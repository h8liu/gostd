<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5697330">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5697386">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5697440">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5697491">package</span>&nbsp;<span class="ident" id="5697499">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5697506">import</span>&nbsp;<span class="op" id="5697513">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697516">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697525">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697535">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697542">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697552">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697562">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697575">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697587">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697593">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697606">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697613">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697619">pathpkg</span>&nbsp;<span class="string" id="5697627">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697635">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697652">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697663">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697671">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697682">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697693">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5697704">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5697719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5697722">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="5697781">type</span>&nbsp;<span class="ident" id="5697786">Context</span>&nbsp;<span class="keyword" id="5697794">struct</span>&nbsp;<span class="op" id="5697801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697804">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5697816">string</span>&nbsp;<span class="comment" id="5697823">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697847">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5697859">string</span>&nbsp;<span class="comment" id="5697866">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697894">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5697906">string</span>&nbsp;<span class="comment" id="5697913">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697925">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5697937">string</span>&nbsp;<span class="comment" id="5697944">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5697956">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="5697968">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5697975">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698003">UseAllFiles</span>&nbsp;<span class="builtintype" id="5698015">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5698022">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698075">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5698087">string</span>&nbsp;<span class="comment" id="5698094">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698146">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698203">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698273">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698339">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698415">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698501">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698569">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698631">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5698643">[</span><span class="op" id="5698644">]</span><span class="builtintype" id="5698645">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5698653">ReleaseTags</span>&nbsp;<span class="op" id="5698665">[</span><span class="op" id="5698666">]</span><span class="builtintype" id="5698667">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698676">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698757">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698832">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698909">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5698985">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699059">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699114">InstallSuffix</span>&nbsp;<span class="builtintype" id="5699128">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699137">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699206">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699270">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699338">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699409">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699465">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699535">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699586">JoinPath</span>&nbsp;<span class="keyword" id="5699595">func</span><span class="op" id="5699599">(</span><span class="ident" id="5699600">elem</span>&nbsp;<span class="op" id="5699605">...</span><span class="builtintype" id="5699608">string</span><span class="op" id="5699614">)</span>&nbsp;<span class="builtintype" id="5699616">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699625">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699698">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699759">SplitPathList</span>&nbsp;<span class="keyword" id="5699773">func</span><span class="op" id="5699777">(</span><span class="ident" id="5699778">list</span>&nbsp;<span class="builtintype" id="5699783">string</span><span class="op" id="5699789">)</span>&nbsp;<span class="op" id="5699791">[</span><span class="op" id="5699792">]</span><span class="builtintype" id="5699793">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699802">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699858">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5699911">IsAbsPath</span>&nbsp;<span class="keyword" id="5699921">func</span><span class="op" id="5699925">(</span><span class="ident" id="5699926">path</span>&nbsp;<span class="builtintype" id="5699931">string</span><span class="op" id="5699937">)</span>&nbsp;<span class="builtintype" id="5699939">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5699946">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700000">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700078">IsDir</span>&nbsp;<span class="keyword" id="5700084">func</span><span class="op" id="5700088">(</span><span class="ident" id="5700089">path</span>&nbsp;<span class="builtintype" id="5700094">string</span><span class="op" id="5700100">)</span>&nbsp;<span class="builtintype" id="5700102">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700109">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700164">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700206">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700267">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700330">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700394">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700421">HasSubdir</span>&nbsp;<span class="keyword" id="5700431">func</span><span class="op" id="5700435">(</span><span class="ident" id="5700436">root</span><span class="op" id="5700440">,</span>&nbsp;<span class="ident" id="5700442">dir</span>&nbsp;<span class="builtintype" id="5700446">string</span><span class="op" id="5700452">)</span>&nbsp;<span class="op" id="5700454">(</span><span class="ident" id="5700455">rel</span>&nbsp;<span class="builtintype" id="5700459">string</span><span class="op" id="5700465">,</span>&nbsp;<span class="ident" id="5700467">ok</span>&nbsp;<span class="builtintype" id="5700470">bool</span><span class="op" id="5700474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700478">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700538">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700589">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700640">ReadDir</span>&nbsp;<span class="keyword" id="5700648">func</span><span class="op" id="5700652">(</span><span class="ident" id="5700653">dir</span>&nbsp;<span class="builtintype" id="5700657">string</span><span class="op" id="5700663">)</span>&nbsp;<span class="op" id="5700665">(</span><span class="ident" id="5700666">fi</span>&nbsp;<span class="op" id="5700669">[</span><span class="op" id="5700670">]</span><span class="ident" id="5700671">os</span><span class="op" id="5700673">.</span><span class="ident" id="5700674">FileInfo</span><span class="op" id="5700682">,</span>&nbsp;<span class="ident" id="5700684">err</span>&nbsp;<span class="builtintype" id="5700688">error</span><span class="op" id="5700693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700697">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5700754">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5700799">OpenFile</span>&nbsp;<span class="keyword" id="5700808">func</span><span class="op" id="5700812">(</span><span class="ident" id="5700813">path</span>&nbsp;<span class="builtintype" id="5700818">string</span><span class="op" id="5700824">)</span>&nbsp;<span class="op" id="5700826">(</span><span class="ident" id="5700827">r</span>&nbsp;<span class="ident" id="5700829">io</span><span class="op" id="5700831">.</span><span class="ident" id="5700832">ReadCloser</span><span class="op" id="5700842">,</span>&nbsp;<span class="ident" id="5700844">err</span>&nbsp;<span class="builtintype" id="5700848">error</span><span class="op" id="5700853">)</span><br>
<span class="lineno">95</span><span class="op" id="5700855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5700858">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="5700926">func</span>&nbsp;<span class="op" id="5700931">(</span><span class="ident" id="5700932">ctxt</span>&nbsp;<span class="op" id="5700937">*</span><span class="ident" id="5700938">Context</span><span class="op" id="5700945">)</span>&nbsp;<span class="ident" id="5700947">joinPath</span><span class="op" id="5700955">(</span><span class="ident" id="5700956">elem</span>&nbsp;<span class="op" id="5700961">...</span><span class="builtintype" id="5700964">string</span><span class="op" id="5700970">)</span>&nbsp;<span class="builtintype" id="5700972">string</span>&nbsp;<span class="op" id="5700979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5700982">if</span>&nbsp;<span class="ident" id="5700985">f</span>&nbsp;<span class="op" id="5700987">:=</span>&nbsp;<span class="ident" id="5700990">ctxt</span><span class="op" id="5700994">.</span><span class="ident" id="5700995">JoinPath</span><span class="op" id="5701003">;</span>&nbsp;<span class="ident" id="5701005">f</span>&nbsp;<span class="op" id="5701007">!=</span>&nbsp;<span class="ident" id="5701010">nil</span>&nbsp;<span class="op" id="5701014">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701018">return</span>&nbsp;<span class="ident" id="5701025">f</span><span class="op" id="5701026">(</span><span class="ident" id="5701027">elem</span><span class="op" id="5701031">...</span><span class="op" id="5701034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701040">return</span>&nbsp;<span class="ident" id="5701047">filepath</span><span class="op" id="5701055">.</span><span class="ident" id="5701056">Join</span><span class="op" id="5701060">(</span><span class="ident" id="5701061">elem</span><span class="op" id="5701065">...</span><span class="op" id="5701068">)</span><br>
<span class="lineno"></span><span class="op" id="5701070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5701073">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="5701156">func</span>&nbsp;<span class="op" id="5701161">(</span><span class="ident" id="5701162">ctxt</span>&nbsp;<span class="op" id="5701167">*</span><span class="ident" id="5701168">Context</span><span class="op" id="5701175">)</span>&nbsp;<span class="ident" id="5701177">splitPathList</span><span class="op" id="5701190">(</span><span class="ident" id="5701191">s</span>&nbsp;<span class="builtintype" id="5701193">string</span><span class="op" id="5701199">)</span>&nbsp;<span class="op" id="5701201">[</span><span class="op" id="5701202">]</span><span class="builtintype" id="5701203">string</span>&nbsp;<span class="op" id="5701210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701213">if</span>&nbsp;<span class="ident" id="5701216">f</span>&nbsp;<span class="op" id="5701218">:=</span>&nbsp;<span class="ident" id="5701221">ctxt</span><span class="op" id="5701225">.</span><span class="ident" id="5701226">SplitPathList</span><span class="op" id="5701239">;</span>&nbsp;<span class="ident" id="5701241">f</span>&nbsp;<span class="op" id="5701243">!=</span>&nbsp;<span class="ident" id="5701246">nil</span>&nbsp;<span class="op" id="5701250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701254">return</span>&nbsp;<span class="ident" id="5701261">f</span><span class="op" id="5701262">(</span><span class="ident" id="5701263">s</span><span class="op" id="5701264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701267">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701270">return</span>&nbsp;<span class="ident" id="5701277">filepath</span><span class="op" id="5701285">.</span><span class="ident" id="5701286">SplitList</span><span class="op" id="5701295">(</span><span class="ident" id="5701296">s</span><span class="op" id="5701297">)</span><br>
<span class="lineno"></span><span class="op" id="5701299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5701302">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="5701374">func</span>&nbsp;<span class="op" id="5701379">(</span><span class="ident" id="5701380">ctxt</span>&nbsp;<span class="op" id="5701385">*</span><span class="ident" id="5701386">Context</span><span class="op" id="5701393">)</span>&nbsp;<span class="ident" id="5701395">isAbsPath</span><span class="op" id="5701404">(</span><span class="ident" id="5701405">path</span>&nbsp;<span class="builtintype" id="5701410">string</span><span class="op" id="5701416">)</span>&nbsp;<span class="builtintype" id="5701418">bool</span>&nbsp;<span class="op" id="5701423">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701426">if</span>&nbsp;<span class="ident" id="5701429">f</span>&nbsp;<span class="op" id="5701431">:=</span>&nbsp;<span class="ident" id="5701434">ctxt</span><span class="op" id="5701438">.</span><span class="ident" id="5701439">IsAbsPath</span><span class="op" id="5701448">;</span>&nbsp;<span class="ident" id="5701450">f</span>&nbsp;<span class="op" id="5701452">!=</span>&nbsp;<span class="ident" id="5701455">nil</span>&nbsp;<span class="op" id="5701459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701463">return</span>&nbsp;<span class="ident" id="5701470">f</span><span class="op" id="5701471">(</span><span class="ident" id="5701472">path</span><span class="op" id="5701476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701482">return</span>&nbsp;<span class="ident" id="5701489">filepath</span><span class="op" id="5701497">.</span><span class="ident" id="5701498">IsAbs</span><span class="op" id="5701503">(</span><span class="ident" id="5701504">path</span><span class="op" id="5701508">)</span><br>
<span class="lineno"></span><span class="op" id="5701510">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5701513">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="5701574">func</span>&nbsp;<span class="op" id="5701579">(</span><span class="ident" id="5701580">ctxt</span>&nbsp;<span class="op" id="5701585">*</span><span class="ident" id="5701586">Context</span><span class="op" id="5701593">)</span>&nbsp;<span class="ident" id="5701595">isDir</span><span class="op" id="5701600">(</span><span class="ident" id="5701601">path</span>&nbsp;<span class="builtintype" id="5701606">string</span><span class="op" id="5701612">)</span>&nbsp;<span class="builtintype" id="5701614">bool</span>&nbsp;<span class="op" id="5701619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701622">if</span>&nbsp;<span class="ident" id="5701625">f</span>&nbsp;<span class="op" id="5701627">:=</span>&nbsp;<span class="ident" id="5701630">ctxt</span><span class="op" id="5701634">.</span><span class="ident" id="5701635">IsDir</span><span class="op" id="5701640">;</span>&nbsp;<span class="ident" id="5701642">f</span>&nbsp;<span class="op" id="5701644">!=</span>&nbsp;<span class="ident" id="5701647">nil</span>&nbsp;<span class="op" id="5701651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701655">return</span>&nbsp;<span class="ident" id="5701662">f</span><span class="op" id="5701663">(</span><span class="ident" id="5701664">path</span><span class="op" id="5701668">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5701674">fi</span><span class="op" id="5701676">,</span>&nbsp;<span class="ident" id="5701678">err</span>&nbsp;<span class="op" id="5701682">:=</span>&nbsp;<span class="ident" id="5701685">os</span><span class="op" id="5701687">.</span><span class="ident" id="5701688">Stat</span><span class="op" id="5701692">(</span><span class="ident" id="5701693">path</span><span class="op" id="5701697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701700">return</span>&nbsp;<span class="ident" id="5701707">err</span>&nbsp;<span class="op" id="5701711">==</span>&nbsp;<span class="ident" id="5701714">nil</span>&nbsp;<span class="op" id="5701718">&amp;&amp;</span>&nbsp;<span class="ident" id="5701721">fi</span><span class="op" id="5701723">.</span><span class="ident" id="5701724">IsDir</span><span class="op" id="5701729">(</span><span class="op" id="5701730">)</span><br>
<span class="lineno"></span><span class="op" id="5701732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5701735">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5701795">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="5701844">func</span>&nbsp;<span class="op" id="5701849">(</span><span class="ident" id="5701850">ctxt</span>&nbsp;<span class="op" id="5701855">*</span><span class="ident" id="5701856">Context</span><span class="op" id="5701863">)</span>&nbsp;<span class="ident" id="5701865">hasSubdir</span><span class="op" id="5701874">(</span><span class="ident" id="5701875">root</span><span class="op" id="5701879">,</span>&nbsp;<span class="ident" id="5701881">dir</span>&nbsp;<span class="builtintype" id="5701885">string</span><span class="op" id="5701891">)</span>&nbsp;<span class="op" id="5701893">(</span><span class="ident" id="5701894">rel</span>&nbsp;<span class="builtintype" id="5701898">string</span><span class="op" id="5701904">,</span>&nbsp;<span class="ident" id="5701906">ok</span>&nbsp;<span class="builtintype" id="5701909">bool</span><span class="op" id="5701913">)</span>&nbsp;<span class="op" id="5701915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701918">if</span>&nbsp;<span class="ident" id="5701921">f</span>&nbsp;<span class="op" id="5701923">:=</span>&nbsp;<span class="ident" id="5701926">ctxt</span><span class="op" id="5701930">.</span><span class="ident" id="5701931">HasSubdir</span><span class="op" id="5701940">;</span>&nbsp;<span class="ident" id="5701942">f</span>&nbsp;<span class="op" id="5701944">!=</span>&nbsp;<span class="ident" id="5701947">nil</span>&nbsp;<span class="op" id="5701951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5701955">return</span>&nbsp;<span class="ident" id="5701962">f</span><span class="op" id="5701963">(</span><span class="ident" id="5701964">root</span><span class="op" id="5701968">,</span>&nbsp;<span class="ident" id="5701970">dir</span><span class="op" id="5701973">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5701976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5701980">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702013">if</span>&nbsp;<span class="ident" id="5702016">rel</span><span class="op" id="5702019">,</span>&nbsp;<span class="ident" id="5702021">ok</span>&nbsp;<span class="op" id="5702024">=</span>&nbsp;<span class="ident" id="5702026">hasSubdir</span><span class="op" id="5702035">(</span><span class="ident" id="5702036">root</span><span class="op" id="5702040">,</span>&nbsp;<span class="ident" id="5702042">dir</span><span class="op" id="5702045">)</span><span class="op" id="5702046">;</span>&nbsp;<span class="ident" id="5702048">ok</span>&nbsp;<span class="op" id="5702051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702055">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702067">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702108">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5702144">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702175">rootSym</span><span class="op" id="5702182">,</span>&nbsp;<span class="ident" id="5702184">_</span>&nbsp;<span class="op" id="5702186">:=</span>&nbsp;<span class="ident" id="5702189">filepath</span><span class="op" id="5702197">.</span><span class="ident" id="5702198">EvalSymlinks</span><span class="op" id="5702210">(</span><span class="ident" id="5702211">root</span><span class="op" id="5702215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702218">dirSym</span><span class="op" id="5702224">,</span>&nbsp;<span class="ident" id="5702226">_</span>&nbsp;<span class="op" id="5702228">:=</span>&nbsp;<span class="ident" id="5702231">filepath</span><span class="op" id="5702239">.</span><span class="ident" id="5702240">EvalSymlinks</span><span class="op" id="5702252">(</span><span class="ident" id="5702253">dir</span><span class="op" id="5702256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702260">if</span>&nbsp;<span class="ident" id="5702263">rel</span><span class="op" id="5702266">,</span>&nbsp;<span class="ident" id="5702268">ok</span>&nbsp;<span class="op" id="5702271">=</span>&nbsp;<span class="ident" id="5702273">hasSubdir</span><span class="op" id="5702282">(</span><span class="ident" id="5702283">rootSym</span><span class="op" id="5702290">,</span>&nbsp;<span class="ident" id="5702292">dir</span><span class="op" id="5702295">)</span><span class="op" id="5702296">;</span>&nbsp;<span class="ident" id="5702298">ok</span>&nbsp;<span class="op" id="5702301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702305">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702316">if</span>&nbsp;<span class="ident" id="5702319">rel</span><span class="op" id="5702322">,</span>&nbsp;<span class="ident" id="5702324">ok</span>&nbsp;<span class="op" id="5702327">=</span>&nbsp;<span class="ident" id="5702329">hasSubdir</span><span class="op" id="5702338">(</span><span class="ident" id="5702339">root</span><span class="op" id="5702343">,</span>&nbsp;<span class="ident" id="5702345">dirSym</span><span class="op" id="5702351">)</span><span class="op" id="5702352">;</span>&nbsp;<span class="ident" id="5702354">ok</span>&nbsp;<span class="op" id="5702357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702361">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702372">return</span>&nbsp;<span class="ident" id="5702379">hasSubdir</span><span class="op" id="5702388">(</span><span class="ident" id="5702389">rootSym</span><span class="op" id="5702396">,</span>&nbsp;<span class="ident" id="5702398">dirSym</span><span class="op" id="5702404">)</span><br>
<span class="lineno">155</span><span class="op" id="5702406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5702409">func</span>&nbsp;<span class="ident" id="5702414">hasSubdir</span><span class="op" id="5702423">(</span><span class="ident" id="5702424">root</span><span class="op" id="5702428">,</span>&nbsp;<span class="ident" id="5702430">dir</span>&nbsp;<span class="builtintype" id="5702434">string</span><span class="op" id="5702440">)</span>&nbsp;<span class="op" id="5702442">(</span><span class="ident" id="5702443">rel</span>&nbsp;<span class="builtintype" id="5702447">string</span><span class="op" id="5702453">,</span>&nbsp;<span class="ident" id="5702455">ok</span>&nbsp;<span class="builtintype" id="5702458">bool</span><span class="op" id="5702462">)</span>&nbsp;<span class="op" id="5702464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702467">const</span>&nbsp;<span class="ident" id="5702473">sep</span>&nbsp;<span class="op" id="5702477">=</span>&nbsp;<span class="builtintype" id="5702479">string</span><span class="op" id="5702485">(</span><span class="ident" id="5702486">filepath</span><span class="op" id="5702494">.</span><span class="ident" id="5702495">Separator</span><span class="op" id="5702504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702507">root</span>&nbsp;<span class="op" id="5702512">=</span>&nbsp;<span class="ident" id="5702514">filepath</span><span class="op" id="5702522">.</span><span class="ident" id="5702523">Clean</span><span class="op" id="5702528">(</span><span class="ident" id="5702529">root</span><span class="op" id="5702533">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702536">if</span>&nbsp;<span class="op" id="5702539">!</span><span class="ident" id="5702540">strings</span><span class="op" id="5702547">.</span><span class="ident" id="5702548">HasSuffix</span><span class="op" id="5702557">(</span><span class="ident" id="5702558">root</span><span class="op" id="5702562">,</span>&nbsp;<span class="ident" id="5702564">sep</span><span class="op" id="5702567">)</span>&nbsp;<span class="op" id="5702569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702573">root</span>&nbsp;<span class="op" id="5702578">+=</span>&nbsp;<span class="ident" id="5702581">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5702589">dir</span>&nbsp;<span class="op" id="5702593">=</span>&nbsp;<span class="ident" id="5702595">filepath</span><span class="op" id="5702603">.</span><span class="ident" id="5702604">Clean</span><span class="op" id="5702609">(</span><span class="ident" id="5702610">dir</span><span class="op" id="5702613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702616">if</span>&nbsp;<span class="op" id="5702619">!</span><span class="ident" id="5702620">strings</span><span class="op" id="5702627">.</span><span class="ident" id="5702628">HasPrefix</span><span class="op" id="5702637">(</span><span class="ident" id="5702638">dir</span><span class="op" id="5702641">,</span>&nbsp;<span class="ident" id="5702643">root</span><span class="op" id="5702647">)</span>&nbsp;<span class="op" id="5702649">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702653">return</span>&nbsp;<span class="string" id="5702660">&#34;&#34;</span><span class="op" id="5702662">,</span>&nbsp;<span class="builtintype" id="5702664">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702674">return</span>&nbsp;<span class="ident" id="5702681">filepath</span><span class="op" id="5702689">.</span><span class="ident" id="5702690">ToSlash</span><span class="op" id="5702697">(</span><span class="ident" id="5702698">dir</span><span class="op" id="5702701">[</span><span class="builtinfunc" id="5702702">len</span><span class="op" id="5702705">(</span><span class="ident" id="5702706">root</span><span class="op" id="5702710">)</span><span class="op" id="5702711">:</span><span class="op" id="5702712">]</span><span class="op" id="5702713">)</span><span class="op" id="5702714">,</span>&nbsp;<span class="builtintype" id="5702716">true</span><br>
<span class="lineno"></span><span class="op" id="5702721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5702724">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5702791">func</span>&nbsp;<span class="op" id="5702796">(</span><span class="ident" id="5702797">ctxt</span>&nbsp;<span class="op" id="5702802">*</span><span class="ident" id="5702803">Context</span><span class="op" id="5702810">)</span>&nbsp;<span class="ident" id="5702812">readDir</span><span class="op" id="5702819">(</span><span class="ident" id="5702820">path</span>&nbsp;<span class="builtintype" id="5702825">string</span><span class="op" id="5702831">)</span>&nbsp;<span class="op" id="5702833">(</span><span class="op" id="5702834">[</span><span class="op" id="5702835">]</span><span class="ident" id="5702836">os</span><span class="op" id="5702838">.</span><span class="ident" id="5702839">FileInfo</span><span class="op" id="5702847">,</span>&nbsp;<span class="builtintype" id="5702849">error</span><span class="op" id="5702854">)</span>&nbsp;<span class="op" id="5702856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702859">if</span>&nbsp;<span class="ident" id="5702862">f</span>&nbsp;<span class="op" id="5702864">:=</span>&nbsp;<span class="ident" id="5702867">ctxt</span><span class="op" id="5702871">.</span><span class="ident" id="5702872">ReadDir</span><span class="op" id="5702879">;</span>&nbsp;<span class="ident" id="5702881">f</span>&nbsp;<span class="op" id="5702883">!=</span>&nbsp;<span class="ident" id="5702886">nil</span>&nbsp;<span class="op" id="5702890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702894">return</span>&nbsp;<span class="ident" id="5702901">f</span><span class="op" id="5702902">(</span><span class="ident" id="5702903">path</span><span class="op" id="5702907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5702910">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5702913">return</span>&nbsp;<span class="ident" id="5702920">ioutil</span><span class="op" id="5702926">.</span><span class="ident" id="5702927">ReadDir</span><span class="op" id="5702934">(</span><span class="ident" id="5702935">path</span><span class="op" id="5702939">)</span><br>
<span class="lineno"></span><span class="op" id="5702941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5702944">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="5703006">func</span>&nbsp;<span class="op" id="5703011">(</span><span class="ident" id="5703012">ctxt</span>&nbsp;<span class="op" id="5703017">*</span><span class="ident" id="5703018">Context</span><span class="op" id="5703025">)</span>&nbsp;<span class="ident" id="5703027">openFile</span><span class="op" id="5703035">(</span><span class="ident" id="5703036">path</span>&nbsp;<span class="builtintype" id="5703041">string</span><span class="op" id="5703047">)</span>&nbsp;<span class="op" id="5703049">(</span><span class="ident" id="5703050">io</span><span class="op" id="5703052">.</span><span class="ident" id="5703053">ReadCloser</span><span class="op" id="5703063">,</span>&nbsp;<span class="builtintype" id="5703065">error</span><span class="op" id="5703070">)</span>&nbsp;<span class="op" id="5703072">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703075">if</span>&nbsp;<span class="ident" id="5703078">fn</span>&nbsp;<span class="op" id="5703081">:=</span>&nbsp;<span class="ident" id="5703084">ctxt</span><span class="op" id="5703088">.</span><span class="ident" id="5703089">OpenFile</span><span class="op" id="5703097">;</span>&nbsp;<span class="ident" id="5703099">fn</span>&nbsp;<span class="op" id="5703102">!=</span>&nbsp;<span class="ident" id="5703105">nil</span>&nbsp;<span class="op" id="5703109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703113">return</span>&nbsp;<span class="ident" id="5703120">fn</span><span class="op" id="5703122">(</span><span class="ident" id="5703123">path</span><span class="op" id="5703127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703134">f</span><span class="op" id="5703135">,</span>&nbsp;<span class="ident" id="5703137">err</span>&nbsp;<span class="op" id="5703141">:=</span>&nbsp;<span class="ident" id="5703144">os</span><span class="op" id="5703146">.</span><span class="ident" id="5703147">Open</span><span class="op" id="5703151">(</span><span class="ident" id="5703152">path</span><span class="op" id="5703156">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703159">if</span>&nbsp;<span class="ident" id="5703162">err</span>&nbsp;<span class="op" id="5703166">!=</span>&nbsp;<span class="ident" id="5703169">nil</span>&nbsp;<span class="op" id="5703173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703177">return</span>&nbsp;<span class="ident" id="5703184">nil</span><span class="op" id="5703187">,</span>&nbsp;<span class="ident" id="5703189">err</span>&nbsp;<span class="comment" id="5703193">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703214">return</span>&nbsp;<span class="ident" id="5703221">f</span><span class="op" id="5703222">,</span>&nbsp;<span class="ident" id="5703224">nil</span><br>
<span class="lineno"></span><span class="op" id="5703228">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5703231">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5703297">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5703361">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="5703381">func</span>&nbsp;<span class="op" id="5703386">(</span><span class="ident" id="5703387">ctxt</span>&nbsp;<span class="op" id="5703392">*</span><span class="ident" id="5703393">Context</span><span class="op" id="5703400">)</span>&nbsp;<span class="ident" id="5703402">isFile</span><span class="op" id="5703408">(</span><span class="ident" id="5703409">path</span>&nbsp;<span class="builtintype" id="5703414">string</span><span class="op" id="5703420">)</span>&nbsp;<span class="builtintype" id="5703422">bool</span>&nbsp;<span class="op" id="5703427">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703430">f</span><span class="op" id="5703431">,</span>&nbsp;<span class="ident" id="5703433">err</span>&nbsp;<span class="op" id="5703437">:=</span>&nbsp;<span class="ident" id="5703440">ctxt</span><span class="op" id="5703444">.</span><span class="ident" id="5703445">openFile</span><span class="op" id="5703453">(</span><span class="ident" id="5703454">path</span><span class="op" id="5703458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703461">if</span>&nbsp;<span class="ident" id="5703464">err</span>&nbsp;<span class="op" id="5703468">!=</span>&nbsp;<span class="ident" id="5703471">nil</span>&nbsp;<span class="op" id="5703475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703479">return</span>&nbsp;<span class="builtintype" id="5703486">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5703496">f</span><span class="op" id="5703497">.</span><span class="ident" id="5703498">Close</span><span class="op" id="5703503">(</span><span class="op" id="5703504">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703507">return</span>&nbsp;<span class="builtintype" id="5703514">true</span><br>
<span class="lineno"></span><span class="op" id="5703519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5703522">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="5703573">func</span>&nbsp;<span class="op" id="5703578">(</span><span class="ident" id="5703579">ctxt</span>&nbsp;<span class="op" id="5703584">*</span><span class="ident" id="5703585">Context</span><span class="op" id="5703592">)</span>&nbsp;<span class="ident" id="5703594">gopath</span><span class="op" id="5703600">(</span><span class="op" id="5703601">)</span>&nbsp;<span class="op" id="5703603">[</span><span class="op" id="5703604">]</span><span class="builtintype" id="5703605">string</span>&nbsp;<span class="op" id="5703612">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703615">var</span>&nbsp;<span class="ident" id="5703619">all</span>&nbsp;<span class="op" id="5703623">[</span><span class="op" id="5703624">]</span><span class="builtintype" id="5703625">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703633">for</span>&nbsp;<span class="ident" id="5703637">_</span><span class="op" id="5703638">,</span>&nbsp;<span class="ident" id="5703640">p</span>&nbsp;<span class="op" id="5703642">:=</span>&nbsp;<span class="keyword" id="5703645">range</span>&nbsp;<span class="ident" id="5703651">ctxt</span><span class="op" id="5703655">.</span><span class="ident" id="5703656">splitPathList</span><span class="op" id="5703669">(</span><span class="ident" id="5703670">ctxt</span><span class="op" id="5703674">.</span><span class="ident" id="5703675">GOPATH</span><span class="op" id="5703681">)</span>&nbsp;<span class="op" id="5703683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703687">if</span>&nbsp;<span class="ident" id="5703690">p</span>&nbsp;<span class="op" id="5703692">==</span>&nbsp;<span class="string" id="5703695">&#34;&#34;</span>&nbsp;<span class="op" id="5703698">||</span>&nbsp;<span class="ident" id="5703701">p</span>&nbsp;<span class="op" id="5703703">==</span>&nbsp;<span class="ident" id="5703706">ctxt</span><span class="op" id="5703710">.</span><span class="ident" id="5703711">GOROOT</span>&nbsp;<span class="op" id="5703718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5703723">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5703760">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5703804">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5703847">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703897">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5703908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5703912">if</span>&nbsp;<span class="ident" id="5703915">strings</span><span class="op" id="5703922">.</span><span class="ident" id="5703923">HasPrefix</span><span class="op" id="5703932">(</span><span class="ident" id="5703933">p</span><span class="op" id="5703934">,</span>&nbsp;<span class="string" id="5703936">&#34;~&#34;</span><span class="op" id="5703939">)</span>&nbsp;<span class="op" id="5703941">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5703946">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704008">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704072">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704117">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704177">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704235">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704302">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704365">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704431">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704490">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704510">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5704574">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704602">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704617">all</span>&nbsp;<span class="op" id="5704621">=</span>&nbsp;<span class="builtinfunc" id="5704623">append</span><span class="op" id="5704629">(</span><span class="ident" id="5704630">all</span><span class="op" id="5704633">,</span>&nbsp;<span class="ident" id="5704635">p</span><span class="op" id="5704636">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704642">return</span>&nbsp;<span class="ident" id="5704649">all</span><br>
<span class="lineno"></span><span class="op" id="5704653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5704656">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="5704718">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="5704789">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="5704811">func</span>&nbsp;<span class="op" id="5704816">(</span><span class="ident" id="5704817">ctxt</span>&nbsp;<span class="op" id="5704822">*</span><span class="ident" id="5704823">Context</span><span class="op" id="5704830">)</span>&nbsp;<span class="ident" id="5704832">SrcDirs</span><span class="op" id="5704839">(</span><span class="op" id="5704840">)</span>&nbsp;<span class="op" id="5704842">[</span><span class="op" id="5704843">]</span><span class="builtintype" id="5704844">string</span>&nbsp;<span class="op" id="5704851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704854">var</span>&nbsp;<span class="ident" id="5704858">all</span>&nbsp;<span class="op" id="5704862">[</span><span class="op" id="5704863">]</span><span class="builtintype" id="5704864">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704872">if</span>&nbsp;<span class="ident" id="5704875">ctxt</span><span class="op" id="5704879">.</span><span class="ident" id="5704880">GOROOT</span>&nbsp;<span class="op" id="5704887">!=</span>&nbsp;<span class="string" id="5704890">&#34;&#34;</span>&nbsp;<span class="op" id="5704893">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704897">dir</span>&nbsp;<span class="op" id="5704901">:=</span>&nbsp;<span class="ident" id="5704904">ctxt</span><span class="op" id="5704908">.</span><span class="ident" id="5704909">joinPath</span><span class="op" id="5704917">(</span><span class="ident" id="5704918">ctxt</span><span class="op" id="5704922">.</span><span class="ident" id="5704923">GOROOT</span><span class="op" id="5704929">,</span>&nbsp;<span class="string" id="5704931">&#34;src&#34;</span><span class="op" id="5704936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704940">if</span>&nbsp;<span class="ident" id="5704943">ctxt</span><span class="op" id="5704947">.</span><span class="ident" id="5704948">isDir</span><span class="op" id="5704953">(</span><span class="ident" id="5704954">dir</span><span class="op" id="5704957">)</span>&nbsp;<span class="op" id="5704959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5704964">all</span>&nbsp;<span class="op" id="5704968">=</span>&nbsp;<span class="builtinfunc" id="5704970">append</span><span class="op" id="5704976">(</span><span class="ident" id="5704977">all</span><span class="op" id="5704980">,</span>&nbsp;<span class="ident" id="5704982">dir</span><span class="op" id="5704985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5704992">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5704995">for</span>&nbsp;<span class="ident" id="5704999">_</span><span class="op" id="5705000">,</span>&nbsp;<span class="ident" id="5705002">p</span>&nbsp;<span class="op" id="5705004">:=</span>&nbsp;<span class="keyword" id="5705007">range</span>&nbsp;<span class="ident" id="5705013">ctxt</span><span class="op" id="5705017">.</span><span class="ident" id="5705018">gopath</span><span class="op" id="5705024">(</span><span class="op" id="5705025">)</span>&nbsp;<span class="op" id="5705027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705031">dir</span>&nbsp;<span class="op" id="5705035">:=</span>&nbsp;<span class="ident" id="5705038">ctxt</span><span class="op" id="5705042">.</span><span class="ident" id="5705043">joinPath</span><span class="op" id="5705051">(</span><span class="ident" id="5705052">p</span><span class="op" id="5705053">,</span>&nbsp;<span class="string" id="5705055">&#34;src&#34;</span><span class="op" id="5705060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705064">if</span>&nbsp;<span class="ident" id="5705067">ctxt</span><span class="op" id="5705071">.</span><span class="ident" id="5705072">isDir</span><span class="op" id="5705077">(</span><span class="ident" id="5705078">dir</span><span class="op" id="5705081">)</span>&nbsp;<span class="op" id="5705083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705088">all</span>&nbsp;<span class="op" id="5705092">=</span>&nbsp;<span class="builtinfunc" id="5705094">append</span><span class="op" id="5705100">(</span><span class="ident" id="5705101">all</span><span class="op" id="5705104">,</span>&nbsp;<span class="ident" id="5705106">dir</span><span class="op" id="5705109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705113">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5705116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705119">return</span>&nbsp;<span class="ident" id="5705126">all</span><br>
<span class="lineno"></span><span class="op" id="5705130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705133">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="5705179">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="5705249">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="5705314">var</span>&nbsp;<span class="ident" id="5705318">Default</span>&nbsp;<span class="ident" id="5705326">Context</span>&nbsp;<span class="op" id="5705334">=</span>&nbsp;<span class="ident" id="5705336">defaultContext</span><span class="op" id="5705350">(</span><span class="op" id="5705351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5705354">var</span>&nbsp;<span class="ident" id="5705358">cgoEnabled</span>&nbsp;<span class="op" id="5705369">=</span>&nbsp;<span class="keyword" id="5705371">map</span><span class="op" id="5705374">[</span><span class="builtintype" id="5705375">string</span><span class="op" id="5705381">]</span><span class="builtintype" id="5705382">bool</span><span class="op" id="5705386">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705389">&#34;darwin/386&#34;</span><span class="op" id="5705401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705408">true</span><span class="op" id="5705412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705415">&#34;darwin/amd64&#34;</span><span class="op" id="5705429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705434">true</span><span class="op" id="5705438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705441">&#34;dragonfly/386&#34;</span><span class="op" id="5705456">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705460">true</span><span class="op" id="5705464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705467">&#34;dragonfly/amd64&#34;</span><span class="op" id="5705484">:</span>&nbsp;<span class="builtintype" id="5705486">true</span><span class="op" id="5705490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705493">&#34;freebsd/386&#34;</span><span class="op" id="5705506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705512">true</span><span class="op" id="5705516">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705519">&#34;freebsd/amd64&#34;</span><span class="op" id="5705534">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705538">true</span><span class="op" id="5705542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705545">&#34;freebsd/arm&#34;</span><span class="op" id="5705558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705564">true</span><span class="op" id="5705568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705571">&#34;linux/386&#34;</span><span class="op" id="5705582">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705590">true</span><span class="op" id="5705594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705597">&#34;linux/amd64&#34;</span><span class="op" id="5705610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705616">true</span><span class="op" id="5705620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705623">&#34;linux/arm&#34;</span><span class="op" id="5705634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705642">true</span><span class="op" id="5705646">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705649">&#34;android/386&#34;</span><span class="op" id="5705662">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705668">true</span><span class="op" id="5705672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705675">&#34;android/amd64&#34;</span><span class="op" id="5705690">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705694">true</span><span class="op" id="5705698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705701">&#34;android/arm&#34;</span><span class="op" id="5705714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705720">true</span><span class="op" id="5705724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705727">&#34;netbsd/386&#34;</span><span class="op" id="5705739">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705746">true</span><span class="op" id="5705750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705753">&#34;netbsd/amd64&#34;</span><span class="op" id="5705767">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705772">true</span><span class="op" id="5705776">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705779">&#34;netbsd/arm&#34;</span><span class="op" id="5705791">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705798">true</span><span class="op" id="5705802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705805">&#34;openbsd/386&#34;</span><span class="op" id="5705818">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705824">true</span><span class="op" id="5705828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705831">&#34;openbsd/amd64&#34;</span><span class="op" id="5705846">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705850">true</span><span class="op" id="5705854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705857">&#34;windows/386&#34;</span><span class="op" id="5705870">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705876">true</span><span class="op" id="5705880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5705883">&#34;windows/amd64&#34;</span><span class="op" id="5705898">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705902">true</span><span class="op" id="5705906">,</span><br>
<span class="lineno">280</span><span class="op" id="5705908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5705911">func</span>&nbsp;<span class="ident" id="5705916">defaultContext</span><span class="op" id="5705930">(</span><span class="op" id="5705931">)</span>&nbsp;<span class="ident" id="5705933">Context</span>&nbsp;<span class="op" id="5705941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5705944">var</span>&nbsp;<span class="ident" id="5705948">c</span>&nbsp;<span class="ident" id="5705950">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5705960">c</span><span class="op" id="5705961">.</span><span class="ident" id="5705962">GOARCH</span>&nbsp;<span class="op" id="5705969">=</span>&nbsp;<span class="ident" id="5705971">envOr</span><span class="op" id="5705976">(</span><span class="string" id="5705977">&#34;GOARCH&#34;</span><span class="op" id="5705985">,</span>&nbsp;<span class="ident" id="5705987">runtime</span><span class="op" id="5705994">.</span><span class="ident" id="5705995">GOARCH</span><span class="op" id="5706001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706004">c</span><span class="op" id="5706005">.</span><span class="ident" id="5706006">GOOS</span>&nbsp;<span class="op" id="5706011">=</span>&nbsp;<span class="ident" id="5706013">envOr</span><span class="op" id="5706018">(</span><span class="string" id="5706019">&#34;GOOS&#34;</span><span class="op" id="5706025">,</span>&nbsp;<span class="ident" id="5706027">runtime</span><span class="op" id="5706034">.</span><span class="ident" id="5706035">GOOS</span><span class="op" id="5706039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706042">c</span><span class="op" id="5706043">.</span><span class="ident" id="5706044">GOROOT</span>&nbsp;<span class="op" id="5706051">=</span>&nbsp;<span class="ident" id="5706053">runtime</span><span class="op" id="5706060">.</span><span class="ident" id="5706061">GOROOT</span><span class="op" id="5706067">(</span><span class="op" id="5706068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706071">c</span><span class="op" id="5706072">.</span><span class="ident" id="5706073">GOPATH</span>&nbsp;<span class="op" id="5706080">=</span>&nbsp;<span class="ident" id="5706082">envOr</span><span class="op" id="5706087">(</span><span class="string" id="5706088">&#34;GOPATH&#34;</span><span class="op" id="5706096">,</span>&nbsp;<span class="string" id="5706098">&#34;&#34;</span><span class="op" id="5706100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706103">c</span><span class="op" id="5706104">.</span><span class="ident" id="5706105">Compiler</span>&nbsp;<span class="op" id="5706114">=</span>&nbsp;<span class="ident" id="5706116">runtime</span><span class="op" id="5706123">.</span><span class="ident" id="5706124">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706135">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706205">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706275">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706348">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706421">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706498">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706502">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706546">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706620">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706635">c</span><span class="op" id="5706636">.</span><span class="ident" id="5706637">ReleaseTags</span>&nbsp;<span class="op" id="5706649">=</span>&nbsp;<span class="op" id="5706651">[</span><span class="op" id="5706652">]</span><span class="builtintype" id="5706653">string</span><span class="op" id="5706659">{</span><span class="string" id="5706660">&#34;go1.1&#34;</span><span class="op" id="5706667">,</span>&nbsp;<span class="string" id="5706669">&#34;go1.2&#34;</span><span class="op" id="5706676">,</span>&nbsp;<span class="string" id="5706678">&#34;go1.3&#34;</span><span class="op" id="5706685">,</span>&nbsp;<span class="string" id="5706687">&#34;go1.4&#34;</span><span class="op" id="5706694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706698">switch</span>&nbsp;<span class="ident" id="5706705">os</span><span class="op" id="5706707">.</span><span class="ident" id="5706708">Getenv</span><span class="op" id="5706714">(</span><span class="string" id="5706715">&#34;CGO_ENABLED&#34;</span><span class="op" id="5706728">)</span>&nbsp;<span class="op" id="5706730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706733">case</span>&nbsp;<span class="string" id="5706738">&#34;1&#34;</span><span class="op" id="5706741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706745">c</span><span class="op" id="5706746">.</span><span class="ident" id="5706747">CgoEnabled</span>&nbsp;<span class="op" id="5706758">=</span>&nbsp;<span class="builtintype" id="5706760">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706766">case</span>&nbsp;<span class="string" id="5706771">&#34;0&#34;</span><span class="op" id="5706774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706778">c</span><span class="op" id="5706779">.</span><span class="ident" id="5706780">CgoEnabled</span>&nbsp;<span class="op" id="5706791">=</span>&nbsp;<span class="builtintype" id="5706793">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706800">default</span><span class="op" id="5706807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5706811">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706876">if</span>&nbsp;<span class="ident" id="5706879">runtime</span><span class="op" id="5706886">.</span><span class="ident" id="5706887">GOARCH</span>&nbsp;<span class="op" id="5706894">==</span>&nbsp;<span class="ident" id="5706897">c</span><span class="op" id="5706898">.</span><span class="ident" id="5706899">GOARCH</span>&nbsp;<span class="op" id="5706906">&amp;&amp;</span>&nbsp;<span class="ident" id="5706909">runtime</span><span class="op" id="5706916">.</span><span class="ident" id="5706917">GOOS</span>&nbsp;<span class="op" id="5706922">==</span>&nbsp;<span class="ident" id="5706925">c</span><span class="op" id="5706926">.</span><span class="ident" id="5706927">GOOS</span>&nbsp;<span class="op" id="5706932">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706937">c</span><span class="op" id="5706938">.</span><span class="ident" id="5706939">CgoEnabled</span>&nbsp;<span class="op" id="5706950">=</span>&nbsp;<span class="ident" id="5706952">cgoEnabled</span><span class="op" id="5706962">[</span><span class="ident" id="5706963">c</span><span class="op" id="5706964">.</span><span class="ident" id="5706965">GOOS</span><span class="op" id="5706969">+</span><span class="string" id="5706970">&#34;/&#34;</span><span class="op" id="5706973">+</span><span class="ident" id="5706974">c</span><span class="op" id="5706975">.</span><span class="ident" id="5706976">GOARCH</span><span class="op" id="5706982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5706987">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5706995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5706999">c</span><span class="op" id="5707000">.</span><span class="ident" id="5707001">CgoEnabled</span>&nbsp;<span class="op" id="5707012">=</span>&nbsp;<span class="builtintype" id="5707014">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707021">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707025">return</span>&nbsp;<span class="ident" id="5707032">c</span><br>
<span class="lineno"></span><span class="op" id="5707034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5707037">func</span>&nbsp;<span class="ident" id="5707042">envOr</span><span class="op" id="5707047">(</span><span class="ident" id="5707048">name</span><span class="op" id="5707052">,</span>&nbsp;<span class="ident" id="5707054">def</span>&nbsp;<span class="builtintype" id="5707058">string</span><span class="op" id="5707064">)</span>&nbsp;<span class="builtintype" id="5707066">string</span>&nbsp;<span class="op" id="5707073">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707076">s</span>&nbsp;<span class="op" id="5707078">:=</span>&nbsp;<span class="ident" id="5707081">os</span><span class="op" id="5707083">.</span><span class="ident" id="5707084">Getenv</span><span class="op" id="5707090">(</span><span class="ident" id="5707091">name</span><span class="op" id="5707095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707098">if</span>&nbsp;<span class="ident" id="5707101">s</span>&nbsp;<span class="op" id="5707103">==</span>&nbsp;<span class="string" id="5707106">&#34;&#34;</span>&nbsp;<span class="op" id="5707109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707113">return</span>&nbsp;<span class="ident" id="5707120">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5707125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5707128">return</span>&nbsp;<span class="ident" id="5707135">s</span><br>
<span class="lineno">325</span><span class="op" id="5707137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5707140">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="5707201">type</span>&nbsp;<span class="ident" id="5707206">ImportMode</span>&nbsp;<span class="builtintype" id="5707217">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="5707223">const</span>&nbsp;<span class="op" id="5707229">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707232">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707298">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707362">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707399">FindOnly</span>&nbsp;<span class="ident" id="5707408">ImportMode</span>&nbsp;<span class="op" id="5707419">=</span>&nbsp;<span class="num" id="5707421">1</span>&nbsp;<span class="op" id="5707423">&lt;&lt;</span>&nbsp;<span class="ident" id="5707426">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707433">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707498">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707548">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707562">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707636">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707707">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5707767">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707827">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="5707841">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5707844">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="5707904">type</span>&nbsp;<span class="ident" id="5707909">Package</span>&nbsp;<span class="keyword" id="5707917">struct</span>&nbsp;<span class="op" id="5707924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707927">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5707941">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5707950">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5707991">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708005">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708014">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708031">ImportComment</span>&nbsp;<span class="builtintype" id="5708045">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708054">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708102">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708116">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708125">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708152">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708166">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708175">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708218">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708232">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708241">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708286">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708300">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708309">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708359">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708373">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708382">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708433">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708447">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708456">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708502">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708516">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708525">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708554">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708568">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708577">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708599">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5708613">[</span><span class="op" id="5708614">]</span><span class="builtintype" id="5708615">string</span>&nbsp;<span class="comment" id="5708622">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708683">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708697">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708706">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5708749">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708766">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5708781">[</span><span class="op" id="5708782">]</span><span class="builtintype" id="5708783">string</span>&nbsp;<span class="comment" id="5708790">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708859">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5708874">[</span><span class="op" id="5708875">]</span><span class="builtintype" id="5708876">string</span>&nbsp;<span class="comment" id="5708883">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708920">IgnoredGoFiles</span>&nbsp;<span class="op" id="5708935">[</span><span class="op" id="5708936">]</span><span class="builtintype" id="5708937">string</span>&nbsp;<span class="comment" id="5708944">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5708988">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709003">[</span><span class="op" id="5709004">]</span><span class="builtintype" id="5709005">string</span>&nbsp;<span class="comment" id="5709012">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709032">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709047">[</span><span class="op" id="5709048">]</span><span class="builtintype" id="5709049">string</span>&nbsp;<span class="comment" id="5709056">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709092">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709107">[</span><span class="op" id="5709108">]</span><span class="builtintype" id="5709109">string</span>&nbsp;<span class="comment" id="5709116">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709150">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709165">[</span><span class="op" id="5709166">]</span><span class="builtintype" id="5709167">string</span>&nbsp;<span class="comment" id="5709174">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709214">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709229">[</span><span class="op" id="5709230">]</span><span class="builtintype" id="5709231">string</span>&nbsp;<span class="comment" id="5709238">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709258">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709273">[</span><span class="op" id="5709274">]</span><span class="builtintype" id="5709275">string</span>&nbsp;<span class="comment" id="5709282">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709298">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5709313">[</span><span class="op" id="5709314">]</span><span class="builtintype" id="5709315">string</span>&nbsp;<span class="comment" id="5709322">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709341">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709356">[</span><span class="op" id="5709357">]</span><span class="builtintype" id="5709358">string</span>&nbsp;<span class="comment" id="5709365">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709414">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709433">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709446">[</span><span class="op" id="5709447">]</span><span class="builtintype" id="5709448">string</span>&nbsp;<span class="comment" id="5709455">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709481">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="5709494">[</span><span class="op" id="5709495">]</span><span class="builtintype" id="5709496">string</span>&nbsp;<span class="comment" id="5709503">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709531">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="5709544">[</span><span class="op" id="5709545">]</span><span class="builtintype" id="5709546">string</span>&nbsp;<span class="comment" id="5709553">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709581">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5709594">[</span><span class="op" id="5709595">]</span><span class="builtintype" id="5709596">string</span>&nbsp;<span class="comment" id="5709603">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709630">CgoPkgConfig</span>&nbsp;<span class="op" id="5709643">[</span><span class="op" id="5709644">]</span><span class="builtintype" id="5709645">string</span>&nbsp;<span class="comment" id="5709652">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709683">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709710">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5709720">[</span><span class="op" id="5709721">]</span><span class="builtintype" id="5709722">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709748">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709783">ImportPos</span>&nbsp;<span class="keyword" id="5709793">map</span><span class="op" id="5709796">[</span><span class="builtintype" id="5709797">string</span><span class="op" id="5709803">]</span><span class="op" id="5709804">[</span><span class="op" id="5709805">]</span><span class="ident" id="5709806">token</span><span class="op" id="5709811">.</span><span class="ident" id="5709812">Position</span>&nbsp;<span class="comment" id="5709821">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5709855">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709876">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709891">[</span><span class="op" id="5709892">]</span><span class="builtintype" id="5709893">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709919">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5709949">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709964">[</span><span class="op" id="5709965">]</span><span class="builtintype" id="5709966">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709992">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710021">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="5710036">map</span><span class="op" id="5710039">[</span><span class="builtintype" id="5710040">string</span><span class="op" id="5710046">]</span><span class="op" id="5710047">[</span><span class="op" id="5710048">]</span><span class="ident" id="5710049">token</span><span class="op" id="5710054">.</span><span class="ident" id="5710055">Position</span>&nbsp;<span class="comment" id="5710064">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710101">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5710116">[</span><span class="op" id="5710117">]</span><span class="builtintype" id="5710118">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710144">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710179">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5710194">[</span><span class="op" id="5710195">]</span><span class="builtintype" id="5710196">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710222">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710252">XTestImportPos</span>&nbsp;<span class="keyword" id="5710267">map</span><span class="op" id="5710270">[</span><span class="builtintype" id="5710271">string</span><span class="op" id="5710277">]</span><span class="op" id="5710278">[</span><span class="op" id="5710279">]</span><span class="ident" id="5710280">token</span><span class="op" id="5710285">.</span><span class="ident" id="5710286">Position</span>&nbsp;<span class="comment" id="5710295">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="5710332">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5710335">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5710392">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="5710441">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5710491">func</span>&nbsp;<span class="op" id="5710496">(</span><span class="ident" id="5710497">p</span>&nbsp;<span class="op" id="5710499">*</span><span class="ident" id="5710500">Package</span><span class="op" id="5710507">)</span>&nbsp;<span class="ident" id="5710509">IsCommand</span><span class="op" id="5710518">(</span><span class="op" id="5710519">)</span>&nbsp;<span class="builtintype" id="5710521">bool</span>&nbsp;<span class="op" id="5710526">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710529">return</span>&nbsp;<span class="ident" id="5710536">p</span><span class="op" id="5710537">.</span><span class="ident" id="5710538">Name</span>&nbsp;<span class="op" id="5710543">==</span>&nbsp;<span class="string" id="5710546">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="5710553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5710556">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5710622">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="5710646">func</span>&nbsp;<span class="op" id="5710651">(</span><span class="ident" id="5710652">ctxt</span>&nbsp;<span class="op" id="5710657">*</span><span class="ident" id="5710658">Context</span><span class="op" id="5710665">)</span>&nbsp;<span class="ident" id="5710667">ImportDir</span><span class="op" id="5710676">(</span><span class="ident" id="5710677">dir</span>&nbsp;<span class="builtintype" id="5710681">string</span><span class="op" id="5710687">,</span>&nbsp;<span class="ident" id="5710689">mode</span>&nbsp;<span class="ident" id="5710694">ImportMode</span><span class="op" id="5710704">)</span>&nbsp;<span class="op" id="5710706">(</span><span class="op" id="5710707">*</span><span class="ident" id="5710708">Package</span><span class="op" id="5710715">,</span>&nbsp;<span class="builtintype" id="5710717">error</span><span class="op" id="5710722">)</span>&nbsp;<span class="op" id="5710724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5710727">return</span>&nbsp;<span class="ident" id="5710734">ctxt</span><span class="op" id="5710738">.</span><span class="ident" id="5710739">Import</span><span class="op" id="5710745">(</span><span class="string" id="5710746">&#34;.&#34;</span><span class="op" id="5710749">,</span>&nbsp;<span class="ident" id="5710751">dir</span><span class="op" id="5710754">,</span>&nbsp;<span class="ident" id="5710756">mode</span><span class="op" id="5710760">)</span><br>
<span class="lineno"></span><span class="op" id="5710762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5710765">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="5710830">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5710896">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="5710951">type</span>&nbsp;<span class="ident" id="5710956">NoGoError</span>&nbsp;<span class="keyword" id="5710966">struct</span>&nbsp;<span class="op" id="5710973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5710976">Dir</span>&nbsp;<span class="builtintype" id="5710980">string</span><br>
<span class="lineno"></span><span class="op" id="5710987">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="5710990">func</span>&nbsp;<span class="op" id="5710995">(</span><span class="ident" id="5710996">e</span>&nbsp;<span class="op" id="5710998">*</span><span class="ident" id="5710999">NoGoError</span><span class="op" id="5711008">)</span>&nbsp;<span class="ident" id="5711010">Error</span><span class="op" id="5711015">(</span><span class="op" id="5711016">)</span>&nbsp;<span class="builtintype" id="5711018">string</span>&nbsp;<span class="op" id="5711025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711028">return</span>&nbsp;<span class="string" id="5711035">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="5711070">+</span>&nbsp;<span class="ident" id="5711072">e</span><span class="op" id="5711073">.</span><span class="ident" id="5711074">Dir</span><br>
<span class="lineno"></span><span class="op" id="5711078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="5711081">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="5711138">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="5711199">type</span>&nbsp;<span class="ident" id="5711204">MultiplePackageError</span>&nbsp;<span class="keyword" id="5711225">struct</span>&nbsp;<span class="op" id="5711232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711235">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5711244">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5711253">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711284">Packages</span>&nbsp;<span class="op" id="5711293">[</span><span class="op" id="5711294">]</span><span class="builtintype" id="5711295">string</span>&nbsp;<span class="comment" id="5711302">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711326">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5711335">[</span><span class="op" id="5711336">]</span><span class="builtintype" id="5711337">string</span>&nbsp;<span class="comment" id="5711344">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="5711406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5711409">func</span>&nbsp;<span class="op" id="5711414">(</span><span class="ident" id="5711415">e</span>&nbsp;<span class="op" id="5711417">*</span><span class="ident" id="5711418">MultiplePackageError</span><span class="op" id="5711438">)</span>&nbsp;<span class="ident" id="5711440">Error</span><span class="op" id="5711445">(</span><span class="op" id="5711446">)</span>&nbsp;<span class="builtintype" id="5711448">string</span>&nbsp;<span class="op" id="5711455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5711458">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711517">return</span>&nbsp;<span class="ident" id="5711524">fmt</span><span class="op" id="5711527">.</span><span class="ident" id="5711528">Sprintf</span><span class="op" id="5711535">(</span><span class="string" id="5711536">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5711578">,</span>&nbsp;<span class="ident" id="5711580">e</span><span class="op" id="5711581">.</span><span class="ident" id="5711582">Packages</span><span class="op" id="5711590">[</span><span class="num" id="5711591">0</span><span class="op" id="5711592">]</span><span class="op" id="5711593">,</span>&nbsp;<span class="ident" id="5711595">e</span><span class="op" id="5711596">.</span><span class="ident" id="5711597">Files</span><span class="op" id="5711602">[</span><span class="num" id="5711603">0</span><span class="op" id="5711604">]</span><span class="op" id="5711605">,</span>&nbsp;<span class="ident" id="5711607">e</span><span class="op" id="5711608">.</span><span class="ident" id="5711609">Packages</span><span class="op" id="5711617">[</span><span class="num" id="5711618">1</span><span class="op" id="5711619">]</span><span class="op" id="5711620">,</span>&nbsp;<span class="ident" id="5711622">e</span><span class="op" id="5711623">.</span><span class="ident" id="5711624">Files</span><span class="op" id="5711629">[</span><span class="num" id="5711630">1</span><span class="op" id="5711631">]</span><span class="op" id="5711632">,</span>&nbsp;<span class="ident" id="5711634">e</span><span class="op" id="5711635">.</span><span class="ident" id="5711636">Dir</span><span class="op" id="5711639">)</span><br>
<span class="lineno"></span><span class="op" id="5711641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5711644">func</span>&nbsp;<span class="ident" id="5711649">nameExt</span><span class="op" id="5711656">(</span><span class="ident" id="5711657">name</span>&nbsp;<span class="builtintype" id="5711662">string</span><span class="op" id="5711668">)</span>&nbsp;<span class="builtintype" id="5711670">string</span>&nbsp;<span class="op" id="5711677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5711680">i</span>&nbsp;<span class="op" id="5711682">:=</span>&nbsp;<span class="ident" id="5711685">strings</span><span class="op" id="5711692">.</span><span class="ident" id="5711693">LastIndex</span><span class="op" id="5711702">(</span><span class="ident" id="5711703">name</span><span class="op" id="5711707">,</span>&nbsp;<span class="string" id="5711709">&#34;.&#34;</span><span class="op" id="5711712">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711715">if</span>&nbsp;<span class="ident" id="5711718">i</span>&nbsp;<span class="op" id="5711720">&lt;</span>&nbsp;<span class="num" id="5711722">0</span>&nbsp;<span class="op" id="5711724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711728">return</span>&nbsp;<span class="string" id="5711735">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5711739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5711742">return</span>&nbsp;<span class="ident" id="5711749">name</span><span class="op" id="5711753">[</span><span class="ident" id="5711754">i</span><span class="op" id="5711755">:</span><span class="op" id="5711756">]</span><br>
<span class="lineno"></span><span class="op" id="5711758">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5711761">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="5711834">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5711903">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5711979">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="5712055">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="5712072">//</span><br>
<span class="lineno"></span><span class="comment" id="5712075">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5712149">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="5712195">//</span><br>
<span class="lineno">450</span><span class="comment" id="5712198">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="5712238">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="5712302">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="5712365">//</span><br>
<span class="lineno"></span><span class="comment" id="5712368">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="5712436">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="5712480">//</span><br>
<span class="lineno"></span><span class="keyword" id="5712483">func</span>&nbsp;<span class="op" id="5712488">(</span><span class="ident" id="5712489">ctxt</span>&nbsp;<span class="op" id="5712494">*</span><span class="ident" id="5712495">Context</span><span class="op" id="5712502">)</span>&nbsp;<span class="ident" id="5712504">Import</span><span class="op" id="5712510">(</span><span class="ident" id="5712511">path</span>&nbsp;<span class="builtintype" id="5712516">string</span><span class="op" id="5712522">,</span>&nbsp;<span class="ident" id="5712524">srcDir</span>&nbsp;<span class="builtintype" id="5712531">string</span><span class="op" id="5712537">,</span>&nbsp;<span class="ident" id="5712539">mode</span>&nbsp;<span class="ident" id="5712544">ImportMode</span><span class="op" id="5712554">)</span>&nbsp;<span class="op" id="5712556">(</span><span class="op" id="5712557">*</span><span class="ident" id="5712558">Package</span><span class="op" id="5712565">,</span>&nbsp;<span class="builtintype" id="5712567">error</span><span class="op" id="5712572">)</span>&nbsp;<span class="op" id="5712574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712577">p</span>&nbsp;<span class="op" id="5712579">:=</span>&nbsp;<span class="op" id="5712582">&amp;</span><span class="ident" id="5712583">Package</span><span class="op" id="5712590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712594">ImportPath</span><span class="op" id="5712604">:</span>&nbsp;<span class="ident" id="5712606">path</span><span class="op" id="5712610">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712616">if</span>&nbsp;<span class="ident" id="5712619">path</span>&nbsp;<span class="op" id="5712624">==</span>&nbsp;<span class="string" id="5712627">&#34;&#34;</span>&nbsp;<span class="op" id="5712630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712634">return</span>&nbsp;<span class="ident" id="5712641">p</span><span class="op" id="5712642">,</span>&nbsp;<span class="ident" id="5712644">fmt</span><span class="op" id="5712647">.</span><span class="ident" id="5712648">Errorf</span><span class="op" id="5712654">(</span><span class="string" id="5712655">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="5712687">,</span>&nbsp;<span class="ident" id="5712689">path</span><span class="op" id="5712693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5712696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712700">var</span>&nbsp;<span class="ident" id="5712704">pkga</span>&nbsp;<span class="builtintype" id="5712709">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712717">var</span>&nbsp;<span class="ident" id="5712721">pkgerr</span>&nbsp;<span class="builtintype" id="5712728">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712735">switch</span>&nbsp;<span class="ident" id="5712742">ctxt</span><span class="op" id="5712746">.</span><span class="ident" id="5712747">Compiler</span>&nbsp;<span class="op" id="5712756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712759">case</span>&nbsp;<span class="string" id="5712764">&#34;gccgo&#34;</span><span class="op" id="5712771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712775">dir</span><span class="op" id="5712778">,</span>&nbsp;<span class="ident" id="5712780">elem</span>&nbsp;<span class="op" id="5712785">:=</span>&nbsp;<span class="ident" id="5712788">pathpkg</span><span class="op" id="5712795">.</span><span class="ident" id="5712796">Split</span><span class="op" id="5712801">(</span><span class="ident" id="5712802">p</span><span class="op" id="5712803">.</span><span class="ident" id="5712804">ImportPath</span><span class="op" id="5712814">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712818">pkga</span>&nbsp;<span class="op" id="5712823">=</span>&nbsp;<span class="string" id="5712825">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="5712838">+</span>&nbsp;<span class="ident" id="5712840">ctxt</span><span class="op" id="5712844">.</span><span class="ident" id="5712845">GOOS</span>&nbsp;<span class="op" id="5712850">+</span>&nbsp;<span class="string" id="5712852">&#34;_&#34;</span>&nbsp;<span class="op" id="5712856">+</span>&nbsp;<span class="ident" id="5712858">ctxt</span><span class="op" id="5712862">.</span><span class="ident" id="5712863">GOARCH</span>&nbsp;<span class="op" id="5712870">+</span>&nbsp;<span class="string" id="5712872">&#34;/&#34;</span>&nbsp;<span class="op" id="5712876">+</span>&nbsp;<span class="ident" id="5712878">dir</span>&nbsp;<span class="op" id="5712882">+</span>&nbsp;<span class="string" id="5712884">&#34;lib&#34;</span>&nbsp;<span class="op" id="5712890">+</span>&nbsp;<span class="ident" id="5712892">elem</span>&nbsp;<span class="op" id="5712897">+</span>&nbsp;<span class="string" id="5712899">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712905">case</span>&nbsp;<span class="string" id="5712910">&#34;gc&#34;</span><span class="op" id="5712914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712918">suffix</span>&nbsp;<span class="op" id="5712925">:=</span>&nbsp;<span class="string" id="5712928">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5712933">if</span>&nbsp;<span class="ident" id="5712936">ctxt</span><span class="op" id="5712940">.</span><span class="ident" id="5712941">InstallSuffix</span>&nbsp;<span class="op" id="5712955">!=</span>&nbsp;<span class="string" id="5712958">&#34;&#34;</span>&nbsp;<span class="op" id="5712961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5712966">suffix</span>&nbsp;<span class="op" id="5712973">=</span>&nbsp;<span class="string" id="5712975">&#34;_&#34;</span>&nbsp;<span class="op" id="5712979">+</span>&nbsp;<span class="ident" id="5712981">ctxt</span><span class="op" id="5712985">.</span><span class="ident" id="5712986">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713006">pkga</span>&nbsp;<span class="op" id="5713011">=</span>&nbsp;<span class="string" id="5713013">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="5713020">+</span>&nbsp;<span class="ident" id="5713022">ctxt</span><span class="op" id="5713026">.</span><span class="ident" id="5713027">GOOS</span>&nbsp;<span class="op" id="5713032">+</span>&nbsp;<span class="string" id="5713034">&#34;_&#34;</span>&nbsp;<span class="op" id="5713038">+</span>&nbsp;<span class="ident" id="5713040">ctxt</span><span class="op" id="5713044">.</span><span class="ident" id="5713045">GOARCH</span>&nbsp;<span class="op" id="5713052">+</span>&nbsp;<span class="ident" id="5713054">suffix</span>&nbsp;<span class="op" id="5713061">+</span>&nbsp;<span class="string" id="5713063">&#34;/&#34;</span>&nbsp;<span class="op" id="5713067">+</span>&nbsp;<span class="ident" id="5713069">p</span><span class="op" id="5713070">.</span><span class="ident" id="5713071">ImportPath</span>&nbsp;<span class="op" id="5713082">+</span>&nbsp;<span class="string" id="5713084">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713090">default</span><span class="op" id="5713097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713101">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713138">pkgerr</span>&nbsp;<span class="op" id="5713145">=</span>&nbsp;<span class="ident" id="5713147">fmt</span><span class="op" id="5713150">.</span><span class="ident" id="5713151">Errorf</span><span class="op" id="5713157">(</span><span class="string" id="5713158">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="5713190">,</span>&nbsp;<span class="ident" id="5713192">path</span><span class="op" id="5713196">,</span>&nbsp;<span class="ident" id="5713198">ctxt</span><span class="op" id="5713202">.</span><span class="ident" id="5713203">Compiler</span><span class="op" id="5713211">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713218">binaryOnly</span>&nbsp;<span class="op" id="5713229">:=</span>&nbsp;<span class="builtintype" id="5713232">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713239">if</span>&nbsp;<span class="ident" id="5713242">IsLocalImport</span><span class="op" id="5713255">(</span><span class="ident" id="5713256">path</span><span class="op" id="5713260">)</span>&nbsp;<span class="op" id="5713262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713266">pkga</span>&nbsp;<span class="op" id="5713271">=</span>&nbsp;<span class="string" id="5713273">&#34;&#34;</span>&nbsp;<span class="comment" id="5713276">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713318">if</span>&nbsp;<span class="ident" id="5713321">srcDir</span>&nbsp;<span class="op" id="5713328">==</span>&nbsp;<span class="string" id="5713331">&#34;&#34;</span>&nbsp;<span class="op" id="5713334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713339">return</span>&nbsp;<span class="ident" id="5713346">p</span><span class="op" id="5713347">,</span>&nbsp;<span class="ident" id="5713349">fmt</span><span class="op" id="5713352">.</span><span class="ident" id="5713353">Errorf</span><span class="op" id="5713359">(</span><span class="string" id="5713360">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="5713409">,</span>&nbsp;<span class="ident" id="5713411">path</span><span class="op" id="5713415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713423">if</span>&nbsp;<span class="op" id="5713426">!</span><span class="ident" id="5713427">ctxt</span><span class="op" id="5713431">.</span><span class="ident" id="5713432">isAbsPath</span><span class="op" id="5713441">(</span><span class="ident" id="5713442">path</span><span class="op" id="5713446">)</span>&nbsp;<span class="op" id="5713448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713453">p</span><span class="op" id="5713454">.</span><span class="ident" id="5713455">Dir</span>&nbsp;<span class="op" id="5713459">=</span>&nbsp;<span class="ident" id="5713461">ctxt</span><span class="op" id="5713465">.</span><span class="ident" id="5713466">joinPath</span><span class="op" id="5713474">(</span><span class="ident" id="5713475">srcDir</span><span class="op" id="5713481">,</span>&nbsp;<span class="ident" id="5713483">path</span><span class="op" id="5713487">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713495">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713541">if</span>&nbsp;<span class="ident" id="5713544">ctxt</span><span class="op" id="5713548">.</span><span class="ident" id="5713549">GOROOT</span>&nbsp;<span class="op" id="5713556">!=</span>&nbsp;<span class="string" id="5713559">&#34;&#34;</span>&nbsp;<span class="op" id="5713562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713567">root</span>&nbsp;<span class="op" id="5713572">:=</span>&nbsp;<span class="ident" id="5713575">ctxt</span><span class="op" id="5713579">.</span><span class="ident" id="5713580">joinPath</span><span class="op" id="5713588">(</span><span class="ident" id="5713589">ctxt</span><span class="op" id="5713593">.</span><span class="ident" id="5713594">GOROOT</span><span class="op" id="5713600">,</span>&nbsp;<span class="string" id="5713602">&#34;src&#34;</span><span class="op" id="5713607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713612">if</span>&nbsp;<span class="ident" id="5713615">sub</span><span class="op" id="5713618">,</span>&nbsp;<span class="ident" id="5713620">ok</span>&nbsp;<span class="op" id="5713623">:=</span>&nbsp;<span class="ident" id="5713626">ctxt</span><span class="op" id="5713630">.</span><span class="ident" id="5713631">hasSubdir</span><span class="op" id="5713640">(</span><span class="ident" id="5713641">root</span><span class="op" id="5713645">,</span>&nbsp;<span class="ident" id="5713647">p</span><span class="op" id="5713648">.</span><span class="ident" id="5713649">Dir</span><span class="op" id="5713652">)</span><span class="op" id="5713653">;</span>&nbsp;<span class="ident" id="5713655">ok</span>&nbsp;<span class="op" id="5713658">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713664">p</span><span class="op" id="5713665">.</span><span class="ident" id="5713666">Goroot</span>&nbsp;<span class="op" id="5713673">=</span>&nbsp;<span class="builtintype" id="5713675">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713684">p</span><span class="op" id="5713685">.</span><span class="ident" id="5713686">ImportPath</span>&nbsp;<span class="op" id="5713697">=</span>&nbsp;<span class="ident" id="5713699">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713707">p</span><span class="op" id="5713708">.</span><span class="ident" id="5713709">Root</span>&nbsp;<span class="op" id="5713714">=</span>&nbsp;<span class="ident" id="5713716">ctxt</span><span class="op" id="5713720">.</span><span class="ident" id="5713721">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713732">goto</span>&nbsp;<span class="ident" id="5713737">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713746">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5713750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713754">all</span>&nbsp;<span class="op" id="5713758">:=</span>&nbsp;<span class="ident" id="5713761">ctxt</span><span class="op" id="5713765">.</span><span class="ident" id="5713766">gopath</span><span class="op" id="5713772">(</span><span class="op" id="5713773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713777">for</span>&nbsp;<span class="ident" id="5713781">i</span><span class="op" id="5713782">,</span>&nbsp;<span class="ident" id="5713784">root</span>&nbsp;<span class="op" id="5713789">:=</span>&nbsp;<span class="keyword" id="5713792">range</span>&nbsp;<span class="ident" id="5713798">all</span>&nbsp;<span class="op" id="5713802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5713807">rootsrc</span>&nbsp;<span class="op" id="5713815">:=</span>&nbsp;<span class="ident" id="5713818">ctxt</span><span class="op" id="5713822">.</span><span class="ident" id="5713823">joinPath</span><span class="op" id="5713831">(</span><span class="ident" id="5713832">root</span><span class="op" id="5713836">,</span>&nbsp;<span class="string" id="5713838">&#34;src&#34;</span><span class="op" id="5713843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5713848">if</span>&nbsp;<span class="ident" id="5713851">sub</span><span class="op" id="5713854">,</span>&nbsp;<span class="ident" id="5713856">ok</span>&nbsp;<span class="op" id="5713859">:=</span>&nbsp;<span class="ident" id="5713862">ctxt</span><span class="op" id="5713866">.</span><span class="ident" id="5713867">hasSubdir</span><span class="op" id="5713876">(</span><span class="ident" id="5713877">rootsrc</span><span class="op" id="5713884">,</span>&nbsp;<span class="ident" id="5713886">p</span><span class="op" id="5713887">.</span><span class="ident" id="5713888">Dir</span><span class="op" id="5713891">)</span><span class="op" id="5713892">;</span>&nbsp;<span class="ident" id="5713894">ok</span>&nbsp;<span class="op" id="5713897">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713903">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5713952">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714007">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714026">if</span>&nbsp;<span class="ident" id="5714029">ctxt</span><span class="op" id="5714033">.</span><span class="ident" id="5714034">GOROOT</span>&nbsp;<span class="op" id="5714041">!=</span>&nbsp;<span class="string" id="5714044">&#34;&#34;</span>&nbsp;<span class="op" id="5714047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714054">if</span>&nbsp;<span class="ident" id="5714057">dir</span>&nbsp;<span class="op" id="5714061">:=</span>&nbsp;<span class="ident" id="5714064">ctxt</span><span class="op" id="5714068">.</span><span class="ident" id="5714069">joinPath</span><span class="op" id="5714077">(</span><span class="ident" id="5714078">ctxt</span><span class="op" id="5714082">.</span><span class="ident" id="5714083">GOROOT</span><span class="op" id="5714089">,</span>&nbsp;<span class="string" id="5714091">&#34;src&#34;</span><span class="op" id="5714096">,</span>&nbsp;<span class="ident" id="5714098">sub</span><span class="op" id="5714101">)</span><span class="op" id="5714102">;</span>&nbsp;<span class="ident" id="5714104">ctxt</span><span class="op" id="5714108">.</span><span class="ident" id="5714109">isDir</span><span class="op" id="5714114">(</span><span class="ident" id="5714115">dir</span><span class="op" id="5714118">)</span>&nbsp;<span class="op" id="5714120">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714128">p</span><span class="op" id="5714129">.</span><span class="ident" id="5714130">ConflictDir</span>&nbsp;<span class="op" id="5714142">=</span>&nbsp;<span class="ident" id="5714144">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714154">goto</span>&nbsp;<span class="ident" id="5714159">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714182">for</span>&nbsp;<span class="ident" id="5714186">_</span><span class="op" id="5714187">,</span>&nbsp;<span class="ident" id="5714189">earlyRoot</span>&nbsp;<span class="op" id="5714199">:=</span>&nbsp;<span class="keyword" id="5714202">range</span>&nbsp;<span class="ident" id="5714208">all</span><span class="op" id="5714211">[</span><span class="op" id="5714212">:</span><span class="ident" id="5714213">i</span><span class="op" id="5714214">]</span>&nbsp;<span class="op" id="5714216">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714223">if</span>&nbsp;<span class="ident" id="5714226">dir</span>&nbsp;<span class="op" id="5714230">:=</span>&nbsp;<span class="ident" id="5714233">ctxt</span><span class="op" id="5714237">.</span><span class="ident" id="5714238">joinPath</span><span class="op" id="5714246">(</span><span class="ident" id="5714247">earlyRoot</span><span class="op" id="5714256">,</span>&nbsp;<span class="string" id="5714258">&#34;src&#34;</span><span class="op" id="5714263">,</span>&nbsp;<span class="ident" id="5714265">sub</span><span class="op" id="5714268">)</span><span class="op" id="5714269">;</span>&nbsp;<span class="ident" id="5714271">ctxt</span><span class="op" id="5714275">.</span><span class="ident" id="5714276">isDir</span><span class="op" id="5714281">(</span><span class="ident" id="5714282">dir</span><span class="op" id="5714285">)</span>&nbsp;<span class="op" id="5714287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714295">p</span><span class="op" id="5714296">.</span><span class="ident" id="5714297">ConflictDir</span>&nbsp;<span class="op" id="5714309">=</span>&nbsp;<span class="ident" id="5714311">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714321">goto</span>&nbsp;<span class="ident" id="5714326">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714343">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714350">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714418">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714436">p</span><span class="op" id="5714437">.</span><span class="ident" id="5714438">ImportPath</span>&nbsp;<span class="op" id="5714449">=</span>&nbsp;<span class="ident" id="5714451">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714459">p</span><span class="op" id="5714460">.</span><span class="ident" id="5714461">Root</span>&nbsp;<span class="op" id="5714466">=</span>&nbsp;<span class="ident" id="5714468">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714477">goto</span>&nbsp;<span class="ident" id="5714482">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714499">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714557">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714602">}</span>&nbsp;<span class="keyword" id="5714604">else</span>&nbsp;<span class="op" id="5714609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714613">if</span>&nbsp;<span class="ident" id="5714616">strings</span><span class="op" id="5714623">.</span><span class="ident" id="5714624">HasPrefix</span><span class="op" id="5714633">(</span><span class="ident" id="5714634">path</span><span class="op" id="5714638">,</span>&nbsp;<span class="string" id="5714640">&#34;/&#34;</span><span class="op" id="5714643">)</span>&nbsp;<span class="op" id="5714645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714650">return</span>&nbsp;<span class="ident" id="5714657">p</span><span class="op" id="5714658">,</span>&nbsp;<span class="ident" id="5714660">fmt</span><span class="op" id="5714663">.</span><span class="ident" id="5714664">Errorf</span><span class="op" id="5714670">(</span><span class="string" id="5714671">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="5714711">,</span>&nbsp;<span class="ident" id="5714713">path</span><span class="op" id="5714717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714726">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714790">var</span>&nbsp;<span class="ident" id="5714794">tried</span>&nbsp;<span class="keyword" id="5714800">struct</span>&nbsp;<span class="op" id="5714807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714812">goroot</span>&nbsp;<span class="builtintype" id="5714819">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714829">gopath</span>&nbsp;<span class="op" id="5714836">[</span><span class="op" id="5714837">]</span><span class="builtintype" id="5714838">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5714847">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714852">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714895">if</span>&nbsp;<span class="ident" id="5714898">ctxt</span><span class="op" id="5714902">.</span><span class="ident" id="5714903">GOROOT</span>&nbsp;<span class="op" id="5714910">!=</span>&nbsp;<span class="string" id="5714913">&#34;&#34;</span>&nbsp;<span class="op" id="5714916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714921">dir</span>&nbsp;<span class="op" id="5714925">:=</span>&nbsp;<span class="ident" id="5714928">ctxt</span><span class="op" id="5714932">.</span><span class="ident" id="5714933">joinPath</span><span class="op" id="5714941">(</span><span class="ident" id="5714942">ctxt</span><span class="op" id="5714946">.</span><span class="ident" id="5714947">GOROOT</span><span class="op" id="5714953">,</span>&nbsp;<span class="string" id="5714955">&#34;src&#34;</span><span class="op" id="5714960">,</span>&nbsp;<span class="ident" id="5714962">path</span><span class="op" id="5714966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714971">isDir</span>&nbsp;<span class="op" id="5714977">:=</span>&nbsp;<span class="ident" id="5714980">ctxt</span><span class="op" id="5714984">.</span><span class="ident" id="5714985">isDir</span><span class="op" id="5714990">(</span><span class="ident" id="5714991">dir</span><span class="op" id="5714994">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714999">binaryOnly</span>&nbsp;<span class="op" id="5715010">=</span>&nbsp;<span class="op" id="5715012">!</span><span class="ident" id="5715013">isDir</span>&nbsp;<span class="op" id="5715019">&amp;&amp;</span>&nbsp;<span class="ident" id="5715022">mode</span><span class="op" id="5715026">&amp;</span><span class="ident" id="5715027">AllowBinary</span>&nbsp;<span class="op" id="5715039">!=</span>&nbsp;<span class="num" id="5715042">0</span>&nbsp;<span class="op" id="5715044">&amp;&amp;</span>&nbsp;<span class="ident" id="5715047">pkga</span>&nbsp;<span class="op" id="5715052">!=</span>&nbsp;<span class="string" id="5715055">&#34;&#34;</span>&nbsp;<span class="op" id="5715058">&amp;&amp;</span>&nbsp;<span class="ident" id="5715061">ctxt</span><span class="op" id="5715065">.</span><span class="ident" id="5715066">isFile</span><span class="op" id="5715072">(</span><span class="ident" id="5715073">ctxt</span><span class="op" id="5715077">.</span><span class="ident" id="5715078">joinPath</span><span class="op" id="5715086">(</span><span class="ident" id="5715087">ctxt</span><span class="op" id="5715091">.</span><span class="ident" id="5715092">GOROOT</span><span class="op" id="5715098">,</span>&nbsp;<span class="ident" id="5715100">pkga</span><span class="op" id="5715104">)</span><span class="op" id="5715105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715110">if</span>&nbsp;<span class="ident" id="5715113">isDir</span>&nbsp;<span class="op" id="5715119">||</span>&nbsp;<span class="ident" id="5715122">binaryOnly</span>&nbsp;<span class="op" id="5715133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715139">p</span><span class="op" id="5715140">.</span><span class="ident" id="5715141">Dir</span>&nbsp;<span class="op" id="5715145">=</span>&nbsp;<span class="ident" id="5715147">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715155">p</span><span class="op" id="5715156">.</span><span class="ident" id="5715157">Goroot</span>&nbsp;<span class="op" id="5715164">=</span>&nbsp;<span class="builtintype" id="5715166">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715175">p</span><span class="op" id="5715176">.</span><span class="ident" id="5715177">Root</span>&nbsp;<span class="op" id="5715182">=</span>&nbsp;<span class="ident" id="5715184">ctxt</span><span class="op" id="5715188">.</span><span class="ident" id="5715189">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715200">goto</span>&nbsp;<span class="ident" id="5715205">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715219">tried</span><span class="op" id="5715224">.</span><span class="ident" id="5715225">goroot</span>&nbsp;<span class="op" id="5715232">=</span>&nbsp;<span class="ident" id="5715234">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715244">for</span>&nbsp;<span class="ident" id="5715248">_</span><span class="op" id="5715249">,</span>&nbsp;<span class="ident" id="5715251">root</span>&nbsp;<span class="op" id="5715256">:=</span>&nbsp;<span class="keyword" id="5715259">range</span>&nbsp;<span class="ident" id="5715265">ctxt</span><span class="op" id="5715269">.</span><span class="ident" id="5715270">gopath</span><span class="op" id="5715276">(</span><span class="op" id="5715277">)</span>&nbsp;<span class="op" id="5715279">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715284">dir</span>&nbsp;<span class="op" id="5715288">:=</span>&nbsp;<span class="ident" id="5715291">ctxt</span><span class="op" id="5715295">.</span><span class="ident" id="5715296">joinPath</span><span class="op" id="5715304">(</span><span class="ident" id="5715305">root</span><span class="op" id="5715309">,</span>&nbsp;<span class="string" id="5715311">&#34;src&#34;</span><span class="op" id="5715316">,</span>&nbsp;<span class="ident" id="5715318">path</span><span class="op" id="5715322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715327">isDir</span>&nbsp;<span class="op" id="5715333">:=</span>&nbsp;<span class="ident" id="5715336">ctxt</span><span class="op" id="5715340">.</span><span class="ident" id="5715341">isDir</span><span class="op" id="5715346">(</span><span class="ident" id="5715347">dir</span><span class="op" id="5715350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715355">binaryOnly</span>&nbsp;<span class="op" id="5715366">=</span>&nbsp;<span class="op" id="5715368">!</span><span class="ident" id="5715369">isDir</span>&nbsp;<span class="op" id="5715375">&amp;&amp;</span>&nbsp;<span class="ident" id="5715378">mode</span><span class="op" id="5715382">&amp;</span><span class="ident" id="5715383">AllowBinary</span>&nbsp;<span class="op" id="5715395">!=</span>&nbsp;<span class="num" id="5715398">0</span>&nbsp;<span class="op" id="5715400">&amp;&amp;</span>&nbsp;<span class="ident" id="5715403">pkga</span>&nbsp;<span class="op" id="5715408">!=</span>&nbsp;<span class="string" id="5715411">&#34;&#34;</span>&nbsp;<span class="op" id="5715414">&amp;&amp;</span>&nbsp;<span class="ident" id="5715417">ctxt</span><span class="op" id="5715421">.</span><span class="ident" id="5715422">isFile</span><span class="op" id="5715428">(</span><span class="ident" id="5715429">ctxt</span><span class="op" id="5715433">.</span><span class="ident" id="5715434">joinPath</span><span class="op" id="5715442">(</span><span class="ident" id="5715443">root</span><span class="op" id="5715447">,</span>&nbsp;<span class="ident" id="5715449">pkga</span><span class="op" id="5715453">)</span><span class="op" id="5715454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715459">if</span>&nbsp;<span class="ident" id="5715462">isDir</span>&nbsp;<span class="op" id="5715468">||</span>&nbsp;<span class="ident" id="5715471">binaryOnly</span>&nbsp;<span class="op" id="5715482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715488">p</span><span class="op" id="5715489">.</span><span class="ident" id="5715490">Dir</span>&nbsp;<span class="op" id="5715494">=</span>&nbsp;<span class="ident" id="5715496">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715504">p</span><span class="op" id="5715505">.</span><span class="ident" id="5715506">Root</span>&nbsp;<span class="op" id="5715511">=</span>&nbsp;<span class="ident" id="5715513">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715522">goto</span>&nbsp;<span class="ident" id="5715527">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715541">tried</span><span class="op" id="5715546">.</span><span class="ident" id="5715547">gopath</span>&nbsp;<span class="op" id="5715554">=</span>&nbsp;<span class="builtinfunc" id="5715556">append</span><span class="op" id="5715562">(</span><span class="ident" id="5715563">tried</span><span class="op" id="5715568">.</span><span class="ident" id="5715569">gopath</span><span class="op" id="5715575">,</span>&nbsp;<span class="ident" id="5715577">dir</span><span class="op" id="5715580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715584">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715589">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715616">var</span>&nbsp;<span class="ident" id="5715620">paths</span>&nbsp;<span class="op" id="5715626">[</span><span class="op" id="5715627">]</span><span class="builtintype" id="5715628">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715637">if</span>&nbsp;<span class="ident" id="5715640">tried</span><span class="op" id="5715645">.</span><span class="ident" id="5715646">goroot</span>&nbsp;<span class="op" id="5715653">!=</span>&nbsp;<span class="string" id="5715656">&#34;&#34;</span>&nbsp;<span class="op" id="5715659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715664">paths</span>&nbsp;<span class="op" id="5715670">=</span>&nbsp;<span class="builtinfunc" id="5715672">append</span><span class="op" id="5715678">(</span><span class="ident" id="5715679">paths</span><span class="op" id="5715684">,</span>&nbsp;<span class="ident" id="5715686">fmt</span><span class="op" id="5715689">.</span><span class="ident" id="5715690">Sprintf</span><span class="op" id="5715697">(</span><span class="string" id="5715698">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="5715719">,</span>&nbsp;<span class="ident" id="5715721">tried</span><span class="op" id="5715726">.</span><span class="ident" id="5715727">goroot</span><span class="op" id="5715733">)</span><span class="op" id="5715734">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715738">}</span>&nbsp;<span class="keyword" id="5715740">else</span>&nbsp;<span class="op" id="5715745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715750">paths</span>&nbsp;<span class="op" id="5715756">=</span>&nbsp;<span class="builtinfunc" id="5715758">append</span><span class="op" id="5715764">(</span><span class="ident" id="5715765">paths</span><span class="op" id="5715770">,</span>&nbsp;<span class="string" id="5715772">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5715793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715801">var</span>&nbsp;<span class="ident" id="5715805">i</span>&nbsp;<span class="builtintype" id="5715807">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715813">var</span>&nbsp;<span class="ident" id="5715817">format</span>&nbsp;<span class="op" id="5715824">=</span>&nbsp;<span class="string" id="5715826">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715850">for</span>&nbsp;<span class="op" id="5715854">;</span>&nbsp;<span class="ident" id="5715856">i</span>&nbsp;<span class="op" id="5715858">&lt;</span>&nbsp;<span class="builtinfunc" id="5715860">len</span><span class="op" id="5715863">(</span><span class="ident" id="5715864">tried</span><span class="op" id="5715869">.</span><span class="ident" id="5715870">gopath</span><span class="op" id="5715876">)</span><span class="op" id="5715877">;</span>&nbsp;<span class="ident" id="5715879">i</span><span class="op" id="5715880">++</span>&nbsp;<span class="op" id="5715883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715888">if</span>&nbsp;<span class="ident" id="5715891">i</span>&nbsp;<span class="op" id="5715893">&gt;</span>&nbsp;<span class="num" id="5715895">0</span>&nbsp;<span class="op" id="5715897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715903">format</span>&nbsp;<span class="op" id="5715910">=</span>&nbsp;<span class="string" id="5715912">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715927">paths</span>&nbsp;<span class="op" id="5715933">=</span>&nbsp;<span class="builtinfunc" id="5715935">append</span><span class="op" id="5715941">(</span><span class="ident" id="5715942">paths</span><span class="op" id="5715947">,</span>&nbsp;<span class="ident" id="5715949">fmt</span><span class="op" id="5715952">.</span><span class="ident" id="5715953">Sprintf</span><span class="op" id="5715960">(</span><span class="ident" id="5715961">format</span><span class="op" id="5715967">,</span>&nbsp;<span class="ident" id="5715969">tried</span><span class="op" id="5715974">.</span><span class="ident" id="5715975">gopath</span><span class="op" id="5715981">[</span><span class="ident" id="5715982">i</span><span class="op" id="5715983">]</span><span class="op" id="5715984">)</span><span class="op" id="5715985">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715993">if</span>&nbsp;<span class="ident" id="5715996">i</span>&nbsp;<span class="op" id="5715998">==</span>&nbsp;<span class="num" id="5716001">0</span>&nbsp;<span class="op" id="5716003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716008">paths</span>&nbsp;<span class="op" id="5716014">=</span>&nbsp;<span class="builtinfunc" id="5716016">append</span><span class="op" id="5716022">(</span><span class="ident" id="5716023">paths</span><span class="op" id="5716028">,</span>&nbsp;<span class="string" id="5716030">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5716051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716059">return</span>&nbsp;<span class="ident" id="5716066">p</span><span class="op" id="5716067">,</span>&nbsp;<span class="ident" id="5716069">fmt</span><span class="op" id="5716072">.</span><span class="ident" id="5716073">Errorf</span><span class="op" id="5716079">(</span><span class="string" id="5716080">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="5716119">,</span>&nbsp;<span class="ident" id="5716121">path</span><span class="op" id="5716125">,</span>&nbsp;<span class="ident" id="5716127">strings</span><span class="op" id="5716134">.</span><span class="ident" id="5716135">Join</span><span class="op" id="5716139">(</span><span class="ident" id="5716140">paths</span><span class="op" id="5716145">,</span>&nbsp;<span class="string" id="5716147">&#34;\n&#34;</span><span class="op" id="5716151">)</span><span class="op" id="5716152">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5716158">Found</span><span class="op" id="5716163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716166">if</span>&nbsp;<span class="ident" id="5716169">p</span><span class="op" id="5716170">.</span><span class="ident" id="5716171">Root</span>&nbsp;<span class="op" id="5716176">!=</span>&nbsp;<span class="string" id="5716179">&#34;&#34;</span>&nbsp;<span class="op" id="5716182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716186">p</span><span class="op" id="5716187">.</span><span class="ident" id="5716188">SrcRoot</span>&nbsp;<span class="op" id="5716196">=</span>&nbsp;<span class="ident" id="5716198">ctxt</span><span class="op" id="5716202">.</span><span class="ident" id="5716203">joinPath</span><span class="op" id="5716211">(</span><span class="ident" id="5716212">p</span><span class="op" id="5716213">.</span><span class="ident" id="5716214">Root</span><span class="op" id="5716218">,</span>&nbsp;<span class="string" id="5716220">&#34;src&#34;</span><span class="op" id="5716225">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716229">p</span><span class="op" id="5716230">.</span><span class="ident" id="5716231">PkgRoot</span>&nbsp;<span class="op" id="5716239">=</span>&nbsp;<span class="ident" id="5716241">ctxt</span><span class="op" id="5716245">.</span><span class="ident" id="5716246">joinPath</span><span class="op" id="5716254">(</span><span class="ident" id="5716255">p</span><span class="op" id="5716256">.</span><span class="ident" id="5716257">Root</span><span class="op" id="5716261">,</span>&nbsp;<span class="string" id="5716263">&#34;pkg&#34;</span><span class="op" id="5716268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716272">p</span><span class="op" id="5716273">.</span><span class="ident" id="5716274">BinDir</span>&nbsp;<span class="op" id="5716281">=</span>&nbsp;<span class="ident" id="5716283">ctxt</span><span class="op" id="5716287">.</span><span class="ident" id="5716288">joinPath</span><span class="op" id="5716296">(</span><span class="ident" id="5716297">p</span><span class="op" id="5716298">.</span><span class="ident" id="5716299">Root</span><span class="op" id="5716303">,</span>&nbsp;<span class="string" id="5716305">&#34;bin&#34;</span><span class="op" id="5716310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716314">if</span>&nbsp;<span class="ident" id="5716317">pkga</span>&nbsp;<span class="op" id="5716322">!=</span>&nbsp;<span class="string" id="5716325">&#34;&#34;</span>&nbsp;<span class="op" id="5716328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716333">p</span><span class="op" id="5716334">.</span><span class="ident" id="5716335">PkgObj</span>&nbsp;<span class="op" id="5716342">=</span>&nbsp;<span class="ident" id="5716344">ctxt</span><span class="op" id="5716348">.</span><span class="ident" id="5716349">joinPath</span><span class="op" id="5716357">(</span><span class="ident" id="5716358">p</span><span class="op" id="5716359">.</span><span class="ident" id="5716360">Root</span><span class="op" id="5716364">,</span>&nbsp;<span class="ident" id="5716366">pkga</span><span class="op" id="5716370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716374">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716381">if</span>&nbsp;<span class="ident" id="5716384">mode</span><span class="op" id="5716388">&amp;</span><span class="ident" id="5716389">FindOnly</span>&nbsp;<span class="op" id="5716398">!=</span>&nbsp;<span class="num" id="5716401">0</span>&nbsp;<span class="op" id="5716403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716407">return</span>&nbsp;<span class="ident" id="5716414">p</span><span class="op" id="5716415">,</span>&nbsp;<span class="ident" id="5716417">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716425">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716428">if</span>&nbsp;<span class="ident" id="5716431">binaryOnly</span>&nbsp;<span class="op" id="5716442">&amp;&amp;</span>&nbsp;<span class="op" id="5716445">(</span><span class="ident" id="5716446">mode</span><span class="op" id="5716450">&amp;</span><span class="ident" id="5716451">AllowBinary</span><span class="op" id="5716462">)</span>&nbsp;<span class="op" id="5716464">!=</span>&nbsp;<span class="num" id="5716467">0</span>&nbsp;<span class="op" id="5716469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716473">return</span>&nbsp;<span class="ident" id="5716480">p</span><span class="op" id="5716481">,</span>&nbsp;<span class="ident" id="5716483">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716495">dirs</span><span class="op" id="5716499">,</span>&nbsp;<span class="ident" id="5716501">err</span>&nbsp;<span class="op" id="5716505">:=</span>&nbsp;<span class="ident" id="5716508">ctxt</span><span class="op" id="5716512">.</span><span class="ident" id="5716513">readDir</span><span class="op" id="5716520">(</span><span class="ident" id="5716521">p</span><span class="op" id="5716522">.</span><span class="ident" id="5716523">Dir</span><span class="op" id="5716526">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716529">if</span>&nbsp;<span class="ident" id="5716532">err</span>&nbsp;<span class="op" id="5716536">!=</span>&nbsp;<span class="ident" id="5716539">nil</span>&nbsp;<span class="op" id="5716543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716547">return</span>&nbsp;<span class="ident" id="5716554">p</span><span class="op" id="5716555">,</span>&nbsp;<span class="ident" id="5716557">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716566">var</span>&nbsp;<span class="ident" id="5716570">Sfiles</span>&nbsp;<span class="op" id="5716577">[</span><span class="op" id="5716578">]</span><span class="builtintype" id="5716579">string</span>&nbsp;<span class="comment" id="5716586">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716618">var</span>&nbsp;<span class="ident" id="5716622">firstFile</span><span class="op" id="5716631">,</span>&nbsp;<span class="ident" id="5716633">firstCommentFile</span>&nbsp;<span class="builtintype" id="5716650">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716658">imported</span>&nbsp;<span class="op" id="5716667">:=</span>&nbsp;<span class="builtinfunc" id="5716670">make</span><span class="op" id="5716674">(</span><span class="keyword" id="5716675">map</span><span class="op" id="5716678">[</span><span class="builtintype" id="5716679">string</span><span class="op" id="5716685">]</span><span class="op" id="5716686">[</span><span class="op" id="5716687">]</span><span class="ident" id="5716688">token</span><span class="op" id="5716693">.</span><span class="ident" id="5716694">Position</span><span class="op" id="5716702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716705">testImported</span>&nbsp;<span class="op" id="5716718">:=</span>&nbsp;<span class="builtinfunc" id="5716721">make</span><span class="op" id="5716725">(</span><span class="keyword" id="5716726">map</span><span class="op" id="5716729">[</span><span class="builtintype" id="5716730">string</span><span class="op" id="5716736">]</span><span class="op" id="5716737">[</span><span class="op" id="5716738">]</span><span class="ident" id="5716739">token</span><span class="op" id="5716744">.</span><span class="ident" id="5716745">Position</span><span class="op" id="5716753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716756">xTestImported</span>&nbsp;<span class="op" id="5716770">:=</span>&nbsp;<span class="builtinfunc" id="5716773">make</span><span class="op" id="5716777">(</span><span class="keyword" id="5716778">map</span><span class="op" id="5716781">[</span><span class="builtintype" id="5716782">string</span><span class="op" id="5716788">]</span><span class="op" id="5716789">[</span><span class="op" id="5716790">]</span><span class="ident" id="5716791">token</span><span class="op" id="5716796">.</span><span class="ident" id="5716797">Position</span><span class="op" id="5716805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716808">allTags</span>&nbsp;<span class="op" id="5716816">:=</span>&nbsp;<span class="builtinfunc" id="5716819">make</span><span class="op" id="5716823">(</span><span class="keyword" id="5716824">map</span><span class="op" id="5716827">[</span><span class="builtintype" id="5716828">string</span><span class="op" id="5716834">]</span><span class="builtintype" id="5716835">bool</span><span class="op" id="5716839">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716842">fset</span>&nbsp;<span class="op" id="5716847">:=</span>&nbsp;<span class="ident" id="5716850">token</span><span class="op" id="5716855">.</span><span class="ident" id="5716856">NewFileSet</span><span class="op" id="5716866">(</span><span class="op" id="5716867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716870">for</span>&nbsp;<span class="ident" id="5716874">_</span><span class="op" id="5716875">,</span>&nbsp;<span class="ident" id="5716877">d</span>&nbsp;<span class="op" id="5716879">:=</span>&nbsp;<span class="keyword" id="5716882">range</span>&nbsp;<span class="ident" id="5716888">dirs</span>&nbsp;<span class="op" id="5716893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716897">if</span>&nbsp;<span class="ident" id="5716900">d</span><span class="op" id="5716901">.</span><span class="ident" id="5716902">IsDir</span><span class="op" id="5716907">(</span><span class="op" id="5716908">)</span>&nbsp;<span class="op" id="5716910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716915">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716926">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716931">name</span>&nbsp;<span class="op" id="5716936">:=</span>&nbsp;<span class="ident" id="5716939">d</span><span class="op" id="5716940">.</span><span class="ident" id="5716941">Name</span><span class="op" id="5716945">(</span><span class="op" id="5716946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716950">ext</span>&nbsp;<span class="op" id="5716954">:=</span>&nbsp;<span class="ident" id="5716957">nameExt</span><span class="op" id="5716964">(</span><span class="ident" id="5716965">name</span><span class="op" id="5716969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716974">match</span><span class="op" id="5716979">,</span>&nbsp;<span class="ident" id="5716981">data</span><span class="op" id="5716985">,</span>&nbsp;<span class="ident" id="5716987">filename</span><span class="op" id="5716995">,</span>&nbsp;<span class="ident" id="5716997">err</span>&nbsp;<span class="op" id="5717001">:=</span>&nbsp;<span class="ident" id="5717004">ctxt</span><span class="op" id="5717008">.</span><span class="ident" id="5717009">matchFile</span><span class="op" id="5717018">(</span><span class="ident" id="5717019">p</span><span class="op" id="5717020">.</span><span class="ident" id="5717021">Dir</span><span class="op" id="5717024">,</span>&nbsp;<span class="ident" id="5717026">name</span><span class="op" id="5717030">,</span>&nbsp;<span class="builtintype" id="5717032">true</span><span class="op" id="5717036">,</span>&nbsp;<span class="ident" id="5717038">allTags</span><span class="op" id="5717045">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717049">if</span>&nbsp;<span class="ident" id="5717052">err</span>&nbsp;<span class="op" id="5717056">!=</span>&nbsp;<span class="ident" id="5717059">nil</span>&nbsp;<span class="op" id="5717063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717068">return</span>&nbsp;<span class="ident" id="5717075">p</span><span class="op" id="5717076">,</span>&nbsp;<span class="ident" id="5717078">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717088">if</span>&nbsp;<span class="op" id="5717091">!</span><span class="ident" id="5717092">match</span>&nbsp;<span class="op" id="5717098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717103">if</span>&nbsp;<span class="ident" id="5717106">ext</span>&nbsp;<span class="op" id="5717110">==</span>&nbsp;<span class="string" id="5717113">&#34;.go&#34;</span>&nbsp;<span class="op" id="5717119">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717125">p</span><span class="op" id="5717126">.</span><span class="ident" id="5717127">IgnoredGoFiles</span>&nbsp;<span class="op" id="5717142">=</span>&nbsp;<span class="builtinfunc" id="5717144">append</span><span class="op" id="5717150">(</span><span class="ident" id="5717151">p</span><span class="op" id="5717152">.</span><span class="ident" id="5717153">IgnoredGoFiles</span><span class="op" id="5717167">,</span>&nbsp;<span class="ident" id="5717169">name</span><span class="op" id="5717173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717183">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717199">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717262">switch</span>&nbsp;<span class="ident" id="5717269">ext</span>&nbsp;<span class="op" id="5717273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717277">case</span>&nbsp;<span class="string" id="5717282">&#34;.c&#34;</span><span class="op" id="5717286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717291">p</span><span class="op" id="5717292">.</span><span class="ident" id="5717293">CFiles</span>&nbsp;<span class="op" id="5717300">=</span>&nbsp;<span class="builtinfunc" id="5717302">append</span><span class="op" id="5717308">(</span><span class="ident" id="5717309">p</span><span class="op" id="5717310">.</span><span class="ident" id="5717311">CFiles</span><span class="op" id="5717317">,</span>&nbsp;<span class="ident" id="5717319">name</span><span class="op" id="5717323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717328">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717339">case</span>&nbsp;<span class="string" id="5717344">&#34;.cc&#34;</span><span class="op" id="5717349">,</span>&nbsp;<span class="string" id="5717351">&#34;.cpp&#34;</span><span class="op" id="5717357">,</span>&nbsp;<span class="string" id="5717359">&#34;.cxx&#34;</span><span class="op" id="5717365">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717370">p</span><span class="op" id="5717371">.</span><span class="ident" id="5717372">CXXFiles</span>&nbsp;<span class="op" id="5717381">=</span>&nbsp;<span class="builtinfunc" id="5717383">append</span><span class="op" id="5717389">(</span><span class="ident" id="5717390">p</span><span class="op" id="5717391">.</span><span class="ident" id="5717392">CXXFiles</span><span class="op" id="5717400">,</span>&nbsp;<span class="ident" id="5717402">name</span><span class="op" id="5717406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717411">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717422">case</span>&nbsp;<span class="string" id="5717427">&#34;.m&#34;</span><span class="op" id="5717431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717436">p</span><span class="op" id="5717437">.</span><span class="ident" id="5717438">MFiles</span>&nbsp;<span class="op" id="5717445">=</span>&nbsp;<span class="builtinfunc" id="5717447">append</span><span class="op" id="5717453">(</span><span class="ident" id="5717454">p</span><span class="op" id="5717455">.</span><span class="ident" id="5717456">MFiles</span><span class="op" id="5717462">,</span>&nbsp;<span class="ident" id="5717464">name</span><span class="op" id="5717468">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717473">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717484">case</span>&nbsp;<span class="string" id="5717489">&#34;.h&#34;</span><span class="op" id="5717493">,</span>&nbsp;<span class="string" id="5717495">&#34;.hh&#34;</span><span class="op" id="5717500">,</span>&nbsp;<span class="string" id="5717502">&#34;.hpp&#34;</span><span class="op" id="5717508">,</span>&nbsp;<span class="string" id="5717510">&#34;.hxx&#34;</span><span class="op" id="5717516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717521">p</span><span class="op" id="5717522">.</span><span class="ident" id="5717523">HFiles</span>&nbsp;<span class="op" id="5717530">=</span>&nbsp;<span class="builtinfunc" id="5717532">append</span><span class="op" id="5717538">(</span><span class="ident" id="5717539">p</span><span class="op" id="5717540">.</span><span class="ident" id="5717541">HFiles</span><span class="op" id="5717547">,</span>&nbsp;<span class="ident" id="5717549">name</span><span class="op" id="5717553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717558">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717569">case</span>&nbsp;<span class="string" id="5717574">&#34;.s&#34;</span><span class="op" id="5717578">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717583">p</span><span class="op" id="5717584">.</span><span class="ident" id="5717585">SFiles</span>&nbsp;<span class="op" id="5717592">=</span>&nbsp;<span class="builtinfunc" id="5717594">append</span><span class="op" id="5717600">(</span><span class="ident" id="5717601">p</span><span class="op" id="5717602">.</span><span class="ident" id="5717603">SFiles</span><span class="op" id="5717609">,</span>&nbsp;<span class="ident" id="5717611">name</span><span class="op" id="5717615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717620">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717631">case</span>&nbsp;<span class="string" id="5717636">&#34;.S&#34;</span><span class="op" id="5717640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717645">Sfiles</span>&nbsp;<span class="op" id="5717652">=</span>&nbsp;<span class="builtinfunc" id="5717654">append</span><span class="op" id="5717660">(</span><span class="ident" id="5717661">Sfiles</span><span class="op" id="5717667">,</span>&nbsp;<span class="ident" id="5717669">name</span><span class="op" id="5717673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717678">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717689">case</span>&nbsp;<span class="string" id="5717694">&#34;.swig&#34;</span><span class="op" id="5717701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717706">p</span><span class="op" id="5717707">.</span><span class="ident" id="5717708">SwigFiles</span>&nbsp;<span class="op" id="5717718">=</span>&nbsp;<span class="builtinfunc" id="5717720">append</span><span class="op" id="5717726">(</span><span class="ident" id="5717727">p</span><span class="op" id="5717728">.</span><span class="ident" id="5717729">SwigFiles</span><span class="op" id="5717738">,</span>&nbsp;<span class="ident" id="5717740">name</span><span class="op" id="5717744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717749">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717760">case</span>&nbsp;<span class="string" id="5717765">&#34;.swigcxx&#34;</span><span class="op" id="5717775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717780">p</span><span class="op" id="5717781">.</span><span class="ident" id="5717782">SwigCXXFiles</span>&nbsp;<span class="op" id="5717795">=</span>&nbsp;<span class="builtinfunc" id="5717797">append</span><span class="op" id="5717803">(</span><span class="ident" id="5717804">p</span><span class="op" id="5717805">.</span><span class="ident" id="5717806">SwigCXXFiles</span><span class="op" id="5717818">,</span>&nbsp;<span class="ident" id="5717820">name</span><span class="op" id="5717824">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717829">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717840">case</span>&nbsp;<span class="string" id="5717845">&#34;.syso&#34;</span><span class="op" id="5717852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717857">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717904">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717951">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718004">p</span><span class="op" id="5718005">.</span><span class="ident" id="5718006">SysoFiles</span>&nbsp;<span class="op" id="5718016">=</span>&nbsp;<span class="builtinfunc" id="5718018">append</span><span class="op" id="5718024">(</span><span class="ident" id="5718025">p</span><span class="op" id="5718026">.</span><span class="ident" id="5718027">SysoFiles</span><span class="op" id="5718036">,</span>&nbsp;<span class="ident" id="5718038">name</span><span class="op" id="5718042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718047">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718063">pf</span><span class="op" id="5718065">,</span>&nbsp;<span class="ident" id="5718067">err</span>&nbsp;<span class="op" id="5718071">:=</span>&nbsp;<span class="ident" id="5718074">parser</span><span class="op" id="5718080">.</span><span class="ident" id="5718081">ParseFile</span><span class="op" id="5718090">(</span><span class="ident" id="5718091">fset</span><span class="op" id="5718095">,</span>&nbsp;<span class="ident" id="5718097">filename</span><span class="op" id="5718105">,</span>&nbsp;<span class="ident" id="5718107">data</span><span class="op" id="5718111">,</span>&nbsp;<span class="ident" id="5718113">parser</span><span class="op" id="5718119">.</span><span class="ident" id="5718120">ImportsOnly</span><span class="op" id="5718131">|</span><span class="ident" id="5718132">parser</span><span class="op" id="5718138">.</span><span class="ident" id="5718139">ParseComments</span><span class="op" id="5718152">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718156">if</span>&nbsp;<span class="ident" id="5718159">err</span>&nbsp;<span class="op" id="5718163">!=</span>&nbsp;<span class="ident" id="5718166">nil</span>&nbsp;<span class="op" id="5718170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718175">return</span>&nbsp;<span class="ident" id="5718182">p</span><span class="op" id="5718183">,</span>&nbsp;<span class="ident" id="5718185">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718196">pkg</span>&nbsp;<span class="op" id="5718200">:=</span>&nbsp;<span class="ident" id="5718203">pf</span><span class="op" id="5718205">.</span><span class="ident" id="5718206">Name</span><span class="op" id="5718210">.</span><span class="ident" id="5718211">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718218">if</span>&nbsp;<span class="ident" id="5718221">pkg</span>&nbsp;<span class="op" id="5718225">==</span>&nbsp;<span class="string" id="5718228">&#34;documentation&#34;</span>&nbsp;<span class="op" id="5718244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718249">p</span><span class="op" id="5718250">.</span><span class="ident" id="5718251">IgnoredGoFiles</span>&nbsp;<span class="op" id="5718266">=</span>&nbsp;<span class="builtinfunc" id="5718268">append</span><span class="op" id="5718274">(</span><span class="ident" id="5718275">p</span><span class="op" id="5718276">.</span><span class="ident" id="5718277">IgnoredGoFiles</span><span class="op" id="5718291">,</span>&nbsp;<span class="ident" id="5718293">name</span><span class="op" id="5718297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718302">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718318">isTest</span>&nbsp;<span class="op" id="5718325">:=</span>&nbsp;<span class="ident" id="5718328">strings</span><span class="op" id="5718335">.</span><span class="ident" id="5718336">HasSuffix</span><span class="op" id="5718345">(</span><span class="ident" id="5718346">name</span><span class="op" id="5718350">,</span>&nbsp;<span class="string" id="5718352">&#34;_test.go&#34;</span><span class="op" id="5718362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718366">isXTest</span>&nbsp;<span class="op" id="5718374">:=</span>&nbsp;<span class="builtintype" id="5718377">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718385">if</span>&nbsp;<span class="ident" id="5718388">isTest</span>&nbsp;<span class="op" id="5718395">&amp;&amp;</span>&nbsp;<span class="ident" id="5718398">strings</span><span class="op" id="5718405">.</span><span class="ident" id="5718406">HasSuffix</span><span class="op" id="5718415">(</span><span class="ident" id="5718416">pkg</span><span class="op" id="5718419">,</span>&nbsp;<span class="string" id="5718421">&#34;_test&#34;</span><span class="op" id="5718428">)</span>&nbsp;<span class="op" id="5718430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718435">isXTest</span>&nbsp;<span class="op" id="5718443">=</span>&nbsp;<span class="builtintype" id="5718445">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718453">pkg</span>&nbsp;<span class="op" id="5718457">=</span>&nbsp;<span class="ident" id="5718459">pkg</span><span class="op" id="5718462">[</span><span class="op" id="5718463">:</span><span class="builtinfunc" id="5718464">len</span><span class="op" id="5718467">(</span><span class="ident" id="5718468">pkg</span><span class="op" id="5718471">)</span><span class="op" id="5718472">-</span><span class="builtinfunc" id="5718473">len</span><span class="op" id="5718476">(</span><span class="string" id="5718477">&#34;_test&#34;</span><span class="op" id="5718484">)</span><span class="op" id="5718485">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718494">if</span>&nbsp;<span class="ident" id="5718497">p</span><span class="op" id="5718498">.</span><span class="ident" id="5718499">Name</span>&nbsp;<span class="op" id="5718504">==</span>&nbsp;<span class="string" id="5718507">&#34;&#34;</span>&nbsp;<span class="op" id="5718510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718515">p</span><span class="op" id="5718516">.</span><span class="ident" id="5718517">Name</span>&nbsp;<span class="op" id="5718522">=</span>&nbsp;<span class="ident" id="5718524">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718531">firstFile</span>&nbsp;<span class="op" id="5718541">=</span>&nbsp;<span class="ident" id="5718543">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718550">}</span>&nbsp;<span class="keyword" id="5718552">else</span>&nbsp;<span class="keyword" id="5718557">if</span>&nbsp;<span class="ident" id="5718560">pkg</span>&nbsp;<span class="op" id="5718564">!=</span>&nbsp;<span class="ident" id="5718567">p</span><span class="op" id="5718568">.</span><span class="ident" id="5718569">Name</span>&nbsp;<span class="op" id="5718574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718579">return</span>&nbsp;<span class="ident" id="5718586">p</span><span class="op" id="5718587">,</span>&nbsp;<span class="op" id="5718589">&amp;</span><span class="ident" id="5718590">MultiplePackageError</span><span class="op" id="5718610">{</span><span class="ident" id="5718611">p</span><span class="op" id="5718612">.</span><span class="ident" id="5718613">Dir</span><span class="op" id="5718616">,</span>&nbsp;<span class="op" id="5718618">[</span><span class="op" id="5718619">]</span><span class="builtintype" id="5718620">string</span><span class="op" id="5718626">{</span><span class="ident" id="5718627">firstFile</span><span class="op" id="5718636">,</span>&nbsp;<span class="ident" id="5718638">name</span><span class="op" id="5718642">}</span><span class="op" id="5718643">,</span>&nbsp;<span class="op" id="5718645">[</span><span class="op" id="5718646">]</span><span class="builtintype" id="5718647">string</span><span class="op" id="5718653">{</span><span class="ident" id="5718654">p</span><span class="op" id="5718655">.</span><span class="ident" id="5718656">Name</span><span class="op" id="5718660">,</span>&nbsp;<span class="ident" id="5718662">pkg</span><span class="op" id="5718665">}</span><span class="op" id="5718666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718674">if</span>&nbsp;<span class="ident" id="5718677">pf</span><span class="op" id="5718679">.</span><span class="ident" id="5718680">Doc</span>&nbsp;<span class="op" id="5718684">!=</span>&nbsp;<span class="ident" id="5718687">nil</span>&nbsp;<span class="op" id="5718691">&amp;&amp;</span>&nbsp;<span class="ident" id="5718694">p</span><span class="op" id="5718695">.</span><span class="ident" id="5718696">Doc</span>&nbsp;<span class="op" id="5718700">==</span>&nbsp;<span class="string" id="5718703">&#34;&#34;</span>&nbsp;<span class="op" id="5718706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718711">p</span><span class="op" id="5718712">.</span><span class="ident" id="5718713">Doc</span>&nbsp;<span class="op" id="5718717">=</span>&nbsp;<span class="ident" id="5718719">doc</span><span class="op" id="5718722">.</span><span class="ident" id="5718723">Synopsis</span><span class="op" id="5718731">(</span><span class="ident" id="5718732">pf</span><span class="op" id="5718734">.</span><span class="ident" id="5718735">Doc</span><span class="op" id="5718738">.</span><span class="ident" id="5718739">Text</span><span class="op" id="5718743">(</span><span class="op" id="5718744">)</span><span class="op" id="5718745">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718754">if</span>&nbsp;<span class="ident" id="5718757">mode</span><span class="op" id="5718761">&amp;</span><span class="ident" id="5718762">ImportComment</span>&nbsp;<span class="op" id="5718776">!=</span>&nbsp;<span class="num" id="5718779">0</span>&nbsp;<span class="op" id="5718781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718786">qcom</span><span class="op" id="5718790">,</span>&nbsp;<span class="ident" id="5718792">line</span>&nbsp;<span class="op" id="5718797">:=</span>&nbsp;<span class="ident" id="5718800">findImportComment</span><span class="op" id="5718817">(</span><span class="ident" id="5718818">data</span><span class="op" id="5718822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718827">if</span>&nbsp;<span class="ident" id="5718830">line</span>&nbsp;<span class="op" id="5718835">!=</span>&nbsp;<span class="num" id="5718838">0</span>&nbsp;<span class="op" id="5718840">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718846">com</span><span class="op" id="5718849">,</span>&nbsp;<span class="ident" id="5718851">err</span>&nbsp;<span class="op" id="5718855">:=</span>&nbsp;<span class="ident" id="5718858">strconv</span><span class="op" id="5718865">.</span><span class="ident" id="5718866">Unquote</span><span class="op" id="5718873">(</span><span class="ident" id="5718874">qcom</span><span class="op" id="5718878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718884">if</span>&nbsp;<span class="ident" id="5718887">err</span>&nbsp;<span class="op" id="5718891">!=</span>&nbsp;<span class="ident" id="5718894">nil</span>&nbsp;<span class="op" id="5718898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718905">return</span>&nbsp;<span class="ident" id="5718912">p</span><span class="op" id="5718913">,</span>&nbsp;<span class="ident" id="5718915">fmt</span><span class="op" id="5718918">.</span><span class="ident" id="5718919">Errorf</span><span class="op" id="5718925">(</span><span class="string" id="5718926">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="5718962">,</span>&nbsp;<span class="ident" id="5718964">filename</span><span class="op" id="5718972">,</span>&nbsp;<span class="ident" id="5718974">line</span><span class="op" id="5718978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718990">if</span>&nbsp;<span class="ident" id="5718993">p</span><span class="op" id="5718994">.</span><span class="ident" id="5718995">ImportComment</span>&nbsp;<span class="op" id="5719009">==</span>&nbsp;<span class="string" id="5719012">&#34;&#34;</span>&nbsp;<span class="op" id="5719015">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719022">p</span><span class="op" id="5719023">.</span><span class="ident" id="5719024">ImportComment</span>&nbsp;<span class="op" id="5719038">=</span>&nbsp;<span class="ident" id="5719040">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719049">firstCommentFile</span>&nbsp;<span class="op" id="5719066">=</span>&nbsp;<span class="ident" id="5719068">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719077">}</span>&nbsp;<span class="keyword" id="5719079">else</span>&nbsp;<span class="keyword" id="5719084">if</span>&nbsp;<span class="ident" id="5719087">p</span><span class="op" id="5719088">.</span><span class="ident" id="5719089">ImportComment</span>&nbsp;<span class="op" id="5719103">!=</span>&nbsp;<span class="ident" id="5719106">com</span>&nbsp;<span class="op" id="5719110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719117">return</span>&nbsp;<span class="ident" id="5719124">p</span><span class="op" id="5719125">,</span>&nbsp;<span class="ident" id="5719127">fmt</span><span class="op" id="5719130">.</span><span class="ident" id="5719131">Errorf</span><span class="op" id="5719137">(</span><span class="string" id="5719138">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5719187">,</span>&nbsp;<span class="ident" id="5719189">p</span><span class="op" id="5719190">.</span><span class="ident" id="5719191">ImportComment</span><span class="op" id="5719204">,</span>&nbsp;<span class="ident" id="5719206">firstCommentFile</span><span class="op" id="5719222">,</span>&nbsp;<span class="ident" id="5719224">com</span><span class="op" id="5719227">,</span>&nbsp;<span class="ident" id="5719229">name</span><span class="op" id="5719233">,</span>&nbsp;<span class="ident" id="5719235">p</span><span class="op" id="5719236">.</span><span class="ident" id="5719237">Dir</span><span class="op" id="5719240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719246">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719260">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719307">isCgo</span>&nbsp;<span class="op" id="5719313">:=</span>&nbsp;<span class="builtintype" id="5719316">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719324">for</span>&nbsp;<span class="ident" id="5719328">_</span><span class="op" id="5719329">,</span>&nbsp;<span class="ident" id="5719331">decl</span>&nbsp;<span class="op" id="5719336">:=</span>&nbsp;<span class="keyword" id="5719339">range</span>&nbsp;<span class="ident" id="5719345">pf</span><span class="op" id="5719347">.</span><span class="ident" id="5719348">Decls</span>&nbsp;<span class="op" id="5719354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719359">d</span><span class="op" id="5719360">,</span>&nbsp;<span class="ident" id="5719362">ok</span>&nbsp;<span class="op" id="5719365">:=</span>&nbsp;<span class="ident" id="5719368">decl</span><span class="op" id="5719372">.</span><span class="op" id="5719373">(</span><span class="op" id="5719374">*</span><span class="ident" id="5719375">ast</span><span class="op" id="5719378">.</span><span class="ident" id="5719379">GenDecl</span><span class="op" id="5719386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719391">if</span>&nbsp;<span class="op" id="5719394">!</span><span class="ident" id="5719395">ok</span>&nbsp;<span class="op" id="5719398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719404">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719416">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719421">for</span>&nbsp;<span class="ident" id="5719425">_</span><span class="op" id="5719426">,</span>&nbsp;<span class="ident" id="5719428">dspec</span>&nbsp;<span class="op" id="5719434">:=</span>&nbsp;<span class="keyword" id="5719437">range</span>&nbsp;<span class="ident" id="5719443">d</span><span class="op" id="5719444">.</span><span class="ident" id="5719445">Specs</span>&nbsp;<span class="op" id="5719451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719457">spec</span><span class="op" id="5719461">,</span>&nbsp;<span class="ident" id="5719463">ok</span>&nbsp;<span class="op" id="5719466">:=</span>&nbsp;<span class="ident" id="5719469">dspec</span><span class="op" id="5719474">.</span><span class="op" id="5719475">(</span><span class="op" id="5719476">*</span><span class="ident" id="5719477">ast</span><span class="op" id="5719480">.</span><span class="ident" id="5719481">ImportSpec</span><span class="op" id="5719491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719497">if</span>&nbsp;<span class="op" id="5719500">!</span><span class="ident" id="5719501">ok</span>&nbsp;<span class="op" id="5719504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719511">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719524">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719530">quoted</span>&nbsp;<span class="op" id="5719537">:=</span>&nbsp;<span class="ident" id="5719540">spec</span><span class="op" id="5719544">.</span><span class="ident" id="5719545">Path</span><span class="op" id="5719549">.</span><span class="ident" id="5719550">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719560">path</span><span class="op" id="5719564">,</span>&nbsp;<span class="ident" id="5719566">err</span>&nbsp;<span class="op" id="5719570">:=</span>&nbsp;<span class="ident" id="5719573">strconv</span><span class="op" id="5719580">.</span><span class="ident" id="5719581">Unquote</span><span class="op" id="5719588">(</span><span class="ident" id="5719589">quoted</span><span class="op" id="5719595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719601">if</span>&nbsp;<span class="ident" id="5719604">err</span>&nbsp;<span class="op" id="5719608">!=</span>&nbsp;<span class="ident" id="5719611">nil</span>&nbsp;<span class="op" id="5719615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719622">log</span><span class="op" id="5719625">.</span><span class="ident" id="5719626">Panicf</span><span class="op" id="5719632">(</span><span class="string" id="5719633">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="5719682">,</span>&nbsp;<span class="ident" id="5719684">filename</span><span class="op" id="5719692">,</span>&nbsp;<span class="ident" id="5719694">quoted</span><span class="op" id="5719700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719706">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719712">if</span>&nbsp;<span class="ident" id="5719715">isXTest</span>&nbsp;<span class="op" id="5719723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719730">xTestImported</span><span class="op" id="5719743">[</span><span class="ident" id="5719744">path</span><span class="op" id="5719748">]</span>&nbsp;<span class="op" id="5719750">=</span>&nbsp;<span class="builtinfunc" id="5719752">append</span><span class="op" id="5719758">(</span><span class="ident" id="5719759">xTestImported</span><span class="op" id="5719772">[</span><span class="ident" id="5719773">path</span><span class="op" id="5719777">]</span><span class="op" id="5719778">,</span>&nbsp;<span class="ident" id="5719780">fset</span><span class="op" id="5719784">.</span><span class="ident" id="5719785">Position</span><span class="op" id="5719793">(</span><span class="ident" id="5719794">spec</span><span class="op" id="5719798">.</span><span class="ident" id="5719799">Pos</span><span class="op" id="5719802">(</span><span class="op" id="5719803">)</span><span class="op" id="5719804">)</span><span class="op" id="5719805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719811">}</span>&nbsp;<span class="keyword" id="5719813">else</span>&nbsp;<span class="keyword" id="5719818">if</span>&nbsp;<span class="ident" id="5719821">isTest</span>&nbsp;<span class="op" id="5719828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719835">testImported</span><span class="op" id="5719847">[</span><span class="ident" id="5719848">path</span><span class="op" id="5719852">]</span>&nbsp;<span class="op" id="5719854">=</span>&nbsp;<span class="builtinfunc" id="5719856">append</span><span class="op" id="5719862">(</span><span class="ident" id="5719863">testImported</span><span class="op" id="5719875">[</span><span class="ident" id="5719876">path</span><span class="op" id="5719880">]</span><span class="op" id="5719881">,</span>&nbsp;<span class="ident" id="5719883">fset</span><span class="op" id="5719887">.</span><span class="ident" id="5719888">Position</span><span class="op" id="5719896">(</span><span class="ident" id="5719897">spec</span><span class="op" id="5719901">.</span><span class="ident" id="5719902">Pos</span><span class="op" id="5719905">(</span><span class="op" id="5719906">)</span><span class="op" id="5719907">)</span><span class="op" id="5719908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719914">}</span>&nbsp;<span class="keyword" id="5719916">else</span>&nbsp;<span class="op" id="5719921">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719928">imported</span><span class="op" id="5719936">[</span><span class="ident" id="5719937">path</span><span class="op" id="5719941">]</span>&nbsp;<span class="op" id="5719943">=</span>&nbsp;<span class="builtinfunc" id="5719945">append</span><span class="op" id="5719951">(</span><span class="ident" id="5719952">imported</span><span class="op" id="5719960">[</span><span class="ident" id="5719961">path</span><span class="op" id="5719965">]</span><span class="op" id="5719966">,</span>&nbsp;<span class="ident" id="5719968">fset</span><span class="op" id="5719972">.</span><span class="ident" id="5719973">Position</span><span class="op" id="5719981">(</span><span class="ident" id="5719982">spec</span><span class="op" id="5719986">.</span><span class="ident" id="5719987">Pos</span><span class="op" id="5719990">(</span><span class="op" id="5719991">)</span><span class="op" id="5719992">)</span><span class="op" id="5719993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720005">if</span>&nbsp;<span class="ident" id="5720008">path</span>&nbsp;<span class="op" id="5720013">==</span>&nbsp;<span class="string" id="5720016">&#34;C&#34;</span>&nbsp;<span class="op" id="5720020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720027">if</span>&nbsp;<span class="ident" id="5720030">isTest</span>&nbsp;<span class="op" id="5720037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720045">return</span>&nbsp;<span class="ident" id="5720052">p</span><span class="op" id="5720053">,</span>&nbsp;<span class="ident" id="5720055">fmt</span><span class="op" id="5720058">.</span><span class="ident" id="5720059">Errorf</span><span class="op" id="5720065">(</span><span class="string" id="5720066">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="5720103">,</span>&nbsp;<span class="ident" id="5720105">filename</span><span class="op" id="5720113">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720127">cg</span>&nbsp;<span class="op" id="5720130">:=</span>&nbsp;<span class="ident" id="5720133">spec</span><span class="op" id="5720137">.</span><span class="ident" id="5720138">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720147">if</span>&nbsp;<span class="ident" id="5720150">cg</span>&nbsp;<span class="op" id="5720153">==</span>&nbsp;<span class="ident" id="5720156">nil</span>&nbsp;<span class="op" id="5720160">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5720163">len</span><span class="op" id="5720166">(</span><span class="ident" id="5720167">d</span><span class="op" id="5720168">.</span><span class="ident" id="5720169">Specs</span><span class="op" id="5720174">)</span>&nbsp;<span class="op" id="5720176">==</span>&nbsp;<span class="num" id="5720179">1</span>&nbsp;<span class="op" id="5720181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720189">cg</span>&nbsp;<span class="op" id="5720192">=</span>&nbsp;<span class="ident" id="5720194">d</span><span class="op" id="5720195">.</span><span class="ident" id="5720196">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720205">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720212">if</span>&nbsp;<span class="ident" id="5720215">cg</span>&nbsp;<span class="op" id="5720218">!=</span>&nbsp;<span class="ident" id="5720221">nil</span>&nbsp;<span class="op" id="5720225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720233">if</span>&nbsp;<span class="ident" id="5720236">err</span>&nbsp;<span class="op" id="5720240">:=</span>&nbsp;<span class="ident" id="5720243">ctxt</span><span class="op" id="5720247">.</span><span class="ident" id="5720248">saveCgo</span><span class="op" id="5720255">(</span><span class="ident" id="5720256">filename</span><span class="op" id="5720264">,</span>&nbsp;<span class="ident" id="5720266">p</span><span class="op" id="5720267">,</span>&nbsp;<span class="ident" id="5720269">cg</span><span class="op" id="5720271">)</span><span class="op" id="5720272">;</span>&nbsp;<span class="ident" id="5720274">err</span>&nbsp;<span class="op" id="5720278">!=</span>&nbsp;<span class="ident" id="5720281">nil</span>&nbsp;<span class="op" id="5720285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720294">return</span>&nbsp;<span class="ident" id="5720301">p</span><span class="op" id="5720302">,</span>&nbsp;<span class="ident" id="5720304">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720321">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720328">isCgo</span>&nbsp;<span class="op" id="5720334">=</span>&nbsp;<span class="builtintype" id="5720336">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720358">if</span>&nbsp;<span class="ident" id="5720361">isCgo</span>&nbsp;<span class="op" id="5720367">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720372">allTags</span><span class="op" id="5720379">[</span><span class="string" id="5720380">&#34;cgo&#34;</span><span class="op" id="5720385">]</span>&nbsp;<span class="op" id="5720387">=</span>&nbsp;<span class="builtintype" id="5720389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720397">if</span>&nbsp;<span class="ident" id="5720400">ctxt</span><span class="op" id="5720404">.</span><span class="ident" id="5720405">CgoEnabled</span>&nbsp;<span class="op" id="5720416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720422">p</span><span class="op" id="5720423">.</span><span class="ident" id="5720424">CgoFiles</span>&nbsp;<span class="op" id="5720433">=</span>&nbsp;<span class="builtinfunc" id="5720435">append</span><span class="op" id="5720441">(</span><span class="ident" id="5720442">p</span><span class="op" id="5720443">.</span><span class="ident" id="5720444">CgoFiles</span><span class="op" id="5720452">,</span>&nbsp;<span class="ident" id="5720454">name</span><span class="op" id="5720458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720463">}</span>&nbsp;<span class="keyword" id="5720465">else</span>&nbsp;<span class="op" id="5720470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720476">p</span><span class="op" id="5720477">.</span><span class="ident" id="5720478">IgnoredGoFiles</span>&nbsp;<span class="op" id="5720493">=</span>&nbsp;<span class="builtinfunc" id="5720495">append</span><span class="op" id="5720501">(</span><span class="ident" id="5720502">p</span><span class="op" id="5720503">.</span><span class="ident" id="5720504">IgnoredGoFiles</span><span class="op" id="5720518">,</span>&nbsp;<span class="ident" id="5720520">name</span><span class="op" id="5720524">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720533">}</span>&nbsp;<span class="keyword" id="5720535">else</span>&nbsp;<span class="keyword" id="5720540">if</span>&nbsp;<span class="ident" id="5720543">isXTest</span>&nbsp;<span class="op" id="5720551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720556">p</span><span class="op" id="5720557">.</span><span class="ident" id="5720558">XTestGoFiles</span>&nbsp;<span class="op" id="5720571">=</span>&nbsp;<span class="builtinfunc" id="5720573">append</span><span class="op" id="5720579">(</span><span class="ident" id="5720580">p</span><span class="op" id="5720581">.</span><span class="ident" id="5720582">XTestGoFiles</span><span class="op" id="5720594">,</span>&nbsp;<span class="ident" id="5720596">name</span><span class="op" id="5720600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720604">}</span>&nbsp;<span class="keyword" id="5720606">else</span>&nbsp;<span class="keyword" id="5720611">if</span>&nbsp;<span class="ident" id="5720614">isTest</span>&nbsp;<span class="op" id="5720621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720626">p</span><span class="op" id="5720627">.</span><span class="ident" id="5720628">TestGoFiles</span>&nbsp;<span class="op" id="5720640">=</span>&nbsp;<span class="builtinfunc" id="5720642">append</span><span class="op" id="5720648">(</span><span class="ident" id="5720649">p</span><span class="op" id="5720650">.</span><span class="ident" id="5720651">TestGoFiles</span><span class="op" id="5720662">,</span>&nbsp;<span class="ident" id="5720664">name</span><span class="op" id="5720668">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720672">}</span>&nbsp;<span class="keyword" id="5720674">else</span>&nbsp;<span class="op" id="5720679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720684">p</span><span class="op" id="5720685">.</span><span class="ident" id="5720686">GoFiles</span>&nbsp;<span class="op" id="5720694">=</span>&nbsp;<span class="builtinfunc" id="5720696">append</span><span class="op" id="5720702">(</span><span class="ident" id="5720703">p</span><span class="op" id="5720704">.</span><span class="ident" id="5720705">GoFiles</span><span class="op" id="5720712">,</span>&nbsp;<span class="ident" id="5720714">name</span><span class="op" id="5720718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720728">if</span>&nbsp;<span class="builtinfunc" id="5720731">len</span><span class="op" id="5720734">(</span><span class="ident" id="5720735">p</span><span class="op" id="5720736">.</span><span class="ident" id="5720737">GoFiles</span><span class="op" id="5720744">)</span><span class="op" id="5720745">+</span><span class="builtinfunc" id="5720746">len</span><span class="op" id="5720749">(</span><span class="ident" id="5720750">p</span><span class="op" id="5720751">.</span><span class="ident" id="5720752">CgoFiles</span><span class="op" id="5720760">)</span><span class="op" id="5720761">+</span><span class="builtinfunc" id="5720762">len</span><span class="op" id="5720765">(</span><span class="ident" id="5720766">p</span><span class="op" id="5720767">.</span><span class="ident" id="5720768">TestGoFiles</span><span class="op" id="5720779">)</span><span class="op" id="5720780">+</span><span class="builtinfunc" id="5720781">len</span><span class="op" id="5720784">(</span><span class="ident" id="5720785">p</span><span class="op" id="5720786">.</span><span class="ident" id="5720787">XTestGoFiles</span><span class="op" id="5720799">)</span>&nbsp;<span class="op" id="5720801">==</span>&nbsp;<span class="num" id="5720804">0</span>&nbsp;<span class="op" id="5720806">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720810">return</span>&nbsp;<span class="ident" id="5720817">p</span><span class="op" id="5720818">,</span>&nbsp;<span class="op" id="5720820">&amp;</span><span class="ident" id="5720821">NoGoError</span><span class="op" id="5720830">{</span><span class="ident" id="5720831">p</span><span class="op" id="5720832">.</span><span class="ident" id="5720833">Dir</span><span class="op" id="5720836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720843">for</span>&nbsp;<span class="ident" id="5720847">tag</span>&nbsp;<span class="op" id="5720851">:=</span>&nbsp;<span class="keyword" id="5720854">range</span>&nbsp;<span class="ident" id="5720860">allTags</span>&nbsp;<span class="op" id="5720868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720872">p</span><span class="op" id="5720873">.</span><span class="ident" id="5720874">AllTags</span>&nbsp;<span class="op" id="5720882">=</span>&nbsp;<span class="builtinfunc" id="5720884">append</span><span class="op" id="5720890">(</span><span class="ident" id="5720891">p</span><span class="op" id="5720892">.</span><span class="ident" id="5720893">AllTags</span><span class="op" id="5720900">,</span>&nbsp;<span class="ident" id="5720902">tag</span><span class="op" id="5720905">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720911">sort</span><span class="op" id="5720915">.</span><span class="ident" id="5720916">Strings</span><span class="op" id="5720923">(</span><span class="ident" id="5720924">p</span><span class="op" id="5720925">.</span><span class="ident" id="5720926">AllTags</span><span class="op" id="5720933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720937">p</span><span class="op" id="5720938">.</span><span class="ident" id="5720939">Imports</span><span class="op" id="5720946">,</span>&nbsp;<span class="ident" id="5720948">p</span><span class="op" id="5720949">.</span><span class="ident" id="5720950">ImportPos</span>&nbsp;<span class="op" id="5720960">=</span>&nbsp;<span class="ident" id="5720962">cleanImports</span><span class="op" id="5720974">(</span><span class="ident" id="5720975">imported</span><span class="op" id="5720983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720986">p</span><span class="op" id="5720987">.</span><span class="ident" id="5720988">TestImports</span><span class="op" id="5720999">,</span>&nbsp;<span class="ident" id="5721001">p</span><span class="op" id="5721002">.</span><span class="ident" id="5721003">TestImportPos</span>&nbsp;<span class="op" id="5721017">=</span>&nbsp;<span class="ident" id="5721019">cleanImports</span><span class="op" id="5721031">(</span><span class="ident" id="5721032">testImported</span><span class="op" id="5721044">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721047">p</span><span class="op" id="5721048">.</span><span class="ident" id="5721049">XTestImports</span><span class="op" id="5721061">,</span>&nbsp;<span class="ident" id="5721063">p</span><span class="op" id="5721064">.</span><span class="ident" id="5721065">XTestImportPos</span>&nbsp;<span class="op" id="5721080">=</span>&nbsp;<span class="ident" id="5721082">cleanImports</span><span class="op" id="5721094">(</span><span class="ident" id="5721095">xTestImported</span><span class="op" id="5721108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721112">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721158">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721199">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721244">if</span>&nbsp;<span class="builtinfunc" id="5721247">len</span><span class="op" id="5721250">(</span><span class="ident" id="5721251">p</span><span class="op" id="5721252">.</span><span class="ident" id="5721253">CgoFiles</span><span class="op" id="5721261">)</span>&nbsp;<span class="op" id="5721263">&gt;</span>&nbsp;<span class="num" id="5721265">0</span>&nbsp;<span class="op" id="5721267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721271">p</span><span class="op" id="5721272">.</span><span class="ident" id="5721273">SFiles</span>&nbsp;<span class="op" id="5721280">=</span>&nbsp;<span class="builtinfunc" id="5721282">append</span><span class="op" id="5721288">(</span><span class="ident" id="5721289">p</span><span class="op" id="5721290">.</span><span class="ident" id="5721291">SFiles</span><span class="op" id="5721297">,</span>&nbsp;<span class="ident" id="5721299">Sfiles</span><span class="op" id="5721305">...</span><span class="op" id="5721308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721312">sort</span><span class="op" id="5721316">.</span><span class="ident" id="5721317">Strings</span><span class="op" id="5721324">(</span><span class="ident" id="5721325">p</span><span class="op" id="5721326">.</span><span class="ident" id="5721327">SFiles</span><span class="op" id="5721333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721340">return</span>&nbsp;<span class="ident" id="5721347">p</span><span class="op" id="5721348">,</span>&nbsp;<span class="ident" id="5721350">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="5721357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721360">func</span>&nbsp;<span class="ident" id="5721365">findImportComment</span><span class="op" id="5721382">(</span><span class="ident" id="5721383">data</span>&nbsp;<span class="op" id="5721388">[</span><span class="op" id="5721389">]</span><span class="builtintype" id="5721390">byte</span><span class="op" id="5721394">)</span>&nbsp;<span class="op" id="5721396">(</span><span class="ident" id="5721397">s</span>&nbsp;<span class="builtintype" id="5721399">string</span><span class="op" id="5721405">,</span>&nbsp;<span class="ident" id="5721407">line</span>&nbsp;<span class="builtintype" id="5721412">int</span><span class="op" id="5721415">)</span>&nbsp;<span class="op" id="5721417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721420">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721447">word</span><span class="op" id="5721451">,</span>&nbsp;<span class="ident" id="5721453">data</span>&nbsp;<span class="op" id="5721458">:=</span>&nbsp;<span class="ident" id="5721461">parseWord</span><span class="op" id="5721470">(</span><span class="ident" id="5721471">data</span><span class="op" id="5721475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721478">if</span>&nbsp;<span class="builtintype" id="5721481">string</span><span class="op" id="5721487">(</span><span class="ident" id="5721488">word</span><span class="op" id="5721492">)</span>&nbsp;<span class="op" id="5721494">!=</span>&nbsp;<span class="string" id="5721497">&#34;package&#34;</span>&nbsp;<span class="op" id="5721507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721511">return</span>&nbsp;<span class="string" id="5721518">&#34;&#34;</span><span class="op" id="5721520">,</span>&nbsp;<span class="num" id="5721522">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721529">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721553">_</span><span class="op" id="5721554">,</span>&nbsp;<span class="ident" id="5721556">data</span>&nbsp;<span class="op" id="5721561">=</span>&nbsp;<span class="ident" id="5721563">parseWord</span><span class="op" id="5721572">(</span><span class="ident" id="5721573">data</span><span class="op" id="5721577">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721581">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5721637">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721683">for</span>&nbsp;<span class="builtinfunc" id="5721687">len</span><span class="op" id="5721690">(</span><span class="ident" id="5721691">data</span><span class="op" id="5721695">)</span>&nbsp;<span class="op" id="5721697">&gt;</span>&nbsp;<span class="num" id="5721699">0</span>&nbsp;<span class="op" id="5721701">&amp;&amp;</span>&nbsp;<span class="op" id="5721704">(</span><span class="ident" id="5721705">data</span><span class="op" id="5721709">[</span><span class="num" id="5721710">0</span><span class="op" id="5721711">]</span>&nbsp;<span class="op" id="5721713">==</span>&nbsp;<span class="string" id="5721716">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5721720">||</span>&nbsp;<span class="ident" id="5721723">data</span><span class="op" id="5721727">[</span><span class="num" id="5721728">0</span><span class="op" id="5721729">]</span>&nbsp;<span class="op" id="5721731">==</span>&nbsp;<span class="string" id="5721734">&#39;\t&#39;</span>&nbsp;<span class="op" id="5721739">||</span>&nbsp;<span class="ident" id="5721742">data</span><span class="op" id="5721746">[</span><span class="num" id="5721747">0</span><span class="op" id="5721748">]</span>&nbsp;<span class="op" id="5721750">==</span>&nbsp;<span class="string" id="5721753">&#39;\r&#39;</span><span class="op" id="5721757">)</span>&nbsp;<span class="op" id="5721759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721763">data</span>&nbsp;<span class="op" id="5721768">=</span>&nbsp;<span class="ident" id="5721770">data</span><span class="op" id="5721774">[</span><span class="num" id="5721775">1</span><span class="op" id="5721776">:</span><span class="op" id="5721777">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721784">var</span>&nbsp;<span class="ident" id="5721788">comment</span>&nbsp;<span class="op" id="5721796">[</span><span class="op" id="5721797">]</span><span class="builtintype" id="5721798">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721804">switch</span>&nbsp;<span class="op" id="5721811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721814">case</span>&nbsp;<span class="ident" id="5721819">bytes</span><span class="op" id="5721824">.</span><span class="ident" id="5721825">HasPrefix</span><span class="op" id="5721834">(</span><span class="ident" id="5721835">data</span><span class="op" id="5721839">,</span>&nbsp;<span class="ident" id="5721841">slashSlash</span><span class="op" id="5721851">)</span><span class="op" id="5721852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721856">i</span>&nbsp;<span class="op" id="5721858">:=</span>&nbsp;<span class="ident" id="5721861">bytes</span><span class="op" id="5721866">.</span><span class="ident" id="5721867">Index</span><span class="op" id="5721872">(</span><span class="ident" id="5721873">data</span><span class="op" id="5721877">,</span>&nbsp;<span class="ident" id="5721879">newline</span><span class="op" id="5721886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721890">if</span>&nbsp;<span class="ident" id="5721893">i</span>&nbsp;<span class="op" id="5721895">&lt;</span>&nbsp;<span class="num" id="5721897">0</span>&nbsp;<span class="op" id="5721899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721904">i</span>&nbsp;<span class="op" id="5721906">=</span>&nbsp;<span class="builtinfunc" id="5721908">len</span><span class="op" id="5721911">(</span><span class="ident" id="5721912">data</span><span class="op" id="5721916">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721924">comment</span>&nbsp;<span class="op" id="5721932">=</span>&nbsp;<span class="ident" id="5721934">data</span><span class="op" id="5721938">[</span><span class="num" id="5721939">2</span><span class="op" id="5721940">:</span><span class="ident" id="5721941">i</span><span class="op" id="5721942">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721945">case</span>&nbsp;<span class="ident" id="5721950">bytes</span><span class="op" id="5721955">.</span><span class="ident" id="5721956">HasPrefix</span><span class="op" id="5721965">(</span><span class="ident" id="5721966">data</span><span class="op" id="5721970">,</span>&nbsp;<span class="ident" id="5721972">slashStar</span><span class="op" id="5721981">)</span><span class="op" id="5721982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721986">data</span>&nbsp;<span class="op" id="5721991">=</span>&nbsp;<span class="ident" id="5721993">data</span><span class="op" id="5721997">[</span><span class="num" id="5721998">2</span><span class="op" id="5721999">:</span><span class="op" id="5722000">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722004">i</span>&nbsp;<span class="op" id="5722006">:=</span>&nbsp;<span class="ident" id="5722009">bytes</span><span class="op" id="5722014">.</span><span class="ident" id="5722015">Index</span><span class="op" id="5722020">(</span><span class="ident" id="5722021">data</span><span class="op" id="5722025">,</span>&nbsp;<span class="ident" id="5722027">starSlash</span><span class="op" id="5722036">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722040">if</span>&nbsp;<span class="ident" id="5722043">i</span>&nbsp;<span class="op" id="5722045">&lt;</span>&nbsp;<span class="num" id="5722047">0</span>&nbsp;<span class="op" id="5722049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722054">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722078">return</span>&nbsp;<span class="string" id="5722085">&#34;&#34;</span><span class="op" id="5722087">,</span>&nbsp;<span class="num" id="5722089">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722097">comment</span>&nbsp;<span class="op" id="5722105">=</span>&nbsp;<span class="ident" id="5722107">data</span><span class="op" id="5722111">[</span><span class="op" id="5722112">:</span><span class="ident" id="5722113">i</span><span class="op" id="5722114">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722118">if</span>&nbsp;<span class="ident" id="5722121">bytes</span><span class="op" id="5722126">.</span><span class="ident" id="5722127">Contains</span><span class="op" id="5722135">(</span><span class="ident" id="5722136">comment</span><span class="op" id="5722143">,</span>&nbsp;<span class="ident" id="5722145">newline</span><span class="op" id="5722152">)</span>&nbsp;<span class="op" id="5722154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722159">return</span>&nbsp;<span class="string" id="5722166">&#34;&#34;</span><span class="op" id="5722168">,</span>&nbsp;<span class="num" id="5722170">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722180">comment</span>&nbsp;<span class="op" id="5722188">=</span>&nbsp;<span class="ident" id="5722190">bytes</span><span class="op" id="5722195">.</span><span class="ident" id="5722196">TrimSpace</span><span class="op" id="5722205">(</span><span class="ident" id="5722206">comment</span><span class="op" id="5722213">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722217">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722258">word</span><span class="op" id="5722262">,</span>&nbsp;<span class="ident" id="5722264">arg</span>&nbsp;<span class="op" id="5722268">:=</span>&nbsp;<span class="ident" id="5722271">parseWord</span><span class="op" id="5722280">(</span><span class="ident" id="5722281">comment</span><span class="op" id="5722288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722291">if</span>&nbsp;<span class="builtintype" id="5722294">string</span><span class="op" id="5722300">(</span><span class="ident" id="5722301">word</span><span class="op" id="5722305">)</span>&nbsp;<span class="op" id="5722307">!=</span>&nbsp;<span class="string" id="5722310">&#34;import&#34;</span>&nbsp;<span class="op" id="5722319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722323">return</span>&nbsp;<span class="string" id="5722330">&#34;&#34;</span><span class="op" id="5722332">,</span>&nbsp;<span class="num" id="5722334">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722341">line</span>&nbsp;<span class="op" id="5722346">=</span>&nbsp;<span class="num" id="5722348">1</span>&nbsp;<span class="op" id="5722350">+</span>&nbsp;<span class="ident" id="5722352">bytes</span><span class="op" id="5722357">.</span><span class="ident" id="5722358">Count</span><span class="op" id="5722363">(</span><span class="ident" id="5722364">data</span><span class="op" id="5722368">[</span><span class="op" id="5722369">:</span><span class="builtinfunc" id="5722370">cap</span><span class="op" id="5722373">(</span><span class="ident" id="5722374">data</span><span class="op" id="5722378">)</span><span class="op" id="5722379">-</span><span class="builtinfunc" id="5722380">cap</span><span class="op" id="5722383">(</span><span class="ident" id="5722384">arg</span><span class="op" id="5722387">)</span><span class="op" id="5722388">]</span><span class="op" id="5722389">,</span>&nbsp;<span class="ident" id="5722391">newline</span><span class="op" id="5722398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722401">return</span>&nbsp;<span class="ident" id="5722408">strings</span><span class="op" id="5722415">.</span><span class="ident" id="5722416">TrimSpace</span><span class="op" id="5722425">(</span><span class="builtintype" id="5722426">string</span><span class="op" id="5722432">(</span><span class="ident" id="5722433">arg</span><span class="op" id="5722436">)</span><span class="op" id="5722437">)</span><span class="op" id="5722438">,</span>&nbsp;<span class="ident" id="5722440">line</span><br>
<span class="lineno"></span><span class="op" id="5722445">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="5722448">var</span>&nbsp;<span class="op" id="5722452">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722455">slashSlash</span>&nbsp;<span class="op" id="5722466">=</span>&nbsp;<span class="op" id="5722468">[</span><span class="op" id="5722469">]</span><span class="builtintype" id="5722470">byte</span><span class="op" id="5722474">(</span><span class="string" id="5722475">&#34;//&#34;</span><span class="op" id="5722479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722482">slashStar</span>&nbsp;&nbsp;<span class="op" id="5722493">=</span>&nbsp;<span class="op" id="5722495">[</span><span class="op" id="5722496">]</span><span class="builtintype" id="5722497">byte</span><span class="op" id="5722501">(</span><span class="string" id="5722502">&#34;/*&#34;</span><span class="op" id="5722506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722509">starSlash</span>&nbsp;&nbsp;<span class="op" id="5722520">=</span>&nbsp;<span class="op" id="5722522">[</span><span class="op" id="5722523">]</span><span class="builtintype" id="5722524">byte</span><span class="op" id="5722528">(</span><span class="string" id="5722529">&#34;*/&#34;</span><span class="op" id="5722533">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722536">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722547">=</span>&nbsp;<span class="op" id="5722549">[</span><span class="op" id="5722550">]</span><span class="builtintype" id="5722551">byte</span><span class="op" id="5722555">(</span><span class="string" id="5722556">&#34;\n&#34;</span><span class="op" id="5722560">)</span><br>
<span class="lineno"></span><span class="op" id="5722562">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5722565">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="5722645">func</span>&nbsp;<span class="ident" id="5722650">skipSpaceOrComment</span><span class="op" id="5722668">(</span><span class="ident" id="5722669">data</span>&nbsp;<span class="op" id="5722674">[</span><span class="op" id="5722675">]</span><span class="builtintype" id="5722676">byte</span><span class="op" id="5722680">)</span>&nbsp;<span class="op" id="5722682">[</span><span class="op" id="5722683">]</span><span class="builtintype" id="5722684">byte</span>&nbsp;<span class="op" id="5722689">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722692">for</span>&nbsp;<span class="builtinfunc" id="5722696">len</span><span class="op" id="5722699">(</span><span class="ident" id="5722700">data</span><span class="op" id="5722704">)</span>&nbsp;<span class="op" id="5722706">&gt;</span>&nbsp;<span class="num" id="5722708">0</span>&nbsp;<span class="op" id="5722710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722714">switch</span>&nbsp;<span class="ident" id="5722721">data</span><span class="op" id="5722725">[</span><span class="num" id="5722726">0</span><span class="op" id="5722727">]</span>&nbsp;<span class="op" id="5722729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722733">case</span>&nbsp;<span class="string" id="5722738">&#39;&nbsp;&#39;</span><span class="op" id="5722741">,</span>&nbsp;<span class="string" id="5722743">&#39;\t&#39;</span><span class="op" id="5722747">,</span>&nbsp;<span class="string" id="5722749">&#39;\r&#39;</span><span class="op" id="5722753">,</span>&nbsp;<span class="string" id="5722755">&#39;\n&#39;</span><span class="op" id="5722759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722764">data</span>&nbsp;<span class="op" id="5722769">=</span>&nbsp;<span class="ident" id="5722771">data</span><span class="op" id="5722775">[</span><span class="num" id="5722776">1</span><span class="op" id="5722777">:</span><span class="op" id="5722778">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722783">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722794">case</span>&nbsp;<span class="string" id="5722799">&#39;/&#39;</span><span class="op" id="5722802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722807">if</span>&nbsp;<span class="ident" id="5722810">bytes</span><span class="op" id="5722815">.</span><span class="ident" id="5722816">HasPrefix</span><span class="op" id="5722825">(</span><span class="ident" id="5722826">data</span><span class="op" id="5722830">,</span>&nbsp;<span class="ident" id="5722832">slashSlash</span><span class="op" id="5722842">)</span>&nbsp;<span class="op" id="5722844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722850">i</span>&nbsp;<span class="op" id="5722852">:=</span>&nbsp;<span class="ident" id="5722855">bytes</span><span class="op" id="5722860">.</span><span class="ident" id="5722861">Index</span><span class="op" id="5722866">(</span><span class="ident" id="5722867">data</span><span class="op" id="5722871">,</span>&nbsp;<span class="ident" id="5722873">newline</span><span class="op" id="5722880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722886">if</span>&nbsp;<span class="ident" id="5722889">i</span>&nbsp;<span class="op" id="5722891">&lt;</span>&nbsp;<span class="num" id="5722893">0</span>&nbsp;<span class="op" id="5722895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722902">return</span>&nbsp;<span class="ident" id="5722909">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722923">data</span>&nbsp;<span class="op" id="5722928">=</span>&nbsp;<span class="ident" id="5722930">data</span><span class="op" id="5722934">[</span><span class="ident" id="5722935">i</span><span class="op" id="5722936">+</span><span class="num" id="5722937">1</span><span class="op" id="5722938">:</span><span class="op" id="5722939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722945">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722962">if</span>&nbsp;<span class="ident" id="5722965">bytes</span><span class="op" id="5722970">.</span><span class="ident" id="5722971">HasPrefix</span><span class="op" id="5722980">(</span><span class="ident" id="5722981">data</span><span class="op" id="5722985">,</span>&nbsp;<span class="ident" id="5722987">slashStar</span><span class="op" id="5722996">)</span>&nbsp;<span class="op" id="5722998">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723004">data</span>&nbsp;<span class="op" id="5723009">=</span>&nbsp;<span class="ident" id="5723011">data</span><span class="op" id="5723015">[</span><span class="num" id="5723016">2</span><span class="op" id="5723017">:</span><span class="op" id="5723018">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723024">i</span>&nbsp;<span class="op" id="5723026">:=</span>&nbsp;<span class="ident" id="5723029">bytes</span><span class="op" id="5723034">.</span><span class="ident" id="5723035">Index</span><span class="op" id="5723040">(</span><span class="ident" id="5723041">data</span><span class="op" id="5723045">,</span>&nbsp;<span class="ident" id="5723047">starSlash</span><span class="op" id="5723056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723062">if</span>&nbsp;<span class="ident" id="5723065">i</span>&nbsp;<span class="op" id="5723067">&lt;</span>&nbsp;<span class="num" id="5723069">0</span>&nbsp;<span class="op" id="5723071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723078">return</span>&nbsp;<span class="ident" id="5723085">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723093">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723099">data</span>&nbsp;<span class="op" id="5723104">=</span>&nbsp;<span class="ident" id="5723106">data</span><span class="op" id="5723110">[</span><span class="ident" id="5723111">i</span><span class="op" id="5723112">+</span><span class="num" id="5723113">2</span><span class="op" id="5723114">:</span><span class="op" id="5723115">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723121">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723141">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723151">return</span>&nbsp;<span class="ident" id="5723158">data</span><br>
<span class="lineno"></span><span class="op" id="5723163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723166">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="5723224">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="5723294">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="5723350">func</span>&nbsp;<span class="ident" id="5723355">parseWord</span><span class="op" id="5723364">(</span><span class="ident" id="5723365">data</span>&nbsp;<span class="op" id="5723370">[</span><span class="op" id="5723371">]</span><span class="builtintype" id="5723372">byte</span><span class="op" id="5723376">)</span>&nbsp;<span class="op" id="5723378">(</span><span class="ident" id="5723379">word</span><span class="op" id="5723383">,</span>&nbsp;<span class="ident" id="5723385">rest</span>&nbsp;<span class="op" id="5723390">[</span><span class="op" id="5723391">]</span><span class="builtintype" id="5723392">byte</span><span class="op" id="5723396">)</span>&nbsp;<span class="op" id="5723398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723401">data</span>&nbsp;<span class="op" id="5723406">=</span>&nbsp;<span class="ident" id="5723408">skipSpaceOrComment</span><span class="op" id="5723426">(</span><span class="ident" id="5723427">data</span><span class="op" id="5723431">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723435">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723475">rest</span>&nbsp;<span class="op" id="5723480">=</span>&nbsp;<span class="ident" id="5723482">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723488">for</span>&nbsp;<span class="op" id="5723492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723496">r</span><span class="op" id="5723497">,</span>&nbsp;<span class="ident" id="5723499">size</span>&nbsp;<span class="op" id="5723504">:=</span>&nbsp;<span class="ident" id="5723507">utf8</span><span class="op" id="5723511">.</span><span class="ident" id="5723512">DecodeRune</span><span class="op" id="5723522">(</span><span class="ident" id="5723523">rest</span><span class="op" id="5723527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723531">if</span>&nbsp;<span class="ident" id="5723534">unicode</span><span class="op" id="5723541">.</span><span class="ident" id="5723542">IsLetter</span><span class="op" id="5723550">(</span><span class="ident" id="5723551">r</span><span class="op" id="5723552">)</span>&nbsp;<span class="op" id="5723554">||</span>&nbsp;<span class="string" id="5723557">&#39;0&#39;</span>&nbsp;<span class="op" id="5723561">&lt;=</span>&nbsp;<span class="ident" id="5723564">r</span>&nbsp;<span class="op" id="5723566">&amp;&amp;</span>&nbsp;<span class="ident" id="5723569">r</span>&nbsp;<span class="op" id="5723571">&lt;=</span>&nbsp;<span class="string" id="5723574">&#39;9&#39;</span>&nbsp;<span class="op" id="5723578">||</span>&nbsp;<span class="ident" id="5723581">r</span>&nbsp;<span class="op" id="5723583">==</span>&nbsp;<span class="string" id="5723586">&#39;_&#39;</span>&nbsp;<span class="op" id="5723590">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723595">rest</span>&nbsp;<span class="op" id="5723600">=</span>&nbsp;<span class="ident" id="5723602">rest</span><span class="op" id="5723606">[</span><span class="ident" id="5723607">size</span><span class="op" id="5723611">:</span><span class="op" id="5723612">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723617">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723632">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723639">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723643">word</span>&nbsp;<span class="op" id="5723648">=</span>&nbsp;<span class="ident" id="5723650">data</span><span class="op" id="5723654">[</span><span class="op" id="5723655">:</span><span class="builtinfunc" id="5723656">len</span><span class="op" id="5723659">(</span><span class="ident" id="5723660">data</span><span class="op" id="5723664">)</span><span class="op" id="5723665">-</span><span class="builtinfunc" id="5723666">len</span><span class="op" id="5723669">(</span><span class="ident" id="5723670">rest</span><span class="op" id="5723674">)</span><span class="op" id="5723675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723678">if</span>&nbsp;<span class="builtinfunc" id="5723681">len</span><span class="op" id="5723684">(</span><span class="ident" id="5723685">word</span><span class="op" id="5723689">)</span>&nbsp;<span class="op" id="5723691">==</span>&nbsp;<span class="num" id="5723694">0</span>&nbsp;<span class="op" id="5723696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723700">return</span>&nbsp;<span class="ident" id="5723707">nil</span><span class="op" id="5723710">,</span>&nbsp;<span class="ident" id="5723712">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723717">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723721">return</span>&nbsp;<span class="ident" id="5723728">word</span><span class="op" id="5723732">,</span>&nbsp;<span class="ident" id="5723734">rest</span><br>
<span class="lineno"></span><span class="op" id="5723739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723742">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="5723823">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="5723902">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5723924">//</span><br>
<span class="lineno"></span><span class="comment" id="5723927">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5724000">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="5724043">func</span>&nbsp;<span class="op" id="5724048">(</span><span class="ident" id="5724049">ctxt</span>&nbsp;<span class="op" id="5724054">*</span><span class="ident" id="5724055">Context</span><span class="op" id="5724062">)</span>&nbsp;<span class="ident" id="5724064">MatchFile</span><span class="op" id="5724073">(</span><span class="ident" id="5724074">dir</span><span class="op" id="5724077">,</span>&nbsp;<span class="ident" id="5724079">name</span>&nbsp;<span class="builtintype" id="5724084">string</span><span class="op" id="5724090">)</span>&nbsp;<span class="op" id="5724092">(</span><span class="ident" id="5724093">match</span>&nbsp;<span class="builtintype" id="5724099">bool</span><span class="op" id="5724103">,</span>&nbsp;<span class="ident" id="5724105">err</span>&nbsp;<span class="builtintype" id="5724109">error</span><span class="op" id="5724114">)</span>&nbsp;<span class="op" id="5724116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724119">match</span><span class="op" id="5724124">,</span>&nbsp;<span class="ident" id="5724126">_</span><span class="op" id="5724127">,</span>&nbsp;<span class="ident" id="5724129">_</span><span class="op" id="5724130">,</span>&nbsp;<span class="ident" id="5724132">err</span>&nbsp;<span class="op" id="5724136">=</span>&nbsp;<span class="ident" id="5724138">ctxt</span><span class="op" id="5724142">.</span><span class="ident" id="5724143">matchFile</span><span class="op" id="5724152">(</span><span class="ident" id="5724153">dir</span><span class="op" id="5724156">,</span>&nbsp;<span class="ident" id="5724158">name</span><span class="op" id="5724162">,</span>&nbsp;<span class="builtintype" id="5724164">false</span><span class="op" id="5724169">,</span>&nbsp;<span class="ident" id="5724171">nil</span><span class="op" id="5724174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724177">return</span><br>
<span class="lineno"></span><span class="op" id="5724184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="5724187">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="5724271">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="5724327">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5724370">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="5724445">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="5724521">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="5724568">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="5724638">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="5724673">func</span>&nbsp;<span class="op" id="5724678">(</span><span class="ident" id="5724679">ctxt</span>&nbsp;<span class="op" id="5724684">*</span><span class="ident" id="5724685">Context</span><span class="op" id="5724692">)</span>&nbsp;<span class="ident" id="5724694">matchFile</span><span class="op" id="5724703">(</span><span class="ident" id="5724704">dir</span><span class="op" id="5724707">,</span>&nbsp;<span class="ident" id="5724709">name</span>&nbsp;<span class="builtintype" id="5724714">string</span><span class="op" id="5724720">,</span>&nbsp;<span class="ident" id="5724722">returnImports</span>&nbsp;<span class="builtintype" id="5724736">bool</span><span class="op" id="5724740">,</span>&nbsp;<span class="ident" id="5724742">allTags</span>&nbsp;<span class="keyword" id="5724750">map</span><span class="op" id="5724753">[</span><span class="builtintype" id="5724754">string</span><span class="op" id="5724760">]</span><span class="builtintype" id="5724761">bool</span><span class="op" id="5724765">)</span>&nbsp;<span class="op" id="5724767">(</span><span class="ident" id="5724768">match</span>&nbsp;<span class="builtintype" id="5724774">bool</span><span class="op" id="5724778">,</span>&nbsp;<span class="ident" id="5724780">data</span>&nbsp;<span class="op" id="5724785">[</span><span class="op" id="5724786">]</span><span class="builtintype" id="5724787">byte</span><span class="op" id="5724791">,</span>&nbsp;<span class="ident" id="5724793">filename</span>&nbsp;<span class="builtintype" id="5724802">string</span><span class="op" id="5724808">,</span>&nbsp;<span class="ident" id="5724810">err</span>&nbsp;<span class="builtintype" id="5724814">error</span><span class="op" id="5724819">)</span>&nbsp;<span class="op" id="5724821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724824">if</span>&nbsp;<span class="ident" id="5724827">strings</span><span class="op" id="5724834">.</span><span class="ident" id="5724835">HasPrefix</span><span class="op" id="5724844">(</span><span class="ident" id="5724845">name</span><span class="op" id="5724849">,</span>&nbsp;<span class="string" id="5724851">&#34;_&#34;</span><span class="op" id="5724854">)</span>&nbsp;<span class="op" id="5724856">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724861">strings</span><span class="op" id="5724868">.</span><span class="ident" id="5724869">HasPrefix</span><span class="op" id="5724878">(</span><span class="ident" id="5724879">name</span><span class="op" id="5724883">,</span>&nbsp;<span class="string" id="5724885">&#34;.&#34;</span><span class="op" id="5724888">)</span>&nbsp;<span class="op" id="5724890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724894">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724906">i</span>&nbsp;<span class="op" id="5724908">:=</span>&nbsp;<span class="ident" id="5724911">strings</span><span class="op" id="5724918">.</span><span class="ident" id="5724919">LastIndex</span><span class="op" id="5724928">(</span><span class="ident" id="5724929">name</span><span class="op" id="5724933">,</span>&nbsp;<span class="string" id="5724935">&#34;.&#34;</span><span class="op" id="5724938">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724941">if</span>&nbsp;<span class="ident" id="5724944">i</span>&nbsp;<span class="op" id="5724946">&lt;</span>&nbsp;<span class="num" id="5724948">0</span>&nbsp;<span class="op" id="5724950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724954">i</span>&nbsp;<span class="op" id="5724956">=</span>&nbsp;<span class="builtinfunc" id="5724958">len</span><span class="op" id="5724961">(</span><span class="ident" id="5724962">name</span><span class="op" id="5724966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724972">ext</span>&nbsp;<span class="op" id="5724976">:=</span>&nbsp;<span class="ident" id="5724979">name</span><span class="op" id="5724983">[</span><span class="ident" id="5724984">i</span><span class="op" id="5724985">:</span><span class="op" id="5724986">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724990">if</span>&nbsp;<span class="op" id="5724993">!</span><span class="ident" id="5724994">ctxt</span><span class="op" id="5724998">.</span><span class="ident" id="5724999">goodOSArchFile</span><span class="op" id="5725013">(</span><span class="ident" id="5725014">name</span><span class="op" id="5725018">,</span>&nbsp;<span class="ident" id="5725020">allTags</span><span class="op" id="5725027">)</span>&nbsp;<span class="op" id="5725029">&amp;&amp;</span>&nbsp;<span class="op" id="5725032">!</span><span class="ident" id="5725033">ctxt</span><span class="op" id="5725037">.</span><span class="ident" id="5725038">UseAllFiles</span>&nbsp;<span class="op" id="5725050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725054">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725066">switch</span>&nbsp;<span class="ident" id="5725073">ext</span>&nbsp;<span class="op" id="5725077">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725080">case</span>&nbsp;<span class="string" id="5725085">&#34;.go&#34;</span><span class="op" id="5725090">,</span>&nbsp;<span class="string" id="5725092">&#34;.c&#34;</span><span class="op" id="5725096">,</span>&nbsp;<span class="string" id="5725098">&#34;.cc&#34;</span><span class="op" id="5725103">,</span>&nbsp;<span class="string" id="5725105">&#34;.cxx&#34;</span><span class="op" id="5725111">,</span>&nbsp;<span class="string" id="5725113">&#34;.cpp&#34;</span><span class="op" id="5725119">,</span>&nbsp;<span class="string" id="5725121">&#34;.m&#34;</span><span class="op" id="5725125">,</span>&nbsp;<span class="string" id="5725127">&#34;.s&#34;</span><span class="op" id="5725131">,</span>&nbsp;<span class="string" id="5725133">&#34;.h&#34;</span><span class="op" id="5725137">,</span>&nbsp;<span class="string" id="5725139">&#34;.hh&#34;</span><span class="op" id="5725144">,</span>&nbsp;<span class="string" id="5725146">&#34;.hpp&#34;</span><span class="op" id="5725152">,</span>&nbsp;<span class="string" id="5725154">&#34;.hxx&#34;</span><span class="op" id="5725160">,</span>&nbsp;<span class="string" id="5725162">&#34;.S&#34;</span><span class="op" id="5725166">,</span>&nbsp;<span class="string" id="5725168">&#34;.swig&#34;</span><span class="op" id="5725175">,</span>&nbsp;<span class="string" id="5725177">&#34;.swigcxx&#34;</span><span class="op" id="5725187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725191">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725232">case</span>&nbsp;<span class="string" id="5725237">&#34;.syso&#34;</span><span class="op" id="5725244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725248">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725272">match</span>&nbsp;<span class="op" id="5725278">=</span>&nbsp;<span class="builtintype" id="5725280">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725287">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725295">default</span><span class="op" id="5725302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725306">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725316">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725324">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725328">filename</span>&nbsp;<span class="op" id="5725337">=</span>&nbsp;<span class="ident" id="5725339">ctxt</span><span class="op" id="5725343">.</span><span class="ident" id="5725344">joinPath</span><span class="op" id="5725352">(</span><span class="ident" id="5725353">dir</span><span class="op" id="5725356">,</span>&nbsp;<span class="ident" id="5725358">name</span><span class="op" id="5725362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725365">f</span><span class="op" id="5725366">,</span>&nbsp;<span class="ident" id="5725368">err</span>&nbsp;<span class="op" id="5725372">:=</span>&nbsp;<span class="ident" id="5725375">ctxt</span><span class="op" id="5725379">.</span><span class="ident" id="5725380">openFile</span><span class="op" id="5725388">(</span><span class="ident" id="5725389">filename</span><span class="op" id="5725397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725400">if</span>&nbsp;<span class="ident" id="5725403">err</span>&nbsp;<span class="op" id="5725407">!=</span>&nbsp;<span class="ident" id="5725410">nil</span>&nbsp;<span class="op" id="5725414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725418">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725430">if</span>&nbsp;<span class="ident" id="5725433">strings</span><span class="op" id="5725440">.</span><span class="ident" id="5725441">HasSuffix</span><span class="op" id="5725450">(</span><span class="ident" id="5725451">filename</span><span class="op" id="5725459">,</span>&nbsp;<span class="string" id="5725461">&#34;.go&#34;</span><span class="op" id="5725466">)</span>&nbsp;<span class="op" id="5725468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725472">data</span><span class="op" id="5725476">,</span>&nbsp;<span class="ident" id="5725478">err</span>&nbsp;<span class="op" id="5725482">=</span>&nbsp;<span class="ident" id="5725484">readImports</span><span class="op" id="5725495">(</span><span class="ident" id="5725496">f</span><span class="op" id="5725497">,</span>&nbsp;<span class="builtintype" id="5725499">false</span><span class="op" id="5725504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725507">}</span>&nbsp;<span class="keyword" id="5725509">else</span>&nbsp;<span class="op" id="5725514">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725518">data</span><span class="op" id="5725522">,</span>&nbsp;<span class="ident" id="5725524">err</span>&nbsp;<span class="op" id="5725528">=</span>&nbsp;<span class="ident" id="5725530">readComments</span><span class="op" id="5725542">(</span><span class="ident" id="5725543">f</span><span class="op" id="5725544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725550">f</span><span class="op" id="5725551">.</span><span class="ident" id="5725552">Close</span><span class="op" id="5725557">(</span><span class="op" id="5725558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725561">if</span>&nbsp;<span class="ident" id="5725564">err</span>&nbsp;<span class="op" id="5725568">!=</span>&nbsp;<span class="ident" id="5725571">nil</span>&nbsp;<span class="op" id="5725575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725579">err</span>&nbsp;<span class="op" id="5725583">=</span>&nbsp;<span class="ident" id="5725585">fmt</span><span class="op" id="5725588">.</span><span class="ident" id="5725589">Errorf</span><span class="op" id="5725595">(</span><span class="string" id="5725596">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="5725609">,</span>&nbsp;<span class="ident" id="5725611">filename</span><span class="op" id="5725619">,</span>&nbsp;<span class="ident" id="5725621">err</span><span class="op" id="5725624">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725628">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725640">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725699">if</span>&nbsp;<span class="op" id="5725702">!</span><span class="ident" id="5725703">ctxt</span><span class="op" id="5725707">.</span><span class="ident" id="5725708">shouldBuild</span><span class="op" id="5725719">(</span><span class="ident" id="5725720">data</span><span class="op" id="5725724">,</span>&nbsp;<span class="ident" id="5725726">allTags</span><span class="op" id="5725733">)</span>&nbsp;<span class="op" id="5725735">&amp;&amp;</span>&nbsp;<span class="op" id="5725738">!</span><span class="ident" id="5725739">ctxt</span><span class="op" id="5725743">.</span><span class="ident" id="5725744">UseAllFiles</span>&nbsp;<span class="op" id="5725756">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725760">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725772">match</span>&nbsp;<span class="op" id="5725778">=</span>&nbsp;<span class="builtintype" id="5725780">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725786">return</span><br>
<span class="lineno">975</span><span class="op" id="5725793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5725796">func</span>&nbsp;<span class="ident" id="5725801">cleanImports</span><span class="op" id="5725813">(</span><span class="ident" id="5725814">m</span>&nbsp;<span class="keyword" id="5725816">map</span><span class="op" id="5725819">[</span><span class="builtintype" id="5725820">string</span><span class="op" id="5725826">]</span><span class="op" id="5725827">[</span><span class="op" id="5725828">]</span><span class="ident" id="5725829">token</span><span class="op" id="5725834">.</span><span class="ident" id="5725835">Position</span><span class="op" id="5725843">)</span>&nbsp;<span class="op" id="5725845">(</span><span class="op" id="5725846">[</span><span class="op" id="5725847">]</span><span class="builtintype" id="5725848">string</span><span class="op" id="5725854">,</span>&nbsp;<span class="keyword" id="5725856">map</span><span class="op" id="5725859">[</span><span class="builtintype" id="5725860">string</span><span class="op" id="5725866">]</span><span class="op" id="5725867">[</span><span class="op" id="5725868">]</span><span class="ident" id="5725869">token</span><span class="op" id="5725874">.</span><span class="ident" id="5725875">Position</span><span class="op" id="5725883">)</span>&nbsp;<span class="op" id="5725885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725888">all</span>&nbsp;<span class="op" id="5725892">:=</span>&nbsp;<span class="builtinfunc" id="5725895">make</span><span class="op" id="5725899">(</span><span class="op" id="5725900">[</span><span class="op" id="5725901">]</span><span class="builtintype" id="5725902">string</span><span class="op" id="5725908">,</span>&nbsp;<span class="num" id="5725910">0</span><span class="op" id="5725911">,</span>&nbsp;<span class="builtinfunc" id="5725913">len</span><span class="op" id="5725916">(</span><span class="ident" id="5725917">m</span><span class="op" id="5725918">)</span><span class="op" id="5725919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725922">for</span>&nbsp;<span class="ident" id="5725926">path</span>&nbsp;<span class="op" id="5725931">:=</span>&nbsp;<span class="keyword" id="5725934">range</span>&nbsp;<span class="ident" id="5725940">m</span>&nbsp;<span class="op" id="5725942">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725946">all</span>&nbsp;<span class="op" id="5725950">=</span>&nbsp;<span class="builtinfunc" id="5725952">append</span><span class="op" id="5725958">(</span><span class="ident" id="5725959">all</span><span class="op" id="5725962">,</span>&nbsp;<span class="ident" id="5725964">path</span><span class="op" id="5725968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725974">sort</span><span class="op" id="5725978">.</span><span class="ident" id="5725979">Strings</span><span class="op" id="5725986">(</span><span class="ident" id="5725987">all</span><span class="op" id="5725990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725993">return</span>&nbsp;<span class="ident" id="5726000">all</span><span class="op" id="5726003">,</span>&nbsp;<span class="ident" id="5726005">m</span><br>
<span class="lineno"></span><span class="op" id="5726007">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="5726010">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="5726053">func</span>&nbsp;<span class="ident" id="5726058">Import</span><span class="op" id="5726064">(</span><span class="ident" id="5726065">path</span><span class="op" id="5726069">,</span>&nbsp;<span class="ident" id="5726071">srcDir</span>&nbsp;<span class="builtintype" id="5726078">string</span><span class="op" id="5726084">,</span>&nbsp;<span class="ident" id="5726086">mode</span>&nbsp;<span class="ident" id="5726091">ImportMode</span><span class="op" id="5726101">)</span>&nbsp;<span class="op" id="5726103">(</span><span class="op" id="5726104">*</span><span class="ident" id="5726105">Package</span><span class="op" id="5726112">,</span>&nbsp;<span class="builtintype" id="5726114">error</span><span class="op" id="5726119">)</span>&nbsp;<span class="op" id="5726121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726124">return</span>&nbsp;<span class="ident" id="5726131">Default</span><span class="op" id="5726138">.</span><span class="ident" id="5726139">Import</span><span class="op" id="5726145">(</span><span class="ident" id="5726146">path</span><span class="op" id="5726150">,</span>&nbsp;<span class="ident" id="5726152">srcDir</span><span class="op" id="5726158">,</span>&nbsp;<span class="ident" id="5726160">mode</span><span class="op" id="5726164">)</span><br>
<span class="lineno"></span><span class="op" id="5726166">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="5726169">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5726218">func</span>&nbsp;<span class="ident" id="5726223">ImportDir</span><span class="op" id="5726232">(</span><span class="ident" id="5726233">dir</span>&nbsp;<span class="builtintype" id="5726237">string</span><span class="op" id="5726243">,</span>&nbsp;<span class="ident" id="5726245">mode</span>&nbsp;<span class="ident" id="5726250">ImportMode</span><span class="op" id="5726260">)</span>&nbsp;<span class="op" id="5726262">(</span><span class="op" id="5726263">*</span><span class="ident" id="5726264">Package</span><span class="op" id="5726271">,</span>&nbsp;<span class="builtintype" id="5726273">error</span><span class="op" id="5726278">)</span>&nbsp;<span class="op" id="5726280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726283">return</span>&nbsp;<span class="ident" id="5726290">Default</span><span class="op" id="5726297">.</span><span class="ident" id="5726298">ImportDir</span><span class="op" id="5726307">(</span><span class="ident" id="5726308">dir</span><span class="op" id="5726311">,</span>&nbsp;<span class="ident" id="5726313">mode</span><span class="op" id="5726317">)</span><br>
<span class="lineno"></span><span class="op" id="5726319">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="5726322">var</span>&nbsp;<span class="ident" id="5726326">slashslash</span>&nbsp;<span class="op" id="5726337">=</span>&nbsp;<span class="op" id="5726339">[</span><span class="op" id="5726340">]</span><span class="builtintype" id="5726341">byte</span><span class="op" id="5726345">(</span><span class="string" id="5726346">&#34;//&#34;</span><span class="op" id="5726350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5726353">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="5726413">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="5726474">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="5726533">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="5726590">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="5726657">//</span><br>
<span class="lineno"></span><span class="comment" id="5726660">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="5726723">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="5726759">//</span><br>
<span class="lineno"></span><span class="comment" id="5726762">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="5726789">//</span><br>
<span class="lineno"></span><span class="comment" id="5726792">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="5726851">//</span><br>
<span class="lineno"></span><span class="keyword" id="5726854">func</span>&nbsp;<span class="op" id="5726859">(</span><span class="ident" id="5726860">ctxt</span>&nbsp;<span class="op" id="5726865">*</span><span class="ident" id="5726866">Context</span><span class="op" id="5726873">)</span>&nbsp;<span class="ident" id="5726875">shouldBuild</span><span class="op" id="5726886">(</span><span class="ident" id="5726887">content</span>&nbsp;<span class="op" id="5726895">[</span><span class="op" id="5726896">]</span><span class="builtintype" id="5726897">byte</span><span class="op" id="5726901">,</span>&nbsp;<span class="ident" id="5726903">allTags</span>&nbsp;<span class="keyword" id="5726911">map</span><span class="op" id="5726914">[</span><span class="builtintype" id="5726915">string</span><span class="op" id="5726921">]</span><span class="builtintype" id="5726922">bool</span><span class="op" id="5726926">)</span>&nbsp;<span class="builtintype" id="5726928">bool</span>&nbsp;<span class="op" id="5726933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5726936">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727001">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727045">end</span>&nbsp;<span class="op" id="5727049">:=</span>&nbsp;<span class="num" id="5727052">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727055">p</span>&nbsp;<span class="op" id="5727057">:=</span>&nbsp;<span class="ident" id="5727060">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727069">for</span>&nbsp;<span class="builtinfunc" id="5727073">len</span><span class="op" id="5727076">(</span><span class="ident" id="5727077">p</span><span class="op" id="5727078">)</span>&nbsp;<span class="op" id="5727080">&gt;</span>&nbsp;<span class="num" id="5727082">0</span>&nbsp;<span class="op" id="5727084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727088">line</span>&nbsp;<span class="op" id="5727093">:=</span>&nbsp;<span class="ident" id="5727096">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727100">if</span>&nbsp;<span class="ident" id="5727103">i</span>&nbsp;<span class="op" id="5727105">:=</span>&nbsp;<span class="ident" id="5727108">bytes</span><span class="op" id="5727113">.</span><span class="ident" id="5727114">IndexByte</span><span class="op" id="5727123">(</span><span class="ident" id="5727124">line</span><span class="op" id="5727128">,</span>&nbsp;<span class="string" id="5727130">&#39;\n&#39;</span><span class="op" id="5727134">)</span><span class="op" id="5727135">;</span>&nbsp;<span class="ident" id="5727137">i</span>&nbsp;<span class="op" id="5727139">&gt;=</span>&nbsp;<span class="num" id="5727142">0</span>&nbsp;<span class="op" id="5727144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727149">line</span><span class="op" id="5727153">,</span>&nbsp;<span class="ident" id="5727155">p</span>&nbsp;<span class="op" id="5727157">=</span>&nbsp;<span class="ident" id="5727159">line</span><span class="op" id="5727163">[</span><span class="op" id="5727164">:</span><span class="ident" id="5727165">i</span><span class="op" id="5727166">]</span><span class="op" id="5727167">,</span>&nbsp;<span class="ident" id="5727169">p</span><span class="op" id="5727170">[</span><span class="ident" id="5727171">i</span><span class="op" id="5727172">+</span><span class="num" id="5727173">1</span><span class="op" id="5727174">:</span><span class="op" id="5727175">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727179">}</span>&nbsp;<span class="keyword" id="5727181">else</span>&nbsp;<span class="op" id="5727186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727191">p</span>&nbsp;<span class="op" id="5727193">=</span>&nbsp;<span class="ident" id="5727195">p</span><span class="op" id="5727196">[</span><span class="builtinfunc" id="5727197">len</span><span class="op" id="5727200">(</span><span class="ident" id="5727201">p</span><span class="op" id="5727202">)</span><span class="op" id="5727203">:</span><span class="op" id="5727204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727212">line</span>&nbsp;<span class="op" id="5727217">=</span>&nbsp;<span class="ident" id="5727219">bytes</span><span class="op" id="5727224">.</span><span class="ident" id="5727225">TrimSpace</span><span class="op" id="5727234">(</span><span class="ident" id="5727235">line</span><span class="op" id="5727239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727243">if</span>&nbsp;<span class="builtinfunc" id="5727246">len</span><span class="op" id="5727249">(</span><span class="ident" id="5727250">line</span><span class="op" id="5727254">)</span>&nbsp;<span class="op" id="5727256">==</span>&nbsp;<span class="num" id="5727259">0</span>&nbsp;<span class="op" id="5727261">{</span>&nbsp;<span class="comment" id="5727263">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727280">end</span>&nbsp;<span class="op" id="5727284">=</span>&nbsp;<span class="builtinfunc" id="5727286">len</span><span class="op" id="5727289">(</span><span class="ident" id="5727290">content</span><span class="op" id="5727297">)</span>&nbsp;<span class="op" id="5727299">-</span>&nbsp;<span class="builtinfunc" id="5727301">len</span><span class="op" id="5727304">(</span><span class="ident" id="5727305">p</span><span class="op" id="5727306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727311">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727326">if</span>&nbsp;<span class="op" id="5727329">!</span><span class="ident" id="5727330">bytes</span><span class="op" id="5727335">.</span><span class="ident" id="5727336">HasPrefix</span><span class="op" id="5727345">(</span><span class="ident" id="5727346">line</span><span class="op" id="5727350">,</span>&nbsp;<span class="ident" id="5727352">slashslash</span><span class="op" id="5727362">)</span>&nbsp;<span class="op" id="5727364">{</span>&nbsp;<span class="comment" id="5727366">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727389">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727403">content</span>&nbsp;<span class="op" id="5727411">=</span>&nbsp;<span class="ident" id="5727413">content</span><span class="op" id="5727420">[</span><span class="op" id="5727421">:</span><span class="ident" id="5727422">end</span><span class="op" id="5727425">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727429">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727472">p</span>&nbsp;<span class="op" id="5727474">=</span>&nbsp;<span class="ident" id="5727476">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727485">allok</span>&nbsp;<span class="op" id="5727491">:=</span>&nbsp;<span class="builtintype" id="5727494">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727500">for</span>&nbsp;<span class="builtinfunc" id="5727504">len</span><span class="op" id="5727507">(</span><span class="ident" id="5727508">p</span><span class="op" id="5727509">)</span>&nbsp;<span class="op" id="5727511">&gt;</span>&nbsp;<span class="num" id="5727513">0</span>&nbsp;<span class="op" id="5727515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727519">line</span>&nbsp;<span class="op" id="5727524">:=</span>&nbsp;<span class="ident" id="5727527">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727531">if</span>&nbsp;<span class="ident" id="5727534">i</span>&nbsp;<span class="op" id="5727536">:=</span>&nbsp;<span class="ident" id="5727539">bytes</span><span class="op" id="5727544">.</span><span class="ident" id="5727545">IndexByte</span><span class="op" id="5727554">(</span><span class="ident" id="5727555">line</span><span class="op" id="5727559">,</span>&nbsp;<span class="string" id="5727561">&#39;\n&#39;</span><span class="op" id="5727565">)</span><span class="op" id="5727566">;</span>&nbsp;<span class="ident" id="5727568">i</span>&nbsp;<span class="op" id="5727570">&gt;=</span>&nbsp;<span class="num" id="5727573">0</span>&nbsp;<span class="op" id="5727575">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727580">line</span><span class="op" id="5727584">,</span>&nbsp;<span class="ident" id="5727586">p</span>&nbsp;<span class="op" id="5727588">=</span>&nbsp;<span class="ident" id="5727590">line</span><span class="op" id="5727594">[</span><span class="op" id="5727595">:</span><span class="ident" id="5727596">i</span><span class="op" id="5727597">]</span><span class="op" id="5727598">,</span>&nbsp;<span class="ident" id="5727600">p</span><span class="op" id="5727601">[</span><span class="ident" id="5727602">i</span><span class="op" id="5727603">+</span><span class="num" id="5727604">1</span><span class="op" id="5727605">:</span><span class="op" id="5727606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727610">}</span>&nbsp;<span class="keyword" id="5727612">else</span>&nbsp;<span class="op" id="5727617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727622">p</span>&nbsp;<span class="op" id="5727624">=</span>&nbsp;<span class="ident" id="5727626">p</span><span class="op" id="5727627">[</span><span class="builtinfunc" id="5727628">len</span><span class="op" id="5727631">(</span><span class="ident" id="5727632">p</span><span class="op" id="5727633">)</span><span class="op" id="5727634">:</span><span class="op" id="5727635">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727643">line</span>&nbsp;<span class="op" id="5727648">=</span>&nbsp;<span class="ident" id="5727650">bytes</span><span class="op" id="5727655">.</span><span class="ident" id="5727656">TrimSpace</span><span class="op" id="5727665">(</span><span class="ident" id="5727666">line</span><span class="op" id="5727670">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727674">if</span>&nbsp;<span class="ident" id="5727677">bytes</span><span class="op" id="5727682">.</span><span class="ident" id="5727683">HasPrefix</span><span class="op" id="5727692">(</span><span class="ident" id="5727693">line</span><span class="op" id="5727697">,</span>&nbsp;<span class="ident" id="5727699">slashslash</span><span class="op" id="5727709">)</span>&nbsp;<span class="op" id="5727711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727716">line</span>&nbsp;<span class="op" id="5727721">=</span>&nbsp;<span class="ident" id="5727723">bytes</span><span class="op" id="5727728">.</span><span class="ident" id="5727729">TrimSpace</span><span class="op" id="5727738">(</span><span class="ident" id="5727739">line</span><span class="op" id="5727743">[</span><span class="builtinfunc" id="5727744">len</span><span class="op" id="5727747">(</span><span class="ident" id="5727748">slashslash</span><span class="op" id="5727758">)</span><span class="op" id="5727759">:</span><span class="op" id="5727760">]</span><span class="op" id="5727761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727766">if</span>&nbsp;<span class="builtinfunc" id="5727769">len</span><span class="op" id="5727772">(</span><span class="ident" id="5727773">line</span><span class="op" id="5727777">)</span>&nbsp;<span class="op" id="5727779">&gt;</span>&nbsp;<span class="num" id="5727781">0</span>&nbsp;<span class="op" id="5727783">&amp;&amp;</span>&nbsp;<span class="ident" id="5727786">line</span><span class="op" id="5727790">[</span><span class="num" id="5727791">0</span><span class="op" id="5727792">]</span>&nbsp;<span class="op" id="5727794">==</span>&nbsp;<span class="string" id="5727797">&#39;+&#39;</span>&nbsp;<span class="op" id="5727801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727807">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727842">f</span>&nbsp;<span class="op" id="5727844">:=</span>&nbsp;<span class="ident" id="5727847">strings</span><span class="op" id="5727854">.</span><span class="ident" id="5727855">Fields</span><span class="op" id="5727861">(</span><span class="builtintype" id="5727862">string</span><span class="op" id="5727868">(</span><span class="ident" id="5727869">line</span><span class="op" id="5727873">)</span><span class="op" id="5727874">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727880">if</span>&nbsp;<span class="ident" id="5727883">f</span><span class="op" id="5727884">[</span><span class="num" id="5727885">0</span><span class="op" id="5727886">]</span>&nbsp;<span class="op" id="5727888">==</span>&nbsp;<span class="string" id="5727891">&#34;+build&#34;</span>&nbsp;<span class="op" id="5727900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727907">ok</span>&nbsp;<span class="op" id="5727910">:=</span>&nbsp;<span class="builtintype" id="5727913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727924">for</span>&nbsp;<span class="ident" id="5727928">_</span><span class="op" id="5727929">,</span>&nbsp;<span class="ident" id="5727931">tok</span>&nbsp;<span class="op" id="5727935">:=</span>&nbsp;<span class="keyword" id="5727938">range</span>&nbsp;<span class="ident" id="5727944">f</span><span class="op" id="5727945">[</span><span class="num" id="5727946">1</span><span class="op" id="5727947">:</span><span class="op" id="5727948">]</span>&nbsp;<span class="op" id="5727950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727958">if</span>&nbsp;<span class="ident" id="5727961">ctxt</span><span class="op" id="5727965">.</span><span class="ident" id="5727966">match</span><span class="op" id="5727971">(</span><span class="ident" id="5727972">tok</span><span class="op" id="5727975">,</span>&nbsp;<span class="ident" id="5727977">allTags</span><span class="op" id="5727984">)</span>&nbsp;<span class="op" id="5727986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727995">ok</span>&nbsp;<span class="op" id="5727998">=</span>&nbsp;<span class="builtintype" id="5728000">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728025">if</span>&nbsp;<span class="op" id="5728028">!</span><span class="ident" id="5728029">ok</span>&nbsp;<span class="op" id="5728032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728040">allok</span>&nbsp;<span class="op" id="5728046">=</span>&nbsp;<span class="builtintype" id="5728048">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728059">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728081">return</span>&nbsp;<span class="ident" id="5728088">allok</span><br>
<span class="lineno"></span><span class="op" id="5728094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5728097">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5728177">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="5728261">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="5728307">//</span><br>
<span class="lineno"></span><span class="comment" id="5728310">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="5728353">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="5728406">func</span>&nbsp;<span class="op" id="5728411">(</span><span class="ident" id="5728412">ctxt</span>&nbsp;<span class="op" id="5728417">*</span><span class="ident" id="5728418">Context</span><span class="op" id="5728425">)</span>&nbsp;<span class="ident" id="5728427">saveCgo</span><span class="op" id="5728434">(</span><span class="ident" id="5728435">filename</span>&nbsp;<span class="builtintype" id="5728444">string</span><span class="op" id="5728450">,</span>&nbsp;<span class="ident" id="5728452">di</span>&nbsp;<span class="op" id="5728455">*</span><span class="ident" id="5728456">Package</span><span class="op" id="5728463">,</span>&nbsp;<span class="ident" id="5728465">cg</span>&nbsp;<span class="op" id="5728468">*</span><span class="ident" id="5728469">ast</span><span class="op" id="5728472">.</span><span class="ident" id="5728473">CommentGroup</span><span class="op" id="5728485">)</span>&nbsp;<span class="builtintype" id="5728487">error</span>&nbsp;<span class="op" id="5728493">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728496">text</span>&nbsp;<span class="op" id="5728501">:=</span>&nbsp;<span class="ident" id="5728504">cg</span><span class="op" id="5728506">.</span><span class="ident" id="5728507">Text</span><span class="op" id="5728511">(</span><span class="op" id="5728512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728515">for</span>&nbsp;<span class="ident" id="5728519">_</span><span class="op" id="5728520">,</span>&nbsp;<span class="ident" id="5728522">line</span>&nbsp;<span class="op" id="5728527">:=</span>&nbsp;<span class="keyword" id="5728530">range</span>&nbsp;<span class="ident" id="5728536">strings</span><span class="op" id="5728543">.</span><span class="ident" id="5728544">Split</span><span class="op" id="5728549">(</span><span class="ident" id="5728550">text</span><span class="op" id="5728554">,</span>&nbsp;<span class="string" id="5728556">&#34;\n&#34;</span><span class="op" id="5728560">)</span>&nbsp;<span class="op" id="5728562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728566">orig</span>&nbsp;<span class="op" id="5728571">:=</span>&nbsp;<span class="ident" id="5728574">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728582">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728595">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728637">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728642">line</span>&nbsp;<span class="op" id="5728647">=</span>&nbsp;<span class="ident" id="5728649">strings</span><span class="op" id="5728656">.</span><span class="ident" id="5728657">TrimSpace</span><span class="op" id="5728666">(</span><span class="ident" id="5728667">line</span><span class="op" id="5728671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728675">if</span>&nbsp;<span class="builtinfunc" id="5728678">len</span><span class="op" id="5728681">(</span><span class="ident" id="5728682">line</span><span class="op" id="5728686">)</span>&nbsp;<span class="op" id="5728688">&lt;</span>&nbsp;<span class="num" id="5728690">5</span>&nbsp;<span class="op" id="5728692">||</span>&nbsp;<span class="ident" id="5728695">line</span><span class="op" id="5728699">[</span><span class="op" id="5728700">:</span><span class="num" id="5728701">4</span><span class="op" id="5728702">]</span>&nbsp;<span class="op" id="5728704">!=</span>&nbsp;<span class="string" id="5728707">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="5728714">||</span>&nbsp;<span class="op" id="5728717">(</span><span class="ident" id="5728718">line</span><span class="op" id="5728722">[</span><span class="num" id="5728723">4</span><span class="op" id="5728724">]</span>&nbsp;<span class="op" id="5728726">!=</span>&nbsp;<span class="string" id="5728729">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5728733">&amp;&amp;</span>&nbsp;<span class="ident" id="5728736">line</span><span class="op" id="5728740">[</span><span class="num" id="5728741">4</span><span class="op" id="5728742">]</span>&nbsp;<span class="op" id="5728744">!=</span>&nbsp;<span class="string" id="5728747">&#39;\t&#39;</span><span class="op" id="5728751">)</span>&nbsp;<span class="op" id="5728753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728758">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728774">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728795">line</span>&nbsp;<span class="op" id="5728800">=</span>&nbsp;<span class="ident" id="5728802">strings</span><span class="op" id="5728809">.</span><span class="ident" id="5728810">TrimSpace</span><span class="op" id="5728819">(</span><span class="ident" id="5728820">line</span><span class="op" id="5728824">[</span><span class="num" id="5728825">4</span><span class="op" id="5728826">:</span><span class="op" id="5728827">]</span><span class="op" id="5728828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728832">i</span>&nbsp;<span class="op" id="5728834">:=</span>&nbsp;<span class="ident" id="5728837">strings</span><span class="op" id="5728844">.</span><span class="ident" id="5728845">Index</span><span class="op" id="5728850">(</span><span class="ident" id="5728851">line</span><span class="op" id="5728855">,</span>&nbsp;<span class="string" id="5728857">&#34;:&#34;</span><span class="op" id="5728860">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728864">if</span>&nbsp;<span class="ident" id="5728867">i</span>&nbsp;<span class="op" id="5728869">&lt;</span>&nbsp;<span class="num" id="5728871">0</span>&nbsp;<span class="op" id="5728873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728878">return</span>&nbsp;<span class="ident" id="5728885">fmt</span><span class="op" id="5728888">.</span><span class="ident" id="5728889">Errorf</span><span class="op" id="5728895">(</span><span class="string" id="5728896">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5728923">,</span>&nbsp;<span class="ident" id="5728925">filename</span><span class="op" id="5728933">,</span>&nbsp;<span class="ident" id="5728935">orig</span><span class="op" id="5728939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728947">line</span><span class="op" id="5728951">,</span>&nbsp;<span class="ident" id="5728953">argstr</span>&nbsp;<span class="op" id="5728960">:=</span>&nbsp;<span class="ident" id="5728963">line</span><span class="op" id="5728967">[</span><span class="op" id="5728968">:</span><span class="ident" id="5728969">i</span><span class="op" id="5728970">]</span><span class="op" id="5728971">,</span>&nbsp;<span class="ident" id="5728973">line</span><span class="op" id="5728977">[</span><span class="ident" id="5728978">i</span><span class="op" id="5728979">+</span><span class="num" id="5728980">1</span><span class="op" id="5728981">:</span><span class="op" id="5728982">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728987">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729017">f</span>&nbsp;<span class="op" id="5729019">:=</span>&nbsp;<span class="ident" id="5729022">strings</span><span class="op" id="5729029">.</span><span class="ident" id="5729030">Fields</span><span class="op" id="5729036">(</span><span class="ident" id="5729037">line</span><span class="op" id="5729041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729045">if</span>&nbsp;<span class="builtinfunc" id="5729048">len</span><span class="op" id="5729051">(</span><span class="ident" id="5729052">f</span><span class="op" id="5729053">)</span>&nbsp;<span class="op" id="5729055">&lt;</span>&nbsp;<span class="num" id="5729057">1</span>&nbsp;<span class="op" id="5729059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729064">return</span>&nbsp;<span class="ident" id="5729071">fmt</span><span class="op" id="5729074">.</span><span class="ident" id="5729075">Errorf</span><span class="op" id="5729081">(</span><span class="string" id="5729082">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5729109">,</span>&nbsp;<span class="ident" id="5729111">filename</span><span class="op" id="5729119">,</span>&nbsp;<span class="ident" id="5729121">orig</span><span class="op" id="5729125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729129">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729134">cond</span><span class="op" id="5729138">,</span>&nbsp;<span class="ident" id="5729140">verb</span>&nbsp;<span class="op" id="5729145">:=</span>&nbsp;<span class="ident" id="5729148">f</span><span class="op" id="5729149">[</span><span class="op" id="5729150">:</span><span class="builtinfunc" id="5729151">len</span><span class="op" id="5729154">(</span><span class="ident" id="5729155">f</span><span class="op" id="5729156">)</span><span class="op" id="5729157">-</span><span class="num" id="5729158">1</span><span class="op" id="5729159">]</span><span class="op" id="5729160">,</span>&nbsp;<span class="ident" id="5729162">f</span><span class="op" id="5729163">[</span><span class="builtinfunc" id="5729164">len</span><span class="op" id="5729167">(</span><span class="ident" id="5729168">f</span><span class="op" id="5729169">)</span><span class="op" id="5729170">-</span><span class="num" id="5729171">1</span><span class="op" id="5729172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729176">if</span>&nbsp;<span class="builtinfunc" id="5729179">len</span><span class="op" id="5729182">(</span><span class="ident" id="5729183">cond</span><span class="op" id="5729187">)</span>&nbsp;<span class="op" id="5729189">&gt;</span>&nbsp;<span class="num" id="5729191">0</span>&nbsp;<span class="op" id="5729193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729198">ok</span>&nbsp;<span class="op" id="5729201">:=</span>&nbsp;<span class="builtintype" id="5729204">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729213">for</span>&nbsp;<span class="ident" id="5729217">_</span><span class="op" id="5729218">,</span>&nbsp;<span class="ident" id="5729220">c</span>&nbsp;<span class="op" id="5729222">:=</span>&nbsp;<span class="keyword" id="5729225">range</span>&nbsp;<span class="ident" id="5729231">cond</span>&nbsp;<span class="op" id="5729236">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729242">if</span>&nbsp;<span class="ident" id="5729245">ctxt</span><span class="op" id="5729249">.</span><span class="ident" id="5729250">match</span><span class="op" id="5729255">(</span><span class="ident" id="5729256">c</span><span class="op" id="5729257">,</span>&nbsp;<span class="ident" id="5729259">nil</span><span class="op" id="5729262">)</span>&nbsp;<span class="op" id="5729264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729271">ok</span>&nbsp;<span class="op" id="5729274">=</span>&nbsp;<span class="builtintype" id="5729276">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729286">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729301">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729306">if</span>&nbsp;<span class="op" id="5729309">!</span><span class="ident" id="5729310">ok</span>&nbsp;<span class="op" id="5729313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729319">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729340">args</span><span class="op" id="5729344">,</span>&nbsp;<span class="ident" id="5729346">err</span>&nbsp;<span class="op" id="5729350">:=</span>&nbsp;<span class="ident" id="5729353">splitQuoted</span><span class="op" id="5729364">(</span><span class="ident" id="5729365">argstr</span><span class="op" id="5729371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729375">if</span>&nbsp;<span class="ident" id="5729378">err</span>&nbsp;<span class="op" id="5729382">!=</span>&nbsp;<span class="ident" id="5729385">nil</span>&nbsp;<span class="op" id="5729389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729394">return</span>&nbsp;<span class="ident" id="5729401">fmt</span><span class="op" id="5729404">.</span><span class="ident" id="5729405">Errorf</span><span class="op" id="5729411">(</span><span class="string" id="5729412">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5729439">,</span>&nbsp;<span class="ident" id="5729441">filename</span><span class="op" id="5729449">,</span>&nbsp;<span class="ident" id="5729451">orig</span><span class="op" id="5729455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729463">for</span>&nbsp;<span class="ident" id="5729467">_</span><span class="op" id="5729468">,</span>&nbsp;<span class="ident" id="5729470">arg</span>&nbsp;<span class="op" id="5729474">:=</span>&nbsp;<span class="keyword" id="5729477">range</span>&nbsp;<span class="ident" id="5729483">args</span>&nbsp;<span class="op" id="5729488">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729493">if</span>&nbsp;<span class="op" id="5729496">!</span><span class="ident" id="5729497">safeCgoName</span><span class="op" id="5729508">(</span><span class="ident" id="5729509">arg</span><span class="op" id="5729512">)</span>&nbsp;<span class="op" id="5729514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729520">return</span>&nbsp;<span class="ident" id="5729527">fmt</span><span class="op" id="5729530">.</span><span class="ident" id="5729531">Errorf</span><span class="op" id="5729537">(</span><span class="string" id="5729538">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="5729571">,</span>&nbsp;<span class="ident" id="5729573">filename</span><span class="op" id="5729581">,</span>&nbsp;<span class="ident" id="5729583">arg</span><span class="op" id="5729586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5729595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729600">switch</span>&nbsp;<span class="ident" id="5729607">verb</span>&nbsp;<span class="op" id="5729612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729616">case</span>&nbsp;<span class="string" id="5729621">&#34;CFLAGS&#34;</span><span class="op" id="5729629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729634">di</span><span class="op" id="5729636">.</span><span class="ident" id="5729637">CgoCFLAGS</span>&nbsp;<span class="op" id="5729647">=</span>&nbsp;<span class="builtinfunc" id="5729649">append</span><span class="op" id="5729655">(</span><span class="ident" id="5729656">di</span><span class="op" id="5729658">.</span><span class="ident" id="5729659">CgoCFLAGS</span><span class="op" id="5729668">,</span>&nbsp;<span class="ident" id="5729670">args</span><span class="op" id="5729674">...</span><span class="op" id="5729677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729681">case</span>&nbsp;<span class="string" id="5729686">&#34;CPPFLAGS&#34;</span><span class="op" id="5729696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729701">di</span><span class="op" id="5729703">.</span><span class="ident" id="5729704">CgoCPPFLAGS</span>&nbsp;<span class="op" id="5729716">=</span>&nbsp;<span class="builtinfunc" id="5729718">append</span><span class="op" id="5729724">(</span><span class="ident" id="5729725">di</span><span class="op" id="5729727">.</span><span class="ident" id="5729728">CgoCPPFLAGS</span><span class="op" id="5729739">,</span>&nbsp;<span class="ident" id="5729741">args</span><span class="op" id="5729745">...</span><span class="op" id="5729748">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729752">case</span>&nbsp;<span class="string" id="5729757">&#34;CXXFLAGS&#34;</span><span class="op" id="5729767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729772">di</span><span class="op" id="5729774">.</span><span class="ident" id="5729775">CgoCXXFLAGS</span>&nbsp;<span class="op" id="5729787">=</span>&nbsp;<span class="builtinfunc" id="5729789">append</span><span class="op" id="5729795">(</span><span class="ident" id="5729796">di</span><span class="op" id="5729798">.</span><span class="ident" id="5729799">CgoCXXFLAGS</span><span class="op" id="5729810">,</span>&nbsp;<span class="ident" id="5729812">args</span><span class="op" id="5729816">...</span><span class="op" id="5729819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729823">case</span>&nbsp;<span class="string" id="5729828">&#34;LDFLAGS&#34;</span><span class="op" id="5729837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729842">di</span><span class="op" id="5729844">.</span><span class="ident" id="5729845">CgoLDFLAGS</span>&nbsp;<span class="op" id="5729856">=</span>&nbsp;<span class="builtinfunc" id="5729858">append</span><span class="op" id="5729864">(</span><span class="ident" id="5729865">di</span><span class="op" id="5729867">.</span><span class="ident" id="5729868">CgoLDFLAGS</span><span class="op" id="5729878">,</span>&nbsp;<span class="ident" id="5729880">args</span><span class="op" id="5729884">...</span><span class="op" id="5729887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729891">case</span>&nbsp;<span class="string" id="5729896">&#34;pkg-config&#34;</span><span class="op" id="5729908">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5729913">di</span><span class="op" id="5729915">.</span><span class="ident" id="5729916">CgoPkgConfig</span>&nbsp;<span class="op" id="5729929">=</span>&nbsp;<span class="builtinfunc" id="5729931">append</span><span class="op" id="5729937">(</span><span class="ident" id="5729938">di</span><span class="op" id="5729940">.</span><span class="ident" id="5729941">CgoPkgConfig</span><span class="op" id="5729953">,</span>&nbsp;<span class="ident" id="5729955">args</span><span class="op" id="5729959">...</span><span class="op" id="5729962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729966">default</span><span class="op" id="5729973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5729978">return</span>&nbsp;<span class="ident" id="5729985">fmt</span><span class="op" id="5729988">.</span><span class="ident" id="5729989">Errorf</span><span class="op" id="5729995">(</span><span class="string" id="5729996">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="5730023">,</span>&nbsp;<span class="ident" id="5730025">filename</span><span class="op" id="5730033">,</span>&nbsp;<span class="ident" id="5730035">orig</span><span class="op" id="5730039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5730043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5730046">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730049">return</span>&nbsp;<span class="ident" id="5730056">nil</span><br>
<span class="lineno"></span><span class="op" id="5730060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5730063">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="5730168">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="5730278">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="5730308">var</span>&nbsp;<span class="ident" id="5730312">safeBytes</span>&nbsp;<span class="op" id="5730322">=</span>&nbsp;<span class="op" id="5730324">[</span><span class="op" id="5730325">]</span><span class="builtintype" id="5730326">byte</span><span class="op" id="5730330">(</span><span class="string" id="5730331">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="5730404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5730407">func</span>&nbsp;<span class="ident" id="5730412">safeCgoName</span><span class="op" id="5730423">(</span><span class="ident" id="5730424">s</span>&nbsp;<span class="builtintype" id="5730426">string</span><span class="op" id="5730432">)</span>&nbsp;<span class="builtintype" id="5730434">bool</span>&nbsp;<span class="op" id="5730439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730442">if</span>&nbsp;<span class="ident" id="5730445">s</span>&nbsp;<span class="op" id="5730447">==</span>&nbsp;<span class="string" id="5730450">&#34;&#34;</span>&nbsp;<span class="op" id="5730453">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730457">return</span>&nbsp;<span class="builtintype" id="5730464">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5730471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730474">for</span>&nbsp;<span class="ident" id="5730478">i</span>&nbsp;<span class="op" id="5730480">:=</span>&nbsp;<span class="num" id="5730483">0</span><span class="op" id="5730484">;</span>&nbsp;<span class="ident" id="5730486">i</span>&nbsp;<span class="op" id="5730488">&lt;</span>&nbsp;<span class="builtinfunc" id="5730490">len</span><span class="op" id="5730493">(</span><span class="ident" id="5730494">s</span><span class="op" id="5730495">)</span><span class="op" id="5730496">;</span>&nbsp;<span class="ident" id="5730498">i</span><span class="op" id="5730499">++</span>&nbsp;<span class="op" id="5730502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730506">if</span>&nbsp;<span class="ident" id="5730509">c</span>&nbsp;<span class="op" id="5730511">:=</span>&nbsp;<span class="ident" id="5730514">s</span><span class="op" id="5730515">[</span><span class="ident" id="5730516">i</span><span class="op" id="5730517">]</span><span class="op" id="5730518">;</span>&nbsp;<span class="ident" id="5730520">c</span>&nbsp;<span class="op" id="5730522">&lt;</span>&nbsp;<span class="num" id="5730524">0x80</span>&nbsp;<span class="op" id="5730529">&amp;&amp;</span>&nbsp;<span class="ident" id="5730532">bytes</span><span class="op" id="5730537">.</span><span class="ident" id="5730538">IndexByte</span><span class="op" id="5730547">(</span><span class="ident" id="5730548">safeBytes</span><span class="op" id="5730557">,</span>&nbsp;<span class="ident" id="5730559">c</span><span class="op" id="5730560">)</span>&nbsp;<span class="op" id="5730562">&lt;</span>&nbsp;<span class="num" id="5730564">0</span>&nbsp;<span class="op" id="5730566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730571">return</span>&nbsp;<span class="builtintype" id="5730578">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5730586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5730589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5730592">return</span>&nbsp;<span class="builtintype" id="5730599">true</span><br>
<span class="lineno"></span><span class="op" id="5730604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="5730607">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="5730690">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5730767">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="5730855">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5730937">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="5731018">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5731095">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="5731149">//</span><br>
<span class="lineno"></span><span class="comment" id="5731152">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="5731190">//</span><br>
<span class="lineno">1170</span><span class="comment" id="5731193">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5731224">//</span><br>
<span class="lineno"></span><span class="comment" id="5731227">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="5731250">//</span><br>
<span class="lineno"></span><span class="comment" id="5731253">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="5731295">//</span><br>
<span class="lineno"></span><span class="keyword" id="5731298">func</span>&nbsp;<span class="ident" id="5731303">splitQuoted</span><span class="op" id="5731314">(</span><span class="ident" id="5731315">s</span>&nbsp;<span class="builtintype" id="5731317">string</span><span class="op" id="5731323">)</span>&nbsp;<span class="op" id="5731325">(</span><span class="ident" id="5731326">r</span>&nbsp;<span class="op" id="5731328">[</span><span class="op" id="5731329">]</span><span class="builtintype" id="5731330">string</span><span class="op" id="5731336">,</span>&nbsp;<span class="ident" id="5731338">err</span>&nbsp;<span class="builtintype" id="5731342">error</span><span class="op" id="5731347">)</span>&nbsp;<span class="op" id="5731349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731352">var</span>&nbsp;<span class="ident" id="5731356">args</span>&nbsp;<span class="op" id="5731361">[</span><span class="op" id="5731362">]</span><span class="builtintype" id="5731363">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731371">arg</span>&nbsp;<span class="op" id="5731375">:=</span>&nbsp;<span class="builtinfunc" id="5731378">make</span><span class="op" id="5731382">(</span><span class="op" id="5731383">[</span><span class="op" id="5731384">]</span><span class="builtintype" id="5731385">rune</span><span class="op" id="5731389">,</span>&nbsp;<span class="builtinfunc" id="5731391">len</span><span class="op" id="5731394">(</span><span class="ident" id="5731395">s</span><span class="op" id="5731396">)</span><span class="op" id="5731397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731400">escaped</span>&nbsp;<span class="op" id="5731408">:=</span>&nbsp;<span class="builtintype" id="5731411">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731418">quoted</span>&nbsp;<span class="op" id="5731425">:=</span>&nbsp;<span class="builtintype" id="5731428">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731435">quote</span>&nbsp;<span class="op" id="5731441">:=</span>&nbsp;<span class="string" id="5731444">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731452">i</span>&nbsp;<span class="op" id="5731454">:=</span>&nbsp;<span class="num" id="5731457">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731460">for</span>&nbsp;<span class="ident" id="5731464">_</span><span class="op" id="5731465">,</span>&nbsp;<span class="builtintype" id="5731467">rune</span>&nbsp;<span class="op" id="5731472">:=</span>&nbsp;<span class="keyword" id="5731475">range</span>&nbsp;<span class="ident" id="5731481">s</span>&nbsp;<span class="op" id="5731483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731487">switch</span>&nbsp;<span class="op" id="5731494">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731498">case</span>&nbsp;<span class="ident" id="5731503">escaped</span><span class="op" id="5731510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731515">escaped</span>&nbsp;<span class="op" id="5731523">=</span>&nbsp;<span class="builtintype" id="5731525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731533">case</span>&nbsp;<span class="builtintype" id="5731538">rune</span>&nbsp;<span class="op" id="5731543">==</span>&nbsp;<span class="string" id="5731546">&#39;\\&#39;</span><span class="op" id="5731550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731555">escaped</span>&nbsp;<span class="op" id="5731563">=</span>&nbsp;<span class="builtintype" id="5731565">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731573">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731584">case</span>&nbsp;<span class="ident" id="5731589">quote</span>&nbsp;<span class="op" id="5731595">!=</span>&nbsp;<span class="string" id="5731598">&#39;\x00&#39;</span><span class="op" id="5731604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731609">if</span>&nbsp;<span class="builtintype" id="5731612">rune</span>&nbsp;<span class="op" id="5731617">==</span>&nbsp;<span class="ident" id="5731620">quote</span>&nbsp;<span class="op" id="5731626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731632">quote</span>&nbsp;<span class="op" id="5731638">=</span>&nbsp;<span class="string" id="5731640">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731651">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731663">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731667">case</span>&nbsp;<span class="builtintype" id="5731672">rune</span>&nbsp;<span class="op" id="5731677">==</span>&nbsp;<span class="string" id="5731680">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5731684">||</span>&nbsp;<span class="builtintype" id="5731687">rune</span>&nbsp;<span class="op" id="5731692">==</span>&nbsp;<span class="string" id="5731695">&#39;\&#39;&#39;</span><span class="op" id="5731699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731704">quoted</span>&nbsp;<span class="op" id="5731711">=</span>&nbsp;<span class="builtintype" id="5731713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731721">quote</span>&nbsp;<span class="op" id="5731727">=</span>&nbsp;<span class="builtintype" id="5731729">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731737">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731748">case</span>&nbsp;<span class="ident" id="5731753">unicode</span><span class="op" id="5731760">.</span><span class="ident" id="5731761">IsSpace</span><span class="op" id="5731768">(</span><span class="builtintype" id="5731769">rune</span><span class="op" id="5731773">)</span><span class="op" id="5731774">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731779">if</span>&nbsp;<span class="ident" id="5731782">quoted</span>&nbsp;<span class="op" id="5731789">||</span>&nbsp;<span class="ident" id="5731792">i</span>&nbsp;<span class="op" id="5731794">&gt;</span>&nbsp;<span class="num" id="5731796">0</span>&nbsp;<span class="op" id="5731798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731804">quoted</span>&nbsp;<span class="op" id="5731811">=</span>&nbsp;<span class="builtintype" id="5731813">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731823">args</span>&nbsp;<span class="op" id="5731828">=</span>&nbsp;<span class="builtinfunc" id="5731830">append</span><span class="op" id="5731836">(</span><span class="ident" id="5731837">args</span><span class="op" id="5731841">,</span>&nbsp;<span class="builtintype" id="5731843">string</span><span class="op" id="5731849">(</span><span class="ident" id="5731850">arg</span><span class="op" id="5731853">[</span><span class="op" id="5731854">:</span><span class="ident" id="5731855">i</span><span class="op" id="5731856">]</span><span class="op" id="5731857">)</span><span class="op" id="5731858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731864">i</span>&nbsp;<span class="op" id="5731866">=</span>&nbsp;<span class="num" id="5731868">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731873">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731878">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731893">arg</span><span class="op" id="5731896">[</span><span class="ident" id="5731897">i</span><span class="op" id="5731898">]</span>&nbsp;<span class="op" id="5731900">=</span>&nbsp;<span class="builtintype" id="5731902">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731909">i</span><span class="op" id="5731910">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731914">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731917">if</span>&nbsp;<span class="ident" id="5731920">quoted</span>&nbsp;<span class="op" id="5731927">||</span>&nbsp;<span class="ident" id="5731930">i</span>&nbsp;<span class="op" id="5731932">&gt;</span>&nbsp;<span class="num" id="5731934">0</span>&nbsp;<span class="op" id="5731936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731940">args</span>&nbsp;<span class="op" id="5731945">=</span>&nbsp;<span class="builtinfunc" id="5731947">append</span><span class="op" id="5731953">(</span><span class="ident" id="5731954">args</span><span class="op" id="5731958">,</span>&nbsp;<span class="builtintype" id="5731960">string</span><span class="op" id="5731966">(</span><span class="ident" id="5731967">arg</span><span class="op" id="5731970">[</span><span class="op" id="5731971">:</span><span class="ident" id="5731972">i</span><span class="op" id="5731973">]</span><span class="op" id="5731974">)</span><span class="op" id="5731975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5731978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5731981">if</span>&nbsp;<span class="ident" id="5731984">quote</span>&nbsp;<span class="op" id="5731990">!=</span>&nbsp;<span class="num" id="5731993">0</span>&nbsp;<span class="op" id="5731995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5731999">err</span>&nbsp;<span class="op" id="5732003">=</span>&nbsp;<span class="ident" id="5732005">errors</span><span class="op" id="5732011">.</span><span class="ident" id="5732012">New</span><span class="op" id="5732015">(</span><span class="string" id="5732016">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="5732032">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732035">}</span>&nbsp;<span class="keyword" id="5732037">else</span>&nbsp;<span class="keyword" id="5732042">if</span>&nbsp;<span class="ident" id="5732045">escaped</span>&nbsp;<span class="op" id="5732053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732057">err</span>&nbsp;<span class="op" id="5732061">=</span>&nbsp;<span class="ident" id="5732063">errors</span><span class="op" id="5732069">.</span><span class="ident" id="5732070">New</span><span class="op" id="5732073">(</span><span class="string" id="5732074">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="5732095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732101">return</span>&nbsp;<span class="ident" id="5732108">args</span><span class="op" id="5732112">,</span>&nbsp;<span class="ident" id="5732114">err</span><br>
<span class="lineno"></span><span class="op" id="5732118">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="5732121">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="5732166">//</span><br>
<span class="lineno"></span><span class="comment" id="5732169">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="5732178">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="5732189">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="5732216">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="5732245">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5732262">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5732280">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="5732344">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="5732413">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5732455">//</span><br>
<span class="lineno"></span><span class="keyword" id="5732458">func</span>&nbsp;<span class="op" id="5732463">(</span><span class="ident" id="5732464">ctxt</span>&nbsp;<span class="op" id="5732469">*</span><span class="ident" id="5732470">Context</span><span class="op" id="5732477">)</span>&nbsp;<span class="ident" id="5732479">match</span><span class="op" id="5732484">(</span><span class="ident" id="5732485">name</span>&nbsp;<span class="builtintype" id="5732490">string</span><span class="op" id="5732496">,</span>&nbsp;<span class="ident" id="5732498">allTags</span>&nbsp;<span class="keyword" id="5732506">map</span><span class="op" id="5732509">[</span><span class="builtintype" id="5732510">string</span><span class="op" id="5732516">]</span><span class="builtintype" id="5732517">bool</span><span class="op" id="5732521">)</span>&nbsp;<span class="builtintype" id="5732523">bool</span>&nbsp;<span class="op" id="5732528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732531">if</span>&nbsp;<span class="ident" id="5732534">name</span>&nbsp;<span class="op" id="5732539">==</span>&nbsp;<span class="string" id="5732542">&#34;&#34;</span>&nbsp;<span class="op" id="5732545">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732549">if</span>&nbsp;<span class="ident" id="5732552">allTags</span>&nbsp;<span class="op" id="5732560">!=</span>&nbsp;<span class="ident" id="5732563">nil</span>&nbsp;<span class="op" id="5732567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732572">allTags</span><span class="op" id="5732579">[</span><span class="ident" id="5732580">name</span><span class="op" id="5732584">]</span>&nbsp;<span class="op" id="5732586">=</span>&nbsp;<span class="builtintype" id="5732588">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732599">return</span>&nbsp;<span class="builtintype" id="5732606">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732613">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732616">if</span>&nbsp;<span class="ident" id="5732619">i</span>&nbsp;<span class="op" id="5732621">:=</span>&nbsp;<span class="ident" id="5732624">strings</span><span class="op" id="5732631">.</span><span class="ident" id="5732632">Index</span><span class="op" id="5732637">(</span><span class="ident" id="5732638">name</span><span class="op" id="5732642">,</span>&nbsp;<span class="string" id="5732644">&#34;,&#34;</span><span class="op" id="5732647">)</span><span class="op" id="5732648">;</span>&nbsp;<span class="ident" id="5732650">i</span>&nbsp;<span class="op" id="5732652">&gt;=</span>&nbsp;<span class="num" id="5732655">0</span>&nbsp;<span class="op" id="5732657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5732661">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732687">ok1</span>&nbsp;<span class="op" id="5732691">:=</span>&nbsp;<span class="ident" id="5732694">ctxt</span><span class="op" id="5732698">.</span><span class="ident" id="5732699">match</span><span class="op" id="5732704">(</span><span class="ident" id="5732705">name</span><span class="op" id="5732709">[</span><span class="op" id="5732710">:</span><span class="ident" id="5732711">i</span><span class="op" id="5732712">]</span><span class="op" id="5732713">,</span>&nbsp;<span class="ident" id="5732715">allTags</span><span class="op" id="5732722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5732726">ok2</span>&nbsp;<span class="op" id="5732730">:=</span>&nbsp;<span class="ident" id="5732733">ctxt</span><span class="op" id="5732737">.</span><span class="ident" id="5732738">match</span><span class="op" id="5732743">(</span><span class="ident" id="5732744">name</span><span class="op" id="5732748">[</span><span class="ident" id="5732749">i</span><span class="op" id="5732750">+</span><span class="num" id="5732751">1</span><span class="op" id="5732752">:</span><span class="op" id="5732753">]</span><span class="op" id="5732754">,</span>&nbsp;<span class="ident" id="5732756">allTags</span><span class="op" id="5732763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732767">return</span>&nbsp;<span class="ident" id="5732774">ok1</span>&nbsp;<span class="op" id="5732778">&amp;&amp;</span>&nbsp;<span class="ident" id="5732781">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732789">if</span>&nbsp;<span class="ident" id="5732792">strings</span><span class="op" id="5732799">.</span><span class="ident" id="5732800">HasPrefix</span><span class="op" id="5732809">(</span><span class="ident" id="5732810">name</span><span class="op" id="5732814">,</span>&nbsp;<span class="string" id="5732816">&#34;!!&#34;</span><span class="op" id="5732820">)</span>&nbsp;<span class="op" id="5732822">{</span>&nbsp;<span class="comment" id="5732824">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732855">return</span>&nbsp;<span class="builtintype" id="5732862">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732872">if</span>&nbsp;<span class="ident" id="5732875">strings</span><span class="op" id="5732882">.</span><span class="ident" id="5732883">HasPrefix</span><span class="op" id="5732892">(</span><span class="ident" id="5732893">name</span><span class="op" id="5732897">,</span>&nbsp;<span class="string" id="5732899">&#34;!&#34;</span><span class="op" id="5732902">)</span>&nbsp;<span class="op" id="5732904">{</span>&nbsp;<span class="comment" id="5732906">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732920">return</span>&nbsp;<span class="builtinfunc" id="5732927">len</span><span class="op" id="5732930">(</span><span class="ident" id="5732931">name</span><span class="op" id="5732935">)</span>&nbsp;<span class="op" id="5732937">&gt;</span>&nbsp;<span class="num" id="5732939">1</span>&nbsp;<span class="op" id="5732941">&amp;&amp;</span>&nbsp;<span class="op" id="5732944">!</span><span class="ident" id="5732945">ctxt</span><span class="op" id="5732949">.</span><span class="ident" id="5732950">match</span><span class="op" id="5732955">(</span><span class="ident" id="5732956">name</span><span class="op" id="5732960">[</span><span class="num" id="5732961">1</span><span class="op" id="5732962">:</span><span class="op" id="5732963">]</span><span class="op" id="5732964">,</span>&nbsp;<span class="ident" id="5732966">allTags</span><span class="op" id="5732973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5732976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5732980">if</span>&nbsp;<span class="ident" id="5732983">allTags</span>&nbsp;<span class="op" id="5732991">!=</span>&nbsp;<span class="ident" id="5732994">nil</span>&nbsp;<span class="op" id="5732998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5733002">allTags</span><span class="op" id="5733009">[</span><span class="ident" id="5733010">name</span><span class="op" id="5733014">]</span>&nbsp;<span class="op" id="5733016">=</span>&nbsp;<span class="builtintype" id="5733018">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733028">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733083">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733148">for</span>&nbsp;<span class="ident" id="5733152">_</span><span class="op" id="5733153">,</span>&nbsp;<span class="ident" id="5733155">c</span>&nbsp;<span class="op" id="5733157">:=</span>&nbsp;<span class="keyword" id="5733160">range</span>&nbsp;<span class="ident" id="5733166">name</span>&nbsp;<span class="op" id="5733171">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733175">if</span>&nbsp;<span class="op" id="5733178">!</span><span class="ident" id="5733179">unicode</span><span class="op" id="5733186">.</span><span class="ident" id="5733187">IsLetter</span><span class="op" id="5733195">(</span><span class="ident" id="5733196">c</span><span class="op" id="5733197">)</span>&nbsp;<span class="op" id="5733199">&amp;&amp;</span>&nbsp;<span class="op" id="5733202">!</span><span class="ident" id="5733203">unicode</span><span class="op" id="5733210">.</span><span class="ident" id="5733211">IsDigit</span><span class="op" id="5733218">(</span><span class="ident" id="5733219">c</span><span class="op" id="5733220">)</span>&nbsp;<span class="op" id="5733222">&amp;&amp;</span>&nbsp;<span class="ident" id="5733225">c</span>&nbsp;<span class="op" id="5733227">!=</span>&nbsp;<span class="string" id="5733230">&#39;_&#39;</span>&nbsp;<span class="op" id="5733234">&amp;&amp;</span>&nbsp;<span class="ident" id="5733237">c</span>&nbsp;<span class="op" id="5733239">!=</span>&nbsp;<span class="string" id="5733242">&#39;.&#39;</span>&nbsp;<span class="op" id="5733246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733251">return</span>&nbsp;<span class="builtintype" id="5733258">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733273">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733290">if</span>&nbsp;<span class="ident" id="5733293">ctxt</span><span class="op" id="5733297">.</span><span class="ident" id="5733298">CgoEnabled</span>&nbsp;<span class="op" id="5733309">&amp;&amp;</span>&nbsp;<span class="ident" id="5733312">name</span>&nbsp;<span class="op" id="5733317">==</span>&nbsp;<span class="string" id="5733320">&#34;cgo&#34;</span>&nbsp;<span class="op" id="5733326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733330">return</span>&nbsp;<span class="builtintype" id="5733337">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733346">if</span>&nbsp;<span class="ident" id="5733349">name</span>&nbsp;<span class="op" id="5733354">==</span>&nbsp;<span class="ident" id="5733357">ctxt</span><span class="op" id="5733361">.</span><span class="ident" id="5733362">GOOS</span>&nbsp;<span class="op" id="5733367">||</span>&nbsp;<span class="ident" id="5733370">name</span>&nbsp;<span class="op" id="5733375">==</span>&nbsp;<span class="ident" id="5733378">ctxt</span><span class="op" id="5733382">.</span><span class="ident" id="5733383">GOARCH</span>&nbsp;<span class="op" id="5733390">||</span>&nbsp;<span class="ident" id="5733393">name</span>&nbsp;<span class="op" id="5733398">==</span>&nbsp;<span class="ident" id="5733401">ctxt</span><span class="op" id="5733405">.</span><span class="ident" id="5733406">Compiler</span>&nbsp;<span class="op" id="5733415">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733419">return</span>&nbsp;<span class="builtintype" id="5733426">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733435">if</span>&nbsp;<span class="ident" id="5733438">ctxt</span><span class="op" id="5733442">.</span><span class="ident" id="5733443">GOOS</span>&nbsp;<span class="op" id="5733448">==</span>&nbsp;<span class="string" id="5733451">&#34;android&#34;</span>&nbsp;<span class="op" id="5733461">&amp;&amp;</span>&nbsp;<span class="ident" id="5733464">name</span>&nbsp;<span class="op" id="5733469">==</span>&nbsp;<span class="string" id="5733472">&#34;linux&#34;</span>&nbsp;<span class="op" id="5733480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733484">return</span>&nbsp;<span class="builtintype" id="5733491">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733497">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5733501">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733516">for</span>&nbsp;<span class="ident" id="5733520">_</span><span class="op" id="5733521">,</span>&nbsp;<span class="ident" id="5733523">tag</span>&nbsp;<span class="op" id="5733527">:=</span>&nbsp;<span class="keyword" id="5733530">range</span>&nbsp;<span class="ident" id="5733536">ctxt</span><span class="op" id="5733540">.</span><span class="ident" id="5733541">BuildTags</span>&nbsp;<span class="op" id="5733551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733555">if</span>&nbsp;<span class="ident" id="5733558">tag</span>&nbsp;<span class="op" id="5733562">==</span>&nbsp;<span class="ident" id="5733565">name</span>&nbsp;<span class="op" id="5733570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733575">return</span>&nbsp;<span class="builtintype" id="5733582">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733595">for</span>&nbsp;<span class="ident" id="5733599">_</span><span class="op" id="5733600">,</span>&nbsp;<span class="ident" id="5733602">tag</span>&nbsp;<span class="op" id="5733606">:=</span>&nbsp;<span class="keyword" id="5733609">range</span>&nbsp;<span class="ident" id="5733615">ctxt</span><span class="op" id="5733619">.</span><span class="ident" id="5733620">ReleaseTags</span>&nbsp;<span class="op" id="5733632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733636">if</span>&nbsp;<span class="ident" id="5733639">tag</span>&nbsp;<span class="op" id="5733643">==</span>&nbsp;<span class="ident" id="5733646">name</span>&nbsp;<span class="op" id="5733651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733656">return</span>&nbsp;<span class="builtintype" id="5733663">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5733673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5733677">return</span>&nbsp;<span class="builtintype" id="5733684">false</span><br>
<span class="lineno"></span><span class="op" id="5733690">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="5733693">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="5733765">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="5733816">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="5733852">//</span><br>
<span class="lineno">1295</span><span class="comment" id="5733855">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="5733877">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5733901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5733933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5733960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="5733989">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5734026">//</span><br>
<span class="lineno"></span><span class="comment" id="5734029">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="5734108">func</span>&nbsp;<span class="op" id="5734113">(</span><span class="ident" id="5734114">ctxt</span>&nbsp;<span class="op" id="5734119">*</span><span class="ident" id="5734120">Context</span><span class="op" id="5734127">)</span>&nbsp;<span class="ident" id="5734129">goodOSArchFile</span><span class="op" id="5734143">(</span><span class="ident" id="5734144">name</span>&nbsp;<span class="builtintype" id="5734149">string</span><span class="op" id="5734155">,</span>&nbsp;<span class="ident" id="5734157">allTags</span>&nbsp;<span class="keyword" id="5734165">map</span><span class="op" id="5734168">[</span><span class="builtintype" id="5734169">string</span><span class="op" id="5734175">]</span><span class="builtintype" id="5734176">bool</span><span class="op" id="5734180">)</span>&nbsp;<span class="builtintype" id="5734182">bool</span>&nbsp;<span class="op" id="5734187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734190">if</span>&nbsp;<span class="ident" id="5734193">dot</span>&nbsp;<span class="op" id="5734197">:=</span>&nbsp;<span class="ident" id="5734200">strings</span><span class="op" id="5734207">.</span><span class="ident" id="5734208">Index</span><span class="op" id="5734213">(</span><span class="ident" id="5734214">name</span><span class="op" id="5734218">,</span>&nbsp;<span class="string" id="5734220">&#34;.&#34;</span><span class="op" id="5734223">)</span><span class="op" id="5734224">;</span>&nbsp;<span class="ident" id="5734226">dot</span>&nbsp;<span class="op" id="5734230">!=</span>&nbsp;<span class="op" id="5734233">-</span><span class="num" id="5734234">1</span>&nbsp;<span class="op" id="5734236">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734240">name</span>&nbsp;<span class="op" id="5734245">=</span>&nbsp;<span class="ident" id="5734247">name</span><span class="op" id="5734251">[</span><span class="op" id="5734252">:</span><span class="ident" id="5734253">dot</span><span class="op" id="5734256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734263">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734339">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734414">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734482">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734560">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734635">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5734710">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734748">i</span>&nbsp;<span class="op" id="5734750">:=</span>&nbsp;<span class="ident" id="5734753">strings</span><span class="op" id="5734760">.</span><span class="ident" id="5734761">Index</span><span class="op" id="5734766">(</span><span class="ident" id="5734767">name</span><span class="op" id="5734771">,</span>&nbsp;<span class="string" id="5734773">&#34;_&#34;</span><span class="op" id="5734776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734779">if</span>&nbsp;<span class="ident" id="5734782">i</span>&nbsp;<span class="op" id="5734784">&lt;</span>&nbsp;<span class="num" id="5734786">0</span>&nbsp;<span class="op" id="5734788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734792">return</span>&nbsp;<span class="builtintype" id="5734799">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734808">name</span>&nbsp;<span class="op" id="5734813">=</span>&nbsp;<span class="ident" id="5734815">name</span><span class="op" id="5734819">[</span><span class="ident" id="5734820">i</span><span class="op" id="5734821">:</span><span class="op" id="5734822">]</span>&nbsp;<span class="comment" id="5734824">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734862">l</span>&nbsp;<span class="op" id="5734864">:=</span>&nbsp;<span class="ident" id="5734867">strings</span><span class="op" id="5734874">.</span><span class="ident" id="5734875">Split</span><span class="op" id="5734880">(</span><span class="ident" id="5734881">name</span><span class="op" id="5734885">,</span>&nbsp;<span class="string" id="5734887">&#34;_&#34;</span><span class="op" id="5734890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734893">if</span>&nbsp;<span class="ident" id="5734896">n</span>&nbsp;<span class="op" id="5734898">:=</span>&nbsp;<span class="builtinfunc" id="5734901">len</span><span class="op" id="5734904">(</span><span class="ident" id="5734905">l</span><span class="op" id="5734906">)</span><span class="op" id="5734907">;</span>&nbsp;<span class="ident" id="5734909">n</span>&nbsp;<span class="op" id="5734911">&gt;</span>&nbsp;<span class="num" id="5734913">0</span>&nbsp;<span class="op" id="5734915">&amp;&amp;</span>&nbsp;<span class="ident" id="5734918">l</span><span class="op" id="5734919">[</span><span class="ident" id="5734920">n</span><span class="op" id="5734921">-</span><span class="num" id="5734922">1</span><span class="op" id="5734923">]</span>&nbsp;<span class="op" id="5734925">==</span>&nbsp;<span class="string" id="5734928">&#34;test&#34;</span>&nbsp;<span class="op" id="5734935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734939">l</span>&nbsp;<span class="op" id="5734941">=</span>&nbsp;<span class="ident" id="5734943">l</span><span class="op" id="5734944">[</span><span class="op" id="5734945">:</span><span class="ident" id="5734946">n</span><span class="op" id="5734947">-</span><span class="num" id="5734948">1</span><span class="op" id="5734949">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5734952">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5734955">n</span>&nbsp;<span class="op" id="5734957">:=</span>&nbsp;<span class="builtinfunc" id="5734960">len</span><span class="op" id="5734963">(</span><span class="ident" id="5734964">l</span><span class="op" id="5734965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5734968">if</span>&nbsp;<span class="ident" id="5734971">n</span>&nbsp;<span class="op" id="5734973">&gt;=</span>&nbsp;<span class="num" id="5734976">2</span>&nbsp;<span class="op" id="5734978">&amp;&amp;</span>&nbsp;<span class="ident" id="5734981">knownOS</span><span class="op" id="5734988">[</span><span class="ident" id="5734989">l</span><span class="op" id="5734990">[</span><span class="ident" id="5734991">n</span><span class="op" id="5734992">-</span><span class="num" id="5734993">2</span><span class="op" id="5734994">]</span><span class="op" id="5734995">]</span>&nbsp;<span class="op" id="5734997">&amp;&amp;</span>&nbsp;<span class="ident" id="5735000">knownArch</span><span class="op" id="5735009">[</span><span class="ident" id="5735010">l</span><span class="op" id="5735011">[</span><span class="ident" id="5735012">n</span><span class="op" id="5735013">-</span><span class="num" id="5735014">1</span><span class="op" id="5735015">]</span><span class="op" id="5735016">]</span>&nbsp;<span class="op" id="5735018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735022">if</span>&nbsp;<span class="ident" id="5735025">allTags</span>&nbsp;<span class="op" id="5735033">!=</span>&nbsp;<span class="ident" id="5735036">nil</span>&nbsp;<span class="op" id="5735040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735045">allTags</span><span class="op" id="5735052">[</span><span class="ident" id="5735053">l</span><span class="op" id="5735054">[</span><span class="ident" id="5735055">n</span><span class="op" id="5735056">-</span><span class="num" id="5735057">2</span><span class="op" id="5735058">]</span><span class="op" id="5735059">]</span>&nbsp;<span class="op" id="5735061">=</span>&nbsp;<span class="builtintype" id="5735063">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735071">allTags</span><span class="op" id="5735078">[</span><span class="ident" id="5735079">l</span><span class="op" id="5735080">[</span><span class="ident" id="5735081">n</span><span class="op" id="5735082">-</span><span class="num" id="5735083">1</span><span class="op" id="5735084">]</span><span class="op" id="5735085">]</span>&nbsp;<span class="op" id="5735087">=</span>&nbsp;<span class="builtintype" id="5735089">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735100">if</span>&nbsp;<span class="ident" id="5735103">l</span><span class="op" id="5735104">[</span><span class="ident" id="5735105">n</span><span class="op" id="5735106">-</span><span class="num" id="5735107">1</span><span class="op" id="5735108">]</span>&nbsp;<span class="op" id="5735110">!=</span>&nbsp;<span class="ident" id="5735113">ctxt</span><span class="op" id="5735117">.</span><span class="ident" id="5735118">GOARCH</span>&nbsp;<span class="op" id="5735125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735130">return</span>&nbsp;<span class="builtintype" id="5735137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735149">if</span>&nbsp;<span class="ident" id="5735152">ctxt</span><span class="op" id="5735156">.</span><span class="ident" id="5735157">GOOS</span>&nbsp;<span class="op" id="5735162">==</span>&nbsp;<span class="string" id="5735165">&#34;android&#34;</span>&nbsp;<span class="op" id="5735175">&amp;&amp;</span>&nbsp;<span class="ident" id="5735178">l</span><span class="op" id="5735179">[</span><span class="ident" id="5735180">n</span><span class="op" id="5735181">-</span><span class="num" id="5735182">2</span><span class="op" id="5735183">]</span>&nbsp;<span class="op" id="5735185">==</span>&nbsp;<span class="string" id="5735188">&#34;linux&#34;</span>&nbsp;<span class="op" id="5735196">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735201">return</span>&nbsp;<span class="builtintype" id="5735208">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735219">return</span>&nbsp;<span class="ident" id="5735226">l</span><span class="op" id="5735227">[</span><span class="ident" id="5735228">n</span><span class="op" id="5735229">-</span><span class="num" id="5735230">2</span><span class="op" id="5735231">]</span>&nbsp;<span class="op" id="5735233">==</span>&nbsp;<span class="ident" id="5735236">ctxt</span><span class="op" id="5735240">.</span><span class="ident" id="5735241">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735250">if</span>&nbsp;<span class="ident" id="5735253">n</span>&nbsp;<span class="op" id="5735255">&gt;=</span>&nbsp;<span class="num" id="5735258">1</span>&nbsp;<span class="op" id="5735260">&amp;&amp;</span>&nbsp;<span class="ident" id="5735263">knownOS</span><span class="op" id="5735270">[</span><span class="ident" id="5735271">l</span><span class="op" id="5735272">[</span><span class="ident" id="5735273">n</span><span class="op" id="5735274">-</span><span class="num" id="5735275">1</span><span class="op" id="5735276">]</span><span class="op" id="5735277">]</span>&nbsp;<span class="op" id="5735279">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735283">if</span>&nbsp;<span class="ident" id="5735286">allTags</span>&nbsp;<span class="op" id="5735294">!=</span>&nbsp;<span class="ident" id="5735297">nil</span>&nbsp;<span class="op" id="5735301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735306">allTags</span><span class="op" id="5735313">[</span><span class="ident" id="5735314">l</span><span class="op" id="5735315">[</span><span class="ident" id="5735316">n</span><span class="op" id="5735317">-</span><span class="num" id="5735318">1</span><span class="op" id="5735319">]</span><span class="op" id="5735320">]</span>&nbsp;<span class="op" id="5735322">=</span>&nbsp;<span class="builtintype" id="5735324">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735335">if</span>&nbsp;<span class="ident" id="5735338">ctxt</span><span class="op" id="5735342">.</span><span class="ident" id="5735343">GOOS</span>&nbsp;<span class="op" id="5735348">==</span>&nbsp;<span class="string" id="5735351">&#34;android&#34;</span>&nbsp;<span class="op" id="5735361">&amp;&amp;</span>&nbsp;<span class="ident" id="5735364">l</span><span class="op" id="5735365">[</span><span class="ident" id="5735366">n</span><span class="op" id="5735367">-</span><span class="num" id="5735368">1</span><span class="op" id="5735369">]</span>&nbsp;<span class="op" id="5735371">==</span>&nbsp;<span class="string" id="5735374">&#34;linux&#34;</span>&nbsp;<span class="op" id="5735382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735387">return</span>&nbsp;<span class="builtintype" id="5735394">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735405">return</span>&nbsp;<span class="ident" id="5735412">l</span><span class="op" id="5735413">[</span><span class="ident" id="5735414">n</span><span class="op" id="5735415">-</span><span class="num" id="5735416">1</span><span class="op" id="5735417">]</span>&nbsp;<span class="op" id="5735419">==</span>&nbsp;<span class="ident" id="5735422">ctxt</span><span class="op" id="5735426">.</span><span class="ident" id="5735427">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735436">if</span>&nbsp;<span class="ident" id="5735439">n</span>&nbsp;<span class="op" id="5735441">&gt;=</span>&nbsp;<span class="num" id="5735444">1</span>&nbsp;<span class="op" id="5735446">&amp;&amp;</span>&nbsp;<span class="ident" id="5735449">knownArch</span><span class="op" id="5735458">[</span><span class="ident" id="5735459">l</span><span class="op" id="5735460">[</span><span class="ident" id="5735461">n</span><span class="op" id="5735462">-</span><span class="num" id="5735463">1</span><span class="op" id="5735464">]</span><span class="op" id="5735465">]</span>&nbsp;<span class="op" id="5735467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735471">if</span>&nbsp;<span class="ident" id="5735474">allTags</span>&nbsp;<span class="op" id="5735482">!=</span>&nbsp;<span class="ident" id="5735485">nil</span>&nbsp;<span class="op" id="5735489">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735494">allTags</span><span class="op" id="5735501">[</span><span class="ident" id="5735502">l</span><span class="op" id="5735503">[</span><span class="ident" id="5735504">n</span><span class="op" id="5735505">-</span><span class="num" id="5735506">1</span><span class="op" id="5735507">]</span><span class="op" id="5735508">]</span>&nbsp;<span class="op" id="5735510">=</span>&nbsp;<span class="builtintype" id="5735512">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735523">return</span>&nbsp;<span class="ident" id="5735530">l</span><span class="op" id="5735531">[</span><span class="ident" id="5735532">n</span><span class="op" id="5735533">-</span><span class="num" id="5735534">1</span><span class="op" id="5735535">]</span>&nbsp;<span class="op" id="5735537">==</span>&nbsp;<span class="ident" id="5735540">ctxt</span><span class="op" id="5735544">.</span><span class="ident" id="5735545">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735556">return</span>&nbsp;<span class="builtintype" id="5735563">true</span><br>
<span class="lineno">1355</span><span class="op" id="5735568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5735571">var</span>&nbsp;<span class="ident" id="5735575">knownOS</span>&nbsp;<span class="op" id="5735583">=</span>&nbsp;<span class="builtinfunc" id="5735585">make</span><span class="op" id="5735589">(</span><span class="keyword" id="5735590">map</span><span class="op" id="5735593">[</span><span class="builtintype" id="5735594">string</span><span class="op" id="5735600">]</span><span class="builtintype" id="5735601">bool</span><span class="op" id="5735605">)</span><br>
<span class="lineno"></span><span class="keyword" id="5735607">var</span>&nbsp;<span class="ident" id="5735611">knownArch</span>&nbsp;<span class="op" id="5735621">=</span>&nbsp;<span class="builtinfunc" id="5735623">make</span><span class="op" id="5735627">(</span><span class="keyword" id="5735628">map</span><span class="op" id="5735631">[</span><span class="builtintype" id="5735632">string</span><span class="op" id="5735638">]</span><span class="builtintype" id="5735639">bool</span><span class="op" id="5735643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="5735646">func</span>&nbsp;<span class="ident" id="5735651">init</span><span class="op" id="5735655">(</span><span class="op" id="5735656">)</span>&nbsp;<span class="op" id="5735658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735661">for</span>&nbsp;<span class="ident" id="5735665">_</span><span class="op" id="5735666">,</span>&nbsp;<span class="ident" id="5735668">v</span>&nbsp;<span class="op" id="5735670">:=</span>&nbsp;<span class="keyword" id="5735673">range</span>&nbsp;<span class="ident" id="5735679">strings</span><span class="op" id="5735686">.</span><span class="ident" id="5735687">Fields</span><span class="op" id="5735693">(</span><span class="ident" id="5735694">goosList</span><span class="op" id="5735702">)</span>&nbsp;<span class="op" id="5735704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735708">knownOS</span><span class="op" id="5735715">[</span><span class="ident" id="5735716">v</span><span class="op" id="5735717">]</span>&nbsp;<span class="op" id="5735719">=</span>&nbsp;<span class="builtintype" id="5735721">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5735730">for</span>&nbsp;<span class="ident" id="5735734">_</span><span class="op" id="5735735">,</span>&nbsp;<span class="ident" id="5735737">v</span>&nbsp;<span class="op" id="5735739">:=</span>&nbsp;<span class="keyword" id="5735742">range</span>&nbsp;<span class="ident" id="5735748">strings</span><span class="op" id="5735755">.</span><span class="ident" id="5735756">Fields</span><span class="op" id="5735762">(</span><span class="ident" id="5735763">goarchList</span><span class="op" id="5735773">)</span>&nbsp;<span class="op" id="5735775">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5735779">knownArch</span><span class="op" id="5735788">[</span><span class="ident" id="5735789">v</span><span class="op" id="5735790">]</span>&nbsp;<span class="op" id="5735792">=</span>&nbsp;<span class="builtintype" id="5735794">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5735800">}</span><br>
<span class="lineno"></span><span class="op" id="5735802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5735805">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="5735857">var</span>&nbsp;<span class="ident" id="5735861">ToolDir</span>&nbsp;<span class="op" id="5735869">=</span>&nbsp;<span class="ident" id="5735871">filepath</span><span class="op" id="5735879">.</span><span class="ident" id="5735880">Join</span><span class="op" id="5735884">(</span><span class="ident" id="5735885">runtime</span><span class="op" id="5735892">.</span><span class="ident" id="5735893">GOROOT</span><span class="op" id="5735899">(</span><span class="op" id="5735900">)</span><span class="op" id="5735901">,</span>&nbsp;<span class="string" id="5735903">&#34;pkg/tool/&#34;</span><span class="op" id="5735914">+</span><span class="ident" id="5735915">runtime</span><span class="op" id="5735922">.</span><span class="ident" id="5735923">GOOS</span><span class="op" id="5735927">+</span><span class="string" id="5735928">&#34;_&#34;</span><span class="op" id="5735931">+</span><span class="ident" id="5735932">runtime</span><span class="op" id="5735939">.</span><span class="ident" id="5735940">GOARCH</span><span class="op" id="5735946">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5735949">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5736001">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5736063">func</span>&nbsp;<span class="ident" id="5736068">IsLocalImport</span><span class="op" id="5736081">(</span><span class="ident" id="5736082">path</span>&nbsp;<span class="builtintype" id="5736087">string</span><span class="op" id="5736093">)</span>&nbsp;<span class="builtintype" id="5736095">bool</span>&nbsp;<span class="op" id="5736100">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736103">return</span>&nbsp;<span class="ident" id="5736110">path</span>&nbsp;<span class="op" id="5736115">==</span>&nbsp;<span class="string" id="5736118">&#34;.&#34;</span>&nbsp;<span class="op" id="5736122">||</span>&nbsp;<span class="ident" id="5736125">path</span>&nbsp;<span class="op" id="5736130">==</span>&nbsp;<span class="string" id="5736133">&#34;..&#34;</span>&nbsp;<span class="op" id="5736138">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5736143">strings</span><span class="op" id="5736150">.</span><span class="ident" id="5736151">HasPrefix</span><span class="op" id="5736160">(</span><span class="ident" id="5736161">path</span><span class="op" id="5736165">,</span>&nbsp;<span class="string" id="5736167">&#34;./&#34;</span><span class="op" id="5736171">)</span>&nbsp;<span class="op" id="5736173">||</span>&nbsp;<span class="ident" id="5736176">strings</span><span class="op" id="5736183">.</span><span class="ident" id="5736184">HasPrefix</span><span class="op" id="5736193">(</span><span class="ident" id="5736194">path</span><span class="op" id="5736198">,</span>&nbsp;<span class="string" id="5736200">&#34;../&#34;</span><span class="op" id="5736205">)</span><br>
<span class="lineno"></span><span class="op" id="5736207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5736210">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="5736279">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5736326">func</span>&nbsp;<span class="ident" id="5736331">ArchChar</span><span class="op" id="5736339">(</span><span class="ident" id="5736340">goarch</span>&nbsp;<span class="builtintype" id="5736347">string</span><span class="op" id="5736353">)</span>&nbsp;<span class="op" id="5736355">(</span><span class="builtintype" id="5736356">string</span><span class="op" id="5736362">,</span>&nbsp;<span class="builtintype" id="5736364">error</span><span class="op" id="5736369">)</span>&nbsp;<span class="op" id="5736371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736374">switch</span>&nbsp;<span class="ident" id="5736381">goarch</span>&nbsp;<span class="op" id="5736388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736391">case</span>&nbsp;<span class="string" id="5736396">&#34;386&#34;</span><span class="op" id="5736401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736405">return</span>&nbsp;<span class="string" id="5736412">&#34;8&#34;</span><span class="op" id="5736415">,</span>&nbsp;<span class="ident" id="5736417">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736422">case</span>&nbsp;<span class="string" id="5736427">&#34;amd64&#34;</span><span class="op" id="5736434">,</span>&nbsp;<span class="string" id="5736436">&#34;amd64p32&#34;</span><span class="op" id="5736446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736450">return</span>&nbsp;<span class="string" id="5736457">&#34;6&#34;</span><span class="op" id="5736460">,</span>&nbsp;<span class="ident" id="5736462">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736467">case</span>&nbsp;<span class="string" id="5736472">&#34;arm&#34;</span><span class="op" id="5736477">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736481">return</span>&nbsp;<span class="string" id="5736488">&#34;5&#34;</span><span class="op" id="5736491">,</span>&nbsp;<span class="ident" id="5736493">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5736498">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5736501">return</span>&nbsp;<span class="string" id="5736508">&#34;&#34;</span><span class="op" id="5736510">,</span>&nbsp;<span class="ident" id="5736512">errors</span><span class="op" id="5736518">.</span><span class="ident" id="5736519">New</span><span class="op" id="5736522">(</span><span class="string" id="5736523">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="5736545">+</span>&nbsp;<span class="ident" id="5736547">goarch</span><span class="op" id="5736553">)</span><br>
<span class="lineno"></span><span class="op" id="5736555">}</span>
</div>
</body>
</html>
