<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5631762">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5631817">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5631871">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5631922">package</span>&nbsp;<span class="ident" id="5631930">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5631937">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5631994">func</span>&nbsp;<span class="ident" id="5631999">RGBToYCbCr</span><span class="op" id="5632009">(</span><span class="ident" id="5632010">r</span><span class="op" id="5632011">,</span>&nbsp;<span class="ident" id="5632013">g</span><span class="op" id="5632014">,</span>&nbsp;<span class="ident" id="5632016">b</span>&nbsp;<span class="builtintype" id="5632018">uint8</span><span class="op" id="5632023">)</span>&nbsp;<span class="op" id="5632025">(</span><span class="builtintype" id="5632026">uint8</span><span class="op" id="5632031">,</span>&nbsp;<span class="builtintype" id="5632033">uint8</span><span class="op" id="5632038">,</span>&nbsp;<span class="builtintype" id="5632040">uint8</span><span class="op" id="5632045">)</span>&nbsp;<span class="op" id="5632047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632050">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632083">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632124">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632171">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632218">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632285">r1</span>&nbsp;<span class="op" id="5632288">:=</span>&nbsp;<span class="builtintype" id="5632291">int</span><span class="op" id="5632294">(</span><span class="ident" id="5632295">r</span><span class="op" id="5632296">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632299">g1</span>&nbsp;<span class="op" id="5632302">:=</span>&nbsp;<span class="builtintype" id="5632305">int</span><span class="op" id="5632308">(</span><span class="ident" id="5632309">g</span><span class="op" id="5632310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632313">b1</span>&nbsp;<span class="op" id="5632316">:=</span>&nbsp;<span class="builtintype" id="5632319">int</span><span class="op" id="5632322">(</span><span class="ident" id="5632323">b</span><span class="op" id="5632324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632327">yy</span>&nbsp;<span class="op" id="5632330">:=</span>&nbsp;<span class="op" id="5632333">(</span><span class="num" id="5632334">19595</span><span class="op" id="5632339">*</span><span class="ident" id="5632340">r1</span>&nbsp;<span class="op" id="5632343">+</span>&nbsp;<span class="num" id="5632345">38470</span><span class="op" id="5632350">*</span><span class="ident" id="5632351">g1</span>&nbsp;<span class="op" id="5632354">+</span>&nbsp;<span class="num" id="5632356">7471</span><span class="op" id="5632360">*</span><span class="ident" id="5632361">b1</span>&nbsp;<span class="op" id="5632364">+</span>&nbsp;<span class="num" id="5632366">1</span><span class="op" id="5632367">&lt;&lt;</span><span class="num" id="5632369">15</span><span class="op" id="5632371">)</span>&nbsp;<span class="op" id="5632373">&gt;&gt;</span>&nbsp;<span class="num" id="5632376">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632380">cb</span>&nbsp;<span class="op" id="5632383">:=</span>&nbsp;<span class="op" id="5632386">(</span><span class="op" id="5632387">-</span><span class="num" id="5632388">11056</span><span class="op" id="5632393">*</span><span class="ident" id="5632394">r1</span>&nbsp;<span class="op" id="5632397">-</span>&nbsp;<span class="num" id="5632399">21712</span><span class="op" id="5632404">*</span><span class="ident" id="5632405">g1</span>&nbsp;<span class="op" id="5632408">+</span>&nbsp;<span class="num" id="5632410">32768</span><span class="op" id="5632415">*</span><span class="ident" id="5632416">b1</span>&nbsp;<span class="op" id="5632419">+</span>&nbsp;<span class="num" id="5632421">257</span><span class="op" id="5632424">&lt;&lt;</span><span class="num" id="5632426">15</span><span class="op" id="5632428">)</span>&nbsp;<span class="op" id="5632430">&gt;&gt;</span>&nbsp;<span class="num" id="5632433">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632437">cr</span>&nbsp;<span class="op" id="5632440">:=</span>&nbsp;<span class="op" id="5632443">(</span><span class="num" id="5632444">32768</span><span class="op" id="5632449">*</span><span class="ident" id="5632450">r1</span>&nbsp;<span class="op" id="5632453">-</span>&nbsp;<span class="num" id="5632455">27440</span><span class="op" id="5632460">*</span><span class="ident" id="5632461">g1</span>&nbsp;<span class="op" id="5632464">-</span>&nbsp;<span class="num" id="5632466">5328</span><span class="op" id="5632470">*</span><span class="ident" id="5632471">b1</span>&nbsp;<span class="op" id="5632474">+</span>&nbsp;<span class="num" id="5632476">257</span><span class="op" id="5632479">&lt;&lt;</span><span class="num" id="5632481">15</span><span class="op" id="5632483">)</span>&nbsp;<span class="op" id="5632485">&gt;&gt;</span>&nbsp;<span class="num" id="5632488">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5632492">if</span>&nbsp;<span class="ident" id="5632495">yy</span>&nbsp;<span class="op" id="5632498">&lt;</span>&nbsp;<span class="num" id="5632500">0</span>&nbsp;<span class="op" id="5632502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632506">yy</span>&nbsp;<span class="op" id="5632509">=</span>&nbsp;<span class="num" id="5632511">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5632514">}</span>&nbsp;<span class="keyword" id="5632516">else</span>&nbsp;<span class="keyword" id="5632521">if</span>&nbsp;<span class="ident" id="5632524">yy</span>&nbsp;<span class="op" id="5632527">&gt;</span>&nbsp;<span class="num" id="5632529">255</span>&nbsp;<span class="op" id="5632533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632537">yy</span>&nbsp;<span class="op" id="5632540">=</span>&nbsp;<span class="num" id="5632542">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5632547">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5632550">if</span>&nbsp;<span class="ident" id="5632553">cb</span>&nbsp;<span class="op" id="5632556">&lt;</span>&nbsp;<span class="num" id="5632558">0</span>&nbsp;<span class="op" id="5632560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632564">cb</span>&nbsp;<span class="op" id="5632567">=</span>&nbsp;<span class="num" id="5632569">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5632572">}</span>&nbsp;<span class="keyword" id="5632574">else</span>&nbsp;<span class="keyword" id="5632579">if</span>&nbsp;<span class="ident" id="5632582">cb</span>&nbsp;<span class="op" id="5632585">&gt;</span>&nbsp;<span class="num" id="5632587">255</span>&nbsp;<span class="op" id="5632591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632595">cb</span>&nbsp;<span class="op" id="5632598">=</span>&nbsp;<span class="num" id="5632600">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5632605">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5632608">if</span>&nbsp;<span class="ident" id="5632611">cr</span>&nbsp;<span class="op" id="5632614">&lt;</span>&nbsp;<span class="num" id="5632616">0</span>&nbsp;<span class="op" id="5632618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632622">cr</span>&nbsp;<span class="op" id="5632625">=</span>&nbsp;<span class="num" id="5632627">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5632630">}</span>&nbsp;<span class="keyword" id="5632632">else</span>&nbsp;<span class="keyword" id="5632637">if</span>&nbsp;<span class="ident" id="5632640">cr</span>&nbsp;<span class="op" id="5632643">&gt;</span>&nbsp;<span class="num" id="5632645">255</span>&nbsp;<span class="op" id="5632649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5632653">cr</span>&nbsp;<span class="op" id="5632656">=</span>&nbsp;<span class="num" id="5632658">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5632663">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5632666">return</span>&nbsp;<span class="builtintype" id="5632673">uint8</span><span class="op" id="5632678">(</span><span class="ident" id="5632679">yy</span><span class="op" id="5632681">)</span><span class="op" id="5632682">,</span>&nbsp;<span class="builtintype" id="5632684">uint8</span><span class="op" id="5632689">(</span><span class="ident" id="5632690">cb</span><span class="op" id="5632692">)</span><span class="op" id="5632693">,</span>&nbsp;<span class="builtintype" id="5632695">uint8</span><span class="op" id="5632700">(</span><span class="ident" id="5632701">cr</span><span class="op" id="5632703">)</span><br>
<span class="lineno"></span><span class="op" id="5632705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5632708">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="5632765">func</span>&nbsp;<span class="ident" id="5632770">YCbCrToRGB</span><span class="op" id="5632780">(</span><span class="ident" id="5632781">y</span><span class="op" id="5632782">,</span>&nbsp;<span class="ident" id="5632784">cb</span><span class="op" id="5632786">,</span>&nbsp;<span class="ident" id="5632788">cr</span>&nbsp;<span class="builtintype" id="5632791">uint8</span><span class="op" id="5632796">)</span>&nbsp;<span class="op" id="5632798">(</span><span class="builtintype" id="5632799">uint8</span><span class="op" id="5632804">,</span>&nbsp;<span class="builtintype" id="5632806">uint8</span><span class="op" id="5632811">,</span>&nbsp;<span class="builtintype" id="5632813">uint8</span><span class="op" id="5632818">)</span>&nbsp;<span class="op" id="5632820">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632823">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632856">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632886">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632935">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5632965">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633032">yy1</span>&nbsp;<span class="op" id="5633036">:=</span>&nbsp;<span class="builtintype" id="5633039">int</span><span class="op" id="5633042">(</span><span class="ident" id="5633043">y</span><span class="op" id="5633044">)</span><span class="op" id="5633045">&lt;&lt;</span><span class="num" id="5633047">16</span>&nbsp;<span class="op" id="5633050">+</span>&nbsp;<span class="num" id="5633052">1</span><span class="op" id="5633053">&lt;&lt;</span><span class="num" id="5633055">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633059">cb1</span>&nbsp;<span class="op" id="5633063">:=</span>&nbsp;<span class="builtintype" id="5633066">int</span><span class="op" id="5633069">(</span><span class="ident" id="5633070">cb</span><span class="op" id="5633072">)</span>&nbsp;<span class="op" id="5633074">-</span>&nbsp;<span class="num" id="5633076">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633081">cr1</span>&nbsp;<span class="op" id="5633085">:=</span>&nbsp;<span class="builtintype" id="5633088">int</span><span class="op" id="5633091">(</span><span class="ident" id="5633092">cr</span><span class="op" id="5633094">)</span>&nbsp;<span class="op" id="5633096">-</span>&nbsp;<span class="num" id="5633098">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633103">r</span>&nbsp;<span class="op" id="5633105">:=</span>&nbsp;<span class="op" id="5633108">(</span><span class="ident" id="5633109">yy1</span>&nbsp;<span class="op" id="5633113">+</span>&nbsp;<span class="num" id="5633115">91881</span><span class="op" id="5633120">*</span><span class="ident" id="5633121">cr1</span><span class="op" id="5633124">)</span>&nbsp;<span class="op" id="5633126">&gt;&gt;</span>&nbsp;<span class="num" id="5633129">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633133">g</span>&nbsp;<span class="op" id="5633135">:=</span>&nbsp;<span class="op" id="5633138">(</span><span class="ident" id="5633139">yy1</span>&nbsp;<span class="op" id="5633143">-</span>&nbsp;<span class="num" id="5633145">22554</span><span class="op" id="5633150">*</span><span class="ident" id="5633151">cb1</span>&nbsp;<span class="op" id="5633155">-</span>&nbsp;<span class="num" id="5633157">46802</span><span class="op" id="5633162">*</span><span class="ident" id="5633163">cr1</span><span class="op" id="5633166">)</span>&nbsp;<span class="op" id="5633168">&gt;&gt;</span>&nbsp;<span class="num" id="5633171">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633175">b</span>&nbsp;<span class="op" id="5633177">:=</span>&nbsp;<span class="op" id="5633180">(</span><span class="ident" id="5633181">yy1</span>&nbsp;<span class="op" id="5633185">+</span>&nbsp;<span class="num" id="5633187">116130</span><span class="op" id="5633193">*</span><span class="ident" id="5633194">cb1</span><span class="op" id="5633197">)</span>&nbsp;<span class="op" id="5633199">&gt;&gt;</span>&nbsp;<span class="num" id="5633202">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5633206">if</span>&nbsp;<span class="ident" id="5633209">r</span>&nbsp;<span class="op" id="5633211">&lt;</span>&nbsp;<span class="num" id="5633213">0</span>&nbsp;<span class="op" id="5633215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633219">r</span>&nbsp;<span class="op" id="5633221">=</span>&nbsp;<span class="num" id="5633223">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5633226">}</span>&nbsp;<span class="keyword" id="5633228">else</span>&nbsp;<span class="keyword" id="5633233">if</span>&nbsp;<span class="ident" id="5633236">r</span>&nbsp;<span class="op" id="5633238">&gt;</span>&nbsp;<span class="num" id="5633240">255</span>&nbsp;<span class="op" id="5633244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633248">r</span>&nbsp;<span class="op" id="5633250">=</span>&nbsp;<span class="num" id="5633252">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5633257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5633260">if</span>&nbsp;<span class="ident" id="5633263">g</span>&nbsp;<span class="op" id="5633265">&lt;</span>&nbsp;<span class="num" id="5633267">0</span>&nbsp;<span class="op" id="5633269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633273">g</span>&nbsp;<span class="op" id="5633275">=</span>&nbsp;<span class="num" id="5633277">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5633280">}</span>&nbsp;<span class="keyword" id="5633282">else</span>&nbsp;<span class="keyword" id="5633287">if</span>&nbsp;<span class="ident" id="5633290">g</span>&nbsp;<span class="op" id="5633292">&gt;</span>&nbsp;<span class="num" id="5633294">255</span>&nbsp;<span class="op" id="5633298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633302">g</span>&nbsp;<span class="op" id="5633304">=</span>&nbsp;<span class="num" id="5633306">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5633311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5633314">if</span>&nbsp;<span class="ident" id="5633317">b</span>&nbsp;<span class="op" id="5633319">&lt;</span>&nbsp;<span class="num" id="5633321">0</span>&nbsp;<span class="op" id="5633323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633327">b</span>&nbsp;<span class="op" id="5633329">=</span>&nbsp;<span class="num" id="5633331">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5633334">}</span>&nbsp;<span class="keyword" id="5633336">else</span>&nbsp;<span class="keyword" id="5633341">if</span>&nbsp;<span class="ident" id="5633344">b</span>&nbsp;<span class="op" id="5633346">&gt;</span>&nbsp;<span class="num" id="5633348">255</span>&nbsp;<span class="op" id="5633352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5633356">b</span>&nbsp;<span class="op" id="5633358">=</span>&nbsp;<span class="num" id="5633360">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5633365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5633368">return</span>&nbsp;<span class="builtintype" id="5633375">uint8</span><span class="op" id="5633380">(</span><span class="ident" id="5633381">r</span><span class="op" id="5633382">)</span><span class="op" id="5633383">,</span>&nbsp;<span class="builtintype" id="5633385">uint8</span><span class="op" id="5633390">(</span><span class="ident" id="5633391">g</span><span class="op" id="5633392">)</span><span class="op" id="5633393">,</span>&nbsp;<span class="builtintype" id="5633395">uint8</span><span class="op" id="5633400">(</span><span class="ident" id="5633401">b</span><span class="op" id="5633402">)</span><br>
<span class="lineno"></span><span class="op" id="5633404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5633407">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="5633486">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="5633525">//</span><br>
<span class="lineno"></span><span class="comment" id="5633528">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="5633602">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="5633677">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="5633755">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="5633808">//</span><br>
<span class="lineno"></span><span class="comment" id="5633811">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="5633890">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="5633965">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="5634037">type</span>&nbsp;<span class="ident" id="5634042">YCbCr</span>&nbsp;<span class="keyword" id="5634048">struct</span>&nbsp;<span class="op" id="5634055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5634058">Y</span><span class="op" id="5634059">,</span>&nbsp;<span class="ident" id="5634061">Cb</span><span class="op" id="5634063">,</span>&nbsp;<span class="ident" id="5634065">Cr</span>&nbsp;<span class="builtintype" id="5634068">uint8</span><br>
<span class="lineno"></span><span class="op" id="5634074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5634077">func</span>&nbsp;<span class="op" id="5634082">(</span><span class="ident" id="5634083">c</span>&nbsp;<span class="ident" id="5634085">YCbCr</span><span class="op" id="5634090">)</span>&nbsp;<span class="ident" id="5634092">RGBA</span><span class="op" id="5634096">(</span><span class="op" id="5634097">)</span>&nbsp;<span class="op" id="5634099">(</span><span class="builtintype" id="5634100">uint32</span><span class="op" id="5634106">,</span>&nbsp;<span class="builtintype" id="5634108">uint32</span><span class="op" id="5634114">,</span>&nbsp;<span class="builtintype" id="5634116">uint32</span><span class="op" id="5634122">,</span>&nbsp;<span class="builtintype" id="5634124">uint32</span><span class="op" id="5634130">)</span>&nbsp;<span class="op" id="5634132">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5634135">r</span><span class="op" id="5634136">,</span>&nbsp;<span class="ident" id="5634138">g</span><span class="op" id="5634139">,</span>&nbsp;<span class="ident" id="5634141">b</span>&nbsp;<span class="op" id="5634143">:=</span>&nbsp;<span class="ident" id="5634146">YCbCrToRGB</span><span class="op" id="5634156">(</span><span class="ident" id="5634157">c</span><span class="op" id="5634158">.</span><span class="ident" id="5634159">Y</span><span class="op" id="5634160">,</span>&nbsp;<span class="ident" id="5634162">c</span><span class="op" id="5634163">.</span><span class="ident" id="5634164">Cb</span><span class="op" id="5634166">,</span>&nbsp;<span class="ident" id="5634168">c</span><span class="op" id="5634169">.</span><span class="ident" id="5634170">Cr</span><span class="op" id="5634172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5634175">return</span>&nbsp;<span class="builtintype" id="5634182">uint32</span><span class="op" id="5634188">(</span><span class="ident" id="5634189">r</span><span class="op" id="5634190">)</span>&nbsp;<span class="op" id="5634192">*</span>&nbsp;<span class="num" id="5634194">0x101</span><span class="op" id="5634199">,</span>&nbsp;<span class="builtintype" id="5634201">uint32</span><span class="op" id="5634207">(</span><span class="ident" id="5634208">g</span><span class="op" id="5634209">)</span>&nbsp;<span class="op" id="5634211">*</span>&nbsp;<span class="num" id="5634213">0x101</span><span class="op" id="5634218">,</span>&nbsp;<span class="builtintype" id="5634220">uint32</span><span class="op" id="5634226">(</span><span class="ident" id="5634227">b</span><span class="op" id="5634228">)</span>&nbsp;<span class="op" id="5634230">*</span>&nbsp;<span class="num" id="5634232">0x101</span><span class="op" id="5634237">,</span>&nbsp;<span class="num" id="5634239">0xffff</span><br>
<span class="lineno"></span><span class="op" id="5634246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5634249">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="5634295">var</span>&nbsp;<span class="ident" id="5634299">YCbCrModel</span>&nbsp;<span class="ident" id="5634310">Model</span>&nbsp;<span class="op" id="5634316">=</span>&nbsp;<span class="ident" id="5634318">ModelFunc</span><span class="op" id="5634327">(</span><span class="ident" id="5634328">yCbCrModel</span><span class="op" id="5634338">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5634341">func</span>&nbsp;<span class="ident" id="5634346">yCbCrModel</span><span class="op" id="5634356">(</span><span class="ident" id="5634357">c</span>&nbsp;<span class="ident" id="5634359">Color</span><span class="op" id="5634364">)</span>&nbsp;<span class="ident" id="5634366">Color</span>&nbsp;<span class="op" id="5634372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5634375">if</span>&nbsp;<span class="ident" id="5634378">_</span><span class="op" id="5634379">,</span>&nbsp;<span class="ident" id="5634381">ok</span>&nbsp;<span class="op" id="5634384">:=</span>&nbsp;<span class="ident" id="5634387">c</span><span class="op" id="5634388">.</span><span class="op" id="5634389">(</span><span class="ident" id="5634390">YCbCr</span><span class="op" id="5634395">)</span><span class="op" id="5634396">;</span>&nbsp;<span class="ident" id="5634398">ok</span>&nbsp;<span class="op" id="5634401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5634405">return</span>&nbsp;<span class="ident" id="5634412">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5634415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5634418">r</span><span class="op" id="5634419">,</span>&nbsp;<span class="ident" id="5634421">g</span><span class="op" id="5634422">,</span>&nbsp;<span class="ident" id="5634424">b</span><span class="op" id="5634425">,</span>&nbsp;<span class="ident" id="5634427">_</span>&nbsp;<span class="op" id="5634429">:=</span>&nbsp;<span class="ident" id="5634432">c</span><span class="op" id="5634433">.</span><span class="ident" id="5634434">RGBA</span><span class="op" id="5634438">(</span><span class="op" id="5634439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5634442">y</span><span class="op" id="5634443">,</span>&nbsp;<span class="ident" id="5634445">u</span><span class="op" id="5634446">,</span>&nbsp;<span class="ident" id="5634448">v</span>&nbsp;<span class="op" id="5634450">:=</span>&nbsp;<span class="ident" id="5634453">RGBToYCbCr</span><span class="op" id="5634463">(</span><span class="builtintype" id="5634464">uint8</span><span class="op" id="5634469">(</span><span class="ident" id="5634470">r</span><span class="op" id="5634471">&gt;&gt;</span><span class="num" id="5634473">8</span><span class="op" id="5634474">)</span><span class="op" id="5634475">,</span>&nbsp;<span class="builtintype" id="5634477">uint8</span><span class="op" id="5634482">(</span><span class="ident" id="5634483">g</span><span class="op" id="5634484">&gt;&gt;</span><span class="num" id="5634486">8</span><span class="op" id="5634487">)</span><span class="op" id="5634488">,</span>&nbsp;<span class="builtintype" id="5634490">uint8</span><span class="op" id="5634495">(</span><span class="ident" id="5634496">b</span><span class="op" id="5634497">&gt;&gt;</span><span class="num" id="5634499">8</span><span class="op" id="5634500">)</span><span class="op" id="5634501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5634504">return</span>&nbsp;<span class="ident" id="5634511">YCbCr</span><span class="op" id="5634516">{</span><span class="ident" id="5634517">y</span><span class="op" id="5634518">,</span>&nbsp;<span class="ident" id="5634520">u</span><span class="op" id="5634521">,</span>&nbsp;<span class="ident" id="5634523">v</span><span class="op" id="5634524">}</span><br>
<span class="lineno"></span><span class="op" id="5634526">}</span>
</div>
</body>
</html>
