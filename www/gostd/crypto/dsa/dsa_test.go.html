<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html" class="current">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6555377">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6555432">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6555486">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6555537">package</span>&nbsp;<span class="ident" id="6555545">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555550">import</span>&nbsp;<span class="op" id="6555557">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6555560">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6555575">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6555587">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6555597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555600">func</span>&nbsp;<span class="ident" id="6555605">testSignAndVerify</span><span class="op" id="6555622">(</span><span class="ident" id="6555623">t</span>&nbsp;<span class="op" id="6555625">*</span><span class="ident" id="6555626"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555587">testing</a></span><span class="op" id="6555633">.</span><span class="ident" id="6555634"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6555635">,</span>&nbsp;<span class="ident" id="6555637">i</span>&nbsp;<span class="builtintype" id="6555639">int</span><span class="op" id="6555642">,</span>&nbsp;<span class="ident" id="6555644">priv</span>&nbsp;<span class="op" id="6555649">*</span><span class="ident" id="6555650"><a href="/gostd/crypto/dsa/dsa.go.html#2024982">PrivateKey</a></span><span class="op" id="6555660">)</span>&nbsp;<span class="op" id="6555662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555665">hashed</span>&nbsp;<span class="op" id="6555672">:=</span>&nbsp;<span class="op" id="6555675">[</span><span class="op" id="6555676">]</span><span class="builtintype" id="6555677">byte</span><span class="op" id="6555681">(</span><span class="string" id="6555682">&#34;testing&#34;</span><span class="op" id="6555691">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555694">r</span><span class="op" id="6555695">,</span>&nbsp;<span class="ident" id="6555697">s</span><span class="op" id="6555698">,</span>&nbsp;<span class="ident" id="6555700">err</span>&nbsp;<span class="op" id="6555704">:=</span>&nbsp;<span class="ident" id="6555707"><a href="/gostd/crypto/dsa/dsa.go.html#2028987">Sign</a></span><span class="op" id="6555711">(</span><span class="ident" id="6555712"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555560">rand</a></span><span class="op" id="6555716">.</span><span class="ident" id="6555717"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="6555723">,</span>&nbsp;<span class="ident" id="6555725"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555644">priv</a></span><span class="op" id="6555729">,</span>&nbsp;<span class="ident" id="6555731"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555665">hashed</a></span><span class="op" id="6555737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6555740">if</span>&nbsp;<span class="ident" id="6555743"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555700">err</a></span>&nbsp;<span class="op" id="6555747">!=</span>&nbsp;<span class="builtintype" id="6555750">nil</span>&nbsp;<span class="op" id="6555754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555758"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555623">t</a></span><span class="op" id="6555759">.</span><span class="ident" id="6555760"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6555766">(</span><span class="string" id="6555767">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6555790">,</span>&nbsp;<span class="ident" id="6555792"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555637">i</a></span><span class="op" id="6555793">,</span>&nbsp;<span class="ident" id="6555795"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555700">err</a></span><span class="op" id="6555798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6555802">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6555810">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6555814">if</span>&nbsp;<span class="op" id="6555817">!</span><span class="ident" id="6555818"><a href="/gostd/crypto/dsa/dsa.go.html#2030016">Verify</a></span><span class="op" id="6555824">(</span><span class="op" id="6555825">&amp;</span><span class="ident" id="6555826"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555644">priv</a></span><span class="op" id="6555830">.</span><span class="ident" id="6555831"><a href="/gostd/crypto/dsa/dsa.go.html#2025003">PublicKey</a></span><span class="op" id="6555840">,</span>&nbsp;<span class="ident" id="6555842"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555665">hashed</a></span><span class="op" id="6555848">,</span>&nbsp;<span class="ident" id="6555850"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555694">r</a></span><span class="op" id="6555851">,</span>&nbsp;<span class="ident" id="6555853"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555697">s</a></span><span class="op" id="6555854">)</span>&nbsp;<span class="op" id="6555856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555860"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555623">t</a></span><span class="op" id="6555861">.</span><span class="ident" id="6555862"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6555868">(</span><span class="string" id="6555869">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6555888">,</span>&nbsp;<span class="ident" id="6555890"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555637">i</a></span><span class="op" id="6555891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6555894">}</span><br>
<span class="lineno"></span><span class="op" id="6555896">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6555899">func</span>&nbsp;<span class="ident" id="6555904">testParameterGeneration</span><span class="op" id="6555927">(</span><span class="ident" id="6555928">t</span>&nbsp;<span class="op" id="6555930">*</span><span class="ident" id="6555931"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555587">testing</a></span><span class="op" id="6555938">.</span><span class="ident" id="6555939"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6555940">,</span>&nbsp;<span class="ident" id="6555942">sizes</span>&nbsp;<span class="ident" id="6555948"><a href="/gostd/crypto/dsa/dsa.go.html#2025507">ParameterSizes</a></span><span class="op" id="6555962">,</span>&nbsp;<span class="ident" id="6555964">L</span><span class="op" id="6555965">,</span>&nbsp;<span class="ident" id="6555967">N</span>&nbsp;<span class="builtintype" id="6555969">int</span><span class="op" id="6555972">)</span>&nbsp;<span class="op" id="6555974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6555977">var</span>&nbsp;<span class="ident" id="6555981">priv</span>&nbsp;<span class="ident" id="6555986"><a href="/gostd/crypto/dsa/dsa.go.html#2024982">PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555998">params</span>&nbsp;<span class="op" id="6556005">:=</span>&nbsp;<span class="op" id="6556008">&amp;</span><span class="ident" id="6556009"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555981">priv</a></span><span class="op" id="6556013">.</span><span class="ident" id="6556014"><a href="/gostd/crypto/dsa/dsa.go.html#2024907">Parameters</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556027">err</span>&nbsp;<span class="op" id="6556031">:=</span>&nbsp;<span class="ident" id="6556034"><a href="/gostd/crypto/dsa/dsa.go.html#2025919">GenerateParameters</a></span><span class="op" id="6556052">(</span><span class="ident" id="6556053"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556059">,</span>&nbsp;<span class="ident" id="6556061"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555560">rand</a></span><span class="op" id="6556065">.</span><span class="ident" id="6556066"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="6556072">,</span>&nbsp;<span class="ident" id="6556074"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556082">if</span>&nbsp;<span class="ident" id="6556085"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556027">err</a></span>&nbsp;<span class="op" id="6556089">!=</span>&nbsp;<span class="builtintype" id="6556092">nil</span>&nbsp;<span class="op" id="6556096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556100"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556101">.</span><span class="ident" id="6556102"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6556108">(</span><span class="string" id="6556109">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="6556117">,</span>&nbsp;<span class="builtintype" id="6556119">int</span><span class="op" id="6556122">(</span><span class="ident" id="6556123"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556128">)</span><span class="op" id="6556129">,</span>&nbsp;<span class="ident" id="6556131"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556027">err</a></span><span class="op" id="6556134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556138">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556146">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556150">if</span>&nbsp;<span class="ident" id="6556153"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556159">.</span><span class="ident" id="6556160"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="6556161">.</span><span class="ident" id="6556162"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="6556168">(</span><span class="op" id="6556169">)</span>&nbsp;<span class="op" id="6556171">!=</span>&nbsp;<span class="ident" id="6556174"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555964">L</a></span>&nbsp;<span class="op" id="6556176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556180"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556181">.</span><span class="ident" id="6556182"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6556188">(</span><span class="string" id="6556189">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6556223">,</span>&nbsp;<span class="builtintype" id="6556225">int</span><span class="op" id="6556228">(</span><span class="ident" id="6556229"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556234">)</span><span class="op" id="6556235">,</span>&nbsp;<span class="ident" id="6556237"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556243">.</span><span class="ident" id="6556244"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="6556245">.</span><span class="ident" id="6556246"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="6556252">(</span><span class="op" id="6556253">)</span><span class="op" id="6556254">,</span>&nbsp;<span class="ident" id="6556256"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555964">L</a></span><span class="op" id="6556257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556264">if</span>&nbsp;<span class="ident" id="6556267"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556273">.</span><span class="ident" id="6556274"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="6556275">.</span><span class="ident" id="6556276"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="6556282">(</span><span class="op" id="6556283">)</span>&nbsp;<span class="op" id="6556285">!=</span>&nbsp;<span class="ident" id="6556288"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555967">N</a></span>&nbsp;<span class="op" id="6556290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556294"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556295">.</span><span class="ident" id="6556296"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6556302">(</span><span class="string" id="6556303">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6556332">,</span>&nbsp;<span class="builtintype" id="6556334">int</span><span class="op" id="6556337">(</span><span class="ident" id="6556338"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556343">)</span><span class="op" id="6556344">,</span>&nbsp;<span class="ident" id="6556346"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556352">.</span><span class="ident" id="6556353"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="6556354">.</span><span class="ident" id="6556355"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="6556361">(</span><span class="op" id="6556362">)</span><span class="op" id="6556363">,</span>&nbsp;<span class="ident" id="6556365"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555964">L</a></span><span class="op" id="6556366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556373">one</span>&nbsp;<span class="op" id="6556377">:=</span>&nbsp;<span class="builtinfunc" id="6556380">new</span><span class="op" id="6556383">(</span><span class="ident" id="6556384"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6556387">.</span><span class="ident" id="6556388"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6556391">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556394"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556373">one</a></span><span class="op" id="6556397">.</span><span class="ident" id="6556398"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="6556406">(</span><span class="num" id="6556407">1</span><span class="op" id="6556408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556411">pm1</span>&nbsp;<span class="op" id="6556415">:=</span>&nbsp;<span class="builtinfunc" id="6556418">new</span><span class="op" id="6556421">(</span><span class="ident" id="6556422"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6556425">.</span><span class="ident" id="6556426"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6556429">)</span><span class="op" id="6556430">.</span><span class="ident" id="6556431"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="6556434">(</span><span class="ident" id="6556435"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556441">.</span><span class="ident" id="6556442"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="6556443">,</span>&nbsp;<span class="ident" id="6556445"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556373">one</a></span><span class="op" id="6556448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556451">quo</span><span class="op" id="6556454">,</span>&nbsp;<span class="ident" id="6556456">rem</span>&nbsp;<span class="op" id="6556460">:=</span>&nbsp;<span class="builtinfunc" id="6556463">new</span><span class="op" id="6556466">(</span><span class="ident" id="6556467"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6556470">.</span><span class="ident" id="6556471"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6556474">)</span><span class="op" id="6556475">.</span><span class="ident" id="6556476"><a href="/gostd/math/big/int.go.html#2042567">DivMod</a></span><span class="op" id="6556482">(</span><span class="ident" id="6556483"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556411">pm1</a></span><span class="op" id="6556486">,</span>&nbsp;<span class="ident" id="6556488"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556494">.</span><span class="ident" id="6556495"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="6556496">,</span>&nbsp;<span class="builtinfunc" id="6556498">new</span><span class="op" id="6556501">(</span><span class="ident" id="6556502"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6556505">.</span><span class="ident" id="6556506"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6556509">)</span><span class="op" id="6556510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556513">if</span>&nbsp;<span class="ident" id="6556516"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556456">rem</a></span><span class="op" id="6556519">.</span><span class="ident" id="6556520"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="6556524">(</span><span class="op" id="6556525">)</span>&nbsp;<span class="op" id="6556527">!=</span>&nbsp;<span class="num" id="6556530">0</span>&nbsp;<span class="op" id="6556532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556536"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556537">.</span><span class="ident" id="6556538"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6556544">(</span><span class="string" id="6556545">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="6556565">,</span>&nbsp;<span class="builtintype" id="6556567">int</span><span class="op" id="6556570">(</span><span class="ident" id="6556571"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556576">)</span><span class="op" id="6556577">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556583">x</span>&nbsp;<span class="op" id="6556585">:=</span>&nbsp;<span class="builtinfunc" id="6556588">new</span><span class="op" id="6556591">(</span><span class="ident" id="6556592"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6556595">.</span><span class="ident" id="6556596"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6556599">)</span><span class="op" id="6556600">.</span><span class="ident" id="6556601"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="6556604">(</span><span class="ident" id="6556605"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556611">.</span><span class="ident" id="6556612"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="6556613">,</span>&nbsp;<span class="ident" id="6556615"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556451">quo</a></span><span class="op" id="6556618">,</span>&nbsp;<span class="ident" id="6556620"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555998">params</a></span><span class="op" id="6556626">.</span><span class="ident" id="6556627"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="6556628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556631">if</span>&nbsp;<span class="ident" id="6556634"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556583">x</a></span><span class="op" id="6556635">.</span><span class="ident" id="6556636"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="6556639">(</span><span class="ident" id="6556640"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556373">one</a></span><span class="op" id="6556643">)</span>&nbsp;<span class="op" id="6556645">==</span>&nbsp;<span class="num" id="6556648">0</span>&nbsp;<span class="op" id="6556650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556654"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556655">.</span><span class="ident" id="6556656"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6556662">(</span><span class="string" id="6556663">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="6556686">,</span>&nbsp;<span class="builtintype" id="6556688">int</span><span class="op" id="6556691">(</span><span class="ident" id="6556692"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556697">)</span><span class="op" id="6556698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556701">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556705"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556027">err</a></span>&nbsp;<span class="op" id="6556709">=</span>&nbsp;<span class="ident" id="6556711"><a href="/gostd/crypto/dsa/dsa.go.html#2027649">GenerateKey</a></span><span class="op" id="6556722">(</span><span class="op" id="6556723">&amp;</span><span class="ident" id="6556724"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555981">priv</a></span><span class="op" id="6556728">,</span>&nbsp;<span class="ident" id="6556730"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555560">rand</a></span><span class="op" id="6556734">.</span><span class="ident" id="6556735"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="6556741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556744">if</span>&nbsp;<span class="ident" id="6556747"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556027">err</a></span>&nbsp;<span class="op" id="6556751">!=</span>&nbsp;<span class="builtintype" id="6556754">nil</span>&nbsp;<span class="op" id="6556758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556762"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556763">.</span><span class="ident" id="6556764"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6556770">(</span><span class="string" id="6556771">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6556797">,</span>&nbsp;<span class="ident" id="6556799"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556027">err</a></span><span class="op" id="6556802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556806">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556818"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555605">testSignAndVerify</a></span><span class="op" id="6556835">(</span><span class="ident" id="6556836"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555928">t</a></span><span class="op" id="6556837">,</span>&nbsp;<span class="builtintype" id="6556839">int</span><span class="op" id="6556842">(</span><span class="ident" id="6556843"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555942">sizes</a></span><span class="op" id="6556848">)</span><span class="op" id="6556849">,</span>&nbsp;<span class="op" id="6556851">&amp;</span><span class="ident" id="6556852"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555981">priv</a></span><span class="op" id="6556856">)</span><br>
<span class="lineno"></span><span class="op" id="6556858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6556861">func</span>&nbsp;<span class="ident" id="6556866">TestParameterGeneration</span><span class="op" id="6556889">(</span><span class="ident" id="6556890">t</span>&nbsp;<span class="op" id="6556892">*</span><span class="ident" id="6556893"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555587">testing</a></span><span class="op" id="6556900">.</span><span class="ident" id="6556901"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6556902">)</span>&nbsp;<span class="op" id="6556904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6556907">if</span>&nbsp;<span class="ident" id="6556910"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555587">testing</a></span><span class="op" id="6556917">.</span><span class="ident" id="6556918"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6556923">(</span><span class="op" id="6556924">)</span>&nbsp;<span class="op" id="6556926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556930"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556890">t</a></span><span class="op" id="6556931">.</span><span class="ident" id="6556932"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="6556936">(</span><span class="string" id="6556937">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="6556987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6556990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6556994"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555904">testParameterGeneration</a></span><span class="op" id="6557017">(</span><span class="ident" id="6557018"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556890">t</a></span><span class="op" id="6557019">,</span>&nbsp;<span class="ident" id="6557021"><a href="/gostd/crypto/dsa/dsa.go.html#2025536">L1024N160</a></span><span class="op" id="6557030">,</span>&nbsp;<span class="num" id="6557032">1024</span><span class="op" id="6557036">,</span>&nbsp;<span class="num" id="6557038">160</span><span class="op" id="6557041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557044"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555904">testParameterGeneration</a></span><span class="op" id="6557067">(</span><span class="ident" id="6557068"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556890">t</a></span><span class="op" id="6557069">,</span>&nbsp;<span class="ident" id="6557071"><a href="/gostd/crypto/dsa/dsa.go.html#2025569">L2048N224</a></span><span class="op" id="6557080">,</span>&nbsp;<span class="num" id="6557082">2048</span><span class="op" id="6557086">,</span>&nbsp;<span class="num" id="6557088">224</span><span class="op" id="6557091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557094"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555904">testParameterGeneration</a></span><span class="op" id="6557117">(</span><span class="ident" id="6557118"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556890">t</a></span><span class="op" id="6557119">,</span>&nbsp;<span class="ident" id="6557121"><a href="/gostd/crypto/dsa/dsa.go.html#2025580">L2048N256</a></span><span class="op" id="6557130">,</span>&nbsp;<span class="num" id="6557132">2048</span><span class="op" id="6557136">,</span>&nbsp;<span class="num" id="6557138">256</span><span class="op" id="6557141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557144"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555904">testParameterGeneration</a></span><span class="op" id="6557167">(</span><span class="ident" id="6557168"><a href="/gostd/crypto/dsa/dsa_test.go.html#6556890">t</a></span><span class="op" id="6557169">,</span>&nbsp;<span class="ident" id="6557171"><a href="/gostd/crypto/dsa/dsa.go.html#2025591">L3072N256</a></span><span class="op" id="6557180">,</span>&nbsp;<span class="num" id="6557182">3072</span><span class="op" id="6557186">,</span>&nbsp;<span class="num" id="6557188">256</span><span class="op" id="6557191">)</span><br>
<span class="lineno"></span><span class="op" id="6557193">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6557196">func</span>&nbsp;<span class="ident" id="6557201">TestSignAndVerify</span><span class="op" id="6557218">(</span><span class="ident" id="6557219">t</span>&nbsp;<span class="op" id="6557221">*</span><span class="ident" id="6557222"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555587">testing</a></span><span class="op" id="6557229">.</span><span class="ident" id="6557230"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6557231">)</span>&nbsp;<span class="op" id="6557233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6557236">var</span>&nbsp;<span class="ident" id="6557240">priv</span>&nbsp;<span class="ident" id="6557245"><a href="/gostd/crypto/dsa/dsa.go.html#2024982">PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557257"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557240">priv</a></span><span class="op" id="6557261">.</span><span class="ident" id="6557262"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="6557263">,</span>&nbsp;<span class="ident" id="6557265">_</span>&nbsp;<span class="op" id="6557267">=</span>&nbsp;<span class="builtinfunc" id="6557269">new</span><span class="op" id="6557272">(</span><span class="ident" id="6557273"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6557276">.</span><span class="ident" id="6557277"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6557280">)</span><span class="op" id="6557281">.</span><span class="ident" id="6557282"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="6557291">(</span><span class="string" id="6557292">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="6557550">,</span>&nbsp;<span class="num" id="6557552">16</span><span class="op" id="6557554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557557"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557240">priv</a></span><span class="op" id="6557561">.</span><span class="ident" id="6557562"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="6557563">,</span>&nbsp;<span class="ident" id="6557565">_</span>&nbsp;<span class="op" id="6557567">=</span>&nbsp;<span class="builtinfunc" id="6557569">new</span><span class="op" id="6557572">(</span><span class="ident" id="6557573"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6557576">.</span><span class="ident" id="6557577"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6557580">)</span><span class="op" id="6557581">.</span><span class="ident" id="6557582"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="6557591">(</span><span class="string" id="6557592">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="6557634">,</span>&nbsp;<span class="num" id="6557636">16</span><span class="op" id="6557638">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557641"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557240">priv</a></span><span class="op" id="6557645">.</span><span class="ident" id="6557646"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="6557647">,</span>&nbsp;<span class="ident" id="6557649">_</span>&nbsp;<span class="op" id="6557651">=</span>&nbsp;<span class="builtinfunc" id="6557653">new</span><span class="op" id="6557656">(</span><span class="ident" id="6557657"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6557660">.</span><span class="ident" id="6557661"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6557664">)</span><span class="op" id="6557665">.</span><span class="ident" id="6557666"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="6557675">(</span><span class="string" id="6557676">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="6557934">,</span>&nbsp;<span class="num" id="6557936">16</span><span class="op" id="6557938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6557941"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557240">priv</a></span><span class="op" id="6557945">.</span><span class="ident" id="6557946"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="6557947">,</span>&nbsp;<span class="ident" id="6557949">_</span>&nbsp;<span class="op" id="6557951">=</span>&nbsp;<span class="builtinfunc" id="6557953">new</span><span class="op" id="6557956">(</span><span class="ident" id="6557957"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6557960">.</span><span class="ident" id="6557961"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6557964">)</span><span class="op" id="6557965">.</span><span class="ident" id="6557966"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="6557975">(</span><span class="string" id="6557976">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="6558234">,</span>&nbsp;<span class="num" id="6558236">16</span><span class="op" id="6558238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6558241"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557240">priv</a></span><span class="op" id="6558245">.</span><span class="ident" id="6558246"><a href="/gostd/crypto/dsa/dsa.go.html#2025014">X</a></span><span class="op" id="6558247">,</span>&nbsp;<span class="ident" id="6558249">_</span>&nbsp;<span class="op" id="6558251">=</span>&nbsp;<span class="builtinfunc" id="6558253">new</span><span class="op" id="6558256">(</span><span class="ident" id="6558257"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555575">big</a></span><span class="op" id="6558260">.</span><span class="ident" id="6558261"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6558264">)</span><span class="op" id="6558265">.</span><span class="ident" id="6558266"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="6558275">(</span><span class="string" id="6558276">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="6558318">,</span>&nbsp;<span class="num" id="6558320">16</span><span class="op" id="6558322">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6558326"><a href="/gostd/crypto/dsa/dsa_test.go.html#6555605">testSignAndVerify</a></span><span class="op" id="6558343">(</span><span class="ident" id="6558344"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557219">t</a></span><span class="op" id="6558345">,</span>&nbsp;<span class="num" id="6558347">0</span><span class="op" id="6558348">,</span>&nbsp;<span class="op" id="6558350">&amp;</span><span class="ident" id="6558351"><a href="/gostd/crypto/dsa/dsa_test.go.html#6557240">priv</a></span><span class="op" id="6558355">)</span><br>
<span class="lineno">85</span><span class="op" id="6558357">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
