<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4204447">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4204502">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4204556">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4204607">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4204685">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4204703">package</span>&nbsp;<span class="ident" id="4204711">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4204719">import</span>&nbsp;<span class="op" id="4204726">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4204729">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4204739">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4204746">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4204749">func</span>&nbsp;<span class="ident" id="4204754">init</span><span class="op" id="4204758">(</span><span class="op" id="4204759">)</span>&nbsp;<span class="op" id="4204761">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204764">crypto</span><span class="op" id="4204770">.</span><span class="ident" id="4204771">RegisterHash</span><span class="op" id="4204783">(</span><span class="ident" id="4204784">crypto</span><span class="op" id="4204790">.</span><span class="ident" id="4204791">SHA224</span><span class="op" id="4204797">,</span>&nbsp;<span class="ident" id="4204799">New224</span><span class="op" id="4204805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204808">crypto</span><span class="op" id="4204814">.</span><span class="ident" id="4204815">RegisterHash</span><span class="op" id="4204827">(</span><span class="ident" id="4204828">crypto</span><span class="op" id="4204834">.</span><span class="ident" id="4204835">SHA256</span><span class="op" id="4204841">,</span>&nbsp;<span class="ident" id="4204843">New</span><span class="op" id="4204846">)</span><br>
<span class="lineno"></span><span class="op" id="4204848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4204851">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4204894">const</span>&nbsp;<span class="ident" id="4204900">Size</span>&nbsp;<span class="op" id="4204905">=</span>&nbsp;<span class="num" id="4204907">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4204911">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4204954">const</span>&nbsp;<span class="ident" id="4204960">Size224</span>&nbsp;<span class="op" id="4204968">=</span>&nbsp;<span class="num" id="4204970">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4204974">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4205022">const</span>&nbsp;<span class="ident" id="4205028">BlockSize</span>&nbsp;<span class="op" id="4205038">=</span>&nbsp;<span class="num" id="4205040">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4205044">const</span>&nbsp;<span class="op" id="4205050">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205053">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205063">=</span>&nbsp;<span class="num" id="4205065">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205069">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205079">=</span>&nbsp;<span class="num" id="4205081">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205093">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205103">=</span>&nbsp;<span class="num" id="4205105">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205117">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205127">=</span>&nbsp;<span class="num" id="4205129">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205141">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205151">=</span>&nbsp;<span class="num" id="4205153">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205165">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205175">=</span>&nbsp;<span class="num" id="4205177">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205189">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205199">=</span>&nbsp;<span class="num" id="4205201">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205213">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205223">=</span>&nbsp;<span class="num" id="4205225">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205237">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205247">=</span>&nbsp;<span class="num" id="4205249">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205261">init0_224</span>&nbsp;<span class="op" id="4205271">=</span>&nbsp;<span class="num" id="4205273">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205285">init1_224</span>&nbsp;<span class="op" id="4205295">=</span>&nbsp;<span class="num" id="4205297">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205309">init2_224</span>&nbsp;<span class="op" id="4205319">=</span>&nbsp;<span class="num" id="4205321">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205333">init3_224</span>&nbsp;<span class="op" id="4205343">=</span>&nbsp;<span class="num" id="4205345">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205357">init4_224</span>&nbsp;<span class="op" id="4205367">=</span>&nbsp;<span class="num" id="4205369">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205381">init5_224</span>&nbsp;<span class="op" id="4205391">=</span>&nbsp;<span class="num" id="4205393">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205405">init6_224</span>&nbsp;<span class="op" id="4205415">=</span>&nbsp;<span class="num" id="4205417">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205429">init7_224</span>&nbsp;<span class="op" id="4205439">=</span>&nbsp;<span class="num" id="4205441">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4205452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4205455">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4205514">type</span>&nbsp;<span class="ident" id="4205519">digest</span>&nbsp;<span class="keyword" id="4205526">struct</span>&nbsp;<span class="op" id="4205533">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205536">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205542">[</span><span class="num" id="4205543">8</span><span class="op" id="4205544">]</span><span class="builtintype" id="4205545">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205553">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4205559">[</span><span class="ident" id="4205560">chunk</span><span class="op" id="4205565">]</span><span class="builtintype" id="4205566">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205572">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4205578">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4205583">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4205589">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205597">is224</span>&nbsp;<span class="builtintype" id="4205603">bool</span>&nbsp;<span class="comment" id="4205608">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4205642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4205645">func</span>&nbsp;<span class="op" id="4205650">(</span><span class="ident" id="4205651">d</span>&nbsp;<span class="op" id="4205653">*</span><span class="ident" id="4205654">digest</span><span class="op" id="4205660">)</span>&nbsp;<span class="ident" id="4205662">Reset</span><span class="op" id="4205667">(</span><span class="op" id="4205668">)</span>&nbsp;<span class="op" id="4205670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205673">if</span>&nbsp;<span class="op" id="4205676">!</span><span class="ident" id="4205677">d</span><span class="op" id="4205678">.</span><span class="ident" id="4205679">is224</span>&nbsp;<span class="op" id="4205685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205689">d</span><span class="op" id="4205690">.</span><span class="ident" id="4205691">h</span><span class="op" id="4205692">[</span><span class="num" id="4205693">0</span><span class="op" id="4205694">]</span>&nbsp;<span class="op" id="4205696">=</span>&nbsp;<span class="ident" id="4205698">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205706">d</span><span class="op" id="4205707">.</span><span class="ident" id="4205708">h</span><span class="op" id="4205709">[</span><span class="num" id="4205710">1</span><span class="op" id="4205711">]</span>&nbsp;<span class="op" id="4205713">=</span>&nbsp;<span class="ident" id="4205715">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205723">d</span><span class="op" id="4205724">.</span><span class="ident" id="4205725">h</span><span class="op" id="4205726">[</span><span class="num" id="4205727">2</span><span class="op" id="4205728">]</span>&nbsp;<span class="op" id="4205730">=</span>&nbsp;<span class="ident" id="4205732">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205740">d</span><span class="op" id="4205741">.</span><span class="ident" id="4205742">h</span><span class="op" id="4205743">[</span><span class="num" id="4205744">3</span><span class="op" id="4205745">]</span>&nbsp;<span class="op" id="4205747">=</span>&nbsp;<span class="ident" id="4205749">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205757">d</span><span class="op" id="4205758">.</span><span class="ident" id="4205759">h</span><span class="op" id="4205760">[</span><span class="num" id="4205761">4</span><span class="op" id="4205762">]</span>&nbsp;<span class="op" id="4205764">=</span>&nbsp;<span class="ident" id="4205766">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205774">d</span><span class="op" id="4205775">.</span><span class="ident" id="4205776">h</span><span class="op" id="4205777">[</span><span class="num" id="4205778">5</span><span class="op" id="4205779">]</span>&nbsp;<span class="op" id="4205781">=</span>&nbsp;<span class="ident" id="4205783">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205791">d</span><span class="op" id="4205792">.</span><span class="ident" id="4205793">h</span><span class="op" id="4205794">[</span><span class="num" id="4205795">6</span><span class="op" id="4205796">]</span>&nbsp;<span class="op" id="4205798">=</span>&nbsp;<span class="ident" id="4205800">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205808">d</span><span class="op" id="4205809">.</span><span class="ident" id="4205810">h</span><span class="op" id="4205811">[</span><span class="num" id="4205812">7</span><span class="op" id="4205813">]</span>&nbsp;<span class="op" id="4205815">=</span>&nbsp;<span class="ident" id="4205817">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205824">}</span>&nbsp;<span class="keyword" id="4205826">else</span>&nbsp;<span class="op" id="4205831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205835">d</span><span class="op" id="4205836">.</span><span class="ident" id="4205837">h</span><span class="op" id="4205838">[</span><span class="num" id="4205839">0</span><span class="op" id="4205840">]</span>&nbsp;<span class="op" id="4205842">=</span>&nbsp;<span class="ident" id="4205844">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205856">d</span><span class="op" id="4205857">.</span><span class="ident" id="4205858">h</span><span class="op" id="4205859">[</span><span class="num" id="4205860">1</span><span class="op" id="4205861">]</span>&nbsp;<span class="op" id="4205863">=</span>&nbsp;<span class="ident" id="4205865">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205877">d</span><span class="op" id="4205878">.</span><span class="ident" id="4205879">h</span><span class="op" id="4205880">[</span><span class="num" id="4205881">2</span><span class="op" id="4205882">]</span>&nbsp;<span class="op" id="4205884">=</span>&nbsp;<span class="ident" id="4205886">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205898">d</span><span class="op" id="4205899">.</span><span class="ident" id="4205900">h</span><span class="op" id="4205901">[</span><span class="num" id="4205902">3</span><span class="op" id="4205903">]</span>&nbsp;<span class="op" id="4205905">=</span>&nbsp;<span class="ident" id="4205907">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205919">d</span><span class="op" id="4205920">.</span><span class="ident" id="4205921">h</span><span class="op" id="4205922">[</span><span class="num" id="4205923">4</span><span class="op" id="4205924">]</span>&nbsp;<span class="op" id="4205926">=</span>&nbsp;<span class="ident" id="4205928">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205940">d</span><span class="op" id="4205941">.</span><span class="ident" id="4205942">h</span><span class="op" id="4205943">[</span><span class="num" id="4205944">5</span><span class="op" id="4205945">]</span>&nbsp;<span class="op" id="4205947">=</span>&nbsp;<span class="ident" id="4205949">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205961">d</span><span class="op" id="4205962">.</span><span class="ident" id="4205963">h</span><span class="op" id="4205964">[</span><span class="num" id="4205965">6</span><span class="op" id="4205966">]</span>&nbsp;<span class="op" id="4205968">=</span>&nbsp;<span class="ident" id="4205970">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205982">d</span><span class="op" id="4205983">.</span><span class="ident" id="4205984">h</span><span class="op" id="4205985">[</span><span class="num" id="4205986">7</span><span class="op" id="4205987">]</span>&nbsp;<span class="op" id="4205989">=</span>&nbsp;<span class="ident" id="4205991">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206005">d</span><span class="op" id="4206006">.</span><span class="ident" id="4206007">nx</span>&nbsp;<span class="op" id="4206010">=</span>&nbsp;<span class="num" id="4206012">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206015">d</span><span class="op" id="4206016">.</span><span class="builtinfunc" id="4206017">len</span>&nbsp;<span class="op" id="4206021">=</span>&nbsp;<span class="num" id="4206023">0</span><br>
<span class="lineno"></span><span class="op" id="4206025">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4206028">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4206090">func</span>&nbsp;<span class="ident" id="4206095">New</span><span class="op" id="4206098">(</span><span class="op" id="4206099">)</span>&nbsp;<span class="ident" id="4206101">hash</span><span class="op" id="4206105">.</span><span class="ident" id="4206106">Hash</span>&nbsp;<span class="op" id="4206111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206114">d</span>&nbsp;<span class="op" id="4206116">:=</span>&nbsp;<span class="builtinfunc" id="4206119">new</span><span class="op" id="4206122">(</span><span class="ident" id="4206123">digest</span><span class="op" id="4206129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206132">d</span><span class="op" id="4206133">.</span><span class="ident" id="4206134">Reset</span><span class="op" id="4206139">(</span><span class="op" id="4206140">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206143">return</span>&nbsp;<span class="ident" id="4206150">d</span><br>
<span class="lineno"></span><span class="op" id="4206152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4206155">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4206220">func</span>&nbsp;<span class="ident" id="4206225">New224</span><span class="op" id="4206231">(</span><span class="op" id="4206232">)</span>&nbsp;<span class="ident" id="4206234">hash</span><span class="op" id="4206238">.</span><span class="ident" id="4206239">Hash</span>&nbsp;<span class="op" id="4206244">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206247">d</span>&nbsp;<span class="op" id="4206249">:=</span>&nbsp;<span class="builtinfunc" id="4206252">new</span><span class="op" id="4206255">(</span><span class="ident" id="4206256">digest</span><span class="op" id="4206262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206265">d</span><span class="op" id="4206266">.</span><span class="ident" id="4206267">is224</span>&nbsp;<span class="op" id="4206273">=</span>&nbsp;<span class="builtintype" id="4206275">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206281">d</span><span class="op" id="4206282">.</span><span class="ident" id="4206283">Reset</span><span class="op" id="4206288">(</span><span class="op" id="4206289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206292">return</span>&nbsp;<span class="ident" id="4206299">d</span><br>
<span class="lineno"></span><span class="op" id="4206301">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4206304">func</span>&nbsp;<span class="op" id="4206309">(</span><span class="ident" id="4206310">d</span>&nbsp;<span class="op" id="4206312">*</span><span class="ident" id="4206313">digest</span><span class="op" id="4206319">)</span>&nbsp;<span class="ident" id="4206321">Size</span><span class="op" id="4206325">(</span><span class="op" id="4206326">)</span>&nbsp;<span class="builtintype" id="4206328">int</span>&nbsp;<span class="op" id="4206332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206335">if</span>&nbsp;<span class="op" id="4206338">!</span><span class="ident" id="4206339">d</span><span class="op" id="4206340">.</span><span class="ident" id="4206341">is224</span>&nbsp;<span class="op" id="4206347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206351">return</span>&nbsp;<span class="ident" id="4206358">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206364">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206367">return</span>&nbsp;<span class="ident" id="4206374">Size224</span><br>
<span class="lineno"></span><span class="op" id="4206382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4206385">func</span>&nbsp;<span class="op" id="4206390">(</span><span class="ident" id="4206391">d</span>&nbsp;<span class="op" id="4206393">*</span><span class="ident" id="4206394">digest</span><span class="op" id="4206400">)</span>&nbsp;<span class="ident" id="4206402">BlockSize</span><span class="op" id="4206411">(</span><span class="op" id="4206412">)</span>&nbsp;<span class="builtintype" id="4206414">int</span>&nbsp;<span class="op" id="4206418">{</span>&nbsp;<span class="keyword" id="4206420">return</span>&nbsp;<span class="ident" id="4206427">BlockSize</span>&nbsp;<span class="op" id="4206437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4206440">func</span>&nbsp;<span class="op" id="4206445">(</span><span class="ident" id="4206446">d</span>&nbsp;<span class="op" id="4206448">*</span><span class="ident" id="4206449">digest</span><span class="op" id="4206455">)</span>&nbsp;<span class="ident" id="4206457">Write</span><span class="op" id="4206462">(</span><span class="ident" id="4206463">p</span>&nbsp;<span class="op" id="4206465">[</span><span class="op" id="4206466">]</span><span class="builtintype" id="4206467">byte</span><span class="op" id="4206471">)</span>&nbsp;<span class="op" id="4206473">(</span><span class="ident" id="4206474">nn</span>&nbsp;<span class="builtintype" id="4206477">int</span><span class="op" id="4206480">,</span>&nbsp;<span class="ident" id="4206482">err</span>&nbsp;<span class="builtintype" id="4206486">error</span><span class="op" id="4206491">)</span>&nbsp;<span class="op" id="4206493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206496">nn</span>&nbsp;<span class="op" id="4206499">=</span>&nbsp;<span class="builtinfunc" id="4206501">len</span><span class="op" id="4206504">(</span><span class="ident" id="4206505">p</span><span class="op" id="4206506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206509">d</span><span class="op" id="4206510">.</span><span class="builtinfunc" id="4206511">len</span>&nbsp;<span class="op" id="4206515">+=</span>&nbsp;<span class="ident" id="4206518">uint64</span><span class="op" id="4206524">(</span><span class="ident" id="4206525">nn</span><span class="op" id="4206527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206530">if</span>&nbsp;<span class="ident" id="4206533">d</span><span class="op" id="4206534">.</span><span class="ident" id="4206535">nx</span>&nbsp;<span class="op" id="4206538">&gt;</span>&nbsp;<span class="num" id="4206540">0</span>&nbsp;<span class="op" id="4206542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206546">n</span>&nbsp;<span class="op" id="4206548">:=</span>&nbsp;<span class="builtinfunc" id="4206551">copy</span><span class="op" id="4206555">(</span><span class="ident" id="4206556">d</span><span class="op" id="4206557">.</span><span class="ident" id="4206558">x</span><span class="op" id="4206559">[</span><span class="ident" id="4206560">d</span><span class="op" id="4206561">.</span><span class="ident" id="4206562">nx</span><span class="op" id="4206564">:</span><span class="op" id="4206565">]</span><span class="op" id="4206566">,</span>&nbsp;<span class="ident" id="4206568">p</span><span class="op" id="4206569">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206573">d</span><span class="op" id="4206574">.</span><span class="ident" id="4206575">nx</span>&nbsp;<span class="op" id="4206578">+=</span>&nbsp;<span class="ident" id="4206581">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206585">if</span>&nbsp;<span class="ident" id="4206588">d</span><span class="op" id="4206589">.</span><span class="ident" id="4206590">nx</span>&nbsp;<span class="op" id="4206593">==</span>&nbsp;<span class="ident" id="4206596">chunk</span>&nbsp;<span class="op" id="4206602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206607">block</span><span class="op" id="4206612">(</span><span class="ident" id="4206613">d</span><span class="op" id="4206614">,</span>&nbsp;<span class="ident" id="4206616">d</span><span class="op" id="4206617">.</span><span class="ident" id="4206618">x</span><span class="op" id="4206619">[</span><span class="op" id="4206620">:</span><span class="op" id="4206621">]</span><span class="op" id="4206622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206627">d</span><span class="op" id="4206628">.</span><span class="ident" id="4206629">nx</span>&nbsp;<span class="op" id="4206632">=</span>&nbsp;<span class="num" id="4206634">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206638">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206642">p</span>&nbsp;<span class="op" id="4206644">=</span>&nbsp;<span class="ident" id="4206646">p</span><span class="op" id="4206647">[</span><span class="ident" id="4206648">n</span><span class="op" id="4206649">:</span><span class="op" id="4206650">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206656">if</span>&nbsp;<span class="builtinfunc" id="4206659">len</span><span class="op" id="4206662">(</span><span class="ident" id="4206663">p</span><span class="op" id="4206664">)</span>&nbsp;<span class="op" id="4206666">&gt;=</span>&nbsp;<span class="ident" id="4206669">chunk</span>&nbsp;<span class="op" id="4206675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206679">n</span>&nbsp;<span class="op" id="4206681">:=</span>&nbsp;<span class="builtinfunc" id="4206684">len</span><span class="op" id="4206687">(</span><span class="ident" id="4206688">p</span><span class="op" id="4206689">)</span>&nbsp;<span class="op" id="4206691">&amp;^</span>&nbsp;<span class="op" id="4206694">(</span><span class="ident" id="4206695">chunk</span>&nbsp;<span class="op" id="4206701">-</span>&nbsp;<span class="num" id="4206703">1</span><span class="op" id="4206704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206708">block</span><span class="op" id="4206713">(</span><span class="ident" id="4206714">d</span><span class="op" id="4206715">,</span>&nbsp;<span class="ident" id="4206717">p</span><span class="op" id="4206718">[</span><span class="op" id="4206719">:</span><span class="ident" id="4206720">n</span><span class="op" id="4206721">]</span><span class="op" id="4206722">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206726">p</span>&nbsp;<span class="op" id="4206728">=</span>&nbsp;<span class="ident" id="4206730">p</span><span class="op" id="4206731">[</span><span class="ident" id="4206732">n</span><span class="op" id="4206733">:</span><span class="op" id="4206734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206740">if</span>&nbsp;<span class="builtinfunc" id="4206743">len</span><span class="op" id="4206746">(</span><span class="ident" id="4206747">p</span><span class="op" id="4206748">)</span>&nbsp;<span class="op" id="4206750">&gt;</span>&nbsp;<span class="num" id="4206752">0</span>&nbsp;<span class="op" id="4206754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206758">d</span><span class="op" id="4206759">.</span><span class="ident" id="4206760">nx</span>&nbsp;<span class="op" id="4206763">=</span>&nbsp;<span class="builtinfunc" id="4206765">copy</span><span class="op" id="4206769">(</span><span class="ident" id="4206770">d</span><span class="op" id="4206771">.</span><span class="ident" id="4206772">x</span><span class="op" id="4206773">[</span><span class="op" id="4206774">:</span><span class="op" id="4206775">]</span><span class="op" id="4206776">,</span>&nbsp;<span class="ident" id="4206778">p</span><span class="op" id="4206779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206782">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206785">return</span><br>
<span class="lineno"></span><span class="op" id="4206792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4206795">func</span>&nbsp;<span class="op" id="4206800">(</span><span class="ident" id="4206801">d0</span>&nbsp;<span class="op" id="4206804">*</span><span class="ident" id="4206805">digest</span><span class="op" id="4206811">)</span>&nbsp;<span class="ident" id="4206813">Sum</span><span class="op" id="4206816">(</span><span class="ident" id="4206817">in</span>&nbsp;<span class="op" id="4206820">[</span><span class="op" id="4206821">]</span><span class="builtintype" id="4206822">byte</span><span class="op" id="4206826">)</span>&nbsp;<span class="op" id="4206828">[</span><span class="op" id="4206829">]</span><span class="builtintype" id="4206830">byte</span>&nbsp;<span class="op" id="4206835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206838">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206905">d</span>&nbsp;<span class="op" id="4206907">:=</span>&nbsp;<span class="op" id="4206910">*</span><span class="ident" id="4206911">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206915">hash</span>&nbsp;<span class="op" id="4206920">:=</span>&nbsp;<span class="ident" id="4206923">d</span><span class="op" id="4206924">.</span><span class="ident" id="4206925">checkSum</span><span class="op" id="4206933">(</span><span class="op" id="4206934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206937">if</span>&nbsp;<span class="ident" id="4206940">d</span><span class="op" id="4206941">.</span><span class="ident" id="4206942">is224</span>&nbsp;<span class="op" id="4206948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206952">return</span>&nbsp;<span class="builtinfunc" id="4206959">append</span><span class="op" id="4206965">(</span><span class="ident" id="4206966">in</span><span class="op" id="4206968">,</span>&nbsp;<span class="ident" id="4206970">hash</span><span class="op" id="4206974">[</span><span class="op" id="4206975">:</span><span class="ident" id="4206976">Size224</span><span class="op" id="4206983">]</span><span class="op" id="4206984">...</span><span class="op" id="4206987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206990">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206993">return</span>&nbsp;<span class="builtinfunc" id="4207000">append</span><span class="op" id="4207006">(</span><span class="ident" id="4207007">in</span><span class="op" id="4207009">,</span>&nbsp;<span class="ident" id="4207011">hash</span><span class="op" id="4207015">[</span><span class="op" id="4207016">:</span><span class="op" id="4207017">]</span><span class="op" id="4207018">...</span><span class="op" id="4207021">)</span><br>
<span class="lineno"></span><span class="op" id="4207023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4207026">func</span>&nbsp;<span class="op" id="4207031">(</span><span class="ident" id="4207032">d</span>&nbsp;<span class="op" id="4207034">*</span><span class="ident" id="4207035">digest</span><span class="op" id="4207041">)</span>&nbsp;<span class="ident" id="4207043">checkSum</span><span class="op" id="4207051">(</span><span class="op" id="4207052">)</span>&nbsp;<span class="op" id="4207054">[</span><span class="ident" id="4207055">Size</span><span class="op" id="4207059">]</span><span class="builtintype" id="4207060">byte</span>&nbsp;<span class="op" id="4207065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4207068">len</span>&nbsp;<span class="op" id="4207072">:=</span>&nbsp;<span class="ident" id="4207075">d</span><span class="op" id="4207076">.</span><span class="builtinfunc" id="4207077">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4207082">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207142">var</span>&nbsp;<span class="ident" id="4207146">tmp</span>&nbsp;<span class="op" id="4207150">[</span><span class="num" id="4207151">64</span><span class="op" id="4207153">]</span><span class="builtintype" id="4207154">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207160">tmp</span><span class="op" id="4207163">[</span><span class="num" id="4207164">0</span><span class="op" id="4207165">]</span>&nbsp;<span class="op" id="4207167">=</span>&nbsp;<span class="num" id="4207169">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207175">if</span>&nbsp;<span class="builtinfunc" id="4207178">len</span><span class="op" id="4207181">%</span><span class="num" id="4207182">64</span>&nbsp;<span class="op" id="4207185">&lt;</span>&nbsp;<span class="num" id="4207187">56</span>&nbsp;<span class="op" id="4207190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207194">d</span><span class="op" id="4207195">.</span><span class="ident" id="4207196">Write</span><span class="op" id="4207201">(</span><span class="ident" id="4207202">tmp</span><span class="op" id="4207205">[</span><span class="num" id="4207206">0</span>&nbsp;<span class="op" id="4207208">:</span>&nbsp;<span class="num" id="4207210">56</span><span class="op" id="4207212">-</span><span class="builtinfunc" id="4207213">len</span><span class="op" id="4207216">%</span><span class="num" id="4207217">64</span><span class="op" id="4207219">]</span><span class="op" id="4207220">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207223">}</span>&nbsp;<span class="keyword" id="4207225">else</span>&nbsp;<span class="op" id="4207230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207234">d</span><span class="op" id="4207235">.</span><span class="ident" id="4207236">Write</span><span class="op" id="4207241">(</span><span class="ident" id="4207242">tmp</span><span class="op" id="4207245">[</span><span class="num" id="4207246">0</span>&nbsp;<span class="op" id="4207248">:</span>&nbsp;<span class="num" id="4207250">64</span><span class="op" id="4207252">+</span><span class="num" id="4207253">56</span><span class="op" id="4207255">-</span><span class="builtinfunc" id="4207256">len</span><span class="op" id="4207259">%</span><span class="num" id="4207260">64</span><span class="op" id="4207262">]</span><span class="op" id="4207263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4207270">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4207290">len</span>&nbsp;<span class="op" id="4207294">&lt;&lt;=</span>&nbsp;<span class="num" id="4207298">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207301">for</span>&nbsp;<span class="ident" id="4207305">i</span>&nbsp;<span class="op" id="4207307">:=</span>&nbsp;<span class="builtintype" id="4207310">uint</span><span class="op" id="4207314">(</span><span class="num" id="4207315">0</span><span class="op" id="4207316">)</span><span class="op" id="4207317">;</span>&nbsp;<span class="ident" id="4207319">i</span>&nbsp;<span class="op" id="4207321">&lt;</span>&nbsp;<span class="num" id="4207323">8</span><span class="op" id="4207324">;</span>&nbsp;<span class="ident" id="4207326">i</span><span class="op" id="4207327">++</span>&nbsp;<span class="op" id="4207330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207334">tmp</span><span class="op" id="4207337">[</span><span class="ident" id="4207338">i</span><span class="op" id="4207339">]</span>&nbsp;<span class="op" id="4207341">=</span>&nbsp;<span class="builtintype" id="4207343">byte</span><span class="op" id="4207347">(</span><span class="builtinfunc" id="4207348">len</span>&nbsp;<span class="op" id="4207352">&gt;&gt;</span>&nbsp;<span class="op" id="4207355">(</span><span class="num" id="4207356">56</span>&nbsp;<span class="op" id="4207359">-</span>&nbsp;<span class="num" id="4207361">8</span><span class="op" id="4207362">*</span><span class="ident" id="4207363">i</span><span class="op" id="4207364">)</span><span class="op" id="4207365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207371">d</span><span class="op" id="4207372">.</span><span class="ident" id="4207373">Write</span><span class="op" id="4207378">(</span><span class="ident" id="4207379">tmp</span><span class="op" id="4207382">[</span><span class="num" id="4207383">0</span><span class="op" id="4207384">:</span><span class="num" id="4207385">8</span><span class="op" id="4207386">]</span><span class="op" id="4207387">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207391">if</span>&nbsp;<span class="ident" id="4207394">d</span><span class="op" id="4207395">.</span><span class="ident" id="4207396">nx</span>&nbsp;<span class="op" id="4207399">!=</span>&nbsp;<span class="num" id="4207402">0</span>&nbsp;<span class="op" id="4207404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4207408">panic</span><span class="op" id="4207413">(</span><span class="string" id="4207414">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4207425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207432">h</span>&nbsp;<span class="op" id="4207434">:=</span>&nbsp;<span class="ident" id="4207437">d</span><span class="op" id="4207438">.</span><span class="ident" id="4207439">h</span><span class="op" id="4207440">[</span><span class="op" id="4207441">:</span><span class="op" id="4207442">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207445">if</span>&nbsp;<span class="ident" id="4207448">d</span><span class="op" id="4207449">.</span><span class="ident" id="4207450">is224</span>&nbsp;<span class="op" id="4207456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207460">h</span>&nbsp;<span class="op" id="4207462">=</span>&nbsp;<span class="ident" id="4207464">d</span><span class="op" id="4207465">.</span><span class="ident" id="4207466">h</span><span class="op" id="4207467">[</span><span class="op" id="4207468">:</span><span class="num" id="4207469">7</span><span class="op" id="4207470">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207477">var</span>&nbsp;<span class="ident" id="4207481">digest</span>&nbsp;<span class="op" id="4207488">[</span><span class="ident" id="4207489">Size</span><span class="op" id="4207493">]</span><span class="builtintype" id="4207494">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207500">for</span>&nbsp;<span class="ident" id="4207504">i</span><span class="op" id="4207505">,</span>&nbsp;<span class="ident" id="4207507">s</span>&nbsp;<span class="op" id="4207509">:=</span>&nbsp;<span class="keyword" id="4207512">range</span>&nbsp;<span class="ident" id="4207518">h</span>&nbsp;<span class="op" id="4207520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207524">digest</span><span class="op" id="4207530">[</span><span class="ident" id="4207531">i</span><span class="op" id="4207532">*</span><span class="num" id="4207533">4</span><span class="op" id="4207534">]</span>&nbsp;<span class="op" id="4207536">=</span>&nbsp;<span class="builtintype" id="4207538">byte</span><span class="op" id="4207542">(</span><span class="ident" id="4207543">s</span>&nbsp;<span class="op" id="4207545">&gt;&gt;</span>&nbsp;<span class="num" id="4207548">24</span><span class="op" id="4207550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207554">digest</span><span class="op" id="4207560">[</span><span class="ident" id="4207561">i</span><span class="op" id="4207562">*</span><span class="num" id="4207563">4</span><span class="op" id="4207564">+</span><span class="num" id="4207565">1</span><span class="op" id="4207566">]</span>&nbsp;<span class="op" id="4207568">=</span>&nbsp;<span class="builtintype" id="4207570">byte</span><span class="op" id="4207574">(</span><span class="ident" id="4207575">s</span>&nbsp;<span class="op" id="4207577">&gt;&gt;</span>&nbsp;<span class="num" id="4207580">16</span><span class="op" id="4207582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207586">digest</span><span class="op" id="4207592">[</span><span class="ident" id="4207593">i</span><span class="op" id="4207594">*</span><span class="num" id="4207595">4</span><span class="op" id="4207596">+</span><span class="num" id="4207597">2</span><span class="op" id="4207598">]</span>&nbsp;<span class="op" id="4207600">=</span>&nbsp;<span class="builtintype" id="4207602">byte</span><span class="op" id="4207606">(</span><span class="ident" id="4207607">s</span>&nbsp;<span class="op" id="4207609">&gt;&gt;</span>&nbsp;<span class="num" id="4207612">8</span><span class="op" id="4207613">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207617">digest</span><span class="op" id="4207623">[</span><span class="ident" id="4207624">i</span><span class="op" id="4207625">*</span><span class="num" id="4207626">4</span><span class="op" id="4207627">+</span><span class="num" id="4207628">3</span><span class="op" id="4207629">]</span>&nbsp;<span class="op" id="4207631">=</span>&nbsp;<span class="builtintype" id="4207633">byte</span><span class="op" id="4207637">(</span><span class="ident" id="4207638">s</span><span class="op" id="4207639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207646">return</span>&nbsp;<span class="ident" id="4207653">digest</span><br>
<span class="lineno"></span><span class="op" id="4207660">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4207663">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4207714">func</span>&nbsp;<span class="ident" id="4207719">Sum256</span><span class="op" id="4207725">(</span><span class="ident" id="4207726">data</span>&nbsp;<span class="op" id="4207731">[</span><span class="op" id="4207732">]</span><span class="builtintype" id="4207733">byte</span><span class="op" id="4207737">)</span>&nbsp;<span class="op" id="4207739">[</span><span class="ident" id="4207740">Size</span><span class="op" id="4207744">]</span><span class="builtintype" id="4207745">byte</span>&nbsp;<span class="op" id="4207750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207753">var</span>&nbsp;<span class="ident" id="4207757">d</span>&nbsp;<span class="ident" id="4207759">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207767">d</span><span class="op" id="4207768">.</span><span class="ident" id="4207769">Reset</span><span class="op" id="4207774">(</span><span class="op" id="4207775">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207778">d</span><span class="op" id="4207779">.</span><span class="ident" id="4207780">Write</span><span class="op" id="4207785">(</span><span class="ident" id="4207786">data</span><span class="op" id="4207790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207793">return</span>&nbsp;<span class="ident" id="4207800">d</span><span class="op" id="4207801">.</span><span class="ident" id="4207802">checkSum</span><span class="op" id="4207810">(</span><span class="op" id="4207811">)</span><br>
<span class="lineno"></span><span class="op" id="4207813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4207816">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4207867">func</span>&nbsp;<span class="ident" id="4207872">Sum224</span><span class="op" id="4207878">(</span><span class="ident" id="4207879">data</span>&nbsp;<span class="op" id="4207884">[</span><span class="op" id="4207885">]</span><span class="builtintype" id="4207886">byte</span><span class="op" id="4207890">)</span>&nbsp;<span class="op" id="4207892">(</span><span class="ident" id="4207893">sum224</span>&nbsp;<span class="op" id="4207900">[</span><span class="ident" id="4207901">Size224</span><span class="op" id="4207908">]</span><span class="builtintype" id="4207909">byte</span><span class="op" id="4207913">)</span>&nbsp;<span class="op" id="4207915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207918">var</span>&nbsp;<span class="ident" id="4207922">d</span>&nbsp;<span class="ident" id="4207924">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207932">d</span><span class="op" id="4207933">.</span><span class="ident" id="4207934">is224</span>&nbsp;<span class="op" id="4207940">=</span>&nbsp;<span class="builtintype" id="4207942">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207948">d</span><span class="op" id="4207949">.</span><span class="ident" id="4207950">Reset</span><span class="op" id="4207955">(</span><span class="op" id="4207956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207959">d</span><span class="op" id="4207960">.</span><span class="ident" id="4207961">Write</span><span class="op" id="4207966">(</span><span class="ident" id="4207967">data</span><span class="op" id="4207971">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207974">sum</span>&nbsp;<span class="op" id="4207978">:=</span>&nbsp;<span class="ident" id="4207981">d</span><span class="op" id="4207982">.</span><span class="ident" id="4207983">checkSum</span><span class="op" id="4207991">(</span><span class="op" id="4207992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4207995">copy</span><span class="op" id="4207999">(</span><span class="ident" id="4208000">sum224</span><span class="op" id="4208006">[</span><span class="op" id="4208007">:</span><span class="op" id="4208008">]</span><span class="op" id="4208009">,</span>&nbsp;<span class="ident" id="4208011">sum</span><span class="op" id="4208014">[</span><span class="op" id="4208015">:</span><span class="ident" id="4208016">Size224</span><span class="op" id="4208023">]</span><span class="op" id="4208024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208027">return</span><br>
<span class="lineno"></span><span class="op" id="4208034">}</span>
</div>
</body>
</html>
