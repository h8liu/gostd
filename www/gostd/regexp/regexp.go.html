<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp</h2>
<ul>
<li><a href="/gostd/regexp/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/regexp/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/regexp/exec.go.html">exec.go</a></li>
<li><a href="/gostd/regexp/exec2_test.go.html">exec2_test.go</a></li>
<li><a href="/gostd/regexp/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/regexp/find_test.go.html">find_test.go</a></li>
<li><a href="/gostd/regexp/onepass.go.html">onepass.go</a></li>
<li><a href="/gostd/regexp/onepass_test.go.html">onepass_test.go</a></li>
<li><a href="/gostd/regexp/regexp.go.html" class="current">regexp.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5168273">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5168328">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5168382">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5168433">//&nbsp;Package&nbsp;regexp&nbsp;implements&nbsp;regular&nbsp;expression&nbsp;search.</span><br>
<span class="lineno"></span><span class="comment" id="5168489">//</span><br>
<span class="lineno"></span><span class="comment" id="5168492">//&nbsp;The&nbsp;syntax&nbsp;of&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;accepted&nbsp;is&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="5168554">//&nbsp;general&nbsp;syntax&nbsp;used&nbsp;by&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;languages.</span><br>
<span class="lineno"></span><span class="comment" id="5168615">//&nbsp;More&nbsp;precisely,&nbsp;it&nbsp;is&nbsp;the&nbsp;syntax&nbsp;accepted&nbsp;by&nbsp;RE2&nbsp;and&nbsp;described&nbsp;at</span><br>
<span class="lineno">10</span><span class="comment" id="5168684">//&nbsp;http://code.google.com/p/re2/wiki/Syntax,&nbsp;except&nbsp;for&nbsp;\C.</span><br>
<span class="lineno"></span><span class="comment" id="5168744">//&nbsp;For&nbsp;an&nbsp;overview&nbsp;of&nbsp;the&nbsp;syntax,&nbsp;run</span><br>
<span class="lineno"></span><span class="comment" id="5168782">//&nbsp;&nbsp;&nbsp;godoc&nbsp;regexp/syntax</span><br>
<span class="lineno"></span><span class="comment" id="5168807">//</span><br>
<span class="lineno"></span><span class="comment" id="5168810">//&nbsp;The&nbsp;regexp&nbsp;implementation&nbsp;provided&nbsp;by&nbsp;this&nbsp;package&nbsp;is</span><br>
<span class="lineno">15</span><span class="comment" id="5168867">//&nbsp;guaranteed&nbsp;to&nbsp;run&nbsp;in&nbsp;time&nbsp;linear&nbsp;in&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5168929">//&nbsp;(This&nbsp;is&nbsp;a&nbsp;property&nbsp;not&nbsp;guaranteed&nbsp;by&nbsp;most&nbsp;open&nbsp;source</span><br>
<span class="lineno"></span><span class="comment" id="5168987">//&nbsp;implementations&nbsp;of&nbsp;regular&nbsp;expressions.)&nbsp;For&nbsp;more&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="5169052">//&nbsp;about&nbsp;this&nbsp;property,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="5169080">//&nbsp;&nbsp;&nbsp;&nbsp;http://swtch.com/~rsc/regexp/regexp1.html</span><br>
<span class="lineno">20</span><span class="comment" id="5169125">//&nbsp;or&nbsp;any&nbsp;book&nbsp;about&nbsp;automata&nbsp;theory.</span><br>
<span class="lineno"></span><span class="comment" id="5169163">//</span><br>
<span class="lineno"></span><span class="comment" id="5169166">//&nbsp;All&nbsp;characters&nbsp;are&nbsp;UTF-8-encoded&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5169215">//</span><br>
<span class="lineno"></span><span class="comment" id="5169218">//&nbsp;There&nbsp;are&nbsp;16&nbsp;methods&nbsp;of&nbsp;Regexp&nbsp;that&nbsp;match&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;identify</span><br>
<span class="lineno">25</span><span class="comment" id="5169297">//&nbsp;the&nbsp;matched&nbsp;text.&nbsp;&nbsp;Their&nbsp;names&nbsp;are&nbsp;matched&nbsp;by&nbsp;this&nbsp;regular&nbsp;expression:</span><br>
<span class="lineno"></span><span class="comment" id="5169371">//</span><br>
<span class="lineno"></span><span class="comment" id="5169374">//&nbsp;&nbsp;&nbsp;&nbsp;Find(All)?(String)?(Submatch)?(Index)?</span><br>
<span class="lineno"></span><span class="comment" id="5169416">//</span><br>
<span class="lineno"></span><span class="comment" id="5169419">//&nbsp;If&nbsp;&#39;All&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;routine&nbsp;matches&nbsp;successive&nbsp;non-overlapping</span><br>
<span class="lineno">30</span><span class="comment" id="5169490">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression.&nbsp;&nbsp;Empty&nbsp;matches&nbsp;abutting&nbsp;a&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="5169563">//&nbsp;match&nbsp;are&nbsp;ignored.&nbsp;&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;containing&nbsp;the&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="5169640">//&nbsp;return&nbsp;values&nbsp;of&nbsp;the&nbsp;corresponding&nbsp;non-&#39;All&#39;&nbsp;routine.&nbsp;&nbsp;These&nbsp;routines&nbsp;take</span><br>
<span class="lineno"></span><span class="comment" id="5169718">//&nbsp;an&nbsp;extra&nbsp;integer&nbsp;argument,&nbsp;n;&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;function&nbsp;returns&nbsp;at&nbsp;most&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="5169793">//&nbsp;matches/submatches.</span><br>
<span class="lineno">35</span><span class="comment" id="5169816">//</span><br>
<span class="lineno"></span><span class="comment" id="5169819">//&nbsp;If&nbsp;&#39;String&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;string;&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5169896">//&nbsp;of&nbsp;bytes;&nbsp;return&nbsp;values&nbsp;are&nbsp;adjusted&nbsp;as&nbsp;appropriate.</span><br>
<span class="lineno"></span><span class="comment" id="5169952">//</span><br>
<span class="lineno"></span><span class="comment" id="5169955">//&nbsp;If&nbsp;&#39;Submatch&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;identifying&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="5170028">//&nbsp;successive&nbsp;submatches&nbsp;of&nbsp;the&nbsp;expression.&nbsp;Submatches&nbsp;are&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5170098">//&nbsp;parenthesized&nbsp;subexpressions&nbsp;(also&nbsp;known&nbsp;as&nbsp;capturing&nbsp;groups)&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5170174">//&nbsp;regular&nbsp;expression,&nbsp;numbered&nbsp;from&nbsp;left&nbsp;to&nbsp;right&nbsp;in&nbsp;order&nbsp;of&nbsp;opening</span><br>
<span class="lineno"></span><span class="comment" id="5170245">//&nbsp;parenthesis.&nbsp;Submatch&nbsp;0&nbsp;is&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression,&nbsp;submatch&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="5170322">//&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;first&nbsp;parenthesized&nbsp;subexpression,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">45</span><span class="comment" id="5170388">//</span><br>
<span class="lineno"></span><span class="comment" id="5170391">//&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;present,&nbsp;matches&nbsp;and&nbsp;submatches&nbsp;are&nbsp;identified&nbsp;by&nbsp;byte&nbsp;index</span><br>
<span class="lineno"></span><span class="comment" id="5170469">//&nbsp;pairs&nbsp;within&nbsp;the&nbsp;input&nbsp;string:&nbsp;result[2*n:2*n+1]&nbsp;identifies&nbsp;the&nbsp;indexes&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5170547">//&nbsp;the&nbsp;nth&nbsp;submatch.&nbsp;&nbsp;The&nbsp;pair&nbsp;for&nbsp;n==0&nbsp;identifies&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire</span><br>
<span class="lineno"></span><span class="comment" id="5170622">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;not&nbsp;present,&nbsp;the&nbsp;match&nbsp;is&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno">50</span><span class="comment" id="5170696">//&nbsp;text&nbsp;of&nbsp;the&nbsp;match/submatch.&nbsp;&nbsp;If&nbsp;an&nbsp;index&nbsp;is&nbsp;negative,&nbsp;it&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5170767">//&nbsp;subexpression&nbsp;did&nbsp;not&nbsp;match&nbsp;any&nbsp;string&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="5170823">//</span><br>
<span class="lineno"></span><span class="comment" id="5170826">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;subset&nbsp;of&nbsp;the&nbsp;methods&nbsp;that&nbsp;can&nbsp;be&nbsp;applied&nbsp;to&nbsp;text&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5170900">//&nbsp;from&nbsp;a&nbsp;RuneReader:</span><br>
<span class="lineno">55</span><span class="comment" id="5170922">//</span><br>
<span class="lineno"></span><span class="comment" id="5170925">//&nbsp;&nbsp;&nbsp;&nbsp;MatchReader,&nbsp;FindReaderIndex,&nbsp;FindReaderSubmatchIndex</span><br>
<span class="lineno"></span><span class="comment" id="5170982">//</span><br>
<span class="lineno"></span><span class="comment" id="5170985">//&nbsp;This&nbsp;set&nbsp;may&nbsp;grow.&nbsp;&nbsp;Note&nbsp;that&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;may&nbsp;need&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5171057">//&nbsp;examine&nbsp;text&nbsp;beyond&nbsp;the&nbsp;text&nbsp;returned&nbsp;by&nbsp;a&nbsp;match,&nbsp;so&nbsp;the&nbsp;methods&nbsp;that</span><br>
<span class="lineno">60</span><span class="comment" id="5171130">//&nbsp;match&nbsp;text&nbsp;from&nbsp;a&nbsp;RuneReader&nbsp;may&nbsp;read&nbsp;arbitrarily&nbsp;far&nbsp;into&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5171202">//&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="comment" id="5171223">//</span><br>
<span class="lineno"></span><span class="comment" id="5171226">//&nbsp;(There&nbsp;are&nbsp;a&nbsp;few&nbsp;other&nbsp;methods&nbsp;that&nbsp;do&nbsp;not&nbsp;match&nbsp;this&nbsp;pattern.)</span><br>
<span class="lineno"></span><span class="comment" id="5171293">//</span><br>
<span class="lineno">65</span><span class="keyword" id="5171296">package</span>&nbsp;<span class="ident" id="5171304">regexp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5171312">import</span>&nbsp;<span class="op" id="5171319">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171322">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171331">&#34;io&#34;</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171337">&#34;regexp/syntax&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171354">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171365">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171376">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171384">&#34;unicode&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5171395">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5171410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5171413">var</span>&nbsp;<span class="ident" id="5171417">debug</span>&nbsp;<span class="op" id="5171423">=</span>&nbsp;<span class="builtintype" id="5171425">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="5171432">//&nbsp;Regexp&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="5171498">//&nbsp;A&nbsp;Regexp&nbsp;is&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="5171561">type</span>&nbsp;<span class="ident" id="5171566">Regexp</span>&nbsp;<span class="keyword" id="5171573">struct</span>&nbsp;<span class="op" id="5171580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5171583">//&nbsp;read-only&nbsp;after&nbsp;Compile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171611">expr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5171626">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5171641">//&nbsp;as&nbsp;passed&nbsp;to&nbsp;Compile</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171666">prog</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5171681">*</span><span class="ident" id="5171682">syntax</span><span class="op" id="5171688">.</span><span class="ident" id="5171689">Prog</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5171696">//&nbsp;compiled&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171717">onepass</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5171732">*</span><span class="ident" id="5171733">onePassProg</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5171747">//&nbsp;onpass&nbsp;program&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171773">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5171788">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5171803">//&nbsp;required&nbsp;prefix&nbsp;in&nbsp;unanchored&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171845">prefixBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5171860">[</span><span class="op" id="5171861">]</span><span class="builtintype" id="5171862">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5171875">//&nbsp;prefix,&nbsp;as&nbsp;a&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171899">prefixComplete</span>&nbsp;<span class="builtintype" id="5171914">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5171929">//&nbsp;prefix&nbsp;is&nbsp;the&nbsp;entire&nbsp;regexp</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5171961">prefixRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5171976">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5171991">//&nbsp;first&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172016">prefixEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5172031">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5172046">//&nbsp;pc&nbsp;for&nbsp;last&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172077">cond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172092">syntax</span><span class="op" id="5172098">.</span><span class="ident" id="5172099">EmptyOp</span>&nbsp;<span class="comment" id="5172107">//&nbsp;empty-width&nbsp;conditions&nbsp;required&nbsp;at&nbsp;start&nbsp;of&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172161">numSubexp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5172176">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172181">subexpNames</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5172196">[</span><span class="op" id="5172197">]</span><span class="builtintype" id="5172198">string</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172206">longest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5172221">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5172228">//&nbsp;cache&nbsp;of&nbsp;machines&nbsp;for&nbsp;running&nbsp;regexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172269">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172277">sync</span><span class="op" id="5172281">.</span><span class="ident" id="5172282">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5172289">machine</span>&nbsp;<span class="op" id="5172297">[</span><span class="op" id="5172298">]</span><span class="op" id="5172299">*</span><span class="ident" id="5172300">machine</span><br>
<span class="lineno">100</span><span class="op" id="5172308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5172311">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;source&nbsp;text&nbsp;used&nbsp;to&nbsp;compile&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="5172385">func</span>&nbsp;<span class="op" id="5172390">(</span><span class="ident" id="5172391">re</span>&nbsp;<span class="op" id="5172394">*</span><span class="ident" id="5172395">Regexp</span><span class="op" id="5172401">)</span>&nbsp;<span class="ident" id="5172403">String</span><span class="op" id="5172409">(</span><span class="op" id="5172410">)</span>&nbsp;<span class="builtintype" id="5172412">string</span>&nbsp;<span class="op" id="5172419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5172422">return</span>&nbsp;<span class="ident" id="5172429">re</span><span class="op" id="5172431">.</span><span class="ident" id="5172432">expr</span><br>
<span class="lineno">105</span><span class="op" id="5172437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5172440">//&nbsp;Compile&nbsp;parses&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;returns,&nbsp;if&nbsp;successful,</span><br>
<span class="lineno"></span><span class="comment" id="5172507">//&nbsp;a&nbsp;Regexp&nbsp;object&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;match&nbsp;against&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5172566">//</span><br>
<span class="lineno">110</span><span class="comment" id="5172569">//&nbsp;When&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5172632">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5172704">//&nbsp;it&nbsp;chooses&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first.</span><br>
<span class="lineno"></span><span class="comment" id="5172777">//&nbsp;This&nbsp;so-called&nbsp;leftmost-first&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="5172841">//&nbsp;that&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;implementations&nbsp;use,&nbsp;although&nbsp;this</span><br>
<span class="lineno">115</span><span class="comment" id="5172908">//&nbsp;package&nbsp;implements&nbsp;it&nbsp;without&nbsp;the&nbsp;expense&nbsp;of&nbsp;backtracking.</span><br>
<span class="lineno"></span><span class="comment" id="5172970">//&nbsp;For&nbsp;POSIX&nbsp;leftmost-longest&nbsp;matching,&nbsp;see&nbsp;CompilePOSIX.</span><br>
<span class="lineno"></span><span class="keyword" id="5173028">func</span>&nbsp;<span class="ident" id="5173033">Compile</span><span class="op" id="5173040">(</span><span class="ident" id="5173041">expr</span>&nbsp;<span class="builtintype" id="5173046">string</span><span class="op" id="5173052">)</span>&nbsp;<span class="op" id="5173054">(</span><span class="op" id="5173055">*</span><span class="ident" id="5173056">Regexp</span><span class="op" id="5173062">,</span>&nbsp;<span class="builtintype" id="5173064">error</span><span class="op" id="5173069">)</span>&nbsp;<span class="op" id="5173071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5173074">return</span>&nbsp;<span class="ident" id="5173081">compile</span><span class="op" id="5173088">(</span><span class="ident" id="5173089">expr</span><span class="op" id="5173093">,</span>&nbsp;<span class="ident" id="5173095">syntax</span><span class="op" id="5173101">.</span><span class="ident" id="5173102">Perl</span><span class="op" id="5173106">,</span>&nbsp;<span class="builtintype" id="5173108">false</span><span class="op" id="5173113">)</span><br>
<span class="lineno"></span><span class="op" id="5173115">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5173118">//&nbsp;CompilePOSIX&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;restricts&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5173187">//&nbsp;to&nbsp;POSIX&nbsp;ERE&nbsp;(egrep)&nbsp;syntax&nbsp;and&nbsp;changes&nbsp;the&nbsp;match&nbsp;semantics&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5173253">//&nbsp;leftmost-longest.</span><br>
<span class="lineno"></span><span class="comment" id="5173274">//</span><br>
<span class="lineno">125</span><span class="comment" id="5173277">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5173349">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5173421">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="comment" id="5173472">//&nbsp;This&nbsp;so-called&nbsp;leftmost-longest&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="5173538">//&nbsp;that&nbsp;early&nbsp;regular&nbsp;expression&nbsp;implementations&nbsp;used&nbsp;and&nbsp;that&nbsp;POSIX</span><br>
<span class="lineno">130</span><span class="comment" id="5173607">//&nbsp;specifies.</span><br>
<span class="lineno"></span><span class="comment" id="5173621">//</span><br>
<span class="lineno"></span><span class="comment" id="5173624">//&nbsp;However,&nbsp;there&nbsp;can&nbsp;be&nbsp;multiple&nbsp;leftmost-longest&nbsp;matches,&nbsp;with&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5173699">//&nbsp;submatch&nbsp;choices,&nbsp;and&nbsp;here&nbsp;this&nbsp;package&nbsp;diverges&nbsp;from&nbsp;POSIX.</span><br>
<span class="lineno"></span><span class="comment" id="5173763">//&nbsp;Among&nbsp;the&nbsp;possible&nbsp;leftmost-longest&nbsp;matches,&nbsp;this&nbsp;package&nbsp;chooses</span><br>
<span class="lineno">135</span><span class="comment" id="5173832">//&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first,&nbsp;while&nbsp;POSIX</span><br>
<span class="lineno"></span><span class="comment" id="5173906">//&nbsp;specifies&nbsp;that&nbsp;the&nbsp;match&nbsp;be&nbsp;chosen&nbsp;to&nbsp;maximize&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5173980">//&nbsp;subexpression,&nbsp;then&nbsp;the&nbsp;second,&nbsp;and&nbsp;so&nbsp;on&nbsp;from&nbsp;left&nbsp;to&nbsp;right.</span><br>
<span class="lineno"></span><span class="comment" id="5174045">//&nbsp;The&nbsp;POSIX&nbsp;rule&nbsp;is&nbsp;computationally&nbsp;prohibitive&nbsp;and&nbsp;not&nbsp;even&nbsp;well-defined.</span><br>
<span class="lineno"></span><span class="comment" id="5174121">//&nbsp;See&nbsp;http://swtch.com/~rsc/regexp/regexp2.html#posix&nbsp;for&nbsp;details.</span><br>
<span class="lineno">140</span><span class="keyword" id="5174189">func</span>&nbsp;<span class="ident" id="5174194">CompilePOSIX</span><span class="op" id="5174206">(</span><span class="ident" id="5174207">expr</span>&nbsp;<span class="builtintype" id="5174212">string</span><span class="op" id="5174218">)</span>&nbsp;<span class="op" id="5174220">(</span><span class="op" id="5174221">*</span><span class="ident" id="5174222">Regexp</span><span class="op" id="5174228">,</span>&nbsp;<span class="builtintype" id="5174230">error</span><span class="op" id="5174235">)</span>&nbsp;<span class="op" id="5174237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5174240">return</span>&nbsp;<span class="ident" id="5174247">compile</span><span class="op" id="5174254">(</span><span class="ident" id="5174255">expr</span><span class="op" id="5174259">,</span>&nbsp;<span class="ident" id="5174261">syntax</span><span class="op" id="5174267">.</span><span class="ident" id="5174268">POSIX</span><span class="op" id="5174273">,</span>&nbsp;<span class="builtintype" id="5174275">true</span><span class="op" id="5174279">)</span><br>
<span class="lineno"></span><span class="op" id="5174281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5174284">//&nbsp;Longest&nbsp;makes&nbsp;future&nbsp;searches&nbsp;prefer&nbsp;the&nbsp;leftmost-longest&nbsp;match.</span><br>
<span class="lineno">145</span><span class="comment" id="5174352">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5174424">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="5174496">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="5174547">func</span>&nbsp;<span class="op" id="5174552">(</span><span class="ident" id="5174553">re</span>&nbsp;<span class="op" id="5174556">*</span><span class="ident" id="5174557">Regexp</span><span class="op" id="5174563">)</span>&nbsp;<span class="ident" id="5174565">Longest</span><span class="op" id="5174572">(</span><span class="op" id="5174573">)</span>&nbsp;<span class="op" id="5174575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174578">re</span><span class="op" id="5174580">.</span><span class="ident" id="5174581">longest</span>&nbsp;<span class="op" id="5174589">=</span>&nbsp;<span class="builtintype" id="5174591">true</span><br>
<span class="lineno">150</span><span class="op" id="5174596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5174599">func</span>&nbsp;<span class="ident" id="5174604">compile</span><span class="op" id="5174611">(</span><span class="ident" id="5174612">expr</span>&nbsp;<span class="builtintype" id="5174617">string</span><span class="op" id="5174623">,</span>&nbsp;<span class="ident" id="5174625">mode</span>&nbsp;<span class="ident" id="5174630">syntax</span><span class="op" id="5174636">.</span><span class="ident" id="5174637">Flags</span><span class="op" id="5174642">,</span>&nbsp;<span class="ident" id="5174644">longest</span>&nbsp;<span class="builtintype" id="5174652">bool</span><span class="op" id="5174656">)</span>&nbsp;<span class="op" id="5174658">(</span><span class="op" id="5174659">*</span><span class="ident" id="5174660">Regexp</span><span class="op" id="5174666">,</span>&nbsp;<span class="builtintype" id="5174668">error</span><span class="op" id="5174673">)</span>&nbsp;<span class="op" id="5174675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174678">re</span><span class="op" id="5174680">,</span>&nbsp;<span class="ident" id="5174682">err</span>&nbsp;<span class="op" id="5174686">:=</span>&nbsp;<span class="ident" id="5174689">syntax</span><span class="op" id="5174695">.</span><span class="ident" id="5174696">Parse</span><span class="op" id="5174701">(</span><span class="ident" id="5174702">expr</span><span class="op" id="5174706">,</span>&nbsp;<span class="ident" id="5174708">mode</span><span class="op" id="5174712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5174715">if</span>&nbsp;<span class="ident" id="5174718">err</span>&nbsp;<span class="op" id="5174722">!=</span>&nbsp;<span class="builtintype" id="5174725">nil</span>&nbsp;<span class="op" id="5174729">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5174733">return</span>&nbsp;<span class="builtintype" id="5174740">nil</span><span class="op" id="5174743">,</span>&nbsp;<span class="ident" id="5174745">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5174750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174753">maxCap</span>&nbsp;<span class="op" id="5174760">:=</span>&nbsp;<span class="ident" id="5174763">re</span><span class="op" id="5174765">.</span><span class="ident" id="5174766">MaxCap</span><span class="op" id="5174772">(</span><span class="op" id="5174773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174776">capNames</span>&nbsp;<span class="op" id="5174785">:=</span>&nbsp;<span class="ident" id="5174788">re</span><span class="op" id="5174790">.</span><span class="ident" id="5174791">CapNames</span><span class="op" id="5174799">(</span><span class="op" id="5174800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174804">re</span>&nbsp;<span class="op" id="5174807">=</span>&nbsp;<span class="ident" id="5174809">re</span><span class="op" id="5174811">.</span><span class="ident" id="5174812">Simplify</span><span class="op" id="5174820">(</span><span class="op" id="5174821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174824">prog</span><span class="op" id="5174828">,</span>&nbsp;<span class="ident" id="5174830">err</span>&nbsp;<span class="op" id="5174834">:=</span>&nbsp;<span class="ident" id="5174837">syntax</span><span class="op" id="5174843">.</span><span class="ident" id="5174844">Compile</span><span class="op" id="5174851">(</span><span class="ident" id="5174852">re</span><span class="op" id="5174854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5174857">if</span>&nbsp;<span class="ident" id="5174860">err</span>&nbsp;<span class="op" id="5174864">!=</span>&nbsp;<span class="builtintype" id="5174867">nil</span>&nbsp;<span class="op" id="5174871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5174875">return</span>&nbsp;<span class="builtintype" id="5174882">nil</span><span class="op" id="5174885">,</span>&nbsp;<span class="ident" id="5174887">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5174892">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174895">regexp</span>&nbsp;<span class="op" id="5174902">:=</span>&nbsp;<span class="op" id="5174905">&amp;</span><span class="ident" id="5174906">Regexp</span><span class="op" id="5174912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174916">expr</span><span class="op" id="5174920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174929">expr</span><span class="op" id="5174933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174937">prog</span><span class="op" id="5174941">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174950">prog</span><span class="op" id="5174954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174958">onepass</span><span class="op" id="5174965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174971">compileOnePass</span><span class="op" id="5174985">(</span><span class="ident" id="5174986">prog</span><span class="op" id="5174990">)</span><span class="op" id="5174991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5174995">numSubexp</span><span class="op" id="5175004">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5175008">maxCap</span><span class="op" id="5175014">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175018">subexpNames</span><span class="op" id="5175029">:</span>&nbsp;<span class="ident" id="5175031">capNames</span><span class="op" id="5175039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175043">cond</span><span class="op" id="5175047">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175056">prog</span><span class="op" id="5175060">.</span><span class="ident" id="5175061">StartCond</span><span class="op" id="5175070">(</span><span class="op" id="5175071">)</span><span class="op" id="5175072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175076">longest</span><span class="op" id="5175083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175089">longest</span><span class="op" id="5175096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5175099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175102">if</span>&nbsp;<span class="ident" id="5175105">regexp</span><span class="op" id="5175111">.</span><span class="ident" id="5175112">onepass</span>&nbsp;<span class="op" id="5175120">==</span>&nbsp;<span class="ident" id="5175123">notOnePass</span>&nbsp;<span class="op" id="5175134">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175138">regexp</span><span class="op" id="5175144">.</span><span class="ident" id="5175145">prefix</span><span class="op" id="5175151">,</span>&nbsp;<span class="ident" id="5175153">regexp</span><span class="op" id="5175159">.</span><span class="ident" id="5175160">prefixComplete</span>&nbsp;<span class="op" id="5175175">=</span>&nbsp;<span class="ident" id="5175177">prog</span><span class="op" id="5175181">.</span><span class="ident" id="5175182">Prefix</span><span class="op" id="5175188">(</span><span class="op" id="5175189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5175192">}</span>&nbsp;<span class="keyword" id="5175194">else</span>&nbsp;<span class="op" id="5175199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175203">regexp</span><span class="op" id="5175209">.</span><span class="ident" id="5175210">prefix</span><span class="op" id="5175216">,</span>&nbsp;<span class="ident" id="5175218">regexp</span><span class="op" id="5175224">.</span><span class="ident" id="5175225">prefixComplete</span><span class="op" id="5175239">,</span>&nbsp;<span class="ident" id="5175241">regexp</span><span class="op" id="5175247">.</span><span class="ident" id="5175248">prefixEnd</span>&nbsp;<span class="op" id="5175258">=</span>&nbsp;<span class="ident" id="5175260">onePassPrefix</span><span class="op" id="5175273">(</span><span class="ident" id="5175274">prog</span><span class="op" id="5175278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5175281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175284">if</span>&nbsp;<span class="ident" id="5175287">regexp</span><span class="op" id="5175293">.</span><span class="ident" id="5175294">prefix</span>&nbsp;<span class="op" id="5175301">!=</span>&nbsp;<span class="string" id="5175304">&#34;&#34;</span>&nbsp;<span class="op" id="5175307">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5175311">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;this&nbsp;allocation&nbsp;by&nbsp;adding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5175360">//&nbsp;IndexString&nbsp;to&nbsp;package&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175395">regexp</span><span class="op" id="5175401">.</span><span class="ident" id="5175402">prefixBytes</span>&nbsp;<span class="op" id="5175414">=</span>&nbsp;<span class="op" id="5175416">[</span><span class="op" id="5175417">]</span><span class="builtintype" id="5175418">byte</span><span class="op" id="5175422">(</span><span class="ident" id="5175423">regexp</span><span class="op" id="5175429">.</span><span class="ident" id="5175430">prefix</span><span class="op" id="5175436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175440">regexp</span><span class="op" id="5175446">.</span><span class="ident" id="5175447">prefixRune</span><span class="op" id="5175457">,</span>&nbsp;<span class="ident" id="5175459">_</span>&nbsp;<span class="op" id="5175461">=</span>&nbsp;<span class="ident" id="5175463">utf8</span><span class="op" id="5175467">.</span><span class="ident" id="5175468">DecodeRuneInString</span><span class="op" id="5175486">(</span><span class="ident" id="5175487">regexp</span><span class="op" id="5175493">.</span><span class="ident" id="5175494">prefix</span><span class="op" id="5175500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5175503">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175506">return</span>&nbsp;<span class="ident" id="5175513">regexp</span><span class="op" id="5175519">,</span>&nbsp;<span class="builtintype" id="5175521">nil</span><br>
<span class="lineno"></span><span class="op" id="5175525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5175528">//&nbsp;get&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;use&nbsp;for&nbsp;matching&nbsp;re.</span><br>
<span class="lineno"></span><span class="comment" id="5175577">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache&nbsp;if&nbsp;possible,&nbsp;to&nbsp;avoid</span><br>
<span class="lineno">190</span><span class="comment" id="5175633">//&nbsp;unnecessary&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5175660">func</span>&nbsp;<span class="op" id="5175665">(</span><span class="ident" id="5175666">re</span>&nbsp;<span class="op" id="5175669">*</span><span class="ident" id="5175670">Regexp</span><span class="op" id="5175676">)</span>&nbsp;<span class="ident" id="5175678">get</span><span class="op" id="5175681">(</span><span class="op" id="5175682">)</span>&nbsp;<span class="op" id="5175684">*</span><span class="ident" id="5175685">machine</span>&nbsp;<span class="op" id="5175693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175696">re</span><span class="op" id="5175698">.</span><span class="ident" id="5175699">mu</span><span class="op" id="5175701">.</span><span class="ident" id="5175702">Lock</span><span class="op" id="5175706">(</span><span class="op" id="5175707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175710">if</span>&nbsp;<span class="ident" id="5175713">n</span>&nbsp;<span class="op" id="5175715">:=</span>&nbsp;<span class="builtinfunc" id="5175718">len</span><span class="op" id="5175721">(</span><span class="ident" id="5175722">re</span><span class="op" id="5175724">.</span><span class="ident" id="5175725">machine</span><span class="op" id="5175732">)</span><span class="op" id="5175733">;</span>&nbsp;<span class="ident" id="5175735">n</span>&nbsp;<span class="op" id="5175737">&gt;</span>&nbsp;<span class="num" id="5175739">0</span>&nbsp;<span class="op" id="5175741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175745">z</span>&nbsp;<span class="op" id="5175747">:=</span>&nbsp;<span class="ident" id="5175750">re</span><span class="op" id="5175752">.</span><span class="ident" id="5175753">machine</span><span class="op" id="5175760">[</span><span class="ident" id="5175761">n</span><span class="op" id="5175762">-</span><span class="num" id="5175763">1</span><span class="op" id="5175764">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175768">re</span><span class="op" id="5175770">.</span><span class="ident" id="5175771">machine</span>&nbsp;<span class="op" id="5175779">=</span>&nbsp;<span class="ident" id="5175781">re</span><span class="op" id="5175783">.</span><span class="ident" id="5175784">machine</span><span class="op" id="5175791">[</span><span class="op" id="5175792">:</span><span class="ident" id="5175793">n</span><span class="op" id="5175794">-</span><span class="num" id="5175795">1</span><span class="op" id="5175796">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175800">re</span><span class="op" id="5175802">.</span><span class="ident" id="5175803">mu</span><span class="op" id="5175805">.</span><span class="ident" id="5175806">Unlock</span><span class="op" id="5175812">(</span><span class="op" id="5175813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175817">return</span>&nbsp;<span class="ident" id="5175824">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5175827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175830">re</span><span class="op" id="5175832">.</span><span class="ident" id="5175833">mu</span><span class="op" id="5175835">.</span><span class="ident" id="5175836">Unlock</span><span class="op" id="5175842">(</span><span class="op" id="5175843">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175846">z</span>&nbsp;<span class="op" id="5175848">:=</span>&nbsp;<span class="ident" id="5175851">progMachine</span><span class="op" id="5175862">(</span><span class="ident" id="5175863">re</span><span class="op" id="5175865">.</span><span class="ident" id="5175866">prog</span><span class="op" id="5175870">,</span>&nbsp;<span class="ident" id="5175872">re</span><span class="op" id="5175874">.</span><span class="ident" id="5175875">onepass</span><span class="op" id="5175882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5175885">z</span><span class="op" id="5175886">.</span><span class="ident" id="5175887">re</span>&nbsp;<span class="op" id="5175890">=</span>&nbsp;<span class="ident" id="5175892">re</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175896">return</span>&nbsp;<span class="ident" id="5175903">z</span><br>
<span class="lineno"></span><span class="op" id="5175905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="5175908">//&nbsp;put&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache.</span><br>
<span class="lineno"></span><span class="comment" id="5175960">//&nbsp;There&nbsp;is&nbsp;no&nbsp;attempt&nbsp;to&nbsp;limit&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;cache,&nbsp;so&nbsp;it&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5176026">//&nbsp;grow&nbsp;to&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;simultaneous&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5176080">//&nbsp;run&nbsp;using&nbsp;re.&nbsp;&nbsp;(The&nbsp;cache&nbsp;empties&nbsp;when&nbsp;re&nbsp;gets&nbsp;garbage&nbsp;collected.)</span><br>
<span class="lineno"></span><span class="keyword" id="5176150">func</span>&nbsp;<span class="op" id="5176155">(</span><span class="ident" id="5176156">re</span>&nbsp;<span class="op" id="5176159">*</span><span class="ident" id="5176160">Regexp</span><span class="op" id="5176166">)</span>&nbsp;<span class="ident" id="5176168">put</span><span class="op" id="5176171">(</span><span class="ident" id="5176172">z</span>&nbsp;<span class="op" id="5176174">*</span><span class="ident" id="5176175">machine</span><span class="op" id="5176182">)</span>&nbsp;<span class="op" id="5176184">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5176187">re</span><span class="op" id="5176189">.</span><span class="ident" id="5176190">mu</span><span class="op" id="5176192">.</span><span class="ident" id="5176193">Lock</span><span class="op" id="5176197">(</span><span class="op" id="5176198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5176201">re</span><span class="op" id="5176203">.</span><span class="ident" id="5176204">machine</span>&nbsp;<span class="op" id="5176212">=</span>&nbsp;<span class="builtinfunc" id="5176214">append</span><span class="op" id="5176220">(</span><span class="ident" id="5176221">re</span><span class="op" id="5176223">.</span><span class="ident" id="5176224">machine</span><span class="op" id="5176231">,</span>&nbsp;<span class="ident" id="5176233">z</span><span class="op" id="5176234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5176237">re</span><span class="op" id="5176239">.</span><span class="ident" id="5176240">mu</span><span class="op" id="5176242">.</span><span class="ident" id="5176243">Unlock</span><span class="op" id="5176249">(</span><span class="op" id="5176250">)</span><br>
<span class="lineno"></span><span class="op" id="5176252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="5176255">//&nbsp;MustCompile&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="5176333">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5176415">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="5176431">func</span>&nbsp;<span class="ident" id="5176436">MustCompile</span><span class="op" id="5176447">(</span><span class="ident" id="5176448">str</span>&nbsp;<span class="builtintype" id="5176452">string</span><span class="op" id="5176458">)</span>&nbsp;<span class="op" id="5176460">*</span><span class="ident" id="5176461">Regexp</span>&nbsp;<span class="op" id="5176468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5176471">regexp</span><span class="op" id="5176477">,</span>&nbsp;<span class="builtintype" id="5176479">error</span>&nbsp;<span class="op" id="5176485">:=</span>&nbsp;<span class="ident" id="5176488">Compile</span><span class="op" id="5176495">(</span><span class="ident" id="5176496">str</span><span class="op" id="5176499">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5176502">if</span>&nbsp;<span class="builtintype" id="5176505">error</span>&nbsp;<span class="op" id="5176511">!=</span>&nbsp;<span class="builtintype" id="5176514">nil</span>&nbsp;<span class="op" id="5176518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5176522">panic</span><span class="op" id="5176527">(</span><span class="string" id="5176528">`regexp:&nbsp;Compile(`</span>&nbsp;<span class="op" id="5176547">+</span>&nbsp;<span class="ident" id="5176549">quote</span><span class="op" id="5176554">(</span><span class="ident" id="5176555">str</span><span class="op" id="5176558">)</span>&nbsp;<span class="op" id="5176560">+</span>&nbsp;<span class="string" id="5176562">`):&nbsp;`</span>&nbsp;<span class="op" id="5176568">+</span>&nbsp;<span class="builtintype" id="5176570">error</span><span class="op" id="5176575">.</span><span class="ident" id="5176576">Error</span><span class="op" id="5176581">(</span><span class="op" id="5176582">)</span><span class="op" id="5176583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5176586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5176589">return</span>&nbsp;<span class="ident" id="5176596">regexp</span><br>
<span class="lineno"></span><span class="op" id="5176603">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="5176606">//&nbsp;MustCompilePOSIX&nbsp;is&nbsp;like&nbsp;CompilePOSIX&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="5176694">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5176776">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="5176792">func</span>&nbsp;<span class="ident" id="5176797">MustCompilePOSIX</span><span class="op" id="5176813">(</span><span class="ident" id="5176814">str</span>&nbsp;<span class="builtintype" id="5176818">string</span><span class="op" id="5176824">)</span>&nbsp;<span class="op" id="5176826">*</span><span class="ident" id="5176827">Regexp</span>&nbsp;<span class="op" id="5176834">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5176837">regexp</span><span class="op" id="5176843">,</span>&nbsp;<span class="builtintype" id="5176845">error</span>&nbsp;<span class="op" id="5176851">:=</span>&nbsp;<span class="ident" id="5176854">CompilePOSIX</span><span class="op" id="5176866">(</span><span class="ident" id="5176867">str</span><span class="op" id="5176870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5176873">if</span>&nbsp;<span class="builtintype" id="5176876">error</span>&nbsp;<span class="op" id="5176882">!=</span>&nbsp;<span class="builtintype" id="5176885">nil</span>&nbsp;<span class="op" id="5176889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5176893">panic</span><span class="op" id="5176898">(</span><span class="string" id="5176899">`regexp:&nbsp;CompilePOSIX(`</span>&nbsp;<span class="op" id="5176923">+</span>&nbsp;<span class="ident" id="5176925">quote</span><span class="op" id="5176930">(</span><span class="ident" id="5176931">str</span><span class="op" id="5176934">)</span>&nbsp;<span class="op" id="5176936">+</span>&nbsp;<span class="string" id="5176938">`):&nbsp;`</span>&nbsp;<span class="op" id="5176944">+</span>&nbsp;<span class="builtintype" id="5176946">error</span><span class="op" id="5176951">.</span><span class="ident" id="5176952">Error</span><span class="op" id="5176957">(</span><span class="op" id="5176958">)</span><span class="op" id="5176959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5176962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5176965">return</span>&nbsp;<span class="ident" id="5176972">regexp</span><br>
<span class="lineno">235</span><span class="op" id="5176979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5176982">func</span>&nbsp;<span class="ident" id="5176987">quote</span><span class="op" id="5176992">(</span><span class="ident" id="5176993">s</span>&nbsp;<span class="builtintype" id="5176995">string</span><span class="op" id="5177001">)</span>&nbsp;<span class="builtintype" id="5177003">string</span>&nbsp;<span class="op" id="5177010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5177013">if</span>&nbsp;<span class="ident" id="5177016">strconv</span><span class="op" id="5177023">.</span><span class="ident" id="5177024">CanBackquote</span><span class="op" id="5177036">(</span><span class="ident" id="5177037">s</span><span class="op" id="5177038">)</span>&nbsp;<span class="op" id="5177040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5177044">return</span>&nbsp;<span class="string" id="5177051">&#34;`&#34;</span>&nbsp;<span class="op" id="5177055">+</span>&nbsp;<span class="ident" id="5177057">s</span>&nbsp;<span class="op" id="5177059">+</span>&nbsp;<span class="string" id="5177061">&#34;`&#34;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5177066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5177069">return</span>&nbsp;<span class="ident" id="5177076">strconv</span><span class="op" id="5177083">.</span><span class="ident" id="5177084">Quote</span><span class="op" id="5177089">(</span><span class="ident" id="5177090">s</span><span class="op" id="5177091">)</span><br>
<span class="lineno"></span><span class="op" id="5177093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5177096">//&nbsp;NumSubexp&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;parenthesized&nbsp;subexpressions&nbsp;in&nbsp;this&nbsp;Regexp.</span><br>
<span class="lineno">245</span><span class="keyword" id="5177176">func</span>&nbsp;<span class="op" id="5177181">(</span><span class="ident" id="5177182">re</span>&nbsp;<span class="op" id="5177185">*</span><span class="ident" id="5177186">Regexp</span><span class="op" id="5177192">)</span>&nbsp;<span class="ident" id="5177194">NumSubexp</span><span class="op" id="5177203">(</span><span class="op" id="5177204">)</span>&nbsp;<span class="builtintype" id="5177206">int</span>&nbsp;<span class="op" id="5177210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5177213">return</span>&nbsp;<span class="ident" id="5177220">re</span><span class="op" id="5177222">.</span><span class="ident" id="5177223">numSubexp</span><br>
<span class="lineno"></span><span class="op" id="5177233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5177236">//&nbsp;SubexpNames&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;parenthesized&nbsp;subexpressions</span><br>
<span class="lineno">250</span><span class="comment" id="5177305">//&nbsp;in&nbsp;this&nbsp;Regexp.&nbsp;&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;first&nbsp;sub-expression&nbsp;is&nbsp;names[1],</span><br>
<span class="lineno"></span><span class="comment" id="5177376">//&nbsp;so&nbsp;that&nbsp;if&nbsp;m&nbsp;is&nbsp;a&nbsp;match&nbsp;slice,&nbsp;the&nbsp;name&nbsp;for&nbsp;m[i]&nbsp;is&nbsp;SubexpNames()[i].</span><br>
<span class="lineno"></span><span class="comment" id="5177449">//&nbsp;Since&nbsp;the&nbsp;Regexp&nbsp;as&nbsp;a&nbsp;whole&nbsp;cannot&nbsp;be&nbsp;named,&nbsp;names[0]&nbsp;is&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="5177516">//&nbsp;the&nbsp;empty&nbsp;string.&nbsp;&nbsp;The&nbsp;slice&nbsp;should&nbsp;not&nbsp;be&nbsp;modified.</span><br>
<span class="lineno"></span><span class="keyword" id="5177572">func</span>&nbsp;<span class="op" id="5177577">(</span><span class="ident" id="5177578">re</span>&nbsp;<span class="op" id="5177581">*</span><span class="ident" id="5177582">Regexp</span><span class="op" id="5177588">)</span>&nbsp;<span class="ident" id="5177590">SubexpNames</span><span class="op" id="5177601">(</span><span class="op" id="5177602">)</span>&nbsp;<span class="op" id="5177604">[</span><span class="op" id="5177605">]</span><span class="builtintype" id="5177606">string</span>&nbsp;<span class="op" id="5177613">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5177616">return</span>&nbsp;<span class="ident" id="5177623">re</span><span class="op" id="5177625">.</span><span class="ident" id="5177626">subexpNames</span><br>
<span class="lineno"></span><span class="op" id="5177638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5177641">const</span>&nbsp;<span class="ident" id="5177647">endOfText</span>&nbsp;<span class="builtintype" id="5177657">rune</span>&nbsp;<span class="op" id="5177662">=</span>&nbsp;<span class="op" id="5177664">-</span><span class="num" id="5177665">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="5177668">//&nbsp;input&nbsp;abstracts&nbsp;different&nbsp;representations&nbsp;of&nbsp;the&nbsp;input&nbsp;text.&nbsp;It&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="5177744">//&nbsp;one-character&nbsp;lookahead.</span><br>
<span class="lineno"></span><span class="keyword" id="5177772">type</span>&nbsp;<span class="ident" id="5177777">input</span>&nbsp;<span class="keyword" id="5177783">interface</span>&nbsp;<span class="op" id="5177793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5177796">step</span><span class="op" id="5177800">(</span><span class="ident" id="5177801">pos</span>&nbsp;<span class="builtintype" id="5177805">int</span><span class="op" id="5177808">)</span>&nbsp;<span class="op" id="5177810">(</span><span class="ident" id="5177811">r</span>&nbsp;<span class="builtintype" id="5177813">rune</span><span class="op" id="5177817">,</span>&nbsp;<span class="ident" id="5177819">width</span>&nbsp;<span class="builtintype" id="5177825">int</span><span class="op" id="5177828">)</span>&nbsp;<span class="comment" id="5177830">//&nbsp;advance&nbsp;one&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5177851">canCheckPrefix</span><span class="op" id="5177865">(</span><span class="op" id="5177866">)</span>&nbsp;<span class="builtintype" id="5177868">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5177885">//&nbsp;can&nbsp;we&nbsp;look&nbsp;ahead&nbsp;without&nbsp;losing&nbsp;info?</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5177928">hasPrefix</span><span class="op" id="5177937">(</span><span class="ident" id="5177938">re</span>&nbsp;<span class="op" id="5177941">*</span><span class="ident" id="5177942">Regexp</span><span class="op" id="5177948">)</span>&nbsp;<span class="builtintype" id="5177950">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5177956">index</span><span class="op" id="5177961">(</span><span class="ident" id="5177962">re</span>&nbsp;<span class="op" id="5177965">*</span><span class="ident" id="5177966">Regexp</span><span class="op" id="5177972">,</span>&nbsp;<span class="ident" id="5177974">pos</span>&nbsp;<span class="builtintype" id="5177978">int</span><span class="op" id="5177981">)</span>&nbsp;<span class="builtintype" id="5177983">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5177988">context</span><span class="op" id="5177995">(</span><span class="ident" id="5177996">pos</span>&nbsp;<span class="builtintype" id="5178000">int</span><span class="op" id="5178003">)</span>&nbsp;<span class="ident" id="5178005">syntax</span><span class="op" id="5178011">.</span><span class="ident" id="5178012">EmptyOp</span><br>
<span class="lineno"></span><span class="op" id="5178020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="5178023">//&nbsp;inputString&nbsp;scans&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5178054">type</span>&nbsp;<span class="ident" id="5178059">inputString</span>&nbsp;<span class="keyword" id="5178071">struct</span>&nbsp;<span class="op" id="5178078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5178081">str</span>&nbsp;<span class="builtintype" id="5178085">string</span><br>
<span class="lineno"></span><span class="op" id="5178092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="5178095">func</span>&nbsp;<span class="op" id="5178100">(</span><span class="ident" id="5178101">i</span>&nbsp;<span class="op" id="5178103">*</span><span class="ident" id="5178104">inputString</span><span class="op" id="5178115">)</span>&nbsp;<span class="ident" id="5178117">step</span><span class="op" id="5178121">(</span><span class="ident" id="5178122">pos</span>&nbsp;<span class="builtintype" id="5178126">int</span><span class="op" id="5178129">)</span>&nbsp;<span class="op" id="5178131">(</span><span class="builtintype" id="5178132">rune</span><span class="op" id="5178136">,</span>&nbsp;<span class="builtintype" id="5178138">int</span><span class="op" id="5178141">)</span>&nbsp;<span class="op" id="5178143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178146">if</span>&nbsp;<span class="ident" id="5178149">pos</span>&nbsp;<span class="op" id="5178153">&lt;</span>&nbsp;<span class="builtinfunc" id="5178155">len</span><span class="op" id="5178158">(</span><span class="ident" id="5178159">i</span><span class="op" id="5178160">.</span><span class="ident" id="5178161">str</span><span class="op" id="5178164">)</span>&nbsp;<span class="op" id="5178166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5178170">c</span>&nbsp;<span class="op" id="5178172">:=</span>&nbsp;<span class="ident" id="5178175">i</span><span class="op" id="5178176">.</span><span class="ident" id="5178177">str</span><span class="op" id="5178180">[</span><span class="ident" id="5178181">pos</span><span class="op" id="5178184">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178188">if</span>&nbsp;<span class="ident" id="5178191">c</span>&nbsp;<span class="op" id="5178193">&lt;</span>&nbsp;<span class="ident" id="5178195">utf8</span><span class="op" id="5178199">.</span><span class="ident" id="5178200">RuneSelf</span>&nbsp;<span class="op" id="5178209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178214">return</span>&nbsp;<span class="builtintype" id="5178221">rune</span><span class="op" id="5178225">(</span><span class="ident" id="5178226">c</span><span class="op" id="5178227">)</span><span class="op" id="5178228">,</span>&nbsp;<span class="num" id="5178230">1</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5178234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178238">return</span>&nbsp;<span class="ident" id="5178245">utf8</span><span class="op" id="5178249">.</span><span class="ident" id="5178250">DecodeRuneInString</span><span class="op" id="5178268">(</span><span class="ident" id="5178269">i</span><span class="op" id="5178270">.</span><span class="ident" id="5178271">str</span><span class="op" id="5178274">[</span><span class="ident" id="5178275">pos</span><span class="op" id="5178278">:</span><span class="op" id="5178279">]</span><span class="op" id="5178280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5178283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178286">return</span>&nbsp;<span class="ident" id="5178293">endOfText</span><span class="op" id="5178302">,</span>&nbsp;<span class="num" id="5178304">0</span><br>
<span class="lineno"></span><span class="op" id="5178306">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="5178309">func</span>&nbsp;<span class="op" id="5178314">(</span><span class="ident" id="5178315">i</span>&nbsp;<span class="op" id="5178317">*</span><span class="ident" id="5178318">inputString</span><span class="op" id="5178329">)</span>&nbsp;<span class="ident" id="5178331">canCheckPrefix</span><span class="op" id="5178345">(</span><span class="op" id="5178346">)</span>&nbsp;<span class="builtintype" id="5178348">bool</span>&nbsp;<span class="op" id="5178353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178356">return</span>&nbsp;<span class="builtintype" id="5178363">true</span><br>
<span class="lineno"></span><span class="op" id="5178368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="5178371">func</span>&nbsp;<span class="op" id="5178376">(</span><span class="ident" id="5178377">i</span>&nbsp;<span class="op" id="5178379">*</span><span class="ident" id="5178380">inputString</span><span class="op" id="5178391">)</span>&nbsp;<span class="ident" id="5178393">hasPrefix</span><span class="op" id="5178402">(</span><span class="ident" id="5178403">re</span>&nbsp;<span class="op" id="5178406">*</span><span class="ident" id="5178407">Regexp</span><span class="op" id="5178413">)</span>&nbsp;<span class="builtintype" id="5178415">bool</span>&nbsp;<span class="op" id="5178420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178423">return</span>&nbsp;<span class="ident" id="5178430">strings</span><span class="op" id="5178437">.</span><span class="ident" id="5178438">HasPrefix</span><span class="op" id="5178447">(</span><span class="ident" id="5178448">i</span><span class="op" id="5178449">.</span><span class="ident" id="5178450">str</span><span class="op" id="5178453">,</span>&nbsp;<span class="ident" id="5178455">re</span><span class="op" id="5178457">.</span><span class="ident" id="5178458">prefix</span><span class="op" id="5178464">)</span><br>
<span class="lineno"></span><span class="op" id="5178466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5178469">func</span>&nbsp;<span class="op" id="5178474">(</span><span class="ident" id="5178475">i</span>&nbsp;<span class="op" id="5178477">*</span><span class="ident" id="5178478">inputString</span><span class="op" id="5178489">)</span>&nbsp;<span class="ident" id="5178491">index</span><span class="op" id="5178496">(</span><span class="ident" id="5178497">re</span>&nbsp;<span class="op" id="5178500">*</span><span class="ident" id="5178501">Regexp</span><span class="op" id="5178507">,</span>&nbsp;<span class="ident" id="5178509">pos</span>&nbsp;<span class="builtintype" id="5178513">int</span><span class="op" id="5178516">)</span>&nbsp;<span class="builtintype" id="5178518">int</span>&nbsp;<span class="op" id="5178522">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178525">return</span>&nbsp;<span class="ident" id="5178532">strings</span><span class="op" id="5178539">.</span><span class="ident" id="5178540">Index</span><span class="op" id="5178545">(</span><span class="ident" id="5178546">i</span><span class="op" id="5178547">.</span><span class="ident" id="5178548">str</span><span class="op" id="5178551">[</span><span class="ident" id="5178552">pos</span><span class="op" id="5178555">:</span><span class="op" id="5178556">]</span><span class="op" id="5178557">,</span>&nbsp;<span class="ident" id="5178559">re</span><span class="op" id="5178561">.</span><span class="ident" id="5178562">prefix</span><span class="op" id="5178568">)</span><br>
<span class="lineno"></span><span class="op" id="5178570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5178573">func</span>&nbsp;<span class="op" id="5178578">(</span><span class="ident" id="5178579">i</span>&nbsp;<span class="op" id="5178581">*</span><span class="ident" id="5178582">inputString</span><span class="op" id="5178593">)</span>&nbsp;<span class="ident" id="5178595">context</span><span class="op" id="5178602">(</span><span class="ident" id="5178603">pos</span>&nbsp;<span class="builtintype" id="5178607">int</span><span class="op" id="5178610">)</span>&nbsp;<span class="ident" id="5178612">syntax</span><span class="op" id="5178618">.</span><span class="ident" id="5178619">EmptyOp</span>&nbsp;<span class="op" id="5178627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5178630">r1</span><span class="op" id="5178632">,</span>&nbsp;<span class="ident" id="5178634">r2</span>&nbsp;<span class="op" id="5178637">:=</span>&nbsp;<span class="ident" id="5178640">endOfText</span><span class="op" id="5178649">,</span>&nbsp;<span class="ident" id="5178651">endOfText</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178662">if</span>&nbsp;<span class="ident" id="5178665">pos</span>&nbsp;<span class="op" id="5178669">&gt;</span>&nbsp;<span class="num" id="5178671">0</span>&nbsp;<span class="op" id="5178673">&amp;&amp;</span>&nbsp;<span class="ident" id="5178676">pos</span>&nbsp;<span class="op" id="5178680">&lt;=</span>&nbsp;<span class="builtinfunc" id="5178683">len</span><span class="op" id="5178686">(</span><span class="ident" id="5178687">i</span><span class="op" id="5178688">.</span><span class="ident" id="5178689">str</span><span class="op" id="5178692">)</span>&nbsp;<span class="op" id="5178694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5178698">r1</span><span class="op" id="5178700">,</span>&nbsp;<span class="ident" id="5178702">_</span>&nbsp;<span class="op" id="5178704">=</span>&nbsp;<span class="ident" id="5178706">utf8</span><span class="op" id="5178710">.</span><span class="ident" id="5178711">DecodeLastRuneInString</span><span class="op" id="5178733">(</span><span class="ident" id="5178734">i</span><span class="op" id="5178735">.</span><span class="ident" id="5178736">str</span><span class="op" id="5178739">[</span><span class="op" id="5178740">:</span><span class="ident" id="5178741">pos</span><span class="op" id="5178744">]</span><span class="op" id="5178745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5178748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178751">if</span>&nbsp;<span class="ident" id="5178754">pos</span>&nbsp;<span class="op" id="5178758">&lt;</span>&nbsp;<span class="builtinfunc" id="5178760">len</span><span class="op" id="5178763">(</span><span class="ident" id="5178764">i</span><span class="op" id="5178765">.</span><span class="ident" id="5178766">str</span><span class="op" id="5178769">)</span>&nbsp;<span class="op" id="5178771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5178775">r2</span><span class="op" id="5178777">,</span>&nbsp;<span class="ident" id="5178779">_</span>&nbsp;<span class="op" id="5178781">=</span>&nbsp;<span class="ident" id="5178783">utf8</span><span class="op" id="5178787">.</span><span class="ident" id="5178788">DecodeRuneInString</span><span class="op" id="5178806">(</span><span class="ident" id="5178807">i</span><span class="op" id="5178808">.</span><span class="ident" id="5178809">str</span><span class="op" id="5178812">[</span><span class="ident" id="5178813">pos</span><span class="op" id="5178816">:</span><span class="op" id="5178817">]</span><span class="op" id="5178818">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5178821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178824">return</span>&nbsp;<span class="ident" id="5178831">syntax</span><span class="op" id="5178837">.</span><span class="ident" id="5178838">EmptyOpContext</span><span class="op" id="5178852">(</span><span class="ident" id="5178853">r1</span><span class="op" id="5178855">,</span>&nbsp;<span class="ident" id="5178857">r2</span><span class="op" id="5178859">)</span><br>
<span class="lineno"></span><span class="op" id="5178861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5178864">//&nbsp;inputBytes&nbsp;scans&nbsp;a&nbsp;byte&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="5178898">type</span>&nbsp;<span class="ident" id="5178903">inputBytes</span>&nbsp;<span class="keyword" id="5178914">struct</span>&nbsp;<span class="op" id="5178921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5178924">str</span>&nbsp;<span class="op" id="5178928">[</span><span class="op" id="5178929">]</span><span class="builtintype" id="5178930">byte</span><br>
<span class="lineno"></span><span class="op" id="5178935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5178938">func</span>&nbsp;<span class="op" id="5178943">(</span><span class="ident" id="5178944">i</span>&nbsp;<span class="op" id="5178946">*</span><span class="ident" id="5178947">inputBytes</span><span class="op" id="5178957">)</span>&nbsp;<span class="ident" id="5178959">step</span><span class="op" id="5178963">(</span><span class="ident" id="5178964">pos</span>&nbsp;<span class="builtintype" id="5178968">int</span><span class="op" id="5178971">)</span>&nbsp;<span class="op" id="5178973">(</span><span class="builtintype" id="5178974">rune</span><span class="op" id="5178978">,</span>&nbsp;<span class="builtintype" id="5178980">int</span><span class="op" id="5178983">)</span>&nbsp;<span class="op" id="5178985">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5178988">if</span>&nbsp;<span class="ident" id="5178991">pos</span>&nbsp;<span class="op" id="5178995">&lt;</span>&nbsp;<span class="builtinfunc" id="5178997">len</span><span class="op" id="5179000">(</span><span class="ident" id="5179001">i</span><span class="op" id="5179002">.</span><span class="ident" id="5179003">str</span><span class="op" id="5179006">)</span>&nbsp;<span class="op" id="5179008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179012">c</span>&nbsp;<span class="op" id="5179014">:=</span>&nbsp;<span class="ident" id="5179017">i</span><span class="op" id="5179018">.</span><span class="ident" id="5179019">str</span><span class="op" id="5179022">[</span><span class="ident" id="5179023">pos</span><span class="op" id="5179026">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179030">if</span>&nbsp;<span class="ident" id="5179033">c</span>&nbsp;<span class="op" id="5179035">&lt;</span>&nbsp;<span class="ident" id="5179037">utf8</span><span class="op" id="5179041">.</span><span class="ident" id="5179042">RuneSelf</span>&nbsp;<span class="op" id="5179051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179056">return</span>&nbsp;<span class="builtintype" id="5179063">rune</span><span class="op" id="5179067">(</span><span class="ident" id="5179068">c</span><span class="op" id="5179069">)</span><span class="op" id="5179070">,</span>&nbsp;<span class="num" id="5179072">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5179076">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179080">return</span>&nbsp;<span class="ident" id="5179087">utf8</span><span class="op" id="5179091">.</span><span class="ident" id="5179092">DecodeRune</span><span class="op" id="5179102">(</span><span class="ident" id="5179103">i</span><span class="op" id="5179104">.</span><span class="ident" id="5179105">str</span><span class="op" id="5179108">[</span><span class="ident" id="5179109">pos</span><span class="op" id="5179112">:</span><span class="op" id="5179113">]</span><span class="op" id="5179114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5179117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179120">return</span>&nbsp;<span class="ident" id="5179127">endOfText</span><span class="op" id="5179136">,</span>&nbsp;<span class="num" id="5179138">0</span><br>
<span class="lineno"></span><span class="op" id="5179140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="5179143">func</span>&nbsp;<span class="op" id="5179148">(</span><span class="ident" id="5179149">i</span>&nbsp;<span class="op" id="5179151">*</span><span class="ident" id="5179152">inputBytes</span><span class="op" id="5179162">)</span>&nbsp;<span class="ident" id="5179164">canCheckPrefix</span><span class="op" id="5179178">(</span><span class="op" id="5179179">)</span>&nbsp;<span class="builtintype" id="5179181">bool</span>&nbsp;<span class="op" id="5179186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179189">return</span>&nbsp;<span class="builtintype" id="5179196">true</span><br>
<span class="lineno"></span><span class="op" id="5179201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179204">func</span>&nbsp;<span class="op" id="5179209">(</span><span class="ident" id="5179210">i</span>&nbsp;<span class="op" id="5179212">*</span><span class="ident" id="5179213">inputBytes</span><span class="op" id="5179223">)</span>&nbsp;<span class="ident" id="5179225">hasPrefix</span><span class="op" id="5179234">(</span><span class="ident" id="5179235">re</span>&nbsp;<span class="op" id="5179238">*</span><span class="ident" id="5179239">Regexp</span><span class="op" id="5179245">)</span>&nbsp;<span class="builtintype" id="5179247">bool</span>&nbsp;<span class="op" id="5179252">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179255">return</span>&nbsp;<span class="ident" id="5179262">bytes</span><span class="op" id="5179267">.</span><span class="ident" id="5179268">HasPrefix</span><span class="op" id="5179277">(</span><span class="ident" id="5179278">i</span><span class="op" id="5179279">.</span><span class="ident" id="5179280">str</span><span class="op" id="5179283">,</span>&nbsp;<span class="ident" id="5179285">re</span><span class="op" id="5179287">.</span><span class="ident" id="5179288">prefixBytes</span><span class="op" id="5179299">)</span><br>
<span class="lineno"></span><span class="op" id="5179301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179304">func</span>&nbsp;<span class="op" id="5179309">(</span><span class="ident" id="5179310">i</span>&nbsp;<span class="op" id="5179312">*</span><span class="ident" id="5179313">inputBytes</span><span class="op" id="5179323">)</span>&nbsp;<span class="ident" id="5179325">index</span><span class="op" id="5179330">(</span><span class="ident" id="5179331">re</span>&nbsp;<span class="op" id="5179334">*</span><span class="ident" id="5179335">Regexp</span><span class="op" id="5179341">,</span>&nbsp;<span class="ident" id="5179343">pos</span>&nbsp;<span class="builtintype" id="5179347">int</span><span class="op" id="5179350">)</span>&nbsp;<span class="builtintype" id="5179352">int</span>&nbsp;<span class="op" id="5179356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179359">return</span>&nbsp;<span class="ident" id="5179366">bytes</span><span class="op" id="5179371">.</span><span class="ident" id="5179372">Index</span><span class="op" id="5179377">(</span><span class="ident" id="5179378">i</span><span class="op" id="5179379">.</span><span class="ident" id="5179380">str</span><span class="op" id="5179383">[</span><span class="ident" id="5179384">pos</span><span class="op" id="5179387">:</span><span class="op" id="5179388">]</span><span class="op" id="5179389">,</span>&nbsp;<span class="ident" id="5179391">re</span><span class="op" id="5179393">.</span><span class="ident" id="5179394">prefixBytes</span><span class="op" id="5179405">)</span><br>
<span class="lineno">335</span><span class="op" id="5179407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179410">func</span>&nbsp;<span class="op" id="5179415">(</span><span class="ident" id="5179416">i</span>&nbsp;<span class="op" id="5179418">*</span><span class="ident" id="5179419">inputBytes</span><span class="op" id="5179429">)</span>&nbsp;<span class="ident" id="5179431">context</span><span class="op" id="5179438">(</span><span class="ident" id="5179439">pos</span>&nbsp;<span class="builtintype" id="5179443">int</span><span class="op" id="5179446">)</span>&nbsp;<span class="ident" id="5179448">syntax</span><span class="op" id="5179454">.</span><span class="ident" id="5179455">EmptyOp</span>&nbsp;<span class="op" id="5179463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179466">r1</span><span class="op" id="5179468">,</span>&nbsp;<span class="ident" id="5179470">r2</span>&nbsp;<span class="op" id="5179473">:=</span>&nbsp;<span class="ident" id="5179476">endOfText</span><span class="op" id="5179485">,</span>&nbsp;<span class="ident" id="5179487">endOfText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179498">if</span>&nbsp;<span class="ident" id="5179501">pos</span>&nbsp;<span class="op" id="5179505">&gt;</span>&nbsp;<span class="num" id="5179507">0</span>&nbsp;<span class="op" id="5179509">&amp;&amp;</span>&nbsp;<span class="ident" id="5179512">pos</span>&nbsp;<span class="op" id="5179516">&lt;=</span>&nbsp;<span class="builtinfunc" id="5179519">len</span><span class="op" id="5179522">(</span><span class="ident" id="5179523">i</span><span class="op" id="5179524">.</span><span class="ident" id="5179525">str</span><span class="op" id="5179528">)</span>&nbsp;<span class="op" id="5179530">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179534">r1</span><span class="op" id="5179536">,</span>&nbsp;<span class="ident" id="5179538">_</span>&nbsp;<span class="op" id="5179540">=</span>&nbsp;<span class="ident" id="5179542">utf8</span><span class="op" id="5179546">.</span><span class="ident" id="5179547">DecodeLastRune</span><span class="op" id="5179561">(</span><span class="ident" id="5179562">i</span><span class="op" id="5179563">.</span><span class="ident" id="5179564">str</span><span class="op" id="5179567">[</span><span class="op" id="5179568">:</span><span class="ident" id="5179569">pos</span><span class="op" id="5179572">]</span><span class="op" id="5179573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5179576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179579">if</span>&nbsp;<span class="ident" id="5179582">pos</span>&nbsp;<span class="op" id="5179586">&lt;</span>&nbsp;<span class="builtinfunc" id="5179588">len</span><span class="op" id="5179591">(</span><span class="ident" id="5179592">i</span><span class="op" id="5179593">.</span><span class="ident" id="5179594">str</span><span class="op" id="5179597">)</span>&nbsp;<span class="op" id="5179599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179603">r2</span><span class="op" id="5179605">,</span>&nbsp;<span class="ident" id="5179607">_</span>&nbsp;<span class="op" id="5179609">=</span>&nbsp;<span class="ident" id="5179611">utf8</span><span class="op" id="5179615">.</span><span class="ident" id="5179616">DecodeRune</span><span class="op" id="5179626">(</span><span class="ident" id="5179627">i</span><span class="op" id="5179628">.</span><span class="ident" id="5179629">str</span><span class="op" id="5179632">[</span><span class="ident" id="5179633">pos</span><span class="op" id="5179636">:</span><span class="op" id="5179637">]</span><span class="op" id="5179638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5179641">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179644">return</span>&nbsp;<span class="ident" id="5179651">syntax</span><span class="op" id="5179657">.</span><span class="ident" id="5179658">EmptyOpContext</span><span class="op" id="5179672">(</span><span class="ident" id="5179673">r1</span><span class="op" id="5179675">,</span>&nbsp;<span class="ident" id="5179677">r2</span><span class="op" id="5179679">)</span><br>
<span class="lineno"></span><span class="op" id="5179681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5179684">//&nbsp;inputReader&nbsp;scans&nbsp;a&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5179719">type</span>&nbsp;<span class="ident" id="5179724">inputReader</span>&nbsp;<span class="keyword" id="5179736">struct</span>&nbsp;<span class="op" id="5179743">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179746">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179752">io</span><span class="op" id="5179754">.</span><span class="ident" id="5179755">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179767">atEOT</span>&nbsp;<span class="builtintype" id="5179773">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179779">pos</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5179785">int</span><br>
<span class="lineno"></span><span class="op" id="5179789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5179792">func</span>&nbsp;<span class="op" id="5179797">(</span><span class="ident" id="5179798">i</span>&nbsp;<span class="op" id="5179800">*</span><span class="ident" id="5179801">inputReader</span><span class="op" id="5179812">)</span>&nbsp;<span class="ident" id="5179814">step</span><span class="op" id="5179818">(</span><span class="ident" id="5179819">pos</span>&nbsp;<span class="builtintype" id="5179823">int</span><span class="op" id="5179826">)</span>&nbsp;<span class="op" id="5179828">(</span><span class="builtintype" id="5179829">rune</span><span class="op" id="5179833">,</span>&nbsp;<span class="builtintype" id="5179835">int</span><span class="op" id="5179838">)</span>&nbsp;<span class="op" id="5179840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179843">if</span>&nbsp;<span class="op" id="5179846">!</span><span class="ident" id="5179847">i</span><span class="op" id="5179848">.</span><span class="ident" id="5179849">atEOT</span>&nbsp;<span class="op" id="5179855">&amp;&amp;</span>&nbsp;<span class="ident" id="5179858">pos</span>&nbsp;<span class="op" id="5179862">!=</span>&nbsp;<span class="ident" id="5179865">i</span><span class="op" id="5179866">.</span><span class="ident" id="5179867">pos</span>&nbsp;<span class="op" id="5179871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179875">return</span>&nbsp;<span class="ident" id="5179882">endOfText</span><span class="op" id="5179891">,</span>&nbsp;<span class="num" id="5179893">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5179897">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179900">r</span><span class="op" id="5179901">,</span>&nbsp;<span class="ident" id="5179903">w</span><span class="op" id="5179904">,</span>&nbsp;<span class="ident" id="5179906">err</span>&nbsp;<span class="op" id="5179910">:=</span>&nbsp;<span class="ident" id="5179913">i</span><span class="op" id="5179914">.</span><span class="ident" id="5179915">r</span><span class="op" id="5179916">.</span><span class="ident" id="5179917">ReadRune</span><span class="op" id="5179925">(</span><span class="op" id="5179926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179929">if</span>&nbsp;<span class="ident" id="5179932">err</span>&nbsp;<span class="op" id="5179936">!=</span>&nbsp;<span class="builtintype" id="5179939">nil</span>&nbsp;<span class="op" id="5179943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179947">i</span><span class="op" id="5179948">.</span><span class="ident" id="5179949">atEOT</span>&nbsp;<span class="op" id="5179955">=</span>&nbsp;<span class="builtintype" id="5179957">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5179964">return</span>&nbsp;<span class="ident" id="5179971">endOfText</span><span class="op" id="5179980">,</span>&nbsp;<span class="num" id="5179982">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5179985">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5179988">i</span><span class="op" id="5179989">.</span><span class="ident" id="5179990">pos</span>&nbsp;<span class="op" id="5179994">+=</span>&nbsp;<span class="ident" id="5179997">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180000">return</span>&nbsp;<span class="ident" id="5180007">r</span><span class="op" id="5180008">,</span>&nbsp;<span class="ident" id="5180010">w</span><br>
<span class="lineno"></span><span class="op" id="5180012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5180015">func</span>&nbsp;<span class="op" id="5180020">(</span><span class="ident" id="5180021">i</span>&nbsp;<span class="op" id="5180023">*</span><span class="ident" id="5180024">inputReader</span><span class="op" id="5180035">)</span>&nbsp;<span class="ident" id="5180037">canCheckPrefix</span><span class="op" id="5180051">(</span><span class="op" id="5180052">)</span>&nbsp;<span class="builtintype" id="5180054">bool</span>&nbsp;<span class="op" id="5180059">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180062">return</span>&nbsp;<span class="builtintype" id="5180069">false</span><br>
<span class="lineno"></span><span class="op" id="5180075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5180078">func</span>&nbsp;<span class="op" id="5180083">(</span><span class="ident" id="5180084">i</span>&nbsp;<span class="op" id="5180086">*</span><span class="ident" id="5180087">inputReader</span><span class="op" id="5180098">)</span>&nbsp;<span class="ident" id="5180100">hasPrefix</span><span class="op" id="5180109">(</span><span class="ident" id="5180110">re</span>&nbsp;<span class="op" id="5180113">*</span><span class="ident" id="5180114">Regexp</span><span class="op" id="5180120">)</span>&nbsp;<span class="builtintype" id="5180122">bool</span>&nbsp;<span class="op" id="5180127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180130">return</span>&nbsp;<span class="builtintype" id="5180137">false</span><br>
<span class="lineno">375</span><span class="op" id="5180143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5180146">func</span>&nbsp;<span class="op" id="5180151">(</span><span class="ident" id="5180152">i</span>&nbsp;<span class="op" id="5180154">*</span><span class="ident" id="5180155">inputReader</span><span class="op" id="5180166">)</span>&nbsp;<span class="ident" id="5180168">index</span><span class="op" id="5180173">(</span><span class="ident" id="5180174">re</span>&nbsp;<span class="op" id="5180177">*</span><span class="ident" id="5180178">Regexp</span><span class="op" id="5180184">,</span>&nbsp;<span class="ident" id="5180186">pos</span>&nbsp;<span class="builtintype" id="5180190">int</span><span class="op" id="5180193">)</span>&nbsp;<span class="builtintype" id="5180195">int</span>&nbsp;<span class="op" id="5180199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180202">return</span>&nbsp;<span class="op" id="5180209">-</span><span class="num" id="5180210">1</span><br>
<span class="lineno"></span><span class="op" id="5180212">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5180215">func</span>&nbsp;<span class="op" id="5180220">(</span><span class="ident" id="5180221">i</span>&nbsp;<span class="op" id="5180223">*</span><span class="ident" id="5180224">inputReader</span><span class="op" id="5180235">)</span>&nbsp;<span class="ident" id="5180237">context</span><span class="op" id="5180244">(</span><span class="ident" id="5180245">pos</span>&nbsp;<span class="builtintype" id="5180249">int</span><span class="op" id="5180252">)</span>&nbsp;<span class="ident" id="5180254">syntax</span><span class="op" id="5180260">.</span><span class="ident" id="5180261">EmptyOp</span>&nbsp;<span class="op" id="5180269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180272">return</span>&nbsp;<span class="num" id="5180279">0</span><br>
<span class="lineno"></span><span class="op" id="5180281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5180284">//&nbsp;LiteralPrefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;must&nbsp;begin&nbsp;any&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="5180352">//&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;re.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;boolean&nbsp;true&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5180421">//&nbsp;literal&nbsp;string&nbsp;comprises&nbsp;the&nbsp;entire&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="5180480">func</span>&nbsp;<span class="op" id="5180485">(</span><span class="ident" id="5180486">re</span>&nbsp;<span class="op" id="5180489">*</span><span class="ident" id="5180490">Regexp</span><span class="op" id="5180496">)</span>&nbsp;<span class="ident" id="5180498">LiteralPrefix</span><span class="op" id="5180511">(</span><span class="op" id="5180512">)</span>&nbsp;<span class="op" id="5180514">(</span><span class="ident" id="5180515">prefix</span>&nbsp;<span class="builtintype" id="5180522">string</span><span class="op" id="5180528">,</span>&nbsp;<span class="ident" id="5180530">complete</span>&nbsp;<span class="builtintype" id="5180539">bool</span><span class="op" id="5180543">)</span>&nbsp;<span class="op" id="5180545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180548">return</span>&nbsp;<span class="ident" id="5180555">re</span><span class="op" id="5180557">.</span><span class="ident" id="5180558">prefix</span><span class="op" id="5180564">,</span>&nbsp;<span class="ident" id="5180566">re</span><span class="op" id="5180568">.</span><span class="ident" id="5180569">prefixComplete</span><br>
<span class="lineno">390</span><span class="op" id="5180584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5180587">//&nbsp;MatchReader&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;text&nbsp;read&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5180658">//&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5180673">func</span>&nbsp;<span class="op" id="5180678">(</span><span class="ident" id="5180679">re</span>&nbsp;<span class="op" id="5180682">*</span><span class="ident" id="5180683">Regexp</span><span class="op" id="5180689">)</span>&nbsp;<span class="ident" id="5180691">MatchReader</span><span class="op" id="5180702">(</span><span class="ident" id="5180703">r</span>&nbsp;<span class="ident" id="5180705">io</span><span class="op" id="5180707">.</span><span class="ident" id="5180708">RuneReader</span><span class="op" id="5180718">)</span>&nbsp;<span class="builtintype" id="5180720">bool</span>&nbsp;<span class="op" id="5180725">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180728">return</span>&nbsp;<span class="ident" id="5180735">re</span><span class="op" id="5180737">.</span><span class="ident" id="5180738">doExecute</span><span class="op" id="5180747">(</span><span class="ident" id="5180748">r</span><span class="op" id="5180749">,</span>&nbsp;<span class="builtintype" id="5180751">nil</span><span class="op" id="5180754">,</span>&nbsp;<span class="string" id="5180756">&#34;&#34;</span><span class="op" id="5180758">,</span>&nbsp;<span class="num" id="5180760">0</span><span class="op" id="5180761">,</span>&nbsp;<span class="num" id="5180763">0</span><span class="op" id="5180764">)</span>&nbsp;<span class="op" id="5180766">!=</span>&nbsp;<span class="builtintype" id="5180769">nil</span><br>
<span class="lineno"></span><span class="op" id="5180773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5180776">//&nbsp;MatchString&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5180840">func</span>&nbsp;<span class="op" id="5180845">(</span><span class="ident" id="5180846">re</span>&nbsp;<span class="op" id="5180849">*</span><span class="ident" id="5180850">Regexp</span><span class="op" id="5180856">)</span>&nbsp;<span class="ident" id="5180858">MatchString</span><span class="op" id="5180869">(</span><span class="ident" id="5180870">s</span>&nbsp;<span class="builtintype" id="5180872">string</span><span class="op" id="5180878">)</span>&nbsp;<span class="builtintype" id="5180880">bool</span>&nbsp;<span class="op" id="5180885">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5180888">return</span>&nbsp;<span class="ident" id="5180895">re</span><span class="op" id="5180897">.</span><span class="ident" id="5180898">doExecute</span><span class="op" id="5180907">(</span><span class="builtintype" id="5180908">nil</span><span class="op" id="5180911">,</span>&nbsp;<span class="builtintype" id="5180913">nil</span><span class="op" id="5180916">,</span>&nbsp;<span class="ident" id="5180918">s</span><span class="op" id="5180919">,</span>&nbsp;<span class="num" id="5180921">0</span><span class="op" id="5180922">,</span>&nbsp;<span class="num" id="5180924">0</span><span class="op" id="5180925">)</span>&nbsp;<span class="op" id="5180927">!=</span>&nbsp;<span class="builtintype" id="5180930">nil</span><br>
<span class="lineno"></span><span class="op" id="5180934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5180937">//&nbsp;Match&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;byte&nbsp;slice&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5180999">func</span>&nbsp;<span class="op" id="5181004">(</span><span class="ident" id="5181005">re</span>&nbsp;<span class="op" id="5181008">*</span><span class="ident" id="5181009">Regexp</span><span class="op" id="5181015">)</span>&nbsp;<span class="ident" id="5181017">Match</span><span class="op" id="5181022">(</span><span class="ident" id="5181023">b</span>&nbsp;<span class="op" id="5181025">[</span><span class="op" id="5181026">]</span><span class="builtintype" id="5181027">byte</span><span class="op" id="5181031">)</span>&nbsp;<span class="builtintype" id="5181033">bool</span>&nbsp;<span class="op" id="5181038">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181041">return</span>&nbsp;<span class="ident" id="5181048">re</span><span class="op" id="5181050">.</span><span class="ident" id="5181051">doExecute</span><span class="op" id="5181060">(</span><span class="builtintype" id="5181061">nil</span><span class="op" id="5181064">,</span>&nbsp;<span class="ident" id="5181066">b</span><span class="op" id="5181067">,</span>&nbsp;<span class="string" id="5181069">&#34;&#34;</span><span class="op" id="5181071">,</span>&nbsp;<span class="num" id="5181073">0</span><span class="op" id="5181074">,</span>&nbsp;<span class="num" id="5181076">0</span><span class="op" id="5181077">)</span>&nbsp;<span class="op" id="5181079">!=</span>&nbsp;<span class="builtintype" id="5181082">nil</span><br>
<span class="lineno"></span><span class="op" id="5181086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5181089">//&nbsp;MatchReader&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;the&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5181165">//&nbsp;read&nbsp;by&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and</span><br>
<span class="lineno">410</span><span class="comment" id="5181242">//&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5181272">func</span>&nbsp;<span class="ident" id="5181277">MatchReader</span><span class="op" id="5181288">(</span><span class="ident" id="5181289">pattern</span>&nbsp;<span class="builtintype" id="5181297">string</span><span class="op" id="5181303">,</span>&nbsp;<span class="ident" id="5181305">r</span>&nbsp;<span class="ident" id="5181307">io</span><span class="op" id="5181309">.</span><span class="ident" id="5181310">RuneReader</span><span class="op" id="5181320">)</span>&nbsp;<span class="op" id="5181322">(</span><span class="ident" id="5181323">matched</span>&nbsp;<span class="builtintype" id="5181331">bool</span><span class="op" id="5181335">,</span>&nbsp;<span class="ident" id="5181337">err</span>&nbsp;<span class="builtintype" id="5181341">error</span><span class="op" id="5181346">)</span>&nbsp;<span class="op" id="5181348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5181351">re</span><span class="op" id="5181353">,</span>&nbsp;<span class="ident" id="5181355">err</span>&nbsp;<span class="op" id="5181359">:=</span>&nbsp;<span class="ident" id="5181362">Compile</span><span class="op" id="5181369">(</span><span class="ident" id="5181370">pattern</span><span class="op" id="5181377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181380">if</span>&nbsp;<span class="ident" id="5181383">err</span>&nbsp;<span class="op" id="5181387">!=</span>&nbsp;<span class="builtintype" id="5181390">nil</span>&nbsp;<span class="op" id="5181394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181398">return</span>&nbsp;<span class="builtintype" id="5181405">false</span><span class="op" id="5181410">,</span>&nbsp;<span class="ident" id="5181412">err</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5181417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181420">return</span>&nbsp;<span class="ident" id="5181427">re</span><span class="op" id="5181429">.</span><span class="ident" id="5181430">MatchReader</span><span class="op" id="5181441">(</span><span class="ident" id="5181442">r</span><span class="op" id="5181443">)</span><span class="op" id="5181444">,</span>&nbsp;<span class="builtintype" id="5181446">nil</span><br>
<span class="lineno"></span><span class="op" id="5181450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5181453">//&nbsp;MatchString&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno">420</span><span class="comment" id="5181512">//&nbsp;matches&nbsp;a&nbsp;string.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="5181564">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5181613">func</span>&nbsp;<span class="ident" id="5181618">MatchString</span><span class="op" id="5181629">(</span><span class="ident" id="5181630">pattern</span>&nbsp;<span class="builtintype" id="5181638">string</span><span class="op" id="5181644">,</span>&nbsp;<span class="ident" id="5181646">s</span>&nbsp;<span class="builtintype" id="5181648">string</span><span class="op" id="5181654">)</span>&nbsp;<span class="op" id="5181656">(</span><span class="ident" id="5181657">matched</span>&nbsp;<span class="builtintype" id="5181665">bool</span><span class="op" id="5181669">,</span>&nbsp;<span class="ident" id="5181671">err</span>&nbsp;<span class="builtintype" id="5181675">error</span><span class="op" id="5181680">)</span>&nbsp;<span class="op" id="5181682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5181685">re</span><span class="op" id="5181687">,</span>&nbsp;<span class="ident" id="5181689">err</span>&nbsp;<span class="op" id="5181693">:=</span>&nbsp;<span class="ident" id="5181696">Compile</span><span class="op" id="5181703">(</span><span class="ident" id="5181704">pattern</span><span class="op" id="5181711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181714">if</span>&nbsp;<span class="ident" id="5181717">err</span>&nbsp;<span class="op" id="5181721">!=</span>&nbsp;<span class="builtintype" id="5181724">nil</span>&nbsp;<span class="op" id="5181728">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181732">return</span>&nbsp;<span class="builtintype" id="5181739">false</span><span class="op" id="5181744">,</span>&nbsp;<span class="ident" id="5181746">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5181751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5181754">return</span>&nbsp;<span class="ident" id="5181761">re</span><span class="op" id="5181763">.</span><span class="ident" id="5181764">MatchString</span><span class="op" id="5181775">(</span><span class="ident" id="5181776">s</span><span class="op" id="5181777">)</span><span class="op" id="5181778">,</span>&nbsp;<span class="builtintype" id="5181780">nil</span><br>
<span class="lineno"></span><span class="op" id="5181784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="5181787">//&nbsp;Match&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5181840">//&nbsp;matches&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="5181896">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="5181945">func</span>&nbsp;<span class="ident" id="5181950">Match</span><span class="op" id="5181955">(</span><span class="ident" id="5181956">pattern</span>&nbsp;<span class="builtintype" id="5181964">string</span><span class="op" id="5181970">,</span>&nbsp;<span class="ident" id="5181972">b</span>&nbsp;<span class="op" id="5181974">[</span><span class="op" id="5181975">]</span><span class="builtintype" id="5181976">byte</span><span class="op" id="5181980">)</span>&nbsp;<span class="op" id="5181982">(</span><span class="ident" id="5181983">matched</span>&nbsp;<span class="builtintype" id="5181991">bool</span><span class="op" id="5181995">,</span>&nbsp;<span class="ident" id="5181997">err</span>&nbsp;<span class="builtintype" id="5182001">error</span><span class="op" id="5182006">)</span>&nbsp;<span class="op" id="5182008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5182011">re</span><span class="op" id="5182013">,</span>&nbsp;<span class="ident" id="5182015">err</span>&nbsp;<span class="op" id="5182019">:=</span>&nbsp;<span class="ident" id="5182022">Compile</span><span class="op" id="5182029">(</span><span class="ident" id="5182030">pattern</span><span class="op" id="5182037">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182040">if</span>&nbsp;<span class="ident" id="5182043">err</span>&nbsp;<span class="op" id="5182047">!=</span>&nbsp;<span class="builtintype" id="5182050">nil</span>&nbsp;<span class="op" id="5182054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182058">return</span>&nbsp;<span class="builtintype" id="5182065">false</span><span class="op" id="5182070">,</span>&nbsp;<span class="ident" id="5182072">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5182077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182080">return</span>&nbsp;<span class="ident" id="5182087">re</span><span class="op" id="5182089">.</span><span class="ident" id="5182090">Match</span><span class="op" id="5182095">(</span><span class="ident" id="5182096">b</span><span class="op" id="5182097">)</span><span class="op" id="5182098">,</span>&nbsp;<span class="builtintype" id="5182100">nil</span><br>
<span class="lineno"></span><span class="op" id="5182104">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5182107">//&nbsp;ReplaceAllString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5182182">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5182260">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="5182336">func</span>&nbsp;<span class="op" id="5182341">(</span><span class="ident" id="5182342">re</span>&nbsp;<span class="op" id="5182345">*</span><span class="ident" id="5182346">Regexp</span><span class="op" id="5182352">)</span>&nbsp;<span class="ident" id="5182354">ReplaceAllString</span><span class="op" id="5182370">(</span><span class="ident" id="5182371">src</span><span class="op" id="5182374">,</span>&nbsp;<span class="ident" id="5182376">repl</span>&nbsp;<span class="builtintype" id="5182381">string</span><span class="op" id="5182387">)</span>&nbsp;<span class="builtintype" id="5182389">string</span>&nbsp;<span class="op" id="5182396">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5182399">n</span>&nbsp;<span class="op" id="5182401">:=</span>&nbsp;<span class="num" id="5182404">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182407">if</span>&nbsp;<span class="ident" id="5182410">strings</span><span class="op" id="5182417">.</span><span class="ident" id="5182418">Index</span><span class="op" id="5182423">(</span><span class="ident" id="5182424">repl</span><span class="op" id="5182428">,</span>&nbsp;<span class="string" id="5182430">&#34;$&#34;</span><span class="op" id="5182433">)</span>&nbsp;<span class="op" id="5182435">&gt;=</span>&nbsp;<span class="num" id="5182438">0</span>&nbsp;<span class="op" id="5182440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5182444">n</span>&nbsp;<span class="op" id="5182446">=</span>&nbsp;<span class="num" id="5182448">2</span>&nbsp;<span class="op" id="5182450">*</span>&nbsp;<span class="op" id="5182452">(</span><span class="ident" id="5182453">re</span><span class="op" id="5182455">.</span><span class="ident" id="5182456">numSubexp</span>&nbsp;<span class="op" id="5182466">+</span>&nbsp;<span class="num" id="5182468">1</span><span class="op" id="5182469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5182472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5182475">b</span>&nbsp;<span class="op" id="5182477">:=</span>&nbsp;<span class="ident" id="5182480">re</span><span class="op" id="5182482">.</span><span class="ident" id="5182483">replaceAll</span><span class="op" id="5182493">(</span><span class="builtintype" id="5182494">nil</span><span class="op" id="5182497">,</span>&nbsp;<span class="ident" id="5182499">src</span><span class="op" id="5182502">,</span>&nbsp;<span class="ident" id="5182504">n</span><span class="op" id="5182505">,</span>&nbsp;<span class="keyword" id="5182507">func</span><span class="op" id="5182511">(</span><span class="ident" id="5182512">dst</span>&nbsp;<span class="op" id="5182516">[</span><span class="op" id="5182517">]</span><span class="builtintype" id="5182518">byte</span><span class="op" id="5182522">,</span>&nbsp;<span class="ident" id="5182524">match</span>&nbsp;<span class="op" id="5182530">[</span><span class="op" id="5182531">]</span><span class="builtintype" id="5182532">int</span><span class="op" id="5182535">)</span>&nbsp;<span class="op" id="5182537">[</span><span class="op" id="5182538">]</span><span class="builtintype" id="5182539">byte</span>&nbsp;<span class="op" id="5182544">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182548">return</span>&nbsp;<span class="ident" id="5182555">re</span><span class="op" id="5182557">.</span><span class="ident" id="5182558">expand</span><span class="op" id="5182564">(</span><span class="ident" id="5182565">dst</span><span class="op" id="5182568">,</span>&nbsp;<span class="ident" id="5182570">repl</span><span class="op" id="5182574">,</span>&nbsp;<span class="builtintype" id="5182576">nil</span><span class="op" id="5182579">,</span>&nbsp;<span class="ident" id="5182581">src</span><span class="op" id="5182584">,</span>&nbsp;<span class="ident" id="5182586">match</span><span class="op" id="5182591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5182594">}</span><span class="op" id="5182595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182598">return</span>&nbsp;<span class="builtintype" id="5182605">string</span><span class="op" id="5182611">(</span><span class="ident" id="5182612">b</span><span class="op" id="5182613">)</span><br>
<span class="lineno"></span><span class="op" id="5182615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="5182618">//&nbsp;ReplaceAllLiteralString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5182700">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno"></span><span class="comment" id="5182784">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5182809">func</span>&nbsp;<span class="op" id="5182814">(</span><span class="ident" id="5182815">re</span>&nbsp;<span class="op" id="5182818">*</span><span class="ident" id="5182819">Regexp</span><span class="op" id="5182825">)</span>&nbsp;<span class="ident" id="5182827">ReplaceAllLiteralString</span><span class="op" id="5182850">(</span><span class="ident" id="5182851">src</span><span class="op" id="5182854">,</span>&nbsp;<span class="ident" id="5182856">repl</span>&nbsp;<span class="builtintype" id="5182861">string</span><span class="op" id="5182867">)</span>&nbsp;<span class="builtintype" id="5182869">string</span>&nbsp;<span class="op" id="5182876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182879">return</span>&nbsp;<span class="builtintype" id="5182886">string</span><span class="op" id="5182892">(</span><span class="ident" id="5182893">re</span><span class="op" id="5182895">.</span><span class="ident" id="5182896">replaceAll</span><span class="op" id="5182906">(</span><span class="builtintype" id="5182907">nil</span><span class="op" id="5182910">,</span>&nbsp;<span class="ident" id="5182912">src</span><span class="op" id="5182915">,</span>&nbsp;<span class="num" id="5182917">2</span><span class="op" id="5182918">,</span>&nbsp;<span class="keyword" id="5182920">func</span><span class="op" id="5182924">(</span><span class="ident" id="5182925">dst</span>&nbsp;<span class="op" id="5182929">[</span><span class="op" id="5182930">]</span><span class="builtintype" id="5182931">byte</span><span class="op" id="5182935">,</span>&nbsp;<span class="ident" id="5182937">match</span>&nbsp;<span class="op" id="5182943">[</span><span class="op" id="5182944">]</span><span class="builtintype" id="5182945">int</span><span class="op" id="5182948">)</span>&nbsp;<span class="op" id="5182950">[</span><span class="op" id="5182951">]</span><span class="builtintype" id="5182952">byte</span>&nbsp;<span class="op" id="5182957">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5182961">return</span>&nbsp;<span class="builtinfunc" id="5182968">append</span><span class="op" id="5182974">(</span><span class="ident" id="5182975">dst</span><span class="op" id="5182978">,</span>&nbsp;<span class="ident" id="5182980">repl</span><span class="op" id="5182984">...</span><span class="op" id="5182987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5182990">}</span><span class="op" id="5182991">)</span><span class="op" id="5182992">)</span><br>
<span class="lineno"></span><span class="op" id="5182994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5182997">//&nbsp;ReplaceAllStringFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="5183071">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="5183145">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;substring.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno"></span><span class="comment" id="5183223">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5183258">func</span>&nbsp;<span class="op" id="5183263">(</span><span class="ident" id="5183264">re</span>&nbsp;<span class="op" id="5183267">*</span><span class="ident" id="5183268">Regexp</span><span class="op" id="5183274">)</span>&nbsp;<span class="ident" id="5183276">ReplaceAllStringFunc</span><span class="op" id="5183296">(</span><span class="ident" id="5183297">src</span>&nbsp;<span class="builtintype" id="5183301">string</span><span class="op" id="5183307">,</span>&nbsp;<span class="ident" id="5183309">repl</span>&nbsp;<span class="keyword" id="5183314">func</span><span class="op" id="5183318">(</span><span class="builtintype" id="5183319">string</span><span class="op" id="5183325">)</span>&nbsp;<span class="builtintype" id="5183327">string</span><span class="op" id="5183333">)</span>&nbsp;<span class="builtintype" id="5183335">string</span>&nbsp;<span class="op" id="5183342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5183345">b</span>&nbsp;<span class="op" id="5183347">:=</span>&nbsp;<span class="ident" id="5183350">re</span><span class="op" id="5183352">.</span><span class="ident" id="5183353">replaceAll</span><span class="op" id="5183363">(</span><span class="builtintype" id="5183364">nil</span><span class="op" id="5183367">,</span>&nbsp;<span class="ident" id="5183369">src</span><span class="op" id="5183372">,</span>&nbsp;<span class="num" id="5183374">2</span><span class="op" id="5183375">,</span>&nbsp;<span class="keyword" id="5183377">func</span><span class="op" id="5183381">(</span><span class="ident" id="5183382">dst</span>&nbsp;<span class="op" id="5183386">[</span><span class="op" id="5183387">]</span><span class="builtintype" id="5183388">byte</span><span class="op" id="5183392">,</span>&nbsp;<span class="ident" id="5183394">match</span>&nbsp;<span class="op" id="5183400">[</span><span class="op" id="5183401">]</span><span class="builtintype" id="5183402">int</span><span class="op" id="5183405">)</span>&nbsp;<span class="op" id="5183407">[</span><span class="op" id="5183408">]</span><span class="builtintype" id="5183409">byte</span>&nbsp;<span class="op" id="5183414">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183418">return</span>&nbsp;<span class="builtinfunc" id="5183425">append</span><span class="op" id="5183431">(</span><span class="ident" id="5183432">dst</span><span class="op" id="5183435">,</span>&nbsp;<span class="ident" id="5183437">repl</span><span class="op" id="5183441">(</span><span class="ident" id="5183442">src</span><span class="op" id="5183445">[</span><span class="ident" id="5183446">match</span><span class="op" id="5183451">[</span><span class="num" id="5183452">0</span><span class="op" id="5183453">]</span><span class="op" id="5183454">:</span><span class="ident" id="5183455">match</span><span class="op" id="5183460">[</span><span class="num" id="5183461">1</span><span class="op" id="5183462">]</span><span class="op" id="5183463">]</span><span class="op" id="5183464">)</span><span class="op" id="5183465">...</span><span class="op" id="5183468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5183471">}</span><span class="op" id="5183472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183475">return</span>&nbsp;<span class="builtintype" id="5183482">string</span><span class="op" id="5183488">(</span><span class="ident" id="5183489">b</span><span class="op" id="5183490">)</span><br>
<span class="lineno"></span><span class="op" id="5183492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="5183495">func</span>&nbsp;<span class="op" id="5183500">(</span><span class="ident" id="5183501">re</span>&nbsp;<span class="op" id="5183504">*</span><span class="ident" id="5183505">Regexp</span><span class="op" id="5183511">)</span>&nbsp;<span class="ident" id="5183513">replaceAll</span><span class="op" id="5183523">(</span><span class="ident" id="5183524">bsrc</span>&nbsp;<span class="op" id="5183529">[</span><span class="op" id="5183530">]</span><span class="builtintype" id="5183531">byte</span><span class="op" id="5183535">,</span>&nbsp;<span class="ident" id="5183537">src</span>&nbsp;<span class="builtintype" id="5183541">string</span><span class="op" id="5183547">,</span>&nbsp;<span class="ident" id="5183549">nmatch</span>&nbsp;<span class="builtintype" id="5183556">int</span><span class="op" id="5183559">,</span>&nbsp;<span class="ident" id="5183561">repl</span>&nbsp;<span class="keyword" id="5183566">func</span><span class="op" id="5183570">(</span><span class="ident" id="5183571">dst</span>&nbsp;<span class="op" id="5183575">[</span><span class="op" id="5183576">]</span><span class="builtintype" id="5183577">byte</span><span class="op" id="5183581">,</span>&nbsp;<span class="ident" id="5183583">m</span>&nbsp;<span class="op" id="5183585">[</span><span class="op" id="5183586">]</span><span class="builtintype" id="5183587">int</span><span class="op" id="5183590">)</span>&nbsp;<span class="op" id="5183592">[</span><span class="op" id="5183593">]</span><span class="builtintype" id="5183594">byte</span><span class="op" id="5183598">)</span>&nbsp;<span class="op" id="5183600">[</span><span class="op" id="5183601">]</span><span class="builtintype" id="5183602">byte</span>&nbsp;<span class="op" id="5183607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5183610">lastMatchEnd</span>&nbsp;<span class="op" id="5183623">:=</span>&nbsp;<span class="num" id="5183626">0</span>&nbsp;<span class="comment" id="5183628">//&nbsp;end&nbsp;position&nbsp;of&nbsp;the&nbsp;most&nbsp;recent&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5183670">searchPos</span>&nbsp;<span class="op" id="5183680">:=</span>&nbsp;<span class="num" id="5183683">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5183688">//&nbsp;position&nbsp;where&nbsp;we&nbsp;next&nbsp;look&nbsp;for&nbsp;a&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183732">var</span>&nbsp;<span class="ident" id="5183736">buf</span>&nbsp;<span class="op" id="5183740">[</span><span class="op" id="5183741">]</span><span class="builtintype" id="5183742">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183748">var</span>&nbsp;<span class="ident" id="5183752">endPos</span>&nbsp;<span class="builtintype" id="5183759">int</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183764">if</span>&nbsp;<span class="ident" id="5183767">bsrc</span>&nbsp;<span class="op" id="5183772">!=</span>&nbsp;<span class="builtintype" id="5183775">nil</span>&nbsp;<span class="op" id="5183779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5183783">endPos</span>&nbsp;<span class="op" id="5183790">=</span>&nbsp;<span class="builtinfunc" id="5183792">len</span><span class="op" id="5183795">(</span><span class="ident" id="5183796">bsrc</span><span class="op" id="5183800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5183803">}</span>&nbsp;<span class="keyword" id="5183805">else</span>&nbsp;<span class="op" id="5183810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5183814">endPos</span>&nbsp;<span class="op" id="5183821">=</span>&nbsp;<span class="builtinfunc" id="5183823">len</span><span class="op" id="5183826">(</span><span class="ident" id="5183827">src</span><span class="op" id="5183830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5183833">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183836">for</span>&nbsp;<span class="ident" id="5183840">searchPos</span>&nbsp;<span class="op" id="5183850">&lt;=</span>&nbsp;<span class="ident" id="5183853">endPos</span>&nbsp;<span class="op" id="5183860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5183864">a</span>&nbsp;<span class="op" id="5183866">:=</span>&nbsp;<span class="ident" id="5183869">re</span><span class="op" id="5183871">.</span><span class="ident" id="5183872">doExecute</span><span class="op" id="5183881">(</span><span class="builtintype" id="5183882">nil</span><span class="op" id="5183885">,</span>&nbsp;<span class="ident" id="5183887">bsrc</span><span class="op" id="5183891">,</span>&nbsp;<span class="ident" id="5183893">src</span><span class="op" id="5183896">,</span>&nbsp;<span class="ident" id="5183898">searchPos</span><span class="op" id="5183907">,</span>&nbsp;<span class="ident" id="5183909">nmatch</span><span class="op" id="5183915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183919">if</span>&nbsp;<span class="builtinfunc" id="5183922">len</span><span class="op" id="5183925">(</span><span class="ident" id="5183926">a</span><span class="op" id="5183927">)</span>&nbsp;<span class="op" id="5183929">==</span>&nbsp;<span class="num" id="5183932">0</span>&nbsp;<span class="op" id="5183934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5183939">break</span>&nbsp;<span class="comment" id="5183945">//&nbsp;no&nbsp;more&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5183966">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5183971">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;before&nbsp;this&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5184025">if</span>&nbsp;<span class="ident" id="5184028">bsrc</span>&nbsp;<span class="op" id="5184033">!=</span>&nbsp;<span class="builtintype" id="5184036">nil</span>&nbsp;<span class="op" id="5184040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184045">buf</span>&nbsp;<span class="op" id="5184049">=</span>&nbsp;<span class="builtinfunc" id="5184051">append</span><span class="op" id="5184057">(</span><span class="ident" id="5184058">buf</span><span class="op" id="5184061">,</span>&nbsp;<span class="ident" id="5184063">bsrc</span><span class="op" id="5184067">[</span><span class="ident" id="5184068">lastMatchEnd</span><span class="op" id="5184080">:</span><span class="ident" id="5184081">a</span><span class="op" id="5184082">[</span><span class="num" id="5184083">0</span><span class="op" id="5184084">]</span><span class="op" id="5184085">]</span><span class="op" id="5184086">...</span><span class="op" id="5184089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184093">}</span>&nbsp;<span class="keyword" id="5184095">else</span>&nbsp;<span class="op" id="5184100">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184105">buf</span>&nbsp;<span class="op" id="5184109">=</span>&nbsp;<span class="builtinfunc" id="5184111">append</span><span class="op" id="5184117">(</span><span class="ident" id="5184118">buf</span><span class="op" id="5184121">,</span>&nbsp;<span class="ident" id="5184123">src</span><span class="op" id="5184126">[</span><span class="ident" id="5184127">lastMatchEnd</span><span class="op" id="5184139">:</span><span class="ident" id="5184140">a</span><span class="op" id="5184141">[</span><span class="num" id="5184142">0</span><span class="op" id="5184143">]</span><span class="op" id="5184144">]</span><span class="op" id="5184145">...</span><span class="op" id="5184148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184157">//&nbsp;Now&nbsp;insert&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;replacement&nbsp;string,&nbsp;but&nbsp;not&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184221">//&nbsp;match&nbsp;of&nbsp;the&nbsp;empty&nbsp;string&nbsp;immediately&nbsp;after&nbsp;another&nbsp;match.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184285">//&nbsp;(Otherwise,&nbsp;we&nbsp;get&nbsp;double&nbsp;replacement&nbsp;for&nbsp;patterns&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184346">//&nbsp;match&nbsp;both&nbsp;empty&nbsp;and&nbsp;nonempty&nbsp;strings.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5184391">if</span>&nbsp;<span class="ident" id="5184394">a</span><span class="op" id="5184395">[</span><span class="num" id="5184396">1</span><span class="op" id="5184397">]</span>&nbsp;<span class="op" id="5184399">&gt;</span>&nbsp;<span class="ident" id="5184401">lastMatchEnd</span>&nbsp;<span class="op" id="5184414">||</span>&nbsp;<span class="ident" id="5184417">a</span><span class="op" id="5184418">[</span><span class="num" id="5184419">0</span><span class="op" id="5184420">]</span>&nbsp;<span class="op" id="5184422">==</span>&nbsp;<span class="num" id="5184425">0</span>&nbsp;<span class="op" id="5184427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184432">buf</span>&nbsp;<span class="op" id="5184436">=</span>&nbsp;<span class="ident" id="5184438">repl</span><span class="op" id="5184442">(</span><span class="ident" id="5184443">buf</span><span class="op" id="5184446">,</span>&nbsp;<span class="ident" id="5184448">a</span><span class="op" id="5184449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184453">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184457">lastMatchEnd</span>&nbsp;<span class="op" id="5184470">=</span>&nbsp;<span class="ident" id="5184472">a</span><span class="op" id="5184473">[</span><span class="num" id="5184474">1</span><span class="op" id="5184475">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184480">//&nbsp;Advance&nbsp;past&nbsp;this&nbsp;match;&nbsp;always&nbsp;advance&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5184549">var</span>&nbsp;<span class="ident" id="5184553">width</span>&nbsp;<span class="builtintype" id="5184559">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5184565">if</span>&nbsp;<span class="ident" id="5184568">bsrc</span>&nbsp;<span class="op" id="5184573">!=</span>&nbsp;<span class="builtintype" id="5184576">nil</span>&nbsp;<span class="op" id="5184580">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184585">_</span><span class="op" id="5184586">,</span>&nbsp;<span class="ident" id="5184588">width</span>&nbsp;<span class="op" id="5184594">=</span>&nbsp;<span class="ident" id="5184596">utf8</span><span class="op" id="5184600">.</span><span class="ident" id="5184601">DecodeRune</span><span class="op" id="5184611">(</span><span class="ident" id="5184612">bsrc</span><span class="op" id="5184616">[</span><span class="ident" id="5184617">searchPos</span><span class="op" id="5184626">:</span><span class="op" id="5184627">]</span><span class="op" id="5184628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184632">}</span>&nbsp;<span class="keyword" id="5184634">else</span>&nbsp;<span class="op" id="5184639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184644">_</span><span class="op" id="5184645">,</span>&nbsp;<span class="ident" id="5184647">width</span>&nbsp;<span class="op" id="5184653">=</span>&nbsp;<span class="ident" id="5184655">utf8</span><span class="op" id="5184659">.</span><span class="ident" id="5184660">DecodeRuneInString</span><span class="op" id="5184678">(</span><span class="ident" id="5184679">src</span><span class="op" id="5184682">[</span><span class="ident" id="5184683">searchPos</span><span class="op" id="5184692">:</span><span class="op" id="5184693">]</span><span class="op" id="5184694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5184702">if</span>&nbsp;<span class="ident" id="5184705">searchPos</span><span class="op" id="5184714">+</span><span class="ident" id="5184715">width</span>&nbsp;<span class="op" id="5184721">&gt;</span>&nbsp;<span class="ident" id="5184723">a</span><span class="op" id="5184724">[</span><span class="num" id="5184725">1</span><span class="op" id="5184726">]</span>&nbsp;<span class="op" id="5184728">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184733">searchPos</span>&nbsp;<span class="op" id="5184743">+=</span>&nbsp;<span class="ident" id="5184746">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184754">}</span>&nbsp;<span class="keyword" id="5184756">else</span>&nbsp;<span class="keyword" id="5184761">if</span>&nbsp;<span class="ident" id="5184764">searchPos</span><span class="op" id="5184773">+</span><span class="num" id="5184774">1</span>&nbsp;<span class="op" id="5184776">&gt;</span>&nbsp;<span class="ident" id="5184778">a</span><span class="op" id="5184779">[</span><span class="num" id="5184780">1</span><span class="op" id="5184781">]</span>&nbsp;<span class="op" id="5184783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184788">//&nbsp;This&nbsp;clause&nbsp;is&nbsp;only&nbsp;needed&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184845">//&nbsp;string.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;DecodeRuneInString&nbsp;returns&nbsp;width=0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184910">searchPos</span><span class="op" id="5184919">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184924">}</span>&nbsp;<span class="keyword" id="5184926">else</span>&nbsp;<span class="op" id="5184931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5184936">searchPos</span>&nbsp;<span class="op" id="5184946">=</span>&nbsp;<span class="ident" id="5184948">a</span><span class="op" id="5184949">[</span><span class="num" id="5184950">1</span><span class="op" id="5184951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5184958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5184962">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;after&nbsp;the&nbsp;last&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185018">if</span>&nbsp;<span class="ident" id="5185021">bsrc</span>&nbsp;<span class="op" id="5185026">!=</span>&nbsp;<span class="builtintype" id="5185029">nil</span>&nbsp;<span class="op" id="5185033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185037">buf</span>&nbsp;<span class="op" id="5185041">=</span>&nbsp;<span class="builtinfunc" id="5185043">append</span><span class="op" id="5185049">(</span><span class="ident" id="5185050">buf</span><span class="op" id="5185053">,</span>&nbsp;<span class="ident" id="5185055">bsrc</span><span class="op" id="5185059">[</span><span class="ident" id="5185060">lastMatchEnd</span><span class="op" id="5185072">:</span><span class="op" id="5185073">]</span><span class="op" id="5185074">...</span><span class="op" id="5185077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5185080">}</span>&nbsp;<span class="keyword" id="5185082">else</span>&nbsp;<span class="op" id="5185087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185091">buf</span>&nbsp;<span class="op" id="5185095">=</span>&nbsp;<span class="builtinfunc" id="5185097">append</span><span class="op" id="5185103">(</span><span class="ident" id="5185104">buf</span><span class="op" id="5185107">,</span>&nbsp;<span class="ident" id="5185109">src</span><span class="op" id="5185112">[</span><span class="ident" id="5185113">lastMatchEnd</span><span class="op" id="5185125">:</span><span class="op" id="5185126">]</span><span class="op" id="5185127">...</span><span class="op" id="5185130">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5185133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185137">return</span>&nbsp;<span class="ident" id="5185144">buf</span><br>
<span class="lineno"></span><span class="op" id="5185148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="5185151">//&nbsp;ReplaceAll&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5185220">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;text&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5185296">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="5185372">func</span>&nbsp;<span class="op" id="5185377">(</span><span class="ident" id="5185378">re</span>&nbsp;<span class="op" id="5185381">*</span><span class="ident" id="5185382">Regexp</span><span class="op" id="5185388">)</span>&nbsp;<span class="ident" id="5185390">ReplaceAll</span><span class="op" id="5185400">(</span><span class="ident" id="5185401">src</span><span class="op" id="5185404">,</span>&nbsp;<span class="ident" id="5185406">repl</span>&nbsp;<span class="op" id="5185411">[</span><span class="op" id="5185412">]</span><span class="builtintype" id="5185413">byte</span><span class="op" id="5185417">)</span>&nbsp;<span class="op" id="5185419">[</span><span class="op" id="5185420">]</span><span class="builtintype" id="5185421">byte</span>&nbsp;<span class="op" id="5185426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185429">n</span>&nbsp;<span class="op" id="5185431">:=</span>&nbsp;<span class="num" id="5185434">2</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185437">if</span>&nbsp;<span class="ident" id="5185440">bytes</span><span class="op" id="5185445">.</span><span class="ident" id="5185446">IndexByte</span><span class="op" id="5185455">(</span><span class="ident" id="5185456">repl</span><span class="op" id="5185460">,</span>&nbsp;<span class="string" id="5185462">&#39;$&#39;</span><span class="op" id="5185465">)</span>&nbsp;<span class="op" id="5185467">&gt;=</span>&nbsp;<span class="num" id="5185470">0</span>&nbsp;<span class="op" id="5185472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185476">n</span>&nbsp;<span class="op" id="5185478">=</span>&nbsp;<span class="num" id="5185480">2</span>&nbsp;<span class="op" id="5185482">*</span>&nbsp;<span class="op" id="5185484">(</span><span class="ident" id="5185485">re</span><span class="op" id="5185487">.</span><span class="ident" id="5185488">numSubexp</span>&nbsp;<span class="op" id="5185498">+</span>&nbsp;<span class="num" id="5185500">1</span><span class="op" id="5185501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5185504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185507">srepl</span>&nbsp;<span class="op" id="5185513">:=</span>&nbsp;<span class="string" id="5185516">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185520">b</span>&nbsp;<span class="op" id="5185522">:=</span>&nbsp;<span class="ident" id="5185525">re</span><span class="op" id="5185527">.</span><span class="ident" id="5185528">replaceAll</span><span class="op" id="5185538">(</span><span class="ident" id="5185539">src</span><span class="op" id="5185542">,</span>&nbsp;<span class="string" id="5185544">&#34;&#34;</span><span class="op" id="5185546">,</span>&nbsp;<span class="ident" id="5185548">n</span><span class="op" id="5185549">,</span>&nbsp;<span class="keyword" id="5185551">func</span><span class="op" id="5185555">(</span><span class="ident" id="5185556">dst</span>&nbsp;<span class="op" id="5185560">[</span><span class="op" id="5185561">]</span><span class="builtintype" id="5185562">byte</span><span class="op" id="5185566">,</span>&nbsp;<span class="ident" id="5185568">match</span>&nbsp;<span class="op" id="5185574">[</span><span class="op" id="5185575">]</span><span class="builtintype" id="5185576">int</span><span class="op" id="5185579">)</span>&nbsp;<span class="op" id="5185581">[</span><span class="op" id="5185582">]</span><span class="builtintype" id="5185583">byte</span>&nbsp;<span class="op" id="5185588">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185592">if</span>&nbsp;<span class="builtinfunc" id="5185595">len</span><span class="op" id="5185598">(</span><span class="ident" id="5185599">srepl</span><span class="op" id="5185604">)</span>&nbsp;<span class="op" id="5185606">!=</span>&nbsp;<span class="builtinfunc" id="5185609">len</span><span class="op" id="5185612">(</span><span class="ident" id="5185613">repl</span><span class="op" id="5185617">)</span>&nbsp;<span class="op" id="5185619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5185624">srepl</span>&nbsp;<span class="op" id="5185630">=</span>&nbsp;<span class="builtintype" id="5185632">string</span><span class="op" id="5185638">(</span><span class="ident" id="5185639">repl</span><span class="op" id="5185643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5185647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185651">return</span>&nbsp;<span class="ident" id="5185658">re</span><span class="op" id="5185660">.</span><span class="ident" id="5185661">expand</span><span class="op" id="5185667">(</span><span class="ident" id="5185668">dst</span><span class="op" id="5185671">,</span>&nbsp;<span class="ident" id="5185673">srepl</span><span class="op" id="5185678">,</span>&nbsp;<span class="ident" id="5185680">src</span><span class="op" id="5185683">,</span>&nbsp;<span class="string" id="5185685">&#34;&#34;</span><span class="op" id="5185687">,</span>&nbsp;<span class="ident" id="5185689">match</span><span class="op" id="5185694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5185697">}</span><span class="op" id="5185698">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185701">return</span>&nbsp;<span class="ident" id="5185708">b</span><br>
<span class="lineno"></span><span class="op" id="5185710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5185713">//&nbsp;ReplaceAllLiteral&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="5185789">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;bytes&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno">555</span><span class="comment" id="5185872">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5185897">func</span>&nbsp;<span class="op" id="5185902">(</span><span class="ident" id="5185903">re</span>&nbsp;<span class="op" id="5185906">*</span><span class="ident" id="5185907">Regexp</span><span class="op" id="5185913">)</span>&nbsp;<span class="ident" id="5185915">ReplaceAllLiteral</span><span class="op" id="5185932">(</span><span class="ident" id="5185933">src</span><span class="op" id="5185936">,</span>&nbsp;<span class="ident" id="5185938">repl</span>&nbsp;<span class="op" id="5185943">[</span><span class="op" id="5185944">]</span><span class="builtintype" id="5185945">byte</span><span class="op" id="5185949">)</span>&nbsp;<span class="op" id="5185951">[</span><span class="op" id="5185952">]</span><span class="builtintype" id="5185953">byte</span>&nbsp;<span class="op" id="5185958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5185961">return</span>&nbsp;<span class="ident" id="5185968">re</span><span class="op" id="5185970">.</span><span class="ident" id="5185971">replaceAll</span><span class="op" id="5185981">(</span><span class="ident" id="5185982">src</span><span class="op" id="5185985">,</span>&nbsp;<span class="string" id="5185987">&#34;&#34;</span><span class="op" id="5185989">,</span>&nbsp;<span class="num" id="5185991">2</span><span class="op" id="5185992">,</span>&nbsp;<span class="keyword" id="5185994">func</span><span class="op" id="5185998">(</span><span class="ident" id="5185999">dst</span>&nbsp;<span class="op" id="5186003">[</span><span class="op" id="5186004">]</span><span class="builtintype" id="5186005">byte</span><span class="op" id="5186009">,</span>&nbsp;<span class="ident" id="5186011">match</span>&nbsp;<span class="op" id="5186017">[</span><span class="op" id="5186018">]</span><span class="builtintype" id="5186019">int</span><span class="op" id="5186022">)</span>&nbsp;<span class="op" id="5186024">[</span><span class="op" id="5186025">]</span><span class="builtintype" id="5186026">byte</span>&nbsp;<span class="op" id="5186031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5186035">return</span>&nbsp;<span class="builtinfunc" id="5186042">append</span><span class="op" id="5186048">(</span><span class="ident" id="5186049">dst</span><span class="op" id="5186052">,</span>&nbsp;<span class="ident" id="5186054">repl</span><span class="op" id="5186058">...</span><span class="op" id="5186061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5186064">}</span><span class="op" id="5186065">)</span><br>
<span class="lineno">560</span><span class="op" id="5186067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5186070">//&nbsp;ReplaceAllFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5186138">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="5186212">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;byte&nbsp;slice.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno">565</span><span class="comment" id="5186291">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="5186326">func</span>&nbsp;<span class="op" id="5186331">(</span><span class="ident" id="5186332">re</span>&nbsp;<span class="op" id="5186335">*</span><span class="ident" id="5186336">Regexp</span><span class="op" id="5186342">)</span>&nbsp;<span class="ident" id="5186344">ReplaceAllFunc</span><span class="op" id="5186358">(</span><span class="ident" id="5186359">src</span>&nbsp;<span class="op" id="5186363">[</span><span class="op" id="5186364">]</span><span class="builtintype" id="5186365">byte</span><span class="op" id="5186369">,</span>&nbsp;<span class="ident" id="5186371">repl</span>&nbsp;<span class="keyword" id="5186376">func</span><span class="op" id="5186380">(</span><span class="op" id="5186381">[</span><span class="op" id="5186382">]</span><span class="builtintype" id="5186383">byte</span><span class="op" id="5186387">)</span>&nbsp;<span class="op" id="5186389">[</span><span class="op" id="5186390">]</span><span class="builtintype" id="5186391">byte</span><span class="op" id="5186395">)</span>&nbsp;<span class="op" id="5186397">[</span><span class="op" id="5186398">]</span><span class="builtintype" id="5186399">byte</span>&nbsp;<span class="op" id="5186404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5186407">return</span>&nbsp;<span class="ident" id="5186414">re</span><span class="op" id="5186416">.</span><span class="ident" id="5186417">replaceAll</span><span class="op" id="5186427">(</span><span class="ident" id="5186428">src</span><span class="op" id="5186431">,</span>&nbsp;<span class="string" id="5186433">&#34;&#34;</span><span class="op" id="5186435">,</span>&nbsp;<span class="num" id="5186437">2</span><span class="op" id="5186438">,</span>&nbsp;<span class="keyword" id="5186440">func</span><span class="op" id="5186444">(</span><span class="ident" id="5186445">dst</span>&nbsp;<span class="op" id="5186449">[</span><span class="op" id="5186450">]</span><span class="builtintype" id="5186451">byte</span><span class="op" id="5186455">,</span>&nbsp;<span class="ident" id="5186457">match</span>&nbsp;<span class="op" id="5186463">[</span><span class="op" id="5186464">]</span><span class="builtintype" id="5186465">int</span><span class="op" id="5186468">)</span>&nbsp;<span class="op" id="5186470">[</span><span class="op" id="5186471">]</span><span class="builtintype" id="5186472">byte</span>&nbsp;<span class="op" id="5186477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5186481">return</span>&nbsp;<span class="builtinfunc" id="5186488">append</span><span class="op" id="5186494">(</span><span class="ident" id="5186495">dst</span><span class="op" id="5186498">,</span>&nbsp;<span class="ident" id="5186500">repl</span><span class="op" id="5186504">(</span><span class="ident" id="5186505">src</span><span class="op" id="5186508">[</span><span class="ident" id="5186509">match</span><span class="op" id="5186514">[</span><span class="num" id="5186515">0</span><span class="op" id="5186516">]</span><span class="op" id="5186517">:</span><span class="ident" id="5186518">match</span><span class="op" id="5186523">[</span><span class="num" id="5186524">1</span><span class="op" id="5186525">]</span><span class="op" id="5186526">]</span><span class="op" id="5186527">)</span><span class="op" id="5186528">...</span><span class="op" id="5186531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5186534">}</span><span class="op" id="5186535">)</span><br>
<span class="lineno">570</span><span class="op" id="5186537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5186540">var</span>&nbsp;<span class="ident" id="5186544">specialBytes</span>&nbsp;<span class="op" id="5186557">=</span>&nbsp;<span class="op" id="5186559">[</span><span class="op" id="5186560">]</span><span class="builtintype" id="5186561">byte</span><span class="op" id="5186565">(</span><span class="string" id="5186566">`\.+*?()|[]{}^$`</span><span class="op" id="5186582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5186585">func</span>&nbsp;<span class="ident" id="5186590">special</span><span class="op" id="5186597">(</span><span class="ident" id="5186598">b</span>&nbsp;<span class="builtintype" id="5186600">byte</span><span class="op" id="5186604">)</span>&nbsp;<span class="builtintype" id="5186606">bool</span>&nbsp;<span class="op" id="5186611">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5186614">return</span>&nbsp;<span class="ident" id="5186621">bytes</span><span class="op" id="5186626">.</span><span class="ident" id="5186627">IndexByte</span><span class="op" id="5186636">(</span><span class="ident" id="5186637">specialBytes</span><span class="op" id="5186649">,</span>&nbsp;<span class="ident" id="5186651">b</span><span class="op" id="5186652">)</span>&nbsp;<span class="op" id="5186654">&gt;=</span>&nbsp;<span class="num" id="5186657">0</span><br>
<span class="lineno"></span><span class="op" id="5186659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5186662">//&nbsp;QuoteMeta&nbsp;returns&nbsp;a&nbsp;string&nbsp;that&nbsp;quotes&nbsp;all&nbsp;regular&nbsp;expression&nbsp;metacharacters</span><br>
<span class="lineno"></span><span class="comment" id="5186742">//&nbsp;inside&nbsp;the&nbsp;argument&nbsp;text;&nbsp;the&nbsp;returned&nbsp;string&nbsp;is&nbsp;a&nbsp;regular&nbsp;expression&nbsp;matching</span><br>
<span class="lineno">580</span><span class="comment" id="5186824">//&nbsp;the&nbsp;literal&nbsp;text.&nbsp;&nbsp;For&nbsp;example,&nbsp;QuoteMeta(`[foo]`)&nbsp;returns&nbsp;`\[foo\]`.</span><br>
<span class="lineno"></span><span class="keyword" id="5186897">func</span>&nbsp;<span class="ident" id="5186902">QuoteMeta</span><span class="op" id="5186911">(</span><span class="ident" id="5186912">s</span>&nbsp;<span class="builtintype" id="5186914">string</span><span class="op" id="5186920">)</span>&nbsp;<span class="builtintype" id="5186922">string</span>&nbsp;<span class="op" id="5186929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5186932">b</span>&nbsp;<span class="op" id="5186934">:=</span>&nbsp;<span class="builtinfunc" id="5186937">make</span><span class="op" id="5186941">(</span><span class="op" id="5186942">[</span><span class="op" id="5186943">]</span><span class="builtintype" id="5186944">byte</span><span class="op" id="5186948">,</span>&nbsp;<span class="num" id="5186950">2</span><span class="op" id="5186951">*</span><span class="builtinfunc" id="5186952">len</span><span class="op" id="5186955">(</span><span class="ident" id="5186956">s</span><span class="op" id="5186957">)</span><span class="op" id="5186958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5186962">//&nbsp;A&nbsp;byte&nbsp;loop&nbsp;is&nbsp;correct&nbsp;because&nbsp;all&nbsp;metacharacters&nbsp;are&nbsp;ASCII.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187027">j</span>&nbsp;<span class="op" id="5187029">:=</span>&nbsp;<span class="num" id="5187032">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187035">for</span>&nbsp;<span class="ident" id="5187039">i</span>&nbsp;<span class="op" id="5187041">:=</span>&nbsp;<span class="num" id="5187044">0</span><span class="op" id="5187045">;</span>&nbsp;<span class="ident" id="5187047">i</span>&nbsp;<span class="op" id="5187049">&lt;</span>&nbsp;<span class="builtinfunc" id="5187051">len</span><span class="op" id="5187054">(</span><span class="ident" id="5187055">s</span><span class="op" id="5187056">)</span><span class="op" id="5187057">;</span>&nbsp;<span class="ident" id="5187059">i</span><span class="op" id="5187060">++</span>&nbsp;<span class="op" id="5187063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187067">if</span>&nbsp;<span class="ident" id="5187070">special</span><span class="op" id="5187077">(</span><span class="ident" id="5187078">s</span><span class="op" id="5187079">[</span><span class="ident" id="5187080">i</span><span class="op" id="5187081">]</span><span class="op" id="5187082">)</span>&nbsp;<span class="op" id="5187084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187089">b</span><span class="op" id="5187090">[</span><span class="ident" id="5187091">j</span><span class="op" id="5187092">]</span>&nbsp;<span class="op" id="5187094">=</span>&nbsp;<span class="string" id="5187096">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187104">j</span><span class="op" id="5187105">++</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5187110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187114">b</span><span class="op" id="5187115">[</span><span class="ident" id="5187116">j</span><span class="op" id="5187117">]</span>&nbsp;<span class="op" id="5187119">=</span>&nbsp;<span class="ident" id="5187121">s</span><span class="op" id="5187122">[</span><span class="ident" id="5187123">i</span><span class="op" id="5187124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187128">j</span><span class="op" id="5187129">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5187133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187136">return</span>&nbsp;<span class="builtintype" id="5187143">string</span><span class="op" id="5187149">(</span><span class="ident" id="5187150">b</span><span class="op" id="5187151">[</span><span class="num" id="5187152">0</span><span class="op" id="5187153">:</span><span class="ident" id="5187154">j</span><span class="op" id="5187155">]</span><span class="op" id="5187156">)</span><br>
<span class="lineno">595</span><span class="op" id="5187158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187161">//&nbsp;The&nbsp;number&nbsp;of&nbsp;capture&nbsp;values&nbsp;in&nbsp;the&nbsp;program&nbsp;may&nbsp;correspond</span><br>
<span class="lineno"></span><span class="comment" id="5187223">//&nbsp;to&nbsp;fewer&nbsp;capturing&nbsp;expressions&nbsp;than&nbsp;are&nbsp;in&nbsp;the&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="comment" id="5187281">//&nbsp;For&nbsp;example,&nbsp;&#34;(a){0}&#34;&nbsp;turns&nbsp;into&nbsp;an&nbsp;empty&nbsp;program,&nbsp;so&nbsp;the</span><br>
<span class="lineno">600</span><span class="comment" id="5187342">//&nbsp;maximum&nbsp;capture&nbsp;in&nbsp;the&nbsp;program&nbsp;is&nbsp;0&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5187403">//&nbsp;an&nbsp;expression&nbsp;for&nbsp;\1.&nbsp;&nbsp;Pad&nbsp;appends&nbsp;-1s&nbsp;to&nbsp;the&nbsp;slice&nbsp;a&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="5187471">func</span>&nbsp;<span class="op" id="5187476">(</span><span class="ident" id="5187477">re</span>&nbsp;<span class="op" id="5187480">*</span><span class="ident" id="5187481">Regexp</span><span class="op" id="5187487">)</span>&nbsp;<span class="ident" id="5187489">pad</span><span class="op" id="5187492">(</span><span class="ident" id="5187493">a</span>&nbsp;<span class="op" id="5187495">[</span><span class="op" id="5187496">]</span><span class="builtintype" id="5187497">int</span><span class="op" id="5187500">)</span>&nbsp;<span class="op" id="5187502">[</span><span class="op" id="5187503">]</span><span class="builtintype" id="5187504">int</span>&nbsp;<span class="op" id="5187508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187511">if</span>&nbsp;<span class="ident" id="5187514">a</span>&nbsp;<span class="op" id="5187516">==</span>&nbsp;<span class="builtintype" id="5187519">nil</span>&nbsp;<span class="op" id="5187523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5187527">//&nbsp;No&nbsp;match.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187542">return</span>&nbsp;<span class="builtintype" id="5187549">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5187554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187557">n</span>&nbsp;<span class="op" id="5187559">:=</span>&nbsp;<span class="op" id="5187562">(</span><span class="num" id="5187563">1</span>&nbsp;<span class="op" id="5187565">+</span>&nbsp;<span class="ident" id="5187567">re</span><span class="op" id="5187569">.</span><span class="ident" id="5187570">numSubexp</span><span class="op" id="5187579">)</span>&nbsp;<span class="op" id="5187581">*</span>&nbsp;<span class="num" id="5187583">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187586">for</span>&nbsp;<span class="builtinfunc" id="5187590">len</span><span class="op" id="5187593">(</span><span class="ident" id="5187594">a</span><span class="op" id="5187595">)</span>&nbsp;<span class="op" id="5187597">&lt;</span>&nbsp;<span class="ident" id="5187599">n</span>&nbsp;<span class="op" id="5187601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187605">a</span>&nbsp;<span class="op" id="5187607">=</span>&nbsp;<span class="builtinfunc" id="5187609">append</span><span class="op" id="5187615">(</span><span class="ident" id="5187616">a</span><span class="op" id="5187617">,</span>&nbsp;<span class="op" id="5187619">-</span><span class="num" id="5187620">1</span><span class="op" id="5187621">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5187624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187627">return</span>&nbsp;<span class="ident" id="5187634">a</span><br>
<span class="lineno"></span><span class="op" id="5187636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187639">//&nbsp;Find&nbsp;matches&nbsp;in&nbsp;slice&nbsp;b&nbsp;if&nbsp;b&nbsp;is&nbsp;non-nil,&nbsp;otherwise&nbsp;find&nbsp;matches&nbsp;in&nbsp;string&nbsp;s.</span><br>
<span class="lineno">615</span><span class="keyword" id="5187719">func</span>&nbsp;<span class="op" id="5187724">(</span><span class="ident" id="5187725">re</span>&nbsp;<span class="op" id="5187728">*</span><span class="ident" id="5187729">Regexp</span><span class="op" id="5187735">)</span>&nbsp;<span class="ident" id="5187737">allMatches</span><span class="op" id="5187747">(</span><span class="ident" id="5187748">s</span>&nbsp;<span class="builtintype" id="5187750">string</span><span class="op" id="5187756">,</span>&nbsp;<span class="ident" id="5187758">b</span>&nbsp;<span class="op" id="5187760">[</span><span class="op" id="5187761">]</span><span class="builtintype" id="5187762">byte</span><span class="op" id="5187766">,</span>&nbsp;<span class="ident" id="5187768">n</span>&nbsp;<span class="builtintype" id="5187770">int</span><span class="op" id="5187773">,</span>&nbsp;<span class="ident" id="5187775">deliver</span>&nbsp;<span class="keyword" id="5187783">func</span><span class="op" id="5187787">(</span><span class="op" id="5187788">[</span><span class="op" id="5187789">]</span><span class="builtintype" id="5187790">int</span><span class="op" id="5187793">)</span><span class="op" id="5187794">)</span>&nbsp;<span class="op" id="5187796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187799">var</span>&nbsp;<span class="ident" id="5187803">end</span>&nbsp;<span class="builtintype" id="5187807">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187812">if</span>&nbsp;<span class="ident" id="5187815">b</span>&nbsp;<span class="op" id="5187817">==</span>&nbsp;<span class="builtintype" id="5187820">nil</span>&nbsp;<span class="op" id="5187824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187828">end</span>&nbsp;<span class="op" id="5187832">=</span>&nbsp;<span class="builtinfunc" id="5187834">len</span><span class="op" id="5187837">(</span><span class="ident" id="5187838">s</span><span class="op" id="5187839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5187842">}</span>&nbsp;<span class="keyword" id="5187844">else</span>&nbsp;<span class="op" id="5187849">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187853">end</span>&nbsp;<span class="op" id="5187857">=</span>&nbsp;<span class="builtinfunc" id="5187859">len</span><span class="op" id="5187862">(</span><span class="ident" id="5187863">b</span><span class="op" id="5187864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5187867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187871">for</span>&nbsp;<span class="ident" id="5187875">pos</span><span class="op" id="5187878">,</span>&nbsp;<span class="ident" id="5187880">i</span><span class="op" id="5187881">,</span>&nbsp;<span class="ident" id="5187883">prevMatchEnd</span>&nbsp;<span class="op" id="5187896">:=</span>&nbsp;<span class="num" id="5187899">0</span><span class="op" id="5187900">,</span>&nbsp;<span class="num" id="5187902">0</span><span class="op" id="5187903">,</span>&nbsp;<span class="op" id="5187905">-</span><span class="num" id="5187906">1</span><span class="op" id="5187907">;</span>&nbsp;<span class="ident" id="5187909">i</span>&nbsp;<span class="op" id="5187911">&lt;</span>&nbsp;<span class="ident" id="5187913">n</span>&nbsp;<span class="op" id="5187915">&amp;&amp;</span>&nbsp;<span class="ident" id="5187918">pos</span>&nbsp;<span class="op" id="5187922">&lt;=</span>&nbsp;<span class="ident" id="5187925">end</span><span class="op" id="5187928">;</span>&nbsp;<span class="op" id="5187930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5187934">matches</span>&nbsp;<span class="op" id="5187942">:=</span>&nbsp;<span class="ident" id="5187945">re</span><span class="op" id="5187947">.</span><span class="ident" id="5187948">doExecute</span><span class="op" id="5187957">(</span><span class="builtintype" id="5187958">nil</span><span class="op" id="5187961">,</span>&nbsp;<span class="ident" id="5187963">b</span><span class="op" id="5187964">,</span>&nbsp;<span class="ident" id="5187966">s</span><span class="op" id="5187967">,</span>&nbsp;<span class="ident" id="5187969">pos</span><span class="op" id="5187972">,</span>&nbsp;<span class="ident" id="5187974">re</span><span class="op" id="5187976">.</span><span class="ident" id="5187977">prog</span><span class="op" id="5187981">.</span><span class="ident" id="5187982">NumCap</span><span class="op" id="5187988">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5187992">if</span>&nbsp;<span class="builtinfunc" id="5187995">len</span><span class="op" id="5187998">(</span><span class="ident" id="5187999">matches</span><span class="op" id="5188006">)</span>&nbsp;<span class="op" id="5188008">==</span>&nbsp;<span class="num" id="5188011">0</span>&nbsp;<span class="op" id="5188013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188018">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188031">accept</span>&nbsp;<span class="op" id="5188038">:=</span>&nbsp;<span class="builtintype" id="5188041">true</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188048">if</span>&nbsp;<span class="ident" id="5188051">matches</span><span class="op" id="5188058">[</span><span class="num" id="5188059">1</span><span class="op" id="5188060">]</span>&nbsp;<span class="op" id="5188062">==</span>&nbsp;<span class="ident" id="5188065">pos</span>&nbsp;<span class="op" id="5188069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5188074">//&nbsp;We&#39;ve&nbsp;found&nbsp;an&nbsp;empty&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188108">if</span>&nbsp;<span class="ident" id="5188111">matches</span><span class="op" id="5188118">[</span><span class="num" id="5188119">0</span><span class="op" id="5188120">]</span>&nbsp;<span class="op" id="5188122">==</span>&nbsp;<span class="ident" id="5188125">prevMatchEnd</span>&nbsp;<span class="op" id="5188138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5188144">//&nbsp;We&nbsp;don&#39;t&nbsp;allow&nbsp;an&nbsp;empty&nbsp;match&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5188187">//&nbsp;after&nbsp;a&nbsp;previous&nbsp;match,&nbsp;so&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188232">accept</span>&nbsp;<span class="op" id="5188239">=</span>&nbsp;<span class="builtintype" id="5188241">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188255">var</span>&nbsp;<span class="ident" id="5188259">width</span>&nbsp;<span class="builtintype" id="5188265">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5188272">//&nbsp;TODO:&nbsp;use&nbsp;step()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188295">if</span>&nbsp;<span class="ident" id="5188298">b</span>&nbsp;<span class="op" id="5188300">==</span>&nbsp;<span class="builtintype" id="5188303">nil</span>&nbsp;<span class="op" id="5188307">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188313">_</span><span class="op" id="5188314">,</span>&nbsp;<span class="ident" id="5188316">width</span>&nbsp;<span class="op" id="5188322">=</span>&nbsp;<span class="ident" id="5188324">utf8</span><span class="op" id="5188328">.</span><span class="ident" id="5188329">DecodeRuneInString</span><span class="op" id="5188347">(</span><span class="ident" id="5188348">s</span><span class="op" id="5188349">[</span><span class="ident" id="5188350">pos</span><span class="op" id="5188353">:</span><span class="ident" id="5188354">end</span><span class="op" id="5188357">]</span><span class="op" id="5188358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188363">}</span>&nbsp;<span class="keyword" id="5188365">else</span>&nbsp;<span class="op" id="5188370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188376">_</span><span class="op" id="5188377">,</span>&nbsp;<span class="ident" id="5188379">width</span>&nbsp;<span class="op" id="5188385">=</span>&nbsp;<span class="ident" id="5188387">utf8</span><span class="op" id="5188391">.</span><span class="ident" id="5188392">DecodeRune</span><span class="op" id="5188402">(</span><span class="ident" id="5188403">b</span><span class="op" id="5188404">[</span><span class="ident" id="5188405">pos</span><span class="op" id="5188408">:</span><span class="ident" id="5188409">end</span><span class="op" id="5188412">]</span><span class="op" id="5188413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188423">if</span>&nbsp;<span class="ident" id="5188426">width</span>&nbsp;<span class="op" id="5188432">&gt;</span>&nbsp;<span class="num" id="5188434">0</span>&nbsp;<span class="op" id="5188436">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188442">pos</span>&nbsp;<span class="op" id="5188446">+=</span>&nbsp;<span class="ident" id="5188449">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188458">}</span>&nbsp;<span class="keyword" id="5188460">else</span>&nbsp;<span class="op" id="5188465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188471">pos</span>&nbsp;<span class="op" id="5188475">=</span>&nbsp;<span class="ident" id="5188477">end</span>&nbsp;<span class="op" id="5188481">+</span>&nbsp;<span class="num" id="5188483">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188492">}</span>&nbsp;<span class="keyword" id="5188494">else</span>&nbsp;<span class="op" id="5188499">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188504">pos</span>&nbsp;<span class="op" id="5188508">=</span>&nbsp;<span class="ident" id="5188510">matches</span><span class="op" id="5188517">[</span><span class="num" id="5188518">1</span><span class="op" id="5188519">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188527">prevMatchEnd</span>&nbsp;<span class="op" id="5188540">=</span>&nbsp;<span class="ident" id="5188542">matches</span><span class="op" id="5188549">[</span><span class="num" id="5188550">1</span><span class="op" id="5188551">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188556">if</span>&nbsp;<span class="ident" id="5188559">accept</span>&nbsp;<span class="op" id="5188566">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188571">deliver</span><span class="op" id="5188578">(</span><span class="ident" id="5188579">re</span><span class="op" id="5188581">.</span><span class="ident" id="5188582">pad</span><span class="op" id="5188585">(</span><span class="ident" id="5188586">matches</span><span class="op" id="5188593">)</span><span class="op" id="5188594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188599">i</span><span class="op" id="5188600">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188608">}</span><br>
<span class="lineno"></span><span class="op" id="5188610">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="5188613">//&nbsp;Find&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="5188708">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5188753">func</span>&nbsp;<span class="op" id="5188758">(</span><span class="ident" id="5188759">re</span>&nbsp;<span class="op" id="5188762">*</span><span class="ident" id="5188763">Regexp</span><span class="op" id="5188769">)</span>&nbsp;<span class="ident" id="5188771">Find</span><span class="op" id="5188775">(</span><span class="ident" id="5188776">b</span>&nbsp;<span class="op" id="5188778">[</span><span class="op" id="5188779">]</span><span class="builtintype" id="5188780">byte</span><span class="op" id="5188784">)</span>&nbsp;<span class="op" id="5188786">[</span><span class="op" id="5188787">]</span><span class="builtintype" id="5188788">byte</span>&nbsp;<span class="op" id="5188793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5188796">a</span>&nbsp;<span class="op" id="5188798">:=</span>&nbsp;<span class="ident" id="5188801">re</span><span class="op" id="5188803">.</span><span class="ident" id="5188804">doExecute</span><span class="op" id="5188813">(</span><span class="builtintype" id="5188814">nil</span><span class="op" id="5188817">,</span>&nbsp;<span class="ident" id="5188819">b</span><span class="op" id="5188820">,</span>&nbsp;<span class="string" id="5188822">&#34;&#34;</span><span class="op" id="5188824">,</span>&nbsp;<span class="num" id="5188826">0</span><span class="op" id="5188827">,</span>&nbsp;<span class="num" id="5188829">2</span><span class="op" id="5188830">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188833">if</span>&nbsp;<span class="ident" id="5188836">a</span>&nbsp;<span class="op" id="5188838">==</span>&nbsp;<span class="builtintype" id="5188841">nil</span>&nbsp;<span class="op" id="5188845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188849">return</span>&nbsp;<span class="builtintype" id="5188856">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5188861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5188864">return</span>&nbsp;<span class="ident" id="5188871">b</span><span class="op" id="5188872">[</span><span class="ident" id="5188873">a</span><span class="op" id="5188874">[</span><span class="num" id="5188875">0</span><span class="op" id="5188876">]</span><span class="op" id="5188877">:</span><span class="ident" id="5188878">a</span><span class="op" id="5188879">[</span><span class="num" id="5188880">1</span><span class="op" id="5188881">]</span><span class="op" id="5188882">]</span><br>
<span class="lineno"></span><span class="op" id="5188884">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="5188887">//&nbsp;FindIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the&nbsp;location&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5188965">//&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match&nbsp;itself&nbsp;is&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5189043">//&nbsp;b[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="5189064">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">675</span><span class="keyword" id="5189109">func</span>&nbsp;<span class="op" id="5189114">(</span><span class="ident" id="5189115">re</span>&nbsp;<span class="op" id="5189118">*</span><span class="ident" id="5189119">Regexp</span><span class="op" id="5189125">)</span>&nbsp;<span class="ident" id="5189127">FindIndex</span><span class="op" id="5189136">(</span><span class="ident" id="5189137">b</span>&nbsp;<span class="op" id="5189139">[</span><span class="op" id="5189140">]</span><span class="builtintype" id="5189141">byte</span><span class="op" id="5189145">)</span>&nbsp;<span class="op" id="5189147">(</span><span class="ident" id="5189148">loc</span>&nbsp;<span class="op" id="5189152">[</span><span class="op" id="5189153">]</span><span class="builtintype" id="5189154">int</span><span class="op" id="5189157">)</span>&nbsp;<span class="op" id="5189159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5189162">a</span>&nbsp;<span class="op" id="5189164">:=</span>&nbsp;<span class="ident" id="5189167">re</span><span class="op" id="5189169">.</span><span class="ident" id="5189170">doExecute</span><span class="op" id="5189179">(</span><span class="builtintype" id="5189180">nil</span><span class="op" id="5189183">,</span>&nbsp;<span class="ident" id="5189185">b</span><span class="op" id="5189186">,</span>&nbsp;<span class="string" id="5189188">&#34;&#34;</span><span class="op" id="5189190">,</span>&nbsp;<span class="num" id="5189192">0</span><span class="op" id="5189193">,</span>&nbsp;<span class="num" id="5189195">2</span><span class="op" id="5189196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5189199">if</span>&nbsp;<span class="ident" id="5189202">a</span>&nbsp;<span class="op" id="5189204">==</span>&nbsp;<span class="builtintype" id="5189207">nil</span>&nbsp;<span class="op" id="5189211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5189215">return</span>&nbsp;<span class="builtintype" id="5189222">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5189227">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5189230">return</span>&nbsp;<span class="ident" id="5189237">a</span><span class="op" id="5189238">[</span><span class="num" id="5189239">0</span><span class="op" id="5189240">:</span><span class="num" id="5189241">2</span><span class="op" id="5189242">]</span><br>
<span class="lineno"></span><span class="op" id="5189244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5189247">//&nbsp;FindString&nbsp;returns&nbsp;a&nbsp;string&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5189337">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;match,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,</span><br>
<span class="lineno">685</span><span class="comment" id="5189412">//&nbsp;but&nbsp;it&nbsp;will&nbsp;also&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;regular&nbsp;expression&nbsp;successfully&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="5189488">//&nbsp;an&nbsp;empty&nbsp;string.&nbsp;&nbsp;Use&nbsp;FindStringIndex&nbsp;or&nbsp;FindStringSubmatch&nbsp;if&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5189560">//&nbsp;necessary&nbsp;to&nbsp;distinguish&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span><span class="keyword" id="5189601">func</span>&nbsp;<span class="op" id="5189606">(</span><span class="ident" id="5189607">re</span>&nbsp;<span class="op" id="5189610">*</span><span class="ident" id="5189611">Regexp</span><span class="op" id="5189617">)</span>&nbsp;<span class="ident" id="5189619">FindString</span><span class="op" id="5189629">(</span><span class="ident" id="5189630">s</span>&nbsp;<span class="builtintype" id="5189632">string</span><span class="op" id="5189638">)</span>&nbsp;<span class="builtintype" id="5189640">string</span>&nbsp;<span class="op" id="5189647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5189650">a</span>&nbsp;<span class="op" id="5189652">:=</span>&nbsp;<span class="ident" id="5189655">re</span><span class="op" id="5189657">.</span><span class="ident" id="5189658">doExecute</span><span class="op" id="5189667">(</span><span class="builtintype" id="5189668">nil</span><span class="op" id="5189671">,</span>&nbsp;<span class="builtintype" id="5189673">nil</span><span class="op" id="5189676">,</span>&nbsp;<span class="ident" id="5189678">s</span><span class="op" id="5189679">,</span>&nbsp;<span class="num" id="5189681">0</span><span class="op" id="5189682">,</span>&nbsp;<span class="num" id="5189684">2</span><span class="op" id="5189685">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5189688">if</span>&nbsp;<span class="ident" id="5189691">a</span>&nbsp;<span class="op" id="5189693">==</span>&nbsp;<span class="builtintype" id="5189696">nil</span>&nbsp;<span class="op" id="5189700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5189704">return</span>&nbsp;<span class="string" id="5189711">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5189715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5189718">return</span>&nbsp;<span class="ident" id="5189725">s</span><span class="op" id="5189726">[</span><span class="ident" id="5189727">a</span><span class="op" id="5189728">[</span><span class="num" id="5189729">0</span><span class="op" id="5189730">]</span><span class="op" id="5189731">:</span><span class="ident" id="5189732">a</span><span class="op" id="5189733">[</span><span class="num" id="5189734">1</span><span class="op" id="5189735">]</span><span class="op" id="5189736">]</span><br>
<span class="lineno"></span><span class="op" id="5189738">}</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span><span class="comment" id="5189741">//&nbsp;FindStringIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5189813">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="5189890">//&nbsp;itself&nbsp;is&nbsp;at&nbsp;s[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="5189924">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">700</span><span class="keyword" id="5189969">func</span>&nbsp;<span class="op" id="5189974">(</span><span class="ident" id="5189975">re</span>&nbsp;<span class="op" id="5189978">*</span><span class="ident" id="5189979">Regexp</span><span class="op" id="5189985">)</span>&nbsp;<span class="ident" id="5189987">FindStringIndex</span><span class="op" id="5190002">(</span><span class="ident" id="5190003">s</span>&nbsp;<span class="builtintype" id="5190005">string</span><span class="op" id="5190011">)</span>&nbsp;<span class="op" id="5190013">(</span><span class="ident" id="5190014">loc</span>&nbsp;<span class="op" id="5190018">[</span><span class="op" id="5190019">]</span><span class="builtintype" id="5190020">int</span><span class="op" id="5190023">)</span>&nbsp;<span class="op" id="5190025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190028">a</span>&nbsp;<span class="op" id="5190030">:=</span>&nbsp;<span class="ident" id="5190033">re</span><span class="op" id="5190035">.</span><span class="ident" id="5190036">doExecute</span><span class="op" id="5190045">(</span><span class="builtintype" id="5190046">nil</span><span class="op" id="5190049">,</span>&nbsp;<span class="builtintype" id="5190051">nil</span><span class="op" id="5190054">,</span>&nbsp;<span class="ident" id="5190056">s</span><span class="op" id="5190057">,</span>&nbsp;<span class="num" id="5190059">0</span><span class="op" id="5190060">,</span>&nbsp;<span class="num" id="5190062">2</span><span class="op" id="5190063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190066">if</span>&nbsp;<span class="ident" id="5190069">a</span>&nbsp;<span class="op" id="5190071">==</span>&nbsp;<span class="builtintype" id="5190074">nil</span>&nbsp;<span class="op" id="5190078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190082">return</span>&nbsp;<span class="builtintype" id="5190089">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190094">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190097">return</span>&nbsp;<span class="ident" id="5190104">a</span><span class="op" id="5190105">[</span><span class="num" id="5190106">0</span><span class="op" id="5190107">:</span><span class="num" id="5190108">2</span><span class="op" id="5190109">]</span><br>
<span class="lineno"></span><span class="op" id="5190111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5190114">//&nbsp;FindReaderIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5190186">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;text&nbsp;read&nbsp;from</span><br>
<span class="lineno">710</span><span class="comment" id="5190264">//&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;The&nbsp;match&nbsp;text&nbsp;was&nbsp;found&nbsp;in&nbsp;the&nbsp;input&nbsp;stream&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5190332">//&nbsp;byte&nbsp;offset&nbsp;loc[0]&nbsp;through&nbsp;loc[1]-1.</span><br>
<span class="lineno"></span><span class="comment" id="5190372">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5190417">func</span>&nbsp;<span class="op" id="5190422">(</span><span class="ident" id="5190423">re</span>&nbsp;<span class="op" id="5190426">*</span><span class="ident" id="5190427">Regexp</span><span class="op" id="5190433">)</span>&nbsp;<span class="ident" id="5190435">FindReaderIndex</span><span class="op" id="5190450">(</span><span class="ident" id="5190451">r</span>&nbsp;<span class="ident" id="5190453">io</span><span class="op" id="5190455">.</span><span class="ident" id="5190456">RuneReader</span><span class="op" id="5190466">)</span>&nbsp;<span class="op" id="5190468">(</span><span class="ident" id="5190469">loc</span>&nbsp;<span class="op" id="5190473">[</span><span class="op" id="5190474">]</span><span class="builtintype" id="5190475">int</span><span class="op" id="5190478">)</span>&nbsp;<span class="op" id="5190480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190483">a</span>&nbsp;<span class="op" id="5190485">:=</span>&nbsp;<span class="ident" id="5190488">re</span><span class="op" id="5190490">.</span><span class="ident" id="5190491">doExecute</span><span class="op" id="5190500">(</span><span class="ident" id="5190501">r</span><span class="op" id="5190502">,</span>&nbsp;<span class="builtintype" id="5190504">nil</span><span class="op" id="5190507">,</span>&nbsp;<span class="string" id="5190509">&#34;&#34;</span><span class="op" id="5190511">,</span>&nbsp;<span class="num" id="5190513">0</span><span class="op" id="5190514">,</span>&nbsp;<span class="num" id="5190516">2</span><span class="op" id="5190517">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190520">if</span>&nbsp;<span class="ident" id="5190523">a</span>&nbsp;<span class="op" id="5190525">==</span>&nbsp;<span class="builtintype" id="5190528">nil</span>&nbsp;<span class="op" id="5190532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190536">return</span>&nbsp;<span class="builtintype" id="5190543">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190551">return</span>&nbsp;<span class="ident" id="5190558">a</span><span class="op" id="5190559">[</span><span class="num" id="5190560">0</span><span class="op" id="5190561">:</span><span class="num" id="5190562">2</span><span class="op" id="5190563">]</span><br>
<span class="lineno"></span><span class="op" id="5190565">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="comment" id="5190568">//&nbsp;FindSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;slices&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost</span><br>
<span class="lineno"></span><span class="comment" id="5190643">//&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5190715">//&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5190791">//&nbsp;comment.</span><br>
<span class="lineno">725</span><span class="comment" id="5190803">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5190848">func</span>&nbsp;<span class="op" id="5190853">(</span><span class="ident" id="5190854">re</span>&nbsp;<span class="op" id="5190857">*</span><span class="ident" id="5190858">Regexp</span><span class="op" id="5190864">)</span>&nbsp;<span class="ident" id="5190866">FindSubmatch</span><span class="op" id="5190878">(</span><span class="ident" id="5190879">b</span>&nbsp;<span class="op" id="5190881">[</span><span class="op" id="5190882">]</span><span class="builtintype" id="5190883">byte</span><span class="op" id="5190887">)</span>&nbsp;<span class="op" id="5190889">[</span><span class="op" id="5190890">]</span><span class="op" id="5190891">[</span><span class="op" id="5190892">]</span><span class="builtintype" id="5190893">byte</span>&nbsp;<span class="op" id="5190898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190901">a</span>&nbsp;<span class="op" id="5190903">:=</span>&nbsp;<span class="ident" id="5190906">re</span><span class="op" id="5190908">.</span><span class="ident" id="5190909">doExecute</span><span class="op" id="5190918">(</span><span class="builtintype" id="5190919">nil</span><span class="op" id="5190922">,</span>&nbsp;<span class="ident" id="5190924">b</span><span class="op" id="5190925">,</span>&nbsp;<span class="string" id="5190927">&#34;&#34;</span><span class="op" id="5190929">,</span>&nbsp;<span class="num" id="5190931">0</span><span class="op" id="5190932">,</span>&nbsp;<span class="ident" id="5190934">re</span><span class="op" id="5190936">.</span><span class="ident" id="5190937">prog</span><span class="op" id="5190941">.</span><span class="ident" id="5190942">NumCap</span><span class="op" id="5190948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190951">if</span>&nbsp;<span class="ident" id="5190954">a</span>&nbsp;<span class="op" id="5190956">==</span>&nbsp;<span class="builtintype" id="5190959">nil</span>&nbsp;<span class="op" id="5190963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5190967">return</span>&nbsp;<span class="builtintype" id="5190974">nil</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5190979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5190982">ret</span>&nbsp;<span class="op" id="5190986">:=</span>&nbsp;<span class="builtinfunc" id="5190989">make</span><span class="op" id="5190993">(</span><span class="op" id="5190994">[</span><span class="op" id="5190995">]</span><span class="op" id="5190996">[</span><span class="op" id="5190997">]</span><span class="builtintype" id="5190998">byte</span><span class="op" id="5191002">,</span>&nbsp;<span class="num" id="5191004">1</span><span class="op" id="5191005">+</span><span class="ident" id="5191006">re</span><span class="op" id="5191008">.</span><span class="ident" id="5191009">numSubexp</span><span class="op" id="5191018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191021">for</span>&nbsp;<span class="ident" id="5191025">i</span>&nbsp;<span class="op" id="5191027">:=</span>&nbsp;<span class="keyword" id="5191030">range</span>&nbsp;<span class="ident" id="5191036">ret</span>&nbsp;<span class="op" id="5191040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191044">if</span>&nbsp;<span class="num" id="5191047">2</span><span class="op" id="5191048">*</span><span class="ident" id="5191049">i</span>&nbsp;<span class="op" id="5191051">&lt;</span>&nbsp;<span class="builtinfunc" id="5191053">len</span><span class="op" id="5191056">(</span><span class="ident" id="5191057">a</span><span class="op" id="5191058">)</span>&nbsp;<span class="op" id="5191060">&amp;&amp;</span>&nbsp;<span class="ident" id="5191063">a</span><span class="op" id="5191064">[</span><span class="num" id="5191065">2</span><span class="op" id="5191066">*</span><span class="ident" id="5191067">i</span><span class="op" id="5191068">]</span>&nbsp;<span class="op" id="5191070">&gt;=</span>&nbsp;<span class="num" id="5191073">0</span>&nbsp;<span class="op" id="5191075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5191080">ret</span><span class="op" id="5191083">[</span><span class="ident" id="5191084">i</span><span class="op" id="5191085">]</span>&nbsp;<span class="op" id="5191087">=</span>&nbsp;<span class="ident" id="5191089">b</span><span class="op" id="5191090">[</span><span class="ident" id="5191091">a</span><span class="op" id="5191092">[</span><span class="num" id="5191093">2</span><span class="op" id="5191094">*</span><span class="ident" id="5191095">i</span><span class="op" id="5191096">]</span><span class="op" id="5191097">:</span><span class="ident" id="5191098">a</span><span class="op" id="5191099">[</span><span class="num" id="5191100">2</span><span class="op" id="5191101">*</span><span class="ident" id="5191102">i</span><span class="op" id="5191103">+</span><span class="num" id="5191104">1</span><span class="op" id="5191105">]</span><span class="op" id="5191106">]</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5191110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5191113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5191116">return</span>&nbsp;<span class="ident" id="5191123">ret</span><br>
<span class="lineno"></span><span class="op" id="5191127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="comment" id="5191130">//&nbsp;Expand&nbsp;appends&nbsp;template&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;result;&nbsp;during&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5191199">//&nbsp;append,&nbsp;Expand&nbsp;replaces&nbsp;variables&nbsp;in&nbsp;the&nbsp;template&nbsp;with&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5191271">//&nbsp;matches&nbsp;drawn&nbsp;from&nbsp;src.&nbsp;&nbsp;The&nbsp;match&nbsp;slice&nbsp;should&nbsp;have&nbsp;been&nbsp;returned&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5191344">//&nbsp;FindSubmatchIndex.</span><br>
<span class="lineno"></span><span class="comment" id="5191366">//</span><br>
<span class="lineno">745</span><span class="comment" id="5191369">//&nbsp;In&nbsp;the&nbsp;template,&nbsp;a&nbsp;variable&nbsp;is&nbsp;denoted&nbsp;by&nbsp;a&nbsp;substring&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="5191438">//&nbsp;$name&nbsp;or&nbsp;${name},&nbsp;where&nbsp;name&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;sequence&nbsp;of&nbsp;letters,</span><br>
<span class="lineno"></span><span class="comment" id="5191506">//&nbsp;digits,&nbsp;and&nbsp;underscores.&nbsp;&nbsp;A&nbsp;purely&nbsp;numeric&nbsp;name&nbsp;like&nbsp;$1&nbsp;refers&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5191575">//&nbsp;the&nbsp;submatch&nbsp;with&nbsp;the&nbsp;corresponding&nbsp;index;&nbsp;other&nbsp;names&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5191642">//&nbsp;capturing&nbsp;parentheses&nbsp;named&nbsp;with&nbsp;the&nbsp;(?P&lt;name&gt;...)&nbsp;syntax.&nbsp;&nbsp;A</span><br>
<span class="lineno">750</span><span class="comment" id="5191707">//&nbsp;reference&nbsp;to&nbsp;an&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;unmatched&nbsp;index&nbsp;or&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5191780">//&nbsp;present&nbsp;in&nbsp;the&nbsp;regular&nbsp;expression&nbsp;is&nbsp;replaced&nbsp;with&nbsp;an&nbsp;empty&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5191850">//</span><br>
<span class="lineno"></span><span class="comment" id="5191853">//&nbsp;In&nbsp;the&nbsp;$name&nbsp;form,&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;as&nbsp;long&nbsp;as&nbsp;possible:&nbsp;$1x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5191923">//&nbsp;equivalent&nbsp;to&nbsp;${1x},&nbsp;not&nbsp;${1}x,&nbsp;and,&nbsp;$10&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;${10},&nbsp;not&nbsp;${1}0.</span><br>
<span class="lineno">755</span><span class="comment" id="5192002">//</span><br>
<span class="lineno"></span><span class="comment" id="5192005">//&nbsp;To&nbsp;insert&nbsp;a&nbsp;literal&nbsp;$&nbsp;in&nbsp;the&nbsp;output,&nbsp;use&nbsp;$$&nbsp;in&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5192069">func</span>&nbsp;<span class="op" id="5192074">(</span><span class="ident" id="5192075">re</span>&nbsp;<span class="op" id="5192078">*</span><span class="ident" id="5192079">Regexp</span><span class="op" id="5192085">)</span>&nbsp;<span class="ident" id="5192087">Expand</span><span class="op" id="5192093">(</span><span class="ident" id="5192094">dst</span>&nbsp;<span class="op" id="5192098">[</span><span class="op" id="5192099">]</span><span class="builtintype" id="5192100">byte</span><span class="op" id="5192104">,</span>&nbsp;<span class="ident" id="5192106">template</span>&nbsp;<span class="op" id="5192115">[</span><span class="op" id="5192116">]</span><span class="builtintype" id="5192117">byte</span><span class="op" id="5192121">,</span>&nbsp;<span class="ident" id="5192123">src</span>&nbsp;<span class="op" id="5192127">[</span><span class="op" id="5192128">]</span><span class="builtintype" id="5192129">byte</span><span class="op" id="5192133">,</span>&nbsp;<span class="ident" id="5192135">match</span>&nbsp;<span class="op" id="5192141">[</span><span class="op" id="5192142">]</span><span class="builtintype" id="5192143">int</span><span class="op" id="5192146">)</span>&nbsp;<span class="op" id="5192148">[</span><span class="op" id="5192149">]</span><span class="builtintype" id="5192150">byte</span>&nbsp;<span class="op" id="5192155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192158">return</span>&nbsp;<span class="ident" id="5192165">re</span><span class="op" id="5192167">.</span><span class="ident" id="5192168">expand</span><span class="op" id="5192174">(</span><span class="ident" id="5192175">dst</span><span class="op" id="5192178">,</span>&nbsp;<span class="builtintype" id="5192180">string</span><span class="op" id="5192186">(</span><span class="ident" id="5192187">template</span><span class="op" id="5192195">)</span><span class="op" id="5192196">,</span>&nbsp;<span class="ident" id="5192198">src</span><span class="op" id="5192201">,</span>&nbsp;<span class="string" id="5192203">&#34;&#34;</span><span class="op" id="5192205">,</span>&nbsp;<span class="ident" id="5192207">match</span><span class="op" id="5192212">)</span><br>
<span class="lineno"></span><span class="op" id="5192214">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5192217">//&nbsp;ExpandString&nbsp;is&nbsp;like&nbsp;Expand&nbsp;but&nbsp;the&nbsp;template&nbsp;and&nbsp;source&nbsp;are&nbsp;strings.</span><br>
<span class="lineno"></span><span class="comment" id="5192289">//&nbsp;It&nbsp;appends&nbsp;to&nbsp;and&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;in&nbsp;order&nbsp;to&nbsp;give&nbsp;the&nbsp;calling</span><br>
<span class="lineno"></span><span class="comment" id="5192360">//&nbsp;code&nbsp;control&nbsp;over&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5192393">func</span>&nbsp;<span class="op" id="5192398">(</span><span class="ident" id="5192399">re</span>&nbsp;<span class="op" id="5192402">*</span><span class="ident" id="5192403">Regexp</span><span class="op" id="5192409">)</span>&nbsp;<span class="ident" id="5192411">ExpandString</span><span class="op" id="5192423">(</span><span class="ident" id="5192424">dst</span>&nbsp;<span class="op" id="5192428">[</span><span class="op" id="5192429">]</span><span class="builtintype" id="5192430">byte</span><span class="op" id="5192434">,</span>&nbsp;<span class="ident" id="5192436">template</span>&nbsp;<span class="builtintype" id="5192445">string</span><span class="op" id="5192451">,</span>&nbsp;<span class="ident" id="5192453">src</span>&nbsp;<span class="builtintype" id="5192457">string</span><span class="op" id="5192463">,</span>&nbsp;<span class="ident" id="5192465">match</span>&nbsp;<span class="op" id="5192471">[</span><span class="op" id="5192472">]</span><span class="builtintype" id="5192473">int</span><span class="op" id="5192476">)</span>&nbsp;<span class="op" id="5192478">[</span><span class="op" id="5192479">]</span><span class="builtintype" id="5192480">byte</span>&nbsp;<span class="op" id="5192485">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192488">return</span>&nbsp;<span class="ident" id="5192495">re</span><span class="op" id="5192497">.</span><span class="ident" id="5192498">expand</span><span class="op" id="5192504">(</span><span class="ident" id="5192505">dst</span><span class="op" id="5192508">,</span>&nbsp;<span class="ident" id="5192510">template</span><span class="op" id="5192518">,</span>&nbsp;<span class="builtintype" id="5192520">nil</span><span class="op" id="5192523">,</span>&nbsp;<span class="ident" id="5192525">src</span><span class="op" id="5192528">,</span>&nbsp;<span class="ident" id="5192530">match</span><span class="op" id="5192535">)</span><br>
<span class="lineno"></span><span class="op" id="5192537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5192540">func</span>&nbsp;<span class="op" id="5192545">(</span><span class="ident" id="5192546">re</span>&nbsp;<span class="op" id="5192549">*</span><span class="ident" id="5192550">Regexp</span><span class="op" id="5192556">)</span>&nbsp;<span class="ident" id="5192558">expand</span><span class="op" id="5192564">(</span><span class="ident" id="5192565">dst</span>&nbsp;<span class="op" id="5192569">[</span><span class="op" id="5192570">]</span><span class="builtintype" id="5192571">byte</span><span class="op" id="5192575">,</span>&nbsp;<span class="ident" id="5192577">template</span>&nbsp;<span class="builtintype" id="5192586">string</span><span class="op" id="5192592">,</span>&nbsp;<span class="ident" id="5192594">bsrc</span>&nbsp;<span class="op" id="5192599">[</span><span class="op" id="5192600">]</span><span class="builtintype" id="5192601">byte</span><span class="op" id="5192605">,</span>&nbsp;<span class="ident" id="5192607">src</span>&nbsp;<span class="builtintype" id="5192611">string</span><span class="op" id="5192617">,</span>&nbsp;<span class="ident" id="5192619">match</span>&nbsp;<span class="op" id="5192625">[</span><span class="op" id="5192626">]</span><span class="builtintype" id="5192627">int</span><span class="op" id="5192630">)</span>&nbsp;<span class="op" id="5192632">[</span><span class="op" id="5192633">]</span><span class="builtintype" id="5192634">byte</span>&nbsp;<span class="op" id="5192639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192642">for</span>&nbsp;<span class="builtinfunc" id="5192646">len</span><span class="op" id="5192649">(</span><span class="ident" id="5192650">template</span><span class="op" id="5192658">)</span>&nbsp;<span class="op" id="5192660">&gt;</span>&nbsp;<span class="num" id="5192662">0</span>&nbsp;<span class="op" id="5192664">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192668">i</span>&nbsp;<span class="op" id="5192670">:=</span>&nbsp;<span class="ident" id="5192673">strings</span><span class="op" id="5192680">.</span><span class="ident" id="5192681">Index</span><span class="op" id="5192686">(</span><span class="ident" id="5192687">template</span><span class="op" id="5192695">,</span>&nbsp;<span class="string" id="5192697">&#34;$&#34;</span><span class="op" id="5192700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192704">if</span>&nbsp;<span class="ident" id="5192707">i</span>&nbsp;<span class="op" id="5192709">&lt;</span>&nbsp;<span class="num" id="5192711">0</span>&nbsp;<span class="op" id="5192713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192718">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192730">dst</span>&nbsp;<span class="op" id="5192734">=</span>&nbsp;<span class="builtinfunc" id="5192736">append</span><span class="op" id="5192742">(</span><span class="ident" id="5192743">dst</span><span class="op" id="5192746">,</span>&nbsp;<span class="ident" id="5192748">template</span><span class="op" id="5192756">[</span><span class="op" id="5192757">:</span><span class="ident" id="5192758">i</span><span class="op" id="5192759">]</span><span class="op" id="5192760">...</span><span class="op" id="5192763">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192767">template</span>&nbsp;<span class="op" id="5192776">=</span>&nbsp;<span class="ident" id="5192778">template</span><span class="op" id="5192786">[</span><span class="ident" id="5192787">i</span><span class="op" id="5192788">:</span><span class="op" id="5192789">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192793">if</span>&nbsp;<span class="builtinfunc" id="5192796">len</span><span class="op" id="5192799">(</span><span class="ident" id="5192800">template</span><span class="op" id="5192808">)</span>&nbsp;<span class="op" id="5192810">&gt;</span>&nbsp;<span class="num" id="5192812">1</span>&nbsp;<span class="op" id="5192814">&amp;&amp;</span>&nbsp;<span class="ident" id="5192817">template</span><span class="op" id="5192825">[</span><span class="num" id="5192826">1</span><span class="op" id="5192827">]</span>&nbsp;<span class="op" id="5192829">==</span>&nbsp;<span class="string" id="5192832">&#39;$&#39;</span>&nbsp;<span class="op" id="5192836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5192841">//&nbsp;Treat&nbsp;$$&nbsp;as&nbsp;$.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192862">dst</span>&nbsp;<span class="op" id="5192866">=</span>&nbsp;<span class="builtinfunc" id="5192868">append</span><span class="op" id="5192874">(</span><span class="ident" id="5192875">dst</span><span class="op" id="5192878">,</span>&nbsp;<span class="string" id="5192880">&#39;$&#39;</span><span class="op" id="5192883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192888">template</span>&nbsp;<span class="op" id="5192897">=</span>&nbsp;<span class="ident" id="5192899">template</span><span class="op" id="5192907">[</span><span class="num" id="5192908">2</span><span class="op" id="5192909">:</span><span class="op" id="5192910">]</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192915">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5192926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192930">name</span><span class="op" id="5192934">,</span>&nbsp;<span class="ident" id="5192936">num</span><span class="op" id="5192939">,</span>&nbsp;<span class="ident" id="5192941">rest</span><span class="op" id="5192945">,</span>&nbsp;<span class="ident" id="5192947">ok</span>&nbsp;<span class="op" id="5192950">:=</span>&nbsp;<span class="ident" id="5192953">extract</span><span class="op" id="5192960">(</span><span class="ident" id="5192961">template</span><span class="op" id="5192969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5192973">if</span>&nbsp;<span class="op" id="5192976">!</span><span class="ident" id="5192977">ok</span>&nbsp;<span class="op" id="5192980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5192985">//&nbsp;Malformed;&nbsp;treat&nbsp;$&nbsp;as&nbsp;raw&nbsp;text.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193023">dst</span>&nbsp;<span class="op" id="5193027">=</span>&nbsp;<span class="builtinfunc" id="5193029">append</span><span class="op" id="5193035">(</span><span class="ident" id="5193036">dst</span><span class="op" id="5193039">,</span>&nbsp;<span class="string" id="5193041">&#39;$&#39;</span><span class="op" id="5193044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193049">template</span>&nbsp;<span class="op" id="5193058">=</span>&nbsp;<span class="ident" id="5193060">template</span><span class="op" id="5193068">[</span><span class="num" id="5193069">1</span><span class="op" id="5193070">:</span><span class="op" id="5193071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193076">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193091">template</span>&nbsp;<span class="op" id="5193100">=</span>&nbsp;<span class="ident" id="5193102">rest</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193109">if</span>&nbsp;<span class="ident" id="5193112">num</span>&nbsp;<span class="op" id="5193116">&gt;=</span>&nbsp;<span class="num" id="5193119">0</span>&nbsp;<span class="op" id="5193121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193126">if</span>&nbsp;<span class="num" id="5193129">2</span><span class="op" id="5193130">*</span><span class="ident" id="5193131">num</span><span class="op" id="5193134">+</span><span class="num" id="5193135">1</span>&nbsp;<span class="op" id="5193137">&lt;</span>&nbsp;<span class="builtinfunc" id="5193139">len</span><span class="op" id="5193142">(</span><span class="ident" id="5193143">match</span><span class="op" id="5193148">)</span>&nbsp;<span class="op" id="5193150">&amp;&amp;</span>&nbsp;<span class="ident" id="5193153">match</span><span class="op" id="5193158">[</span><span class="num" id="5193159">2</span><span class="op" id="5193160">*</span><span class="ident" id="5193161">num</span><span class="op" id="5193164">]</span>&nbsp;<span class="op" id="5193166">&gt;=</span>&nbsp;<span class="num" id="5193169">0</span>&nbsp;<span class="op" id="5193171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193177">if</span>&nbsp;<span class="ident" id="5193180">bsrc</span>&nbsp;<span class="op" id="5193185">!=</span>&nbsp;<span class="builtintype" id="5193188">nil</span>&nbsp;<span class="op" id="5193192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193199">dst</span>&nbsp;<span class="op" id="5193203">=</span>&nbsp;<span class="builtinfunc" id="5193205">append</span><span class="op" id="5193211">(</span><span class="ident" id="5193212">dst</span><span class="op" id="5193215">,</span>&nbsp;<span class="ident" id="5193217">bsrc</span><span class="op" id="5193221">[</span><span class="ident" id="5193222">match</span><span class="op" id="5193227">[</span><span class="num" id="5193228">2</span><span class="op" id="5193229">*</span><span class="ident" id="5193230">num</span><span class="op" id="5193233">]</span><span class="op" id="5193234">:</span><span class="ident" id="5193235">match</span><span class="op" id="5193240">[</span><span class="num" id="5193241">2</span><span class="op" id="5193242">*</span><span class="ident" id="5193243">num</span><span class="op" id="5193246">+</span><span class="num" id="5193247">1</span><span class="op" id="5193248">]</span><span class="op" id="5193249">]</span><span class="op" id="5193250">...</span><span class="op" id="5193253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193259">}</span>&nbsp;<span class="keyword" id="5193261">else</span>&nbsp;<span class="op" id="5193266">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193273">dst</span>&nbsp;<span class="op" id="5193277">=</span>&nbsp;<span class="builtinfunc" id="5193279">append</span><span class="op" id="5193285">(</span><span class="ident" id="5193286">dst</span><span class="op" id="5193289">,</span>&nbsp;<span class="ident" id="5193291">src</span><span class="op" id="5193294">[</span><span class="ident" id="5193295">match</span><span class="op" id="5193300">[</span><span class="num" id="5193301">2</span><span class="op" id="5193302">*</span><span class="ident" id="5193303">num</span><span class="op" id="5193306">]</span><span class="op" id="5193307">:</span><span class="ident" id="5193308">match</span><span class="op" id="5193313">[</span><span class="num" id="5193314">2</span><span class="op" id="5193315">*</span><span class="ident" id="5193316">num</span><span class="op" id="5193319">+</span><span class="num" id="5193320">1</span><span class="op" id="5193321">]</span><span class="op" id="5193322">]</span><span class="op" id="5193323">...</span><span class="op" id="5193326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193341">}</span>&nbsp;<span class="keyword" id="5193343">else</span>&nbsp;<span class="op" id="5193348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193353">for</span>&nbsp;<span class="ident" id="5193357">i</span><span class="op" id="5193358">,</span>&nbsp;<span class="ident" id="5193360">namei</span>&nbsp;<span class="op" id="5193366">:=</span>&nbsp;<span class="keyword" id="5193369">range</span>&nbsp;<span class="ident" id="5193375">re</span><span class="op" id="5193377">.</span><span class="ident" id="5193378">subexpNames</span>&nbsp;<span class="op" id="5193390">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193396">if</span>&nbsp;<span class="ident" id="5193399">name</span>&nbsp;<span class="op" id="5193404">==</span>&nbsp;<span class="ident" id="5193407">namei</span>&nbsp;<span class="op" id="5193413">&amp;&amp;</span>&nbsp;<span class="num" id="5193416">2</span><span class="op" id="5193417">*</span><span class="ident" id="5193418">i</span><span class="op" id="5193419">+</span><span class="num" id="5193420">1</span>&nbsp;<span class="op" id="5193422">&lt;</span>&nbsp;<span class="builtinfunc" id="5193424">len</span><span class="op" id="5193427">(</span><span class="ident" id="5193428">match</span><span class="op" id="5193433">)</span>&nbsp;<span class="op" id="5193435">&amp;&amp;</span>&nbsp;<span class="ident" id="5193438">match</span><span class="op" id="5193443">[</span><span class="num" id="5193444">2</span><span class="op" id="5193445">*</span><span class="ident" id="5193446">i</span><span class="op" id="5193447">]</span>&nbsp;<span class="op" id="5193449">&gt;=</span>&nbsp;<span class="num" id="5193452">0</span>&nbsp;<span class="op" id="5193454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193461">if</span>&nbsp;<span class="ident" id="5193464">bsrc</span>&nbsp;<span class="op" id="5193469">!=</span>&nbsp;<span class="builtintype" id="5193472">nil</span>&nbsp;<span class="op" id="5193476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193484">dst</span>&nbsp;<span class="op" id="5193488">=</span>&nbsp;<span class="builtinfunc" id="5193490">append</span><span class="op" id="5193496">(</span><span class="ident" id="5193497">dst</span><span class="op" id="5193500">,</span>&nbsp;<span class="ident" id="5193502">bsrc</span><span class="op" id="5193506">[</span><span class="ident" id="5193507">match</span><span class="op" id="5193512">[</span><span class="num" id="5193513">2</span><span class="op" id="5193514">*</span><span class="ident" id="5193515">i</span><span class="op" id="5193516">]</span><span class="op" id="5193517">:</span><span class="ident" id="5193518">match</span><span class="op" id="5193523">[</span><span class="num" id="5193524">2</span><span class="op" id="5193525">*</span><span class="ident" id="5193526">i</span><span class="op" id="5193527">+</span><span class="num" id="5193528">1</span><span class="op" id="5193529">]</span><span class="op" id="5193530">]</span><span class="op" id="5193531">...</span><span class="op" id="5193534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193541">}</span>&nbsp;<span class="keyword" id="5193543">else</span>&nbsp;<span class="op" id="5193548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193556">dst</span>&nbsp;<span class="op" id="5193560">=</span>&nbsp;<span class="builtinfunc" id="5193562">append</span><span class="op" id="5193568">(</span><span class="ident" id="5193569">dst</span><span class="op" id="5193572">,</span>&nbsp;<span class="ident" id="5193574">src</span><span class="op" id="5193577">[</span><span class="ident" id="5193578">match</span><span class="op" id="5193583">[</span><span class="num" id="5193584">2</span><span class="op" id="5193585">*</span><span class="ident" id="5193586">i</span><span class="op" id="5193587">]</span><span class="op" id="5193588">:</span><span class="ident" id="5193589">match</span><span class="op" id="5193594">[</span><span class="num" id="5193595">2</span><span class="op" id="5193596">*</span><span class="ident" id="5193597">i</span><span class="op" id="5193598">+</span><span class="num" id="5193599">1</span><span class="op" id="5193600">]</span><span class="op" id="5193601">]</span><span class="op" id="5193602">...</span><span class="op" id="5193605">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193619">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193638">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193644">dst</span>&nbsp;<span class="op" id="5193648">=</span>&nbsp;<span class="builtinfunc" id="5193650">append</span><span class="op" id="5193656">(</span><span class="ident" id="5193657">dst</span><span class="op" id="5193660">,</span>&nbsp;<span class="ident" id="5193662">template</span><span class="op" id="5193670">...</span><span class="op" id="5193673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193676">return</span>&nbsp;<span class="ident" id="5193683">dst</span><br>
<span class="lineno"></span><span class="op" id="5193687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span><span class="comment" id="5193690">//&nbsp;extract&nbsp;returns&nbsp;the&nbsp;name&nbsp;from&nbsp;a&nbsp;leading&nbsp;&#34;$name&#34;&nbsp;or&nbsp;&#34;${name}&#34;&nbsp;in&nbsp;str.</span><br>
<span class="lineno"></span><span class="comment" id="5193762">//&nbsp;If&nbsp;it&nbsp;is&nbsp;a&nbsp;number,&nbsp;extract&nbsp;returns&nbsp;num&nbsp;set&nbsp;to&nbsp;that&nbsp;number;&nbsp;otherwise&nbsp;num&nbsp;=&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="5193844">func</span>&nbsp;<span class="ident" id="5193849">extract</span><span class="op" id="5193856">(</span><span class="ident" id="5193857">str</span>&nbsp;<span class="builtintype" id="5193861">string</span><span class="op" id="5193867">)</span>&nbsp;<span class="op" id="5193869">(</span><span class="ident" id="5193870">name</span>&nbsp;<span class="builtintype" id="5193875">string</span><span class="op" id="5193881">,</span>&nbsp;<span class="ident" id="5193883">num</span>&nbsp;<span class="builtintype" id="5193887">int</span><span class="op" id="5193890">,</span>&nbsp;<span class="ident" id="5193892">rest</span>&nbsp;<span class="builtintype" id="5193897">string</span><span class="op" id="5193903">,</span>&nbsp;<span class="ident" id="5193905">ok</span>&nbsp;<span class="builtintype" id="5193908">bool</span><span class="op" id="5193912">)</span>&nbsp;<span class="op" id="5193914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193917">if</span>&nbsp;<span class="builtinfunc" id="5193920">len</span><span class="op" id="5193923">(</span><span class="ident" id="5193924">str</span><span class="op" id="5193927">)</span>&nbsp;<span class="op" id="5193929">&lt;</span>&nbsp;<span class="num" id="5193931">2</span>&nbsp;<span class="op" id="5193933">||</span>&nbsp;<span class="ident" id="5193936">str</span><span class="op" id="5193939">[</span><span class="num" id="5193940">0</span><span class="op" id="5193941">]</span>&nbsp;<span class="op" id="5193943">!=</span>&nbsp;<span class="string" id="5193946">&#39;$&#39;</span>&nbsp;<span class="op" id="5193950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193954">return</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5193962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5193965">brace</span>&nbsp;<span class="op" id="5193971">:=</span>&nbsp;<span class="builtintype" id="5193974">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5193981">if</span>&nbsp;<span class="ident" id="5193984">str</span><span class="op" id="5193987">[</span><span class="num" id="5193988">1</span><span class="op" id="5193989">]</span>&nbsp;<span class="op" id="5193991">==</span>&nbsp;<span class="string" id="5193994">&#39;{&#39;</span>&nbsp;<span class="op" id="5193998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194002">brace</span>&nbsp;<span class="op" id="5194008">=</span>&nbsp;<span class="builtintype" id="5194010">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194017">str</span>&nbsp;<span class="op" id="5194021">=</span>&nbsp;<span class="ident" id="5194023">str</span><span class="op" id="5194026">[</span><span class="num" id="5194027">2</span><span class="op" id="5194028">:</span><span class="op" id="5194029">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194032">}</span>&nbsp;<span class="keyword" id="5194034">else</span>&nbsp;<span class="op" id="5194039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194043">str</span>&nbsp;<span class="op" id="5194047">=</span>&nbsp;<span class="ident" id="5194049">str</span><span class="op" id="5194052">[</span><span class="num" id="5194053">1</span><span class="op" id="5194054">:</span><span class="op" id="5194055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194061">i</span>&nbsp;<span class="op" id="5194063">:=</span>&nbsp;<span class="num" id="5194066">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194069">for</span>&nbsp;<span class="ident" id="5194073">i</span>&nbsp;<span class="op" id="5194075">&lt;</span>&nbsp;<span class="builtinfunc" id="5194077">len</span><span class="op" id="5194080">(</span><span class="ident" id="5194081">str</span><span class="op" id="5194084">)</span>&nbsp;<span class="op" id="5194086">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194090">rune</span><span class="op" id="5194094">,</span>&nbsp;<span class="ident" id="5194096">size</span>&nbsp;<span class="op" id="5194101">:=</span>&nbsp;<span class="ident" id="5194104">utf8</span><span class="op" id="5194108">.</span><span class="ident" id="5194109">DecodeRuneInString</span><span class="op" id="5194127">(</span><span class="ident" id="5194128">str</span><span class="op" id="5194131">[</span><span class="ident" id="5194132">i</span><span class="op" id="5194133">:</span><span class="op" id="5194134">]</span><span class="op" id="5194135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194139">if</span>&nbsp;<span class="op" id="5194142">!</span><span class="ident" id="5194143">unicode</span><span class="op" id="5194150">.</span><span class="ident" id="5194151">IsLetter</span><span class="op" id="5194159">(</span><span class="builtintype" id="5194160">rune</span><span class="op" id="5194164">)</span>&nbsp;<span class="op" id="5194166">&amp;&amp;</span>&nbsp;<span class="op" id="5194169">!</span><span class="ident" id="5194170">unicode</span><span class="op" id="5194177">.</span><span class="ident" id="5194178">IsDigit</span><span class="op" id="5194185">(</span><span class="builtintype" id="5194186">rune</span><span class="op" id="5194190">)</span>&nbsp;<span class="op" id="5194192">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5194195">rune</span>&nbsp;<span class="op" id="5194200">!=</span>&nbsp;<span class="string" id="5194203">&#39;_&#39;</span>&nbsp;<span class="op" id="5194207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194212">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194224">i</span>&nbsp;<span class="op" id="5194226">+=</span>&nbsp;<span class="ident" id="5194229">size</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194238">if</span>&nbsp;<span class="ident" id="5194241">i</span>&nbsp;<span class="op" id="5194243">==</span>&nbsp;<span class="num" id="5194246">0</span>&nbsp;<span class="op" id="5194248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5194252">//&nbsp;empty&nbsp;name&nbsp;is&nbsp;not&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194280">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194288">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194291">name</span>&nbsp;<span class="op" id="5194296">=</span>&nbsp;<span class="ident" id="5194298">str</span><span class="op" id="5194301">[</span><span class="op" id="5194302">:</span><span class="ident" id="5194303">i</span><span class="op" id="5194304">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194307">if</span>&nbsp;<span class="ident" id="5194310">brace</span>&nbsp;<span class="op" id="5194316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194320">if</span>&nbsp;<span class="ident" id="5194323">i</span>&nbsp;<span class="op" id="5194325">&gt;=</span>&nbsp;<span class="builtinfunc" id="5194328">len</span><span class="op" id="5194331">(</span><span class="ident" id="5194332">str</span><span class="op" id="5194335">)</span>&nbsp;<span class="op" id="5194337">||</span>&nbsp;<span class="ident" id="5194340">str</span><span class="op" id="5194343">[</span><span class="ident" id="5194344">i</span><span class="op" id="5194345">]</span>&nbsp;<span class="op" id="5194347">!=</span>&nbsp;<span class="string" id="5194350">&#39;}&#39;</span>&nbsp;<span class="op" id="5194354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5194359">//&nbsp;missing&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194387">return</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194400">i</span><span class="op" id="5194401">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5194409">//&nbsp;Parse&nbsp;number.</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194427">num</span>&nbsp;<span class="op" id="5194431">=</span>&nbsp;<span class="num" id="5194433">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194436">for</span>&nbsp;<span class="ident" id="5194440">i</span>&nbsp;<span class="op" id="5194442">:=</span>&nbsp;<span class="num" id="5194445">0</span><span class="op" id="5194446">;</span>&nbsp;<span class="ident" id="5194448">i</span>&nbsp;<span class="op" id="5194450">&lt;</span>&nbsp;<span class="builtinfunc" id="5194452">len</span><span class="op" id="5194455">(</span><span class="ident" id="5194456">name</span><span class="op" id="5194460">)</span><span class="op" id="5194461">;</span>&nbsp;<span class="ident" id="5194463">i</span><span class="op" id="5194464">++</span>&nbsp;<span class="op" id="5194467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194471">if</span>&nbsp;<span class="ident" id="5194474">name</span><span class="op" id="5194478">[</span><span class="ident" id="5194479">i</span><span class="op" id="5194480">]</span>&nbsp;<span class="op" id="5194482">&lt;</span>&nbsp;<span class="string" id="5194484">&#39;0&#39;</span>&nbsp;<span class="op" id="5194488">||</span>&nbsp;<span class="string" id="5194491">&#39;9&#39;</span>&nbsp;<span class="op" id="5194495">&lt;</span>&nbsp;<span class="ident" id="5194497">name</span><span class="op" id="5194501">[</span><span class="ident" id="5194502">i</span><span class="op" id="5194503">]</span>&nbsp;<span class="op" id="5194505">||</span>&nbsp;<span class="ident" id="5194508">num</span>&nbsp;<span class="op" id="5194512">&gt;=</span>&nbsp;<span class="num" id="5194515">1e8</span>&nbsp;<span class="op" id="5194519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194524">num</span>&nbsp;<span class="op" id="5194528">=</span>&nbsp;<span class="op" id="5194530">-</span><span class="num" id="5194531">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194536">break</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194548">num</span>&nbsp;<span class="op" id="5194552">=</span>&nbsp;<span class="ident" id="5194554">num</span><span class="op" id="5194557">*</span><span class="num" id="5194558">10</span>&nbsp;<span class="op" id="5194561">+</span>&nbsp;<span class="builtintype" id="5194563">int</span><span class="op" id="5194566">(</span><span class="ident" id="5194567">name</span><span class="op" id="5194571">[</span><span class="ident" id="5194572">i</span><span class="op" id="5194573">]</span><span class="op" id="5194574">)</span>&nbsp;<span class="op" id="5194576">-</span>&nbsp;<span class="string" id="5194578">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5194586">//&nbsp;Disallow&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194614">if</span>&nbsp;<span class="ident" id="5194617">name</span><span class="op" id="5194621">[</span><span class="num" id="5194622">0</span><span class="op" id="5194623">]</span>&nbsp;<span class="op" id="5194625">==</span>&nbsp;<span class="string" id="5194628">&#39;0&#39;</span>&nbsp;<span class="op" id="5194632">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5194635">len</span><span class="op" id="5194638">(</span><span class="ident" id="5194639">name</span><span class="op" id="5194643">)</span>&nbsp;<span class="op" id="5194645">&gt;</span>&nbsp;<span class="num" id="5194647">1</span>&nbsp;<span class="op" id="5194649">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194653">num</span>&nbsp;<span class="op" id="5194657">=</span>&nbsp;<span class="op" id="5194659">-</span><span class="num" id="5194660">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5194663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194667">rest</span>&nbsp;<span class="op" id="5194672">=</span>&nbsp;<span class="ident" id="5194674">str</span><span class="op" id="5194677">[</span><span class="ident" id="5194678">i</span><span class="op" id="5194679">:</span><span class="op" id="5194680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5194683">ok</span>&nbsp;<span class="op" id="5194686">=</span>&nbsp;<span class="builtintype" id="5194688">true</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5194694">return</span><br>
<span class="lineno"></span><span class="op" id="5194701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5194704">//&nbsp;FindSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs&nbsp;identifying&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5194781">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno">870</span><span class="comment" id="5194858">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions</span><br>
<span class="lineno"></span><span class="comment" id="5194935">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5194962">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5195007">func</span>&nbsp;<span class="op" id="5195012">(</span><span class="ident" id="5195013">re</span>&nbsp;<span class="op" id="5195016">*</span><span class="ident" id="5195017">Regexp</span><span class="op" id="5195023">)</span>&nbsp;<span class="ident" id="5195025">FindSubmatchIndex</span><span class="op" id="5195042">(</span><span class="ident" id="5195043">b</span>&nbsp;<span class="op" id="5195045">[</span><span class="op" id="5195046">]</span><span class="builtintype" id="5195047">byte</span><span class="op" id="5195051">)</span>&nbsp;<span class="op" id="5195053">[</span><span class="op" id="5195054">]</span><span class="builtintype" id="5195055">int</span>&nbsp;<span class="op" id="5195059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195062">return</span>&nbsp;<span class="ident" id="5195069">re</span><span class="op" id="5195071">.</span><span class="ident" id="5195072">pad</span><span class="op" id="5195075">(</span><span class="ident" id="5195076">re</span><span class="op" id="5195078">.</span><span class="ident" id="5195079">doExecute</span><span class="op" id="5195088">(</span><span class="builtintype" id="5195089">nil</span><span class="op" id="5195092">,</span>&nbsp;<span class="ident" id="5195094">b</span><span class="op" id="5195095">,</span>&nbsp;<span class="string" id="5195097">&#34;&#34;</span><span class="op" id="5195099">,</span>&nbsp;<span class="num" id="5195101">0</span><span class="op" id="5195102">,</span>&nbsp;<span class="ident" id="5195104">re</span><span class="op" id="5195106">.</span><span class="ident" id="5195107">prog</span><span class="op" id="5195111">.</span><span class="ident" id="5195112">NumCap</span><span class="op" id="5195118">)</span><span class="op" id="5195119">)</span><br>
<span class="lineno">875</span><span class="op" id="5195121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5195124">//&nbsp;FindStringSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;strings&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5195197">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5195274">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno">880</span><span class="comment" id="5195345">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5195365">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5195410">func</span>&nbsp;<span class="op" id="5195415">(</span><span class="ident" id="5195416">re</span>&nbsp;<span class="op" id="5195419">*</span><span class="ident" id="5195420">Regexp</span><span class="op" id="5195426">)</span>&nbsp;<span class="ident" id="5195428">FindStringSubmatch</span><span class="op" id="5195446">(</span><span class="ident" id="5195447">s</span>&nbsp;<span class="builtintype" id="5195449">string</span><span class="op" id="5195455">)</span>&nbsp;<span class="op" id="5195457">[</span><span class="op" id="5195458">]</span><span class="builtintype" id="5195459">string</span>&nbsp;<span class="op" id="5195466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195469">a</span>&nbsp;<span class="op" id="5195471">:=</span>&nbsp;<span class="ident" id="5195474">re</span><span class="op" id="5195476">.</span><span class="ident" id="5195477">doExecute</span><span class="op" id="5195486">(</span><span class="builtintype" id="5195487">nil</span><span class="op" id="5195490">,</span>&nbsp;<span class="builtintype" id="5195492">nil</span><span class="op" id="5195495">,</span>&nbsp;<span class="ident" id="5195497">s</span><span class="op" id="5195498">,</span>&nbsp;<span class="num" id="5195500">0</span><span class="op" id="5195501">,</span>&nbsp;<span class="ident" id="5195503">re</span><span class="op" id="5195505">.</span><span class="ident" id="5195506">prog</span><span class="op" id="5195510">.</span><span class="ident" id="5195511">NumCap</span><span class="op" id="5195517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195520">if</span>&nbsp;<span class="ident" id="5195523">a</span>&nbsp;<span class="op" id="5195525">==</span>&nbsp;<span class="builtintype" id="5195528">nil</span>&nbsp;<span class="op" id="5195532">{</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195536">return</span>&nbsp;<span class="builtintype" id="5195543">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195551">ret</span>&nbsp;<span class="op" id="5195555">:=</span>&nbsp;<span class="builtinfunc" id="5195558">make</span><span class="op" id="5195562">(</span><span class="op" id="5195563">[</span><span class="op" id="5195564">]</span><span class="builtintype" id="5195565">string</span><span class="op" id="5195571">,</span>&nbsp;<span class="num" id="5195573">1</span><span class="op" id="5195574">+</span><span class="ident" id="5195575">re</span><span class="op" id="5195577">.</span><span class="ident" id="5195578">numSubexp</span><span class="op" id="5195587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195590">for</span>&nbsp;<span class="ident" id="5195594">i</span>&nbsp;<span class="op" id="5195596">:=</span>&nbsp;<span class="keyword" id="5195599">range</span>&nbsp;<span class="ident" id="5195605">ret</span>&nbsp;<span class="op" id="5195609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195613">if</span>&nbsp;<span class="num" id="5195616">2</span><span class="op" id="5195617">*</span><span class="ident" id="5195618">i</span>&nbsp;<span class="op" id="5195620">&lt;</span>&nbsp;<span class="builtinfunc" id="5195622">len</span><span class="op" id="5195625">(</span><span class="ident" id="5195626">a</span><span class="op" id="5195627">)</span>&nbsp;<span class="op" id="5195629">&amp;&amp;</span>&nbsp;<span class="ident" id="5195632">a</span><span class="op" id="5195633">[</span><span class="num" id="5195634">2</span><span class="op" id="5195635">*</span><span class="ident" id="5195636">i</span><span class="op" id="5195637">]</span>&nbsp;<span class="op" id="5195639">&gt;=</span>&nbsp;<span class="num" id="5195642">0</span>&nbsp;<span class="op" id="5195644">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5195649">ret</span><span class="op" id="5195652">[</span><span class="ident" id="5195653">i</span><span class="op" id="5195654">]</span>&nbsp;<span class="op" id="5195656">=</span>&nbsp;<span class="ident" id="5195658">s</span><span class="op" id="5195659">[</span><span class="ident" id="5195660">a</span><span class="op" id="5195661">[</span><span class="num" id="5195662">2</span><span class="op" id="5195663">*</span><span class="ident" id="5195664">i</span><span class="op" id="5195665">]</span><span class="op" id="5195666">:</span><span class="ident" id="5195667">a</span><span class="op" id="5195668">[</span><span class="num" id="5195669">2</span><span class="op" id="5195670">*</span><span class="ident" id="5195671">i</span><span class="op" id="5195672">+</span><span class="num" id="5195673">1</span><span class="op" id="5195674">]</span><span class="op" id="5195675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5195682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5195685">return</span>&nbsp;<span class="ident" id="5195692">ret</span><br>
<span class="lineno"></span><span class="op" id="5195696">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="comment" id="5195699">//&nbsp;FindStringSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="5195766">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5195839">//&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5195915">//&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">900</span><span class="comment" id="5195963">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5196008">func</span>&nbsp;<span class="op" id="5196013">(</span><span class="ident" id="5196014">re</span>&nbsp;<span class="op" id="5196017">*</span><span class="ident" id="5196018">Regexp</span><span class="op" id="5196024">)</span>&nbsp;<span class="ident" id="5196026">FindStringSubmatchIndex</span><span class="op" id="5196049">(</span><span class="ident" id="5196050">s</span>&nbsp;<span class="builtintype" id="5196052">string</span><span class="op" id="5196058">)</span>&nbsp;<span class="op" id="5196060">[</span><span class="op" id="5196061">]</span><span class="builtintype" id="5196062">int</span>&nbsp;<span class="op" id="5196066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196069">return</span>&nbsp;<span class="ident" id="5196076">re</span><span class="op" id="5196078">.</span><span class="ident" id="5196079">pad</span><span class="op" id="5196082">(</span><span class="ident" id="5196083">re</span><span class="op" id="5196085">.</span><span class="ident" id="5196086">doExecute</span><span class="op" id="5196095">(</span><span class="builtintype" id="5196096">nil</span><span class="op" id="5196099">,</span>&nbsp;<span class="builtintype" id="5196101">nil</span><span class="op" id="5196104">,</span>&nbsp;<span class="ident" id="5196106">s</span><span class="op" id="5196107">,</span>&nbsp;<span class="num" id="5196109">0</span><span class="op" id="5196110">,</span>&nbsp;<span class="ident" id="5196112">re</span><span class="op" id="5196114">.</span><span class="ident" id="5196115">prog</span><span class="op" id="5196119">.</span><span class="ident" id="5196120">NumCap</span><span class="op" id="5196126">)</span><span class="op" id="5196127">)</span><br>
<span class="lineno"></span><span class="op" id="5196129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="comment" id="5196132">//&nbsp;FindReaderSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="5196199">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;of&nbsp;text&nbsp;read&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5196275">//&nbsp;the&nbsp;RuneReader,&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="5196353">//&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.&nbsp;&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="5196426">//&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">910</span><span class="keyword" id="5196469">func</span>&nbsp;<span class="op" id="5196474">(</span><span class="ident" id="5196475">re</span>&nbsp;<span class="op" id="5196478">*</span><span class="ident" id="5196479">Regexp</span><span class="op" id="5196485">)</span>&nbsp;<span class="ident" id="5196487">FindReaderSubmatchIndex</span><span class="op" id="5196510">(</span><span class="ident" id="5196511">r</span>&nbsp;<span class="ident" id="5196513">io</span><span class="op" id="5196515">.</span><span class="ident" id="5196516">RuneReader</span><span class="op" id="5196526">)</span>&nbsp;<span class="op" id="5196528">[</span><span class="op" id="5196529">]</span><span class="builtintype" id="5196530">int</span>&nbsp;<span class="op" id="5196534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196537">return</span>&nbsp;<span class="ident" id="5196544">re</span><span class="op" id="5196546">.</span><span class="ident" id="5196547">pad</span><span class="op" id="5196550">(</span><span class="ident" id="5196551">re</span><span class="op" id="5196553">.</span><span class="ident" id="5196554">doExecute</span><span class="op" id="5196563">(</span><span class="ident" id="5196564">r</span><span class="op" id="5196565">,</span>&nbsp;<span class="builtintype" id="5196567">nil</span><span class="op" id="5196570">,</span>&nbsp;<span class="string" id="5196572">&#34;&#34;</span><span class="op" id="5196574">,</span>&nbsp;<span class="num" id="5196576">0</span><span class="op" id="5196577">,</span>&nbsp;<span class="ident" id="5196579">re</span><span class="op" id="5196581">.</span><span class="ident" id="5196582">prog</span><span class="op" id="5196586">.</span><span class="ident" id="5196587">NumCap</span><span class="op" id="5196593">)</span><span class="op" id="5196594">)</span><br>
<span class="lineno"></span><span class="op" id="5196596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5196599">const</span>&nbsp;<span class="ident" id="5196605">startSize</span>&nbsp;<span class="op" id="5196615">=</span>&nbsp;<span class="num" id="5196617">10</span>&nbsp;<span class="comment" id="5196620">//&nbsp;The&nbsp;size&nbsp;at&nbsp;which&nbsp;to&nbsp;start&nbsp;a&nbsp;slice&nbsp;in&nbsp;the&nbsp;&#39;All&#39;&nbsp;routines.</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="5196682">//&nbsp;FindAll&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;Find;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="5196760">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5196833">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5196853">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">920</span><span class="keyword" id="5196898">func</span>&nbsp;<span class="op" id="5196903">(</span><span class="ident" id="5196904">re</span>&nbsp;<span class="op" id="5196907">*</span><span class="ident" id="5196908">Regexp</span><span class="op" id="5196914">)</span>&nbsp;<span class="ident" id="5196916">FindAll</span><span class="op" id="5196923">(</span><span class="ident" id="5196924">b</span>&nbsp;<span class="op" id="5196926">[</span><span class="op" id="5196927">]</span><span class="builtintype" id="5196928">byte</span><span class="op" id="5196932">,</span>&nbsp;<span class="ident" id="5196934">n</span>&nbsp;<span class="builtintype" id="5196936">int</span><span class="op" id="5196939">)</span>&nbsp;<span class="op" id="5196941">[</span><span class="op" id="5196942">]</span><span class="op" id="5196943">[</span><span class="op" id="5196944">]</span><span class="builtintype" id="5196945">byte</span>&nbsp;<span class="op" id="5196950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5196953">if</span>&nbsp;<span class="ident" id="5196956">n</span>&nbsp;<span class="op" id="5196958">&lt;</span>&nbsp;<span class="num" id="5196960">0</span>&nbsp;<span class="op" id="5196962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196966">n</span>&nbsp;<span class="op" id="5196968">=</span>&nbsp;<span class="builtinfunc" id="5196970">len</span><span class="op" id="5196973">(</span><span class="ident" id="5196974">b</span><span class="op" id="5196975">)</span>&nbsp;<span class="op" id="5196977">+</span>&nbsp;<span class="num" id="5196979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5196982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5196985">result</span>&nbsp;<span class="op" id="5196992">:=</span>&nbsp;<span class="builtinfunc" id="5196995">make</span><span class="op" id="5196999">(</span><span class="op" id="5197000">[</span><span class="op" id="5197001">]</span><span class="op" id="5197002">[</span><span class="op" id="5197003">]</span><span class="builtintype" id="5197004">byte</span><span class="op" id="5197008">,</span>&nbsp;<span class="num" id="5197010">0</span><span class="op" id="5197011">,</span>&nbsp;<span class="ident" id="5197013">startSize</span><span class="op" id="5197022">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197025">re</span><span class="op" id="5197027">.</span><span class="ident" id="5197028">allMatches</span><span class="op" id="5197038">(</span><span class="string" id="5197039">&#34;&#34;</span><span class="op" id="5197041">,</span>&nbsp;<span class="ident" id="5197043">b</span><span class="op" id="5197044">,</span>&nbsp;<span class="ident" id="5197046">n</span><span class="op" id="5197047">,</span>&nbsp;<span class="keyword" id="5197049">func</span><span class="op" id="5197053">(</span><span class="ident" id="5197054">match</span>&nbsp;<span class="op" id="5197060">[</span><span class="op" id="5197061">]</span><span class="builtintype" id="5197062">int</span><span class="op" id="5197065">)</span>&nbsp;<span class="op" id="5197067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197071">result</span>&nbsp;<span class="op" id="5197078">=</span>&nbsp;<span class="builtinfunc" id="5197080">append</span><span class="op" id="5197086">(</span><span class="ident" id="5197087">result</span><span class="op" id="5197093">,</span>&nbsp;<span class="ident" id="5197095">b</span><span class="op" id="5197096">[</span><span class="ident" id="5197097">match</span><span class="op" id="5197102">[</span><span class="num" id="5197103">0</span><span class="op" id="5197104">]</span><span class="op" id="5197105">:</span><span class="ident" id="5197106">match</span><span class="op" id="5197111">[</span><span class="num" id="5197112">1</span><span class="op" id="5197113">]</span><span class="op" id="5197114">]</span><span class="op" id="5197115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5197118">}</span><span class="op" id="5197119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197122">if</span>&nbsp;<span class="builtinfunc" id="5197125">len</span><span class="op" id="5197128">(</span><span class="ident" id="5197129">result</span><span class="op" id="5197135">)</span>&nbsp;<span class="op" id="5197137">==</span>&nbsp;<span class="num" id="5197140">0</span>&nbsp;<span class="op" id="5197142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197146">return</span>&nbsp;<span class="builtintype" id="5197153">nil</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5197158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197161">return</span>&nbsp;<span class="ident" id="5197168">result</span><br>
<span class="lineno"></span><span class="op" id="5197175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5197178">//&nbsp;FindAllIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno">935</span><span class="comment" id="5197255">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="5197332">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5197359">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5197404">func</span>&nbsp;<span class="op" id="5197409">(</span><span class="ident" id="5197410">re</span>&nbsp;<span class="op" id="5197413">*</span><span class="ident" id="5197414">Regexp</span><span class="op" id="5197420">)</span>&nbsp;<span class="ident" id="5197422">FindAllIndex</span><span class="op" id="5197434">(</span><span class="ident" id="5197435">b</span>&nbsp;<span class="op" id="5197437">[</span><span class="op" id="5197438">]</span><span class="builtintype" id="5197439">byte</span><span class="op" id="5197443">,</span>&nbsp;<span class="ident" id="5197445">n</span>&nbsp;<span class="builtintype" id="5197447">int</span><span class="op" id="5197450">)</span>&nbsp;<span class="op" id="5197452">[</span><span class="op" id="5197453">]</span><span class="op" id="5197454">[</span><span class="op" id="5197455">]</span><span class="builtintype" id="5197456">int</span>&nbsp;<span class="op" id="5197460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197463">if</span>&nbsp;<span class="ident" id="5197466">n</span>&nbsp;<span class="op" id="5197468">&lt;</span>&nbsp;<span class="num" id="5197470">0</span>&nbsp;<span class="op" id="5197472">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197476">n</span>&nbsp;<span class="op" id="5197478">=</span>&nbsp;<span class="builtinfunc" id="5197480">len</span><span class="op" id="5197483">(</span><span class="ident" id="5197484">b</span><span class="op" id="5197485">)</span>&nbsp;<span class="op" id="5197487">+</span>&nbsp;<span class="num" id="5197489">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5197492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197495">result</span>&nbsp;<span class="op" id="5197502">:=</span>&nbsp;<span class="builtinfunc" id="5197505">make</span><span class="op" id="5197509">(</span><span class="op" id="5197510">[</span><span class="op" id="5197511">]</span><span class="op" id="5197512">[</span><span class="op" id="5197513">]</span><span class="builtintype" id="5197514">int</span><span class="op" id="5197517">,</span>&nbsp;<span class="num" id="5197519">0</span><span class="op" id="5197520">,</span>&nbsp;<span class="ident" id="5197522">startSize</span><span class="op" id="5197531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197534">re</span><span class="op" id="5197536">.</span><span class="ident" id="5197537">allMatches</span><span class="op" id="5197547">(</span><span class="string" id="5197548">&#34;&#34;</span><span class="op" id="5197550">,</span>&nbsp;<span class="ident" id="5197552">b</span><span class="op" id="5197553">,</span>&nbsp;<span class="ident" id="5197555">n</span><span class="op" id="5197556">,</span>&nbsp;<span class="keyword" id="5197558">func</span><span class="op" id="5197562">(</span><span class="ident" id="5197563">match</span>&nbsp;<span class="op" id="5197569">[</span><span class="op" id="5197570">]</span><span class="builtintype" id="5197571">int</span><span class="op" id="5197574">)</span>&nbsp;<span class="op" id="5197576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197580">result</span>&nbsp;<span class="op" id="5197587">=</span>&nbsp;<span class="builtinfunc" id="5197589">append</span><span class="op" id="5197595">(</span><span class="ident" id="5197596">result</span><span class="op" id="5197602">,</span>&nbsp;<span class="ident" id="5197604">match</span><span class="op" id="5197609">[</span><span class="num" id="5197610">0</span><span class="op" id="5197611">:</span><span class="num" id="5197612">2</span><span class="op" id="5197613">]</span><span class="op" id="5197614">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5197617">}</span><span class="op" id="5197618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197621">if</span>&nbsp;<span class="builtinfunc" id="5197624">len</span><span class="op" id="5197627">(</span><span class="ident" id="5197628">result</span><span class="op" id="5197634">)</span>&nbsp;<span class="op" id="5197636">==</span>&nbsp;<span class="num" id="5197639">0</span>&nbsp;<span class="op" id="5197641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197645">return</span>&nbsp;<span class="builtintype" id="5197652">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5197657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197660">return</span>&nbsp;<span class="ident" id="5197667">result</span><br>
<span class="lineno">950</span><span class="op" id="5197674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5197677">//&nbsp;FindAllString&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindString;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5197756">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="5197833">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">955</span><span class="comment" id="5197860">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5197905">func</span>&nbsp;<span class="op" id="5197910">(</span><span class="ident" id="5197911">re</span>&nbsp;<span class="op" id="5197914">*</span><span class="ident" id="5197915">Regexp</span><span class="op" id="5197921">)</span>&nbsp;<span class="ident" id="5197923">FindAllString</span><span class="op" id="5197936">(</span><span class="ident" id="5197937">s</span>&nbsp;<span class="builtintype" id="5197939">string</span><span class="op" id="5197945">,</span>&nbsp;<span class="ident" id="5197947">n</span>&nbsp;<span class="builtintype" id="5197949">int</span><span class="op" id="5197952">)</span>&nbsp;<span class="op" id="5197954">[</span><span class="op" id="5197955">]</span><span class="builtintype" id="5197956">string</span>&nbsp;<span class="op" id="5197963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5197966">if</span>&nbsp;<span class="ident" id="5197969">n</span>&nbsp;<span class="op" id="5197971">&lt;</span>&nbsp;<span class="num" id="5197973">0</span>&nbsp;<span class="op" id="5197975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197979">n</span>&nbsp;<span class="op" id="5197981">=</span>&nbsp;<span class="builtinfunc" id="5197983">len</span><span class="op" id="5197986">(</span><span class="ident" id="5197987">s</span><span class="op" id="5197988">)</span>&nbsp;<span class="op" id="5197990">+</span>&nbsp;<span class="num" id="5197992">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5197995">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5197998">result</span>&nbsp;<span class="op" id="5198005">:=</span>&nbsp;<span class="builtinfunc" id="5198008">make</span><span class="op" id="5198012">(</span><span class="op" id="5198013">[</span><span class="op" id="5198014">]</span><span class="builtintype" id="5198015">string</span><span class="op" id="5198021">,</span>&nbsp;<span class="num" id="5198023">0</span><span class="op" id="5198024">,</span>&nbsp;<span class="ident" id="5198026">startSize</span><span class="op" id="5198035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198038">re</span><span class="op" id="5198040">.</span><span class="ident" id="5198041">allMatches</span><span class="op" id="5198051">(</span><span class="ident" id="5198052">s</span><span class="op" id="5198053">,</span>&nbsp;<span class="builtintype" id="5198055">nil</span><span class="op" id="5198058">,</span>&nbsp;<span class="ident" id="5198060">n</span><span class="op" id="5198061">,</span>&nbsp;<span class="keyword" id="5198063">func</span><span class="op" id="5198067">(</span><span class="ident" id="5198068">match</span>&nbsp;<span class="op" id="5198074">[</span><span class="op" id="5198075">]</span><span class="builtintype" id="5198076">int</span><span class="op" id="5198079">)</span>&nbsp;<span class="op" id="5198081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198085">result</span>&nbsp;<span class="op" id="5198092">=</span>&nbsp;<span class="builtinfunc" id="5198094">append</span><span class="op" id="5198100">(</span><span class="ident" id="5198101">result</span><span class="op" id="5198107">,</span>&nbsp;<span class="ident" id="5198109">s</span><span class="op" id="5198110">[</span><span class="ident" id="5198111">match</span><span class="op" id="5198116">[</span><span class="num" id="5198117">0</span><span class="op" id="5198118">]</span><span class="op" id="5198119">:</span><span class="ident" id="5198120">match</span><span class="op" id="5198125">[</span><span class="num" id="5198126">1</span><span class="op" id="5198127">]</span><span class="op" id="5198128">]</span><span class="op" id="5198129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5198132">}</span><span class="op" id="5198133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198136">if</span>&nbsp;<span class="builtinfunc" id="5198139">len</span><span class="op" id="5198142">(</span><span class="ident" id="5198143">result</span><span class="op" id="5198149">)</span>&nbsp;<span class="op" id="5198151">==</span>&nbsp;<span class="num" id="5198154">0</span>&nbsp;<span class="op" id="5198156">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198160">return</span>&nbsp;<span class="builtintype" id="5198167">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5198172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198175">return</span>&nbsp;<span class="ident" id="5198182">result</span><br>
<span class="lineno"></span><span class="op" id="5198189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="comment" id="5198192">//&nbsp;FindAllStringIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringIndex;&nbsp;it&nbsp;returns&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5198268">//&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno"></span><span class="comment" id="5198346">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5198385">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5198430">func</span>&nbsp;<span class="op" id="5198435">(</span><span class="ident" id="5198436">re</span>&nbsp;<span class="op" id="5198439">*</span><span class="ident" id="5198440">Regexp</span><span class="op" id="5198446">)</span>&nbsp;<span class="ident" id="5198448">FindAllStringIndex</span><span class="op" id="5198466">(</span><span class="ident" id="5198467">s</span>&nbsp;<span class="builtintype" id="5198469">string</span><span class="op" id="5198475">,</span>&nbsp;<span class="ident" id="5198477">n</span>&nbsp;<span class="builtintype" id="5198479">int</span><span class="op" id="5198482">)</span>&nbsp;<span class="op" id="5198484">[</span><span class="op" id="5198485">]</span><span class="op" id="5198486">[</span><span class="op" id="5198487">]</span><span class="builtintype" id="5198488">int</span>&nbsp;<span class="op" id="5198492">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198495">if</span>&nbsp;<span class="ident" id="5198498">n</span>&nbsp;<span class="op" id="5198500">&lt;</span>&nbsp;<span class="num" id="5198502">0</span>&nbsp;<span class="op" id="5198504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198508">n</span>&nbsp;<span class="op" id="5198510">=</span>&nbsp;<span class="builtinfunc" id="5198512">len</span><span class="op" id="5198515">(</span><span class="ident" id="5198516">s</span><span class="op" id="5198517">)</span>&nbsp;<span class="op" id="5198519">+</span>&nbsp;<span class="num" id="5198521">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5198524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198527">result</span>&nbsp;<span class="op" id="5198534">:=</span>&nbsp;<span class="builtinfunc" id="5198537">make</span><span class="op" id="5198541">(</span><span class="op" id="5198542">[</span><span class="op" id="5198543">]</span><span class="op" id="5198544">[</span><span class="op" id="5198545">]</span><span class="builtintype" id="5198546">int</span><span class="op" id="5198549">,</span>&nbsp;<span class="num" id="5198551">0</span><span class="op" id="5198552">,</span>&nbsp;<span class="ident" id="5198554">startSize</span><span class="op" id="5198563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198566">re</span><span class="op" id="5198568">.</span><span class="ident" id="5198569">allMatches</span><span class="op" id="5198579">(</span><span class="ident" id="5198580">s</span><span class="op" id="5198581">,</span>&nbsp;<span class="builtintype" id="5198583">nil</span><span class="op" id="5198586">,</span>&nbsp;<span class="ident" id="5198588">n</span><span class="op" id="5198589">,</span>&nbsp;<span class="keyword" id="5198591">func</span><span class="op" id="5198595">(</span><span class="ident" id="5198596">match</span>&nbsp;<span class="op" id="5198602">[</span><span class="op" id="5198603">]</span><span class="builtintype" id="5198604">int</span><span class="op" id="5198607">)</span>&nbsp;<span class="op" id="5198609">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5198613">result</span>&nbsp;<span class="op" id="5198620">=</span>&nbsp;<span class="builtinfunc" id="5198622">append</span><span class="op" id="5198628">(</span><span class="ident" id="5198629">result</span><span class="op" id="5198635">,</span>&nbsp;<span class="ident" id="5198637">match</span><span class="op" id="5198642">[</span><span class="num" id="5198643">0</span><span class="op" id="5198644">:</span><span class="num" id="5198645">2</span><span class="op" id="5198646">]</span><span class="op" id="5198647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5198650">}</span><span class="op" id="5198651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198654">if</span>&nbsp;<span class="builtinfunc" id="5198657">len</span><span class="op" id="5198660">(</span><span class="ident" id="5198661">result</span><span class="op" id="5198667">)</span>&nbsp;<span class="op" id="5198669">==</span>&nbsp;<span class="num" id="5198672">0</span>&nbsp;<span class="op" id="5198674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198678">return</span>&nbsp;<span class="builtintype" id="5198685">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5198690">}</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5198693">return</span>&nbsp;<span class="ident" id="5198700">result</span><br>
<span class="lineno"></span><span class="op" id="5198707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5198710">//&nbsp;FindAllSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatch;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="5198786">//&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno">990</span><span class="comment" id="5198858">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5198897">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5198942">func</span>&nbsp;<span class="op" id="5198947">(</span><span class="ident" id="5198948">re</span>&nbsp;<span class="op" id="5198951">*</span><span class="ident" id="5198952">Regexp</span><span class="op" id="5198958">)</span>&nbsp;<span class="ident" id="5198960">FindAllSubmatch</span><span class="op" id="5198975">(</span><span class="ident" id="5198976">b</span>&nbsp;<span class="op" id="5198978">[</span><span class="op" id="5198979">]</span><span class="builtintype" id="5198980">byte</span><span class="op" id="5198984">,</span>&nbsp;<span class="ident" id="5198986">n</span>&nbsp;<span class="builtintype" id="5198988">int</span><span class="op" id="5198991">)</span>&nbsp;<span class="op" id="5198993">[</span><span class="op" id="5198994">]</span><span class="op" id="5198995">[</span><span class="op" id="5198996">]</span><span class="op" id="5198997">[</span><span class="op" id="5198998">]</span><span class="builtintype" id="5198999">byte</span>&nbsp;<span class="op" id="5199004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199007">if</span>&nbsp;<span class="ident" id="5199010">n</span>&nbsp;<span class="op" id="5199012">&lt;</span>&nbsp;<span class="num" id="5199014">0</span>&nbsp;<span class="op" id="5199016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199020">n</span>&nbsp;<span class="op" id="5199022">=</span>&nbsp;<span class="builtinfunc" id="5199024">len</span><span class="op" id="5199027">(</span><span class="ident" id="5199028">b</span><span class="op" id="5199029">)</span>&nbsp;<span class="op" id="5199031">+</span>&nbsp;<span class="num" id="5199033">1</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199039">result</span>&nbsp;<span class="op" id="5199046">:=</span>&nbsp;<span class="builtinfunc" id="5199049">make</span><span class="op" id="5199053">(</span><span class="op" id="5199054">[</span><span class="op" id="5199055">]</span><span class="op" id="5199056">[</span><span class="op" id="5199057">]</span><span class="op" id="5199058">[</span><span class="op" id="5199059">]</span><span class="builtintype" id="5199060">byte</span><span class="op" id="5199064">,</span>&nbsp;<span class="num" id="5199066">0</span><span class="op" id="5199067">,</span>&nbsp;<span class="ident" id="5199069">startSize</span><span class="op" id="5199078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199081">re</span><span class="op" id="5199083">.</span><span class="ident" id="5199084">allMatches</span><span class="op" id="5199094">(</span><span class="string" id="5199095">&#34;&#34;</span><span class="op" id="5199097">,</span>&nbsp;<span class="ident" id="5199099">b</span><span class="op" id="5199100">,</span>&nbsp;<span class="ident" id="5199102">n</span><span class="op" id="5199103">,</span>&nbsp;<span class="keyword" id="5199105">func</span><span class="op" id="5199109">(</span><span class="ident" id="5199110">match</span>&nbsp;<span class="op" id="5199116">[</span><span class="op" id="5199117">]</span><span class="builtintype" id="5199118">int</span><span class="op" id="5199121">)</span>&nbsp;<span class="op" id="5199123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199127">slice</span>&nbsp;<span class="op" id="5199133">:=</span>&nbsp;<span class="builtinfunc" id="5199136">make</span><span class="op" id="5199140">(</span><span class="op" id="5199141">[</span><span class="op" id="5199142">]</span><span class="op" id="5199143">[</span><span class="op" id="5199144">]</span><span class="builtintype" id="5199145">byte</span><span class="op" id="5199149">,</span>&nbsp;<span class="builtinfunc" id="5199151">len</span><span class="op" id="5199154">(</span><span class="ident" id="5199155">match</span><span class="op" id="5199160">)</span><span class="op" id="5199161">/</span><span class="num" id="5199162">2</span><span class="op" id="5199163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199167">for</span>&nbsp;<span class="ident" id="5199171">j</span>&nbsp;<span class="op" id="5199173">:=</span>&nbsp;<span class="keyword" id="5199176">range</span>&nbsp;<span class="ident" id="5199182">slice</span>&nbsp;<span class="op" id="5199188">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199193">if</span>&nbsp;<span class="ident" id="5199196">match</span><span class="op" id="5199201">[</span><span class="num" id="5199202">2</span><span class="op" id="5199203">*</span><span class="ident" id="5199204">j</span><span class="op" id="5199205">]</span>&nbsp;<span class="op" id="5199207">&gt;=</span>&nbsp;<span class="num" id="5199210">0</span>&nbsp;<span class="op" id="5199212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199218">slice</span><span class="op" id="5199223">[</span><span class="ident" id="5199224">j</span><span class="op" id="5199225">]</span>&nbsp;<span class="op" id="5199227">=</span>&nbsp;<span class="ident" id="5199229">b</span><span class="op" id="5199230">[</span><span class="ident" id="5199231">match</span><span class="op" id="5199236">[</span><span class="num" id="5199237">2</span><span class="op" id="5199238">*</span><span class="ident" id="5199239">j</span><span class="op" id="5199240">]</span><span class="op" id="5199241">:</span><span class="ident" id="5199242">match</span><span class="op" id="5199247">[</span><span class="num" id="5199248">2</span><span class="op" id="5199249">*</span><span class="ident" id="5199250">j</span><span class="op" id="5199251">+</span><span class="num" id="5199252">1</span><span class="op" id="5199253">]</span><span class="op" id="5199254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199267">result</span>&nbsp;<span class="op" id="5199274">=</span>&nbsp;<span class="builtinfunc" id="5199276">append</span><span class="op" id="5199282">(</span><span class="ident" id="5199283">result</span><span class="op" id="5199289">,</span>&nbsp;<span class="ident" id="5199291">slice</span><span class="op" id="5199296">)</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199299">}</span><span class="op" id="5199300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199303">if</span>&nbsp;<span class="builtinfunc" id="5199306">len</span><span class="op" id="5199309">(</span><span class="ident" id="5199310">result</span><span class="op" id="5199316">)</span>&nbsp;<span class="op" id="5199318">==</span>&nbsp;<span class="num" id="5199321">0</span>&nbsp;<span class="op" id="5199323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199327">return</span>&nbsp;<span class="builtintype" id="5199334">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199342">return</span>&nbsp;<span class="ident" id="5199349">result</span><br>
<span class="lineno">1010</span><span class="op" id="5199356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5199359">//&nbsp;FindAllSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatchIndex;&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="5199437">//&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5199511">//&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">1015</span><span class="comment" id="5199556">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5199601">func</span>&nbsp;<span class="op" id="5199606">(</span><span class="ident" id="5199607">re</span>&nbsp;<span class="op" id="5199610">*</span><span class="ident" id="5199611">Regexp</span><span class="op" id="5199617">)</span>&nbsp;<span class="ident" id="5199619">FindAllSubmatchIndex</span><span class="op" id="5199639">(</span><span class="ident" id="5199640">b</span>&nbsp;<span class="op" id="5199642">[</span><span class="op" id="5199643">]</span><span class="builtintype" id="5199644">byte</span><span class="op" id="5199648">,</span>&nbsp;<span class="ident" id="5199650">n</span>&nbsp;<span class="builtintype" id="5199652">int</span><span class="op" id="5199655">)</span>&nbsp;<span class="op" id="5199657">[</span><span class="op" id="5199658">]</span><span class="op" id="5199659">[</span><span class="op" id="5199660">]</span><span class="builtintype" id="5199661">int</span>&nbsp;<span class="op" id="5199665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199668">if</span>&nbsp;<span class="ident" id="5199671">n</span>&nbsp;<span class="op" id="5199673">&lt;</span>&nbsp;<span class="num" id="5199675">0</span>&nbsp;<span class="op" id="5199677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199681">n</span>&nbsp;<span class="op" id="5199683">=</span>&nbsp;<span class="builtinfunc" id="5199685">len</span><span class="op" id="5199688">(</span><span class="ident" id="5199689">b</span><span class="op" id="5199690">)</span>&nbsp;<span class="op" id="5199692">+</span>&nbsp;<span class="num" id="5199694">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199697">}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199700">result</span>&nbsp;<span class="op" id="5199707">:=</span>&nbsp;<span class="builtinfunc" id="5199710">make</span><span class="op" id="5199714">(</span><span class="op" id="5199715">[</span><span class="op" id="5199716">]</span><span class="op" id="5199717">[</span><span class="op" id="5199718">]</span><span class="builtintype" id="5199719">int</span><span class="op" id="5199722">,</span>&nbsp;<span class="num" id="5199724">0</span><span class="op" id="5199725">,</span>&nbsp;<span class="ident" id="5199727">startSize</span><span class="op" id="5199736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199739">re</span><span class="op" id="5199741">.</span><span class="ident" id="5199742">allMatches</span><span class="op" id="5199752">(</span><span class="string" id="5199753">&#34;&#34;</span><span class="op" id="5199755">,</span>&nbsp;<span class="ident" id="5199757">b</span><span class="op" id="5199758">,</span>&nbsp;<span class="ident" id="5199760">n</span><span class="op" id="5199761">,</span>&nbsp;<span class="keyword" id="5199763">func</span><span class="op" id="5199767">(</span><span class="ident" id="5199768">match</span>&nbsp;<span class="op" id="5199774">[</span><span class="op" id="5199775">]</span><span class="builtintype" id="5199776">int</span><span class="op" id="5199779">)</span>&nbsp;<span class="op" id="5199781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5199785">result</span>&nbsp;<span class="op" id="5199792">=</span>&nbsp;<span class="builtinfunc" id="5199794">append</span><span class="op" id="5199800">(</span><span class="ident" id="5199801">result</span><span class="op" id="5199807">,</span>&nbsp;<span class="ident" id="5199809">match</span><span class="op" id="5199814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199817">}</span><span class="op" id="5199818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199821">if</span>&nbsp;<span class="builtinfunc" id="5199824">len</span><span class="op" id="5199827">(</span><span class="ident" id="5199828">result</span><span class="op" id="5199834">)</span>&nbsp;<span class="op" id="5199836">==</span>&nbsp;<span class="num" id="5199839">0</span>&nbsp;<span class="op" id="5199841">{</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199845">return</span>&nbsp;<span class="builtintype" id="5199852">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5199857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5199860">return</span>&nbsp;<span class="ident" id="5199867">result</span><br>
<span class="lineno"></span><span class="op" id="5199874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1030</span><span class="comment" id="5199877">//&nbsp;FindAllStringSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringSubmatch;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5199949">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5200027">//&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5200076">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5200121">func</span>&nbsp;<span class="op" id="5200126">(</span><span class="ident" id="5200127">re</span>&nbsp;<span class="op" id="5200130">*</span><span class="ident" id="5200131">Regexp</span><span class="op" id="5200137">)</span>&nbsp;<span class="ident" id="5200139">FindAllStringSubmatch</span><span class="op" id="5200160">(</span><span class="ident" id="5200161">s</span>&nbsp;<span class="builtintype" id="5200163">string</span><span class="op" id="5200169">,</span>&nbsp;<span class="ident" id="5200171">n</span>&nbsp;<span class="builtintype" id="5200173">int</span><span class="op" id="5200176">)</span>&nbsp;<span class="op" id="5200178">[</span><span class="op" id="5200179">]</span><span class="op" id="5200180">[</span><span class="op" id="5200181">]</span><span class="builtintype" id="5200182">string</span>&nbsp;<span class="op" id="5200189">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200192">if</span>&nbsp;<span class="ident" id="5200195">n</span>&nbsp;<span class="op" id="5200197">&lt;</span>&nbsp;<span class="num" id="5200199">0</span>&nbsp;<span class="op" id="5200201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200205">n</span>&nbsp;<span class="op" id="5200207">=</span>&nbsp;<span class="builtinfunc" id="5200209">len</span><span class="op" id="5200212">(</span><span class="ident" id="5200213">s</span><span class="op" id="5200214">)</span>&nbsp;<span class="op" id="5200216">+</span>&nbsp;<span class="num" id="5200218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200224">result</span>&nbsp;<span class="op" id="5200231">:=</span>&nbsp;<span class="builtinfunc" id="5200234">make</span><span class="op" id="5200238">(</span><span class="op" id="5200239">[</span><span class="op" id="5200240">]</span><span class="op" id="5200241">[</span><span class="op" id="5200242">]</span><span class="builtintype" id="5200243">string</span><span class="op" id="5200249">,</span>&nbsp;<span class="num" id="5200251">0</span><span class="op" id="5200252">,</span>&nbsp;<span class="ident" id="5200254">startSize</span><span class="op" id="5200263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200266">re</span><span class="op" id="5200268">.</span><span class="ident" id="5200269">allMatches</span><span class="op" id="5200279">(</span><span class="ident" id="5200280">s</span><span class="op" id="5200281">,</span>&nbsp;<span class="builtintype" id="5200283">nil</span><span class="op" id="5200286">,</span>&nbsp;<span class="ident" id="5200288">n</span><span class="op" id="5200289">,</span>&nbsp;<span class="keyword" id="5200291">func</span><span class="op" id="5200295">(</span><span class="ident" id="5200296">match</span>&nbsp;<span class="op" id="5200302">[</span><span class="op" id="5200303">]</span><span class="builtintype" id="5200304">int</span><span class="op" id="5200307">)</span>&nbsp;<span class="op" id="5200309">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200313">slice</span>&nbsp;<span class="op" id="5200319">:=</span>&nbsp;<span class="builtinfunc" id="5200322">make</span><span class="op" id="5200326">(</span><span class="op" id="5200327">[</span><span class="op" id="5200328">]</span><span class="builtintype" id="5200329">string</span><span class="op" id="5200335">,</span>&nbsp;<span class="builtinfunc" id="5200337">len</span><span class="op" id="5200340">(</span><span class="ident" id="5200341">match</span><span class="op" id="5200346">)</span><span class="op" id="5200347">/</span><span class="num" id="5200348">2</span><span class="op" id="5200349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200353">for</span>&nbsp;<span class="ident" id="5200357">j</span>&nbsp;<span class="op" id="5200359">:=</span>&nbsp;<span class="keyword" id="5200362">range</span>&nbsp;<span class="ident" id="5200368">slice</span>&nbsp;<span class="op" id="5200374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200379">if</span>&nbsp;<span class="ident" id="5200382">match</span><span class="op" id="5200387">[</span><span class="num" id="5200388">2</span><span class="op" id="5200389">*</span><span class="ident" id="5200390">j</span><span class="op" id="5200391">]</span>&nbsp;<span class="op" id="5200393">&gt;=</span>&nbsp;<span class="num" id="5200396">0</span>&nbsp;<span class="op" id="5200398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200404">slice</span><span class="op" id="5200409">[</span><span class="ident" id="5200410">j</span><span class="op" id="5200411">]</span>&nbsp;<span class="op" id="5200413">=</span>&nbsp;<span class="ident" id="5200415">s</span><span class="op" id="5200416">[</span><span class="ident" id="5200417">match</span><span class="op" id="5200422">[</span><span class="num" id="5200423">2</span><span class="op" id="5200424">*</span><span class="ident" id="5200425">j</span><span class="op" id="5200426">]</span><span class="op" id="5200427">:</span><span class="ident" id="5200428">match</span><span class="op" id="5200433">[</span><span class="num" id="5200434">2</span><span class="op" id="5200435">*</span><span class="ident" id="5200436">j</span><span class="op" id="5200437">+</span><span class="num" id="5200438">1</span><span class="op" id="5200439">]</span><span class="op" id="5200440">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200445">}</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200453">result</span>&nbsp;<span class="op" id="5200460">=</span>&nbsp;<span class="builtinfunc" id="5200462">append</span><span class="op" id="5200468">(</span><span class="ident" id="5200469">result</span><span class="op" id="5200475">,</span>&nbsp;<span class="ident" id="5200477">slice</span><span class="op" id="5200482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200485">}</span><span class="op" id="5200486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200489">if</span>&nbsp;<span class="builtinfunc" id="5200492">len</span><span class="op" id="5200495">(</span><span class="ident" id="5200496">result</span><span class="op" id="5200502">)</span>&nbsp;<span class="op" id="5200504">==</span>&nbsp;<span class="num" id="5200507">0</span>&nbsp;<span class="op" id="5200509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200513">return</span>&nbsp;<span class="builtintype" id="5200520">nil</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200528">return</span>&nbsp;<span class="ident" id="5200535">result</span><br>
<span class="lineno"></span><span class="op" id="5200542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5200545">//&nbsp;FindAllStringSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of</span><br>
<span class="lineno">1055</span><span class="comment" id="5200599">//&nbsp;FindStringSubmatchIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5200675">//&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5200745">//&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5200757">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="5200802">func</span>&nbsp;<span class="op" id="5200807">(</span><span class="ident" id="5200808">re</span>&nbsp;<span class="op" id="5200811">*</span><span class="ident" id="5200812">Regexp</span><span class="op" id="5200818">)</span>&nbsp;<span class="ident" id="5200820">FindAllStringSubmatchIndex</span><span class="op" id="5200846">(</span><span class="ident" id="5200847">s</span>&nbsp;<span class="builtintype" id="5200849">string</span><span class="op" id="5200855">,</span>&nbsp;<span class="ident" id="5200857">n</span>&nbsp;<span class="builtintype" id="5200859">int</span><span class="op" id="5200862">)</span>&nbsp;<span class="op" id="5200864">[</span><span class="op" id="5200865">]</span><span class="op" id="5200866">[</span><span class="op" id="5200867">]</span><span class="builtintype" id="5200868">int</span>&nbsp;<span class="op" id="5200872">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5200875">if</span>&nbsp;<span class="ident" id="5200878">n</span>&nbsp;<span class="op" id="5200880">&lt;</span>&nbsp;<span class="num" id="5200882">0</span>&nbsp;<span class="op" id="5200884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200888">n</span>&nbsp;<span class="op" id="5200890">=</span>&nbsp;<span class="builtinfunc" id="5200892">len</span><span class="op" id="5200895">(</span><span class="ident" id="5200896">s</span><span class="op" id="5200897">)</span>&nbsp;<span class="op" id="5200899">+</span>&nbsp;<span class="num" id="5200901">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5200904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200907">result</span>&nbsp;<span class="op" id="5200914">:=</span>&nbsp;<span class="builtinfunc" id="5200917">make</span><span class="op" id="5200921">(</span><span class="op" id="5200922">[</span><span class="op" id="5200923">]</span><span class="op" id="5200924">[</span><span class="op" id="5200925">]</span><span class="builtintype" id="5200926">int</span><span class="op" id="5200929">,</span>&nbsp;<span class="num" id="5200931">0</span><span class="op" id="5200932">,</span>&nbsp;<span class="ident" id="5200934">startSize</span><span class="op" id="5200943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200946">re</span><span class="op" id="5200948">.</span><span class="ident" id="5200949">allMatches</span><span class="op" id="5200959">(</span><span class="ident" id="5200960">s</span><span class="op" id="5200961">,</span>&nbsp;<span class="builtintype" id="5200963">nil</span><span class="op" id="5200966">,</span>&nbsp;<span class="ident" id="5200968">n</span><span class="op" id="5200969">,</span>&nbsp;<span class="keyword" id="5200971">func</span><span class="op" id="5200975">(</span><span class="ident" id="5200976">match</span>&nbsp;<span class="op" id="5200982">[</span><span class="op" id="5200983">]</span><span class="builtintype" id="5200984">int</span><span class="op" id="5200987">)</span>&nbsp;<span class="op" id="5200989">{</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5200993">result</span>&nbsp;<span class="op" id="5201000">=</span>&nbsp;<span class="builtinfunc" id="5201002">append</span><span class="op" id="5201008">(</span><span class="ident" id="5201009">result</span><span class="op" id="5201015">,</span>&nbsp;<span class="ident" id="5201017">match</span><span class="op" id="5201022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5201025">}</span><span class="op" id="5201026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201029">if</span>&nbsp;<span class="builtinfunc" id="5201032">len</span><span class="op" id="5201035">(</span><span class="ident" id="5201036">result</span><span class="op" id="5201042">)</span>&nbsp;<span class="op" id="5201044">==</span>&nbsp;<span class="num" id="5201047">0</span>&nbsp;<span class="op" id="5201049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201053">return</span>&nbsp;<span class="builtintype" id="5201060">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5201065">}</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201068">return</span>&nbsp;<span class="ident" id="5201075">result</span><br>
<span class="lineno"></span><span class="op" id="5201082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5201085">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;substrings&nbsp;separated&nbsp;by&nbsp;the&nbsp;expression&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5201170">//&nbsp;the&nbsp;substrings&nbsp;between&nbsp;those&nbsp;expression&nbsp;matches.</span><br>
<span class="lineno">1075</span><span class="comment" id="5201222">//</span><br>
<span class="lineno"></span><span class="comment" id="5201225">//&nbsp;The&nbsp;slice&nbsp;returned&nbsp;by&nbsp;this&nbsp;method&nbsp;consists&nbsp;of&nbsp;all&nbsp;the&nbsp;substrings&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="5201298">//&nbsp;not&nbsp;contained&nbsp;in&nbsp;the&nbsp;slice&nbsp;returned&nbsp;by&nbsp;FindAllString.&nbsp;When&nbsp;called&nbsp;on&nbsp;an&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="5201384">//&nbsp;that&nbsp;contains&nbsp;no&nbsp;metacharacters,&nbsp;it&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;strings.SplitN.</span><br>
<span class="lineno"></span><span class="comment" id="5201456">//</span><br>
<span class="lineno">1080</span><span class="comment" id="5201459">//&nbsp;Example:</span><br>
<span class="lineno"></span><span class="comment" id="5201471">//&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;regexp.MustCompile(&#34;a*&#34;).Split(&#34;abaabaccadaaae&#34;,&nbsp;5)</span><br>
<span class="lineno"></span><span class="comment" id="5201533">//&nbsp;&nbsp;&nbsp;//&nbsp;s:&nbsp;[&#34;&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;c&#34;,&nbsp;&#34;cadaaae&#34;]</span><br>
<span class="lineno"></span><span class="comment" id="5201575">//</span><br>
<span class="lineno"></span><span class="comment" id="5201578">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;substrings&nbsp;to&nbsp;return:</span><br>
<span class="lineno">1085</span><span class="comment" id="5201638">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;substrings;&nbsp;the&nbsp;last&nbsp;substring&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="5201722">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;substrings)</span><br>
<span class="lineno"></span><span class="comment" id="5201771">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;substrings</span><br>
<span class="lineno"></span><span class="keyword" id="5201798">func</span>&nbsp;<span class="op" id="5201803">(</span><span class="ident" id="5201804">re</span>&nbsp;<span class="op" id="5201807">*</span><span class="ident" id="5201808">Regexp</span><span class="op" id="5201814">)</span>&nbsp;<span class="ident" id="5201816">Split</span><span class="op" id="5201821">(</span><span class="ident" id="5201822">s</span>&nbsp;<span class="builtintype" id="5201824">string</span><span class="op" id="5201830">,</span>&nbsp;<span class="ident" id="5201832">n</span>&nbsp;<span class="builtintype" id="5201834">int</span><span class="op" id="5201837">)</span>&nbsp;<span class="op" id="5201839">[</span><span class="op" id="5201840">]</span><span class="builtintype" id="5201841">string</span>&nbsp;<span class="op" id="5201848">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201852">if</span>&nbsp;<span class="ident" id="5201855">n</span>&nbsp;<span class="op" id="5201857">==</span>&nbsp;<span class="num" id="5201860">0</span>&nbsp;<span class="op" id="5201862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201866">return</span>&nbsp;<span class="builtintype" id="5201873">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5201878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201882">if</span>&nbsp;<span class="builtinfunc" id="5201885">len</span><span class="op" id="5201888">(</span><span class="ident" id="5201889">re</span><span class="op" id="5201891">.</span><span class="ident" id="5201892">expr</span><span class="op" id="5201896">)</span>&nbsp;<span class="op" id="5201898">&gt;</span>&nbsp;<span class="num" id="5201900">0</span>&nbsp;<span class="op" id="5201902">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5201905">len</span><span class="op" id="5201908">(</span><span class="ident" id="5201909">s</span><span class="op" id="5201910">)</span>&nbsp;<span class="op" id="5201912">==</span>&nbsp;<span class="num" id="5201915">0</span>&nbsp;<span class="op" id="5201917">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5201921">return</span>&nbsp;<span class="op" id="5201928">[</span><span class="op" id="5201929">]</span><span class="builtintype" id="5201930">string</span><span class="op" id="5201936">{</span><span class="string" id="5201937">&#34;&#34;</span><span class="op" id="5201939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5201942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5201946">matches</span>&nbsp;<span class="op" id="5201954">:=</span>&nbsp;<span class="ident" id="5201957">re</span><span class="op" id="5201959">.</span><span class="ident" id="5201960">FindAllStringIndex</span><span class="op" id="5201978">(</span><span class="ident" id="5201979">s</span><span class="op" id="5201980">,</span>&nbsp;<span class="ident" id="5201982">n</span><span class="op" id="5201983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5201986">strings</span>&nbsp;<span class="op" id="5201994">:=</span>&nbsp;<span class="builtinfunc" id="5201997">make</span><span class="op" id="5202001">(</span><span class="op" id="5202002">[</span><span class="op" id="5202003">]</span><span class="builtintype" id="5202004">string</span><span class="op" id="5202010">,</span>&nbsp;<span class="num" id="5202012">0</span><span class="op" id="5202013">,</span>&nbsp;<span class="builtinfunc" id="5202015">len</span><span class="op" id="5202018">(</span><span class="ident" id="5202019">matches</span><span class="op" id="5202026">)</span><span class="op" id="5202027">)</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202031">beg</span>&nbsp;<span class="op" id="5202035">:=</span>&nbsp;<span class="num" id="5202038">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202041">end</span>&nbsp;<span class="op" id="5202045">:=</span>&nbsp;<span class="num" id="5202048">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5202051">for</span>&nbsp;<span class="ident" id="5202055">_</span><span class="op" id="5202056">,</span>&nbsp;<span class="ident" id="5202058">match</span>&nbsp;<span class="op" id="5202064">:=</span>&nbsp;<span class="keyword" id="5202067">range</span>&nbsp;<span class="ident" id="5202073">matches</span>&nbsp;<span class="op" id="5202081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5202085">if</span>&nbsp;<span class="ident" id="5202088">n</span>&nbsp;<span class="op" id="5202090">&gt;</span>&nbsp;<span class="num" id="5202092">0</span>&nbsp;<span class="op" id="5202094">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5202097">len</span><span class="op" id="5202100">(</span><span class="ident" id="5202101">strings</span><span class="op" id="5202108">)</span>&nbsp;<span class="op" id="5202110">&gt;=</span>&nbsp;<span class="ident" id="5202113">n</span><span class="op" id="5202114">-</span><span class="num" id="5202115">1</span>&nbsp;<span class="op" id="5202117">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5202122">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5202130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202135">end</span>&nbsp;<span class="op" id="5202139">=</span>&nbsp;<span class="ident" id="5202141">match</span><span class="op" id="5202146">[</span><span class="num" id="5202147">0</span><span class="op" id="5202148">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5202152">if</span>&nbsp;<span class="ident" id="5202155">match</span><span class="op" id="5202160">[</span><span class="num" id="5202161">1</span><span class="op" id="5202162">]</span>&nbsp;<span class="op" id="5202164">!=</span>&nbsp;<span class="num" id="5202167">0</span>&nbsp;<span class="op" id="5202169">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202174">strings</span>&nbsp;<span class="op" id="5202182">=</span>&nbsp;<span class="builtinfunc" id="5202184">append</span><span class="op" id="5202190">(</span><span class="ident" id="5202191">strings</span><span class="op" id="5202198">,</span>&nbsp;<span class="ident" id="5202200">s</span><span class="op" id="5202201">[</span><span class="ident" id="5202202">beg</span><span class="op" id="5202205">:</span><span class="ident" id="5202206">end</span><span class="op" id="5202209">]</span><span class="op" id="5202210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5202214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202218">beg</span>&nbsp;<span class="op" id="5202222">=</span>&nbsp;<span class="ident" id="5202224">match</span><span class="op" id="5202229">[</span><span class="num" id="5202230">1</span><span class="op" id="5202231">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5202234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5202238">if</span>&nbsp;<span class="ident" id="5202241">end</span>&nbsp;<span class="op" id="5202245">!=</span>&nbsp;<span class="builtinfunc" id="5202248">len</span><span class="op" id="5202251">(</span><span class="ident" id="5202252">s</span><span class="op" id="5202253">)</span>&nbsp;<span class="op" id="5202255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5202259">strings</span>&nbsp;<span class="op" id="5202267">=</span>&nbsp;<span class="builtinfunc" id="5202269">append</span><span class="op" id="5202275">(</span><span class="ident" id="5202276">strings</span><span class="op" id="5202283">,</span>&nbsp;<span class="ident" id="5202285">s</span><span class="op" id="5202286">[</span><span class="ident" id="5202287">beg</span><span class="op" id="5202290">:</span><span class="op" id="5202291">]</span><span class="op" id="5202292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5202295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5202299">return</span>&nbsp;<span class="ident" id="5202306">strings</span><br>
<span class="lineno">1120</span><span class="op" id="5202314">}</span>
</div>
</body>
</html>
