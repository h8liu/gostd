<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html" class="current">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6658447">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6658502">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6658556">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6658607">package</span>&nbsp;<span class="ident" id="6658615">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658620">import</span>&nbsp;<span class="op" id="6658627">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6658630">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6658636">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6658647">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6658658">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6658668">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658671">type</span>&nbsp;<span class="ident" id="6658676">listenerFile</span>&nbsp;<span class="keyword" id="6658689">interface</span>&nbsp;<span class="op" id="6658699">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658702">Listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658712">File</span><span class="op" id="6658716">(</span><span class="op" id="6658717">)</span>&nbsp;<span class="op" id="6658719">(</span><span class="ident" id="6658720">f</span>&nbsp;<span class="op" id="6658722">*</span><span class="ident" id="6658723">os</span><span class="op" id="6658725">.</span><span class="ident" id="6658726">File</span><span class="op" id="6658730">,</span>&nbsp;<span class="ident" id="6658732">err</span>&nbsp;<span class="builtintype" id="6658736">error</span><span class="op" id="6658741">)</span><br>
<span class="lineno"></span><span class="op" id="6658743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658746">type</span>&nbsp;<span class="ident" id="6658751">packetConnFile</span>&nbsp;<span class="keyword" id="6658766">interface</span>&nbsp;<span class="op" id="6658776">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658779">PacketConn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658791">File</span><span class="op" id="6658795">(</span><span class="op" id="6658796">)</span>&nbsp;<span class="op" id="6658798">(</span><span class="ident" id="6658799">f</span>&nbsp;<span class="op" id="6658801">*</span><span class="ident" id="6658802">os</span><span class="op" id="6658804">.</span><span class="ident" id="6658805">File</span><span class="op" id="6658809">,</span>&nbsp;<span class="ident" id="6658811">err</span>&nbsp;<span class="builtintype" id="6658815">error</span><span class="op" id="6658820">)</span><br>
<span class="lineno"></span><span class="op" id="6658822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658825">type</span>&nbsp;<span class="ident" id="6658830">connFile</span>&nbsp;<span class="keyword" id="6658839">interface</span>&nbsp;<span class="op" id="6658849">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658852">Conn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658858">File</span><span class="op" id="6658862">(</span><span class="op" id="6658863">)</span>&nbsp;<span class="op" id="6658865">(</span><span class="ident" id="6658866">f</span>&nbsp;<span class="op" id="6658868">*</span><span class="ident" id="6658869">os</span><span class="op" id="6658871">.</span><span class="ident" id="6658872">File</span><span class="op" id="6658876">,</span>&nbsp;<span class="ident" id="6658878">err</span>&nbsp;<span class="builtintype" id="6658882">error</span><span class="op" id="6658887">)</span><br>
<span class="lineno"></span><span class="op" id="6658889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658892">func</span>&nbsp;<span class="ident" id="6658897">testFileListener</span><span class="op" id="6658913">(</span><span class="ident" id="6658914">t</span>&nbsp;<span class="op" id="6658916">*</span><span class="ident" id="6658917">testing</span><span class="op" id="6658924">.</span><span class="ident" id="6658925">T</span><span class="op" id="6658926">,</span>&nbsp;<span class="ident" id="6658928">net</span><span class="op" id="6658931">,</span>&nbsp;<span class="ident" id="6658933">laddr</span>&nbsp;<span class="builtintype" id="6658939">string</span><span class="op" id="6658945">)</span>&nbsp;<span class="op" id="6658947">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6658950">switch</span>&nbsp;<span class="ident" id="6658957">net</span>&nbsp;<span class="op" id="6658961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6658964">case</span>&nbsp;<span class="string" id="6658969">&#34;tcp&#34;</span><span class="op" id="6658974">,</span>&nbsp;<span class="string" id="6658976">&#34;tcp4&#34;</span><span class="op" id="6658982">,</span>&nbsp;<span class="string" id="6658984">&#34;tcp6&#34;</span><span class="op" id="6658990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6658994">laddr</span>&nbsp;<span class="op" id="6659000">+=</span>&nbsp;<span class="string" id="6659003">&#34;:0&#34;</span>&nbsp;<span class="comment" id="6659008">//&nbsp;any&nbsp;available&nbsp;port</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659034">l</span><span class="op" id="6659035">,</span>&nbsp;<span class="ident" id="6659037">err</span>&nbsp;<span class="op" id="6659041">:=</span>&nbsp;<span class="ident" id="6659044">Listen</span><span class="op" id="6659050">(</span><span class="ident" id="6659051">net</span><span class="op" id="6659054">,</span>&nbsp;<span class="ident" id="6659056">laddr</span><span class="op" id="6659061">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659064">if</span>&nbsp;<span class="ident" id="6659067">err</span>&nbsp;<span class="op" id="6659071">!=</span>&nbsp;<span class="builtintype" id="6659074">nil</span>&nbsp;<span class="op" id="6659078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659082">t</span><span class="op" id="6659083">.</span><span class="ident" id="6659084">Fatalf</span><span class="op" id="6659090">(</span><span class="string" id="6659091">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6659110">,</span>&nbsp;<span class="ident" id="6659112">err</span><span class="op" id="6659115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659121">defer</span>&nbsp;<span class="ident" id="6659127">l</span><span class="op" id="6659128">.</span><span class="ident" id="6659129">Close</span><span class="op" id="6659134">(</span><span class="op" id="6659135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659138">lf</span>&nbsp;<span class="op" id="6659141">:=</span>&nbsp;<span class="ident" id="6659144">l</span><span class="op" id="6659145">.</span><span class="op" id="6659146">(</span><span class="ident" id="6659147">listenerFile</span><span class="op" id="6659159">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659162">f</span><span class="op" id="6659163">,</span>&nbsp;<span class="ident" id="6659165">err</span>&nbsp;<span class="op" id="6659169">:=</span>&nbsp;<span class="ident" id="6659172">lf</span><span class="op" id="6659174">.</span><span class="ident" id="6659175">File</span><span class="op" id="6659179">(</span><span class="op" id="6659180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659183">if</span>&nbsp;<span class="ident" id="6659186">err</span>&nbsp;<span class="op" id="6659190">!=</span>&nbsp;<span class="builtintype" id="6659193">nil</span>&nbsp;<span class="op" id="6659197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659201">t</span><span class="op" id="6659202">.</span><span class="ident" id="6659203">Fatalf</span><span class="op" id="6659209">(</span><span class="string" id="6659210">&#34;File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6659227">,</span>&nbsp;<span class="ident" id="6659229">err</span><span class="op" id="6659232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659238">c</span><span class="op" id="6659239">,</span>&nbsp;<span class="ident" id="6659241">err</span>&nbsp;<span class="op" id="6659245">:=</span>&nbsp;<span class="ident" id="6659248">FileListener</span><span class="op" id="6659260">(</span><span class="ident" id="6659261">f</span><span class="op" id="6659262">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659265">if</span>&nbsp;<span class="ident" id="6659268">err</span>&nbsp;<span class="op" id="6659272">!=</span>&nbsp;<span class="builtintype" id="6659275">nil</span>&nbsp;<span class="op" id="6659279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659283">t</span><span class="op" id="6659284">.</span><span class="ident" id="6659285">Fatalf</span><span class="op" id="6659291">(</span><span class="string" id="6659292">&#34;FileListener&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6659317">,</span>&nbsp;<span class="ident" id="6659319">err</span><span class="op" id="6659322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659328">if</span>&nbsp;<span class="op" id="6659331">!</span><span class="ident" id="6659332">reflect</span><span class="op" id="6659339">.</span><span class="ident" id="6659340">DeepEqual</span><span class="op" id="6659349">(</span><span class="ident" id="6659350">l</span><span class="op" id="6659351">.</span><span class="ident" id="6659352">Addr</span><span class="op" id="6659356">(</span><span class="op" id="6659357">)</span><span class="op" id="6659358">,</span>&nbsp;<span class="ident" id="6659360">c</span><span class="op" id="6659361">.</span><span class="ident" id="6659362">Addr</span><span class="op" id="6659366">(</span><span class="op" id="6659367">)</span><span class="op" id="6659368">)</span>&nbsp;<span class="op" id="6659370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659374">t</span><span class="op" id="6659375">.</span><span class="ident" id="6659376">Fatalf</span><span class="op" id="6659382">(</span><span class="string" id="6659383">&#34;Addrs&nbsp;not&nbsp;equal:&nbsp;%#v&nbsp;!=&nbsp;%#v&#34;</span><span class="op" id="6659412">,</span>&nbsp;<span class="ident" id="6659414">l</span><span class="op" id="6659415">.</span><span class="ident" id="6659416">Addr</span><span class="op" id="6659420">(</span><span class="op" id="6659421">)</span><span class="op" id="6659422">,</span>&nbsp;<span class="ident" id="6659424">c</span><span class="op" id="6659425">.</span><span class="ident" id="6659426">Addr</span><span class="op" id="6659430">(</span><span class="op" id="6659431">)</span><span class="op" id="6659432">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659438">if</span>&nbsp;<span class="ident" id="6659441">err</span>&nbsp;<span class="op" id="6659445">:=</span>&nbsp;<span class="ident" id="6659448">c</span><span class="op" id="6659449">.</span><span class="ident" id="6659450">Close</span><span class="op" id="6659455">(</span><span class="op" id="6659456">)</span><span class="op" id="6659457">;</span>&nbsp;<span class="ident" id="6659459">err</span>&nbsp;<span class="op" id="6659463">!=</span>&nbsp;<span class="builtintype" id="6659466">nil</span>&nbsp;<span class="op" id="6659470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659474">t</span><span class="op" id="6659475">.</span><span class="ident" id="6659476">Fatalf</span><span class="op" id="6659482">(</span><span class="string" id="6659483">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6659501">,</span>&nbsp;<span class="ident" id="6659503">err</span><span class="op" id="6659506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6659512">if</span>&nbsp;<span class="ident" id="6659515">err</span>&nbsp;<span class="op" id="6659519">:=</span>&nbsp;<span class="ident" id="6659522">f</span><span class="op" id="6659523">.</span><span class="ident" id="6659524">Close</span><span class="op" id="6659529">(</span><span class="op" id="6659530">)</span><span class="op" id="6659531">;</span>&nbsp;<span class="ident" id="6659533">err</span>&nbsp;<span class="op" id="6659537">!=</span>&nbsp;<span class="builtintype" id="6659540">nil</span>&nbsp;<span class="op" id="6659544">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659548">t</span><span class="op" id="6659549">.</span><span class="ident" id="6659550">Fatalf</span><span class="op" id="6659556">(</span><span class="string" id="6659557">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6659575">,</span>&nbsp;<span class="ident" id="6659577">err</span><span class="op" id="6659580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659583">}</span><br>
<span class="lineno"></span><span class="op" id="6659585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6659588">var</span>&nbsp;<span class="ident" id="6659592">fileListenerTests</span>&nbsp;<span class="op" id="6659610">=</span>&nbsp;<span class="op" id="6659612">[</span><span class="op" id="6659613">]</span><span class="keyword" id="6659614">struct</span>&nbsp;<span class="op" id="6659621">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659624">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6659630">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659638">laddr</span>&nbsp;<span class="builtintype" id="6659644">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659652">ipv6</span>&nbsp;&nbsp;<span class="builtintype" id="6659658">bool</span>&nbsp;<span class="comment" id="6659663">//&nbsp;test&nbsp;with&nbsp;underlying&nbsp;AF_INET6&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6659704">linux</span>&nbsp;<span class="builtintype" id="6659710">bool</span>&nbsp;<span class="comment" id="6659715">//&nbsp;test&nbsp;with&nbsp;abstract&nbsp;unix&nbsp;domain&nbsp;socket,&nbsp;a&nbsp;Linux-ism</span><br>
<span class="lineno"></span><span class="op" id="6659769">}</span><span class="op" id="6659770">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659773">{</span><span class="ident" id="6659774">net</span><span class="op" id="6659777">:</span>&nbsp;<span class="string" id="6659779">&#34;tcp&#34;</span><span class="op" id="6659784">,</span>&nbsp;<span class="ident" id="6659786">laddr</span><span class="op" id="6659791">:</span>&nbsp;<span class="string" id="6659793">&#34;&#34;</span><span class="op" id="6659795">}</span><span class="op" id="6659796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659799">{</span><span class="ident" id="6659800">net</span><span class="op" id="6659803">:</span>&nbsp;<span class="string" id="6659805">&#34;tcp&#34;</span><span class="op" id="6659810">,</span>&nbsp;<span class="ident" id="6659812">laddr</span><span class="op" id="6659817">:</span>&nbsp;<span class="string" id="6659819">&#34;0.0.0.0&#34;</span><span class="op" id="6659828">}</span><span class="op" id="6659829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659832">{</span><span class="ident" id="6659833">net</span><span class="op" id="6659836">:</span>&nbsp;<span class="string" id="6659838">&#34;tcp&#34;</span><span class="op" id="6659843">,</span>&nbsp;<span class="ident" id="6659845">laddr</span><span class="op" id="6659850">:</span>&nbsp;<span class="string" id="6659852">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6659870">}</span><span class="op" id="6659871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659874">{</span><span class="ident" id="6659875">net</span><span class="op" id="6659878">:</span>&nbsp;<span class="string" id="6659880">&#34;tcp&#34;</span><span class="op" id="6659885">,</span>&nbsp;<span class="ident" id="6659887">laddr</span><span class="op" id="6659892">:</span>&nbsp;<span class="string" id="6659894">&#34;[::]&#34;</span><span class="op" id="6659900">,</span>&nbsp;<span class="ident" id="6659902">ipv6</span><span class="op" id="6659906">:</span>&nbsp;<span class="builtintype" id="6659908">true</span><span class="op" id="6659912">}</span><span class="op" id="6659913">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659917">{</span><span class="ident" id="6659918">net</span><span class="op" id="6659921">:</span>&nbsp;<span class="string" id="6659923">&#34;tcp&#34;</span><span class="op" id="6659928">,</span>&nbsp;<span class="ident" id="6659930">laddr</span><span class="op" id="6659935">:</span>&nbsp;<span class="string" id="6659937">&#34;127.0.0.1&#34;</span><span class="op" id="6659948">}</span><span class="op" id="6659949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659952">{</span><span class="ident" id="6659953">net</span><span class="op" id="6659956">:</span>&nbsp;<span class="string" id="6659958">&#34;tcp&#34;</span><span class="op" id="6659963">,</span>&nbsp;<span class="ident" id="6659965">laddr</span><span class="op" id="6659970">:</span>&nbsp;<span class="string" id="6659972">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6659992">}</span><span class="op" id="6659993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6659996">{</span><span class="ident" id="6659997">net</span><span class="op" id="6660000">:</span>&nbsp;<span class="string" id="6660002">&#34;tcp&#34;</span><span class="op" id="6660007">,</span>&nbsp;<span class="ident" id="6660009">laddr</span><span class="op" id="6660014">:</span>&nbsp;<span class="string" id="6660016">&#34;[::1]&#34;</span><span class="op" id="6660023">,</span>&nbsp;<span class="ident" id="6660025">ipv6</span><span class="op" id="6660029">:</span>&nbsp;<span class="builtintype" id="6660031">true</span><span class="op" id="6660035">}</span><span class="op" id="6660036">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660040">{</span><span class="ident" id="6660041">net</span><span class="op" id="6660044">:</span>&nbsp;<span class="string" id="6660046">&#34;tcp4&#34;</span><span class="op" id="6660052">,</span>&nbsp;<span class="ident" id="6660054">laddr</span><span class="op" id="6660059">:</span>&nbsp;<span class="string" id="6660061">&#34;&#34;</span><span class="op" id="6660063">}</span><span class="op" id="6660064">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660067">{</span><span class="ident" id="6660068">net</span><span class="op" id="6660071">:</span>&nbsp;<span class="string" id="6660073">&#34;tcp4&#34;</span><span class="op" id="6660079">,</span>&nbsp;<span class="ident" id="6660081">laddr</span><span class="op" id="6660086">:</span>&nbsp;<span class="string" id="6660088">&#34;0.0.0.0&#34;</span><span class="op" id="6660097">}</span><span class="op" id="6660098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660101">{</span><span class="ident" id="6660102">net</span><span class="op" id="6660105">:</span>&nbsp;<span class="string" id="6660107">&#34;tcp4&#34;</span><span class="op" id="6660113">,</span>&nbsp;<span class="ident" id="6660115">laddr</span><span class="op" id="6660120">:</span>&nbsp;<span class="string" id="6660122">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6660140">}</span><span class="op" id="6660141">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660145">{</span><span class="ident" id="6660146">net</span><span class="op" id="6660149">:</span>&nbsp;<span class="string" id="6660151">&#34;tcp4&#34;</span><span class="op" id="6660157">,</span>&nbsp;<span class="ident" id="6660159">laddr</span><span class="op" id="6660164">:</span>&nbsp;<span class="string" id="6660166">&#34;127.0.0.1&#34;</span><span class="op" id="6660177">}</span><span class="op" id="6660178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660181">{</span><span class="ident" id="6660182">net</span><span class="op" id="6660185">:</span>&nbsp;<span class="string" id="6660187">&#34;tcp4&#34;</span><span class="op" id="6660193">,</span>&nbsp;<span class="ident" id="6660195">laddr</span><span class="op" id="6660200">:</span>&nbsp;<span class="string" id="6660202">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6660222">}</span><span class="op" id="6660223">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660227">{</span><span class="ident" id="6660228">net</span><span class="op" id="6660231">:</span>&nbsp;<span class="string" id="6660233">&#34;tcp6&#34;</span><span class="op" id="6660239">,</span>&nbsp;<span class="ident" id="6660241">laddr</span><span class="op" id="6660246">:</span>&nbsp;<span class="string" id="6660248">&#34;&#34;</span><span class="op" id="6660250">,</span>&nbsp;<span class="ident" id="6660252">ipv6</span><span class="op" id="6660256">:</span>&nbsp;<span class="builtintype" id="6660258">true</span><span class="op" id="6660262">}</span><span class="op" id="6660263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660266">{</span><span class="ident" id="6660267">net</span><span class="op" id="6660270">:</span>&nbsp;<span class="string" id="6660272">&#34;tcp6&#34;</span><span class="op" id="6660278">,</span>&nbsp;<span class="ident" id="6660280">laddr</span><span class="op" id="6660285">:</span>&nbsp;<span class="string" id="6660287">&#34;[::]&#34;</span><span class="op" id="6660293">,</span>&nbsp;<span class="ident" id="6660295">ipv6</span><span class="op" id="6660299">:</span>&nbsp;<span class="builtintype" id="6660301">true</span><span class="op" id="6660305">}</span><span class="op" id="6660306">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660310">{</span><span class="ident" id="6660311">net</span><span class="op" id="6660314">:</span>&nbsp;<span class="string" id="6660316">&#34;tcp6&#34;</span><span class="op" id="6660322">,</span>&nbsp;<span class="ident" id="6660324">laddr</span><span class="op" id="6660329">:</span>&nbsp;<span class="string" id="6660331">&#34;[::1]&#34;</span><span class="op" id="6660338">,</span>&nbsp;<span class="ident" id="6660340">ipv6</span><span class="op" id="6660344">:</span>&nbsp;<span class="builtintype" id="6660346">true</span><span class="op" id="6660350">}</span><span class="op" id="6660351">,</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660355">{</span><span class="ident" id="6660356">net</span><span class="op" id="6660359">:</span>&nbsp;<span class="string" id="6660361">&#34;unix&#34;</span><span class="op" id="6660367">,</span>&nbsp;<span class="ident" id="6660369">laddr</span><span class="op" id="6660374">:</span>&nbsp;<span class="string" id="6660376">&#34;@gotest/net&#34;</span><span class="op" id="6660389">,</span>&nbsp;<span class="ident" id="6660391">linux</span><span class="op" id="6660396">:</span>&nbsp;<span class="builtintype" id="6660398">true</span><span class="op" id="6660402">}</span><span class="op" id="6660403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660406">{</span><span class="ident" id="6660407">net</span><span class="op" id="6660410">:</span>&nbsp;<span class="string" id="6660412">&#34;unixpacket&#34;</span><span class="op" id="6660424">,</span>&nbsp;<span class="ident" id="6660426">laddr</span><span class="op" id="6660431">:</span>&nbsp;<span class="string" id="6660433">&#34;@gotest/net&#34;</span><span class="op" id="6660446">,</span>&nbsp;<span class="ident" id="6660448">linux</span><span class="op" id="6660453">:</span>&nbsp;<span class="builtintype" id="6660455">true</span><span class="op" id="6660459">}</span><span class="op" id="6660460">,</span><br>
<span class="lineno"></span><span class="op" id="6660462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6660465">func</span>&nbsp;<span class="ident" id="6660470">TestFileListener</span><span class="op" id="6660486">(</span><span class="ident" id="6660487">t</span>&nbsp;<span class="op" id="6660489">*</span><span class="ident" id="6660490">testing</span><span class="op" id="6660497">.</span><span class="ident" id="6660498">T</span><span class="op" id="6660499">)</span>&nbsp;<span class="op" id="6660501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660504">switch</span>&nbsp;<span class="ident" id="6660511">runtime</span><span class="op" id="6660518">.</span><span class="ident" id="6660519">GOOS</span>&nbsp;<span class="op" id="6660524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660527">case</span>&nbsp;<span class="string" id="6660532">&#34;nacl&#34;</span><span class="op" id="6660538">,</span>&nbsp;<span class="string" id="6660540">&#34;windows&#34;</span><span class="op" id="6660549">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6660553">t</span><span class="op" id="6660554">.</span><span class="ident" id="6660555">Skipf</span><span class="op" id="6660560">(</span><span class="string" id="6660561">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6660582">,</span>&nbsp;<span class="ident" id="6660584">runtime</span><span class="op" id="6660591">.</span><span class="ident" id="6660592">GOOS</span><span class="op" id="6660596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660599">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660603">for</span>&nbsp;<span class="ident" id="6660607">_</span><span class="op" id="6660608">,</span>&nbsp;<span class="ident" id="6660610">tt</span>&nbsp;<span class="op" id="6660613">:=</span>&nbsp;<span class="keyword" id="6660616">range</span>&nbsp;<span class="ident" id="6660622">fileListenerTests</span>&nbsp;<span class="op" id="6660640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660644">if</span>&nbsp;<span class="ident" id="6660647">skipServerTest</span><span class="op" id="6660661">(</span><span class="ident" id="6660662">tt</span><span class="op" id="6660664">.</span><span class="ident" id="6660665">net</span><span class="op" id="6660668">,</span>&nbsp;<span class="string" id="6660670">&#34;unix&#34;</span><span class="op" id="6660676">,</span>&nbsp;<span class="ident" id="6660678">tt</span><span class="op" id="6660680">.</span><span class="ident" id="6660681">laddr</span><span class="op" id="6660686">,</span>&nbsp;<span class="ident" id="6660688">tt</span><span class="op" id="6660690">.</span><span class="ident" id="6660691">ipv6</span><span class="op" id="6660695">,</span>&nbsp;<span class="builtintype" id="6660697">false</span><span class="op" id="6660702">,</span>&nbsp;<span class="ident" id="6660704">tt</span><span class="op" id="6660706">.</span><span class="ident" id="6660707">linux</span><span class="op" id="6660712">)</span>&nbsp;<span class="op" id="6660714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660719">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660730">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660734">if</span>&nbsp;<span class="ident" id="6660737">skipServerTest</span><span class="op" id="6660751">(</span><span class="ident" id="6660752">tt</span><span class="op" id="6660754">.</span><span class="ident" id="6660755">net</span><span class="op" id="6660758">,</span>&nbsp;<span class="string" id="6660760">&#34;unixpacket&#34;</span><span class="op" id="6660772">,</span>&nbsp;<span class="ident" id="6660774">tt</span><span class="op" id="6660776">.</span><span class="ident" id="6660777">laddr</span><span class="op" id="6660782">,</span>&nbsp;<span class="ident" id="6660784">tt</span><span class="op" id="6660786">.</span><span class="ident" id="6660787">ipv6</span><span class="op" id="6660791">,</span>&nbsp;<span class="builtintype" id="6660793">false</span><span class="op" id="6660798">,</span>&nbsp;<span class="ident" id="6660800">tt</span><span class="op" id="6660802">.</span><span class="ident" id="6660803">linux</span><span class="op" id="6660808">)</span>&nbsp;<span class="op" id="6660810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660815">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6660830">testFileListener</span><span class="op" id="6660846">(</span><span class="ident" id="6660847">t</span><span class="op" id="6660848">,</span>&nbsp;<span class="ident" id="6660850">tt</span><span class="op" id="6660852">.</span><span class="ident" id="6660853">net</span><span class="op" id="6660856">,</span>&nbsp;<span class="ident" id="6660858">tt</span><span class="op" id="6660860">.</span><span class="ident" id="6660861">laddr</span><span class="op" id="6660866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6660869">}</span><br>
<span class="lineno">105</span><span class="op" id="6660871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6660874">func</span>&nbsp;<span class="ident" id="6660879">testFilePacketConn</span><span class="op" id="6660897">(</span><span class="ident" id="6660898">t</span>&nbsp;<span class="op" id="6660900">*</span><span class="ident" id="6660901">testing</span><span class="op" id="6660908">.</span><span class="ident" id="6660909">T</span><span class="op" id="6660910">,</span>&nbsp;<span class="ident" id="6660912">pcf</span>&nbsp;<span class="ident" id="6660916">packetConnFile</span><span class="op" id="6660930">,</span>&nbsp;<span class="ident" id="6660932">listen</span>&nbsp;<span class="builtintype" id="6660939">bool</span><span class="op" id="6660943">)</span>&nbsp;<span class="op" id="6660945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6660948">f</span><span class="op" id="6660949">,</span>&nbsp;<span class="ident" id="6660951">err</span>&nbsp;<span class="op" id="6660955">:=</span>&nbsp;<span class="ident" id="6660958">pcf</span><span class="op" id="6660961">.</span><span class="ident" id="6660962">File</span><span class="op" id="6660966">(</span><span class="op" id="6660967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6660970">if</span>&nbsp;<span class="ident" id="6660973">err</span>&nbsp;<span class="op" id="6660977">!=</span>&nbsp;<span class="builtintype" id="6660980">nil</span>&nbsp;<span class="op" id="6660984">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6660988">t</span><span class="op" id="6660989">.</span><span class="ident" id="6660990">Fatalf</span><span class="op" id="6660996">(</span><span class="string" id="6660997">&#34;File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661014">,</span>&nbsp;<span class="ident" id="6661016">err</span><span class="op" id="6661019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661025">c</span><span class="op" id="6661026">,</span>&nbsp;<span class="ident" id="6661028">err</span>&nbsp;<span class="op" id="6661032">:=</span>&nbsp;<span class="ident" id="6661035">FilePacketConn</span><span class="op" id="6661049">(</span><span class="ident" id="6661050">f</span><span class="op" id="6661051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661054">if</span>&nbsp;<span class="ident" id="6661057">err</span>&nbsp;<span class="op" id="6661061">!=</span>&nbsp;<span class="builtintype" id="6661064">nil</span>&nbsp;<span class="op" id="6661068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661072">t</span><span class="op" id="6661073">.</span><span class="ident" id="6661074">Fatalf</span><span class="op" id="6661080">(</span><span class="string" id="6661081">&#34;FilePacketConn&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661108">,</span>&nbsp;<span class="ident" id="6661110">err</span><span class="op" id="6661113">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661119">if</span>&nbsp;<span class="op" id="6661122">!</span><span class="ident" id="6661123">reflect</span><span class="op" id="6661130">.</span><span class="ident" id="6661131">DeepEqual</span><span class="op" id="6661140">(</span><span class="ident" id="6661141">pcf</span><span class="op" id="6661144">.</span><span class="ident" id="6661145">LocalAddr</span><span class="op" id="6661154">(</span><span class="op" id="6661155">)</span><span class="op" id="6661156">,</span>&nbsp;<span class="ident" id="6661158">c</span><span class="op" id="6661159">.</span><span class="ident" id="6661160">LocalAddr</span><span class="op" id="6661169">(</span><span class="op" id="6661170">)</span><span class="op" id="6661171">)</span>&nbsp;<span class="op" id="6661173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661177">t</span><span class="op" id="6661178">.</span><span class="ident" id="6661179">Fatalf</span><span class="op" id="6661185">(</span><span class="string" id="6661186">&#34;LocalAddrs&nbsp;not&nbsp;equal:&nbsp;%#v&nbsp;!=&nbsp;%#v&#34;</span><span class="op" id="6661220">,</span>&nbsp;<span class="ident" id="6661222">pcf</span><span class="op" id="6661225">.</span><span class="ident" id="6661226">LocalAddr</span><span class="op" id="6661235">(</span><span class="op" id="6661236">)</span><span class="op" id="6661237">,</span>&nbsp;<span class="ident" id="6661239">c</span><span class="op" id="6661240">.</span><span class="ident" id="6661241">LocalAddr</span><span class="op" id="6661250">(</span><span class="op" id="6661251">)</span><span class="op" id="6661252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661258">if</span>&nbsp;<span class="ident" id="6661261">listen</span>&nbsp;<span class="op" id="6661268">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661272">if</span>&nbsp;<span class="ident" id="6661275">_</span><span class="op" id="6661276">,</span>&nbsp;<span class="ident" id="6661278">err</span>&nbsp;<span class="op" id="6661282">:=</span>&nbsp;<span class="ident" id="6661285">c</span><span class="op" id="6661286">.</span><span class="ident" id="6661287">WriteTo</span><span class="op" id="6661294">(</span><span class="op" id="6661295">[</span><span class="op" id="6661296">]</span><span class="builtintype" id="6661297">byte</span><span class="op" id="6661301">{</span><span class="op" id="6661302">}</span><span class="op" id="6661303">,</span>&nbsp;<span class="ident" id="6661305">c</span><span class="op" id="6661306">.</span><span class="ident" id="6661307">LocalAddr</span><span class="op" id="6661316">(</span><span class="op" id="6661317">)</span><span class="op" id="6661318">)</span><span class="op" id="6661319">;</span>&nbsp;<span class="ident" id="6661321">err</span>&nbsp;<span class="op" id="6661325">!=</span>&nbsp;<span class="builtintype" id="6661328">nil</span>&nbsp;<span class="op" id="6661332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661337">t</span><span class="op" id="6661338">.</span><span class="ident" id="6661339">Fatalf</span><span class="op" id="6661345">(</span><span class="string" id="6661346">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661366">,</span>&nbsp;<span class="ident" id="6661368">err</span><span class="op" id="6661371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661381">if</span>&nbsp;<span class="ident" id="6661384">err</span>&nbsp;<span class="op" id="6661388">:=</span>&nbsp;<span class="ident" id="6661391">c</span><span class="op" id="6661392">.</span><span class="ident" id="6661393">Close</span><span class="op" id="6661398">(</span><span class="op" id="6661399">)</span><span class="op" id="6661400">;</span>&nbsp;<span class="ident" id="6661402">err</span>&nbsp;<span class="op" id="6661406">!=</span>&nbsp;<span class="builtintype" id="6661409">nil</span>&nbsp;<span class="op" id="6661413">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661417">t</span><span class="op" id="6661418">.</span><span class="ident" id="6661419">Fatalf</span><span class="op" id="6661425">(</span><span class="string" id="6661426">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661444">,</span>&nbsp;<span class="ident" id="6661446">err</span><span class="op" id="6661449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661455">if</span>&nbsp;<span class="ident" id="6661458">err</span>&nbsp;<span class="op" id="6661462">:=</span>&nbsp;<span class="ident" id="6661465">f</span><span class="op" id="6661466">.</span><span class="ident" id="6661467">Close</span><span class="op" id="6661472">(</span><span class="op" id="6661473">)</span><span class="op" id="6661474">;</span>&nbsp;<span class="ident" id="6661476">err</span>&nbsp;<span class="op" id="6661480">!=</span>&nbsp;<span class="builtintype" id="6661483">nil</span>&nbsp;<span class="op" id="6661487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661491">t</span><span class="op" id="6661492">.</span><span class="ident" id="6661493">Fatalf</span><span class="op" id="6661499">(</span><span class="string" id="6661500">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661518">,</span>&nbsp;<span class="ident" id="6661520">err</span><span class="op" id="6661523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661526">}</span><br>
<span class="lineno">130</span><span class="op" id="6661528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6661531">func</span>&nbsp;<span class="ident" id="6661536">testFilePacketConnListen</span><span class="op" id="6661560">(</span><span class="ident" id="6661561">t</span>&nbsp;<span class="op" id="6661563">*</span><span class="ident" id="6661564">testing</span><span class="op" id="6661571">.</span><span class="ident" id="6661572">T</span><span class="op" id="6661573">,</span>&nbsp;<span class="ident" id="6661575">net</span><span class="op" id="6661578">,</span>&nbsp;<span class="ident" id="6661580">laddr</span>&nbsp;<span class="builtintype" id="6661586">string</span><span class="op" id="6661592">)</span>&nbsp;<span class="op" id="6661594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661597">switch</span>&nbsp;<span class="ident" id="6661604">net</span>&nbsp;<span class="op" id="6661608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661611">case</span>&nbsp;<span class="string" id="6661616">&#34;udp&#34;</span><span class="op" id="6661621">,</span>&nbsp;<span class="string" id="6661623">&#34;udp4&#34;</span><span class="op" id="6661629">,</span>&nbsp;<span class="string" id="6661631">&#34;udp6&#34;</span><span class="op" id="6661637">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661641">laddr</span>&nbsp;<span class="op" id="6661647">+=</span>&nbsp;<span class="string" id="6661650">&#34;:0&#34;</span>&nbsp;<span class="comment" id="6661655">//&nbsp;any&nbsp;available&nbsp;port</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661681">l</span><span class="op" id="6661682">,</span>&nbsp;<span class="ident" id="6661684">err</span>&nbsp;<span class="op" id="6661688">:=</span>&nbsp;<span class="ident" id="6661691">ListenPacket</span><span class="op" id="6661703">(</span><span class="ident" id="6661704">net</span><span class="op" id="6661707">,</span>&nbsp;<span class="ident" id="6661709">laddr</span><span class="op" id="6661714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661717">if</span>&nbsp;<span class="ident" id="6661720">err</span>&nbsp;<span class="op" id="6661724">!=</span>&nbsp;<span class="builtintype" id="6661727">nil</span>&nbsp;<span class="op" id="6661731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661735">t</span><span class="op" id="6661736">.</span><span class="ident" id="6661737">Fatalf</span><span class="op" id="6661743">(</span><span class="string" id="6661744">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661769">,</span>&nbsp;<span class="ident" id="6661771">err</span><span class="op" id="6661774">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661780">testFilePacketConn</span><span class="op" id="6661798">(</span><span class="ident" id="6661799">t</span><span class="op" id="6661800">,</span>&nbsp;<span class="ident" id="6661802">l</span><span class="op" id="6661803">.</span><span class="op" id="6661804">(</span><span class="ident" id="6661805">packetConnFile</span><span class="op" id="6661819">)</span><span class="op" id="6661820">,</span>&nbsp;<span class="builtintype" id="6661822">true</span><span class="op" id="6661826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661829">if</span>&nbsp;<span class="ident" id="6661832">err</span>&nbsp;<span class="op" id="6661836">:=</span>&nbsp;<span class="ident" id="6661839">l</span><span class="op" id="6661840">.</span><span class="ident" id="6661841">Close</span><span class="op" id="6661846">(</span><span class="op" id="6661847">)</span><span class="op" id="6661848">;</span>&nbsp;<span class="ident" id="6661850">err</span>&nbsp;<span class="op" id="6661854">!=</span>&nbsp;<span class="builtintype" id="6661857">nil</span>&nbsp;<span class="op" id="6661861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6661865">t</span><span class="op" id="6661866">.</span><span class="ident" id="6661867">Fatalf</span><span class="op" id="6661873">(</span><span class="string" id="6661874">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661892">,</span>&nbsp;<span class="ident" id="6661894">err</span><span class="op" id="6661897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6661900">}</span><br>
<span class="lineno">145</span><span class="op" id="6661902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6661905">func</span>&nbsp;<span class="ident" id="6661910">testFilePacketConnDial</span><span class="op" id="6661932">(</span><span class="ident" id="6661933">t</span>&nbsp;<span class="op" id="6661935">*</span><span class="ident" id="6661936">testing</span><span class="op" id="6661943">.</span><span class="ident" id="6661944">T</span><span class="op" id="6661945">,</span>&nbsp;<span class="ident" id="6661947">net</span><span class="op" id="6661950">,</span>&nbsp;<span class="ident" id="6661952">raddr</span>&nbsp;<span class="builtintype" id="6661958">string</span><span class="op" id="6661964">)</span>&nbsp;<span class="op" id="6661966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661969">switch</span>&nbsp;<span class="ident" id="6661976">net</span>&nbsp;<span class="op" id="6661980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6661983">case</span>&nbsp;<span class="string" id="6661988">&#34;udp&#34;</span><span class="op" id="6661993">,</span>&nbsp;<span class="string" id="6661995">&#34;udp4&#34;</span><span class="op" id="6662001">,</span>&nbsp;<span class="string" id="6662003">&#34;udp6&#34;</span><span class="op" id="6662009">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662013">raddr</span>&nbsp;<span class="op" id="6662019">+=</span>&nbsp;<span class="string" id="6662022">&#34;:12345&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662035">c</span><span class="op" id="6662036">,</span>&nbsp;<span class="ident" id="6662038">err</span>&nbsp;<span class="op" id="6662042">:=</span>&nbsp;<span class="ident" id="6662045">Dial</span><span class="op" id="6662049">(</span><span class="ident" id="6662050">net</span><span class="op" id="6662053">,</span>&nbsp;<span class="ident" id="6662055">raddr</span><span class="op" id="6662060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662063">if</span>&nbsp;<span class="ident" id="6662066">err</span>&nbsp;<span class="op" id="6662070">!=</span>&nbsp;<span class="builtintype" id="6662073">nil</span>&nbsp;<span class="op" id="6662077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662081">t</span><span class="op" id="6662082">.</span><span class="ident" id="6662083">Fatalf</span><span class="op" id="6662089">(</span><span class="string" id="6662090">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6662107">,</span>&nbsp;<span class="ident" id="6662109">err</span><span class="op" id="6662112">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662118">testFilePacketConn</span><span class="op" id="6662136">(</span><span class="ident" id="6662137">t</span><span class="op" id="6662138">,</span>&nbsp;<span class="ident" id="6662140">c</span><span class="op" id="6662141">.</span><span class="op" id="6662142">(</span><span class="ident" id="6662143">packetConnFile</span><span class="op" id="6662157">)</span><span class="op" id="6662158">,</span>&nbsp;<span class="builtintype" id="6662160">false</span><span class="op" id="6662165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662168">if</span>&nbsp;<span class="ident" id="6662171">err</span>&nbsp;<span class="op" id="6662175">:=</span>&nbsp;<span class="ident" id="6662178">c</span><span class="op" id="6662179">.</span><span class="ident" id="6662180">Close</span><span class="op" id="6662185">(</span><span class="op" id="6662186">)</span><span class="op" id="6662187">;</span>&nbsp;<span class="ident" id="6662189">err</span>&nbsp;<span class="op" id="6662193">!=</span>&nbsp;<span class="builtintype" id="6662196">nil</span>&nbsp;<span class="op" id="6662200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662204">t</span><span class="op" id="6662205">.</span><span class="ident" id="6662206">Fatalf</span><span class="op" id="6662212">(</span><span class="string" id="6662213">&#34;Close&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6662231">,</span>&nbsp;<span class="ident" id="6662233">err</span><span class="op" id="6662236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662239">}</span><br>
<span class="lineno">160</span><span class="op" id="6662241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6662244">var</span>&nbsp;<span class="ident" id="6662248">filePacketConnTests</span>&nbsp;<span class="op" id="6662268">=</span>&nbsp;<span class="op" id="6662270">[</span><span class="op" id="6662271">]</span><span class="keyword" id="6662272">struct</span>&nbsp;<span class="op" id="6662279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662282">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6662288">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662296">addr</span>&nbsp;&nbsp;<span class="builtintype" id="6662302">string</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662310">ipv6</span>&nbsp;&nbsp;<span class="builtintype" id="6662316">bool</span>&nbsp;<span class="comment" id="6662321">//&nbsp;test&nbsp;with&nbsp;underlying&nbsp;AF_INET6&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662362">linux</span>&nbsp;<span class="builtintype" id="6662368">bool</span>&nbsp;<span class="comment" id="6662373">//&nbsp;test&nbsp;with&nbsp;abstract&nbsp;unix&nbsp;domain&nbsp;socket,&nbsp;a&nbsp;Linux-ism</span><br>
<span class="lineno"></span><span class="op" id="6662427">}</span><span class="op" id="6662428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662431">{</span><span class="ident" id="6662432">net</span><span class="op" id="6662435">:</span>&nbsp;<span class="string" id="6662437">&#34;udp&#34;</span><span class="op" id="6662442">,</span>&nbsp;<span class="ident" id="6662444">addr</span><span class="op" id="6662448">:</span>&nbsp;<span class="string" id="6662450">&#34;127.0.0.1&#34;</span><span class="op" id="6662461">}</span><span class="op" id="6662462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662465">{</span><span class="ident" id="6662466">net</span><span class="op" id="6662469">:</span>&nbsp;<span class="string" id="6662471">&#34;udp&#34;</span><span class="op" id="6662476">,</span>&nbsp;<span class="ident" id="6662478">addr</span><span class="op" id="6662482">:</span>&nbsp;<span class="string" id="6662484">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6662504">}</span><span class="op" id="6662505">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662508">{</span><span class="ident" id="6662509">net</span><span class="op" id="6662512">:</span>&nbsp;<span class="string" id="6662514">&#34;udp&#34;</span><span class="op" id="6662519">,</span>&nbsp;<span class="ident" id="6662521">addr</span><span class="op" id="6662525">:</span>&nbsp;<span class="string" id="6662527">&#34;[::1]&#34;</span><span class="op" id="6662534">,</span>&nbsp;<span class="ident" id="6662536">ipv6</span><span class="op" id="6662540">:</span>&nbsp;<span class="builtintype" id="6662542">true</span><span class="op" id="6662546">}</span><span class="op" id="6662547">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662551">{</span><span class="ident" id="6662552">net</span><span class="op" id="6662555">:</span>&nbsp;<span class="string" id="6662557">&#34;udp4&#34;</span><span class="op" id="6662563">,</span>&nbsp;<span class="ident" id="6662565">addr</span><span class="op" id="6662569">:</span>&nbsp;<span class="string" id="6662571">&#34;127.0.0.1&#34;</span><span class="op" id="6662582">}</span><span class="op" id="6662583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662586">{</span><span class="ident" id="6662587">net</span><span class="op" id="6662590">:</span>&nbsp;<span class="string" id="6662592">&#34;udp4&#34;</span><span class="op" id="6662598">,</span>&nbsp;<span class="ident" id="6662600">addr</span><span class="op" id="6662604">:</span>&nbsp;<span class="string" id="6662606">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6662626">}</span><span class="op" id="6662627">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662631">{</span><span class="ident" id="6662632">net</span><span class="op" id="6662635">:</span>&nbsp;<span class="string" id="6662637">&#34;udp6&#34;</span><span class="op" id="6662643">,</span>&nbsp;<span class="ident" id="6662645">addr</span><span class="op" id="6662649">:</span>&nbsp;<span class="string" id="6662651">&#34;[::1]&#34;</span><span class="op" id="6662658">,</span>&nbsp;<span class="ident" id="6662660">ipv6</span><span class="op" id="6662664">:</span>&nbsp;<span class="builtintype" id="6662666">true</span><span class="op" id="6662670">}</span><span class="op" id="6662671">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662675">{</span><span class="ident" id="6662676">net</span><span class="op" id="6662679">:</span>&nbsp;<span class="string" id="6662681">&#34;ip4:icmp&#34;</span><span class="op" id="6662691">,</span>&nbsp;<span class="ident" id="6662693">addr</span><span class="op" id="6662697">:</span>&nbsp;<span class="string" id="6662699">&#34;127.0.0.1&#34;</span><span class="op" id="6662710">}</span><span class="op" id="6662711">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662715">{</span><span class="ident" id="6662716">net</span><span class="op" id="6662719">:</span>&nbsp;<span class="string" id="6662721">&#34;unixgram&#34;</span><span class="op" id="6662731">,</span>&nbsp;<span class="ident" id="6662733">addr</span><span class="op" id="6662737">:</span>&nbsp;<span class="string" id="6662739">&#34;@gotest3/net&#34;</span><span class="op" id="6662753">,</span>&nbsp;<span class="ident" id="6662755">linux</span><span class="op" id="6662760">:</span>&nbsp;<span class="builtintype" id="6662762">true</span><span class="op" id="6662766">}</span><span class="op" id="6662767">,</span><br>
<span class="lineno">180</span><span class="op" id="6662769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6662772">func</span>&nbsp;<span class="ident" id="6662777">TestFilePacketConn</span><span class="op" id="6662795">(</span><span class="ident" id="6662796">t</span>&nbsp;<span class="op" id="6662798">*</span><span class="ident" id="6662799">testing</span><span class="op" id="6662806">.</span><span class="ident" id="6662807">T</span><span class="op" id="6662808">)</span>&nbsp;<span class="op" id="6662810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662813">switch</span>&nbsp;<span class="ident" id="6662820">runtime</span><span class="op" id="6662827">.</span><span class="ident" id="6662828">GOOS</span>&nbsp;<span class="op" id="6662833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662836">case</span>&nbsp;<span class="string" id="6662841">&#34;nacl&#34;</span><span class="op" id="6662847">,</span>&nbsp;<span class="string" id="6662849">&#34;plan9&#34;</span><span class="op" id="6662856">,</span>&nbsp;<span class="string" id="6662858">&#34;windows&#34;</span><span class="op" id="6662867">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6662871">t</span><span class="op" id="6662872">.</span><span class="ident" id="6662873">Skipf</span><span class="op" id="6662878">(</span><span class="string" id="6662879">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6662900">,</span>&nbsp;<span class="ident" id="6662902">runtime</span><span class="op" id="6662909">.</span><span class="ident" id="6662910">GOOS</span><span class="op" id="6662914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6662917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662921">for</span>&nbsp;<span class="ident" id="6662925">_</span><span class="op" id="6662926">,</span>&nbsp;<span class="ident" id="6662928">tt</span>&nbsp;<span class="op" id="6662931">:=</span>&nbsp;<span class="keyword" id="6662934">range</span>&nbsp;<span class="ident" id="6662940">filePacketConnTests</span>&nbsp;<span class="op" id="6662960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662964">if</span>&nbsp;<span class="ident" id="6662967">skipServerTest</span><span class="op" id="6662981">(</span><span class="ident" id="6662982">tt</span><span class="op" id="6662984">.</span><span class="ident" id="6662985">net</span><span class="op" id="6662988">,</span>&nbsp;<span class="string" id="6662990">&#34;unixgram&#34;</span><span class="op" id="6663000">,</span>&nbsp;<span class="ident" id="6663002">tt</span><span class="op" id="6663004">.</span><span class="ident" id="6663005">addr</span><span class="op" id="6663009">,</span>&nbsp;<span class="ident" id="6663011">tt</span><span class="op" id="6663013">.</span><span class="ident" id="6663014">ipv6</span><span class="op" id="6663018">,</span>&nbsp;<span class="builtintype" id="6663020">false</span><span class="op" id="6663025">,</span>&nbsp;<span class="ident" id="6663027">tt</span><span class="op" id="6663029">.</span><span class="ident" id="6663030">linux</span><span class="op" id="6663035">)</span>&nbsp;<span class="op" id="6663037">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663042">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663057">if</span>&nbsp;<span class="ident" id="6663060">os</span><span class="op" id="6663062">.</span><span class="ident" id="6663063">Getuid</span><span class="op" id="6663069">(</span><span class="op" id="6663070">)</span>&nbsp;<span class="op" id="6663072">!=</span>&nbsp;<span class="num" id="6663075">0</span>&nbsp;<span class="op" id="6663077">&amp;&amp;</span>&nbsp;<span class="ident" id="6663080">tt</span><span class="op" id="6663082">.</span><span class="ident" id="6663083">net</span>&nbsp;<span class="op" id="6663087">==</span>&nbsp;<span class="string" id="6663090">&#34;ip4:icmp&#34;</span>&nbsp;<span class="op" id="6663101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6663106">t</span><span class="op" id="6663107">.</span><span class="ident" id="6663108">Log</span><span class="op" id="6663111">(</span><span class="string" id="6663112">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="6663141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663146">continue</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6663161">testFilePacketConnListen</span><span class="op" id="6663185">(</span><span class="ident" id="6663186">t</span><span class="op" id="6663187">,</span>&nbsp;<span class="ident" id="6663189">tt</span><span class="op" id="6663191">.</span><span class="ident" id="6663192">net</span><span class="op" id="6663195">,</span>&nbsp;<span class="ident" id="6663197">tt</span><span class="op" id="6663199">.</span><span class="ident" id="6663200">addr</span><span class="op" id="6663204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663208">switch</span>&nbsp;<span class="ident" id="6663215">tt</span><span class="op" id="6663217">.</span><span class="ident" id="6663218">addr</span>&nbsp;<span class="op" id="6663223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663227">case</span>&nbsp;<span class="string" id="6663232">&#34;&#34;</span><span class="op" id="6663234">,</span>&nbsp;<span class="string" id="6663236">&#34;0.0.0.0&#34;</span><span class="op" id="6663245">,</span>&nbsp;<span class="string" id="6663247">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6663265">,</span>&nbsp;<span class="string" id="6663267">&#34;[::]&#34;</span><span class="op" id="6663273">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663277">default</span><span class="op" id="6663284">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6663289">if</span>&nbsp;<span class="ident" id="6663292">tt</span><span class="op" id="6663294">.</span><span class="ident" id="6663295">net</span>&nbsp;<span class="op" id="6663299">!=</span>&nbsp;<span class="string" id="6663302">&#34;unixgram&#34;</span>&nbsp;<span class="op" id="6663313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6663319">testFilePacketConnDial</span><span class="op" id="6663341">(</span><span class="ident" id="6663342">t</span><span class="op" id="6663343">,</span>&nbsp;<span class="ident" id="6663345">tt</span><span class="op" id="6663347">.</span><span class="ident" id="6663348">net</span><span class="op" id="6663351">,</span>&nbsp;<span class="ident" id="6663353">tt</span><span class="op" id="6663355">.</span><span class="ident" id="6663356">addr</span><span class="op" id="6663360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663372">}</span><br>
<span class="lineno">205</span><span class="op" id="6663374">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
