<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html" class="current">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1613032">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1613087">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1613141">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1613192">package</span>&nbsp;<span class="ident" id="1613200">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1613209">import</span>&nbsp;<span class="string" id="1613216">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1613226">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*m.</span><br>
<span class="lineno">10</span><span class="keyword" id="1613268">func</span>&nbsp;<span class="ident" id="1613273">gc_m_ptr</span><span class="op" id="1613281">(</span><span class="ident" id="1613282">ret</span>&nbsp;<span class="op" id="1613286">*</span><span class="keyword" id="1613287">interface</span><span class="op" id="1613296">{</span><span class="op" id="1613297">}</span><span class="op" id="1613298">)</span>&nbsp;<span class="op" id="1613300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613303">*</span><span class="ident" id="1613304">ret</span>&nbsp;<span class="op" id="1613308">=</span>&nbsp;<span class="op" id="1613310">(</span><span class="op" id="1613311">*</span><span class="ident" id="1613312">m</span><span class="op" id="1613313">)</span><span class="op" id="1613314">(</span><span class="ident" id="1613315">nil</span><span class="op" id="1613318">)</span><br>
<span class="lineno"></span><span class="op" id="1613320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1613323">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*g.</span><br>
<span class="lineno">15</span><span class="keyword" id="1613365">func</span>&nbsp;<span class="ident" id="1613370">gc_g_ptr</span><span class="op" id="1613378">(</span><span class="ident" id="1613379">ret</span>&nbsp;<span class="op" id="1613383">*</span><span class="keyword" id="1613384">interface</span><span class="op" id="1613393">{</span><span class="op" id="1613394">}</span><span class="op" id="1613395">)</span>&nbsp;<span class="op" id="1613397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613400">*</span><span class="ident" id="1613401">ret</span>&nbsp;<span class="op" id="1613405">=</span>&nbsp;<span class="op" id="1613407">(</span><span class="op" id="1613408">*</span><span class="ident" id="1613409">g</span><span class="op" id="1613410">)</span><span class="op" id="1613411">(</span><span class="ident" id="1613412">nil</span><span class="op" id="1613415">)</span><br>
<span class="lineno"></span><span class="op" id="1613417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1613420">//&nbsp;Called&nbsp;from&nbsp;C.&nbsp;Returns&nbsp;the&nbsp;Go&nbsp;type&nbsp;*itab.</span><br>
<span class="lineno">20</span><span class="keyword" id="1613465">func</span>&nbsp;<span class="ident" id="1613470">gc_itab_ptr</span><span class="op" id="1613481">(</span><span class="ident" id="1613482">ret</span>&nbsp;<span class="op" id="1613486">*</span><span class="keyword" id="1613487">interface</span><span class="op" id="1613496">{</span><span class="op" id="1613497">}</span><span class="op" id="1613498">)</span>&nbsp;<span class="op" id="1613500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613503">*</span><span class="ident" id="1613504">ret</span>&nbsp;<span class="op" id="1613508">=</span>&nbsp;<span class="op" id="1613510">(</span><span class="op" id="1613511">*</span><span class="ident" id="1613512">itab</span><span class="op" id="1613516">)</span><span class="op" id="1613517">(</span><span class="ident" id="1613518">nil</span><span class="op" id="1613521">)</span><br>
<span class="lineno"></span><span class="op" id="1613523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1613526">func</span>&nbsp;<span class="ident" id="1613531">gc_unixnanotime</span><span class="op" id="1613546">(</span><span class="ident" id="1613547">now</span>&nbsp;<span class="op" id="1613551">*</span><span class="ident" id="1613552">int64</span><span class="op" id="1613557">)</span>&nbsp;<span class="op" id="1613559">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613562">sec</span><span class="op" id="1613565">,</span>&nbsp;<span class="ident" id="1613567">nsec</span>&nbsp;<span class="op" id="1613572">:=</span>&nbsp;<span class="ident" id="1613575">timenow</span><span class="op" id="1613582">(</span><span class="op" id="1613583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613586">*</span><span class="ident" id="1613587">now</span>&nbsp;<span class="op" id="1613591">=</span>&nbsp;<span class="ident" id="1613593">sec</span><span class="op" id="1613596">*</span><span class="num" id="1613597">1e9</span>&nbsp;<span class="op" id="1613601">+</span>&nbsp;<span class="ident" id="1613603">int64</span><span class="op" id="1613608">(</span><span class="ident" id="1613609">nsec</span><span class="op" id="1613613">)</span><br>
<span class="lineno"></span><span class="op" id="1613615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1613618">func</span>&nbsp;<span class="ident" id="1613623">freeOSMemory</span><span class="op" id="1613635">(</span><span class="op" id="1613636">)</span>&nbsp;<span class="op" id="1613638">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613641">gogc</span><span class="op" id="1613645">(</span><span class="num" id="1613646">2</span><span class="op" id="1613647">)</span>&nbsp;<span class="comment" id="1613649">//&nbsp;force&nbsp;GC&nbsp;and&nbsp;do&nbsp;eager&nbsp;sweep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613681">onM</span><span class="op" id="1613684">(</span><span class="ident" id="1613685">scavenge_m</span><span class="op" id="1613695">)</span><br>
<span class="lineno"></span><span class="op" id="1613697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1613700">var</span>&nbsp;<span class="ident" id="1613704">poolcleanup</span>&nbsp;<span class="keyword" id="1613716">func</span><span class="op" id="1613720">(</span><span class="op" id="1613721">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="1613724">func</span>&nbsp;<span class="ident" id="1613729">registerPoolCleanup</span><span class="op" id="1613748">(</span><span class="ident" id="1613749">f</span>&nbsp;<span class="keyword" id="1613751">func</span><span class="op" id="1613755">(</span><span class="op" id="1613756">)</span><span class="op" id="1613757">)</span>&nbsp;<span class="op" id="1613759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613762">poolcleanup</span>&nbsp;<span class="op" id="1613774">=</span>&nbsp;<span class="ident" id="1613776">f</span><br>
<span class="lineno"></span><span class="op" id="1613778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="1613781">func</span>&nbsp;<span class="ident" id="1613786">clearpools</span><span class="op" id="1613796">(</span><span class="op" id="1613797">)</span>&nbsp;<span class="op" id="1613799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1613802">//&nbsp;clear&nbsp;sync.Pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613823">if</span>&nbsp;<span class="ident" id="1613826">poolcleanup</span>&nbsp;<span class="op" id="1613838">!=</span>&nbsp;<span class="ident" id="1613841">nil</span>&nbsp;<span class="op" id="1613845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613849">poolcleanup</span><span class="op" id="1613860">(</span><span class="op" id="1613861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613864">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613868">for</span>&nbsp;<span class="ident" id="1613872">_</span><span class="op" id="1613873">,</span>&nbsp;<span class="ident" id="1613875">p</span>&nbsp;<span class="op" id="1613877">:=</span>&nbsp;<span class="keyword" id="1613880">range</span>&nbsp;<span class="op" id="1613886">&amp;</span><span class="ident" id="1613887">allp</span>&nbsp;<span class="op" id="1613892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613896">if</span>&nbsp;<span class="ident" id="1613899">p</span>&nbsp;<span class="op" id="1613901">==</span>&nbsp;<span class="ident" id="1613904">nil</span>&nbsp;<span class="op" id="1613908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613913">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613921">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1613925">//&nbsp;clear&nbsp;tinyalloc&nbsp;pool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613951">if</span>&nbsp;<span class="ident" id="1613954">c</span>&nbsp;<span class="op" id="1613956">:=</span>&nbsp;<span class="ident" id="1613959">p</span><span class="op" id="1613960">.</span><span class="ident" id="1613961">mcache</span><span class="op" id="1613967">;</span>&nbsp;<span class="ident" id="1613969">c</span>&nbsp;<span class="op" id="1613971">!=</span>&nbsp;<span class="ident" id="1613974">nil</span>&nbsp;<span class="op" id="1613978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613983">c</span><span class="op" id="1613984">.</span><span class="ident" id="1613985">tiny</span>&nbsp;<span class="op" id="1613990">=</span>&nbsp;<span class="ident" id="1613992">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613999">c</span><span class="op" id="1614000">.</span><span class="ident" id="1614001">tinysize</span>&nbsp;<span class="op" id="1614010">=</span>&nbsp;<span class="num" id="1614012">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614018">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614080">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614148">var</span>&nbsp;<span class="ident" id="1614152">sg</span><span class="op" id="1614154">,</span>&nbsp;<span class="ident" id="1614156">sgnext</span>&nbsp;<span class="op" id="1614163">*</span><span class="ident" id="1614164">sudog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614173">for</span>&nbsp;<span class="ident" id="1614177">sg</span>&nbsp;<span class="op" id="1614180">=</span>&nbsp;<span class="ident" id="1614182">c</span><span class="op" id="1614183">.</span><span class="ident" id="1614184">sudogcache</span><span class="op" id="1614194">;</span>&nbsp;<span class="ident" id="1614196">sg</span>&nbsp;<span class="op" id="1614199">!=</span>&nbsp;<span class="ident" id="1614202">nil</span><span class="op" id="1614205">;</span>&nbsp;<span class="ident" id="1614207">sg</span>&nbsp;<span class="op" id="1614210">=</span>&nbsp;<span class="ident" id="1614212">sgnext</span>&nbsp;<span class="op" id="1614219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614225">sgnext</span>&nbsp;<span class="op" id="1614232">=</span>&nbsp;<span class="ident" id="1614234">sg</span><span class="op" id="1614236">.</span><span class="ident" id="1614237">next</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614246">sg</span><span class="op" id="1614248">.</span><span class="ident" id="1614249">next</span>&nbsp;<span class="op" id="1614254">=</span>&nbsp;<span class="ident" id="1614256">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614268">c</span><span class="op" id="1614269">.</span><span class="ident" id="1614270">sudogcache</span>&nbsp;<span class="op" id="1614281">=</span>&nbsp;<span class="ident" id="1614283">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614294">//&nbsp;clear&nbsp;defer&nbsp;pools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614317">for</span>&nbsp;<span class="ident" id="1614321">i</span>&nbsp;<span class="op" id="1614323">:=</span>&nbsp;<span class="keyword" id="1614326">range</span>&nbsp;<span class="ident" id="1614332">p</span><span class="op" id="1614333">.</span><span class="ident" id="1614334">deferpool</span>&nbsp;<span class="op" id="1614344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614349">//&nbsp;disconnect&nbsp;cached&nbsp;list&nbsp;before&nbsp;dropping&nbsp;it&nbsp;on&nbsp;the&nbsp;floor,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614411">//&nbsp;so&nbsp;that&nbsp;a&nbsp;dangling&nbsp;ref&nbsp;to&nbsp;one&nbsp;entry&nbsp;does&nbsp;not&nbsp;pin&nbsp;all&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614479">var</span>&nbsp;<span class="ident" id="1614483">d</span><span class="op" id="1614484">,</span>&nbsp;<span class="ident" id="1614486">dlink</span>&nbsp;<span class="op" id="1614492">*</span><span class="ident" id="1614493">_defer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614503">for</span>&nbsp;<span class="ident" id="1614507">d</span>&nbsp;<span class="op" id="1614509">=</span>&nbsp;<span class="ident" id="1614511">p</span><span class="op" id="1614512">.</span><span class="ident" id="1614513">deferpool</span><span class="op" id="1614522">[</span><span class="ident" id="1614523">i</span><span class="op" id="1614524">]</span><span class="op" id="1614525">;</span>&nbsp;<span class="ident" id="1614527">d</span>&nbsp;<span class="op" id="1614529">!=</span>&nbsp;<span class="ident" id="1614532">nil</span><span class="op" id="1614535">;</span>&nbsp;<span class="ident" id="1614537">d</span>&nbsp;<span class="op" id="1614539">=</span>&nbsp;<span class="ident" id="1614541">dlink</span>&nbsp;<span class="op" id="1614547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614553">dlink</span>&nbsp;<span class="op" id="1614559">=</span>&nbsp;<span class="ident" id="1614561">d</span><span class="op" id="1614562">.</span><span class="ident" id="1614563">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614572">d</span><span class="op" id="1614573">.</span><span class="ident" id="1614574">link</span>&nbsp;<span class="op" id="1614579">=</span>&nbsp;<span class="ident" id="1614581">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614593">p</span><span class="op" id="1614594">.</span><span class="ident" id="1614595">deferpool</span><span class="op" id="1614604">[</span><span class="ident" id="1614605">i</span><span class="op" id="1614606">]</span>&nbsp;<span class="op" id="1614608">=</span>&nbsp;<span class="ident" id="1614610">nil</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614619">}</span><br>
<span class="lineno"></span><span class="op" id="1614621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1614624">func</span>&nbsp;<span class="ident" id="1614629">gosweepone</span><span class="op" id="1614639">(</span><span class="op" id="1614640">)</span>&nbsp;<span class="builtintype" id="1614642">uintptr</span><br>
<span class="lineno">80</span><span class="keyword" id="1614650">func</span>&nbsp;<span class="ident" id="1614655">gosweepdone</span><span class="op" id="1614666">(</span><span class="op" id="1614667">)</span>&nbsp;<span class="builtintype" id="1614669">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1614675">func</span>&nbsp;<span class="ident" id="1614680">bgsweep</span><span class="op" id="1614687">(</span><span class="op" id="1614688">)</span>&nbsp;<span class="op" id="1614690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614693">getg</span><span class="op" id="1614697">(</span><span class="op" id="1614698">)</span><span class="op" id="1614699">.</span><span class="ident" id="1614700">issystem</span>&nbsp;<span class="op" id="1614709">=</span>&nbsp;<span class="builtintype" id="1614711">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614717">for</span>&nbsp;<span class="op" id="1614721">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614725">for</span>&nbsp;<span class="ident" id="1614729">gosweepone</span><span class="op" id="1614739">(</span><span class="op" id="1614740">)</span>&nbsp;<span class="op" id="1614742">!=</span>&nbsp;<span class="op" id="1614745">^</span><span class="builtintype" id="1614746">uintptr</span><span class="op" id="1614753">(</span><span class="num" id="1614754">0</span><span class="op" id="1614755">)</span>&nbsp;<span class="op" id="1614757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614762">sweep</span><span class="op" id="1614767">.</span><span class="ident" id="1614768">nbgsweep</span><span class="op" id="1614776">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614782">Gosched</span><span class="op" id="1614789">(</span><span class="op" id="1614790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614798">lock</span><span class="op" id="1614802">(</span><span class="op" id="1614803">&amp;</span><span class="ident" id="1614804">gclock</span><span class="op" id="1614810">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614814">if</span>&nbsp;<span class="op" id="1614817">!</span><span class="ident" id="1614818">gosweepdone</span><span class="op" id="1614829">(</span><span class="op" id="1614830">)</span>&nbsp;<span class="op" id="1614832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614837">//&nbsp;This&nbsp;can&nbsp;happen&nbsp;if&nbsp;a&nbsp;GC&nbsp;runs&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614880">//&nbsp;gosweepone&nbsp;returning&nbsp;^0&nbsp;above</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1614916">//&nbsp;and&nbsp;the&nbsp;lock&nbsp;being&nbsp;acquired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614951">unlock</span><span class="op" id="1614957">(</span><span class="op" id="1614958">&amp;</span><span class="ident" id="1614959">gclock</span><span class="op" id="1614965">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614970">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614985">sweep</span><span class="op" id="1614990">.</span><span class="ident" id="1614991">parked</span>&nbsp;<span class="op" id="1614998">=</span>&nbsp;<span class="builtintype" id="1615000">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615007">goparkunlock</span><span class="op" id="1615019">(</span><span class="op" id="1615020">&amp;</span><span class="ident" id="1615021">gclock</span><span class="op" id="1615027">,</span>&nbsp;<span class="string" id="1615029">&#34;GC&nbsp;sweep&nbsp;wait&#34;</span><span class="op" id="1615044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1615047">}</span><br>
<span class="lineno">100</span><span class="op" id="1615049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615052">//&nbsp;NOTE:&nbsp;Really&nbsp;dst&nbsp;*unsafe.Pointer,&nbsp;src&nbsp;unsafe.Pointer,</span><br>
<span class="lineno"></span><span class="comment" id="1615109">//&nbsp;but&nbsp;if&nbsp;we&nbsp;do&nbsp;that,&nbsp;Go&nbsp;inserts&nbsp;a&nbsp;write&nbsp;barrier&nbsp;on&nbsp;*dst&nbsp;=&nbsp;src.</span><br>
<span class="lineno"></span><span class="comment" id="1615173">//go:nosplit</span><br>
<span class="lineno">105</span><span class="keyword" id="1615186">func</span>&nbsp;<span class="ident" id="1615191">writebarrierptr</span><span class="op" id="1615206">(</span><span class="ident" id="1615207">dst</span>&nbsp;<span class="op" id="1615211">*</span><span class="builtintype" id="1615212">uintptr</span><span class="op" id="1615219">,</span>&nbsp;<span class="ident" id="1615221">src</span>&nbsp;<span class="builtintype" id="1615225">uintptr</span><span class="op" id="1615232">)</span>&nbsp;<span class="op" id="1615234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1615237">*</span><span class="ident" id="1615238">dst</span>&nbsp;<span class="op" id="1615242">=</span>&nbsp;<span class="ident" id="1615244">src</span><br>
<span class="lineno"></span><span class="op" id="1615248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615251">//go:nosplit</span><br>
<span class="lineno">110</span><span class="keyword" id="1615264">func</span>&nbsp;<span class="ident" id="1615269">writebarrierstring</span><span class="op" id="1615287">(</span><span class="ident" id="1615288">dst</span>&nbsp;<span class="op" id="1615292">*</span><span class="op" id="1615293">[</span><span class="num" id="1615294">2</span><span class="op" id="1615295">]</span><span class="builtintype" id="1615296">uintptr</span><span class="op" id="1615303">,</span>&nbsp;<span class="ident" id="1615305">src</span>&nbsp;<span class="op" id="1615309">[</span><span class="num" id="1615310">2</span><span class="op" id="1615311">]</span><span class="builtintype" id="1615312">uintptr</span><span class="op" id="1615319">)</span>&nbsp;<span class="op" id="1615321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615324">dst</span><span class="op" id="1615327">[</span><span class="num" id="1615328">0</span><span class="op" id="1615329">]</span>&nbsp;<span class="op" id="1615331">=</span>&nbsp;<span class="ident" id="1615333">src</span><span class="op" id="1615336">[</span><span class="num" id="1615337">0</span><span class="op" id="1615338">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615341">dst</span><span class="op" id="1615344">[</span><span class="num" id="1615345">1</span><span class="op" id="1615346">]</span>&nbsp;<span class="op" id="1615348">=</span>&nbsp;<span class="ident" id="1615350">src</span><span class="op" id="1615353">[</span><span class="num" id="1615354">1</span><span class="op" id="1615355">]</span><br>
<span class="lineno"></span><span class="op" id="1615357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1615360">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1615373">func</span>&nbsp;<span class="ident" id="1615378">writebarrierslice</span><span class="op" id="1615395">(</span><span class="ident" id="1615396">dst</span>&nbsp;<span class="op" id="1615400">*</span><span class="op" id="1615401">[</span><span class="num" id="1615402">3</span><span class="op" id="1615403">]</span><span class="builtintype" id="1615404">uintptr</span><span class="op" id="1615411">,</span>&nbsp;<span class="ident" id="1615413">src</span>&nbsp;<span class="op" id="1615417">[</span><span class="num" id="1615418">3</span><span class="op" id="1615419">]</span><span class="builtintype" id="1615420">uintptr</span><span class="op" id="1615427">)</span>&nbsp;<span class="op" id="1615429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615432">dst</span><span class="op" id="1615435">[</span><span class="num" id="1615436">0</span><span class="op" id="1615437">]</span>&nbsp;<span class="op" id="1615439">=</span>&nbsp;<span class="ident" id="1615441">src</span><span class="op" id="1615444">[</span><span class="num" id="1615445">0</span><span class="op" id="1615446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615449">dst</span><span class="op" id="1615452">[</span><span class="num" id="1615453">1</span><span class="op" id="1615454">]</span>&nbsp;<span class="op" id="1615456">=</span>&nbsp;<span class="ident" id="1615458">src</span><span class="op" id="1615461">[</span><span class="num" id="1615462">1</span><span class="op" id="1615463">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615466">dst</span><span class="op" id="1615469">[</span><span class="num" id="1615470">2</span><span class="op" id="1615471">]</span>&nbsp;<span class="op" id="1615473">=</span>&nbsp;<span class="ident" id="1615475">src</span><span class="op" id="1615478">[</span><span class="num" id="1615479">2</span><span class="op" id="1615480">]</span><br>
<span class="lineno">120</span><span class="op" id="1615482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615485">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1615498">func</span>&nbsp;<span class="ident" id="1615503">writebarrieriface</span><span class="op" id="1615520">(</span><span class="ident" id="1615521">dst</span>&nbsp;<span class="op" id="1615525">*</span><span class="op" id="1615526">[</span><span class="num" id="1615527">2</span><span class="op" id="1615528">]</span><span class="builtintype" id="1615529">uintptr</span><span class="op" id="1615536">,</span>&nbsp;<span class="ident" id="1615538">src</span>&nbsp;<span class="op" id="1615542">[</span><span class="num" id="1615543">2</span><span class="op" id="1615544">]</span><span class="builtintype" id="1615545">uintptr</span><span class="op" id="1615552">)</span>&nbsp;<span class="op" id="1615554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615557">dst</span><span class="op" id="1615560">[</span><span class="num" id="1615561">0</span><span class="op" id="1615562">]</span>&nbsp;<span class="op" id="1615564">=</span>&nbsp;<span class="ident" id="1615566">src</span><span class="op" id="1615569">[</span><span class="num" id="1615570">0</span><span class="op" id="1615571">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615574">dst</span><span class="op" id="1615577">[</span><span class="num" id="1615578">1</span><span class="op" id="1615579">]</span>&nbsp;<span class="op" id="1615581">=</span>&nbsp;<span class="ident" id="1615583">src</span><span class="op" id="1615586">[</span><span class="num" id="1615587">1</span><span class="op" id="1615588">]</span><br>
<span class="lineno"></span><span class="op" id="1615590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615593">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1615606">func</span>&nbsp;<span class="ident" id="1615611">writebarrierfat2</span><span class="op" id="1615627">(</span><span class="ident" id="1615628">dst</span>&nbsp;<span class="op" id="1615632">*</span><span class="op" id="1615633">[</span><span class="num" id="1615634">2</span><span class="op" id="1615635">]</span><span class="builtintype" id="1615636">uintptr</span><span class="op" id="1615643">,</span>&nbsp;<span class="ident" id="1615645">_</span>&nbsp;<span class="op" id="1615647">*</span><span class="builtintype" id="1615648">byte</span><span class="op" id="1615652">,</span>&nbsp;<span class="ident" id="1615654">src</span>&nbsp;<span class="op" id="1615658">[</span><span class="num" id="1615659">2</span><span class="op" id="1615660">]</span><span class="builtintype" id="1615661">uintptr</span><span class="op" id="1615668">)</span>&nbsp;<span class="op" id="1615670">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615673">dst</span><span class="op" id="1615676">[</span><span class="num" id="1615677">0</span><span class="op" id="1615678">]</span>&nbsp;<span class="op" id="1615680">=</span>&nbsp;<span class="ident" id="1615682">src</span><span class="op" id="1615685">[</span><span class="num" id="1615686">0</span><span class="op" id="1615687">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615690">dst</span><span class="op" id="1615693">[</span><span class="num" id="1615694">1</span><span class="op" id="1615695">]</span>&nbsp;<span class="op" id="1615697">=</span>&nbsp;<span class="ident" id="1615699">src</span><span class="op" id="1615702">[</span><span class="num" id="1615703">1</span><span class="op" id="1615704">]</span><br>
<span class="lineno"></span><span class="op" id="1615706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615709">//go:nosplit</span><br>
<span class="lineno">135</span><span class="keyword" id="1615722">func</span>&nbsp;<span class="ident" id="1615727">writebarrierfat3</span><span class="op" id="1615743">(</span><span class="ident" id="1615744">dst</span>&nbsp;<span class="op" id="1615748">*</span><span class="op" id="1615749">[</span><span class="num" id="1615750">3</span><span class="op" id="1615751">]</span><span class="builtintype" id="1615752">uintptr</span><span class="op" id="1615759">,</span>&nbsp;<span class="ident" id="1615761">_</span>&nbsp;<span class="op" id="1615763">*</span><span class="builtintype" id="1615764">byte</span><span class="op" id="1615768">,</span>&nbsp;<span class="ident" id="1615770">src</span>&nbsp;<span class="op" id="1615774">[</span><span class="num" id="1615775">3</span><span class="op" id="1615776">]</span><span class="builtintype" id="1615777">uintptr</span><span class="op" id="1615784">)</span>&nbsp;<span class="op" id="1615786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615789">dst</span><span class="op" id="1615792">[</span><span class="num" id="1615793">0</span><span class="op" id="1615794">]</span>&nbsp;<span class="op" id="1615796">=</span>&nbsp;<span class="ident" id="1615798">src</span><span class="op" id="1615801">[</span><span class="num" id="1615802">0</span><span class="op" id="1615803">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615806">dst</span><span class="op" id="1615809">[</span><span class="num" id="1615810">1</span><span class="op" id="1615811">]</span>&nbsp;<span class="op" id="1615813">=</span>&nbsp;<span class="ident" id="1615815">src</span><span class="op" id="1615818">[</span><span class="num" id="1615819">1</span><span class="op" id="1615820">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615823">dst</span><span class="op" id="1615826">[</span><span class="num" id="1615827">2</span><span class="op" id="1615828">]</span>&nbsp;<span class="op" id="1615830">=</span>&nbsp;<span class="ident" id="1615832">src</span><span class="op" id="1615835">[</span><span class="num" id="1615836">2</span><span class="op" id="1615837">]</span><br>
<span class="lineno"></span><span class="op" id="1615839">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1615842">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1615855">func</span>&nbsp;<span class="ident" id="1615860">writebarrierfat4</span><span class="op" id="1615876">(</span><span class="ident" id="1615877">dst</span>&nbsp;<span class="op" id="1615881">*</span><span class="op" id="1615882">[</span><span class="num" id="1615883">4</span><span class="op" id="1615884">]</span><span class="builtintype" id="1615885">uintptr</span><span class="op" id="1615892">,</span>&nbsp;<span class="ident" id="1615894">_</span>&nbsp;<span class="op" id="1615896">*</span><span class="builtintype" id="1615897">byte</span><span class="op" id="1615901">,</span>&nbsp;<span class="ident" id="1615903">src</span>&nbsp;<span class="op" id="1615907">[</span><span class="num" id="1615908">4</span><span class="op" id="1615909">]</span><span class="builtintype" id="1615910">uintptr</span><span class="op" id="1615917">)</span>&nbsp;<span class="op" id="1615919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615922">dst</span><span class="op" id="1615925">[</span><span class="num" id="1615926">0</span><span class="op" id="1615927">]</span>&nbsp;<span class="op" id="1615929">=</span>&nbsp;<span class="ident" id="1615931">src</span><span class="op" id="1615934">[</span><span class="num" id="1615935">0</span><span class="op" id="1615936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615939">dst</span><span class="op" id="1615942">[</span><span class="num" id="1615943">1</span><span class="op" id="1615944">]</span>&nbsp;<span class="op" id="1615946">=</span>&nbsp;<span class="ident" id="1615948">src</span><span class="op" id="1615951">[</span><span class="num" id="1615952">1</span><span class="op" id="1615953">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615956">dst</span><span class="op" id="1615959">[</span><span class="num" id="1615960">2</span><span class="op" id="1615961">]</span>&nbsp;<span class="op" id="1615963">=</span>&nbsp;<span class="ident" id="1615965">src</span><span class="op" id="1615968">[</span><span class="num" id="1615969">2</span><span class="op" id="1615970">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615973">dst</span><span class="op" id="1615976">[</span><span class="num" id="1615977">3</span><span class="op" id="1615978">]</span>&nbsp;<span class="op" id="1615980">=</span>&nbsp;<span class="ident" id="1615982">src</span><span class="op" id="1615985">[</span><span class="num" id="1615986">3</span><span class="op" id="1615987">]</span><br>
<span class="lineno"></span><span class="op" id="1615989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615992">//go:nosplit</span><br>
<span class="lineno">150</span><span class="keyword" id="1616005">func</span>&nbsp;<span class="ident" id="1616010">writebarrierfat</span><span class="op" id="1616025">(</span><span class="ident" id="1616026">typ</span>&nbsp;<span class="op" id="1616030">*</span><span class="ident" id="1616031">_type</span><span class="op" id="1616036">,</span>&nbsp;<span class="ident" id="1616038">dst</span><span class="op" id="1616041">,</span>&nbsp;<span class="ident" id="1616043">src</span>&nbsp;<span class="ident" id="1616047">unsafe</span><span class="op" id="1616053">.</span><span class="ident" id="1616054">Pointer</span><span class="op" id="1616061">)</span>&nbsp;<span class="op" id="1616063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616066">memmove</span><span class="op" id="1616073">(</span><span class="ident" id="1616074">dst</span><span class="op" id="1616077">,</span>&nbsp;<span class="ident" id="1616079">src</span><span class="op" id="1616082">,</span>&nbsp;<span class="ident" id="1616084">typ</span><span class="op" id="1616087">.</span><span class="ident" id="1616088">size</span><span class="op" id="1616092">)</span><br>
<span class="lineno"></span><span class="op" id="1616094">}</span>
</div>
</body>
</html>
