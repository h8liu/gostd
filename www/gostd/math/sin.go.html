<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html" class="current">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2212175">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2212230">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2212284">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2212335">package</span>&nbsp;<span class="ident" id="2212343">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212349">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2212389">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2212449">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2212513">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2212571">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2212629">//</span><br>
<span class="lineno"></span><span class="comment" id="2212632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2212646">//</span><br>
<span class="lineno"></span><span class="comment" id="2212649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2212671">//</span><br>
<span class="lineno">20</span><span class="comment" id="2212674">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2212687">//</span><br>
<span class="lineno"></span><span class="comment" id="2212690">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2212713">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2212730">//</span><br>
<span class="lineno">25</span><span class="comment" id="2212733">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2212749">//</span><br>
<span class="lineno"></span><span class="comment" id="2212752">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2212829">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2212899">//</span><br>
<span class="lineno">30</span><span class="comment" id="2212902">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2212958">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2213008">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2213036">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2213090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2213118">//</span><br>
<span class="lineno"></span><span class="comment" id="2213121">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2213134">//</span><br>
<span class="lineno"></span><span class="comment" id="2213137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2213177">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2213236">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2213297">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2213358">//</span><br>
<span class="lineno"></span><span class="comment" id="2213361">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2213439">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2213515">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2213557">//</span><br>
<span class="lineno"></span><span class="comment" id="2213560">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2213574">//</span><br>
<span class="lineno"></span><span class="comment" id="2213577">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2213601">//</span><br>
<span class="lineno"></span><span class="comment" id="2213604">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2213617">//</span><br>
<span class="lineno"></span><span class="comment" id="2213620">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2213643">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2213660">//</span><br>
<span class="lineno"></span><span class="comment" id="2213663">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2213679">//</span><br>
<span class="lineno"></span><span class="comment" id="2213682">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2213759">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2213829">//</span><br>
<span class="lineno"></span><span class="comment" id="2213832">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2213888">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2213940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2213968">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2214020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2214048">//</span><br>
<span class="lineno"></span><span class="comment" id="2214051">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2214064">//</span><br>
<span class="lineno"></span><span class="comment" id="2214067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2214107">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2214166">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2214227">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2214288">//</span><br>
<span class="lineno"></span><span class="comment" id="2214291">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2214339">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2214403">//</span><br>
<span class="lineno"></span><span class="comment" id="2214406">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2214467">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2214537">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2214612">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2214679">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2214752">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2214824">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2214838">//</span><br>
<span class="lineno">85</span><span class="comment" id="2214841">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2214907">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2214973">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2214986">//</span><br>
<span class="lineno"></span><span class="comment" id="2214989">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2215013">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2215043">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2215063">var</span>&nbsp;<span class="ident" id="2215067">_sin</span>&nbsp;<span class="op" id="2215072">=</span>&nbsp;<span class="op" id="2215074">[</span><span class="op" id="2215075">...</span><span class="op" id="2215078">]</span><span class="builtintype" id="2215079">float64</span><span class="op" id="2215086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215089">1.58962301576546568060E-10</span><span class="op" id="2215115">,</span>&nbsp;<span class="comment" id="2215117">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215140">-</span><span class="num" id="2215141">2.50507477628578072866E-8</span><span class="op" id="2215166">,</span>&nbsp;<span class="comment" id="2215168">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215191">2.75573136213857245213E-6</span><span class="op" id="2215216">,</span>&nbsp;&nbsp;<span class="comment" id="2215219">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215242">-</span><span class="num" id="2215243">1.98412698295895385996E-4</span><span class="op" id="2215268">,</span>&nbsp;<span class="comment" id="2215270">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215293">8.33333333332211858878E-3</span><span class="op" id="2215318">,</span>&nbsp;&nbsp;<span class="comment" id="2215321">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215344">-</span><span class="num" id="2215345">1.66666666666666307295E-1</span><span class="op" id="2215370">,</span>&nbsp;<span class="comment" id="2215372">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2215394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2215397">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2215417">var</span>&nbsp;<span class="ident" id="2215421">_cos</span>&nbsp;<span class="op" id="2215426">=</span>&nbsp;<span class="op" id="2215428">[</span><span class="op" id="2215429">...</span><span class="op" id="2215432">]</span><span class="builtintype" id="2215433">float64</span><span class="op" id="2215440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215443">-</span><span class="num" id="2215444">1.13585365213876817300E-11</span><span class="op" id="2215470">,</span>&nbsp;<span class="comment" id="2215472">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215495">2.08757008419747316778E-9</span><span class="op" id="2215520">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2215524">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215547">-</span><span class="num" id="2215548">2.75573141792967388112E-7</span><span class="op" id="2215573">,</span>&nbsp;&nbsp;<span class="comment" id="2215576">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215599">2.48015872888517045348E-5</span><span class="op" id="2215624">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2215628">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215651">-</span><span class="num" id="2215652">1.38888888888730564116E-3</span><span class="op" id="2215677">,</span>&nbsp;&nbsp;<span class="comment" id="2215680">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2215703">4.16666666666665929218E-2</span><span class="op" id="2215728">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2215732">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2215754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2215757">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2215809">//</span><br>
<span class="lineno"></span><span class="comment" id="2215812">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2215834">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2215854">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2215872">func</span>&nbsp;<span class="ident" id="2215877">Cos</span><span class="op" id="2215880">(</span><span class="ident" id="2215881">x</span>&nbsp;<span class="builtintype" id="2215883">float64</span><span class="op" id="2215890">)</span>&nbsp;<span class="builtintype" id="2215892">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2215901">func</span>&nbsp;<span class="ident" id="2215906">cos</span><span class="op" id="2215909">(</span><span class="ident" id="2215910">x</span>&nbsp;<span class="builtintype" id="2215912">float64</span><span class="op" id="2215919">)</span>&nbsp;<span class="builtintype" id="2215921">float64</span>&nbsp;<span class="op" id="2215929">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215932">const</span>&nbsp;<span class="op" id="2215938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215942">PI4A</span>&nbsp;<span class="op" id="2215947">=</span>&nbsp;<span class="num" id="2215949">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216003">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216056">PI4B</span>&nbsp;<span class="op" id="2216061">=</span>&nbsp;<span class="num" id="2216063">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216117">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216142">PI4C</span>&nbsp;<span class="op" id="2216147">=</span>&nbsp;<span class="num" id="2216149">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216203">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216228">M4PI</span>&nbsp;<span class="op" id="2216233">=</span>&nbsp;<span class="num" id="2216235">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2216289">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216301">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216319">switch</span>&nbsp;<span class="op" id="2216326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216329">case</span>&nbsp;<span class="ident" id="2216334">IsNaN</span><span class="op" id="2216339">(</span><span class="ident" id="2216340">x</span><span class="op" id="2216341">)</span>&nbsp;<span class="op" id="2216343">||</span>&nbsp;<span class="ident" id="2216346">IsInf</span><span class="op" id="2216351">(</span><span class="ident" id="2216352">x</span><span class="op" id="2216353">,</span>&nbsp;<span class="num" id="2216355">0</span><span class="op" id="2216356">)</span><span class="op" id="2216357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216361">return</span>&nbsp;<span class="ident" id="2216368">NaN</span><span class="op" id="2216371">(</span><span class="op" id="2216372">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216379">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216406">sign</span>&nbsp;<span class="op" id="2216411">:=</span>&nbsp;<span class="builtintype" id="2216414">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216421">if</span>&nbsp;<span class="ident" id="2216424">x</span>&nbsp;<span class="op" id="2216426">&lt;</span>&nbsp;<span class="num" id="2216428">0</span>&nbsp;<span class="op" id="2216430">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216434">x</span>&nbsp;<span class="op" id="2216436">=</span>&nbsp;<span class="op" id="2216438">-</span><span class="ident" id="2216439">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216446">j</span>&nbsp;<span class="op" id="2216448">:=</span>&nbsp;<span class="ident" id="2216451">int64</span><span class="op" id="2216456">(</span><span class="ident" id="2216457">x</span>&nbsp;<span class="op" id="2216459">*</span>&nbsp;<span class="ident" id="2216461">M4PI</span><span class="op" id="2216465">)</span>&nbsp;<span class="comment" id="2216467">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216537">y</span>&nbsp;<span class="op" id="2216539">:=</span>&nbsp;<span class="builtintype" id="2216542">float64</span><span class="op" id="2216549">(</span><span class="ident" id="2216550">j</span><span class="op" id="2216551">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216558">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216598">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216622">if</span>&nbsp;<span class="ident" id="2216625">j</span><span class="op" id="2216626">&amp;</span><span class="num" id="2216627">1</span>&nbsp;<span class="op" id="2216629">==</span>&nbsp;<span class="num" id="2216632">1</span>&nbsp;<span class="op" id="2216634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216638">j</span>&nbsp;<span class="op" id="2216640">+=</span>&nbsp;<span class="num" id="2216643">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216647">y</span>&nbsp;<span class="op" id="2216649">+=</span>&nbsp;<span class="num" id="2216652">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216658">j</span>&nbsp;<span class="op" id="2216660">&amp;=</span>&nbsp;<span class="num" id="2216663">7</span>&nbsp;<span class="comment" id="2216665">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216709">if</span>&nbsp;<span class="ident" id="2216712">j</span>&nbsp;<span class="op" id="2216714">&gt;</span>&nbsp;<span class="num" id="2216716">3</span>&nbsp;<span class="op" id="2216718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216722">j</span>&nbsp;<span class="op" id="2216724">-=</span>&nbsp;<span class="num" id="2216727">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216731">sign</span>&nbsp;<span class="op" id="2216736">=</span>&nbsp;<span class="op" id="2216738">!</span><span class="ident" id="2216739">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216748">if</span>&nbsp;<span class="ident" id="2216751">j</span>&nbsp;<span class="op" id="2216753">&gt;</span>&nbsp;<span class="num" id="2216755">1</span>&nbsp;<span class="op" id="2216757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216761">sign</span>&nbsp;<span class="op" id="2216766">=</span>&nbsp;<span class="op" id="2216768">!</span><span class="ident" id="2216769">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216779">z</span>&nbsp;<span class="op" id="2216781">:=</span>&nbsp;<span class="op" id="2216784">(</span><span class="op" id="2216785">(</span><span class="ident" id="2216786">x</span>&nbsp;<span class="op" id="2216788">-</span>&nbsp;<span class="ident" id="2216790">y</span><span class="op" id="2216791">*</span><span class="ident" id="2216792">PI4A</span><span class="op" id="2216796">)</span>&nbsp;<span class="op" id="2216798">-</span>&nbsp;<span class="ident" id="2216800">y</span><span class="op" id="2216801">*</span><span class="ident" id="2216802">PI4B</span><span class="op" id="2216806">)</span>&nbsp;<span class="op" id="2216808">-</span>&nbsp;<span class="ident" id="2216810">y</span><span class="op" id="2216811">*</span><span class="ident" id="2216812">PI4C</span>&nbsp;<span class="comment" id="2216817">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216859">zz</span>&nbsp;<span class="op" id="2216862">:=</span>&nbsp;<span class="ident" id="2216865">z</span>&nbsp;<span class="op" id="2216867">*</span>&nbsp;<span class="ident" id="2216869">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216872">if</span>&nbsp;<span class="ident" id="2216875">j</span>&nbsp;<span class="op" id="2216877">==</span>&nbsp;<span class="num" id="2216880">1</span>&nbsp;<span class="op" id="2216882">||</span>&nbsp;<span class="ident" id="2216885">j</span>&nbsp;<span class="op" id="2216887">==</span>&nbsp;<span class="num" id="2216890">2</span>&nbsp;<span class="op" id="2216892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216896">y</span>&nbsp;<span class="op" id="2216898">=</span>&nbsp;<span class="ident" id="2216900">z</span>&nbsp;<span class="op" id="2216902">+</span>&nbsp;<span class="ident" id="2216904">z</span><span class="op" id="2216905">*</span><span class="ident" id="2216906">zz</span><span class="op" id="2216908">*</span><span class="op" id="2216909">(</span><span class="op" id="2216910">(</span><span class="op" id="2216911">(</span><span class="op" id="2216912">(</span><span class="op" id="2216913">(</span><span class="op" id="2216914">(</span><span class="ident" id="2216915">_sin</span><span class="op" id="2216919">[</span><span class="num" id="2216920">0</span><span class="op" id="2216921">]</span><span class="op" id="2216922">*</span><span class="ident" id="2216923">zz</span><span class="op" id="2216925">)</span><span class="op" id="2216926">+</span><span class="ident" id="2216927">_sin</span><span class="op" id="2216931">[</span><span class="num" id="2216932">1</span><span class="op" id="2216933">]</span><span class="op" id="2216934">)</span><span class="op" id="2216935">*</span><span class="ident" id="2216936">zz</span><span class="op" id="2216938">+</span><span class="ident" id="2216939">_sin</span><span class="op" id="2216943">[</span><span class="num" id="2216944">2</span><span class="op" id="2216945">]</span><span class="op" id="2216946">)</span><span class="op" id="2216947">*</span><span class="ident" id="2216948">zz</span><span class="op" id="2216950">+</span><span class="ident" id="2216951">_sin</span><span class="op" id="2216955">[</span><span class="num" id="2216956">3</span><span class="op" id="2216957">]</span><span class="op" id="2216958">)</span><span class="op" id="2216959">*</span><span class="ident" id="2216960">zz</span><span class="op" id="2216962">+</span><span class="ident" id="2216963">_sin</span><span class="op" id="2216967">[</span><span class="num" id="2216968">4</span><span class="op" id="2216969">]</span><span class="op" id="2216970">)</span><span class="op" id="2216971">*</span><span class="ident" id="2216972">zz</span><span class="op" id="2216974">+</span><span class="ident" id="2216975">_sin</span><span class="op" id="2216979">[</span><span class="num" id="2216980">5</span><span class="op" id="2216981">]</span><span class="op" id="2216982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216985">}</span>&nbsp;<span class="keyword" id="2216987">else</span>&nbsp;<span class="op" id="2216992">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216996">y</span>&nbsp;<span class="op" id="2216998">=</span>&nbsp;<span class="num" id="2217000">1.0</span>&nbsp;<span class="op" id="2217004">-</span>&nbsp;<span class="num" id="2217006">0.5</span><span class="op" id="2217009">*</span><span class="ident" id="2217010">zz</span>&nbsp;<span class="op" id="2217013">+</span>&nbsp;<span class="ident" id="2217015">zz</span><span class="op" id="2217017">*</span><span class="ident" id="2217018">zz</span><span class="op" id="2217020">*</span><span class="op" id="2217021">(</span><span class="op" id="2217022">(</span><span class="op" id="2217023">(</span><span class="op" id="2217024">(</span><span class="op" id="2217025">(</span><span class="op" id="2217026">(</span><span class="ident" id="2217027">_cos</span><span class="op" id="2217031">[</span><span class="num" id="2217032">0</span><span class="op" id="2217033">]</span><span class="op" id="2217034">*</span><span class="ident" id="2217035">zz</span><span class="op" id="2217037">)</span><span class="op" id="2217038">+</span><span class="ident" id="2217039">_cos</span><span class="op" id="2217043">[</span><span class="num" id="2217044">1</span><span class="op" id="2217045">]</span><span class="op" id="2217046">)</span><span class="op" id="2217047">*</span><span class="ident" id="2217048">zz</span><span class="op" id="2217050">+</span><span class="ident" id="2217051">_cos</span><span class="op" id="2217055">[</span><span class="num" id="2217056">2</span><span class="op" id="2217057">]</span><span class="op" id="2217058">)</span><span class="op" id="2217059">*</span><span class="ident" id="2217060">zz</span><span class="op" id="2217062">+</span><span class="ident" id="2217063">_cos</span><span class="op" id="2217067">[</span><span class="num" id="2217068">3</span><span class="op" id="2217069">]</span><span class="op" id="2217070">)</span><span class="op" id="2217071">*</span><span class="ident" id="2217072">zz</span><span class="op" id="2217074">+</span><span class="ident" id="2217075">_cos</span><span class="op" id="2217079">[</span><span class="num" id="2217080">4</span><span class="op" id="2217081">]</span><span class="op" id="2217082">)</span><span class="op" id="2217083">*</span><span class="ident" id="2217084">zz</span><span class="op" id="2217086">+</span><span class="ident" id="2217087">_cos</span><span class="op" id="2217091">[</span><span class="num" id="2217092">5</span><span class="op" id="2217093">]</span><span class="op" id="2217094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217100">if</span>&nbsp;<span class="ident" id="2217103">sign</span>&nbsp;<span class="op" id="2217108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217112">y</span>&nbsp;<span class="op" id="2217114">=</span>&nbsp;<span class="op" id="2217116">-</span><span class="ident" id="2217117">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217120">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217123">return</span>&nbsp;<span class="ident" id="2217130">y</span><br>
<span class="lineno"></span><span class="op" id="2217132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2217135">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2217185">//</span><br>
<span class="lineno">170</span><span class="comment" id="2217188">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2217210">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2217228">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2217248">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2217266">func</span>&nbsp;<span class="ident" id="2217271">Sin</span><span class="op" id="2217274">(</span><span class="ident" id="2217275">x</span>&nbsp;<span class="builtintype" id="2217277">float64</span><span class="op" id="2217284">)</span>&nbsp;<span class="builtintype" id="2217286">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2217295">func</span>&nbsp;<span class="ident" id="2217300">sin</span><span class="op" id="2217303">(</span><span class="ident" id="2217304">x</span>&nbsp;<span class="builtintype" id="2217306">float64</span><span class="op" id="2217313">)</span>&nbsp;<span class="builtintype" id="2217315">float64</span>&nbsp;<span class="op" id="2217323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217326">const</span>&nbsp;<span class="op" id="2217332">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217336">PI4A</span>&nbsp;<span class="op" id="2217341">=</span>&nbsp;<span class="num" id="2217343">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217397">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217450">PI4B</span>&nbsp;<span class="op" id="2217455">=</span>&nbsp;<span class="num" id="2217457">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217511">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217536">PI4C</span>&nbsp;<span class="op" id="2217541">=</span>&nbsp;<span class="num" id="2217543">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217597">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217622">M4PI</span>&nbsp;<span class="op" id="2217627">=</span>&nbsp;<span class="num" id="2217629">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2217683">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217695">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217713">switch</span>&nbsp;<span class="op" id="2217720">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217723">case</span>&nbsp;<span class="ident" id="2217728">x</span>&nbsp;<span class="op" id="2217730">==</span>&nbsp;<span class="num" id="2217733">0</span>&nbsp;<span class="op" id="2217735">||</span>&nbsp;<span class="ident" id="2217738">IsNaN</span><span class="op" id="2217743">(</span><span class="ident" id="2217744">x</span><span class="op" id="2217745">)</span><span class="op" id="2217746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217750">return</span>&nbsp;<span class="ident" id="2217757">x</span>&nbsp;<span class="comment" id="2217759">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217783">case</span>&nbsp;<span class="ident" id="2217788">IsInf</span><span class="op" id="2217793">(</span><span class="ident" id="2217794">x</span><span class="op" id="2217795">,</span>&nbsp;<span class="num" id="2217797">0</span><span class="op" id="2217798">)</span><span class="op" id="2217799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217803">return</span>&nbsp;<span class="ident" id="2217810">NaN</span><span class="op" id="2217813">(</span><span class="op" id="2217814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217817">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217821">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217866">sign</span>&nbsp;<span class="op" id="2217871">:=</span>&nbsp;<span class="builtintype" id="2217874">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217881">if</span>&nbsp;<span class="ident" id="2217884">x</span>&nbsp;<span class="op" id="2217886">&lt;</span>&nbsp;<span class="num" id="2217888">0</span>&nbsp;<span class="op" id="2217890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217894">x</span>&nbsp;<span class="op" id="2217896">=</span>&nbsp;<span class="op" id="2217898">-</span><span class="ident" id="2217899">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217903">sign</span>&nbsp;<span class="op" id="2217908">=</span>&nbsp;<span class="builtintype" id="2217910">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217920">j</span>&nbsp;<span class="op" id="2217922">:=</span>&nbsp;<span class="ident" id="2217925">int64</span><span class="op" id="2217930">(</span><span class="ident" id="2217931">x</span>&nbsp;<span class="op" id="2217933">*</span>&nbsp;<span class="ident" id="2217935">M4PI</span><span class="op" id="2217939">)</span>&nbsp;<span class="comment" id="2217941">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218011">y</span>&nbsp;<span class="op" id="2218013">:=</span>&nbsp;<span class="builtintype" id="2218016">float64</span><span class="op" id="2218023">(</span><span class="ident" id="2218024">j</span><span class="op" id="2218025">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218032">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218072">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218096">if</span>&nbsp;<span class="ident" id="2218099">j</span><span class="op" id="2218100">&amp;</span><span class="num" id="2218101">1</span>&nbsp;<span class="op" id="2218103">==</span>&nbsp;<span class="num" id="2218106">1</span>&nbsp;<span class="op" id="2218108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218112">j</span>&nbsp;<span class="op" id="2218114">+=</span>&nbsp;<span class="num" id="2218117">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218121">y</span>&nbsp;<span class="op" id="2218123">+=</span>&nbsp;<span class="num" id="2218126">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218132">j</span>&nbsp;<span class="op" id="2218134">&amp;=</span>&nbsp;<span class="num" id="2218137">7</span>&nbsp;<span class="comment" id="2218139">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218183">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218205">if</span>&nbsp;<span class="ident" id="2218208">j</span>&nbsp;<span class="op" id="2218210">&gt;</span>&nbsp;<span class="num" id="2218212">3</span>&nbsp;<span class="op" id="2218214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218218">sign</span>&nbsp;<span class="op" id="2218223">=</span>&nbsp;<span class="op" id="2218225">!</span><span class="ident" id="2218226">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218233">j</span>&nbsp;<span class="op" id="2218235">-=</span>&nbsp;<span class="num" id="2218238">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218245">z</span>&nbsp;<span class="op" id="2218247">:=</span>&nbsp;<span class="op" id="2218250">(</span><span class="op" id="2218251">(</span><span class="ident" id="2218252">x</span>&nbsp;<span class="op" id="2218254">-</span>&nbsp;<span class="ident" id="2218256">y</span><span class="op" id="2218257">*</span><span class="ident" id="2218258">PI4A</span><span class="op" id="2218262">)</span>&nbsp;<span class="op" id="2218264">-</span>&nbsp;<span class="ident" id="2218266">y</span><span class="op" id="2218267">*</span><span class="ident" id="2218268">PI4B</span><span class="op" id="2218272">)</span>&nbsp;<span class="op" id="2218274">-</span>&nbsp;<span class="ident" id="2218276">y</span><span class="op" id="2218277">*</span><span class="ident" id="2218278">PI4C</span>&nbsp;<span class="comment" id="2218283">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218325">zz</span>&nbsp;<span class="op" id="2218328">:=</span>&nbsp;<span class="ident" id="2218331">z</span>&nbsp;<span class="op" id="2218333">*</span>&nbsp;<span class="ident" id="2218335">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218338">if</span>&nbsp;<span class="ident" id="2218341">j</span>&nbsp;<span class="op" id="2218343">==</span>&nbsp;<span class="num" id="2218346">1</span>&nbsp;<span class="op" id="2218348">||</span>&nbsp;<span class="ident" id="2218351">j</span>&nbsp;<span class="op" id="2218353">==</span>&nbsp;<span class="num" id="2218356">2</span>&nbsp;<span class="op" id="2218358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218362">y</span>&nbsp;<span class="op" id="2218364">=</span>&nbsp;<span class="num" id="2218366">1.0</span>&nbsp;<span class="op" id="2218370">-</span>&nbsp;<span class="num" id="2218372">0.5</span><span class="op" id="2218375">*</span><span class="ident" id="2218376">zz</span>&nbsp;<span class="op" id="2218379">+</span>&nbsp;<span class="ident" id="2218381">zz</span><span class="op" id="2218383">*</span><span class="ident" id="2218384">zz</span><span class="op" id="2218386">*</span><span class="op" id="2218387">(</span><span class="op" id="2218388">(</span><span class="op" id="2218389">(</span><span class="op" id="2218390">(</span><span class="op" id="2218391">(</span><span class="op" id="2218392">(</span><span class="ident" id="2218393">_cos</span><span class="op" id="2218397">[</span><span class="num" id="2218398">0</span><span class="op" id="2218399">]</span><span class="op" id="2218400">*</span><span class="ident" id="2218401">zz</span><span class="op" id="2218403">)</span><span class="op" id="2218404">+</span><span class="ident" id="2218405">_cos</span><span class="op" id="2218409">[</span><span class="num" id="2218410">1</span><span class="op" id="2218411">]</span><span class="op" id="2218412">)</span><span class="op" id="2218413">*</span><span class="ident" id="2218414">zz</span><span class="op" id="2218416">+</span><span class="ident" id="2218417">_cos</span><span class="op" id="2218421">[</span><span class="num" id="2218422">2</span><span class="op" id="2218423">]</span><span class="op" id="2218424">)</span><span class="op" id="2218425">*</span><span class="ident" id="2218426">zz</span><span class="op" id="2218428">+</span><span class="ident" id="2218429">_cos</span><span class="op" id="2218433">[</span><span class="num" id="2218434">3</span><span class="op" id="2218435">]</span><span class="op" id="2218436">)</span><span class="op" id="2218437">*</span><span class="ident" id="2218438">zz</span><span class="op" id="2218440">+</span><span class="ident" id="2218441">_cos</span><span class="op" id="2218445">[</span><span class="num" id="2218446">4</span><span class="op" id="2218447">]</span><span class="op" id="2218448">)</span><span class="op" id="2218449">*</span><span class="ident" id="2218450">zz</span><span class="op" id="2218452">+</span><span class="ident" id="2218453">_cos</span><span class="op" id="2218457">[</span><span class="num" id="2218458">5</span><span class="op" id="2218459">]</span><span class="op" id="2218460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218463">}</span>&nbsp;<span class="keyword" id="2218465">else</span>&nbsp;<span class="op" id="2218470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218474">y</span>&nbsp;<span class="op" id="2218476">=</span>&nbsp;<span class="ident" id="2218478">z</span>&nbsp;<span class="op" id="2218480">+</span>&nbsp;<span class="ident" id="2218482">z</span><span class="op" id="2218483">*</span><span class="ident" id="2218484">zz</span><span class="op" id="2218486">*</span><span class="op" id="2218487">(</span><span class="op" id="2218488">(</span><span class="op" id="2218489">(</span><span class="op" id="2218490">(</span><span class="op" id="2218491">(</span><span class="op" id="2218492">(</span><span class="ident" id="2218493">_sin</span><span class="op" id="2218497">[</span><span class="num" id="2218498">0</span><span class="op" id="2218499">]</span><span class="op" id="2218500">*</span><span class="ident" id="2218501">zz</span><span class="op" id="2218503">)</span><span class="op" id="2218504">+</span><span class="ident" id="2218505">_sin</span><span class="op" id="2218509">[</span><span class="num" id="2218510">1</span><span class="op" id="2218511">]</span><span class="op" id="2218512">)</span><span class="op" id="2218513">*</span><span class="ident" id="2218514">zz</span><span class="op" id="2218516">+</span><span class="ident" id="2218517">_sin</span><span class="op" id="2218521">[</span><span class="num" id="2218522">2</span><span class="op" id="2218523">]</span><span class="op" id="2218524">)</span><span class="op" id="2218525">*</span><span class="ident" id="2218526">zz</span><span class="op" id="2218528">+</span><span class="ident" id="2218529">_sin</span><span class="op" id="2218533">[</span><span class="num" id="2218534">3</span><span class="op" id="2218535">]</span><span class="op" id="2218536">)</span><span class="op" id="2218537">*</span><span class="ident" id="2218538">zz</span><span class="op" id="2218540">+</span><span class="ident" id="2218541">_sin</span><span class="op" id="2218545">[</span><span class="num" id="2218546">4</span><span class="op" id="2218547">]</span><span class="op" id="2218548">)</span><span class="op" id="2218549">*</span><span class="ident" id="2218550">zz</span><span class="op" id="2218552">+</span><span class="ident" id="2218553">_sin</span><span class="op" id="2218557">[</span><span class="num" id="2218558">5</span><span class="op" id="2218559">]</span><span class="op" id="2218560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218563">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218566">if</span>&nbsp;<span class="ident" id="2218569">sign</span>&nbsp;<span class="op" id="2218574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218578">y</span>&nbsp;<span class="op" id="2218580">=</span>&nbsp;<span class="op" id="2218582">-</span><span class="ident" id="2218583">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218589">return</span>&nbsp;<span class="ident" id="2218596">y</span><br>
<span class="lineno"></span><span class="op" id="2218598">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
