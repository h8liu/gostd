<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html" class="current">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2939555">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2939610">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2939664">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2939715">package</span>&nbsp;<span class="ident" id="2939723">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2939729">import</span>&nbsp;<span class="op" id="2939736">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939739">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939748">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939755">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939762">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939769">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939780">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2939791">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="2939798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2939801">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="2939855">//</span><br>
<span class="lineno"></span><span class="comment" id="2939858">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="2939900">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2939977">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="2940035">type</span>&nbsp;<span class="ident" id="2940040">Cookie</span>&nbsp;<span class="keyword" id="2940047">struct</span>&nbsp;<span class="op" id="2940054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940057">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940068">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940076">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940087">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940095">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940106">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940114">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940125">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940133">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940144">time</span><span class="op" id="2940148">.</span><span class="ident" id="2940149">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940155">RawExpires</span>&nbsp;<span class="builtintype" id="2940166">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2940175">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2940228">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2940292">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940358">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940367">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940372">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940381">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940387">HttpOnly</span>&nbsp;<span class="builtintype" id="2940396">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940402">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2940411">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940419">Unparsed</span>&nbsp;<span class="op" id="2940428">[</span><span class="op" id="2940429">]</span><span class="builtintype" id="2940430">string</span>&nbsp;<span class="comment" id="2940437">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="2940483">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2940486">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2940540">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="2940601">func</span>&nbsp;<span class="ident" id="2940606">readSetCookies</span><span class="op" id="2940620">(</span><span class="ident" id="2940621">h</span>&nbsp;<span class="ident" id="2940623">Header</span><span class="op" id="2940629">)</span>&nbsp;<span class="op" id="2940631">[</span><span class="op" id="2940632">]</span><span class="op" id="2940633">*</span><span class="ident" id="2940634">Cookie</span>&nbsp;<span class="op" id="2940641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940644">cookies</span>&nbsp;<span class="op" id="2940652">:=</span>&nbsp;<span class="op" id="2940655">[</span><span class="op" id="2940656">]</span><span class="op" id="2940657">*</span><span class="ident" id="2940658">Cookie</span><span class="op" id="2940664">{</span><span class="op" id="2940665">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2940668">for</span>&nbsp;<span class="ident" id="2940672">_</span><span class="op" id="2940673">,</span>&nbsp;<span class="ident" id="2940675">line</span>&nbsp;<span class="op" id="2940680">:=</span>&nbsp;<span class="keyword" id="2940683">range</span>&nbsp;<span class="ident" id="2940689">h</span><span class="op" id="2940690">[</span><span class="string" id="2940691">&#34;Set-Cookie&#34;</span><span class="op" id="2940703">]</span>&nbsp;<span class="op" id="2940705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940709">parts</span>&nbsp;<span class="op" id="2940715">:=</span>&nbsp;<span class="ident" id="2940718">strings</span><span class="op" id="2940725">.</span><span class="ident" id="2940726">Split</span><span class="op" id="2940731">(</span><span class="ident" id="2940732">strings</span><span class="op" id="2940739">.</span><span class="ident" id="2940740">TrimSpace</span><span class="op" id="2940749">(</span><span class="ident" id="2940750">line</span><span class="op" id="2940754">)</span><span class="op" id="2940755">,</span>&nbsp;<span class="string" id="2940757">&#34;;&#34;</span><span class="op" id="2940760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2940764">if</span>&nbsp;<span class="builtinfunc" id="2940767">len</span><span class="op" id="2940770">(</span><span class="ident" id="2940771">parts</span><span class="op" id="2940776">)</span>&nbsp;<span class="op" id="2940778">==</span>&nbsp;<span class="num" id="2940781">1</span>&nbsp;<span class="op" id="2940783">&amp;&amp;</span>&nbsp;<span class="ident" id="2940786">parts</span><span class="op" id="2940791">[</span><span class="num" id="2940792">0</span><span class="op" id="2940793">]</span>&nbsp;<span class="op" id="2940795">==</span>&nbsp;<span class="string" id="2940798">&#34;&#34;</span>&nbsp;<span class="op" id="2940801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2940806">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2940817">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940821">parts</span><span class="op" id="2940826">[</span><span class="num" id="2940827">0</span><span class="op" id="2940828">]</span>&nbsp;<span class="op" id="2940830">=</span>&nbsp;<span class="ident" id="2940832">strings</span><span class="op" id="2940839">.</span><span class="ident" id="2940840">TrimSpace</span><span class="op" id="2940849">(</span><span class="ident" id="2940850">parts</span><span class="op" id="2940855">[</span><span class="num" id="2940856">0</span><span class="op" id="2940857">]</span><span class="op" id="2940858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940862">j</span>&nbsp;<span class="op" id="2940864">:=</span>&nbsp;<span class="ident" id="2940867">strings</span><span class="op" id="2940874">.</span><span class="ident" id="2940875">Index</span><span class="op" id="2940880">(</span><span class="ident" id="2940881">parts</span><span class="op" id="2940886">[</span><span class="num" id="2940887">0</span><span class="op" id="2940888">]</span><span class="op" id="2940889">,</span>&nbsp;<span class="string" id="2940891">&#34;=&#34;</span><span class="op" id="2940894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2940898">if</span>&nbsp;<span class="ident" id="2940901">j</span>&nbsp;<span class="op" id="2940903">&lt;</span>&nbsp;<span class="num" id="2940905">0</span>&nbsp;<span class="op" id="2940907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2940912">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2940923">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2940927">name</span><span class="op" id="2940931">,</span>&nbsp;<span class="ident" id="2940933">value</span>&nbsp;<span class="op" id="2940939">:=</span>&nbsp;<span class="ident" id="2940942">parts</span><span class="op" id="2940947">[</span><span class="num" id="2940948">0</span><span class="op" id="2940949">]</span><span class="op" id="2940950">[</span><span class="op" id="2940951">:</span><span class="ident" id="2940952">j</span><span class="op" id="2940953">]</span><span class="op" id="2940954">,</span>&nbsp;<span class="ident" id="2940956">parts</span><span class="op" id="2940961">[</span><span class="num" id="2940962">0</span><span class="op" id="2940963">]</span><span class="op" id="2940964">[</span><span class="ident" id="2940965">j</span><span class="op" id="2940966">+</span><span class="num" id="2940967">1</span><span class="op" id="2940968">:</span><span class="op" id="2940969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2940973">if</span>&nbsp;<span class="op" id="2940976">!</span><span class="ident" id="2940977">isCookieNameValid</span><span class="op" id="2940994">(</span><span class="ident" id="2940995">name</span><span class="op" id="2940999">)</span>&nbsp;<span class="op" id="2941001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941006">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941021">value</span><span class="op" id="2941026">,</span>&nbsp;<span class="ident" id="2941028">success</span>&nbsp;<span class="op" id="2941036">:=</span>&nbsp;<span class="ident" id="2941039">parseCookieValue</span><span class="op" id="2941055">(</span><span class="ident" id="2941056">value</span><span class="op" id="2941061">,</span>&nbsp;<span class="builtintype" id="2941063">true</span><span class="op" id="2941067">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941071">if</span>&nbsp;<span class="op" id="2941074">!</span><span class="ident" id="2941075">success</span>&nbsp;<span class="op" id="2941083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941088">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941103">c</span>&nbsp;<span class="op" id="2941105">:=</span>&nbsp;<span class="op" id="2941108">&amp;</span><span class="ident" id="2941109">Cookie</span><span class="op" id="2941115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941120">Name</span><span class="op" id="2941124">:</span>&nbsp;&nbsp;<span class="ident" id="2941127">name</span><span class="op" id="2941131">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941136">Value</span><span class="op" id="2941141">:</span>&nbsp;<span class="ident" id="2941143">value</span><span class="op" id="2941148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941153">Raw</span><span class="op" id="2941156">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2941160">line</span><span class="op" id="2941164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941172">for</span>&nbsp;<span class="ident" id="2941176">i</span>&nbsp;<span class="op" id="2941178">:=</span>&nbsp;<span class="num" id="2941181">1</span><span class="op" id="2941182">;</span>&nbsp;<span class="ident" id="2941184">i</span>&nbsp;<span class="op" id="2941186">&lt;</span>&nbsp;<span class="builtinfunc" id="2941188">len</span><span class="op" id="2941191">(</span><span class="ident" id="2941192">parts</span><span class="op" id="2941197">)</span><span class="op" id="2941198">;</span>&nbsp;<span class="ident" id="2941200">i</span><span class="op" id="2941201">++</span>&nbsp;<span class="op" id="2941204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941209">parts</span><span class="op" id="2941214">[</span><span class="ident" id="2941215">i</span><span class="op" id="2941216">]</span>&nbsp;<span class="op" id="2941218">=</span>&nbsp;<span class="ident" id="2941220">strings</span><span class="op" id="2941227">.</span><span class="ident" id="2941228">TrimSpace</span><span class="op" id="2941237">(</span><span class="ident" id="2941238">parts</span><span class="op" id="2941243">[</span><span class="ident" id="2941244">i</span><span class="op" id="2941245">]</span><span class="op" id="2941246">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941251">if</span>&nbsp;<span class="builtinfunc" id="2941254">len</span><span class="op" id="2941257">(</span><span class="ident" id="2941258">parts</span><span class="op" id="2941263">[</span><span class="ident" id="2941264">i</span><span class="op" id="2941265">]</span><span class="op" id="2941266">)</span>&nbsp;<span class="op" id="2941268">==</span>&nbsp;<span class="num" id="2941271">0</span>&nbsp;<span class="op" id="2941273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941279">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941297">attr</span><span class="op" id="2941301">,</span>&nbsp;<span class="ident" id="2941303">val</span>&nbsp;<span class="op" id="2941307">:=</span>&nbsp;<span class="ident" id="2941310">parts</span><span class="op" id="2941315">[</span><span class="ident" id="2941316">i</span><span class="op" id="2941317">]</span><span class="op" id="2941318">,</span>&nbsp;<span class="string" id="2941320">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941326">if</span>&nbsp;<span class="ident" id="2941329">j</span>&nbsp;<span class="op" id="2941331">:=</span>&nbsp;<span class="ident" id="2941334">strings</span><span class="op" id="2941341">.</span><span class="ident" id="2941342">Index</span><span class="op" id="2941347">(</span><span class="ident" id="2941348">attr</span><span class="op" id="2941352">,</span>&nbsp;<span class="string" id="2941354">&#34;=&#34;</span><span class="op" id="2941357">)</span><span class="op" id="2941358">;</span>&nbsp;<span class="ident" id="2941360">j</span>&nbsp;<span class="op" id="2941362">&gt;=</span>&nbsp;<span class="num" id="2941365">0</span>&nbsp;<span class="op" id="2941367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941373">attr</span><span class="op" id="2941377">,</span>&nbsp;<span class="ident" id="2941379">val</span>&nbsp;<span class="op" id="2941383">=</span>&nbsp;<span class="ident" id="2941385">attr</span><span class="op" id="2941389">[</span><span class="op" id="2941390">:</span><span class="ident" id="2941391">j</span><span class="op" id="2941392">]</span><span class="op" id="2941393">,</span>&nbsp;<span class="ident" id="2941395">attr</span><span class="op" id="2941399">[</span><span class="ident" id="2941400">j</span><span class="op" id="2941401">+</span><span class="num" id="2941402">1</span><span class="op" id="2941403">:</span><span class="op" id="2941404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941414">lowerAttr</span>&nbsp;<span class="op" id="2941424">:=</span>&nbsp;<span class="ident" id="2941427">strings</span><span class="op" id="2941434">.</span><span class="ident" id="2941435">ToLower</span><span class="op" id="2941442">(</span><span class="ident" id="2941443">attr</span><span class="op" id="2941447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941452">val</span><span class="op" id="2941455">,</span>&nbsp;<span class="ident" id="2941457">success</span>&nbsp;<span class="op" id="2941465">=</span>&nbsp;<span class="ident" id="2941467">parseCookieValue</span><span class="op" id="2941483">(</span><span class="ident" id="2941484">val</span><span class="op" id="2941487">,</span>&nbsp;<span class="builtintype" id="2941489">false</span><span class="op" id="2941494">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941499">if</span>&nbsp;<span class="op" id="2941502">!</span><span class="ident" id="2941503">success</span>&nbsp;<span class="op" id="2941511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941517">c</span><span class="op" id="2941518">.</span><span class="ident" id="2941519">Unparsed</span>&nbsp;<span class="op" id="2941528">=</span>&nbsp;<span class="builtinfunc" id="2941530">append</span><span class="op" id="2941536">(</span><span class="ident" id="2941537">c</span><span class="op" id="2941538">.</span><span class="ident" id="2941539">Unparsed</span><span class="op" id="2941547">,</span>&nbsp;<span class="ident" id="2941549">parts</span><span class="op" id="2941554">[</span><span class="ident" id="2941555">i</span><span class="op" id="2941556">]</span><span class="op" id="2941557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941563">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941580">switch</span>&nbsp;<span class="ident" id="2941587">lowerAttr</span>&nbsp;<span class="op" id="2941597">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941602">case</span>&nbsp;<span class="string" id="2941607">&#34;secure&#34;</span><span class="op" id="2941615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941621">c</span><span class="op" id="2941622">.</span><span class="ident" id="2941623">Secure</span>&nbsp;<span class="op" id="2941630">=</span>&nbsp;<span class="builtintype" id="2941632">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941641">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941653">case</span>&nbsp;<span class="string" id="2941658">&#34;httponly&#34;</span><span class="op" id="2941668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941674">c</span><span class="op" id="2941675">.</span><span class="ident" id="2941676">HttpOnly</span>&nbsp;<span class="op" id="2941685">=</span>&nbsp;<span class="builtintype" id="2941687">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941696">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941708">case</span>&nbsp;<span class="string" id="2941713">&#34;domain&#34;</span><span class="op" id="2941721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941727">c</span><span class="op" id="2941728">.</span><span class="ident" id="2941729">Domain</span>&nbsp;<span class="op" id="2941736">=</span>&nbsp;<span class="ident" id="2941738">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941746">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941758">case</span>&nbsp;<span class="string" id="2941763">&#34;max-age&#34;</span><span class="op" id="2941772">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941778">secs</span><span class="op" id="2941782">,</span>&nbsp;<span class="ident" id="2941784">err</span>&nbsp;<span class="op" id="2941788">:=</span>&nbsp;<span class="ident" id="2941791">strconv</span><span class="op" id="2941798">.</span><span class="ident" id="2941799">Atoi</span><span class="op" id="2941803">(</span><span class="ident" id="2941804">val</span><span class="op" id="2941807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941813">if</span>&nbsp;<span class="ident" id="2941816">err</span>&nbsp;<span class="op" id="2941820">!=</span>&nbsp;<span class="builtintype" id="2941823">nil</span>&nbsp;<span class="op" id="2941827">||</span>&nbsp;<span class="ident" id="2941830">secs</span>&nbsp;<span class="op" id="2941835">!=</span>&nbsp;<span class="num" id="2941838">0</span>&nbsp;<span class="op" id="2941840">&amp;&amp;</span>&nbsp;<span class="ident" id="2941843">val</span><span class="op" id="2941846">[</span><span class="num" id="2941847">0</span><span class="op" id="2941848">]</span>&nbsp;<span class="op" id="2941850">==</span>&nbsp;<span class="string" id="2941853">&#39;0&#39;</span>&nbsp;<span class="op" id="2941857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941864">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941880">if</span>&nbsp;<span class="ident" id="2941883">secs</span>&nbsp;<span class="op" id="2941888">&lt;=</span>&nbsp;<span class="num" id="2941891">0</span>&nbsp;<span class="op" id="2941893">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941900">c</span><span class="op" id="2941901">.</span><span class="ident" id="2941902">MaxAge</span>&nbsp;<span class="op" id="2941909">=</span>&nbsp;<span class="op" id="2941911">-</span><span class="num" id="2941912">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941918">}</span>&nbsp;<span class="keyword" id="2941920">else</span>&nbsp;<span class="op" id="2941925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941932">c</span><span class="op" id="2941933">.</span><span class="ident" id="2941934">MaxAge</span>&nbsp;<span class="op" id="2941941">=</span>&nbsp;<span class="ident" id="2941943">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2941952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941958">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2941970">case</span>&nbsp;<span class="string" id="2941975">&#34;expires&#34;</span><span class="op" id="2941984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2941990">c</span><span class="op" id="2941991">.</span><span class="ident" id="2941992">RawExpires</span>&nbsp;<span class="op" id="2942003">=</span>&nbsp;<span class="ident" id="2942005">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942013">exptime</span><span class="op" id="2942020">,</span>&nbsp;<span class="ident" id="2942022">err</span>&nbsp;<span class="op" id="2942026">:=</span>&nbsp;<span class="ident" id="2942029">time</span><span class="op" id="2942033">.</span><span class="ident" id="2942034">Parse</span><span class="op" id="2942039">(</span><span class="ident" id="2942040">time</span><span class="op" id="2942044">.</span><span class="ident" id="2942045">RFC1123</span><span class="op" id="2942052">,</span>&nbsp;<span class="ident" id="2942054">val</span><span class="op" id="2942057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942063">if</span>&nbsp;<span class="ident" id="2942066">err</span>&nbsp;<span class="op" id="2942070">!=</span>&nbsp;<span class="builtintype" id="2942073">nil</span>&nbsp;<span class="op" id="2942077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942084">exptime</span><span class="op" id="2942091">,</span>&nbsp;<span class="ident" id="2942093">err</span>&nbsp;<span class="op" id="2942097">=</span>&nbsp;<span class="ident" id="2942099">time</span><span class="op" id="2942103">.</span><span class="ident" id="2942104">Parse</span><span class="op" id="2942109">(</span><span class="string" id="2942110">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="2942141">,</span>&nbsp;<span class="ident" id="2942143">val</span><span class="op" id="2942146">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942153">if</span>&nbsp;<span class="ident" id="2942156">err</span>&nbsp;<span class="op" id="2942160">!=</span>&nbsp;<span class="builtintype" id="2942163">nil</span>&nbsp;<span class="op" id="2942167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942175">c</span><span class="op" id="2942176">.</span><span class="ident" id="2942177">Expires</span>&nbsp;<span class="op" id="2942185">=</span>&nbsp;<span class="ident" id="2942187">time</span><span class="op" id="2942191">.</span><span class="ident" id="2942192">Time</span><span class="op" id="2942196">{</span><span class="op" id="2942197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942205">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2942216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2942222">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942228">c</span><span class="op" id="2942229">.</span><span class="ident" id="2942230">Expires</span>&nbsp;<span class="op" id="2942238">=</span>&nbsp;<span class="ident" id="2942240">exptime</span><span class="op" id="2942247">.</span><span class="ident" id="2942248">UTC</span><span class="op" id="2942251">(</span><span class="op" id="2942252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942258">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942270">case</span>&nbsp;<span class="string" id="2942275">&#34;path&#34;</span><span class="op" id="2942281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942287">c</span><span class="op" id="2942288">.</span><span class="ident" id="2942289">Path</span>&nbsp;<span class="op" id="2942294">=</span>&nbsp;<span class="ident" id="2942296">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942304">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2942316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942321">c</span><span class="op" id="2942322">.</span><span class="ident" id="2942323">Unparsed</span>&nbsp;<span class="op" id="2942332">=</span>&nbsp;<span class="builtinfunc" id="2942334">append</span><span class="op" id="2942340">(</span><span class="ident" id="2942341">c</span><span class="op" id="2942342">.</span><span class="ident" id="2942343">Unparsed</span><span class="op" id="2942351">,</span>&nbsp;<span class="ident" id="2942353">parts</span><span class="op" id="2942358">[</span><span class="ident" id="2942359">i</span><span class="op" id="2942360">]</span><span class="op" id="2942361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2942365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942369">cookies</span>&nbsp;<span class="op" id="2942377">=</span>&nbsp;<span class="builtinfunc" id="2942379">append</span><span class="op" id="2942385">(</span><span class="ident" id="2942386">cookies</span><span class="op" id="2942393">,</span>&nbsp;<span class="ident" id="2942395">c</span><span class="op" id="2942396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2942399">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942402">return</span>&nbsp;<span class="ident" id="2942409">cookies</span><br>
<span class="lineno"></span><span class="op" id="2942417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2942420">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="2942500">func</span>&nbsp;<span class="ident" id="2942505">SetCookie</span><span class="op" id="2942514">(</span><span class="ident" id="2942515">w</span>&nbsp;<span class="ident" id="2942517">ResponseWriter</span><span class="op" id="2942531">,</span>&nbsp;<span class="ident" id="2942533">cookie</span>&nbsp;<span class="op" id="2942540">*</span><span class="ident" id="2942541">Cookie</span><span class="op" id="2942547">)</span>&nbsp;<span class="op" id="2942549">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942552">w</span><span class="op" id="2942553">.</span><span class="ident" id="2942554">Header</span><span class="op" id="2942560">(</span><span class="op" id="2942561">)</span><span class="op" id="2942562">.</span><span class="ident" id="2942563">Add</span><span class="op" id="2942566">(</span><span class="string" id="2942567">&#34;Set-Cookie&#34;</span><span class="op" id="2942579">,</span>&nbsp;<span class="ident" id="2942581">cookie</span><span class="op" id="2942587">.</span><span class="ident" id="2942588">String</span><span class="op" id="2942594">(</span><span class="op" id="2942595">)</span><span class="op" id="2942596">)</span><br>
<span class="lineno"></span><span class="op" id="2942598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2942601">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="2942671">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="2942739">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="2942776">func</span>&nbsp;<span class="op" id="2942781">(</span><span class="ident" id="2942782">c</span>&nbsp;<span class="op" id="2942784">*</span><span class="ident" id="2942785">Cookie</span><span class="op" id="2942791">)</span>&nbsp;<span class="ident" id="2942793">String</span><span class="op" id="2942799">(</span><span class="op" id="2942800">)</span>&nbsp;<span class="builtintype" id="2942802">string</span>&nbsp;<span class="op" id="2942809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942812">var</span>&nbsp;<span class="ident" id="2942816">b</span>&nbsp;<span class="ident" id="2942818">bytes</span><span class="op" id="2942823">.</span><span class="ident" id="2942824">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942832">fmt</span><span class="op" id="2942835">.</span><span class="ident" id="2942836">Fprintf</span><span class="op" id="2942843">(</span><span class="op" id="2942844">&amp;</span><span class="ident" id="2942845">b</span><span class="op" id="2942846">,</span>&nbsp;<span class="string" id="2942848">&#34;%s=%s&#34;</span><span class="op" id="2942855">,</span>&nbsp;<span class="ident" id="2942857">sanitizeCookieName</span><span class="op" id="2942875">(</span><span class="ident" id="2942876">c</span><span class="op" id="2942877">.</span><span class="ident" id="2942878">Name</span><span class="op" id="2942882">)</span><span class="op" id="2942883">,</span>&nbsp;<span class="ident" id="2942885">sanitizeCookieValue</span><span class="op" id="2942904">(</span><span class="ident" id="2942905">c</span><span class="op" id="2942906">.</span><span class="ident" id="2942907">Value</span><span class="op" id="2942912">)</span><span class="op" id="2942913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2942916">if</span>&nbsp;<span class="builtinfunc" id="2942919">len</span><span class="op" id="2942922">(</span><span class="ident" id="2942923">c</span><span class="op" id="2942924">.</span><span class="ident" id="2942925">Path</span><span class="op" id="2942929">)</span>&nbsp;<span class="op" id="2942931">&gt;</span>&nbsp;<span class="num" id="2942933">0</span>&nbsp;<span class="op" id="2942935">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2942939">fmt</span><span class="op" id="2942942">.</span><span class="ident" id="2942943">Fprintf</span><span class="op" id="2942950">(</span><span class="op" id="2942951">&amp;</span><span class="ident" id="2942952">b</span><span class="op" id="2942953">,</span>&nbsp;<span class="string" id="2942955">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="2942966">,</span>&nbsp;<span class="ident" id="2942968">sanitizeCookiePath</span><span class="op" id="2942986">(</span><span class="ident" id="2942987">c</span><span class="op" id="2942988">.</span><span class="ident" id="2942989">Path</span><span class="op" id="2942993">)</span><span class="op" id="2942994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2942997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943000">if</span>&nbsp;<span class="builtinfunc" id="2943003">len</span><span class="op" id="2943006">(</span><span class="ident" id="2943007">c</span><span class="op" id="2943008">.</span><span class="ident" id="2943009">Domain</span><span class="op" id="2943015">)</span>&nbsp;<span class="op" id="2943017">&gt;</span>&nbsp;<span class="num" id="2943019">0</span>&nbsp;<span class="op" id="2943021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943025">if</span>&nbsp;<span class="ident" id="2943028">validCookieDomain</span><span class="op" id="2943045">(</span><span class="ident" id="2943046">c</span><span class="op" id="2943047">.</span><span class="ident" id="2943048">Domain</span><span class="op" id="2943054">)</span>&nbsp;<span class="op" id="2943056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2943061">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2943115">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2943173">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2943226">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943251">d</span>&nbsp;<span class="op" id="2943253">:=</span>&nbsp;<span class="ident" id="2943256">c</span><span class="op" id="2943257">.</span><span class="ident" id="2943258">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943268">if</span>&nbsp;<span class="ident" id="2943271">d</span><span class="op" id="2943272">[</span><span class="num" id="2943273">0</span><span class="op" id="2943274">]</span>&nbsp;<span class="op" id="2943276">==</span>&nbsp;<span class="string" id="2943279">&#39;.&#39;</span>&nbsp;<span class="op" id="2943283">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943289">d</span>&nbsp;<span class="op" id="2943291">=</span>&nbsp;<span class="ident" id="2943293">d</span><span class="op" id="2943294">[</span><span class="num" id="2943295">1</span><span class="op" id="2943296">:</span><span class="op" id="2943297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943307">fmt</span><span class="op" id="2943310">.</span><span class="ident" id="2943311">Fprintf</span><span class="op" id="2943318">(</span><span class="op" id="2943319">&amp;</span><span class="ident" id="2943320">b</span><span class="op" id="2943321">,</span>&nbsp;<span class="string" id="2943323">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="2943336">,</span>&nbsp;<span class="ident" id="2943338">d</span><span class="op" id="2943339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943343">}</span>&nbsp;<span class="keyword" id="2943345">else</span>&nbsp;<span class="op" id="2943350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943355">log</span><span class="op" id="2943358">.</span><span class="ident" id="2943359">Printf</span><span class="op" id="2943365">(</span><span class="string" id="2943366">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="2943429">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943435">c</span><span class="op" id="2943436">.</span><span class="ident" id="2943437">Domain</span><span class="op" id="2943443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943453">if</span>&nbsp;<span class="ident" id="2943456">c</span><span class="op" id="2943457">.</span><span class="ident" id="2943458">Expires</span><span class="op" id="2943465">.</span><span class="ident" id="2943466">Unix</span><span class="op" id="2943470">(</span><span class="op" id="2943471">)</span>&nbsp;<span class="op" id="2943473">&gt;</span>&nbsp;<span class="num" id="2943475">0</span>&nbsp;<span class="op" id="2943477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943481">fmt</span><span class="op" id="2943484">.</span><span class="ident" id="2943485">Fprintf</span><span class="op" id="2943492">(</span><span class="op" id="2943493">&amp;</span><span class="ident" id="2943494">b</span><span class="op" id="2943495">,</span>&nbsp;<span class="string" id="2943497">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="2943511">,</span>&nbsp;<span class="ident" id="2943513">c</span><span class="op" id="2943514">.</span><span class="ident" id="2943515">Expires</span><span class="op" id="2943522">.</span><span class="ident" id="2943523">UTC</span><span class="op" id="2943526">(</span><span class="op" id="2943527">)</span><span class="op" id="2943528">.</span><span class="ident" id="2943529">Format</span><span class="op" id="2943535">(</span><span class="ident" id="2943536">time</span><span class="op" id="2943540">.</span><span class="ident" id="2943541">RFC1123</span><span class="op" id="2943548">)</span><span class="op" id="2943549">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943555">if</span>&nbsp;<span class="ident" id="2943558">c</span><span class="op" id="2943559">.</span><span class="ident" id="2943560">MaxAge</span>&nbsp;<span class="op" id="2943567">&gt;</span>&nbsp;<span class="num" id="2943569">0</span>&nbsp;<span class="op" id="2943571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943575">fmt</span><span class="op" id="2943578">.</span><span class="ident" id="2943579">Fprintf</span><span class="op" id="2943586">(</span><span class="op" id="2943587">&amp;</span><span class="ident" id="2943588">b</span><span class="op" id="2943589">,</span>&nbsp;<span class="string" id="2943591">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="2943605">,</span>&nbsp;<span class="ident" id="2943607">c</span><span class="op" id="2943608">.</span><span class="ident" id="2943609">MaxAge</span><span class="op" id="2943615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943618">}</span>&nbsp;<span class="keyword" id="2943620">else</span>&nbsp;<span class="keyword" id="2943625">if</span>&nbsp;<span class="ident" id="2943628">c</span><span class="op" id="2943629">.</span><span class="ident" id="2943630">MaxAge</span>&nbsp;<span class="op" id="2943637">&lt;</span>&nbsp;<span class="num" id="2943639">0</span>&nbsp;<span class="op" id="2943641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943645">fmt</span><span class="op" id="2943648">.</span><span class="ident" id="2943649">Fprintf</span><span class="op" id="2943656">(</span><span class="op" id="2943657">&amp;</span><span class="ident" id="2943658">b</span><span class="op" id="2943659">,</span>&nbsp;<span class="string" id="2943661">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="2943674">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943680">if</span>&nbsp;<span class="ident" id="2943683">c</span><span class="op" id="2943684">.</span><span class="ident" id="2943685">HttpOnly</span>&nbsp;<span class="op" id="2943694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943698">fmt</span><span class="op" id="2943701">.</span><span class="ident" id="2943702">Fprintf</span><span class="op" id="2943709">(</span><span class="op" id="2943710">&amp;</span><span class="ident" id="2943711">b</span><span class="op" id="2943712">,</span>&nbsp;<span class="string" id="2943714">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="2943726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943732">if</span>&nbsp;<span class="ident" id="2943735">c</span><span class="op" id="2943736">.</span><span class="ident" id="2943737">Secure</span>&nbsp;<span class="op" id="2943744">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2943748">fmt</span><span class="op" id="2943751">.</span><span class="ident" id="2943752">Fprintf</span><span class="op" id="2943759">(</span><span class="op" id="2943760">&amp;</span><span class="ident" id="2943761">b</span><span class="op" id="2943762">,</span>&nbsp;<span class="string" id="2943764">&#34;;&nbsp;Secure&#34;</span><span class="op" id="2943774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2943777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2943780">return</span>&nbsp;<span class="ident" id="2943787">b</span><span class="op" id="2943788">.</span><span class="ident" id="2943789">String</span><span class="op" id="2943795">(</span><span class="op" id="2943796">)</span><br>
<span class="lineno"></span><span class="op" id="2943798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2943801">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2943865">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="2943909">//</span><br>
<span class="lineno"></span><span class="comment" id="2943912">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="2943977">func</span>&nbsp;<span class="ident" id="2943982">readCookies</span><span class="op" id="2943993">(</span><span class="ident" id="2943994">h</span>&nbsp;<span class="ident" id="2943996">Header</span><span class="op" id="2944002">,</span>&nbsp;<span class="ident" id="2944004">filter</span>&nbsp;<span class="builtintype" id="2944011">string</span><span class="op" id="2944017">)</span>&nbsp;<span class="op" id="2944019">[</span><span class="op" id="2944020">]</span><span class="op" id="2944021">*</span><span class="ident" id="2944022">Cookie</span>&nbsp;<span class="op" id="2944029">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944032">cookies</span>&nbsp;<span class="op" id="2944040">:=</span>&nbsp;<span class="op" id="2944043">[</span><span class="op" id="2944044">]</span><span class="op" id="2944045">*</span><span class="ident" id="2944046">Cookie</span><span class="op" id="2944052">{</span><span class="op" id="2944053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944056">lines</span><span class="op" id="2944061">,</span>&nbsp;<span class="ident" id="2944063">ok</span>&nbsp;<span class="op" id="2944066">:=</span>&nbsp;<span class="ident" id="2944069">h</span><span class="op" id="2944070">[</span><span class="string" id="2944071">&#34;Cookie&#34;</span><span class="op" id="2944079">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944082">if</span>&nbsp;<span class="op" id="2944085">!</span><span class="ident" id="2944086">ok</span>&nbsp;<span class="op" id="2944089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944093">return</span>&nbsp;<span class="ident" id="2944100">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944109">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944113">for</span>&nbsp;<span class="ident" id="2944117">_</span><span class="op" id="2944118">,</span>&nbsp;<span class="ident" id="2944120">line</span>&nbsp;<span class="op" id="2944125">:=</span>&nbsp;<span class="keyword" id="2944128">range</span>&nbsp;<span class="ident" id="2944134">lines</span>&nbsp;<span class="op" id="2944140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944144">parts</span>&nbsp;<span class="op" id="2944150">:=</span>&nbsp;<span class="ident" id="2944153">strings</span><span class="op" id="2944160">.</span><span class="ident" id="2944161">Split</span><span class="op" id="2944166">(</span><span class="ident" id="2944167">strings</span><span class="op" id="2944174">.</span><span class="ident" id="2944175">TrimSpace</span><span class="op" id="2944184">(</span><span class="ident" id="2944185">line</span><span class="op" id="2944189">)</span><span class="op" id="2944190">,</span>&nbsp;<span class="string" id="2944192">&#34;;&#34;</span><span class="op" id="2944195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944199">if</span>&nbsp;<span class="builtinfunc" id="2944202">len</span><span class="op" id="2944205">(</span><span class="ident" id="2944206">parts</span><span class="op" id="2944211">)</span>&nbsp;<span class="op" id="2944213">==</span>&nbsp;<span class="num" id="2944216">1</span>&nbsp;<span class="op" id="2944218">&amp;&amp;</span>&nbsp;<span class="ident" id="2944221">parts</span><span class="op" id="2944226">[</span><span class="num" id="2944227">0</span><span class="op" id="2944228">]</span>&nbsp;<span class="op" id="2944230">==</span>&nbsp;<span class="string" id="2944233">&#34;&#34;</span>&nbsp;<span class="op" id="2944236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944241">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2944256">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944281">parsedPairs</span>&nbsp;<span class="op" id="2944293">:=</span>&nbsp;<span class="num" id="2944296">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944300">for</span>&nbsp;<span class="ident" id="2944304">i</span>&nbsp;<span class="op" id="2944306">:=</span>&nbsp;<span class="num" id="2944309">0</span><span class="op" id="2944310">;</span>&nbsp;<span class="ident" id="2944312">i</span>&nbsp;<span class="op" id="2944314">&lt;</span>&nbsp;<span class="builtinfunc" id="2944316">len</span><span class="op" id="2944319">(</span><span class="ident" id="2944320">parts</span><span class="op" id="2944325">)</span><span class="op" id="2944326">;</span>&nbsp;<span class="ident" id="2944328">i</span><span class="op" id="2944329">++</span>&nbsp;<span class="op" id="2944332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944337">parts</span><span class="op" id="2944342">[</span><span class="ident" id="2944343">i</span><span class="op" id="2944344">]</span>&nbsp;<span class="op" id="2944346">=</span>&nbsp;<span class="ident" id="2944348">strings</span><span class="op" id="2944355">.</span><span class="ident" id="2944356">TrimSpace</span><span class="op" id="2944365">(</span><span class="ident" id="2944366">parts</span><span class="op" id="2944371">[</span><span class="ident" id="2944372">i</span><span class="op" id="2944373">]</span><span class="op" id="2944374">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944379">if</span>&nbsp;<span class="builtinfunc" id="2944382">len</span><span class="op" id="2944385">(</span><span class="ident" id="2944386">parts</span><span class="op" id="2944391">[</span><span class="ident" id="2944392">i</span><span class="op" id="2944393">]</span><span class="op" id="2944394">)</span>&nbsp;<span class="op" id="2944396">==</span>&nbsp;<span class="num" id="2944399">0</span>&nbsp;<span class="op" id="2944401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944407">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944424">name</span><span class="op" id="2944428">,</span>&nbsp;<span class="ident" id="2944430">val</span>&nbsp;<span class="op" id="2944434">:=</span>&nbsp;<span class="ident" id="2944437">parts</span><span class="op" id="2944442">[</span><span class="ident" id="2944443">i</span><span class="op" id="2944444">]</span><span class="op" id="2944445">,</span>&nbsp;<span class="string" id="2944447">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944453">if</span>&nbsp;<span class="ident" id="2944456">j</span>&nbsp;<span class="op" id="2944458">:=</span>&nbsp;<span class="ident" id="2944461">strings</span><span class="op" id="2944468">.</span><span class="ident" id="2944469">Index</span><span class="op" id="2944474">(</span><span class="ident" id="2944475">name</span><span class="op" id="2944479">,</span>&nbsp;<span class="string" id="2944481">&#34;=&#34;</span><span class="op" id="2944484">)</span><span class="op" id="2944485">;</span>&nbsp;<span class="ident" id="2944487">j</span>&nbsp;<span class="op" id="2944489">&gt;=</span>&nbsp;<span class="num" id="2944492">0</span>&nbsp;<span class="op" id="2944494">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944500">name</span><span class="op" id="2944504">,</span>&nbsp;<span class="ident" id="2944506">val</span>&nbsp;<span class="op" id="2944510">=</span>&nbsp;<span class="ident" id="2944512">name</span><span class="op" id="2944516">[</span><span class="op" id="2944517">:</span><span class="ident" id="2944518">j</span><span class="op" id="2944519">]</span><span class="op" id="2944520">,</span>&nbsp;<span class="ident" id="2944522">name</span><span class="op" id="2944526">[</span><span class="ident" id="2944527">j</span><span class="op" id="2944528">+</span><span class="num" id="2944529">1</span><span class="op" id="2944530">:</span><span class="op" id="2944531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944541">if</span>&nbsp;<span class="op" id="2944544">!</span><span class="ident" id="2944545">isCookieNameValid</span><span class="op" id="2944562">(</span><span class="ident" id="2944563">name</span><span class="op" id="2944567">)</span>&nbsp;<span class="op" id="2944569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944575">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944587">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944592">if</span>&nbsp;<span class="ident" id="2944595">filter</span>&nbsp;<span class="op" id="2944602">!=</span>&nbsp;<span class="string" id="2944605">&#34;&#34;</span>&nbsp;<span class="op" id="2944608">&amp;&amp;</span>&nbsp;<span class="ident" id="2944611">filter</span>&nbsp;<span class="op" id="2944618">!=</span>&nbsp;<span class="ident" id="2944621">name</span>&nbsp;<span class="op" id="2944626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944632">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944649">val</span><span class="op" id="2944652">,</span>&nbsp;<span class="ident" id="2944654">success</span>&nbsp;<span class="op" id="2944662">:=</span>&nbsp;<span class="ident" id="2944665">parseCookieValue</span><span class="op" id="2944681">(</span><span class="ident" id="2944682">val</span><span class="op" id="2944685">,</span>&nbsp;<span class="builtintype" id="2944687">true</span><span class="op" id="2944691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944696">if</span>&nbsp;<span class="op" id="2944699">!</span><span class="ident" id="2944700">success</span>&nbsp;<span class="op" id="2944708">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944714">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944731">cookies</span>&nbsp;<span class="op" id="2944739">=</span>&nbsp;<span class="builtinfunc" id="2944741">append</span><span class="op" id="2944747">(</span><span class="ident" id="2944748">cookies</span><span class="op" id="2944755">,</span>&nbsp;<span class="op" id="2944757">&amp;</span><span class="ident" id="2944758">Cookie</span><span class="op" id="2944764">{</span><span class="ident" id="2944765">Name</span><span class="op" id="2944769">:</span>&nbsp;<span class="ident" id="2944771">name</span><span class="op" id="2944775">,</span>&nbsp;<span class="ident" id="2944777">Value</span><span class="op" id="2944782">:</span>&nbsp;<span class="ident" id="2944784">val</span><span class="op" id="2944787">}</span><span class="op" id="2944788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2944793">parsedPairs</span><span class="op" id="2944804">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944809">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944815">return</span>&nbsp;<span class="ident" id="2944822">cookies</span><br>
<span class="lineno"></span><span class="op" id="2944830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2944833">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="2944903">func</span>&nbsp;<span class="ident" id="2944908">validCookieDomain</span><span class="op" id="2944925">(</span><span class="ident" id="2944926">v</span>&nbsp;<span class="builtintype" id="2944928">string</span><span class="op" id="2944934">)</span>&nbsp;<span class="builtintype" id="2944936">bool</span>&nbsp;<span class="op" id="2944941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944944">if</span>&nbsp;<span class="ident" id="2944947">isCookieDomainName</span><span class="op" id="2944965">(</span><span class="ident" id="2944966">v</span><span class="op" id="2944967">)</span>&nbsp;<span class="op" id="2944969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944973">return</span>&nbsp;<span class="builtintype" id="2944980">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2944986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2944989">if</span>&nbsp;<span class="ident" id="2944992">net</span><span class="op" id="2944995">.</span><span class="ident" id="2944996">ParseIP</span><span class="op" id="2945003">(</span><span class="ident" id="2945004">v</span><span class="op" id="2945005">)</span>&nbsp;<span class="op" id="2945007">!=</span>&nbsp;<span class="builtintype" id="2945010">nil</span>&nbsp;<span class="op" id="2945014">&amp;&amp;</span>&nbsp;<span class="op" id="2945017">!</span><span class="ident" id="2945018">strings</span><span class="op" id="2945025">.</span><span class="ident" id="2945026">Contains</span><span class="op" id="2945034">(</span><span class="ident" id="2945035">v</span><span class="op" id="2945036">,</span>&nbsp;<span class="string" id="2945038">&#34;:&#34;</span><span class="op" id="2945041">)</span>&nbsp;<span class="op" id="2945043">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945047">return</span>&nbsp;<span class="builtintype" id="2945054">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2945060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945063">return</span>&nbsp;<span class="builtintype" id="2945070">false</span><br>
<span class="lineno"></span><span class="op" id="2945076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="2945079">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="2945153">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2945223">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="2945254">func</span>&nbsp;<span class="ident" id="2945259">isCookieDomainName</span><span class="op" id="2945277">(</span><span class="ident" id="2945278">s</span>&nbsp;<span class="builtintype" id="2945280">string</span><span class="op" id="2945286">)</span>&nbsp;<span class="builtintype" id="2945288">bool</span>&nbsp;<span class="op" id="2945293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945296">if</span>&nbsp;<span class="builtinfunc" id="2945299">len</span><span class="op" id="2945302">(</span><span class="ident" id="2945303">s</span><span class="op" id="2945304">)</span>&nbsp;<span class="op" id="2945306">==</span>&nbsp;<span class="num" id="2945309">0</span>&nbsp;<span class="op" id="2945311">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945315">return</span>&nbsp;<span class="builtintype" id="2945322">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2945329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945332">if</span>&nbsp;<span class="builtinfunc" id="2945335">len</span><span class="op" id="2945338">(</span><span class="ident" id="2945339">s</span><span class="op" id="2945340">)</span>&nbsp;<span class="op" id="2945342">&gt;</span>&nbsp;<span class="num" id="2945344">255</span>&nbsp;<span class="op" id="2945348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945352">return</span>&nbsp;<span class="builtintype" id="2945359">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2945366">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945370">if</span>&nbsp;<span class="ident" id="2945373">s</span><span class="op" id="2945374">[</span><span class="num" id="2945375">0</span><span class="op" id="2945376">]</span>&nbsp;<span class="op" id="2945378">==</span>&nbsp;<span class="string" id="2945381">&#39;.&#39;</span>&nbsp;<span class="op" id="2945385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2945389">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945452">s</span>&nbsp;<span class="op" id="2945454">=</span>&nbsp;<span class="ident" id="2945456">s</span><span class="op" id="2945457">[</span><span class="num" id="2945458">1</span><span class="op" id="2945459">:</span><span class="op" id="2945460">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2945463">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945466">last</span>&nbsp;<span class="op" id="2945471">:=</span>&nbsp;<span class="builtintype" id="2945474">byte</span><span class="op" id="2945478">(</span><span class="string" id="2945479">&#39;.&#39;</span><span class="op" id="2945482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945485">ok</span>&nbsp;<span class="op" id="2945488">:=</span>&nbsp;<span class="builtintype" id="2945491">false</span>&nbsp;<span class="comment" id="2945497">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945530">partlen</span>&nbsp;<span class="op" id="2945538">:=</span>&nbsp;<span class="num" id="2945541">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945544">for</span>&nbsp;<span class="ident" id="2945548">i</span>&nbsp;<span class="op" id="2945550">:=</span>&nbsp;<span class="num" id="2945553">0</span><span class="op" id="2945554">;</span>&nbsp;<span class="ident" id="2945556">i</span>&nbsp;<span class="op" id="2945558">&lt;</span>&nbsp;<span class="builtinfunc" id="2945560">len</span><span class="op" id="2945563">(</span><span class="ident" id="2945564">s</span><span class="op" id="2945565">)</span><span class="op" id="2945566">;</span>&nbsp;<span class="ident" id="2945568">i</span><span class="op" id="2945569">++</span>&nbsp;<span class="op" id="2945572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945576">c</span>&nbsp;<span class="op" id="2945578">:=</span>&nbsp;<span class="ident" id="2945581">s</span><span class="op" id="2945582">[</span><span class="ident" id="2945583">i</span><span class="op" id="2945584">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945588">switch</span>&nbsp;<span class="op" id="2945595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945599">default</span><span class="op" id="2945606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945611">return</span>&nbsp;<span class="builtintype" id="2945618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945626">case</span>&nbsp;<span class="string" id="2945631">&#39;a&#39;</span>&nbsp;<span class="op" id="2945635">&lt;=</span>&nbsp;<span class="ident" id="2945638">c</span>&nbsp;<span class="op" id="2945640">&amp;&amp;</span>&nbsp;<span class="ident" id="2945643">c</span>&nbsp;<span class="op" id="2945645">&lt;=</span>&nbsp;<span class="string" id="2945648">&#39;z&#39;</span>&nbsp;<span class="op" id="2945652">||</span>&nbsp;<span class="string" id="2945655">&#39;A&#39;</span>&nbsp;<span class="op" id="2945659">&lt;=</span>&nbsp;<span class="ident" id="2945662">c</span>&nbsp;<span class="op" id="2945664">&amp;&amp;</span>&nbsp;<span class="ident" id="2945667">c</span>&nbsp;<span class="op" id="2945669">&lt;=</span>&nbsp;<span class="string" id="2945672">&#39;Z&#39;</span><span class="op" id="2945675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2945680">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945736">ok</span>&nbsp;<span class="op" id="2945739">=</span>&nbsp;<span class="builtintype" id="2945741">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945749">partlen</span><span class="op" id="2945756">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945761">case</span>&nbsp;<span class="string" id="2945766">&#39;0&#39;</span>&nbsp;<span class="op" id="2945770">&lt;=</span>&nbsp;<span class="ident" id="2945773">c</span>&nbsp;<span class="op" id="2945775">&amp;&amp;</span>&nbsp;<span class="ident" id="2945778">c</span>&nbsp;<span class="op" id="2945780">&lt;=</span>&nbsp;<span class="string" id="2945783">&#39;9&#39;</span><span class="op" id="2945786">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2945791">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945802">partlen</span><span class="op" id="2945809">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945814">case</span>&nbsp;<span class="ident" id="2945819">c</span>&nbsp;<span class="op" id="2945821">==</span>&nbsp;<span class="string" id="2945824">&#39;-&#39;</span><span class="op" id="2945827">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2945832">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945870">if</span>&nbsp;<span class="ident" id="2945873">last</span>&nbsp;<span class="op" id="2945878">==</span>&nbsp;<span class="string" id="2945881">&#39;.&#39;</span>&nbsp;<span class="op" id="2945885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945891">return</span>&nbsp;<span class="builtintype" id="2945898">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2945907">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2945912">partlen</span><span class="op" id="2945919">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945924">case</span>&nbsp;<span class="ident" id="2945929">c</span>&nbsp;<span class="op" id="2945931">==</span>&nbsp;<span class="string" id="2945934">&#39;.&#39;</span><span class="op" id="2945937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2945942">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2945985">if</span>&nbsp;<span class="ident" id="2945988">last</span>&nbsp;<span class="op" id="2945993">==</span>&nbsp;<span class="string" id="2945996">&#39;.&#39;</span>&nbsp;<span class="op" id="2946000">||</span>&nbsp;<span class="ident" id="2946003">last</span>&nbsp;<span class="op" id="2946008">==</span>&nbsp;<span class="string" id="2946011">&#39;-&#39;</span>&nbsp;<span class="op" id="2946015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946021">return</span>&nbsp;<span class="builtintype" id="2946028">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2946037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946042">if</span>&nbsp;<span class="ident" id="2946045">partlen</span>&nbsp;<span class="op" id="2946053">&gt;</span>&nbsp;<span class="num" id="2946055">63</span>&nbsp;<span class="op" id="2946058">||</span>&nbsp;<span class="ident" id="2946061">partlen</span>&nbsp;<span class="op" id="2946069">==</span>&nbsp;<span class="num" id="2946072">0</span>&nbsp;<span class="op" id="2946074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946080">return</span>&nbsp;<span class="builtintype" id="2946087">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2946096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2946101">partlen</span>&nbsp;<span class="op" id="2946109">=</span>&nbsp;<span class="num" id="2946111">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2946115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2946119">last</span>&nbsp;<span class="op" id="2946124">=</span>&nbsp;<span class="ident" id="2946126">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2946129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946132">if</span>&nbsp;<span class="ident" id="2946135">last</span>&nbsp;<span class="op" id="2946140">==</span>&nbsp;<span class="string" id="2946143">&#39;-&#39;</span>&nbsp;<span class="op" id="2946147">||</span>&nbsp;<span class="ident" id="2946150">partlen</span>&nbsp;<span class="op" id="2946158">&gt;</span>&nbsp;<span class="num" id="2946160">63</span>&nbsp;<span class="op" id="2946163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946167">return</span>&nbsp;<span class="builtintype" id="2946174">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2946181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946185">return</span>&nbsp;<span class="ident" id="2946192">ok</span><br>
<span class="lineno"></span><span class="op" id="2946195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="2946198">var</span>&nbsp;<span class="ident" id="2946202">cookieNameSanitizer</span>&nbsp;<span class="op" id="2946222">=</span>&nbsp;<span class="ident" id="2946224">strings</span><span class="op" id="2946231">.</span><span class="ident" id="2946232">NewReplacer</span><span class="op" id="2946243">(</span><span class="string" id="2946244">&#34;\n&#34;</span><span class="op" id="2946248">,</span>&nbsp;<span class="string" id="2946250">&#34;-&#34;</span><span class="op" id="2946253">,</span>&nbsp;<span class="string" id="2946255">&#34;\r&#34;</span><span class="op" id="2946259">,</span>&nbsp;<span class="string" id="2946261">&#34;-&#34;</span><span class="op" id="2946264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2946267">func</span>&nbsp;<span class="ident" id="2946272">sanitizeCookieName</span><span class="op" id="2946290">(</span><span class="ident" id="2946291">n</span>&nbsp;<span class="builtintype" id="2946293">string</span><span class="op" id="2946299">)</span>&nbsp;<span class="builtintype" id="2946301">string</span>&nbsp;<span class="op" id="2946308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946311">return</span>&nbsp;<span class="ident" id="2946318">cookieNameSanitizer</span><span class="op" id="2946337">.</span><span class="ident" id="2946338">Replace</span><span class="op" id="2946345">(</span><span class="ident" id="2946346">n</span><span class="op" id="2946347">)</span><br>
<span class="lineno"></span><span class="op" id="2946349">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2946352">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="2946404">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2946475">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="2946543">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="2946594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="2946646">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="2946675">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="2946742">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="2946811">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="2946837">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="2946893">func</span>&nbsp;<span class="ident" id="2946898">sanitizeCookieValue</span><span class="op" id="2946917">(</span><span class="ident" id="2946918">v</span>&nbsp;<span class="builtintype" id="2946920">string</span><span class="op" id="2946926">)</span>&nbsp;<span class="builtintype" id="2946928">string</span>&nbsp;<span class="op" id="2946935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2946938">v</span>&nbsp;<span class="op" id="2946940">=</span>&nbsp;<span class="ident" id="2946942">sanitizeOrWarn</span><span class="op" id="2946956">(</span><span class="string" id="2946957">&#34;Cookie.Value&#34;</span><span class="op" id="2946971">,</span>&nbsp;<span class="ident" id="2946973">validCookieValueByte</span><span class="op" id="2946993">,</span>&nbsp;<span class="ident" id="2946995">v</span><span class="op" id="2946996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2946999">if</span>&nbsp;<span class="builtinfunc" id="2947002">len</span><span class="op" id="2947005">(</span><span class="ident" id="2947006">v</span><span class="op" id="2947007">)</span>&nbsp;<span class="op" id="2947009">==</span>&nbsp;<span class="num" id="2947012">0</span>&nbsp;<span class="op" id="2947014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947018">return</span>&nbsp;<span class="ident" id="2947025">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947031">if</span>&nbsp;<span class="ident" id="2947034">v</span><span class="op" id="2947035">[</span><span class="num" id="2947036">0</span><span class="op" id="2947037">]</span>&nbsp;<span class="op" id="2947039">==</span>&nbsp;<span class="string" id="2947042">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2947046">||</span>&nbsp;<span class="ident" id="2947049">v</span><span class="op" id="2947050">[</span><span class="num" id="2947051">0</span><span class="op" id="2947052">]</span>&nbsp;<span class="op" id="2947054">==</span>&nbsp;<span class="string" id="2947057">&#39;,&#39;</span>&nbsp;<span class="op" id="2947061">||</span>&nbsp;<span class="ident" id="2947064">v</span><span class="op" id="2947065">[</span><span class="builtinfunc" id="2947066">len</span><span class="op" id="2947069">(</span><span class="ident" id="2947070">v</span><span class="op" id="2947071">)</span><span class="op" id="2947072">-</span><span class="num" id="2947073">1</span><span class="op" id="2947074">]</span>&nbsp;<span class="op" id="2947076">==</span>&nbsp;<span class="string" id="2947079">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2947083">||</span>&nbsp;<span class="ident" id="2947086">v</span><span class="op" id="2947087">[</span><span class="builtinfunc" id="2947088">len</span><span class="op" id="2947091">(</span><span class="ident" id="2947092">v</span><span class="op" id="2947093">)</span><span class="op" id="2947094">-</span><span class="num" id="2947095">1</span><span class="op" id="2947096">]</span>&nbsp;<span class="op" id="2947098">==</span>&nbsp;<span class="string" id="2947101">&#39;,&#39;</span>&nbsp;<span class="op" id="2947105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947109">return</span>&nbsp;<span class="string" id="2947116">`&#34;`</span>&nbsp;<span class="op" id="2947120">+</span>&nbsp;<span class="ident" id="2947122">v</span>&nbsp;<span class="op" id="2947124">+</span>&nbsp;<span class="string" id="2947126">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947134">return</span>&nbsp;<span class="ident" id="2947141">v</span><br>
<span class="lineno">310</span><span class="op" id="2947143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2947146">func</span>&nbsp;<span class="ident" id="2947151">validCookieValueByte</span><span class="op" id="2947171">(</span><span class="ident" id="2947172">b</span>&nbsp;<span class="builtintype" id="2947174">byte</span><span class="op" id="2947178">)</span>&nbsp;<span class="builtintype" id="2947180">bool</span>&nbsp;<span class="op" id="2947185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947188">return</span>&nbsp;<span class="num" id="2947195">0x20</span>&nbsp;<span class="op" id="2947200">&lt;=</span>&nbsp;<span class="ident" id="2947203">b</span>&nbsp;<span class="op" id="2947205">&amp;&amp;</span>&nbsp;<span class="ident" id="2947208">b</span>&nbsp;<span class="op" id="2947210">&lt;</span>&nbsp;<span class="num" id="2947212">0x7f</span>&nbsp;<span class="op" id="2947217">&amp;&amp;</span>&nbsp;<span class="ident" id="2947220">b</span>&nbsp;<span class="op" id="2947222">!=</span>&nbsp;<span class="string" id="2947225">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2947229">&amp;&amp;</span>&nbsp;<span class="ident" id="2947232">b</span>&nbsp;<span class="op" id="2947234">!=</span>&nbsp;<span class="string" id="2947237">&#39;;&#39;</span>&nbsp;<span class="op" id="2947241">&amp;&amp;</span>&nbsp;<span class="ident" id="2947244">b</span>&nbsp;<span class="op" id="2947246">!=</span>&nbsp;<span class="string" id="2947249">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="2947254">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="2947257">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="2947299">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="2947352">func</span>&nbsp;<span class="ident" id="2947357">sanitizeCookiePath</span><span class="op" id="2947375">(</span><span class="ident" id="2947376">v</span>&nbsp;<span class="builtintype" id="2947378">string</span><span class="op" id="2947384">)</span>&nbsp;<span class="builtintype" id="2947386">string</span>&nbsp;<span class="op" id="2947393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947396">return</span>&nbsp;<span class="ident" id="2947403">sanitizeOrWarn</span><span class="op" id="2947417">(</span><span class="string" id="2947418">&#34;Cookie.Path&#34;</span><span class="op" id="2947431">,</span>&nbsp;<span class="ident" id="2947433">validCookiePathByte</span><span class="op" id="2947452">,</span>&nbsp;<span class="ident" id="2947454">v</span><span class="op" id="2947455">)</span><br>
<span class="lineno">320</span><span class="op" id="2947457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2947460">func</span>&nbsp;<span class="ident" id="2947465">validCookiePathByte</span><span class="op" id="2947484">(</span><span class="ident" id="2947485">b</span>&nbsp;<span class="builtintype" id="2947487">byte</span><span class="op" id="2947491">)</span>&nbsp;<span class="builtintype" id="2947493">bool</span>&nbsp;<span class="op" id="2947498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947501">return</span>&nbsp;<span class="num" id="2947508">0x20</span>&nbsp;<span class="op" id="2947513">&lt;=</span>&nbsp;<span class="ident" id="2947516">b</span>&nbsp;<span class="op" id="2947518">&amp;&amp;</span>&nbsp;<span class="ident" id="2947521">b</span>&nbsp;<span class="op" id="2947523">&lt;</span>&nbsp;<span class="num" id="2947525">0x7f</span>&nbsp;<span class="op" id="2947530">&amp;&amp;</span>&nbsp;<span class="ident" id="2947533">b</span>&nbsp;<span class="op" id="2947535">!=</span>&nbsp;<span class="string" id="2947538">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="2947542">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="2947545">func</span>&nbsp;<span class="ident" id="2947550">sanitizeOrWarn</span><span class="op" id="2947564">(</span><span class="ident" id="2947565">fieldName</span>&nbsp;<span class="builtintype" id="2947575">string</span><span class="op" id="2947581">,</span>&nbsp;<span class="ident" id="2947583">valid</span>&nbsp;<span class="keyword" id="2947589">func</span><span class="op" id="2947593">(</span><span class="builtintype" id="2947594">byte</span><span class="op" id="2947598">)</span>&nbsp;<span class="builtintype" id="2947600">bool</span><span class="op" id="2947604">,</span>&nbsp;<span class="ident" id="2947606">v</span>&nbsp;<span class="builtintype" id="2947608">string</span><span class="op" id="2947614">)</span>&nbsp;<span class="builtintype" id="2947616">string</span>&nbsp;<span class="op" id="2947623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2947626">ok</span>&nbsp;<span class="op" id="2947629">:=</span>&nbsp;<span class="builtintype" id="2947632">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947638">for</span>&nbsp;<span class="ident" id="2947642">i</span>&nbsp;<span class="op" id="2947644">:=</span>&nbsp;<span class="num" id="2947647">0</span><span class="op" id="2947648">;</span>&nbsp;<span class="ident" id="2947650">i</span>&nbsp;<span class="op" id="2947652">&lt;</span>&nbsp;<span class="builtinfunc" id="2947654">len</span><span class="op" id="2947657">(</span><span class="ident" id="2947658">v</span><span class="op" id="2947659">)</span><span class="op" id="2947660">;</span>&nbsp;<span class="ident" id="2947662">i</span><span class="op" id="2947663">++</span>&nbsp;<span class="op" id="2947666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947670">if</span>&nbsp;<span class="ident" id="2947673">valid</span><span class="op" id="2947678">(</span><span class="ident" id="2947679">v</span><span class="op" id="2947680">[</span><span class="ident" id="2947681">i</span><span class="op" id="2947682">]</span><span class="op" id="2947683">)</span>&nbsp;<span class="op" id="2947685">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947690">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2947705">log</span><span class="op" id="2947708">.</span><span class="ident" id="2947709">Printf</span><span class="op" id="2947715">(</span><span class="string" id="2947716">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="2947773">,</span>&nbsp;<span class="ident" id="2947775">v</span><span class="op" id="2947776">[</span><span class="ident" id="2947777">i</span><span class="op" id="2947778">]</span><span class="op" id="2947779">,</span>&nbsp;<span class="ident" id="2947781">fieldName</span><span class="op" id="2947790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2947794">ok</span>&nbsp;<span class="op" id="2947797">=</span>&nbsp;<span class="builtintype" id="2947799">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947807">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947817">if</span>&nbsp;<span class="ident" id="2947820">ok</span>&nbsp;<span class="op" id="2947823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947827">return</span>&nbsp;<span class="ident" id="2947834">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2947840">buf</span>&nbsp;<span class="op" id="2947844">:=</span>&nbsp;<span class="builtinfunc" id="2947847">make</span><span class="op" id="2947851">(</span><span class="op" id="2947852">[</span><span class="op" id="2947853">]</span><span class="builtintype" id="2947854">byte</span><span class="op" id="2947858">,</span>&nbsp;<span class="num" id="2947860">0</span><span class="op" id="2947861">,</span>&nbsp;<span class="builtinfunc" id="2947863">len</span><span class="op" id="2947866">(</span><span class="ident" id="2947867">v</span><span class="op" id="2947868">)</span><span class="op" id="2947869">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947872">for</span>&nbsp;<span class="ident" id="2947876">i</span>&nbsp;<span class="op" id="2947878">:=</span>&nbsp;<span class="num" id="2947881">0</span><span class="op" id="2947882">;</span>&nbsp;<span class="ident" id="2947884">i</span>&nbsp;<span class="op" id="2947886">&lt;</span>&nbsp;<span class="builtinfunc" id="2947888">len</span><span class="op" id="2947891">(</span><span class="ident" id="2947892">v</span><span class="op" id="2947893">)</span><span class="op" id="2947894">;</span>&nbsp;<span class="ident" id="2947896">i</span><span class="op" id="2947897">++</span>&nbsp;<span class="op" id="2947900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947904">if</span>&nbsp;<span class="ident" id="2947907">b</span>&nbsp;<span class="op" id="2947909">:=</span>&nbsp;<span class="ident" id="2947912">v</span><span class="op" id="2947913">[</span><span class="ident" id="2947914">i</span><span class="op" id="2947915">]</span><span class="op" id="2947916">;</span>&nbsp;<span class="ident" id="2947918">valid</span><span class="op" id="2947923">(</span><span class="ident" id="2947924">b</span><span class="op" id="2947925">)</span>&nbsp;<span class="op" id="2947927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2947932">buf</span>&nbsp;<span class="op" id="2947936">=</span>&nbsp;<span class="builtinfunc" id="2947938">append</span><span class="op" id="2947944">(</span><span class="ident" id="2947945">buf</span><span class="op" id="2947948">,</span>&nbsp;<span class="ident" id="2947950">b</span><span class="op" id="2947951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2947958">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2947961">return</span>&nbsp;<span class="builtintype" id="2947968">string</span><span class="op" id="2947974">(</span><span class="ident" id="2947975">buf</span><span class="op" id="2947978">)</span><br>
<span class="lineno"></span><span class="op" id="2947980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2947983">func</span>&nbsp;<span class="ident" id="2947988">parseCookieValue</span><span class="op" id="2948004">(</span><span class="ident" id="2948005">raw</span>&nbsp;<span class="builtintype" id="2948009">string</span><span class="op" id="2948015">,</span>&nbsp;<span class="ident" id="2948017">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="2948034">bool</span><span class="op" id="2948038">)</span>&nbsp;<span class="op" id="2948040">(</span><span class="builtintype" id="2948041">string</span><span class="op" id="2948047">,</span>&nbsp;<span class="builtintype" id="2948049">bool</span><span class="op" id="2948053">)</span>&nbsp;<span class="op" id="2948055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2948058">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2948092">if</span>&nbsp;<span class="ident" id="2948095">allowDoubleQuote</span>&nbsp;<span class="op" id="2948112">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2948115">len</span><span class="op" id="2948118">(</span><span class="ident" id="2948119">raw</span><span class="op" id="2948122">)</span>&nbsp;<span class="op" id="2948124">&gt;</span>&nbsp;<span class="num" id="2948126">1</span>&nbsp;<span class="op" id="2948128">&amp;&amp;</span>&nbsp;<span class="ident" id="2948131">raw</span><span class="op" id="2948134">[</span><span class="num" id="2948135">0</span><span class="op" id="2948136">]</span>&nbsp;<span class="op" id="2948138">==</span>&nbsp;<span class="string" id="2948141">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2948145">&amp;&amp;</span>&nbsp;<span class="ident" id="2948148">raw</span><span class="op" id="2948151">[</span><span class="builtinfunc" id="2948152">len</span><span class="op" id="2948155">(</span><span class="ident" id="2948156">raw</span><span class="op" id="2948159">)</span><span class="op" id="2948160">-</span><span class="num" id="2948161">1</span><span class="op" id="2948162">]</span>&nbsp;<span class="op" id="2948164">==</span>&nbsp;<span class="string" id="2948167">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2948171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2948175">raw</span>&nbsp;<span class="op" id="2948179">=</span>&nbsp;<span class="ident" id="2948181">raw</span><span class="op" id="2948184">[</span><span class="num" id="2948185">1</span>&nbsp;<span class="op" id="2948187">:</span>&nbsp;<span class="builtinfunc" id="2948189">len</span><span class="op" id="2948192">(</span><span class="ident" id="2948193">raw</span><span class="op" id="2948196">)</span><span class="op" id="2948197">-</span><span class="num" id="2948198">1</span><span class="op" id="2948199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2948202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2948205">for</span>&nbsp;<span class="ident" id="2948209">i</span>&nbsp;<span class="op" id="2948211">:=</span>&nbsp;<span class="num" id="2948214">0</span><span class="op" id="2948215">;</span>&nbsp;<span class="ident" id="2948217">i</span>&nbsp;<span class="op" id="2948219">&lt;</span>&nbsp;<span class="builtinfunc" id="2948221">len</span><span class="op" id="2948224">(</span><span class="ident" id="2948225">raw</span><span class="op" id="2948228">)</span><span class="op" id="2948229">;</span>&nbsp;<span class="ident" id="2948231">i</span><span class="op" id="2948232">++</span>&nbsp;<span class="op" id="2948235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2948239">if</span>&nbsp;<span class="op" id="2948242">!</span><span class="ident" id="2948243">validCookieValueByte</span><span class="op" id="2948263">(</span><span class="ident" id="2948264">raw</span><span class="op" id="2948267">[</span><span class="ident" id="2948268">i</span><span class="op" id="2948269">]</span><span class="op" id="2948270">)</span>&nbsp;<span class="op" id="2948272">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2948277">return</span>&nbsp;<span class="string" id="2948284">&#34;&#34;</span><span class="op" id="2948286">,</span>&nbsp;<span class="builtintype" id="2948288">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2948296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2948299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2948302">return</span>&nbsp;<span class="ident" id="2948309">raw</span><span class="op" id="2948312">,</span>&nbsp;<span class="builtintype" id="2948314">true</span><br>
<span class="lineno"></span><span class="op" id="2948319">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="2948322">func</span>&nbsp;<span class="ident" id="2948327">isCookieNameValid</span><span class="op" id="2948344">(</span><span class="ident" id="2948345">raw</span>&nbsp;<span class="builtintype" id="2948349">string</span><span class="op" id="2948355">)</span>&nbsp;<span class="builtintype" id="2948357">bool</span>&nbsp;<span class="op" id="2948362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2948365">return</span>&nbsp;<span class="ident" id="2948372">strings</span><span class="op" id="2948379">.</span><span class="ident" id="2948380">IndexFunc</span><span class="op" id="2948389">(</span><span class="ident" id="2948390">raw</span><span class="op" id="2948393">,</span>&nbsp;<span class="ident" id="2948395">isNotToken</span><span class="op" id="2948405">)</span>&nbsp;<span class="op" id="2948407">&lt;</span>&nbsp;<span class="num" id="2948409">0</span><br>
<span class="lineno"></span><span class="op" id="2948411">}</span>
</div>
</body>
</html>
