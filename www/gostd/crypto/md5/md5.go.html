<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4704974">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4705029">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4705083">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4705134">//go:generate&nbsp;go&nbsp;run&nbsp;gen.go&nbsp;-full&nbsp;-output&nbsp;md5block.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705189">//&nbsp;Package&nbsp;md5&nbsp;implements&nbsp;the&nbsp;MD5&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;1321.</span><br>
<span class="lineno"></span><span class="keyword" id="4705262">package</span>&nbsp;<span class="ident" id="4705270">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4705275">import</span>&nbsp;<span class="op" id="4705282">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4705285">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4705295">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4705302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4705305">func</span>&nbsp;<span class="ident" id="4705310">init</span><span class="op" id="4705314">(</span><span class="op" id="4705315">)</span>&nbsp;<span class="op" id="4705317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705320">crypto</span><span class="op" id="4705326">.</span><span class="ident" id="4705327">RegisterHash</span><span class="op" id="4705339">(</span><span class="ident" id="4705340">crypto</span><span class="op" id="4705346">.</span><span class="ident" id="4705347">MD5</span><span class="op" id="4705350">,</span>&nbsp;<span class="ident" id="4705352">New</span><span class="op" id="4705355">)</span><br>
<span class="lineno"></span><span class="op" id="4705357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705360">//&nbsp;The&nbsp;size&nbsp;of&nbsp;an&nbsp;MD5&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4705401">const</span>&nbsp;<span class="ident" id="4705407">Size</span>&nbsp;<span class="op" id="4705412">=</span>&nbsp;<span class="num" id="4705414">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705418">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;MD5&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4705452">const</span>&nbsp;<span class="ident" id="4705458">BlockSize</span>&nbsp;<span class="op" id="4705468">=</span>&nbsp;<span class="num" id="4705470">64</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4705474">const</span>&nbsp;<span class="op" id="4705480">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705483">chunk</span>&nbsp;<span class="op" id="4705489">=</span>&nbsp;<span class="num" id="4705491">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705495">init0</span>&nbsp;<span class="op" id="4705501">=</span>&nbsp;<span class="num" id="4705503">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705515">init1</span>&nbsp;<span class="op" id="4705521">=</span>&nbsp;<span class="num" id="4705523">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705535">init2</span>&nbsp;<span class="op" id="4705541">=</span>&nbsp;<span class="num" id="4705543">0x98BADCFE</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705555">init3</span>&nbsp;<span class="op" id="4705561">=</span>&nbsp;<span class="num" id="4705563">0x10325476</span><br>
<span class="lineno"></span><span class="op" id="4705574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705577">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4705636">type</span>&nbsp;<span class="ident" id="4705641">digest</span>&nbsp;<span class="keyword" id="4705648">struct</span>&nbsp;<span class="op" id="4705655">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705658">s</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4705662">[</span><span class="num" id="4705663">4</span><span class="op" id="4705664">]</span><span class="builtintype" id="4705665">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705673">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4705677">[</span><span class="ident" id="4705678">chunk</span><span class="op" id="4705683">]</span><span class="builtintype" id="4705684">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705690">nx</span>&nbsp;&nbsp;<span class="builtintype" id="4705694">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4705699">len</span>&nbsp;<span class="ident" id="4705703">uint64</span><br>
<span class="lineno"></span><span class="op" id="4705710">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4705713">func</span>&nbsp;<span class="op" id="4705718">(</span><span class="ident" id="4705719">d</span>&nbsp;<span class="op" id="4705721">*</span><span class="ident" id="4705722">digest</span><span class="op" id="4705728">)</span>&nbsp;<span class="ident" id="4705730">Reset</span><span class="op" id="4705735">(</span><span class="op" id="4705736">)</span>&nbsp;<span class="op" id="4705738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705741">d</span><span class="op" id="4705742">.</span><span class="ident" id="4705743">s</span><span class="op" id="4705744">[</span><span class="num" id="4705745">0</span><span class="op" id="4705746">]</span>&nbsp;<span class="op" id="4705748">=</span>&nbsp;<span class="ident" id="4705750">init0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705757">d</span><span class="op" id="4705758">.</span><span class="ident" id="4705759">s</span><span class="op" id="4705760">[</span><span class="num" id="4705761">1</span><span class="op" id="4705762">]</span>&nbsp;<span class="op" id="4705764">=</span>&nbsp;<span class="ident" id="4705766">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705773">d</span><span class="op" id="4705774">.</span><span class="ident" id="4705775">s</span><span class="op" id="4705776">[</span><span class="num" id="4705777">2</span><span class="op" id="4705778">]</span>&nbsp;<span class="op" id="4705780">=</span>&nbsp;<span class="ident" id="4705782">init2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705789">d</span><span class="op" id="4705790">.</span><span class="ident" id="4705791">s</span><span class="op" id="4705792">[</span><span class="num" id="4705793">3</span><span class="op" id="4705794">]</span>&nbsp;<span class="op" id="4705796">=</span>&nbsp;<span class="ident" id="4705798">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705805">d</span><span class="op" id="4705806">.</span><span class="ident" id="4705807">nx</span>&nbsp;<span class="op" id="4705810">=</span>&nbsp;<span class="num" id="4705812">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705815">d</span><span class="op" id="4705816">.</span><span class="builtinfunc" id="4705817">len</span>&nbsp;<span class="op" id="4705821">=</span>&nbsp;<span class="num" id="4705823">0</span><br>
<span class="lineno"></span><span class="op" id="4705825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4705828">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;MD5&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4705887">func</span>&nbsp;<span class="ident" id="4705892">New</span><span class="op" id="4705895">(</span><span class="op" id="4705896">)</span>&nbsp;<span class="ident" id="4705898">hash</span><span class="op" id="4705902">.</span><span class="ident" id="4705903">Hash</span>&nbsp;<span class="op" id="4705908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705911">d</span>&nbsp;<span class="op" id="4705913">:=</span>&nbsp;<span class="builtinfunc" id="4705916">new</span><span class="op" id="4705919">(</span><span class="ident" id="4705920">digest</span><span class="op" id="4705926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4705929">d</span><span class="op" id="4705930">.</span><span class="ident" id="4705931">Reset</span><span class="op" id="4705936">(</span><span class="op" id="4705937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4705940">return</span>&nbsp;<span class="ident" id="4705947">d</span><br>
<span class="lineno">55</span><span class="op" id="4705949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4705952">func</span>&nbsp;<span class="op" id="4705957">(</span><span class="ident" id="4705958">d</span>&nbsp;<span class="op" id="4705960">*</span><span class="ident" id="4705961">digest</span><span class="op" id="4705967">)</span>&nbsp;<span class="ident" id="4705969">Size</span><span class="op" id="4705973">(</span><span class="op" id="4705974">)</span>&nbsp;<span class="builtintype" id="4705976">int</span>&nbsp;<span class="op" id="4705980">{</span>&nbsp;<span class="keyword" id="4705982">return</span>&nbsp;<span class="ident" id="4705989">Size</span>&nbsp;<span class="op" id="4705994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4705997">func</span>&nbsp;<span class="op" id="4706002">(</span><span class="ident" id="4706003">d</span>&nbsp;<span class="op" id="4706005">*</span><span class="ident" id="4706006">digest</span><span class="op" id="4706012">)</span>&nbsp;<span class="ident" id="4706014">BlockSize</span><span class="op" id="4706023">(</span><span class="op" id="4706024">)</span>&nbsp;<span class="builtintype" id="4706026">int</span>&nbsp;<span class="op" id="4706030">{</span>&nbsp;<span class="keyword" id="4706032">return</span>&nbsp;<span class="ident" id="4706039">BlockSize</span>&nbsp;<span class="op" id="4706049">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4706052">func</span>&nbsp;<span class="op" id="4706057">(</span><span class="ident" id="4706058">d</span>&nbsp;<span class="op" id="4706060">*</span><span class="ident" id="4706061">digest</span><span class="op" id="4706067">)</span>&nbsp;<span class="ident" id="4706069">Write</span><span class="op" id="4706074">(</span><span class="ident" id="4706075">p</span>&nbsp;<span class="op" id="4706077">[</span><span class="op" id="4706078">]</span><span class="builtintype" id="4706079">byte</span><span class="op" id="4706083">)</span>&nbsp;<span class="op" id="4706085">(</span><span class="ident" id="4706086">nn</span>&nbsp;<span class="builtintype" id="4706089">int</span><span class="op" id="4706092">,</span>&nbsp;<span class="ident" id="4706094">err</span>&nbsp;<span class="builtintype" id="4706098">error</span><span class="op" id="4706103">)</span>&nbsp;<span class="op" id="4706105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706108">nn</span>&nbsp;<span class="op" id="4706111">=</span>&nbsp;<span class="builtinfunc" id="4706113">len</span><span class="op" id="4706116">(</span><span class="ident" id="4706117">p</span><span class="op" id="4706118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706121">d</span><span class="op" id="4706122">.</span><span class="builtinfunc" id="4706123">len</span>&nbsp;<span class="op" id="4706127">+=</span>&nbsp;<span class="ident" id="4706130">uint64</span><span class="op" id="4706136">(</span><span class="ident" id="4706137">nn</span><span class="op" id="4706139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706142">if</span>&nbsp;<span class="ident" id="4706145">d</span><span class="op" id="4706146">.</span><span class="ident" id="4706147">nx</span>&nbsp;<span class="op" id="4706150">&gt;</span>&nbsp;<span class="num" id="4706152">0</span>&nbsp;<span class="op" id="4706154">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706158">n</span>&nbsp;<span class="op" id="4706160">:=</span>&nbsp;<span class="builtinfunc" id="4706163">len</span><span class="op" id="4706166">(</span><span class="ident" id="4706167">p</span><span class="op" id="4706168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706172">if</span>&nbsp;<span class="ident" id="4706175">n</span>&nbsp;<span class="op" id="4706177">&gt;</span>&nbsp;<span class="ident" id="4706179">chunk</span><span class="op" id="4706184">-</span><span class="ident" id="4706185">d</span><span class="op" id="4706186">.</span><span class="ident" id="4706187">nx</span>&nbsp;<span class="op" id="4706190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706195">n</span>&nbsp;<span class="op" id="4706197">=</span>&nbsp;<span class="ident" id="4706199">chunk</span>&nbsp;<span class="op" id="4706205">-</span>&nbsp;<span class="ident" id="4706207">d</span><span class="op" id="4706208">.</span><span class="ident" id="4706209">nx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706218">for</span>&nbsp;<span class="ident" id="4706222">i</span>&nbsp;<span class="op" id="4706224">:=</span>&nbsp;<span class="num" id="4706227">0</span><span class="op" id="4706228">;</span>&nbsp;<span class="ident" id="4706230">i</span>&nbsp;<span class="op" id="4706232">&lt;</span>&nbsp;<span class="ident" id="4706234">n</span><span class="op" id="4706235">;</span>&nbsp;<span class="ident" id="4706237">i</span><span class="op" id="4706238">++</span>&nbsp;<span class="op" id="4706241">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706246">d</span><span class="op" id="4706247">.</span><span class="ident" id="4706248">x</span><span class="op" id="4706249">[</span><span class="ident" id="4706250">d</span><span class="op" id="4706251">.</span><span class="ident" id="4706252">nx</span><span class="op" id="4706254">+</span><span class="ident" id="4706255">i</span><span class="op" id="4706256">]</span>&nbsp;<span class="op" id="4706258">=</span>&nbsp;<span class="ident" id="4706260">p</span><span class="op" id="4706261">[</span><span class="ident" id="4706262">i</span><span class="op" id="4706263">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706271">d</span><span class="op" id="4706272">.</span><span class="ident" id="4706273">nx</span>&nbsp;<span class="op" id="4706276">+=</span>&nbsp;<span class="ident" id="4706279">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706283">if</span>&nbsp;<span class="ident" id="4706286">d</span><span class="op" id="4706287">.</span><span class="ident" id="4706288">nx</span>&nbsp;<span class="op" id="4706291">==</span>&nbsp;<span class="ident" id="4706294">chunk</span>&nbsp;<span class="op" id="4706300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706305">block</span><span class="op" id="4706310">(</span><span class="ident" id="4706311">d</span><span class="op" id="4706312">,</span>&nbsp;<span class="ident" id="4706314">d</span><span class="op" id="4706315">.</span><span class="ident" id="4706316">x</span><span class="op" id="4706317">[</span><span class="num" id="4706318">0</span><span class="op" id="4706319">:</span><span class="ident" id="4706320">chunk</span><span class="op" id="4706325">]</span><span class="op" id="4706326">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706331">d</span><span class="op" id="4706332">.</span><span class="ident" id="4706333">nx</span>&nbsp;<span class="op" id="4706336">=</span>&nbsp;<span class="num" id="4706338">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706346">p</span>&nbsp;<span class="op" id="4706348">=</span>&nbsp;<span class="ident" id="4706350">p</span><span class="op" id="4706351">[</span><span class="ident" id="4706352">n</span><span class="op" id="4706353">:</span><span class="op" id="4706354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706360">if</span>&nbsp;<span class="builtinfunc" id="4706363">len</span><span class="op" id="4706366">(</span><span class="ident" id="4706367">p</span><span class="op" id="4706368">)</span>&nbsp;<span class="op" id="4706370">&gt;=</span>&nbsp;<span class="ident" id="4706373">chunk</span>&nbsp;<span class="op" id="4706379">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706383">n</span>&nbsp;<span class="op" id="4706385">:=</span>&nbsp;<span class="builtinfunc" id="4706388">len</span><span class="op" id="4706391">(</span><span class="ident" id="4706392">p</span><span class="op" id="4706393">)</span>&nbsp;<span class="op" id="4706395">&amp;^</span>&nbsp;<span class="op" id="4706398">(</span><span class="ident" id="4706399">chunk</span>&nbsp;<span class="op" id="4706405">-</span>&nbsp;<span class="num" id="4706407">1</span><span class="op" id="4706408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706412">block</span><span class="op" id="4706417">(</span><span class="ident" id="4706418">d</span><span class="op" id="4706419">,</span>&nbsp;<span class="ident" id="4706421">p</span><span class="op" id="4706422">[</span><span class="op" id="4706423">:</span><span class="ident" id="4706424">n</span><span class="op" id="4706425">]</span><span class="op" id="4706426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706430">p</span>&nbsp;<span class="op" id="4706432">=</span>&nbsp;<span class="ident" id="4706434">p</span><span class="op" id="4706435">[</span><span class="ident" id="4706436">n</span><span class="op" id="4706437">:</span><span class="op" id="4706438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706444">if</span>&nbsp;<span class="builtinfunc" id="4706447">len</span><span class="op" id="4706450">(</span><span class="ident" id="4706451">p</span><span class="op" id="4706452">)</span>&nbsp;<span class="op" id="4706454">&gt;</span>&nbsp;<span class="num" id="4706456">0</span>&nbsp;<span class="op" id="4706458">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706462">d</span><span class="op" id="4706463">.</span><span class="ident" id="4706464">nx</span>&nbsp;<span class="op" id="4706467">=</span>&nbsp;<span class="builtinfunc" id="4706469">copy</span><span class="op" id="4706473">(</span><span class="ident" id="4706474">d</span><span class="op" id="4706475">.</span><span class="ident" id="4706476">x</span><span class="op" id="4706477">[</span><span class="op" id="4706478">:</span><span class="op" id="4706479">]</span><span class="op" id="4706480">,</span>&nbsp;<span class="ident" id="4706482">p</span><span class="op" id="4706483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706489">return</span><br>
<span class="lineno"></span><span class="op" id="4706496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="4706499">func</span>&nbsp;<span class="op" id="4706504">(</span><span class="ident" id="4706505">d0</span>&nbsp;<span class="op" id="4706508">*</span><span class="ident" id="4706509">digest</span><span class="op" id="4706515">)</span>&nbsp;<span class="ident" id="4706517">Sum</span><span class="op" id="4706520">(</span><span class="ident" id="4706521">in</span>&nbsp;<span class="op" id="4706524">[</span><span class="op" id="4706525">]</span><span class="builtintype" id="4706526">byte</span><span class="op" id="4706530">)</span>&nbsp;<span class="op" id="4706532">[</span><span class="op" id="4706533">]</span><span class="builtintype" id="4706534">byte</span>&nbsp;<span class="op" id="4706539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4706542">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706609">d</span>&nbsp;<span class="op" id="4706611">:=</span>&nbsp;<span class="op" id="4706614">*</span><span class="ident" id="4706615">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706619">hash</span>&nbsp;<span class="op" id="4706624">:=</span>&nbsp;<span class="ident" id="4706627">d</span><span class="op" id="4706628">.</span><span class="ident" id="4706629">checkSum</span><span class="op" id="4706637">(</span><span class="op" id="4706638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706641">return</span>&nbsp;<span class="builtinfunc" id="4706648">append</span><span class="op" id="4706654">(</span><span class="ident" id="4706655">in</span><span class="op" id="4706657">,</span>&nbsp;<span class="ident" id="4706659">hash</span><span class="op" id="4706663">[</span><span class="op" id="4706664">:</span><span class="op" id="4706665">]</span><span class="op" id="4706666">...</span><span class="op" id="4706669">)</span><br>
<span class="lineno">95</span><span class="op" id="4706671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4706674">func</span>&nbsp;<span class="op" id="4706679">(</span><span class="ident" id="4706680">d</span>&nbsp;<span class="op" id="4706682">*</span><span class="ident" id="4706683">digest</span><span class="op" id="4706689">)</span>&nbsp;<span class="ident" id="4706691">checkSum</span><span class="op" id="4706699">(</span><span class="op" id="4706700">)</span>&nbsp;<span class="op" id="4706702">[</span><span class="ident" id="4706703">Size</span><span class="op" id="4706707">]</span><span class="builtintype" id="4706708">byte</span>&nbsp;<span class="op" id="4706713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4706716">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4706776">len</span>&nbsp;<span class="op" id="4706780">:=</span>&nbsp;<span class="ident" id="4706783">d</span><span class="op" id="4706784">.</span><span class="builtinfunc" id="4706785">len</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706790">var</span>&nbsp;<span class="ident" id="4706794">tmp</span>&nbsp;<span class="op" id="4706798">[</span><span class="num" id="4706799">64</span><span class="op" id="4706801">]</span><span class="builtintype" id="4706802">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706808">tmp</span><span class="op" id="4706811">[</span><span class="num" id="4706812">0</span><span class="op" id="4706813">]</span>&nbsp;<span class="op" id="4706815">=</span>&nbsp;<span class="num" id="4706817">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706823">if</span>&nbsp;<span class="builtinfunc" id="4706826">len</span><span class="op" id="4706829">%</span><span class="num" id="4706830">64</span>&nbsp;<span class="op" id="4706833">&lt;</span>&nbsp;<span class="num" id="4706835">56</span>&nbsp;<span class="op" id="4706838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706842">d</span><span class="op" id="4706843">.</span><span class="ident" id="4706844">Write</span><span class="op" id="4706849">(</span><span class="ident" id="4706850">tmp</span><span class="op" id="4706853">[</span><span class="num" id="4706854">0</span>&nbsp;<span class="op" id="4706856">:</span>&nbsp;<span class="num" id="4706858">56</span><span class="op" id="4706860">-</span><span class="builtinfunc" id="4706861">len</span><span class="op" id="4706864">%</span><span class="num" id="4706865">64</span><span class="op" id="4706867">]</span><span class="op" id="4706868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706871">}</span>&nbsp;<span class="keyword" id="4706873">else</span>&nbsp;<span class="op" id="4706878">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706882">d</span><span class="op" id="4706883">.</span><span class="ident" id="4706884">Write</span><span class="op" id="4706889">(</span><span class="ident" id="4706890">tmp</span><span class="op" id="4706893">[</span><span class="num" id="4706894">0</span>&nbsp;<span class="op" id="4706896">:</span>&nbsp;<span class="num" id="4706898">64</span><span class="op" id="4706900">+</span><span class="num" id="4706901">56</span><span class="op" id="4706903">-</span><span class="builtinfunc" id="4706904">len</span><span class="op" id="4706907">%</span><span class="num" id="4706908">64</span><span class="op" id="4706910">]</span><span class="op" id="4706911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4706914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4706918">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4706938">len</span>&nbsp;<span class="op" id="4706942">&lt;&lt;=</span>&nbsp;<span class="num" id="4706946">3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4706949">for</span>&nbsp;<span class="ident" id="4706953">i</span>&nbsp;<span class="op" id="4706955">:=</span>&nbsp;<span class="builtintype" id="4706958">uint</span><span class="op" id="4706962">(</span><span class="num" id="4706963">0</span><span class="op" id="4706964">)</span><span class="op" id="4706965">;</span>&nbsp;<span class="ident" id="4706967">i</span>&nbsp;<span class="op" id="4706969">&lt;</span>&nbsp;<span class="num" id="4706971">8</span><span class="op" id="4706972">;</span>&nbsp;<span class="ident" id="4706974">i</span><span class="op" id="4706975">++</span>&nbsp;<span class="op" id="4706978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4706982">tmp</span><span class="op" id="4706985">[</span><span class="ident" id="4706986">i</span><span class="op" id="4706987">]</span>&nbsp;<span class="op" id="4706989">=</span>&nbsp;<span class="builtintype" id="4706991">byte</span><span class="op" id="4706995">(</span><span class="builtinfunc" id="4706996">len</span>&nbsp;<span class="op" id="4707000">&gt;&gt;</span>&nbsp;<span class="op" id="4707003">(</span><span class="num" id="4707004">8</span>&nbsp;<span class="op" id="4707006">*</span>&nbsp;<span class="ident" id="4707008">i</span><span class="op" id="4707009">)</span><span class="op" id="4707010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4707013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707016">d</span><span class="op" id="4707017">.</span><span class="ident" id="4707018">Write</span><span class="op" id="4707023">(</span><span class="ident" id="4707024">tmp</span><span class="op" id="4707027">[</span><span class="num" id="4707028">0</span><span class="op" id="4707029">:</span><span class="num" id="4707030">8</span><span class="op" id="4707031">]</span><span class="op" id="4707032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4707036">if</span>&nbsp;<span class="ident" id="4707039">d</span><span class="op" id="4707040">.</span><span class="ident" id="4707041">nx</span>&nbsp;<span class="op" id="4707044">!=</span>&nbsp;<span class="num" id="4707047">0</span>&nbsp;<span class="op" id="4707049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4707053">panic</span><span class="op" id="4707058">(</span><span class="string" id="4707059">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4707070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4707073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4707077">var</span>&nbsp;<span class="ident" id="4707081">digest</span>&nbsp;<span class="op" id="4707088">[</span><span class="ident" id="4707089">Size</span><span class="op" id="4707093">]</span><span class="builtintype" id="4707094">byte</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4707100">for</span>&nbsp;<span class="ident" id="4707104">i</span><span class="op" id="4707105">,</span>&nbsp;<span class="ident" id="4707107">s</span>&nbsp;<span class="op" id="4707109">:=</span>&nbsp;<span class="keyword" id="4707112">range</span>&nbsp;<span class="ident" id="4707118">d</span><span class="op" id="4707119">.</span><span class="ident" id="4707120">s</span>&nbsp;<span class="op" id="4707122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707126">digest</span><span class="op" id="4707132">[</span><span class="ident" id="4707133">i</span><span class="op" id="4707134">*</span><span class="num" id="4707135">4</span><span class="op" id="4707136">]</span>&nbsp;<span class="op" id="4707138">=</span>&nbsp;<span class="builtintype" id="4707140">byte</span><span class="op" id="4707144">(</span><span class="ident" id="4707145">s</span><span class="op" id="4707146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707150">digest</span><span class="op" id="4707156">[</span><span class="ident" id="4707157">i</span><span class="op" id="4707158">*</span><span class="num" id="4707159">4</span><span class="op" id="4707160">+</span><span class="num" id="4707161">1</span><span class="op" id="4707162">]</span>&nbsp;<span class="op" id="4707164">=</span>&nbsp;<span class="builtintype" id="4707166">byte</span><span class="op" id="4707170">(</span><span class="ident" id="4707171">s</span>&nbsp;<span class="op" id="4707173">&gt;&gt;</span>&nbsp;<span class="num" id="4707176">8</span><span class="op" id="4707177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707181">digest</span><span class="op" id="4707187">[</span><span class="ident" id="4707188">i</span><span class="op" id="4707189">*</span><span class="num" id="4707190">4</span><span class="op" id="4707191">+</span><span class="num" id="4707192">2</span><span class="op" id="4707193">]</span>&nbsp;<span class="op" id="4707195">=</span>&nbsp;<span class="builtintype" id="4707197">byte</span><span class="op" id="4707201">(</span><span class="ident" id="4707202">s</span>&nbsp;<span class="op" id="4707204">&gt;&gt;</span>&nbsp;<span class="num" id="4707207">16</span><span class="op" id="4707209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707213">digest</span><span class="op" id="4707219">[</span><span class="ident" id="4707220">i</span><span class="op" id="4707221">*</span><span class="num" id="4707222">4</span><span class="op" id="4707223">+</span><span class="num" id="4707224">3</span><span class="op" id="4707225">]</span>&nbsp;<span class="op" id="4707227">=</span>&nbsp;<span class="builtintype" id="4707229">byte</span><span class="op" id="4707233">(</span><span class="ident" id="4707234">s</span>&nbsp;<span class="op" id="4707236">&gt;&gt;</span>&nbsp;<span class="num" id="4707239">24</span><span class="op" id="4707241">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4707244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4707248">return</span>&nbsp;<span class="ident" id="4707255">digest</span><br>
<span class="lineno"></span><span class="op" id="4707262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="4707265">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;MD5&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4707310">func</span>&nbsp;<span class="ident" id="4707315">Sum</span><span class="op" id="4707318">(</span><span class="ident" id="4707319">data</span>&nbsp;<span class="op" id="4707324">[</span><span class="op" id="4707325">]</span><span class="builtintype" id="4707326">byte</span><span class="op" id="4707330">)</span>&nbsp;<span class="op" id="4707332">[</span><span class="ident" id="4707333">Size</span><span class="op" id="4707337">]</span><span class="builtintype" id="4707338">byte</span>&nbsp;<span class="op" id="4707343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4707346">var</span>&nbsp;<span class="ident" id="4707350">d</span>&nbsp;<span class="ident" id="4707352">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707360">d</span><span class="op" id="4707361">.</span><span class="ident" id="4707362">Reset</span><span class="op" id="4707367">(</span><span class="op" id="4707368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4707371">d</span><span class="op" id="4707372">.</span><span class="ident" id="4707373">Write</span><span class="op" id="4707378">(</span><span class="ident" id="4707379">data</span><span class="op" id="4707383">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4707386">return</span>&nbsp;<span class="ident" id="4707393">d</span><span class="op" id="4707394">.</span><span class="ident" id="4707395">checkSum</span><span class="op" id="4707403">(</span><span class="op" id="4707404">)</span><br>
<span class="lineno"></span><span class="op" id="4707406">}</span>
</div>
</body>
</html>
