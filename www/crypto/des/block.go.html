<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4256604">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4256659">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4256713">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4256764">package</span>&nbsp;<span class="ident" id="4256772">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4256777">import</span>&nbsp;<span class="op" id="4256784">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4256787">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4256805">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4256808">func</span>&nbsp;<span class="ident" id="4256813">cryptBlock</span><span class="op" id="4256823">(</span><span class="ident" id="4256824">subkeys</span>&nbsp;<span class="op" id="4256832">[</span><span class="op" id="4256833">]</span><span class="ident" id="4256834">uint64</span><span class="op" id="4256840">,</span>&nbsp;<span class="ident" id="4256842">dst</span><span class="op" id="4256845">,</span>&nbsp;<span class="ident" id="4256847">src</span>&nbsp;<span class="op" id="4256851">[</span><span class="op" id="4256852">]</span><span class="builtintype" id="4256853">byte</span><span class="op" id="4256857">,</span>&nbsp;<span class="ident" id="4256859">decrypt</span>&nbsp;<span class="builtintype" id="4256867">bool</span><span class="op" id="4256871">)</span>&nbsp;<span class="op" id="4256873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4256876">b</span>&nbsp;<span class="op" id="4256878">:=</span>&nbsp;<span class="ident" id="4256881"><a href="/crypto/des/block.go.html#4256787">binary</a></span><span class="op" id="4256887">.</span><span class="ident" id="4256888">BigEndian</span><span class="op" id="4256897">.</span><span class="ident" id="4256898">Uint64</span><span class="op" id="4256904">(</span><span class="ident" id="4256905"><a href="/crypto/des/block.go.html#4256847">src</a></span><span class="op" id="4256908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4256911"><a href="/crypto/des/block.go.html#4256876">b</a></span>&nbsp;<span class="op" id="4256913">=</span>&nbsp;<span class="ident" id="4256915"><a href="/crypto/des/block.go.html#4259275">permuteInitialBlock</a></span><span class="op" id="4256934">(</span><span class="ident" id="4256935"><a href="/crypto/des/block.go.html#4256876">b</a></span><span class="op" id="4256936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4256939">left</span><span class="op" id="4256943">,</span>&nbsp;<span class="ident" id="4256945">right</span>&nbsp;<span class="op" id="4256951">:=</span>&nbsp;<span class="builtintype" id="4256954">uint32</span><span class="op" id="4256960">(</span><span class="ident" id="4256961"><a href="/crypto/des/block.go.html#4256876">b</a></span><span class="op" id="4256962">&gt;&gt;</span><span class="num" id="4256964">32</span><span class="op" id="4256966">)</span><span class="op" id="4256967">,</span>&nbsp;<span class="builtintype" id="4256969">uint32</span><span class="op" id="4256975">(</span><span class="ident" id="4256976"><a href="/crypto/des/block.go.html#4256876">b</a></span><span class="op" id="4256977">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4256981">var</span>&nbsp;<span class="ident" id="4256985">subkey</span>&nbsp;<span class="ident" id="4256992">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4257000">for</span>&nbsp;<span class="ident" id="4257004">i</span>&nbsp;<span class="op" id="4257006">:=</span>&nbsp;<span class="num" id="4257009">0</span><span class="op" id="4257010">;</span>&nbsp;<span class="ident" id="4257012"><a href="/crypto/des/block.go.html#4257004">i</a></span>&nbsp;<span class="op" id="4257014">&lt;</span>&nbsp;<span class="num" id="4257016">16</span><span class="op" id="4257018">;</span>&nbsp;<span class="ident" id="4257020"><a href="/crypto/des/block.go.html#4257004">i</a></span><span class="op" id="4257021">++</span>&nbsp;<span class="op" id="4257024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4257028">if</span>&nbsp;<span class="ident" id="4257031"><a href="/crypto/des/block.go.html#4256859">decrypt</a></span>&nbsp;<span class="op" id="4257039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257044"><a href="/crypto/des/block.go.html#4256985">subkey</a></span>&nbsp;<span class="op" id="4257051">=</span>&nbsp;<span class="ident" id="4257053"><a href="/crypto/des/block.go.html#4256824">subkeys</a></span><span class="op" id="4257060">[</span><span class="num" id="4257061">15</span><span class="op" id="4257063">-</span><span class="ident" id="4257064"><a href="/crypto/des/block.go.html#4257004">i</a></span><span class="op" id="4257065">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4257069">}</span>&nbsp;<span class="keyword" id="4257071">else</span>&nbsp;<span class="op" id="4257076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257081"><a href="/crypto/des/block.go.html#4256985">subkey</a></span>&nbsp;<span class="op" id="4257088">=</span>&nbsp;<span class="ident" id="4257090"><a href="/crypto/des/block.go.html#4256824">subkeys</a></span><span class="op" id="4257097">[</span><span class="ident" id="4257098"><a href="/crypto/des/block.go.html#4257004">i</a></span><span class="op" id="4257099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4257103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257108"><a href="/crypto/des/block.go.html#4256939">left</a></span><span class="op" id="4257112">,</span>&nbsp;<span class="ident" id="4257114"><a href="/crypto/des/block.go.html#4256945">right</a></span>&nbsp;<span class="op" id="4257120">=</span>&nbsp;<span class="ident" id="4257122"><a href="/crypto/des/block.go.html#4256945">right</a></span><span class="op" id="4257127">,</span>&nbsp;<span class="ident" id="4257129"><a href="/crypto/des/block.go.html#4256939">left</a></span><span class="op" id="4257133">^</span><span class="ident" id="4257134"><a href="/crypto/des/block.go.html#4257669">feistel</a></span><span class="op" id="4257141">(</span><span class="ident" id="4257142"><a href="/crypto/des/block.go.html#4256945">right</a></span><span class="op" id="4257147">,</span>&nbsp;<span class="ident" id="4257149"><a href="/crypto/des/block.go.html#4256985">subkey</a></span><span class="op" id="4257155">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4257158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4257161">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257215">preOutput</span>&nbsp;<span class="op" id="4257225">:=</span>&nbsp;<span class="op" id="4257228">(</span><span class="ident" id="4257229">uint64</span><span class="op" id="4257235">(</span><span class="ident" id="4257236"><a href="/crypto/des/block.go.html#4256945">right</a></span><span class="op" id="4257241">)</span>&nbsp;<span class="op" id="4257243">&lt;&lt;</span>&nbsp;<span class="num" id="4257246">32</span><span class="op" id="4257248">)</span>&nbsp;<span class="op" id="4257250">|</span>&nbsp;<span class="ident" id="4257252">uint64</span><span class="op" id="4257258">(</span><span class="ident" id="4257259"><a href="/crypto/des/block.go.html#4256939">left</a></span><span class="op" id="4257263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257266"><a href="/crypto/des/block.go.html#4256787">binary</a></span><span class="op" id="4257272">.</span><span class="ident" id="4257273">BigEndian</span><span class="op" id="4257282">.</span><span class="ident" id="4257283">PutUint64</span><span class="op" id="4257292">(</span><span class="ident" id="4257293"><a href="/crypto/des/block.go.html#4256842">dst</a></span><span class="op" id="4257296">,</span>&nbsp;<span class="ident" id="4257298"><a href="/crypto/des/block.go.html#4260894">permuteFinalBlock</a></span><span class="op" id="4257315">(</span><span class="ident" id="4257316"><a href="/crypto/des/block.go.html#4257215">preOutput</a></span><span class="op" id="4257325">)</span><span class="op" id="4257326">)</span><br>
<span class="lineno"></span><span class="op" id="4257328">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4257331">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4257390">func</span>&nbsp;<span class="ident" id="4257395">encryptBlock</span><span class="op" id="4257407">(</span><span class="ident" id="4257408">subkeys</span>&nbsp;<span class="op" id="4257416">[</span><span class="op" id="4257417">]</span><span class="ident" id="4257418">uint64</span><span class="op" id="4257424">,</span>&nbsp;<span class="ident" id="4257426">dst</span><span class="op" id="4257429">,</span>&nbsp;<span class="ident" id="4257431">src</span>&nbsp;<span class="op" id="4257435">[</span><span class="op" id="4257436">]</span><span class="builtintype" id="4257437">byte</span><span class="op" id="4257441">)</span>&nbsp;<span class="op" id="4257443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257446"><a href="/crypto/des/block.go.html#4256813">cryptBlock</a></span><span class="op" id="4257456">(</span><span class="ident" id="4257457"><a href="/crypto/des/block.go.html#4257408">subkeys</a></span><span class="op" id="4257464">,</span>&nbsp;<span class="ident" id="4257466"><a href="/crypto/des/block.go.html#4257426">dst</a></span><span class="op" id="4257469">,</span>&nbsp;<span class="ident" id="4257471"><a href="/crypto/des/block.go.html#4257431">src</a></span><span class="op" id="4257474">,</span>&nbsp;<span class="ident" id="4257476">false</span><span class="op" id="4257481">)</span><br>
<span class="lineno"></span><span class="op" id="4257483">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4257486">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4257545">func</span>&nbsp;<span class="ident" id="4257550">decryptBlock</span><span class="op" id="4257562">(</span><span class="ident" id="4257563">subkeys</span>&nbsp;<span class="op" id="4257571">[</span><span class="op" id="4257572">]</span><span class="ident" id="4257573">uint64</span><span class="op" id="4257579">,</span>&nbsp;<span class="ident" id="4257581">dst</span><span class="op" id="4257584">,</span>&nbsp;<span class="ident" id="4257586">src</span>&nbsp;<span class="op" id="4257590">[</span><span class="op" id="4257591">]</span><span class="builtintype" id="4257592">byte</span><span class="op" id="4257596">)</span>&nbsp;<span class="op" id="4257598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257601"><a href="/crypto/des/block.go.html#4256813">cryptBlock</a></span><span class="op" id="4257611">(</span><span class="ident" id="4257612"><a href="/crypto/des/block.go.html#4257563">subkeys</a></span><span class="op" id="4257619">,</span>&nbsp;<span class="ident" id="4257621"><a href="/crypto/des/block.go.html#4257581">dst</a></span><span class="op" id="4257624">,</span>&nbsp;<span class="ident" id="4257626"><a href="/crypto/des/block.go.html#4257586">src</a></span><span class="op" id="4257629">,</span>&nbsp;<span class="ident" id="4257631">true</span><span class="op" id="4257635">)</span><br>
<span class="lineno"></span><span class="op" id="4257637">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4257640">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4257664">func</span>&nbsp;<span class="ident" id="4257669">feistel</span><span class="op" id="4257676">(</span><span class="ident" id="4257677">right</span>&nbsp;<span class="builtintype" id="4257683">uint32</span><span class="op" id="4257689">,</span>&nbsp;<span class="ident" id="4257691">key</span>&nbsp;<span class="ident" id="4257695">uint64</span><span class="op" id="4257701">)</span>&nbsp;<span class="op" id="4257703">(</span><span class="ident" id="4257704">result</span>&nbsp;<span class="builtintype" id="4257711">uint32</span><span class="op" id="4257717">)</span>&nbsp;<span class="op" id="4257719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257722">sBoxLocations</span>&nbsp;<span class="op" id="4257736">:=</span>&nbsp;<span class="ident" id="4257739"><a href="/crypto/des/block.go.html#4257691">key</a></span>&nbsp;<span class="op" id="4257743">^</span>&nbsp;<span class="ident" id="4257745"><a href="/crypto/des/block.go.html#4258882">expandBlock</a></span><span class="op" id="4257756">(</span><span class="ident" id="4257757"><a href="/crypto/des/block.go.html#4257677">right</a></span><span class="op" id="4257762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4257765">var</span>&nbsp;<span class="ident" id="4257769">sBoxResult</span>&nbsp;<span class="builtintype" id="4257780">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4257788">for</span>&nbsp;<span class="ident" id="4257792">i</span>&nbsp;<span class="op" id="4257794">:=</span>&nbsp;<span class="builtintype" id="4257797">uint8</span><span class="op" id="4257802">(</span><span class="num" id="4257803">0</span><span class="op" id="4257804">)</span><span class="op" id="4257805">;</span>&nbsp;<span class="ident" id="4257807"><a href="/crypto/des/block.go.html#4257792">i</a></span>&nbsp;<span class="op" id="4257809">&lt;</span>&nbsp;<span class="num" id="4257811">8</span><span class="op" id="4257812">;</span>&nbsp;<span class="ident" id="4257814"><a href="/crypto/des/block.go.html#4257792">i</a></span><span class="op" id="4257815">++</span>&nbsp;<span class="op" id="4257818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257822">sBoxLocation</span>&nbsp;<span class="op" id="4257835">:=</span>&nbsp;<span class="builtintype" id="4257838">uint8</span><span class="op" id="4257843">(</span><span class="ident" id="4257844"><a href="/crypto/des/block.go.html#4257722">sBoxLocations</a></span><span class="op" id="4257857">&gt;&gt;</span><span class="num" id="4257859">42</span><span class="op" id="4257861">)</span>&nbsp;<span class="op" id="4257863">&amp;</span>&nbsp;<span class="num" id="4257865">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257872"><a href="/crypto/des/block.go.html#4257722">sBoxLocations</a></span>&nbsp;<span class="op" id="4257886">&lt;&lt;=</span>&nbsp;<span class="num" id="4257890">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4257894">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4257933">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4257965">row</span>&nbsp;<span class="op" id="4257969">:=</span>&nbsp;<span class="op" id="4257972">(</span><span class="ident" id="4257973"><a href="/crypto/des/block.go.html#4257822">sBoxLocation</a></span>&nbsp;<span class="op" id="4257986">&amp;</span>&nbsp;<span class="num" id="4257988">0x1</span><span class="op" id="4257991">)</span>&nbsp;<span class="op" id="4257993">|</span>&nbsp;<span class="op" id="4257995">(</span><span class="op" id="4257996">(</span><span class="ident" id="4257997"><a href="/crypto/des/block.go.html#4257822">sBoxLocation</a></span>&nbsp;<span class="op" id="4258010">&amp;</span>&nbsp;<span class="num" id="4258012">0x20</span><span class="op" id="4258016">)</span>&nbsp;<span class="op" id="4258018">&gt;&gt;</span>&nbsp;<span class="num" id="4258021">4</span><span class="op" id="4258022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258026">column</span>&nbsp;<span class="op" id="4258033">:=</span>&nbsp;<span class="op" id="4258036">(</span><span class="ident" id="4258037"><a href="/crypto/des/block.go.html#4257822">sBoxLocation</a></span>&nbsp;<span class="op" id="4258050">&gt;&gt;</span>&nbsp;<span class="num" id="4258053">1</span><span class="op" id="4258054">)</span>&nbsp;<span class="op" id="4258056">&amp;</span>&nbsp;<span class="num" id="4258058">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258064"><a href="/crypto/des/block.go.html#4257769">sBoxResult</a></span>&nbsp;<span class="op" id="4258075">^=</span>&nbsp;<span class="ident" id="4258078"><a href="/crypto/des/block.go.html#4258238">feistelBox</a></span><span class="op" id="4258088">[</span><span class="ident" id="4258089"><a href="/crypto/des/block.go.html#4257792">i</a></span><span class="op" id="4258090">]</span><span class="op" id="4258091">[</span><span class="num" id="4258092">16</span><span class="op" id="4258094">*</span><span class="ident" id="4258095"><a href="/crypto/des/block.go.html#4257965">row</a></span><span class="op" id="4258098">+</span><span class="ident" id="4258099"><a href="/crypto/des/block.go.html#4258026">column</a></span><span class="op" id="4258105">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4258108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4258111">return</span>&nbsp;<span class="ident" id="4258118"><a href="/crypto/des/block.go.html#4257769">sBoxResult</a></span><br>
<span class="lineno">55</span><span class="op" id="4258129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4258132">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4258200">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4258234">var</span>&nbsp;<span class="ident" id="4258238">feistelBox</span>&nbsp;<span class="op" id="4258249">[</span><span class="num" id="4258250">8</span><span class="op" id="4258251">]</span><span class="op" id="4258252">[</span><span class="num" id="4258253">64</span><span class="op" id="4258255">]</span><span class="builtintype" id="4258256">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4258264">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4258326">func</span>&nbsp;<span class="ident" id="4258331">permuteBlock</span><span class="op" id="4258343">(</span><span class="ident" id="4258344">src</span>&nbsp;<span class="ident" id="4258348">uint64</span><span class="op" id="4258354">,</span>&nbsp;<span class="ident" id="4258356">permutation</span>&nbsp;<span class="op" id="4258368">[</span><span class="op" id="4258369">]</span><span class="builtintype" id="4258370">uint8</span><span class="op" id="4258375">)</span>&nbsp;<span class="op" id="4258377">(</span><span class="ident" id="4258378">block</span>&nbsp;<span class="ident" id="4258384">uint64</span><span class="op" id="4258390">)</span>&nbsp;<span class="op" id="4258392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4258395">for</span>&nbsp;<span class="ident" id="4258399">position</span><span class="op" id="4258407">,</span>&nbsp;<span class="ident" id="4258409">n</span>&nbsp;<span class="op" id="4258411">:=</span>&nbsp;<span class="keyword" id="4258414">range</span>&nbsp;<span class="ident" id="4258420"><a href="/crypto/des/block.go.html#4258356">permutation</a></span>&nbsp;<span class="op" id="4258432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258436">bit</span>&nbsp;<span class="op" id="4258440">:=</span>&nbsp;<span class="op" id="4258443">(</span><span class="ident" id="4258444"><a href="/crypto/des/block.go.html#4258344">src</a></span>&nbsp;<span class="op" id="4258448">&gt;&gt;</span>&nbsp;<span class="ident" id="4258451"><a href="/crypto/des/block.go.html#4258409">n</a></span><span class="op" id="4258452">)</span>&nbsp;<span class="op" id="4258454">&amp;</span>&nbsp;<span class="num" id="4258456">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258460"><a href="/crypto/des/block.go.html#4258378">block</a></span>&nbsp;<span class="op" id="4258466">|=</span>&nbsp;<span class="ident" id="4258469"><a href="/crypto/des/block.go.html#4258436">bit</a></span>&nbsp;<span class="op" id="4258473">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4258476">uint</span><span class="op" id="4258480">(</span><span class="op" id="4258481">(</span><span class="builtinfunc" id="4258482">len</span><span class="op" id="4258485">(</span><span class="ident" id="4258486"><a href="/crypto/des/block.go.html#4258356">permutation</a></span><span class="op" id="4258497">)</span><span class="op" id="4258498">-</span><span class="num" id="4258499">1</span><span class="op" id="4258500">)</span><span class="op" id="4258501">-</span><span class="ident" id="4258502"><a href="/crypto/des/block.go.html#4258399">position</a></span><span class="op" id="4258510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4258513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4258516">return</span><br>
<span class="lineno"></span><span class="op" id="4258523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4258526">func</span>&nbsp;<span class="ident" id="4258531">init</span><span class="op" id="4258535">(</span><span class="op" id="4258536">)</span>&nbsp;<span class="op" id="4258538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4258541">for</span>&nbsp;<span class="ident" id="4258545">s</span>&nbsp;<span class="op" id="4258547">:=</span>&nbsp;<span class="keyword" id="4258550">range</span>&nbsp;<span class="ident" id="4258556"><a href="/crypto/des/const.go.html#4266673">sBoxes</a></span>&nbsp;<span class="op" id="4258563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4258567">for</span>&nbsp;<span class="ident" id="4258571">i</span>&nbsp;<span class="op" id="4258573">:=</span>&nbsp;<span class="num" id="4258576">0</span><span class="op" id="4258577">;</span>&nbsp;<span class="ident" id="4258579"><a href="/crypto/des/block.go.html#4258571">i</a></span>&nbsp;<span class="op" id="4258581">&lt;</span>&nbsp;<span class="num" id="4258583">4</span><span class="op" id="4258584">;</span>&nbsp;<span class="ident" id="4258586"><a href="/crypto/des/block.go.html#4258571">i</a></span><span class="op" id="4258587">++</span>&nbsp;<span class="op" id="4258590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4258595">for</span>&nbsp;<span class="ident" id="4258599">j</span>&nbsp;<span class="op" id="4258601">:=</span>&nbsp;<span class="num" id="4258604">0</span><span class="op" id="4258605">;</span>&nbsp;<span class="ident" id="4258607"><a href="/crypto/des/block.go.html#4258599">j</a></span>&nbsp;<span class="op" id="4258609">&lt;</span>&nbsp;<span class="num" id="4258611">16</span><span class="op" id="4258613">;</span>&nbsp;<span class="ident" id="4258615"><a href="/crypto/des/block.go.html#4258599">j</a></span><span class="op" id="4258616">++</span>&nbsp;<span class="op" id="4258619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258625">f</span>&nbsp;<span class="op" id="4258627">:=</span>&nbsp;<span class="ident" id="4258630">uint64</span><span class="op" id="4258636">(</span><span class="ident" id="4258637"><a href="/crypto/des/const.go.html#4266673">sBoxes</a></span><span class="op" id="4258643">[</span><span class="ident" id="4258644"><a href="/crypto/des/block.go.html#4258545">s</a></span><span class="op" id="4258645">]</span><span class="op" id="4258646">[</span><span class="ident" id="4258647"><a href="/crypto/des/block.go.html#4258571">i</a></span><span class="op" id="4258648">]</span><span class="op" id="4258649">[</span><span class="ident" id="4258650"><a href="/crypto/des/block.go.html#4258599">j</a></span><span class="op" id="4258651">]</span><span class="op" id="4258652">)</span>&nbsp;<span class="op" id="4258654">&lt;&lt;</span>&nbsp;<span class="op" id="4258657">(</span><span class="num" id="4258658">4</span>&nbsp;<span class="op" id="4258660">*</span>&nbsp;<span class="op" id="4258662">(</span><span class="num" id="4258663">7</span>&nbsp;<span class="op" id="4258665">-</span>&nbsp;<span class="builtintype" id="4258667">uint</span><span class="op" id="4258671">(</span><span class="ident" id="4258672"><a href="/crypto/des/block.go.html#4258545">s</a></span><span class="op" id="4258673">)</span><span class="op" id="4258674">)</span><span class="op" id="4258675">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258681"><a href="/crypto/des/block.go.html#4258625">f</a></span>&nbsp;<span class="op" id="4258683">=</span>&nbsp;<span class="ident" id="4258685"><a href="/crypto/des/block.go.html#4258331">permuteBlock</a></span><span class="op" id="4258697">(</span><span class="ident" id="4258698">uint64</span><span class="op" id="4258704">(</span><span class="ident" id="4258705"><a href="/crypto/des/block.go.html#4258625">f</a></span><span class="op" id="4258706">)</span><span class="op" id="4258707">,</span>&nbsp;<span class="ident" id="4258709"><a href="/crypto/des/const.go.html#4265781">permutationFunction</a></span><span class="op" id="4258728">[</span><span class="op" id="4258729">:</span><span class="op" id="4258730">]</span><span class="op" id="4258731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258737"><a href="/crypto/des/block.go.html#4258238">feistelBox</a></span><span class="op" id="4258747">[</span><span class="ident" id="4258748"><a href="/crypto/des/block.go.html#4258545">s</a></span><span class="op" id="4258749">]</span><span class="op" id="4258750">[</span><span class="num" id="4258751">16</span><span class="op" id="4258753">*</span><span class="ident" id="4258754"><a href="/crypto/des/block.go.html#4258571">i</a></span><span class="op" id="4258755">+</span><span class="ident" id="4258756"><a href="/crypto/des/block.go.html#4258599">j</a></span><span class="op" id="4258757">]</span>&nbsp;<span class="op" id="4258759">=</span>&nbsp;<span class="builtintype" id="4258761">uint32</span><span class="op" id="4258767">(</span><span class="ident" id="4258768"><a href="/crypto/des/block.go.html#4258625">f</a></span><span class="op" id="4258769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4258774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4258778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4258781">}</span><br>
<span class="lineno">80</span><span class="op" id="4258783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4258786">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4258836">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4258877">func</span>&nbsp;<span class="ident" id="4258882">expandBlock</span><span class="op" id="4258893">(</span><span class="ident" id="4258894">src</span>&nbsp;<span class="builtintype" id="4258898">uint32</span><span class="op" id="4258904">)</span>&nbsp;<span class="op" id="4258906">(</span><span class="ident" id="4258907">block</span>&nbsp;<span class="ident" id="4258913">uint64</span><span class="op" id="4258919">)</span>&nbsp;<span class="op" id="4258921">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4258924">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4258968"><a href="/crypto/des/block.go.html#4258894">src</a></span>&nbsp;<span class="op" id="4258972">=</span>&nbsp;<span class="op" id="4258974">(</span><span class="ident" id="4258975"><a href="/crypto/des/block.go.html#4258894">src</a></span>&nbsp;<span class="op" id="4258979">&lt;&lt;</span>&nbsp;<span class="num" id="4258982">5</span><span class="op" id="4258983">)</span>&nbsp;<span class="op" id="4258985">|</span>&nbsp;<span class="op" id="4258987">(</span><span class="ident" id="4258988"><a href="/crypto/des/block.go.html#4258894">src</a></span>&nbsp;<span class="op" id="4258992">&gt;&gt;</span>&nbsp;<span class="num" id="4258995">27</span><span class="op" id="4258997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4259000">for</span>&nbsp;<span class="ident" id="4259004">i</span>&nbsp;<span class="op" id="4259006">:=</span>&nbsp;<span class="num" id="4259009">0</span><span class="op" id="4259010">;</span>&nbsp;<span class="ident" id="4259012"><a href="/crypto/des/block.go.html#4259004">i</a></span>&nbsp;<span class="op" id="4259014">&lt;</span>&nbsp;<span class="num" id="4259016">8</span><span class="op" id="4259017">;</span>&nbsp;<span class="ident" id="4259019"><a href="/crypto/des/block.go.html#4259004">i</a></span><span class="op" id="4259020">++</span>&nbsp;<span class="op" id="4259023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259027"><a href="/crypto/des/block.go.html#4258907">block</a></span>&nbsp;<span class="op" id="4259033">&lt;&lt;=</span>&nbsp;<span class="num" id="4259037">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259041">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259075"><a href="/crypto/des/block.go.html#4258907">block</a></span>&nbsp;<span class="op" id="4259081">|=</span>&nbsp;<span class="ident" id="4259084">uint64</span><span class="op" id="4259090">(</span><span class="ident" id="4259091"><a href="/crypto/des/block.go.html#4258894">src</a></span><span class="op" id="4259094">)</span>&nbsp;<span class="op" id="4259096">&amp;</span>&nbsp;<span class="op" id="4259098">(</span><span class="num" id="4259099">1</span><span class="op" id="4259100">&lt;&lt;</span><span class="num" id="4259102">6</span>&nbsp;<span class="op" id="4259104">-</span>&nbsp;<span class="num" id="4259106">1</span><span class="op" id="4259107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259111">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259135"><a href="/crypto/des/block.go.html#4258894">src</a></span>&nbsp;<span class="op" id="4259139">=</span>&nbsp;<span class="op" id="4259141">(</span><span class="ident" id="4259142"><a href="/crypto/des/block.go.html#4258894">src</a></span>&nbsp;<span class="op" id="4259146">&lt;&lt;</span>&nbsp;<span class="num" id="4259149">4</span><span class="op" id="4259150">)</span>&nbsp;<span class="op" id="4259152">|</span>&nbsp;<span class="op" id="4259154">(</span><span class="ident" id="4259155"><a href="/crypto/des/block.go.html#4258894">src</a></span>&nbsp;<span class="op" id="4259159">&gt;&gt;</span>&nbsp;<span class="num" id="4259162">28</span><span class="op" id="4259164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4259167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4259170">return</span><br>
<span class="lineno">95</span><span class="op" id="4259177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4259180">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4259244">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4259270">func</span>&nbsp;<span class="ident" id="4259275">permuteInitialBlock</span><span class="op" id="4259294">(</span><span class="ident" id="4259295">block</span>&nbsp;<span class="ident" id="4259301">uint64</span><span class="op" id="4259307">)</span>&nbsp;<span class="ident" id="4259309">uint64</span>&nbsp;<span class="op" id="4259316">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259319">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259365">b1</span>&nbsp;<span class="op" id="4259368">:=</span>&nbsp;<span class="ident" id="4259371"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259377">&gt;&gt;</span>&nbsp;<span class="num" id="4259380">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259384">b2</span>&nbsp;<span class="op" id="4259387">:=</span>&nbsp;<span class="ident" id="4259390"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259396">&lt;&lt;</span>&nbsp;<span class="num" id="4259399">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259403"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259409">^=</span>&nbsp;<span class="ident" id="4259412"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4259415">^</span>&nbsp;<span class="ident" id="4259417"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4259420">^</span>&nbsp;<span class="ident" id="4259422"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4259424">&lt;&lt;</span><span class="num" id="4259426">48</span>&nbsp;<span class="op" id="4259429">^</span>&nbsp;<span class="ident" id="4259431"><a href="/crypto/des/block.go.html#4259384">b2</a></span><span class="op" id="4259433">&gt;&gt;</span><span class="num" id="4259435">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259440">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259476"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4259479">=</span>&nbsp;<span class="ident" id="4259481"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259487">&gt;&gt;</span>&nbsp;<span class="num" id="4259490">32</span>&nbsp;<span class="op" id="4259493">&amp;</span>&nbsp;<span class="num" id="4259495">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259505"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4259508">=</span>&nbsp;<span class="op" id="4259510">(</span><span class="ident" id="4259511"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259517">&amp;</span>&nbsp;<span class="num" id="4259519">0xff00ff00</span><span class="op" id="4259529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259532"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259538">^=</span>&nbsp;<span class="ident" id="4259541"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4259543">&lt;&lt;</span><span class="num" id="4259545">32</span>&nbsp;<span class="op" id="4259548">^</span>&nbsp;<span class="ident" id="4259550"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4259553">^</span>&nbsp;<span class="ident" id="4259555"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4259557">&lt;&lt;</span><span class="num" id="4259559">8</span>&nbsp;<span class="op" id="4259561">^</span>&nbsp;<span class="ident" id="4259563"><a href="/crypto/des/block.go.html#4259384">b2</a></span><span class="op" id="4259565">&lt;&lt;</span><span class="num" id="4259567">24</span>&nbsp;<span class="comment" id="4259570">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259601">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259660">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259688">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259716">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259772">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259800">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259828">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259856">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4259885">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259928"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4259931">=</span>&nbsp;<span class="ident" id="4259933"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259939">&amp;</span>&nbsp;<span class="num" id="4259941">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259961"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4259964">=</span>&nbsp;<span class="ident" id="4259966"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4259972">&amp;</span>&nbsp;<span class="num" id="4259974">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4259994"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4260000">^=</span>&nbsp;<span class="ident" id="4260003"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4260006">^</span>&nbsp;<span class="ident" id="4260008"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4260011">^</span>&nbsp;<span class="ident" id="4260013"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4260015">&gt;&gt;</span><span class="num" id="4260017">12</span>&nbsp;<span class="op" id="4260020">^</span>&nbsp;<span class="ident" id="4260022"><a href="/crypto/des/block.go.html#4259384">b2</a></span><span class="op" id="4260024">&lt;&lt;</span><span class="num" id="4260026">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260031">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260061">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260065">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260090">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260094">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260110">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260126">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260142">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260168">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4260206"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4260209">=</span>&nbsp;<span class="ident" id="4260211"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4260217">&amp;</span>&nbsp;<span class="num" id="4260219">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4260239"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4260242">=</span>&nbsp;<span class="ident" id="4260244"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4260250">&amp;</span>&nbsp;<span class="num" id="4260252">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4260272"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4260278">^=</span>&nbsp;<span class="ident" id="4260281"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4260284">^</span>&nbsp;<span class="ident" id="4260286"><a href="/crypto/des/block.go.html#4259384">b2</a></span>&nbsp;<span class="op" id="4260289">^</span>&nbsp;<span class="ident" id="4260291"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4260293">&gt;&gt;</span><span class="num" id="4260295">6</span>&nbsp;<span class="op" id="4260297">^</span>&nbsp;<span class="ident" id="4260299"><a href="/crypto/des/block.go.html#4259384">b2</a></span><span class="op" id="4260301">&lt;&lt;</span><span class="num" id="4260303">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260307">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260337">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260347">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260357">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260367">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260377">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260387">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260397">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260407">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260436">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4260474"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4260477">=</span>&nbsp;<span class="ident" id="4260479"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4260485">&amp;</span>&nbsp;<span class="num" id="4260487">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4260507"><a href="/crypto/des/block.go.html#4259295">block</a></span>&nbsp;<span class="op" id="4260513">^=</span>&nbsp;<span class="ident" id="4260516"><a href="/crypto/des/block.go.html#4259365">b1</a></span>&nbsp;<span class="op" id="4260519">^</span>&nbsp;<span class="ident" id="4260521"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4260523">&gt;&gt;</span><span class="num" id="4260525">33</span>&nbsp;<span class="op" id="4260528">^</span>&nbsp;<span class="ident" id="4260530"><a href="/crypto/des/block.go.html#4259365">b1</a></span><span class="op" id="4260532">&lt;&lt;</span><span class="num" id="4260534">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260539">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260569">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260596">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260623">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260650">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260677">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260704">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260731">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260758">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4260785">return</span>&nbsp;<span class="ident" id="4260792"><a href="/crypto/des/block.go.html#4259295">block</a></span><br>
<span class="lineno"></span><span class="op" id="4260798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4260801">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4260865">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4260889">func</span>&nbsp;<span class="ident" id="4260894">permuteFinalBlock</span><span class="op" id="4260911">(</span><span class="ident" id="4260912">block</span>&nbsp;<span class="ident" id="4260918">uint64</span><span class="op" id="4260924">)</span>&nbsp;<span class="ident" id="4260926">uint64</span>&nbsp;<span class="op" id="4260933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260936">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4260994">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261020">b1</span>&nbsp;<span class="op" id="4261023">:=</span>&nbsp;<span class="ident" id="4261026"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261032">&amp;</span>&nbsp;<span class="num" id="4261034">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261054"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261060">^=</span>&nbsp;<span class="ident" id="4261063"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261066">^</span>&nbsp;<span class="ident" id="4261068"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261070">&gt;&gt;</span><span class="num" id="4261072">33</span>&nbsp;<span class="op" id="4261075">^</span>&nbsp;<span class="ident" id="4261077"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261079">&lt;&lt;</span><span class="num" id="4261081">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261086"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261089">=</span>&nbsp;<span class="ident" id="4261091"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261097">&amp;</span>&nbsp;<span class="num" id="4261099">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261119">b2</span>&nbsp;<span class="op" id="4261122">:=</span>&nbsp;<span class="ident" id="4261125"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261131">&amp;</span>&nbsp;<span class="num" id="4261133">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261153"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261159">^=</span>&nbsp;<span class="ident" id="4261162"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261165">^</span>&nbsp;<span class="ident" id="4261167"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261170">^</span>&nbsp;<span class="ident" id="4261172"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261174">&gt;&gt;</span><span class="num" id="4261176">6</span>&nbsp;<span class="op" id="4261178">^</span>&nbsp;<span class="ident" id="4261180"><a href="/crypto/des/block.go.html#4261119">b2</a></span><span class="op" id="4261182">&lt;&lt;</span><span class="num" id="4261184">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261188"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261191">=</span>&nbsp;<span class="ident" id="4261193"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261199">&amp;</span>&nbsp;<span class="num" id="4261201">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261221"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261224">=</span>&nbsp;<span class="ident" id="4261226"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261232">&amp;</span>&nbsp;<span class="num" id="4261234">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261254"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261260">^=</span>&nbsp;<span class="ident" id="4261263"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261266">^</span>&nbsp;<span class="ident" id="4261268"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261271">^</span>&nbsp;<span class="ident" id="4261273"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261275">&gt;&gt;</span><span class="num" id="4261277">12</span>&nbsp;<span class="op" id="4261280">^</span>&nbsp;<span class="ident" id="4261282"><a href="/crypto/des/block.go.html#4261119">b2</a></span><span class="op" id="4261284">&lt;&lt;</span><span class="num" id="4261286">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261291"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261294">=</span>&nbsp;<span class="ident" id="4261296"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261302">&gt;&gt;</span>&nbsp;<span class="num" id="4261305">32</span>&nbsp;<span class="op" id="4261308">&amp;</span>&nbsp;<span class="num" id="4261310">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261320"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261323">=</span>&nbsp;<span class="op" id="4261325">(</span><span class="ident" id="4261326"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261332">&amp;</span>&nbsp;<span class="num" id="4261334">0xff00ff00</span><span class="op" id="4261344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261347"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261353">^=</span>&nbsp;<span class="ident" id="4261356"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261358">&lt;&lt;</span><span class="num" id="4261360">32</span>&nbsp;<span class="op" id="4261363">^</span>&nbsp;<span class="ident" id="4261365"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261368">^</span>&nbsp;<span class="ident" id="4261370"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261372">&lt;&lt;</span><span class="num" id="4261374">8</span>&nbsp;<span class="op" id="4261376">^</span>&nbsp;<span class="ident" id="4261378"><a href="/crypto/des/block.go.html#4261119">b2</a></span><span class="op" id="4261380">&lt;&lt;</span><span class="num" id="4261382">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261387"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261390">=</span>&nbsp;<span class="ident" id="4261392"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261398">&gt;&gt;</span>&nbsp;<span class="num" id="4261401">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261405"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261408">=</span>&nbsp;<span class="ident" id="4261410"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261416">&lt;&lt;</span>&nbsp;<span class="num" id="4261419">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261423"><a href="/crypto/des/block.go.html#4260912">block</a></span>&nbsp;<span class="op" id="4261429">^=</span>&nbsp;<span class="ident" id="4261432"><a href="/crypto/des/block.go.html#4261020">b1</a></span>&nbsp;<span class="op" id="4261435">^</span>&nbsp;<span class="ident" id="4261437"><a href="/crypto/des/block.go.html#4261119">b2</a></span>&nbsp;<span class="op" id="4261440">^</span>&nbsp;<span class="ident" id="4261442"><a href="/crypto/des/block.go.html#4261020">b1</a></span><span class="op" id="4261444">&lt;&lt;</span><span class="num" id="4261446">48</span>&nbsp;<span class="op" id="4261449">^</span>&nbsp;<span class="ident" id="4261451"><a href="/crypto/des/block.go.html#4261119">b2</a></span><span class="op" id="4261453">&gt;&gt;</span><span class="num" id="4261455">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4261459">return</span>&nbsp;<span class="ident" id="4261466"><a href="/crypto/des/block.go.html#4260912">block</a></span><br>
<span class="lineno"></span><span class="op" id="4261472">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4261475">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4261521">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4261549">func</span>&nbsp;<span class="ident" id="4261554">ksRotate</span><span class="op" id="4261562">(</span><span class="ident" id="4261563">in</span>&nbsp;<span class="builtintype" id="4261566">uint32</span><span class="op" id="4261572">)</span>&nbsp;<span class="op" id="4261574">(</span><span class="ident" id="4261575">out</span>&nbsp;<span class="op" id="4261579">[</span><span class="op" id="4261580">]</span><span class="builtintype" id="4261581">uint32</span><span class="op" id="4261587">)</span>&nbsp;<span class="op" id="4261589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261592"><a href="/crypto/des/block.go.html#4261575">out</a></span>&nbsp;<span class="op" id="4261596">=</span>&nbsp;<span class="builtinfunc" id="4261598">make</span><span class="op" id="4261602">(</span><span class="op" id="4261603">[</span><span class="op" id="4261604">]</span><span class="builtintype" id="4261605">uint32</span><span class="op" id="4261611">,</span>&nbsp;<span class="num" id="4261613">16</span><span class="op" id="4261615">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261618">last</span>&nbsp;<span class="op" id="4261623">:=</span>&nbsp;<span class="ident" id="4261626"><a href="/crypto/des/block.go.html#4261563">in</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4261630">for</span>&nbsp;<span class="ident" id="4261634">i</span>&nbsp;<span class="op" id="4261636">:=</span>&nbsp;<span class="num" id="4261639">0</span><span class="op" id="4261640">;</span>&nbsp;<span class="ident" id="4261642"><a href="/crypto/des/block.go.html#4261634">i</a></span>&nbsp;<span class="op" id="4261644">&lt;</span>&nbsp;<span class="num" id="4261646">16</span><span class="op" id="4261648">;</span>&nbsp;<span class="ident" id="4261650"><a href="/crypto/des/block.go.html#4261634">i</a></span><span class="op" id="4261651">++</span>&nbsp;<span class="op" id="4261654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261658">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261690">left</span>&nbsp;<span class="op" id="4261695">:=</span>&nbsp;<span class="op" id="4261698">(</span><span class="ident" id="4261699"><a href="/crypto/des/block.go.html#4261618">last</a></span>&nbsp;<span class="op" id="4261704">&lt;&lt;</span>&nbsp;<span class="op" id="4261707">(</span><span class="num" id="4261708">4</span>&nbsp;<span class="op" id="4261710">+</span>&nbsp;<span class="ident" id="4261712"><a href="/crypto/des/const.go.html#4268782">ksRotations</a></span><span class="op" id="4261723">[</span><span class="ident" id="4261724"><a href="/crypto/des/block.go.html#4261634">i</a></span><span class="op" id="4261725">]</span><span class="op" id="4261726">)</span><span class="op" id="4261727">)</span>&nbsp;<span class="op" id="4261729">&gt;&gt;</span>&nbsp;<span class="num" id="4261732">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261736">right</span>&nbsp;<span class="op" id="4261742">:=</span>&nbsp;<span class="op" id="4261745">(</span><span class="ident" id="4261746"><a href="/crypto/des/block.go.html#4261618">last</a></span>&nbsp;<span class="op" id="4261751">&lt;&lt;</span>&nbsp;<span class="num" id="4261754">4</span><span class="op" id="4261755">)</span>&nbsp;<span class="op" id="4261757">&gt;&gt;</span>&nbsp;<span class="op" id="4261760">(</span><span class="num" id="4261761">32</span>&nbsp;<span class="op" id="4261764">-</span>&nbsp;<span class="ident" id="4261766"><a href="/crypto/des/const.go.html#4268782">ksRotations</a></span><span class="op" id="4261777">[</span><span class="ident" id="4261778"><a href="/crypto/des/block.go.html#4261634">i</a></span><span class="op" id="4261779">]</span><span class="op" id="4261780">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261784"><a href="/crypto/des/block.go.html#4261575">out</a></span><span class="op" id="4261787">[</span><span class="ident" id="4261788"><a href="/crypto/des/block.go.html#4261634">i</a></span><span class="op" id="4261789">]</span>&nbsp;<span class="op" id="4261791">=</span>&nbsp;<span class="ident" id="4261793"><a href="/crypto/des/block.go.html#4261690">left</a></span>&nbsp;<span class="op" id="4261798">|</span>&nbsp;<span class="ident" id="4261800"><a href="/crypto/des/block.go.html#4261736">right</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261808"><a href="/crypto/des/block.go.html#4261618">last</a></span>&nbsp;<span class="op" id="4261813">=</span>&nbsp;<span class="ident" id="4261815"><a href="/crypto/des/block.go.html#4261575">out</a></span><span class="op" id="4261818">[</span><span class="ident" id="4261819"><a href="/crypto/des/block.go.html#4261634">i</a></span><span class="op" id="4261820">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4261823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4261826">return</span><br>
<span class="lineno"></span><span class="op" id="4261833">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4261836">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4261887">func</span>&nbsp;<span class="op" id="4261892">(</span><span class="ident" id="4261893">c</span>&nbsp;<span class="op" id="4261895">*</span><span class="ident" id="4261896"><a href="/crypto/des/cipher.go.html#4262975">desCipher</a></span><span class="op" id="4261905">)</span>&nbsp;<span class="ident" id="4261907">generateSubkeys</span><span class="op" id="4261922">(</span><span class="ident" id="4261923">keyBytes</span>&nbsp;<span class="op" id="4261932">[</span><span class="op" id="4261933">]</span><span class="builtintype" id="4261934">byte</span><span class="op" id="4261938">)</span>&nbsp;<span class="op" id="4261940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261943">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261976">key</span>&nbsp;<span class="op" id="4261980">:=</span>&nbsp;<span class="ident" id="4261983"><a href="/crypto/des/block.go.html#4256787">binary</a></span><span class="op" id="4261989">.</span><span class="ident" id="4261990">BigEndian</span><span class="op" id="4261999">.</span><span class="ident" id="4262000">Uint64</span><span class="op" id="4262006">(</span><span class="ident" id="4262007"><a href="/crypto/des/block.go.html#4261923">keyBytes</a></span><span class="op" id="4262015">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262018">permutedKey</span>&nbsp;<span class="op" id="4262030">:=</span>&nbsp;<span class="ident" id="4262033"><a href="/crypto/des/block.go.html#4258331">permuteBlock</a></span><span class="op" id="4262045">(</span><span class="ident" id="4262046"><a href="/crypto/des/block.go.html#4261976">key</a></span><span class="op" id="4262049">,</span>&nbsp;<span class="ident" id="4262051"><a href="/crypto/des/const.go.html#4266012">permutedChoice1</a></span><span class="op" id="4262066">[</span><span class="op" id="4262067">:</span><span class="op" id="4262068">]</span><span class="op" id="4262069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4262073">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262142">leftRotations</span>&nbsp;<span class="op" id="4262156">:=</span>&nbsp;<span class="ident" id="4262159"><a href="/crypto/des/block.go.html#4261554">ksRotate</a></span><span class="op" id="4262167">(</span><span class="builtintype" id="4262168">uint32</span><span class="op" id="4262174">(</span><span class="ident" id="4262175"><a href="/crypto/des/block.go.html#4262018">permutedKey</a></span>&nbsp;<span class="op" id="4262187">&gt;&gt;</span>&nbsp;<span class="num" id="4262190">28</span><span class="op" id="4262192">)</span><span class="op" id="4262193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262196">rightRotations</span>&nbsp;<span class="op" id="4262211">:=</span>&nbsp;<span class="ident" id="4262214"><a href="/crypto/des/block.go.html#4261554">ksRotate</a></span><span class="op" id="4262222">(</span><span class="builtintype" id="4262223">uint32</span><span class="op" id="4262229">(</span><span class="ident" id="4262230"><a href="/crypto/des/block.go.html#4262018">permutedKey</a></span><span class="op" id="4262241">&lt;&lt;</span><span class="num" id="4262243">4</span><span class="op" id="4262244">)</span>&nbsp;<span class="op" id="4262246">&gt;&gt;</span>&nbsp;<span class="num" id="4262249">4</span><span class="op" id="4262250">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4262254">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4262275">for</span>&nbsp;<span class="ident" id="4262279">i</span>&nbsp;<span class="op" id="4262281">:=</span>&nbsp;<span class="num" id="4262284">0</span><span class="op" id="4262285">;</span>&nbsp;<span class="ident" id="4262287"><a href="/crypto/des/block.go.html#4262279">i</a></span>&nbsp;<span class="op" id="4262289">&lt;</span>&nbsp;<span class="num" id="4262291">16</span><span class="op" id="4262293">;</span>&nbsp;<span class="ident" id="4262295"><a href="/crypto/des/block.go.html#4262279">i</a></span><span class="op" id="4262296">++</span>&nbsp;<span class="op" id="4262299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4262303">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262351">pc2Input</span>&nbsp;<span class="op" id="4262360">:=</span>&nbsp;<span class="ident" id="4262363">uint64</span><span class="op" id="4262369">(</span><span class="ident" id="4262370"><a href="/crypto/des/block.go.html#4262142">leftRotations</a></span><span class="op" id="4262383">[</span><span class="ident" id="4262384"><a href="/crypto/des/block.go.html#4262279">i</a></span><span class="op" id="4262385">]</span><span class="op" id="4262386">)</span><span class="op" id="4262387">&lt;&lt;</span><span class="num" id="4262389">28</span>&nbsp;<span class="op" id="4262392">|</span>&nbsp;<span class="ident" id="4262394">uint64</span><span class="op" id="4262400">(</span><span class="ident" id="4262401"><a href="/crypto/des/block.go.html#4262196">rightRotations</a></span><span class="op" id="4262415">[</span><span class="ident" id="4262416"><a href="/crypto/des/block.go.html#4262279">i</a></span><span class="op" id="4262417">]</span><span class="op" id="4262418">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4262422">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262465"><a href="/crypto/des/block.go.html#4261893">c</a></span><span class="op" id="4262466">.</span><span class="ident" id="4262467">subkeys</span><span class="op" id="4262474">[</span><span class="ident" id="4262475"><a href="/crypto/des/block.go.html#4262279">i</a></span><span class="op" id="4262476">]</span>&nbsp;<span class="op" id="4262478">=</span>&nbsp;<span class="ident" id="4262480"><a href="/crypto/des/block.go.html#4258331">permuteBlock</a></span><span class="op" id="4262492">(</span><span class="ident" id="4262493"><a href="/crypto/des/block.go.html#4262351">pc2Input</a></span><span class="op" id="4262501">,</span>&nbsp;<span class="ident" id="4262503"><a href="/crypto/des/const.go.html#4266367">permutedChoice2</a></span><span class="op" id="4262518">[</span><span class="op" id="4262519">:</span><span class="op" id="4262520">]</span><span class="op" id="4262521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4262524">}</span><br>
<span class="lineno"></span><span class="op" id="4262526">}</span>
</div>
</body>
</html>
