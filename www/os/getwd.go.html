<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2074719">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2074774">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2074828">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2074879">package</span>&nbsp;<span class="ident" id="2074887">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2074891">import</span>&nbsp;<span class="op" id="2074898">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2074901">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2074912">&#34;sync&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2074920">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2074930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2074933">var</span>&nbsp;<span class="ident" id="2074937">getwdCache</span>&nbsp;<span class="keyword" id="2074948">struct</span>&nbsp;<span class="op" id="2074955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074958"><a href="/os/getwd.go.html#2074912">sync</a></span><span class="op" id="2074962">.</span><span class="ident" id="2074963">Mutex</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074970">dir</span>&nbsp;<span class="builtintype" id="2074974">string</span><br>
<span class="lineno"></span><span class="op" id="2074981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074984">//&nbsp;useSyscallwd&nbsp;determines&nbsp;whether&nbsp;to&nbsp;use&nbsp;the&nbsp;return&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2075046">//&nbsp;syscall.Getwd&nbsp;based&nbsp;on&nbsp;its&nbsp;error.</span><br>
<span class="lineno">20</span><span class="keyword" id="2075083">var</span>&nbsp;<span class="ident" id="2075087">useSyscallwd</span>&nbsp;<span class="op" id="2075100">=</span>&nbsp;<span class="keyword" id="2075102">func</span><span class="op" id="2075106">(</span><span class="builtintype" id="2075107">error</span><span class="op" id="2075112">)</span>&nbsp;<span class="builtintype" id="2075114">bool</span>&nbsp;<span class="op" id="2075119">{</span>&nbsp;<span class="keyword" id="2075121">return</span>&nbsp;<span class="ident" id="2075128">true</span>&nbsp;<span class="op" id="2075133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2075136">//&nbsp;Getwd&nbsp;returns&nbsp;a&nbsp;rooted&nbsp;path&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2075193">//&nbsp;current&nbsp;directory.&nbsp;&nbsp;If&nbsp;the&nbsp;current&nbsp;directory&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2075248">//&nbsp;reached&nbsp;via&nbsp;multiple&nbsp;paths&nbsp;(due&nbsp;to&nbsp;symbolic&nbsp;links),</span><br>
<span class="lineno">25</span><span class="comment" id="2075303">//&nbsp;Getwd&nbsp;may&nbsp;return&nbsp;any&nbsp;one&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span><span class="keyword" id="2075340">func</span>&nbsp;<span class="ident" id="2075345">Getwd</span><span class="op" id="2075350">(</span><span class="op" id="2075351">)</span>&nbsp;<span class="op" id="2075353">(</span><span class="ident" id="2075354">dir</span>&nbsp;<span class="builtintype" id="2075358">string</span><span class="op" id="2075364">,</span>&nbsp;<span class="ident" id="2075366">err</span>&nbsp;<span class="builtintype" id="2075370">error</span><span class="op" id="2075375">)</span>&nbsp;<span class="op" id="2075377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075380">if</span>&nbsp;<span class="ident" id="2075383"><a href="/os/getwd.go.html#2074901">runtime</a></span><span class="op" id="2075390">.</span><span class="ident" id="2075391">GOOS</span>&nbsp;<span class="op" id="2075396">==</span>&nbsp;<span class="string" id="2075399">&#34;windows&#34;</span>&nbsp;<span class="op" id="2075409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075413">return</span>&nbsp;<span class="ident" id="2075420"><a href="/os/getwd.go.html#2074920">syscall</a></span><span class="op" id="2075427">.</span><span class="ident" id="2075428">Getwd</span><span class="op" id="2075433">(</span><span class="op" id="2075434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075437">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075441">//&nbsp;Clumsy&nbsp;but&nbsp;widespread&nbsp;kludge:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075475">//&nbsp;if&nbsp;$PWD&nbsp;is&nbsp;set&nbsp;and&nbsp;matches&nbsp;&#34;.&#34;,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075519">dot</span><span class="op" id="2075522">,</span>&nbsp;<span class="ident" id="2075524"><a href="/os/getwd.go.html#2075366">err</a></span>&nbsp;<span class="op" id="2075528">:=</span>&nbsp;<span class="ident" id="2075531"><a href="/os/file_unix.go.html#2068839">Stat</a></span><span class="op" id="2075535">(</span><span class="string" id="2075536">&#34;.&#34;</span><span class="op" id="2075539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075542">if</span>&nbsp;<span class="ident" id="2075545"><a href="/os/getwd.go.html#2075366">err</a></span>&nbsp;<span class="op" id="2075549">!=</span>&nbsp;<span class="ident" id="2075552">nil</span>&nbsp;<span class="op" id="2075556">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075560">return</span>&nbsp;<span class="string" id="2075567">&#34;&#34;</span><span class="op" id="2075569">,</span>&nbsp;<span class="ident" id="2075571"><a href="/os/getwd.go.html#2075366">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075579"><a href="/os/getwd.go.html#2075354">dir</a></span>&nbsp;<span class="op" id="2075583">=</span>&nbsp;<span class="ident" id="2075585"><a href="/os/env.go.html#2043043">Getenv</a></span><span class="op" id="2075591">(</span><span class="string" id="2075592">&#34;PWD&#34;</span><span class="op" id="2075597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075600">if</span>&nbsp;<span class="builtinfunc" id="2075603">len</span><span class="op" id="2075606">(</span><span class="ident" id="2075607"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2075610">)</span>&nbsp;<span class="op" id="2075612">&gt;</span>&nbsp;<span class="num" id="2075614">0</span>&nbsp;<span class="op" id="2075616">&amp;&amp;</span>&nbsp;<span class="ident" id="2075619"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2075622">[</span><span class="num" id="2075623">0</span><span class="op" id="2075624">]</span>&nbsp;<span class="op" id="2075626">==</span>&nbsp;<span class="string" id="2075629">&#39;/&#39;</span>&nbsp;<span class="op" id="2075633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075637">d</span><span class="op" id="2075638">,</span>&nbsp;<span class="ident" id="2075640">err</span>&nbsp;<span class="op" id="2075644">:=</span>&nbsp;<span class="ident" id="2075647"><a href="/os/file_unix.go.html#2068839">Stat</a></span><span class="op" id="2075651">(</span><span class="ident" id="2075652"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2075655">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075659">if</span>&nbsp;<span class="ident" id="2075662"><a href="/os/getwd.go.html#2075640">err</a></span>&nbsp;<span class="op" id="2075666">==</span>&nbsp;<span class="ident" id="2075669">nil</span>&nbsp;<span class="op" id="2075673">&amp;&amp;</span>&nbsp;<span class="ident" id="2075676"><a href="/os/types.go.html#2089277">SameFile</a></span><span class="op" id="2075684">(</span><span class="ident" id="2075685"><a href="/os/getwd.go.html#2075519">dot</a></span><span class="op" id="2075688">,</span>&nbsp;<span class="ident" id="2075690"><a href="/os/getwd.go.html#2075637">d</a></span><span class="op" id="2075691">)</span>&nbsp;<span class="op" id="2075693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075698">return</span>&nbsp;<span class="ident" id="2075705"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2075708">,</span>&nbsp;<span class="ident" id="2075710">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075723">//&nbsp;If&nbsp;the&nbsp;operating&nbsp;system&nbsp;provides&nbsp;a&nbsp;Getwd&nbsp;call,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075782">//&nbsp;Otherwise,&nbsp;we&#39;re&nbsp;trying&nbsp;to&nbsp;find&nbsp;our&nbsp;way&nbsp;back&nbsp;to&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075839">if</span>&nbsp;<span class="ident" id="2075842"><a href="/os/getwd.go.html#2074920">syscall</a></span><span class="op" id="2075849">.</span><span class="ident" id="2075850">ImplementsGetwd</span>&nbsp;<span class="op" id="2075866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075870">s</span><span class="op" id="2075871">,</span>&nbsp;<span class="ident" id="2075873">e</span>&nbsp;<span class="op" id="2075875">:=</span>&nbsp;<span class="ident" id="2075878"><a href="/os/getwd.go.html#2074920">syscall</a></span><span class="op" id="2075885">.</span><span class="ident" id="2075886">Getwd</span><span class="op" id="2075891">(</span><span class="op" id="2075892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075896">if</span>&nbsp;<span class="ident" id="2075899"><a href="/os/getwd.go.html#2075087">useSyscallwd</a></span><span class="op" id="2075911">(</span><span class="ident" id="2075912"><a href="/os/getwd.go.html#2075873">e</a></span><span class="op" id="2075913">)</span>&nbsp;<span class="op" id="2075915">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075920">return</span>&nbsp;<span class="ident" id="2075927"><a href="/os/getwd.go.html#2075870">s</a></span><span class="op" id="2075928">,</span>&nbsp;<span class="ident" id="2075930"><a href="/os/error.go.html#2044800">NewSyscallError</a></span><span class="op" id="2075945">(</span><span class="string" id="2075946">&#34;getwd&#34;</span><span class="op" id="2075953">,</span>&nbsp;<span class="ident" id="2075955"><a href="/os/getwd.go.html#2075873">e</a></span><span class="op" id="2075956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075967">//&nbsp;Apply&nbsp;same&nbsp;kludge&nbsp;but&nbsp;to&nbsp;cached&nbsp;dir&nbsp;instead&nbsp;of&nbsp;$PWD.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076024"><a href="/os/getwd.go.html#2074937">getwdCache</a></span><span class="op" id="2076034">.</span><span class="ident" id="2076035">Lock</span><span class="op" id="2076039">(</span><span class="op" id="2076040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076043"><a href="/os/getwd.go.html#2075354">dir</a></span>&nbsp;<span class="op" id="2076047">=</span>&nbsp;<span class="ident" id="2076049"><a href="/os/getwd.go.html#2074937">getwdCache</a></span><span class="op" id="2076059">.</span><span class="ident" id="2076060">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076065"><a href="/os/getwd.go.html#2074937">getwdCache</a></span><span class="op" id="2076075">.</span><span class="ident" id="2076076">Unlock</span><span class="op" id="2076082">(</span><span class="op" id="2076083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076086">if</span>&nbsp;<span class="builtinfunc" id="2076089">len</span><span class="op" id="2076092">(</span><span class="ident" id="2076093"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2076096">)</span>&nbsp;<span class="op" id="2076098">&gt;</span>&nbsp;<span class="num" id="2076100">0</span>&nbsp;<span class="op" id="2076102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076106">d</span><span class="op" id="2076107">,</span>&nbsp;<span class="ident" id="2076109">err</span>&nbsp;<span class="op" id="2076113">:=</span>&nbsp;<span class="ident" id="2076116"><a href="/os/file_unix.go.html#2068839">Stat</a></span><span class="op" id="2076120">(</span><span class="ident" id="2076121"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2076124">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076128">if</span>&nbsp;<span class="ident" id="2076131"><a href="/os/getwd.go.html#2076109">err</a></span>&nbsp;<span class="op" id="2076135">==</span>&nbsp;<span class="ident" id="2076138">nil</span>&nbsp;<span class="op" id="2076142">&amp;&amp;</span>&nbsp;<span class="ident" id="2076145"><a href="/os/types.go.html#2089277">SameFile</a></span><span class="op" id="2076153">(</span><span class="ident" id="2076154"><a href="/os/getwd.go.html#2075519">dot</a></span><span class="op" id="2076157">,</span>&nbsp;<span class="ident" id="2076159"><a href="/os/getwd.go.html#2076106">d</a></span><span class="op" id="2076160">)</span>&nbsp;<span class="op" id="2076162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076167">return</span>&nbsp;<span class="ident" id="2076174"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2076177">,</span>&nbsp;<span class="ident" id="2076179">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076192">//&nbsp;Root&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;because&nbsp;it&nbsp;has&nbsp;no&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076244">//&nbsp;and&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076269">root</span><span class="op" id="2076273">,</span>&nbsp;<span class="ident" id="2076275"><a href="/os/getwd.go.html#2075366">err</a></span>&nbsp;<span class="op" id="2076279">:=</span>&nbsp;<span class="ident" id="2076282"><a href="/os/file_unix.go.html#2068839">Stat</a></span><span class="op" id="2076286">(</span><span class="string" id="2076287">&#34;/&#34;</span><span class="op" id="2076290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076293">if</span>&nbsp;<span class="ident" id="2076296"><a href="/os/getwd.go.html#2075366">err</a></span>&nbsp;<span class="op" id="2076300">!=</span>&nbsp;<span class="ident" id="2076303">nil</span>&nbsp;<span class="op" id="2076307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076311">//&nbsp;Can&#39;t&nbsp;stat&nbsp;root&nbsp;-&nbsp;no&nbsp;hope.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076343">return</span>&nbsp;<span class="string" id="2076350">&#34;&#34;</span><span class="op" id="2076352">,</span>&nbsp;<span class="ident" id="2076354"><a href="/os/getwd.go.html#2075366">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076362">if</span>&nbsp;<span class="ident" id="2076365"><a href="/os/types.go.html#2089277">SameFile</a></span><span class="op" id="2076373">(</span><span class="ident" id="2076374"><a href="/os/getwd.go.html#2076269">root</a></span><span class="op" id="2076378">,</span>&nbsp;<span class="ident" id="2076380"><a href="/os/getwd.go.html#2075519">dot</a></span><span class="op" id="2076383">)</span>&nbsp;<span class="op" id="2076385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076389">return</span>&nbsp;<span class="string" id="2076396">&#34;/&#34;</span><span class="op" id="2076399">,</span>&nbsp;<span class="ident" id="2076401">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076406">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076410">//&nbsp;General&nbsp;algorithm:&nbsp;find&nbsp;name&nbsp;in&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076453">//&nbsp;and&nbsp;then&nbsp;find&nbsp;name&nbsp;of&nbsp;parent.&nbsp;&nbsp;Each&nbsp;iteration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076503">//&nbsp;adds&nbsp;/name&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076543"><a href="/os/getwd.go.html#2075354">dir</a></span>&nbsp;<span class="op" id="2076547">=</span>&nbsp;<span class="string" id="2076549">&#34;&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076553">for</span>&nbsp;<span class="ident" id="2076557">parent</span>&nbsp;<span class="op" id="2076564">:=</span>&nbsp;<span class="string" id="2076567">&#34;..&#34;</span><span class="op" id="2076571">;</span>&nbsp;<span class="op" id="2076573">;</span>&nbsp;<span class="ident" id="2076575"><a href="/os/getwd.go.html#2076557">parent</a></span>&nbsp;<span class="op" id="2076582">=</span>&nbsp;<span class="string" id="2076584">&#34;../&#34;</span>&nbsp;<span class="op" id="2076590">+</span>&nbsp;<span class="ident" id="2076592"><a href="/os/getwd.go.html#2076557">parent</a></span>&nbsp;<span class="op" id="2076599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076603">if</span>&nbsp;<span class="builtinfunc" id="2076606">len</span><span class="op" id="2076609">(</span><span class="ident" id="2076610"><a href="/os/getwd.go.html#2076557">parent</a></span><span class="op" id="2076616">)</span>&nbsp;<span class="op" id="2076618">&gt;=</span>&nbsp;<span class="num" id="2076621">1024</span>&nbsp;<span class="op" id="2076626">{</span>&nbsp;<span class="comment" id="2076628">//&nbsp;Sanity&nbsp;check</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076647">return</span>&nbsp;<span class="string" id="2076654">&#34;&#34;</span><span class="op" id="2076656">,</span>&nbsp;<span class="ident" id="2076658"><a href="/os/getwd.go.html#2074920">syscall</a></span><span class="op" id="2076665">.</span><span class="ident" id="2076666">ENAMETOOLONG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076685">fd</span><span class="op" id="2076687">,</span>&nbsp;<span class="ident" id="2076689">err</span>&nbsp;<span class="op" id="2076693">:=</span>&nbsp;<span class="ident" id="2076696"><a href="/os/file.go.html#2060191">Open</a></span><span class="op" id="2076700">(</span><span class="ident" id="2076701"><a href="/os/getwd.go.html#2076557">parent</a></span><span class="op" id="2076707">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076711">if</span>&nbsp;<span class="ident" id="2076714"><a href="/os/getwd.go.html#2076689">err</a></span>&nbsp;<span class="op" id="2076718">!=</span>&nbsp;<span class="ident" id="2076721">nil</span>&nbsp;<span class="op" id="2076725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076730">return</span>&nbsp;<span class="string" id="2076737">&#34;&#34;</span><span class="op" id="2076739">,</span>&nbsp;<span class="ident" id="2076741"><a href="/os/getwd.go.html#2076689">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076752">for</span>&nbsp;<span class="op" id="2076756">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076761">names</span><span class="op" id="2076766">,</span>&nbsp;<span class="ident" id="2076768">err</span>&nbsp;<span class="op" id="2076772">:=</span>&nbsp;<span class="ident" id="2076775"><a href="/os/getwd.go.html#2076685">fd</a></span><span class="op" id="2076777">.</span><span class="ident" id="2076778">Readdirnames</span><span class="op" id="2076790">(</span><span class="num" id="2076791">100</span><span class="op" id="2076794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076799">if</span>&nbsp;<span class="ident" id="2076802"><a href="/os/getwd.go.html#2076768">err</a></span>&nbsp;<span class="op" id="2076806">!=</span>&nbsp;<span class="ident" id="2076809">nil</span>&nbsp;<span class="op" id="2076813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076819"><a href="/os/getwd.go.html#2076685">fd</a></span><span class="op" id="2076821">.</span><span class="ident" id="2076822">Close</span><span class="op" id="2076827">(</span><span class="op" id="2076828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076834">return</span>&nbsp;<span class="string" id="2076841">&#34;&#34;</span><span class="op" id="2076843">,</span>&nbsp;<span class="ident" id="2076845"><a href="/os/getwd.go.html#2076768">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076852">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076857">for</span>&nbsp;<span class="ident" id="2076861">_</span><span class="op" id="2076862">,</span>&nbsp;<span class="ident" id="2076864">name</span>&nbsp;<span class="op" id="2076869">:=</span>&nbsp;<span class="keyword" id="2076872">range</span>&nbsp;<span class="ident" id="2076878"><a href="/os/getwd.go.html#2076761">names</a></span>&nbsp;<span class="op" id="2076884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076890">d</span><span class="op" id="2076891">,</span>&nbsp;<span class="ident" id="2076893">_</span>&nbsp;<span class="op" id="2076895">:=</span>&nbsp;<span class="ident" id="2076898"><a href="/os/file_unix.go.html#2069301">Lstat</a></span><span class="op" id="2076903">(</span><span class="ident" id="2076904"><a href="/os/getwd.go.html#2076557">parent</a></span>&nbsp;<span class="op" id="2076911">+</span>&nbsp;<span class="string" id="2076913">&#34;/&#34;</span>&nbsp;<span class="op" id="2076917">+</span>&nbsp;<span class="ident" id="2076919"><a href="/os/getwd.go.html#2076864">name</a></span><span class="op" id="2076923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076929">if</span>&nbsp;<span class="ident" id="2076932"><a href="/os/types.go.html#2089277">SameFile</a></span><span class="op" id="2076940">(</span><span class="ident" id="2076941"><a href="/os/getwd.go.html#2076890">d</a></span><span class="op" id="2076942">,</span>&nbsp;<span class="ident" id="2076944"><a href="/os/getwd.go.html#2075519">dot</a></span><span class="op" id="2076947">)</span>&nbsp;<span class="op" id="2076949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076956"><a href="/os/getwd.go.html#2075354">dir</a></span>&nbsp;<span class="op" id="2076960">=</span>&nbsp;<span class="string" id="2076962">&#34;/&#34;</span>&nbsp;<span class="op" id="2076966">+</span>&nbsp;<span class="ident" id="2076968"><a href="/os/getwd.go.html#2076864">name</a></span>&nbsp;<span class="op" id="2076973">+</span>&nbsp;<span class="ident" id="2076975"><a href="/os/getwd.go.html#2075354">dir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076984">goto</span>&nbsp;<span class="ident" id="2076989">Found</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077012">Found</span><span class="op" id="2077017">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077021">pd</span><span class="op" id="2077023">,</span>&nbsp;<span class="ident" id="2077025"><a href="/os/getwd.go.html#2076689">err</a></span>&nbsp;<span class="op" id="2077029">:=</span>&nbsp;<span class="ident" id="2077032"><a href="/os/getwd.go.html#2076685">fd</a></span><span class="op" id="2077034">.</span><span class="ident" id="2077035">Stat</span><span class="op" id="2077039">(</span><span class="op" id="2077040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077044">if</span>&nbsp;<span class="ident" id="2077047"><a href="/os/getwd.go.html#2076689">err</a></span>&nbsp;<span class="op" id="2077051">!=</span>&nbsp;<span class="ident" id="2077054">nil</span>&nbsp;<span class="op" id="2077058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077063">return</span>&nbsp;<span class="string" id="2077070">&#34;&#34;</span><span class="op" id="2077072">,</span>&nbsp;<span class="ident" id="2077074"><a href="/os/getwd.go.html#2076689">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077084"><a href="/os/getwd.go.html#2076685">fd</a></span><span class="op" id="2077086">.</span><span class="ident" id="2077087">Close</span><span class="op" id="2077092">(</span><span class="op" id="2077093">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077097">if</span>&nbsp;<span class="ident" id="2077100"><a href="/os/types.go.html#2089277">SameFile</a></span><span class="op" id="2077108">(</span><span class="ident" id="2077109"><a href="/os/getwd.go.html#2077021">pd</a></span><span class="op" id="2077111">,</span>&nbsp;<span class="ident" id="2077113"><a href="/os/getwd.go.html#2076269">root</a></span><span class="op" id="2077117">)</span>&nbsp;<span class="op" id="2077119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077124">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077136">//&nbsp;Set&nbsp;up&nbsp;for&nbsp;next&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077164"><a href="/os/getwd.go.html#2075519">dot</a></span>&nbsp;<span class="op" id="2077168">=</span>&nbsp;<span class="ident" id="2077170"><a href="/os/getwd.go.html#2077021">pd</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077178">//&nbsp;Save&nbsp;answer&nbsp;as&nbsp;hint&nbsp;to&nbsp;avoid&nbsp;the&nbsp;expensive&nbsp;path&nbsp;next&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077241"><a href="/os/getwd.go.html#2074937">getwdCache</a></span><span class="op" id="2077251">.</span><span class="ident" id="2077252">Lock</span><span class="op" id="2077256">(</span><span class="op" id="2077257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077260"><a href="/os/getwd.go.html#2074937">getwdCache</a></span><span class="op" id="2077270">.</span><span class="ident" id="2077271">dir</span>&nbsp;<span class="op" id="2077275">=</span>&nbsp;<span class="ident" id="2077277"><a href="/os/getwd.go.html#2075354">dir</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077282"><a href="/os/getwd.go.html#2074937">getwdCache</a></span><span class="op" id="2077292">.</span><span class="ident" id="2077293">Unlock</span><span class="op" id="2077299">(</span><span class="op" id="2077300">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077304">return</span>&nbsp;<span class="ident" id="2077311"><a href="/os/getwd.go.html#2075354">dir</a></span><span class="op" id="2077314">,</span>&nbsp;<span class="ident" id="2077316">nil</span><br>
<span class="lineno"></span><span class="op" id="2077320">}</span>
</div>
</body>
</html>
