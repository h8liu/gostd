<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7925584">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7925639">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7925693">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7925744">package</span>&nbsp;<span class="ident" id="7925752">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7925757">import</span>&nbsp;<span class="op" id="7925764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7925767">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7925774">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7925780">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7925791">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7925801">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7925804">var</span>&nbsp;<span class="ident" id="7925808">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7925835">=</span>&nbsp;<span class="op" id="7925837">[</span><span class="op" id="7925838">]</span><span class="keyword" id="7925839">struct</span>&nbsp;<span class="op" id="7925846">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925849">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7925855">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925863">gaddr</span>&nbsp;<span class="op" id="7925869">*</span><span class="ident" id="7925870"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span>&nbsp;<span class="comment" id="7925878">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7925894">}</span><span class="op" id="7925895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925898">{</span><span class="string" id="7925899">&#34;udp&#34;</span><span class="op" id="7925904">,</span>&nbsp;<span class="op" id="7925906">&amp;</span><span class="ident" id="7925907"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7925914">{</span><span class="ident" id="7925915">IP</span><span class="op" id="7925917">:</span>&nbsp;<span class="ident" id="7925919"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7925923">(</span><span class="num" id="7925924">224</span><span class="op" id="7925927">,</span>&nbsp;<span class="num" id="7925929">0</span><span class="op" id="7925930">,</span>&nbsp;<span class="num" id="7925932">0</span><span class="op" id="7925933">,</span>&nbsp;<span class="num" id="7925935">254</span><span class="op" id="7925938">)</span><span class="op" id="7925939">,</span>&nbsp;<span class="ident" id="7925941">Port</span><span class="op" id="7925945">:</span>&nbsp;<span class="num" id="7925947">12345</span><span class="op" id="7925952">}</span><span class="op" id="7925953">}</span><span class="op" id="7925954">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925958">{</span><span class="string" id="7925959">&#34;udp4&#34;</span><span class="op" id="7925965">,</span>&nbsp;<span class="op" id="7925967">&amp;</span><span class="ident" id="7925968"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7925975">{</span><span class="ident" id="7925976">IP</span><span class="op" id="7925978">:</span>&nbsp;<span class="ident" id="7925980"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7925984">(</span><span class="num" id="7925985">224</span><span class="op" id="7925988">,</span>&nbsp;<span class="num" id="7925990">0</span><span class="op" id="7925991">,</span>&nbsp;<span class="num" id="7925993">0</span><span class="op" id="7925994">,</span>&nbsp;<span class="num" id="7925996">254</span><span class="op" id="7925999">)</span><span class="op" id="7926000">,</span>&nbsp;<span class="ident" id="7926002">Port</span><span class="op" id="7926006">:</span>&nbsp;<span class="num" id="7926008">12345</span><span class="op" id="7926013">}</span><span class="op" id="7926014">}</span><span class="op" id="7926015">,</span><br>
<span class="lineno"></span><span class="op" id="7926017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7926020">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7926090">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="7926161">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7926170">func</span>&nbsp;<span class="ident" id="7926175">TestIPv4MulticastListener</span><span class="op" id="7926200">(</span><span class="ident" id="7926201">t</span>&nbsp;<span class="op" id="7926203">*</span><span class="ident" id="7926204"><a href="/net/multicast_test.go.html#7925791">testing</a></span><span class="op" id="7926211">.</span><span class="ident" id="7926212">T</span><span class="op" id="7926213">)</span>&nbsp;<span class="op" id="7926215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926218">switch</span>&nbsp;<span class="ident" id="7926225"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7926232">.</span><span class="ident" id="7926233">GOOS</span>&nbsp;<span class="op" id="7926238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926241">case</span>&nbsp;<span class="string" id="7926246">&#34;android&#34;</span><span class="op" id="7926255">,</span>&nbsp;<span class="string" id="7926257">&#34;nacl&#34;</span><span class="op" id="7926263">,</span>&nbsp;<span class="string" id="7926265">&#34;plan9&#34;</span><span class="op" id="7926272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926276"><a href="/net/multicast_test.go.html#7926201">t</a></span><span class="op" id="7926277">.</span><span class="ident" id="7926278">Skipf</span><span class="op" id="7926283">(</span><span class="string" id="7926284">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7926305">,</span>&nbsp;<span class="ident" id="7926307"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7926314">.</span><span class="ident" id="7926315">GOOS</span><span class="op" id="7926319">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926322">case</span>&nbsp;<span class="string" id="7926327">&#34;solaris&#34;</span><span class="op" id="7926336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926340"><a href="/net/multicast_test.go.html#7926201">t</a></span><span class="op" id="7926341">.</span><span class="ident" id="7926342">Skipf</span><span class="op" id="7926347">(</span><span class="string" id="7926348">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7926390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926397">closer</span>&nbsp;<span class="op" id="7926404">:=</span>&nbsp;<span class="keyword" id="7926407">func</span><span class="op" id="7926411">(</span><span class="ident" id="7926412">cs</span>&nbsp;<span class="op" id="7926415">[</span><span class="op" id="7926416">]</span><span class="op" id="7926417">*</span><span class="ident" id="7926418"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="7926425">)</span>&nbsp;<span class="op" id="7926427">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926431">for</span>&nbsp;<span class="ident" id="7926435">_</span><span class="op" id="7926436">,</span>&nbsp;<span class="ident" id="7926438">c</span>&nbsp;<span class="op" id="7926440">:=</span>&nbsp;<span class="keyword" id="7926443">range</span>&nbsp;<span class="ident" id="7926449"><a href="/net/multicast_test.go.html#7926412">cs</a></span>&nbsp;<span class="op" id="7926452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926457">if</span>&nbsp;<span class="ident" id="7926460"><a href="/net/multicast_test.go.html#7926438">c</a></span>&nbsp;<span class="op" id="7926462">!=</span>&nbsp;<span class="ident" id="7926465">nil</span>&nbsp;<span class="op" id="7926469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926475"><a href="/net/multicast_test.go.html#7926438">c</a></span><span class="op" id="7926476">.</span><span class="ident" id="7926477">Close</span><span class="op" id="7926482">(</span><span class="op" id="7926483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926492">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926499">for</span>&nbsp;<span class="ident" id="7926503">_</span><span class="op" id="7926504">,</span>&nbsp;<span class="ident" id="7926506">ifi</span>&nbsp;<span class="op" id="7926510">:=</span>&nbsp;<span class="keyword" id="7926513">range</span>&nbsp;<span class="op" id="7926519">[</span><span class="op" id="7926520">]</span><span class="op" id="7926521">*</span><span class="ident" id="7926522"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="7926531">{</span><span class="ident" id="7926532"><a href="/net/interface_test.go.html#7876504">loopbackInterface</a></span><span class="op" id="7926549">(</span><span class="op" id="7926550">)</span><span class="op" id="7926551">,</span>&nbsp;<span class="ident" id="7926553">nil</span><span class="op" id="7926556">}</span>&nbsp;<span class="op" id="7926558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7926562">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7926618">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7926671">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7926721">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7926773">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926791">if</span>&nbsp;<span class="ident" id="7926794"><a href="/net/multicast_test.go.html#7926506">ifi</a></span>&nbsp;<span class="op" id="7926798">==</span>&nbsp;<span class="ident" id="7926801">nil</span>&nbsp;<span class="op" id="7926805">&amp;&amp;</span>&nbsp;<span class="op" id="7926808">!</span><span class="op" id="7926809">*</span><span class="ident" id="7926810"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="7926823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926828">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926843">for</span>&nbsp;<span class="ident" id="7926847">_</span><span class="op" id="7926848">,</span>&nbsp;<span class="ident" id="7926850">tt</span>&nbsp;<span class="op" id="7926853">:=</span>&nbsp;<span class="keyword" id="7926856">range</span>&nbsp;<span class="ident" id="7926862"><a href="/net/multicast_test.go.html#7925808">ipv4MulticastListenerTests</a></span>&nbsp;<span class="op" id="7926889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926894">var</span>&nbsp;<span class="ident" id="7926898">err</span>&nbsp;<span class="builtintype" id="7926902">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926911">cs</span>&nbsp;<span class="op" id="7926914">:=</span>&nbsp;<span class="builtinfunc" id="7926917">make</span><span class="op" id="7926921">(</span><span class="op" id="7926922">[</span><span class="op" id="7926923">]</span><span class="op" id="7926924">*</span><span class="ident" id="7926925"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="7926932">,</span>&nbsp;<span class="num" id="7926934">2</span><span class="op" id="7926935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926940">if</span>&nbsp;<span class="ident" id="7926943"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7926945">[</span><span class="num" id="7926946">0</span><span class="op" id="7926947">]</span><span class="op" id="7926948">,</span>&nbsp;<span class="ident" id="7926950"><a href="/net/multicast_test.go.html#7926898">err</a></span>&nbsp;<span class="op" id="7926954">=</span>&nbsp;<span class="ident" id="7926956"><a href="/net/udpsock_posix.go.html#1524542">ListenMulticastUDP</a></span><span class="op" id="7926974">(</span><span class="ident" id="7926975"><a href="/net/multicast_test.go.html#7926850">tt</a></span><span class="op" id="7926977">.</span><span class="ident" id="7926978">net</span><span class="op" id="7926981">,</span>&nbsp;<span class="ident" id="7926983"><a href="/net/multicast_test.go.html#7926506">ifi</a></span><span class="op" id="7926986">,</span>&nbsp;<span class="ident" id="7926988"><a href="/net/multicast_test.go.html#7926850">tt</a></span><span class="op" id="7926990">.</span><span class="ident" id="7926991">gaddr</span><span class="op" id="7926996">)</span><span class="op" id="7926997">;</span>&nbsp;<span class="ident" id="7926999"><a href="/net/multicast_test.go.html#7926898">err</a></span>&nbsp;<span class="op" id="7927003">!=</span>&nbsp;<span class="ident" id="7927006">nil</span>&nbsp;<span class="op" id="7927010">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927016"><a href="/net/multicast_test.go.html#7926201">t</a></span><span class="op" id="7927017">.</span><span class="ident" id="7927018">Fatalf</span><span class="op" id="7927024">(</span><span class="string" id="7927025">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7927068">,</span>&nbsp;<span class="ident" id="7927070"><a href="/net/multicast_test.go.html#7926506">ifi</a></span><span class="op" id="7927073">,</span>&nbsp;<span class="ident" id="7927075"><a href="/net/multicast_test.go.html#7926898">err</a></span><span class="op" id="7927078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927088">if</span>&nbsp;<span class="ident" id="7927091">err</span>&nbsp;<span class="op" id="7927095">:=</span>&nbsp;<span class="ident" id="7927098"><a href="/net/multicast_test.go.html#7929890">checkMulticastListener</a></span><span class="op" id="7927120">(</span><span class="ident" id="7927121"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927123">[</span><span class="num" id="7927124">0</span><span class="op" id="7927125">]</span><span class="op" id="7927126">,</span>&nbsp;<span class="ident" id="7927128"><a href="/net/multicast_test.go.html#7926850">tt</a></span><span class="op" id="7927130">.</span><span class="ident" id="7927131">gaddr</span><span class="op" id="7927136">.</span><span class="ident" id="7927137">IP</span><span class="op" id="7927139">)</span><span class="op" id="7927140">;</span>&nbsp;<span class="ident" id="7927142"><a href="/net/multicast_test.go.html#7927091">err</a></span>&nbsp;<span class="op" id="7927146">!=</span>&nbsp;<span class="ident" id="7927149">nil</span>&nbsp;<span class="op" id="7927153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927159"><a href="/net/multicast_test.go.html#7926397">closer</a></span><span class="op" id="7927165">(</span><span class="ident" id="7927166"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927174"><a href="/net/multicast_test.go.html#7926201">t</a></span><span class="op" id="7927175">.</span><span class="ident" id="7927176">Fatal</span><span class="op" id="7927181">(</span><span class="ident" id="7927182"><a href="/net/multicast_test.go.html#7927091">err</a></span><span class="op" id="7927185">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927195">if</span>&nbsp;<span class="ident" id="7927198"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927200">[</span><span class="num" id="7927201">1</span><span class="op" id="7927202">]</span><span class="op" id="7927203">,</span>&nbsp;<span class="ident" id="7927205"><a href="/net/multicast_test.go.html#7926898">err</a></span>&nbsp;<span class="op" id="7927209">=</span>&nbsp;<span class="ident" id="7927211"><a href="/net/udpsock_posix.go.html#1524542">ListenMulticastUDP</a></span><span class="op" id="7927229">(</span><span class="ident" id="7927230"><a href="/net/multicast_test.go.html#7926850">tt</a></span><span class="op" id="7927232">.</span><span class="ident" id="7927233">net</span><span class="op" id="7927236">,</span>&nbsp;<span class="ident" id="7927238"><a href="/net/multicast_test.go.html#7926506">ifi</a></span><span class="op" id="7927241">,</span>&nbsp;<span class="ident" id="7927243"><a href="/net/multicast_test.go.html#7926850">tt</a></span><span class="op" id="7927245">.</span><span class="ident" id="7927246">gaddr</span><span class="op" id="7927251">)</span><span class="op" id="7927252">;</span>&nbsp;<span class="ident" id="7927254"><a href="/net/multicast_test.go.html#7926898">err</a></span>&nbsp;<span class="op" id="7927258">!=</span>&nbsp;<span class="ident" id="7927261">nil</span>&nbsp;<span class="op" id="7927265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927271"><a href="/net/multicast_test.go.html#7926397">closer</a></span><span class="op" id="7927277">(</span><span class="ident" id="7927278"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927286"><a href="/net/multicast_test.go.html#7926201">t</a></span><span class="op" id="7927287">.</span><span class="ident" id="7927288">Fatalf</span><span class="op" id="7927294">(</span><span class="string" id="7927295">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7927339">,</span>&nbsp;<span class="ident" id="7927341"><a href="/net/multicast_test.go.html#7926506">ifi</a></span><span class="op" id="7927344">,</span>&nbsp;<span class="ident" id="7927346"><a href="/net/multicast_test.go.html#7926898">err</a></span><span class="op" id="7927349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927354">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927359">if</span>&nbsp;<span class="ident" id="7927362">err</span>&nbsp;<span class="op" id="7927366">:=</span>&nbsp;<span class="ident" id="7927369"><a href="/net/multicast_test.go.html#7929890">checkMulticastListener</a></span><span class="op" id="7927391">(</span><span class="ident" id="7927392"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927394">[</span><span class="num" id="7927395">1</span><span class="op" id="7927396">]</span><span class="op" id="7927397">,</span>&nbsp;<span class="ident" id="7927399"><a href="/net/multicast_test.go.html#7926850">tt</a></span><span class="op" id="7927401">.</span><span class="ident" id="7927402">gaddr</span><span class="op" id="7927407">.</span><span class="ident" id="7927408">IP</span><span class="op" id="7927410">)</span><span class="op" id="7927411">;</span>&nbsp;<span class="ident" id="7927413"><a href="/net/multicast_test.go.html#7927362">err</a></span>&nbsp;<span class="op" id="7927417">!=</span>&nbsp;<span class="ident" id="7927420">nil</span>&nbsp;<span class="op" id="7927424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927430"><a href="/net/multicast_test.go.html#7926397">closer</a></span><span class="op" id="7927436">(</span><span class="ident" id="7927437"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927445"><a href="/net/multicast_test.go.html#7926201">t</a></span><span class="op" id="7927446">.</span><span class="ident" id="7927447">Fatal</span><span class="op" id="7927452">(</span><span class="ident" id="7927453"><a href="/net/multicast_test.go.html#7927362">err</a></span><span class="op" id="7927456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927466"><a href="/net/multicast_test.go.html#7926397">closer</a></span><span class="op" id="7927472">(</span><span class="ident" id="7927473"><a href="/net/multicast_test.go.html#7926911">cs</a></span><span class="op" id="7927475">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927482">}</span><br>
<span class="lineno"></span><span class="op" id="7927484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7927487">var</span>&nbsp;<span class="ident" id="7927491">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7927518">=</span>&nbsp;<span class="op" id="7927520">[</span><span class="op" id="7927521">]</span><span class="keyword" id="7927522">struct</span>&nbsp;<span class="op" id="7927529">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927532">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7927538">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927546">gaddr</span>&nbsp;<span class="op" id="7927552">*</span><span class="ident" id="7927553"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span>&nbsp;<span class="comment" id="7927561">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7927577">}</span><span class="op" id="7927578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927581">{</span><span class="string" id="7927582">&#34;udp&#34;</span><span class="op" id="7927587">,</span>&nbsp;<span class="op" id="7927589">&amp;</span><span class="ident" id="7927590"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927597">{</span><span class="ident" id="7927598">IP</span><span class="op" id="7927600">:</span>&nbsp;<span class="ident" id="7927602"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927609">(</span><span class="string" id="7927610">&#34;ff01::114&#34;</span><span class="op" id="7927621">)</span><span class="op" id="7927622">,</span>&nbsp;<span class="ident" id="7927624">Port</span><span class="op" id="7927628">:</span>&nbsp;<span class="num" id="7927630">12345</span><span class="op" id="7927635">}</span><span class="op" id="7927636">}</span><span class="op" id="7927637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927640">{</span><span class="string" id="7927641">&#34;udp&#34;</span><span class="op" id="7927646">,</span>&nbsp;<span class="op" id="7927648">&amp;</span><span class="ident" id="7927649"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927656">{</span><span class="ident" id="7927657">IP</span><span class="op" id="7927659">:</span>&nbsp;<span class="ident" id="7927661"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927668">(</span><span class="string" id="7927669">&#34;ff02::114&#34;</span><span class="op" id="7927680">)</span><span class="op" id="7927681">,</span>&nbsp;<span class="ident" id="7927683">Port</span><span class="op" id="7927687">:</span>&nbsp;<span class="num" id="7927689">12345</span><span class="op" id="7927694">}</span><span class="op" id="7927695">}</span><span class="op" id="7927696">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927699">{</span><span class="string" id="7927700">&#34;udp&#34;</span><span class="op" id="7927705">,</span>&nbsp;<span class="op" id="7927707">&amp;</span><span class="ident" id="7927708"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927715">{</span><span class="ident" id="7927716">IP</span><span class="op" id="7927718">:</span>&nbsp;<span class="ident" id="7927720"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927727">(</span><span class="string" id="7927728">&#34;ff04::114&#34;</span><span class="op" id="7927739">)</span><span class="op" id="7927740">,</span>&nbsp;<span class="ident" id="7927742">Port</span><span class="op" id="7927746">:</span>&nbsp;<span class="num" id="7927748">12345</span><span class="op" id="7927753">}</span><span class="op" id="7927754">}</span><span class="op" id="7927755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927758">{</span><span class="string" id="7927759">&#34;udp&#34;</span><span class="op" id="7927764">,</span>&nbsp;<span class="op" id="7927766">&amp;</span><span class="ident" id="7927767"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927774">{</span><span class="ident" id="7927775">IP</span><span class="op" id="7927777">:</span>&nbsp;<span class="ident" id="7927779"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927786">(</span><span class="string" id="7927787">&#34;ff05::114&#34;</span><span class="op" id="7927798">)</span><span class="op" id="7927799">,</span>&nbsp;<span class="ident" id="7927801">Port</span><span class="op" id="7927805">:</span>&nbsp;<span class="num" id="7927807">12345</span><span class="op" id="7927812">}</span><span class="op" id="7927813">}</span><span class="op" id="7927814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927817">{</span><span class="string" id="7927818">&#34;udp&#34;</span><span class="op" id="7927823">,</span>&nbsp;<span class="op" id="7927825">&amp;</span><span class="ident" id="7927826"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927833">{</span><span class="ident" id="7927834">IP</span><span class="op" id="7927836">:</span>&nbsp;<span class="ident" id="7927838"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927845">(</span><span class="string" id="7927846">&#34;ff08::114&#34;</span><span class="op" id="7927857">)</span><span class="op" id="7927858">,</span>&nbsp;<span class="ident" id="7927860">Port</span><span class="op" id="7927864">:</span>&nbsp;<span class="num" id="7927866">12345</span><span class="op" id="7927871">}</span><span class="op" id="7927872">}</span><span class="op" id="7927873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927876">{</span><span class="string" id="7927877">&#34;udp&#34;</span><span class="op" id="7927882">,</span>&nbsp;<span class="op" id="7927884">&amp;</span><span class="ident" id="7927885"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927892">{</span><span class="ident" id="7927893">IP</span><span class="op" id="7927895">:</span>&nbsp;<span class="ident" id="7927897"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927904">(</span><span class="string" id="7927905">&#34;ff0e::114&#34;</span><span class="op" id="7927916">)</span><span class="op" id="7927917">,</span>&nbsp;<span class="ident" id="7927919">Port</span><span class="op" id="7927923">:</span>&nbsp;<span class="num" id="7927925">12345</span><span class="op" id="7927930">}</span><span class="op" id="7927931">}</span><span class="op" id="7927932">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927936">{</span><span class="string" id="7927937">&#34;udp6&#34;</span><span class="op" id="7927943">,</span>&nbsp;<span class="op" id="7927945">&amp;</span><span class="ident" id="7927946"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7927953">{</span><span class="ident" id="7927954">IP</span><span class="op" id="7927956">:</span>&nbsp;<span class="ident" id="7927958"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7927965">(</span><span class="string" id="7927966">&#34;ff01::114&#34;</span><span class="op" id="7927977">)</span><span class="op" id="7927978">,</span>&nbsp;<span class="ident" id="7927980">Port</span><span class="op" id="7927984">:</span>&nbsp;<span class="num" id="7927986">12345</span><span class="op" id="7927991">}</span><span class="op" id="7927992">}</span><span class="op" id="7927993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927996">{</span><span class="string" id="7927997">&#34;udp6&#34;</span><span class="op" id="7928003">,</span>&nbsp;<span class="op" id="7928005">&amp;</span><span class="ident" id="7928006"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7928013">{</span><span class="ident" id="7928014">IP</span><span class="op" id="7928016">:</span>&nbsp;<span class="ident" id="7928018"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7928025">(</span><span class="string" id="7928026">&#34;ff02::114&#34;</span><span class="op" id="7928037">)</span><span class="op" id="7928038">,</span>&nbsp;<span class="ident" id="7928040">Port</span><span class="op" id="7928044">:</span>&nbsp;<span class="num" id="7928046">12345</span><span class="op" id="7928051">}</span><span class="op" id="7928052">}</span><span class="op" id="7928053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928056">{</span><span class="string" id="7928057">&#34;udp6&#34;</span><span class="op" id="7928063">,</span>&nbsp;<span class="op" id="7928065">&amp;</span><span class="ident" id="7928066"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7928073">{</span><span class="ident" id="7928074">IP</span><span class="op" id="7928076">:</span>&nbsp;<span class="ident" id="7928078"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7928085">(</span><span class="string" id="7928086">&#34;ff04::114&#34;</span><span class="op" id="7928097">)</span><span class="op" id="7928098">,</span>&nbsp;<span class="ident" id="7928100">Port</span><span class="op" id="7928104">:</span>&nbsp;<span class="num" id="7928106">12345</span><span class="op" id="7928111">}</span><span class="op" id="7928112">}</span><span class="op" id="7928113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928116">{</span><span class="string" id="7928117">&#34;udp6&#34;</span><span class="op" id="7928123">,</span>&nbsp;<span class="op" id="7928125">&amp;</span><span class="ident" id="7928126"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7928133">{</span><span class="ident" id="7928134">IP</span><span class="op" id="7928136">:</span>&nbsp;<span class="ident" id="7928138"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7928145">(</span><span class="string" id="7928146">&#34;ff05::114&#34;</span><span class="op" id="7928157">)</span><span class="op" id="7928158">,</span>&nbsp;<span class="ident" id="7928160">Port</span><span class="op" id="7928164">:</span>&nbsp;<span class="num" id="7928166">12345</span><span class="op" id="7928171">}</span><span class="op" id="7928172">}</span><span class="op" id="7928173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928176">{</span><span class="string" id="7928177">&#34;udp6&#34;</span><span class="op" id="7928183">,</span>&nbsp;<span class="op" id="7928185">&amp;</span><span class="ident" id="7928186"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7928193">{</span><span class="ident" id="7928194">IP</span><span class="op" id="7928196">:</span>&nbsp;<span class="ident" id="7928198"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7928205">(</span><span class="string" id="7928206">&#34;ff08::114&#34;</span><span class="op" id="7928217">)</span><span class="op" id="7928218">,</span>&nbsp;<span class="ident" id="7928220">Port</span><span class="op" id="7928224">:</span>&nbsp;<span class="num" id="7928226">12345</span><span class="op" id="7928231">}</span><span class="op" id="7928232">}</span><span class="op" id="7928233">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928236">{</span><span class="string" id="7928237">&#34;udp6&#34;</span><span class="op" id="7928243">,</span>&nbsp;<span class="op" id="7928245">&amp;</span><span class="ident" id="7928246"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7928253">{</span><span class="ident" id="7928254">IP</span><span class="op" id="7928256">:</span>&nbsp;<span class="ident" id="7928258"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7928265">(</span><span class="string" id="7928266">&#34;ff0e::114&#34;</span><span class="op" id="7928277">)</span><span class="op" id="7928278">,</span>&nbsp;<span class="ident" id="7928280">Port</span><span class="op" id="7928284">:</span>&nbsp;<span class="num" id="7928286">12345</span><span class="op" id="7928291">}</span><span class="op" id="7928292">}</span><span class="op" id="7928293">,</span><br>
<span class="lineno"></span><span class="op" id="7928295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7928298">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7928368">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="7928439">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7928448">func</span>&nbsp;<span class="ident" id="7928453">TestIPv6MulticastListener</span><span class="op" id="7928478">(</span><span class="ident" id="7928479">t</span>&nbsp;<span class="op" id="7928481">*</span><span class="ident" id="7928482"><a href="/net/multicast_test.go.html#7925791">testing</a></span><span class="op" id="7928489">.</span><span class="ident" id="7928490">T</span><span class="op" id="7928491">)</span>&nbsp;<span class="op" id="7928493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928496">switch</span>&nbsp;<span class="ident" id="7928503"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7928510">.</span><span class="ident" id="7928511">GOOS</span>&nbsp;<span class="op" id="7928516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928519">case</span>&nbsp;<span class="string" id="7928524">&#34;plan9&#34;</span><span class="op" id="7928531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928535"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7928536">.</span><span class="ident" id="7928537">Skipf</span><span class="op" id="7928542">(</span><span class="string" id="7928543">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7928564">,</span>&nbsp;<span class="ident" id="7928566"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7928573">.</span><span class="ident" id="7928574">GOOS</span><span class="op" id="7928578">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928581">case</span>&nbsp;<span class="string" id="7928586">&#34;solaris&#34;</span><span class="op" id="7928595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928599"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7928600">.</span><span class="ident" id="7928601">Skipf</span><span class="op" id="7928606">(</span><span class="string" id="7928607">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7928649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928655">if</span>&nbsp;<span class="op" id="7928658">!</span><span class="ident" id="7928659"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7928672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928676"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7928677">.</span><span class="ident" id="7928678">Skip</span><span class="op" id="7928682">(</span><span class="string" id="7928683">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7928706">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928712">if</span>&nbsp;<span class="ident" id="7928715"><a href="/net/multicast_test.go.html#7925774">os</a></span><span class="op" id="7928717">.</span><span class="ident" id="7928718">Getuid</span><span class="op" id="7928724">(</span><span class="op" id="7928725">)</span>&nbsp;<span class="op" id="7928727">!=</span>&nbsp;<span class="num" id="7928730">0</span>&nbsp;<span class="op" id="7928732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928736"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7928737">.</span><span class="ident" id="7928738">Skip</span><span class="op" id="7928742">(</span><span class="string" id="7928743">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="7928772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928779">closer</span>&nbsp;<span class="op" id="7928786">:=</span>&nbsp;<span class="keyword" id="7928789">func</span><span class="op" id="7928793">(</span><span class="ident" id="7928794">cs</span>&nbsp;<span class="op" id="7928797">[</span><span class="op" id="7928798">]</span><span class="op" id="7928799">*</span><span class="ident" id="7928800"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="7928807">)</span>&nbsp;<span class="op" id="7928809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928813">for</span>&nbsp;<span class="ident" id="7928817">_</span><span class="op" id="7928818">,</span>&nbsp;<span class="ident" id="7928820">c</span>&nbsp;<span class="op" id="7928822">:=</span>&nbsp;<span class="keyword" id="7928825">range</span>&nbsp;<span class="ident" id="7928831"><a href="/net/multicast_test.go.html#7928794">cs</a></span>&nbsp;<span class="op" id="7928834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928839">if</span>&nbsp;<span class="ident" id="7928842"><a href="/net/multicast_test.go.html#7928820">c</a></span>&nbsp;<span class="op" id="7928844">!=</span>&nbsp;<span class="ident" id="7928847">nil</span>&nbsp;<span class="op" id="7928851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928857"><a href="/net/multicast_test.go.html#7928820">c</a></span><span class="op" id="7928858">.</span><span class="ident" id="7928859">Close</span><span class="op" id="7928864">(</span><span class="op" id="7928865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928870">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928881">for</span>&nbsp;<span class="ident" id="7928885">_</span><span class="op" id="7928886">,</span>&nbsp;<span class="ident" id="7928888">ifi</span>&nbsp;<span class="op" id="7928892">:=</span>&nbsp;<span class="keyword" id="7928895">range</span>&nbsp;<span class="op" id="7928901">[</span><span class="op" id="7928902">]</span><span class="op" id="7928903">*</span><span class="ident" id="7928904"><a href="/net/interface.go.html#1406383">Interface</a></span><span class="op" id="7928913">{</span><span class="ident" id="7928914"><a href="/net/interface_test.go.html#7876504">loopbackInterface</a></span><span class="op" id="7928931">(</span><span class="op" id="7928932">)</span><span class="op" id="7928933">,</span>&nbsp;<span class="ident" id="7928935">nil</span><span class="op" id="7928938">}</span>&nbsp;<span class="op" id="7928940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7928944">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7929000">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7929053">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7929103">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7929155">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929173">if</span>&nbsp;<span class="ident" id="7929176"><a href="/net/multicast_test.go.html#7928888">ifi</a></span>&nbsp;<span class="op" id="7929180">==</span>&nbsp;<span class="ident" id="7929183">nil</span>&nbsp;<span class="op" id="7929187">&amp;&amp;</span>&nbsp;<span class="op" id="7929190">(</span><span class="op" id="7929191">!</span><span class="op" id="7929192">*</span><span class="ident" id="7929193"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="7929206">||</span>&nbsp;<span class="op" id="7929209">!</span><span class="op" id="7929210">*</span><span class="ident" id="7929211"><a href="/net/dialgoogle_test.go.html#7841218">testIPv6</a></span><span class="op" id="7929219">)</span>&nbsp;<span class="op" id="7929221">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929226">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929241">for</span>&nbsp;<span class="ident" id="7929245">_</span><span class="op" id="7929246">,</span>&nbsp;<span class="ident" id="7929248">tt</span>&nbsp;<span class="op" id="7929251">:=</span>&nbsp;<span class="keyword" id="7929254">range</span>&nbsp;<span class="ident" id="7929260"><a href="/net/multicast_test.go.html#7927491">ipv6MulticastListenerTests</a></span>&nbsp;<span class="op" id="7929287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929292">var</span>&nbsp;<span class="ident" id="7929296">err</span>&nbsp;<span class="builtintype" id="7929300">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929309">cs</span>&nbsp;<span class="op" id="7929312">:=</span>&nbsp;<span class="builtinfunc" id="7929315">make</span><span class="op" id="7929319">(</span><span class="op" id="7929320">[</span><span class="op" id="7929321">]</span><span class="op" id="7929322">*</span><span class="ident" id="7929323"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="7929330">,</span>&nbsp;<span class="num" id="7929332">2</span><span class="op" id="7929333">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929338">if</span>&nbsp;<span class="ident" id="7929341"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929343">[</span><span class="num" id="7929344">0</span><span class="op" id="7929345">]</span><span class="op" id="7929346">,</span>&nbsp;<span class="ident" id="7929348"><a href="/net/multicast_test.go.html#7929296">err</a></span>&nbsp;<span class="op" id="7929352">=</span>&nbsp;<span class="ident" id="7929354"><a href="/net/udpsock_posix.go.html#1524542">ListenMulticastUDP</a></span><span class="op" id="7929372">(</span><span class="ident" id="7929373"><a href="/net/multicast_test.go.html#7929248">tt</a></span><span class="op" id="7929375">.</span><span class="ident" id="7929376">net</span><span class="op" id="7929379">,</span>&nbsp;<span class="ident" id="7929381"><a href="/net/multicast_test.go.html#7928888">ifi</a></span><span class="op" id="7929384">,</span>&nbsp;<span class="ident" id="7929386"><a href="/net/multicast_test.go.html#7929248">tt</a></span><span class="op" id="7929388">.</span><span class="ident" id="7929389">gaddr</span><span class="op" id="7929394">)</span><span class="op" id="7929395">;</span>&nbsp;<span class="ident" id="7929397"><a href="/net/multicast_test.go.html#7929296">err</a></span>&nbsp;<span class="op" id="7929401">!=</span>&nbsp;<span class="ident" id="7929404">nil</span>&nbsp;<span class="op" id="7929408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929414"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7929415">.</span><span class="ident" id="7929416">Fatalf</span><span class="op" id="7929422">(</span><span class="string" id="7929423">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7929466">,</span>&nbsp;<span class="ident" id="7929468"><a href="/net/multicast_test.go.html#7928888">ifi</a></span><span class="op" id="7929471">,</span>&nbsp;<span class="ident" id="7929473"><a href="/net/multicast_test.go.html#7929296">err</a></span><span class="op" id="7929476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929486">if</span>&nbsp;<span class="ident" id="7929489">err</span>&nbsp;<span class="op" id="7929493">:=</span>&nbsp;<span class="ident" id="7929496"><a href="/net/multicast_test.go.html#7929890">checkMulticastListener</a></span><span class="op" id="7929518">(</span><span class="ident" id="7929519"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929521">[</span><span class="num" id="7929522">0</span><span class="op" id="7929523">]</span><span class="op" id="7929524">,</span>&nbsp;<span class="ident" id="7929526"><a href="/net/multicast_test.go.html#7929248">tt</a></span><span class="op" id="7929528">.</span><span class="ident" id="7929529">gaddr</span><span class="op" id="7929534">.</span><span class="ident" id="7929535">IP</span><span class="op" id="7929537">)</span><span class="op" id="7929538">;</span>&nbsp;<span class="ident" id="7929540"><a href="/net/multicast_test.go.html#7929489">err</a></span>&nbsp;<span class="op" id="7929544">!=</span>&nbsp;<span class="ident" id="7929547">nil</span>&nbsp;<span class="op" id="7929551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929557"><a href="/net/multicast_test.go.html#7928779">closer</a></span><span class="op" id="7929563">(</span><span class="ident" id="7929564"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929566">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929572"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7929573">.</span><span class="ident" id="7929574">Fatal</span><span class="op" id="7929579">(</span><span class="ident" id="7929580"><a href="/net/multicast_test.go.html#7929489">err</a></span><span class="op" id="7929583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929593">if</span>&nbsp;<span class="ident" id="7929596"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929598">[</span><span class="num" id="7929599">1</span><span class="op" id="7929600">]</span><span class="op" id="7929601">,</span>&nbsp;<span class="ident" id="7929603"><a href="/net/multicast_test.go.html#7929296">err</a></span>&nbsp;<span class="op" id="7929607">=</span>&nbsp;<span class="ident" id="7929609"><a href="/net/udpsock_posix.go.html#1524542">ListenMulticastUDP</a></span><span class="op" id="7929627">(</span><span class="ident" id="7929628"><a href="/net/multicast_test.go.html#7929248">tt</a></span><span class="op" id="7929630">.</span><span class="ident" id="7929631">net</span><span class="op" id="7929634">,</span>&nbsp;<span class="ident" id="7929636"><a href="/net/multicast_test.go.html#7928888">ifi</a></span><span class="op" id="7929639">,</span>&nbsp;<span class="ident" id="7929641"><a href="/net/multicast_test.go.html#7929248">tt</a></span><span class="op" id="7929643">.</span><span class="ident" id="7929644">gaddr</span><span class="op" id="7929649">)</span><span class="op" id="7929650">;</span>&nbsp;<span class="ident" id="7929652"><a href="/net/multicast_test.go.html#7929296">err</a></span>&nbsp;<span class="op" id="7929656">!=</span>&nbsp;<span class="ident" id="7929659">nil</span>&nbsp;<span class="op" id="7929663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929669"><a href="/net/multicast_test.go.html#7928779">closer</a></span><span class="op" id="7929675">(</span><span class="ident" id="7929676"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929684"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7929685">.</span><span class="ident" id="7929686">Fatalf</span><span class="op" id="7929692">(</span><span class="string" id="7929693">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7929737">,</span>&nbsp;<span class="ident" id="7929739"><a href="/net/multicast_test.go.html#7928888">ifi</a></span><span class="op" id="7929742">,</span>&nbsp;<span class="ident" id="7929744"><a href="/net/multicast_test.go.html#7929296">err</a></span><span class="op" id="7929747">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929757">if</span>&nbsp;<span class="ident" id="7929760">err</span>&nbsp;<span class="op" id="7929764">:=</span>&nbsp;<span class="ident" id="7929767"><a href="/net/multicast_test.go.html#7929890">checkMulticastListener</a></span><span class="op" id="7929789">(</span><span class="ident" id="7929790"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929792">[</span><span class="num" id="7929793">1</span><span class="op" id="7929794">]</span><span class="op" id="7929795">,</span>&nbsp;<span class="ident" id="7929797"><a href="/net/multicast_test.go.html#7929248">tt</a></span><span class="op" id="7929799">.</span><span class="ident" id="7929800">gaddr</span><span class="op" id="7929805">.</span><span class="ident" id="7929806">IP</span><span class="op" id="7929808">)</span><span class="op" id="7929809">;</span>&nbsp;<span class="ident" id="7929811"><a href="/net/multicast_test.go.html#7929760">err</a></span>&nbsp;<span class="op" id="7929815">!=</span>&nbsp;<span class="ident" id="7929818">nil</span>&nbsp;<span class="op" id="7929822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929828"><a href="/net/multicast_test.go.html#7928779">closer</a></span><span class="op" id="7929834">(</span><span class="ident" id="7929835"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929843"><a href="/net/multicast_test.go.html#7928479">t</a></span><span class="op" id="7929844">.</span><span class="ident" id="7929845">Fatal</span><span class="op" id="7929850">(</span><span class="ident" id="7929851"><a href="/net/multicast_test.go.html#7929760">err</a></span><span class="op" id="7929854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929859">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929864"><a href="/net/multicast_test.go.html#7928779">closer</a></span><span class="op" id="7929870">(</span><span class="ident" id="7929871"><a href="/net/multicast_test.go.html#7929309">cs</a></span><span class="op" id="7929873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929880">}</span><br>
<span class="lineno"></span><span class="op" id="7929882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7929885">func</span>&nbsp;<span class="ident" id="7929890">checkMulticastListener</span><span class="op" id="7929912">(</span><span class="ident" id="7929913">c</span>&nbsp;<span class="op" id="7929915">*</span><span class="ident" id="7929916"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="7929923">,</span>&nbsp;<span class="ident" id="7929925">ip</span>&nbsp;<span class="ident" id="7929928"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="7929930">)</span>&nbsp;<span class="builtintype" id="7929932">error</span>&nbsp;<span class="op" id="7929938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929941">if</span>&nbsp;<span class="ident" id="7929944">ok</span><span class="op" id="7929946">,</span>&nbsp;<span class="ident" id="7929948">err</span>&nbsp;<span class="op" id="7929952">:=</span>&nbsp;<span class="ident" id="7929955"><a href="/net/multicast_test.go.html#7930275">multicastRIBContains</a></span><span class="op" id="7929975">(</span><span class="ident" id="7929976"><a href="/net/multicast_test.go.html#7929925">ip</a></span><span class="op" id="7929978">)</span><span class="op" id="7929979">;</span>&nbsp;<span class="ident" id="7929981"><a href="/net/multicast_test.go.html#7929948">err</a></span>&nbsp;<span class="op" id="7929985">!=</span>&nbsp;<span class="ident" id="7929988">nil</span>&nbsp;<span class="op" id="7929992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929996">return</span>&nbsp;<span class="ident" id="7930003"><a href="/net/multicast_test.go.html#7929948">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930008">}</span>&nbsp;<span class="keyword" id="7930010">else</span>&nbsp;<span class="keyword" id="7930015">if</span>&nbsp;<span class="op" id="7930018">!</span><span class="ident" id="7930019"><a href="/net/multicast_test.go.html#7929944">ok</a></span>&nbsp;<span class="op" id="7930022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930026">return</span>&nbsp;<span class="ident" id="7930033"><a href="/net/multicast_test.go.html#7925767">fmt</a></span><span class="op" id="7930036">.</span><span class="ident" id="7930037">Errorf</span><span class="op" id="7930043">(</span><span class="string" id="7930044">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="7930075">,</span>&nbsp;<span class="ident" id="7930077"><a href="/net/multicast_test.go.html#7929925">ip</a></span><span class="op" id="7930079">.</span><span class="ident" id="7930080">String</span><span class="op" id="7930086">(</span><span class="op" id="7930087">)</span><span class="op" id="7930088">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930094">la</span>&nbsp;<span class="op" id="7930097">:=</span>&nbsp;<span class="ident" id="7930100"><a href="/net/multicast_test.go.html#7929913">c</a></span><span class="op" id="7930101">.</span><span class="ident" id="7930102">LocalAddr</span><span class="op" id="7930111">(</span><span class="op" id="7930112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930115">if</span>&nbsp;<span class="ident" id="7930118">la</span><span class="op" id="7930120">,</span>&nbsp;<span class="ident" id="7930122">ok</span>&nbsp;<span class="op" id="7930125">:=</span>&nbsp;<span class="ident" id="7930128"><a href="/net/multicast_test.go.html#7930094">la</a></span><span class="op" id="7930130">.</span><span class="op" id="7930131">(</span><span class="op" id="7930132">*</span><span class="ident" id="7930133"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="7930140">)</span><span class="op" id="7930141">;</span>&nbsp;<span class="op" id="7930143">!</span><span class="ident" id="7930144"><a href="/net/multicast_test.go.html#7930122">ok</a></span>&nbsp;<span class="op" id="7930147">||</span>&nbsp;<span class="ident" id="7930150"><a href="/net/multicast_test.go.html#7930118">la</a></span><span class="op" id="7930152">.</span><span class="ident" id="7930153">Port</span>&nbsp;<span class="op" id="7930158">==</span>&nbsp;<span class="num" id="7930161">0</span>&nbsp;<span class="op" id="7930163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930167">return</span>&nbsp;<span class="ident" id="7930174"><a href="/net/multicast_test.go.html#7925767">fmt</a></span><span class="op" id="7930177">.</span><span class="ident" id="7930178">Errorf</span><span class="op" id="7930184">(</span><span class="string" id="7930185">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7930246">,</span>&nbsp;<span class="ident" id="7930248"><a href="/net/multicast_test.go.html#7930118">la</a></span><span class="op" id="7930250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930253">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930256">return</span>&nbsp;<span class="ident" id="7930263">nil</span><br>
<span class="lineno"></span><span class="op" id="7930267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7930270">func</span>&nbsp;<span class="ident" id="7930275">multicastRIBContains</span><span class="op" id="7930295">(</span><span class="ident" id="7930296">ip</span>&nbsp;<span class="ident" id="7930299"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="7930301">)</span>&nbsp;<span class="op" id="7930303">(</span><span class="builtintype" id="7930304">bool</span><span class="op" id="7930308">,</span>&nbsp;<span class="builtintype" id="7930310">error</span><span class="op" id="7930315">)</span>&nbsp;<span class="op" id="7930317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930320">switch</span>&nbsp;<span class="ident" id="7930327"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7930334">.</span><span class="ident" id="7930335">GOOS</span>&nbsp;<span class="op" id="7930340">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930343">case</span>&nbsp;<span class="string" id="7930348">&#34;dragonfly&#34;</span><span class="op" id="7930359">,</span>&nbsp;<span class="string" id="7930361">&#34;netbsd&#34;</span><span class="op" id="7930369">,</span>&nbsp;<span class="string" id="7930371">&#34;openbsd&#34;</span><span class="op" id="7930380">,</span>&nbsp;<span class="string" id="7930382">&#34;plan9&#34;</span><span class="op" id="7930389">,</span>&nbsp;<span class="string" id="7930391">&#34;solaris&#34;</span><span class="op" id="7930400">,</span>&nbsp;<span class="string" id="7930402">&#34;windows&#34;</span><span class="op" id="7930411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930415">return</span>&nbsp;<span class="builtintype" id="7930422">true</span><span class="op" id="7930426">,</span>&nbsp;<span class="ident" id="7930428">nil</span>&nbsp;<span class="comment" id="7930432">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930456">case</span>&nbsp;<span class="string" id="7930461">&#34;linux&#34;</span><span class="op" id="7930468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930472">if</span>&nbsp;<span class="ident" id="7930475"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7930482">.</span><span class="ident" id="7930483">GOARCH</span>&nbsp;<span class="op" id="7930490">==</span>&nbsp;<span class="string" id="7930493">&#34;arm&#34;</span>&nbsp;<span class="op" id="7930499">||</span>&nbsp;<span class="ident" id="7930502"><a href="/net/multicast_test.go.html#7925780">runtime</a></span><span class="op" id="7930509">.</span><span class="ident" id="7930510">GOARCH</span>&nbsp;<span class="op" id="7930517">==</span>&nbsp;<span class="string" id="7930520">&#34;alpha&#34;</span>&nbsp;<span class="op" id="7930528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930533">return</span>&nbsp;<span class="builtintype" id="7930540">true</span><span class="op" id="7930544">,</span>&nbsp;<span class="ident" id="7930546">nil</span>&nbsp;<span class="comment" id="7930550">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930581">ift</span><span class="op" id="7930584">,</span>&nbsp;<span class="ident" id="7930586">err</span>&nbsp;<span class="op" id="7930590">:=</span>&nbsp;<span class="ident" id="7930593"><a href="/net/interface.go.html#1407961">Interfaces</a></span><span class="op" id="7930603">(</span><span class="op" id="7930604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930607">if</span>&nbsp;<span class="ident" id="7930610"><a href="/net/multicast_test.go.html#7930586">err</a></span>&nbsp;<span class="op" id="7930614">!=</span>&nbsp;<span class="ident" id="7930617">nil</span>&nbsp;<span class="op" id="7930621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930625">return</span>&nbsp;<span class="builtintype" id="7930632">false</span><span class="op" id="7930637">,</span>&nbsp;<span class="ident" id="7930639"><a href="/net/multicast_test.go.html#7930586">err</a></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930647">for</span>&nbsp;<span class="ident" id="7930651">_</span><span class="op" id="7930652">,</span>&nbsp;<span class="ident" id="7930654">ifi</span>&nbsp;<span class="op" id="7930658">:=</span>&nbsp;<span class="keyword" id="7930661">range</span>&nbsp;<span class="ident" id="7930667"><a href="/net/multicast_test.go.html#7930581">ift</a></span>&nbsp;<span class="op" id="7930671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930675">ifmat</span><span class="op" id="7930680">,</span>&nbsp;<span class="ident" id="7930682">err</span>&nbsp;<span class="op" id="7930686">:=</span>&nbsp;<span class="ident" id="7930689"><a href="/net/multicast_test.go.html#7930654">ifi</a></span><span class="op" id="7930692">.</span><span class="ident" id="7930693">MulticastAddrs</span><span class="op" id="7930707">(</span><span class="op" id="7930708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930712">if</span>&nbsp;<span class="ident" id="7930715"><a href="/net/multicast_test.go.html#7930682">err</a></span>&nbsp;<span class="op" id="7930719">!=</span>&nbsp;<span class="ident" id="7930722">nil</span>&nbsp;<span class="op" id="7930726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930731">return</span>&nbsp;<span class="builtintype" id="7930738">false</span><span class="op" id="7930743">,</span>&nbsp;<span class="ident" id="7930745"><a href="/net/multicast_test.go.html#7930682">err</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930755">for</span>&nbsp;<span class="ident" id="7930759">_</span><span class="op" id="7930760">,</span>&nbsp;<span class="ident" id="7930762">ifma</span>&nbsp;<span class="op" id="7930767">:=</span>&nbsp;<span class="keyword" id="7930770">range</span>&nbsp;<span class="ident" id="7930776"><a href="/net/multicast_test.go.html#7930675">ifmat</a></span>&nbsp;<span class="op" id="7930782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930787">if</span>&nbsp;<span class="ident" id="7930790"><a href="/net/multicast_test.go.html#7930762">ifma</a></span><span class="op" id="7930794">.</span><span class="op" id="7930795">(</span><span class="op" id="7930796">*</span><span class="ident" id="7930797"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7930803">)</span><span class="op" id="7930804">.</span><span class="ident" id="7930805">IP</span><span class="op" id="7930807">.</span><span class="ident" id="7930808">Equal</span><span class="op" id="7930813">(</span><span class="ident" id="7930814"><a href="/net/multicast_test.go.html#7930296">ip</a></span><span class="op" id="7930816">)</span>&nbsp;<span class="op" id="7930818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930824">return</span>&nbsp;<span class="builtintype" id="7930831">true</span><span class="op" id="7930835">,</span>&nbsp;<span class="ident" id="7930837">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930844">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930854">return</span>&nbsp;<span class="builtintype" id="7930861">false</span><span class="op" id="7930866">,</span>&nbsp;<span class="ident" id="7930868">nil</span><br>
<span class="lineno"></span><span class="op" id="7930872">}</span>
</div>
</body>
</html>
