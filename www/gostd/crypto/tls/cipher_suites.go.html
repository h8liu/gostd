<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3753340">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3753395">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3753449">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3753500">package</span>&nbsp;<span class="ident" id="3753508">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3753513">import</span>&nbsp;<span class="op" id="3753520">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753523">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753537">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753554">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753568">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753583">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753597">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753612">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3753627">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3753634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3753637">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="3753716">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="3753780">type</span>&nbsp;<span class="ident" id="3753785">keyAgreement</span>&nbsp;<span class="keyword" id="3753798">interface</span>&nbsp;<span class="op" id="3753808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3753811">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3753879">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3753941">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754014">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754023">generateServerKeyExchange</span><span class="op" id="3754048">(</span><span class="op" id="3754049">*</span><span class="ident" id="3754050">Config</span><span class="op" id="3754056">,</span>&nbsp;<span class="op" id="3754058">*</span><span class="ident" id="3754059">Certificate</span><span class="op" id="3754070">,</span>&nbsp;<span class="op" id="3754072">*</span><span class="ident" id="3754073">clientHelloMsg</span><span class="op" id="3754087">,</span>&nbsp;<span class="op" id="3754089">*</span><span class="ident" id="3754090">serverHelloMsg</span><span class="op" id="3754104">)</span>&nbsp;<span class="op" id="3754106">(</span><span class="op" id="3754107">*</span><span class="ident" id="3754108">serverKeyExchangeMsg</span><span class="op" id="3754128">,</span>&nbsp;<span class="builtintype" id="3754130">error</span><span class="op" id="3754135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754138">processClientKeyExchange</span><span class="op" id="3754162">(</span><span class="op" id="3754163">*</span><span class="ident" id="3754164">Config</span><span class="op" id="3754170">,</span>&nbsp;<span class="op" id="3754172">*</span><span class="ident" id="3754173">Certificate</span><span class="op" id="3754184">,</span>&nbsp;<span class="op" id="3754186">*</span><span class="ident" id="3754187">clientKeyExchangeMsg</span><span class="op" id="3754207">,</span>&nbsp;<span class="builtintype" id="3754209">uint16</span><span class="op" id="3754215">)</span>&nbsp;<span class="op" id="3754217">(</span><span class="op" id="3754218">[</span><span class="op" id="3754219">]</span><span class="builtintype" id="3754220">byte</span><span class="op" id="3754224">,</span>&nbsp;<span class="builtintype" id="3754226">error</span><span class="op" id="3754231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754235">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754302">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754365">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754396">processServerKeyExchange</span><span class="op" id="3754420">(</span><span class="op" id="3754421">*</span><span class="ident" id="3754422">Config</span><span class="op" id="3754428">,</span>&nbsp;<span class="op" id="3754430">*</span><span class="ident" id="3754431">clientHelloMsg</span><span class="op" id="3754445">,</span>&nbsp;<span class="op" id="3754447">*</span><span class="ident" id="3754448">serverHelloMsg</span><span class="op" id="3754462">,</span>&nbsp;<span class="op" id="3754464">*</span><span class="ident" id="3754465">x509</span><span class="op" id="3754469">.</span><span class="ident" id="3754470">Certificate</span><span class="op" id="3754481">,</span>&nbsp;<span class="op" id="3754483">*</span><span class="ident" id="3754484">serverKeyExchangeMsg</span><span class="op" id="3754504">)</span>&nbsp;<span class="builtintype" id="3754506">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754513">generateClientKeyExchange</span><span class="op" id="3754538">(</span><span class="op" id="3754539">*</span><span class="ident" id="3754540">Config</span><span class="op" id="3754546">,</span>&nbsp;<span class="op" id="3754548">*</span><span class="ident" id="3754549">clientHelloMsg</span><span class="op" id="3754563">,</span>&nbsp;<span class="op" id="3754565">*</span><span class="ident" id="3754566">x509</span><span class="op" id="3754570">.</span><span class="ident" id="3754571">Certificate</span><span class="op" id="3754582">)</span>&nbsp;<span class="op" id="3754584">(</span><span class="op" id="3754585">[</span><span class="op" id="3754586">]</span><span class="builtintype" id="3754587">byte</span><span class="op" id="3754591">,</span>&nbsp;<span class="op" id="3754593">*</span><span class="ident" id="3754594">clientKeyExchangeMsg</span><span class="op" id="3754614">,</span>&nbsp;<span class="builtintype" id="3754616">error</span><span class="op" id="3754621">)</span><br>
<span class="lineno">35</span><span class="op" id="3754623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3754626">const</span>&nbsp;<span class="op" id="3754632">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754635">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754705">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754777">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754849">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3754876">suiteECDHE</span>&nbsp;<span class="op" id="3754887">=</span>&nbsp;<span class="num" id="3754889">1</span>&nbsp;<span class="op" id="3754891">&lt;&lt;</span>&nbsp;<span class="ident" id="3754894">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754900">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3754965">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755032">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755102">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755117">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755129">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755202">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755239">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="3755250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3755253">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="3755329">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="3755396">type</span>&nbsp;<span class="ident" id="3755401">cipherSuite</span>&nbsp;<span class="keyword" id="3755413">struct</span>&nbsp;<span class="op" id="3755420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755423">id</span>&nbsp;<span class="builtintype" id="3755426">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755434">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755508">keyLen</span>&nbsp;<span class="builtintype" id="3755515">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755520">macLen</span>&nbsp;<span class="builtintype" id="3755527">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755532">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="3755539">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755544">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755551">func</span><span class="op" id="3755555">(</span><span class="ident" id="3755556">version</span>&nbsp;<span class="builtintype" id="3755564">uint16</span><span class="op" id="3755570">)</span>&nbsp;<span class="ident" id="3755572">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755586">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755638">flags</span>&nbsp;&nbsp;<span class="builtintype" id="3755645">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755650">cipher</span>&nbsp;<span class="keyword" id="3755657">func</span><span class="op" id="3755661">(</span><span class="ident" id="3755662">key</span><span class="op" id="3755665">,</span>&nbsp;<span class="ident" id="3755667">iv</span>&nbsp;<span class="op" id="3755670">[</span><span class="op" id="3755671">]</span><span class="builtintype" id="3755672">byte</span><span class="op" id="3755676">,</span>&nbsp;<span class="ident" id="3755678">isRead</span>&nbsp;<span class="builtintype" id="3755685">bool</span><span class="op" id="3755689">)</span>&nbsp;<span class="keyword" id="3755691">interface</span><span class="op" id="3755700">{</span><span class="op" id="3755701">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755704">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755711">func</span><span class="op" id="3755715">(</span><span class="ident" id="3755716">version</span>&nbsp;<span class="builtintype" id="3755724">uint16</span><span class="op" id="3755730">,</span>&nbsp;<span class="ident" id="3755732">macKey</span>&nbsp;<span class="op" id="3755739">[</span><span class="op" id="3755740">]</span><span class="builtintype" id="3755741">byte</span><span class="op" id="3755745">)</span>&nbsp;<span class="ident" id="3755747">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3755760">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3755767">func</span><span class="op" id="3755771">(</span><span class="ident" id="3755772">key</span><span class="op" id="3755775">,</span>&nbsp;<span class="ident" id="3755777">fixedNonce</span>&nbsp;<span class="op" id="3755788">[</span><span class="op" id="3755789">]</span><span class="builtintype" id="3755790">byte</span><span class="op" id="3755794">)</span>&nbsp;<span class="ident" id="3755796">cipher</span><span class="op" id="3755802">.</span><span class="ident" id="3755803">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3755808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3755811">var</span>&nbsp;<span class="ident" id="3755815">cipherSuites</span>&nbsp;<span class="op" id="3755828">=</span>&nbsp;<span class="op" id="3755830">[</span><span class="op" id="3755831">]</span><span class="op" id="3755832">*</span><span class="ident" id="3755833">cipherSuite</span><span class="op" id="3755844">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755847">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3755916">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3755978">{</span><span class="ident" id="3755979">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3756016">,</span>&nbsp;<span class="num" id="3756018">16</span><span class="op" id="3756020">,</span>&nbsp;<span class="num" id="3756022">0</span><span class="op" id="3756023">,</span>&nbsp;<span class="num" id="3756025">4</span><span class="op" id="3756026">,</span>&nbsp;<span class="ident" id="3756028">ecdheRSAKA</span><span class="op" id="3756038">,</span>&nbsp;<span class="ident" id="3756040">suiteECDHE</span>&nbsp;<span class="op" id="3756051">|</span>&nbsp;<span class="ident" id="3756053">suiteTLS12</span><span class="op" id="3756063">,</span>&nbsp;<span class="ident" id="3756065">nil</span><span class="op" id="3756068">,</span>&nbsp;<span class="ident" id="3756070">nil</span><span class="op" id="3756073">,</span>&nbsp;<span class="ident" id="3756075">aeadAESGCM</span><span class="op" id="3756085">}</span><span class="op" id="3756086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756089">{</span><span class="ident" id="3756090">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3756129">,</span>&nbsp;<span class="num" id="3756131">16</span><span class="op" id="3756133">,</span>&nbsp;<span class="num" id="3756135">0</span><span class="op" id="3756136">,</span>&nbsp;<span class="num" id="3756138">4</span><span class="op" id="3756139">,</span>&nbsp;<span class="ident" id="3756141">ecdheECDSAKA</span><span class="op" id="3756153">,</span>&nbsp;<span class="ident" id="3756155">suiteECDHE</span>&nbsp;<span class="op" id="3756166">|</span>&nbsp;<span class="ident" id="3756168">suiteECDSA</span>&nbsp;<span class="op" id="3756179">|</span>&nbsp;<span class="ident" id="3756181">suiteTLS12</span><span class="op" id="3756191">,</span>&nbsp;<span class="ident" id="3756193">nil</span><span class="op" id="3756196">,</span>&nbsp;<span class="ident" id="3756198">nil</span><span class="op" id="3756201">,</span>&nbsp;<span class="ident" id="3756203">aeadAESGCM</span><span class="op" id="3756213">}</span><span class="op" id="3756214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756217">{</span><span class="ident" id="3756218">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="3756248">,</span>&nbsp;<span class="num" id="3756250">16</span><span class="op" id="3756252">,</span>&nbsp;<span class="num" id="3756254">20</span><span class="op" id="3756256">,</span>&nbsp;<span class="num" id="3756258">0</span><span class="op" id="3756259">,</span>&nbsp;<span class="ident" id="3756261">ecdheRSAKA</span><span class="op" id="3756271">,</span>&nbsp;<span class="ident" id="3756273">suiteECDHE</span><span class="op" id="3756283">,</span>&nbsp;<span class="ident" id="3756285">cipherRC4</span><span class="op" id="3756294">,</span>&nbsp;<span class="ident" id="3756296">macSHA1</span><span class="op" id="3756303">,</span>&nbsp;<span class="ident" id="3756305">nil</span><span class="op" id="3756308">}</span><span class="op" id="3756309">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756312">{</span><span class="ident" id="3756313">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="3756345">,</span>&nbsp;<span class="num" id="3756347">16</span><span class="op" id="3756349">,</span>&nbsp;<span class="num" id="3756351">20</span><span class="op" id="3756353">,</span>&nbsp;<span class="num" id="3756355">0</span><span class="op" id="3756356">,</span>&nbsp;<span class="ident" id="3756358">ecdheECDSAKA</span><span class="op" id="3756370">,</span>&nbsp;<span class="ident" id="3756372">suiteECDHE</span>&nbsp;<span class="op" id="3756383">|</span>&nbsp;<span class="ident" id="3756385">suiteECDSA</span><span class="op" id="3756395">,</span>&nbsp;<span class="ident" id="3756397">cipherRC4</span><span class="op" id="3756406">,</span>&nbsp;<span class="ident" id="3756408">macSHA1</span><span class="op" id="3756415">,</span>&nbsp;<span class="ident" id="3756417">nil</span><span class="op" id="3756420">}</span><span class="op" id="3756421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756424">{</span><span class="ident" id="3756425">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3756459">,</span>&nbsp;<span class="num" id="3756461">16</span><span class="op" id="3756463">,</span>&nbsp;<span class="num" id="3756465">20</span><span class="op" id="3756467">,</span>&nbsp;<span class="num" id="3756469">16</span><span class="op" id="3756471">,</span>&nbsp;<span class="ident" id="3756473">ecdheRSAKA</span><span class="op" id="3756483">,</span>&nbsp;<span class="ident" id="3756485">suiteECDHE</span><span class="op" id="3756495">,</span>&nbsp;<span class="ident" id="3756497">cipherAES</span><span class="op" id="3756506">,</span>&nbsp;<span class="ident" id="3756508">macSHA1</span><span class="op" id="3756515">,</span>&nbsp;<span class="ident" id="3756517">nil</span><span class="op" id="3756520">}</span><span class="op" id="3756521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756524">{</span><span class="ident" id="3756525">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3756561">,</span>&nbsp;<span class="num" id="3756563">16</span><span class="op" id="3756565">,</span>&nbsp;<span class="num" id="3756567">20</span><span class="op" id="3756569">,</span>&nbsp;<span class="num" id="3756571">16</span><span class="op" id="3756573">,</span>&nbsp;<span class="ident" id="3756575">ecdheECDSAKA</span><span class="op" id="3756587">,</span>&nbsp;<span class="ident" id="3756589">suiteECDHE</span>&nbsp;<span class="op" id="3756600">|</span>&nbsp;<span class="ident" id="3756602">suiteECDSA</span><span class="op" id="3756612">,</span>&nbsp;<span class="ident" id="3756614">cipherAES</span><span class="op" id="3756623">,</span>&nbsp;<span class="ident" id="3756625">macSHA1</span><span class="op" id="3756632">,</span>&nbsp;<span class="ident" id="3756634">nil</span><span class="op" id="3756637">}</span><span class="op" id="3756638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756641">{</span><span class="ident" id="3756642">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3756676">,</span>&nbsp;<span class="num" id="3756678">32</span><span class="op" id="3756680">,</span>&nbsp;<span class="num" id="3756682">20</span><span class="op" id="3756684">,</span>&nbsp;<span class="num" id="3756686">16</span><span class="op" id="3756688">,</span>&nbsp;<span class="ident" id="3756690">ecdheRSAKA</span><span class="op" id="3756700">,</span>&nbsp;<span class="ident" id="3756702">suiteECDHE</span><span class="op" id="3756712">,</span>&nbsp;<span class="ident" id="3756714">cipherAES</span><span class="op" id="3756723">,</span>&nbsp;<span class="ident" id="3756725">macSHA1</span><span class="op" id="3756732">,</span>&nbsp;<span class="ident" id="3756734">nil</span><span class="op" id="3756737">}</span><span class="op" id="3756738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756741">{</span><span class="ident" id="3756742">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3756778">,</span>&nbsp;<span class="num" id="3756780">32</span><span class="op" id="3756782">,</span>&nbsp;<span class="num" id="3756784">20</span><span class="op" id="3756786">,</span>&nbsp;<span class="num" id="3756788">16</span><span class="op" id="3756790">,</span>&nbsp;<span class="ident" id="3756792">ecdheECDSAKA</span><span class="op" id="3756804">,</span>&nbsp;<span class="ident" id="3756806">suiteECDHE</span>&nbsp;<span class="op" id="3756817">|</span>&nbsp;<span class="ident" id="3756819">suiteECDSA</span><span class="op" id="3756829">,</span>&nbsp;<span class="ident" id="3756831">cipherAES</span><span class="op" id="3756840">,</span>&nbsp;<span class="ident" id="3756842">macSHA1</span><span class="op" id="3756849">,</span>&nbsp;<span class="ident" id="3756851">nil</span><span class="op" id="3756854">}</span><span class="op" id="3756855">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756858">{</span><span class="ident" id="3756859">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="3756883">,</span>&nbsp;<span class="num" id="3756885">16</span><span class="op" id="3756887">,</span>&nbsp;<span class="num" id="3756889">20</span><span class="op" id="3756891">,</span>&nbsp;<span class="num" id="3756893">0</span><span class="op" id="3756894">,</span>&nbsp;<span class="ident" id="3756896">rsaKA</span><span class="op" id="3756901">,</span>&nbsp;<span class="num" id="3756903">0</span><span class="op" id="3756904">,</span>&nbsp;<span class="ident" id="3756906">cipherRC4</span><span class="op" id="3756915">,</span>&nbsp;<span class="ident" id="3756917">macSHA1</span><span class="op" id="3756924">,</span>&nbsp;<span class="ident" id="3756926">nil</span><span class="op" id="3756929">}</span><span class="op" id="3756930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3756933">{</span><span class="ident" id="3756934">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3756962">,</span>&nbsp;<span class="num" id="3756964">16</span><span class="op" id="3756966">,</span>&nbsp;<span class="num" id="3756968">20</span><span class="op" id="3756970">,</span>&nbsp;<span class="num" id="3756972">16</span><span class="op" id="3756974">,</span>&nbsp;<span class="ident" id="3756976">rsaKA</span><span class="op" id="3756981">,</span>&nbsp;<span class="num" id="3756983">0</span><span class="op" id="3756984">,</span>&nbsp;<span class="ident" id="3756986">cipherAES</span><span class="op" id="3756995">,</span>&nbsp;<span class="ident" id="3756997">macSHA1</span><span class="op" id="3757004">,</span>&nbsp;<span class="ident" id="3757006">nil</span><span class="op" id="3757009">}</span><span class="op" id="3757010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757013">{</span><span class="ident" id="3757014">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3757042">,</span>&nbsp;<span class="num" id="3757044">32</span><span class="op" id="3757046">,</span>&nbsp;<span class="num" id="3757048">20</span><span class="op" id="3757050">,</span>&nbsp;<span class="num" id="3757052">16</span><span class="op" id="3757054">,</span>&nbsp;<span class="ident" id="3757056">rsaKA</span><span class="op" id="3757061">,</span>&nbsp;<span class="num" id="3757063">0</span><span class="op" id="3757064">,</span>&nbsp;<span class="ident" id="3757066">cipherAES</span><span class="op" id="3757075">,</span>&nbsp;<span class="ident" id="3757077">macSHA1</span><span class="op" id="3757084">,</span>&nbsp;<span class="ident" id="3757086">nil</span><span class="op" id="3757089">}</span><span class="op" id="3757090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757093">{</span><span class="ident" id="3757094">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3757129">,</span>&nbsp;<span class="num" id="3757131">24</span><span class="op" id="3757133">,</span>&nbsp;<span class="num" id="3757135">20</span><span class="op" id="3757137">,</span>&nbsp;<span class="num" id="3757139">8</span><span class="op" id="3757140">,</span>&nbsp;<span class="ident" id="3757142">ecdheRSAKA</span><span class="op" id="3757152">,</span>&nbsp;<span class="ident" id="3757154">suiteECDHE</span><span class="op" id="3757164">,</span>&nbsp;<span class="ident" id="3757166">cipher3DES</span><span class="op" id="3757176">,</span>&nbsp;<span class="ident" id="3757178">macSHA1</span><span class="op" id="3757185">,</span>&nbsp;<span class="ident" id="3757187">nil</span><span class="op" id="3757190">}</span><span class="op" id="3757191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757194">{</span><span class="ident" id="3757195">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3757224">,</span>&nbsp;<span class="num" id="3757226">24</span><span class="op" id="3757228">,</span>&nbsp;<span class="num" id="3757230">20</span><span class="op" id="3757232">,</span>&nbsp;<span class="num" id="3757234">8</span><span class="op" id="3757235">,</span>&nbsp;<span class="ident" id="3757237">rsaKA</span><span class="op" id="3757242">,</span>&nbsp;<span class="num" id="3757244">0</span><span class="op" id="3757245">,</span>&nbsp;<span class="ident" id="3757247">cipher3DES</span><span class="op" id="3757257">,</span>&nbsp;<span class="ident" id="3757259">macSHA1</span><span class="op" id="3757266">,</span>&nbsp;<span class="ident" id="3757268">nil</span><span class="op" id="3757271">}</span><span class="op" id="3757272">,</span><br>
<span class="lineno">85</span><span class="op" id="3757274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3757277">func</span>&nbsp;<span class="ident" id="3757282">cipherRC4</span><span class="op" id="3757291">(</span><span class="ident" id="3757292">key</span><span class="op" id="3757295">,</span>&nbsp;<span class="ident" id="3757297">iv</span>&nbsp;<span class="op" id="3757300">[</span><span class="op" id="3757301">]</span><span class="builtintype" id="3757302">byte</span><span class="op" id="3757306">,</span>&nbsp;<span class="ident" id="3757308">isRead</span>&nbsp;<span class="builtintype" id="3757315">bool</span><span class="op" id="3757319">)</span>&nbsp;<span class="keyword" id="3757321">interface</span><span class="op" id="3757330">{</span><span class="op" id="3757331">}</span>&nbsp;<span class="op" id="3757333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757336">cipher</span><span class="op" id="3757342">,</span>&nbsp;<span class="ident" id="3757344">_</span>&nbsp;<span class="op" id="3757346">:=</span>&nbsp;<span class="ident" id="3757349">rc4</span><span class="op" id="3757352">.</span><span class="ident" id="3757353">NewCipher</span><span class="op" id="3757362">(</span><span class="ident" id="3757363">key</span><span class="op" id="3757366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757369">return</span>&nbsp;<span class="ident" id="3757376">cipher</span><br>
<span class="lineno">90</span><span class="op" id="3757383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3757386">func</span>&nbsp;<span class="ident" id="3757391">cipher3DES</span><span class="op" id="3757401">(</span><span class="ident" id="3757402">key</span><span class="op" id="3757405">,</span>&nbsp;<span class="ident" id="3757407">iv</span>&nbsp;<span class="op" id="3757410">[</span><span class="op" id="3757411">]</span><span class="builtintype" id="3757412">byte</span><span class="op" id="3757416">,</span>&nbsp;<span class="ident" id="3757418">isRead</span>&nbsp;<span class="builtintype" id="3757425">bool</span><span class="op" id="3757429">)</span>&nbsp;<span class="keyword" id="3757431">interface</span><span class="op" id="3757440">{</span><span class="op" id="3757441">}</span>&nbsp;<span class="op" id="3757443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757446">block</span><span class="op" id="3757451">,</span>&nbsp;<span class="ident" id="3757453">_</span>&nbsp;<span class="op" id="3757455">:=</span>&nbsp;<span class="ident" id="3757458">des</span><span class="op" id="3757461">.</span><span class="ident" id="3757462">NewTripleDESCipher</span><span class="op" id="3757480">(</span><span class="ident" id="3757481">key</span><span class="op" id="3757484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757487">if</span>&nbsp;<span class="ident" id="3757490">isRead</span>&nbsp;<span class="op" id="3757497">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757501">return</span>&nbsp;<span class="ident" id="3757508">cipher</span><span class="op" id="3757514">.</span><span class="ident" id="3757515">NewCBCDecrypter</span><span class="op" id="3757530">(</span><span class="ident" id="3757531">block</span><span class="op" id="3757536">,</span>&nbsp;<span class="ident" id="3757538">iv</span><span class="op" id="3757540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757546">return</span>&nbsp;<span class="ident" id="3757553">cipher</span><span class="op" id="3757559">.</span><span class="ident" id="3757560">NewCBCEncrypter</span><span class="op" id="3757575">(</span><span class="ident" id="3757576">block</span><span class="op" id="3757581">,</span>&nbsp;<span class="ident" id="3757583">iv</span><span class="op" id="3757585">)</span><br>
<span class="lineno"></span><span class="op" id="3757587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3757590">func</span>&nbsp;<span class="ident" id="3757595">cipherAES</span><span class="op" id="3757604">(</span><span class="ident" id="3757605">key</span><span class="op" id="3757608">,</span>&nbsp;<span class="ident" id="3757610">iv</span>&nbsp;<span class="op" id="3757613">[</span><span class="op" id="3757614">]</span><span class="builtintype" id="3757615">byte</span><span class="op" id="3757619">,</span>&nbsp;<span class="ident" id="3757621">isRead</span>&nbsp;<span class="builtintype" id="3757628">bool</span><span class="op" id="3757632">)</span>&nbsp;<span class="keyword" id="3757634">interface</span><span class="op" id="3757643">{</span><span class="op" id="3757644">}</span>&nbsp;<span class="op" id="3757646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757649">block</span><span class="op" id="3757654">,</span>&nbsp;<span class="ident" id="3757656">_</span>&nbsp;<span class="op" id="3757658">:=</span>&nbsp;<span class="ident" id="3757661">aes</span><span class="op" id="3757664">.</span><span class="ident" id="3757665">NewCipher</span><span class="op" id="3757674">(</span><span class="ident" id="3757675">key</span><span class="op" id="3757678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757681">if</span>&nbsp;<span class="ident" id="3757684">isRead</span>&nbsp;<span class="op" id="3757691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757695">return</span>&nbsp;<span class="ident" id="3757702">cipher</span><span class="op" id="3757708">.</span><span class="ident" id="3757709">NewCBCDecrypter</span><span class="op" id="3757724">(</span><span class="ident" id="3757725">block</span><span class="op" id="3757730">,</span>&nbsp;<span class="ident" id="3757732">iv</span><span class="op" id="3757734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3757737">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757740">return</span>&nbsp;<span class="ident" id="3757747">cipher</span><span class="op" id="3757753">.</span><span class="ident" id="3757754">NewCBCEncrypter</span><span class="op" id="3757769">(</span><span class="ident" id="3757770">block</span><span class="op" id="3757775">,</span>&nbsp;<span class="ident" id="3757777">iv</span><span class="op" id="3757779">)</span><br>
<span class="lineno"></span><span class="op" id="3757781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3757784">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="3757849">func</span>&nbsp;<span class="ident" id="3757854">macSHA1</span><span class="op" id="3757861">(</span><span class="ident" id="3757862">version</span>&nbsp;<span class="builtintype" id="3757870">uint16</span><span class="op" id="3757876">,</span>&nbsp;<span class="ident" id="3757878">key</span>&nbsp;<span class="op" id="3757882">[</span><span class="op" id="3757883">]</span><span class="builtintype" id="3757884">byte</span><span class="op" id="3757888">)</span>&nbsp;<span class="ident" id="3757890">macFunction</span>&nbsp;<span class="op" id="3757902">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3757905">if</span>&nbsp;<span class="ident" id="3757908">version</span>&nbsp;<span class="op" id="3757916">==</span>&nbsp;<span class="ident" id="3757919">VersionSSL30</span>&nbsp;<span class="op" id="3757932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757936">mac</span>&nbsp;<span class="op" id="3757940">:=</span>&nbsp;<span class="ident" id="3757943">ssl30MAC</span><span class="op" id="3757951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757956">h</span><span class="op" id="3757957">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3757961">sha1</span><span class="op" id="3757965">.</span><span class="ident" id="3757966">New</span><span class="op" id="3757969">(</span><span class="op" id="3757970">)</span><span class="op" id="3757971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3757976">key</span><span class="op" id="3757979">:</span>&nbsp;<span class="builtinfunc" id="3757981">make</span><span class="op" id="3757985">(</span><span class="op" id="3757986">[</span><span class="op" id="3757987">]</span><span class="builtintype" id="3757988">byte</span><span class="op" id="3757992">,</span>&nbsp;<span class="builtinfunc" id="3757994">len</span><span class="op" id="3757997">(</span><span class="ident" id="3757998">key</span><span class="op" id="3758001">)</span><span class="op" id="3758002">)</span><span class="op" id="3758003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758007">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3758011">copy</span><span class="op" id="3758015">(</span><span class="ident" id="3758016">mac</span><span class="op" id="3758019">.</span><span class="ident" id="3758020">key</span><span class="op" id="3758023">,</span>&nbsp;<span class="ident" id="3758025">key</span><span class="op" id="3758028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758032">return</span>&nbsp;<span class="ident" id="3758039">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3758044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758047">return</span>&nbsp;<span class="ident" id="3758054">tls10MAC</span><span class="op" id="3758062">{</span><span class="ident" id="3758063">hmac</span><span class="op" id="3758067">.</span><span class="ident" id="3758068">New</span><span class="op" id="3758071">(</span><span class="ident" id="3758072">sha1</span><span class="op" id="3758076">.</span><span class="ident" id="3758077">New</span><span class="op" id="3758080">,</span>&nbsp;<span class="ident" id="3758082">key</span><span class="op" id="3758085">)</span><span class="op" id="3758086">}</span><br>
<span class="lineno"></span><span class="op" id="3758088">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3758091">type</span>&nbsp;<span class="ident" id="3758096">macFunction</span>&nbsp;<span class="keyword" id="3758108">interface</span>&nbsp;<span class="op" id="3758118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758121">Size</span><span class="op" id="3758125">(</span><span class="op" id="3758126">)</span>&nbsp;<span class="builtintype" id="3758128">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758133">MAC</span><span class="op" id="3758136">(</span><span class="ident" id="3758137">digestBuf</span><span class="op" id="3758146">,</span>&nbsp;<span class="ident" id="3758148">seq</span><span class="op" id="3758151">,</span>&nbsp;<span class="ident" id="3758153">header</span><span class="op" id="3758159">,</span>&nbsp;<span class="ident" id="3758161">data</span>&nbsp;<span class="op" id="3758166">[</span><span class="op" id="3758167">]</span><span class="builtintype" id="3758168">byte</span><span class="op" id="3758172">)</span>&nbsp;<span class="op" id="3758174">[</span><span class="op" id="3758175">]</span><span class="builtintype" id="3758176">byte</span><br>
<span class="lineno"></span><span class="op" id="3758181">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3758184">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3758261">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="3758275">type</span>&nbsp;<span class="ident" id="3758280">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="3758295">struct</span>&nbsp;<span class="op" id="3758302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3758305">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3758376">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3758440">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758495">sealNonce</span><span class="op" id="3758504">,</span>&nbsp;<span class="ident" id="3758506">openNonce</span>&nbsp;<span class="op" id="3758516">[</span><span class="op" id="3758517">]</span><span class="builtintype" id="3758518">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3758524">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3758545">cipher</span><span class="op" id="3758551">.</span><span class="ident" id="3758552">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3758557">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3758560">func</span>&nbsp;<span class="op" id="3758565">(</span><span class="ident" id="3758566">f</span>&nbsp;<span class="op" id="3758568">*</span><span class="ident" id="3758569">fixedNonceAEAD</span><span class="op" id="3758583">)</span>&nbsp;<span class="ident" id="3758585">NonceSize</span><span class="op" id="3758594">(</span><span class="op" id="3758595">)</span>&nbsp;<span class="builtintype" id="3758597">int</span>&nbsp;<span class="op" id="3758601">{</span>&nbsp;<span class="keyword" id="3758603">return</span>&nbsp;<span class="num" id="3758610">8</span>&nbsp;<span class="op" id="3758612">}</span><br>
<span class="lineno"></span><span class="keyword" id="3758614">func</span>&nbsp;<span class="op" id="3758619">(</span><span class="ident" id="3758620">f</span>&nbsp;<span class="op" id="3758622">*</span><span class="ident" id="3758623">fixedNonceAEAD</span><span class="op" id="3758637">)</span>&nbsp;<span class="ident" id="3758639">Overhead</span><span class="op" id="3758647">(</span><span class="op" id="3758648">)</span>&nbsp;<span class="builtintype" id="3758650">int</span>&nbsp;&nbsp;<span class="op" id="3758655">{</span>&nbsp;<span class="keyword" id="3758657">return</span>&nbsp;<span class="ident" id="3758664">f</span><span class="op" id="3758665">.</span><span class="ident" id="3758666">aead</span><span class="op" id="3758670">.</span><span class="ident" id="3758671">Overhead</span><span class="op" id="3758679">(</span><span class="op" id="3758680">)</span>&nbsp;<span class="op" id="3758682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758685">func</span>&nbsp;<span class="op" id="3758690">(</span><span class="ident" id="3758691">f</span>&nbsp;<span class="op" id="3758693">*</span><span class="ident" id="3758694">fixedNonceAEAD</span><span class="op" id="3758708">)</span>&nbsp;<span class="ident" id="3758710">Seal</span><span class="op" id="3758714">(</span><span class="ident" id="3758715">out</span><span class="op" id="3758718">,</span>&nbsp;<span class="ident" id="3758720">nonce</span><span class="op" id="3758725">,</span>&nbsp;<span class="ident" id="3758727">plaintext</span><span class="op" id="3758736">,</span>&nbsp;<span class="ident" id="3758738">additionalData</span>&nbsp;<span class="op" id="3758753">[</span><span class="op" id="3758754">]</span><span class="builtintype" id="3758755">byte</span><span class="op" id="3758759">)</span>&nbsp;<span class="op" id="3758761">[</span><span class="op" id="3758762">]</span><span class="builtintype" id="3758763">byte</span>&nbsp;<span class="op" id="3758768">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3758771">copy</span><span class="op" id="3758775">(</span><span class="ident" id="3758776">f</span><span class="op" id="3758777">.</span><span class="ident" id="3758778">sealNonce</span><span class="op" id="3758787">[</span><span class="builtinfunc" id="3758788">len</span><span class="op" id="3758791">(</span><span class="ident" id="3758792">f</span><span class="op" id="3758793">.</span><span class="ident" id="3758794">sealNonce</span><span class="op" id="3758803">)</span><span class="op" id="3758804">-</span><span class="num" id="3758805">8</span><span class="op" id="3758806">:</span><span class="op" id="3758807">]</span><span class="op" id="3758808">,</span>&nbsp;<span class="ident" id="3758810">nonce</span><span class="op" id="3758815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3758818">return</span>&nbsp;<span class="ident" id="3758825">f</span><span class="op" id="3758826">.</span><span class="ident" id="3758827">aead</span><span class="op" id="3758831">.</span><span class="ident" id="3758832">Seal</span><span class="op" id="3758836">(</span><span class="ident" id="3758837">out</span><span class="op" id="3758840">,</span>&nbsp;<span class="ident" id="3758842">f</span><span class="op" id="3758843">.</span><span class="ident" id="3758844">sealNonce</span><span class="op" id="3758853">,</span>&nbsp;<span class="ident" id="3758855">plaintext</span><span class="op" id="3758864">,</span>&nbsp;<span class="ident" id="3758866">additionalData</span><span class="op" id="3758880">)</span><br>
<span class="lineno"></span><span class="op" id="3758882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3758885">func</span>&nbsp;<span class="op" id="3758890">(</span><span class="ident" id="3758891">f</span>&nbsp;<span class="op" id="3758893">*</span><span class="ident" id="3758894">fixedNonceAEAD</span><span class="op" id="3758908">)</span>&nbsp;<span class="ident" id="3758910">Open</span><span class="op" id="3758914">(</span><span class="ident" id="3758915">out</span><span class="op" id="3758918">,</span>&nbsp;<span class="ident" id="3758920">nonce</span><span class="op" id="3758925">,</span>&nbsp;<span class="ident" id="3758927">plaintext</span><span class="op" id="3758936">,</span>&nbsp;<span class="ident" id="3758938">additionalData</span>&nbsp;<span class="op" id="3758953">[</span><span class="op" id="3758954">]</span><span class="builtintype" id="3758955">byte</span><span class="op" id="3758959">)</span>&nbsp;<span class="op" id="3758961">(</span><span class="op" id="3758962">[</span><span class="op" id="3758963">]</span><span class="builtintype" id="3758964">byte</span><span class="op" id="3758968">,</span>&nbsp;<span class="builtintype" id="3758970">error</span><span class="op" id="3758975">)</span>&nbsp;<span class="op" id="3758977">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3758980">copy</span><span class="op" id="3758984">(</span><span class="ident" id="3758985">f</span><span class="op" id="3758986">.</span><span class="ident" id="3758987">openNonce</span><span class="op" id="3758996">[</span><span class="builtinfunc" id="3758997">len</span><span class="op" id="3759000">(</span><span class="ident" id="3759001">f</span><span class="op" id="3759002">.</span><span class="ident" id="3759003">openNonce</span><span class="op" id="3759012">)</span><span class="op" id="3759013">-</span><span class="num" id="3759014">8</span><span class="op" id="3759015">:</span><span class="op" id="3759016">]</span><span class="op" id="3759017">,</span>&nbsp;<span class="ident" id="3759019">nonce</span><span class="op" id="3759024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759027">return</span>&nbsp;<span class="ident" id="3759034">f</span><span class="op" id="3759035">.</span><span class="ident" id="3759036">aead</span><span class="op" id="3759040">.</span><span class="ident" id="3759041">Open</span><span class="op" id="3759045">(</span><span class="ident" id="3759046">out</span><span class="op" id="3759049">,</span>&nbsp;<span class="ident" id="3759051">f</span><span class="op" id="3759052">.</span><span class="ident" id="3759053">openNonce</span><span class="op" id="3759062">,</span>&nbsp;<span class="ident" id="3759064">plaintext</span><span class="op" id="3759073">,</span>&nbsp;<span class="ident" id="3759075">additionalData</span><span class="op" id="3759089">)</span><br>
<span class="lineno"></span><span class="op" id="3759091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759094">func</span>&nbsp;<span class="ident" id="3759099">aeadAESGCM</span><span class="op" id="3759109">(</span><span class="ident" id="3759110">key</span><span class="op" id="3759113">,</span>&nbsp;<span class="ident" id="3759115">fixedNonce</span>&nbsp;<span class="op" id="3759126">[</span><span class="op" id="3759127">]</span><span class="builtintype" id="3759128">byte</span><span class="op" id="3759132">)</span>&nbsp;<span class="ident" id="3759134">cipher</span><span class="op" id="3759140">.</span><span class="ident" id="3759141">AEAD</span>&nbsp;<span class="op" id="3759146">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759149">aes</span><span class="op" id="3759152">,</span>&nbsp;<span class="ident" id="3759154">err</span>&nbsp;<span class="op" id="3759158">:=</span>&nbsp;<span class="ident" id="3759161">aes</span><span class="op" id="3759164">.</span><span class="ident" id="3759165">NewCipher</span><span class="op" id="3759174">(</span><span class="ident" id="3759175">key</span><span class="op" id="3759178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759181">if</span>&nbsp;<span class="ident" id="3759184">err</span>&nbsp;<span class="op" id="3759188">!=</span>&nbsp;<span class="ident" id="3759191">nil</span>&nbsp;<span class="op" id="3759195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3759199">panic</span><span class="op" id="3759204">(</span><span class="ident" id="3759205">err</span><span class="op" id="3759208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759214">aead</span><span class="op" id="3759218">,</span>&nbsp;<span class="ident" id="3759220">err</span>&nbsp;<span class="op" id="3759224">:=</span>&nbsp;<span class="ident" id="3759227">cipher</span><span class="op" id="3759233">.</span><span class="ident" id="3759234">NewGCM</span><span class="op" id="3759240">(</span><span class="ident" id="3759241">aes</span><span class="op" id="3759244">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759247">if</span>&nbsp;<span class="ident" id="3759250">err</span>&nbsp;<span class="op" id="3759254">!=</span>&nbsp;<span class="ident" id="3759257">nil</span>&nbsp;<span class="op" id="3759261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3759265">panic</span><span class="op" id="3759270">(</span><span class="ident" id="3759271">err</span><span class="op" id="3759274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3759277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759281">nonce1</span><span class="op" id="3759287">,</span>&nbsp;<span class="ident" id="3759289">nonce2</span>&nbsp;<span class="op" id="3759296">:=</span>&nbsp;<span class="builtinfunc" id="3759299">make</span><span class="op" id="3759303">(</span><span class="op" id="3759304">[</span><span class="op" id="3759305">]</span><span class="builtintype" id="3759306">byte</span><span class="op" id="3759310">,</span>&nbsp;<span class="num" id="3759312">12</span><span class="op" id="3759314">)</span><span class="op" id="3759315">,</span>&nbsp;<span class="builtinfunc" id="3759317">make</span><span class="op" id="3759321">(</span><span class="op" id="3759322">[</span><span class="op" id="3759323">]</span><span class="builtintype" id="3759324">byte</span><span class="op" id="3759328">,</span>&nbsp;<span class="num" id="3759330">12</span><span class="op" id="3759332">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3759335">copy</span><span class="op" id="3759339">(</span><span class="ident" id="3759340">nonce1</span><span class="op" id="3759346">,</span>&nbsp;<span class="ident" id="3759348">fixedNonce</span><span class="op" id="3759358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3759361">copy</span><span class="op" id="3759365">(</span><span class="ident" id="3759366">nonce2</span><span class="op" id="3759372">,</span>&nbsp;<span class="ident" id="3759374">fixedNonce</span><span class="op" id="3759384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759388">return</span>&nbsp;<span class="op" id="3759395">&amp;</span><span class="ident" id="3759396">fixedNonceAEAD</span><span class="op" id="3759410">{</span><span class="ident" id="3759411">nonce1</span><span class="op" id="3759417">,</span>&nbsp;<span class="ident" id="3759419">nonce2</span><span class="op" id="3759425">,</span>&nbsp;<span class="ident" id="3759427">aead</span><span class="op" id="3759431">}</span><br>
<span class="lineno"></span><span class="op" id="3759433">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3759436">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3759497">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="3759575">type</span>&nbsp;<span class="ident" id="3759580">ssl30MAC</span>&nbsp;<span class="keyword" id="3759589">struct</span>&nbsp;<span class="op" id="3759596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759599">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3759603">hash</span><span class="op" id="3759607">.</span><span class="ident" id="3759608">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3759614">key</span>&nbsp;<span class="op" id="3759618">[</span><span class="op" id="3759619">]</span><span class="builtintype" id="3759620">byte</span><br>
<span class="lineno"></span><span class="op" id="3759625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759628">func</span>&nbsp;<span class="op" id="3759633">(</span><span class="ident" id="3759634">s</span>&nbsp;<span class="ident" id="3759636">ssl30MAC</span><span class="op" id="3759644">)</span>&nbsp;<span class="ident" id="3759646">Size</span><span class="op" id="3759650">(</span><span class="op" id="3759651">)</span>&nbsp;<span class="builtintype" id="3759653">int</span>&nbsp;<span class="op" id="3759657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3759660">return</span>&nbsp;<span class="ident" id="3759667">s</span><span class="op" id="3759668">.</span><span class="ident" id="3759669">h</span><span class="op" id="3759670">.</span><span class="ident" id="3759671">Size</span><span class="op" id="3759675">(</span><span class="op" id="3759676">)</span><br>
<span class="lineno">175</span><span class="op" id="3759678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759681">var</span>&nbsp;<span class="ident" id="3759685">ssl30Pad1</span>&nbsp;<span class="op" id="3759695">=</span>&nbsp;<span class="op" id="3759697">[</span><span class="num" id="3759698">48</span><span class="op" id="3759700">]</span><span class="builtintype" id="3759701">byte</span><span class="op" id="3759705">{</span><span class="num" id="3759706">0x36</span><span class="op" id="3759710">,</span>&nbsp;<span class="num" id="3759712">0x36</span><span class="op" id="3759716">,</span>&nbsp;<span class="num" id="3759718">0x36</span><span class="op" id="3759722">,</span>&nbsp;<span class="num" id="3759724">0x36</span><span class="op" id="3759728">,</span>&nbsp;<span class="num" id="3759730">0x36</span><span class="op" id="3759734">,</span>&nbsp;<span class="num" id="3759736">0x36</span><span class="op" id="3759740">,</span>&nbsp;<span class="num" id="3759742">0x36</span><span class="op" id="3759746">,</span>&nbsp;<span class="num" id="3759748">0x36</span><span class="op" id="3759752">,</span>&nbsp;<span class="num" id="3759754">0x36</span><span class="op" id="3759758">,</span>&nbsp;<span class="num" id="3759760">0x36</span><span class="op" id="3759764">,</span>&nbsp;<span class="num" id="3759766">0x36</span><span class="op" id="3759770">,</span>&nbsp;<span class="num" id="3759772">0x36</span><span class="op" id="3759776">,</span>&nbsp;<span class="num" id="3759778">0x36</span><span class="op" id="3759782">,</span>&nbsp;<span class="num" id="3759784">0x36</span><span class="op" id="3759788">,</span>&nbsp;<span class="num" id="3759790">0x36</span><span class="op" id="3759794">,</span>&nbsp;<span class="num" id="3759796">0x36</span><span class="op" id="3759800">,</span>&nbsp;<span class="num" id="3759802">0x36</span><span class="op" id="3759806">,</span>&nbsp;<span class="num" id="3759808">0x36</span><span class="op" id="3759812">,</span>&nbsp;<span class="num" id="3759814">0x36</span><span class="op" id="3759818">,</span>&nbsp;<span class="num" id="3759820">0x36</span><span class="op" id="3759824">,</span>&nbsp;<span class="num" id="3759826">0x36</span><span class="op" id="3759830">,</span>&nbsp;<span class="num" id="3759832">0x36</span><span class="op" id="3759836">,</span>&nbsp;<span class="num" id="3759838">0x36</span><span class="op" id="3759842">,</span>&nbsp;<span class="num" id="3759844">0x36</span><span class="op" id="3759848">,</span>&nbsp;<span class="num" id="3759850">0x36</span><span class="op" id="3759854">,</span>&nbsp;<span class="num" id="3759856">0x36</span><span class="op" id="3759860">,</span>&nbsp;<span class="num" id="3759862">0x36</span><span class="op" id="3759866">,</span>&nbsp;<span class="num" id="3759868">0x36</span><span class="op" id="3759872">,</span>&nbsp;<span class="num" id="3759874">0x36</span><span class="op" id="3759878">,</span>&nbsp;<span class="num" id="3759880">0x36</span><span class="op" id="3759884">,</span>&nbsp;<span class="num" id="3759886">0x36</span><span class="op" id="3759890">,</span>&nbsp;<span class="num" id="3759892">0x36</span><span class="op" id="3759896">,</span>&nbsp;<span class="num" id="3759898">0x36</span><span class="op" id="3759902">,</span>&nbsp;<span class="num" id="3759904">0x36</span><span class="op" id="3759908">,</span>&nbsp;<span class="num" id="3759910">0x36</span><span class="op" id="3759914">,</span>&nbsp;<span class="num" id="3759916">0x36</span><span class="op" id="3759920">,</span>&nbsp;<span class="num" id="3759922">0x36</span><span class="op" id="3759926">,</span>&nbsp;<span class="num" id="3759928">0x36</span><span class="op" id="3759932">,</span>&nbsp;<span class="num" id="3759934">0x36</span><span class="op" id="3759938">,</span>&nbsp;<span class="num" id="3759940">0x36</span><span class="op" id="3759944">,</span>&nbsp;<span class="num" id="3759946">0x36</span><span class="op" id="3759950">,</span>&nbsp;<span class="num" id="3759952">0x36</span><span class="op" id="3759956">,</span>&nbsp;<span class="num" id="3759958">0x36</span><span class="op" id="3759962">,</span>&nbsp;<span class="num" id="3759964">0x36</span><span class="op" id="3759968">,</span>&nbsp;<span class="num" id="3759970">0x36</span><span class="op" id="3759974">,</span>&nbsp;<span class="num" id="3759976">0x36</span><span class="op" id="3759980">,</span>&nbsp;<span class="num" id="3759982">0x36</span><span class="op" id="3759986">,</span>&nbsp;<span class="num" id="3759988">0x36</span><span class="op" id="3759992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3759995">var</span>&nbsp;<span class="ident" id="3759999">ssl30Pad2</span>&nbsp;<span class="op" id="3760009">=</span>&nbsp;<span class="op" id="3760011">[</span><span class="num" id="3760012">48</span><span class="op" id="3760014">]</span><span class="builtintype" id="3760015">byte</span><span class="op" id="3760019">{</span><span class="num" id="3760020">0x5c</span><span class="op" id="3760024">,</span>&nbsp;<span class="num" id="3760026">0x5c</span><span class="op" id="3760030">,</span>&nbsp;<span class="num" id="3760032">0x5c</span><span class="op" id="3760036">,</span>&nbsp;<span class="num" id="3760038">0x5c</span><span class="op" id="3760042">,</span>&nbsp;<span class="num" id="3760044">0x5c</span><span class="op" id="3760048">,</span>&nbsp;<span class="num" id="3760050">0x5c</span><span class="op" id="3760054">,</span>&nbsp;<span class="num" id="3760056">0x5c</span><span class="op" id="3760060">,</span>&nbsp;<span class="num" id="3760062">0x5c</span><span class="op" id="3760066">,</span>&nbsp;<span class="num" id="3760068">0x5c</span><span class="op" id="3760072">,</span>&nbsp;<span class="num" id="3760074">0x5c</span><span class="op" id="3760078">,</span>&nbsp;<span class="num" id="3760080">0x5c</span><span class="op" id="3760084">,</span>&nbsp;<span class="num" id="3760086">0x5c</span><span class="op" id="3760090">,</span>&nbsp;<span class="num" id="3760092">0x5c</span><span class="op" id="3760096">,</span>&nbsp;<span class="num" id="3760098">0x5c</span><span class="op" id="3760102">,</span>&nbsp;<span class="num" id="3760104">0x5c</span><span class="op" id="3760108">,</span>&nbsp;<span class="num" id="3760110">0x5c</span><span class="op" id="3760114">,</span>&nbsp;<span class="num" id="3760116">0x5c</span><span class="op" id="3760120">,</span>&nbsp;<span class="num" id="3760122">0x5c</span><span class="op" id="3760126">,</span>&nbsp;<span class="num" id="3760128">0x5c</span><span class="op" id="3760132">,</span>&nbsp;<span class="num" id="3760134">0x5c</span><span class="op" id="3760138">,</span>&nbsp;<span class="num" id="3760140">0x5c</span><span class="op" id="3760144">,</span>&nbsp;<span class="num" id="3760146">0x5c</span><span class="op" id="3760150">,</span>&nbsp;<span class="num" id="3760152">0x5c</span><span class="op" id="3760156">,</span>&nbsp;<span class="num" id="3760158">0x5c</span><span class="op" id="3760162">,</span>&nbsp;<span class="num" id="3760164">0x5c</span><span class="op" id="3760168">,</span>&nbsp;<span class="num" id="3760170">0x5c</span><span class="op" id="3760174">,</span>&nbsp;<span class="num" id="3760176">0x5c</span><span class="op" id="3760180">,</span>&nbsp;<span class="num" id="3760182">0x5c</span><span class="op" id="3760186">,</span>&nbsp;<span class="num" id="3760188">0x5c</span><span class="op" id="3760192">,</span>&nbsp;<span class="num" id="3760194">0x5c</span><span class="op" id="3760198">,</span>&nbsp;<span class="num" id="3760200">0x5c</span><span class="op" id="3760204">,</span>&nbsp;<span class="num" id="3760206">0x5c</span><span class="op" id="3760210">,</span>&nbsp;<span class="num" id="3760212">0x5c</span><span class="op" id="3760216">,</span>&nbsp;<span class="num" id="3760218">0x5c</span><span class="op" id="3760222">,</span>&nbsp;<span class="num" id="3760224">0x5c</span><span class="op" id="3760228">,</span>&nbsp;<span class="num" id="3760230">0x5c</span><span class="op" id="3760234">,</span>&nbsp;<span class="num" id="3760236">0x5c</span><span class="op" id="3760240">,</span>&nbsp;<span class="num" id="3760242">0x5c</span><span class="op" id="3760246">,</span>&nbsp;<span class="num" id="3760248">0x5c</span><span class="op" id="3760252">,</span>&nbsp;<span class="num" id="3760254">0x5c</span><span class="op" id="3760258">,</span>&nbsp;<span class="num" id="3760260">0x5c</span><span class="op" id="3760264">,</span>&nbsp;<span class="num" id="3760266">0x5c</span><span class="op" id="3760270">,</span>&nbsp;<span class="num" id="3760272">0x5c</span><span class="op" id="3760276">,</span>&nbsp;<span class="num" id="3760278">0x5c</span><span class="op" id="3760282">,</span>&nbsp;<span class="num" id="3760284">0x5c</span><span class="op" id="3760288">,</span>&nbsp;<span class="num" id="3760290">0x5c</span><span class="op" id="3760294">,</span>&nbsp;<span class="num" id="3760296">0x5c</span><span class="op" id="3760300">,</span>&nbsp;<span class="num" id="3760302">0x5c</span><span class="op" id="3760306">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3760309">func</span>&nbsp;<span class="op" id="3760314">(</span><span class="ident" id="3760315">s</span>&nbsp;<span class="ident" id="3760317">ssl30MAC</span><span class="op" id="3760325">)</span>&nbsp;<span class="ident" id="3760327">MAC</span><span class="op" id="3760330">(</span><span class="ident" id="3760331">digestBuf</span><span class="op" id="3760340">,</span>&nbsp;<span class="ident" id="3760342">seq</span><span class="op" id="3760345">,</span>&nbsp;<span class="ident" id="3760347">header</span><span class="op" id="3760353">,</span>&nbsp;<span class="ident" id="3760355">data</span>&nbsp;<span class="op" id="3760360">[</span><span class="op" id="3760361">]</span><span class="builtintype" id="3760362">byte</span><span class="op" id="3760366">)</span>&nbsp;<span class="op" id="3760368">[</span><span class="op" id="3760369">]</span><span class="builtintype" id="3760370">byte</span>&nbsp;<span class="op" id="3760375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760378">padLength</span>&nbsp;<span class="op" id="3760388">:=</span>&nbsp;<span class="num" id="3760391">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760395">if</span>&nbsp;<span class="ident" id="3760398">s</span><span class="op" id="3760399">.</span><span class="ident" id="3760400">h</span><span class="op" id="3760401">.</span><span class="ident" id="3760402">Size</span><span class="op" id="3760406">(</span><span class="op" id="3760407">)</span>&nbsp;<span class="op" id="3760409">==</span>&nbsp;<span class="num" id="3760412">20</span>&nbsp;<span class="op" id="3760415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760419">padLength</span>&nbsp;<span class="op" id="3760429">=</span>&nbsp;<span class="num" id="3760431">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760439">s</span><span class="op" id="3760440">.</span><span class="ident" id="3760441">h</span><span class="op" id="3760442">.</span><span class="ident" id="3760443">Reset</span><span class="op" id="3760448">(</span><span class="op" id="3760449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760452">s</span><span class="op" id="3760453">.</span><span class="ident" id="3760454">h</span><span class="op" id="3760455">.</span><span class="ident" id="3760456">Write</span><span class="op" id="3760461">(</span><span class="ident" id="3760462">s</span><span class="op" id="3760463">.</span><span class="ident" id="3760464">key</span><span class="op" id="3760467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760470">s</span><span class="op" id="3760471">.</span><span class="ident" id="3760472">h</span><span class="op" id="3760473">.</span><span class="ident" id="3760474">Write</span><span class="op" id="3760479">(</span><span class="ident" id="3760480">ssl30Pad1</span><span class="op" id="3760489">[</span><span class="op" id="3760490">:</span><span class="ident" id="3760491">padLength</span><span class="op" id="3760500">]</span><span class="op" id="3760501">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760504">s</span><span class="op" id="3760505">.</span><span class="ident" id="3760506">h</span><span class="op" id="3760507">.</span><span class="ident" id="3760508">Write</span><span class="op" id="3760513">(</span><span class="ident" id="3760514">seq</span><span class="op" id="3760517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760520">s</span><span class="op" id="3760521">.</span><span class="ident" id="3760522">h</span><span class="op" id="3760523">.</span><span class="ident" id="3760524">Write</span><span class="op" id="3760529">(</span><span class="ident" id="3760530">header</span><span class="op" id="3760536">[</span><span class="op" id="3760537">:</span><span class="num" id="3760538">1</span><span class="op" id="3760539">]</span><span class="op" id="3760540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760543">s</span><span class="op" id="3760544">.</span><span class="ident" id="3760545">h</span><span class="op" id="3760546">.</span><span class="ident" id="3760547">Write</span><span class="op" id="3760552">(</span><span class="ident" id="3760553">header</span><span class="op" id="3760559">[</span><span class="num" id="3760560">3</span><span class="op" id="3760561">:</span><span class="num" id="3760562">5</span><span class="op" id="3760563">]</span><span class="op" id="3760564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760567">s</span><span class="op" id="3760568">.</span><span class="ident" id="3760569">h</span><span class="op" id="3760570">.</span><span class="ident" id="3760571">Write</span><span class="op" id="3760576">(</span><span class="ident" id="3760577">data</span><span class="op" id="3760581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760584">digestBuf</span>&nbsp;<span class="op" id="3760594">=</span>&nbsp;<span class="ident" id="3760596">s</span><span class="op" id="3760597">.</span><span class="ident" id="3760598">h</span><span class="op" id="3760599">.</span><span class="ident" id="3760600">Sum</span><span class="op" id="3760603">(</span><span class="ident" id="3760604">digestBuf</span><span class="op" id="3760613">[</span><span class="op" id="3760614">:</span><span class="num" id="3760615">0</span><span class="op" id="3760616">]</span><span class="op" id="3760617">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760621">s</span><span class="op" id="3760622">.</span><span class="ident" id="3760623">h</span><span class="op" id="3760624">.</span><span class="ident" id="3760625">Reset</span><span class="op" id="3760630">(</span><span class="op" id="3760631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760634">s</span><span class="op" id="3760635">.</span><span class="ident" id="3760636">h</span><span class="op" id="3760637">.</span><span class="ident" id="3760638">Write</span><span class="op" id="3760643">(</span><span class="ident" id="3760644">s</span><span class="op" id="3760645">.</span><span class="ident" id="3760646">key</span><span class="op" id="3760649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760652">s</span><span class="op" id="3760653">.</span><span class="ident" id="3760654">h</span><span class="op" id="3760655">.</span><span class="ident" id="3760656">Write</span><span class="op" id="3760661">(</span><span class="ident" id="3760662">ssl30Pad2</span><span class="op" id="3760671">[</span><span class="op" id="3760672">:</span><span class="ident" id="3760673">padLength</span><span class="op" id="3760682">]</span><span class="op" id="3760683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760686">s</span><span class="op" id="3760687">.</span><span class="ident" id="3760688">h</span><span class="op" id="3760689">.</span><span class="ident" id="3760690">Write</span><span class="op" id="3760695">(</span><span class="ident" id="3760696">digestBuf</span><span class="op" id="3760705">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760708">return</span>&nbsp;<span class="ident" id="3760715">s</span><span class="op" id="3760716">.</span><span class="ident" id="3760717">h</span><span class="op" id="3760718">.</span><span class="ident" id="3760719">Sum</span><span class="op" id="3760722">(</span><span class="ident" id="3760723">digestBuf</span><span class="op" id="3760732">[</span><span class="op" id="3760733">:</span><span class="num" id="3760734">0</span><span class="op" id="3760735">]</span><span class="op" id="3760736">)</span><br>
<span class="lineno"></span><span class="op" id="3760738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3760741">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3760815">type</span>&nbsp;<span class="ident" id="3760820">tls10MAC</span>&nbsp;<span class="keyword" id="3760829">struct</span>&nbsp;<span class="op" id="3760836">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760839">h</span>&nbsp;<span class="ident" id="3760841">hash</span><span class="op" id="3760845">.</span><span class="ident" id="3760846">Hash</span><br>
<span class="lineno"></span><span class="op" id="3760851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3760854">func</span>&nbsp;<span class="op" id="3760859">(</span><span class="ident" id="3760860">s</span>&nbsp;<span class="ident" id="3760862">tls10MAC</span><span class="op" id="3760870">)</span>&nbsp;<span class="ident" id="3760872">Size</span><span class="op" id="3760876">(</span><span class="op" id="3760877">)</span>&nbsp;<span class="builtintype" id="3760879">int</span>&nbsp;<span class="op" id="3760883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760886">return</span>&nbsp;<span class="ident" id="3760893">s</span><span class="op" id="3760894">.</span><span class="ident" id="3760895">h</span><span class="op" id="3760896">.</span><span class="ident" id="3760897">Size</span><span class="op" id="3760901">(</span><span class="op" id="3760902">)</span><br>
<span class="lineno">210</span><span class="op" id="3760904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3760907">func</span>&nbsp;<span class="op" id="3760912">(</span><span class="ident" id="3760913">s</span>&nbsp;<span class="ident" id="3760915">tls10MAC</span><span class="op" id="3760923">)</span>&nbsp;<span class="ident" id="3760925">MAC</span><span class="op" id="3760928">(</span><span class="ident" id="3760929">digestBuf</span><span class="op" id="3760938">,</span>&nbsp;<span class="ident" id="3760940">seq</span><span class="op" id="3760943">,</span>&nbsp;<span class="ident" id="3760945">header</span><span class="op" id="3760951">,</span>&nbsp;<span class="ident" id="3760953">data</span>&nbsp;<span class="op" id="3760958">[</span><span class="op" id="3760959">]</span><span class="builtintype" id="3760960">byte</span><span class="op" id="3760964">)</span>&nbsp;<span class="op" id="3760966">[</span><span class="op" id="3760967">]</span><span class="builtintype" id="3760968">byte</span>&nbsp;<span class="op" id="3760973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760976">s</span><span class="op" id="3760977">.</span><span class="ident" id="3760978">h</span><span class="op" id="3760979">.</span><span class="ident" id="3760980">Reset</span><span class="op" id="3760985">(</span><span class="op" id="3760986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760989">s</span><span class="op" id="3760990">.</span><span class="ident" id="3760991">h</span><span class="op" id="3760992">.</span><span class="ident" id="3760993">Write</span><span class="op" id="3760998">(</span><span class="ident" id="3760999">seq</span><span class="op" id="3761002">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761005">s</span><span class="op" id="3761006">.</span><span class="ident" id="3761007">h</span><span class="op" id="3761008">.</span><span class="ident" id="3761009">Write</span><span class="op" id="3761014">(</span><span class="ident" id="3761015">header</span><span class="op" id="3761021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761024">s</span><span class="op" id="3761025">.</span><span class="ident" id="3761026">h</span><span class="op" id="3761027">.</span><span class="ident" id="3761028">Write</span><span class="op" id="3761033">(</span><span class="ident" id="3761034">data</span><span class="op" id="3761038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761041">return</span>&nbsp;<span class="ident" id="3761048">s</span><span class="op" id="3761049">.</span><span class="ident" id="3761050">h</span><span class="op" id="3761051">.</span><span class="ident" id="3761052">Sum</span><span class="op" id="3761055">(</span><span class="ident" id="3761056">digestBuf</span><span class="op" id="3761065">[</span><span class="op" id="3761066">:</span><span class="num" id="3761067">0</span><span class="op" id="3761068">]</span><span class="op" id="3761069">)</span><br>
<span class="lineno"></span><span class="op" id="3761071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3761074">func</span>&nbsp;<span class="ident" id="3761079">rsaKA</span><span class="op" id="3761084">(</span><span class="ident" id="3761085">version</span>&nbsp;<span class="builtintype" id="3761093">uint16</span><span class="op" id="3761099">)</span>&nbsp;<span class="ident" id="3761101">keyAgreement</span>&nbsp;<span class="op" id="3761114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761117">return</span>&nbsp;<span class="ident" id="3761124">rsaKeyAgreement</span><span class="op" id="3761139">{</span><span class="op" id="3761140">}</span><br>
<span class="lineno"></span><span class="op" id="3761142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3761145">func</span>&nbsp;<span class="ident" id="3761150">ecdheECDSAKA</span><span class="op" id="3761162">(</span><span class="ident" id="3761163">version</span>&nbsp;<span class="builtintype" id="3761171">uint16</span><span class="op" id="3761177">)</span>&nbsp;<span class="ident" id="3761179">keyAgreement</span>&nbsp;<span class="op" id="3761192">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761195">return</span>&nbsp;<span class="op" id="3761202">&amp;</span><span class="ident" id="3761203">ecdheKeyAgreement</span><span class="op" id="3761220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761224">sigType</span><span class="op" id="3761231">:</span>&nbsp;<span class="ident" id="3761233">signatureECDSA</span><span class="op" id="3761247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761251">version</span><span class="op" id="3761258">:</span>&nbsp;<span class="ident" id="3761260">version</span><span class="op" id="3761267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761270">}</span><br>
<span class="lineno"></span><span class="op" id="3761272">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3761275">func</span>&nbsp;<span class="ident" id="3761280">ecdheRSAKA</span><span class="op" id="3761290">(</span><span class="ident" id="3761291">version</span>&nbsp;<span class="builtintype" id="3761299">uint16</span><span class="op" id="3761305">)</span>&nbsp;<span class="ident" id="3761307">keyAgreement</span>&nbsp;<span class="op" id="3761320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761323">return</span>&nbsp;<span class="op" id="3761330">&amp;</span><span class="ident" id="3761331">ecdheKeyAgreement</span><span class="op" id="3761348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761352">sigType</span><span class="op" id="3761359">:</span>&nbsp;<span class="ident" id="3761361">signatureRSA</span><span class="op" id="3761373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761377">version</span><span class="op" id="3761384">:</span>&nbsp;<span class="ident" id="3761386">version</span><span class="op" id="3761393">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761396">}</span><br>
<span class="lineno"></span><span class="op" id="3761398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3761401">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="3761470">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="3761520">func</span>&nbsp;<span class="ident" id="3761525">mutualCipherSuite</span><span class="op" id="3761542">(</span><span class="ident" id="3761543">have</span>&nbsp;<span class="op" id="3761548">[</span><span class="op" id="3761549">]</span><span class="builtintype" id="3761550">uint16</span><span class="op" id="3761556">,</span>&nbsp;<span class="ident" id="3761558">want</span>&nbsp;<span class="builtintype" id="3761563">uint16</span><span class="op" id="3761569">)</span>&nbsp;<span class="op" id="3761571">*</span><span class="ident" id="3761572">cipherSuite</span>&nbsp;<span class="op" id="3761584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761587">for</span>&nbsp;<span class="ident" id="3761591">_</span><span class="op" id="3761592">,</span>&nbsp;<span class="ident" id="3761594">id</span>&nbsp;<span class="op" id="3761597">:=</span>&nbsp;<span class="keyword" id="3761600">range</span>&nbsp;<span class="ident" id="3761606">have</span>&nbsp;<span class="op" id="3761611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761615">if</span>&nbsp;<span class="ident" id="3761618">id</span>&nbsp;<span class="op" id="3761621">==</span>&nbsp;<span class="ident" id="3761624">want</span>&nbsp;<span class="op" id="3761629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761634">for</span>&nbsp;<span class="ident" id="3761638">_</span><span class="op" id="3761639">,</span>&nbsp;<span class="ident" id="3761641">suite</span>&nbsp;<span class="op" id="3761647">:=</span>&nbsp;<span class="keyword" id="3761650">range</span>&nbsp;<span class="ident" id="3761656">cipherSuites</span>&nbsp;<span class="op" id="3761669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761675">if</span>&nbsp;<span class="ident" id="3761678">suite</span><span class="op" id="3761683">.</span><span class="ident" id="3761684">id</span>&nbsp;<span class="op" id="3761687">==</span>&nbsp;<span class="ident" id="3761690">want</span>&nbsp;<span class="op" id="3761695">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761702">return</span>&nbsp;<span class="ident" id="3761709">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761729">return</span>&nbsp;<span class="ident" id="3761736">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761742">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761748">return</span>&nbsp;<span class="ident" id="3761755">nil</span><br>
<span class="lineno"></span><span class="op" id="3761759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3761762">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="3761817">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="3761886">const</span>&nbsp;<span class="op" id="3761892">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761895">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3761935">uint16</span>&nbsp;<span class="op" id="3761942">=</span>&nbsp;<span class="num" id="3761944">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761952">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3761992">uint16</span>&nbsp;<span class="op" id="3761999">=</span>&nbsp;<span class="num" id="3762001">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762009">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762049">uint16</span>&nbsp;<span class="op" id="3762056">=</span>&nbsp;<span class="num" id="3762058">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762066">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762106">uint16</span>&nbsp;<span class="op" id="3762113">=</span>&nbsp;<span class="num" id="3762115">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762123">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762163">uint16</span>&nbsp;<span class="op" id="3762170">=</span>&nbsp;<span class="num" id="3762172">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762180">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762220">uint16</span>&nbsp;<span class="op" id="3762227">=</span>&nbsp;<span class="num" id="3762229">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762237">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762277">uint16</span>&nbsp;<span class="op" id="3762284">=</span>&nbsp;<span class="num" id="3762286">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762294">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762334">uint16</span>&nbsp;<span class="op" id="3762341">=</span>&nbsp;<span class="num" id="3762343">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762351">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762391">uint16</span>&nbsp;<span class="op" id="3762398">=</span>&nbsp;<span class="num" id="3762400">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762408">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762448">uint16</span>&nbsp;<span class="op" id="3762455">=</span>&nbsp;<span class="num" id="3762457">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762465">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762505">uint16</span>&nbsp;<span class="op" id="3762512">=</span>&nbsp;<span class="num" id="3762514">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762522">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3762562">uint16</span>&nbsp;<span class="op" id="3762569">=</span>&nbsp;<span class="num" id="3762571">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762579">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="3762619">uint16</span>&nbsp;<span class="op" id="3762626">=</span>&nbsp;<span class="num" id="3762628">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762637">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762706">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3762757">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762823">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="3762841">uint16</span>&nbsp;<span class="op" id="3762848">=</span>&nbsp;<span class="num" id="3762850">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="3762857">)</span>
</div>
</body>
</html>
