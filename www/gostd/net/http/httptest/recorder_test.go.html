<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6930697">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6930752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6930806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6930857">package</span>&nbsp;<span class="ident" id="6930865">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6930875">import</span>&nbsp;<span class="op" id="6930882">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6930885">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6930892">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6930904">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6930914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6930917">func</span>&nbsp;<span class="ident" id="6930922">TestRecorder</span><span class="op" id="6930934">(</span><span class="ident" id="6930935">t</span>&nbsp;<span class="op" id="6930937">*</span><span class="ident" id="6930938">testing</span><span class="op" id="6930945">.</span><span class="ident" id="6930946">T</span><span class="op" id="6930947">)</span>&nbsp;<span class="op" id="6930949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930952">type</span>&nbsp;<span class="ident" id="6930957">checkFunc</span>&nbsp;<span class="keyword" id="6930967">func</span><span class="op" id="6930971">(</span><span class="op" id="6930972">*</span><span class="ident" id="6930973">ResponseRecorder</span><span class="op" id="6930989">)</span>&nbsp;<span class="builtintype" id="6930991">error</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930998">check</span>&nbsp;<span class="op" id="6931004">:=</span>&nbsp;<span class="keyword" id="6931007">func</span><span class="op" id="6931011">(</span><span class="ident" id="6931012">fns</span>&nbsp;<span class="op" id="6931016">...</span><span class="ident" id="6931019">checkFunc</span><span class="op" id="6931028">)</span>&nbsp;<span class="op" id="6931030">[</span><span class="op" id="6931031">]</span><span class="ident" id="6931032">checkFunc</span>&nbsp;<span class="op" id="6931042">{</span>&nbsp;<span class="keyword" id="6931044">return</span>&nbsp;<span class="ident" id="6931051">fns</span>&nbsp;<span class="op" id="6931055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931059">hasStatus</span>&nbsp;<span class="op" id="6931069">:=</span>&nbsp;<span class="keyword" id="6931072">func</span><span class="op" id="6931076">(</span><span class="ident" id="6931077">wantCode</span>&nbsp;<span class="builtintype" id="6931086">int</span><span class="op" id="6931089">)</span>&nbsp;<span class="ident" id="6931091">checkFunc</span>&nbsp;<span class="op" id="6931101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931105">return</span>&nbsp;<span class="keyword" id="6931112">func</span><span class="op" id="6931116">(</span><span class="ident" id="6931117">rec</span>&nbsp;<span class="op" id="6931121">*</span><span class="ident" id="6931122">ResponseRecorder</span><span class="op" id="6931138">)</span>&nbsp;<span class="builtintype" id="6931140">error</span>&nbsp;<span class="op" id="6931146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931151">if</span>&nbsp;<span class="ident" id="6931154">rec</span><span class="op" id="6931157">.</span><span class="ident" id="6931158">Code</span>&nbsp;<span class="op" id="6931163">!=</span>&nbsp;<span class="ident" id="6931166">wantCode</span>&nbsp;<span class="op" id="6931175">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931181">return</span>&nbsp;<span class="ident" id="6931188">fmt</span><span class="op" id="6931191">.</span><span class="ident" id="6931192">Errorf</span><span class="op" id="6931198">(</span><span class="string" id="6931199">&#34;Status&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6931221">,</span>&nbsp;<span class="ident" id="6931223">rec</span><span class="op" id="6931226">.</span><span class="ident" id="6931227">Code</span><span class="op" id="6931231">,</span>&nbsp;<span class="ident" id="6931233">wantCode</span><span class="op" id="6931241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931251">return</span>&nbsp;<span class="ident" id="6931258">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931267">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931270">hasContents</span>&nbsp;<span class="op" id="6931282">:=</span>&nbsp;<span class="keyword" id="6931285">func</span><span class="op" id="6931289">(</span><span class="ident" id="6931290">want</span>&nbsp;<span class="builtintype" id="6931295">string</span><span class="op" id="6931301">)</span>&nbsp;<span class="ident" id="6931303">checkFunc</span>&nbsp;<span class="op" id="6931313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931317">return</span>&nbsp;<span class="keyword" id="6931324">func</span><span class="op" id="6931328">(</span><span class="ident" id="6931329">rec</span>&nbsp;<span class="op" id="6931333">*</span><span class="ident" id="6931334">ResponseRecorder</span><span class="op" id="6931350">)</span>&nbsp;<span class="builtintype" id="6931352">error</span>&nbsp;<span class="op" id="6931358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931363">if</span>&nbsp;<span class="ident" id="6931366">rec</span><span class="op" id="6931369">.</span><span class="ident" id="6931370">Body</span><span class="op" id="6931374">.</span><span class="ident" id="6931375">String</span><span class="op" id="6931381">(</span><span class="op" id="6931382">)</span>&nbsp;<span class="op" id="6931384">!=</span>&nbsp;<span class="ident" id="6931387">want</span>&nbsp;<span class="op" id="6931392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931398">return</span>&nbsp;<span class="ident" id="6931405">fmt</span><span class="op" id="6931408">.</span><span class="ident" id="6931409">Errorf</span><span class="op" id="6931415">(</span><span class="string" id="6931416">&#34;wrote&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6931437">,</span>&nbsp;<span class="ident" id="6931439">rec</span><span class="op" id="6931442">.</span><span class="ident" id="6931443">Body</span><span class="op" id="6931447">.</span><span class="ident" id="6931448">String</span><span class="op" id="6931454">(</span><span class="op" id="6931455">)</span><span class="op" id="6931456">,</span>&nbsp;<span class="ident" id="6931458">want</span><span class="op" id="6931462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931467">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931472">return</span>&nbsp;<span class="ident" id="6931479">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931491">hasFlush</span>&nbsp;<span class="op" id="6931500">:=</span>&nbsp;<span class="keyword" id="6931503">func</span><span class="op" id="6931507">(</span><span class="ident" id="6931508">want</span>&nbsp;<span class="builtintype" id="6931513">bool</span><span class="op" id="6931517">)</span>&nbsp;<span class="ident" id="6931519">checkFunc</span>&nbsp;<span class="op" id="6931529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931533">return</span>&nbsp;<span class="keyword" id="6931540">func</span><span class="op" id="6931544">(</span><span class="ident" id="6931545">rec</span>&nbsp;<span class="op" id="6931549">*</span><span class="ident" id="6931550">ResponseRecorder</span><span class="op" id="6931566">)</span>&nbsp;<span class="builtintype" id="6931568">error</span>&nbsp;<span class="op" id="6931574">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931579">if</span>&nbsp;<span class="ident" id="6931582">rec</span><span class="op" id="6931585">.</span><span class="ident" id="6931586">Flushed</span>&nbsp;<span class="op" id="6931594">!=</span>&nbsp;<span class="ident" id="6931597">want</span>&nbsp;<span class="op" id="6931602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931608">return</span>&nbsp;<span class="ident" id="6931615">fmt</span><span class="op" id="6931618">.</span><span class="ident" id="6931619">Errorf</span><span class="op" id="6931625">(</span><span class="string" id="6931626">&#34;Flushed&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6931649">,</span>&nbsp;<span class="ident" id="6931651">rec</span><span class="op" id="6931654">.</span><span class="ident" id="6931655">Flushed</span><span class="op" id="6931662">,</span>&nbsp;<span class="ident" id="6931664">want</span><span class="op" id="6931668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931678">return</span>&nbsp;<span class="ident" id="6931685">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931691">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931698">tests</span>&nbsp;<span class="op" id="6931704">:=</span>&nbsp;<span class="op" id="6931707">[</span><span class="op" id="6931708">]</span><span class="keyword" id="6931709">struct</span>&nbsp;<span class="op" id="6931716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931720">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6931727">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931736">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6931743">func</span><span class="op" id="6931747">(</span><span class="ident" id="6931748">w</span>&nbsp;<span class="ident" id="6931750">http</span><span class="op" id="6931754">.</span><span class="ident" id="6931755">ResponseWriter</span><span class="op" id="6931769">,</span>&nbsp;<span class="ident" id="6931771">r</span>&nbsp;<span class="op" id="6931773">*</span><span class="ident" id="6931774">http</span><span class="op" id="6931778">.</span><span class="ident" id="6931779">Request</span><span class="op" id="6931786">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931790">checks</span>&nbsp;<span class="op" id="6931797">[</span><span class="op" id="6931798">]</span><span class="ident" id="6931799">checkFunc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931810">}</span><span class="op" id="6931811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6931820">&#34;200&nbsp;default&#34;</span><span class="op" id="6931833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931838">func</span><span class="op" id="6931842">(</span><span class="ident" id="6931843">w</span>&nbsp;<span class="ident" id="6931845">http</span><span class="op" id="6931849">.</span><span class="ident" id="6931850">ResponseWriter</span><span class="op" id="6931864">,</span>&nbsp;<span class="ident" id="6931866">r</span>&nbsp;<span class="op" id="6931868">*</span><span class="ident" id="6931869">http</span><span class="op" id="6931873">.</span><span class="ident" id="6931874">Request</span><span class="op" id="6931881">)</span>&nbsp;<span class="op" id="6931883">{</span><span class="op" id="6931884">}</span><span class="op" id="6931885">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931890">check</span><span class="op" id="6931895">(</span><span class="ident" id="6931896">hasStatus</span><span class="op" id="6931905">(</span><span class="num" id="6931906">200</span><span class="op" id="6931909">)</span><span class="op" id="6931910">,</span>&nbsp;<span class="ident" id="6931912">hasContents</span><span class="op" id="6931923">(</span><span class="string" id="6931924">&#34;&#34;</span><span class="op" id="6931926">)</span><span class="op" id="6931927">)</span><span class="op" id="6931928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931932">}</span><span class="op" id="6931933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6931942">&#34;first&nbsp;code&nbsp;only&#34;</span><span class="op" id="6931959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931964">func</span><span class="op" id="6931968">(</span><span class="ident" id="6931969">w</span>&nbsp;<span class="ident" id="6931971">http</span><span class="op" id="6931975">.</span><span class="ident" id="6931976">ResponseWriter</span><span class="op" id="6931990">,</span>&nbsp;<span class="ident" id="6931992">r</span>&nbsp;<span class="op" id="6931994">*</span><span class="ident" id="6931995">http</span><span class="op" id="6931999">.</span><span class="ident" id="6932000">Request</span><span class="op" id="6932007">)</span>&nbsp;<span class="op" id="6932009">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932015">w</span><span class="op" id="6932016">.</span><span class="ident" id="6932017">WriteHeader</span><span class="op" id="6932028">(</span><span class="num" id="6932029">201</span><span class="op" id="6932032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932038">w</span><span class="op" id="6932039">.</span><span class="ident" id="6932040">WriteHeader</span><span class="op" id="6932051">(</span><span class="num" id="6932052">202</span><span class="op" id="6932055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932061">w</span><span class="op" id="6932062">.</span><span class="ident" id="6932063">Write</span><span class="op" id="6932068">(</span><span class="op" id="6932069">[</span><span class="op" id="6932070">]</span><span class="builtintype" id="6932071">byte</span><span class="op" id="6932075">(</span><span class="string" id="6932076">&#34;hi&#34;</span><span class="op" id="6932080">)</span><span class="op" id="6932081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932086">}</span><span class="op" id="6932087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932092">check</span><span class="op" id="6932097">(</span><span class="ident" id="6932098">hasStatus</span><span class="op" id="6932107">(</span><span class="num" id="6932108">201</span><span class="op" id="6932111">)</span><span class="op" id="6932112">,</span>&nbsp;<span class="ident" id="6932114">hasContents</span><span class="op" id="6932125">(</span><span class="string" id="6932126">&#34;hi&#34;</span><span class="op" id="6932130">)</span><span class="op" id="6932131">)</span><span class="op" id="6932132">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932136">}</span><span class="op" id="6932137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6932146">&#34;write&nbsp;sends&nbsp;200&#34;</span><span class="op" id="6932163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932168">func</span><span class="op" id="6932172">(</span><span class="ident" id="6932173">w</span>&nbsp;<span class="ident" id="6932175">http</span><span class="op" id="6932179">.</span><span class="ident" id="6932180">ResponseWriter</span><span class="op" id="6932194">,</span>&nbsp;<span class="ident" id="6932196">r</span>&nbsp;<span class="op" id="6932198">*</span><span class="ident" id="6932199">http</span><span class="op" id="6932203">.</span><span class="ident" id="6932204">Request</span><span class="op" id="6932211">)</span>&nbsp;<span class="op" id="6932213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932219">w</span><span class="op" id="6932220">.</span><span class="ident" id="6932221">Write</span><span class="op" id="6932226">(</span><span class="op" id="6932227">[</span><span class="op" id="6932228">]</span><span class="builtintype" id="6932229">byte</span><span class="op" id="6932233">(</span><span class="string" id="6932234">&#34;hi&nbsp;first&#34;</span><span class="op" id="6932244">)</span><span class="op" id="6932245">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932251">w</span><span class="op" id="6932252">.</span><span class="ident" id="6932253">WriteHeader</span><span class="op" id="6932264">(</span><span class="num" id="6932265">201</span><span class="op" id="6932268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932274">w</span><span class="op" id="6932275">.</span><span class="ident" id="6932276">WriteHeader</span><span class="op" id="6932287">(</span><span class="num" id="6932288">202</span><span class="op" id="6932291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932296">}</span><span class="op" id="6932297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932302">check</span><span class="op" id="6932307">(</span><span class="ident" id="6932308">hasStatus</span><span class="op" id="6932317">(</span><span class="num" id="6932318">200</span><span class="op" id="6932321">)</span><span class="op" id="6932322">,</span>&nbsp;<span class="ident" id="6932324">hasContents</span><span class="op" id="6932335">(</span><span class="string" id="6932336">&#34;hi&nbsp;first&#34;</span><span class="op" id="6932346">)</span><span class="op" id="6932347">,</span>&nbsp;<span class="ident" id="6932349">hasFlush</span><span class="op" id="6932357">(</span><span class="builtintype" id="6932358">false</span><span class="op" id="6932363">)</span><span class="op" id="6932364">)</span><span class="op" id="6932365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932369">}</span><span class="op" id="6932370">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6932379">&#34;flush&#34;</span><span class="op" id="6932386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932391">func</span><span class="op" id="6932395">(</span><span class="ident" id="6932396">w</span>&nbsp;<span class="ident" id="6932398">http</span><span class="op" id="6932402">.</span><span class="ident" id="6932403">ResponseWriter</span><span class="op" id="6932417">,</span>&nbsp;<span class="ident" id="6932419">r</span>&nbsp;<span class="op" id="6932421">*</span><span class="ident" id="6932422">http</span><span class="op" id="6932426">.</span><span class="ident" id="6932427">Request</span><span class="op" id="6932434">)</span>&nbsp;<span class="op" id="6932436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932442">w</span><span class="op" id="6932443">.</span><span class="op" id="6932444">(</span><span class="ident" id="6932445">http</span><span class="op" id="6932449">.</span><span class="ident" id="6932450">Flusher</span><span class="op" id="6932457">)</span><span class="op" id="6932458">.</span><span class="ident" id="6932459">Flush</span><span class="op" id="6932464">(</span><span class="op" id="6932465">)</span>&nbsp;<span class="comment" id="6932467">//&nbsp;also&nbsp;sends&nbsp;a&nbsp;200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932491">w</span><span class="op" id="6932492">.</span><span class="ident" id="6932493">WriteHeader</span><span class="op" id="6932504">(</span><span class="num" id="6932505">201</span><span class="op" id="6932508">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932513">}</span><span class="op" id="6932514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932519">check</span><span class="op" id="6932524">(</span><span class="ident" id="6932525">hasStatus</span><span class="op" id="6932534">(</span><span class="num" id="6932535">200</span><span class="op" id="6932538">)</span><span class="op" id="6932539">,</span>&nbsp;<span class="ident" id="6932541">hasFlush</span><span class="op" id="6932549">(</span><span class="builtintype" id="6932550">true</span><span class="op" id="6932554">)</span><span class="op" id="6932555">)</span><span class="op" id="6932556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932560">}</span><span class="op" id="6932561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932567">r</span><span class="op" id="6932568">,</span>&nbsp;<span class="ident" id="6932570">_</span>&nbsp;<span class="op" id="6932572">:=</span>&nbsp;<span class="ident" id="6932575">http</span><span class="op" id="6932579">.</span><span class="ident" id="6932580">NewRequest</span><span class="op" id="6932590">(</span><span class="string" id="6932591">&#34;GET&#34;</span><span class="op" id="6932596">,</span>&nbsp;<span class="string" id="6932598">&#34;http://foo.com/&#34;</span><span class="op" id="6932615">,</span>&nbsp;<span class="ident" id="6932617">nil</span><span class="op" id="6932620">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932623">for</span>&nbsp;<span class="ident" id="6932627">_</span><span class="op" id="6932628">,</span>&nbsp;<span class="ident" id="6932630">tt</span>&nbsp;<span class="op" id="6932633">:=</span>&nbsp;<span class="keyword" id="6932636">range</span>&nbsp;<span class="ident" id="6932642">tests</span>&nbsp;<span class="op" id="6932648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932652">h</span>&nbsp;<span class="op" id="6932654">:=</span>&nbsp;<span class="ident" id="6932657">http</span><span class="op" id="6932661">.</span><span class="ident" id="6932662">HandlerFunc</span><span class="op" id="6932673">(</span><span class="ident" id="6932674">tt</span><span class="op" id="6932676">.</span><span class="ident" id="6932677">h</span><span class="op" id="6932678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932682">rec</span>&nbsp;<span class="op" id="6932686">:=</span>&nbsp;<span class="ident" id="6932689">NewRecorder</span><span class="op" id="6932700">(</span><span class="op" id="6932701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932705">h</span><span class="op" id="6932706">.</span><span class="ident" id="6932707">ServeHTTP</span><span class="op" id="6932716">(</span><span class="ident" id="6932717">rec</span><span class="op" id="6932720">,</span>&nbsp;<span class="ident" id="6932722">r</span><span class="op" id="6932723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932727">for</span>&nbsp;<span class="ident" id="6932731">_</span><span class="op" id="6932732">,</span>&nbsp;<span class="ident" id="6932734">check</span>&nbsp;<span class="op" id="6932740">:=</span>&nbsp;<span class="keyword" id="6932743">range</span>&nbsp;<span class="ident" id="6932749">tt</span><span class="op" id="6932751">.</span><span class="ident" id="6932752">checks</span>&nbsp;<span class="op" id="6932759">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932764">if</span>&nbsp;<span class="ident" id="6932767">err</span>&nbsp;<span class="op" id="6932771">:=</span>&nbsp;<span class="ident" id="6932774">check</span><span class="op" id="6932779">(</span><span class="ident" id="6932780">rec</span><span class="op" id="6932783">)</span><span class="op" id="6932784">;</span>&nbsp;<span class="ident" id="6932786">err</span>&nbsp;<span class="op" id="6932790">!=</span>&nbsp;<span class="ident" id="6932793">nil</span>&nbsp;<span class="op" id="6932797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932803">t</span><span class="op" id="6932804">.</span><span class="ident" id="6932805">Errorf</span><span class="op" id="6932811">(</span><span class="string" id="6932812">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="6932820">,</span>&nbsp;<span class="ident" id="6932822">tt</span><span class="op" id="6932824">.</span><span class="ident" id="6932825">name</span><span class="op" id="6932829">,</span>&nbsp;<span class="ident" id="6932831">err</span><span class="op" id="6932834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932846">}</span><br>
<span class="lineno">90</span><span class="op" id="6932848">}</span>
</div>
</body>
</html>
