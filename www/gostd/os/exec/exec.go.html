<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5616243">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5616298">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5616352">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5616403">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5616479">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5616553">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5616569">package</span>&nbsp;<span class="ident" id="5616577">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5616583">import</span>&nbsp;<span class="op" id="5616590">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616593">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616602">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616612">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616618">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616624">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616641">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616652">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616663">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616674">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5616682">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5616692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5616695">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5616760">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5616789">type</span>&nbsp;<span class="ident" id="5616794">Error</span>&nbsp;<span class="keyword" id="5616800">struct</span>&nbsp;<span class="op" id="5616807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616810">Name</span>&nbsp;<span class="builtintype" id="5616815">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616823">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5616828">error</span><br>
<span class="lineno"></span><span class="op" id="5616834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5616837">func</span>&nbsp;<span class="op" id="5616842">(</span><span class="ident" id="5616843">e</span>&nbsp;<span class="op" id="5616845">*</span><span class="ident" id="5616846">Error</span><span class="op" id="5616851">)</span>&nbsp;<span class="ident" id="5616853">Error</span><span class="op" id="5616858">(</span><span class="op" id="5616859">)</span>&nbsp;<span class="builtintype" id="5616861">string</span>&nbsp;<span class="op" id="5616868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5616871">return</span>&nbsp;<span class="string" id="5616878">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5616887">+</span>&nbsp;<span class="ident" id="5616889">strconv</span><span class="op" id="5616896">.</span><span class="ident" id="5616897">Quote</span><span class="op" id="5616902">(</span><span class="ident" id="5616903">e</span><span class="op" id="5616904">.</span><span class="ident" id="5616905">Name</span><span class="op" id="5616909">)</span>&nbsp;<span class="op" id="5616911">+</span>&nbsp;<span class="string" id="5616913">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5616918">+</span>&nbsp;<span class="ident" id="5616920">e</span><span class="op" id="5616921">.</span><span class="ident" id="5616922">Err</span><span class="op" id="5616925">.</span><span class="ident" id="5616926">Error</span><span class="op" id="5616931">(</span><span class="op" id="5616932">)</span><br>
<span class="lineno"></span><span class="op" id="5616934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5616937">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5616998">type</span>&nbsp;<span class="ident" id="5617003">Cmd</span>&nbsp;<span class="keyword" id="5617007">struct</span>&nbsp;<span class="op" id="5617014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617017">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617061">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617065">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617123">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617180">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5617192">Path</span>&nbsp;<span class="builtintype" id="5617197">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617206">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617279">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617335">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617339">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5617406">Args</span>&nbsp;<span class="op" id="5617411">[</span><span class="op" id="5617412">]</span><span class="builtintype" id="5617413">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617422">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617472">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5617535">Env</span>&nbsp;<span class="op" id="5617539">[</span><span class="op" id="5617540">]</span><span class="builtintype" id="5617541">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617550">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617606">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617666">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5617707">Dir</span>&nbsp;<span class="builtintype" id="5617711">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617720">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617770">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617844">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617915">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5617942">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618004">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618073">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618147">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618213">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5618289">Stdin</span>&nbsp;<span class="ident" id="5618295">io</span><span class="op" id="5618297">.</span><span class="ident" id="5618298">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618307">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618378">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618382">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618451">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618488">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618492">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618550">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5618591">Stdout</span>&nbsp;<span class="ident" id="5618598">io</span><span class="op" id="5618600">.</span><span class="ident" id="5618601">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5618609">Stderr</span>&nbsp;<span class="ident" id="5618616">io</span><span class="op" id="5618618">.</span><span class="ident" id="5618619">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618628">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618698">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618771">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618840">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618844">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618919">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5618952">ExtraFiles</span>&nbsp;<span class="op" id="5618963">[</span><span class="op" id="5618964">]</span><span class="op" id="5618965">*</span><span class="ident" id="5618966">os</span><span class="op" id="5618968">.</span><span class="ident" id="5618969">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5618976">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5619046">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619115">SysProcAttr</span>&nbsp;<span class="op" id="5619127">*</span><span class="ident" id="5619128">syscall</span><span class="op" id="5619135">.</span><span class="ident" id="5619136">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5619150">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619203">Process</span>&nbsp;<span class="op" id="5619211">*</span><span class="ident" id="5619212">os</span><span class="op" id="5619214">.</span><span class="ident" id="5619215">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5619225">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5619288">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619331">ProcessState</span>&nbsp;<span class="op" id="5619344">*</span><span class="ident" id="5619345">os</span><span class="op" id="5619347">.</span><span class="ident" id="5619348">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619363">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5619379">error</span>&nbsp;<span class="comment" id="5619385">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619413">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5619429">bool</span>&nbsp;&nbsp;<span class="comment" id="5619435">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619460">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5619476">[</span><span class="op" id="5619477">]</span><span class="op" id="5619478">*</span><span class="ident" id="5619479">os</span><span class="op" id="5619481">.</span><span class="ident" id="5619482">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619488">closeAfterStart</span>&nbsp;<span class="op" id="5619504">[</span><span class="op" id="5619505">]</span><span class="ident" id="5619506">io</span><span class="op" id="5619508">.</span><span class="ident" id="5619509">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619517">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5619533">[</span><span class="op" id="5619534">]</span><span class="ident" id="5619535">io</span><span class="op" id="5619537">.</span><span class="ident" id="5619538">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619546">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5619562">[</span><span class="op" id="5619563">]</span><span class="keyword" id="5619564">func</span><span class="op" id="5619568">(</span><span class="op" id="5619569">)</span>&nbsp;<span class="builtintype" id="5619571">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5619578">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5619594">chan</span>&nbsp;<span class="builtintype" id="5619599">error</span>&nbsp;<span class="comment" id="5619605">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5619631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5619634">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5619702">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5619726">//</span><br>
<span class="lineno">110</span><span class="comment" id="5619729">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5619790">//</span><br>
<span class="lineno"></span><span class="comment" id="5619793">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5619858">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5619928">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5619946">//</span><br>
<span class="lineno"></span><span class="comment" id="5619949">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5620019">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5620085">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5620147">func</span>&nbsp;<span class="ident" id="5620152">Command</span><span class="op" id="5620159">(</span><span class="ident" id="5620160">name</span>&nbsp;<span class="builtintype" id="5620165">string</span><span class="op" id="5620171">,</span>&nbsp;<span class="ident" id="5620173">arg</span>&nbsp;<span class="op" id="5620177">...</span><span class="builtintype" id="5620180">string</span><span class="op" id="5620186">)</span>&nbsp;<span class="op" id="5620188">*</span><span class="ident" id="5620189">Cmd</span>&nbsp;<span class="op" id="5620193">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620196">cmd</span>&nbsp;<span class="op" id="5620200">:=</span>&nbsp;<span class="op" id="5620203">&amp;</span><span class="ident" id="5620204">Cmd</span><span class="op" id="5620207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620211">Path</span><span class="op" id="5620215">:</span>&nbsp;<span class="ident" id="5620217">name</span><span class="op" id="5620221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620225">Args</span><span class="op" id="5620229">:</span>&nbsp;<span class="builtinfunc" id="5620231">append</span><span class="op" id="5620237">(</span><span class="op" id="5620238">[</span><span class="op" id="5620239">]</span><span class="builtintype" id="5620240">string</span><span class="op" id="5620246">{</span><span class="ident" id="5620247">name</span><span class="op" id="5620251">}</span><span class="op" id="5620252">,</span>&nbsp;<span class="ident" id="5620254">arg</span><span class="op" id="5620257">...</span><span class="op" id="5620260">)</span><span class="op" id="5620261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620267">if</span>&nbsp;<span class="ident" id="5620270">filepath</span><span class="op" id="5620278">.</span><span class="ident" id="5620279">Base</span><span class="op" id="5620283">(</span><span class="ident" id="5620284">name</span><span class="op" id="5620288">)</span>&nbsp;<span class="op" id="5620290">==</span>&nbsp;<span class="ident" id="5620293">name</span>&nbsp;<span class="op" id="5620298">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620302">if</span>&nbsp;<span class="ident" id="5620305">lp</span><span class="op" id="5620307">,</span>&nbsp;<span class="ident" id="5620309">err</span>&nbsp;<span class="op" id="5620313">:=</span>&nbsp;<span class="ident" id="5620316">LookPath</span><span class="op" id="5620324">(</span><span class="ident" id="5620325">name</span><span class="op" id="5620329">)</span><span class="op" id="5620330">;</span>&nbsp;<span class="ident" id="5620332">err</span>&nbsp;<span class="op" id="5620336">!=</span>&nbsp;<span class="builtintype" id="5620339">nil</span>&nbsp;<span class="op" id="5620343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620348">cmd</span><span class="op" id="5620351">.</span><span class="ident" id="5620352">lookPathErr</span>&nbsp;<span class="op" id="5620364">=</span>&nbsp;<span class="ident" id="5620366">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620372">}</span>&nbsp;<span class="keyword" id="5620374">else</span>&nbsp;<span class="op" id="5620379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620384">cmd</span><span class="op" id="5620387">.</span><span class="ident" id="5620388">Path</span>&nbsp;<span class="op" id="5620393">=</span>&nbsp;<span class="ident" id="5620395">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620400">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620406">return</span>&nbsp;<span class="ident" id="5620413">cmd</span><br>
<span class="lineno"></span><span class="op" id="5620417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5620420">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5620491">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5620547">func</span>&nbsp;<span class="ident" id="5620552">interfaceEqual</span><span class="op" id="5620566">(</span><span class="ident" id="5620567">a</span><span class="op" id="5620568">,</span>&nbsp;<span class="ident" id="5620570">b</span>&nbsp;<span class="keyword" id="5620572">interface</span><span class="op" id="5620581">{</span><span class="op" id="5620582">}</span><span class="op" id="5620583">)</span>&nbsp;<span class="builtintype" id="5620585">bool</span>&nbsp;<span class="op" id="5620590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620593">defer</span>&nbsp;<span class="keyword" id="5620599">func</span><span class="op" id="5620603">(</span><span class="op" id="5620604">)</span>&nbsp;<span class="op" id="5620606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5620610">recover</span><span class="op" id="5620617">(</span><span class="op" id="5620618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620621">}</span><span class="op" id="5620622">(</span><span class="op" id="5620623">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620626">return</span>&nbsp;<span class="ident" id="5620633">a</span>&nbsp;<span class="op" id="5620635">==</span>&nbsp;<span class="ident" id="5620638">b</span><br>
<span class="lineno"></span><span class="op" id="5620640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5620643">func</span>&nbsp;<span class="op" id="5620648">(</span><span class="ident" id="5620649">c</span>&nbsp;<span class="op" id="5620651">*</span><span class="ident" id="5620652">Cmd</span><span class="op" id="5620655">)</span>&nbsp;<span class="ident" id="5620657">envv</span><span class="op" id="5620661">(</span><span class="op" id="5620662">)</span>&nbsp;<span class="op" id="5620664">[</span><span class="op" id="5620665">]</span><span class="builtintype" id="5620666">string</span>&nbsp;<span class="op" id="5620673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620676">if</span>&nbsp;<span class="ident" id="5620679">c</span><span class="op" id="5620680">.</span><span class="ident" id="5620681">Env</span>&nbsp;<span class="op" id="5620685">!=</span>&nbsp;<span class="builtintype" id="5620688">nil</span>&nbsp;<span class="op" id="5620692">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620696">return</span>&nbsp;<span class="ident" id="5620703">c</span><span class="op" id="5620704">.</span><span class="ident" id="5620705">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620713">return</span>&nbsp;<span class="ident" id="5620720">os</span><span class="op" id="5620722">.</span><span class="ident" id="5620723">Environ</span><span class="op" id="5620730">(</span><span class="op" id="5620731">)</span><br>
<span class="lineno"></span><span class="op" id="5620733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5620736">func</span>&nbsp;<span class="op" id="5620741">(</span><span class="ident" id="5620742">c</span>&nbsp;<span class="op" id="5620744">*</span><span class="ident" id="5620745">Cmd</span><span class="op" id="5620748">)</span>&nbsp;<span class="ident" id="5620750">argv</span><span class="op" id="5620754">(</span><span class="op" id="5620755">)</span>&nbsp;<span class="op" id="5620757">[</span><span class="op" id="5620758">]</span><span class="builtintype" id="5620759">string</span>&nbsp;<span class="op" id="5620766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620769">if</span>&nbsp;<span class="builtinfunc" id="5620772">len</span><span class="op" id="5620775">(</span><span class="ident" id="5620776">c</span><span class="op" id="5620777">.</span><span class="ident" id="5620778">Args</span><span class="op" id="5620782">)</span>&nbsp;<span class="op" id="5620784">&gt;</span>&nbsp;<span class="num" id="5620786">0</span>&nbsp;<span class="op" id="5620788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620792">return</span>&nbsp;<span class="ident" id="5620799">c</span><span class="op" id="5620800">.</span><span class="ident" id="5620801">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620810">return</span>&nbsp;<span class="op" id="5620817">[</span><span class="op" id="5620818">]</span><span class="builtintype" id="5620819">string</span><span class="op" id="5620825">{</span><span class="ident" id="5620826">c</span><span class="op" id="5620827">.</span><span class="ident" id="5620828">Path</span><span class="op" id="5620832">}</span><br>
<span class="lineno">155</span><span class="op" id="5620834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5620837">func</span>&nbsp;<span class="op" id="5620842">(</span><span class="ident" id="5620843">c</span>&nbsp;<span class="op" id="5620845">*</span><span class="ident" id="5620846">Cmd</span><span class="op" id="5620849">)</span>&nbsp;<span class="ident" id="5620851">stdin</span><span class="op" id="5620856">(</span><span class="op" id="5620857">)</span>&nbsp;<span class="op" id="5620859">(</span><span class="ident" id="5620860">f</span>&nbsp;<span class="op" id="5620862">*</span><span class="ident" id="5620863">os</span><span class="op" id="5620865">.</span><span class="ident" id="5620866">File</span><span class="op" id="5620870">,</span>&nbsp;<span class="ident" id="5620872">err</span>&nbsp;<span class="builtintype" id="5620876">error</span><span class="op" id="5620881">)</span>&nbsp;<span class="op" id="5620883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620886">if</span>&nbsp;<span class="ident" id="5620889">c</span><span class="op" id="5620890">.</span><span class="ident" id="5620891">Stdin</span>&nbsp;<span class="op" id="5620897">==</span>&nbsp;<span class="builtintype" id="5620900">nil</span>&nbsp;<span class="op" id="5620904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620908">f</span><span class="op" id="5620909">,</span>&nbsp;<span class="ident" id="5620911">err</span>&nbsp;<span class="op" id="5620915">=</span>&nbsp;<span class="ident" id="5620917">os</span><span class="op" id="5620919">.</span><span class="ident" id="5620920">Open</span><span class="op" id="5620924">(</span><span class="ident" id="5620925">os</span><span class="op" id="5620927">.</span><span class="ident" id="5620928">DevNull</span><span class="op" id="5620935">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620939">if</span>&nbsp;<span class="ident" id="5620942">err</span>&nbsp;<span class="op" id="5620946">!=</span>&nbsp;<span class="builtintype" id="5620949">nil</span>&nbsp;<span class="op" id="5620953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5620958">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5620967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5620971">c</span><span class="op" id="5620972">.</span><span class="ident" id="5620973">closeAfterStart</span>&nbsp;<span class="op" id="5620989">=</span>&nbsp;<span class="builtinfunc" id="5620991">append</span><span class="op" id="5620997">(</span><span class="ident" id="5620998">c</span><span class="op" id="5620999">.</span><span class="ident" id="5621000">closeAfterStart</span><span class="op" id="5621015">,</span>&nbsp;<span class="ident" id="5621017">f</span><span class="op" id="5621018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621022">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621034">if</span>&nbsp;<span class="ident" id="5621037">f</span><span class="op" id="5621038">,</span>&nbsp;<span class="ident" id="5621040">ok</span>&nbsp;<span class="op" id="5621043">:=</span>&nbsp;<span class="ident" id="5621046">c</span><span class="op" id="5621047">.</span><span class="ident" id="5621048">Stdin</span><span class="op" id="5621053">.</span><span class="op" id="5621054">(</span><span class="op" id="5621055">*</span><span class="ident" id="5621056">os</span><span class="op" id="5621058">.</span><span class="ident" id="5621059">File</span><span class="op" id="5621063">)</span><span class="op" id="5621064">;</span>&nbsp;<span class="ident" id="5621066">ok</span>&nbsp;<span class="op" id="5621069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621073">return</span>&nbsp;<span class="ident" id="5621080">f</span><span class="op" id="5621081">,</span>&nbsp;<span class="builtintype" id="5621083">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621088">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621092">pr</span><span class="op" id="5621094">,</span>&nbsp;<span class="ident" id="5621096">pw</span><span class="op" id="5621098">,</span>&nbsp;<span class="ident" id="5621100">err</span>&nbsp;<span class="op" id="5621104">:=</span>&nbsp;<span class="ident" id="5621107">os</span><span class="op" id="5621109">.</span><span class="ident" id="5621110">Pipe</span><span class="op" id="5621114">(</span><span class="op" id="5621115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621118">if</span>&nbsp;<span class="ident" id="5621121">err</span>&nbsp;<span class="op" id="5621125">!=</span>&nbsp;<span class="builtintype" id="5621128">nil</span>&nbsp;<span class="op" id="5621132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621136">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621144">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621148">c</span><span class="op" id="5621149">.</span><span class="ident" id="5621150">closeAfterStart</span>&nbsp;<span class="op" id="5621166">=</span>&nbsp;<span class="builtinfunc" id="5621168">append</span><span class="op" id="5621174">(</span><span class="ident" id="5621175">c</span><span class="op" id="5621176">.</span><span class="ident" id="5621177">closeAfterStart</span><span class="op" id="5621192">,</span>&nbsp;<span class="ident" id="5621194">pr</span><span class="op" id="5621196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621199">c</span><span class="op" id="5621200">.</span><span class="ident" id="5621201">closeAfterWait</span>&nbsp;<span class="op" id="5621216">=</span>&nbsp;<span class="builtinfunc" id="5621218">append</span><span class="op" id="5621224">(</span><span class="ident" id="5621225">c</span><span class="op" id="5621226">.</span><span class="ident" id="5621227">closeAfterWait</span><span class="op" id="5621241">,</span>&nbsp;<span class="ident" id="5621243">pw</span><span class="op" id="5621245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621248">c</span><span class="op" id="5621249">.</span><span class="ident" id="5621250">goroutine</span>&nbsp;<span class="op" id="5621260">=</span>&nbsp;<span class="builtinfunc" id="5621262">append</span><span class="op" id="5621268">(</span><span class="ident" id="5621269">c</span><span class="op" id="5621270">.</span><span class="ident" id="5621271">goroutine</span><span class="op" id="5621280">,</span>&nbsp;<span class="keyword" id="5621282">func</span><span class="op" id="5621286">(</span><span class="op" id="5621287">)</span>&nbsp;<span class="builtintype" id="5621289">error</span>&nbsp;<span class="op" id="5621295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621299">_</span><span class="op" id="5621300">,</span>&nbsp;<span class="ident" id="5621302">err</span>&nbsp;<span class="op" id="5621306">:=</span>&nbsp;<span class="ident" id="5621309">io</span><span class="op" id="5621311">.</span><span class="ident" id="5621312">Copy</span><span class="op" id="5621316">(</span><span class="ident" id="5621317">pw</span><span class="op" id="5621319">,</span>&nbsp;<span class="ident" id="5621321">c</span><span class="op" id="5621322">.</span><span class="ident" id="5621323">Stdin</span><span class="op" id="5621328">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621332">if</span>&nbsp;<span class="ident" id="5621335">err1</span>&nbsp;<span class="op" id="5621340">:=</span>&nbsp;<span class="ident" id="5621343">pw</span><span class="op" id="5621345">.</span><span class="ident" id="5621346">Close</span><span class="op" id="5621351">(</span><span class="op" id="5621352">)</span><span class="op" id="5621353">;</span>&nbsp;<span class="ident" id="5621355">err</span>&nbsp;<span class="op" id="5621359">==</span>&nbsp;<span class="builtintype" id="5621362">nil</span>&nbsp;<span class="op" id="5621366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621371">err</span>&nbsp;<span class="op" id="5621375">=</span>&nbsp;<span class="ident" id="5621377">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621388">return</span>&nbsp;<span class="ident" id="5621395">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621400">}</span><span class="op" id="5621401">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621404">return</span>&nbsp;<span class="ident" id="5621411">pr</span><span class="op" id="5621413">,</span>&nbsp;<span class="builtintype" id="5621415">nil</span><br>
<span class="lineno"></span><span class="op" id="5621419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5621422">func</span>&nbsp;<span class="op" id="5621427">(</span><span class="ident" id="5621428">c</span>&nbsp;<span class="op" id="5621430">*</span><span class="ident" id="5621431">Cmd</span><span class="op" id="5621434">)</span>&nbsp;<span class="ident" id="5621436">stdout</span><span class="op" id="5621442">(</span><span class="op" id="5621443">)</span>&nbsp;<span class="op" id="5621445">(</span><span class="ident" id="5621446">f</span>&nbsp;<span class="op" id="5621448">*</span><span class="ident" id="5621449">os</span><span class="op" id="5621451">.</span><span class="ident" id="5621452">File</span><span class="op" id="5621456">,</span>&nbsp;<span class="ident" id="5621458">err</span>&nbsp;<span class="builtintype" id="5621462">error</span><span class="op" id="5621467">)</span>&nbsp;<span class="op" id="5621469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621472">return</span>&nbsp;<span class="ident" id="5621479">c</span><span class="op" id="5621480">.</span><span class="ident" id="5621481">writerDescriptor</span><span class="op" id="5621497">(</span><span class="ident" id="5621498">c</span><span class="op" id="5621499">.</span><span class="ident" id="5621500">Stdout</span><span class="op" id="5621506">)</span><br>
<span class="lineno">190</span><span class="op" id="5621508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5621511">func</span>&nbsp;<span class="op" id="5621516">(</span><span class="ident" id="5621517">c</span>&nbsp;<span class="op" id="5621519">*</span><span class="ident" id="5621520">Cmd</span><span class="op" id="5621523">)</span>&nbsp;<span class="ident" id="5621525">stderr</span><span class="op" id="5621531">(</span><span class="op" id="5621532">)</span>&nbsp;<span class="op" id="5621534">(</span><span class="ident" id="5621535">f</span>&nbsp;<span class="op" id="5621537">*</span><span class="ident" id="5621538">os</span><span class="op" id="5621540">.</span><span class="ident" id="5621541">File</span><span class="op" id="5621545">,</span>&nbsp;<span class="ident" id="5621547">err</span>&nbsp;<span class="builtintype" id="5621551">error</span><span class="op" id="5621556">)</span>&nbsp;<span class="op" id="5621558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621561">if</span>&nbsp;<span class="ident" id="5621564">c</span><span class="op" id="5621565">.</span><span class="ident" id="5621566">Stderr</span>&nbsp;<span class="op" id="5621573">!=</span>&nbsp;<span class="builtintype" id="5621576">nil</span>&nbsp;<span class="op" id="5621580">&amp;&amp;</span>&nbsp;<span class="ident" id="5621583">interfaceEqual</span><span class="op" id="5621597">(</span><span class="ident" id="5621598">c</span><span class="op" id="5621599">.</span><span class="ident" id="5621600">Stderr</span><span class="op" id="5621606">,</span>&nbsp;<span class="ident" id="5621608">c</span><span class="op" id="5621609">.</span><span class="ident" id="5621610">Stdout</span><span class="op" id="5621616">)</span>&nbsp;<span class="op" id="5621618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621622">return</span>&nbsp;<span class="ident" id="5621629">c</span><span class="op" id="5621630">.</span><span class="ident" id="5621631">childFiles</span><span class="op" id="5621641">[</span><span class="num" id="5621642">1</span><span class="op" id="5621643">]</span><span class="op" id="5621644">,</span>&nbsp;<span class="builtintype" id="5621646">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621654">return</span>&nbsp;<span class="ident" id="5621661">c</span><span class="op" id="5621662">.</span><span class="ident" id="5621663">writerDescriptor</span><span class="op" id="5621679">(</span><span class="ident" id="5621680">c</span><span class="op" id="5621681">.</span><span class="ident" id="5621682">Stderr</span><span class="op" id="5621688">)</span><br>
<span class="lineno"></span><span class="op" id="5621690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5621693">func</span>&nbsp;<span class="op" id="5621698">(</span><span class="ident" id="5621699">c</span>&nbsp;<span class="op" id="5621701">*</span><span class="ident" id="5621702">Cmd</span><span class="op" id="5621705">)</span>&nbsp;<span class="ident" id="5621707">writerDescriptor</span><span class="op" id="5621723">(</span><span class="ident" id="5621724">w</span>&nbsp;<span class="ident" id="5621726">io</span><span class="op" id="5621728">.</span><span class="ident" id="5621729">Writer</span><span class="op" id="5621735">)</span>&nbsp;<span class="op" id="5621737">(</span><span class="ident" id="5621738">f</span>&nbsp;<span class="op" id="5621740">*</span><span class="ident" id="5621741">os</span><span class="op" id="5621743">.</span><span class="ident" id="5621744">File</span><span class="op" id="5621748">,</span>&nbsp;<span class="ident" id="5621750">err</span>&nbsp;<span class="builtintype" id="5621754">error</span><span class="op" id="5621759">)</span>&nbsp;<span class="op" id="5621761">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621764">if</span>&nbsp;<span class="ident" id="5621767">w</span>&nbsp;<span class="op" id="5621769">==</span>&nbsp;<span class="builtintype" id="5621772">nil</span>&nbsp;<span class="op" id="5621776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621780">f</span><span class="op" id="5621781">,</span>&nbsp;<span class="ident" id="5621783">err</span>&nbsp;<span class="op" id="5621787">=</span>&nbsp;<span class="ident" id="5621789">os</span><span class="op" id="5621791">.</span><span class="ident" id="5621792">OpenFile</span><span class="op" id="5621800">(</span><span class="ident" id="5621801">os</span><span class="op" id="5621803">.</span><span class="ident" id="5621804">DevNull</span><span class="op" id="5621811">,</span>&nbsp;<span class="ident" id="5621813">os</span><span class="op" id="5621815">.</span><span class="ident" id="5621816">O_WRONLY</span><span class="op" id="5621824">,</span>&nbsp;<span class="num" id="5621826">0</span><span class="op" id="5621827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621831">if</span>&nbsp;<span class="ident" id="5621834">err</span>&nbsp;<span class="op" id="5621838">!=</span>&nbsp;<span class="builtintype" id="5621841">nil</span>&nbsp;<span class="op" id="5621845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621850">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621859">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621863">c</span><span class="op" id="5621864">.</span><span class="ident" id="5621865">closeAfterStart</span>&nbsp;<span class="op" id="5621881">=</span>&nbsp;<span class="builtinfunc" id="5621883">append</span><span class="op" id="5621889">(</span><span class="ident" id="5621890">c</span><span class="op" id="5621891">.</span><span class="ident" id="5621892">closeAfterStart</span><span class="op" id="5621907">,</span>&nbsp;<span class="ident" id="5621909">f</span><span class="op" id="5621910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621914">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621926">if</span>&nbsp;<span class="ident" id="5621929">f</span><span class="op" id="5621930">,</span>&nbsp;<span class="ident" id="5621932">ok</span>&nbsp;<span class="op" id="5621935">:=</span>&nbsp;<span class="ident" id="5621938">w</span><span class="op" id="5621939">.</span><span class="op" id="5621940">(</span><span class="op" id="5621941">*</span><span class="ident" id="5621942">os</span><span class="op" id="5621944">.</span><span class="ident" id="5621945">File</span><span class="op" id="5621949">)</span><span class="op" id="5621950">;</span>&nbsp;<span class="ident" id="5621952">ok</span>&nbsp;<span class="op" id="5621955">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5621959">return</span>&nbsp;<span class="ident" id="5621966">f</span><span class="op" id="5621967">,</span>&nbsp;<span class="builtintype" id="5621969">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5621974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5621978">pr</span><span class="op" id="5621980">,</span>&nbsp;<span class="ident" id="5621982">pw</span><span class="op" id="5621984">,</span>&nbsp;<span class="ident" id="5621986">err</span>&nbsp;<span class="op" id="5621990">:=</span>&nbsp;<span class="ident" id="5621993">os</span><span class="op" id="5621995">.</span><span class="ident" id="5621996">Pipe</span><span class="op" id="5622000">(</span><span class="op" id="5622001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622004">if</span>&nbsp;<span class="ident" id="5622007">err</span>&nbsp;<span class="op" id="5622011">!=</span>&nbsp;<span class="builtintype" id="5622014">nil</span>&nbsp;<span class="op" id="5622018">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622022">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5622030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5622034">c</span><span class="op" id="5622035">.</span><span class="ident" id="5622036">closeAfterStart</span>&nbsp;<span class="op" id="5622052">=</span>&nbsp;<span class="builtinfunc" id="5622054">append</span><span class="op" id="5622060">(</span><span class="ident" id="5622061">c</span><span class="op" id="5622062">.</span><span class="ident" id="5622063">closeAfterStart</span><span class="op" id="5622078">,</span>&nbsp;<span class="ident" id="5622080">pw</span><span class="op" id="5622082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5622085">c</span><span class="op" id="5622086">.</span><span class="ident" id="5622087">closeAfterWait</span>&nbsp;<span class="op" id="5622102">=</span>&nbsp;<span class="builtinfunc" id="5622104">append</span><span class="op" id="5622110">(</span><span class="ident" id="5622111">c</span><span class="op" id="5622112">.</span><span class="ident" id="5622113">closeAfterWait</span><span class="op" id="5622127">,</span>&nbsp;<span class="ident" id="5622129">pr</span><span class="op" id="5622131">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5622134">c</span><span class="op" id="5622135">.</span><span class="ident" id="5622136">goroutine</span>&nbsp;<span class="op" id="5622146">=</span>&nbsp;<span class="builtinfunc" id="5622148">append</span><span class="op" id="5622154">(</span><span class="ident" id="5622155">c</span><span class="op" id="5622156">.</span><span class="ident" id="5622157">goroutine</span><span class="op" id="5622166">,</span>&nbsp;<span class="keyword" id="5622168">func</span><span class="op" id="5622172">(</span><span class="op" id="5622173">)</span>&nbsp;<span class="builtintype" id="5622175">error</span>&nbsp;<span class="op" id="5622181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5622185">_</span><span class="op" id="5622186">,</span>&nbsp;<span class="ident" id="5622188">err</span>&nbsp;<span class="op" id="5622192">:=</span>&nbsp;<span class="ident" id="5622195">io</span><span class="op" id="5622197">.</span><span class="ident" id="5622198">Copy</span><span class="op" id="5622202">(</span><span class="ident" id="5622203">w</span><span class="op" id="5622204">,</span>&nbsp;<span class="ident" id="5622206">pr</span><span class="op" id="5622208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622212">return</span>&nbsp;<span class="ident" id="5622219">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5622224">}</span><span class="op" id="5622225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622228">return</span>&nbsp;<span class="ident" id="5622235">pw</span><span class="op" id="5622237">,</span>&nbsp;<span class="builtintype" id="5622239">nil</span><br>
<span class="lineno">225</span><span class="op" id="5622243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5622246">func</span>&nbsp;<span class="op" id="5622251">(</span><span class="ident" id="5622252">c</span>&nbsp;<span class="op" id="5622254">*</span><span class="ident" id="5622255">Cmd</span><span class="op" id="5622258">)</span>&nbsp;<span class="ident" id="5622260">closeDescriptors</span><span class="op" id="5622276">(</span><span class="ident" id="5622277">closers</span>&nbsp;<span class="op" id="5622285">[</span><span class="op" id="5622286">]</span><span class="ident" id="5622287">io</span><span class="op" id="5622289">.</span><span class="ident" id="5622290">Closer</span><span class="op" id="5622296">)</span>&nbsp;<span class="op" id="5622298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622301">for</span>&nbsp;<span class="ident" id="5622305">_</span><span class="op" id="5622306">,</span>&nbsp;<span class="ident" id="5622308">fd</span>&nbsp;<span class="op" id="5622311">:=</span>&nbsp;<span class="keyword" id="5622314">range</span>&nbsp;<span class="ident" id="5622320">closers</span>&nbsp;<span class="op" id="5622328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5622332">fd</span><span class="op" id="5622334">.</span><span class="ident" id="5622335">Close</span><span class="op" id="5622340">(</span><span class="op" id="5622341">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5622344">}</span><br>
<span class="lineno"></span><span class="op" id="5622346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5622349">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5622415">//</span><br>
<span class="lineno">235</span><span class="comment" id="5622418">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5622484">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5622549">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5622560">//</span><br>
<span class="lineno"></span><span class="comment" id="5622563">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5622632">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5622689">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5622719">func</span>&nbsp;<span class="op" id="5622724">(</span><span class="ident" id="5622725">c</span>&nbsp;<span class="op" id="5622727">*</span><span class="ident" id="5622728">Cmd</span><span class="op" id="5622731">)</span>&nbsp;<span class="ident" id="5622733">Run</span><span class="op" id="5622736">(</span><span class="op" id="5622737">)</span>&nbsp;<span class="builtintype" id="5622739">error</span>&nbsp;<span class="op" id="5622745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622748">if</span>&nbsp;<span class="ident" id="5622751">err</span>&nbsp;<span class="op" id="5622755">:=</span>&nbsp;<span class="ident" id="5622758">c</span><span class="op" id="5622759">.</span><span class="ident" id="5622760">Start</span><span class="op" id="5622765">(</span><span class="op" id="5622766">)</span><span class="op" id="5622767">;</span>&nbsp;<span class="ident" id="5622769">err</span>&nbsp;<span class="op" id="5622773">!=</span>&nbsp;<span class="builtintype" id="5622776">nil</span>&nbsp;<span class="op" id="5622780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622784">return</span>&nbsp;<span class="ident" id="5622791">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5622796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5622799">return</span>&nbsp;<span class="ident" id="5622806">c</span><span class="op" id="5622807">.</span><span class="ident" id="5622808">Wait</span><span class="op" id="5622812">(</span><span class="op" id="5622813">)</span><br>
<span class="lineno"></span><span class="op" id="5622815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5622818">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5622882">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5622933">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5623015">func</span>&nbsp;<span class="ident" id="5623020">lookExtensions</span><span class="op" id="5623034">(</span><span class="ident" id="5623035">path</span><span class="op" id="5623039">,</span>&nbsp;<span class="ident" id="5623041">dir</span>&nbsp;<span class="builtintype" id="5623045">string</span><span class="op" id="5623051">)</span>&nbsp;<span class="op" id="5623053">(</span><span class="builtintype" id="5623054">string</span><span class="op" id="5623060">,</span>&nbsp;<span class="builtintype" id="5623062">error</span><span class="op" id="5623067">)</span>&nbsp;<span class="op" id="5623069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623072">if</span>&nbsp;<span class="ident" id="5623075">filepath</span><span class="op" id="5623083">.</span><span class="ident" id="5623084">Base</span><span class="op" id="5623088">(</span><span class="ident" id="5623089">path</span><span class="op" id="5623093">)</span>&nbsp;<span class="op" id="5623095">==</span>&nbsp;<span class="ident" id="5623098">path</span>&nbsp;<span class="op" id="5623103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623107">path</span>&nbsp;<span class="op" id="5623112">=</span>&nbsp;<span class="ident" id="5623114">filepath</span><span class="op" id="5623122">.</span><span class="ident" id="5623123">Join</span><span class="op" id="5623127">(</span><span class="string" id="5623128">&#34;.&#34;</span><span class="op" id="5623131">,</span>&nbsp;<span class="ident" id="5623133">path</span><span class="op" id="5623137">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5623140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623143">if</span>&nbsp;<span class="ident" id="5623146">dir</span>&nbsp;<span class="op" id="5623150">==</span>&nbsp;<span class="string" id="5623153">&#34;&#34;</span>&nbsp;<span class="op" id="5623156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623160">return</span>&nbsp;<span class="ident" id="5623167">LookPath</span><span class="op" id="5623175">(</span><span class="ident" id="5623176">path</span><span class="op" id="5623180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5623183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623186">if</span>&nbsp;<span class="ident" id="5623189">filepath</span><span class="op" id="5623197">.</span><span class="ident" id="5623198">VolumeName</span><span class="op" id="5623208">(</span><span class="ident" id="5623209">path</span><span class="op" id="5623213">)</span>&nbsp;<span class="op" id="5623215">!=</span>&nbsp;<span class="string" id="5623218">&#34;&#34;</span>&nbsp;<span class="op" id="5623221">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623225">return</span>&nbsp;<span class="ident" id="5623232">LookPath</span><span class="op" id="5623240">(</span><span class="ident" id="5623241">path</span><span class="op" id="5623245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5623248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623251">if</span>&nbsp;<span class="builtinfunc" id="5623254">len</span><span class="op" id="5623257">(</span><span class="ident" id="5623258">path</span><span class="op" id="5623262">)</span>&nbsp;<span class="op" id="5623264">&gt;</span>&nbsp;<span class="num" id="5623266">1</span>&nbsp;<span class="op" id="5623268">&amp;&amp;</span>&nbsp;<span class="ident" id="5623271">os</span><span class="op" id="5623273">.</span><span class="ident" id="5623274">IsPathSeparator</span><span class="op" id="5623289">(</span><span class="ident" id="5623290">path</span><span class="op" id="5623294">[</span><span class="num" id="5623295">0</span><span class="op" id="5623296">]</span><span class="op" id="5623297">)</span>&nbsp;<span class="op" id="5623299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623303">return</span>&nbsp;<span class="ident" id="5623310">LookPath</span><span class="op" id="5623318">(</span><span class="ident" id="5623319">path</span><span class="op" id="5623323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5623326">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623329">dirandpath</span>&nbsp;<span class="op" id="5623340">:=</span>&nbsp;<span class="ident" id="5623343">filepath</span><span class="op" id="5623351">.</span><span class="ident" id="5623352">Join</span><span class="op" id="5623356">(</span><span class="ident" id="5623357">dir</span><span class="op" id="5623360">,</span>&nbsp;<span class="ident" id="5623362">path</span><span class="op" id="5623366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5623369">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623427">lp</span><span class="op" id="5623429">,</span>&nbsp;<span class="ident" id="5623431">err</span>&nbsp;<span class="op" id="5623435">:=</span>&nbsp;<span class="ident" id="5623438">LookPath</span><span class="op" id="5623446">(</span><span class="ident" id="5623447">dirandpath</span><span class="op" id="5623457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623460">if</span>&nbsp;<span class="ident" id="5623463">err</span>&nbsp;<span class="op" id="5623467">!=</span>&nbsp;<span class="builtintype" id="5623470">nil</span>&nbsp;<span class="op" id="5623474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623478">return</span>&nbsp;<span class="string" id="5623485">&#34;&#34;</span><span class="op" id="5623487">,</span>&nbsp;<span class="ident" id="5623489">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5623494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623497">ext</span>&nbsp;<span class="op" id="5623501">:=</span>&nbsp;<span class="ident" id="5623504">strings</span><span class="op" id="5623511">.</span><span class="ident" id="5623512">TrimPrefix</span><span class="op" id="5623522">(</span><span class="ident" id="5623523">lp</span><span class="op" id="5623525">,</span>&nbsp;<span class="ident" id="5623527">dirandpath</span><span class="op" id="5623537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623540">return</span>&nbsp;<span class="ident" id="5623547">path</span>&nbsp;<span class="op" id="5623552">+</span>&nbsp;<span class="ident" id="5623554">ext</span><span class="op" id="5623557">,</span>&nbsp;<span class="builtintype" id="5623559">nil</span><br>
<span class="lineno"></span><span class="op" id="5623563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5623566">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5623642">//</span><br>
<span class="lineno"></span><span class="comment" id="5623645">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5623723">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5623750">func</span>&nbsp;<span class="op" id="5623755">(</span><span class="ident" id="5623756">c</span>&nbsp;<span class="op" id="5623758">*</span><span class="ident" id="5623759">Cmd</span><span class="op" id="5623762">)</span>&nbsp;<span class="ident" id="5623764">Start</span><span class="op" id="5623769">(</span><span class="op" id="5623770">)</span>&nbsp;<span class="builtintype" id="5623772">error</span>&nbsp;<span class="op" id="5623778">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623781">if</span>&nbsp;<span class="ident" id="5623784">c</span><span class="op" id="5623785">.</span><span class="ident" id="5623786">lookPathErr</span>&nbsp;<span class="op" id="5623798">!=</span>&nbsp;<span class="builtintype" id="5623801">nil</span>&nbsp;<span class="op" id="5623805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623809">c</span><span class="op" id="5623810">.</span><span class="ident" id="5623811">closeDescriptors</span><span class="op" id="5623827">(</span><span class="ident" id="5623828">c</span><span class="op" id="5623829">.</span><span class="ident" id="5623830">closeAfterStart</span><span class="op" id="5623845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623849">c</span><span class="op" id="5623850">.</span><span class="ident" id="5623851">closeDescriptors</span><span class="op" id="5623867">(</span><span class="ident" id="5623868">c</span><span class="op" id="5623869">.</span><span class="ident" id="5623870">closeAfterWait</span><span class="op" id="5623884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623888">return</span>&nbsp;<span class="ident" id="5623895">c</span><span class="op" id="5623896">.</span><span class="ident" id="5623897">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5623910">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623913">if</span>&nbsp;<span class="ident" id="5623916">runtime</span><span class="op" id="5623923">.</span><span class="ident" id="5623924">GOOS</span>&nbsp;<span class="op" id="5623929">==</span>&nbsp;<span class="string" id="5623932">&#34;windows&#34;</span>&nbsp;<span class="op" id="5623942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5623946">lp</span><span class="op" id="5623948">,</span>&nbsp;<span class="ident" id="5623950">err</span>&nbsp;<span class="op" id="5623954">:=</span>&nbsp;<span class="ident" id="5623957">lookExtensions</span><span class="op" id="5623971">(</span><span class="ident" id="5623972">c</span><span class="op" id="5623973">.</span><span class="ident" id="5623974">Path</span><span class="op" id="5623978">,</span>&nbsp;<span class="ident" id="5623980">c</span><span class="op" id="5623981">.</span><span class="ident" id="5623982">Dir</span><span class="op" id="5623985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5623989">if</span>&nbsp;<span class="ident" id="5623992">err</span>&nbsp;<span class="op" id="5623996">!=</span>&nbsp;<span class="builtintype" id="5623999">nil</span>&nbsp;<span class="op" id="5624003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624008">c</span><span class="op" id="5624009">.</span><span class="ident" id="5624010">closeDescriptors</span><span class="op" id="5624026">(</span><span class="ident" id="5624027">c</span><span class="op" id="5624028">.</span><span class="ident" id="5624029">closeAfterStart</span><span class="op" id="5624044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624049">c</span><span class="op" id="5624050">.</span><span class="ident" id="5624051">closeDescriptors</span><span class="op" id="5624067">(</span><span class="ident" id="5624068">c</span><span class="op" id="5624069">.</span><span class="ident" id="5624070">closeAfterWait</span><span class="op" id="5624084">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624089">return</span>&nbsp;<span class="ident" id="5624096">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624106">c</span><span class="op" id="5624107">.</span><span class="ident" id="5624108">Path</span>&nbsp;<span class="op" id="5624113">=</span>&nbsp;<span class="ident" id="5624115">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624122">if</span>&nbsp;<span class="ident" id="5624125">c</span><span class="op" id="5624126">.</span><span class="ident" id="5624127">Process</span>&nbsp;<span class="op" id="5624135">!=</span>&nbsp;<span class="builtintype" id="5624138">nil</span>&nbsp;<span class="op" id="5624142">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624146">return</span>&nbsp;<span class="ident" id="5624153">errors</span><span class="op" id="5624159">.</span><span class="ident" id="5624160">New</span><span class="op" id="5624163">(</span><span class="string" id="5624164">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5624187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624194">type</span>&nbsp;<span class="ident" id="5624199">F</span>&nbsp;<span class="keyword" id="5624201">func</span><span class="op" id="5624205">(</span><span class="op" id="5624206">*</span><span class="ident" id="5624207">Cmd</span><span class="op" id="5624210">)</span>&nbsp;<span class="op" id="5624212">(</span><span class="op" id="5624213">*</span><span class="ident" id="5624214">os</span><span class="op" id="5624216">.</span><span class="ident" id="5624217">File</span><span class="op" id="5624221">,</span>&nbsp;<span class="builtintype" id="5624223">error</span><span class="op" id="5624228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624231">for</span>&nbsp;<span class="ident" id="5624235">_</span><span class="op" id="5624236">,</span>&nbsp;<span class="ident" id="5624238">setupFd</span>&nbsp;<span class="op" id="5624246">:=</span>&nbsp;<span class="keyword" id="5624249">range</span>&nbsp;<span class="op" id="5624255">[</span><span class="op" id="5624256">]</span><span class="ident" id="5624257">F</span><span class="op" id="5624258">{</span><span class="op" id="5624259">(</span><span class="op" id="5624260">*</span><span class="ident" id="5624261">Cmd</span><span class="op" id="5624264">)</span><span class="op" id="5624265">.</span><span class="ident" id="5624266">stdin</span><span class="op" id="5624271">,</span>&nbsp;<span class="op" id="5624273">(</span><span class="op" id="5624274">*</span><span class="ident" id="5624275">Cmd</span><span class="op" id="5624278">)</span><span class="op" id="5624279">.</span><span class="ident" id="5624280">stdout</span><span class="op" id="5624286">,</span>&nbsp;<span class="op" id="5624288">(</span><span class="op" id="5624289">*</span><span class="ident" id="5624290">Cmd</span><span class="op" id="5624293">)</span><span class="op" id="5624294">.</span><span class="ident" id="5624295">stderr</span><span class="op" id="5624301">}</span>&nbsp;<span class="op" id="5624303">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624307">fd</span><span class="op" id="5624309">,</span>&nbsp;<span class="ident" id="5624311">err</span>&nbsp;<span class="op" id="5624315">:=</span>&nbsp;<span class="ident" id="5624318">setupFd</span><span class="op" id="5624325">(</span><span class="ident" id="5624326">c</span><span class="op" id="5624327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624331">if</span>&nbsp;<span class="ident" id="5624334">err</span>&nbsp;<span class="op" id="5624338">!=</span>&nbsp;<span class="builtintype" id="5624341">nil</span>&nbsp;<span class="op" id="5624345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624350">c</span><span class="op" id="5624351">.</span><span class="ident" id="5624352">closeDescriptors</span><span class="op" id="5624368">(</span><span class="ident" id="5624369">c</span><span class="op" id="5624370">.</span><span class="ident" id="5624371">closeAfterStart</span><span class="op" id="5624386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624391">c</span><span class="op" id="5624392">.</span><span class="ident" id="5624393">closeDescriptors</span><span class="op" id="5624409">(</span><span class="ident" id="5624410">c</span><span class="op" id="5624411">.</span><span class="ident" id="5624412">closeAfterWait</span><span class="op" id="5624426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624431">return</span>&nbsp;<span class="ident" id="5624438">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624448">c</span><span class="op" id="5624449">.</span><span class="ident" id="5624450">childFiles</span>&nbsp;<span class="op" id="5624461">=</span>&nbsp;<span class="builtinfunc" id="5624463">append</span><span class="op" id="5624469">(</span><span class="ident" id="5624470">c</span><span class="op" id="5624471">.</span><span class="ident" id="5624472">childFiles</span><span class="op" id="5624482">,</span>&nbsp;<span class="ident" id="5624484">fd</span><span class="op" id="5624486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624492">c</span><span class="op" id="5624493">.</span><span class="ident" id="5624494">childFiles</span>&nbsp;<span class="op" id="5624505">=</span>&nbsp;<span class="builtinfunc" id="5624507">append</span><span class="op" id="5624513">(</span><span class="ident" id="5624514">c</span><span class="op" id="5624515">.</span><span class="ident" id="5624516">childFiles</span><span class="op" id="5624526">,</span>&nbsp;<span class="ident" id="5624528">c</span><span class="op" id="5624529">.</span><span class="ident" id="5624530">ExtraFiles</span><span class="op" id="5624540">...</span><span class="op" id="5624543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624547">var</span>&nbsp;<span class="ident" id="5624551">err</span>&nbsp;<span class="builtintype" id="5624555">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624562">c</span><span class="op" id="5624563">.</span><span class="ident" id="5624564">Process</span><span class="op" id="5624571">,</span>&nbsp;<span class="ident" id="5624573">err</span>&nbsp;<span class="op" id="5624577">=</span>&nbsp;<span class="ident" id="5624579">os</span><span class="op" id="5624581">.</span><span class="ident" id="5624582">StartProcess</span><span class="op" id="5624594">(</span><span class="ident" id="5624595">c</span><span class="op" id="5624596">.</span><span class="ident" id="5624597">Path</span><span class="op" id="5624601">,</span>&nbsp;<span class="ident" id="5624603">c</span><span class="op" id="5624604">.</span><span class="ident" id="5624605">argv</span><span class="op" id="5624609">(</span><span class="op" id="5624610">)</span><span class="op" id="5624611">,</span>&nbsp;<span class="op" id="5624613">&amp;</span><span class="ident" id="5624614">os</span><span class="op" id="5624616">.</span><span class="ident" id="5624617">ProcAttr</span><span class="op" id="5624625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624629">Dir</span><span class="op" id="5624632">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5624636">c</span><span class="op" id="5624637">.</span><span class="ident" id="5624638">Dir</span><span class="op" id="5624641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624645">Files</span><span class="op" id="5624650">:</span>&nbsp;<span class="ident" id="5624652">c</span><span class="op" id="5624653">.</span><span class="ident" id="5624654">childFiles</span><span class="op" id="5624664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624668">Env</span><span class="op" id="5624671">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5624675">c</span><span class="op" id="5624676">.</span><span class="ident" id="5624677">envv</span><span class="op" id="5624681">(</span><span class="op" id="5624682">)</span><span class="op" id="5624683">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624687">Sys</span><span class="op" id="5624690">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5624694">c</span><span class="op" id="5624695">.</span><span class="ident" id="5624696">SysProcAttr</span><span class="op" id="5624707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624710">}</span><span class="op" id="5624711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624714">if</span>&nbsp;<span class="ident" id="5624717">err</span>&nbsp;<span class="op" id="5624721">!=</span>&nbsp;<span class="builtintype" id="5624724">nil</span>&nbsp;<span class="op" id="5624728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624732">c</span><span class="op" id="5624733">.</span><span class="ident" id="5624734">closeDescriptors</span><span class="op" id="5624750">(</span><span class="ident" id="5624751">c</span><span class="op" id="5624752">.</span><span class="ident" id="5624753">closeAfterStart</span><span class="op" id="5624768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624772">c</span><span class="op" id="5624773">.</span><span class="ident" id="5624774">closeDescriptors</span><span class="op" id="5624790">(</span><span class="ident" id="5624791">c</span><span class="op" id="5624792">.</span><span class="ident" id="5624793">closeAfterWait</span><span class="op" id="5624807">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624811">return</span>&nbsp;<span class="ident" id="5624818">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624827">c</span><span class="op" id="5624828">.</span><span class="ident" id="5624829">closeDescriptors</span><span class="op" id="5624845">(</span><span class="ident" id="5624846">c</span><span class="op" id="5624847">.</span><span class="ident" id="5624848">closeAfterStart</span><span class="op" id="5624863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624867">c</span><span class="op" id="5624868">.</span><span class="ident" id="5624869">errch</span>&nbsp;<span class="op" id="5624875">=</span>&nbsp;<span class="builtinfunc" id="5624877">make</span><span class="op" id="5624881">(</span><span class="keyword" id="5624882">chan</span>&nbsp;<span class="builtintype" id="5624887">error</span><span class="op" id="5624892">,</span>&nbsp;<span class="builtinfunc" id="5624894">len</span><span class="op" id="5624897">(</span><span class="ident" id="5624898">c</span><span class="op" id="5624899">.</span><span class="ident" id="5624900">goroutine</span><span class="op" id="5624909">)</span><span class="op" id="5624910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624913">for</span>&nbsp;<span class="ident" id="5624917">_</span><span class="op" id="5624918">,</span>&nbsp;<span class="ident" id="5624920">fn</span>&nbsp;<span class="op" id="5624923">:=</span>&nbsp;<span class="keyword" id="5624926">range</span>&nbsp;<span class="ident" id="5624932">c</span><span class="op" id="5624933">.</span><span class="ident" id="5624934">goroutine</span>&nbsp;<span class="op" id="5624944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5624948">go</span>&nbsp;<span class="keyword" id="5624951">func</span><span class="op" id="5624955">(</span><span class="ident" id="5624956">fn</span>&nbsp;<span class="keyword" id="5624959">func</span><span class="op" id="5624963">(</span><span class="op" id="5624964">)</span>&nbsp;<span class="builtintype" id="5624966">error</span><span class="op" id="5624971">)</span>&nbsp;<span class="op" id="5624973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5624978">c</span><span class="op" id="5624979">.</span><span class="ident" id="5624980">errch</span>&nbsp;<span class="op" id="5624986">&lt;-</span>&nbsp;<span class="ident" id="5624989">fn</span><span class="op" id="5624991">(</span><span class="op" id="5624992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5624996">}</span><span class="op" id="5624997">(</span><span class="ident" id="5624998">fn</span><span class="op" id="5625000">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5625003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625007">return</span>&nbsp;<span class="builtintype" id="5625014">nil</span><br>
<span class="lineno"></span><span class="op" id="5625018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5625021">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5625080">type</span>&nbsp;<span class="ident" id="5625085">ExitError</span>&nbsp;<span class="keyword" id="5625095">struct</span>&nbsp;<span class="op" id="5625102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5625105">*</span><span class="ident" id="5625106">os</span><span class="op" id="5625108">.</span><span class="ident" id="5625109">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5625122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5625125">func</span>&nbsp;<span class="op" id="5625130">(</span><span class="ident" id="5625131">e</span>&nbsp;<span class="op" id="5625133">*</span><span class="ident" id="5625134">ExitError</span><span class="op" id="5625143">)</span>&nbsp;<span class="ident" id="5625145">Error</span><span class="op" id="5625150">(</span><span class="op" id="5625151">)</span>&nbsp;<span class="builtintype" id="5625153">string</span>&nbsp;<span class="op" id="5625160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625163">return</span>&nbsp;<span class="ident" id="5625170">e</span><span class="op" id="5625171">.</span><span class="ident" id="5625172">ProcessState</span><span class="op" id="5625184">.</span><span class="ident" id="5625185">String</span><span class="op" id="5625191">(</span><span class="op" id="5625192">)</span><br>
<span class="lineno"></span><span class="op" id="5625194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5625197">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5625236">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5625275">//</span><br>
<span class="lineno"></span><span class="comment" id="5625278">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5625344">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5625409">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5625420">//</span><br>
<span class="lineno"></span><span class="comment" id="5625423">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5625492">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5625549">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5625579">//</span><br>
<span class="lineno">355</span><span class="comment" id="5625582">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5625638">func</span>&nbsp;<span class="op" id="5625643">(</span><span class="ident" id="5625644">c</span>&nbsp;<span class="op" id="5625646">*</span><span class="ident" id="5625647">Cmd</span><span class="op" id="5625650">)</span>&nbsp;<span class="ident" id="5625652">Wait</span><span class="op" id="5625656">(</span><span class="op" id="5625657">)</span>&nbsp;<span class="builtintype" id="5625659">error</span>&nbsp;<span class="op" id="5625665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625668">if</span>&nbsp;<span class="ident" id="5625671">c</span><span class="op" id="5625672">.</span><span class="ident" id="5625673">Process</span>&nbsp;<span class="op" id="5625681">==</span>&nbsp;<span class="builtintype" id="5625684">nil</span>&nbsp;<span class="op" id="5625688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625692">return</span>&nbsp;<span class="ident" id="5625699">errors</span><span class="op" id="5625705">.</span><span class="ident" id="5625706">New</span><span class="op" id="5625709">(</span><span class="string" id="5625710">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5625729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5625732">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625735">if</span>&nbsp;<span class="ident" id="5625738">c</span><span class="op" id="5625739">.</span><span class="ident" id="5625740">finished</span>&nbsp;<span class="op" id="5625749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625753">return</span>&nbsp;<span class="ident" id="5625760">errors</span><span class="op" id="5625766">.</span><span class="ident" id="5625767">New</span><span class="op" id="5625770">(</span><span class="string" id="5625771">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5625802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5625805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5625808">c</span><span class="op" id="5625809">.</span><span class="ident" id="5625810">finished</span>&nbsp;<span class="op" id="5625819">=</span>&nbsp;<span class="builtintype" id="5625821">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5625827">state</span><span class="op" id="5625832">,</span>&nbsp;<span class="ident" id="5625834">err</span>&nbsp;<span class="op" id="5625838">:=</span>&nbsp;<span class="ident" id="5625841">c</span><span class="op" id="5625842">.</span><span class="ident" id="5625843">Process</span><span class="op" id="5625850">.</span><span class="ident" id="5625851">Wait</span><span class="op" id="5625855">(</span><span class="op" id="5625856">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5625859">c</span><span class="op" id="5625860">.</span><span class="ident" id="5625861">ProcessState</span>&nbsp;<span class="op" id="5625874">=</span>&nbsp;<span class="ident" id="5625876">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625884">var</span>&nbsp;<span class="ident" id="5625888">copyError</span>&nbsp;<span class="builtintype" id="5625898">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625905">for</span>&nbsp;<span class="keyword" id="5625909">range</span>&nbsp;<span class="ident" id="5625915">c</span><span class="op" id="5625916">.</span><span class="ident" id="5625917">goroutine</span>&nbsp;<span class="op" id="5625927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5625931">if</span>&nbsp;<span class="ident" id="5625934">err</span>&nbsp;<span class="op" id="5625938">:=</span>&nbsp;<span class="op" id="5625941">&lt;-</span><span class="ident" id="5625943">c</span><span class="op" id="5625944">.</span><span class="ident" id="5625945">errch</span><span class="op" id="5625950">;</span>&nbsp;<span class="ident" id="5625952">err</span>&nbsp;<span class="op" id="5625956">!=</span>&nbsp;<span class="builtintype" id="5625959">nil</span>&nbsp;<span class="op" id="5625963">&amp;&amp;</span>&nbsp;<span class="ident" id="5625966">copyError</span>&nbsp;<span class="op" id="5625976">==</span>&nbsp;<span class="builtintype" id="5625979">nil</span>&nbsp;<span class="op" id="5625983">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5625988">copyError</span>&nbsp;<span class="op" id="5625998">=</span>&nbsp;<span class="ident" id="5626000">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5626013">c</span><span class="op" id="5626014">.</span><span class="ident" id="5626015">closeDescriptors</span><span class="op" id="5626031">(</span><span class="ident" id="5626032">c</span><span class="op" id="5626033">.</span><span class="ident" id="5626034">closeAfterWait</span><span class="op" id="5626048">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626052">if</span>&nbsp;<span class="ident" id="5626055">err</span>&nbsp;<span class="op" id="5626059">!=</span>&nbsp;<span class="builtintype" id="5626062">nil</span>&nbsp;<span class="op" id="5626066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626070">return</span>&nbsp;<span class="ident" id="5626077">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626082">}</span>&nbsp;<span class="keyword" id="5626084">else</span>&nbsp;<span class="keyword" id="5626089">if</span>&nbsp;<span class="op" id="5626092">!</span><span class="ident" id="5626093">state</span><span class="op" id="5626098">.</span><span class="ident" id="5626099">Success</span><span class="op" id="5626106">(</span><span class="op" id="5626107">)</span>&nbsp;<span class="op" id="5626109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626113">return</span>&nbsp;<span class="op" id="5626120">&amp;</span><span class="ident" id="5626121">ExitError</span><span class="op" id="5626130">{</span><span class="ident" id="5626131">state</span><span class="op" id="5626136">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626143">return</span>&nbsp;<span class="ident" id="5626150">copyError</span><br>
<span class="lineno"></span><span class="op" id="5626160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5626163">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5626223">func</span>&nbsp;<span class="op" id="5626228">(</span><span class="ident" id="5626229">c</span>&nbsp;<span class="op" id="5626231">*</span><span class="ident" id="5626232">Cmd</span><span class="op" id="5626235">)</span>&nbsp;<span class="ident" id="5626237">Output</span><span class="op" id="5626243">(</span><span class="op" id="5626244">)</span>&nbsp;<span class="op" id="5626246">(</span><span class="op" id="5626247">[</span><span class="op" id="5626248">]</span><span class="builtintype" id="5626249">byte</span><span class="op" id="5626253">,</span>&nbsp;<span class="builtintype" id="5626255">error</span><span class="op" id="5626260">)</span>&nbsp;<span class="op" id="5626262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626265">if</span>&nbsp;<span class="ident" id="5626268">c</span><span class="op" id="5626269">.</span><span class="ident" id="5626270">Stdout</span>&nbsp;<span class="op" id="5626277">!=</span>&nbsp;<span class="builtintype" id="5626280">nil</span>&nbsp;<span class="op" id="5626284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626288">return</span>&nbsp;<span class="builtintype" id="5626295">nil</span><span class="op" id="5626298">,</span>&nbsp;<span class="ident" id="5626300">errors</span><span class="op" id="5626306">.</span><span class="ident" id="5626307">New</span><span class="op" id="5626310">(</span><span class="string" id="5626311">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5626337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626340">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626343">var</span>&nbsp;<span class="ident" id="5626347">b</span>&nbsp;<span class="ident" id="5626349">bytes</span><span class="op" id="5626354">.</span><span class="ident" id="5626355">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5626363">c</span><span class="op" id="5626364">.</span><span class="ident" id="5626365">Stdout</span>&nbsp;<span class="op" id="5626372">=</span>&nbsp;<span class="op" id="5626374">&amp;</span><span class="ident" id="5626375">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5626378">err</span>&nbsp;<span class="op" id="5626382">:=</span>&nbsp;<span class="ident" id="5626385">c</span><span class="op" id="5626386">.</span><span class="ident" id="5626387">Run</span><span class="op" id="5626390">(</span><span class="op" id="5626391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626394">return</span>&nbsp;<span class="ident" id="5626401">b</span><span class="op" id="5626402">.</span><span class="ident" id="5626403">Bytes</span><span class="op" id="5626408">(</span><span class="op" id="5626409">)</span><span class="op" id="5626410">,</span>&nbsp;<span class="ident" id="5626412">err</span><br>
<span class="lineno"></span><span class="op" id="5626416">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5626419">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5626488">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5626518">func</span>&nbsp;<span class="op" id="5626523">(</span><span class="ident" id="5626524">c</span>&nbsp;<span class="op" id="5626526">*</span><span class="ident" id="5626527">Cmd</span><span class="op" id="5626530">)</span>&nbsp;<span class="ident" id="5626532">CombinedOutput</span><span class="op" id="5626546">(</span><span class="op" id="5626547">)</span>&nbsp;<span class="op" id="5626549">(</span><span class="op" id="5626550">[</span><span class="op" id="5626551">]</span><span class="builtintype" id="5626552">byte</span><span class="op" id="5626556">,</span>&nbsp;<span class="builtintype" id="5626558">error</span><span class="op" id="5626563">)</span>&nbsp;<span class="op" id="5626565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626568">if</span>&nbsp;<span class="ident" id="5626571">c</span><span class="op" id="5626572">.</span><span class="ident" id="5626573">Stdout</span>&nbsp;<span class="op" id="5626580">!=</span>&nbsp;<span class="builtintype" id="5626583">nil</span>&nbsp;<span class="op" id="5626587">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626591">return</span>&nbsp;<span class="builtintype" id="5626598">nil</span><span class="op" id="5626601">,</span>&nbsp;<span class="ident" id="5626603">errors</span><span class="op" id="5626609">.</span><span class="ident" id="5626610">New</span><span class="op" id="5626613">(</span><span class="string" id="5626614">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5626640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626646">if</span>&nbsp;<span class="ident" id="5626649">c</span><span class="op" id="5626650">.</span><span class="ident" id="5626651">Stderr</span>&nbsp;<span class="op" id="5626658">!=</span>&nbsp;<span class="builtintype" id="5626661">nil</span>&nbsp;<span class="op" id="5626665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626669">return</span>&nbsp;<span class="builtintype" id="5626676">nil</span><span class="op" id="5626679">,</span>&nbsp;<span class="ident" id="5626681">errors</span><span class="op" id="5626687">.</span><span class="ident" id="5626688">New</span><span class="op" id="5626691">(</span><span class="string" id="5626692">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5626718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5626721">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626724">var</span>&nbsp;<span class="ident" id="5626728">b</span>&nbsp;<span class="ident" id="5626730">bytes</span><span class="op" id="5626735">.</span><span class="ident" id="5626736">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5626744">c</span><span class="op" id="5626745">.</span><span class="ident" id="5626746">Stdout</span>&nbsp;<span class="op" id="5626753">=</span>&nbsp;<span class="op" id="5626755">&amp;</span><span class="ident" id="5626756">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5626759">c</span><span class="op" id="5626760">.</span><span class="ident" id="5626761">Stderr</span>&nbsp;<span class="op" id="5626768">=</span>&nbsp;<span class="op" id="5626770">&amp;</span><span class="ident" id="5626771">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5626774">err</span>&nbsp;<span class="op" id="5626778">:=</span>&nbsp;<span class="ident" id="5626781">c</span><span class="op" id="5626782">.</span><span class="ident" id="5626783">Run</span><span class="op" id="5626786">(</span><span class="op" id="5626787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5626790">return</span>&nbsp;<span class="ident" id="5626797">b</span><span class="op" id="5626798">.</span><span class="ident" id="5626799">Bytes</span><span class="op" id="5626804">(</span><span class="op" id="5626805">)</span><span class="op" id="5626806">,</span>&nbsp;<span class="ident" id="5626808">err</span><br>
<span class="lineno">410</span><span class="op" id="5626812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5626815">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5626883">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5626926">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5627001">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5627069">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5627145">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5627191">func</span>&nbsp;<span class="op" id="5627196">(</span><span class="ident" id="5627197">c</span>&nbsp;<span class="op" id="5627199">*</span><span class="ident" id="5627200">Cmd</span><span class="op" id="5627203">)</span>&nbsp;<span class="ident" id="5627205">StdinPipe</span><span class="op" id="5627214">(</span><span class="op" id="5627215">)</span>&nbsp;<span class="op" id="5627217">(</span><span class="ident" id="5627218">io</span><span class="op" id="5627220">.</span><span class="ident" id="5627221">WriteCloser</span><span class="op" id="5627232">,</span>&nbsp;<span class="builtintype" id="5627234">error</span><span class="op" id="5627239">)</span>&nbsp;<span class="op" id="5627241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627244">if</span>&nbsp;<span class="ident" id="5627247">c</span><span class="op" id="5627248">.</span><span class="ident" id="5627249">Stdin</span>&nbsp;<span class="op" id="5627255">!=</span>&nbsp;<span class="builtintype" id="5627258">nil</span>&nbsp;<span class="op" id="5627262">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627266">return</span>&nbsp;<span class="builtintype" id="5627273">nil</span><span class="op" id="5627276">,</span>&nbsp;<span class="ident" id="5627278">errors</span><span class="op" id="5627284">.</span><span class="ident" id="5627285">New</span><span class="op" id="5627288">(</span><span class="string" id="5627289">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5627314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5627317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627320">if</span>&nbsp;<span class="ident" id="5627323">c</span><span class="op" id="5627324">.</span><span class="ident" id="5627325">Process</span>&nbsp;<span class="op" id="5627333">!=</span>&nbsp;<span class="builtintype" id="5627336">nil</span>&nbsp;<span class="op" id="5627340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627344">return</span>&nbsp;<span class="builtintype" id="5627351">nil</span><span class="op" id="5627354">,</span>&nbsp;<span class="ident" id="5627356">errors</span><span class="op" id="5627362">.</span><span class="ident" id="5627363">New</span><span class="op" id="5627366">(</span><span class="string" id="5627367">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5627406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5627409">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627412">pr</span><span class="op" id="5627414">,</span>&nbsp;<span class="ident" id="5627416">pw</span><span class="op" id="5627418">,</span>&nbsp;<span class="ident" id="5627420">err</span>&nbsp;<span class="op" id="5627424">:=</span>&nbsp;<span class="ident" id="5627427">os</span><span class="op" id="5627429">.</span><span class="ident" id="5627430">Pipe</span><span class="op" id="5627434">(</span><span class="op" id="5627435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627438">if</span>&nbsp;<span class="ident" id="5627441">err</span>&nbsp;<span class="op" id="5627445">!=</span>&nbsp;<span class="builtintype" id="5627448">nil</span>&nbsp;<span class="op" id="5627452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627456">return</span>&nbsp;<span class="builtintype" id="5627463">nil</span><span class="op" id="5627466">,</span>&nbsp;<span class="ident" id="5627468">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5627473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627476">c</span><span class="op" id="5627477">.</span><span class="ident" id="5627478">Stdin</span>&nbsp;<span class="op" id="5627484">=</span>&nbsp;<span class="ident" id="5627486">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627490">c</span><span class="op" id="5627491">.</span><span class="ident" id="5627492">closeAfterStart</span>&nbsp;<span class="op" id="5627508">=</span>&nbsp;<span class="builtinfunc" id="5627510">append</span><span class="op" id="5627516">(</span><span class="ident" id="5627517">c</span><span class="op" id="5627518">.</span><span class="ident" id="5627519">closeAfterStart</span><span class="op" id="5627534">,</span>&nbsp;<span class="ident" id="5627536">pr</span><span class="op" id="5627538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627541">wc</span>&nbsp;<span class="op" id="5627544">:=</span>&nbsp;<span class="op" id="5627547">&amp;</span><span class="ident" id="5627548">closeOnce</span><span class="op" id="5627557">{</span><span class="ident" id="5627558">File</span><span class="op" id="5627562">:</span>&nbsp;<span class="ident" id="5627564">pw</span><span class="op" id="5627566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627569">c</span><span class="op" id="5627570">.</span><span class="ident" id="5627571">closeAfterWait</span>&nbsp;<span class="op" id="5627586">=</span>&nbsp;<span class="builtinfunc" id="5627588">append</span><span class="op" id="5627594">(</span><span class="ident" id="5627595">c</span><span class="op" id="5627596">.</span><span class="ident" id="5627597">closeAfterWait</span><span class="op" id="5627611">,</span>&nbsp;<span class="ident" id="5627613">wc</span><span class="op" id="5627615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627618">return</span>&nbsp;<span class="ident" id="5627625">wc</span><span class="op" id="5627627">,</span>&nbsp;<span class="builtintype" id="5627629">nil</span><br>
<span class="lineno"></span><span class="op" id="5627633">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5627636">type</span>&nbsp;<span class="ident" id="5627641">closeOnce</span>&nbsp;<span class="keyword" id="5627651">struct</span>&nbsp;<span class="op" id="5627658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5627661">*</span><span class="ident" id="5627662">os</span><span class="op" id="5627664">.</span><span class="ident" id="5627665">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627672">once</span>&nbsp;<span class="ident" id="5627677">sync</span><span class="op" id="5627681">.</span><span class="ident" id="5627682">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627688">err</span>&nbsp;&nbsp;<span class="builtintype" id="5627693">error</span><br>
<span class="lineno"></span><span class="op" id="5627699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5627702">func</span>&nbsp;<span class="op" id="5627707">(</span><span class="ident" id="5627708">c</span>&nbsp;<span class="op" id="5627710">*</span><span class="ident" id="5627711">closeOnce</span><span class="op" id="5627720">)</span>&nbsp;<span class="ident" id="5627722">Close</span><span class="op" id="5627727">(</span><span class="op" id="5627728">)</span>&nbsp;<span class="builtintype" id="5627730">error</span>&nbsp;<span class="op" id="5627736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627739">c</span><span class="op" id="5627740">.</span><span class="ident" id="5627741">once</span><span class="op" id="5627745">.</span><span class="ident" id="5627746">Do</span><span class="op" id="5627748">(</span><span class="ident" id="5627749">c</span><span class="op" id="5627750">.</span><span class="builtinfunc" id="5627751">close</span><span class="op" id="5627756">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5627759">return</span>&nbsp;<span class="ident" id="5627766">c</span><span class="op" id="5627767">.</span><span class="ident" id="5627768">err</span><br>
<span class="lineno"></span><span class="op" id="5627772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5627775">func</span>&nbsp;<span class="op" id="5627780">(</span><span class="ident" id="5627781">c</span>&nbsp;<span class="op" id="5627783">*</span><span class="ident" id="5627784">closeOnce</span><span class="op" id="5627793">)</span>&nbsp;<span class="builtinfunc" id="5627795">close</span><span class="op" id="5627800">(</span><span class="op" id="5627801">)</span>&nbsp;<span class="op" id="5627803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5627806">c</span><span class="op" id="5627807">.</span><span class="ident" id="5627808">err</span>&nbsp;<span class="op" id="5627812">=</span>&nbsp;<span class="ident" id="5627814">c</span><span class="op" id="5627815">.</span><span class="ident" id="5627816">File</span><span class="op" id="5627820">.</span><span class="ident" id="5627821">Close</span><span class="op" id="5627826">(</span><span class="op" id="5627827">)</span><br>
<span class="lineno">450</span><span class="op" id="5627829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5627832">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5627901">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5627945">//</span><br>
<span class="lineno">455</span><span class="comment" id="5627948">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5628023">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5628094">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5628173">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5628248">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5628288">func</span>&nbsp;<span class="op" id="5628293">(</span><span class="ident" id="5628294">c</span>&nbsp;<span class="op" id="5628296">*</span><span class="ident" id="5628297">Cmd</span><span class="op" id="5628300">)</span>&nbsp;<span class="ident" id="5628302">StdoutPipe</span><span class="op" id="5628312">(</span><span class="op" id="5628313">)</span>&nbsp;<span class="op" id="5628315">(</span><span class="ident" id="5628316">io</span><span class="op" id="5628318">.</span><span class="ident" id="5628319">ReadCloser</span><span class="op" id="5628329">,</span>&nbsp;<span class="builtintype" id="5628331">error</span><span class="op" id="5628336">)</span>&nbsp;<span class="op" id="5628338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628341">if</span>&nbsp;<span class="ident" id="5628344">c</span><span class="op" id="5628345">.</span><span class="ident" id="5628346">Stdout</span>&nbsp;<span class="op" id="5628353">!=</span>&nbsp;<span class="builtintype" id="5628356">nil</span>&nbsp;<span class="op" id="5628360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628364">return</span>&nbsp;<span class="builtintype" id="5628371">nil</span><span class="op" id="5628374">,</span>&nbsp;<span class="ident" id="5628376">errors</span><span class="op" id="5628382">.</span><span class="ident" id="5628383">New</span><span class="op" id="5628386">(</span><span class="string" id="5628387">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5628413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5628416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628419">if</span>&nbsp;<span class="ident" id="5628422">c</span><span class="op" id="5628423">.</span><span class="ident" id="5628424">Process</span>&nbsp;<span class="op" id="5628432">!=</span>&nbsp;<span class="builtintype" id="5628435">nil</span>&nbsp;<span class="op" id="5628439">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628443">return</span>&nbsp;<span class="builtintype" id="5628450">nil</span><span class="op" id="5628453">,</span>&nbsp;<span class="ident" id="5628455">errors</span><span class="op" id="5628461">.</span><span class="ident" id="5628462">New</span><span class="op" id="5628465">(</span><span class="string" id="5628466">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5628506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5628509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5628512">pr</span><span class="op" id="5628514">,</span>&nbsp;<span class="ident" id="5628516">pw</span><span class="op" id="5628518">,</span>&nbsp;<span class="ident" id="5628520">err</span>&nbsp;<span class="op" id="5628524">:=</span>&nbsp;<span class="ident" id="5628527">os</span><span class="op" id="5628529">.</span><span class="ident" id="5628530">Pipe</span><span class="op" id="5628534">(</span><span class="op" id="5628535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628538">if</span>&nbsp;<span class="ident" id="5628541">err</span>&nbsp;<span class="op" id="5628545">!=</span>&nbsp;<span class="builtintype" id="5628548">nil</span>&nbsp;<span class="op" id="5628552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628556">return</span>&nbsp;<span class="builtintype" id="5628563">nil</span><span class="op" id="5628566">,</span>&nbsp;<span class="ident" id="5628568">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5628573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5628576">c</span><span class="op" id="5628577">.</span><span class="ident" id="5628578">Stdout</span>&nbsp;<span class="op" id="5628585">=</span>&nbsp;<span class="ident" id="5628587">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5628591">c</span><span class="op" id="5628592">.</span><span class="ident" id="5628593">closeAfterStart</span>&nbsp;<span class="op" id="5628609">=</span>&nbsp;<span class="builtinfunc" id="5628611">append</span><span class="op" id="5628617">(</span><span class="ident" id="5628618">c</span><span class="op" id="5628619">.</span><span class="ident" id="5628620">closeAfterStart</span><span class="op" id="5628635">,</span>&nbsp;<span class="ident" id="5628637">pw</span><span class="op" id="5628639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5628642">c</span><span class="op" id="5628643">.</span><span class="ident" id="5628644">closeAfterWait</span>&nbsp;<span class="op" id="5628659">=</span>&nbsp;<span class="builtinfunc" id="5628661">append</span><span class="op" id="5628667">(</span><span class="ident" id="5628668">c</span><span class="op" id="5628669">.</span><span class="ident" id="5628670">closeAfterWait</span><span class="op" id="5628684">,</span>&nbsp;<span class="ident" id="5628686">pr</span><span class="op" id="5628688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5628691">return</span>&nbsp;<span class="ident" id="5628698">pr</span><span class="op" id="5628700">,</span>&nbsp;<span class="builtintype" id="5628702">nil</span><br>
<span class="lineno">475</span><span class="op" id="5628706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5628709">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5628778">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5628821">//</span><br>
<span class="lineno">480</span><span class="comment" id="5628824">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5628899">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5628970">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5629049">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5629123">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5629174">func</span>&nbsp;<span class="op" id="5629179">(</span><span class="ident" id="5629180">c</span>&nbsp;<span class="op" id="5629182">*</span><span class="ident" id="5629183">Cmd</span><span class="op" id="5629186">)</span>&nbsp;<span class="ident" id="5629188">StderrPipe</span><span class="op" id="5629198">(</span><span class="op" id="5629199">)</span>&nbsp;<span class="op" id="5629201">(</span><span class="ident" id="5629202">io</span><span class="op" id="5629204">.</span><span class="ident" id="5629205">ReadCloser</span><span class="op" id="5629215">,</span>&nbsp;<span class="builtintype" id="5629217">error</span><span class="op" id="5629222">)</span>&nbsp;<span class="op" id="5629224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629227">if</span>&nbsp;<span class="ident" id="5629230">c</span><span class="op" id="5629231">.</span><span class="ident" id="5629232">Stderr</span>&nbsp;<span class="op" id="5629239">!=</span>&nbsp;<span class="builtintype" id="5629242">nil</span>&nbsp;<span class="op" id="5629246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629250">return</span>&nbsp;<span class="builtintype" id="5629257">nil</span><span class="op" id="5629260">,</span>&nbsp;<span class="ident" id="5629262">errors</span><span class="op" id="5629268">.</span><span class="ident" id="5629269">New</span><span class="op" id="5629272">(</span><span class="string" id="5629273">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5629299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5629302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629305">if</span>&nbsp;<span class="ident" id="5629308">c</span><span class="op" id="5629309">.</span><span class="ident" id="5629310">Process</span>&nbsp;<span class="op" id="5629318">!=</span>&nbsp;<span class="builtintype" id="5629321">nil</span>&nbsp;<span class="op" id="5629325">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629329">return</span>&nbsp;<span class="builtintype" id="5629336">nil</span><span class="op" id="5629339">,</span>&nbsp;<span class="ident" id="5629341">errors</span><span class="op" id="5629347">.</span><span class="ident" id="5629348">New</span><span class="op" id="5629351">(</span><span class="string" id="5629352">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5629392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5629395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5629398">pr</span><span class="op" id="5629400">,</span>&nbsp;<span class="ident" id="5629402">pw</span><span class="op" id="5629404">,</span>&nbsp;<span class="ident" id="5629406">err</span>&nbsp;<span class="op" id="5629410">:=</span>&nbsp;<span class="ident" id="5629413">os</span><span class="op" id="5629415">.</span><span class="ident" id="5629416">Pipe</span><span class="op" id="5629420">(</span><span class="op" id="5629421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629424">if</span>&nbsp;<span class="ident" id="5629427">err</span>&nbsp;<span class="op" id="5629431">!=</span>&nbsp;<span class="builtintype" id="5629434">nil</span>&nbsp;<span class="op" id="5629438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629442">return</span>&nbsp;<span class="builtintype" id="5629449">nil</span><span class="op" id="5629452">,</span>&nbsp;<span class="ident" id="5629454">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5629459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5629462">c</span><span class="op" id="5629463">.</span><span class="ident" id="5629464">Stderr</span>&nbsp;<span class="op" id="5629471">=</span>&nbsp;<span class="ident" id="5629473">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5629477">c</span><span class="op" id="5629478">.</span><span class="ident" id="5629479">closeAfterStart</span>&nbsp;<span class="op" id="5629495">=</span>&nbsp;<span class="builtinfunc" id="5629497">append</span><span class="op" id="5629503">(</span><span class="ident" id="5629504">c</span><span class="op" id="5629505">.</span><span class="ident" id="5629506">closeAfterStart</span><span class="op" id="5629521">,</span>&nbsp;<span class="ident" id="5629523">pw</span><span class="op" id="5629525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5629528">c</span><span class="op" id="5629529">.</span><span class="ident" id="5629530">closeAfterWait</span>&nbsp;<span class="op" id="5629545">=</span>&nbsp;<span class="builtinfunc" id="5629547">append</span><span class="op" id="5629553">(</span><span class="ident" id="5629554">c</span><span class="op" id="5629555">.</span><span class="ident" id="5629556">closeAfterWait</span><span class="op" id="5629570">,</span>&nbsp;<span class="ident" id="5629572">pr</span><span class="op" id="5629574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5629577">return</span>&nbsp;<span class="ident" id="5629584">pr</span><span class="op" id="5629586">,</span>&nbsp;<span class="builtintype" id="5629588">nil</span><br>
<span class="lineno">500</span><span class="op" id="5629592">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
