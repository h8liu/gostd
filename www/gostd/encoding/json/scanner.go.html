<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5389588">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5389644">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5389698">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5389749">package</span>&nbsp;<span class="ident" id="5389757">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5389763">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="5389799">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="5389866">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="5389937">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5389999">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="5390065">//</span><br>
<span class="lineno"></span><span class="comment" id="5390068">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="5390131">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5390174">import</span>&nbsp;<span class="string" id="5390181">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390192">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="5390253">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="5390320">func</span>&nbsp;<span class="ident" id="5390325">checkValid</span><span class="op" id="5390335">(</span><span class="ident" id="5390336">data</span>&nbsp;<span class="op" id="5390341">[</span><span class="op" id="5390342">]</span><span class="builtintype" id="5390343">byte</span><span class="op" id="5390347">,</span>&nbsp;<span class="ident" id="5390349">scan</span>&nbsp;<span class="op" id="5390354">*</span><span class="ident" id="5390355">scanner</span><span class="op" id="5390362">)</span>&nbsp;<span class="builtintype" id="5390364">error</span>&nbsp;<span class="op" id="5390370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390373">scan</span><span class="op" id="5390377">.</span><span class="ident" id="5390378">reset</span><span class="op" id="5390383">(</span><span class="op" id="5390384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390387">for</span>&nbsp;<span class="ident" id="5390391">_</span><span class="op" id="5390392">,</span>&nbsp;<span class="ident" id="5390394">c</span>&nbsp;<span class="op" id="5390396">:=</span>&nbsp;<span class="keyword" id="5390399">range</span>&nbsp;<span class="ident" id="5390405">data</span>&nbsp;<span class="op" id="5390410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390414">scan</span><span class="op" id="5390418">.</span><span class="ident" id="5390419">bytes</span><span class="op" id="5390424">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390429">if</span>&nbsp;<span class="ident" id="5390432">scan</span><span class="op" id="5390436">.</span><span class="ident" id="5390437">step</span><span class="op" id="5390441">(</span><span class="ident" id="5390442">scan</span><span class="op" id="5390446">,</span>&nbsp;<span class="builtintype" id="5390448">int</span><span class="op" id="5390451">(</span><span class="ident" id="5390452">c</span><span class="op" id="5390453">)</span><span class="op" id="5390454">)</span>&nbsp;<span class="op" id="5390456">==</span>&nbsp;<span class="ident" id="5390459">scanError</span>&nbsp;<span class="op" id="5390469">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390474">return</span>&nbsp;<span class="ident" id="5390481">scan</span><span class="op" id="5390485">.</span><span class="ident" id="5390486">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390498">if</span>&nbsp;<span class="ident" id="5390501">scan</span><span class="op" id="5390505">.</span><span class="ident" id="5390506">eof</span><span class="op" id="5390509">(</span><span class="op" id="5390510">)</span>&nbsp;<span class="op" id="5390512">==</span>&nbsp;<span class="ident" id="5390515">scanError</span>&nbsp;<span class="op" id="5390525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390529">return</span>&nbsp;<span class="ident" id="5390536">scan</span><span class="op" id="5390540">.</span><span class="ident" id="5390541">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5390546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390549">return</span>&nbsp;<span class="builtintype" id="5390556">nil</span><br>
<span class="lineno"></span><span class="op" id="5390560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5390563">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="5390621">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="5390694">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5390760">func</span>&nbsp;<span class="ident" id="5390765">nextValue</span><span class="op" id="5390774">(</span><span class="ident" id="5390775">data</span>&nbsp;<span class="op" id="5390780">[</span><span class="op" id="5390781">]</span><span class="builtintype" id="5390782">byte</span><span class="op" id="5390786">,</span>&nbsp;<span class="ident" id="5390788">scan</span>&nbsp;<span class="op" id="5390793">*</span><span class="ident" id="5390794">scanner</span><span class="op" id="5390801">)</span>&nbsp;<span class="op" id="5390803">(</span><span class="ident" id="5390804">value</span><span class="op" id="5390809">,</span>&nbsp;<span class="ident" id="5390811">rest</span>&nbsp;<span class="op" id="5390816">[</span><span class="op" id="5390817">]</span><span class="builtintype" id="5390818">byte</span><span class="op" id="5390822">,</span>&nbsp;<span class="ident" id="5390824">err</span>&nbsp;<span class="builtintype" id="5390828">error</span><span class="op" id="5390833">)</span>&nbsp;<span class="op" id="5390835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390838">scan</span><span class="op" id="5390842">.</span><span class="ident" id="5390843">reset</span><span class="op" id="5390848">(</span><span class="op" id="5390849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390852">for</span>&nbsp;<span class="ident" id="5390856">i</span><span class="op" id="5390857">,</span>&nbsp;<span class="ident" id="5390859">c</span>&nbsp;<span class="op" id="5390861">:=</span>&nbsp;<span class="keyword" id="5390864">range</span>&nbsp;<span class="ident" id="5390870">data</span>&nbsp;<span class="op" id="5390875">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5390879">v</span>&nbsp;<span class="op" id="5390881">:=</span>&nbsp;<span class="ident" id="5390884">scan</span><span class="op" id="5390888">.</span><span class="ident" id="5390889">step</span><span class="op" id="5390893">(</span><span class="ident" id="5390894">scan</span><span class="op" id="5390898">,</span>&nbsp;<span class="builtintype" id="5390900">int</span><span class="op" id="5390903">(</span><span class="ident" id="5390904">c</span><span class="op" id="5390905">)</span><span class="op" id="5390906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390910">if</span>&nbsp;<span class="ident" id="5390913">v</span>&nbsp;<span class="op" id="5390915">&gt;=</span>&nbsp;<span class="ident" id="5390918">scanEnd</span>&nbsp;<span class="op" id="5390926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390931">switch</span>&nbsp;<span class="ident" id="5390938">v</span>&nbsp;<span class="op" id="5390940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390945">case</span>&nbsp;<span class="ident" id="5390950">scanError</span><span class="op" id="5390959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390965">return</span>&nbsp;<span class="builtintype" id="5390972">nil</span><span class="op" id="5390975">,</span>&nbsp;<span class="builtintype" id="5390977">nil</span><span class="op" id="5390980">,</span>&nbsp;<span class="ident" id="5390982">scan</span><span class="op" id="5390986">.</span><span class="ident" id="5390987">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5390994">case</span>&nbsp;<span class="ident" id="5390999">scanEnd</span><span class="op" id="5391006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391012">return</span>&nbsp;<span class="ident" id="5391019">data</span><span class="op" id="5391023">[</span><span class="num" id="5391024">0</span><span class="op" id="5391025">:</span><span class="ident" id="5391026">i</span><span class="op" id="5391027">]</span><span class="op" id="5391028">,</span>&nbsp;<span class="ident" id="5391030">data</span><span class="op" id="5391034">[</span><span class="ident" id="5391035">i</span><span class="op" id="5391036">:</span><span class="op" id="5391037">]</span><span class="op" id="5391038">,</span>&nbsp;<span class="builtintype" id="5391040">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391054">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391057">if</span>&nbsp;<span class="ident" id="5391060">scan</span><span class="op" id="5391064">.</span><span class="ident" id="5391065">eof</span><span class="op" id="5391068">(</span><span class="op" id="5391069">)</span>&nbsp;<span class="op" id="5391071">==</span>&nbsp;<span class="ident" id="5391074">scanError</span>&nbsp;<span class="op" id="5391084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391088">return</span>&nbsp;<span class="builtintype" id="5391095">nil</span><span class="op" id="5391098">,</span>&nbsp;<span class="builtintype" id="5391100">nil</span><span class="op" id="5391103">,</span>&nbsp;<span class="ident" id="5391105">scan</span><span class="op" id="5391109">.</span><span class="ident" id="5391110">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5391115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5391118">return</span>&nbsp;<span class="ident" id="5391125">data</span><span class="op" id="5391129">,</span>&nbsp;<span class="builtintype" id="5391131">nil</span><span class="op" id="5391134">,</span>&nbsp;<span class="builtintype" id="5391136">nil</span><br>
<span class="lineno"></span><span class="op" id="5391140">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5391143">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5391201">type</span>&nbsp;<span class="ident" id="5391206">SyntaxError</span>&nbsp;<span class="keyword" id="5391218">struct</span>&nbsp;<span class="op" id="5391225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391228">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5391235">string</span>&nbsp;<span class="comment" id="5391242">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5391267">Offset</span>&nbsp;<span class="ident" id="5391274">int64</span>&nbsp;&nbsp;<span class="comment" id="5391281">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="5391326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5391329">func</span>&nbsp;<span class="op" id="5391334">(</span><span class="ident" id="5391335">e</span>&nbsp;<span class="op" id="5391337">*</span><span class="ident" id="5391338">SyntaxError</span><span class="op" id="5391349">)</span>&nbsp;<span class="ident" id="5391351">Error</span><span class="op" id="5391356">(</span><span class="op" id="5391357">)</span>&nbsp;<span class="builtintype" id="5391359">string</span>&nbsp;<span class="op" id="5391366">{</span>&nbsp;<span class="keyword" id="5391368">return</span>&nbsp;<span class="ident" id="5391375">e</span><span class="op" id="5391376">.</span><span class="ident" id="5391377">msg</span>&nbsp;<span class="op" id="5391381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5391384">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="5391431">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="5391497">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="5391546">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5391603">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="5391661">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="5391718">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="5391759">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="5391821">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5391878">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5391943">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="5392003">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="5392035">type</span>&nbsp;<span class="ident" id="5392040">scanner</span>&nbsp;<span class="keyword" id="5392048">struct</span>&nbsp;<span class="op" id="5392055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392058">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392126">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392185">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392247">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392297">step</span>&nbsp;<span class="keyword" id="5392302">func</span><span class="op" id="5392306">(</span><span class="op" id="5392307">*</span><span class="ident" id="5392308">scanner</span><span class="op" id="5392315">,</span>&nbsp;<span class="builtintype" id="5392317">int</span><span class="op" id="5392320">)</span>&nbsp;<span class="builtintype" id="5392322">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392328">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392364">endTop</span>&nbsp;<span class="builtintype" id="5392371">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392378">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392463">parseState</span>&nbsp;<span class="op" id="5392474">[</span><span class="op" id="5392475">]</span><span class="builtintype" id="5392476">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392482">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392515">err</span>&nbsp;<span class="builtintype" id="5392519">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392527">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392561">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5392571">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392577">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="5392587">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392592">redoState</span>&nbsp;<span class="keyword" id="5392602">func</span><span class="op" id="5392606">(</span><span class="op" id="5392607">*</span><span class="ident" id="5392608">scanner</span><span class="op" id="5392615">,</span>&nbsp;<span class="builtintype" id="5392617">int</span><span class="op" id="5392620">)</span>&nbsp;<span class="builtintype" id="5392622">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5392628">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5392680">bytes</span>&nbsp;<span class="ident" id="5392686">int64</span><br>
<span class="lineno"></span><span class="op" id="5392692">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5392695">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5392758">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="5392815">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5392877">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="5392923">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="5392982">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="5393039">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="5393091">const</span>&nbsp;<span class="op" id="5393097">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393100">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393114">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5393131">=</span>&nbsp;<span class="ident" id="5393133">iota</span>&nbsp;<span class="comment" id="5393138">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393161">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393185">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393232">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393256">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393273">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393297">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393335">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393359">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393399">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393423">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393476">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393500">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393516">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393540">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393570">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393594">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393645">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393669">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5393731">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393741">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5393751">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5393829">scanError</span>&nbsp;<span class="comment" id="5393839">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="5393869">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5393872">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5393924">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5393976">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5394034">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="5394102">const</span>&nbsp;<span class="op" id="5394108">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394111">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5394128">=</span>&nbsp;<span class="ident" id="5394130">iota</span>&nbsp;<span class="comment" id="5394135">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394173">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5394197">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394236">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5394260">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="5394283">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5394286">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="5394325">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="5394369">func</span>&nbsp;<span class="op" id="5394374">(</span><span class="ident" id="5394375">s</span>&nbsp;<span class="op" id="5394377">*</span><span class="ident" id="5394378">scanner</span><span class="op" id="5394385">)</span>&nbsp;<span class="ident" id="5394387">reset</span><span class="op" id="5394392">(</span><span class="op" id="5394393">)</span>&nbsp;<span class="op" id="5394395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394398">s</span><span class="op" id="5394399">.</span><span class="ident" id="5394400">step</span>&nbsp;<span class="op" id="5394405">=</span>&nbsp;<span class="ident" id="5394407">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394424">s</span><span class="op" id="5394425">.</span><span class="ident" id="5394426">parseState</span>&nbsp;<span class="op" id="5394437">=</span>&nbsp;<span class="ident" id="5394439">s</span><span class="op" id="5394440">.</span><span class="ident" id="5394441">parseState</span><span class="op" id="5394451">[</span><span class="num" id="5394452">0</span><span class="op" id="5394453">:</span><span class="num" id="5394454">0</span><span class="op" id="5394455">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394458">s</span><span class="op" id="5394459">.</span><span class="ident" id="5394460">err</span>&nbsp;<span class="op" id="5394464">=</span>&nbsp;<span class="builtintype" id="5394466">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394471">s</span><span class="op" id="5394472">.</span><span class="ident" id="5394473">redo</span>&nbsp;<span class="op" id="5394478">=</span>&nbsp;<span class="builtintype" id="5394480">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394487">s</span><span class="op" id="5394488">.</span><span class="ident" id="5394489">endTop</span>&nbsp;<span class="op" id="5394496">=</span>&nbsp;<span class="builtintype" id="5394498">false</span><br>
<span class="lineno"></span><span class="op" id="5394504">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5394507">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="5394572">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="5394621">func</span>&nbsp;<span class="op" id="5394626">(</span><span class="ident" id="5394627">s</span>&nbsp;<span class="op" id="5394629">*</span><span class="ident" id="5394630">scanner</span><span class="op" id="5394637">)</span>&nbsp;<span class="ident" id="5394639">eof</span><span class="op" id="5394642">(</span><span class="op" id="5394643">)</span>&nbsp;<span class="builtintype" id="5394645">int</span>&nbsp;<span class="op" id="5394649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394652">if</span>&nbsp;<span class="ident" id="5394655">s</span><span class="op" id="5394656">.</span><span class="ident" id="5394657">err</span>&nbsp;<span class="op" id="5394661">!=</span>&nbsp;<span class="builtintype" id="5394664">nil</span>&nbsp;<span class="op" id="5394668">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394672">return</span>&nbsp;<span class="ident" id="5394679">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394693">if</span>&nbsp;<span class="ident" id="5394696">s</span><span class="op" id="5394697">.</span><span class="ident" id="5394698">endTop</span>&nbsp;<span class="op" id="5394705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394709">return</span>&nbsp;<span class="ident" id="5394716">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394725">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394728">s</span><span class="op" id="5394729">.</span><span class="ident" id="5394730">step</span><span class="op" id="5394734">(</span><span class="ident" id="5394735">s</span><span class="op" id="5394736">,</span>&nbsp;<span class="string" id="5394738">&#39;&nbsp;&#39;</span><span class="op" id="5394741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394744">if</span>&nbsp;<span class="ident" id="5394747">s</span><span class="op" id="5394748">.</span><span class="ident" id="5394749">endTop</span>&nbsp;<span class="op" id="5394756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394760">return</span>&nbsp;<span class="ident" id="5394767">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394779">if</span>&nbsp;<span class="ident" id="5394782">s</span><span class="op" id="5394783">.</span><span class="ident" id="5394784">err</span>&nbsp;<span class="op" id="5394788">==</span>&nbsp;<span class="builtintype" id="5394791">nil</span>&nbsp;<span class="op" id="5394795">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394799">s</span><span class="op" id="5394800">.</span><span class="ident" id="5394801">err</span>&nbsp;<span class="op" id="5394805">=</span>&nbsp;<span class="op" id="5394807">&amp;</span><span class="ident" id="5394808">SyntaxError</span><span class="op" id="5394819">{</span><span class="string" id="5394820">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="5394850">,</span>&nbsp;<span class="ident" id="5394852">s</span><span class="op" id="5394853">.</span><span class="ident" id="5394854">bytes</span><span class="op" id="5394859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5394862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5394865">return</span>&nbsp;<span class="ident" id="5394872">scanError</span><br>
<span class="lineno"></span><span class="op" id="5394882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="5394885">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5394952">func</span>&nbsp;<span class="op" id="5394957">(</span><span class="ident" id="5394958">s</span>&nbsp;<span class="op" id="5394960">*</span><span class="ident" id="5394961">scanner</span><span class="op" id="5394968">)</span>&nbsp;<span class="ident" id="5394970">pushParseState</span><span class="op" id="5394984">(</span><span class="ident" id="5394985">p</span>&nbsp;<span class="builtintype" id="5394987">int</span><span class="op" id="5394990">)</span>&nbsp;<span class="op" id="5394992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5394995">s</span><span class="op" id="5394996">.</span><span class="ident" id="5394997">parseState</span>&nbsp;<span class="op" id="5395008">=</span>&nbsp;<span class="builtinfunc" id="5395010">append</span><span class="op" id="5395016">(</span><span class="ident" id="5395017">s</span><span class="op" id="5395018">.</span><span class="ident" id="5395019">parseState</span><span class="op" id="5395029">,</span>&nbsp;<span class="ident" id="5395031">p</span><span class="op" id="5395032">)</span><br>
<span class="lineno"></span><span class="op" id="5395034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5395037">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="5395106">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="5395141">func</span>&nbsp;<span class="op" id="5395146">(</span><span class="ident" id="5395147">s</span>&nbsp;<span class="op" id="5395149">*</span><span class="ident" id="5395150">scanner</span><span class="op" id="5395157">)</span>&nbsp;<span class="ident" id="5395159">popParseState</span><span class="op" id="5395172">(</span><span class="op" id="5395173">)</span>&nbsp;<span class="op" id="5395175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395178">n</span>&nbsp;<span class="op" id="5395180">:=</span>&nbsp;<span class="builtinfunc" id="5395183">len</span><span class="op" id="5395186">(</span><span class="ident" id="5395187">s</span><span class="op" id="5395188">.</span><span class="ident" id="5395189">parseState</span><span class="op" id="5395199">)</span>&nbsp;<span class="op" id="5395201">-</span>&nbsp;<span class="num" id="5395203">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395206">s</span><span class="op" id="5395207">.</span><span class="ident" id="5395208">parseState</span>&nbsp;<span class="op" id="5395219">=</span>&nbsp;<span class="ident" id="5395221">s</span><span class="op" id="5395222">.</span><span class="ident" id="5395223">parseState</span><span class="op" id="5395233">[</span><span class="num" id="5395234">0</span><span class="op" id="5395235">:</span><span class="ident" id="5395236">n</span><span class="op" id="5395237">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395240">s</span><span class="op" id="5395241">.</span><span class="ident" id="5395242">redo</span>&nbsp;<span class="op" id="5395247">=</span>&nbsp;<span class="builtintype" id="5395249">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395256">if</span>&nbsp;<span class="ident" id="5395259">n</span>&nbsp;<span class="op" id="5395261">==</span>&nbsp;<span class="num" id="5395264">0</span>&nbsp;<span class="op" id="5395266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395270">s</span><span class="op" id="5395271">.</span><span class="ident" id="5395272">step</span>&nbsp;<span class="op" id="5395277">=</span>&nbsp;<span class="ident" id="5395279">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395293">s</span><span class="op" id="5395294">.</span><span class="ident" id="5395295">endTop</span>&nbsp;<span class="op" id="5395302">=</span>&nbsp;<span class="builtintype" id="5395304">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395310">}</span>&nbsp;<span class="keyword" id="5395312">else</span>&nbsp;<span class="op" id="5395317">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395321">s</span><span class="op" id="5395322">.</span><span class="ident" id="5395323">step</span>&nbsp;<span class="op" id="5395328">=</span>&nbsp;<span class="ident" id="5395330">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395345">}</span><br>
<span class="lineno"></span><span class="op" id="5395347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5395350">func</span>&nbsp;<span class="ident" id="5395355">isSpace</span><span class="op" id="5395362">(</span><span class="ident" id="5395363">c</span>&nbsp;<span class="builtintype" id="5395365">rune</span><span class="op" id="5395369">)</span>&nbsp;<span class="builtintype" id="5395371">bool</span>&nbsp;<span class="op" id="5395376">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395379">return</span>&nbsp;<span class="ident" id="5395386">c</span>&nbsp;<span class="op" id="5395388">==</span>&nbsp;<span class="string" id="5395391">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5395395">||</span>&nbsp;<span class="ident" id="5395398">c</span>&nbsp;<span class="op" id="5395400">==</span>&nbsp;<span class="string" id="5395403">&#39;\t&#39;</span>&nbsp;<span class="op" id="5395408">||</span>&nbsp;<span class="ident" id="5395411">c</span>&nbsp;<span class="op" id="5395413">==</span>&nbsp;<span class="string" id="5395416">&#39;\r&#39;</span>&nbsp;<span class="op" id="5395421">||</span>&nbsp;<span class="ident" id="5395424">c</span>&nbsp;<span class="op" id="5395426">==</span>&nbsp;<span class="string" id="5395429">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="5395434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5395437">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="5395495">func</span>&nbsp;<span class="ident" id="5395500">stateBeginValueOrEmpty</span><span class="op" id="5395522">(</span><span class="ident" id="5395523">s</span>&nbsp;<span class="op" id="5395525">*</span><span class="ident" id="5395526">scanner</span><span class="op" id="5395533">,</span>&nbsp;<span class="ident" id="5395535">c</span>&nbsp;<span class="builtintype" id="5395537">int</span><span class="op" id="5395540">)</span>&nbsp;<span class="builtintype" id="5395542">int</span>&nbsp;<span class="op" id="5395546">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395549">if</span>&nbsp;<span class="ident" id="5395552">c</span>&nbsp;<span class="op" id="5395554">&lt;=</span>&nbsp;<span class="string" id="5395557">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5395561">&amp;&amp;</span>&nbsp;<span class="ident" id="5395564">isSpace</span><span class="op" id="5395571">(</span><span class="builtintype" id="5395572">rune</span><span class="op" id="5395576">(</span><span class="ident" id="5395577">c</span><span class="op" id="5395578">)</span><span class="op" id="5395579">)</span>&nbsp;<span class="op" id="5395581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395585">return</span>&nbsp;<span class="ident" id="5395592">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395610">if</span>&nbsp;<span class="ident" id="5395613">c</span>&nbsp;<span class="op" id="5395615">==</span>&nbsp;<span class="string" id="5395618">&#39;]&#39;</span>&nbsp;<span class="op" id="5395622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395626">return</span>&nbsp;<span class="ident" id="5395633">stateEndValue</span><span class="op" id="5395646">(</span><span class="ident" id="5395647">s</span><span class="op" id="5395648">,</span>&nbsp;<span class="ident" id="5395650">c</span><span class="op" id="5395651">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395657">return</span>&nbsp;<span class="ident" id="5395664">stateBeginValue</span><span class="op" id="5395679">(</span><span class="ident" id="5395680">s</span><span class="op" id="5395681">,</span>&nbsp;<span class="ident" id="5395683">c</span><span class="op" id="5395684">)</span><br>
<span class="lineno"></span><span class="op" id="5395686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5395689">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="5395752">func</span>&nbsp;<span class="ident" id="5395757">stateBeginValue</span><span class="op" id="5395772">(</span><span class="ident" id="5395773">s</span>&nbsp;<span class="op" id="5395775">*</span><span class="ident" id="5395776">scanner</span><span class="op" id="5395783">,</span>&nbsp;<span class="ident" id="5395785">c</span>&nbsp;<span class="builtintype" id="5395787">int</span><span class="op" id="5395790">)</span>&nbsp;<span class="builtintype" id="5395792">int</span>&nbsp;<span class="op" id="5395796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395799">if</span>&nbsp;<span class="ident" id="5395802">c</span>&nbsp;<span class="op" id="5395804">&lt;=</span>&nbsp;<span class="string" id="5395807">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5395811">&amp;&amp;</span>&nbsp;<span class="ident" id="5395814">isSpace</span><span class="op" id="5395821">(</span><span class="builtintype" id="5395822">rune</span><span class="op" id="5395826">(</span><span class="ident" id="5395827">c</span><span class="op" id="5395828">)</span><span class="op" id="5395829">)</span>&nbsp;<span class="op" id="5395831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395835">return</span>&nbsp;<span class="ident" id="5395842">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5395857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395860">switch</span>&nbsp;<span class="ident" id="5395867">c</span>&nbsp;<span class="op" id="5395869">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395872">case</span>&nbsp;<span class="string" id="5395877">&#39;{&#39;</span><span class="op" id="5395880">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395884">s</span><span class="op" id="5395885">.</span><span class="ident" id="5395886">step</span>&nbsp;<span class="op" id="5395891">=</span>&nbsp;<span class="ident" id="5395893">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395919">s</span><span class="op" id="5395920">.</span><span class="ident" id="5395921">pushParseState</span><span class="op" id="5395935">(</span><span class="ident" id="5395936">parseObjectKey</span><span class="op" id="5395950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395954">return</span>&nbsp;<span class="ident" id="5395961">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5395978">case</span>&nbsp;<span class="string" id="5395983">&#39;[&#39;</span><span class="op" id="5395986">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5395990">s</span><span class="op" id="5395991">.</span><span class="ident" id="5395992">step</span>&nbsp;<span class="op" id="5395997">=</span>&nbsp;<span class="ident" id="5395999">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396024">s</span><span class="op" id="5396025">.</span><span class="ident" id="5396026">pushParseState</span><span class="op" id="5396040">(</span><span class="ident" id="5396041">parseArrayValue</span><span class="op" id="5396056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396060">return</span>&nbsp;<span class="ident" id="5396067">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396083">case</span>&nbsp;<span class="string" id="5396088">&#39;&#34;&#39;</span><span class="op" id="5396091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396095">s</span><span class="op" id="5396096">.</span><span class="ident" id="5396097">step</span>&nbsp;<span class="op" id="5396102">=</span>&nbsp;<span class="ident" id="5396104">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396120">return</span>&nbsp;<span class="ident" id="5396127">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396145">case</span>&nbsp;<span class="string" id="5396150">&#39;-&#39;</span><span class="op" id="5396153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396157">s</span><span class="op" id="5396158">.</span><span class="ident" id="5396159">step</span>&nbsp;<span class="op" id="5396164">=</span>&nbsp;<span class="ident" id="5396166">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396177">return</span>&nbsp;<span class="ident" id="5396184">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396202">case</span>&nbsp;<span class="string" id="5396207">&#39;0&#39;</span><span class="op" id="5396210">:</span>&nbsp;<span class="comment" id="5396212">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396236">s</span><span class="op" id="5396237">.</span><span class="ident" id="5396238">step</span>&nbsp;<span class="op" id="5396243">=</span>&nbsp;<span class="ident" id="5396245">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396254">return</span>&nbsp;<span class="ident" id="5396261">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396279">case</span>&nbsp;<span class="string" id="5396284">&#39;t&#39;</span><span class="op" id="5396287">:</span>&nbsp;<span class="comment" id="5396289">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396312">s</span><span class="op" id="5396313">.</span><span class="ident" id="5396314">step</span>&nbsp;<span class="op" id="5396319">=</span>&nbsp;<span class="ident" id="5396321">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396330">return</span>&nbsp;<span class="ident" id="5396337">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396355">case</span>&nbsp;<span class="string" id="5396360">&#39;f&#39;</span><span class="op" id="5396363">:</span>&nbsp;<span class="comment" id="5396365">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396389">s</span><span class="op" id="5396390">.</span><span class="ident" id="5396391">step</span>&nbsp;<span class="op" id="5396396">=</span>&nbsp;<span class="ident" id="5396398">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396407">return</span>&nbsp;<span class="ident" id="5396414">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396432">case</span>&nbsp;<span class="string" id="5396437">&#39;n&#39;</span><span class="op" id="5396440">:</span>&nbsp;<span class="comment" id="5396442">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396465">s</span><span class="op" id="5396466">.</span><span class="ident" id="5396467">step</span>&nbsp;<span class="op" id="5396472">=</span>&nbsp;<span class="ident" id="5396474">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396483">return</span>&nbsp;<span class="ident" id="5396490">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396511">if</span>&nbsp;<span class="string" id="5396514">&#39;1&#39;</span>&nbsp;<span class="op" id="5396518">&lt;=</span>&nbsp;<span class="ident" id="5396521">c</span>&nbsp;<span class="op" id="5396523">&amp;&amp;</span>&nbsp;<span class="ident" id="5396526">c</span>&nbsp;<span class="op" id="5396528">&lt;=</span>&nbsp;<span class="string" id="5396531">&#39;9&#39;</span>&nbsp;<span class="op" id="5396535">{</span>&nbsp;<span class="comment" id="5396537">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396562">s</span><span class="op" id="5396563">.</span><span class="ident" id="5396564">step</span>&nbsp;<span class="op" id="5396569">=</span>&nbsp;<span class="ident" id="5396571">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396580">return</span>&nbsp;<span class="ident" id="5396587">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396608">return</span>&nbsp;<span class="ident" id="5396615">s</span><span class="op" id="5396616">.</span><span class="builtintype" id="5396617">error</span><span class="op" id="5396622">(</span><span class="ident" id="5396623">c</span><span class="op" id="5396624">,</span>&nbsp;<span class="string" id="5396626">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="5396658">)</span><br>
<span class="lineno"></span><span class="op" id="5396660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396663">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="5396722">func</span>&nbsp;<span class="ident" id="5396727">stateBeginStringOrEmpty</span><span class="op" id="5396750">(</span><span class="ident" id="5396751">s</span>&nbsp;<span class="op" id="5396753">*</span><span class="ident" id="5396754">scanner</span><span class="op" id="5396761">,</span>&nbsp;<span class="ident" id="5396763">c</span>&nbsp;<span class="builtintype" id="5396765">int</span><span class="op" id="5396768">)</span>&nbsp;<span class="builtintype" id="5396770">int</span>&nbsp;<span class="op" id="5396774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396777">if</span>&nbsp;<span class="ident" id="5396780">c</span>&nbsp;<span class="op" id="5396782">&lt;=</span>&nbsp;<span class="string" id="5396785">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5396789">&amp;&amp;</span>&nbsp;<span class="ident" id="5396792">isSpace</span><span class="op" id="5396799">(</span><span class="builtintype" id="5396800">rune</span><span class="op" id="5396804">(</span><span class="ident" id="5396805">c</span><span class="op" id="5396806">)</span><span class="op" id="5396807">)</span>&nbsp;<span class="op" id="5396809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396813">return</span>&nbsp;<span class="ident" id="5396820">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396838">if</span>&nbsp;<span class="ident" id="5396841">c</span>&nbsp;<span class="op" id="5396843">==</span>&nbsp;<span class="string" id="5396846">&#39;}&#39;</span>&nbsp;<span class="op" id="5396850">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396854">n</span>&nbsp;<span class="op" id="5396856">:=</span>&nbsp;<span class="builtinfunc" id="5396859">len</span><span class="op" id="5396862">(</span><span class="ident" id="5396863">s</span><span class="op" id="5396864">.</span><span class="ident" id="5396865">parseState</span><span class="op" id="5396875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5396879">s</span><span class="op" id="5396880">.</span><span class="ident" id="5396881">parseState</span><span class="op" id="5396891">[</span><span class="ident" id="5396892">n</span><span class="op" id="5396893">-</span><span class="num" id="5396894">1</span><span class="op" id="5396895">]</span>&nbsp;<span class="op" id="5396897">=</span>&nbsp;<span class="ident" id="5396899">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396918">return</span>&nbsp;<span class="ident" id="5396925">stateEndValue</span><span class="op" id="5396938">(</span><span class="ident" id="5396939">s</span><span class="op" id="5396940">,</span>&nbsp;<span class="ident" id="5396942">c</span><span class="op" id="5396943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5396946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5396949">return</span>&nbsp;<span class="ident" id="5396956">stateBeginString</span><span class="op" id="5396972">(</span><span class="ident" id="5396973">s</span><span class="op" id="5396974">,</span>&nbsp;<span class="ident" id="5396976">c</span><span class="op" id="5396977">)</span><br>
<span class="lineno">250</span><span class="op" id="5396979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396982">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="5397047">func</span>&nbsp;<span class="ident" id="5397052">stateBeginString</span><span class="op" id="5397068">(</span><span class="ident" id="5397069">s</span>&nbsp;<span class="op" id="5397071">*</span><span class="ident" id="5397072">scanner</span><span class="op" id="5397079">,</span>&nbsp;<span class="ident" id="5397081">c</span>&nbsp;<span class="builtintype" id="5397083">int</span><span class="op" id="5397086">)</span>&nbsp;<span class="builtintype" id="5397088">int</span>&nbsp;<span class="op" id="5397092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397095">if</span>&nbsp;<span class="ident" id="5397098">c</span>&nbsp;<span class="op" id="5397100">&lt;=</span>&nbsp;<span class="string" id="5397103">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5397107">&amp;&amp;</span>&nbsp;<span class="ident" id="5397110">isSpace</span><span class="op" id="5397117">(</span><span class="builtintype" id="5397118">rune</span><span class="op" id="5397122">(</span><span class="ident" id="5397123">c</span><span class="op" id="5397124">)</span><span class="op" id="5397125">)</span>&nbsp;<span class="op" id="5397127">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397131">return</span>&nbsp;<span class="ident" id="5397138">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397156">if</span>&nbsp;<span class="ident" id="5397159">c</span>&nbsp;<span class="op" id="5397161">==</span>&nbsp;<span class="string" id="5397164">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5397168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397172">s</span><span class="op" id="5397173">.</span><span class="ident" id="5397174">step</span>&nbsp;<span class="op" id="5397179">=</span>&nbsp;<span class="ident" id="5397181">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397197">return</span>&nbsp;<span class="ident" id="5397204">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397225">return</span>&nbsp;<span class="ident" id="5397232">s</span><span class="op" id="5397233">.</span><span class="builtintype" id="5397234">error</span><span class="op" id="5397239">(</span><span class="ident" id="5397240">c</span><span class="op" id="5397241">,</span>&nbsp;<span class="string" id="5397243">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="5397287">)</span><br>
<span class="lineno"></span><span class="op" id="5397289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5397292">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="5397348">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5397399">func</span>&nbsp;<span class="ident" id="5397404">stateEndValue</span><span class="op" id="5397417">(</span><span class="ident" id="5397418">s</span>&nbsp;<span class="op" id="5397420">*</span><span class="ident" id="5397421">scanner</span><span class="op" id="5397428">,</span>&nbsp;<span class="ident" id="5397430">c</span>&nbsp;<span class="builtintype" id="5397432">int</span><span class="op" id="5397435">)</span>&nbsp;<span class="builtintype" id="5397437">int</span>&nbsp;<span class="op" id="5397441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397444">n</span>&nbsp;<span class="op" id="5397446">:=</span>&nbsp;<span class="builtinfunc" id="5397449">len</span><span class="op" id="5397452">(</span><span class="ident" id="5397453">s</span><span class="op" id="5397454">.</span><span class="ident" id="5397455">parseState</span><span class="op" id="5397465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397468">if</span>&nbsp;<span class="ident" id="5397471">n</span>&nbsp;<span class="op" id="5397473">==</span>&nbsp;<span class="num" id="5397476">0</span>&nbsp;<span class="op" id="5397478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5397482">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397532">s</span><span class="op" id="5397533">.</span><span class="ident" id="5397534">step</span>&nbsp;<span class="op" id="5397539">=</span>&nbsp;<span class="ident" id="5397541">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397555">s</span><span class="op" id="5397556">.</span><span class="ident" id="5397557">endTop</span>&nbsp;<span class="op" id="5397564">=</span>&nbsp;<span class="builtintype" id="5397566">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397573">return</span>&nbsp;<span class="ident" id="5397580">stateEndTop</span><span class="op" id="5397591">(</span><span class="ident" id="5397592">s</span><span class="op" id="5397593">,</span>&nbsp;<span class="ident" id="5397595">c</span><span class="op" id="5397596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397602">if</span>&nbsp;<span class="ident" id="5397605">c</span>&nbsp;<span class="op" id="5397607">&lt;=</span>&nbsp;<span class="string" id="5397610">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5397614">&amp;&amp;</span>&nbsp;<span class="ident" id="5397617">isSpace</span><span class="op" id="5397624">(</span><span class="builtintype" id="5397625">rune</span><span class="op" id="5397629">(</span><span class="ident" id="5397630">c</span><span class="op" id="5397631">)</span><span class="op" id="5397632">)</span>&nbsp;<span class="op" id="5397634">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397638">s</span><span class="op" id="5397639">.</span><span class="ident" id="5397640">step</span>&nbsp;<span class="op" id="5397645">=</span>&nbsp;<span class="ident" id="5397647">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397663">return</span>&nbsp;<span class="ident" id="5397670">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397688">ps</span>&nbsp;<span class="op" id="5397691">:=</span>&nbsp;<span class="ident" id="5397694">s</span><span class="op" id="5397695">.</span><span class="ident" id="5397696">parseState</span><span class="op" id="5397706">[</span><span class="ident" id="5397707">n</span><span class="op" id="5397708">-</span><span class="num" id="5397709">1</span><span class="op" id="5397710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397713">switch</span>&nbsp;<span class="ident" id="5397720">ps</span>&nbsp;<span class="op" id="5397723">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397726">case</span>&nbsp;<span class="ident" id="5397731">parseObjectKey</span><span class="op" id="5397745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397749">if</span>&nbsp;<span class="ident" id="5397752">c</span>&nbsp;<span class="op" id="5397754">==</span>&nbsp;<span class="string" id="5397757">&#39;:&#39;</span>&nbsp;<span class="op" id="5397761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397766">s</span><span class="op" id="5397767">.</span><span class="ident" id="5397768">parseState</span><span class="op" id="5397778">[</span><span class="ident" id="5397779">n</span><span class="op" id="5397780">-</span><span class="num" id="5397781">1</span><span class="op" id="5397782">]</span>&nbsp;<span class="op" id="5397784">=</span>&nbsp;<span class="ident" id="5397786">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397806">s</span><span class="op" id="5397807">.</span><span class="ident" id="5397808">step</span>&nbsp;<span class="op" id="5397813">=</span>&nbsp;<span class="ident" id="5397815">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397834">return</span>&nbsp;<span class="ident" id="5397841">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5397857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397861">return</span>&nbsp;<span class="ident" id="5397868">s</span><span class="op" id="5397869">.</span><span class="builtintype" id="5397870">error</span><span class="op" id="5397875">(</span><span class="ident" id="5397876">c</span><span class="op" id="5397877">,</span>&nbsp;<span class="string" id="5397879">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="5397897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397900">case</span>&nbsp;<span class="ident" id="5397905">parseObjectValue</span><span class="op" id="5397921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5397925">if</span>&nbsp;<span class="ident" id="5397928">c</span>&nbsp;<span class="op" id="5397930">==</span>&nbsp;<span class="string" id="5397933">&#39;,&#39;</span>&nbsp;<span class="op" id="5397937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397942">s</span><span class="op" id="5397943">.</span><span class="ident" id="5397944">parseState</span><span class="op" id="5397954">[</span><span class="ident" id="5397955">n</span><span class="op" id="5397956">-</span><span class="num" id="5397957">1</span><span class="op" id="5397958">]</span>&nbsp;<span class="op" id="5397960">=</span>&nbsp;<span class="ident" id="5397962">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5397980">s</span><span class="op" id="5397981">.</span><span class="ident" id="5397982">step</span>&nbsp;<span class="op" id="5397987">=</span>&nbsp;<span class="ident" id="5397989">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398009">return</span>&nbsp;<span class="ident" id="5398016">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398038">if</span>&nbsp;<span class="ident" id="5398041">c</span>&nbsp;<span class="op" id="5398043">==</span>&nbsp;<span class="string" id="5398046">&#39;}&#39;</span>&nbsp;<span class="op" id="5398050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398055">s</span><span class="op" id="5398056">.</span><span class="ident" id="5398057">popParseState</span><span class="op" id="5398070">(</span><span class="op" id="5398071">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398076">return</span>&nbsp;<span class="ident" id="5398083">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398103">return</span>&nbsp;<span class="ident" id="5398110">s</span><span class="op" id="5398111">.</span><span class="builtintype" id="5398112">error</span><span class="op" id="5398117">(</span><span class="ident" id="5398118">c</span><span class="op" id="5398119">,</span>&nbsp;<span class="string" id="5398121">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="5398150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398153">case</span>&nbsp;<span class="ident" id="5398158">parseArrayValue</span><span class="op" id="5398173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398177">if</span>&nbsp;<span class="ident" id="5398180">c</span>&nbsp;<span class="op" id="5398182">==</span>&nbsp;<span class="string" id="5398185">&#39;,&#39;</span>&nbsp;<span class="op" id="5398189">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398194">s</span><span class="op" id="5398195">.</span><span class="ident" id="5398196">step</span>&nbsp;<span class="op" id="5398201">=</span>&nbsp;<span class="ident" id="5398203">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398222">return</span>&nbsp;<span class="ident" id="5398229">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398250">if</span>&nbsp;<span class="ident" id="5398253">c</span>&nbsp;<span class="op" id="5398255">==</span>&nbsp;<span class="string" id="5398258">&#39;]&#39;</span>&nbsp;<span class="op" id="5398262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398267">s</span><span class="op" id="5398268">.</span><span class="ident" id="5398269">popParseState</span><span class="op" id="5398282">(</span><span class="op" id="5398283">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398288">return</span>&nbsp;<span class="ident" id="5398295">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398314">return</span>&nbsp;<span class="ident" id="5398321">s</span><span class="op" id="5398322">.</span><span class="builtintype" id="5398323">error</span><span class="op" id="5398328">(</span><span class="ident" id="5398329">c</span><span class="op" id="5398330">,</span>&nbsp;<span class="string" id="5398332">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="5398353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398359">return</span>&nbsp;<span class="ident" id="5398366">s</span><span class="op" id="5398367">.</span><span class="builtintype" id="5398368">error</span><span class="op" id="5398373">(</span><span class="ident" id="5398374">c</span><span class="op" id="5398375">,</span>&nbsp;<span class="string" id="5398377">&#34;&#34;</span><span class="op" id="5398379">)</span><br>
<span class="lineno">310</span><span class="op" id="5398381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5398384">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5398449">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="5398493">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="5398538">func</span>&nbsp;<span class="ident" id="5398543">stateEndTop</span><span class="op" id="5398554">(</span><span class="ident" id="5398555">s</span>&nbsp;<span class="op" id="5398557">*</span><span class="ident" id="5398558">scanner</span><span class="op" id="5398565">,</span>&nbsp;<span class="ident" id="5398567">c</span>&nbsp;<span class="builtintype" id="5398569">int</span><span class="op" id="5398572">)</span>&nbsp;<span class="builtintype" id="5398574">int</span>&nbsp;<span class="op" id="5398578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398581">if</span>&nbsp;<span class="ident" id="5398584">c</span>&nbsp;<span class="op" id="5398586">!=</span>&nbsp;<span class="string" id="5398589">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5398593">&amp;&amp;</span>&nbsp;<span class="ident" id="5398596">c</span>&nbsp;<span class="op" id="5398598">!=</span>&nbsp;<span class="string" id="5398601">&#39;\t&#39;</span>&nbsp;<span class="op" id="5398606">&amp;&amp;</span>&nbsp;<span class="ident" id="5398609">c</span>&nbsp;<span class="op" id="5398611">!=</span>&nbsp;<span class="string" id="5398614">&#39;\r&#39;</span>&nbsp;<span class="op" id="5398619">&amp;&amp;</span>&nbsp;<span class="ident" id="5398622">c</span>&nbsp;<span class="op" id="5398624">!=</span>&nbsp;<span class="string" id="5398627">&#39;\n&#39;</span>&nbsp;<span class="op" id="5398632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5398636">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398685">s</span><span class="op" id="5398686">.</span><span class="builtintype" id="5398687">error</span><span class="op" id="5398692">(</span><span class="ident" id="5398693">c</span><span class="op" id="5398694">,</span>&nbsp;<span class="string" id="5398696">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="5398719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398722">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398725">return</span>&nbsp;<span class="ident" id="5398732">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="5398740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5398743">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5398792">func</span>&nbsp;<span class="ident" id="5398797">stateInString</span><span class="op" id="5398810">(</span><span class="ident" id="5398811">s</span>&nbsp;<span class="op" id="5398813">*</span><span class="ident" id="5398814">scanner</span><span class="op" id="5398821">,</span>&nbsp;<span class="ident" id="5398823">c</span>&nbsp;<span class="builtintype" id="5398825">int</span><span class="op" id="5398828">)</span>&nbsp;<span class="builtintype" id="5398830">int</span>&nbsp;<span class="op" id="5398834">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398837">if</span>&nbsp;<span class="ident" id="5398840">c</span>&nbsp;<span class="op" id="5398842">==</span>&nbsp;<span class="string" id="5398845">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5398849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398853">s</span><span class="op" id="5398854">.</span><span class="ident" id="5398855">step</span>&nbsp;<span class="op" id="5398860">=</span>&nbsp;<span class="ident" id="5398862">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398878">return</span>&nbsp;<span class="ident" id="5398885">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398902">if</span>&nbsp;<span class="ident" id="5398905">c</span>&nbsp;<span class="op" id="5398907">==</span>&nbsp;<span class="string" id="5398910">&#39;\\&#39;</span>&nbsp;<span class="op" id="5398915">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5398919">s</span><span class="op" id="5398920">.</span><span class="ident" id="5398921">step</span>&nbsp;<span class="op" id="5398926">=</span>&nbsp;<span class="ident" id="5398928">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398947">return</span>&nbsp;<span class="ident" id="5398954">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5398968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398971">if</span>&nbsp;<span class="ident" id="5398974">c</span>&nbsp;<span class="op" id="5398976">&lt;</span>&nbsp;<span class="num" id="5398978">0x20</span>&nbsp;<span class="op" id="5398983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5398987">return</span>&nbsp;<span class="ident" id="5398994">s</span><span class="op" id="5398995">.</span><span class="builtintype" id="5398996">error</span><span class="op" id="5399001">(</span><span class="ident" id="5399002">c</span><span class="op" id="5399003">,</span>&nbsp;<span class="string" id="5399005">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="5399024">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399030">return</span>&nbsp;<span class="ident" id="5399037">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="5399050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399053">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="5399129">func</span>&nbsp;<span class="ident" id="5399134">stateInStringEsc</span><span class="op" id="5399150">(</span><span class="ident" id="5399151">s</span>&nbsp;<span class="op" id="5399153">*</span><span class="ident" id="5399154">scanner</span><span class="op" id="5399161">,</span>&nbsp;<span class="ident" id="5399163">c</span>&nbsp;<span class="builtintype" id="5399165">int</span><span class="op" id="5399168">)</span>&nbsp;<span class="builtintype" id="5399170">int</span>&nbsp;<span class="op" id="5399174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399177">switch</span>&nbsp;<span class="ident" id="5399184">c</span>&nbsp;<span class="op" id="5399186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399189">case</span>&nbsp;<span class="string" id="5399194">&#39;b&#39;</span><span class="op" id="5399197">,</span>&nbsp;<span class="string" id="5399199">&#39;f&#39;</span><span class="op" id="5399202">,</span>&nbsp;<span class="string" id="5399204">&#39;n&#39;</span><span class="op" id="5399207">,</span>&nbsp;<span class="string" id="5399209">&#39;r&#39;</span><span class="op" id="5399212">,</span>&nbsp;<span class="string" id="5399214">&#39;t&#39;</span><span class="op" id="5399217">,</span>&nbsp;<span class="string" id="5399219">&#39;\\&#39;</span><span class="op" id="5399223">,</span>&nbsp;<span class="string" id="5399225">&#39;/&#39;</span><span class="op" id="5399228">,</span>&nbsp;<span class="string" id="5399230">&#39;&#34;&#39;</span><span class="op" id="5399233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399237">s</span><span class="op" id="5399238">.</span><span class="ident" id="5399239">step</span>&nbsp;<span class="op" id="5399244">=</span>&nbsp;<span class="ident" id="5399246">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399262">return</span>&nbsp;<span class="ident" id="5399269">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399286">if</span>&nbsp;<span class="ident" id="5399289">c</span>&nbsp;<span class="op" id="5399291">==</span>&nbsp;<span class="string" id="5399294">&#39;u&#39;</span>&nbsp;<span class="op" id="5399298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399302">s</span><span class="op" id="5399303">.</span><span class="ident" id="5399304">step</span>&nbsp;<span class="op" id="5399309">=</span>&nbsp;<span class="ident" id="5399311">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399331">return</span>&nbsp;<span class="ident" id="5399338">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399352">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399355">return</span>&nbsp;<span class="ident" id="5399362">s</span><span class="op" id="5399363">.</span><span class="builtintype" id="5399364">error</span><span class="op" id="5399369">(</span><span class="ident" id="5399370">c</span><span class="op" id="5399371">,</span>&nbsp;<span class="string" id="5399373">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="5399396">)</span><br>
<span class="lineno"></span><span class="op" id="5399398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399401">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5399479">func</span>&nbsp;<span class="ident" id="5399484">stateInStringEscU</span><span class="op" id="5399501">(</span><span class="ident" id="5399502">s</span>&nbsp;<span class="op" id="5399504">*</span><span class="ident" id="5399505">scanner</span><span class="op" id="5399512">,</span>&nbsp;<span class="ident" id="5399514">c</span>&nbsp;<span class="builtintype" id="5399516">int</span><span class="op" id="5399519">)</span>&nbsp;<span class="builtintype" id="5399521">int</span>&nbsp;<span class="op" id="5399525">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399528">if</span>&nbsp;<span class="string" id="5399531">&#39;0&#39;</span>&nbsp;<span class="op" id="5399535">&lt;=</span>&nbsp;<span class="ident" id="5399538">c</span>&nbsp;<span class="op" id="5399540">&amp;&amp;</span>&nbsp;<span class="ident" id="5399543">c</span>&nbsp;<span class="op" id="5399545">&lt;=</span>&nbsp;<span class="string" id="5399548">&#39;9&#39;</span>&nbsp;<span class="op" id="5399552">||</span>&nbsp;<span class="string" id="5399555">&#39;a&#39;</span>&nbsp;<span class="op" id="5399559">&lt;=</span>&nbsp;<span class="ident" id="5399562">c</span>&nbsp;<span class="op" id="5399564">&amp;&amp;</span>&nbsp;<span class="ident" id="5399567">c</span>&nbsp;<span class="op" id="5399569">&lt;=</span>&nbsp;<span class="string" id="5399572">&#39;f&#39;</span>&nbsp;<span class="op" id="5399576">||</span>&nbsp;<span class="string" id="5399579">&#39;A&#39;</span>&nbsp;<span class="op" id="5399583">&lt;=</span>&nbsp;<span class="ident" id="5399586">c</span>&nbsp;<span class="op" id="5399588">&amp;&amp;</span>&nbsp;<span class="ident" id="5399591">c</span>&nbsp;<span class="op" id="5399593">&lt;=</span>&nbsp;<span class="string" id="5399596">&#39;F&#39;</span>&nbsp;<span class="op" id="5399600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399604">s</span><span class="op" id="5399605">.</span><span class="ident" id="5399606">step</span>&nbsp;<span class="op" id="5399611">=</span>&nbsp;<span class="ident" id="5399613">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399634">return</span>&nbsp;<span class="ident" id="5399641">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5399658">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399670">return</span>&nbsp;<span class="ident" id="5399677">s</span><span class="op" id="5399678">.</span><span class="builtintype" id="5399679">error</span><span class="op" id="5399684">(</span><span class="ident" id="5399685">c</span><span class="op" id="5399686">,</span>&nbsp;<span class="string" id="5399688">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5399725">)</span><br>
<span class="lineno"></span><span class="op" id="5399727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399730">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5399810">func</span>&nbsp;<span class="ident" id="5399815">stateInStringEscU1</span><span class="op" id="5399833">(</span><span class="ident" id="5399834">s</span>&nbsp;<span class="op" id="5399836">*</span><span class="ident" id="5399837">scanner</span><span class="op" id="5399844">,</span>&nbsp;<span class="ident" id="5399846">c</span>&nbsp;<span class="builtintype" id="5399848">int</span><span class="op" id="5399851">)</span>&nbsp;<span class="builtintype" id="5399853">int</span>&nbsp;<span class="op" id="5399857">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399860">if</span>&nbsp;<span class="string" id="5399863">&#39;0&#39;</span>&nbsp;<span class="op" id="5399867">&lt;=</span>&nbsp;<span class="ident" id="5399870">c</span>&nbsp;<span class="op" id="5399872">&amp;&amp;</span>&nbsp;<span class="ident" id="5399875">c</span>&nbsp;<span class="op" id="5399877">&lt;=</span>&nbsp;<span class="string" id="5399880">&#39;9&#39;</span>&nbsp;<span class="op" id="5399884">||</span>&nbsp;<span class="string" id="5399887">&#39;a&#39;</span>&nbsp;<span class="op" id="5399891">&lt;=</span>&nbsp;<span class="ident" id="5399894">c</span>&nbsp;<span class="op" id="5399896">&amp;&amp;</span>&nbsp;<span class="ident" id="5399899">c</span>&nbsp;<span class="op" id="5399901">&lt;=</span>&nbsp;<span class="string" id="5399904">&#39;f&#39;</span>&nbsp;<span class="op" id="5399908">||</span>&nbsp;<span class="string" id="5399911">&#39;A&#39;</span>&nbsp;<span class="op" id="5399915">&lt;=</span>&nbsp;<span class="ident" id="5399918">c</span>&nbsp;<span class="op" id="5399920">&amp;&amp;</span>&nbsp;<span class="ident" id="5399923">c</span>&nbsp;<span class="op" id="5399925">&lt;=</span>&nbsp;<span class="string" id="5399928">&#39;F&#39;</span>&nbsp;<span class="op" id="5399932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5399936">s</span><span class="op" id="5399937">.</span><span class="ident" id="5399938">step</span>&nbsp;<span class="op" id="5399943">=</span>&nbsp;<span class="ident" id="5399945">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5399967">return</span>&nbsp;<span class="ident" id="5399974">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5399988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5399991">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400003">return</span>&nbsp;<span class="ident" id="5400010">s</span><span class="op" id="5400011">.</span><span class="builtintype" id="5400012">error</span><span class="op" id="5400017">(</span><span class="ident" id="5400018">c</span><span class="op" id="5400019">,</span>&nbsp;<span class="string" id="5400021">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5400058">)</span><br>
<span class="lineno"></span><span class="op" id="5400060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400063">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5400145">func</span>&nbsp;<span class="ident" id="5400150">stateInStringEscU12</span><span class="op" id="5400169">(</span><span class="ident" id="5400170">s</span>&nbsp;<span class="op" id="5400172">*</span><span class="ident" id="5400173">scanner</span><span class="op" id="5400180">,</span>&nbsp;<span class="ident" id="5400182">c</span>&nbsp;<span class="builtintype" id="5400184">int</span><span class="op" id="5400187">)</span>&nbsp;<span class="builtintype" id="5400189">int</span>&nbsp;<span class="op" id="5400193">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400196">if</span>&nbsp;<span class="string" id="5400199">&#39;0&#39;</span>&nbsp;<span class="op" id="5400203">&lt;=</span>&nbsp;<span class="ident" id="5400206">c</span>&nbsp;<span class="op" id="5400208">&amp;&amp;</span>&nbsp;<span class="ident" id="5400211">c</span>&nbsp;<span class="op" id="5400213">&lt;=</span>&nbsp;<span class="string" id="5400216">&#39;9&#39;</span>&nbsp;<span class="op" id="5400220">||</span>&nbsp;<span class="string" id="5400223">&#39;a&#39;</span>&nbsp;<span class="op" id="5400227">&lt;=</span>&nbsp;<span class="ident" id="5400230">c</span>&nbsp;<span class="op" id="5400232">&amp;&amp;</span>&nbsp;<span class="ident" id="5400235">c</span>&nbsp;<span class="op" id="5400237">&lt;=</span>&nbsp;<span class="string" id="5400240">&#39;f&#39;</span>&nbsp;<span class="op" id="5400244">||</span>&nbsp;<span class="string" id="5400247">&#39;A&#39;</span>&nbsp;<span class="op" id="5400251">&lt;=</span>&nbsp;<span class="ident" id="5400254">c</span>&nbsp;<span class="op" id="5400256">&amp;&amp;</span>&nbsp;<span class="ident" id="5400259">c</span>&nbsp;<span class="op" id="5400261">&lt;=</span>&nbsp;<span class="string" id="5400264">&#39;F&#39;</span>&nbsp;<span class="op" id="5400268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400272">s</span><span class="op" id="5400273">.</span><span class="ident" id="5400274">step</span>&nbsp;<span class="op" id="5400279">=</span>&nbsp;<span class="ident" id="5400281">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400304">return</span>&nbsp;<span class="ident" id="5400311">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5400328">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400340">return</span>&nbsp;<span class="ident" id="5400347">s</span><span class="op" id="5400348">.</span><span class="builtintype" id="5400349">error</span><span class="op" id="5400354">(</span><span class="ident" id="5400355">c</span><span class="op" id="5400356">,</span>&nbsp;<span class="string" id="5400358">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5400395">)</span><br>
<span class="lineno"></span><span class="op" id="5400397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400400">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5400484">func</span>&nbsp;<span class="ident" id="5400489">stateInStringEscU123</span><span class="op" id="5400509">(</span><span class="ident" id="5400510">s</span>&nbsp;<span class="op" id="5400512">*</span><span class="ident" id="5400513">scanner</span><span class="op" id="5400520">,</span>&nbsp;<span class="ident" id="5400522">c</span>&nbsp;<span class="builtintype" id="5400524">int</span><span class="op" id="5400527">)</span>&nbsp;<span class="builtintype" id="5400529">int</span>&nbsp;<span class="op" id="5400533">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400536">if</span>&nbsp;<span class="string" id="5400539">&#39;0&#39;</span>&nbsp;<span class="op" id="5400543">&lt;=</span>&nbsp;<span class="ident" id="5400546">c</span>&nbsp;<span class="op" id="5400548">&amp;&amp;</span>&nbsp;<span class="ident" id="5400551">c</span>&nbsp;<span class="op" id="5400553">&lt;=</span>&nbsp;<span class="string" id="5400556">&#39;9&#39;</span>&nbsp;<span class="op" id="5400560">||</span>&nbsp;<span class="string" id="5400563">&#39;a&#39;</span>&nbsp;<span class="op" id="5400567">&lt;=</span>&nbsp;<span class="ident" id="5400570">c</span>&nbsp;<span class="op" id="5400572">&amp;&amp;</span>&nbsp;<span class="ident" id="5400575">c</span>&nbsp;<span class="op" id="5400577">&lt;=</span>&nbsp;<span class="string" id="5400580">&#39;f&#39;</span>&nbsp;<span class="op" id="5400584">||</span>&nbsp;<span class="string" id="5400587">&#39;A&#39;</span>&nbsp;<span class="op" id="5400591">&lt;=</span>&nbsp;<span class="ident" id="5400594">c</span>&nbsp;<span class="op" id="5400596">&amp;&amp;</span>&nbsp;<span class="ident" id="5400599">c</span>&nbsp;<span class="op" id="5400601">&lt;=</span>&nbsp;<span class="string" id="5400604">&#39;F&#39;</span>&nbsp;<span class="op" id="5400608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400612">s</span><span class="op" id="5400613">.</span><span class="ident" id="5400614">step</span>&nbsp;<span class="op" id="5400619">=</span>&nbsp;<span class="ident" id="5400621">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400637">return</span>&nbsp;<span class="ident" id="5400644">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5400661">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400673">return</span>&nbsp;<span class="ident" id="5400680">s</span><span class="op" id="5400681">.</span><span class="builtintype" id="5400682">error</span><span class="op" id="5400687">(</span><span class="ident" id="5400688">c</span><span class="op" id="5400689">,</span>&nbsp;<span class="string" id="5400691">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5400728">)</span><br>
<span class="lineno"></span><span class="op" id="5400730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400733">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5400793">func</span>&nbsp;<span class="ident" id="5400798">stateNeg</span><span class="op" id="5400806">(</span><span class="ident" id="5400807">s</span>&nbsp;<span class="op" id="5400809">*</span><span class="ident" id="5400810">scanner</span><span class="op" id="5400817">,</span>&nbsp;<span class="ident" id="5400819">c</span>&nbsp;<span class="builtintype" id="5400821">int</span><span class="op" id="5400824">)</span>&nbsp;<span class="builtintype" id="5400826">int</span>&nbsp;<span class="op" id="5400830">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400833">if</span>&nbsp;<span class="ident" id="5400836">c</span>&nbsp;<span class="op" id="5400838">==</span>&nbsp;<span class="string" id="5400841">&#39;0&#39;</span>&nbsp;<span class="op" id="5400845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400849">s</span><span class="op" id="5400850">.</span><span class="ident" id="5400851">step</span>&nbsp;<span class="op" id="5400856">=</span>&nbsp;<span class="ident" id="5400858">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400867">return</span>&nbsp;<span class="ident" id="5400874">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400891">if</span>&nbsp;<span class="string" id="5400894">&#39;1&#39;</span>&nbsp;<span class="op" id="5400898">&lt;=</span>&nbsp;<span class="ident" id="5400901">c</span>&nbsp;<span class="op" id="5400903">&amp;&amp;</span>&nbsp;<span class="ident" id="5400906">c</span>&nbsp;<span class="op" id="5400908">&lt;=</span>&nbsp;<span class="string" id="5400911">&#39;9&#39;</span>&nbsp;<span class="op" id="5400915">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5400919">s</span><span class="op" id="5400920">.</span><span class="ident" id="5400921">step</span>&nbsp;<span class="op" id="5400926">=</span>&nbsp;<span class="ident" id="5400928">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400937">return</span>&nbsp;<span class="ident" id="5400944">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5400958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5400961">return</span>&nbsp;<span class="ident" id="5400968">s</span><span class="op" id="5400969">.</span><span class="builtintype" id="5400970">error</span><span class="op" id="5400975">(</span><span class="ident" id="5400976">c</span><span class="op" id="5400977">,</span>&nbsp;<span class="string" id="5400979">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5400999">)</span><br>
<span class="lineno"></span><span class="op" id="5401001">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="5401004">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5401077">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="5401128">func</span>&nbsp;<span class="ident" id="5401133">state1</span><span class="op" id="5401139">(</span><span class="ident" id="5401140">s</span>&nbsp;<span class="op" id="5401142">*</span><span class="ident" id="5401143">scanner</span><span class="op" id="5401150">,</span>&nbsp;<span class="ident" id="5401152">c</span>&nbsp;<span class="builtintype" id="5401154">int</span><span class="op" id="5401157">)</span>&nbsp;<span class="builtintype" id="5401159">int</span>&nbsp;<span class="op" id="5401163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401166">if</span>&nbsp;<span class="string" id="5401169">&#39;0&#39;</span>&nbsp;<span class="op" id="5401173">&lt;=</span>&nbsp;<span class="ident" id="5401176">c</span>&nbsp;<span class="op" id="5401178">&amp;&amp;</span>&nbsp;<span class="ident" id="5401181">c</span>&nbsp;<span class="op" id="5401183">&lt;=</span>&nbsp;<span class="string" id="5401186">&#39;9&#39;</span>&nbsp;<span class="op" id="5401190">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401194">s</span><span class="op" id="5401195">.</span><span class="ident" id="5401196">step</span>&nbsp;<span class="op" id="5401201">=</span>&nbsp;<span class="ident" id="5401203">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401212">return</span>&nbsp;<span class="ident" id="5401219">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401236">return</span>&nbsp;<span class="ident" id="5401243">state0</span><span class="op" id="5401249">(</span><span class="ident" id="5401250">s</span><span class="op" id="5401251">,</span>&nbsp;<span class="ident" id="5401253">c</span><span class="op" id="5401254">)</span><br>
<span class="lineno"></span><span class="op" id="5401256">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="5401259">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5401317">func</span>&nbsp;<span class="ident" id="5401322">state0</span><span class="op" id="5401328">(</span><span class="ident" id="5401329">s</span>&nbsp;<span class="op" id="5401331">*</span><span class="ident" id="5401332">scanner</span><span class="op" id="5401339">,</span>&nbsp;<span class="ident" id="5401341">c</span>&nbsp;<span class="builtintype" id="5401343">int</span><span class="op" id="5401346">)</span>&nbsp;<span class="builtintype" id="5401348">int</span>&nbsp;<span class="op" id="5401352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401355">if</span>&nbsp;<span class="ident" id="5401358">c</span>&nbsp;<span class="op" id="5401360">==</span>&nbsp;<span class="string" id="5401363">&#39;.&#39;</span>&nbsp;<span class="op" id="5401367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401371">s</span><span class="op" id="5401372">.</span><span class="ident" id="5401373">step</span>&nbsp;<span class="op" id="5401378">=</span>&nbsp;<span class="ident" id="5401380">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401391">return</span>&nbsp;<span class="ident" id="5401398">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401415">if</span>&nbsp;<span class="ident" id="5401418">c</span>&nbsp;<span class="op" id="5401420">==</span>&nbsp;<span class="string" id="5401423">&#39;e&#39;</span>&nbsp;<span class="op" id="5401427">||</span>&nbsp;<span class="ident" id="5401430">c</span>&nbsp;<span class="op" id="5401432">==</span>&nbsp;<span class="string" id="5401435">&#39;E&#39;</span>&nbsp;<span class="op" id="5401439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401443">s</span><span class="op" id="5401444">.</span><span class="ident" id="5401445">step</span>&nbsp;<span class="op" id="5401450">=</span>&nbsp;<span class="ident" id="5401452">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401461">return</span>&nbsp;<span class="ident" id="5401468">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401485">return</span>&nbsp;<span class="ident" id="5401492">stateEndValue</span><span class="op" id="5401505">(</span><span class="ident" id="5401506">s</span><span class="op" id="5401507">,</span>&nbsp;<span class="ident" id="5401509">c</span><span class="op" id="5401510">)</span><br>
<span class="lineno"></span><span class="op" id="5401512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5401515">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="5401597">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="5401628">func</span>&nbsp;<span class="ident" id="5401633">stateDot</span><span class="op" id="5401641">(</span><span class="ident" id="5401642">s</span>&nbsp;<span class="op" id="5401644">*</span><span class="ident" id="5401645">scanner</span><span class="op" id="5401652">,</span>&nbsp;<span class="ident" id="5401654">c</span>&nbsp;<span class="builtintype" id="5401656">int</span><span class="op" id="5401659">)</span>&nbsp;<span class="builtintype" id="5401661">int</span>&nbsp;<span class="op" id="5401665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401668">if</span>&nbsp;<span class="string" id="5401671">&#39;0&#39;</span>&nbsp;<span class="op" id="5401675">&lt;=</span>&nbsp;<span class="ident" id="5401678">c</span>&nbsp;<span class="op" id="5401680">&amp;&amp;</span>&nbsp;<span class="ident" id="5401683">c</span>&nbsp;<span class="op" id="5401685">&lt;=</span>&nbsp;<span class="string" id="5401688">&#39;9&#39;</span>&nbsp;<span class="op" id="5401692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5401696">s</span><span class="op" id="5401697">.</span><span class="ident" id="5401698">step</span>&nbsp;<span class="op" id="5401703">=</span>&nbsp;<span class="ident" id="5401705">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401717">return</span>&nbsp;<span class="ident" id="5401724">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5401738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401741">return</span>&nbsp;<span class="ident" id="5401748">s</span><span class="op" id="5401749">.</span><span class="builtintype" id="5401750">error</span><span class="op" id="5401755">(</span><span class="ident" id="5401756">c</span><span class="op" id="5401757">,</span>&nbsp;<span class="string" id="5401759">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5401799">)</span><br>
<span class="lineno"></span><span class="op" id="5401801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5401804">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="5401887">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="5401940">func</span>&nbsp;<span class="ident" id="5401945">stateDot0</span><span class="op" id="5401954">(</span><span class="ident" id="5401955">s</span>&nbsp;<span class="op" id="5401957">*</span><span class="ident" id="5401958">scanner</span><span class="op" id="5401965">,</span>&nbsp;<span class="ident" id="5401967">c</span>&nbsp;<span class="builtintype" id="5401969">int</span><span class="op" id="5401972">)</span>&nbsp;<span class="builtintype" id="5401974">int</span>&nbsp;<span class="op" id="5401978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5401981">if</span>&nbsp;<span class="string" id="5401984">&#39;0&#39;</span>&nbsp;<span class="op" id="5401988">&lt;=</span>&nbsp;<span class="ident" id="5401991">c</span>&nbsp;<span class="op" id="5401993">&amp;&amp;</span>&nbsp;<span class="ident" id="5401996">c</span>&nbsp;<span class="op" id="5401998">&lt;=</span>&nbsp;<span class="string" id="5402001">&#39;9&#39;</span>&nbsp;<span class="op" id="5402005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402009">s</span><span class="op" id="5402010">.</span><span class="ident" id="5402011">step</span>&nbsp;<span class="op" id="5402016">=</span>&nbsp;<span class="ident" id="5402018">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402030">return</span>&nbsp;<span class="ident" id="5402037">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402054">if</span>&nbsp;<span class="ident" id="5402057">c</span>&nbsp;<span class="op" id="5402059">==</span>&nbsp;<span class="string" id="5402062">&#39;e&#39;</span>&nbsp;<span class="op" id="5402066">||</span>&nbsp;<span class="ident" id="5402069">c</span>&nbsp;<span class="op" id="5402071">==</span>&nbsp;<span class="string" id="5402074">&#39;E&#39;</span>&nbsp;<span class="op" id="5402078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402082">s</span><span class="op" id="5402083">.</span><span class="ident" id="5402084">step</span>&nbsp;<span class="op" id="5402089">=</span>&nbsp;<span class="ident" id="5402091">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402100">return</span>&nbsp;<span class="ident" id="5402107">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402121">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402124">return</span>&nbsp;<span class="ident" id="5402131">stateEndValue</span><span class="op" id="5402144">(</span><span class="ident" id="5402145">s</span><span class="op" id="5402146">,</span>&nbsp;<span class="ident" id="5402148">c</span><span class="op" id="5402149">)</span><br>
<span class="lineno"></span><span class="op" id="5402151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5402154">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5402223">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="5402268">func</span>&nbsp;<span class="ident" id="5402273">stateE</span><span class="op" id="5402279">(</span><span class="ident" id="5402280">s</span>&nbsp;<span class="op" id="5402282">*</span><span class="ident" id="5402283">scanner</span><span class="op" id="5402290">,</span>&nbsp;<span class="ident" id="5402292">c</span>&nbsp;<span class="builtintype" id="5402294">int</span><span class="op" id="5402297">)</span>&nbsp;<span class="builtintype" id="5402299">int</span>&nbsp;<span class="op" id="5402303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402306">if</span>&nbsp;<span class="ident" id="5402309">c</span>&nbsp;<span class="op" id="5402311">==</span>&nbsp;<span class="string" id="5402314">&#39;+&#39;</span>&nbsp;<span class="op" id="5402318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402322">s</span><span class="op" id="5402323">.</span><span class="ident" id="5402324">step</span>&nbsp;<span class="op" id="5402329">=</span>&nbsp;<span class="ident" id="5402331">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402344">return</span>&nbsp;<span class="ident" id="5402351">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402365">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402368">if</span>&nbsp;<span class="ident" id="5402371">c</span>&nbsp;<span class="op" id="5402373">==</span>&nbsp;<span class="string" id="5402376">&#39;-&#39;</span>&nbsp;<span class="op" id="5402380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402384">s</span><span class="op" id="5402385">.</span><span class="ident" id="5402386">step</span>&nbsp;<span class="op" id="5402391">=</span>&nbsp;<span class="ident" id="5402393">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402406">return</span>&nbsp;<span class="ident" id="5402413">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402430">return</span>&nbsp;<span class="ident" id="5402437">stateESign</span><span class="op" id="5402447">(</span><span class="ident" id="5402448">s</span><span class="op" id="5402449">,</span>&nbsp;<span class="ident" id="5402451">c</span><span class="op" id="5402452">)</span><br>
<span class="lineno">465</span><span class="op" id="5402454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5402457">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5402537">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="5402584">func</span>&nbsp;<span class="ident" id="5402589">stateESign</span><span class="op" id="5402599">(</span><span class="ident" id="5402600">s</span>&nbsp;<span class="op" id="5402602">*</span><span class="ident" id="5402603">scanner</span><span class="op" id="5402610">,</span>&nbsp;<span class="ident" id="5402612">c</span>&nbsp;<span class="builtintype" id="5402614">int</span><span class="op" id="5402617">)</span>&nbsp;<span class="builtintype" id="5402619">int</span>&nbsp;<span class="op" id="5402623">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402626">if</span>&nbsp;<span class="string" id="5402629">&#39;0&#39;</span>&nbsp;<span class="op" id="5402633">&lt;=</span>&nbsp;<span class="ident" id="5402636">c</span>&nbsp;<span class="op" id="5402638">&amp;&amp;</span>&nbsp;<span class="ident" id="5402641">c</span>&nbsp;<span class="op" id="5402643">&lt;=</span>&nbsp;<span class="string" id="5402646">&#39;9&#39;</span>&nbsp;<span class="op" id="5402650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5402654">s</span><span class="op" id="5402655">.</span><span class="ident" id="5402656">step</span>&nbsp;<span class="op" id="5402661">=</span>&nbsp;<span class="ident" id="5402663">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402673">return</span>&nbsp;<span class="ident" id="5402680">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5402694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402697">return</span>&nbsp;<span class="ident" id="5402704">s</span><span class="op" id="5402705">.</span><span class="builtintype" id="5402706">error</span><span class="op" id="5402711">(</span><span class="ident" id="5402712">c</span><span class="op" id="5402713">,</span>&nbsp;<span class="string" id="5402715">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5402747">)</span><br>
<span class="lineno">475</span><span class="op" id="5402749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5402752">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="5402822">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5402877">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="5402938">func</span>&nbsp;<span class="ident" id="5402943">stateE0</span><span class="op" id="5402950">(</span><span class="ident" id="5402951">s</span>&nbsp;<span class="op" id="5402953">*</span><span class="ident" id="5402954">scanner</span><span class="op" id="5402961">,</span>&nbsp;<span class="ident" id="5402963">c</span>&nbsp;<span class="builtintype" id="5402965">int</span><span class="op" id="5402968">)</span>&nbsp;<span class="builtintype" id="5402970">int</span>&nbsp;<span class="op" id="5402974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5402977">if</span>&nbsp;<span class="string" id="5402980">&#39;0&#39;</span>&nbsp;<span class="op" id="5402984">&lt;=</span>&nbsp;<span class="ident" id="5402987">c</span>&nbsp;<span class="op" id="5402989">&amp;&amp;</span>&nbsp;<span class="ident" id="5402992">c</span>&nbsp;<span class="op" id="5402994">&lt;=</span>&nbsp;<span class="string" id="5402997">&#39;9&#39;</span>&nbsp;<span class="op" id="5403001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403005">s</span><span class="op" id="5403006">.</span><span class="ident" id="5403007">step</span>&nbsp;<span class="op" id="5403012">=</span>&nbsp;<span class="ident" id="5403014">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403024">return</span>&nbsp;<span class="ident" id="5403031">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403045">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403048">return</span>&nbsp;<span class="ident" id="5403055">stateEndValue</span><span class="op" id="5403068">(</span><span class="ident" id="5403069">s</span><span class="op" id="5403070">,</span>&nbsp;<span class="ident" id="5403072">c</span><span class="op" id="5403073">)</span><br>
<span class="lineno"></span><span class="op" id="5403075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5403078">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="5403120">func</span>&nbsp;<span class="ident" id="5403125">stateT</span><span class="op" id="5403131">(</span><span class="ident" id="5403132">s</span>&nbsp;<span class="op" id="5403134">*</span><span class="ident" id="5403135">scanner</span><span class="op" id="5403142">,</span>&nbsp;<span class="ident" id="5403144">c</span>&nbsp;<span class="builtintype" id="5403146">int</span><span class="op" id="5403149">)</span>&nbsp;<span class="builtintype" id="5403151">int</span>&nbsp;<span class="op" id="5403155">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403158">if</span>&nbsp;<span class="ident" id="5403161">c</span>&nbsp;<span class="op" id="5403163">==</span>&nbsp;<span class="string" id="5403166">&#39;r&#39;</span>&nbsp;<span class="op" id="5403170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403174">s</span><span class="op" id="5403175">.</span><span class="ident" id="5403176">step</span>&nbsp;<span class="op" id="5403181">=</span>&nbsp;<span class="ident" id="5403183">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403193">return</span>&nbsp;<span class="ident" id="5403200">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403217">return</span>&nbsp;<span class="ident" id="5403224">s</span><span class="op" id="5403225">.</span><span class="builtintype" id="5403226">error</span><span class="op" id="5403231">(</span><span class="ident" id="5403232">c</span><span class="op" id="5403233">,</span>&nbsp;<span class="string" id="5403235">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="5403268">)</span><br>
<span class="lineno">495</span><span class="op" id="5403270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5403273">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="5403317">func</span>&nbsp;<span class="ident" id="5403322">stateTr</span><span class="op" id="5403329">(</span><span class="ident" id="5403330">s</span>&nbsp;<span class="op" id="5403332">*</span><span class="ident" id="5403333">scanner</span><span class="op" id="5403340">,</span>&nbsp;<span class="ident" id="5403342">c</span>&nbsp;<span class="builtintype" id="5403344">int</span><span class="op" id="5403347">)</span>&nbsp;<span class="builtintype" id="5403349">int</span>&nbsp;<span class="op" id="5403353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403356">if</span>&nbsp;<span class="ident" id="5403359">c</span>&nbsp;<span class="op" id="5403361">==</span>&nbsp;<span class="string" id="5403364">&#39;u&#39;</span>&nbsp;<span class="op" id="5403368">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403372">s</span><span class="op" id="5403373">.</span><span class="ident" id="5403374">step</span>&nbsp;<span class="op" id="5403379">=</span>&nbsp;<span class="ident" id="5403381">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403392">return</span>&nbsp;<span class="ident" id="5403399">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403416">return</span>&nbsp;<span class="ident" id="5403423">s</span><span class="op" id="5403424">.</span><span class="builtintype" id="5403425">error</span><span class="op" id="5403430">(</span><span class="ident" id="5403431">c</span><span class="op" id="5403432">,</span>&nbsp;<span class="string" id="5403434">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5403467">)</span><br>
<span class="lineno"></span><span class="op" id="5403469">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="5403472">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="5403518">func</span>&nbsp;<span class="ident" id="5403523">stateTru</span><span class="op" id="5403531">(</span><span class="ident" id="5403532">s</span>&nbsp;<span class="op" id="5403534">*</span><span class="ident" id="5403535">scanner</span><span class="op" id="5403542">,</span>&nbsp;<span class="ident" id="5403544">c</span>&nbsp;<span class="builtintype" id="5403546">int</span><span class="op" id="5403549">)</span>&nbsp;<span class="builtintype" id="5403551">int</span>&nbsp;<span class="op" id="5403555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403558">if</span>&nbsp;<span class="ident" id="5403561">c</span>&nbsp;<span class="op" id="5403563">==</span>&nbsp;<span class="string" id="5403566">&#39;e&#39;</span>&nbsp;<span class="op" id="5403570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403574">s</span><span class="op" id="5403575">.</span><span class="ident" id="5403576">step</span>&nbsp;<span class="op" id="5403581">=</span>&nbsp;<span class="ident" id="5403583">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403599">return</span>&nbsp;<span class="ident" id="5403606">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403623">return</span>&nbsp;<span class="ident" id="5403630">s</span><span class="op" id="5403631">.</span><span class="builtintype" id="5403632">error</span><span class="op" id="5403637">(</span><span class="ident" id="5403638">c</span><span class="op" id="5403639">,</span>&nbsp;<span class="string" id="5403641">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5403674">)</span><br>
<span class="lineno"></span><span class="op" id="5403676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="5403679">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="5403721">func</span>&nbsp;<span class="ident" id="5403726">stateF</span><span class="op" id="5403732">(</span><span class="ident" id="5403733">s</span>&nbsp;<span class="op" id="5403735">*</span><span class="ident" id="5403736">scanner</span><span class="op" id="5403743">,</span>&nbsp;<span class="ident" id="5403745">c</span>&nbsp;<span class="builtintype" id="5403747">int</span><span class="op" id="5403750">)</span>&nbsp;<span class="builtintype" id="5403752">int</span>&nbsp;<span class="op" id="5403756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403759">if</span>&nbsp;<span class="ident" id="5403762">c</span>&nbsp;<span class="op" id="5403764">==</span>&nbsp;<span class="string" id="5403767">&#39;a&#39;</span>&nbsp;<span class="op" id="5403771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403775">s</span><span class="op" id="5403776">.</span><span class="ident" id="5403777">step</span>&nbsp;<span class="op" id="5403782">=</span>&nbsp;<span class="ident" id="5403784">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403794">return</span>&nbsp;<span class="ident" id="5403801">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5403815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403818">return</span>&nbsp;<span class="ident" id="5403825">s</span><span class="op" id="5403826">.</span><span class="builtintype" id="5403827">error</span><span class="op" id="5403832">(</span><span class="ident" id="5403833">c</span><span class="op" id="5403834">,</span>&nbsp;<span class="string" id="5403836">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="5403870">)</span><br>
<span class="lineno"></span><span class="op" id="5403872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5403875">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="5403919">func</span>&nbsp;<span class="ident" id="5403924">stateFa</span><span class="op" id="5403931">(</span><span class="ident" id="5403932">s</span>&nbsp;<span class="op" id="5403934">*</span><span class="ident" id="5403935">scanner</span><span class="op" id="5403942">,</span>&nbsp;<span class="ident" id="5403944">c</span>&nbsp;<span class="builtintype" id="5403946">int</span><span class="op" id="5403949">)</span>&nbsp;<span class="builtintype" id="5403951">int</span>&nbsp;<span class="op" id="5403955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403958">if</span>&nbsp;<span class="ident" id="5403961">c</span>&nbsp;<span class="op" id="5403963">==</span>&nbsp;<span class="string" id="5403966">&#39;l&#39;</span>&nbsp;<span class="op" id="5403970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5403974">s</span><span class="op" id="5403975">.</span><span class="ident" id="5403976">step</span>&nbsp;<span class="op" id="5403981">=</span>&nbsp;<span class="ident" id="5403983">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5403994">return</span>&nbsp;<span class="ident" id="5404001">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404015">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404018">return</span>&nbsp;<span class="ident" id="5404025">s</span><span class="op" id="5404026">.</span><span class="builtintype" id="5404027">error</span><span class="op" id="5404032">(</span><span class="ident" id="5404033">c</span><span class="op" id="5404034">,</span>&nbsp;<span class="string" id="5404036">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5404070">)</span><br>
<span class="lineno"></span><span class="op" id="5404072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5404075">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="5404121">func</span>&nbsp;<span class="ident" id="5404126">stateFal</span><span class="op" id="5404134">(</span><span class="ident" id="5404135">s</span>&nbsp;<span class="op" id="5404137">*</span><span class="ident" id="5404138">scanner</span><span class="op" id="5404145">,</span>&nbsp;<span class="ident" id="5404147">c</span>&nbsp;<span class="builtintype" id="5404149">int</span><span class="op" id="5404152">)</span>&nbsp;<span class="builtintype" id="5404154">int</span>&nbsp;<span class="op" id="5404158">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404161">if</span>&nbsp;<span class="ident" id="5404164">c</span>&nbsp;<span class="op" id="5404166">==</span>&nbsp;<span class="string" id="5404169">&#39;s&#39;</span>&nbsp;<span class="op" id="5404173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404177">s</span><span class="op" id="5404178">.</span><span class="ident" id="5404179">step</span>&nbsp;<span class="op" id="5404184">=</span>&nbsp;<span class="ident" id="5404186">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404198">return</span>&nbsp;<span class="ident" id="5404205">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404222">return</span>&nbsp;<span class="ident" id="5404229">s</span><span class="op" id="5404230">.</span><span class="builtintype" id="5404231">error</span><span class="op" id="5404236">(</span><span class="ident" id="5404237">c</span><span class="op" id="5404238">,</span>&nbsp;<span class="string" id="5404240">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="5404274">)</span><br>
<span class="lineno">540</span><span class="op" id="5404276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5404279">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="5404327">func</span>&nbsp;<span class="ident" id="5404332">stateFals</span><span class="op" id="5404341">(</span><span class="ident" id="5404342">s</span>&nbsp;<span class="op" id="5404344">*</span><span class="ident" id="5404345">scanner</span><span class="op" id="5404352">,</span>&nbsp;<span class="ident" id="5404354">c</span>&nbsp;<span class="builtintype" id="5404356">int</span><span class="op" id="5404359">)</span>&nbsp;<span class="builtintype" id="5404361">int</span>&nbsp;<span class="op" id="5404365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404368">if</span>&nbsp;<span class="ident" id="5404371">c</span>&nbsp;<span class="op" id="5404373">==</span>&nbsp;<span class="string" id="5404376">&#39;e&#39;</span>&nbsp;<span class="op" id="5404380">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404384">s</span><span class="op" id="5404385">.</span><span class="ident" id="5404386">step</span>&nbsp;<span class="op" id="5404391">=</span>&nbsp;<span class="ident" id="5404393">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404409">return</span>&nbsp;<span class="ident" id="5404416">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404433">return</span>&nbsp;<span class="ident" id="5404440">s</span><span class="op" id="5404441">.</span><span class="builtintype" id="5404442">error</span><span class="op" id="5404447">(</span><span class="ident" id="5404448">c</span><span class="op" id="5404449">,</span>&nbsp;<span class="string" id="5404451">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5404485">)</span><br>
<span class="lineno"></span><span class="op" id="5404487">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="5404490">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="5404532">func</span>&nbsp;<span class="ident" id="5404537">stateN</span><span class="op" id="5404543">(</span><span class="ident" id="5404544">s</span>&nbsp;<span class="op" id="5404546">*</span><span class="ident" id="5404547">scanner</span><span class="op" id="5404554">,</span>&nbsp;<span class="ident" id="5404556">c</span>&nbsp;<span class="builtintype" id="5404558">int</span><span class="op" id="5404561">)</span>&nbsp;<span class="builtintype" id="5404563">int</span>&nbsp;<span class="op" id="5404567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404570">if</span>&nbsp;<span class="ident" id="5404573">c</span>&nbsp;<span class="op" id="5404575">==</span>&nbsp;<span class="string" id="5404578">&#39;u&#39;</span>&nbsp;<span class="op" id="5404582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404586">s</span><span class="op" id="5404587">.</span><span class="ident" id="5404588">step</span>&nbsp;<span class="op" id="5404593">=</span>&nbsp;<span class="ident" id="5404595">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404605">return</span>&nbsp;<span class="ident" id="5404612">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404629">return</span>&nbsp;<span class="ident" id="5404636">s</span><span class="op" id="5404637">.</span><span class="builtintype" id="5404638">error</span><span class="op" id="5404643">(</span><span class="ident" id="5404644">c</span><span class="op" id="5404645">,</span>&nbsp;<span class="string" id="5404647">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5404680">)</span><br>
<span class="lineno"></span><span class="op" id="5404682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="5404685">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="5404729">func</span>&nbsp;<span class="ident" id="5404734">stateNu</span><span class="op" id="5404741">(</span><span class="ident" id="5404742">s</span>&nbsp;<span class="op" id="5404744">*</span><span class="ident" id="5404745">scanner</span><span class="op" id="5404752">,</span>&nbsp;<span class="ident" id="5404754">c</span>&nbsp;<span class="builtintype" id="5404756">int</span><span class="op" id="5404759">)</span>&nbsp;<span class="builtintype" id="5404761">int</span>&nbsp;<span class="op" id="5404765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404768">if</span>&nbsp;<span class="ident" id="5404771">c</span>&nbsp;<span class="op" id="5404773">==</span>&nbsp;<span class="string" id="5404776">&#39;l&#39;</span>&nbsp;<span class="op" id="5404780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404784">s</span><span class="op" id="5404785">.</span><span class="ident" id="5404786">step</span>&nbsp;<span class="op" id="5404791">=</span>&nbsp;<span class="ident" id="5404793">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404804">return</span>&nbsp;<span class="ident" id="5404811">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5404825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404828">return</span>&nbsp;<span class="ident" id="5404835">s</span><span class="op" id="5404836">.</span><span class="builtintype" id="5404837">error</span><span class="op" id="5404842">(</span><span class="ident" id="5404843">c</span><span class="op" id="5404844">,</span>&nbsp;<span class="string" id="5404846">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5404879">)</span><br>
<span class="lineno"></span><span class="op" id="5404881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5404884">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="5404930">func</span>&nbsp;<span class="ident" id="5404935">stateNul</span><span class="op" id="5404943">(</span><span class="ident" id="5404944">s</span>&nbsp;<span class="op" id="5404946">*</span><span class="ident" id="5404947">scanner</span><span class="op" id="5404954">,</span>&nbsp;<span class="ident" id="5404956">c</span>&nbsp;<span class="builtintype" id="5404958">int</span><span class="op" id="5404961">)</span>&nbsp;<span class="builtintype" id="5404963">int</span>&nbsp;<span class="op" id="5404967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5404970">if</span>&nbsp;<span class="ident" id="5404973">c</span>&nbsp;<span class="op" id="5404975">==</span>&nbsp;<span class="string" id="5404978">&#39;l&#39;</span>&nbsp;<span class="op" id="5404982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5404986">s</span><span class="op" id="5404987">.</span><span class="ident" id="5404988">step</span>&nbsp;<span class="op" id="5404993">=</span>&nbsp;<span class="ident" id="5404995">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405011">return</span>&nbsp;<span class="ident" id="5405018">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5405032">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405035">return</span>&nbsp;<span class="ident" id="5405042">s</span><span class="op" id="5405043">.</span><span class="builtintype" id="5405044">error</span><span class="op" id="5405049">(</span><span class="ident" id="5405050">c</span><span class="op" id="5405051">,</span>&nbsp;<span class="string" id="5405053">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5405086">)</span><br>
<span class="lineno"></span><span class="op" id="5405088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5405091">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5405149">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="5405192">func</span>&nbsp;<span class="ident" id="5405197">stateError</span><span class="op" id="5405207">(</span><span class="ident" id="5405208">s</span>&nbsp;<span class="op" id="5405210">*</span><span class="ident" id="5405211">scanner</span><span class="op" id="5405218">,</span>&nbsp;<span class="ident" id="5405220">c</span>&nbsp;<span class="builtintype" id="5405222">int</span><span class="op" id="5405225">)</span>&nbsp;<span class="builtintype" id="5405227">int</span>&nbsp;<span class="op" id="5405231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405234">return</span>&nbsp;<span class="ident" id="5405241">scanError</span><br>
<span class="lineno"></span><span class="op" id="5405251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5405254">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="5405313">func</span>&nbsp;<span class="op" id="5405318">(</span><span class="ident" id="5405319">s</span>&nbsp;<span class="op" id="5405321">*</span><span class="ident" id="5405322">scanner</span><span class="op" id="5405329">)</span>&nbsp;<span class="builtintype" id="5405331">error</span><span class="op" id="5405336">(</span><span class="ident" id="5405337">c</span>&nbsp;<span class="builtintype" id="5405339">int</span><span class="op" id="5405342">,</span>&nbsp;<span class="ident" id="5405344">context</span>&nbsp;<span class="builtintype" id="5405352">string</span><span class="op" id="5405358">)</span>&nbsp;<span class="builtintype" id="5405360">int</span>&nbsp;<span class="op" id="5405364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5405367">s</span><span class="op" id="5405368">.</span><span class="ident" id="5405369">step</span>&nbsp;<span class="op" id="5405374">=</span>&nbsp;<span class="ident" id="5405376">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5405388">s</span><span class="op" id="5405389">.</span><span class="ident" id="5405390">err</span>&nbsp;<span class="op" id="5405394">=</span>&nbsp;<span class="op" id="5405396">&amp;</span><span class="ident" id="5405397">SyntaxError</span><span class="op" id="5405408">{</span><span class="string" id="5405409">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="5405430">+</span>&nbsp;<span class="ident" id="5405432">quoteChar</span><span class="op" id="5405441">(</span><span class="ident" id="5405442">c</span><span class="op" id="5405443">)</span>&nbsp;<span class="op" id="5405445">+</span>&nbsp;<span class="string" id="5405447">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="5405451">+</span>&nbsp;<span class="ident" id="5405453">context</span><span class="op" id="5405460">,</span>&nbsp;<span class="ident" id="5405462">s</span><span class="op" id="5405463">.</span><span class="ident" id="5405464">bytes</span><span class="op" id="5405469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405472">return</span>&nbsp;<span class="ident" id="5405479">scanError</span><br>
<span class="lineno"></span><span class="op" id="5405489">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="5405492">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="5405545">func</span>&nbsp;<span class="ident" id="5405550">quoteChar</span><span class="op" id="5405559">(</span><span class="ident" id="5405560">c</span>&nbsp;<span class="builtintype" id="5405562">int</span><span class="op" id="5405565">)</span>&nbsp;<span class="builtintype" id="5405567">string</span>&nbsp;<span class="op" id="5405574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5405577">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405627">if</span>&nbsp;<span class="ident" id="5405630">c</span>&nbsp;<span class="op" id="5405632">==</span>&nbsp;<span class="string" id="5405635">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="5405640">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405644">return</span>&nbsp;<span class="string" id="5405651">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5405659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405662">if</span>&nbsp;<span class="ident" id="5405665">c</span>&nbsp;<span class="op" id="5405667">==</span>&nbsp;<span class="string" id="5405670">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5405674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405678">return</span>&nbsp;<span class="string" id="5405685">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5405692">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5405696">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5405749">s</span>&nbsp;<span class="op" id="5405751">:=</span>&nbsp;<span class="ident" id="5405754">strconv</span><span class="op" id="5405761">.</span><span class="ident" id="5405762">Quote</span><span class="op" id="5405767">(</span><span class="builtintype" id="5405768">string</span><span class="op" id="5405774">(</span><span class="ident" id="5405775">c</span><span class="op" id="5405776">)</span><span class="op" id="5405777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405780">return</span>&nbsp;<span class="string" id="5405787">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="5405791">+</span>&nbsp;<span class="ident" id="5405793">s</span><span class="op" id="5405794">[</span><span class="num" id="5405795">1</span><span class="op" id="5405796">:</span><span class="builtinfunc" id="5405797">len</span><span class="op" id="5405800">(</span><span class="ident" id="5405801">s</span><span class="op" id="5405802">)</span><span class="op" id="5405803">-</span><span class="num" id="5405804">1</span><span class="op" id="5405805">]</span>&nbsp;<span class="op" id="5405807">+</span>&nbsp;<span class="string" id="5405809">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="5405813">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="5405816">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="5405894">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="5405948">func</span>&nbsp;<span class="op" id="5405953">(</span><span class="ident" id="5405954">s</span>&nbsp;<span class="op" id="5405956">*</span><span class="ident" id="5405957">scanner</span><span class="op" id="5405964">)</span>&nbsp;<span class="ident" id="5405966">undo</span><span class="op" id="5405970">(</span><span class="ident" id="5405971">scanCode</span>&nbsp;<span class="builtintype" id="5405980">int</span><span class="op" id="5405983">)</span>&nbsp;<span class="op" id="5405985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5405988">if</span>&nbsp;<span class="ident" id="5405991">s</span><span class="op" id="5405992">.</span><span class="ident" id="5405993">redo</span>&nbsp;<span class="op" id="5405998">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5406002">panic</span><span class="op" id="5406007">(</span><span class="string" id="5406008">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="5406038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5406041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406044">s</span><span class="op" id="5406045">.</span><span class="ident" id="5406046">redoCode</span>&nbsp;<span class="op" id="5406055">=</span>&nbsp;<span class="ident" id="5406057">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406067">s</span><span class="op" id="5406068">.</span><span class="ident" id="5406069">redoState</span>&nbsp;<span class="op" id="5406079">=</span>&nbsp;<span class="ident" id="5406081">s</span><span class="op" id="5406082">.</span><span class="ident" id="5406083">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406089">s</span><span class="op" id="5406090">.</span><span class="ident" id="5406091">step</span>&nbsp;<span class="op" id="5406096">=</span>&nbsp;<span class="ident" id="5406098">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406109">s</span><span class="op" id="5406110">.</span><span class="ident" id="5406111">redo</span>&nbsp;<span class="op" id="5406116">=</span>&nbsp;<span class="builtintype" id="5406118">true</span><br>
<span class="lineno"></span><span class="op" id="5406123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5406126">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="5406182">func</span>&nbsp;<span class="ident" id="5406187">stateRedo</span><span class="op" id="5406196">(</span><span class="ident" id="5406197">s</span>&nbsp;<span class="op" id="5406199">*</span><span class="ident" id="5406200">scanner</span><span class="op" id="5406207">,</span>&nbsp;<span class="ident" id="5406209">c</span>&nbsp;<span class="builtintype" id="5406211">int</span><span class="op" id="5406214">)</span>&nbsp;<span class="builtintype" id="5406216">int</span>&nbsp;<span class="op" id="5406220">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406223">s</span><span class="op" id="5406224">.</span><span class="ident" id="5406225">redo</span>&nbsp;<span class="op" id="5406230">=</span>&nbsp;<span class="builtintype" id="5406232">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5406239">s</span><span class="op" id="5406240">.</span><span class="ident" id="5406241">step</span>&nbsp;<span class="op" id="5406246">=</span>&nbsp;<span class="ident" id="5406248">s</span><span class="op" id="5406249">.</span><span class="ident" id="5406250">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5406261">return</span>&nbsp;<span class="ident" id="5406268">s</span><span class="op" id="5406269">.</span><span class="ident" id="5406270">redoCode</span><br>
<span class="lineno"></span><span class="op" id="5406279">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
