<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8113356">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8113411">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8113465">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8113516">package</span>&nbsp;<span class="ident" id="8113524">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8113535">import</span>&nbsp;<span class="op" id="8113542">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113545">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113554">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113563">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113573">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113581">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113588">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113594">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113605">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113615">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113623">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113634">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8113645">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="8113652">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8113655">func</span>&nbsp;<span class="ident" id="8113660">TestQuotedPrintable</span><span class="op" id="8113679">(</span><span class="ident" id="8113680">t</span>&nbsp;<span class="op" id="8113682">*</span><span class="ident" id="8113683">testing</span><span class="op" id="8113690">.</span><span class="ident" id="8113691">T</span><span class="op" id="8113692">)</span>&nbsp;<span class="op" id="8113694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113697">tests</span>&nbsp;<span class="op" id="8113703">:=</span>&nbsp;<span class="op" id="8113706">[</span><span class="op" id="8113707">]</span><span class="keyword" id="8113708">struct</span>&nbsp;<span class="op" id="8113715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113719">in</span><span class="op" id="8113721">,</span>&nbsp;<span class="ident" id="8113723">want</span>&nbsp;<span class="builtintype" id="8113728">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8113737">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8113746">interface</span><span class="op" id="8113755">{</span><span class="op" id="8113756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113759">}</span><span class="op" id="8113760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113764">{</span><span class="ident" id="8113765">in</span><span class="op" id="8113767">:</span>&nbsp;<span class="string" id="8113769">&#34;&#34;</span><span class="op" id="8113771">,</span>&nbsp;<span class="ident" id="8113773">want</span><span class="op" id="8113777">:</span>&nbsp;<span class="string" id="8113779">&#34;&#34;</span><span class="op" id="8113781">}</span><span class="op" id="8113782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113786">{</span><span class="ident" id="8113787">in</span><span class="op" id="8113789">:</span>&nbsp;<span class="string" id="8113791">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8113800">,</span>&nbsp;<span class="ident" id="8113802">want</span><span class="op" id="8113806">:</span>&nbsp;<span class="string" id="8113808">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8113817">}</span><span class="op" id="8113818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113822">{</span><span class="ident" id="8113823">in</span><span class="op" id="8113825">:</span>&nbsp;<span class="string" id="8113827">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="8113839">,</span>&nbsp;<span class="ident" id="8113841">want</span><span class="op" id="8113845">:</span>&nbsp;<span class="string" id="8113847">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="8113857">}</span><span class="op" id="8113858">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113862">{</span><span class="ident" id="8113863">in</span><span class="op" id="8113865">:</span>&nbsp;<span class="string" id="8113867">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="8113879">,</span>&nbsp;<span class="ident" id="8113881">want</span><span class="op" id="8113885">:</span>&nbsp;<span class="string" id="8113887">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8113896">}</span><span class="op" id="8113897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113901">{</span><span class="ident" id="8113902">in</span><span class="op" id="8113904">:</span>&nbsp;<span class="string" id="8113906">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8113917">,</span>&nbsp;<span class="ident" id="8113919">want</span><span class="op" id="8113923">:</span>&nbsp;<span class="string" id="8113925">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8113936">}</span><span class="op" id="8113937">,</span>&nbsp;<span class="comment" id="8113939">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8113958">{</span><span class="ident" id="8113959">in</span><span class="op" id="8113961">:</span>&nbsp;<span class="string" id="8113963">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="8113974">,</span>&nbsp;<span class="ident" id="8113976">want</span><span class="op" id="8113980">:</span>&nbsp;<span class="string" id="8113982">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8113991">,</span>&nbsp;<span class="ident" id="8113993">err</span><span class="op" id="8113996">:</span>&nbsp;<span class="ident" id="8113998">io</span><span class="op" id="8114000">.</span><span class="ident" id="8114001">ErrUnexpectedEOF</span><span class="op" id="8114017">}</span><span class="op" id="8114018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114022">{</span><span class="ident" id="8114023">in</span><span class="op" id="8114025">:</span>&nbsp;<span class="string" id="8114027">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="8114039">,</span>&nbsp;<span class="ident" id="8114041">want</span><span class="op" id="8114045">:</span>&nbsp;<span class="string" id="8114047">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8114056">,</span>&nbsp;<span class="ident" id="8114058">err</span><span class="op" id="8114061">:</span>&nbsp;<span class="string" id="8114063">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="8114114">}</span><span class="op" id="8114115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114119">{</span><span class="ident" id="8114120">in</span><span class="op" id="8114122">:</span>&nbsp;<span class="string" id="8114124">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="8114139">,</span>&nbsp;<span class="ident" id="8114141">want</span><span class="op" id="8114145">:</span>&nbsp;<span class="string" id="8114147">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="8114160">}</span><span class="op" id="8114161">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114165">{</span><span class="ident" id="8114166">in</span><span class="op" id="8114168">:</span>&nbsp;<span class="string" id="8114170">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8114191">,</span>&nbsp;<span class="ident" id="8114193">want</span><span class="op" id="8114197">:</span>&nbsp;<span class="string" id="8114199">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="8114211">}</span><span class="op" id="8114212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114216">{</span><span class="ident" id="8114217">in</span><span class="op" id="8114219">:</span>&nbsp;<span class="string" id="8114221">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8114236">,</span>&nbsp;<span class="ident" id="8114238">want</span><span class="op" id="8114242">:</span>&nbsp;<span class="string" id="8114244">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8114253">}</span><span class="op" id="8114254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114258">{</span><span class="ident" id="8114259">in</span><span class="op" id="8114261">:</span>&nbsp;<span class="string" id="8114263">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8114276">,</span>&nbsp;<span class="ident" id="8114278">want</span><span class="op" id="8114282">:</span>&nbsp;<span class="string" id="8114284">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8114293">}</span><span class="op" id="8114294">,</span>&nbsp;<span class="comment" id="8114296">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114326">{</span><span class="ident" id="8114327">in</span><span class="op" id="8114329">:</span>&nbsp;<span class="string" id="8114331">&#34;foo=\nbar&#34;</span><span class="op" id="8114342">,</span>&nbsp;<span class="ident" id="8114344">want</span><span class="op" id="8114348">:</span>&nbsp;<span class="string" id="8114350">&#34;foobar&#34;</span><span class="op" id="8114358">}</span><span class="op" id="8114359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114363">{</span><span class="ident" id="8114364">in</span><span class="op" id="8114366">:</span>&nbsp;<span class="string" id="8114368">&#34;foo\x00bar&#34;</span><span class="op" id="8114380">,</span>&nbsp;<span class="ident" id="8114382">want</span><span class="op" id="8114386">:</span>&nbsp;<span class="string" id="8114388">&#34;foo&#34;</span><span class="op" id="8114393">,</span>&nbsp;<span class="ident" id="8114395">err</span><span class="op" id="8114398">:</span>&nbsp;<span class="string" id="8114400">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8114465">}</span><span class="op" id="8114466">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114470">{</span><span class="ident" id="8114471">in</span><span class="op" id="8114473">:</span>&nbsp;<span class="string" id="8114475">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="8114488">,</span>&nbsp;<span class="ident" id="8114490">want</span><span class="op" id="8114494">:</span>&nbsp;<span class="string" id="8114496">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8114505">,</span>&nbsp;<span class="ident" id="8114507">err</span><span class="op" id="8114510">:</span>&nbsp;<span class="string" id="8114512">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8114577">}</span><span class="op" id="8114578">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8114583">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114600">{</span><span class="ident" id="8114601">in</span><span class="op" id="8114603">:</span>&nbsp;<span class="string" id="8114605">&#34;=3D30\n&#34;</span><span class="op" id="8114614">,</span>&nbsp;<span class="ident" id="8114616">want</span><span class="op" id="8114620">:</span>&nbsp;<span class="string" id="8114622">&#34;=30\n&#34;</span><span class="op" id="8114629">}</span><span class="op" id="8114630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114634">{</span><span class="ident" id="8114635">in</span><span class="op" id="8114637">:</span>&nbsp;<span class="string" id="8114639">&#34;=00=FF0=\n&#34;</span><span class="op" id="8114651">,</span>&nbsp;<span class="ident" id="8114653">want</span><span class="op" id="8114657">:</span>&nbsp;<span class="string" id="8114659">&#34;\x00\xff0&#34;</span><span class="op" id="8114670">}</span><span class="op" id="8114671">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8114676">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114701">{</span><span class="ident" id="8114702">in</span><span class="op" id="8114704">:</span>&nbsp;<span class="string" id="8114706">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="8114715">,</span>&nbsp;<span class="ident" id="8114717">want</span><span class="op" id="8114721">:</span>&nbsp;<span class="string" id="8114723">&#34;foo\n&#34;</span><span class="op" id="8114730">}</span><span class="op" id="8114731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114735">{</span><span class="ident" id="8114736">in</span><span class="op" id="8114738">:</span>&nbsp;<span class="string" id="8114740">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="8114770">,</span>&nbsp;<span class="ident" id="8114772">want</span><span class="op" id="8114776">:</span>&nbsp;<span class="string" id="8114778">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="8114801">}</span><span class="op" id="8114802">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8114807">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8114882">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114947">{</span><span class="ident" id="8114948">in</span><span class="op" id="8114950">:</span>&nbsp;<span class="string" id="8114952">&#34;foo\nbar&#34;</span><span class="op" id="8114962">,</span>&nbsp;<span class="ident" id="8114964">want</span><span class="op" id="8114968">:</span>&nbsp;<span class="string" id="8114970">&#34;foo\nbar&#34;</span><span class="op" id="8114980">}</span><span class="op" id="8114981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8114985">{</span><span class="ident" id="8114986">in</span><span class="op" id="8114988">:</span>&nbsp;<span class="string" id="8114990">&#34;foo\rbar&#34;</span><span class="op" id="8115000">,</span>&nbsp;<span class="ident" id="8115002">want</span><span class="op" id="8115006">:</span>&nbsp;<span class="string" id="8115008">&#34;foo\rbar&#34;</span><span class="op" id="8115018">}</span><span class="op" id="8115019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115023">{</span><span class="ident" id="8115024">in</span><span class="op" id="8115026">:</span>&nbsp;<span class="string" id="8115028">&#34;foo\r\nbar&#34;</span><span class="op" id="8115040">,</span>&nbsp;<span class="ident" id="8115042">want</span><span class="op" id="8115046">:</span>&nbsp;<span class="string" id="8115048">&#34;foo\r\nbar&#34;</span><span class="op" id="8115060">}</span><span class="op" id="8115061">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8115066">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115108">{</span><span class="ident" id="8115109">in</span><span class="op" id="8115111">:</span>&nbsp;<span class="string" id="8115113">&#34;foo=\r\nbar&#34;</span><span class="op" id="8115126">,</span>&nbsp;<span class="ident" id="8115128">want</span><span class="op" id="8115132">:</span>&nbsp;<span class="string" id="8115134">&#34;foobar&#34;</span><span class="op" id="8115142">}</span><span class="op" id="8115143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115147">{</span><span class="ident" id="8115148">in</span><span class="op" id="8115150">:</span>&nbsp;<span class="string" id="8115152">&#34;foo=\nbar&#34;</span><span class="op" id="8115163">,</span>&nbsp;<span class="ident" id="8115165">want</span><span class="op" id="8115169">:</span>&nbsp;<span class="string" id="8115171">&#34;foobar&#34;</span><span class="op" id="8115179">}</span><span class="op" id="8115180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115184">{</span><span class="ident" id="8115185">in</span><span class="op" id="8115187">:</span>&nbsp;<span class="string" id="8115189">&#34;foo=\rbar&#34;</span><span class="op" id="8115200">,</span>&nbsp;<span class="ident" id="8115202">want</span><span class="op" id="8115206">:</span>&nbsp;<span class="string" id="8115208">&#34;foo&#34;</span><span class="op" id="8115213">,</span>&nbsp;<span class="ident" id="8115215">err</span><span class="op" id="8115218">:</span>&nbsp;<span class="string" id="8115220">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="8115271">}</span><span class="op" id="8115272">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115276">{</span><span class="ident" id="8115277">in</span><span class="op" id="8115279">:</span>&nbsp;<span class="string" id="8115281">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="8115299">,</span>&nbsp;<span class="ident" id="8115301">want</span><span class="op" id="8115305">:</span>&nbsp;<span class="string" id="8115307">&#34;foo&#34;</span><span class="op" id="8115312">,</span>&nbsp;<span class="ident" id="8115314">err</span><span class="op" id="8115317">:</span>&nbsp;<span class="string" id="8115319">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="8115366">}</span><span class="op" id="8115367">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8115372">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115400">{</span><span class="ident" id="8115401">in</span><span class="op" id="8115403">:</span>&nbsp;<span class="string" id="8115405">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="8115426">+</span>&nbsp;<span class="string" id="8115428">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="8115454">+</span>&nbsp;<span class="string" id="8115456">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8115487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8115492">want</span><span class="op" id="8115496">:</span>&nbsp;<span class="string" id="8115498">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8115564">}</span><span class="op" id="8115565">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115571">for</span>&nbsp;<span class="ident" id="8115575">_</span><span class="op" id="8115576">,</span>&nbsp;<span class="ident" id="8115578">tt</span>&nbsp;<span class="op" id="8115581">:=</span>&nbsp;<span class="keyword" id="8115584">range</span>&nbsp;<span class="ident" id="8115590">tests</span>&nbsp;<span class="op" id="8115596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115600">var</span>&nbsp;<span class="ident" id="8115604">buf</span>&nbsp;<span class="ident" id="8115608">bytes</span><span class="op" id="8115613">.</span><span class="ident" id="8115614">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8115623">_</span><span class="op" id="8115624">,</span>&nbsp;<span class="ident" id="8115626">err</span>&nbsp;<span class="op" id="8115630">:=</span>&nbsp;<span class="ident" id="8115633">io</span><span class="op" id="8115635">.</span><span class="ident" id="8115636">Copy</span><span class="op" id="8115640">(</span><span class="op" id="8115641">&amp;</span><span class="ident" id="8115642">buf</span><span class="op" id="8115645">,</span>&nbsp;<span class="ident" id="8115647">newQuotedPrintableReader</span><span class="op" id="8115671">(</span><span class="ident" id="8115672">strings</span><span class="op" id="8115679">.</span><span class="ident" id="8115680">NewReader</span><span class="op" id="8115689">(</span><span class="ident" id="8115690">tt</span><span class="op" id="8115692">.</span><span class="ident" id="8115693">in</span><span class="op" id="8115695">)</span><span class="op" id="8115696">)</span><span class="op" id="8115697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115701">if</span>&nbsp;<span class="ident" id="8115704">got</span>&nbsp;<span class="op" id="8115708">:=</span>&nbsp;<span class="ident" id="8115711">buf</span><span class="op" id="8115714">.</span><span class="ident" id="8115715">String</span><span class="op" id="8115721">(</span><span class="op" id="8115722">)</span><span class="op" id="8115723">;</span>&nbsp;<span class="ident" id="8115725">got</span>&nbsp;<span class="op" id="8115729">!=</span>&nbsp;<span class="ident" id="8115732">tt</span><span class="op" id="8115734">.</span><span class="ident" id="8115735">want</span>&nbsp;<span class="op" id="8115740">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8115745">t</span><span class="op" id="8115746">.</span><span class="ident" id="8115747">Errorf</span><span class="op" id="8115753">(</span><span class="string" id="8115754">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8115779">,</span>&nbsp;<span class="ident" id="8115781">tt</span><span class="op" id="8115783">.</span><span class="ident" id="8115784">in</span><span class="op" id="8115786">,</span>&nbsp;<span class="ident" id="8115788">got</span><span class="op" id="8115791">,</span>&nbsp;<span class="ident" id="8115793">tt</span><span class="op" id="8115795">.</span><span class="ident" id="8115796">want</span><span class="op" id="8115800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115808">switch</span>&nbsp;<span class="ident" id="8115815">verr</span>&nbsp;<span class="op" id="8115820">:=</span>&nbsp;<span class="ident" id="8115823">tt</span><span class="op" id="8115825">.</span><span class="ident" id="8115826">err</span><span class="op" id="8115829">.</span><span class="op" id="8115830">(</span><span class="keyword" id="8115831">type</span><span class="op" id="8115835">)</span>&nbsp;<span class="op" id="8115837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115841">case</span>&nbsp;<span class="ident" id="8115846">nil</span><span class="op" id="8115849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115854">if</span>&nbsp;<span class="ident" id="8115857">err</span>&nbsp;<span class="op" id="8115861">!=</span>&nbsp;<span class="ident" id="8115864">nil</span>&nbsp;<span class="op" id="8115868">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8115874">t</span><span class="op" id="8115875">.</span><span class="ident" id="8115876">Errorf</span><span class="op" id="8115882">(</span><span class="string" id="8115883">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8115917">,</span>&nbsp;<span class="ident" id="8115919">tt</span><span class="op" id="8115921">.</span><span class="ident" id="8115922">in</span><span class="op" id="8115924">,</span>&nbsp;<span class="ident" id="8115926">err</span><span class="op" id="8115929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8115934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115938">case</span>&nbsp;<span class="builtintype" id="8115943">string</span><span class="op" id="8115949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8115954">if</span>&nbsp;<span class="ident" id="8115957">got</span>&nbsp;<span class="op" id="8115961">:=</span>&nbsp;<span class="ident" id="8115964">fmt</span><span class="op" id="8115967">.</span><span class="ident" id="8115968">Sprint</span><span class="op" id="8115974">(</span><span class="ident" id="8115975">err</span><span class="op" id="8115978">)</span><span class="op" id="8115979">;</span>&nbsp;<span class="ident" id="8115981">got</span>&nbsp;<span class="op" id="8115985">!=</span>&nbsp;<span class="ident" id="8115988">verr</span>&nbsp;<span class="op" id="8115993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8115999">t</span><span class="op" id="8116000">.</span><span class="ident" id="8116001">Errorf</span><span class="op" id="8116007">(</span><span class="string" id="8116008">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8116039">,</span>&nbsp;<span class="ident" id="8116041">tt</span><span class="op" id="8116043">.</span><span class="ident" id="8116044">in</span><span class="op" id="8116046">,</span>&nbsp;<span class="ident" id="8116048">got</span><span class="op" id="8116051">,</span>&nbsp;<span class="ident" id="8116053">verr</span><span class="op" id="8116057">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116066">case</span>&nbsp;<span class="builtintype" id="8116071">error</span><span class="op" id="8116076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116081">if</span>&nbsp;<span class="ident" id="8116084">err</span>&nbsp;<span class="op" id="8116088">!=</span>&nbsp;<span class="ident" id="8116091">verr</span>&nbsp;<span class="op" id="8116096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116102">t</span><span class="op" id="8116103">.</span><span class="ident" id="8116104">Errorf</span><span class="op" id="8116110">(</span><span class="string" id="8116111">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8116142">,</span>&nbsp;<span class="ident" id="8116144">tt</span><span class="op" id="8116146">.</span><span class="ident" id="8116147">in</span><span class="op" id="8116149">,</span>&nbsp;<span class="ident" id="8116151">err</span><span class="op" id="8116154">,</span>&nbsp;<span class="ident" id="8116156">verr</span><span class="op" id="8116160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116165">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="8116175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8116178">func</span>&nbsp;<span class="ident" id="8116183">everySequence</span><span class="op" id="8116196">(</span><span class="ident" id="8116197">base</span><span class="op" id="8116201">,</span>&nbsp;<span class="ident" id="8116203">alpha</span>&nbsp;<span class="builtintype" id="8116209">string</span><span class="op" id="8116215">,</span>&nbsp;<span class="ident" id="8116217">length</span>&nbsp;<span class="builtintype" id="8116224">int</span><span class="op" id="8116227">,</span>&nbsp;<span class="ident" id="8116229">fn</span>&nbsp;<span class="keyword" id="8116232">func</span><span class="op" id="8116236">(</span><span class="builtintype" id="8116237">string</span><span class="op" id="8116243">)</span><span class="op" id="8116244">)</span>&nbsp;<span class="op" id="8116246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116249">if</span>&nbsp;<span class="builtinfunc" id="8116252">len</span><span class="op" id="8116255">(</span><span class="ident" id="8116256">base</span><span class="op" id="8116260">)</span>&nbsp;<span class="op" id="8116262">==</span>&nbsp;<span class="ident" id="8116265">length</span>&nbsp;<span class="op" id="8116272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116276">fn</span><span class="op" id="8116278">(</span><span class="ident" id="8116279">base</span><span class="op" id="8116283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116287">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116295">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116298">for</span>&nbsp;<span class="ident" id="8116302">i</span>&nbsp;<span class="op" id="8116304">:=</span>&nbsp;<span class="num" id="8116307">0</span><span class="op" id="8116308">;</span>&nbsp;<span class="ident" id="8116310">i</span>&nbsp;<span class="op" id="8116312">&lt;</span>&nbsp;<span class="builtinfunc" id="8116314">len</span><span class="op" id="8116317">(</span><span class="ident" id="8116318">alpha</span><span class="op" id="8116323">)</span><span class="op" id="8116324">;</span>&nbsp;<span class="ident" id="8116326">i</span><span class="op" id="8116327">++</span>&nbsp;<span class="op" id="8116330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116334">everySequence</span><span class="op" id="8116347">(</span><span class="ident" id="8116348">base</span><span class="op" id="8116352">+</span><span class="ident" id="8116353">alpha</span><span class="op" id="8116358">[</span><span class="ident" id="8116359">i</span><span class="op" id="8116360">:</span><span class="ident" id="8116361">i</span><span class="op" id="8116362">+</span><span class="num" id="8116363">1</span><span class="op" id="8116364">]</span><span class="op" id="8116365">,</span>&nbsp;<span class="ident" id="8116367">alpha</span><span class="op" id="8116372">,</span>&nbsp;<span class="ident" id="8116374">length</span><span class="op" id="8116380">,</span>&nbsp;<span class="ident" id="8116382">fn</span><span class="op" id="8116384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116387">}</span><br>
<span class="lineno"></span><span class="op" id="8116389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8116392">var</span>&nbsp;<span class="ident" id="8116396">useQprint</span>&nbsp;<span class="op" id="8116406">=</span>&nbsp;<span class="ident" id="8116408">flag</span><span class="op" id="8116412">.</span><span class="ident" id="8116413">Bool</span><span class="op" id="8116417">(</span><span class="string" id="8116418">&#34;qprint&#34;</span><span class="op" id="8116426">,</span>&nbsp;<span class="builtintype" id="8116428">false</span><span class="op" id="8116433">,</span>&nbsp;<span class="string" id="8116435">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="8116474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8116477">var</span>&nbsp;<span class="ident" id="8116481">badSoftRx</span>&nbsp;<span class="op" id="8116491">=</span>&nbsp;<span class="ident" id="8116493">regexp</span><span class="op" id="8116499">.</span><span class="ident" id="8116500">MustCompile</span><span class="op" id="8116511">(</span><span class="string" id="8116512">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="8116567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8116570">func</span>&nbsp;<span class="ident" id="8116575">TestQPExhaustive</span><span class="op" id="8116591">(</span><span class="ident" id="8116592">t</span>&nbsp;<span class="op" id="8116594">*</span><span class="ident" id="8116595">testing</span><span class="op" id="8116602">.</span><span class="ident" id="8116603">T</span><span class="op" id="8116604">)</span>&nbsp;<span class="op" id="8116606">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116609">if</span>&nbsp;<span class="op" id="8116612">*</span><span class="ident" id="8116613">useQprint</span>&nbsp;<span class="op" id="8116623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116627">_</span><span class="op" id="8116628">,</span>&nbsp;<span class="ident" id="8116630">err</span>&nbsp;<span class="op" id="8116634">:=</span>&nbsp;<span class="ident" id="8116637">exec</span><span class="op" id="8116641">.</span><span class="ident" id="8116642">LookPath</span><span class="op" id="8116650">(</span><span class="string" id="8116651">&#34;qprint&#34;</span><span class="op" id="8116659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116663">if</span>&nbsp;<span class="ident" id="8116666">err</span>&nbsp;<span class="op" id="8116670">!=</span>&nbsp;<span class="ident" id="8116673">nil</span>&nbsp;<span class="op" id="8116677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116682">t</span><span class="op" id="8116683">.</span><span class="ident" id="8116684">Fatalf</span><span class="op" id="8116690">(</span><span class="string" id="8116691">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="8116721">,</span>&nbsp;<span class="ident" id="8116723">err</span><span class="op" id="8116726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116730">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116737">var</span>&nbsp;<span class="ident" id="8116741">buf</span>&nbsp;<span class="ident" id="8116745">bytes</span><span class="op" id="8116750">.</span><span class="ident" id="8116751">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116759">res</span>&nbsp;<span class="op" id="8116763">:=</span>&nbsp;<span class="builtinfunc" id="8116766">make</span><span class="op" id="8116770">(</span><span class="keyword" id="8116771">map</span><span class="op" id="8116774">[</span><span class="builtintype" id="8116775">string</span><span class="op" id="8116781">]</span><span class="builtintype" id="8116782">int</span><span class="op" id="8116785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116788">everySequence</span><span class="op" id="8116801">(</span><span class="string" id="8116802">&#34;&#34;</span><span class="op" id="8116804">,</span>&nbsp;<span class="string" id="8116806">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="8116816">,</span>&nbsp;<span class="num" id="8116818">6</span><span class="op" id="8116819">,</span>&nbsp;<span class="keyword" id="8116821">func</span><span class="op" id="8116825">(</span><span class="ident" id="8116826">s</span>&nbsp;<span class="builtintype" id="8116828">string</span><span class="op" id="8116834">)</span>&nbsp;<span class="op" id="8116836">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116840">if</span>&nbsp;<span class="ident" id="8116843">strings</span><span class="op" id="8116850">.</span><span class="ident" id="8116851">HasSuffix</span><span class="op" id="8116860">(</span><span class="ident" id="8116861">s</span><span class="op" id="8116862">,</span>&nbsp;<span class="string" id="8116864">&#34;=&#34;</span><span class="op" id="8116867">)</span>&nbsp;<span class="op" id="8116869">||</span>&nbsp;<span class="ident" id="8116872">strings</span><span class="op" id="8116879">.</span><span class="ident" id="8116880">Contains</span><span class="op" id="8116888">(</span><span class="ident" id="8116889">s</span><span class="op" id="8116890">,</span>&nbsp;<span class="string" id="8116892">&#34;==&#34;</span><span class="op" id="8116896">)</span>&nbsp;<span class="op" id="8116898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8116903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8116912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116916">buf</span><span class="op" id="8116919">.</span><span class="ident" id="8116920">Reset</span><span class="op" id="8116925">(</span><span class="op" id="8116926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8116930">_</span><span class="op" id="8116931">,</span>&nbsp;<span class="ident" id="8116933">err</span>&nbsp;<span class="op" id="8116937">:=</span>&nbsp;<span class="ident" id="8116940">io</span><span class="op" id="8116942">.</span><span class="ident" id="8116943">Copy</span><span class="op" id="8116947">(</span><span class="op" id="8116948">&amp;</span><span class="ident" id="8116949">buf</span><span class="op" id="8116952">,</span>&nbsp;<span class="ident" id="8116954">newQuotedPrintableReader</span><span class="op" id="8116978">(</span><span class="ident" id="8116979">strings</span><span class="op" id="8116986">.</span><span class="ident" id="8116987">NewReader</span><span class="op" id="8116996">(</span><span class="ident" id="8116997">s</span><span class="op" id="8116998">)</span><span class="op" id="8116999">)</span><span class="op" id="8117000">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117004">if</span>&nbsp;<span class="ident" id="8117007">err</span>&nbsp;<span class="op" id="8117011">!=</span>&nbsp;<span class="ident" id="8117014">nil</span>&nbsp;<span class="op" id="8117018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117023">errStr</span>&nbsp;<span class="op" id="8117030">:=</span>&nbsp;<span class="ident" id="8117033">err</span><span class="op" id="8117036">.</span><span class="ident" id="8117037">Error</span><span class="op" id="8117042">(</span><span class="op" id="8117043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117048">if</span>&nbsp;<span class="ident" id="8117051">strings</span><span class="op" id="8117058">.</span><span class="ident" id="8117059">Contains</span><span class="op" id="8117067">(</span><span class="ident" id="8117068">errStr</span><span class="op" id="8117074">,</span>&nbsp;<span class="string" id="8117076">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="8117100">)</span>&nbsp;<span class="op" id="8117102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117108">errStr</span>&nbsp;<span class="op" id="8117115">=</span>&nbsp;<span class="string" id="8117117">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117144">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117149">res</span><span class="op" id="8117152">[</span><span class="ident" id="8117153">errStr</span><span class="op" id="8117159">]</span><span class="op" id="8117160">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117166">if</span>&nbsp;<span class="ident" id="8117169">strings</span><span class="op" id="8117176">.</span><span class="ident" id="8117177">Contains</span><span class="op" id="8117185">(</span><span class="ident" id="8117186">errStr</span><span class="op" id="8117192">,</span>&nbsp;<span class="string" id="8117194">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="8117230">)</span>&nbsp;<span class="op" id="8117232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117238">if</span>&nbsp;<span class="ident" id="8117241">strings</span><span class="op" id="8117248">.</span><span class="ident" id="8117249">HasSuffix</span><span class="op" id="8117258">(</span><span class="ident" id="8117259">errStr</span><span class="op" id="8117265">,</span>&nbsp;<span class="string" id="8117267">&#34;0x20&#34;</span><span class="op" id="8117273">)</span>&nbsp;<span class="op" id="8117275">&amp;&amp;</span>&nbsp;<span class="op" id="8117278">(</span><span class="ident" id="8117279">strings</span><span class="op" id="8117286">.</span><span class="ident" id="8117287">Contains</span><span class="op" id="8117295">(</span><span class="ident" id="8117296">s</span><span class="op" id="8117297">,</span>&nbsp;<span class="string" id="8117299">&#34;=0&nbsp;&#34;</span><span class="op" id="8117304">)</span>&nbsp;<span class="op" id="8117306">||</span>&nbsp;<span class="ident" id="8117309">strings</span><span class="op" id="8117316">.</span><span class="ident" id="8117317">Contains</span><span class="op" id="8117325">(</span><span class="ident" id="8117326">s</span><span class="op" id="8117327">,</span>&nbsp;<span class="string" id="8117329">&#34;=A&nbsp;&#34;</span><span class="op" id="8117334">)</span>&nbsp;<span class="op" id="8117336">||</span>&nbsp;<span class="ident" id="8117339">strings</span><span class="op" id="8117346">.</span><span class="ident" id="8117347">Contains</span><span class="op" id="8117355">(</span><span class="ident" id="8117356">s</span><span class="op" id="8117357">,</span>&nbsp;<span class="string" id="8117359">&#34;=&nbsp;&#34;</span><span class="op" id="8117363">)</span><span class="op" id="8117364">)</span>&nbsp;<span class="op" id="8117366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117373">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117384">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117390">if</span>&nbsp;<span class="ident" id="8117393">strings</span><span class="op" id="8117400">.</span><span class="ident" id="8117401">HasSuffix</span><span class="op" id="8117410">(</span><span class="ident" id="8117411">errStr</span><span class="op" id="8117417">,</span>&nbsp;<span class="string" id="8117419">&#34;0x3d&#34;</span><span class="op" id="8117425">)</span>&nbsp;<span class="op" id="8117427">&amp;&amp;</span>&nbsp;<span class="op" id="8117430">(</span><span class="ident" id="8117431">strings</span><span class="op" id="8117438">.</span><span class="ident" id="8117439">Contains</span><span class="op" id="8117447">(</span><span class="ident" id="8117448">s</span><span class="op" id="8117449">,</span>&nbsp;<span class="string" id="8117451">&#34;=0=&#34;</span><span class="op" id="8117456">)</span>&nbsp;<span class="op" id="8117458">||</span>&nbsp;<span class="ident" id="8117461">strings</span><span class="op" id="8117468">.</span><span class="ident" id="8117469">Contains</span><span class="op" id="8117477">(</span><span class="ident" id="8117478">s</span><span class="op" id="8117479">,</span>&nbsp;<span class="string" id="8117481">&#34;=A=&#34;</span><span class="op" id="8117486">)</span><span class="op" id="8117487">)</span>&nbsp;<span class="op" id="8117489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117496">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117513">if</span>&nbsp;<span class="ident" id="8117516">strings</span><span class="op" id="8117523">.</span><span class="ident" id="8117524">HasSuffix</span><span class="op" id="8117533">(</span><span class="ident" id="8117534">errStr</span><span class="op" id="8117540">,</span>&nbsp;<span class="string" id="8117542">&#34;0x0a&#34;</span><span class="op" id="8117548">)</span>&nbsp;<span class="op" id="8117550">||</span>&nbsp;<span class="ident" id="8117553">strings</span><span class="op" id="8117560">.</span><span class="ident" id="8117561">HasSuffix</span><span class="op" id="8117570">(</span><span class="ident" id="8117571">errStr</span><span class="op" id="8117577">,</span>&nbsp;<span class="string" id="8117579">&#34;0x0d&#34;</span><span class="op" id="8117585">)</span>&nbsp;<span class="op" id="8117587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8117594">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117678">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117699">if</span>&nbsp;<span class="ident" id="8117702">strings</span><span class="op" id="8117709">.</span><span class="ident" id="8117710">Contains</span><span class="op" id="8117718">(</span><span class="ident" id="8117719">errStr</span><span class="op" id="8117725">,</span>&nbsp;<span class="string" id="8117727">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="8117743">)</span>&nbsp;<span class="op" id="8117745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117751">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117766">if</span>&nbsp;<span class="ident" id="8117769">errStr</span>&nbsp;<span class="op" id="8117776">==</span>&nbsp;<span class="string" id="8117779">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="8117803">&amp;&amp;</span>&nbsp;<span class="ident" id="8117806">badSoftRx</span><span class="op" id="8117815">.</span><span class="ident" id="8117816">MatchString</span><span class="op" id="8117827">(</span><span class="ident" id="8117828">s</span><span class="op" id="8117829">)</span>&nbsp;<span class="op" id="8117831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117852">t</span><span class="op" id="8117853">.</span><span class="ident" id="8117854">Errorf</span><span class="op" id="8117860">(</span><span class="string" id="8117861">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8117878">,</span>&nbsp;<span class="ident" id="8117880">s</span><span class="op" id="8117881">,</span>&nbsp;<span class="ident" id="8117883">err</span><span class="op" id="8117886">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117891">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8117900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8117904">if</span>&nbsp;<span class="op" id="8117907">*</span><span class="ident" id="8117908">useQprint</span>&nbsp;<span class="op" id="8117918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117923">cmd</span>&nbsp;<span class="op" id="8117927">:=</span>&nbsp;<span class="ident" id="8117930">exec</span><span class="op" id="8117934">.</span><span class="ident" id="8117935">Command</span><span class="op" id="8117942">(</span><span class="string" id="8117943">&#34;qprint&#34;</span><span class="op" id="8117951">,</span>&nbsp;<span class="string" id="8117953">&#34;-d&#34;</span><span class="op" id="8117957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117962">cmd</span><span class="op" id="8117965">.</span><span class="ident" id="8117966">Stdin</span>&nbsp;<span class="op" id="8117972">=</span>&nbsp;<span class="ident" id="8117974">strings</span><span class="op" id="8117981">.</span><span class="ident" id="8117982">NewReader</span><span class="op" id="8117991">(</span><span class="ident" id="8117992">s</span><span class="op" id="8117993">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8117998">stderr</span><span class="op" id="8118004">,</span>&nbsp;<span class="ident" id="8118006">err</span>&nbsp;<span class="op" id="8118010">:=</span>&nbsp;<span class="ident" id="8118013">cmd</span><span class="op" id="8118016">.</span><span class="ident" id="8118017">StderrPipe</span><span class="op" id="8118027">(</span><span class="op" id="8118028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118033">if</span>&nbsp;<span class="ident" id="8118036">err</span>&nbsp;<span class="op" id="8118040">!=</span>&nbsp;<span class="ident" id="8118043">nil</span>&nbsp;<span class="op" id="8118047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8118053">panic</span><span class="op" id="8118058">(</span><span class="ident" id="8118059">err</span><span class="op" id="8118062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118072">qpres</span>&nbsp;<span class="op" id="8118078">:=</span>&nbsp;<span class="builtinfunc" id="8118081">make</span><span class="op" id="8118085">(</span><span class="keyword" id="8118086">chan</span>&nbsp;<span class="keyword" id="8118091">interface</span><span class="op" id="8118100">{</span><span class="op" id="8118101">}</span><span class="op" id="8118102">,</span>&nbsp;<span class="num" id="8118104">2</span><span class="op" id="8118105">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118110">go</span>&nbsp;<span class="keyword" id="8118113">func</span><span class="op" id="8118117">(</span><span class="op" id="8118118">)</span>&nbsp;<span class="op" id="8118120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118126">br</span>&nbsp;<span class="op" id="8118129">:=</span>&nbsp;<span class="ident" id="8118132">bufio</span><span class="op" id="8118137">.</span><span class="ident" id="8118138">NewReader</span><span class="op" id="8118147">(</span><span class="ident" id="8118148">stderr</span><span class="op" id="8118154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118160">s</span><span class="op" id="8118161">,</span>&nbsp;<span class="ident" id="8118163">_</span>&nbsp;<span class="op" id="8118165">:=</span>&nbsp;<span class="ident" id="8118168">br</span><span class="op" id="8118170">.</span><span class="ident" id="8118171">ReadString</span><span class="op" id="8118181">(</span><span class="string" id="8118182">&#39;\n&#39;</span><span class="op" id="8118186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118192">if</span>&nbsp;<span class="ident" id="8118195">s</span>&nbsp;<span class="op" id="8118197">!=</span>&nbsp;<span class="string" id="8118200">&#34;&#34;</span>&nbsp;<span class="op" id="8118203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118210">qpres</span>&nbsp;<span class="op" id="8118216">&lt;-</span>&nbsp;<span class="ident" id="8118219">errors</span><span class="op" id="8118225">.</span><span class="ident" id="8118226">New</span><span class="op" id="8118229">(</span><span class="ident" id="8118230">s</span><span class="op" id="8118231">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118238">if</span>&nbsp;<span class="ident" id="8118241">cmd</span><span class="op" id="8118244">.</span><span class="ident" id="8118245">Process</span>&nbsp;<span class="op" id="8118253">!=</span>&nbsp;<span class="ident" id="8118256">nil</span>&nbsp;<span class="op" id="8118260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8118268">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8118318">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118356">cmd</span><span class="op" id="8118359">.</span><span class="ident" id="8118360">Process</span><span class="op" id="8118367">.</span><span class="ident" id="8118368">Kill</span><span class="op" id="8118372">(</span><span class="op" id="8118373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118380">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118391">}</span><span class="op" id="8118392">(</span><span class="op" id="8118393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118398">go</span>&nbsp;<span class="keyword" id="8118401">func</span><span class="op" id="8118405">(</span><span class="op" id="8118406">)</span>&nbsp;<span class="op" id="8118408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118414">want</span><span class="op" id="8118418">,</span>&nbsp;<span class="ident" id="8118420">err</span>&nbsp;<span class="op" id="8118424">:=</span>&nbsp;<span class="ident" id="8118427">cmd</span><span class="op" id="8118430">.</span><span class="ident" id="8118431">Output</span><span class="op" id="8118437">(</span><span class="op" id="8118438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118444">if</span>&nbsp;<span class="ident" id="8118447">err</span>&nbsp;<span class="op" id="8118451">==</span>&nbsp;<span class="ident" id="8118454">nil</span>&nbsp;<span class="op" id="8118458">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118465">qpres</span>&nbsp;<span class="op" id="8118471">&lt;-</span>&nbsp;<span class="ident" id="8118474">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118488">}</span><span class="op" id="8118489">(</span><span class="op" id="8118490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118495">select</span>&nbsp;<span class="op" id="8118502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118507">case</span>&nbsp;<span class="ident" id="8118512">got</span>&nbsp;<span class="op" id="8118516">:=</span>&nbsp;<span class="op" id="8118519">&lt;-</span><span class="ident" id="8118521">qpres</span><span class="op" id="8118526">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118532">if</span>&nbsp;<span class="ident" id="8118535">want</span><span class="op" id="8118539">,</span>&nbsp;<span class="ident" id="8118541">ok</span>&nbsp;<span class="op" id="8118544">:=</span>&nbsp;<span class="ident" id="8118547">got</span><span class="op" id="8118550">.</span><span class="op" id="8118551">(</span><span class="op" id="8118552">[</span><span class="op" id="8118553">]</span><span class="builtintype" id="8118554">byte</span><span class="op" id="8118558">)</span><span class="op" id="8118559">;</span>&nbsp;<span class="ident" id="8118561">ok</span>&nbsp;<span class="op" id="8118564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118571">if</span>&nbsp;<span class="builtintype" id="8118574">string</span><span class="op" id="8118580">(</span><span class="ident" id="8118581">want</span><span class="op" id="8118585">)</span>&nbsp;<span class="op" id="8118587">!=</span>&nbsp;<span class="ident" id="8118590">buf</span><span class="op" id="8118593">.</span><span class="ident" id="8118594">String</span><span class="op" id="8118600">(</span><span class="op" id="8118601">)</span>&nbsp;<span class="op" id="8118603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118611">t</span><span class="op" id="8118612">.</span><span class="ident" id="8118613">Errorf</span><span class="op" id="8118619">(</span><span class="string" id="8118620">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="8118653">,</span>&nbsp;<span class="ident" id="8118655">s</span><span class="op" id="8118656">,</span>&nbsp;<span class="ident" id="8118658">want</span><span class="op" id="8118662">,</span>&nbsp;<span class="ident" id="8118664">buf</span><span class="op" id="8118667">.</span><span class="ident" id="8118668">String</span><span class="op" id="8118674">(</span><span class="op" id="8118675">)</span><span class="op" id="8118676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118689">}</span>&nbsp;<span class="keyword" id="8118691">else</span>&nbsp;<span class="op" id="8118696">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118703">t</span><span class="op" id="8118704">.</span><span class="ident" id="8118705">Logf</span><span class="op" id="8118709">(</span><span class="string" id="8118710">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8118730">,</span>&nbsp;<span class="ident" id="8118732">s</span><span class="op" id="8118733">,</span>&nbsp;<span class="ident" id="8118735">got</span><span class="op" id="8118738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118749">case</span>&nbsp;<span class="op" id="8118754">&lt;-</span><span class="ident" id="8118756">time</span><span class="op" id="8118760">.</span><span class="ident" id="8118761">After</span><span class="op" id="8118766">(</span><span class="num" id="8118767">5</span>&nbsp;<span class="op" id="8118769">*</span>&nbsp;<span class="ident" id="8118771">time</span><span class="op" id="8118775">.</span><span class="ident" id="8118776">Second</span><span class="op" id="8118782">)</span><span class="op" id="8118783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118789">t</span><span class="op" id="8118790">.</span><span class="ident" id="8118791">Logf</span><span class="op" id="8118795">(</span><span class="string" id="8118796">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8118818">,</span>&nbsp;<span class="ident" id="8118820">s</span><span class="op" id="8118821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118826">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118834">res</span><span class="op" id="8118837">[</span><span class="string" id="8118838">&#34;OK&#34;</span><span class="op" id="8118842">]</span><span class="op" id="8118843">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118847">}</span><span class="op" id="8118848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118851">var</span>&nbsp;<span class="ident" id="8118855">outcomes</span>&nbsp;<span class="op" id="8118864">[</span><span class="op" id="8118865">]</span><span class="builtintype" id="8118866">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118874">for</span>&nbsp;<span class="ident" id="8118878">k</span><span class="op" id="8118879">,</span>&nbsp;<span class="ident" id="8118881">v</span>&nbsp;<span class="op" id="8118883">:=</span>&nbsp;<span class="keyword" id="8118886">range</span>&nbsp;<span class="ident" id="8118892">res</span>&nbsp;<span class="op" id="8118896">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118900">outcomes</span>&nbsp;<span class="op" id="8118909">=</span>&nbsp;<span class="builtinfunc" id="8118911">append</span><span class="op" id="8118917">(</span><span class="ident" id="8118918">outcomes</span><span class="op" id="8118926">,</span>&nbsp;<span class="ident" id="8118928">fmt</span><span class="op" id="8118931">.</span><span class="ident" id="8118932">Sprintf</span><span class="op" id="8118939">(</span><span class="string" id="8118940">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="8118948">,</span>&nbsp;<span class="ident" id="8118950">k</span><span class="op" id="8118951">,</span>&nbsp;<span class="ident" id="8118953">v</span><span class="op" id="8118954">)</span><span class="op" id="8118955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118961">sort</span><span class="op" id="8118965">.</span><span class="ident" id="8118966">Strings</span><span class="op" id="8118973">(</span><span class="ident" id="8118974">outcomes</span><span class="op" id="8118982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118985">got</span>&nbsp;<span class="op" id="8118989">:=</span>&nbsp;<span class="ident" id="8118992">strings</span><span class="op" id="8118999">.</span><span class="ident" id="8119000">Join</span><span class="op" id="8119004">(</span><span class="ident" id="8119005">outcomes</span><span class="op" id="8119013">,</span>&nbsp;<span class="string" id="8119015">&#34;\n&#34;</span><span class="op" id="8119019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119022">want</span>&nbsp;<span class="op" id="8119027">:=</span>&nbsp;<span class="string" id="8119030">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119315">if</span>&nbsp;<span class="ident" id="8119318">got</span>&nbsp;<span class="op" id="8119322">!=</span>&nbsp;<span class="ident" id="8119325">want</span>&nbsp;<span class="op" id="8119330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119334">t</span><span class="op" id="8119335">.</span><span class="ident" id="8119336">Errorf</span><span class="op" id="8119342">(</span><span class="string" id="8119343">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="8119364">,</span>&nbsp;<span class="ident" id="8119366">got</span><span class="op" id="8119369">,</span>&nbsp;<span class="ident" id="8119371">want</span><span class="op" id="8119375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119378">}</span><br>
<span class="lineno"></span><span class="op" id="8119380">}</span>
</div>
</body>
</html>
