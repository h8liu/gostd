<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html" class="current">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2247031">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2247086">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2247140">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2247191">//&nbsp;Multiprecision&nbsp;decimal&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="2247226">//&nbsp;For&nbsp;floating-point&nbsp;formatting&nbsp;only;&nbsp;not&nbsp;general&nbsp;purpose.</span><br>
<span class="lineno"></span><span class="comment" id="2247286">//&nbsp;Only&nbsp;operations&nbsp;are&nbsp;assign&nbsp;and&nbsp;(binary)&nbsp;left/right&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="2247347">//&nbsp;Can&nbsp;do&nbsp;binary&nbsp;floating&nbsp;point&nbsp;in&nbsp;multiprecision&nbsp;decimal&nbsp;precisely</span><br>
<span class="lineno"></span><span class="comment" id="2247415">//&nbsp;because&nbsp;2&nbsp;divides&nbsp;10;&nbsp;cannot&nbsp;do&nbsp;decimal&nbsp;floating&nbsp;point</span><br>
<span class="lineno">10</span><span class="comment" id="2247473">//&nbsp;in&nbsp;multiprecision&nbsp;binary&nbsp;precisely.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2247513">package</span>&nbsp;<span class="ident" id="2247521">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2247530">type</span>&nbsp;<span class="ident" id="2247535">decimal</span>&nbsp;<span class="keyword" id="2247543">struct</span>&nbsp;<span class="op" id="2247550">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247553">d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2247559">[</span><span class="num" id="2247560">800</span><span class="op" id="2247563">]</span><span class="builtintype" id="2247564">byte</span>&nbsp;<span class="comment" id="2247569">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247580">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2247586">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2247596">//&nbsp;number&nbsp;of&nbsp;digits&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247622">dp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2247628">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2247638">//&nbsp;decimal&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247656">neg</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2247662">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247668">trunc</span>&nbsp;<span class="builtintype" id="2247674">bool</span>&nbsp;<span class="comment" id="2247679">//&nbsp;discarded&nbsp;nonzero&nbsp;digits&nbsp;beyond&nbsp;d[:nd]</span><br>
<span class="lineno">20</span><span class="op" id="2247721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2247724">func</span>&nbsp;<span class="op" id="2247729">(</span><span class="ident" id="2247730">a</span>&nbsp;<span class="op" id="2247732">*</span><span class="ident" id="2247733">decimal</span><span class="op" id="2247740">)</span>&nbsp;<span class="ident" id="2247742">String</span><span class="op" id="2247748">(</span><span class="op" id="2247749">)</span>&nbsp;<span class="builtintype" id="2247751">string</span>&nbsp;<span class="op" id="2247758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247761">n</span>&nbsp;<span class="op" id="2247763">:=</span>&nbsp;<span class="num" id="2247766">10</span>&nbsp;<span class="op" id="2247769">+</span>&nbsp;<span class="ident" id="2247771">a</span><span class="op" id="2247772">.</span><span class="ident" id="2247773">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247777">if</span>&nbsp;<span class="ident" id="2247780">a</span><span class="op" id="2247781">.</span><span class="ident" id="2247782">dp</span>&nbsp;<span class="op" id="2247785">&gt;</span>&nbsp;<span class="num" id="2247787">0</span>&nbsp;<span class="op" id="2247789">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247793">n</span>&nbsp;<span class="op" id="2247795">+=</span>&nbsp;<span class="ident" id="2247798">a</span><span class="op" id="2247799">.</span><span class="ident" id="2247800">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247807">if</span>&nbsp;<span class="ident" id="2247810">a</span><span class="op" id="2247811">.</span><span class="ident" id="2247812">dp</span>&nbsp;<span class="op" id="2247815">&lt;</span>&nbsp;<span class="num" id="2247817">0</span>&nbsp;<span class="op" id="2247819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247823">n</span>&nbsp;<span class="op" id="2247825">+=</span>&nbsp;<span class="op" id="2247828">-</span><span class="ident" id="2247829">a</span><span class="op" id="2247830">.</span><span class="ident" id="2247831">dp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247835">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247839">buf</span>&nbsp;<span class="op" id="2247843">:=</span>&nbsp;<span class="builtinfunc" id="2247846">make</span><span class="op" id="2247850">(</span><span class="op" id="2247851">[</span><span class="op" id="2247852">]</span><span class="builtintype" id="2247853">byte</span><span class="op" id="2247857">,</span>&nbsp;<span class="ident" id="2247859">n</span><span class="op" id="2247860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247863">w</span>&nbsp;<span class="op" id="2247865">:=</span>&nbsp;<span class="num" id="2247868">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247871">switch</span>&nbsp;<span class="op" id="2247878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247881">case</span>&nbsp;<span class="ident" id="2247886">a</span><span class="op" id="2247887">.</span><span class="ident" id="2247888">nd</span>&nbsp;<span class="op" id="2247891">==</span>&nbsp;<span class="num" id="2247894">0</span><span class="op" id="2247895">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247899">return</span>&nbsp;<span class="string" id="2247906">&#34;0&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247912">case</span>&nbsp;<span class="ident" id="2247917">a</span><span class="op" id="2247918">.</span><span class="ident" id="2247919">dp</span>&nbsp;<span class="op" id="2247922">&lt;=</span>&nbsp;<span class="num" id="2247925">0</span><span class="op" id="2247926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2247930">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;decimal&nbsp;point&nbsp;and&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247985">buf</span><span class="op" id="2247988">[</span><span class="ident" id="2247989">w</span><span class="op" id="2247990">]</span>&nbsp;<span class="op" id="2247992">=</span>&nbsp;<span class="string" id="2247994">&#39;0&#39;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248000">w</span><span class="op" id="2248001">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248006">buf</span><span class="op" id="2248009">[</span><span class="ident" id="2248010">w</span><span class="op" id="2248011">]</span>&nbsp;<span class="op" id="2248013">=</span>&nbsp;<span class="string" id="2248015">&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248021">w</span><span class="op" id="2248022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248027">w</span>&nbsp;<span class="op" id="2248029">+=</span>&nbsp;<span class="ident" id="2248032">digitZero</span><span class="op" id="2248041">(</span><span class="ident" id="2248042">buf</span><span class="op" id="2248045">[</span><span class="ident" id="2248046">w</span>&nbsp;<span class="op" id="2248048">:</span>&nbsp;<span class="ident" id="2248050">w</span><span class="op" id="2248051">+</span><span class="op" id="2248052">-</span><span class="ident" id="2248053">a</span><span class="op" id="2248054">.</span><span class="ident" id="2248055">dp</span><span class="op" id="2248057">]</span><span class="op" id="2248058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248062">w</span>&nbsp;<span class="op" id="2248064">+=</span>&nbsp;<span class="builtinfunc" id="2248067">copy</span><span class="op" id="2248071">(</span><span class="ident" id="2248072">buf</span><span class="op" id="2248075">[</span><span class="ident" id="2248076">w</span><span class="op" id="2248077">:</span><span class="op" id="2248078">]</span><span class="op" id="2248079">,</span>&nbsp;<span class="ident" id="2248081">a</span><span class="op" id="2248082">.</span><span class="ident" id="2248083">d</span><span class="op" id="2248084">[</span><span class="num" id="2248085">0</span><span class="op" id="2248086">:</span><span class="ident" id="2248087">a</span><span class="op" id="2248088">.</span><span class="ident" id="2248089">nd</span><span class="op" id="2248091">]</span><span class="op" id="2248092">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248096">case</span>&nbsp;<span class="ident" id="2248101">a</span><span class="op" id="2248102">.</span><span class="ident" id="2248103">dp</span>&nbsp;<span class="op" id="2248106">&lt;</span>&nbsp;<span class="ident" id="2248108">a</span><span class="op" id="2248109">.</span><span class="ident" id="2248110">nd</span><span class="op" id="2248112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2248116">//&nbsp;decimal&nbsp;point&nbsp;in&nbsp;middle&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248155">w</span>&nbsp;<span class="op" id="2248157">+=</span>&nbsp;<span class="builtinfunc" id="2248160">copy</span><span class="op" id="2248164">(</span><span class="ident" id="2248165">buf</span><span class="op" id="2248168">[</span><span class="ident" id="2248169">w</span><span class="op" id="2248170">:</span><span class="op" id="2248171">]</span><span class="op" id="2248172">,</span>&nbsp;<span class="ident" id="2248174">a</span><span class="op" id="2248175">.</span><span class="ident" id="2248176">d</span><span class="op" id="2248177">[</span><span class="num" id="2248178">0</span><span class="op" id="2248179">:</span><span class="ident" id="2248180">a</span><span class="op" id="2248181">.</span><span class="ident" id="2248182">dp</span><span class="op" id="2248184">]</span><span class="op" id="2248185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248189">buf</span><span class="op" id="2248192">[</span><span class="ident" id="2248193">w</span><span class="op" id="2248194">]</span>&nbsp;<span class="op" id="2248196">=</span>&nbsp;<span class="string" id="2248198">&#39;.&#39;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248204">w</span><span class="op" id="2248205">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248210">w</span>&nbsp;<span class="op" id="2248212">+=</span>&nbsp;<span class="builtinfunc" id="2248215">copy</span><span class="op" id="2248219">(</span><span class="ident" id="2248220">buf</span><span class="op" id="2248223">[</span><span class="ident" id="2248224">w</span><span class="op" id="2248225">:</span><span class="op" id="2248226">]</span><span class="op" id="2248227">,</span>&nbsp;<span class="ident" id="2248229">a</span><span class="op" id="2248230">.</span><span class="ident" id="2248231">d</span><span class="op" id="2248232">[</span><span class="ident" id="2248233">a</span><span class="op" id="2248234">.</span><span class="ident" id="2248235">dp</span><span class="op" id="2248237">:</span><span class="ident" id="2248238">a</span><span class="op" id="2248239">.</span><span class="ident" id="2248240">nd</span><span class="op" id="2248242">]</span><span class="op" id="2248243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248247">default</span><span class="op" id="2248254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2248258">//&nbsp;zeros&nbsp;fill&nbsp;space&nbsp;between&nbsp;digits&nbsp;and&nbsp;decimal&nbsp;point</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248313">w</span>&nbsp;<span class="op" id="2248315">+=</span>&nbsp;<span class="builtinfunc" id="2248318">copy</span><span class="op" id="2248322">(</span><span class="ident" id="2248323">buf</span><span class="op" id="2248326">[</span><span class="ident" id="2248327">w</span><span class="op" id="2248328">:</span><span class="op" id="2248329">]</span><span class="op" id="2248330">,</span>&nbsp;<span class="ident" id="2248332">a</span><span class="op" id="2248333">.</span><span class="ident" id="2248334">d</span><span class="op" id="2248335">[</span><span class="num" id="2248336">0</span><span class="op" id="2248337">:</span><span class="ident" id="2248338">a</span><span class="op" id="2248339">.</span><span class="ident" id="2248340">nd</span><span class="op" id="2248342">]</span><span class="op" id="2248343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248347">w</span>&nbsp;<span class="op" id="2248349">+=</span>&nbsp;<span class="ident" id="2248352">digitZero</span><span class="op" id="2248361">(</span><span class="ident" id="2248362">buf</span><span class="op" id="2248365">[</span><span class="ident" id="2248366">w</span>&nbsp;<span class="op" id="2248368">:</span>&nbsp;<span class="ident" id="2248370">w</span><span class="op" id="2248371">+</span><span class="ident" id="2248372">a</span><span class="op" id="2248373">.</span><span class="ident" id="2248374">dp</span><span class="op" id="2248376">-</span><span class="ident" id="2248377">a</span><span class="op" id="2248378">.</span><span class="ident" id="2248379">nd</span><span class="op" id="2248381">]</span><span class="op" id="2248382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248388">return</span>&nbsp;<span class="builtintype" id="2248395">string</span><span class="op" id="2248401">(</span><span class="ident" id="2248402">buf</span><span class="op" id="2248405">[</span><span class="num" id="2248406">0</span><span class="op" id="2248407">:</span><span class="ident" id="2248408">w</span><span class="op" id="2248409">]</span><span class="op" id="2248410">)</span><br>
<span class="lineno"></span><span class="op" id="2248412">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2248415">func</span>&nbsp;<span class="ident" id="2248420">digitZero</span><span class="op" id="2248429">(</span><span class="ident" id="2248430">dst</span>&nbsp;<span class="op" id="2248434">[</span><span class="op" id="2248435">]</span><span class="builtintype" id="2248436">byte</span><span class="op" id="2248440">)</span>&nbsp;<span class="builtintype" id="2248442">int</span>&nbsp;<span class="op" id="2248446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248449">for</span>&nbsp;<span class="ident" id="2248453">i</span>&nbsp;<span class="op" id="2248455">:=</span>&nbsp;<span class="keyword" id="2248458">range</span>&nbsp;<span class="ident" id="2248464">dst</span>&nbsp;<span class="op" id="2248468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248472">dst</span><span class="op" id="2248475">[</span><span class="ident" id="2248476">i</span><span class="op" id="2248477">]</span>&nbsp;<span class="op" id="2248479">=</span>&nbsp;<span class="string" id="2248481">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248486">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248489">return</span>&nbsp;<span class="builtinfunc" id="2248496">len</span><span class="op" id="2248499">(</span><span class="ident" id="2248500">dst</span><span class="op" id="2248503">)</span><br>
<span class="lineno"></span><span class="op" id="2248505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248508">//&nbsp;trim&nbsp;trailing&nbsp;zeros&nbsp;from&nbsp;number.</span><br>
<span class="lineno"></span><span class="comment" id="2248544">//&nbsp;(They&nbsp;are&nbsp;meaningless;&nbsp;the&nbsp;decimal&nbsp;point&nbsp;is&nbsp;tracked</span><br>
<span class="lineno">70</span><span class="comment" id="2248599">//&nbsp;independent&nbsp;of&nbsp;the&nbsp;number&nbsp;of&nbsp;digits.)</span><br>
<span class="lineno"></span><span class="keyword" id="2248640">func</span>&nbsp;<span class="ident" id="2248645">trim</span><span class="op" id="2248649">(</span><span class="ident" id="2248650">a</span>&nbsp;<span class="op" id="2248652">*</span><span class="ident" id="2248653">decimal</span><span class="op" id="2248660">)</span>&nbsp;<span class="op" id="2248662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248665">for</span>&nbsp;<span class="ident" id="2248669">a</span><span class="op" id="2248670">.</span><span class="ident" id="2248671">nd</span>&nbsp;<span class="op" id="2248674">&gt;</span>&nbsp;<span class="num" id="2248676">0</span>&nbsp;<span class="op" id="2248678">&amp;&amp;</span>&nbsp;<span class="ident" id="2248681">a</span><span class="op" id="2248682">.</span><span class="ident" id="2248683">d</span><span class="op" id="2248684">[</span><span class="ident" id="2248685">a</span><span class="op" id="2248686">.</span><span class="ident" id="2248687">nd</span><span class="op" id="2248689">-</span><span class="num" id="2248690">1</span><span class="op" id="2248691">]</span>&nbsp;<span class="op" id="2248693">==</span>&nbsp;<span class="string" id="2248696">&#39;0&#39;</span>&nbsp;<span class="op" id="2248700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248704">a</span><span class="op" id="2248705">.</span><span class="ident" id="2248706">nd</span><span class="op" id="2248708">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248712">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248715">if</span>&nbsp;<span class="ident" id="2248718">a</span><span class="op" id="2248719">.</span><span class="ident" id="2248720">nd</span>&nbsp;<span class="op" id="2248723">==</span>&nbsp;<span class="num" id="2248726">0</span>&nbsp;<span class="op" id="2248728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248732">a</span><span class="op" id="2248733">.</span><span class="ident" id="2248734">dp</span>&nbsp;<span class="op" id="2248737">=</span>&nbsp;<span class="num" id="2248739">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248742">}</span><br>
<span class="lineno"></span><span class="op" id="2248744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2248747">//&nbsp;Assign&nbsp;v&nbsp;to&nbsp;a.</span><br>
<span class="lineno"></span><span class="keyword" id="2248765">func</span>&nbsp;<span class="op" id="2248770">(</span><span class="ident" id="2248771">a</span>&nbsp;<span class="op" id="2248773">*</span><span class="ident" id="2248774">decimal</span><span class="op" id="2248781">)</span>&nbsp;<span class="ident" id="2248783">Assign</span><span class="op" id="2248789">(</span><span class="ident" id="2248790">v</span>&nbsp;<span class="ident" id="2248792">uint64</span><span class="op" id="2248798">)</span>&nbsp;<span class="op" id="2248800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248803">var</span>&nbsp;<span class="ident" id="2248807">buf</span>&nbsp;<span class="op" id="2248811">[</span><span class="num" id="2248812">24</span><span class="op" id="2248814">]</span><span class="builtintype" id="2248815">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2248822">//&nbsp;Write&nbsp;reversed&nbsp;decimal&nbsp;in&nbsp;buf.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248857">n</span>&nbsp;<span class="op" id="2248859">:=</span>&nbsp;<span class="num" id="2248862">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2248865">for</span>&nbsp;<span class="ident" id="2248869">v</span>&nbsp;<span class="op" id="2248871">&gt;</span>&nbsp;<span class="num" id="2248873">0</span>&nbsp;<span class="op" id="2248875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248879">v1</span>&nbsp;<span class="op" id="2248882">:=</span>&nbsp;<span class="ident" id="2248885">v</span>&nbsp;<span class="op" id="2248887">/</span>&nbsp;<span class="num" id="2248889">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248894">v</span>&nbsp;<span class="op" id="2248896">-=</span>&nbsp;<span class="num" id="2248899">10</span>&nbsp;<span class="op" id="2248902">*</span>&nbsp;<span class="ident" id="2248904">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248909">buf</span><span class="op" id="2248912">[</span><span class="ident" id="2248913">n</span><span class="op" id="2248914">]</span>&nbsp;<span class="op" id="2248916">=</span>&nbsp;<span class="builtintype" id="2248918">byte</span><span class="op" id="2248922">(</span><span class="ident" id="2248923">v</span>&nbsp;<span class="op" id="2248925">+</span>&nbsp;<span class="string" id="2248927">&#39;0&#39;</span><span class="op" id="2248930">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248934">n</span><span class="op" id="2248935">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248940">v</span>&nbsp;<span class="op" id="2248942">=</span>&nbsp;<span class="ident" id="2248944">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2248952">//&nbsp;Reverse&nbsp;again&nbsp;to&nbsp;produce&nbsp;forward&nbsp;decimal&nbsp;in&nbsp;a.d.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249005">a</span><span class="op" id="2249006">.</span><span class="ident" id="2249007">nd</span>&nbsp;<span class="op" id="2249010">=</span>&nbsp;<span class="num" id="2249012">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249015">for</span>&nbsp;<span class="ident" id="2249019">n</span><span class="op" id="2249020">--</span><span class="op" id="2249022">;</span>&nbsp;<span class="ident" id="2249024">n</span>&nbsp;<span class="op" id="2249026">&gt;=</span>&nbsp;<span class="num" id="2249029">0</span><span class="op" id="2249030">;</span>&nbsp;<span class="ident" id="2249032">n</span><span class="op" id="2249033">--</span>&nbsp;<span class="op" id="2249036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249040">a</span><span class="op" id="2249041">.</span><span class="ident" id="2249042">d</span><span class="op" id="2249043">[</span><span class="ident" id="2249044">a</span><span class="op" id="2249045">.</span><span class="ident" id="2249046">nd</span><span class="op" id="2249048">]</span>&nbsp;<span class="op" id="2249050">=</span>&nbsp;<span class="ident" id="2249052">buf</span><span class="op" id="2249055">[</span><span class="ident" id="2249056">n</span><span class="op" id="2249057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249061">a</span><span class="op" id="2249062">.</span><span class="ident" id="2249063">nd</span><span class="op" id="2249065">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249069">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249072">a</span><span class="op" id="2249073">.</span><span class="ident" id="2249074">dp</span>&nbsp;<span class="op" id="2249077">=</span>&nbsp;<span class="ident" id="2249079">a</span><span class="op" id="2249080">.</span><span class="ident" id="2249081">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249085">trim</span><span class="op" id="2249089">(</span><span class="ident" id="2249090">a</span><span class="op" id="2249091">)</span><br>
<span class="lineno"></span><span class="op" id="2249093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2249096">//&nbsp;Maximum&nbsp;shift&nbsp;that&nbsp;we&nbsp;can&nbsp;do&nbsp;in&nbsp;one&nbsp;pass&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno">105</span><span class="comment" id="2249158">//&nbsp;Signed&nbsp;int&nbsp;has&nbsp;31&nbsp;bits,&nbsp;and&nbsp;we&nbsp;have&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;accommodate&nbsp;9&lt;&lt;k.</span><br>
<span class="lineno"></span><span class="keyword" id="2249229">const</span>&nbsp;<span class="ident" id="2249235">maxShift</span>&nbsp;<span class="op" id="2249244">=</span>&nbsp;<span class="num" id="2249246">27</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2249250">//&nbsp;Binary&nbsp;shift&nbsp;right&nbsp;(*&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2249323">func</span>&nbsp;<span class="ident" id="2249328">rightShift</span><span class="op" id="2249338">(</span><span class="ident" id="2249339">a</span>&nbsp;<span class="op" id="2249341">*</span><span class="ident" id="2249342">decimal</span><span class="op" id="2249349">,</span>&nbsp;<span class="ident" id="2249351">k</span>&nbsp;<span class="builtintype" id="2249353">uint</span><span class="op" id="2249357">)</span>&nbsp;<span class="op" id="2249359">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249362">r</span>&nbsp;<span class="op" id="2249364">:=</span>&nbsp;<span class="num" id="2249367">0</span>&nbsp;<span class="comment" id="2249369">//&nbsp;read&nbsp;pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249386">w</span>&nbsp;<span class="op" id="2249388">:=</span>&nbsp;<span class="num" id="2249391">0</span>&nbsp;<span class="comment" id="2249393">//&nbsp;write&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2249412">//&nbsp;Pick&nbsp;up&nbsp;enough&nbsp;leading&nbsp;digits&nbsp;to&nbsp;cover&nbsp;first&nbsp;shift.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249468">n</span>&nbsp;<span class="op" id="2249470">:=</span>&nbsp;<span class="num" id="2249473">0</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249476">for</span>&nbsp;<span class="op" id="2249480">;</span>&nbsp;<span class="ident" id="2249482">n</span><span class="op" id="2249483">&gt;&gt;</span><span class="ident" id="2249485">k</span>&nbsp;<span class="op" id="2249487">==</span>&nbsp;<span class="num" id="2249490">0</span><span class="op" id="2249491">;</span>&nbsp;<span class="ident" id="2249493">r</span><span class="op" id="2249494">++</span>&nbsp;<span class="op" id="2249497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249501">if</span>&nbsp;<span class="ident" id="2249504">r</span>&nbsp;<span class="op" id="2249506">&gt;=</span>&nbsp;<span class="ident" id="2249509">a</span><span class="op" id="2249510">.</span><span class="ident" id="2249511">nd</span>&nbsp;<span class="op" id="2249514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249519">if</span>&nbsp;<span class="ident" id="2249522">n</span>&nbsp;<span class="op" id="2249524">==</span>&nbsp;<span class="num" id="2249527">0</span>&nbsp;<span class="op" id="2249529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2249535">//&nbsp;a&nbsp;==&nbsp;0;&nbsp;shouldn&#39;t&nbsp;get&nbsp;here,&nbsp;but&nbsp;handle&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249589">a</span><span class="op" id="2249590">.</span><span class="ident" id="2249591">nd</span>&nbsp;<span class="op" id="2249594">=</span>&nbsp;<span class="num" id="2249596">0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249602">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249617">for</span>&nbsp;<span class="ident" id="2249621">n</span><span class="op" id="2249622">&gt;&gt;</span><span class="ident" id="2249624">k</span>&nbsp;<span class="op" id="2249626">==</span>&nbsp;<span class="num" id="2249629">0</span>&nbsp;<span class="op" id="2249631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249637">n</span>&nbsp;<span class="op" id="2249639">=</span>&nbsp;<span class="ident" id="2249641">n</span>&nbsp;<span class="op" id="2249643">*</span>&nbsp;<span class="num" id="2249645">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249652">r</span><span class="op" id="2249653">++</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249664">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249676">c</span>&nbsp;<span class="op" id="2249678">:=</span>&nbsp;<span class="builtintype" id="2249681">int</span><span class="op" id="2249684">(</span><span class="ident" id="2249685">a</span><span class="op" id="2249686">.</span><span class="ident" id="2249687">d</span><span class="op" id="2249688">[</span><span class="ident" id="2249689">r</span><span class="op" id="2249690">]</span><span class="op" id="2249691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249695">n</span>&nbsp;<span class="op" id="2249697">=</span>&nbsp;<span class="ident" id="2249699">n</span><span class="op" id="2249700">*</span><span class="num" id="2249701">10</span>&nbsp;<span class="op" id="2249704">+</span>&nbsp;<span class="ident" id="2249706">c</span>&nbsp;<span class="op" id="2249708">-</span>&nbsp;<span class="string" id="2249710">&#39;0&#39;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249718">a</span><span class="op" id="2249719">.</span><span class="ident" id="2249720">dp</span>&nbsp;<span class="op" id="2249723">-=</span>&nbsp;<span class="ident" id="2249726">r</span>&nbsp;<span class="op" id="2249728">-</span>&nbsp;<span class="num" id="2249730">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2249734">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249773">for</span>&nbsp;<span class="op" id="2249777">;</span>&nbsp;<span class="ident" id="2249779">r</span>&nbsp;<span class="op" id="2249781">&lt;</span>&nbsp;<span class="ident" id="2249783">a</span><span class="op" id="2249784">.</span><span class="ident" id="2249785">nd</span><span class="op" id="2249787">;</span>&nbsp;<span class="ident" id="2249789">r</span><span class="op" id="2249790">++</span>&nbsp;<span class="op" id="2249793">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249797">c</span>&nbsp;<span class="op" id="2249799">:=</span>&nbsp;<span class="builtintype" id="2249802">int</span><span class="op" id="2249805">(</span><span class="ident" id="2249806">a</span><span class="op" id="2249807">.</span><span class="ident" id="2249808">d</span><span class="op" id="2249809">[</span><span class="ident" id="2249810">r</span><span class="op" id="2249811">]</span><span class="op" id="2249812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249816">dig</span>&nbsp;<span class="op" id="2249820">:=</span>&nbsp;<span class="ident" id="2249823">n</span>&nbsp;<span class="op" id="2249825">&gt;&gt;</span>&nbsp;<span class="ident" id="2249828">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249832">n</span>&nbsp;<span class="op" id="2249834">-=</span>&nbsp;<span class="ident" id="2249837">dig</span>&nbsp;<span class="op" id="2249841">&lt;&lt;</span>&nbsp;<span class="ident" id="2249844">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249848">a</span><span class="op" id="2249849">.</span><span class="ident" id="2249850">d</span><span class="op" id="2249851">[</span><span class="ident" id="2249852">w</span><span class="op" id="2249853">]</span>&nbsp;<span class="op" id="2249855">=</span>&nbsp;<span class="builtintype" id="2249857">byte</span><span class="op" id="2249861">(</span><span class="ident" id="2249862">dig</span>&nbsp;<span class="op" id="2249866">+</span>&nbsp;<span class="string" id="2249868">&#39;0&#39;</span><span class="op" id="2249871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249875">w</span><span class="op" id="2249876">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249881">n</span>&nbsp;<span class="op" id="2249883">=</span>&nbsp;<span class="ident" id="2249885">n</span><span class="op" id="2249886">*</span><span class="num" id="2249887">10</span>&nbsp;<span class="op" id="2249890">+</span>&nbsp;<span class="ident" id="2249892">c</span>&nbsp;<span class="op" id="2249894">-</span>&nbsp;<span class="string" id="2249896">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2249905">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249932">for</span>&nbsp;<span class="ident" id="2249936">n</span>&nbsp;<span class="op" id="2249938">&gt;</span>&nbsp;<span class="num" id="2249940">0</span>&nbsp;<span class="op" id="2249942">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249946">dig</span>&nbsp;<span class="op" id="2249950">:=</span>&nbsp;<span class="ident" id="2249953">n</span>&nbsp;<span class="op" id="2249955">&gt;&gt;</span>&nbsp;<span class="ident" id="2249958">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249962">n</span>&nbsp;<span class="op" id="2249964">-=</span>&nbsp;<span class="ident" id="2249967">dig</span>&nbsp;<span class="op" id="2249971">&lt;&lt;</span>&nbsp;<span class="ident" id="2249974">k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2249978">if</span>&nbsp;<span class="ident" id="2249981">w</span>&nbsp;<span class="op" id="2249983">&lt;</span>&nbsp;<span class="builtinfunc" id="2249985">len</span><span class="op" id="2249988">(</span><span class="ident" id="2249989">a</span><span class="op" id="2249990">.</span><span class="ident" id="2249991">d</span><span class="op" id="2249992">)</span>&nbsp;<span class="op" id="2249994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2249999">a</span><span class="op" id="2250000">.</span><span class="ident" id="2250001">d</span><span class="op" id="2250002">[</span><span class="ident" id="2250003">w</span><span class="op" id="2250004">]</span>&nbsp;<span class="op" id="2250006">=</span>&nbsp;<span class="builtintype" id="2250008">byte</span><span class="op" id="2250012">(</span><span class="ident" id="2250013">dig</span>&nbsp;<span class="op" id="2250017">+</span>&nbsp;<span class="string" id="2250019">&#39;0&#39;</span><span class="op" id="2250022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250027">w</span><span class="op" id="2250028">++</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250033">}</span>&nbsp;<span class="keyword" id="2250035">else</span>&nbsp;<span class="keyword" id="2250040">if</span>&nbsp;<span class="ident" id="2250043">dig</span>&nbsp;<span class="op" id="2250047">&gt;</span>&nbsp;<span class="num" id="2250049">0</span>&nbsp;<span class="op" id="2250051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250056">a</span><span class="op" id="2250057">.</span><span class="ident" id="2250058">trunc</span>&nbsp;<span class="op" id="2250064">=</span>&nbsp;<span class="builtintype" id="2250066">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250077">n</span>&nbsp;<span class="op" id="2250079">=</span>&nbsp;<span class="ident" id="2250081">n</span>&nbsp;<span class="op" id="2250083">*</span>&nbsp;<span class="num" id="2250085">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250089">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250093">a</span><span class="op" id="2250094">.</span><span class="ident" id="2250095">nd</span>&nbsp;<span class="op" id="2250098">=</span>&nbsp;<span class="ident" id="2250100">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250103">trim</span><span class="op" id="2250107">(</span><span class="ident" id="2250108">a</span><span class="op" id="2250109">)</span><br>
<span class="lineno"></span><span class="op" id="2250111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="2250114">//&nbsp;Cheat&nbsp;sheet&nbsp;for&nbsp;left&nbsp;shift:&nbsp;table&nbsp;indexed&nbsp;by&nbsp;shift&nbsp;count&nbsp;giving</span><br>
<span class="lineno"></span><span class="comment" id="2250181">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits&nbsp;that&nbsp;will&nbsp;be&nbsp;introduced&nbsp;by&nbsp;that&nbsp;shift.</span><br>
<span class="lineno"></span><span class="comment" id="2250244">//</span><br>
<span class="lineno"></span><span class="comment" id="2250247">//&nbsp;For&nbsp;example,&nbsp;leftcheats[4]&nbsp;=&nbsp;{2,&nbsp;&#34;625&#34;}.&nbsp;&nbsp;That&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2250308">//&nbsp;if&nbsp;we&nbsp;are&nbsp;shifting&nbsp;by&nbsp;4&nbsp;(multiplying&nbsp;by&nbsp;16),&nbsp;it&nbsp;will&nbsp;add&nbsp;2&nbsp;digits</span><br>
<span class="lineno">165</span><span class="comment" id="2250377">//&nbsp;when&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;625&#34;&nbsp;through&nbsp;&#34;999&#34;,&nbsp;and&nbsp;one&nbsp;fewer&nbsp;digit</span><br>
<span class="lineno"></span><span class="comment" id="2250447">//&nbsp;if&nbsp;the&nbsp;string&nbsp;prefix&nbsp;is&nbsp;&#34;000&#34;&nbsp;through&nbsp;&#34;624&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2250495">//</span><br>
<span class="lineno"></span><span class="comment" id="2250498">//&nbsp;Credit&nbsp;for&nbsp;this&nbsp;trick&nbsp;goes&nbsp;to&nbsp;Ken.</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2250537">type</span>&nbsp;<span class="ident" id="2250542">leftCheat</span>&nbsp;<span class="keyword" id="2250552">struct</span>&nbsp;<span class="op" id="2250559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250562">delta</span>&nbsp;&nbsp;<span class="builtintype" id="2250569">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2250576">//&nbsp;number&nbsp;of&nbsp;new&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2250601">cutoff</span>&nbsp;<span class="builtintype" id="2250608">string</span>&nbsp;<span class="comment" id="2250615">//&nbsp;&nbsp;&nbsp;minus&nbsp;one&nbsp;digit&nbsp;if&nbsp;original&nbsp;&lt;&nbsp;a.</span><br>
<span class="lineno"></span><span class="op" id="2250653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="2250656">var</span>&nbsp;<span class="ident" id="2250660">leftcheats</span>&nbsp;<span class="op" id="2250671">=</span>&nbsp;<span class="op" id="2250673">[</span><span class="op" id="2250674">]</span><span class="ident" id="2250675">leftCheat</span><span class="op" id="2250684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2250687">//&nbsp;Leading&nbsp;digits&nbsp;of&nbsp;1/2^i&nbsp;=&nbsp;5^i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2250722">//&nbsp;5^23&nbsp;is&nbsp;not&nbsp;an&nbsp;exact&nbsp;64-bit&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2250777">//&nbsp;so&nbsp;have&nbsp;to&nbsp;use&nbsp;bc&nbsp;for&nbsp;the&nbsp;math.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2250813">/*<br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspseq&nbsp;27&nbsp;|&nbsp;sed&nbsp;&#39;s/^/5^/&#39;&nbsp;|&nbsp;bc&nbsp;|<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspawk&nbsp;&#39;BEGIN{&nbsp;print&nbsp;&#34;\tleftCheat{&nbsp;0,&nbsp;\&#34;\&#34;&nbsp;},&#34;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog2&nbsp;=&nbsp;log(2)/log(10)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintf(&#34;\tleftCheat{&nbsp;%d,&nbsp;\&#34;%s\&#34;&nbsp;},\t//&nbsp;*&nbsp;%d\n&#34;,<br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspint(log2*NR+1),&nbsp;$0,&nbsp;2**NR)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}&#39;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251017">{</span><span class="num" id="2251018">0</span><span class="op" id="2251019">,</span>&nbsp;<span class="string" id="2251021">&#34;&#34;</span><span class="op" id="2251023">}</span><span class="op" id="2251024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251027">{</span><span class="num" id="2251028">1</span><span class="op" id="2251029">,</span>&nbsp;<span class="string" id="2251031">&#34;5&#34;</span><span class="op" id="2251034">}</span><span class="op" id="2251035">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251055">//&nbsp;*&nbsp;2</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251063">{</span><span class="num" id="2251064">1</span><span class="op" id="2251065">,</span>&nbsp;<span class="string" id="2251067">&#34;25&#34;</span><span class="op" id="2251071">}</span><span class="op" id="2251072">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251091">//&nbsp;*&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251099">{</span><span class="num" id="2251100">1</span><span class="op" id="2251101">,</span>&nbsp;<span class="string" id="2251103">&#34;125&#34;</span><span class="op" id="2251108">}</span><span class="op" id="2251109">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251127">//&nbsp;*&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251135">{</span><span class="num" id="2251136">2</span><span class="op" id="2251137">,</span>&nbsp;<span class="string" id="2251139">&#34;625&#34;</span><span class="op" id="2251144">}</span><span class="op" id="2251145">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251163">//&nbsp;*&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251172">{</span><span class="num" id="2251173">2</span><span class="op" id="2251174">,</span>&nbsp;<span class="string" id="2251176">&#34;3125&#34;</span><span class="op" id="2251182">}</span><span class="op" id="2251183">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251200">//&nbsp;*&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251209">{</span><span class="num" id="2251210">2</span><span class="op" id="2251211">,</span>&nbsp;<span class="string" id="2251213">&#34;15625&#34;</span><span class="op" id="2251220">}</span><span class="op" id="2251221">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251237">//&nbsp;*&nbsp;64</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251246">{</span><span class="num" id="2251247">3</span><span class="op" id="2251248">,</span>&nbsp;<span class="string" id="2251250">&#34;78125&#34;</span><span class="op" id="2251257">}</span><span class="op" id="2251258">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251274">//&nbsp;*&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251284">{</span><span class="num" id="2251285">3</span><span class="op" id="2251286">,</span>&nbsp;<span class="string" id="2251288">&#34;390625&#34;</span><span class="op" id="2251296">}</span><span class="op" id="2251297">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251312">//&nbsp;*&nbsp;256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251322">{</span><span class="num" id="2251323">3</span><span class="op" id="2251324">,</span>&nbsp;<span class="string" id="2251326">&#34;1953125&#34;</span><span class="op" id="2251335">}</span><span class="op" id="2251336">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251350">//&nbsp;*&nbsp;512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251360">{</span><span class="num" id="2251361">4</span><span class="op" id="2251362">,</span>&nbsp;<span class="string" id="2251364">&#34;9765625&#34;</span><span class="op" id="2251373">}</span><span class="op" id="2251374">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251388">//&nbsp;*&nbsp;1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251399">{</span><span class="num" id="2251400">4</span><span class="op" id="2251401">,</span>&nbsp;<span class="string" id="2251403">&#34;48828125&#34;</span><span class="op" id="2251413">}</span><span class="op" id="2251414">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251427">//&nbsp;*&nbsp;2048</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251438">{</span><span class="num" id="2251439">4</span><span class="op" id="2251440">,</span>&nbsp;<span class="string" id="2251442">&#34;244140625&#34;</span><span class="op" id="2251453">}</span><span class="op" id="2251454">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251466">//&nbsp;*&nbsp;4096</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251477">{</span><span class="num" id="2251478">4</span><span class="op" id="2251479">,</span>&nbsp;<span class="string" id="2251481">&#34;1220703125&#34;</span><span class="op" id="2251493">}</span><span class="op" id="2251494">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251505">//&nbsp;*&nbsp;8192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251516">{</span><span class="num" id="2251517">5</span><span class="op" id="2251518">,</span>&nbsp;<span class="string" id="2251520">&#34;6103515625&#34;</span><span class="op" id="2251532">}</span><span class="op" id="2251533">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251544">//&nbsp;*&nbsp;16384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251556">{</span><span class="num" id="2251557">5</span><span class="op" id="2251558">,</span>&nbsp;<span class="string" id="2251560">&#34;30517578125&#34;</span><span class="op" id="2251573">}</span><span class="op" id="2251574">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251584">//&nbsp;*&nbsp;32768</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251596">{</span><span class="num" id="2251597">5</span><span class="op" id="2251598">,</span>&nbsp;<span class="string" id="2251600">&#34;152587890625&#34;</span><span class="op" id="2251614">}</span><span class="op" id="2251615">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251624">//&nbsp;*&nbsp;65536</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251636">{</span><span class="num" id="2251637">6</span><span class="op" id="2251638">,</span>&nbsp;<span class="string" id="2251640">&#34;762939453125&#34;</span><span class="op" id="2251654">}</span><span class="op" id="2251655">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251664">//&nbsp;*&nbsp;131072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251677">{</span><span class="num" id="2251678">6</span><span class="op" id="2251679">,</span>&nbsp;<span class="string" id="2251681">&#34;3814697265625&#34;</span><span class="op" id="2251696">}</span><span class="op" id="2251697">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251705">//&nbsp;*&nbsp;262144</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251718">{</span><span class="num" id="2251719">6</span><span class="op" id="2251720">,</span>&nbsp;<span class="string" id="2251722">&#34;19073486328125&#34;</span><span class="op" id="2251738">}</span><span class="op" id="2251739">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251746">//&nbsp;*&nbsp;524288</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251759">{</span><span class="num" id="2251760">7</span><span class="op" id="2251761">,</span>&nbsp;<span class="string" id="2251763">&#34;95367431640625&#34;</span><span class="op" id="2251779">}</span><span class="op" id="2251780">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251787">//&nbsp;*&nbsp;1048576</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251801">{</span><span class="num" id="2251802">7</span><span class="op" id="2251803">,</span>&nbsp;<span class="string" id="2251805">&#34;476837158203125&#34;</span><span class="op" id="2251822">}</span><span class="op" id="2251823">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251829">//&nbsp;*&nbsp;2097152</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251843">{</span><span class="num" id="2251844">7</span><span class="op" id="2251845">,</span>&nbsp;<span class="string" id="2251847">&#34;2384185791015625&#34;</span><span class="op" id="2251865">}</span><span class="op" id="2251866">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251871">//&nbsp;*&nbsp;4194304</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251885">{</span><span class="num" id="2251886">7</span><span class="op" id="2251887">,</span>&nbsp;<span class="string" id="2251889">&#34;11920928955078125&#34;</span><span class="op" id="2251908">}</span><span class="op" id="2251909">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251913">//&nbsp;*&nbsp;8388608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251927">{</span><span class="num" id="2251928">8</span><span class="op" id="2251929">,</span>&nbsp;<span class="string" id="2251931">&#34;59604644775390625&#34;</span><span class="op" id="2251950">}</span><span class="op" id="2251951">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251955">//&nbsp;*&nbsp;16777216</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251970">{</span><span class="num" id="2251971">8</span><span class="op" id="2251972">,</span>&nbsp;<span class="string" id="2251974">&#34;298023223876953125&#34;</span><span class="op" id="2251994">}</span><span class="op" id="2251995">,</span>&nbsp;&nbsp;<span class="comment" id="2251998">//&nbsp;*&nbsp;33554432</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252013">{</span><span class="num" id="2252014">8</span><span class="op" id="2252015">,</span>&nbsp;<span class="string" id="2252017">&#34;1490116119384765625&#34;</span><span class="op" id="2252038">}</span><span class="op" id="2252039">,</span>&nbsp;<span class="comment" id="2252041">//&nbsp;*&nbsp;67108864</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252056">{</span><span class="num" id="2252057">9</span><span class="op" id="2252058">,</span>&nbsp;<span class="string" id="2252060">&#34;7450580596923828125&#34;</span><span class="op" id="2252081">}</span><span class="op" id="2252082">,</span>&nbsp;<span class="comment" id="2252084">//&nbsp;*&nbsp;134217728</span><br>
<span class="lineno"></span><span class="op" id="2252099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2252102">//&nbsp;Is&nbsp;the&nbsp;leading&nbsp;prefix&nbsp;of&nbsp;b&nbsp;lexicographically&nbsp;less&nbsp;than&nbsp;s?</span><br>
<span class="lineno"></span><span class="keyword" id="2252163">func</span>&nbsp;<span class="ident" id="2252168">prefixIsLessThan</span><span class="op" id="2252184">(</span><span class="ident" id="2252185">b</span>&nbsp;<span class="op" id="2252187">[</span><span class="op" id="2252188">]</span><span class="builtintype" id="2252189">byte</span><span class="op" id="2252193">,</span>&nbsp;<span class="ident" id="2252195">s</span>&nbsp;<span class="builtintype" id="2252197">string</span><span class="op" id="2252203">)</span>&nbsp;<span class="builtintype" id="2252205">bool</span>&nbsp;<span class="op" id="2252210">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252213">for</span>&nbsp;<span class="ident" id="2252217">i</span>&nbsp;<span class="op" id="2252219">:=</span>&nbsp;<span class="num" id="2252222">0</span><span class="op" id="2252223">;</span>&nbsp;<span class="ident" id="2252225">i</span>&nbsp;<span class="op" id="2252227">&lt;</span>&nbsp;<span class="builtinfunc" id="2252229">len</span><span class="op" id="2252232">(</span><span class="ident" id="2252233">s</span><span class="op" id="2252234">)</span><span class="op" id="2252235">;</span>&nbsp;<span class="ident" id="2252237">i</span><span class="op" id="2252238">++</span>&nbsp;<span class="op" id="2252241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252245">if</span>&nbsp;<span class="ident" id="2252248">i</span>&nbsp;<span class="op" id="2252250">&gt;=</span>&nbsp;<span class="builtinfunc" id="2252253">len</span><span class="op" id="2252256">(</span><span class="ident" id="2252257">b</span><span class="op" id="2252258">)</span>&nbsp;<span class="op" id="2252260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252265">return</span>&nbsp;<span class="builtintype" id="2252272">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252283">if</span>&nbsp;<span class="ident" id="2252286">b</span><span class="op" id="2252287">[</span><span class="ident" id="2252288">i</span><span class="op" id="2252289">]</span>&nbsp;<span class="op" id="2252291">!=</span>&nbsp;<span class="ident" id="2252294">s</span><span class="op" id="2252295">[</span><span class="ident" id="2252296">i</span><span class="op" id="2252297">]</span>&nbsp;<span class="op" id="2252299">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252304">return</span>&nbsp;<span class="ident" id="2252311">b</span><span class="op" id="2252312">[</span><span class="ident" id="2252313">i</span><span class="op" id="2252314">]</span>&nbsp;<span class="op" id="2252316">&lt;</span>&nbsp;<span class="ident" id="2252318">s</span><span class="op" id="2252319">[</span><span class="ident" id="2252320">i</span><span class="op" id="2252321">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252331">return</span>&nbsp;<span class="builtintype" id="2252338">false</span><br>
<span class="lineno"></span><span class="op" id="2252344">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2252347">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(/&nbsp;2)&nbsp;by&nbsp;k&nbsp;bits.&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;maxShift&nbsp;to&nbsp;avoid&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2252419">func</span>&nbsp;<span class="ident" id="2252424">leftShift</span><span class="op" id="2252433">(</span><span class="ident" id="2252434">a</span>&nbsp;<span class="op" id="2252436">*</span><span class="ident" id="2252437">decimal</span><span class="op" id="2252444">,</span>&nbsp;<span class="ident" id="2252446">k</span>&nbsp;<span class="builtintype" id="2252448">uint</span><span class="op" id="2252452">)</span>&nbsp;<span class="op" id="2252454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252457">delta</span>&nbsp;<span class="op" id="2252463">:=</span>&nbsp;<span class="ident" id="2252466">leftcheats</span><span class="op" id="2252476">[</span><span class="ident" id="2252477">k</span><span class="op" id="2252478">]</span><span class="op" id="2252479">.</span><span class="ident" id="2252480">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252487">if</span>&nbsp;<span class="ident" id="2252490">prefixIsLessThan</span><span class="op" id="2252506">(</span><span class="ident" id="2252507">a</span><span class="op" id="2252508">.</span><span class="ident" id="2252509">d</span><span class="op" id="2252510">[</span><span class="num" id="2252511">0</span><span class="op" id="2252512">:</span><span class="ident" id="2252513">a</span><span class="op" id="2252514">.</span><span class="ident" id="2252515">nd</span><span class="op" id="2252517">]</span><span class="op" id="2252518">,</span>&nbsp;<span class="ident" id="2252520">leftcheats</span><span class="op" id="2252530">[</span><span class="ident" id="2252531">k</span><span class="op" id="2252532">]</span><span class="op" id="2252533">.</span><span class="ident" id="2252534">cutoff</span><span class="op" id="2252540">)</span>&nbsp;<span class="op" id="2252542">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252546">delta</span><span class="op" id="2252551">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252559">r</span>&nbsp;<span class="op" id="2252561">:=</span>&nbsp;<span class="ident" id="2252564">a</span><span class="op" id="2252565">.</span><span class="ident" id="2252566">nd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2252577">//&nbsp;read&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252592">w</span>&nbsp;<span class="op" id="2252594">:=</span>&nbsp;<span class="ident" id="2252597">a</span><span class="op" id="2252598">.</span><span class="ident" id="2252599">nd</span>&nbsp;<span class="op" id="2252602">+</span>&nbsp;<span class="ident" id="2252604">delta</span>&nbsp;<span class="comment" id="2252610">//&nbsp;write&nbsp;index</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252626">n</span>&nbsp;<span class="op" id="2252628">:=</span>&nbsp;<span class="num" id="2252631">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2252635">//&nbsp;Pick&nbsp;up&nbsp;a&nbsp;digit,&nbsp;put&nbsp;down&nbsp;a&nbsp;digit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252674">for</span>&nbsp;<span class="ident" id="2252678">r</span><span class="op" id="2252679">--</span><span class="op" id="2252681">;</span>&nbsp;<span class="ident" id="2252683">r</span>&nbsp;<span class="op" id="2252685">&gt;=</span>&nbsp;<span class="num" id="2252688">0</span><span class="op" id="2252689">;</span>&nbsp;<span class="ident" id="2252691">r</span><span class="op" id="2252692">--</span>&nbsp;<span class="op" id="2252695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252699">n</span>&nbsp;<span class="op" id="2252701">+=</span>&nbsp;<span class="op" id="2252704">(</span><span class="builtintype" id="2252705">int</span><span class="op" id="2252708">(</span><span class="ident" id="2252709">a</span><span class="op" id="2252710">.</span><span class="ident" id="2252711">d</span><span class="op" id="2252712">[</span><span class="ident" id="2252713">r</span><span class="op" id="2252714">]</span><span class="op" id="2252715">)</span>&nbsp;<span class="op" id="2252717">-</span>&nbsp;<span class="string" id="2252719">&#39;0&#39;</span><span class="op" id="2252722">)</span>&nbsp;<span class="op" id="2252724">&lt;&lt;</span>&nbsp;<span class="ident" id="2252727">k</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252731">quo</span>&nbsp;<span class="op" id="2252735">:=</span>&nbsp;<span class="ident" id="2252738">n</span>&nbsp;<span class="op" id="2252740">/</span>&nbsp;<span class="num" id="2252742">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252747">rem</span>&nbsp;<span class="op" id="2252751">:=</span>&nbsp;<span class="ident" id="2252754">n</span>&nbsp;<span class="op" id="2252756">-</span>&nbsp;<span class="num" id="2252758">10</span><span class="op" id="2252760">*</span><span class="ident" id="2252761">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252767">w</span><span class="op" id="2252768">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252773">if</span>&nbsp;<span class="ident" id="2252776">w</span>&nbsp;<span class="op" id="2252778">&lt;</span>&nbsp;<span class="builtinfunc" id="2252780">len</span><span class="op" id="2252783">(</span><span class="ident" id="2252784">a</span><span class="op" id="2252785">.</span><span class="ident" id="2252786">d</span><span class="op" id="2252787">)</span>&nbsp;<span class="op" id="2252789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252794">a</span><span class="op" id="2252795">.</span><span class="ident" id="2252796">d</span><span class="op" id="2252797">[</span><span class="ident" id="2252798">w</span><span class="op" id="2252799">]</span>&nbsp;<span class="op" id="2252801">=</span>&nbsp;<span class="builtintype" id="2252803">byte</span><span class="op" id="2252807">(</span><span class="ident" id="2252808">rem</span>&nbsp;<span class="op" id="2252812">+</span>&nbsp;<span class="string" id="2252814">&#39;0&#39;</span><span class="op" id="2252817">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252821">}</span>&nbsp;<span class="keyword" id="2252823">else</span>&nbsp;<span class="keyword" id="2252828">if</span>&nbsp;<span class="ident" id="2252831">rem</span>&nbsp;<span class="op" id="2252835">!=</span>&nbsp;<span class="num" id="2252838">0</span>&nbsp;<span class="op" id="2252840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252845">a</span><span class="op" id="2252846">.</span><span class="ident" id="2252847">trunc</span>&nbsp;<span class="op" id="2252853">=</span>&nbsp;<span class="builtintype" id="2252855">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252866">n</span>&nbsp;<span class="op" id="2252868">=</span>&nbsp;<span class="ident" id="2252870">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252875">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2252879">//&nbsp;Put&nbsp;down&nbsp;extra&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252906">for</span>&nbsp;<span class="ident" id="2252910">n</span>&nbsp;<span class="op" id="2252912">&gt;</span>&nbsp;<span class="num" id="2252914">0</span>&nbsp;<span class="op" id="2252916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252920">quo</span>&nbsp;<span class="op" id="2252924">:=</span>&nbsp;<span class="ident" id="2252927">n</span>&nbsp;<span class="op" id="2252929">/</span>&nbsp;<span class="num" id="2252931">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252936">rem</span>&nbsp;<span class="op" id="2252940">:=</span>&nbsp;<span class="ident" id="2252943">n</span>&nbsp;<span class="op" id="2252945">-</span>&nbsp;<span class="num" id="2252947">10</span><span class="op" id="2252949">*</span><span class="ident" id="2252950">quo</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252956">w</span><span class="op" id="2252957">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252962">if</span>&nbsp;<span class="ident" id="2252965">w</span>&nbsp;<span class="op" id="2252967">&lt;</span>&nbsp;<span class="builtinfunc" id="2252969">len</span><span class="op" id="2252972">(</span><span class="ident" id="2252973">a</span><span class="op" id="2252974">.</span><span class="ident" id="2252975">d</span><span class="op" id="2252976">)</span>&nbsp;<span class="op" id="2252978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252983">a</span><span class="op" id="2252984">.</span><span class="ident" id="2252985">d</span><span class="op" id="2252986">[</span><span class="ident" id="2252987">w</span><span class="op" id="2252988">]</span>&nbsp;<span class="op" id="2252990">=</span>&nbsp;<span class="builtintype" id="2252992">byte</span><span class="op" id="2252996">(</span><span class="ident" id="2252997">rem</span>&nbsp;<span class="op" id="2253001">+</span>&nbsp;<span class="string" id="2253003">&#39;0&#39;</span><span class="op" id="2253006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253010">}</span>&nbsp;<span class="keyword" id="2253012">else</span>&nbsp;<span class="keyword" id="2253017">if</span>&nbsp;<span class="ident" id="2253020">rem</span>&nbsp;<span class="op" id="2253024">!=</span>&nbsp;<span class="num" id="2253027">0</span>&nbsp;<span class="op" id="2253029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253034">a</span><span class="op" id="2253035">.</span><span class="ident" id="2253036">trunc</span>&nbsp;<span class="op" id="2253042">=</span>&nbsp;<span class="builtintype" id="2253044">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253055">n</span>&nbsp;<span class="op" id="2253057">=</span>&nbsp;<span class="ident" id="2253059">quo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253068">a</span><span class="op" id="2253069">.</span><span class="ident" id="2253070">nd</span>&nbsp;<span class="op" id="2253073">+=</span>&nbsp;<span class="ident" id="2253076">delta</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253083">if</span>&nbsp;<span class="ident" id="2253086">a</span><span class="op" id="2253087">.</span><span class="ident" id="2253088">nd</span>&nbsp;<span class="op" id="2253091">&gt;=</span>&nbsp;<span class="builtinfunc" id="2253094">len</span><span class="op" id="2253097">(</span><span class="ident" id="2253098">a</span><span class="op" id="2253099">.</span><span class="ident" id="2253100">d</span><span class="op" id="2253101">)</span>&nbsp;<span class="op" id="2253103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253107">a</span><span class="op" id="2253108">.</span><span class="ident" id="2253109">nd</span>&nbsp;<span class="op" id="2253112">=</span>&nbsp;<span class="builtinfunc" id="2253114">len</span><span class="op" id="2253117">(</span><span class="ident" id="2253118">a</span><span class="op" id="2253119">.</span><span class="ident" id="2253120">d</span><span class="op" id="2253121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253127">a</span><span class="op" id="2253128">.</span><span class="ident" id="2253129">dp</span>&nbsp;<span class="op" id="2253132">+=</span>&nbsp;<span class="ident" id="2253135">delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253142">trim</span><span class="op" id="2253146">(</span><span class="ident" id="2253147">a</span><span class="op" id="2253148">)</span><br>
<span class="lineno">275</span><span class="op" id="2253150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2253153">//&nbsp;Binary&nbsp;shift&nbsp;left&nbsp;(k&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(k&nbsp;&lt;&nbsp;0).</span><br>
<span class="lineno"></span><span class="keyword" id="2253200">func</span>&nbsp;<span class="op" id="2253205">(</span><span class="ident" id="2253206">a</span>&nbsp;<span class="op" id="2253208">*</span><span class="ident" id="2253209">decimal</span><span class="op" id="2253216">)</span>&nbsp;<span class="ident" id="2253218">Shift</span><span class="op" id="2253223">(</span><span class="ident" id="2253224">k</span>&nbsp;<span class="builtintype" id="2253226">int</span><span class="op" id="2253229">)</span>&nbsp;<span class="op" id="2253231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253234">switch</span>&nbsp;<span class="op" id="2253241">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253244">case</span>&nbsp;<span class="ident" id="2253249">a</span><span class="op" id="2253250">.</span><span class="ident" id="2253251">nd</span>&nbsp;<span class="op" id="2253254">==</span>&nbsp;<span class="num" id="2253257">0</span><span class="op" id="2253258">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253262">//&nbsp;nothing&nbsp;to&nbsp;do:&nbsp;a&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253288">case</span>&nbsp;<span class="ident" id="2253293">k</span>&nbsp;<span class="op" id="2253295">&gt;</span>&nbsp;<span class="num" id="2253297">0</span><span class="op" id="2253298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253302">for</span>&nbsp;<span class="ident" id="2253306">k</span>&nbsp;<span class="op" id="2253308">&gt;</span>&nbsp;<span class="ident" id="2253310">maxShift</span>&nbsp;<span class="op" id="2253319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253324">leftShift</span><span class="op" id="2253333">(</span><span class="ident" id="2253334">a</span><span class="op" id="2253335">,</span>&nbsp;<span class="ident" id="2253337">maxShift</span><span class="op" id="2253345">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253350">k</span>&nbsp;<span class="op" id="2253352">-=</span>&nbsp;<span class="ident" id="2253355">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253370">leftShift</span><span class="op" id="2253379">(</span><span class="ident" id="2253380">a</span><span class="op" id="2253381">,</span>&nbsp;<span class="builtintype" id="2253383">uint</span><span class="op" id="2253387">(</span><span class="ident" id="2253388">k</span><span class="op" id="2253389">)</span><span class="op" id="2253390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253393">case</span>&nbsp;<span class="ident" id="2253398">k</span>&nbsp;<span class="op" id="2253400">&lt;</span>&nbsp;<span class="num" id="2253402">0</span><span class="op" id="2253403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253407">for</span>&nbsp;<span class="ident" id="2253411">k</span>&nbsp;<span class="op" id="2253413">&lt;</span>&nbsp;<span class="op" id="2253415">-</span><span class="ident" id="2253416">maxShift</span>&nbsp;<span class="op" id="2253425">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253430">rightShift</span><span class="op" id="2253440">(</span><span class="ident" id="2253441">a</span><span class="op" id="2253442">,</span>&nbsp;<span class="ident" id="2253444">maxShift</span><span class="op" id="2253452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253457">k</span>&nbsp;<span class="op" id="2253459">+=</span>&nbsp;<span class="ident" id="2253462">maxShift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253477">rightShift</span><span class="op" id="2253487">(</span><span class="ident" id="2253488">a</span><span class="op" id="2253489">,</span>&nbsp;<span class="builtintype" id="2253491">uint</span><span class="op" id="2253495">(</span><span class="op" id="2253496">-</span><span class="ident" id="2253497">k</span><span class="op" id="2253498">)</span><span class="op" id="2253499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253502">}</span><br>
<span class="lineno">295</span><span class="op" id="2253504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2253507">//&nbsp;If&nbsp;we&nbsp;chop&nbsp;a&nbsp;at&nbsp;nd&nbsp;digits,&nbsp;should&nbsp;we&nbsp;round&nbsp;up?</span><br>
<span class="lineno"></span><span class="keyword" id="2253557">func</span>&nbsp;<span class="ident" id="2253562">shouldRoundUp</span><span class="op" id="2253575">(</span><span class="ident" id="2253576">a</span>&nbsp;<span class="op" id="2253578">*</span><span class="ident" id="2253579">decimal</span><span class="op" id="2253586">,</span>&nbsp;<span class="ident" id="2253588">nd</span>&nbsp;<span class="builtintype" id="2253591">int</span><span class="op" id="2253594">)</span>&nbsp;<span class="builtintype" id="2253596">bool</span>&nbsp;<span class="op" id="2253601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253604">if</span>&nbsp;<span class="ident" id="2253607">nd</span>&nbsp;<span class="op" id="2253610">&lt;</span>&nbsp;<span class="num" id="2253612">0</span>&nbsp;<span class="op" id="2253614">||</span>&nbsp;<span class="ident" id="2253617">nd</span>&nbsp;<span class="op" id="2253620">&gt;=</span>&nbsp;<span class="ident" id="2253623">a</span><span class="op" id="2253624">.</span><span class="ident" id="2253625">nd</span>&nbsp;<span class="op" id="2253628">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253632">return</span>&nbsp;<span class="builtintype" id="2253639">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253649">if</span>&nbsp;<span class="ident" id="2253652">a</span><span class="op" id="2253653">.</span><span class="ident" id="2253654">d</span><span class="op" id="2253655">[</span><span class="ident" id="2253656">nd</span><span class="op" id="2253658">]</span>&nbsp;<span class="op" id="2253660">==</span>&nbsp;<span class="string" id="2253663">&#39;5&#39;</span>&nbsp;<span class="op" id="2253667">&amp;&amp;</span>&nbsp;<span class="ident" id="2253670">nd</span><span class="op" id="2253672">+</span><span class="num" id="2253673">1</span>&nbsp;<span class="op" id="2253675">==</span>&nbsp;<span class="ident" id="2253678">a</span><span class="op" id="2253679">.</span><span class="ident" id="2253680">nd</span>&nbsp;<span class="op" id="2253683">{</span>&nbsp;<span class="comment" id="2253685">//&nbsp;exactly&nbsp;halfway&nbsp;-&nbsp;round&nbsp;to&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253722">//&nbsp;if&nbsp;we&nbsp;truncated,&nbsp;a&nbsp;little&nbsp;higher&nbsp;than&nbsp;what&#39;s&nbsp;recorded&nbsp;-&nbsp;always&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253799">if</span>&nbsp;<span class="ident" id="2253802">a</span><span class="op" id="2253803">.</span><span class="ident" id="2253804">trunc</span>&nbsp;<span class="op" id="2253810">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253815">return</span>&nbsp;<span class="builtintype" id="2253822">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253833">return</span>&nbsp;<span class="ident" id="2253840">nd</span>&nbsp;<span class="op" id="2253843">&gt;</span>&nbsp;<span class="num" id="2253845">0</span>&nbsp;<span class="op" id="2253847">&amp;&amp;</span>&nbsp;<span class="op" id="2253850">(</span><span class="ident" id="2253851">a</span><span class="op" id="2253852">.</span><span class="ident" id="2253853">d</span><span class="op" id="2253854">[</span><span class="ident" id="2253855">nd</span><span class="op" id="2253857">-</span><span class="num" id="2253858">1</span><span class="op" id="2253859">]</span><span class="op" id="2253860">-</span><span class="string" id="2253861">&#39;0&#39;</span><span class="op" id="2253864">)</span><span class="op" id="2253865">%</span><span class="num" id="2253866">2</span>&nbsp;<span class="op" id="2253868">!=</span>&nbsp;<span class="num" id="2253871">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253877">//&nbsp;not&nbsp;halfway&nbsp;-&nbsp;digit&nbsp;tells&nbsp;all</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253911">return</span>&nbsp;<span class="ident" id="2253918">a</span><span class="op" id="2253919">.</span><span class="ident" id="2253920">d</span><span class="op" id="2253921">[</span><span class="ident" id="2253922">nd</span><span class="op" id="2253924">]</span>&nbsp;<span class="op" id="2253926">&gt;=</span>&nbsp;<span class="string" id="2253929">&#39;5&#39;</span><br>
<span class="lineno"></span><span class="op" id="2253933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2253936">//&nbsp;Round&nbsp;a&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="comment" id="2253972">//&nbsp;If&nbsp;nd&nbsp;is&nbsp;zero,&nbsp;it&nbsp;means&nbsp;we&#39;re&nbsp;rounding</span><br>
<span class="lineno">315</span><span class="comment" id="2254014">//&nbsp;just&nbsp;to&nbsp;the&nbsp;left&nbsp;of&nbsp;the&nbsp;digits,&nbsp;as&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2254055">//&nbsp;0.09&nbsp;-&gt;&nbsp;0.1.</span><br>
<span class="lineno"></span><span class="keyword" id="2254071">func</span>&nbsp;<span class="op" id="2254076">(</span><span class="ident" id="2254077">a</span>&nbsp;<span class="op" id="2254079">*</span><span class="ident" id="2254080">decimal</span><span class="op" id="2254087">)</span>&nbsp;<span class="ident" id="2254089">Round</span><span class="op" id="2254094">(</span><span class="ident" id="2254095">nd</span>&nbsp;<span class="builtintype" id="2254098">int</span><span class="op" id="2254101">)</span>&nbsp;<span class="op" id="2254103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254106">if</span>&nbsp;<span class="ident" id="2254109">nd</span>&nbsp;<span class="op" id="2254112">&lt;</span>&nbsp;<span class="num" id="2254114">0</span>&nbsp;<span class="op" id="2254116">||</span>&nbsp;<span class="ident" id="2254119">nd</span>&nbsp;<span class="op" id="2254122">&gt;=</span>&nbsp;<span class="ident" id="2254125">a</span><span class="op" id="2254126">.</span><span class="ident" id="2254127">nd</span>&nbsp;<span class="op" id="2254130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254134">return</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254145">if</span>&nbsp;<span class="ident" id="2254148">shouldRoundUp</span><span class="op" id="2254161">(</span><span class="ident" id="2254162">a</span><span class="op" id="2254163">,</span>&nbsp;<span class="ident" id="2254165">nd</span><span class="op" id="2254167">)</span>&nbsp;<span class="op" id="2254169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254173">a</span><span class="op" id="2254174">.</span><span class="ident" id="2254175">RoundUp</span><span class="op" id="2254182">(</span><span class="ident" id="2254183">nd</span><span class="op" id="2254185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254188">}</span>&nbsp;<span class="keyword" id="2254190">else</span>&nbsp;<span class="op" id="2254195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254199">a</span><span class="op" id="2254200">.</span><span class="ident" id="2254201">RoundDown</span><span class="op" id="2254210">(</span><span class="ident" id="2254211">nd</span><span class="op" id="2254213">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254216">}</span><br>
<span class="lineno"></span><span class="op" id="2254218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2254221">//&nbsp;Round&nbsp;a&nbsp;down&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="2254262">func</span>&nbsp;<span class="op" id="2254267">(</span><span class="ident" id="2254268">a</span>&nbsp;<span class="op" id="2254270">*</span><span class="ident" id="2254271">decimal</span><span class="op" id="2254278">)</span>&nbsp;<span class="ident" id="2254280">RoundDown</span><span class="op" id="2254289">(</span><span class="ident" id="2254290">nd</span>&nbsp;<span class="builtintype" id="2254293">int</span><span class="op" id="2254296">)</span>&nbsp;<span class="op" id="2254298">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254301">if</span>&nbsp;<span class="ident" id="2254304">nd</span>&nbsp;<span class="op" id="2254307">&lt;</span>&nbsp;<span class="num" id="2254309">0</span>&nbsp;<span class="op" id="2254311">||</span>&nbsp;<span class="ident" id="2254314">nd</span>&nbsp;<span class="op" id="2254317">&gt;=</span>&nbsp;<span class="ident" id="2254320">a</span><span class="op" id="2254321">.</span><span class="ident" id="2254322">nd</span>&nbsp;<span class="op" id="2254325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254329">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254340">a</span><span class="op" id="2254341">.</span><span class="ident" id="2254342">nd</span>&nbsp;<span class="op" id="2254345">=</span>&nbsp;<span class="ident" id="2254347">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254351">trim</span><span class="op" id="2254355">(</span><span class="ident" id="2254356">a</span><span class="op" id="2254357">)</span><br>
<span class="lineno">335</span><span class="op" id="2254359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2254362">//&nbsp;Round&nbsp;a&nbsp;up&nbsp;to&nbsp;nd&nbsp;digits&nbsp;(or&nbsp;fewer).</span><br>
<span class="lineno"></span><span class="keyword" id="2254401">func</span>&nbsp;<span class="op" id="2254406">(</span><span class="ident" id="2254407">a</span>&nbsp;<span class="op" id="2254409">*</span><span class="ident" id="2254410">decimal</span><span class="op" id="2254417">)</span>&nbsp;<span class="ident" id="2254419">RoundUp</span><span class="op" id="2254426">(</span><span class="ident" id="2254427">nd</span>&nbsp;<span class="builtintype" id="2254430">int</span><span class="op" id="2254433">)</span>&nbsp;<span class="op" id="2254435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254438">if</span>&nbsp;<span class="ident" id="2254441">nd</span>&nbsp;<span class="op" id="2254444">&lt;</span>&nbsp;<span class="num" id="2254446">0</span>&nbsp;<span class="op" id="2254448">||</span>&nbsp;<span class="ident" id="2254451">nd</span>&nbsp;<span class="op" id="2254454">&gt;=</span>&nbsp;<span class="ident" id="2254457">a</span><span class="op" id="2254458">.</span><span class="ident" id="2254459">nd</span>&nbsp;<span class="op" id="2254462">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254466">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254478">//&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254491">for</span>&nbsp;<span class="ident" id="2254495">i</span>&nbsp;<span class="op" id="2254497">:=</span>&nbsp;<span class="ident" id="2254500">nd</span>&nbsp;<span class="op" id="2254503">-</span>&nbsp;<span class="num" id="2254505">1</span><span class="op" id="2254506">;</span>&nbsp;<span class="ident" id="2254508">i</span>&nbsp;<span class="op" id="2254510">&gt;=</span>&nbsp;<span class="num" id="2254513">0</span><span class="op" id="2254514">;</span>&nbsp;<span class="ident" id="2254516">i</span><span class="op" id="2254517">--</span>&nbsp;<span class="op" id="2254520">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254524">c</span>&nbsp;<span class="op" id="2254526">:=</span>&nbsp;<span class="ident" id="2254529">a</span><span class="op" id="2254530">.</span><span class="ident" id="2254531">d</span><span class="op" id="2254532">[</span><span class="ident" id="2254533">i</span><span class="op" id="2254534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254538">if</span>&nbsp;<span class="ident" id="2254541">c</span>&nbsp;<span class="op" id="2254543">&lt;</span>&nbsp;<span class="string" id="2254545">&#39;9&#39;</span>&nbsp;<span class="op" id="2254549">{</span>&nbsp;<span class="comment" id="2254551">//&nbsp;can&nbsp;stop&nbsp;after&nbsp;this&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254583">a</span><span class="op" id="2254584">.</span><span class="ident" id="2254585">d</span><span class="op" id="2254586">[</span><span class="ident" id="2254587">i</span><span class="op" id="2254588">]</span><span class="op" id="2254589">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254595">a</span><span class="op" id="2254596">.</span><span class="ident" id="2254597">nd</span>&nbsp;<span class="op" id="2254600">=</span>&nbsp;<span class="ident" id="2254602">i</span>&nbsp;<span class="op" id="2254604">+</span>&nbsp;<span class="num" id="2254606">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254611">return</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254627">//&nbsp;Number&nbsp;is&nbsp;all&nbsp;9s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254649">//&nbsp;Change&nbsp;to&nbsp;single&nbsp;1&nbsp;with&nbsp;adjusted&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254701">a</span><span class="op" id="2254702">.</span><span class="ident" id="2254703">d</span><span class="op" id="2254704">[</span><span class="num" id="2254705">0</span><span class="op" id="2254706">]</span>&nbsp;<span class="op" id="2254708">=</span>&nbsp;<span class="string" id="2254710">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254715">a</span><span class="op" id="2254716">.</span><span class="ident" id="2254717">nd</span>&nbsp;<span class="op" id="2254720">=</span>&nbsp;<span class="num" id="2254722">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254725">a</span><span class="op" id="2254726">.</span><span class="ident" id="2254727">dp</span><span class="op" id="2254729">++</span><br>
<span class="lineno"></span><span class="op" id="2254732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="2254735">//&nbsp;Extract&nbsp;integer&nbsp;part,&nbsp;rounded&nbsp;appropriately.</span><br>
<span class="lineno"></span><span class="comment" id="2254783">//&nbsp;No&nbsp;guarantees&nbsp;about&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="keyword" id="2254816">func</span>&nbsp;<span class="op" id="2254821">(</span><span class="ident" id="2254822">a</span>&nbsp;<span class="op" id="2254824">*</span><span class="ident" id="2254825">decimal</span><span class="op" id="2254832">)</span>&nbsp;<span class="ident" id="2254834">RoundedInteger</span><span class="op" id="2254848">(</span><span class="op" id="2254849">)</span>&nbsp;<span class="ident" id="2254851">uint64</span>&nbsp;<span class="op" id="2254858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254861">if</span>&nbsp;<span class="ident" id="2254864">a</span><span class="op" id="2254865">.</span><span class="ident" id="2254866">dp</span>&nbsp;<span class="op" id="2254869">&gt;</span>&nbsp;<span class="num" id="2254871">20</span>&nbsp;<span class="op" id="2254874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254878">return</span>&nbsp;<span class="num" id="2254885">0xFFFFFFFFFFFFFFFF</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254908">var</span>&nbsp;<span class="ident" id="2254912">i</span>&nbsp;<span class="builtintype" id="2254914">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254919">n</span>&nbsp;<span class="op" id="2254921">:=</span>&nbsp;<span class="ident" id="2254924">uint64</span><span class="op" id="2254930">(</span><span class="num" id="2254931">0</span><span class="op" id="2254932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254935">for</span>&nbsp;<span class="ident" id="2254939">i</span>&nbsp;<span class="op" id="2254941">=</span>&nbsp;<span class="num" id="2254943">0</span><span class="op" id="2254944">;</span>&nbsp;<span class="ident" id="2254946">i</span>&nbsp;<span class="op" id="2254948">&lt;</span>&nbsp;<span class="ident" id="2254950">a</span><span class="op" id="2254951">.</span><span class="ident" id="2254952">dp</span>&nbsp;<span class="op" id="2254955">&amp;&amp;</span>&nbsp;<span class="ident" id="2254958">i</span>&nbsp;<span class="op" id="2254960">&lt;</span>&nbsp;<span class="ident" id="2254962">a</span><span class="op" id="2254963">.</span><span class="ident" id="2254964">nd</span><span class="op" id="2254966">;</span>&nbsp;<span class="ident" id="2254968">i</span><span class="op" id="2254969">++</span>&nbsp;<span class="op" id="2254972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254976">n</span>&nbsp;<span class="op" id="2254978">=</span>&nbsp;<span class="ident" id="2254980">n</span><span class="op" id="2254981">*</span><span class="num" id="2254982">10</span>&nbsp;<span class="op" id="2254985">+</span>&nbsp;<span class="ident" id="2254987">uint64</span><span class="op" id="2254993">(</span><span class="ident" id="2254994">a</span><span class="op" id="2254995">.</span><span class="ident" id="2254996">d</span><span class="op" id="2254997">[</span><span class="ident" id="2254998">i</span><span class="op" id="2254999">]</span><span class="op" id="2255000">-</span><span class="string" id="2255001">&#39;0&#39;</span><span class="op" id="2255004">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255010">for</span>&nbsp;<span class="op" id="2255014">;</span>&nbsp;<span class="ident" id="2255016">i</span>&nbsp;<span class="op" id="2255018">&lt;</span>&nbsp;<span class="ident" id="2255020">a</span><span class="op" id="2255021">.</span><span class="ident" id="2255022">dp</span><span class="op" id="2255024">;</span>&nbsp;<span class="ident" id="2255026">i</span><span class="op" id="2255027">++</span>&nbsp;<span class="op" id="2255030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255034">n</span>&nbsp;<span class="op" id="2255036">*=</span>&nbsp;<span class="num" id="2255039">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255046">if</span>&nbsp;<span class="ident" id="2255049">shouldRoundUp</span><span class="op" id="2255062">(</span><span class="ident" id="2255063">a</span><span class="op" id="2255064">,</span>&nbsp;<span class="ident" id="2255066">a</span><span class="op" id="2255067">.</span><span class="ident" id="2255068">dp</span><span class="op" id="2255070">)</span>&nbsp;<span class="op" id="2255072">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255076">n</span><span class="op" id="2255077">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255084">return</span>&nbsp;<span class="ident" id="2255091">n</span><br>
<span class="lineno"></span><span class="op" id="2255093">}</span>
</div>
</body>
</html>
