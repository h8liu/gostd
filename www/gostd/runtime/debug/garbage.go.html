<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5929757">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5929813">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5929867">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5929918">package</span>&nbsp;<span class="ident" id="5929926">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5929933">import</span>&nbsp;<span class="op" id="5929940">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5929943">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5929954">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5929962">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5929969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5929972">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5930037">type</span>&nbsp;<span class="ident" id="5930042">GCStats</span>&nbsp;<span class="keyword" id="5930050">struct</span>&nbsp;<span class="op" id="5930057">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930060">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930075">time</span><span class="op" id="5930079">.</span><span class="ident" id="5930080">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5930091">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930119">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930134">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5930150">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930184">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930199">time</span><span class="op" id="5930203">.</span><span class="ident" id="5930204">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5930215">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930251">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5930266">[</span><span class="op" id="5930267">]</span><span class="ident" id="5930268">time</span><span class="op" id="5930272">.</span><span class="ident" id="5930273">Duration</span>&nbsp;<span class="comment" id="5930282">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930319">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5930334">[</span><span class="op" id="5930335">]</span><span class="ident" id="5930336">time</span><span class="op" id="5930340">.</span><span class="ident" id="5930341">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5930350">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5930397">PauseQuantiles</span>&nbsp;<span class="op" id="5930412">[</span><span class="op" id="5930413">]</span><span class="ident" id="5930414">time</span><span class="op" id="5930418">.</span><span class="ident" id="5930419">Duration</span><br>
<span class="lineno"></span><span class="op" id="5930428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5930431">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5930500">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5930567">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5930643">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5930710">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5930787">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5930850">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5930921">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5930964">func</span>&nbsp;<span class="ident" id="5930969">ReadGCStats</span><span class="op" id="5930980">(</span><span class="ident" id="5930981">stats</span>&nbsp;<span class="op" id="5930987">*</span><span class="ident" id="5930988">GCStats</span><span class="op" id="5930995">)</span>&nbsp;<span class="op" id="5930997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931000">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931062">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931125">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931189">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931245">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5931270">const</span>&nbsp;<span class="ident" id="5931276">maxPause</span>&nbsp;<span class="op" id="5931285">=</span>&nbsp;<span class="builtinfunc" id="5931287">len</span><span class="op" id="5931290">(</span><span class="op" id="5931291">(</span><span class="op" id="5931292">(</span><span class="op" id="5931293">*</span><span class="ident" id="5931294">runtime</span><span class="op" id="5931301">.</span><span class="ident" id="5931302">MemStats</span><span class="op" id="5931310">)</span><span class="op" id="5931311">(</span><span class="builtintype" id="5931312">nil</span><span class="op" id="5931315">)</span><span class="op" id="5931316">)</span><span class="op" id="5931317">.</span><span class="ident" id="5931318">PauseNs</span><span class="op" id="5931325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5931328">if</span>&nbsp;<span class="builtinfunc" id="5931331">cap</span><span class="op" id="5931334">(</span><span class="ident" id="5931335">stats</span><span class="op" id="5931340">.</span><span class="ident" id="5931341">Pause</span><span class="op" id="5931346">)</span>&nbsp;<span class="op" id="5931348">&lt;</span>&nbsp;<span class="num" id="5931350">2</span><span class="op" id="5931351">*</span><span class="ident" id="5931352">maxPause</span><span class="op" id="5931360">+</span><span class="num" id="5931361">3</span>&nbsp;<span class="op" id="5931363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931367">stats</span><span class="op" id="5931372">.</span><span class="ident" id="5931373">Pause</span>&nbsp;<span class="op" id="5931379">=</span>&nbsp;<span class="builtinfunc" id="5931381">make</span><span class="op" id="5931385">(</span><span class="op" id="5931386">[</span><span class="op" id="5931387">]</span><span class="ident" id="5931388">time</span><span class="op" id="5931392">.</span><span class="ident" id="5931393">Duration</span><span class="op" id="5931401">,</span>&nbsp;<span class="num" id="5931403">2</span><span class="op" id="5931404">*</span><span class="ident" id="5931405">maxPause</span><span class="op" id="5931413">+</span><span class="num" id="5931414">3</span><span class="op" id="5931415">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5931418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931422">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931488">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931556">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931619">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931678">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5931746">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931766">readGCStats</span><span class="op" id="5931777">(</span><span class="op" id="5931778">&amp;</span><span class="ident" id="5931779">stats</span><span class="op" id="5931784">.</span><span class="ident" id="5931785">Pause</span><span class="op" id="5931790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931793">n</span>&nbsp;<span class="op" id="5931795">:=</span>&nbsp;<span class="builtinfunc" id="5931798">len</span><span class="op" id="5931801">(</span><span class="ident" id="5931802">stats</span><span class="op" id="5931807">.</span><span class="ident" id="5931808">Pause</span><span class="op" id="5931813">)</span>&nbsp;<span class="op" id="5931815">-</span>&nbsp;<span class="num" id="5931817">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931820">stats</span><span class="op" id="5931825">.</span><span class="ident" id="5931826">LastGC</span>&nbsp;<span class="op" id="5931833">=</span>&nbsp;<span class="ident" id="5931835">time</span><span class="op" id="5931839">.</span><span class="ident" id="5931840">Unix</span><span class="op" id="5931844">(</span><span class="num" id="5931845">0</span><span class="op" id="5931846">,</span>&nbsp;<span class="ident" id="5931848">int64</span><span class="op" id="5931853">(</span><span class="ident" id="5931854">stats</span><span class="op" id="5931859">.</span><span class="ident" id="5931860">Pause</span><span class="op" id="5931865">[</span><span class="ident" id="5931866">n</span><span class="op" id="5931867">]</span><span class="op" id="5931868">)</span><span class="op" id="5931869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931872">stats</span><span class="op" id="5931877">.</span><span class="ident" id="5931878">NumGC</span>&nbsp;<span class="op" id="5931884">=</span>&nbsp;<span class="ident" id="5931886">int64</span><span class="op" id="5931891">(</span><span class="ident" id="5931892">stats</span><span class="op" id="5931897">.</span><span class="ident" id="5931898">Pause</span><span class="op" id="5931903">[</span><span class="ident" id="5931904">n</span><span class="op" id="5931905">+</span><span class="num" id="5931906">1</span><span class="op" id="5931907">]</span><span class="op" id="5931908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931911">stats</span><span class="op" id="5931916">.</span><span class="ident" id="5931917">PauseTotal</span>&nbsp;<span class="op" id="5931928">=</span>&nbsp;<span class="ident" id="5931930">stats</span><span class="op" id="5931935">.</span><span class="ident" id="5931936">Pause</span><span class="op" id="5931941">[</span><span class="ident" id="5931942">n</span><span class="op" id="5931943">+</span><span class="num" id="5931944">2</span><span class="op" id="5931945">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931948">n</span>&nbsp;<span class="op" id="5931950">/=</span>&nbsp;<span class="num" id="5931953">2</span>&nbsp;<span class="comment" id="5931955">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5931993">stats</span><span class="op" id="5931998">.</span><span class="ident" id="5931999">Pause</span>&nbsp;<span class="op" id="5932005">=</span>&nbsp;<span class="ident" id="5932007">stats</span><span class="op" id="5932012">.</span><span class="ident" id="5932013">Pause</span><span class="op" id="5932018">[</span><span class="op" id="5932019">:</span><span class="ident" id="5932020">n</span><span class="op" id="5932021">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5932025">if</span>&nbsp;<span class="builtinfunc" id="5932028">cap</span><span class="op" id="5932031">(</span><span class="ident" id="5932032">stats</span><span class="op" id="5932037">.</span><span class="ident" id="5932038">PauseEnd</span><span class="op" id="5932046">)</span>&nbsp;<span class="op" id="5932048">&lt;</span>&nbsp;<span class="ident" id="5932050">maxPause</span>&nbsp;<span class="op" id="5932059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932063">stats</span><span class="op" id="5932068">.</span><span class="ident" id="5932069">PauseEnd</span>&nbsp;<span class="op" id="5932078">=</span>&nbsp;<span class="builtinfunc" id="5932080">make</span><span class="op" id="5932084">(</span><span class="op" id="5932085">[</span><span class="op" id="5932086">]</span><span class="ident" id="5932087">time</span><span class="op" id="5932091">.</span><span class="ident" id="5932092">Time</span><span class="op" id="5932096">,</span>&nbsp;<span class="num" id="5932098">0</span><span class="op" id="5932099">,</span>&nbsp;<span class="ident" id="5932101">maxPause</span><span class="op" id="5932109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932115">stats</span><span class="op" id="5932120">.</span><span class="ident" id="5932121">PauseEnd</span>&nbsp;<span class="op" id="5932130">=</span>&nbsp;<span class="ident" id="5932132">stats</span><span class="op" id="5932137">.</span><span class="ident" id="5932138">PauseEnd</span><span class="op" id="5932146">[</span><span class="op" id="5932147">:</span><span class="num" id="5932148">0</span><span class="op" id="5932149">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5932152">for</span>&nbsp;<span class="ident" id="5932156">_</span><span class="op" id="5932157">,</span>&nbsp;<span class="ident" id="5932159">ns</span>&nbsp;<span class="op" id="5932162">:=</span>&nbsp;<span class="keyword" id="5932165">range</span>&nbsp;<span class="ident" id="5932171">stats</span><span class="op" id="5932176">.</span><span class="ident" id="5932177">Pause</span><span class="op" id="5932182">[</span><span class="ident" id="5932183">n</span>&nbsp;<span class="op" id="5932185">:</span>&nbsp;<span class="ident" id="5932187">n</span><span class="op" id="5932188">+</span><span class="ident" id="5932189">n</span><span class="op" id="5932190">]</span>&nbsp;<span class="op" id="5932192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932196">stats</span><span class="op" id="5932201">.</span><span class="ident" id="5932202">PauseEnd</span>&nbsp;<span class="op" id="5932211">=</span>&nbsp;<span class="builtinfunc" id="5932213">append</span><span class="op" id="5932219">(</span><span class="ident" id="5932220">stats</span><span class="op" id="5932225">.</span><span class="ident" id="5932226">PauseEnd</span><span class="op" id="5932234">,</span>&nbsp;<span class="ident" id="5932236">time</span><span class="op" id="5932240">.</span><span class="ident" id="5932241">Unix</span><span class="op" id="5932245">(</span><span class="num" id="5932246">0</span><span class="op" id="5932247">,</span>&nbsp;<span class="ident" id="5932249">int64</span><span class="op" id="5932254">(</span><span class="ident" id="5932255">ns</span><span class="op" id="5932257">)</span><span class="op" id="5932258">)</span><span class="op" id="5932259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5932266">if</span>&nbsp;<span class="builtinfunc" id="5932269">len</span><span class="op" id="5932272">(</span><span class="ident" id="5932273">stats</span><span class="op" id="5932278">.</span><span class="ident" id="5932279">PauseQuantiles</span><span class="op" id="5932293">)</span>&nbsp;<span class="op" id="5932295">&gt;</span>&nbsp;<span class="num" id="5932297">0</span>&nbsp;<span class="op" id="5932299">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5932303">if</span>&nbsp;<span class="ident" id="5932306">n</span>&nbsp;<span class="op" id="5932308">==</span>&nbsp;<span class="num" id="5932311">0</span>&nbsp;<span class="op" id="5932313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5932318">for</span>&nbsp;<span class="ident" id="5932322">i</span>&nbsp;<span class="op" id="5932324">:=</span>&nbsp;<span class="keyword" id="5932327">range</span>&nbsp;<span class="ident" id="5932333">stats</span><span class="op" id="5932338">.</span><span class="ident" id="5932339">PauseQuantiles</span>&nbsp;<span class="op" id="5932354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932360">stats</span><span class="op" id="5932365">.</span><span class="ident" id="5932366">PauseQuantiles</span><span class="op" id="5932380">[</span><span class="ident" id="5932381">i</span><span class="op" id="5932382">]</span>&nbsp;<span class="op" id="5932384">=</span>&nbsp;<span class="num" id="5932386">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932395">}</span>&nbsp;<span class="keyword" id="5932397">else</span>&nbsp;<span class="op" id="5932402">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5932407">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5932472">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932525">sorted</span>&nbsp;<span class="op" id="5932532">:=</span>&nbsp;<span class="ident" id="5932535">stats</span><span class="op" id="5932540">.</span><span class="ident" id="5932541">Pause</span><span class="op" id="5932546">[</span><span class="ident" id="5932547">n</span>&nbsp;<span class="op" id="5932549">:</span>&nbsp;<span class="ident" id="5932551">n</span><span class="op" id="5932552">+</span><span class="ident" id="5932553">n</span><span class="op" id="5932554">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5932559">copy</span><span class="op" id="5932563">(</span><span class="ident" id="5932564">sorted</span><span class="op" id="5932570">,</span>&nbsp;<span class="ident" id="5932572">stats</span><span class="op" id="5932577">.</span><span class="ident" id="5932578">Pause</span><span class="op" id="5932583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932588">sort</span><span class="op" id="5932592">.</span><span class="ident" id="5932593">Sort</span><span class="op" id="5932597">(</span><span class="ident" id="5932598">byDuration</span><span class="op" id="5932608">(</span><span class="ident" id="5932609">sorted</span><span class="op" id="5932615">)</span><span class="op" id="5932616">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932621">nq</span>&nbsp;<span class="op" id="5932624">:=</span>&nbsp;<span class="builtinfunc" id="5932627">len</span><span class="op" id="5932630">(</span><span class="ident" id="5932631">stats</span><span class="op" id="5932636">.</span><span class="ident" id="5932637">PauseQuantiles</span><span class="op" id="5932651">)</span>&nbsp;<span class="op" id="5932653">-</span>&nbsp;<span class="num" id="5932655">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5932660">for</span>&nbsp;<span class="ident" id="5932664">i</span>&nbsp;<span class="op" id="5932666">:=</span>&nbsp;<span class="num" id="5932669">0</span><span class="op" id="5932670">;</span>&nbsp;<span class="ident" id="5932672">i</span>&nbsp;<span class="op" id="5932674">&lt;</span>&nbsp;<span class="ident" id="5932676">nq</span><span class="op" id="5932678">;</span>&nbsp;<span class="ident" id="5932680">i</span><span class="op" id="5932681">++</span>&nbsp;<span class="op" id="5932684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932690">stats</span><span class="op" id="5932695">.</span><span class="ident" id="5932696">PauseQuantiles</span><span class="op" id="5932710">[</span><span class="ident" id="5932711">i</span><span class="op" id="5932712">]</span>&nbsp;<span class="op" id="5932714">=</span>&nbsp;<span class="ident" id="5932716">sorted</span><span class="op" id="5932722">[</span><span class="builtinfunc" id="5932723">len</span><span class="op" id="5932726">(</span><span class="ident" id="5932727">sorted</span><span class="op" id="5932733">)</span><span class="op" id="5932734">*</span><span class="ident" id="5932735">i</span><span class="op" id="5932736">/</span><span class="ident" id="5932737">nq</span><span class="op" id="5932739">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5932749">stats</span><span class="op" id="5932754">.</span><span class="ident" id="5932755">PauseQuantiles</span><span class="op" id="5932769">[</span><span class="ident" id="5932770">nq</span><span class="op" id="5932772">]</span>&nbsp;<span class="op" id="5932774">=</span>&nbsp;<span class="ident" id="5932776">sorted</span><span class="op" id="5932782">[</span><span class="builtinfunc" id="5932783">len</span><span class="op" id="5932786">(</span><span class="ident" id="5932787">sorted</span><span class="op" id="5932793">)</span><span class="op" id="5932794">-</span><span class="num" id="5932795">1</span><span class="op" id="5932796">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932803">}</span><br>
<span class="lineno"></span><span class="op" id="5932805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5932808">type</span>&nbsp;<span class="ident" id="5932813">byDuration</span>&nbsp;<span class="op" id="5932824">[</span><span class="op" id="5932825">]</span><span class="ident" id="5932826">time</span><span class="op" id="5932830">.</span><span class="ident" id="5932831">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5932841">func</span>&nbsp;<span class="op" id="5932846">(</span><span class="ident" id="5932847">x</span>&nbsp;<span class="ident" id="5932849">byDuration</span><span class="op" id="5932859">)</span>&nbsp;<span class="ident" id="5932861">Len</span><span class="op" id="5932864">(</span><span class="op" id="5932865">)</span>&nbsp;<span class="builtintype" id="5932867">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932881">{</span>&nbsp;<span class="keyword" id="5932883">return</span>&nbsp;<span class="builtinfunc" id="5932890">len</span><span class="op" id="5932893">(</span><span class="ident" id="5932894">x</span><span class="op" id="5932895">)</span>&nbsp;<span class="op" id="5932897">}</span><br>
<span class="lineno"></span><span class="keyword" id="5932899">func</span>&nbsp;<span class="op" id="5932904">(</span><span class="ident" id="5932905">x</span>&nbsp;<span class="ident" id="5932907">byDuration</span><span class="op" id="5932917">)</span>&nbsp;<span class="ident" id="5932919">Swap</span><span class="op" id="5932923">(</span><span class="ident" id="5932924">i</span><span class="op" id="5932925">,</span>&nbsp;<span class="ident" id="5932927">j</span>&nbsp;<span class="builtintype" id="5932929">int</span><span class="op" id="5932932">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5932939">{</span>&nbsp;<span class="ident" id="5932941">x</span><span class="op" id="5932942">[</span><span class="ident" id="5932943">i</span><span class="op" id="5932944">]</span><span class="op" id="5932945">,</span>&nbsp;<span class="ident" id="5932947">x</span><span class="op" id="5932948">[</span><span class="ident" id="5932949">j</span><span class="op" id="5932950">]</span>&nbsp;<span class="op" id="5932952">=</span>&nbsp;<span class="ident" id="5932954">x</span><span class="op" id="5932955">[</span><span class="ident" id="5932956">j</span><span class="op" id="5932957">]</span><span class="op" id="5932958">,</span>&nbsp;<span class="ident" id="5932960">x</span><span class="op" id="5932961">[</span><span class="ident" id="5932962">i</span><span class="op" id="5932963">]</span>&nbsp;<span class="op" id="5932965">}</span><br>
<span class="lineno"></span><span class="keyword" id="5932967">func</span>&nbsp;<span class="op" id="5932972">(</span><span class="ident" id="5932973">x</span>&nbsp;<span class="ident" id="5932975">byDuration</span><span class="op" id="5932985">)</span>&nbsp;<span class="ident" id="5932987">Less</span><span class="op" id="5932991">(</span><span class="ident" id="5932992">i</span><span class="op" id="5932993">,</span>&nbsp;<span class="ident" id="5932995">j</span>&nbsp;<span class="builtintype" id="5932997">int</span><span class="op" id="5933000">)</span>&nbsp;<span class="builtintype" id="5933002">bool</span>&nbsp;<span class="op" id="5933007">{</span>&nbsp;<span class="keyword" id="5933009">return</span>&nbsp;<span class="ident" id="5933016">x</span><span class="op" id="5933017">[</span><span class="ident" id="5933018">i</span><span class="op" id="5933019">]</span>&nbsp;<span class="op" id="5933021">&lt;</span>&nbsp;<span class="ident" id="5933023">x</span><span class="op" id="5933024">[</span><span class="ident" id="5933025">j</span><span class="op" id="5933026">]</span>&nbsp;<span class="op" id="5933028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5933031">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5933094">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5933164">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5933245">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5933291">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5933360">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5933410">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5933464">func</span>&nbsp;<span class="ident" id="5933469">SetGCPercent</span><span class="op" id="5933481">(</span><span class="ident" id="5933482">percent</span>&nbsp;<span class="builtintype" id="5933490">int</span><span class="op" id="5933493">)</span>&nbsp;<span class="builtintype" id="5933495">int</span>&nbsp;<span class="op" id="5933499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5933502">old</span>&nbsp;<span class="op" id="5933506">:=</span>&nbsp;<span class="ident" id="5933509">setGCPercent</span><span class="op" id="5933521">(</span><span class="builtintype" id="5933522">int32</span><span class="op" id="5933527">(</span><span class="ident" id="5933528">percent</span><span class="op" id="5933535">)</span><span class="op" id="5933536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5933539">runtime</span><span class="op" id="5933546">.</span><span class="ident" id="5933547">GC</span><span class="op" id="5933549">(</span><span class="op" id="5933550">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5933553">return</span>&nbsp;<span class="builtintype" id="5933560">int</span><span class="op" id="5933563">(</span><span class="ident" id="5933564">old</span><span class="op" id="5933567">)</span><br>
<span class="lineno"></span><span class="op" id="5933569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5933572">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5933631">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5933691">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5933758">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5933823">func</span>&nbsp;<span class="ident" id="5933828">FreeOSMemory</span><span class="op" id="5933840">(</span><span class="op" id="5933841">)</span>&nbsp;<span class="op" id="5933843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5933846">freeOSMemory</span><span class="op" id="5933858">(</span><span class="op" id="5933859">)</span><br>
<span class="lineno"></span><span class="op" id="5933861">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5933864">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5933918">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5933962">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5934026">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5934050">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5934095">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5934171">//</span><br>
<span class="lineno"></span><span class="comment" id="5934174">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5934238">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5934308">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5934325">func</span>&nbsp;<span class="ident" id="5934330">SetMaxStack</span><span class="op" id="5934341">(</span><span class="ident" id="5934342">bytes</span>&nbsp;<span class="builtintype" id="5934348">int</span><span class="op" id="5934351">)</span>&nbsp;<span class="builtintype" id="5934353">int</span>&nbsp;<span class="op" id="5934357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5934360">return</span>&nbsp;<span class="ident" id="5934367">setMaxStack</span><span class="op" id="5934378">(</span><span class="ident" id="5934379">bytes</span><span class="op" id="5934384">)</span><br>
<span class="lineno"></span><span class="op" id="5934386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5934389">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5934450">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5934522">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5934557">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5934604">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5934646">//</span><br>
<span class="lineno"></span><span class="comment" id="5934649">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5934726">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5934800">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5934888">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5934961">//</span><br>
<span class="lineno"></span><span class="comment" id="5934964">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5935030">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5935098">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5935169">func</span>&nbsp;<span class="ident" id="5935174">SetMaxThreads</span><span class="op" id="5935187">(</span><span class="ident" id="5935188">threads</span>&nbsp;<span class="builtintype" id="5935196">int</span><span class="op" id="5935199">)</span>&nbsp;<span class="builtintype" id="5935201">int</span>&nbsp;<span class="op" id="5935205">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935208">return</span>&nbsp;<span class="ident" id="5935215">setMaxThreads</span><span class="op" id="5935228">(</span><span class="ident" id="5935229">threads</span><span class="op" id="5935236">)</span><br>
<span class="lineno"></span><span class="op" id="5935238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5935241">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5935314">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5935389">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5935468">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5935536">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5935608">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5935680">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5935735">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5935793">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5935829">func</span>&nbsp;<span class="ident" id="5935834">SetPanicOnFault</span><span class="op" id="5935849">(</span><span class="ident" id="5935850">enabled</span>&nbsp;<span class="builtintype" id="5935858">bool</span><span class="op" id="5935862">)</span>&nbsp;<span class="builtintype" id="5935864">bool</span>&nbsp;<span class="op" id="5935869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5935872">return</span>&nbsp;<span class="ident" id="5935879">setPanicOnFault</span><span class="op" id="5935894">(</span><span class="ident" id="5935895">enabled</span><span class="op" id="5935902">)</span><br>
<span class="lineno"></span><span class="op" id="5935904">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5935907">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5935976">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5936012">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5936084">func</span>&nbsp;<span class="ident" id="5936089">WriteHeapDump</span><span class="op" id="5936102">(</span><span class="ident" id="5936103">fd</span>&nbsp;<span class="builtintype" id="5936106">uintptr</span><span class="op" id="5936113">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
