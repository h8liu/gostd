<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/smtp</h2>
<ul>
<li><a href="/gostd/net/smtp/auth.go.html">auth.go</a></li>
<li><a href="/gostd/net/smtp/example_test.go.html" class="current">example_test.go</a></li>
<li><a href="/gostd/net/smtp/smtp.go.html">smtp.go</a></li>
<li><a href="/gostd/net/smtp/smtp_test.go.html">smtp_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="624030">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="624085">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="624139">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="624190">package</span>&nbsp;<span class="ident" id="624198">smtp_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="624209">import</span>&nbsp;<span class="op" id="624216">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="624219">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="624226">&#34;log&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="624233">&#34;net/smtp&#34;</span><br>
<span class="lineno"></span><span class="op" id="624244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="624247">func</span>&nbsp;<span class="ident" id="624252">Example</span><span class="op" id="624259">(</span><span class="op" id="624260">)</span>&nbsp;<span class="op" id="624262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="624265">//&nbsp;Connect&nbsp;to&nbsp;the&nbsp;remote&nbsp;SMTP&nbsp;server.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624304">c</span><span class="op" id="624305">,</span>&nbsp;<span class="ident" id="624307">err</span>&nbsp;<span class="op" id="624311">:=</span>&nbsp;<span class="ident" id="624314">smtp</span><span class="op" id="624318">.</span><span class="ident" id="624319">Dial</span><span class="op" id="624323">(</span><span class="string" id="624324">&#34;mail.example.com:25&#34;</span><span class="op" id="624345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624348">if</span>&nbsp;<span class="ident" id="624351">err</span>&nbsp;<span class="op" id="624355">!=</span>&nbsp;<span class="builtintype" id="624358">nil</span>&nbsp;<span class="op" id="624362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624366">log</span><span class="op" id="624369">.</span><span class="ident" id="624370">Fatal</span><span class="op" id="624375">(</span><span class="ident" id="624376">err</span><span class="op" id="624379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="624386">//&nbsp;Set&nbsp;the&nbsp;sender&nbsp;and&nbsp;recipient&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624425">if</span>&nbsp;<span class="ident" id="624428">err</span>&nbsp;<span class="op" id="624432">:=</span>&nbsp;<span class="ident" id="624435">c</span><span class="op" id="624436">.</span><span class="ident" id="624437">Mail</span><span class="op" id="624441">(</span><span class="string" id="624442">&#34;sender@example.org&#34;</span><span class="op" id="624462">)</span><span class="op" id="624463">;</span>&nbsp;<span class="ident" id="624465">err</span>&nbsp;<span class="op" id="624469">!=</span>&nbsp;<span class="builtintype" id="624472">nil</span>&nbsp;<span class="op" id="624476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624480">log</span><span class="op" id="624483">.</span><span class="ident" id="624484">Fatal</span><span class="op" id="624489">(</span><span class="ident" id="624490">err</span><span class="op" id="624493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624499">if</span>&nbsp;<span class="ident" id="624502">err</span>&nbsp;<span class="op" id="624506">:=</span>&nbsp;<span class="ident" id="624509">c</span><span class="op" id="624510">.</span><span class="ident" id="624511">Rcpt</span><span class="op" id="624515">(</span><span class="string" id="624516">&#34;recipient@example.net&#34;</span><span class="op" id="624539">)</span><span class="op" id="624540">;</span>&nbsp;<span class="ident" id="624542">err</span>&nbsp;<span class="op" id="624546">!=</span>&nbsp;<span class="builtintype" id="624549">nil</span>&nbsp;<span class="op" id="624553">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624557">log</span><span class="op" id="624560">.</span><span class="ident" id="624561">Fatal</span><span class="op" id="624566">(</span><span class="ident" id="624567">err</span><span class="op" id="624570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="624577">//&nbsp;Send&nbsp;the&nbsp;email&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624602">wc</span><span class="op" id="624604">,</span>&nbsp;<span class="ident" id="624606">err</span>&nbsp;<span class="op" id="624610">:=</span>&nbsp;<span class="ident" id="624613">c</span><span class="op" id="624614">.</span><span class="ident" id="624615">Data</span><span class="op" id="624619">(</span><span class="op" id="624620">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624623">if</span>&nbsp;<span class="ident" id="624626">err</span>&nbsp;<span class="op" id="624630">!=</span>&nbsp;<span class="builtintype" id="624633">nil</span>&nbsp;<span class="op" id="624637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624641">log</span><span class="op" id="624644">.</span><span class="ident" id="624645">Fatal</span><span class="op" id="624650">(</span><span class="ident" id="624651">err</span><span class="op" id="624654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624660">_</span><span class="op" id="624661">,</span>&nbsp;<span class="ident" id="624663">err</span>&nbsp;<span class="op" id="624667">=</span>&nbsp;<span class="ident" id="624669">fmt</span><span class="op" id="624672">.</span><span class="ident" id="624673">Fprintf</span><span class="op" id="624680">(</span><span class="ident" id="624681">wc</span><span class="op" id="624683">,</span>&nbsp;<span class="string" id="624685">&#34;This&nbsp;is&nbsp;the&nbsp;email&nbsp;body&#34;</span><span class="op" id="624709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624712">if</span>&nbsp;<span class="ident" id="624715">err</span>&nbsp;<span class="op" id="624719">!=</span>&nbsp;<span class="builtintype" id="624722">nil</span>&nbsp;<span class="op" id="624726">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624730">log</span><span class="op" id="624733">.</span><span class="ident" id="624734">Fatal</span><span class="op" id="624739">(</span><span class="ident" id="624740">err</span><span class="op" id="624743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624749">err</span>&nbsp;<span class="op" id="624753">=</span>&nbsp;<span class="ident" id="624755">wc</span><span class="op" id="624757">.</span><span class="ident" id="624758">Close</span><span class="op" id="624763">(</span><span class="op" id="624764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624767">if</span>&nbsp;<span class="ident" id="624770">err</span>&nbsp;<span class="op" id="624774">!=</span>&nbsp;<span class="builtintype" id="624777">nil</span>&nbsp;<span class="op" id="624781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624785">log</span><span class="op" id="624788">.</span><span class="ident" id="624789">Fatal</span><span class="op" id="624794">(</span><span class="ident" id="624795">err</span><span class="op" id="624798">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="624805">//&nbsp;Send&nbsp;the&nbsp;QUIT&nbsp;command&nbsp;and&nbsp;close&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624857">err</span>&nbsp;<span class="op" id="624861">=</span>&nbsp;<span class="ident" id="624863">c</span><span class="op" id="624864">.</span><span class="ident" id="624865">Quit</span><span class="op" id="624869">(</span><span class="op" id="624870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="624873">if</span>&nbsp;<span class="ident" id="624876">err</span>&nbsp;<span class="op" id="624880">!=</span>&nbsp;<span class="builtintype" id="624883">nil</span>&nbsp;<span class="op" id="624887">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624891">log</span><span class="op" id="624894">.</span><span class="ident" id="624895">Fatal</span><span class="op" id="624900">(</span><span class="ident" id="624901">err</span><span class="op" id="624904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="624907">}</span><br>
<span class="lineno"></span><span class="op" id="624909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="624912">func</span>&nbsp;<span class="ident" id="624917">ExamplePlainAuth</span><span class="op" id="624933">(</span><span class="op" id="624934">)</span>&nbsp;<span class="op" id="624936">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="624939">//&nbsp;Set&nbsp;up&nbsp;authentication&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="624978">auth</span>&nbsp;<span class="op" id="624983">:=</span>&nbsp;<span class="ident" id="624986">smtp</span><span class="op" id="624990">.</span><span class="ident" id="624991">PlainAuth</span><span class="op" id="625000">(</span><span class="string" id="625001">&#34;&#34;</span><span class="op" id="625003">,</span>&nbsp;<span class="string" id="625005">&#34;user@example.com&#34;</span><span class="op" id="625023">,</span>&nbsp;<span class="string" id="625025">&#34;password&#34;</span><span class="op" id="625035">,</span>&nbsp;<span class="string" id="625037">&#34;mail.example.com&#34;</span><span class="op" id="625055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="625059">//&nbsp;Connect&nbsp;to&nbsp;the&nbsp;server,&nbsp;authenticate,&nbsp;set&nbsp;the&nbsp;sender&nbsp;and&nbsp;recipient,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="625130">//&nbsp;and&nbsp;send&nbsp;the&nbsp;email&nbsp;all&nbsp;in&nbsp;one&nbsp;step.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="625170">to</span>&nbsp;<span class="op" id="625173">:=</span>&nbsp;<span class="op" id="625176">[</span><span class="op" id="625177">]</span><span class="builtintype" id="625178">string</span><span class="op" id="625184">{</span><span class="string" id="625185">&#34;recipient@example.net&#34;</span><span class="op" id="625208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="625211">msg</span>&nbsp;<span class="op" id="625215">:=</span>&nbsp;<span class="op" id="625218">[</span><span class="op" id="625219">]</span><span class="builtintype" id="625220">byte</span><span class="op" id="625224">(</span><span class="string" id="625225">&#34;This&nbsp;is&nbsp;the&nbsp;email&nbsp;body.&#34;</span><span class="op" id="625250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="625253">err</span>&nbsp;<span class="op" id="625257">:=</span>&nbsp;<span class="ident" id="625260">smtp</span><span class="op" id="625264">.</span><span class="ident" id="625265">SendMail</span><span class="op" id="625273">(</span><span class="string" id="625274">&#34;mail.example.com:25&#34;</span><span class="op" id="625295">,</span>&nbsp;<span class="ident" id="625297">auth</span><span class="op" id="625301">,</span>&nbsp;<span class="string" id="625303">&#34;sender@example.org&#34;</span><span class="op" id="625323">,</span>&nbsp;<span class="ident" id="625325">to</span><span class="op" id="625327">,</span>&nbsp;<span class="ident" id="625329">msg</span><span class="op" id="625332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="625335">if</span>&nbsp;<span class="ident" id="625338">err</span>&nbsp;<span class="op" id="625342">!=</span>&nbsp;<span class="builtintype" id="625345">nil</span>&nbsp;<span class="op" id="625349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="625353">log</span><span class="op" id="625356">.</span><span class="ident" id="625357">Fatal</span><span class="op" id="625362">(</span><span class="ident" id="625363">err</span><span class="op" id="625366">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="625369">}</span><br>
<span class="lineno"></span><span class="op" id="625371">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
