<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7898846">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7898901">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7898955">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7899006">package</span>&nbsp;<span class="ident" id="7899014">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7899021">import</span>&nbsp;<span class="op" id="7899028">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899031">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899040">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899058">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899077">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899092">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899107">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899124">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899141">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899157">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899165">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899171">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899183">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899189">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7899200">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7899210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7899213">func</span>&nbsp;<span class="ident" id="7899218">testKeyGeneration</span><span class="op" id="7899235">(</span><span class="ident" id="7899236">t</span>&nbsp;<span class="op" id="7899238">*</span><span class="ident" id="7899239">testing</span><span class="op" id="7899246">.</span><span class="ident" id="7899247">T</span><span class="op" id="7899248">,</span>&nbsp;<span class="ident" id="7899250">c</span>&nbsp;<span class="ident" id="7899252">elliptic</span><span class="op" id="7899260">.</span><span class="ident" id="7899261">Curve</span><span class="op" id="7899266">,</span>&nbsp;<span class="ident" id="7899268">tag</span>&nbsp;<span class="builtintype" id="7899272">string</span><span class="op" id="7899278">)</span>&nbsp;<span class="op" id="7899280">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899283">priv</span><span class="op" id="7899287">,</span>&nbsp;<span class="ident" id="7899289">err</span>&nbsp;<span class="op" id="7899293">:=</span>&nbsp;<span class="ident" id="7899296">GenerateKey</span><span class="op" id="7899307">(</span><span class="ident" id="7899308">c</span><span class="op" id="7899309">,</span>&nbsp;<span class="ident" id="7899311">rand</span><span class="op" id="7899315">.</span><span class="ident" id="7899316">Reader</span><span class="op" id="7899322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7899325">if</span>&nbsp;<span class="ident" id="7899328">err</span>&nbsp;<span class="op" id="7899332">!=</span>&nbsp;<span class="ident" id="7899335">nil</span>&nbsp;<span class="op" id="7899339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899343">t</span><span class="op" id="7899344">.</span><span class="ident" id="7899345">Errorf</span><span class="op" id="7899351">(</span><span class="string" id="7899352">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7899367">,</span>&nbsp;<span class="ident" id="7899369">tag</span><span class="op" id="7899372">,</span>&nbsp;<span class="ident" id="7899374">err</span><span class="op" id="7899377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7899381">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7899389">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7899392">if</span>&nbsp;<span class="op" id="7899395">!</span><span class="ident" id="7899396">c</span><span class="op" id="7899397">.</span><span class="ident" id="7899398">IsOnCurve</span><span class="op" id="7899407">(</span><span class="ident" id="7899408">priv</span><span class="op" id="7899412">.</span><span class="ident" id="7899413">PublicKey</span><span class="op" id="7899422">.</span><span class="ident" id="7899423">X</span><span class="op" id="7899424">,</span>&nbsp;<span class="ident" id="7899426">priv</span><span class="op" id="7899430">.</span><span class="ident" id="7899431">PublicKey</span><span class="op" id="7899440">.</span><span class="ident" id="7899441">Y</span><span class="op" id="7899442">)</span>&nbsp;<span class="op" id="7899444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899448">t</span><span class="op" id="7899449">.</span><span class="ident" id="7899450">Errorf</span><span class="op" id="7899456">(</span><span class="string" id="7899457">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7899485">,</span>&nbsp;<span class="ident" id="7899487">tag</span><span class="op" id="7899490">,</span>&nbsp;<span class="ident" id="7899492">err</span><span class="op" id="7899495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7899498">}</span><br>
<span class="lineno"></span><span class="op" id="7899500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7899503">func</span>&nbsp;<span class="ident" id="7899508">TestKeyGeneration</span><span class="op" id="7899525">(</span><span class="ident" id="7899526">t</span>&nbsp;<span class="op" id="7899528">*</span><span class="ident" id="7899529">testing</span><span class="op" id="7899536">.</span><span class="ident" id="7899537">T</span><span class="op" id="7899538">)</span>&nbsp;<span class="op" id="7899540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899543">testKeyGeneration</span><span class="op" id="7899560">(</span><span class="ident" id="7899561">t</span><span class="op" id="7899562">,</span>&nbsp;<span class="ident" id="7899564">elliptic</span><span class="op" id="7899572">.</span><span class="ident" id="7899573">P224</span><span class="op" id="7899577">(</span><span class="op" id="7899578">)</span><span class="op" id="7899579">,</span>&nbsp;<span class="string" id="7899581">&#34;p224&#34;</span><span class="op" id="7899587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7899590">if</span>&nbsp;<span class="ident" id="7899593">testing</span><span class="op" id="7899600">.</span><span class="ident" id="7899601">Short</span><span class="op" id="7899606">(</span><span class="op" id="7899607">)</span>&nbsp;<span class="op" id="7899609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7899613">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7899621">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899624">testKeyGeneration</span><span class="op" id="7899641">(</span><span class="ident" id="7899642">t</span><span class="op" id="7899643">,</span>&nbsp;<span class="ident" id="7899645">elliptic</span><span class="op" id="7899653">.</span><span class="ident" id="7899654">P256</span><span class="op" id="7899658">(</span><span class="op" id="7899659">)</span><span class="op" id="7899660">,</span>&nbsp;<span class="string" id="7899662">&#34;p256&#34;</span><span class="op" id="7899668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899671">testKeyGeneration</span><span class="op" id="7899688">(</span><span class="ident" id="7899689">t</span><span class="op" id="7899690">,</span>&nbsp;<span class="ident" id="7899692">elliptic</span><span class="op" id="7899700">.</span><span class="ident" id="7899701">P384</span><span class="op" id="7899705">(</span><span class="op" id="7899706">)</span><span class="op" id="7899707">,</span>&nbsp;<span class="string" id="7899709">&#34;p384&#34;</span><span class="op" id="7899715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899718">testKeyGeneration</span><span class="op" id="7899735">(</span><span class="ident" id="7899736">t</span><span class="op" id="7899737">,</span>&nbsp;<span class="ident" id="7899739">elliptic</span><span class="op" id="7899747">.</span><span class="ident" id="7899748">P521</span><span class="op" id="7899752">(</span><span class="op" id="7899753">)</span><span class="op" id="7899754">,</span>&nbsp;<span class="string" id="7899756">&#34;p521&#34;</span><span class="op" id="7899762">)</span><br>
<span class="lineno"></span><span class="op" id="7899764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7899767">func</span>&nbsp;<span class="ident" id="7899772">testSignAndVerify</span><span class="op" id="7899789">(</span><span class="ident" id="7899790">t</span>&nbsp;<span class="op" id="7899792">*</span><span class="ident" id="7899793">testing</span><span class="op" id="7899800">.</span><span class="ident" id="7899801">T</span><span class="op" id="7899802">,</span>&nbsp;<span class="ident" id="7899804">c</span>&nbsp;<span class="ident" id="7899806">elliptic</span><span class="op" id="7899814">.</span><span class="ident" id="7899815">Curve</span><span class="op" id="7899820">,</span>&nbsp;<span class="ident" id="7899822">tag</span>&nbsp;<span class="builtintype" id="7899826">string</span><span class="op" id="7899832">)</span>&nbsp;<span class="op" id="7899834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899837">priv</span><span class="op" id="7899841">,</span>&nbsp;<span class="ident" id="7899843">_</span>&nbsp;<span class="op" id="7899845">:=</span>&nbsp;<span class="ident" id="7899848">GenerateKey</span><span class="op" id="7899859">(</span><span class="ident" id="7899860">c</span><span class="op" id="7899861">,</span>&nbsp;<span class="ident" id="7899863">rand</span><span class="op" id="7899867">.</span><span class="ident" id="7899868">Reader</span><span class="op" id="7899874">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899878">hashed</span>&nbsp;<span class="op" id="7899885">:=</span>&nbsp;<span class="op" id="7899888">[</span><span class="op" id="7899889">]</span><span class="builtintype" id="7899890">byte</span><span class="op" id="7899894">(</span><span class="string" id="7899895">&#34;testing&#34;</span><span class="op" id="7899904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899907">r</span><span class="op" id="7899908">,</span>&nbsp;<span class="ident" id="7899910">s</span><span class="op" id="7899911">,</span>&nbsp;<span class="ident" id="7899913">err</span>&nbsp;<span class="op" id="7899917">:=</span>&nbsp;<span class="ident" id="7899920">Sign</span><span class="op" id="7899924">(</span><span class="ident" id="7899925">rand</span><span class="op" id="7899929">.</span><span class="ident" id="7899930">Reader</span><span class="op" id="7899936">,</span>&nbsp;<span class="ident" id="7899938">priv</span><span class="op" id="7899942">,</span>&nbsp;<span class="ident" id="7899944">hashed</span><span class="op" id="7899950">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7899953">if</span>&nbsp;<span class="ident" id="7899956">err</span>&nbsp;<span class="op" id="7899960">!=</span>&nbsp;<span class="ident" id="7899963">nil</span>&nbsp;<span class="op" id="7899967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7899971">t</span><span class="op" id="7899972">.</span><span class="ident" id="7899973">Errorf</span><span class="op" id="7899979">(</span><span class="string" id="7899980">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7900003">,</span>&nbsp;<span class="ident" id="7900005">tag</span><span class="op" id="7900008">,</span>&nbsp;<span class="ident" id="7900010">err</span><span class="op" id="7900013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900017">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7900025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900029">if</span>&nbsp;<span class="op" id="7900032">!</span><span class="ident" id="7900033">Verify</span><span class="op" id="7900039">(</span><span class="op" id="7900040">&amp;</span><span class="ident" id="7900041">priv</span><span class="op" id="7900045">.</span><span class="ident" id="7900046">PublicKey</span><span class="op" id="7900055">,</span>&nbsp;<span class="ident" id="7900057">hashed</span><span class="op" id="7900063">,</span>&nbsp;<span class="ident" id="7900065">r</span><span class="op" id="7900066">,</span>&nbsp;<span class="ident" id="7900068">s</span><span class="op" id="7900069">)</span>&nbsp;<span class="op" id="7900071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900075">t</span><span class="op" id="7900076">.</span><span class="ident" id="7900077">Errorf</span><span class="op" id="7900083">(</span><span class="string" id="7900084">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7900103">,</span>&nbsp;<span class="ident" id="7900105">tag</span><span class="op" id="7900108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7900111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900115">hashed</span><span class="op" id="7900121">[</span><span class="num" id="7900122">0</span><span class="op" id="7900123">]</span>&nbsp;<span class="op" id="7900125">^=</span>&nbsp;<span class="num" id="7900128">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900134">if</span>&nbsp;<span class="ident" id="7900137">Verify</span><span class="op" id="7900143">(</span><span class="op" id="7900144">&amp;</span><span class="ident" id="7900145">priv</span><span class="op" id="7900149">.</span><span class="ident" id="7900150">PublicKey</span><span class="op" id="7900159">,</span>&nbsp;<span class="ident" id="7900161">hashed</span><span class="op" id="7900167">,</span>&nbsp;<span class="ident" id="7900169">r</span><span class="op" id="7900170">,</span>&nbsp;<span class="ident" id="7900172">s</span><span class="op" id="7900173">)</span>&nbsp;<span class="op" id="7900175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900179">t</span><span class="op" id="7900180">.</span><span class="ident" id="7900181">Errorf</span><span class="op" id="7900187">(</span><span class="string" id="7900188">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7900214">,</span>&nbsp;<span class="ident" id="7900216">tag</span><span class="op" id="7900219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7900222">}</span><br>
<span class="lineno"></span><span class="op" id="7900224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7900227">func</span>&nbsp;<span class="ident" id="7900232">TestSignAndVerify</span><span class="op" id="7900249">(</span><span class="ident" id="7900250">t</span>&nbsp;<span class="op" id="7900252">*</span><span class="ident" id="7900253">testing</span><span class="op" id="7900260">.</span><span class="ident" id="7900261">T</span><span class="op" id="7900262">)</span>&nbsp;<span class="op" id="7900264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900267">testSignAndVerify</span><span class="op" id="7900284">(</span><span class="ident" id="7900285">t</span><span class="op" id="7900286">,</span>&nbsp;<span class="ident" id="7900288">elliptic</span><span class="op" id="7900296">.</span><span class="ident" id="7900297">P224</span><span class="op" id="7900301">(</span><span class="op" id="7900302">)</span><span class="op" id="7900303">,</span>&nbsp;<span class="string" id="7900305">&#34;p224&#34;</span><span class="op" id="7900311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900314">if</span>&nbsp;<span class="ident" id="7900317">testing</span><span class="op" id="7900324">.</span><span class="ident" id="7900325">Short</span><span class="op" id="7900330">(</span><span class="op" id="7900331">)</span>&nbsp;<span class="op" id="7900333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900337">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7900345">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900348">testSignAndVerify</span><span class="op" id="7900365">(</span><span class="ident" id="7900366">t</span><span class="op" id="7900367">,</span>&nbsp;<span class="ident" id="7900369">elliptic</span><span class="op" id="7900377">.</span><span class="ident" id="7900378">P256</span><span class="op" id="7900382">(</span><span class="op" id="7900383">)</span><span class="op" id="7900384">,</span>&nbsp;<span class="string" id="7900386">&#34;p256&#34;</span><span class="op" id="7900392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900395">testSignAndVerify</span><span class="op" id="7900412">(</span><span class="ident" id="7900413">t</span><span class="op" id="7900414">,</span>&nbsp;<span class="ident" id="7900416">elliptic</span><span class="op" id="7900424">.</span><span class="ident" id="7900425">P384</span><span class="op" id="7900429">(</span><span class="op" id="7900430">)</span><span class="op" id="7900431">,</span>&nbsp;<span class="string" id="7900433">&#34;p384&#34;</span><span class="op" id="7900439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900442">testSignAndVerify</span><span class="op" id="7900459">(</span><span class="ident" id="7900460">t</span><span class="op" id="7900461">,</span>&nbsp;<span class="ident" id="7900463">elliptic</span><span class="op" id="7900471">.</span><span class="ident" id="7900472">P521</span><span class="op" id="7900476">(</span><span class="op" id="7900477">)</span><span class="op" id="7900478">,</span>&nbsp;<span class="string" id="7900480">&#34;p521&#34;</span><span class="op" id="7900486">)</span><br>
<span class="lineno"></span><span class="op" id="7900488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7900491">func</span>&nbsp;<span class="ident" id="7900496">fromHex</span><span class="op" id="7900503">(</span><span class="ident" id="7900504">s</span>&nbsp;<span class="builtintype" id="7900506">string</span><span class="op" id="7900512">)</span>&nbsp;<span class="op" id="7900514">*</span><span class="ident" id="7900515">big</span><span class="op" id="7900518">.</span><span class="ident" id="7900519">Int</span>&nbsp;<span class="op" id="7900523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900526">r</span><span class="op" id="7900527">,</span>&nbsp;<span class="ident" id="7900529">ok</span>&nbsp;<span class="op" id="7900532">:=</span>&nbsp;<span class="builtinfunc" id="7900535">new</span><span class="op" id="7900538">(</span><span class="ident" id="7900539">big</span><span class="op" id="7900542">.</span><span class="ident" id="7900543">Int</span><span class="op" id="7900546">)</span><span class="op" id="7900547">.</span><span class="ident" id="7900548">SetString</span><span class="op" id="7900557">(</span><span class="ident" id="7900558">s</span><span class="op" id="7900559">,</span>&nbsp;<span class="num" id="7900561">16</span><span class="op" id="7900563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900566">if</span>&nbsp;<span class="op" id="7900569">!</span><span class="ident" id="7900570">ok</span>&nbsp;<span class="op" id="7900573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7900577">panic</span><span class="op" id="7900582">(</span><span class="string" id="7900583">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7900592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7900595">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900598">return</span>&nbsp;<span class="ident" id="7900605">r</span><br>
<span class="lineno"></span><span class="op" id="7900607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7900610">func</span>&nbsp;<span class="ident" id="7900615">TestVectors</span><span class="op" id="7900626">(</span><span class="ident" id="7900627">t</span>&nbsp;<span class="op" id="7900629">*</span><span class="ident" id="7900630">testing</span><span class="op" id="7900637">.</span><span class="ident" id="7900638">T</span><span class="op" id="7900639">)</span>&nbsp;<span class="op" id="7900641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7900644">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7900702">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7900783">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7900787">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7900854">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900907">if</span>&nbsp;<span class="ident" id="7900910">testing</span><span class="op" id="7900917">.</span><span class="ident" id="7900918">Short</span><span class="op" id="7900923">(</span><span class="op" id="7900924">)</span>&nbsp;<span class="op" id="7900926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900930">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7900938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7900942">f</span><span class="op" id="7900943">,</span>&nbsp;<span class="ident" id="7900945">err</span>&nbsp;<span class="op" id="7900949">:=</span>&nbsp;<span class="ident" id="7900952">os</span><span class="op" id="7900954">.</span><span class="ident" id="7900955">Open</span><span class="op" id="7900959">(</span><span class="string" id="7900960">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7900985">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7900988">if</span>&nbsp;<span class="ident" id="7900991">err</span>&nbsp;<span class="op" id="7900995">!=</span>&nbsp;<span class="ident" id="7900998">nil</span>&nbsp;<span class="op" id="7901002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901006">t</span><span class="op" id="7901007">.</span><span class="ident" id="7901008">Fatal</span><span class="op" id="7901013">(</span><span class="ident" id="7901014">err</span><span class="op" id="7901017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7901020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901024">buf</span>&nbsp;<span class="op" id="7901028">:=</span>&nbsp;<span class="ident" id="7901031">bufio</span><span class="op" id="7901036">.</span><span class="ident" id="7901037">NewReader</span><span class="op" id="7901046">(</span><span class="ident" id="7901047">bzip2</span><span class="op" id="7901052">.</span><span class="ident" id="7901053">NewReader</span><span class="op" id="7901062">(</span><span class="ident" id="7901063">f</span><span class="op" id="7901064">)</span><span class="op" id="7901065">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901069">lineNo</span>&nbsp;<span class="op" id="7901076">:=</span>&nbsp;<span class="num" id="7901079">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901082">var</span>&nbsp;<span class="ident" id="7901086">h</span>&nbsp;<span class="ident" id="7901088">hash</span><span class="op" id="7901092">.</span><span class="ident" id="7901093">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901099">var</span>&nbsp;<span class="ident" id="7901103">msg</span>&nbsp;<span class="op" id="7901107">[</span><span class="op" id="7901108">]</span><span class="builtintype" id="7901109">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901115">var</span>&nbsp;<span class="ident" id="7901119">hashed</span>&nbsp;<span class="op" id="7901126">[</span><span class="op" id="7901127">]</span><span class="builtintype" id="7901128">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901134">var</span>&nbsp;<span class="ident" id="7901138">r</span><span class="op" id="7901139">,</span>&nbsp;<span class="ident" id="7901141">s</span>&nbsp;<span class="op" id="7901143">*</span><span class="ident" id="7901144">big</span><span class="op" id="7901147">.</span><span class="ident" id="7901148">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901153">pub</span>&nbsp;<span class="op" id="7901157">:=</span>&nbsp;<span class="builtinfunc" id="7901160">new</span><span class="op" id="7901163">(</span><span class="ident" id="7901164">PublicKey</span><span class="op" id="7901173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901177">for</span>&nbsp;<span class="op" id="7901181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901185">line</span><span class="op" id="7901189">,</span>&nbsp;<span class="ident" id="7901191">err</span>&nbsp;<span class="op" id="7901195">:=</span>&nbsp;<span class="ident" id="7901198">buf</span><span class="op" id="7901201">.</span><span class="ident" id="7901202">ReadString</span><span class="op" id="7901212">(</span><span class="string" id="7901213">&#39;\n&#39;</span><span class="op" id="7901217">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901221">if</span>&nbsp;<span class="builtinfunc" id="7901224">len</span><span class="op" id="7901227">(</span><span class="ident" id="7901228">line</span><span class="op" id="7901232">)</span>&nbsp;<span class="op" id="7901234">==</span>&nbsp;<span class="num" id="7901237">0</span>&nbsp;<span class="op" id="7901239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901244">if</span>&nbsp;<span class="ident" id="7901247">err</span>&nbsp;<span class="op" id="7901251">==</span>&nbsp;<span class="ident" id="7901254">io</span><span class="op" id="7901256">.</span><span class="ident" id="7901257">EOF</span>&nbsp;<span class="op" id="7901261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901267">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7901276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901281">t</span><span class="op" id="7901282">.</span><span class="ident" id="7901283">Fatalf</span><span class="op" id="7901289">(</span><span class="string" id="7901290">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7901320">,</span>&nbsp;<span class="ident" id="7901322">err</span><span class="op" id="7901325">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7901329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901333">lineNo</span><span class="op" id="7901339">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7901344">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901395">if</span>&nbsp;<span class="op" id="7901398">!</span><span class="ident" id="7901399">strings</span><span class="op" id="7901406">.</span><span class="ident" id="7901407">HasSuffix</span><span class="op" id="7901416">(</span><span class="ident" id="7901417">line</span><span class="op" id="7901421">,</span>&nbsp;<span class="string" id="7901423">&#34;\r\n&#34;</span><span class="op" id="7901429">)</span>&nbsp;<span class="op" id="7901431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901436">t</span><span class="op" id="7901437">.</span><span class="ident" id="7901438">Fatalf</span><span class="op" id="7901444">(</span><span class="string" id="7901445">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7901491">,</span>&nbsp;<span class="ident" id="7901493">lineNo</span><span class="op" id="7901499">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7901503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901507">line</span>&nbsp;<span class="op" id="7901512">=</span>&nbsp;<span class="ident" id="7901514">line</span><span class="op" id="7901518">[</span><span class="op" id="7901519">:</span><span class="builtinfunc" id="7901520">len</span><span class="op" id="7901523">(</span><span class="ident" id="7901524">line</span><span class="op" id="7901528">)</span><span class="op" id="7901529">-</span><span class="num" id="7901530">2</span><span class="op" id="7901531">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901536">if</span>&nbsp;<span class="builtinfunc" id="7901539">len</span><span class="op" id="7901542">(</span><span class="ident" id="7901543">line</span><span class="op" id="7901547">)</span>&nbsp;<span class="op" id="7901549">==</span>&nbsp;<span class="num" id="7901552">0</span>&nbsp;<span class="op" id="7901554">||</span>&nbsp;<span class="ident" id="7901557">line</span><span class="op" id="7901561">[</span><span class="num" id="7901562">0</span><span class="op" id="7901563">]</span>&nbsp;<span class="op" id="7901565">==</span>&nbsp;<span class="string" id="7901568">&#39;#&#39;</span>&nbsp;<span class="op" id="7901572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901577">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7901588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901593">if</span>&nbsp;<span class="ident" id="7901596">line</span><span class="op" id="7901600">[</span><span class="num" id="7901601">0</span><span class="op" id="7901602">]</span>&nbsp;<span class="op" id="7901604">==</span>&nbsp;<span class="string" id="7901607">&#39;[&#39;</span>&nbsp;<span class="op" id="7901611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901616">line</span>&nbsp;<span class="op" id="7901621">=</span>&nbsp;<span class="ident" id="7901623">line</span><span class="op" id="7901627">[</span><span class="num" id="7901628">1</span>&nbsp;<span class="op" id="7901630">:</span>&nbsp;<span class="builtinfunc" id="7901632">len</span><span class="op" id="7901635">(</span><span class="ident" id="7901636">line</span><span class="op" id="7901640">)</span><span class="op" id="7901641">-</span><span class="num" id="7901642">1</span><span class="op" id="7901643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901648">parts</span>&nbsp;<span class="op" id="7901654">:=</span>&nbsp;<span class="ident" id="7901657">strings</span><span class="op" id="7901664">.</span><span class="ident" id="7901665">SplitN</span><span class="op" id="7901671">(</span><span class="ident" id="7901672">line</span><span class="op" id="7901676">,</span>&nbsp;<span class="string" id="7901678">&#34;,&#34;</span><span class="op" id="7901681">,</span>&nbsp;<span class="num" id="7901683">2</span><span class="op" id="7901684">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901690">switch</span>&nbsp;<span class="ident" id="7901697">parts</span><span class="op" id="7901702">[</span><span class="num" id="7901703">0</span><span class="op" id="7901704">]</span>&nbsp;<span class="op" id="7901706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901711">case</span>&nbsp;<span class="string" id="7901716">&#34;P-224&#34;</span><span class="op" id="7901723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901729">pub</span><span class="op" id="7901732">.</span><span class="ident" id="7901733">Curve</span>&nbsp;<span class="op" id="7901739">=</span>&nbsp;<span class="ident" id="7901741">elliptic</span><span class="op" id="7901749">.</span><span class="ident" id="7901750">P224</span><span class="op" id="7901754">(</span><span class="op" id="7901755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901760">case</span>&nbsp;<span class="string" id="7901765">&#34;P-256&#34;</span><span class="op" id="7901772">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901778">pub</span><span class="op" id="7901781">.</span><span class="ident" id="7901782">Curve</span>&nbsp;<span class="op" id="7901788">=</span>&nbsp;<span class="ident" id="7901790">elliptic</span><span class="op" id="7901798">.</span><span class="ident" id="7901799">P256</span><span class="op" id="7901803">(</span><span class="op" id="7901804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901809">case</span>&nbsp;<span class="string" id="7901814">&#34;P-384&#34;</span><span class="op" id="7901821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901827">pub</span><span class="op" id="7901830">.</span><span class="ident" id="7901831">Curve</span>&nbsp;<span class="op" id="7901837">=</span>&nbsp;<span class="ident" id="7901839">elliptic</span><span class="op" id="7901847">.</span><span class="ident" id="7901848">P384</span><span class="op" id="7901852">(</span><span class="op" id="7901853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901858">case</span>&nbsp;<span class="string" id="7901863">&#34;P-521&#34;</span><span class="op" id="7901870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901876">pub</span><span class="op" id="7901879">.</span><span class="ident" id="7901880">Curve</span>&nbsp;<span class="op" id="7901886">=</span>&nbsp;<span class="ident" id="7901888">elliptic</span><span class="op" id="7901896">.</span><span class="ident" id="7901897">P521</span><span class="op" id="7901901">(</span><span class="op" id="7901902">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901907">default</span><span class="op" id="7901914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901920">pub</span><span class="op" id="7901923">.</span><span class="ident" id="7901924">Curve</span>&nbsp;<span class="op" id="7901930">=</span>&nbsp;<span class="ident" id="7901932">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7901939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901945">switch</span>&nbsp;<span class="ident" id="7901952">parts</span><span class="op" id="7901957">[</span><span class="num" id="7901958">1</span><span class="op" id="7901959">]</span>&nbsp;<span class="op" id="7901961">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7901966">case</span>&nbsp;<span class="string" id="7901971">&#34;SHA-1&#34;</span><span class="op" id="7901978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7901984">h</span>&nbsp;<span class="op" id="7901986">=</span>&nbsp;<span class="ident" id="7901988">sha1</span><span class="op" id="7901992">.</span><span class="ident" id="7901993">New</span><span class="op" id="7901996">(</span><span class="op" id="7901997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902002">case</span>&nbsp;<span class="string" id="7902007">&#34;SHA-224&#34;</span><span class="op" id="7902016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902022">h</span>&nbsp;<span class="op" id="7902024">=</span>&nbsp;<span class="ident" id="7902026">sha256</span><span class="op" id="7902032">.</span><span class="ident" id="7902033">New224</span><span class="op" id="7902039">(</span><span class="op" id="7902040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902045">case</span>&nbsp;<span class="string" id="7902050">&#34;SHA-256&#34;</span><span class="op" id="7902059">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902065">h</span>&nbsp;<span class="op" id="7902067">=</span>&nbsp;<span class="ident" id="7902069">sha256</span><span class="op" id="7902075">.</span><span class="ident" id="7902076">New</span><span class="op" id="7902079">(</span><span class="op" id="7902080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902085">case</span>&nbsp;<span class="string" id="7902090">&#34;SHA-384&#34;</span><span class="op" id="7902099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902105">h</span>&nbsp;<span class="op" id="7902107">=</span>&nbsp;<span class="ident" id="7902109">sha512</span><span class="op" id="7902115">.</span><span class="ident" id="7902116">New384</span><span class="op" id="7902122">(</span><span class="op" id="7902123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902128">case</span>&nbsp;<span class="string" id="7902133">&#34;SHA-512&#34;</span><span class="op" id="7902142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902148">h</span>&nbsp;<span class="op" id="7902150">=</span>&nbsp;<span class="ident" id="7902152">sha512</span><span class="op" id="7902158">.</span><span class="ident" id="7902159">New</span><span class="op" id="7902162">(</span><span class="op" id="7902163">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902168">default</span><span class="op" id="7902175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902181">h</span>&nbsp;<span class="op" id="7902183">=</span>&nbsp;<span class="ident" id="7902185">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7902192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902198">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7902209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902214">if</span>&nbsp;<span class="ident" id="7902217">h</span>&nbsp;<span class="op" id="7902219">==</span>&nbsp;<span class="ident" id="7902222">nil</span>&nbsp;<span class="op" id="7902226">||</span>&nbsp;<span class="ident" id="7902229">pub</span><span class="op" id="7902232">.</span><span class="ident" id="7902233">Curve</span>&nbsp;<span class="op" id="7902239">==</span>&nbsp;<span class="ident" id="7902242">nil</span>&nbsp;<span class="op" id="7902246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902251">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7902262">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902267">switch</span>&nbsp;<span class="op" id="7902274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902278">case</span>&nbsp;<span class="ident" id="7902283">strings</span><span class="op" id="7902290">.</span><span class="ident" id="7902291">HasPrefix</span><span class="op" id="7902300">(</span><span class="ident" id="7902301">line</span><span class="op" id="7902305">,</span>&nbsp;<span class="string" id="7902307">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7902315">)</span><span class="op" id="7902316">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902321">if</span>&nbsp;<span class="ident" id="7902324">msg</span><span class="op" id="7902327">,</span>&nbsp;<span class="ident" id="7902329">err</span>&nbsp;<span class="op" id="7902333">=</span>&nbsp;<span class="ident" id="7902335">hex</span><span class="op" id="7902338">.</span><span class="ident" id="7902339">DecodeString</span><span class="op" id="7902351">(</span><span class="ident" id="7902352">line</span><span class="op" id="7902356">[</span><span class="num" id="7902357">6</span><span class="op" id="7902358">:</span><span class="op" id="7902359">]</span><span class="op" id="7902360">)</span><span class="op" id="7902361">;</span>&nbsp;<span class="ident" id="7902363">err</span>&nbsp;<span class="op" id="7902367">!=</span>&nbsp;<span class="ident" id="7902370">nil</span>&nbsp;<span class="op" id="7902374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902380">t</span><span class="op" id="7902381">.</span><span class="ident" id="7902382">Fatalf</span><span class="op" id="7902388">(</span><span class="string" id="7902389">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7902430">,</span>&nbsp;<span class="ident" id="7902432">lineNo</span><span class="op" id="7902438">,</span>&nbsp;<span class="ident" id="7902440">err</span><span class="op" id="7902443">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7902448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902452">case</span>&nbsp;<span class="ident" id="7902457">strings</span><span class="op" id="7902464">.</span><span class="ident" id="7902465">HasPrefix</span><span class="op" id="7902474">(</span><span class="ident" id="7902475">line</span><span class="op" id="7902479">,</span>&nbsp;<span class="string" id="7902481">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7902488">)</span><span class="op" id="7902489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902494">pub</span><span class="op" id="7902497">.</span><span class="ident" id="7902498">X</span>&nbsp;<span class="op" id="7902500">=</span>&nbsp;<span class="ident" id="7902502">fromHex</span><span class="op" id="7902509">(</span><span class="ident" id="7902510">line</span><span class="op" id="7902514">[</span><span class="num" id="7902515">5</span><span class="op" id="7902516">:</span><span class="op" id="7902517">]</span><span class="op" id="7902518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902522">case</span>&nbsp;<span class="ident" id="7902527">strings</span><span class="op" id="7902534">.</span><span class="ident" id="7902535">HasPrefix</span><span class="op" id="7902544">(</span><span class="ident" id="7902545">line</span><span class="op" id="7902549">,</span>&nbsp;<span class="string" id="7902551">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7902558">)</span><span class="op" id="7902559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902564">pub</span><span class="op" id="7902567">.</span><span class="ident" id="7902568">Y</span>&nbsp;<span class="op" id="7902570">=</span>&nbsp;<span class="ident" id="7902572">fromHex</span><span class="op" id="7902579">(</span><span class="ident" id="7902580">line</span><span class="op" id="7902584">[</span><span class="num" id="7902585">5</span><span class="op" id="7902586">:</span><span class="op" id="7902587">]</span><span class="op" id="7902588">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902592">case</span>&nbsp;<span class="ident" id="7902597">strings</span><span class="op" id="7902604">.</span><span class="ident" id="7902605">HasPrefix</span><span class="op" id="7902614">(</span><span class="ident" id="7902615">line</span><span class="op" id="7902619">,</span>&nbsp;<span class="string" id="7902621">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7902627">)</span><span class="op" id="7902628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902633">r</span>&nbsp;<span class="op" id="7902635">=</span>&nbsp;<span class="ident" id="7902637">fromHex</span><span class="op" id="7902644">(</span><span class="ident" id="7902645">line</span><span class="op" id="7902649">[</span><span class="num" id="7902650">4</span><span class="op" id="7902651">:</span><span class="op" id="7902652">]</span><span class="op" id="7902653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902657">case</span>&nbsp;<span class="ident" id="7902662">strings</span><span class="op" id="7902669">.</span><span class="ident" id="7902670">HasPrefix</span><span class="op" id="7902679">(</span><span class="ident" id="7902680">line</span><span class="op" id="7902684">,</span>&nbsp;<span class="string" id="7902686">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7902692">)</span><span class="op" id="7902693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902698">s</span>&nbsp;<span class="op" id="7902700">=</span>&nbsp;<span class="ident" id="7902702">fromHex</span><span class="op" id="7902709">(</span><span class="ident" id="7902710">line</span><span class="op" id="7902714">[</span><span class="num" id="7902715">4</span><span class="op" id="7902716">:</span><span class="op" id="7902717">]</span><span class="op" id="7902718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902722">case</span>&nbsp;<span class="ident" id="7902727">strings</span><span class="op" id="7902734">.</span><span class="ident" id="7902735">HasPrefix</span><span class="op" id="7902744">(</span><span class="ident" id="7902745">line</span><span class="op" id="7902749">,</span>&nbsp;<span class="string" id="7902751">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7902762">)</span><span class="op" id="7902763">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902768">expected</span>&nbsp;<span class="op" id="7902777">:=</span>&nbsp;<span class="ident" id="7902780">line</span><span class="op" id="7902784">[</span><span class="num" id="7902785">9</span><span class="op" id="7902786">]</span>&nbsp;<span class="op" id="7902788">==</span>&nbsp;<span class="string" id="7902791">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902798">h</span><span class="op" id="7902799">.</span><span class="ident" id="7902800">Reset</span><span class="op" id="7902805">(</span><span class="op" id="7902806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902811">h</span><span class="op" id="7902812">.</span><span class="ident" id="7902813">Write</span><span class="op" id="7902818">(</span><span class="ident" id="7902819">msg</span><span class="op" id="7902822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902827">hashed</span>&nbsp;<span class="op" id="7902834">:=</span>&nbsp;<span class="ident" id="7902837">h</span><span class="op" id="7902838">.</span><span class="ident" id="7902839">Sum</span><span class="op" id="7902842">(</span><span class="ident" id="7902843">hashed</span><span class="op" id="7902849">[</span><span class="op" id="7902850">:</span><span class="num" id="7902851">0</span><span class="op" id="7902852">]</span><span class="op" id="7902853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902858">if</span>&nbsp;<span class="ident" id="7902861">Verify</span><span class="op" id="7902867">(</span><span class="ident" id="7902868">pub</span><span class="op" id="7902871">,</span>&nbsp;<span class="ident" id="7902873">hashed</span><span class="op" id="7902879">,</span>&nbsp;<span class="ident" id="7902881">r</span><span class="op" id="7902882">,</span>&nbsp;<span class="ident" id="7902884">s</span><span class="op" id="7902885">)</span>&nbsp;<span class="op" id="7902887">!=</span>&nbsp;<span class="ident" id="7902890">expected</span>&nbsp;<span class="op" id="7902899">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902905">t</span><span class="op" id="7902906">.</span><span class="ident" id="7902907">Fatalf</span><span class="op" id="7902913">(</span><span class="string" id="7902914">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7902943">,</span>&nbsp;<span class="ident" id="7902945">lineNo</span><span class="op" id="7902951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7902956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7902960">default</span><span class="op" id="7902967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7902972">t</span><span class="op" id="7902973">.</span><span class="ident" id="7902974">Fatalf</span><span class="op" id="7902980">(</span><span class="string" id="7902981">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7903014">,</span>&nbsp;<span class="ident" id="7903016">lineNo</span><span class="op" id="7903022">,</span>&nbsp;<span class="ident" id="7903024">line</span><span class="op" id="7903028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7903032">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7903035">}</span><br>
<span class="lineno"></span><span class="op" id="7903037">}</span>
</div>
</body>
</html>
