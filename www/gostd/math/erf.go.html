<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2276526">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2276581">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2276635">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2276686">package</span>&nbsp;<span class="ident" id="2276694">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2276700">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2276772">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2276826">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2276878">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2276933">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2276963">//</span><br>
<span class="lineno"></span><span class="comment" id="2276966">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2277022">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2277091">//</span><br>
<span class="lineno"></span><span class="comment" id="2277094">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2277153">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2277209">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2277266">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2277283">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2277339">//</span><br>
<span class="lineno">25</span><span class="comment" id="2277342">//</span><br>
<span class="lineno"></span><span class="comment" id="2277345">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2277369">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2277394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2277425">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2277457">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2277500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2277531">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2277562">//</span><br>
<span class="lineno"></span><span class="comment" id="2277565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2277592">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2277606">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2277640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2277679">//</span><br>
<span class="lineno"></span><span class="comment" id="2277682">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2277693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2277728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2277764">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2277830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2277896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2277960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2278002">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2278058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2278108">//</span><br>
<span class="lineno"></span><span class="comment" id="2278111">//</span><br>
<span class="lineno">50</span><span class="comment" id="2278114">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2278166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2278240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2278260">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2278327">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2278394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2278462">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2278532">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2278593">//</span><br>
<span class="lineno"></span><span class="comment" id="2278596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2278655">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2278712">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2278767">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2278823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2278879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2278931">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2278998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2279044">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2279093">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2279158">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2279221">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2279281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2279298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2279341">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2279384">//</span><br>
<span class="lineno">75</span><span class="comment" id="2279387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2279433">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2279488">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2279526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2279543">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2279598">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2279641">//</span><br>
<span class="lineno"></span><span class="comment" id="2279644">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2279676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2279740">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2279811">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2279872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2279937">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2279984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2280001">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2280056">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2280099">//</span><br>
<span class="lineno"></span><span class="comment" id="2280102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2280117">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2280179">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2280224">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2280266">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2280305">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2280368">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2280383">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2280441">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2280477">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2280537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2280574">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2280630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2280693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2280748">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2280794">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2280840">//</span><br>
<span class="lineno"></span><span class="comment" id="2280843">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2280872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2280935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2280998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2281040">//</span><br>
<span class="lineno"></span><span class="comment" id="2281043">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2281068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2281128">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2281188">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2281226">const</span>&nbsp;<span class="op" id="2281232">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281235">erx</span>&nbsp;<span class="op" id="2281239">=</span>&nbsp;<span class="num" id="2281241">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2281268">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2281291">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281350">efx</span>&nbsp;&nbsp;<span class="op" id="2281355">=</span>&nbsp;<span class="num" id="2281357">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2281385">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281408">efx8</span>&nbsp;<span class="op" id="2281413">=</span>&nbsp;<span class="num" id="2281415">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2281443">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281466">pp0</span>&nbsp;&nbsp;<span class="op" id="2281471">=</span>&nbsp;<span class="num" id="2281473">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2281501">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281524">pp1</span>&nbsp;&nbsp;<span class="op" id="2281529">=</span>&nbsp;<span class="op" id="2281531">-</span><span class="num" id="2281532">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2281559">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281582">pp2</span>&nbsp;&nbsp;<span class="op" id="2281587">=</span>&nbsp;<span class="op" id="2281589">-</span><span class="num" id="2281590">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2281617">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281640">pp3</span>&nbsp;&nbsp;<span class="op" id="2281645">=</span>&nbsp;<span class="op" id="2281647">-</span><span class="num" id="2281648">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2281675">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281698">pp4</span>&nbsp;&nbsp;<span class="op" id="2281703">=</span>&nbsp;<span class="op" id="2281705">-</span><span class="num" id="2281706">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2281733">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281756">qq1</span>&nbsp;&nbsp;<span class="op" id="2281761">=</span>&nbsp;<span class="num" id="2281763">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2281791">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281814">qq2</span>&nbsp;&nbsp;<span class="op" id="2281819">=</span>&nbsp;<span class="num" id="2281821">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2281849">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281872">qq3</span>&nbsp;&nbsp;<span class="op" id="2281877">=</span>&nbsp;<span class="num" id="2281879">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2281907">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281930">qq4</span>&nbsp;&nbsp;<span class="op" id="2281935">=</span>&nbsp;<span class="num" id="2281937">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2281965">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281988">qq5</span>&nbsp;&nbsp;<span class="op" id="2281993">=</span>&nbsp;<span class="op" id="2281995">-</span><span class="num" id="2281996">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2282023">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2282046">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282109">pa0</span>&nbsp;<span class="op" id="2282113">=</span>&nbsp;<span class="op" id="2282115">-</span><span class="num" id="2282116">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2282143">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282166">pa1</span>&nbsp;<span class="op" id="2282170">=</span>&nbsp;<span class="num" id="2282172">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2282200">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282223">pa2</span>&nbsp;<span class="op" id="2282227">=</span>&nbsp;<span class="op" id="2282229">-</span><span class="num" id="2282230">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2282257">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282280">pa3</span>&nbsp;<span class="op" id="2282284">=</span>&nbsp;<span class="num" id="2282286">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2282314">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282337">pa4</span>&nbsp;<span class="op" id="2282341">=</span>&nbsp;<span class="op" id="2282343">-</span><span class="num" id="2282344">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2282371">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282394">pa5</span>&nbsp;<span class="op" id="2282398">=</span>&nbsp;<span class="num" id="2282400">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2282428">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282451">pa6</span>&nbsp;<span class="op" id="2282455">=</span>&nbsp;<span class="op" id="2282457">-</span><span class="num" id="2282458">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2282485">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282508">qa1</span>&nbsp;<span class="op" id="2282512">=</span>&nbsp;<span class="num" id="2282514">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2282542">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282565">qa2</span>&nbsp;<span class="op" id="2282569">=</span>&nbsp;<span class="num" id="2282571">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2282599">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282622">qa3</span>&nbsp;<span class="op" id="2282626">=</span>&nbsp;<span class="num" id="2282628">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2282656">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282679">qa4</span>&nbsp;<span class="op" id="2282683">=</span>&nbsp;<span class="num" id="2282685">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2282713">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282736">qa5</span>&nbsp;<span class="op" id="2282740">=</span>&nbsp;<span class="num" id="2282742">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2282770">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282793">qa6</span>&nbsp;<span class="op" id="2282797">=</span>&nbsp;<span class="num" id="2282799">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2282827">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2282850">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282912">ra0</span>&nbsp;<span class="op" id="2282916">=</span>&nbsp;<span class="op" id="2282918">-</span><span class="num" id="2282919">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2282946">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282969">ra1</span>&nbsp;<span class="op" id="2282973">=</span>&nbsp;<span class="op" id="2282975">-</span><span class="num" id="2282976">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2283003">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283026">ra2</span>&nbsp;<span class="op" id="2283030">=</span>&nbsp;<span class="op" id="2283032">-</span><span class="num" id="2283033">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2283060">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283083">ra3</span>&nbsp;<span class="op" id="2283087">=</span>&nbsp;<span class="op" id="2283089">-</span><span class="num" id="2283090">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2283117">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283140">ra4</span>&nbsp;<span class="op" id="2283144">=</span>&nbsp;<span class="op" id="2283146">-</span><span class="num" id="2283147">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2283174">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283197">ra5</span>&nbsp;<span class="op" id="2283201">=</span>&nbsp;<span class="op" id="2283203">-</span><span class="num" id="2283204">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2283231">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283254">ra6</span>&nbsp;<span class="op" id="2283258">=</span>&nbsp;<span class="op" id="2283260">-</span><span class="num" id="2283261">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2283288">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283311">ra7</span>&nbsp;<span class="op" id="2283315">=</span>&nbsp;<span class="op" id="2283317">-</span><span class="num" id="2283318">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2283345">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283368">sa1</span>&nbsp;<span class="op" id="2283372">=</span>&nbsp;<span class="num" id="2283374">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2283402">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283425">sa2</span>&nbsp;<span class="op" id="2283429">=</span>&nbsp;<span class="num" id="2283431">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2283459">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283482">sa3</span>&nbsp;<span class="op" id="2283486">=</span>&nbsp;<span class="num" id="2283488">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2283516">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283539">sa4</span>&nbsp;<span class="op" id="2283543">=</span>&nbsp;<span class="num" id="2283545">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2283573">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283596">sa5</span>&nbsp;<span class="op" id="2283600">=</span>&nbsp;<span class="num" id="2283602">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2283630">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283653">sa6</span>&nbsp;<span class="op" id="2283657">=</span>&nbsp;<span class="num" id="2283659">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2283687">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283710">sa7</span>&nbsp;<span class="op" id="2283714">=</span>&nbsp;<span class="num" id="2283716">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2283744">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283767">sa8</span>&nbsp;<span class="op" id="2283771">=</span>&nbsp;<span class="op" id="2283773">-</span><span class="num" id="2283774">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2283801">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2283824">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283883">rb0</span>&nbsp;<span class="op" id="2283887">=</span>&nbsp;<span class="op" id="2283889">-</span><span class="num" id="2283890">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2283917">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283940">rb1</span>&nbsp;<span class="op" id="2283944">=</span>&nbsp;<span class="op" id="2283946">-</span><span class="num" id="2283947">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2283974">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283997">rb2</span>&nbsp;<span class="op" id="2284001">=</span>&nbsp;<span class="op" id="2284003">-</span><span class="num" id="2284004">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2284031">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284054">rb3</span>&nbsp;<span class="op" id="2284058">=</span>&nbsp;<span class="op" id="2284060">-</span><span class="num" id="2284061">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2284088">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284111">rb4</span>&nbsp;<span class="op" id="2284115">=</span>&nbsp;<span class="op" id="2284117">-</span><span class="num" id="2284118">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2284145">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284168">rb5</span>&nbsp;<span class="op" id="2284172">=</span>&nbsp;<span class="op" id="2284174">-</span><span class="num" id="2284175">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2284202">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284225">rb6</span>&nbsp;<span class="op" id="2284229">=</span>&nbsp;<span class="op" id="2284231">-</span><span class="num" id="2284232">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2284259">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284282">sb1</span>&nbsp;<span class="op" id="2284286">=</span>&nbsp;<span class="num" id="2284288">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2284316">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284339">sb2</span>&nbsp;<span class="op" id="2284343">=</span>&nbsp;<span class="num" id="2284345">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2284373">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284396">sb3</span>&nbsp;<span class="op" id="2284400">=</span>&nbsp;<span class="num" id="2284402">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2284430">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284453">sb4</span>&nbsp;<span class="op" id="2284457">=</span>&nbsp;<span class="num" id="2284459">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2284487">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284510">sb5</span>&nbsp;<span class="op" id="2284514">=</span>&nbsp;<span class="num" id="2284516">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2284544">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284567">sb6</span>&nbsp;<span class="op" id="2284571">=</span>&nbsp;<span class="num" id="2284573">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2284601">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284624">sb7</span>&nbsp;<span class="op" id="2284628">=</span>&nbsp;<span class="op" id="2284630">-</span><span class="num" id="2284631">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2284658">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2284680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2284683">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2284723">//</span><br>
<span class="lineno"></span><span class="comment" id="2284726">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2284748">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2284765">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2284783">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2284801">func</span>&nbsp;<span class="ident" id="2284806">Erf</span><span class="op" id="2284809">(</span><span class="ident" id="2284810">x</span>&nbsp;<span class="builtintype" id="2284812">float64</span><span class="op" id="2284819">)</span>&nbsp;<span class="builtintype" id="2284821">float64</span>&nbsp;<span class="op" id="2284829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284832">const</span>&nbsp;<span class="op" id="2284838">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284842">VeryTiny</span>&nbsp;<span class="op" id="2284851">=</span>&nbsp;<span class="num" id="2284853">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2284876">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284900">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2284909">=</span>&nbsp;<span class="num" id="2284911">1.0</span>&nbsp;<span class="op" id="2284915">/</span>&nbsp;<span class="op" id="2284917">(</span><span class="num" id="2284918">1</span>&nbsp;<span class="op" id="2284920">&lt;&lt;</span>&nbsp;<span class="num" id="2284923">28</span><span class="op" id="2284925">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2284934">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2284948">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284966">switch</span>&nbsp;<span class="op" id="2284973">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284976">case</span>&nbsp;<span class="ident" id="2284981">IsNaN</span><span class="op" id="2284986">(</span><span class="ident" id="2284987">x</span><span class="op" id="2284988">)</span><span class="op" id="2284989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284993">return</span>&nbsp;<span class="ident" id="2285000">NaN</span><span class="op" id="2285003">(</span><span class="op" id="2285004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285007">case</span>&nbsp;<span class="ident" id="2285012">IsInf</span><span class="op" id="2285017">(</span><span class="ident" id="2285018">x</span><span class="op" id="2285019">,</span>&nbsp;<span class="num" id="2285021">1</span><span class="op" id="2285022">)</span><span class="op" id="2285023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285027">return</span>&nbsp;<span class="num" id="2285034">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285037">case</span>&nbsp;<span class="ident" id="2285042">IsInf</span><span class="op" id="2285047">(</span><span class="ident" id="2285048">x</span><span class="op" id="2285049">,</span>&nbsp;<span class="op" id="2285051">-</span><span class="num" id="2285052">1</span><span class="op" id="2285053">)</span><span class="op" id="2285054">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285058">return</span>&nbsp;<span class="op" id="2285065">-</span><span class="num" id="2285066">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285072">sign</span>&nbsp;<span class="op" id="2285077">:=</span>&nbsp;<span class="builtintype" id="2285080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285087">if</span>&nbsp;<span class="ident" id="2285090">x</span>&nbsp;<span class="op" id="2285092">&lt;</span>&nbsp;<span class="num" id="2285094">0</span>&nbsp;<span class="op" id="2285096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285100">x</span>&nbsp;<span class="op" id="2285102">=</span>&nbsp;<span class="op" id="2285104">-</span><span class="ident" id="2285105">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285109">sign</span>&nbsp;<span class="op" id="2285114">=</span>&nbsp;<span class="builtintype" id="2285116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285125">if</span>&nbsp;<span class="ident" id="2285128">x</span>&nbsp;<span class="op" id="2285130">&lt;</span>&nbsp;<span class="num" id="2285132">0.84375</span>&nbsp;<span class="op" id="2285140">{</span>&nbsp;<span class="comment" id="2285142">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285161">var</span>&nbsp;<span class="ident" id="2285165">temp</span>&nbsp;<span class="builtintype" id="2285170">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285180">if</span>&nbsp;<span class="ident" id="2285183">x</span>&nbsp;<span class="op" id="2285185">&lt;</span>&nbsp;<span class="ident" id="2285187">Small</span>&nbsp;<span class="op" id="2285193">{</span>&nbsp;<span class="comment" id="2285195">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285214">if</span>&nbsp;<span class="ident" id="2285217">x</span>&nbsp;<span class="op" id="2285219">&lt;</span>&nbsp;<span class="ident" id="2285221">VeryTiny</span>&nbsp;<span class="op" id="2285230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285236">temp</span>&nbsp;<span class="op" id="2285241">=</span>&nbsp;<span class="num" id="2285243">0.125</span>&nbsp;<span class="op" id="2285249">*</span>&nbsp;<span class="op" id="2285251">(</span><span class="num" id="2285252">8.0</span><span class="op" id="2285255">*</span><span class="ident" id="2285256">x</span>&nbsp;<span class="op" id="2285258">+</span>&nbsp;<span class="ident" id="2285260">efx8</span><span class="op" id="2285264">*</span><span class="ident" id="2285265">x</span><span class="op" id="2285266">)</span>&nbsp;<span class="comment" id="2285268">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285290">}</span>&nbsp;<span class="keyword" id="2285292">else</span>&nbsp;<span class="op" id="2285297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285303">temp</span>&nbsp;<span class="op" id="2285308">=</span>&nbsp;<span class="ident" id="2285310">x</span>&nbsp;<span class="op" id="2285312">+</span>&nbsp;<span class="ident" id="2285314">efx</span><span class="op" id="2285317">*</span><span class="ident" id="2285318">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285323">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285327">}</span>&nbsp;<span class="keyword" id="2285329">else</span>&nbsp;<span class="op" id="2285334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285339">z</span>&nbsp;<span class="op" id="2285341">:=</span>&nbsp;<span class="ident" id="2285344">x</span>&nbsp;<span class="op" id="2285346">*</span>&nbsp;<span class="ident" id="2285348">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285353">r</span>&nbsp;<span class="op" id="2285355">:=</span>&nbsp;<span class="ident" id="2285358">pp0</span>&nbsp;<span class="op" id="2285362">+</span>&nbsp;<span class="ident" id="2285364">z</span><span class="op" id="2285365">*</span><span class="op" id="2285366">(</span><span class="ident" id="2285367">pp1</span><span class="op" id="2285370">+</span><span class="ident" id="2285371">z</span><span class="op" id="2285372">*</span><span class="op" id="2285373">(</span><span class="ident" id="2285374">pp2</span><span class="op" id="2285377">+</span><span class="ident" id="2285378">z</span><span class="op" id="2285379">*</span><span class="op" id="2285380">(</span><span class="ident" id="2285381">pp3</span><span class="op" id="2285384">+</span><span class="ident" id="2285385">z</span><span class="op" id="2285386">*</span><span class="ident" id="2285387">pp4</span><span class="op" id="2285390">)</span><span class="op" id="2285391">)</span><span class="op" id="2285392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285397">s</span>&nbsp;<span class="op" id="2285399">:=</span>&nbsp;<span class="num" id="2285402">1</span>&nbsp;<span class="op" id="2285404">+</span>&nbsp;<span class="ident" id="2285406">z</span><span class="op" id="2285407">*</span><span class="op" id="2285408">(</span><span class="ident" id="2285409">qq1</span><span class="op" id="2285412">+</span><span class="ident" id="2285413">z</span><span class="op" id="2285414">*</span><span class="op" id="2285415">(</span><span class="ident" id="2285416">qq2</span><span class="op" id="2285419">+</span><span class="ident" id="2285420">z</span><span class="op" id="2285421">*</span><span class="op" id="2285422">(</span><span class="ident" id="2285423">qq3</span><span class="op" id="2285426">+</span><span class="ident" id="2285427">z</span><span class="op" id="2285428">*</span><span class="op" id="2285429">(</span><span class="ident" id="2285430">qq4</span><span class="op" id="2285433">+</span><span class="ident" id="2285434">z</span><span class="op" id="2285435">*</span><span class="ident" id="2285436">qq5</span><span class="op" id="2285439">)</span><span class="op" id="2285440">)</span><span class="op" id="2285441">)</span><span class="op" id="2285442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285447">y</span>&nbsp;<span class="op" id="2285449">:=</span>&nbsp;<span class="ident" id="2285452">r</span>&nbsp;<span class="op" id="2285454">/</span>&nbsp;<span class="ident" id="2285456">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285461">temp</span>&nbsp;<span class="op" id="2285466">=</span>&nbsp;<span class="ident" id="2285468">x</span>&nbsp;<span class="op" id="2285470">+</span>&nbsp;<span class="ident" id="2285472">x</span><span class="op" id="2285473">*</span><span class="ident" id="2285474">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285482">if</span>&nbsp;<span class="ident" id="2285485">sign</span>&nbsp;<span class="op" id="2285490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285495">return</span>&nbsp;<span class="op" id="2285502">-</span><span class="ident" id="2285503">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285510">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285514">return</span>&nbsp;<span class="ident" id="2285521">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285530">if</span>&nbsp;<span class="ident" id="2285533">x</span>&nbsp;<span class="op" id="2285535">&lt;</span>&nbsp;<span class="num" id="2285537">1.25</span>&nbsp;<span class="op" id="2285542">{</span>&nbsp;<span class="comment" id="2285544">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285571">s</span>&nbsp;<span class="op" id="2285573">:=</span>&nbsp;<span class="ident" id="2285576">x</span>&nbsp;<span class="op" id="2285578">-</span>&nbsp;<span class="num" id="2285580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285584">P</span>&nbsp;<span class="op" id="2285586">:=</span>&nbsp;<span class="ident" id="2285589">pa0</span>&nbsp;<span class="op" id="2285593">+</span>&nbsp;<span class="ident" id="2285595">s</span><span class="op" id="2285596">*</span><span class="op" id="2285597">(</span><span class="ident" id="2285598">pa1</span><span class="op" id="2285601">+</span><span class="ident" id="2285602">s</span><span class="op" id="2285603">*</span><span class="op" id="2285604">(</span><span class="ident" id="2285605">pa2</span><span class="op" id="2285608">+</span><span class="ident" id="2285609">s</span><span class="op" id="2285610">*</span><span class="op" id="2285611">(</span><span class="ident" id="2285612">pa3</span><span class="op" id="2285615">+</span><span class="ident" id="2285616">s</span><span class="op" id="2285617">*</span><span class="op" id="2285618">(</span><span class="ident" id="2285619">pa4</span><span class="op" id="2285622">+</span><span class="ident" id="2285623">s</span><span class="op" id="2285624">*</span><span class="op" id="2285625">(</span><span class="ident" id="2285626">pa5</span><span class="op" id="2285629">+</span><span class="ident" id="2285630">s</span><span class="op" id="2285631">*</span><span class="ident" id="2285632">pa6</span><span class="op" id="2285635">)</span><span class="op" id="2285636">)</span><span class="op" id="2285637">)</span><span class="op" id="2285638">)</span><span class="op" id="2285639">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285643">Q</span>&nbsp;<span class="op" id="2285645">:=</span>&nbsp;<span class="num" id="2285648">1</span>&nbsp;<span class="op" id="2285650">+</span>&nbsp;<span class="ident" id="2285652">s</span><span class="op" id="2285653">*</span><span class="op" id="2285654">(</span><span class="ident" id="2285655">qa1</span><span class="op" id="2285658">+</span><span class="ident" id="2285659">s</span><span class="op" id="2285660">*</span><span class="op" id="2285661">(</span><span class="ident" id="2285662">qa2</span><span class="op" id="2285665">+</span><span class="ident" id="2285666">s</span><span class="op" id="2285667">*</span><span class="op" id="2285668">(</span><span class="ident" id="2285669">qa3</span><span class="op" id="2285672">+</span><span class="ident" id="2285673">s</span><span class="op" id="2285674">*</span><span class="op" id="2285675">(</span><span class="ident" id="2285676">qa4</span><span class="op" id="2285679">+</span><span class="ident" id="2285680">s</span><span class="op" id="2285681">*</span><span class="op" id="2285682">(</span><span class="ident" id="2285683">qa5</span><span class="op" id="2285686">+</span><span class="ident" id="2285687">s</span><span class="op" id="2285688">*</span><span class="ident" id="2285689">qa6</span><span class="op" id="2285692">)</span><span class="op" id="2285693">)</span><span class="op" id="2285694">)</span><span class="op" id="2285695">)</span><span class="op" id="2285696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285700">if</span>&nbsp;<span class="ident" id="2285703">sign</span>&nbsp;<span class="op" id="2285708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285713">return</span>&nbsp;<span class="op" id="2285720">-</span><span class="ident" id="2285721">erx</span>&nbsp;<span class="op" id="2285725">-</span>&nbsp;<span class="ident" id="2285727">P</span><span class="op" id="2285728">/</span><span class="ident" id="2285729">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285737">return</span>&nbsp;<span class="ident" id="2285744">erx</span>&nbsp;<span class="op" id="2285748">+</span>&nbsp;<span class="ident" id="2285750">P</span><span class="op" id="2285751">/</span><span class="ident" id="2285752">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285758">if</span>&nbsp;<span class="ident" id="2285761">x</span>&nbsp;<span class="op" id="2285763">&gt;=</span>&nbsp;<span class="num" id="2285766">6</span>&nbsp;<span class="op" id="2285768">{</span>&nbsp;<span class="comment" id="2285770">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285790">if</span>&nbsp;<span class="ident" id="2285793">sign</span>&nbsp;<span class="op" id="2285798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285803">return</span>&nbsp;<span class="op" id="2285810">-</span><span class="num" id="2285811">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285815">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285819">return</span>&nbsp;<span class="num" id="2285826">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285832">s</span>&nbsp;<span class="op" id="2285834">:=</span>&nbsp;<span class="num" id="2285837">1</span>&nbsp;<span class="op" id="2285839">/</span>&nbsp;<span class="op" id="2285841">(</span><span class="ident" id="2285842">x</span>&nbsp;<span class="op" id="2285844">*</span>&nbsp;<span class="ident" id="2285846">x</span><span class="op" id="2285847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285850">var</span>&nbsp;<span class="ident" id="2285854">R</span><span class="op" id="2285855">,</span>&nbsp;<span class="ident" id="2285857">S</span>&nbsp;<span class="builtintype" id="2285859">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285868">if</span>&nbsp;<span class="ident" id="2285871">x</span>&nbsp;<span class="op" id="2285873">&lt;</span>&nbsp;<span class="num" id="2285875">1</span><span class="op" id="2285876">/</span><span class="num" id="2285877">0.35</span>&nbsp;<span class="op" id="2285882">{</span>&nbsp;<span class="comment" id="2285884">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285916">R</span>&nbsp;<span class="op" id="2285918">=</span>&nbsp;<span class="ident" id="2285920">ra0</span>&nbsp;<span class="op" id="2285924">+</span>&nbsp;<span class="ident" id="2285926">s</span><span class="op" id="2285927">*</span><span class="op" id="2285928">(</span><span class="ident" id="2285929">ra1</span><span class="op" id="2285932">+</span><span class="ident" id="2285933">s</span><span class="op" id="2285934">*</span><span class="op" id="2285935">(</span><span class="ident" id="2285936">ra2</span><span class="op" id="2285939">+</span><span class="ident" id="2285940">s</span><span class="op" id="2285941">*</span><span class="op" id="2285942">(</span><span class="ident" id="2285943">ra3</span><span class="op" id="2285946">+</span><span class="ident" id="2285947">s</span><span class="op" id="2285948">*</span><span class="op" id="2285949">(</span><span class="ident" id="2285950">ra4</span><span class="op" id="2285953">+</span><span class="ident" id="2285954">s</span><span class="op" id="2285955">*</span><span class="op" id="2285956">(</span><span class="ident" id="2285957">ra5</span><span class="op" id="2285960">+</span><span class="ident" id="2285961">s</span><span class="op" id="2285962">*</span><span class="op" id="2285963">(</span><span class="ident" id="2285964">ra6</span><span class="op" id="2285967">+</span><span class="ident" id="2285968">s</span><span class="op" id="2285969">*</span><span class="ident" id="2285970">ra7</span><span class="op" id="2285973">)</span><span class="op" id="2285974">)</span><span class="op" id="2285975">)</span><span class="op" id="2285976">)</span><span class="op" id="2285977">)</span><span class="op" id="2285978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285982">S</span>&nbsp;<span class="op" id="2285984">=</span>&nbsp;<span class="num" id="2285986">1</span>&nbsp;<span class="op" id="2285988">+</span>&nbsp;<span class="ident" id="2285990">s</span><span class="op" id="2285991">*</span><span class="op" id="2285992">(</span><span class="ident" id="2285993">sa1</span><span class="op" id="2285996">+</span><span class="ident" id="2285997">s</span><span class="op" id="2285998">*</span><span class="op" id="2285999">(</span><span class="ident" id="2286000">sa2</span><span class="op" id="2286003">+</span><span class="ident" id="2286004">s</span><span class="op" id="2286005">*</span><span class="op" id="2286006">(</span><span class="ident" id="2286007">sa3</span><span class="op" id="2286010">+</span><span class="ident" id="2286011">s</span><span class="op" id="2286012">*</span><span class="op" id="2286013">(</span><span class="ident" id="2286014">sa4</span><span class="op" id="2286017">+</span><span class="ident" id="2286018">s</span><span class="op" id="2286019">*</span><span class="op" id="2286020">(</span><span class="ident" id="2286021">sa5</span><span class="op" id="2286024">+</span><span class="ident" id="2286025">s</span><span class="op" id="2286026">*</span><span class="op" id="2286027">(</span><span class="ident" id="2286028">sa6</span><span class="op" id="2286031">+</span><span class="ident" id="2286032">s</span><span class="op" id="2286033">*</span><span class="op" id="2286034">(</span><span class="ident" id="2286035">sa7</span><span class="op" id="2286038">+</span><span class="ident" id="2286039">s</span><span class="op" id="2286040">*</span><span class="ident" id="2286041">sa8</span><span class="op" id="2286044">)</span><span class="op" id="2286045">)</span><span class="op" id="2286046">)</span><span class="op" id="2286047">)</span><span class="op" id="2286048">)</span><span class="op" id="2286049">)</span><span class="op" id="2286050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286053">}</span>&nbsp;<span class="keyword" id="2286055">else</span>&nbsp;<span class="op" id="2286060">{</span>&nbsp;<span class="comment" id="2286062">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286095">R</span>&nbsp;<span class="op" id="2286097">=</span>&nbsp;<span class="ident" id="2286099">rb0</span>&nbsp;<span class="op" id="2286103">+</span>&nbsp;<span class="ident" id="2286105">s</span><span class="op" id="2286106">*</span><span class="op" id="2286107">(</span><span class="ident" id="2286108">rb1</span><span class="op" id="2286111">+</span><span class="ident" id="2286112">s</span><span class="op" id="2286113">*</span><span class="op" id="2286114">(</span><span class="ident" id="2286115">rb2</span><span class="op" id="2286118">+</span><span class="ident" id="2286119">s</span><span class="op" id="2286120">*</span><span class="op" id="2286121">(</span><span class="ident" id="2286122">rb3</span><span class="op" id="2286125">+</span><span class="ident" id="2286126">s</span><span class="op" id="2286127">*</span><span class="op" id="2286128">(</span><span class="ident" id="2286129">rb4</span><span class="op" id="2286132">+</span><span class="ident" id="2286133">s</span><span class="op" id="2286134">*</span><span class="op" id="2286135">(</span><span class="ident" id="2286136">rb5</span><span class="op" id="2286139">+</span><span class="ident" id="2286140">s</span><span class="op" id="2286141">*</span><span class="ident" id="2286142">rb6</span><span class="op" id="2286145">)</span><span class="op" id="2286146">)</span><span class="op" id="2286147">)</span><span class="op" id="2286148">)</span><span class="op" id="2286149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286153">S</span>&nbsp;<span class="op" id="2286155">=</span>&nbsp;<span class="num" id="2286157">1</span>&nbsp;<span class="op" id="2286159">+</span>&nbsp;<span class="ident" id="2286161">s</span><span class="op" id="2286162">*</span><span class="op" id="2286163">(</span><span class="ident" id="2286164">sb1</span><span class="op" id="2286167">+</span><span class="ident" id="2286168">s</span><span class="op" id="2286169">*</span><span class="op" id="2286170">(</span><span class="ident" id="2286171">sb2</span><span class="op" id="2286174">+</span><span class="ident" id="2286175">s</span><span class="op" id="2286176">*</span><span class="op" id="2286177">(</span><span class="ident" id="2286178">sb3</span><span class="op" id="2286181">+</span><span class="ident" id="2286182">s</span><span class="op" id="2286183">*</span><span class="op" id="2286184">(</span><span class="ident" id="2286185">sb4</span><span class="op" id="2286188">+</span><span class="ident" id="2286189">s</span><span class="op" id="2286190">*</span><span class="op" id="2286191">(</span><span class="ident" id="2286192">sb5</span><span class="op" id="2286195">+</span><span class="ident" id="2286196">s</span><span class="op" id="2286197">*</span><span class="op" id="2286198">(</span><span class="ident" id="2286199">sb6</span><span class="op" id="2286202">+</span><span class="ident" id="2286203">s</span><span class="op" id="2286204">*</span><span class="ident" id="2286205">sb7</span><span class="op" id="2286208">)</span><span class="op" id="2286209">)</span><span class="op" id="2286210">)</span><span class="op" id="2286211">)</span><span class="op" id="2286212">)</span><span class="op" id="2286213">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286219">z</span>&nbsp;<span class="op" id="2286221">:=</span>&nbsp;<span class="ident" id="2286224">Float64frombits</span><span class="op" id="2286239">(</span><span class="ident" id="2286240">Float64bits</span><span class="op" id="2286251">(</span><span class="ident" id="2286252">x</span><span class="op" id="2286253">)</span>&nbsp;<span class="op" id="2286255">&amp;</span>&nbsp;<span class="num" id="2286257">0xffffffff00000000</span><span class="op" id="2286275">)</span>&nbsp;<span class="comment" id="2286277">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286316">r</span>&nbsp;<span class="op" id="2286318">:=</span>&nbsp;<span class="ident" id="2286321">Exp</span><span class="op" id="2286324">(</span><span class="op" id="2286325">-</span><span class="ident" id="2286326">z</span><span class="op" id="2286327">*</span><span class="ident" id="2286328">z</span><span class="op" id="2286329">-</span><span class="num" id="2286330">0.5625</span><span class="op" id="2286336">)</span>&nbsp;<span class="op" id="2286338">*</span>&nbsp;<span class="ident" id="2286340">Exp</span><span class="op" id="2286343">(</span><span class="op" id="2286344">(</span><span class="ident" id="2286345">z</span><span class="op" id="2286346">-</span><span class="ident" id="2286347">x</span><span class="op" id="2286348">)</span><span class="op" id="2286349">*</span><span class="op" id="2286350">(</span><span class="ident" id="2286351">z</span><span class="op" id="2286352">+</span><span class="ident" id="2286353">x</span><span class="op" id="2286354">)</span><span class="op" id="2286355">+</span><span class="ident" id="2286356">R</span><span class="op" id="2286357">/</span><span class="ident" id="2286358">S</span><span class="op" id="2286359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286362">if</span>&nbsp;<span class="ident" id="2286365">sign</span>&nbsp;<span class="op" id="2286370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286374">return</span>&nbsp;<span class="ident" id="2286381">r</span><span class="op" id="2286382">/</span><span class="ident" id="2286383">x</span>&nbsp;<span class="op" id="2286385">-</span>&nbsp;<span class="num" id="2286387">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286393">return</span>&nbsp;<span class="num" id="2286400">1</span>&nbsp;<span class="op" id="2286402">-</span>&nbsp;<span class="ident" id="2286404">r</span><span class="op" id="2286405">/</span><span class="ident" id="2286406">x</span><br>
<span class="lineno"></span><span class="op" id="2286408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286411">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2286466">//</span><br>
<span class="lineno"></span><span class="comment" id="2286469">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2286491">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2286509">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2286527">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2286546">func</span>&nbsp;<span class="ident" id="2286551">Erfc</span><span class="op" id="2286555">(</span><span class="ident" id="2286556">x</span>&nbsp;<span class="builtintype" id="2286558">float64</span><span class="op" id="2286565">)</span>&nbsp;<span class="builtintype" id="2286567">float64</span>&nbsp;<span class="op" id="2286575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286578">const</span>&nbsp;<span class="ident" id="2286584">Tiny</span>&nbsp;<span class="op" id="2286589">=</span>&nbsp;<span class="num" id="2286591">1.0</span>&nbsp;<span class="op" id="2286595">/</span>&nbsp;<span class="op" id="2286597">(</span><span class="num" id="2286598">1</span>&nbsp;<span class="op" id="2286600">&lt;&lt;</span>&nbsp;<span class="num" id="2286603">56</span><span class="op" id="2286605">)</span>&nbsp;<span class="comment" id="2286607">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286618">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286636">switch</span>&nbsp;<span class="op" id="2286643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286646">case</span>&nbsp;<span class="ident" id="2286651">IsNaN</span><span class="op" id="2286656">(</span><span class="ident" id="2286657">x</span><span class="op" id="2286658">)</span><span class="op" id="2286659">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286663">return</span>&nbsp;<span class="ident" id="2286670">NaN</span><span class="op" id="2286673">(</span><span class="op" id="2286674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286677">case</span>&nbsp;<span class="ident" id="2286682">IsInf</span><span class="op" id="2286687">(</span><span class="ident" id="2286688">x</span><span class="op" id="2286689">,</span>&nbsp;<span class="num" id="2286691">1</span><span class="op" id="2286692">)</span><span class="op" id="2286693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286697">return</span>&nbsp;<span class="num" id="2286704">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286707">case</span>&nbsp;<span class="ident" id="2286712">IsInf</span><span class="op" id="2286717">(</span><span class="ident" id="2286718">x</span><span class="op" id="2286719">,</span>&nbsp;<span class="op" id="2286721">-</span><span class="num" id="2286722">1</span><span class="op" id="2286723">)</span><span class="op" id="2286724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286728">return</span>&nbsp;<span class="num" id="2286735">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286741">sign</span>&nbsp;<span class="op" id="2286746">:=</span>&nbsp;<span class="builtintype" id="2286749">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286756">if</span>&nbsp;<span class="ident" id="2286759">x</span>&nbsp;<span class="op" id="2286761">&lt;</span>&nbsp;<span class="num" id="2286763">0</span>&nbsp;<span class="op" id="2286765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286769">x</span>&nbsp;<span class="op" id="2286771">=</span>&nbsp;<span class="op" id="2286773">-</span><span class="ident" id="2286774">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286778">sign</span>&nbsp;<span class="op" id="2286783">=</span>&nbsp;<span class="builtintype" id="2286785">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286794">if</span>&nbsp;<span class="ident" id="2286797">x</span>&nbsp;<span class="op" id="2286799">&lt;</span>&nbsp;<span class="num" id="2286801">0.84375</span>&nbsp;<span class="op" id="2286809">{</span>&nbsp;<span class="comment" id="2286811">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286830">var</span>&nbsp;<span class="ident" id="2286834">temp</span>&nbsp;<span class="builtintype" id="2286839">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286849">if</span>&nbsp;<span class="ident" id="2286852">x</span>&nbsp;<span class="op" id="2286854">&lt;</span>&nbsp;<span class="ident" id="2286856">Tiny</span>&nbsp;<span class="op" id="2286861">{</span>&nbsp;<span class="comment" id="2286863">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286882">temp</span>&nbsp;<span class="op" id="2286887">=</span>&nbsp;<span class="ident" id="2286889">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286893">}</span>&nbsp;<span class="keyword" id="2286895">else</span>&nbsp;<span class="op" id="2286900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286905">z</span>&nbsp;<span class="op" id="2286907">:=</span>&nbsp;<span class="ident" id="2286910">x</span>&nbsp;<span class="op" id="2286912">*</span>&nbsp;<span class="ident" id="2286914">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286919">r</span>&nbsp;<span class="op" id="2286921">:=</span>&nbsp;<span class="ident" id="2286924">pp0</span>&nbsp;<span class="op" id="2286928">+</span>&nbsp;<span class="ident" id="2286930">z</span><span class="op" id="2286931">*</span><span class="op" id="2286932">(</span><span class="ident" id="2286933">pp1</span><span class="op" id="2286936">+</span><span class="ident" id="2286937">z</span><span class="op" id="2286938">*</span><span class="op" id="2286939">(</span><span class="ident" id="2286940">pp2</span><span class="op" id="2286943">+</span><span class="ident" id="2286944">z</span><span class="op" id="2286945">*</span><span class="op" id="2286946">(</span><span class="ident" id="2286947">pp3</span><span class="op" id="2286950">+</span><span class="ident" id="2286951">z</span><span class="op" id="2286952">*</span><span class="ident" id="2286953">pp4</span><span class="op" id="2286956">)</span><span class="op" id="2286957">)</span><span class="op" id="2286958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286963">s</span>&nbsp;<span class="op" id="2286965">:=</span>&nbsp;<span class="num" id="2286968">1</span>&nbsp;<span class="op" id="2286970">+</span>&nbsp;<span class="ident" id="2286972">z</span><span class="op" id="2286973">*</span><span class="op" id="2286974">(</span><span class="ident" id="2286975">qq1</span><span class="op" id="2286978">+</span><span class="ident" id="2286979">z</span><span class="op" id="2286980">*</span><span class="op" id="2286981">(</span><span class="ident" id="2286982">qq2</span><span class="op" id="2286985">+</span><span class="ident" id="2286986">z</span><span class="op" id="2286987">*</span><span class="op" id="2286988">(</span><span class="ident" id="2286989">qq3</span><span class="op" id="2286992">+</span><span class="ident" id="2286993">z</span><span class="op" id="2286994">*</span><span class="op" id="2286995">(</span><span class="ident" id="2286996">qq4</span><span class="op" id="2286999">+</span><span class="ident" id="2287000">z</span><span class="op" id="2287001">*</span><span class="ident" id="2287002">qq5</span><span class="op" id="2287005">)</span><span class="op" id="2287006">)</span><span class="op" id="2287007">)</span><span class="op" id="2287008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287013">y</span>&nbsp;<span class="op" id="2287015">:=</span>&nbsp;<span class="ident" id="2287018">r</span>&nbsp;<span class="op" id="2287020">/</span>&nbsp;<span class="ident" id="2287022">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287027">if</span>&nbsp;<span class="ident" id="2287030">x</span>&nbsp;<span class="op" id="2287032">&lt;</span>&nbsp;<span class="num" id="2287034">0.25</span>&nbsp;<span class="op" id="2287039">{</span>&nbsp;<span class="comment" id="2287041">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287058">temp</span>&nbsp;<span class="op" id="2287063">=</span>&nbsp;<span class="ident" id="2287065">x</span>&nbsp;<span class="op" id="2287067">+</span>&nbsp;<span class="ident" id="2287069">x</span><span class="op" id="2287070">*</span><span class="ident" id="2287071">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287076">}</span>&nbsp;<span class="keyword" id="2287078">else</span>&nbsp;<span class="op" id="2287083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287089">temp</span>&nbsp;<span class="op" id="2287094">=</span>&nbsp;<span class="num" id="2287096">0.5</span>&nbsp;<span class="op" id="2287100">+</span>&nbsp;<span class="op" id="2287102">(</span><span class="ident" id="2287103">x</span><span class="op" id="2287104">*</span><span class="ident" id="2287105">y</span>&nbsp;<span class="op" id="2287107">+</span>&nbsp;<span class="op" id="2287109">(</span><span class="ident" id="2287110">x</span>&nbsp;<span class="op" id="2287112">-</span>&nbsp;<span class="num" id="2287114">0.5</span><span class="op" id="2287117">)</span><span class="op" id="2287118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287123">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287131">if</span>&nbsp;<span class="ident" id="2287134">sign</span>&nbsp;<span class="op" id="2287139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287144">return</span>&nbsp;<span class="num" id="2287151">1</span>&nbsp;<span class="op" id="2287153">+</span>&nbsp;<span class="ident" id="2287155">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287166">return</span>&nbsp;<span class="num" id="2287173">1</span>&nbsp;<span class="op" id="2287175">-</span>&nbsp;<span class="ident" id="2287177">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287186">if</span>&nbsp;<span class="ident" id="2287189">x</span>&nbsp;<span class="op" id="2287191">&lt;</span>&nbsp;<span class="num" id="2287193">1.25</span>&nbsp;<span class="op" id="2287198">{</span>&nbsp;<span class="comment" id="2287200">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287227">s</span>&nbsp;<span class="op" id="2287229">:=</span>&nbsp;<span class="ident" id="2287232">x</span>&nbsp;<span class="op" id="2287234">-</span>&nbsp;<span class="num" id="2287236">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287240">P</span>&nbsp;<span class="op" id="2287242">:=</span>&nbsp;<span class="ident" id="2287245">pa0</span>&nbsp;<span class="op" id="2287249">+</span>&nbsp;<span class="ident" id="2287251">s</span><span class="op" id="2287252">*</span><span class="op" id="2287253">(</span><span class="ident" id="2287254">pa1</span><span class="op" id="2287257">+</span><span class="ident" id="2287258">s</span><span class="op" id="2287259">*</span><span class="op" id="2287260">(</span><span class="ident" id="2287261">pa2</span><span class="op" id="2287264">+</span><span class="ident" id="2287265">s</span><span class="op" id="2287266">*</span><span class="op" id="2287267">(</span><span class="ident" id="2287268">pa3</span><span class="op" id="2287271">+</span><span class="ident" id="2287272">s</span><span class="op" id="2287273">*</span><span class="op" id="2287274">(</span><span class="ident" id="2287275">pa4</span><span class="op" id="2287278">+</span><span class="ident" id="2287279">s</span><span class="op" id="2287280">*</span><span class="op" id="2287281">(</span><span class="ident" id="2287282">pa5</span><span class="op" id="2287285">+</span><span class="ident" id="2287286">s</span><span class="op" id="2287287">*</span><span class="ident" id="2287288">pa6</span><span class="op" id="2287291">)</span><span class="op" id="2287292">)</span><span class="op" id="2287293">)</span><span class="op" id="2287294">)</span><span class="op" id="2287295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287299">Q</span>&nbsp;<span class="op" id="2287301">:=</span>&nbsp;<span class="num" id="2287304">1</span>&nbsp;<span class="op" id="2287306">+</span>&nbsp;<span class="ident" id="2287308">s</span><span class="op" id="2287309">*</span><span class="op" id="2287310">(</span><span class="ident" id="2287311">qa1</span><span class="op" id="2287314">+</span><span class="ident" id="2287315">s</span><span class="op" id="2287316">*</span><span class="op" id="2287317">(</span><span class="ident" id="2287318">qa2</span><span class="op" id="2287321">+</span><span class="ident" id="2287322">s</span><span class="op" id="2287323">*</span><span class="op" id="2287324">(</span><span class="ident" id="2287325">qa3</span><span class="op" id="2287328">+</span><span class="ident" id="2287329">s</span><span class="op" id="2287330">*</span><span class="op" id="2287331">(</span><span class="ident" id="2287332">qa4</span><span class="op" id="2287335">+</span><span class="ident" id="2287336">s</span><span class="op" id="2287337">*</span><span class="op" id="2287338">(</span><span class="ident" id="2287339">qa5</span><span class="op" id="2287342">+</span><span class="ident" id="2287343">s</span><span class="op" id="2287344">*</span><span class="ident" id="2287345">qa6</span><span class="op" id="2287348">)</span><span class="op" id="2287349">)</span><span class="op" id="2287350">)</span><span class="op" id="2287351">)</span><span class="op" id="2287352">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287356">if</span>&nbsp;<span class="ident" id="2287359">sign</span>&nbsp;<span class="op" id="2287364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287369">return</span>&nbsp;<span class="num" id="2287376">1</span>&nbsp;<span class="op" id="2287378">+</span>&nbsp;<span class="ident" id="2287380">erx</span>&nbsp;<span class="op" id="2287384">+</span>&nbsp;<span class="ident" id="2287386">P</span><span class="op" id="2287387">/</span><span class="ident" id="2287388">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287396">return</span>&nbsp;<span class="num" id="2287403">1</span>&nbsp;<span class="op" id="2287405">-</span>&nbsp;<span class="ident" id="2287407">erx</span>&nbsp;<span class="op" id="2287411">-</span>&nbsp;<span class="ident" id="2287413">P</span><span class="op" id="2287414">/</span><span class="ident" id="2287415">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287422">if</span>&nbsp;<span class="ident" id="2287425">x</span>&nbsp;<span class="op" id="2287427">&lt;</span>&nbsp;<span class="num" id="2287429">28</span>&nbsp;<span class="op" id="2287432">{</span>&nbsp;<span class="comment" id="2287434">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287448">s</span>&nbsp;<span class="op" id="2287450">:=</span>&nbsp;<span class="num" id="2287453">1</span>&nbsp;<span class="op" id="2287455">/</span>&nbsp;<span class="op" id="2287457">(</span><span class="ident" id="2287458">x</span>&nbsp;<span class="op" id="2287460">*</span>&nbsp;<span class="ident" id="2287462">x</span><span class="op" id="2287463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287467">var</span>&nbsp;<span class="ident" id="2287471">R</span><span class="op" id="2287472">,</span>&nbsp;<span class="ident" id="2287474">S</span>&nbsp;<span class="builtintype" id="2287476">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287486">if</span>&nbsp;<span class="ident" id="2287489">x</span>&nbsp;<span class="op" id="2287491">&lt;</span>&nbsp;<span class="num" id="2287493">1</span><span class="op" id="2287494">/</span><span class="num" id="2287495">0.35</span>&nbsp;<span class="op" id="2287500">{</span>&nbsp;<span class="comment" id="2287502">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287534">R</span>&nbsp;<span class="op" id="2287536">=</span>&nbsp;<span class="ident" id="2287538">ra0</span>&nbsp;<span class="op" id="2287542">+</span>&nbsp;<span class="ident" id="2287544">s</span><span class="op" id="2287545">*</span><span class="op" id="2287546">(</span><span class="ident" id="2287547">ra1</span><span class="op" id="2287550">+</span><span class="ident" id="2287551">s</span><span class="op" id="2287552">*</span><span class="op" id="2287553">(</span><span class="ident" id="2287554">ra2</span><span class="op" id="2287557">+</span><span class="ident" id="2287558">s</span><span class="op" id="2287559">*</span><span class="op" id="2287560">(</span><span class="ident" id="2287561">ra3</span><span class="op" id="2287564">+</span><span class="ident" id="2287565">s</span><span class="op" id="2287566">*</span><span class="op" id="2287567">(</span><span class="ident" id="2287568">ra4</span><span class="op" id="2287571">+</span><span class="ident" id="2287572">s</span><span class="op" id="2287573">*</span><span class="op" id="2287574">(</span><span class="ident" id="2287575">ra5</span><span class="op" id="2287578">+</span><span class="ident" id="2287579">s</span><span class="op" id="2287580">*</span><span class="op" id="2287581">(</span><span class="ident" id="2287582">ra6</span><span class="op" id="2287585">+</span><span class="ident" id="2287586">s</span><span class="op" id="2287587">*</span><span class="ident" id="2287588">ra7</span><span class="op" id="2287591">)</span><span class="op" id="2287592">)</span><span class="op" id="2287593">)</span><span class="op" id="2287594">)</span><span class="op" id="2287595">)</span><span class="op" id="2287596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287601">S</span>&nbsp;<span class="op" id="2287603">=</span>&nbsp;<span class="num" id="2287605">1</span>&nbsp;<span class="op" id="2287607">+</span>&nbsp;<span class="ident" id="2287609">s</span><span class="op" id="2287610">*</span><span class="op" id="2287611">(</span><span class="ident" id="2287612">sa1</span><span class="op" id="2287615">+</span><span class="ident" id="2287616">s</span><span class="op" id="2287617">*</span><span class="op" id="2287618">(</span><span class="ident" id="2287619">sa2</span><span class="op" id="2287622">+</span><span class="ident" id="2287623">s</span><span class="op" id="2287624">*</span><span class="op" id="2287625">(</span><span class="ident" id="2287626">sa3</span><span class="op" id="2287629">+</span><span class="ident" id="2287630">s</span><span class="op" id="2287631">*</span><span class="op" id="2287632">(</span><span class="ident" id="2287633">sa4</span><span class="op" id="2287636">+</span><span class="ident" id="2287637">s</span><span class="op" id="2287638">*</span><span class="op" id="2287639">(</span><span class="ident" id="2287640">sa5</span><span class="op" id="2287643">+</span><span class="ident" id="2287644">s</span><span class="op" id="2287645">*</span><span class="op" id="2287646">(</span><span class="ident" id="2287647">sa6</span><span class="op" id="2287650">+</span><span class="ident" id="2287651">s</span><span class="op" id="2287652">*</span><span class="op" id="2287653">(</span><span class="ident" id="2287654">sa7</span><span class="op" id="2287657">+</span><span class="ident" id="2287658">s</span><span class="op" id="2287659">*</span><span class="ident" id="2287660">sa8</span><span class="op" id="2287663">)</span><span class="op" id="2287664">)</span><span class="op" id="2287665">)</span><span class="op" id="2287666">)</span><span class="op" id="2287667">)</span><span class="op" id="2287668">)</span><span class="op" id="2287669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287673">}</span>&nbsp;<span class="keyword" id="2287675">else</span>&nbsp;<span class="op" id="2287680">{</span>&nbsp;<span class="comment" id="2287682">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287715">if</span>&nbsp;<span class="ident" id="2287718">sign</span>&nbsp;<span class="op" id="2287723">&amp;&amp;</span>&nbsp;<span class="ident" id="2287726">x</span>&nbsp;<span class="op" id="2287728">&gt;</span>&nbsp;<span class="num" id="2287730">6</span>&nbsp;<span class="op" id="2287732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287738">return</span>&nbsp;<span class="num" id="2287745">2</span>&nbsp;<span class="comment" id="2287747">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287765">R</span>&nbsp;<span class="op" id="2287767">=</span>&nbsp;<span class="ident" id="2287769">rb0</span>&nbsp;<span class="op" id="2287773">+</span>&nbsp;<span class="ident" id="2287775">s</span><span class="op" id="2287776">*</span><span class="op" id="2287777">(</span><span class="ident" id="2287778">rb1</span><span class="op" id="2287781">+</span><span class="ident" id="2287782">s</span><span class="op" id="2287783">*</span><span class="op" id="2287784">(</span><span class="ident" id="2287785">rb2</span><span class="op" id="2287788">+</span><span class="ident" id="2287789">s</span><span class="op" id="2287790">*</span><span class="op" id="2287791">(</span><span class="ident" id="2287792">rb3</span><span class="op" id="2287795">+</span><span class="ident" id="2287796">s</span><span class="op" id="2287797">*</span><span class="op" id="2287798">(</span><span class="ident" id="2287799">rb4</span><span class="op" id="2287802">+</span><span class="ident" id="2287803">s</span><span class="op" id="2287804">*</span><span class="op" id="2287805">(</span><span class="ident" id="2287806">rb5</span><span class="op" id="2287809">+</span><span class="ident" id="2287810">s</span><span class="op" id="2287811">*</span><span class="ident" id="2287812">rb6</span><span class="op" id="2287815">)</span><span class="op" id="2287816">)</span><span class="op" id="2287817">)</span><span class="op" id="2287818">)</span><span class="op" id="2287819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287824">S</span>&nbsp;<span class="op" id="2287826">=</span>&nbsp;<span class="num" id="2287828">1</span>&nbsp;<span class="op" id="2287830">+</span>&nbsp;<span class="ident" id="2287832">s</span><span class="op" id="2287833">*</span><span class="op" id="2287834">(</span><span class="ident" id="2287835">sb1</span><span class="op" id="2287838">+</span><span class="ident" id="2287839">s</span><span class="op" id="2287840">*</span><span class="op" id="2287841">(</span><span class="ident" id="2287842">sb2</span><span class="op" id="2287845">+</span><span class="ident" id="2287846">s</span><span class="op" id="2287847">*</span><span class="op" id="2287848">(</span><span class="ident" id="2287849">sb3</span><span class="op" id="2287852">+</span><span class="ident" id="2287853">s</span><span class="op" id="2287854">*</span><span class="op" id="2287855">(</span><span class="ident" id="2287856">sb4</span><span class="op" id="2287859">+</span><span class="ident" id="2287860">s</span><span class="op" id="2287861">*</span><span class="op" id="2287862">(</span><span class="ident" id="2287863">sb5</span><span class="op" id="2287866">+</span><span class="ident" id="2287867">s</span><span class="op" id="2287868">*</span><span class="op" id="2287869">(</span><span class="ident" id="2287870">sb6</span><span class="op" id="2287873">+</span><span class="ident" id="2287874">s</span><span class="op" id="2287875">*</span><span class="ident" id="2287876">sb7</span><span class="op" id="2287879">)</span><span class="op" id="2287880">)</span><span class="op" id="2287881">)</span><span class="op" id="2287882">)</span><span class="op" id="2287883">)</span><span class="op" id="2287884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287892">z</span>&nbsp;<span class="op" id="2287894">:=</span>&nbsp;<span class="ident" id="2287897">Float64frombits</span><span class="op" id="2287912">(</span><span class="ident" id="2287913">Float64bits</span><span class="op" id="2287924">(</span><span class="ident" id="2287925">x</span><span class="op" id="2287926">)</span>&nbsp;<span class="op" id="2287928">&amp;</span>&nbsp;<span class="num" id="2287930">0xffffffff00000000</span><span class="op" id="2287948">)</span>&nbsp;<span class="comment" id="2287950">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287990">r</span>&nbsp;<span class="op" id="2287992">:=</span>&nbsp;<span class="ident" id="2287995">Exp</span><span class="op" id="2287998">(</span><span class="op" id="2287999">-</span><span class="ident" id="2288000">z</span><span class="op" id="2288001">*</span><span class="ident" id="2288002">z</span><span class="op" id="2288003">-</span><span class="num" id="2288004">0.5625</span><span class="op" id="2288010">)</span>&nbsp;<span class="op" id="2288012">*</span>&nbsp;<span class="ident" id="2288014">Exp</span><span class="op" id="2288017">(</span><span class="op" id="2288018">(</span><span class="ident" id="2288019">z</span><span class="op" id="2288020">-</span><span class="ident" id="2288021">x</span><span class="op" id="2288022">)</span><span class="op" id="2288023">*</span><span class="op" id="2288024">(</span><span class="ident" id="2288025">z</span><span class="op" id="2288026">+</span><span class="ident" id="2288027">x</span><span class="op" id="2288028">)</span><span class="op" id="2288029">+</span><span class="ident" id="2288030">R</span><span class="op" id="2288031">/</span><span class="ident" id="2288032">S</span><span class="op" id="2288033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288037">if</span>&nbsp;<span class="ident" id="2288040">sign</span>&nbsp;<span class="op" id="2288045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288050">return</span>&nbsp;<span class="num" id="2288057">2</span>&nbsp;<span class="op" id="2288059">-</span>&nbsp;<span class="ident" id="2288061">r</span><span class="op" id="2288062">/</span><span class="ident" id="2288063">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288071">return</span>&nbsp;<span class="ident" id="2288078">r</span>&nbsp;<span class="op" id="2288080">/</span>&nbsp;<span class="ident" id="2288082">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288088">if</span>&nbsp;<span class="ident" id="2288091">sign</span>&nbsp;<span class="op" id="2288096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288100">return</span>&nbsp;<span class="num" id="2288107">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288113">return</span>&nbsp;<span class="num" id="2288120">0</span><br>
<span class="lineno">335</span><span class="op" id="2288122">}</span>
</div>
</body>
</html>
