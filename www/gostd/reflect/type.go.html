<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2663299">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2663354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2663408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2663459">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2663532">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2663612">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2663688">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2663729">//</span><br>
<span class="lineno">10</span><span class="comment" id="2663732">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2663801">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2663868">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2663886">//</span><br>
<span class="lineno"></span><span class="comment" id="2663889">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2663962">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2664020">package</span>&nbsp;<span class="ident" id="2664028">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2664037">import</span>&nbsp;<span class="op" id="2664044">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2664047">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2664058">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2664069">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2664077">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2664086">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2664089">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2664133">//</span><br>
<span class="lineno"></span><span class="comment" id="2664136">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2664199">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2664258">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2664317">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2664369">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2664431">type</span>&nbsp;<span class="ident" id="2664436">Type</span>&nbsp;<span class="keyword" id="2664441">interface</span>&nbsp;<span class="op" id="2664451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664454">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664492">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664547">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2664587">Align</span><span class="op" id="2664592">(</span><span class="op" id="2664593">)</span>&nbsp;<span class="builtintype" id="2664595">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664601">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664661">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2664709">FieldAlign</span><span class="op" id="2664719">(</span><span class="op" id="2664720">)</span>&nbsp;<span class="builtintype" id="2664722">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664728">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664789">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664846">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664850">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664924">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664993">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2664997">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665067">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2665136">Method</span><span class="op" id="2665142">(</span><span class="builtintype" id="2665143">int</span><span class="op" id="2665146">)</span>&nbsp;<span class="ident" id="2665148">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665157">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665222">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665287">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665291">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665365">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665434">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665438">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665508">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2665577">MethodByName</span><span class="op" id="2665589">(</span><span class="builtintype" id="2665590">string</span><span class="op" id="2665596">)</span>&nbsp;<span class="op" id="2665598">(</span><span class="ident" id="2665599">Method</span><span class="op" id="2665605">,</span>&nbsp;<span class="builtintype" id="2665607">bool</span><span class="op" id="2665611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665615">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2665685">NumMethod</span><span class="op" id="2665694">(</span><span class="op" id="2665695">)</span>&nbsp;<span class="builtintype" id="2665697">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665703">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665756">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2665806">Name</span><span class="op" id="2665810">(</span><span class="op" id="2665811">)</span>&nbsp;<span class="builtintype" id="2665813">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665822">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665896">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2665965">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666047">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666094">PkgPath</span><span class="op" id="2666101">(</span><span class="op" id="2666102">)</span>&nbsp;<span class="builtintype" id="2666104">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666113">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666166">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666231">Size</span><span class="op" id="2666235">(</span><span class="op" id="2666236">)</span>&nbsp;<span class="builtintype" id="2666238">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666248">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666304">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666366">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666425">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666489">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666521">String</span><span class="op" id="2666527">(</span><span class="op" id="2666528">)</span>&nbsp;<span class="builtintype" id="2666530">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666539">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666588">Kind</span><span class="op" id="2666592">(</span><span class="op" id="2666593">)</span>&nbsp;<span class="ident" id="2666595">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666602">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666675">Implements</span><span class="op" id="2666685">(</span><span class="ident" id="2666686">u</span>&nbsp;<span class="ident" id="2666688">Type</span><span class="op" id="2666692">)</span>&nbsp;<span class="builtintype" id="2666694">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666701">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666779">AssignableTo</span><span class="op" id="2666791">(</span><span class="ident" id="2666792">u</span>&nbsp;<span class="ident" id="2666794">Type</span><span class="op" id="2666798">)</span>&nbsp;<span class="builtintype" id="2666800">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666807">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666887">ConvertibleTo</span><span class="op" id="2666900">(</span><span class="ident" id="2666901">u</span>&nbsp;<span class="ident" id="2666903">Type</span><span class="op" id="2666907">)</span>&nbsp;<span class="builtintype" id="2666909">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666916">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666983">Comparable</span><span class="op" id="2666993">(</span><span class="op" id="2666994">)</span>&nbsp;<span class="builtintype" id="2666996">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667003">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667065">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667108">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667112">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667152">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667173">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667197">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667243">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667262">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667276">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667292">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667365">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667412">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667463">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667520">Bits</span><span class="op" id="2667524">(</span><span class="op" id="2667525">)</span>&nbsp;<span class="builtintype" id="2667527">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667533">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667581">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667627">ChanDir</span><span class="op" id="2667634">(</span><span class="op" id="2667635">)</span>&nbsp;<span class="ident" id="2667637">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667647">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667718">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667796">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667826">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667830">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667901">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667905">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667924">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667966">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668014">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668041">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668045">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668099">IsVariadic</span><span class="op" id="2668109">(</span><span class="op" id="2668110">)</span>&nbsp;<span class="builtintype" id="2668112">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668119">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668159">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668232">Elem</span><span class="op" id="2668236">(</span><span class="op" id="2668237">)</span>&nbsp;<span class="ident" id="2668239">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668246">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668292">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668340">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668396">Field</span><span class="op" id="2668401">(</span><span class="ident" id="2668402">i</span>&nbsp;<span class="builtintype" id="2668404">int</span><span class="op" id="2668407">)</span>&nbsp;<span class="ident" id="2668409">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668423">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668479">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668541">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668576">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668624">FieldByIndex</span><span class="op" id="2668636">(</span><span class="ident" id="2668637">index</span>&nbsp;<span class="op" id="2668643">[</span><span class="op" id="2668644">]</span><span class="builtintype" id="2668645">int</span><span class="op" id="2668648">)</span>&nbsp;<span class="ident" id="2668650">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668664">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668725">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668778">FieldByName</span><span class="op" id="2668789">(</span><span class="ident" id="2668790">name</span>&nbsp;<span class="builtintype" id="2668795">string</span><span class="op" id="2668801">)</span>&nbsp;<span class="op" id="2668803">(</span><span class="ident" id="2668804">StructField</span><span class="op" id="2668815">,</span>&nbsp;<span class="builtintype" id="2668817">bool</span><span class="op" id="2668821">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668825">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668888">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668954">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668979">FieldByNameFunc</span><span class="op" id="2668994">(</span><span class="ident" id="2668995">match</span>&nbsp;<span class="keyword" id="2669001">func</span><span class="op" id="2669005">(</span><span class="builtintype" id="2669006">string</span><span class="op" id="2669012">)</span>&nbsp;<span class="builtintype" id="2669014">bool</span><span class="op" id="2669018">)</span>&nbsp;<span class="op" id="2669020">(</span><span class="ident" id="2669021">StructField</span><span class="op" id="2669032">,</span>&nbsp;<span class="builtintype" id="2669034">bool</span><span class="op" id="2669038">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669042">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669109">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669155">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669208">In</span><span class="op" id="2669210">(</span><span class="ident" id="2669211">i</span>&nbsp;<span class="builtintype" id="2669213">int</span><span class="op" id="2669216">)</span>&nbsp;<span class="ident" id="2669218">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669225">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669264">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669309">Key</span><span class="op" id="2669312">(</span><span class="op" id="2669313">)</span>&nbsp;<span class="ident" id="2669315">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669322">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669362">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669409">Len</span><span class="op" id="2669412">(</span><span class="op" id="2669413">)</span>&nbsp;<span class="builtintype" id="2669415">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669421">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669471">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669519">NumField</span><span class="op" id="2669527">(</span><span class="op" id="2669528">)</span>&nbsp;<span class="builtintype" id="2669530">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669536">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669595">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669641">NumIn</span><span class="op" id="2669646">(</span><span class="op" id="2669647">)</span>&nbsp;<span class="builtintype" id="2669649">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669655">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669716">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669762">NumOut</span><span class="op" id="2669768">(</span><span class="op" id="2669769">)</span>&nbsp;<span class="builtintype" id="2669771">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669777">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669846">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669892">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669946">Out</span><span class="op" id="2669949">(</span><span class="ident" id="2669950">i</span>&nbsp;<span class="builtintype" id="2669952">int</span><span class="op" id="2669955">)</span>&nbsp;<span class="ident" id="2669957">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669964">common</span><span class="op" id="2669970">(</span><span class="op" id="2669971">)</span>&nbsp;<span class="op" id="2669973">*</span><span class="ident" id="2669974">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669981">uncommon</span><span class="op" id="2669989">(</span><span class="op" id="2669990">)</span>&nbsp;<span class="op" id="2669992">*</span><span class="ident" id="2669993">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2670006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2670009">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2670096">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2670169">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2670246">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2670318">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2670381">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2670468">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2670516">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2670711">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2670782">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2670820">type</span>&nbsp;<span class="ident" id="2670825">Kind</span>&nbsp;<span class="builtintype" id="2670830">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2670836">const</span>&nbsp;<span class="op" id="2670842">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670845">Invalid</span>&nbsp;<span class="ident" id="2670853">Kind</span>&nbsp;<span class="op" id="2670858">=</span>&nbsp;<span class="ident" id="2670860">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670866">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670872">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670877">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670883">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670890">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670897">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670904">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670910">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670917">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670925">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670933">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670941">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670950">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670959">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670968">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670979">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670991">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670998">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671004">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671010">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671021">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671026">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671031">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671038">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671046">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671054">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2671068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2671071">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2671125">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2671185">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2671248">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2671314">type</span>&nbsp;<span class="ident" id="2671319">rtype</span>&nbsp;<span class="keyword" id="2671325">struct</span>&nbsp;<span class="op" id="2671332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671335">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2671349">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671358">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2671372">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671390">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671442">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2671456">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671474">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671493">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2671507">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671525">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671566">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2671580">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671598">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671643">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2671657">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671675">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671697">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2671711">*</span><span class="ident" id="2671712">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671729">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671777">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2671791">[</span><span class="num" id="2671792">2</span><span class="op" id="2671793">]</span><span class="ident" id="2671794">unsafe</span><span class="op" id="2671800">.</span><span class="ident" id="2671801">Pointer</span>&nbsp;<span class="comment" id="2671809">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2671837">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2671851">*</span><span class="builtintype" id="2671852">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671869">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2671920">*</span><span class="ident" id="2671921">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2671952">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671985">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2671999">*</span><span class="ident" id="2672000">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2672017">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672085">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2672099">unsafe</span><span class="op" id="2672105">.</span><span class="ident" id="2672106">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2672117">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2672142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2672145">type</span>&nbsp;<span class="ident" id="2672150">typeAlg</span>&nbsp;<span class="keyword" id="2672158">struct</span>&nbsp;<span class="op" id="2672165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672168">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672214">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672254">hash</span>&nbsp;<span class="keyword" id="2672259">func</span><span class="op" id="2672263">(</span><span class="ident" id="2672264">unsafe</span><span class="op" id="2672270">.</span><span class="ident" id="2672271">Pointer</span><span class="op" id="2672278">,</span>&nbsp;<span class="builtintype" id="2672280">uintptr</span><span class="op" id="2672287">,</span>&nbsp;<span class="builtintype" id="2672289">uintptr</span><span class="op" id="2672296">)</span>&nbsp;<span class="builtintype" id="2672298">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672307">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672355">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672407">equal</span>&nbsp;<span class="keyword" id="2672413">func</span><span class="op" id="2672417">(</span><span class="ident" id="2672418">unsafe</span><span class="op" id="2672424">.</span><span class="ident" id="2672425">Pointer</span><span class="op" id="2672432">,</span>&nbsp;<span class="ident" id="2672434">unsafe</span><span class="op" id="2672440">.</span><span class="ident" id="2672441">Pointer</span><span class="op" id="2672448">,</span>&nbsp;<span class="builtintype" id="2672450">uintptr</span><span class="op" id="2672457">)</span>&nbsp;<span class="builtintype" id="2672459">bool</span><br>
<span class="lineno"></span><span class="op" id="2672464">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2672467">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2672499">type</span>&nbsp;<span class="ident" id="2672504">method</span>&nbsp;<span class="keyword" id="2672511">struct</span>&nbsp;<span class="op" id="2672518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672521">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2672529">*</span><span class="builtintype" id="2672530">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2672544">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672563">pkgPath</span>&nbsp;<span class="op" id="2672571">*</span><span class="builtintype" id="2672572">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2672586">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672636">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2672644">*</span><span class="ident" id="2672645">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2672659">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672694">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2672702">*</span><span class="ident" id="2672703">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2672717">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672761">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2672769">unsafe</span><span class="op" id="2672775">.</span><span class="ident" id="2672776">Pointer</span>&nbsp;<span class="comment" id="2672784">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672834">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2672842">unsafe</span><span class="op" id="2672848">.</span><span class="ident" id="2672849">Pointer</span>&nbsp;<span class="comment" id="2672857">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2672891">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2672894">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2672958">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2673030">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2673098">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2673146">type</span>&nbsp;<span class="ident" id="2673151">uncommonType</span>&nbsp;<span class="keyword" id="2673164">struct</span>&nbsp;<span class="op" id="2673171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673174">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2673182">*</span><span class="builtintype" id="2673183">string</span>&nbsp;&nbsp;<span class="comment" id="2673191">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673208">pkgPath</span>&nbsp;<span class="op" id="2673216">*</span><span class="builtintype" id="2673217">string</span>&nbsp;&nbsp;<span class="comment" id="2673225">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673282">methods</span>&nbsp;<span class="op" id="2673290">[</span><span class="op" id="2673291">]</span><span class="ident" id="2673292">method</span>&nbsp;<span class="comment" id="2673299">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2673331">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2673334">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2673384">type</span>&nbsp;<span class="ident" id="2673389">ChanDir</span>&nbsp;<span class="builtintype" id="2673397">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2673402">const</span>&nbsp;<span class="op" id="2673408">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673411">RecvDir</span>&nbsp;<span class="ident" id="2673419">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2673439">=</span>&nbsp;<span class="num" id="2673441">1</span>&nbsp;<span class="op" id="2673443">&lt;&lt;</span>&nbsp;<span class="ident" id="2673446">iota</span>&nbsp;<span class="comment" id="2673451">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673462">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673502">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673513">BothDir</span>&nbsp;<span class="op" id="2673521">=</span>&nbsp;<span class="ident" id="2673523">RecvDir</span>&nbsp;<span class="op" id="2673531">|</span>&nbsp;<span class="ident" id="2673533">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673553">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2673561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2673564">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2673608">type</span>&nbsp;<span class="ident" id="2673613">arrayType</span>&nbsp;<span class="keyword" id="2673623">struct</span>&nbsp;<span class="op" id="2673630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673633">rtype</span>&nbsp;<span class="string" id="2673639">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673658">elem</span>&nbsp;&nbsp;<span class="op" id="2673664">*</span><span class="ident" id="2673665">rtype</span>&nbsp;<span class="comment" id="2673671">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673694">slice</span>&nbsp;<span class="op" id="2673700">*</span><span class="ident" id="2673701">rtype</span>&nbsp;<span class="comment" id="2673707">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2673722">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673728">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2673736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2673739">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2673778">type</span>&nbsp;<span class="ident" id="2673783">chanType</span>&nbsp;<span class="keyword" id="2673792">struct</span>&nbsp;<span class="op" id="2673799">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673802">rtype</span>&nbsp;<span class="string" id="2673808">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673826">elem</span>&nbsp;&nbsp;<span class="op" id="2673832">*</span><span class="ident" id="2673833">rtype</span>&nbsp;&nbsp;<span class="comment" id="2673840">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673865">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673871">uintptr</span>&nbsp;<span class="comment" id="2673879">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2673910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2673913">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2673953">type</span>&nbsp;<span class="ident" id="2673958">funcType</span>&nbsp;<span class="keyword" id="2673967">struct</span>&nbsp;<span class="op" id="2673974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673977">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2673987">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674005">dotdotdot</span>&nbsp;<span class="builtintype" id="2674015">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2674024">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674056">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674066">[</span><span class="op" id="2674067">]</span><span class="op" id="2674068">*</span><span class="ident" id="2674069">rtype</span>&nbsp;<span class="comment" id="2674075">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674101">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674111">[</span><span class="op" id="2674112">]</span><span class="op" id="2674113">*</span><span class="ident" id="2674114">rtype</span>&nbsp;<span class="comment" id="2674120">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2674146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2674149">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2674201">type</span>&nbsp;<span class="ident" id="2674206">imethod</span>&nbsp;<span class="keyword" id="2674214">struct</span>&nbsp;<span class="op" id="2674221">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674224">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674232">*</span><span class="builtintype" id="2674233">string</span>&nbsp;<span class="comment" id="2674240">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674259">pkgPath</span>&nbsp;<span class="op" id="2674267">*</span><span class="builtintype" id="2674268">string</span>&nbsp;<span class="comment" id="2674275">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674325">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674333">*</span><span class="ident" id="2674334">rtype</span>&nbsp;&nbsp;<span class="comment" id="2674341">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2674368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2674371">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2674418">type</span>&nbsp;<span class="ident" id="2674423">interfaceType</span>&nbsp;<span class="keyword" id="2674437">struct</span>&nbsp;<span class="op" id="2674444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674447">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2674455">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674478">methods</span>&nbsp;<span class="op" id="2674486">[</span><span class="op" id="2674487">]</span><span class="ident" id="2674488">imethod</span>&nbsp;<span class="comment" id="2674496">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2674514">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2674517">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2674551">type</span>&nbsp;<span class="ident" id="2674556">mapType</span>&nbsp;<span class="keyword" id="2674564">struct</span>&nbsp;<span class="op" id="2674571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674574">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2674588">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674605">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674619">*</span><span class="ident" id="2674620">rtype</span>&nbsp;<span class="comment" id="2674626">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674643">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674657">*</span><span class="ident" id="2674658">rtype</span>&nbsp;<span class="comment" id="2674664">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674693">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674707">*</span><span class="ident" id="2674708">rtype</span>&nbsp;<span class="comment" id="2674714">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674744">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674758">*</span><span class="ident" id="2674759">rtype</span>&nbsp;<span class="comment" id="2674765">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674789">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2674803">uint8</span>&nbsp;&nbsp;<span class="comment" id="2674810">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674831">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2674845">uint8</span>&nbsp;&nbsp;<span class="comment" id="2674852">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674895">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2674909">uint8</span>&nbsp;&nbsp;<span class="comment" id="2674916">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674939">indirectvalue</span>&nbsp;<span class="builtintype" id="2674953">uint8</span>&nbsp;&nbsp;<span class="comment" id="2674960">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675007">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2675021">uint16</span>&nbsp;<span class="comment" id="2675028">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2675046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2675049">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2675087">type</span>&nbsp;<span class="ident" id="2675092">ptrType</span>&nbsp;<span class="keyword" id="2675100">struct</span>&nbsp;<span class="op" id="2675107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675110">rtype</span>&nbsp;<span class="string" id="2675116">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675133">elem</span>&nbsp;&nbsp;<span class="op" id="2675139">*</span><span class="ident" id="2675140">rtype</span>&nbsp;<span class="comment" id="2675146">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2675183">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2675186">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2675224">type</span>&nbsp;<span class="ident" id="2675229">sliceType</span>&nbsp;<span class="keyword" id="2675239">struct</span>&nbsp;<span class="op" id="2675246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675249">rtype</span>&nbsp;<span class="string" id="2675255">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675274">elem</span>&nbsp;&nbsp;<span class="op" id="2675280">*</span><span class="ident" id="2675281">rtype</span>&nbsp;<span class="comment" id="2675287">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2675309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2675312">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2675328">type</span>&nbsp;<span class="ident" id="2675333">structField</span>&nbsp;<span class="keyword" id="2675345">struct</span>&nbsp;<span class="op" id="2675352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675355">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675363">*</span><span class="builtintype" id="2675364">string</span>&nbsp;<span class="comment" id="2675371">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675399">pkgPath</span>&nbsp;<span class="op" id="2675407">*</span><span class="builtintype" id="2675408">string</span>&nbsp;<span class="comment" id="2675415">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675465">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675473">*</span><span class="ident" id="2675474">rtype</span>&nbsp;&nbsp;<span class="comment" id="2675481">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675499">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675507">*</span><span class="builtintype" id="2675508">string</span>&nbsp;<span class="comment" id="2675515">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675533">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2675541">uintptr</span>&nbsp;<span class="comment" id="2675549">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2675587">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2675590">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2675630">type</span>&nbsp;<span class="ident" id="2675635">structType</span>&nbsp;<span class="keyword" id="2675646">struct</span>&nbsp;<span class="op" id="2675653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675656">rtype</span>&nbsp;&nbsp;<span class="string" id="2675663">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675683">fields</span>&nbsp;<span class="op" id="2675690">[</span><span class="op" id="2675691">]</span><span class="ident" id="2675692">structField</span>&nbsp;<span class="comment" id="2675704">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2675724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2675727">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2675883">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2675921">type</span>&nbsp;<span class="ident" id="2675926">Method</span>&nbsp;<span class="keyword" id="2675933">struct</span>&nbsp;<span class="op" id="2675940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675943">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675972">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676045">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676115">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676184">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676205">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676266">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2676274">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676282">PkgPath</span>&nbsp;<span class="builtintype" id="2676290">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676299">Type</span>&nbsp;&nbsp;<span class="ident" id="2676305">Type</span>&nbsp;&nbsp;<span class="comment" id="2676311">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676327">Func</span>&nbsp;&nbsp;<span class="ident" id="2676333">Value</span>&nbsp;<span class="comment" id="2676339">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676380">Index</span>&nbsp;<span class="builtintype" id="2676386">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2676392">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2676417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2676420">const</span>&nbsp;<span class="op" id="2676426">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676429">kindDirectIface</span>&nbsp;<span class="op" id="2676445">=</span>&nbsp;<span class="num" id="2676447">1</span>&nbsp;<span class="op" id="2676449">&lt;&lt;</span>&nbsp;<span class="num" id="2676452">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676455">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676471">=</span>&nbsp;<span class="num" id="2676473">1</span>&nbsp;<span class="op" id="2676475">&lt;&lt;</span>&nbsp;<span class="num" id="2676478">6</span>&nbsp;<span class="comment" id="2676480">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676513">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2676529">=</span>&nbsp;<span class="num" id="2676531">1</span>&nbsp;<span class="op" id="2676533">&lt;&lt;</span>&nbsp;<span class="num" id="2676536">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676539">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676555">=</span>&nbsp;<span class="op" id="2676557">(</span><span class="num" id="2676558">1</span>&nbsp;<span class="op" id="2676560">&lt;&lt;</span>&nbsp;<span class="num" id="2676563">5</span><span class="op" id="2676564">)</span>&nbsp;<span class="op" id="2676566">-</span>&nbsp;<span class="num" id="2676568">1</span><br>
<span class="lineno"></span><span class="op" id="2676570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2676573">func</span>&nbsp;<span class="op" id="2676578">(</span><span class="ident" id="2676579">k</span>&nbsp;<span class="ident" id="2676581">Kind</span><span class="op" id="2676585">)</span>&nbsp;<span class="ident" id="2676587">String</span><span class="op" id="2676593">(</span><span class="op" id="2676594">)</span>&nbsp;<span class="builtintype" id="2676596">string</span>&nbsp;<span class="op" id="2676603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2676606">if</span>&nbsp;<span class="builtintype" id="2676609">int</span><span class="op" id="2676612">(</span><span class="ident" id="2676613">k</span><span class="op" id="2676614">)</span>&nbsp;<span class="op" id="2676616">&lt;</span>&nbsp;<span class="builtinfunc" id="2676618">len</span><span class="op" id="2676621">(</span><span class="ident" id="2676622">kindNames</span><span class="op" id="2676631">)</span>&nbsp;<span class="op" id="2676633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2676637">return</span>&nbsp;<span class="ident" id="2676644">kindNames</span><span class="op" id="2676653">[</span><span class="ident" id="2676654">k</span><span class="op" id="2676655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2676658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2676661">return</span>&nbsp;<span class="string" id="2676668">&#34;kind&#34;</span>&nbsp;<span class="op" id="2676675">+</span>&nbsp;<span class="ident" id="2676677">strconv</span><span class="op" id="2676684">.</span><span class="ident" id="2676685">Itoa</span><span class="op" id="2676689">(</span><span class="builtintype" id="2676690">int</span><span class="op" id="2676693">(</span><span class="ident" id="2676694">k</span><span class="op" id="2676695">)</span><span class="op" id="2676696">)</span><br>
<span class="lineno">410</span><span class="op" id="2676698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2676701">var</span>&nbsp;<span class="ident" id="2676705">kindNames</span>&nbsp;<span class="op" id="2676715">=</span>&nbsp;<span class="op" id="2676717">[</span><span class="op" id="2676718">]</span><span class="builtintype" id="2676719">string</span><span class="op" id="2676725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676728">Invalid</span><span class="op" id="2676735">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676743">&#34;invalid&#34;</span><span class="op" id="2676752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676755">Bool</span><span class="op" id="2676759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676770">&#34;bool&#34;</span><span class="op" id="2676776">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676779">Int</span><span class="op" id="2676782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676794">&#34;int&#34;</span><span class="op" id="2676799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676802">Int8</span><span class="op" id="2676806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676817">&#34;int8&#34;</span><span class="op" id="2676823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676826">Int16</span><span class="op" id="2676831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676841">&#34;int16&#34;</span><span class="op" id="2676848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676851">Int32</span><span class="op" id="2676856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676866">&#34;int32&#34;</span><span class="op" id="2676873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676876">Int64</span><span class="op" id="2676881">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676891">&#34;int64&#34;</span><span class="op" id="2676898">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676901">Uint</span><span class="op" id="2676905">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676916">&#34;uint&#34;</span><span class="op" id="2676922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676925">Uint8</span><span class="op" id="2676930">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676940">&#34;uint8&#34;</span><span class="op" id="2676947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676950">Uint16</span><span class="op" id="2676956">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676965">&#34;uint16&#34;</span><span class="op" id="2676973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676976">Uint32</span><span class="op" id="2676982">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676991">&#34;uint32&#34;</span><span class="op" id="2676999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677002">Uint64</span><span class="op" id="2677008">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677017">&#34;uint64&#34;</span><span class="op" id="2677025">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677028">Uintptr</span><span class="op" id="2677035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677043">&#34;uintptr&#34;</span><span class="op" id="2677052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677055">Float32</span><span class="op" id="2677062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677070">&#34;float32&#34;</span><span class="op" id="2677079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677082">Float64</span><span class="op" id="2677089">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677097">&#34;float64&#34;</span><span class="op" id="2677106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677109">Complex64</span><span class="op" id="2677118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677124">&#34;complex64&#34;</span><span class="op" id="2677135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677138">Complex128</span><span class="op" id="2677148">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677153">&#34;complex128&#34;</span><span class="op" id="2677165">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677168">Array</span><span class="op" id="2677173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677183">&#34;array&#34;</span><span class="op" id="2677190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677193">Chan</span><span class="op" id="2677197">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677208">&#34;chan&#34;</span><span class="op" id="2677214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677217">Func</span><span class="op" id="2677221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677232">&#34;func&#34;</span><span class="op" id="2677238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677241">Interface</span><span class="op" id="2677250">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677256">&#34;interface&#34;</span><span class="op" id="2677267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677270">Map</span><span class="op" id="2677273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677285">&#34;map&#34;</span><span class="op" id="2677290">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677293">Ptr</span><span class="op" id="2677296">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677308">&#34;ptr&#34;</span><span class="op" id="2677313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677316">Slice</span><span class="op" id="2677321">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677331">&#34;slice&#34;</span><span class="op" id="2677338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677341">String</span><span class="op" id="2677347">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677356">&#34;string&#34;</span><span class="op" id="2677364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677367">Struct</span><span class="op" id="2677373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2677382">&#34;struct&#34;</span><span class="op" id="2677390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677393">UnsafePointer</span><span class="op" id="2677406">:</span>&nbsp;<span class="string" id="2677408">&#34;unsafe.Pointer&#34;</span><span class="op" id="2677424">,</span><br>
<span class="lineno">440</span><span class="op" id="2677426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2677429">func</span>&nbsp;<span class="op" id="2677434">(</span><span class="ident" id="2677435">t</span>&nbsp;<span class="op" id="2677437">*</span><span class="ident" id="2677438">uncommonType</span><span class="op" id="2677450">)</span>&nbsp;<span class="ident" id="2677452">uncommon</span><span class="op" id="2677460">(</span><span class="op" id="2677461">)</span>&nbsp;<span class="op" id="2677463">*</span><span class="ident" id="2677464">uncommonType</span>&nbsp;<span class="op" id="2677477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677480">return</span>&nbsp;<span class="ident" id="2677487">t</span><br>
<span class="lineno"></span><span class="op" id="2677489">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2677492">func</span>&nbsp;<span class="op" id="2677497">(</span><span class="ident" id="2677498">t</span>&nbsp;<span class="op" id="2677500">*</span><span class="ident" id="2677501">uncommonType</span><span class="op" id="2677513">)</span>&nbsp;<span class="ident" id="2677515">PkgPath</span><span class="op" id="2677522">(</span><span class="op" id="2677523">)</span>&nbsp;<span class="builtintype" id="2677525">string</span>&nbsp;<span class="op" id="2677532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677535">if</span>&nbsp;<span class="ident" id="2677538">t</span>&nbsp;<span class="op" id="2677540">==</span>&nbsp;<span class="ident" id="2677543">nil</span>&nbsp;<span class="op" id="2677547">||</span>&nbsp;<span class="ident" id="2677550">t</span><span class="op" id="2677551">.</span><span class="ident" id="2677552">pkgPath</span>&nbsp;<span class="op" id="2677560">==</span>&nbsp;<span class="ident" id="2677563">nil</span>&nbsp;<span class="op" id="2677567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677571">return</span>&nbsp;<span class="string" id="2677578">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2677582">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677585">return</span>&nbsp;<span class="op" id="2677592">*</span><span class="ident" id="2677593">t</span><span class="op" id="2677594">.</span><span class="ident" id="2677595">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2677603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2677606">func</span>&nbsp;<span class="op" id="2677611">(</span><span class="ident" id="2677612">t</span>&nbsp;<span class="op" id="2677614">*</span><span class="ident" id="2677615">uncommonType</span><span class="op" id="2677627">)</span>&nbsp;<span class="ident" id="2677629">Name</span><span class="op" id="2677633">(</span><span class="op" id="2677634">)</span>&nbsp;<span class="builtintype" id="2677636">string</span>&nbsp;<span class="op" id="2677643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677646">if</span>&nbsp;<span class="ident" id="2677649">t</span>&nbsp;<span class="op" id="2677651">==</span>&nbsp;<span class="ident" id="2677654">nil</span>&nbsp;<span class="op" id="2677658">||</span>&nbsp;<span class="ident" id="2677661">t</span><span class="op" id="2677662">.</span><span class="ident" id="2677663">name</span>&nbsp;<span class="op" id="2677668">==</span>&nbsp;<span class="ident" id="2677671">nil</span>&nbsp;<span class="op" id="2677675">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677679">return</span>&nbsp;<span class="string" id="2677686">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2677690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677693">return</span>&nbsp;<span class="op" id="2677700">*</span><span class="ident" id="2677701">t</span><span class="op" id="2677702">.</span><span class="ident" id="2677703">name</span><br>
<span class="lineno"></span><span class="op" id="2677708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2677711">func</span>&nbsp;<span class="op" id="2677716">(</span><span class="ident" id="2677717">t</span>&nbsp;<span class="op" id="2677719">*</span><span class="ident" id="2677720">rtype</span><span class="op" id="2677725">)</span>&nbsp;<span class="ident" id="2677727">String</span><span class="op" id="2677733">(</span><span class="op" id="2677734">)</span>&nbsp;<span class="builtintype" id="2677736">string</span>&nbsp;<span class="op" id="2677743">{</span>&nbsp;<span class="keyword" id="2677745">return</span>&nbsp;<span class="op" id="2677752">*</span><span class="ident" id="2677753">t</span><span class="op" id="2677754">.</span><span class="builtintype" id="2677755">string</span>&nbsp;<span class="op" id="2677762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2677765">func</span>&nbsp;<span class="op" id="2677770">(</span><span class="ident" id="2677771">t</span>&nbsp;<span class="op" id="2677773">*</span><span class="ident" id="2677774">rtype</span><span class="op" id="2677779">)</span>&nbsp;<span class="ident" id="2677781">Size</span><span class="op" id="2677785">(</span><span class="op" id="2677786">)</span>&nbsp;<span class="builtintype" id="2677788">uintptr</span>&nbsp;<span class="op" id="2677796">{</span>&nbsp;<span class="keyword" id="2677798">return</span>&nbsp;<span class="ident" id="2677805">t</span><span class="op" id="2677806">.</span><span class="ident" id="2677807">size</span>&nbsp;<span class="op" id="2677812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2677815">func</span>&nbsp;<span class="op" id="2677820">(</span><span class="ident" id="2677821">t</span>&nbsp;<span class="op" id="2677823">*</span><span class="ident" id="2677824">rtype</span><span class="op" id="2677829">)</span>&nbsp;<span class="ident" id="2677831">Bits</span><span class="op" id="2677835">(</span><span class="op" id="2677836">)</span>&nbsp;<span class="builtintype" id="2677838">int</span>&nbsp;<span class="op" id="2677842">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677845">if</span>&nbsp;<span class="ident" id="2677848">t</span>&nbsp;<span class="op" id="2677850">==</span>&nbsp;<span class="ident" id="2677853">nil</span>&nbsp;<span class="op" id="2677857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2677861">panic</span><span class="op" id="2677866">(</span><span class="string" id="2677867">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2677894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2677897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677900">k</span>&nbsp;<span class="op" id="2677902">:=</span>&nbsp;<span class="ident" id="2677905">t</span><span class="op" id="2677906">.</span><span class="ident" id="2677907">Kind</span><span class="op" id="2677911">(</span><span class="op" id="2677912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2677915">if</span>&nbsp;<span class="ident" id="2677918">k</span>&nbsp;<span class="op" id="2677920">&lt;</span>&nbsp;<span class="ident" id="2677922">Int</span>&nbsp;<span class="op" id="2677926">||</span>&nbsp;<span class="ident" id="2677929">k</span>&nbsp;<span class="op" id="2677931">&gt;</span>&nbsp;<span class="ident" id="2677933">Complex128</span>&nbsp;<span class="op" id="2677944">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2677948">panic</span><span class="op" id="2677953">(</span><span class="string" id="2677954">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2677994">+</span>&nbsp;<span class="ident" id="2677996">t</span><span class="op" id="2677997">.</span><span class="ident" id="2677998">String</span><span class="op" id="2678004">(</span><span class="op" id="2678005">)</span><span class="op" id="2678006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678012">return</span>&nbsp;<span class="builtintype" id="2678019">int</span><span class="op" id="2678022">(</span><span class="ident" id="2678023">t</span><span class="op" id="2678024">.</span><span class="ident" id="2678025">size</span><span class="op" id="2678029">)</span>&nbsp;<span class="op" id="2678031">*</span>&nbsp;<span class="num" id="2678033">8</span><br>
<span class="lineno"></span><span class="op" id="2678035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2678038">func</span>&nbsp;<span class="op" id="2678043">(</span><span class="ident" id="2678044">t</span>&nbsp;<span class="op" id="2678046">*</span><span class="ident" id="2678047">rtype</span><span class="op" id="2678052">)</span>&nbsp;<span class="ident" id="2678054">Align</span><span class="op" id="2678059">(</span><span class="op" id="2678060">)</span>&nbsp;<span class="builtintype" id="2678062">int</span>&nbsp;<span class="op" id="2678066">{</span>&nbsp;<span class="keyword" id="2678068">return</span>&nbsp;<span class="builtintype" id="2678075">int</span><span class="op" id="2678078">(</span><span class="ident" id="2678079">t</span><span class="op" id="2678080">.</span><span class="ident" id="2678081">align</span><span class="op" id="2678086">)</span>&nbsp;<span class="op" id="2678088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678091">func</span>&nbsp;<span class="op" id="2678096">(</span><span class="ident" id="2678097">t</span>&nbsp;<span class="op" id="2678099">*</span><span class="ident" id="2678100">rtype</span><span class="op" id="2678105">)</span>&nbsp;<span class="ident" id="2678107">FieldAlign</span><span class="op" id="2678117">(</span><span class="op" id="2678118">)</span>&nbsp;<span class="builtintype" id="2678120">int</span>&nbsp;<span class="op" id="2678124">{</span>&nbsp;<span class="keyword" id="2678126">return</span>&nbsp;<span class="builtintype" id="2678133">int</span><span class="op" id="2678136">(</span><span class="ident" id="2678137">t</span><span class="op" id="2678138">.</span><span class="ident" id="2678139">fieldAlign</span><span class="op" id="2678149">)</span>&nbsp;<span class="op" id="2678151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678154">func</span>&nbsp;<span class="op" id="2678159">(</span><span class="ident" id="2678160">t</span>&nbsp;<span class="op" id="2678162">*</span><span class="ident" id="2678163">rtype</span><span class="op" id="2678168">)</span>&nbsp;<span class="ident" id="2678170">Kind</span><span class="op" id="2678174">(</span><span class="op" id="2678175">)</span>&nbsp;<span class="ident" id="2678177">Kind</span>&nbsp;<span class="op" id="2678182">{</span>&nbsp;<span class="keyword" id="2678184">return</span>&nbsp;<span class="ident" id="2678191">Kind</span><span class="op" id="2678195">(</span><span class="ident" id="2678196">t</span><span class="op" id="2678197">.</span><span class="ident" id="2678198">kind</span>&nbsp;<span class="op" id="2678203">&amp;</span>&nbsp;<span class="ident" id="2678205">kindMask</span><span class="op" id="2678213">)</span>&nbsp;<span class="op" id="2678215">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2678218">func</span>&nbsp;<span class="op" id="2678223">(</span><span class="ident" id="2678224">t</span>&nbsp;<span class="op" id="2678226">*</span><span class="ident" id="2678227">rtype</span><span class="op" id="2678232">)</span>&nbsp;<span class="ident" id="2678234">pointers</span><span class="op" id="2678242">(</span><span class="op" id="2678243">)</span>&nbsp;<span class="builtintype" id="2678245">bool</span>&nbsp;<span class="op" id="2678250">{</span>&nbsp;<span class="keyword" id="2678252">return</span>&nbsp;<span class="ident" id="2678259">t</span><span class="op" id="2678260">.</span><span class="ident" id="2678261">kind</span><span class="op" id="2678265">&amp;</span><span class="ident" id="2678266">kindNoPointers</span>&nbsp;<span class="op" id="2678281">==</span>&nbsp;<span class="num" id="2678284">0</span>&nbsp;<span class="op" id="2678286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678289">func</span>&nbsp;<span class="op" id="2678294">(</span><span class="ident" id="2678295">t</span>&nbsp;<span class="op" id="2678297">*</span><span class="ident" id="2678298">rtype</span><span class="op" id="2678303">)</span>&nbsp;<span class="ident" id="2678305">common</span><span class="op" id="2678311">(</span><span class="op" id="2678312">)</span>&nbsp;<span class="op" id="2678314">*</span><span class="ident" id="2678315">rtype</span>&nbsp;<span class="op" id="2678321">{</span>&nbsp;<span class="keyword" id="2678323">return</span>&nbsp;<span class="ident" id="2678330">t</span>&nbsp;<span class="op" id="2678332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2678335">func</span>&nbsp;<span class="op" id="2678340">(</span><span class="ident" id="2678341">t</span>&nbsp;<span class="op" id="2678343">*</span><span class="ident" id="2678344">uncommonType</span><span class="op" id="2678356">)</span>&nbsp;<span class="ident" id="2678358">Method</span><span class="op" id="2678364">(</span><span class="ident" id="2678365">i</span>&nbsp;<span class="builtintype" id="2678367">int</span><span class="op" id="2678370">)</span>&nbsp;<span class="op" id="2678372">(</span><span class="ident" id="2678373">m</span>&nbsp;<span class="ident" id="2678375">Method</span><span class="op" id="2678381">)</span>&nbsp;<span class="op" id="2678383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678386">if</span>&nbsp;<span class="ident" id="2678389">t</span>&nbsp;<span class="op" id="2678391">==</span>&nbsp;<span class="ident" id="2678394">nil</span>&nbsp;<span class="op" id="2678398">||</span>&nbsp;<span class="ident" id="2678401">i</span>&nbsp;<span class="op" id="2678403">&lt;</span>&nbsp;<span class="num" id="2678405">0</span>&nbsp;<span class="op" id="2678407">||</span>&nbsp;<span class="ident" id="2678410">i</span>&nbsp;<span class="op" id="2678412">&gt;=</span>&nbsp;<span class="builtinfunc" id="2678415">len</span><span class="op" id="2678418">(</span><span class="ident" id="2678419">t</span><span class="op" id="2678420">.</span><span class="ident" id="2678421">methods</span><span class="op" id="2678428">)</span>&nbsp;<span class="op" id="2678430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2678434">panic</span><span class="op" id="2678439">(</span><span class="string" id="2678440">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2678476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678482">p</span>&nbsp;<span class="op" id="2678484">:=</span>&nbsp;<span class="op" id="2678487">&amp;</span><span class="ident" id="2678488">t</span><span class="op" id="2678489">.</span><span class="ident" id="2678490">methods</span><span class="op" id="2678497">[</span><span class="ident" id="2678498">i</span><span class="op" id="2678499">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678502">if</span>&nbsp;<span class="ident" id="2678505">p</span><span class="op" id="2678506">.</span><span class="ident" id="2678507">name</span>&nbsp;<span class="op" id="2678512">!=</span>&nbsp;<span class="ident" id="2678515">nil</span>&nbsp;<span class="op" id="2678519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678523">m</span><span class="op" id="2678524">.</span><span class="ident" id="2678525">Name</span>&nbsp;<span class="op" id="2678530">=</span>&nbsp;<span class="op" id="2678532">*</span><span class="ident" id="2678533">p</span><span class="op" id="2678534">.</span><span class="ident" id="2678535">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678544">fl</span>&nbsp;<span class="op" id="2678547">:=</span>&nbsp;<span class="ident" id="2678550">flag</span><span class="op" id="2678554">(</span><span class="ident" id="2678555">Func</span><span class="op" id="2678559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678562">if</span>&nbsp;<span class="ident" id="2678565">p</span><span class="op" id="2678566">.</span><span class="ident" id="2678567">pkgPath</span>&nbsp;<span class="op" id="2678575">!=</span>&nbsp;<span class="ident" id="2678578">nil</span>&nbsp;<span class="op" id="2678582">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678586">m</span><span class="op" id="2678587">.</span><span class="ident" id="2678588">PkgPath</span>&nbsp;<span class="op" id="2678596">=</span>&nbsp;<span class="op" id="2678598">*</span><span class="ident" id="2678599">p</span><span class="op" id="2678600">.</span><span class="ident" id="2678601">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678611">fl</span>&nbsp;<span class="op" id="2678614">|=</span>&nbsp;<span class="ident" id="2678617">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678628">mt</span>&nbsp;<span class="op" id="2678631">:=</span>&nbsp;<span class="ident" id="2678634">p</span><span class="op" id="2678635">.</span><span class="ident" id="2678636">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678641">m</span><span class="op" id="2678642">.</span><span class="ident" id="2678643">Type</span>&nbsp;<span class="op" id="2678648">=</span>&nbsp;<span class="ident" id="2678650">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678654">fn</span>&nbsp;<span class="op" id="2678657">:=</span>&nbsp;<span class="ident" id="2678660">unsafe</span><span class="op" id="2678666">.</span><span class="ident" id="2678667">Pointer</span><span class="op" id="2678674">(</span><span class="op" id="2678675">&amp;</span><span class="ident" id="2678676">p</span><span class="op" id="2678677">.</span><span class="ident" id="2678678">tfn</span><span class="op" id="2678681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678684">m</span><span class="op" id="2678685">.</span><span class="ident" id="2678686">Func</span>&nbsp;<span class="op" id="2678691">=</span>&nbsp;<span class="ident" id="2678693">Value</span><span class="op" id="2678698">{</span><span class="ident" id="2678699">mt</span><span class="op" id="2678701">,</span>&nbsp;<span class="ident" id="2678703">fn</span><span class="op" id="2678705">,</span>&nbsp;<span class="ident" id="2678707">fl</span><span class="op" id="2678709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678712">m</span><span class="op" id="2678713">.</span><span class="ident" id="2678714">Index</span>&nbsp;<span class="op" id="2678720">=</span>&nbsp;<span class="ident" id="2678722">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678725">return</span><br>
<span class="lineno"></span><span class="op" id="2678732">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2678735">func</span>&nbsp;<span class="op" id="2678740">(</span><span class="ident" id="2678741">t</span>&nbsp;<span class="op" id="2678743">*</span><span class="ident" id="2678744">uncommonType</span><span class="op" id="2678756">)</span>&nbsp;<span class="ident" id="2678758">NumMethod</span><span class="op" id="2678767">(</span><span class="op" id="2678768">)</span>&nbsp;<span class="builtintype" id="2678770">int</span>&nbsp;<span class="op" id="2678774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678777">if</span>&nbsp;<span class="ident" id="2678780">t</span>&nbsp;<span class="op" id="2678782">==</span>&nbsp;<span class="ident" id="2678785">nil</span>&nbsp;<span class="op" id="2678789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678793">return</span>&nbsp;<span class="num" id="2678800">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678803">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678806">return</span>&nbsp;<span class="builtinfunc" id="2678813">len</span><span class="op" id="2678816">(</span><span class="ident" id="2678817">t</span><span class="op" id="2678818">.</span><span class="ident" id="2678819">methods</span><span class="op" id="2678826">)</span><br>
<span class="lineno"></span><span class="op" id="2678828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678831">func</span>&nbsp;<span class="op" id="2678836">(</span><span class="ident" id="2678837">t</span>&nbsp;<span class="op" id="2678839">*</span><span class="ident" id="2678840">uncommonType</span><span class="op" id="2678852">)</span>&nbsp;<span class="ident" id="2678854">MethodByName</span><span class="op" id="2678866">(</span><span class="ident" id="2678867">name</span>&nbsp;<span class="builtintype" id="2678872">string</span><span class="op" id="2678878">)</span>&nbsp;<span class="op" id="2678880">(</span><span class="ident" id="2678881">m</span>&nbsp;<span class="ident" id="2678883">Method</span><span class="op" id="2678889">,</span>&nbsp;<span class="ident" id="2678891">ok</span>&nbsp;<span class="builtintype" id="2678894">bool</span><span class="op" id="2678898">)</span>&nbsp;<span class="op" id="2678900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678903">if</span>&nbsp;<span class="ident" id="2678906">t</span>&nbsp;<span class="op" id="2678908">==</span>&nbsp;<span class="ident" id="2678911">nil</span>&nbsp;<span class="op" id="2678915">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678919">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678930">var</span>&nbsp;<span class="ident" id="2678934">p</span>&nbsp;<span class="op" id="2678936">*</span><span class="ident" id="2678937">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678945">for</span>&nbsp;<span class="ident" id="2678949">i</span>&nbsp;<span class="op" id="2678951">:=</span>&nbsp;<span class="keyword" id="2678954">range</span>&nbsp;<span class="ident" id="2678960">t</span><span class="op" id="2678961">.</span><span class="ident" id="2678962">methods</span>&nbsp;<span class="op" id="2678970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678974">p</span>&nbsp;<span class="op" id="2678976">=</span>&nbsp;<span class="op" id="2678978">&amp;</span><span class="ident" id="2678979">t</span><span class="op" id="2678980">.</span><span class="ident" id="2678981">methods</span><span class="op" id="2678988">[</span><span class="ident" id="2678989">i</span><span class="op" id="2678990">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678994">if</span>&nbsp;<span class="ident" id="2678997">p</span><span class="op" id="2678998">.</span><span class="ident" id="2678999">name</span>&nbsp;<span class="op" id="2679004">!=</span>&nbsp;<span class="ident" id="2679007">nil</span>&nbsp;<span class="op" id="2679011">&amp;&amp;</span>&nbsp;<span class="op" id="2679014">*</span><span class="ident" id="2679015">p</span><span class="op" id="2679016">.</span><span class="ident" id="2679017">name</span>&nbsp;<span class="op" id="2679022">==</span>&nbsp;<span class="ident" id="2679025">name</span>&nbsp;<span class="op" id="2679030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679035">return</span>&nbsp;<span class="ident" id="2679042">t</span><span class="op" id="2679043">.</span><span class="ident" id="2679044">Method</span><span class="op" id="2679050">(</span><span class="ident" id="2679051">i</span><span class="op" id="2679052">)</span><span class="op" id="2679053">,</span>&nbsp;<span class="builtintype" id="2679055">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679068">return</span><br>
<span class="lineno">525</span><span class="op" id="2679075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2679078">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2679128">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2679183">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2679221">func</span>&nbsp;<span class="op" id="2679226">(</span><span class="ident" id="2679227">t</span>&nbsp;<span class="op" id="2679229">*</span><span class="ident" id="2679230">rtype</span><span class="op" id="2679235">)</span>&nbsp;<span class="ident" id="2679237">NumMethod</span><span class="op" id="2679246">(</span><span class="op" id="2679247">)</span>&nbsp;<span class="builtintype" id="2679249">int</span>&nbsp;<span class="op" id="2679253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679256">if</span>&nbsp;<span class="ident" id="2679259">t</span><span class="op" id="2679260">.</span><span class="ident" id="2679261">Kind</span><span class="op" id="2679265">(</span><span class="op" id="2679266">)</span>&nbsp;<span class="op" id="2679268">==</span>&nbsp;<span class="ident" id="2679271">Interface</span>&nbsp;<span class="op" id="2679281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679285">tt</span>&nbsp;<span class="op" id="2679288">:=</span>&nbsp;<span class="op" id="2679291">(</span><span class="op" id="2679292">*</span><span class="ident" id="2679293">interfaceType</span><span class="op" id="2679306">)</span><span class="op" id="2679307">(</span><span class="ident" id="2679308">unsafe</span><span class="op" id="2679314">.</span><span class="ident" id="2679315">Pointer</span><span class="op" id="2679322">(</span><span class="ident" id="2679323">t</span><span class="op" id="2679324">)</span><span class="op" id="2679325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679329">return</span>&nbsp;<span class="ident" id="2679336">tt</span><span class="op" id="2679338">.</span><span class="ident" id="2679339">NumMethod</span><span class="op" id="2679348">(</span><span class="op" id="2679349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679352">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679355">return</span>&nbsp;<span class="ident" id="2679362">t</span><span class="op" id="2679363">.</span><span class="ident" id="2679364">uncommonType</span><span class="op" id="2679376">.</span><span class="ident" id="2679377">NumMethod</span><span class="op" id="2679386">(</span><span class="op" id="2679387">)</span><br>
<span class="lineno"></span><span class="op" id="2679389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679392">func</span>&nbsp;<span class="op" id="2679397">(</span><span class="ident" id="2679398">t</span>&nbsp;<span class="op" id="2679400">*</span><span class="ident" id="2679401">rtype</span><span class="op" id="2679406">)</span>&nbsp;<span class="ident" id="2679408">Method</span><span class="op" id="2679414">(</span><span class="ident" id="2679415">i</span>&nbsp;<span class="builtintype" id="2679417">int</span><span class="op" id="2679420">)</span>&nbsp;<span class="op" id="2679422">(</span><span class="ident" id="2679423">m</span>&nbsp;<span class="ident" id="2679425">Method</span><span class="op" id="2679431">)</span>&nbsp;<span class="op" id="2679433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679436">if</span>&nbsp;<span class="ident" id="2679439">t</span><span class="op" id="2679440">.</span><span class="ident" id="2679441">Kind</span><span class="op" id="2679445">(</span><span class="op" id="2679446">)</span>&nbsp;<span class="op" id="2679448">==</span>&nbsp;<span class="ident" id="2679451">Interface</span>&nbsp;<span class="op" id="2679461">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679465">tt</span>&nbsp;<span class="op" id="2679468">:=</span>&nbsp;<span class="op" id="2679471">(</span><span class="op" id="2679472">*</span><span class="ident" id="2679473">interfaceType</span><span class="op" id="2679486">)</span><span class="op" id="2679487">(</span><span class="ident" id="2679488">unsafe</span><span class="op" id="2679494">.</span><span class="ident" id="2679495">Pointer</span><span class="op" id="2679502">(</span><span class="ident" id="2679503">t</span><span class="op" id="2679504">)</span><span class="op" id="2679505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679509">return</span>&nbsp;<span class="ident" id="2679516">tt</span><span class="op" id="2679518">.</span><span class="ident" id="2679519">Method</span><span class="op" id="2679525">(</span><span class="ident" id="2679526">i</span><span class="op" id="2679527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679533">return</span>&nbsp;<span class="ident" id="2679540">t</span><span class="op" id="2679541">.</span><span class="ident" id="2679542">uncommonType</span><span class="op" id="2679554">.</span><span class="ident" id="2679555">Method</span><span class="op" id="2679561">(</span><span class="ident" id="2679562">i</span><span class="op" id="2679563">)</span><br>
<span class="lineno"></span><span class="op" id="2679565">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2679568">func</span>&nbsp;<span class="op" id="2679573">(</span><span class="ident" id="2679574">t</span>&nbsp;<span class="op" id="2679576">*</span><span class="ident" id="2679577">rtype</span><span class="op" id="2679582">)</span>&nbsp;<span class="ident" id="2679584">MethodByName</span><span class="op" id="2679596">(</span><span class="ident" id="2679597">name</span>&nbsp;<span class="builtintype" id="2679602">string</span><span class="op" id="2679608">)</span>&nbsp;<span class="op" id="2679610">(</span><span class="ident" id="2679611">m</span>&nbsp;<span class="ident" id="2679613">Method</span><span class="op" id="2679619">,</span>&nbsp;<span class="ident" id="2679621">ok</span>&nbsp;<span class="builtintype" id="2679624">bool</span><span class="op" id="2679628">)</span>&nbsp;<span class="op" id="2679630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679633">if</span>&nbsp;<span class="ident" id="2679636">t</span><span class="op" id="2679637">.</span><span class="ident" id="2679638">Kind</span><span class="op" id="2679642">(</span><span class="op" id="2679643">)</span>&nbsp;<span class="op" id="2679645">==</span>&nbsp;<span class="ident" id="2679648">Interface</span>&nbsp;<span class="op" id="2679658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679662">tt</span>&nbsp;<span class="op" id="2679665">:=</span>&nbsp;<span class="op" id="2679668">(</span><span class="op" id="2679669">*</span><span class="ident" id="2679670">interfaceType</span><span class="op" id="2679683">)</span><span class="op" id="2679684">(</span><span class="ident" id="2679685">unsafe</span><span class="op" id="2679691">.</span><span class="ident" id="2679692">Pointer</span><span class="op" id="2679699">(</span><span class="ident" id="2679700">t</span><span class="op" id="2679701">)</span><span class="op" id="2679702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679706">return</span>&nbsp;<span class="ident" id="2679713">tt</span><span class="op" id="2679715">.</span><span class="ident" id="2679716">MethodByName</span><span class="op" id="2679728">(</span><span class="ident" id="2679729">name</span><span class="op" id="2679733">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679739">return</span>&nbsp;<span class="ident" id="2679746">t</span><span class="op" id="2679747">.</span><span class="ident" id="2679748">uncommonType</span><span class="op" id="2679760">.</span><span class="ident" id="2679761">MethodByName</span><span class="op" id="2679773">(</span><span class="ident" id="2679774">name</span><span class="op" id="2679778">)</span><br>
<span class="lineno"></span><span class="op" id="2679780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679783">func</span>&nbsp;<span class="op" id="2679788">(</span><span class="ident" id="2679789">t</span>&nbsp;<span class="op" id="2679791">*</span><span class="ident" id="2679792">rtype</span><span class="op" id="2679797">)</span>&nbsp;<span class="ident" id="2679799">PkgPath</span><span class="op" id="2679806">(</span><span class="op" id="2679807">)</span>&nbsp;<span class="builtintype" id="2679809">string</span>&nbsp;<span class="op" id="2679816">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679819">return</span>&nbsp;<span class="ident" id="2679826">t</span><span class="op" id="2679827">.</span><span class="ident" id="2679828">uncommonType</span><span class="op" id="2679840">.</span><span class="ident" id="2679841">PkgPath</span><span class="op" id="2679848">(</span><span class="op" id="2679849">)</span><br>
<span class="lineno"></span><span class="op" id="2679851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679854">func</span>&nbsp;<span class="op" id="2679859">(</span><span class="ident" id="2679860">t</span>&nbsp;<span class="op" id="2679862">*</span><span class="ident" id="2679863">rtype</span><span class="op" id="2679868">)</span>&nbsp;<span class="ident" id="2679870">Name</span><span class="op" id="2679874">(</span><span class="op" id="2679875">)</span>&nbsp;<span class="builtintype" id="2679877">string</span>&nbsp;<span class="op" id="2679884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679887">return</span>&nbsp;<span class="ident" id="2679894">t</span><span class="op" id="2679895">.</span><span class="ident" id="2679896">uncommonType</span><span class="op" id="2679908">.</span><span class="ident" id="2679909">Name</span><span class="op" id="2679913">(</span><span class="op" id="2679914">)</span><br>
<span class="lineno">560</span><span class="op" id="2679916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679919">func</span>&nbsp;<span class="op" id="2679924">(</span><span class="ident" id="2679925">t</span>&nbsp;<span class="op" id="2679927">*</span><span class="ident" id="2679928">rtype</span><span class="op" id="2679933">)</span>&nbsp;<span class="ident" id="2679935">ChanDir</span><span class="op" id="2679942">(</span><span class="op" id="2679943">)</span>&nbsp;<span class="ident" id="2679945">ChanDir</span>&nbsp;<span class="op" id="2679953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679956">if</span>&nbsp;<span class="ident" id="2679959">t</span><span class="op" id="2679960">.</span><span class="ident" id="2679961">Kind</span><span class="op" id="2679965">(</span><span class="op" id="2679966">)</span>&nbsp;<span class="op" id="2679968">!=</span>&nbsp;<span class="ident" id="2679971">Chan</span>&nbsp;<span class="op" id="2679976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2679980">panic</span><span class="op" id="2679985">(</span><span class="string" id="2679986">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2680021">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680027">tt</span>&nbsp;<span class="op" id="2680030">:=</span>&nbsp;<span class="op" id="2680033">(</span><span class="op" id="2680034">*</span><span class="ident" id="2680035">chanType</span><span class="op" id="2680043">)</span><span class="op" id="2680044">(</span><span class="ident" id="2680045">unsafe</span><span class="op" id="2680051">.</span><span class="ident" id="2680052">Pointer</span><span class="op" id="2680059">(</span><span class="ident" id="2680060">t</span><span class="op" id="2680061">)</span><span class="op" id="2680062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680065">return</span>&nbsp;<span class="ident" id="2680072">ChanDir</span><span class="op" id="2680079">(</span><span class="ident" id="2680080">tt</span><span class="op" id="2680082">.</span><span class="ident" id="2680083">dir</span><span class="op" id="2680086">)</span><br>
<span class="lineno"></span><span class="op" id="2680088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2680091">func</span>&nbsp;<span class="op" id="2680096">(</span><span class="ident" id="2680097">t</span>&nbsp;<span class="op" id="2680099">*</span><span class="ident" id="2680100">rtype</span><span class="op" id="2680105">)</span>&nbsp;<span class="ident" id="2680107">IsVariadic</span><span class="op" id="2680117">(</span><span class="op" id="2680118">)</span>&nbsp;<span class="builtintype" id="2680120">bool</span>&nbsp;<span class="op" id="2680125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680128">if</span>&nbsp;<span class="ident" id="2680131">t</span><span class="op" id="2680132">.</span><span class="ident" id="2680133">Kind</span><span class="op" id="2680137">(</span><span class="op" id="2680138">)</span>&nbsp;<span class="op" id="2680140">!=</span>&nbsp;<span class="ident" id="2680143">Func</span>&nbsp;<span class="op" id="2680148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2680152">panic</span><span class="op" id="2680157">(</span><span class="string" id="2680158">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2680196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680202">tt</span>&nbsp;<span class="op" id="2680205">:=</span>&nbsp;<span class="op" id="2680208">(</span><span class="op" id="2680209">*</span><span class="ident" id="2680210">funcType</span><span class="op" id="2680218">)</span><span class="op" id="2680219">(</span><span class="ident" id="2680220">unsafe</span><span class="op" id="2680226">.</span><span class="ident" id="2680227">Pointer</span><span class="op" id="2680234">(</span><span class="ident" id="2680235">t</span><span class="op" id="2680236">)</span><span class="op" id="2680237">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680240">return</span>&nbsp;<span class="ident" id="2680247">tt</span><span class="op" id="2680249">.</span><span class="ident" id="2680250">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2680260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2680263">func</span>&nbsp;<span class="op" id="2680268">(</span><span class="ident" id="2680269">t</span>&nbsp;<span class="op" id="2680271">*</span><span class="ident" id="2680272">rtype</span><span class="op" id="2680277">)</span>&nbsp;<span class="ident" id="2680279">Elem</span><span class="op" id="2680283">(</span><span class="op" id="2680284">)</span>&nbsp;<span class="ident" id="2680286">Type</span>&nbsp;<span class="op" id="2680291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680294">switch</span>&nbsp;<span class="ident" id="2680301">t</span><span class="op" id="2680302">.</span><span class="ident" id="2680303">Kind</span><span class="op" id="2680307">(</span><span class="op" id="2680308">)</span>&nbsp;<span class="op" id="2680310">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680313">case</span>&nbsp;<span class="ident" id="2680318">Array</span><span class="op" id="2680323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680327">tt</span>&nbsp;<span class="op" id="2680330">:=</span>&nbsp;<span class="op" id="2680333">(</span><span class="op" id="2680334">*</span><span class="ident" id="2680335">arrayType</span><span class="op" id="2680344">)</span><span class="op" id="2680345">(</span><span class="ident" id="2680346">unsafe</span><span class="op" id="2680352">.</span><span class="ident" id="2680353">Pointer</span><span class="op" id="2680360">(</span><span class="ident" id="2680361">t</span><span class="op" id="2680362">)</span><span class="op" id="2680363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680367">return</span>&nbsp;<span class="ident" id="2680374">toType</span><span class="op" id="2680380">(</span><span class="ident" id="2680381">tt</span><span class="op" id="2680383">.</span><span class="ident" id="2680384">elem</span><span class="op" id="2680388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680391">case</span>&nbsp;<span class="ident" id="2680396">Chan</span><span class="op" id="2680400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680404">tt</span>&nbsp;<span class="op" id="2680407">:=</span>&nbsp;<span class="op" id="2680410">(</span><span class="op" id="2680411">*</span><span class="ident" id="2680412">chanType</span><span class="op" id="2680420">)</span><span class="op" id="2680421">(</span><span class="ident" id="2680422">unsafe</span><span class="op" id="2680428">.</span><span class="ident" id="2680429">Pointer</span><span class="op" id="2680436">(</span><span class="ident" id="2680437">t</span><span class="op" id="2680438">)</span><span class="op" id="2680439">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680443">return</span>&nbsp;<span class="ident" id="2680450">toType</span><span class="op" id="2680456">(</span><span class="ident" id="2680457">tt</span><span class="op" id="2680459">.</span><span class="ident" id="2680460">elem</span><span class="op" id="2680464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680467">case</span>&nbsp;<span class="ident" id="2680472">Map</span><span class="op" id="2680475">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680479">tt</span>&nbsp;<span class="op" id="2680482">:=</span>&nbsp;<span class="op" id="2680485">(</span><span class="op" id="2680486">*</span><span class="ident" id="2680487">mapType</span><span class="op" id="2680494">)</span><span class="op" id="2680495">(</span><span class="ident" id="2680496">unsafe</span><span class="op" id="2680502">.</span><span class="ident" id="2680503">Pointer</span><span class="op" id="2680510">(</span><span class="ident" id="2680511">t</span><span class="op" id="2680512">)</span><span class="op" id="2680513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680517">return</span>&nbsp;<span class="ident" id="2680524">toType</span><span class="op" id="2680530">(</span><span class="ident" id="2680531">tt</span><span class="op" id="2680533">.</span><span class="ident" id="2680534">elem</span><span class="op" id="2680538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680541">case</span>&nbsp;<span class="ident" id="2680546">Ptr</span><span class="op" id="2680549">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680553">tt</span>&nbsp;<span class="op" id="2680556">:=</span>&nbsp;<span class="op" id="2680559">(</span><span class="op" id="2680560">*</span><span class="ident" id="2680561">ptrType</span><span class="op" id="2680568">)</span><span class="op" id="2680569">(</span><span class="ident" id="2680570">unsafe</span><span class="op" id="2680576">.</span><span class="ident" id="2680577">Pointer</span><span class="op" id="2680584">(</span><span class="ident" id="2680585">t</span><span class="op" id="2680586">)</span><span class="op" id="2680587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680591">return</span>&nbsp;<span class="ident" id="2680598">toType</span><span class="op" id="2680604">(</span><span class="ident" id="2680605">tt</span><span class="op" id="2680607">.</span><span class="ident" id="2680608">elem</span><span class="op" id="2680612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680615">case</span>&nbsp;<span class="ident" id="2680620">Slice</span><span class="op" id="2680625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680629">tt</span>&nbsp;<span class="op" id="2680632">:=</span>&nbsp;<span class="op" id="2680635">(</span><span class="op" id="2680636">*</span><span class="ident" id="2680637">sliceType</span><span class="op" id="2680646">)</span><span class="op" id="2680647">(</span><span class="ident" id="2680648">unsafe</span><span class="op" id="2680654">.</span><span class="ident" id="2680655">Pointer</span><span class="op" id="2680662">(</span><span class="ident" id="2680663">t</span><span class="op" id="2680664">)</span><span class="op" id="2680665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680669">return</span>&nbsp;<span class="ident" id="2680676">toType</span><span class="op" id="2680682">(</span><span class="ident" id="2680683">tt</span><span class="op" id="2680685">.</span><span class="ident" id="2680686">elem</span><span class="op" id="2680690">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2680696">panic</span><span class="op" id="2680701">(</span><span class="string" id="2680702">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2680733">)</span><br>
<span class="lineno"></span><span class="op" id="2680735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2680738">func</span>&nbsp;<span class="op" id="2680743">(</span><span class="ident" id="2680744">t</span>&nbsp;<span class="op" id="2680746">*</span><span class="ident" id="2680747">rtype</span><span class="op" id="2680752">)</span>&nbsp;<span class="ident" id="2680754">Field</span><span class="op" id="2680759">(</span><span class="ident" id="2680760">i</span>&nbsp;<span class="builtintype" id="2680762">int</span><span class="op" id="2680765">)</span>&nbsp;<span class="ident" id="2680767">StructField</span>&nbsp;<span class="op" id="2680779">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680782">if</span>&nbsp;<span class="ident" id="2680785">t</span><span class="op" id="2680786">.</span><span class="ident" id="2680787">Kind</span><span class="op" id="2680791">(</span><span class="op" id="2680792">)</span>&nbsp;<span class="op" id="2680794">!=</span>&nbsp;<span class="ident" id="2680797">Struct</span>&nbsp;<span class="op" id="2680804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2680808">panic</span><span class="op" id="2680813">(</span><span class="string" id="2680814">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2680849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680855">tt</span>&nbsp;<span class="op" id="2680858">:=</span>&nbsp;<span class="op" id="2680861">(</span><span class="op" id="2680862">*</span><span class="ident" id="2680863">structType</span><span class="op" id="2680873">)</span><span class="op" id="2680874">(</span><span class="ident" id="2680875">unsafe</span><span class="op" id="2680881">.</span><span class="ident" id="2680882">Pointer</span><span class="op" id="2680889">(</span><span class="ident" id="2680890">t</span><span class="op" id="2680891">)</span><span class="op" id="2680892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680895">return</span>&nbsp;<span class="ident" id="2680902">tt</span><span class="op" id="2680904">.</span><span class="ident" id="2680905">Field</span><span class="op" id="2680910">(</span><span class="ident" id="2680911">i</span><span class="op" id="2680912">)</span><br>
<span class="lineno">605</span><span class="op" id="2680914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2680917">func</span>&nbsp;<span class="op" id="2680922">(</span><span class="ident" id="2680923">t</span>&nbsp;<span class="op" id="2680925">*</span><span class="ident" id="2680926">rtype</span><span class="op" id="2680931">)</span>&nbsp;<span class="ident" id="2680933">FieldByIndex</span><span class="op" id="2680945">(</span><span class="ident" id="2680946">index</span>&nbsp;<span class="op" id="2680952">[</span><span class="op" id="2680953">]</span><span class="builtintype" id="2680954">int</span><span class="op" id="2680957">)</span>&nbsp;<span class="ident" id="2680959">StructField</span>&nbsp;<span class="op" id="2680971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680974">if</span>&nbsp;<span class="ident" id="2680977">t</span><span class="op" id="2680978">.</span><span class="ident" id="2680979">Kind</span><span class="op" id="2680983">(</span><span class="op" id="2680984">)</span>&nbsp;<span class="op" id="2680986">!=</span>&nbsp;<span class="ident" id="2680989">Struct</span>&nbsp;<span class="op" id="2680996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681000">panic</span><span class="op" id="2681005">(</span><span class="string" id="2681006">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2681048">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681054">tt</span>&nbsp;<span class="op" id="2681057">:=</span>&nbsp;<span class="op" id="2681060">(</span><span class="op" id="2681061">*</span><span class="ident" id="2681062">structType</span><span class="op" id="2681072">)</span><span class="op" id="2681073">(</span><span class="ident" id="2681074">unsafe</span><span class="op" id="2681080">.</span><span class="ident" id="2681081">Pointer</span><span class="op" id="2681088">(</span><span class="ident" id="2681089">t</span><span class="op" id="2681090">)</span><span class="op" id="2681091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681094">return</span>&nbsp;<span class="ident" id="2681101">tt</span><span class="op" id="2681103">.</span><span class="ident" id="2681104">FieldByIndex</span><span class="op" id="2681116">(</span><span class="ident" id="2681117">index</span><span class="op" id="2681122">)</span><br>
<span class="lineno"></span><span class="op" id="2681124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2681127">func</span>&nbsp;<span class="op" id="2681132">(</span><span class="ident" id="2681133">t</span>&nbsp;<span class="op" id="2681135">*</span><span class="ident" id="2681136">rtype</span><span class="op" id="2681141">)</span>&nbsp;<span class="ident" id="2681143">FieldByName</span><span class="op" id="2681154">(</span><span class="ident" id="2681155">name</span>&nbsp;<span class="builtintype" id="2681160">string</span><span class="op" id="2681166">)</span>&nbsp;<span class="op" id="2681168">(</span><span class="ident" id="2681169">StructField</span><span class="op" id="2681180">,</span>&nbsp;<span class="builtintype" id="2681182">bool</span><span class="op" id="2681186">)</span>&nbsp;<span class="op" id="2681188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681191">if</span>&nbsp;<span class="ident" id="2681194">t</span><span class="op" id="2681195">.</span><span class="ident" id="2681196">Kind</span><span class="op" id="2681200">(</span><span class="op" id="2681201">)</span>&nbsp;<span class="op" id="2681203">!=</span>&nbsp;<span class="ident" id="2681206">Struct</span>&nbsp;<span class="op" id="2681213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681217">panic</span><span class="op" id="2681222">(</span><span class="string" id="2681223">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2681264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681270">tt</span>&nbsp;<span class="op" id="2681273">:=</span>&nbsp;<span class="op" id="2681276">(</span><span class="op" id="2681277">*</span><span class="ident" id="2681278">structType</span><span class="op" id="2681288">)</span><span class="op" id="2681289">(</span><span class="ident" id="2681290">unsafe</span><span class="op" id="2681296">.</span><span class="ident" id="2681297">Pointer</span><span class="op" id="2681304">(</span><span class="ident" id="2681305">t</span><span class="op" id="2681306">)</span><span class="op" id="2681307">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681310">return</span>&nbsp;<span class="ident" id="2681317">tt</span><span class="op" id="2681319">.</span><span class="ident" id="2681320">FieldByName</span><span class="op" id="2681331">(</span><span class="ident" id="2681332">name</span><span class="op" id="2681336">)</span><br>
<span class="lineno"></span><span class="op" id="2681338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681341">func</span>&nbsp;<span class="op" id="2681346">(</span><span class="ident" id="2681347">t</span>&nbsp;<span class="op" id="2681349">*</span><span class="ident" id="2681350">rtype</span><span class="op" id="2681355">)</span>&nbsp;<span class="ident" id="2681357">FieldByNameFunc</span><span class="op" id="2681372">(</span><span class="ident" id="2681373">match</span>&nbsp;<span class="keyword" id="2681379">func</span><span class="op" id="2681383">(</span><span class="builtintype" id="2681384">string</span><span class="op" id="2681390">)</span>&nbsp;<span class="builtintype" id="2681392">bool</span><span class="op" id="2681396">)</span>&nbsp;<span class="op" id="2681398">(</span><span class="ident" id="2681399">StructField</span><span class="op" id="2681410">,</span>&nbsp;<span class="builtintype" id="2681412">bool</span><span class="op" id="2681416">)</span>&nbsp;<span class="op" id="2681418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681421">if</span>&nbsp;<span class="ident" id="2681424">t</span><span class="op" id="2681425">.</span><span class="ident" id="2681426">Kind</span><span class="op" id="2681430">(</span><span class="op" id="2681431">)</span>&nbsp;<span class="op" id="2681433">!=</span>&nbsp;<span class="ident" id="2681436">Struct</span>&nbsp;<span class="op" id="2681443">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681447">panic</span><span class="op" id="2681452">(</span><span class="string" id="2681453">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2681498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681504">tt</span>&nbsp;<span class="op" id="2681507">:=</span>&nbsp;<span class="op" id="2681510">(</span><span class="op" id="2681511">*</span><span class="ident" id="2681512">structType</span><span class="op" id="2681522">)</span><span class="op" id="2681523">(</span><span class="ident" id="2681524">unsafe</span><span class="op" id="2681530">.</span><span class="ident" id="2681531">Pointer</span><span class="op" id="2681538">(</span><span class="ident" id="2681539">t</span><span class="op" id="2681540">)</span><span class="op" id="2681541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681544">return</span>&nbsp;<span class="ident" id="2681551">tt</span><span class="op" id="2681553">.</span><span class="ident" id="2681554">FieldByNameFunc</span><span class="op" id="2681569">(</span><span class="ident" id="2681570">match</span><span class="op" id="2681575">)</span><br>
<span class="lineno"></span><span class="op" id="2681577">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2681580">func</span>&nbsp;<span class="op" id="2681585">(</span><span class="ident" id="2681586">t</span>&nbsp;<span class="op" id="2681588">*</span><span class="ident" id="2681589">rtype</span><span class="op" id="2681594">)</span>&nbsp;<span class="ident" id="2681596">In</span><span class="op" id="2681598">(</span><span class="ident" id="2681599">i</span>&nbsp;<span class="builtintype" id="2681601">int</span><span class="op" id="2681604">)</span>&nbsp;<span class="ident" id="2681606">Type</span>&nbsp;<span class="op" id="2681611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681614">if</span>&nbsp;<span class="ident" id="2681617">t</span><span class="op" id="2681618">.</span><span class="ident" id="2681619">Kind</span><span class="op" id="2681623">(</span><span class="op" id="2681624">)</span>&nbsp;<span class="op" id="2681626">!=</span>&nbsp;<span class="ident" id="2681629">Func</span>&nbsp;<span class="op" id="2681634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681638">panic</span><span class="op" id="2681643">(</span><span class="string" id="2681644">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2681674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681677">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681680">tt</span>&nbsp;<span class="op" id="2681683">:=</span>&nbsp;<span class="op" id="2681686">(</span><span class="op" id="2681687">*</span><span class="ident" id="2681688">funcType</span><span class="op" id="2681696">)</span><span class="op" id="2681697">(</span><span class="ident" id="2681698">unsafe</span><span class="op" id="2681704">.</span><span class="ident" id="2681705">Pointer</span><span class="op" id="2681712">(</span><span class="ident" id="2681713">t</span><span class="op" id="2681714">)</span><span class="op" id="2681715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681718">return</span>&nbsp;<span class="ident" id="2681725">toType</span><span class="op" id="2681731">(</span><span class="ident" id="2681732">tt</span><span class="op" id="2681734">.</span><span class="ident" id="2681735">in</span><span class="op" id="2681737">[</span><span class="ident" id="2681738">i</span><span class="op" id="2681739">]</span><span class="op" id="2681740">)</span><br>
<span class="lineno"></span><span class="op" id="2681742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681745">func</span>&nbsp;<span class="op" id="2681750">(</span><span class="ident" id="2681751">t</span>&nbsp;<span class="op" id="2681753">*</span><span class="ident" id="2681754">rtype</span><span class="op" id="2681759">)</span>&nbsp;<span class="ident" id="2681761">Key</span><span class="op" id="2681764">(</span><span class="op" id="2681765">)</span>&nbsp;<span class="ident" id="2681767">Type</span>&nbsp;<span class="op" id="2681772">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681775">if</span>&nbsp;<span class="ident" id="2681778">t</span><span class="op" id="2681779">.</span><span class="ident" id="2681780">Kind</span><span class="op" id="2681784">(</span><span class="op" id="2681785">)</span>&nbsp;<span class="op" id="2681787">!=</span>&nbsp;<span class="ident" id="2681790">Map</span>&nbsp;<span class="op" id="2681794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681798">panic</span><span class="op" id="2681803">(</span><span class="string" id="2681804">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2681834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681840">tt</span>&nbsp;<span class="op" id="2681843">:=</span>&nbsp;<span class="op" id="2681846">(</span><span class="op" id="2681847">*</span><span class="ident" id="2681848">mapType</span><span class="op" id="2681855">)</span><span class="op" id="2681856">(</span><span class="ident" id="2681857">unsafe</span><span class="op" id="2681863">.</span><span class="ident" id="2681864">Pointer</span><span class="op" id="2681871">(</span><span class="ident" id="2681872">t</span><span class="op" id="2681873">)</span><span class="op" id="2681874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681877">return</span>&nbsp;<span class="ident" id="2681884">toType</span><span class="op" id="2681890">(</span><span class="ident" id="2681891">tt</span><span class="op" id="2681893">.</span><span class="ident" id="2681894">key</span><span class="op" id="2681897">)</span><br>
<span class="lineno">645</span><span class="op" id="2681899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681902">func</span>&nbsp;<span class="op" id="2681907">(</span><span class="ident" id="2681908">t</span>&nbsp;<span class="op" id="2681910">*</span><span class="ident" id="2681911">rtype</span><span class="op" id="2681916">)</span>&nbsp;<span class="ident" id="2681918">Len</span><span class="op" id="2681921">(</span><span class="op" id="2681922">)</span>&nbsp;<span class="builtintype" id="2681924">int</span>&nbsp;<span class="op" id="2681928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681931">if</span>&nbsp;<span class="ident" id="2681934">t</span><span class="op" id="2681935">.</span><span class="ident" id="2681936">Kind</span><span class="op" id="2681940">(</span><span class="op" id="2681941">)</span>&nbsp;<span class="op" id="2681943">!=</span>&nbsp;<span class="ident" id="2681946">Array</span>&nbsp;<span class="op" id="2681952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681956">panic</span><span class="op" id="2681961">(</span><span class="string" id="2681962">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2681994">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682000">tt</span>&nbsp;<span class="op" id="2682003">:=</span>&nbsp;<span class="op" id="2682006">(</span><span class="op" id="2682007">*</span><span class="ident" id="2682008">arrayType</span><span class="op" id="2682017">)</span><span class="op" id="2682018">(</span><span class="ident" id="2682019">unsafe</span><span class="op" id="2682025">.</span><span class="ident" id="2682026">Pointer</span><span class="op" id="2682033">(</span><span class="ident" id="2682034">t</span><span class="op" id="2682035">)</span><span class="op" id="2682036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682039">return</span>&nbsp;<span class="builtintype" id="2682046">int</span><span class="op" id="2682049">(</span><span class="ident" id="2682050">tt</span><span class="op" id="2682052">.</span><span class="builtinfunc" id="2682053">len</span><span class="op" id="2682056">)</span><br>
<span class="lineno"></span><span class="op" id="2682058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2682061">func</span>&nbsp;<span class="op" id="2682066">(</span><span class="ident" id="2682067">t</span>&nbsp;<span class="op" id="2682069">*</span><span class="ident" id="2682070">rtype</span><span class="op" id="2682075">)</span>&nbsp;<span class="ident" id="2682077">NumField</span><span class="op" id="2682085">(</span><span class="op" id="2682086">)</span>&nbsp;<span class="builtintype" id="2682088">int</span>&nbsp;<span class="op" id="2682092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682095">if</span>&nbsp;<span class="ident" id="2682098">t</span><span class="op" id="2682099">.</span><span class="ident" id="2682100">Kind</span><span class="op" id="2682104">(</span><span class="op" id="2682105">)</span>&nbsp;<span class="op" id="2682107">!=</span>&nbsp;<span class="ident" id="2682110">Struct</span>&nbsp;<span class="op" id="2682117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682121">panic</span><span class="op" id="2682126">(</span><span class="string" id="2682127">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2682165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682171">tt</span>&nbsp;<span class="op" id="2682174">:=</span>&nbsp;<span class="op" id="2682177">(</span><span class="op" id="2682178">*</span><span class="ident" id="2682179">structType</span><span class="op" id="2682189">)</span><span class="op" id="2682190">(</span><span class="ident" id="2682191">unsafe</span><span class="op" id="2682197">.</span><span class="ident" id="2682198">Pointer</span><span class="op" id="2682205">(</span><span class="ident" id="2682206">t</span><span class="op" id="2682207">)</span><span class="op" id="2682208">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682211">return</span>&nbsp;<span class="builtinfunc" id="2682218">len</span><span class="op" id="2682221">(</span><span class="ident" id="2682222">tt</span><span class="op" id="2682224">.</span><span class="ident" id="2682225">fields</span><span class="op" id="2682231">)</span><br>
<span class="lineno"></span><span class="op" id="2682233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682236">func</span>&nbsp;<span class="op" id="2682241">(</span><span class="ident" id="2682242">t</span>&nbsp;<span class="op" id="2682244">*</span><span class="ident" id="2682245">rtype</span><span class="op" id="2682250">)</span>&nbsp;<span class="ident" id="2682252">NumIn</span><span class="op" id="2682257">(</span><span class="op" id="2682258">)</span>&nbsp;<span class="builtintype" id="2682260">int</span>&nbsp;<span class="op" id="2682264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682267">if</span>&nbsp;<span class="ident" id="2682270">t</span><span class="op" id="2682271">.</span><span class="ident" id="2682272">Kind</span><span class="op" id="2682276">(</span><span class="op" id="2682277">)</span>&nbsp;<span class="op" id="2682279">!=</span>&nbsp;<span class="ident" id="2682282">Func</span>&nbsp;<span class="op" id="2682287">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682291">panic</span><span class="op" id="2682296">(</span><span class="string" id="2682297">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2682330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682336">tt</span>&nbsp;<span class="op" id="2682339">:=</span>&nbsp;<span class="op" id="2682342">(</span><span class="op" id="2682343">*</span><span class="ident" id="2682344">funcType</span><span class="op" id="2682352">)</span><span class="op" id="2682353">(</span><span class="ident" id="2682354">unsafe</span><span class="op" id="2682360">.</span><span class="ident" id="2682361">Pointer</span><span class="op" id="2682368">(</span><span class="ident" id="2682369">t</span><span class="op" id="2682370">)</span><span class="op" id="2682371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682374">return</span>&nbsp;<span class="builtinfunc" id="2682381">len</span><span class="op" id="2682384">(</span><span class="ident" id="2682385">tt</span><span class="op" id="2682387">.</span><span class="ident" id="2682388">in</span><span class="op" id="2682390">)</span><br>
<span class="lineno"></span><span class="op" id="2682392">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2682395">func</span>&nbsp;<span class="op" id="2682400">(</span><span class="ident" id="2682401">t</span>&nbsp;<span class="op" id="2682403">*</span><span class="ident" id="2682404">rtype</span><span class="op" id="2682409">)</span>&nbsp;<span class="ident" id="2682411">NumOut</span><span class="op" id="2682417">(</span><span class="op" id="2682418">)</span>&nbsp;<span class="builtintype" id="2682420">int</span>&nbsp;<span class="op" id="2682424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682427">if</span>&nbsp;<span class="ident" id="2682430">t</span><span class="op" id="2682431">.</span><span class="ident" id="2682432">Kind</span><span class="op" id="2682436">(</span><span class="op" id="2682437">)</span>&nbsp;<span class="op" id="2682439">!=</span>&nbsp;<span class="ident" id="2682442">Func</span>&nbsp;<span class="op" id="2682447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682451">panic</span><span class="op" id="2682456">(</span><span class="string" id="2682457">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2682491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682494">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682497">tt</span>&nbsp;<span class="op" id="2682500">:=</span>&nbsp;<span class="op" id="2682503">(</span><span class="op" id="2682504">*</span><span class="ident" id="2682505">funcType</span><span class="op" id="2682513">)</span><span class="op" id="2682514">(</span><span class="ident" id="2682515">unsafe</span><span class="op" id="2682521">.</span><span class="ident" id="2682522">Pointer</span><span class="op" id="2682529">(</span><span class="ident" id="2682530">t</span><span class="op" id="2682531">)</span><span class="op" id="2682532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682535">return</span>&nbsp;<span class="builtinfunc" id="2682542">len</span><span class="op" id="2682545">(</span><span class="ident" id="2682546">tt</span><span class="op" id="2682548">.</span><span class="ident" id="2682549">out</span><span class="op" id="2682552">)</span><br>
<span class="lineno"></span><span class="op" id="2682554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682557">func</span>&nbsp;<span class="op" id="2682562">(</span><span class="ident" id="2682563">t</span>&nbsp;<span class="op" id="2682565">*</span><span class="ident" id="2682566">rtype</span><span class="op" id="2682571">)</span>&nbsp;<span class="ident" id="2682573">Out</span><span class="op" id="2682576">(</span><span class="ident" id="2682577">i</span>&nbsp;<span class="builtintype" id="2682579">int</span><span class="op" id="2682582">)</span>&nbsp;<span class="ident" id="2682584">Type</span>&nbsp;<span class="op" id="2682589">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682592">if</span>&nbsp;<span class="ident" id="2682595">t</span><span class="op" id="2682596">.</span><span class="ident" id="2682597">Kind</span><span class="op" id="2682601">(</span><span class="op" id="2682602">)</span>&nbsp;<span class="op" id="2682604">!=</span>&nbsp;<span class="ident" id="2682607">Func</span>&nbsp;<span class="op" id="2682612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682616">panic</span><span class="op" id="2682621">(</span><span class="string" id="2682622">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2682653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682659">tt</span>&nbsp;<span class="op" id="2682662">:=</span>&nbsp;<span class="op" id="2682665">(</span><span class="op" id="2682666">*</span><span class="ident" id="2682667">funcType</span><span class="op" id="2682675">)</span><span class="op" id="2682676">(</span><span class="ident" id="2682677">unsafe</span><span class="op" id="2682683">.</span><span class="ident" id="2682684">Pointer</span><span class="op" id="2682691">(</span><span class="ident" id="2682692">t</span><span class="op" id="2682693">)</span><span class="op" id="2682694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682697">return</span>&nbsp;<span class="ident" id="2682704">toType</span><span class="op" id="2682710">(</span><span class="ident" id="2682711">tt</span><span class="op" id="2682713">.</span><span class="ident" id="2682714">out</span><span class="op" id="2682717">[</span><span class="ident" id="2682718">i</span><span class="op" id="2682719">]</span><span class="op" id="2682720">)</span><br>
<span class="lineno">685</span><span class="op" id="2682722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682725">func</span>&nbsp;<span class="op" id="2682730">(</span><span class="ident" id="2682731">d</span>&nbsp;<span class="ident" id="2682733">ChanDir</span><span class="op" id="2682740">)</span>&nbsp;<span class="ident" id="2682742">String</span><span class="op" id="2682748">(</span><span class="op" id="2682749">)</span>&nbsp;<span class="builtintype" id="2682751">string</span>&nbsp;<span class="op" id="2682758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682761">switch</span>&nbsp;<span class="ident" id="2682768">d</span>&nbsp;<span class="op" id="2682770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682773">case</span>&nbsp;<span class="ident" id="2682778">SendDir</span><span class="op" id="2682785">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682789">return</span>&nbsp;<span class="string" id="2682796">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682806">case</span>&nbsp;<span class="ident" id="2682811">RecvDir</span><span class="op" id="2682818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682822">return</span>&nbsp;<span class="string" id="2682829">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682839">case</span>&nbsp;<span class="ident" id="2682844">BothDir</span><span class="op" id="2682851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682855">return</span>&nbsp;<span class="string" id="2682862">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682873">return</span>&nbsp;<span class="string" id="2682880">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2682890">+</span>&nbsp;<span class="ident" id="2682892">strconv</span><span class="op" id="2682899">.</span><span class="ident" id="2682900">Itoa</span><span class="op" id="2682904">(</span><span class="builtintype" id="2682905">int</span><span class="op" id="2682908">(</span><span class="ident" id="2682909">d</span><span class="op" id="2682910">)</span><span class="op" id="2682911">)</span><br>
<span class="lineno"></span><span class="op" id="2682913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2682916">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2682976">func</span>&nbsp;<span class="op" id="2682981">(</span><span class="ident" id="2682982">t</span>&nbsp;<span class="op" id="2682984">*</span><span class="ident" id="2682985">interfaceType</span><span class="op" id="2682998">)</span>&nbsp;<span class="ident" id="2683000">Method</span><span class="op" id="2683006">(</span><span class="ident" id="2683007">i</span>&nbsp;<span class="builtintype" id="2683009">int</span><span class="op" id="2683012">)</span>&nbsp;<span class="op" id="2683014">(</span><span class="ident" id="2683015">m</span>&nbsp;<span class="ident" id="2683017">Method</span><span class="op" id="2683023">)</span>&nbsp;<span class="op" id="2683025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683028">if</span>&nbsp;<span class="ident" id="2683031">i</span>&nbsp;<span class="op" id="2683033">&lt;</span>&nbsp;<span class="num" id="2683035">0</span>&nbsp;<span class="op" id="2683037">||</span>&nbsp;<span class="ident" id="2683040">i</span>&nbsp;<span class="op" id="2683042">&gt;=</span>&nbsp;<span class="builtinfunc" id="2683045">len</span><span class="op" id="2683048">(</span><span class="ident" id="2683049">t</span><span class="op" id="2683050">.</span><span class="ident" id="2683051">methods</span><span class="op" id="2683058">)</span>&nbsp;<span class="op" id="2683060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683064">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683075">p</span>&nbsp;<span class="op" id="2683077">:=</span>&nbsp;<span class="op" id="2683080">&amp;</span><span class="ident" id="2683081">t</span><span class="op" id="2683082">.</span><span class="ident" id="2683083">methods</span><span class="op" id="2683090">[</span><span class="ident" id="2683091">i</span><span class="op" id="2683092">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683095">m</span><span class="op" id="2683096">.</span><span class="ident" id="2683097">Name</span>&nbsp;<span class="op" id="2683102">=</span>&nbsp;<span class="op" id="2683104">*</span><span class="ident" id="2683105">p</span><span class="op" id="2683106">.</span><span class="ident" id="2683107">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683113">if</span>&nbsp;<span class="ident" id="2683116">p</span><span class="op" id="2683117">.</span><span class="ident" id="2683118">pkgPath</span>&nbsp;<span class="op" id="2683126">!=</span>&nbsp;<span class="ident" id="2683129">nil</span>&nbsp;<span class="op" id="2683133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683137">m</span><span class="op" id="2683138">.</span><span class="ident" id="2683139">PkgPath</span>&nbsp;<span class="op" id="2683147">=</span>&nbsp;<span class="op" id="2683149">*</span><span class="ident" id="2683150">p</span><span class="op" id="2683151">.</span><span class="ident" id="2683152">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683164">m</span><span class="op" id="2683165">.</span><span class="ident" id="2683166">Type</span>&nbsp;<span class="op" id="2683171">=</span>&nbsp;<span class="ident" id="2683173">toType</span><span class="op" id="2683179">(</span><span class="ident" id="2683180">p</span><span class="op" id="2683181">.</span><span class="ident" id="2683182">typ</span><span class="op" id="2683185">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683188">m</span><span class="op" id="2683189">.</span><span class="ident" id="2683190">Index</span>&nbsp;<span class="op" id="2683196">=</span>&nbsp;<span class="ident" id="2683198">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683201">return</span><br>
<span class="lineno"></span><span class="op" id="2683208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2683211">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2683290">func</span>&nbsp;<span class="op" id="2683295">(</span><span class="ident" id="2683296">t</span>&nbsp;<span class="op" id="2683298">*</span><span class="ident" id="2683299">interfaceType</span><span class="op" id="2683312">)</span>&nbsp;<span class="ident" id="2683314">NumMethod</span><span class="op" id="2683323">(</span><span class="op" id="2683324">)</span>&nbsp;<span class="builtintype" id="2683326">int</span>&nbsp;<span class="op" id="2683330">{</span>&nbsp;<span class="keyword" id="2683332">return</span>&nbsp;<span class="builtinfunc" id="2683339">len</span><span class="op" id="2683342">(</span><span class="ident" id="2683343">t</span><span class="op" id="2683344">.</span><span class="ident" id="2683345">methods</span><span class="op" id="2683352">)</span>&nbsp;<span class="op" id="2683354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2683357">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2683426">func</span>&nbsp;<span class="op" id="2683431">(</span><span class="ident" id="2683432">t</span>&nbsp;<span class="op" id="2683434">*</span><span class="ident" id="2683435">interfaceType</span><span class="op" id="2683448">)</span>&nbsp;<span class="ident" id="2683450">MethodByName</span><span class="op" id="2683462">(</span><span class="ident" id="2683463">name</span>&nbsp;<span class="builtintype" id="2683468">string</span><span class="op" id="2683474">)</span>&nbsp;<span class="op" id="2683476">(</span><span class="ident" id="2683477">m</span>&nbsp;<span class="ident" id="2683479">Method</span><span class="op" id="2683485">,</span>&nbsp;<span class="ident" id="2683487">ok</span>&nbsp;<span class="builtintype" id="2683490">bool</span><span class="op" id="2683494">)</span>&nbsp;<span class="op" id="2683496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683499">if</span>&nbsp;<span class="ident" id="2683502">t</span>&nbsp;<span class="op" id="2683504">==</span>&nbsp;<span class="ident" id="2683507">nil</span>&nbsp;<span class="op" id="2683511">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683515">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683526">var</span>&nbsp;<span class="ident" id="2683530">p</span>&nbsp;<span class="op" id="2683532">*</span><span class="ident" id="2683533">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683542">for</span>&nbsp;<span class="ident" id="2683546">i</span>&nbsp;<span class="op" id="2683548">:=</span>&nbsp;<span class="keyword" id="2683551">range</span>&nbsp;<span class="ident" id="2683557">t</span><span class="op" id="2683558">.</span><span class="ident" id="2683559">methods</span>&nbsp;<span class="op" id="2683567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683571">p</span>&nbsp;<span class="op" id="2683573">=</span>&nbsp;<span class="op" id="2683575">&amp;</span><span class="ident" id="2683576">t</span><span class="op" id="2683577">.</span><span class="ident" id="2683578">methods</span><span class="op" id="2683585">[</span><span class="ident" id="2683586">i</span><span class="op" id="2683587">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683591">if</span>&nbsp;<span class="op" id="2683594">*</span><span class="ident" id="2683595">p</span><span class="op" id="2683596">.</span><span class="ident" id="2683597">name</span>&nbsp;<span class="op" id="2683602">==</span>&nbsp;<span class="ident" id="2683605">name</span>&nbsp;<span class="op" id="2683610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683615">return</span>&nbsp;<span class="ident" id="2683622">t</span><span class="op" id="2683623">.</span><span class="ident" id="2683624">Method</span><span class="op" id="2683630">(</span><span class="ident" id="2683631">i</span><span class="op" id="2683632">)</span><span class="op" id="2683633">,</span>&nbsp;<span class="builtintype" id="2683635">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683648">return</span><br>
<span class="lineno">730</span><span class="op" id="2683655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2683658">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2683713">type</span>&nbsp;<span class="ident" id="2683718">StructField</span>&nbsp;<span class="keyword" id="2683730">struct</span>&nbsp;<span class="op" id="2683737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683740">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683768">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683841">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683909">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683970">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2683978">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683986">PkgPath</span>&nbsp;<span class="builtintype" id="2683994">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684003">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684013">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2684023">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684038">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684048">StructTag</span>&nbsp;<span class="comment" id="2684058">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684079">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684089">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2684099">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684134">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684144">[</span><span class="op" id="2684145">]</span><span class="builtintype" id="2684146">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2684154">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684195">Anonymous</span>&nbsp;<span class="builtintype" id="2684205">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2684215">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2684239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684242">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2684294">//</span><br>
<span class="lineno">750</span><span class="comment" id="2684297">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2684350">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2684399">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2684459">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2684524">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2684590">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2684634">type</span>&nbsp;<span class="ident" id="2684639">StructTag</span>&nbsp;<span class="builtintype" id="2684649">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684657">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2684721">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2684790">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2684853">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2684888">func</span>&nbsp;<span class="op" id="2684893">(</span><span class="ident" id="2684894">tag</span>&nbsp;<span class="ident" id="2684898">StructTag</span><span class="op" id="2684907">)</span>&nbsp;<span class="ident" id="2684909">Get</span><span class="op" id="2684912">(</span><span class="ident" id="2684913">key</span>&nbsp;<span class="builtintype" id="2684917">string</span><span class="op" id="2684923">)</span>&nbsp;<span class="builtintype" id="2684925">string</span>&nbsp;<span class="op" id="2684932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684935">for</span>&nbsp;<span class="ident" id="2684939">tag</span>&nbsp;<span class="op" id="2684943">!=</span>&nbsp;<span class="string" id="2684946">&#34;&#34;</span>&nbsp;<span class="op" id="2684949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2684953">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684977">i</span>&nbsp;<span class="op" id="2684979">:=</span>&nbsp;<span class="num" id="2684982">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684986">for</span>&nbsp;<span class="ident" id="2684990">i</span>&nbsp;<span class="op" id="2684992">&lt;</span>&nbsp;<span class="builtinfunc" id="2684994">len</span><span class="op" id="2684997">(</span><span class="ident" id="2684998">tag</span><span class="op" id="2685001">)</span>&nbsp;<span class="op" id="2685003">&amp;&amp;</span>&nbsp;<span class="ident" id="2685006">tag</span><span class="op" id="2685009">[</span><span class="ident" id="2685010">i</span><span class="op" id="2685011">]</span>&nbsp;<span class="op" id="2685013">==</span>&nbsp;<span class="string" id="2685016">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2685020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685025">i</span><span class="op" id="2685026">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685035">tag</span>&nbsp;<span class="op" id="2685039">=</span>&nbsp;<span class="ident" id="2685041">tag</span><span class="op" id="2685044">[</span><span class="ident" id="2685045">i</span><span class="op" id="2685046">:</span><span class="op" id="2685047">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685051">if</span>&nbsp;<span class="ident" id="2685054">tag</span>&nbsp;<span class="op" id="2685058">==</span>&nbsp;<span class="string" id="2685061">&#34;&#34;</span>&nbsp;<span class="op" id="2685064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685069">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685082">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685102">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685144">i</span>&nbsp;<span class="op" id="2685146">=</span>&nbsp;<span class="num" id="2685148">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685152">for</span>&nbsp;<span class="ident" id="2685156">i</span>&nbsp;<span class="op" id="2685158">&lt;</span>&nbsp;<span class="builtinfunc" id="2685160">len</span><span class="op" id="2685163">(</span><span class="ident" id="2685164">tag</span><span class="op" id="2685167">)</span>&nbsp;<span class="op" id="2685169">&amp;&amp;</span>&nbsp;<span class="ident" id="2685172">tag</span><span class="op" id="2685175">[</span><span class="ident" id="2685176">i</span><span class="op" id="2685177">]</span>&nbsp;<span class="op" id="2685179">!=</span>&nbsp;<span class="string" id="2685182">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2685186">&amp;&amp;</span>&nbsp;<span class="ident" id="2685189">tag</span><span class="op" id="2685192">[</span><span class="ident" id="2685193">i</span><span class="op" id="2685194">]</span>&nbsp;<span class="op" id="2685196">!=</span>&nbsp;<span class="string" id="2685199">&#39;:&#39;</span>&nbsp;<span class="op" id="2685203">&amp;&amp;</span>&nbsp;<span class="ident" id="2685206">tag</span><span class="op" id="2685209">[</span><span class="ident" id="2685210">i</span><span class="op" id="2685211">]</span>&nbsp;<span class="op" id="2685213">!=</span>&nbsp;<span class="string" id="2685216">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2685220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685225">i</span><span class="op" id="2685226">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685231">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685235">if</span>&nbsp;<span class="ident" id="2685238">i</span><span class="op" id="2685239">+</span><span class="num" id="2685240">1</span>&nbsp;<span class="op" id="2685242">&gt;=</span>&nbsp;<span class="builtinfunc" id="2685245">len</span><span class="op" id="2685248">(</span><span class="ident" id="2685249">tag</span><span class="op" id="2685252">)</span>&nbsp;<span class="op" id="2685254">||</span>&nbsp;<span class="ident" id="2685257">tag</span><span class="op" id="2685260">[</span><span class="ident" id="2685261">i</span><span class="op" id="2685262">]</span>&nbsp;<span class="op" id="2685264">!=</span>&nbsp;<span class="string" id="2685267">&#39;:&#39;</span>&nbsp;<span class="op" id="2685271">||</span>&nbsp;<span class="ident" id="2685274">tag</span><span class="op" id="2685277">[</span><span class="ident" id="2685278">i</span><span class="op" id="2685279">+</span><span class="num" id="2685280">1</span><span class="op" id="2685281">]</span>&nbsp;<span class="op" id="2685283">!=</span>&nbsp;<span class="string" id="2685286">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2685290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685295">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685307">name</span>&nbsp;<span class="op" id="2685312">:=</span>&nbsp;<span class="builtintype" id="2685315">string</span><span class="op" id="2685321">(</span><span class="ident" id="2685322">tag</span><span class="op" id="2685325">[</span><span class="op" id="2685326">:</span><span class="ident" id="2685327">i</span><span class="op" id="2685328">]</span><span class="op" id="2685329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685333">tag</span>&nbsp;<span class="op" id="2685337">=</span>&nbsp;<span class="ident" id="2685339">tag</span><span class="op" id="2685342">[</span><span class="ident" id="2685343">i</span><span class="op" id="2685344">+</span><span class="num" id="2685345">1</span><span class="op" id="2685346">:</span><span class="op" id="2685347">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685352">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685390">i</span>&nbsp;<span class="op" id="2685392">=</span>&nbsp;<span class="num" id="2685394">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685398">for</span>&nbsp;<span class="ident" id="2685402">i</span>&nbsp;<span class="op" id="2685404">&lt;</span>&nbsp;<span class="builtinfunc" id="2685406">len</span><span class="op" id="2685409">(</span><span class="ident" id="2685410">tag</span><span class="op" id="2685413">)</span>&nbsp;<span class="op" id="2685415">&amp;&amp;</span>&nbsp;<span class="ident" id="2685418">tag</span><span class="op" id="2685421">[</span><span class="ident" id="2685422">i</span><span class="op" id="2685423">]</span>&nbsp;<span class="op" id="2685425">!=</span>&nbsp;<span class="string" id="2685428">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2685432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685437">if</span>&nbsp;<span class="ident" id="2685440">tag</span><span class="op" id="2685443">[</span><span class="ident" id="2685444">i</span><span class="op" id="2685445">]</span>&nbsp;<span class="op" id="2685447">==</span>&nbsp;<span class="string" id="2685450">&#39;\\&#39;</span>&nbsp;<span class="op" id="2685455">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685461">i</span><span class="op" id="2685462">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685473">i</span><span class="op" id="2685474">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685483">if</span>&nbsp;<span class="ident" id="2685486">i</span>&nbsp;<span class="op" id="2685488">&gt;=</span>&nbsp;<span class="builtinfunc" id="2685491">len</span><span class="op" id="2685494">(</span><span class="ident" id="2685495">tag</span><span class="op" id="2685498">)</span>&nbsp;<span class="op" id="2685500">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685505">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685517">qvalue</span>&nbsp;<span class="op" id="2685524">:=</span>&nbsp;<span class="builtintype" id="2685527">string</span><span class="op" id="2685533">(</span><span class="ident" id="2685534">tag</span><span class="op" id="2685537">[</span><span class="op" id="2685538">:</span><span class="ident" id="2685539">i</span><span class="op" id="2685540">+</span><span class="num" id="2685541">1</span><span class="op" id="2685542">]</span><span class="op" id="2685543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685547">tag</span>&nbsp;<span class="op" id="2685551">=</span>&nbsp;<span class="ident" id="2685553">tag</span><span class="op" id="2685556">[</span><span class="ident" id="2685557">i</span><span class="op" id="2685558">+</span><span class="num" id="2685559">1</span><span class="op" id="2685560">:</span><span class="op" id="2685561">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685566">if</span>&nbsp;<span class="ident" id="2685569">key</span>&nbsp;<span class="op" id="2685573">==</span>&nbsp;<span class="ident" id="2685576">name</span>&nbsp;<span class="op" id="2685581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685586">value</span><span class="op" id="2685591">,</span>&nbsp;<span class="ident" id="2685593">_</span>&nbsp;<span class="op" id="2685595">:=</span>&nbsp;<span class="ident" id="2685598">strconv</span><span class="op" id="2685605">.</span><span class="ident" id="2685606">Unquote</span><span class="op" id="2685613">(</span><span class="ident" id="2685614">qvalue</span><span class="op" id="2685620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685625">return</span>&nbsp;<span class="ident" id="2685632">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685643">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685646">return</span>&nbsp;<span class="string" id="2685653">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2685656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2685659">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2685699">func</span>&nbsp;<span class="op" id="2685704">(</span><span class="ident" id="2685705">t</span>&nbsp;<span class="op" id="2685707">*</span><span class="ident" id="2685708">structType</span><span class="op" id="2685718">)</span>&nbsp;<span class="ident" id="2685720">Field</span><span class="op" id="2685725">(</span><span class="ident" id="2685726">i</span>&nbsp;<span class="builtintype" id="2685728">int</span><span class="op" id="2685731">)</span>&nbsp;<span class="op" id="2685733">(</span><span class="ident" id="2685734">f</span>&nbsp;<span class="ident" id="2685736">StructField</span><span class="op" id="2685747">)</span>&nbsp;<span class="op" id="2685749">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685752">if</span>&nbsp;<span class="ident" id="2685755">i</span>&nbsp;<span class="op" id="2685757">&lt;</span>&nbsp;<span class="num" id="2685759">0</span>&nbsp;<span class="op" id="2685761">||</span>&nbsp;<span class="ident" id="2685764">i</span>&nbsp;<span class="op" id="2685766">&gt;=</span>&nbsp;<span class="builtinfunc" id="2685769">len</span><span class="op" id="2685772">(</span><span class="ident" id="2685773">t</span><span class="op" id="2685774">.</span><span class="ident" id="2685775">fields</span><span class="op" id="2685781">)</span>&nbsp;<span class="op" id="2685783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685787">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685798">p</span>&nbsp;<span class="op" id="2685800">:=</span>&nbsp;<span class="op" id="2685803">&amp;</span><span class="ident" id="2685804">t</span><span class="op" id="2685805">.</span><span class="ident" id="2685806">fields</span><span class="op" id="2685812">[</span><span class="ident" id="2685813">i</span><span class="op" id="2685814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685817">f</span><span class="op" id="2685818">.</span><span class="ident" id="2685819">Type</span>&nbsp;<span class="op" id="2685824">=</span>&nbsp;<span class="ident" id="2685826">toType</span><span class="op" id="2685832">(</span><span class="ident" id="2685833">p</span><span class="op" id="2685834">.</span><span class="ident" id="2685835">typ</span><span class="op" id="2685838">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685841">if</span>&nbsp;<span class="ident" id="2685844">p</span><span class="op" id="2685845">.</span><span class="ident" id="2685846">name</span>&nbsp;<span class="op" id="2685851">!=</span>&nbsp;<span class="ident" id="2685854">nil</span>&nbsp;<span class="op" id="2685858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685862">f</span><span class="op" id="2685863">.</span><span class="ident" id="2685864">Name</span>&nbsp;<span class="op" id="2685869">=</span>&nbsp;<span class="op" id="2685871">*</span><span class="ident" id="2685872">p</span><span class="op" id="2685873">.</span><span class="ident" id="2685874">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685880">}</span>&nbsp;<span class="keyword" id="2685882">else</span>&nbsp;<span class="op" id="2685887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685891">t</span>&nbsp;<span class="op" id="2685893">:=</span>&nbsp;<span class="ident" id="2685896">f</span><span class="op" id="2685897">.</span><span class="ident" id="2685898">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685905">if</span>&nbsp;<span class="ident" id="2685908">t</span><span class="op" id="2685909">.</span><span class="ident" id="2685910">Kind</span><span class="op" id="2685914">(</span><span class="op" id="2685915">)</span>&nbsp;<span class="op" id="2685917">==</span>&nbsp;<span class="ident" id="2685920">Ptr</span>&nbsp;<span class="op" id="2685924">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685929">t</span>&nbsp;<span class="op" id="2685931">=</span>&nbsp;<span class="ident" id="2685933">t</span><span class="op" id="2685934">.</span><span class="ident" id="2685935">Elem</span><span class="op" id="2685939">(</span><span class="op" id="2685940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685948">f</span><span class="op" id="2685949">.</span><span class="ident" id="2685950">Name</span>&nbsp;<span class="op" id="2685955">=</span>&nbsp;<span class="ident" id="2685957">t</span><span class="op" id="2685958">.</span><span class="ident" id="2685959">Name</span><span class="op" id="2685963">(</span><span class="op" id="2685964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685968">f</span><span class="op" id="2685969">.</span><span class="ident" id="2685970">Anonymous</span>&nbsp;<span class="op" id="2685980">=</span>&nbsp;<span class="builtintype" id="2685982">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685988">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685991">if</span>&nbsp;<span class="ident" id="2685994">p</span><span class="op" id="2685995">.</span><span class="ident" id="2685996">pkgPath</span>&nbsp;<span class="op" id="2686004">!=</span>&nbsp;<span class="ident" id="2686007">nil</span>&nbsp;<span class="op" id="2686011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686015">f</span><span class="op" id="2686016">.</span><span class="ident" id="2686017">PkgPath</span>&nbsp;<span class="op" id="2686025">=</span>&nbsp;<span class="op" id="2686027">*</span><span class="ident" id="2686028">p</span><span class="op" id="2686029">.</span><span class="ident" id="2686030">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686042">if</span>&nbsp;<span class="ident" id="2686045">p</span><span class="op" id="2686046">.</span><span class="ident" id="2686047">tag</span>&nbsp;<span class="op" id="2686051">!=</span>&nbsp;<span class="ident" id="2686054">nil</span>&nbsp;<span class="op" id="2686058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686062">f</span><span class="op" id="2686063">.</span><span class="ident" id="2686064">Tag</span>&nbsp;<span class="op" id="2686068">=</span>&nbsp;<span class="ident" id="2686070">StructTag</span><span class="op" id="2686079">(</span><span class="op" id="2686080">*</span><span class="ident" id="2686081">p</span><span class="op" id="2686082">.</span><span class="ident" id="2686083">tag</span><span class="op" id="2686086">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686092">f</span><span class="op" id="2686093">.</span><span class="ident" id="2686094">Offset</span>&nbsp;<span class="op" id="2686101">=</span>&nbsp;<span class="ident" id="2686103">p</span><span class="op" id="2686104">.</span><span class="ident" id="2686105">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686114">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686174">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686235">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686294">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686354">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686414">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686472">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686523">f</span><span class="op" id="2686524">.</span><span class="ident" id="2686525">Index</span>&nbsp;<span class="op" id="2686531">=</span>&nbsp;<span class="op" id="2686533">[</span><span class="op" id="2686534">]</span><span class="builtintype" id="2686535">int</span><span class="op" id="2686538">{</span><span class="ident" id="2686539">i</span><span class="op" id="2686540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686543">return</span><br>
<span class="lineno"></span><span class="op" id="2686550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686553">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2686620">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686662">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2686727">func</span>&nbsp;<span class="op" id="2686732">(</span><span class="ident" id="2686733">t</span>&nbsp;<span class="op" id="2686735">*</span><span class="ident" id="2686736">structType</span><span class="op" id="2686746">)</span>&nbsp;<span class="ident" id="2686748">FieldByIndex</span><span class="op" id="2686760">(</span><span class="ident" id="2686761">index</span>&nbsp;<span class="op" id="2686767">[</span><span class="op" id="2686768">]</span><span class="builtintype" id="2686769">int</span><span class="op" id="2686772">)</span>&nbsp;<span class="op" id="2686774">(</span><span class="ident" id="2686775">f</span>&nbsp;<span class="ident" id="2686777">StructField</span><span class="op" id="2686788">)</span>&nbsp;<span class="op" id="2686790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686793">f</span><span class="op" id="2686794">.</span><span class="ident" id="2686795">Type</span>&nbsp;<span class="op" id="2686800">=</span>&nbsp;<span class="ident" id="2686802">toType</span><span class="op" id="2686808">(</span><span class="op" id="2686809">&amp;</span><span class="ident" id="2686810">t</span><span class="op" id="2686811">.</span><span class="ident" id="2686812">rtype</span><span class="op" id="2686817">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686820">for</span>&nbsp;<span class="ident" id="2686824">i</span><span class="op" id="2686825">,</span>&nbsp;<span class="ident" id="2686827">x</span>&nbsp;<span class="op" id="2686829">:=</span>&nbsp;<span class="keyword" id="2686832">range</span>&nbsp;<span class="ident" id="2686838">index</span>&nbsp;<span class="op" id="2686844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686848">if</span>&nbsp;<span class="ident" id="2686851">i</span>&nbsp;<span class="op" id="2686853">&gt;</span>&nbsp;<span class="num" id="2686855">0</span>&nbsp;<span class="op" id="2686857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686862">ft</span>&nbsp;<span class="op" id="2686865">:=</span>&nbsp;<span class="ident" id="2686868">f</span><span class="op" id="2686869">.</span><span class="ident" id="2686870">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686878">if</span>&nbsp;<span class="ident" id="2686881">ft</span><span class="op" id="2686883">.</span><span class="ident" id="2686884">Kind</span><span class="op" id="2686888">(</span><span class="op" id="2686889">)</span>&nbsp;<span class="op" id="2686891">==</span>&nbsp;<span class="ident" id="2686894">Ptr</span>&nbsp;<span class="op" id="2686898">&amp;&amp;</span>&nbsp;<span class="ident" id="2686901">ft</span><span class="op" id="2686903">.</span><span class="ident" id="2686904">Elem</span><span class="op" id="2686908">(</span><span class="op" id="2686909">)</span><span class="op" id="2686910">.</span><span class="ident" id="2686911">Kind</span><span class="op" id="2686915">(</span><span class="op" id="2686916">)</span>&nbsp;<span class="op" id="2686918">==</span>&nbsp;<span class="ident" id="2686921">Struct</span>&nbsp;<span class="op" id="2686928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686934">ft</span>&nbsp;<span class="op" id="2686937">=</span>&nbsp;<span class="ident" id="2686939">ft</span><span class="op" id="2686941">.</span><span class="ident" id="2686942">Elem</span><span class="op" id="2686946">(</span><span class="op" id="2686947">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686957">f</span><span class="op" id="2686958">.</span><span class="ident" id="2686959">Type</span>&nbsp;<span class="op" id="2686964">=</span>&nbsp;<span class="ident" id="2686966">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686975">f</span>&nbsp;<span class="op" id="2686977">=</span>&nbsp;<span class="ident" id="2686979">f</span><span class="op" id="2686980">.</span><span class="ident" id="2686981">Type</span><span class="op" id="2686985">.</span><span class="ident" id="2686986">Field</span><span class="op" id="2686991">(</span><span class="ident" id="2686992">x</span><span class="op" id="2686993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686996">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686999">return</span><br>
<span class="lineno"></span><span class="op" id="2687006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2687009">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2687082">type</span>&nbsp;<span class="ident" id="2687087">fieldScan</span>&nbsp;<span class="keyword" id="2687097">struct</span>&nbsp;<span class="op" id="2687104">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687107">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2687113">*</span><span class="ident" id="2687114">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687126">index</span>&nbsp;<span class="op" id="2687132">[</span><span class="op" id="2687133">]</span><span class="builtintype" id="2687134">int</span><br>
<span class="lineno"></span><span class="op" id="2687138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2687141">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2687216">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2687284">func</span>&nbsp;<span class="op" id="2687289">(</span><span class="ident" id="2687290">t</span>&nbsp;<span class="op" id="2687292">*</span><span class="ident" id="2687293">structType</span><span class="op" id="2687303">)</span>&nbsp;<span class="ident" id="2687305">FieldByNameFunc</span><span class="op" id="2687320">(</span><span class="ident" id="2687321">match</span>&nbsp;<span class="keyword" id="2687327">func</span><span class="op" id="2687331">(</span><span class="builtintype" id="2687332">string</span><span class="op" id="2687338">)</span>&nbsp;<span class="builtintype" id="2687340">bool</span><span class="op" id="2687344">)</span>&nbsp;<span class="op" id="2687346">(</span><span class="ident" id="2687347">result</span>&nbsp;<span class="ident" id="2687354">StructField</span><span class="op" id="2687365">,</span>&nbsp;<span class="ident" id="2687367">ok</span>&nbsp;<span class="builtintype" id="2687370">bool</span><span class="op" id="2687374">)</span>&nbsp;<span class="op" id="2687376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687379">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687471">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687562">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687654">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687725">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687774">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687833">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687888">current</span>&nbsp;<span class="op" id="2687896">:=</span>&nbsp;<span class="op" id="2687899">[</span><span class="op" id="2687900">]</span><span class="ident" id="2687901">fieldScan</span><span class="op" id="2687910">{</span><span class="op" id="2687911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687914">next</span>&nbsp;<span class="op" id="2687919">:=</span>&nbsp;<span class="op" id="2687922">[</span><span class="op" id="2687923">]</span><span class="ident" id="2687924">fieldScan</span><span class="op" id="2687933">{</span><span class="op" id="2687934">{</span><span class="ident" id="2687935">typ</span><span class="op" id="2687938">:</span>&nbsp;<span class="ident" id="2687940">t</span><span class="op" id="2687941">}</span><span class="op" id="2687942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687946">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688014">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688079">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688148">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688225">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688298">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688333">var</span>&nbsp;<span class="ident" id="2688337">nextCount</span>&nbsp;<span class="keyword" id="2688347">map</span><span class="op" id="2688350">[</span><span class="op" id="2688351">*</span><span class="ident" id="2688352">structType</span><span class="op" id="2688362">]</span><span class="builtintype" id="2688363">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688369">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688436">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688498">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688567">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688639">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688714">visited</span>&nbsp;<span class="op" id="2688722">:=</span>&nbsp;<span class="keyword" id="2688725">map</span><span class="op" id="2688728">[</span><span class="op" id="2688729">*</span><span class="ident" id="2688730">structType</span><span class="op" id="2688740">]</span><span class="builtintype" id="2688741">bool</span><span class="op" id="2688745">{</span><span class="op" id="2688746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688750">for</span>&nbsp;<span class="builtinfunc" id="2688754">len</span><span class="op" id="2688757">(</span><span class="ident" id="2688758">next</span><span class="op" id="2688762">)</span>&nbsp;<span class="op" id="2688764">&gt;</span>&nbsp;<span class="num" id="2688766">0</span>&nbsp;<span class="op" id="2688768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688772">current</span><span class="op" id="2688779">,</span>&nbsp;<span class="ident" id="2688781">next</span>&nbsp;<span class="op" id="2688786">=</span>&nbsp;<span class="ident" id="2688788">next</span><span class="op" id="2688792">,</span>&nbsp;<span class="ident" id="2688794">current</span><span class="op" id="2688801">[</span><span class="op" id="2688802">:</span><span class="num" id="2688803">0</span><span class="op" id="2688804">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688808">count</span>&nbsp;<span class="op" id="2688814">:=</span>&nbsp;<span class="ident" id="2688817">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688829">nextCount</span>&nbsp;<span class="op" id="2688839">=</span>&nbsp;<span class="ident" id="2688841">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688848">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688916">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689001">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689076">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689165">for</span>&nbsp;<span class="ident" id="2689169">_</span><span class="op" id="2689170">,</span>&nbsp;<span class="ident" id="2689172">scan</span>&nbsp;<span class="op" id="2689177">:=</span>&nbsp;<span class="keyword" id="2689180">range</span>&nbsp;<span class="ident" id="2689186">current</span>&nbsp;<span class="op" id="2689194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689199">t</span>&nbsp;<span class="op" id="2689201">:=</span>&nbsp;<span class="ident" id="2689204">scan</span><span class="op" id="2689208">.</span><span class="ident" id="2689209">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689216">if</span>&nbsp;<span class="ident" id="2689219">visited</span><span class="op" id="2689226">[</span><span class="ident" id="2689227">t</span><span class="op" id="2689228">]</span>&nbsp;<span class="op" id="2689230">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689236">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689301">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689369">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689422">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689434">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689439">visited</span><span class="op" id="2689446">[</span><span class="ident" id="2689447">t</span><span class="op" id="2689448">]</span>&nbsp;<span class="op" id="2689450">=</span>&nbsp;<span class="builtintype" id="2689452">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689460">for</span>&nbsp;<span class="ident" id="2689464">i</span>&nbsp;<span class="op" id="2689466">:=</span>&nbsp;<span class="keyword" id="2689469">range</span>&nbsp;<span class="ident" id="2689475">t</span><span class="op" id="2689476">.</span><span class="ident" id="2689477">fields</span>&nbsp;<span class="op" id="2689484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689490">f</span>&nbsp;<span class="op" id="2689492">:=</span>&nbsp;<span class="op" id="2689495">&amp;</span><span class="ident" id="2689496">t</span><span class="op" id="2689497">.</span><span class="ident" id="2689498">fields</span><span class="op" id="2689504">[</span><span class="ident" id="2689505">i</span><span class="op" id="2689506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689512">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689551">var</span>&nbsp;<span class="ident" id="2689555">fname</span>&nbsp;<span class="builtintype" id="2689561">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689572">var</span>&nbsp;<span class="ident" id="2689576">ntyp</span>&nbsp;<span class="op" id="2689581">*</span><span class="ident" id="2689582">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689592">if</span>&nbsp;<span class="ident" id="2689595">f</span><span class="op" id="2689596">.</span><span class="ident" id="2689597">name</span>&nbsp;<span class="op" id="2689602">!=</span>&nbsp;<span class="ident" id="2689605">nil</span>&nbsp;<span class="op" id="2689609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689616">fname</span>&nbsp;<span class="op" id="2689622">=</span>&nbsp;<span class="op" id="2689624">*</span><span class="ident" id="2689625">f</span><span class="op" id="2689626">.</span><span class="ident" id="2689627">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689636">}</span>&nbsp;<span class="keyword" id="2689638">else</span>&nbsp;<span class="op" id="2689643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689650">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689691">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689721">ntyp</span>&nbsp;<span class="op" id="2689726">=</span>&nbsp;<span class="ident" id="2689728">f</span><span class="op" id="2689729">.</span><span class="ident" id="2689730">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689739">if</span>&nbsp;<span class="ident" id="2689742">ntyp</span><span class="op" id="2689746">.</span><span class="ident" id="2689747">Kind</span><span class="op" id="2689751">(</span><span class="op" id="2689752">)</span>&nbsp;<span class="op" id="2689754">==</span>&nbsp;<span class="ident" id="2689757">Ptr</span>&nbsp;<span class="op" id="2689761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689769">ntyp</span>&nbsp;<span class="op" id="2689774">=</span>&nbsp;<span class="ident" id="2689776">ntyp</span><span class="op" id="2689780">.</span><span class="ident" id="2689781">Elem</span><span class="op" id="2689785">(</span><span class="op" id="2689786">)</span><span class="op" id="2689787">.</span><span class="ident" id="2689788">common</span><span class="op" id="2689794">(</span><span class="op" id="2689795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689802">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689809">fname</span>&nbsp;<span class="op" id="2689815">=</span>&nbsp;<span class="ident" id="2689817">ntyp</span><span class="op" id="2689821">.</span><span class="ident" id="2689822">Name</span><span class="op" id="2689826">(</span><span class="op" id="2689827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689840">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689862">if</span>&nbsp;<span class="ident" id="2689865">match</span><span class="op" id="2689870">(</span><span class="ident" id="2689871">fname</span><span class="op" id="2689876">)</span>&nbsp;<span class="op" id="2689878">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689885">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689909">if</span>&nbsp;<span class="ident" id="2689912">count</span><span class="op" id="2689917">[</span><span class="ident" id="2689918">t</span><span class="op" id="2689919">]</span>&nbsp;<span class="op" id="2689921">&gt;</span>&nbsp;<span class="num" id="2689923">1</span>&nbsp;<span class="op" id="2689925">||</span>&nbsp;<span class="ident" id="2689928">ok</span>&nbsp;<span class="op" id="2689931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689939">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690004">return</span>&nbsp;<span class="ident" id="2690011">StructField</span><span class="op" id="2690022">{</span><span class="op" id="2690023">}</span><span class="op" id="2690024">,</span>&nbsp;<span class="builtintype" id="2690026">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690037">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690044">result</span>&nbsp;<span class="op" id="2690051">=</span>&nbsp;<span class="ident" id="2690053">t</span><span class="op" id="2690054">.</span><span class="ident" id="2690055">Field</span><span class="op" id="2690060">(</span><span class="ident" id="2690061">i</span><span class="op" id="2690062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690069">result</span><span class="op" id="2690075">.</span><span class="ident" id="2690076">Index</span>&nbsp;<span class="op" id="2690082">=</span>&nbsp;<span class="ident" id="2690084">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690093">result</span><span class="op" id="2690099">.</span><span class="ident" id="2690100">Index</span>&nbsp;<span class="op" id="2690106">=</span>&nbsp;<span class="builtinfunc" id="2690108">append</span><span class="op" id="2690114">(</span><span class="ident" id="2690115">result</span><span class="op" id="2690121">.</span><span class="ident" id="2690122">Index</span><span class="op" id="2690127">,</span>&nbsp;<span class="ident" id="2690129">scan</span><span class="op" id="2690133">.</span><span class="ident" id="2690134">index</span><span class="op" id="2690139">...</span><span class="op" id="2690142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690149">result</span><span class="op" id="2690155">.</span><span class="ident" id="2690156">Index</span>&nbsp;<span class="op" id="2690162">=</span>&nbsp;<span class="builtinfunc" id="2690164">append</span><span class="op" id="2690170">(</span><span class="ident" id="2690171">result</span><span class="op" id="2690177">.</span><span class="ident" id="2690178">Index</span><span class="op" id="2690183">,</span>&nbsp;<span class="ident" id="2690185">i</span><span class="op" id="2690186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690193">ok</span>&nbsp;<span class="op" id="2690196">=</span>&nbsp;<span class="builtintype" id="2690198">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690228">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690296">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690366">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690424">if</span>&nbsp;<span class="ident" id="2690427">ok</span>&nbsp;<span class="op" id="2690430">||</span>&nbsp;<span class="ident" id="2690433">ntyp</span>&nbsp;<span class="op" id="2690438">==</span>&nbsp;<span class="ident" id="2690441">nil</span>&nbsp;<span class="op" id="2690445">||</span>&nbsp;<span class="ident" id="2690448">ntyp</span><span class="op" id="2690452">.</span><span class="ident" id="2690453">Kind</span><span class="op" id="2690457">(</span><span class="op" id="2690458">)</span>&nbsp;<span class="op" id="2690460">!=</span>&nbsp;<span class="ident" id="2690463">Struct</span>&nbsp;<span class="op" id="2690470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690477">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690496">styp</span>&nbsp;<span class="op" id="2690501">:=</span>&nbsp;<span class="op" id="2690504">(</span><span class="op" id="2690505">*</span><span class="ident" id="2690506">structType</span><span class="op" id="2690516">)</span><span class="op" id="2690517">(</span><span class="ident" id="2690518">unsafe</span><span class="op" id="2690524">.</span><span class="ident" id="2690525">Pointer</span><span class="op" id="2690532">(</span><span class="ident" id="2690533">ntyp</span><span class="op" id="2690537">)</span><span class="op" id="2690538">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690544">if</span>&nbsp;<span class="ident" id="2690547">nextCount</span><span class="op" id="2690556">[</span><span class="ident" id="2690557">styp</span><span class="op" id="2690561">]</span>&nbsp;<span class="op" id="2690563">&gt;</span>&nbsp;<span class="num" id="2690565">0</span>&nbsp;<span class="op" id="2690567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690574">nextCount</span><span class="op" id="2690583">[</span><span class="ident" id="2690584">styp</span><span class="op" id="2690588">]</span>&nbsp;<span class="op" id="2690590">=</span>&nbsp;<span class="num" id="2690592">2</span>&nbsp;<span class="comment" id="2690594">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690632">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690651">if</span>&nbsp;<span class="ident" id="2690654">nextCount</span>&nbsp;<span class="op" id="2690664">==</span>&nbsp;<span class="ident" id="2690667">nil</span>&nbsp;<span class="op" id="2690671">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690678">nextCount</span>&nbsp;<span class="op" id="2690688">=</span>&nbsp;<span class="keyword" id="2690690">map</span><span class="op" id="2690693">[</span><span class="op" id="2690694">*</span><span class="ident" id="2690695">structType</span><span class="op" id="2690705">]</span><span class="builtintype" id="2690706">int</span><span class="op" id="2690709">{</span><span class="op" id="2690710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690722">nextCount</span><span class="op" id="2690731">[</span><span class="ident" id="2690732">styp</span><span class="op" id="2690736">]</span>&nbsp;<span class="op" id="2690738">=</span>&nbsp;<span class="num" id="2690740">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690746">if</span>&nbsp;<span class="ident" id="2690749">count</span><span class="op" id="2690754">[</span><span class="ident" id="2690755">t</span><span class="op" id="2690756">]</span>&nbsp;<span class="op" id="2690758">&gt;</span>&nbsp;<span class="num" id="2690760">1</span>&nbsp;<span class="op" id="2690762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690769">nextCount</span><span class="op" id="2690778">[</span><span class="ident" id="2690779">styp</span><span class="op" id="2690783">]</span>&nbsp;<span class="op" id="2690785">=</span>&nbsp;<span class="num" id="2690787">2</span>&nbsp;<span class="comment" id="2690789">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690832">var</span>&nbsp;<span class="ident" id="2690836">index</span>&nbsp;<span class="op" id="2690842">[</span><span class="op" id="2690843">]</span><span class="builtintype" id="2690844">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690852">index</span>&nbsp;<span class="op" id="2690858">=</span>&nbsp;<span class="builtinfunc" id="2690860">append</span><span class="op" id="2690866">(</span><span class="ident" id="2690867">index</span><span class="op" id="2690872">,</span>&nbsp;<span class="ident" id="2690874">scan</span><span class="op" id="2690878">.</span><span class="ident" id="2690879">index</span><span class="op" id="2690884">...</span><span class="op" id="2690887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690893">index</span>&nbsp;<span class="op" id="2690899">=</span>&nbsp;<span class="builtinfunc" id="2690901">append</span><span class="op" id="2690907">(</span><span class="ident" id="2690908">index</span><span class="op" id="2690913">,</span>&nbsp;<span class="ident" id="2690915">i</span><span class="op" id="2690916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690922">next</span>&nbsp;<span class="op" id="2690927">=</span>&nbsp;<span class="builtinfunc" id="2690929">append</span><span class="op" id="2690935">(</span><span class="ident" id="2690936">next</span><span class="op" id="2690940">,</span>&nbsp;<span class="ident" id="2690942">fieldScan</span><span class="op" id="2690951">{</span><span class="ident" id="2690952">styp</span><span class="op" id="2690956">,</span>&nbsp;<span class="ident" id="2690958">index</span><span class="op" id="2690963">}</span><span class="op" id="2690964">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690977">if</span>&nbsp;<span class="ident" id="2690980">ok</span>&nbsp;<span class="op" id="2690983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690988">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690996">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691002">return</span><br>
<span class="lineno"></span><span class="op" id="2691009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2691012">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2691072">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2691125">func</span>&nbsp;<span class="op" id="2691130">(</span><span class="ident" id="2691131">t</span>&nbsp;<span class="op" id="2691133">*</span><span class="ident" id="2691134">structType</span><span class="op" id="2691144">)</span>&nbsp;<span class="ident" id="2691146">FieldByName</span><span class="op" id="2691157">(</span><span class="ident" id="2691158">name</span>&nbsp;<span class="builtintype" id="2691163">string</span><span class="op" id="2691169">)</span>&nbsp;<span class="op" id="2691171">(</span><span class="ident" id="2691172">f</span>&nbsp;<span class="ident" id="2691174">StructField</span><span class="op" id="2691185">,</span>&nbsp;<span class="ident" id="2691187">present</span>&nbsp;<span class="builtintype" id="2691195">bool</span><span class="op" id="2691199">)</span>&nbsp;<span class="op" id="2691201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691204">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691276">hasAnon</span>&nbsp;<span class="op" id="2691284">:=</span>&nbsp;<span class="builtintype" id="2691287">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691294">if</span>&nbsp;<span class="ident" id="2691297">name</span>&nbsp;<span class="op" id="2691302">!=</span>&nbsp;<span class="string" id="2691305">&#34;&#34;</span>&nbsp;<span class="op" id="2691308">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691312">for</span>&nbsp;<span class="ident" id="2691316">i</span>&nbsp;<span class="op" id="2691318">:=</span>&nbsp;<span class="keyword" id="2691321">range</span>&nbsp;<span class="ident" id="2691327">t</span><span class="op" id="2691328">.</span><span class="ident" id="2691329">fields</span>&nbsp;<span class="op" id="2691336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691341">tf</span>&nbsp;<span class="op" id="2691344">:=</span>&nbsp;<span class="op" id="2691347">&amp;</span><span class="ident" id="2691348">t</span><span class="op" id="2691349">.</span><span class="ident" id="2691350">fields</span><span class="op" id="2691356">[</span><span class="ident" id="2691357">i</span><span class="op" id="2691358">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691363">if</span>&nbsp;<span class="ident" id="2691366">tf</span><span class="op" id="2691368">.</span><span class="ident" id="2691369">name</span>&nbsp;<span class="op" id="2691374">==</span>&nbsp;<span class="ident" id="2691377">nil</span>&nbsp;<span class="op" id="2691381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691387">hasAnon</span>&nbsp;<span class="op" id="2691395">=</span>&nbsp;<span class="builtintype" id="2691397">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691406">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691423">if</span>&nbsp;<span class="op" id="2691426">*</span><span class="ident" id="2691427">tf</span><span class="op" id="2691429">.</span><span class="ident" id="2691430">name</span>&nbsp;<span class="op" id="2691435">==</span>&nbsp;<span class="ident" id="2691438">name</span>&nbsp;<span class="op" id="2691443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691449">return</span>&nbsp;<span class="ident" id="2691456">t</span><span class="op" id="2691457">.</span><span class="ident" id="2691458">Field</span><span class="op" id="2691463">(</span><span class="ident" id="2691464">i</span><span class="op" id="2691465">)</span><span class="op" id="2691466">,</span>&nbsp;<span class="builtintype" id="2691468">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691480">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691486">if</span>&nbsp;<span class="op" id="2691489">!</span><span class="ident" id="2691490">hasAnon</span>&nbsp;<span class="op" id="2691498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691502">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691513">return</span>&nbsp;<span class="ident" id="2691520">t</span><span class="op" id="2691521">.</span><span class="ident" id="2691522">FieldByNameFunc</span><span class="op" id="2691537">(</span><span class="keyword" id="2691538">func</span><span class="op" id="2691542">(</span><span class="ident" id="2691543">s</span>&nbsp;<span class="builtintype" id="2691545">string</span><span class="op" id="2691551">)</span>&nbsp;<span class="builtintype" id="2691553">bool</span>&nbsp;<span class="op" id="2691558">{</span>&nbsp;<span class="keyword" id="2691560">return</span>&nbsp;<span class="ident" id="2691567">s</span>&nbsp;<span class="op" id="2691569">==</span>&nbsp;<span class="ident" id="2691572">name</span>&nbsp;<span class="op" id="2691577">}</span><span class="op" id="2691578">)</span><br>
<span class="lineno">1000</span><span class="op" id="2691580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2691583">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2691654">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2691682">func</span>&nbsp;<span class="ident" id="2691687">TypeOf</span><span class="op" id="2691693">(</span><span class="ident" id="2691694">i</span>&nbsp;<span class="keyword" id="2691696">interface</span><span class="op" id="2691705">{</span><span class="op" id="2691706">}</span><span class="op" id="2691707">)</span>&nbsp;<span class="ident" id="2691709">Type</span>&nbsp;<span class="op" id="2691714">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691717">eface</span>&nbsp;<span class="op" id="2691723">:=</span>&nbsp;<span class="op" id="2691726">*</span><span class="op" id="2691727">(</span><span class="op" id="2691728">*</span><span class="ident" id="2691729">emptyInterface</span><span class="op" id="2691743">)</span><span class="op" id="2691744">(</span><span class="ident" id="2691745">unsafe</span><span class="op" id="2691751">.</span><span class="ident" id="2691752">Pointer</span><span class="op" id="2691759">(</span><span class="op" id="2691760">&amp;</span><span class="ident" id="2691761">i</span><span class="op" id="2691762">)</span><span class="op" id="2691763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691766">return</span>&nbsp;<span class="ident" id="2691773">toType</span><span class="op" id="2691779">(</span><span class="ident" id="2691780">eface</span><span class="op" id="2691785">.</span><span class="ident" id="2691786">typ</span><span class="op" id="2691789">)</span><br>
<span class="lineno"></span><span class="op" id="2691791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2691794">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2691828">var</span>&nbsp;<span class="ident" id="2691832">ptrMap</span>&nbsp;<span class="keyword" id="2691839">struct</span>&nbsp;<span class="op" id="2691846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691849">sync</span><span class="op" id="2691853">.</span><span class="ident" id="2691854">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691863">m</span>&nbsp;<span class="keyword" id="2691865">map</span><span class="op" id="2691868">[</span><span class="op" id="2691869">*</span><span class="ident" id="2691870">rtype</span><span class="op" id="2691875">]</span><span class="op" id="2691876">*</span><span class="ident" id="2691877">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2691885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2691888">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2691938">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2692006">func</span>&nbsp;<span class="ident" id="2692011">PtrTo</span><span class="op" id="2692016">(</span><span class="ident" id="2692017">t</span>&nbsp;<span class="ident" id="2692019">Type</span><span class="op" id="2692023">)</span>&nbsp;<span class="ident" id="2692025">Type</span>&nbsp;<span class="op" id="2692030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692033">return</span>&nbsp;<span class="ident" id="2692040">t</span><span class="op" id="2692041">.</span><span class="op" id="2692042">(</span><span class="op" id="2692043">*</span><span class="ident" id="2692044">rtype</span><span class="op" id="2692049">)</span><span class="op" id="2692050">.</span><span class="ident" id="2692051">ptrTo</span><span class="op" id="2692056">(</span><span class="op" id="2692057">)</span><br>
<span class="lineno"></span><span class="op" id="2692059">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2692062">func</span>&nbsp;<span class="op" id="2692067">(</span><span class="ident" id="2692068">t</span>&nbsp;<span class="op" id="2692070">*</span><span class="ident" id="2692071">rtype</span><span class="op" id="2692076">)</span>&nbsp;<span class="ident" id="2692078">ptrTo</span><span class="op" id="2692083">(</span><span class="op" id="2692084">)</span>&nbsp;<span class="op" id="2692086">*</span><span class="ident" id="2692087">rtype</span>&nbsp;<span class="op" id="2692093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692096">if</span>&nbsp;<span class="ident" id="2692099">p</span>&nbsp;<span class="op" id="2692101">:=</span>&nbsp;<span class="ident" id="2692104">t</span><span class="op" id="2692105">.</span><span class="ident" id="2692106">ptrToThis</span><span class="op" id="2692115">;</span>&nbsp;<span class="ident" id="2692117">p</span>&nbsp;<span class="op" id="2692119">!=</span>&nbsp;<span class="ident" id="2692122">nil</span>&nbsp;<span class="op" id="2692126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692130">return</span>&nbsp;<span class="ident" id="2692137">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692140">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692144">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692175">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692227">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692281">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692340">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692385">ptrMap</span><span class="op" id="2692391">.</span><span class="ident" id="2692392">RLock</span><span class="op" id="2692397">(</span><span class="op" id="2692398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692401">if</span>&nbsp;<span class="ident" id="2692404">m</span>&nbsp;<span class="op" id="2692406">:=</span>&nbsp;<span class="ident" id="2692409">ptrMap</span><span class="op" id="2692415">.</span><span class="ident" id="2692416">m</span><span class="op" id="2692417">;</span>&nbsp;<span class="ident" id="2692419">m</span>&nbsp;<span class="op" id="2692421">!=</span>&nbsp;<span class="ident" id="2692424">nil</span>&nbsp;<span class="op" id="2692428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692432">if</span>&nbsp;<span class="ident" id="2692435">p</span>&nbsp;<span class="op" id="2692437">:=</span>&nbsp;<span class="ident" id="2692440">m</span><span class="op" id="2692441">[</span><span class="ident" id="2692442">t</span><span class="op" id="2692443">]</span><span class="op" id="2692444">;</span>&nbsp;<span class="ident" id="2692446">p</span>&nbsp;<span class="op" id="2692448">!=</span>&nbsp;<span class="ident" id="2692451">nil</span>&nbsp;<span class="op" id="2692455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692460">ptrMap</span><span class="op" id="2692466">.</span><span class="ident" id="2692467">RUnlock</span><span class="op" id="2692474">(</span><span class="op" id="2692475">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692480">return</span>&nbsp;<span class="op" id="2692487">&amp;</span><span class="ident" id="2692488">p</span><span class="op" id="2692489">.</span><span class="ident" id="2692490">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692504">ptrMap</span><span class="op" id="2692510">.</span><span class="ident" id="2692511">RUnlock</span><span class="op" id="2692518">(</span><span class="op" id="2692519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692522">ptrMap</span><span class="op" id="2692528">.</span><span class="ident" id="2692529">Lock</span><span class="op" id="2692533">(</span><span class="op" id="2692534">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692537">if</span>&nbsp;<span class="ident" id="2692540">ptrMap</span><span class="op" id="2692546">.</span><span class="ident" id="2692547">m</span>&nbsp;<span class="op" id="2692549">==</span>&nbsp;<span class="ident" id="2692552">nil</span>&nbsp;<span class="op" id="2692556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692560">ptrMap</span><span class="op" id="2692566">.</span><span class="ident" id="2692567">m</span>&nbsp;<span class="op" id="2692569">=</span>&nbsp;<span class="builtinfunc" id="2692571">make</span><span class="op" id="2692575">(</span><span class="keyword" id="2692576">map</span><span class="op" id="2692579">[</span><span class="op" id="2692580">*</span><span class="ident" id="2692581">rtype</span><span class="op" id="2692586">]</span><span class="op" id="2692587">*</span><span class="ident" id="2692588">ptrType</span><span class="op" id="2692595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692601">p</span>&nbsp;<span class="op" id="2692603">:=</span>&nbsp;<span class="ident" id="2692606">ptrMap</span><span class="op" id="2692612">.</span><span class="ident" id="2692613">m</span><span class="op" id="2692614">[</span><span class="ident" id="2692615">t</span><span class="op" id="2692616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692619">if</span>&nbsp;<span class="ident" id="2692622">p</span>&nbsp;<span class="op" id="2692624">!=</span>&nbsp;<span class="ident" id="2692627">nil</span>&nbsp;<span class="op" id="2692631">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692635">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692689">ptrMap</span><span class="op" id="2692695">.</span><span class="ident" id="2692696">Unlock</span><span class="op" id="2692702">(</span><span class="op" id="2692703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692707">return</span>&nbsp;<span class="op" id="2692714">&amp;</span><span class="ident" id="2692715">p</span><span class="op" id="2692716">.</span><span class="ident" id="2692717">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692728">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692783">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692810">p</span>&nbsp;<span class="op" id="2692812">=</span>&nbsp;<span class="builtinfunc" id="2692814">new</span><span class="op" id="2692817">(</span><span class="ident" id="2692818">ptrType</span><span class="op" id="2692825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692828">var</span>&nbsp;<span class="ident" id="2692832">iptr</span>&nbsp;<span class="keyword" id="2692837">interface</span><span class="op" id="2692846">{</span><span class="op" id="2692847">}</span>&nbsp;<span class="op" id="2692849">=</span>&nbsp;<span class="op" id="2692851">(</span><span class="op" id="2692852">*</span><span class="ident" id="2692853">unsafe</span><span class="op" id="2692859">.</span><span class="ident" id="2692860">Pointer</span><span class="op" id="2692867">)</span><span class="op" id="2692868">(</span><span class="ident" id="2692869">nil</span><span class="op" id="2692872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692875">prototype</span>&nbsp;<span class="op" id="2692885">:=</span>&nbsp;<span class="op" id="2692888">*</span><span class="op" id="2692889">(</span><span class="op" id="2692890">*</span><span class="op" id="2692891">*</span><span class="ident" id="2692892">ptrType</span><span class="op" id="2692899">)</span><span class="op" id="2692900">(</span><span class="ident" id="2692901">unsafe</span><span class="op" id="2692907">.</span><span class="ident" id="2692908">Pointer</span><span class="op" id="2692915">(</span><span class="op" id="2692916">&amp;</span><span class="ident" id="2692917">iptr</span><span class="op" id="2692921">)</span><span class="op" id="2692922">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692925">*</span><span class="ident" id="2692926">p</span>&nbsp;<span class="op" id="2692928">=</span>&nbsp;<span class="op" id="2692930">*</span><span class="ident" id="2692931">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692943">s</span>&nbsp;<span class="op" id="2692945">:=</span>&nbsp;<span class="string" id="2692948">&#34;*&#34;</span>&nbsp;<span class="op" id="2692952">+</span>&nbsp;<span class="op" id="2692954">*</span><span class="ident" id="2692955">t</span><span class="op" id="2692956">.</span><span class="builtintype" id="2692957">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692965">p</span><span class="op" id="2692966">.</span><span class="builtintype" id="2692967">string</span>&nbsp;<span class="op" id="2692974">=</span>&nbsp;<span class="op" id="2692976">&amp;</span><span class="ident" id="2692977">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692981">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693037">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693086">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693137">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693189">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693219">p</span><span class="op" id="2693220">.</span><span class="ident" id="2693221">hash</span>&nbsp;<span class="op" id="2693226">=</span>&nbsp;<span class="ident" id="2693228">fnv1</span><span class="op" id="2693232">(</span><span class="ident" id="2693233">t</span><span class="op" id="2693234">.</span><span class="ident" id="2693235">hash</span><span class="op" id="2693239">,</span>&nbsp;<span class="string" id="2693241">&#39;*&#39;</span><span class="op" id="2693244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693248">p</span><span class="op" id="2693249">.</span><span class="ident" id="2693250">uncommonType</span>&nbsp;<span class="op" id="2693263">=</span>&nbsp;<span class="ident" id="2693265">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693270">p</span><span class="op" id="2693271">.</span><span class="ident" id="2693272">ptrToThis</span>&nbsp;<span class="op" id="2693282">=</span>&nbsp;<span class="ident" id="2693284">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693289">p</span><span class="op" id="2693290">.</span><span class="ident" id="2693291">zero</span>&nbsp;<span class="op" id="2693296">=</span>&nbsp;<span class="ident" id="2693298">unsafe</span><span class="op" id="2693304">.</span><span class="ident" id="2693305">Pointer</span><span class="op" id="2693312">(</span><span class="op" id="2693313">&amp;</span><span class="builtinfunc" id="2693314">make</span><span class="op" id="2693318">(</span><span class="op" id="2693319">[</span><span class="op" id="2693320">]</span><span class="builtintype" id="2693321">byte</span><span class="op" id="2693325">,</span>&nbsp;<span class="ident" id="2693327">p</span><span class="op" id="2693328">.</span><span class="ident" id="2693329">size</span><span class="op" id="2693333">)</span><span class="op" id="2693334">[</span><span class="num" id="2693335">0</span><span class="op" id="2693336">]</span><span class="op" id="2693337">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693340">p</span><span class="op" id="2693341">.</span><span class="ident" id="2693342">elem</span>&nbsp;<span class="op" id="2693347">=</span>&nbsp;<span class="ident" id="2693349">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693353">ptrMap</span><span class="op" id="2693359">.</span><span class="ident" id="2693360">m</span><span class="op" id="2693361">[</span><span class="ident" id="2693362">t</span><span class="op" id="2693363">]</span>&nbsp;<span class="op" id="2693365">=</span>&nbsp;<span class="ident" id="2693367">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693370">ptrMap</span><span class="op" id="2693376">.</span><span class="ident" id="2693377">Unlock</span><span class="op" id="2693383">(</span><span class="op" id="2693384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693387">return</span>&nbsp;<span class="op" id="2693394">&amp;</span><span class="ident" id="2693395">p</span><span class="op" id="2693396">.</span><span class="ident" id="2693397">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2693403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693406">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2693492">func</span>&nbsp;<span class="ident" id="2693497">fnv1</span><span class="op" id="2693501">(</span><span class="ident" id="2693502">x</span>&nbsp;<span class="builtintype" id="2693504">uint32</span><span class="op" id="2693510">,</span>&nbsp;<span class="ident" id="2693512">list</span>&nbsp;<span class="op" id="2693517">...</span><span class="builtintype" id="2693520">byte</span><span class="op" id="2693524">)</span>&nbsp;<span class="builtintype" id="2693526">uint32</span>&nbsp;<span class="op" id="2693533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693536">for</span>&nbsp;<span class="ident" id="2693540">_</span><span class="op" id="2693541">,</span>&nbsp;<span class="ident" id="2693543">b</span>&nbsp;<span class="op" id="2693545">:=</span>&nbsp;<span class="keyword" id="2693548">range</span>&nbsp;<span class="ident" id="2693554">list</span>&nbsp;<span class="op" id="2693559">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693563">x</span>&nbsp;<span class="op" id="2693565">=</span>&nbsp;<span class="ident" id="2693567">x</span><span class="op" id="2693568">*</span><span class="num" id="2693569">16777619</span>&nbsp;<span class="op" id="2693578">^</span>&nbsp;<span class="builtintype" id="2693580">uint32</span><span class="op" id="2693586">(</span><span class="ident" id="2693587">b</span><span class="op" id="2693588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693594">return</span>&nbsp;<span class="ident" id="2693601">x</span><br>
<span class="lineno"></span><span class="op" id="2693603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2693606">func</span>&nbsp;<span class="op" id="2693611">(</span><span class="ident" id="2693612">t</span>&nbsp;<span class="op" id="2693614">*</span><span class="ident" id="2693615">rtype</span><span class="op" id="2693620">)</span>&nbsp;<span class="ident" id="2693622">Implements</span><span class="op" id="2693632">(</span><span class="ident" id="2693633">u</span>&nbsp;<span class="ident" id="2693635">Type</span><span class="op" id="2693639">)</span>&nbsp;<span class="builtintype" id="2693641">bool</span>&nbsp;<span class="op" id="2693646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693649">if</span>&nbsp;<span class="ident" id="2693652">u</span>&nbsp;<span class="op" id="2693654">==</span>&nbsp;<span class="ident" id="2693657">nil</span>&nbsp;<span class="op" id="2693661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2693665">panic</span><span class="op" id="2693670">(</span><span class="string" id="2693671">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2693716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693722">if</span>&nbsp;<span class="ident" id="2693725">u</span><span class="op" id="2693726">.</span><span class="ident" id="2693727">Kind</span><span class="op" id="2693731">(</span><span class="op" id="2693732">)</span>&nbsp;<span class="op" id="2693734">!=</span>&nbsp;<span class="ident" id="2693737">Interface</span>&nbsp;<span class="op" id="2693747">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2693751">panic</span><span class="op" id="2693756">(</span><span class="string" id="2693757">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2693812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693818">return</span>&nbsp;<span class="ident" id="2693825">implements</span><span class="op" id="2693835">(</span><span class="ident" id="2693836">u</span><span class="op" id="2693837">.</span><span class="op" id="2693838">(</span><span class="op" id="2693839">*</span><span class="ident" id="2693840">rtype</span><span class="op" id="2693845">)</span><span class="op" id="2693846">,</span>&nbsp;<span class="ident" id="2693848">t</span><span class="op" id="2693849">)</span><br>
<span class="lineno"></span><span class="op" id="2693851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2693854">func</span>&nbsp;<span class="op" id="2693859">(</span><span class="ident" id="2693860">t</span>&nbsp;<span class="op" id="2693862">*</span><span class="ident" id="2693863">rtype</span><span class="op" id="2693868">)</span>&nbsp;<span class="ident" id="2693870">AssignableTo</span><span class="op" id="2693882">(</span><span class="ident" id="2693883">u</span>&nbsp;<span class="ident" id="2693885">Type</span><span class="op" id="2693889">)</span>&nbsp;<span class="builtintype" id="2693891">bool</span>&nbsp;<span class="op" id="2693896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693899">if</span>&nbsp;<span class="ident" id="2693902">u</span>&nbsp;<span class="op" id="2693904">==</span>&nbsp;<span class="ident" id="2693907">nil</span>&nbsp;<span class="op" id="2693911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2693915">panic</span><span class="op" id="2693920">(</span><span class="string" id="2693921">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2693968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693974">uu</span>&nbsp;<span class="op" id="2693977">:=</span>&nbsp;<span class="ident" id="2693980">u</span><span class="op" id="2693981">.</span><span class="op" id="2693982">(</span><span class="op" id="2693983">*</span><span class="ident" id="2693984">rtype</span><span class="op" id="2693989">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693992">return</span>&nbsp;<span class="ident" id="2693999">directlyAssignable</span><span class="op" id="2694017">(</span><span class="ident" id="2694018">uu</span><span class="op" id="2694020">,</span>&nbsp;<span class="ident" id="2694022">t</span><span class="op" id="2694023">)</span>&nbsp;<span class="op" id="2694025">||</span>&nbsp;<span class="ident" id="2694028">implements</span><span class="op" id="2694038">(</span><span class="ident" id="2694039">uu</span><span class="op" id="2694041">,</span>&nbsp;<span class="ident" id="2694043">t</span><span class="op" id="2694044">)</span><br>
<span class="lineno"></span><span class="op" id="2694046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2694049">func</span>&nbsp;<span class="op" id="2694054">(</span><span class="ident" id="2694055">t</span>&nbsp;<span class="op" id="2694057">*</span><span class="ident" id="2694058">rtype</span><span class="op" id="2694063">)</span>&nbsp;<span class="ident" id="2694065">ConvertibleTo</span><span class="op" id="2694078">(</span><span class="ident" id="2694079">u</span>&nbsp;<span class="ident" id="2694081">Type</span><span class="op" id="2694085">)</span>&nbsp;<span class="builtintype" id="2694087">bool</span>&nbsp;<span class="op" id="2694092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694095">if</span>&nbsp;<span class="ident" id="2694098">u</span>&nbsp;<span class="op" id="2694100">==</span>&nbsp;<span class="ident" id="2694103">nil</span>&nbsp;<span class="op" id="2694107">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2694111">panic</span><span class="op" id="2694116">(</span><span class="string" id="2694117">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2694165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694171">uu</span>&nbsp;<span class="op" id="2694174">:=</span>&nbsp;<span class="ident" id="2694177">u</span><span class="op" id="2694178">.</span><span class="op" id="2694179">(</span><span class="op" id="2694180">*</span><span class="ident" id="2694181">rtype</span><span class="op" id="2694186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694189">return</span>&nbsp;<span class="ident" id="2694196">convertOp</span><span class="op" id="2694205">(</span><span class="ident" id="2694206">uu</span><span class="op" id="2694208">,</span>&nbsp;<span class="ident" id="2694210">t</span><span class="op" id="2694211">)</span>&nbsp;<span class="op" id="2694213">!=</span>&nbsp;<span class="ident" id="2694216">nil</span><br>
<span class="lineno"></span><span class="op" id="2694220">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2694223">func</span>&nbsp;<span class="op" id="2694228">(</span><span class="ident" id="2694229">t</span>&nbsp;<span class="op" id="2694231">*</span><span class="ident" id="2694232">rtype</span><span class="op" id="2694237">)</span>&nbsp;<span class="ident" id="2694239">Comparable</span><span class="op" id="2694249">(</span><span class="op" id="2694250">)</span>&nbsp;<span class="builtintype" id="2694252">bool</span>&nbsp;<span class="op" id="2694257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694260">return</span>&nbsp;<span class="ident" id="2694267">t</span><span class="op" id="2694268">.</span><span class="ident" id="2694269">alg</span>&nbsp;<span class="op" id="2694273">!=</span>&nbsp;<span class="ident" id="2694276">nil</span>&nbsp;<span class="op" id="2694280">&amp;&amp;</span>&nbsp;<span class="ident" id="2694283">t</span><span class="op" id="2694284">.</span><span class="ident" id="2694285">alg</span><span class="op" id="2694288">.</span><span class="ident" id="2694289">equal</span>&nbsp;<span class="op" id="2694295">!=</span>&nbsp;<span class="ident" id="2694298">nil</span><br>
<span class="lineno"></span><span class="op" id="2694302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2694305">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2694379">func</span>&nbsp;<span class="ident" id="2694384">implements</span><span class="op" id="2694394">(</span><span class="ident" id="2694395">T</span><span class="op" id="2694396">,</span>&nbsp;<span class="ident" id="2694398">V</span>&nbsp;<span class="op" id="2694400">*</span><span class="ident" id="2694401">rtype</span><span class="op" id="2694406">)</span>&nbsp;<span class="builtintype" id="2694408">bool</span>&nbsp;<span class="op" id="2694413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694416">if</span>&nbsp;<span class="ident" id="2694419">T</span><span class="op" id="2694420">.</span><span class="ident" id="2694421">Kind</span><span class="op" id="2694425">(</span><span class="op" id="2694426">)</span>&nbsp;<span class="op" id="2694428">!=</span>&nbsp;<span class="ident" id="2694431">Interface</span>&nbsp;<span class="op" id="2694441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694445">return</span>&nbsp;<span class="builtintype" id="2694452">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694459">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694462">t</span>&nbsp;<span class="op" id="2694464">:=</span>&nbsp;<span class="op" id="2694467">(</span><span class="op" id="2694468">*</span><span class="ident" id="2694469">interfaceType</span><span class="op" id="2694482">)</span><span class="op" id="2694483">(</span><span class="ident" id="2694484">unsafe</span><span class="op" id="2694490">.</span><span class="ident" id="2694491">Pointer</span><span class="op" id="2694498">(</span><span class="ident" id="2694499">T</span><span class="op" id="2694500">)</span><span class="op" id="2694501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694504">if</span>&nbsp;<span class="builtinfunc" id="2694507">len</span><span class="op" id="2694510">(</span><span class="ident" id="2694511">t</span><span class="op" id="2694512">.</span><span class="ident" id="2694513">methods</span><span class="op" id="2694520">)</span>&nbsp;<span class="op" id="2694522">==</span>&nbsp;<span class="num" id="2694525">0</span>&nbsp;<span class="op" id="2694527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694531">return</span>&nbsp;<span class="builtintype" id="2694538">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694548">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694602">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694662">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694708">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694770">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694828">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694888">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694949">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695006">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695065">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695129">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695183">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695216">if</span>&nbsp;<span class="ident" id="2695219">V</span><span class="op" id="2695220">.</span><span class="ident" id="2695221">Kind</span><span class="op" id="2695225">(</span><span class="op" id="2695226">)</span>&nbsp;<span class="op" id="2695228">==</span>&nbsp;<span class="ident" id="2695231">Interface</span>&nbsp;<span class="op" id="2695241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695245">v</span>&nbsp;<span class="op" id="2695247">:=</span>&nbsp;<span class="op" id="2695250">(</span><span class="op" id="2695251">*</span><span class="ident" id="2695252">interfaceType</span><span class="op" id="2695265">)</span><span class="op" id="2695266">(</span><span class="ident" id="2695267">unsafe</span><span class="op" id="2695273">.</span><span class="ident" id="2695274">Pointer</span><span class="op" id="2695281">(</span><span class="ident" id="2695282">V</span><span class="op" id="2695283">)</span><span class="op" id="2695284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695288">i</span>&nbsp;<span class="op" id="2695290">:=</span>&nbsp;<span class="num" id="2695293">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695297">for</span>&nbsp;<span class="ident" id="2695301">j</span>&nbsp;<span class="op" id="2695303">:=</span>&nbsp;<span class="num" id="2695306">0</span><span class="op" id="2695307">;</span>&nbsp;<span class="ident" id="2695309">j</span>&nbsp;<span class="op" id="2695311">&lt;</span>&nbsp;<span class="builtinfunc" id="2695313">len</span><span class="op" id="2695316">(</span><span class="ident" id="2695317">v</span><span class="op" id="2695318">.</span><span class="ident" id="2695319">methods</span><span class="op" id="2695326">)</span><span class="op" id="2695327">;</span>&nbsp;<span class="ident" id="2695329">j</span><span class="op" id="2695330">++</span>&nbsp;<span class="op" id="2695333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695338">tm</span>&nbsp;<span class="op" id="2695341">:=</span>&nbsp;<span class="op" id="2695344">&amp;</span><span class="ident" id="2695345">t</span><span class="op" id="2695346">.</span><span class="ident" id="2695347">methods</span><span class="op" id="2695354">[</span><span class="ident" id="2695355">i</span><span class="op" id="2695356">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695361">vm</span>&nbsp;<span class="op" id="2695364">:=</span>&nbsp;<span class="op" id="2695367">&amp;</span><span class="ident" id="2695368">v</span><span class="op" id="2695369">.</span><span class="ident" id="2695370">methods</span><span class="op" id="2695377">[</span><span class="ident" id="2695378">j</span><span class="op" id="2695379">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695384">if</span>&nbsp;<span class="ident" id="2695387">vm</span><span class="op" id="2695389">.</span><span class="ident" id="2695390">name</span>&nbsp;<span class="op" id="2695395">==</span>&nbsp;<span class="ident" id="2695398">tm</span><span class="op" id="2695400">.</span><span class="ident" id="2695401">name</span>&nbsp;<span class="op" id="2695406">&amp;&amp;</span>&nbsp;<span class="ident" id="2695409">vm</span><span class="op" id="2695411">.</span><span class="ident" id="2695412">pkgPath</span>&nbsp;<span class="op" id="2695420">==</span>&nbsp;<span class="ident" id="2695423">tm</span><span class="op" id="2695425">.</span><span class="ident" id="2695426">pkgPath</span>&nbsp;<span class="op" id="2695434">&amp;&amp;</span>&nbsp;<span class="ident" id="2695437">vm</span><span class="op" id="2695439">.</span><span class="ident" id="2695440">typ</span>&nbsp;<span class="op" id="2695444">==</span>&nbsp;<span class="ident" id="2695447">tm</span><span class="op" id="2695449">.</span><span class="ident" id="2695450">typ</span>&nbsp;<span class="op" id="2695454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695460">if</span>&nbsp;<span class="ident" id="2695463">i</span><span class="op" id="2695464">++</span><span class="op" id="2695466">;</span>&nbsp;<span class="ident" id="2695468">i</span>&nbsp;<span class="op" id="2695470">&gt;=</span>&nbsp;<span class="builtinfunc" id="2695473">len</span><span class="op" id="2695476">(</span><span class="ident" id="2695477">t</span><span class="op" id="2695478">.</span><span class="ident" id="2695479">methods</span><span class="op" id="2695486">)</span>&nbsp;<span class="op" id="2695488">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695495">return</span>&nbsp;<span class="builtintype" id="2695502">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695524">return</span>&nbsp;<span class="builtintype" id="2695531">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695542">v</span>&nbsp;<span class="op" id="2695544">:=</span>&nbsp;<span class="ident" id="2695547">V</span><span class="op" id="2695548">.</span><span class="ident" id="2695549">uncommon</span><span class="op" id="2695557">(</span><span class="op" id="2695558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695561">if</span>&nbsp;<span class="ident" id="2695564">v</span>&nbsp;<span class="op" id="2695566">==</span>&nbsp;<span class="ident" id="2695569">nil</span>&nbsp;<span class="op" id="2695573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695577">return</span>&nbsp;<span class="builtintype" id="2695584">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695594">i</span>&nbsp;<span class="op" id="2695596">:=</span>&nbsp;<span class="num" id="2695599">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695602">for</span>&nbsp;<span class="ident" id="2695606">j</span>&nbsp;<span class="op" id="2695608">:=</span>&nbsp;<span class="num" id="2695611">0</span><span class="op" id="2695612">;</span>&nbsp;<span class="ident" id="2695614">j</span>&nbsp;<span class="op" id="2695616">&lt;</span>&nbsp;<span class="builtinfunc" id="2695618">len</span><span class="op" id="2695621">(</span><span class="ident" id="2695622">v</span><span class="op" id="2695623">.</span><span class="ident" id="2695624">methods</span><span class="op" id="2695631">)</span><span class="op" id="2695632">;</span>&nbsp;<span class="ident" id="2695634">j</span><span class="op" id="2695635">++</span>&nbsp;<span class="op" id="2695638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695642">tm</span>&nbsp;<span class="op" id="2695645">:=</span>&nbsp;<span class="op" id="2695648">&amp;</span><span class="ident" id="2695649">t</span><span class="op" id="2695650">.</span><span class="ident" id="2695651">methods</span><span class="op" id="2695658">[</span><span class="ident" id="2695659">i</span><span class="op" id="2695660">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695664">vm</span>&nbsp;<span class="op" id="2695667">:=</span>&nbsp;<span class="op" id="2695670">&amp;</span><span class="ident" id="2695671">v</span><span class="op" id="2695672">.</span><span class="ident" id="2695673">methods</span><span class="op" id="2695680">[</span><span class="ident" id="2695681">j</span><span class="op" id="2695682">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695686">if</span>&nbsp;<span class="ident" id="2695689">vm</span><span class="op" id="2695691">.</span><span class="ident" id="2695692">name</span>&nbsp;<span class="op" id="2695697">==</span>&nbsp;<span class="ident" id="2695700">tm</span><span class="op" id="2695702">.</span><span class="ident" id="2695703">name</span>&nbsp;<span class="op" id="2695708">&amp;&amp;</span>&nbsp;<span class="ident" id="2695711">vm</span><span class="op" id="2695713">.</span><span class="ident" id="2695714">pkgPath</span>&nbsp;<span class="op" id="2695722">==</span>&nbsp;<span class="ident" id="2695725">tm</span><span class="op" id="2695727">.</span><span class="ident" id="2695728">pkgPath</span>&nbsp;<span class="op" id="2695736">&amp;&amp;</span>&nbsp;<span class="ident" id="2695739">vm</span><span class="op" id="2695741">.</span><span class="ident" id="2695742">mtyp</span>&nbsp;<span class="op" id="2695747">==</span>&nbsp;<span class="ident" id="2695750">tm</span><span class="op" id="2695752">.</span><span class="ident" id="2695753">typ</span>&nbsp;<span class="op" id="2695757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695762">if</span>&nbsp;<span class="ident" id="2695765">i</span><span class="op" id="2695766">++</span><span class="op" id="2695768">;</span>&nbsp;<span class="ident" id="2695770">i</span>&nbsp;<span class="op" id="2695772">&gt;=</span>&nbsp;<span class="builtinfunc" id="2695775">len</span><span class="op" id="2695778">(</span><span class="ident" id="2695779">t</span><span class="op" id="2695780">.</span><span class="ident" id="2695781">methods</span><span class="op" id="2695788">)</span>&nbsp;<span class="op" id="2695790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695796">return</span>&nbsp;<span class="builtintype" id="2695803">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695815">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695821">return</span>&nbsp;<span class="builtintype" id="2695828">false</span><br>
<span class="lineno"></span><span class="op" id="2695834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2695837">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2695911">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2695961">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2696013">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2696069">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2696135">func</span>&nbsp;<span class="ident" id="2696140">directlyAssignable</span><span class="op" id="2696158">(</span><span class="ident" id="2696159">T</span><span class="op" id="2696160">,</span>&nbsp;<span class="ident" id="2696162">V</span>&nbsp;<span class="op" id="2696164">*</span><span class="ident" id="2696165">rtype</span><span class="op" id="2696170">)</span>&nbsp;<span class="builtintype" id="2696172">bool</span>&nbsp;<span class="op" id="2696177">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696180">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696214">if</span>&nbsp;<span class="ident" id="2696217">T</span>&nbsp;<span class="op" id="2696219">==</span>&nbsp;<span class="ident" id="2696222">V</span>&nbsp;<span class="op" id="2696224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696228">return</span>&nbsp;<span class="builtintype" id="2696235">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696245">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696299">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696337">if</span>&nbsp;<span class="ident" id="2696340">T</span><span class="op" id="2696341">.</span><span class="ident" id="2696342">Name</span><span class="op" id="2696346">(</span><span class="op" id="2696347">)</span>&nbsp;<span class="op" id="2696349">!=</span>&nbsp;<span class="string" id="2696352">&#34;&#34;</span>&nbsp;<span class="op" id="2696355">&amp;&amp;</span>&nbsp;<span class="ident" id="2696358">V</span><span class="op" id="2696359">.</span><span class="ident" id="2696360">Name</span><span class="op" id="2696364">(</span><span class="op" id="2696365">)</span>&nbsp;<span class="op" id="2696367">!=</span>&nbsp;<span class="string" id="2696370">&#34;&#34;</span>&nbsp;<span class="op" id="2696373">||</span>&nbsp;<span class="ident" id="2696376">T</span><span class="op" id="2696377">.</span><span class="ident" id="2696378">Kind</span><span class="op" id="2696382">(</span><span class="op" id="2696383">)</span>&nbsp;<span class="op" id="2696385">!=</span>&nbsp;<span class="ident" id="2696388">V</span><span class="op" id="2696389">.</span><span class="ident" id="2696390">Kind</span><span class="op" id="2696394">(</span><span class="op" id="2696395">)</span>&nbsp;<span class="op" id="2696397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696401">return</span>&nbsp;<span class="builtintype" id="2696408">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696415">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696419">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696479">return</span>&nbsp;<span class="ident" id="2696486">haveIdenticalUnderlyingType</span><span class="op" id="2696513">(</span><span class="ident" id="2696514">T</span><span class="op" id="2696515">,</span>&nbsp;<span class="ident" id="2696517">V</span><span class="op" id="2696518">)</span><br>
<span class="lineno"></span><span class="op" id="2696520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2696523">func</span>&nbsp;<span class="ident" id="2696528">haveIdenticalUnderlyingType</span><span class="op" id="2696555">(</span><span class="ident" id="2696556">T</span><span class="op" id="2696557">,</span>&nbsp;<span class="ident" id="2696559">V</span>&nbsp;<span class="op" id="2696561">*</span><span class="ident" id="2696562">rtype</span><span class="op" id="2696567">)</span>&nbsp;<span class="builtintype" id="2696569">bool</span>&nbsp;<span class="op" id="2696574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696577">if</span>&nbsp;<span class="ident" id="2696580">T</span>&nbsp;<span class="op" id="2696582">==</span>&nbsp;<span class="ident" id="2696585">V</span>&nbsp;<span class="op" id="2696587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696591">return</span>&nbsp;<span class="builtintype" id="2696598">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696608">kind</span>&nbsp;<span class="op" id="2696613">:=</span>&nbsp;<span class="ident" id="2696616">T</span><span class="op" id="2696617">.</span><span class="ident" id="2696618">Kind</span><span class="op" id="2696622">(</span><span class="op" id="2696623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696626">if</span>&nbsp;<span class="ident" id="2696629">kind</span>&nbsp;<span class="op" id="2696634">!=</span>&nbsp;<span class="ident" id="2696637">V</span><span class="op" id="2696638">.</span><span class="ident" id="2696639">Kind</span><span class="op" id="2696643">(</span><span class="op" id="2696644">)</span>&nbsp;<span class="op" id="2696646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696650">return</span>&nbsp;<span class="builtintype" id="2696657">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696668">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696732">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696775">if</span>&nbsp;<span class="ident" id="2696778">Bool</span>&nbsp;<span class="op" id="2696783">&lt;=</span>&nbsp;<span class="ident" id="2696786">kind</span>&nbsp;<span class="op" id="2696791">&amp;&amp;</span>&nbsp;<span class="ident" id="2696794">kind</span>&nbsp;<span class="op" id="2696799">&lt;=</span>&nbsp;<span class="ident" id="2696802">Complex128</span>&nbsp;<span class="op" id="2696813">||</span>&nbsp;<span class="ident" id="2696816">kind</span>&nbsp;<span class="op" id="2696821">==</span>&nbsp;<span class="ident" id="2696824">String</span>&nbsp;<span class="op" id="2696831">||</span>&nbsp;<span class="ident" id="2696834">kind</span>&nbsp;<span class="op" id="2696839">==</span>&nbsp;<span class="ident" id="2696842">UnsafePointer</span>&nbsp;<span class="op" id="2696856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696860">return</span>&nbsp;<span class="builtintype" id="2696867">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696873">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696877">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696898">switch</span>&nbsp;<span class="ident" id="2696905">kind</span>&nbsp;<span class="op" id="2696910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696913">case</span>&nbsp;<span class="ident" id="2696918">Array</span><span class="op" id="2696923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696927">return</span>&nbsp;<span class="ident" id="2696934">T</span><span class="op" id="2696935">.</span><span class="ident" id="2696936">Elem</span><span class="op" id="2696940">(</span><span class="op" id="2696941">)</span>&nbsp;<span class="op" id="2696943">==</span>&nbsp;<span class="ident" id="2696946">V</span><span class="op" id="2696947">.</span><span class="ident" id="2696948">Elem</span><span class="op" id="2696952">(</span><span class="op" id="2696953">)</span>&nbsp;<span class="op" id="2696955">&amp;&amp;</span>&nbsp;<span class="ident" id="2696958">T</span><span class="op" id="2696959">.</span><span class="ident" id="2696960">Len</span><span class="op" id="2696963">(</span><span class="op" id="2696964">)</span>&nbsp;<span class="op" id="2696966">==</span>&nbsp;<span class="ident" id="2696969">V</span><span class="op" id="2696970">.</span><span class="ident" id="2696971">Len</span><span class="op" id="2696974">(</span><span class="op" id="2696975">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696979">case</span>&nbsp;<span class="ident" id="2696984">Chan</span><span class="op" id="2696988">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696992">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697011">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697073">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697129">if</span>&nbsp;<span class="ident" id="2697132">V</span><span class="op" id="2697133">.</span><span class="ident" id="2697134">ChanDir</span><span class="op" id="2697141">(</span><span class="op" id="2697142">)</span>&nbsp;<span class="op" id="2697144">==</span>&nbsp;<span class="ident" id="2697147">BothDir</span>&nbsp;<span class="op" id="2697155">&amp;&amp;</span>&nbsp;<span class="ident" id="2697158">T</span><span class="op" id="2697159">.</span><span class="ident" id="2697160">Elem</span><span class="op" id="2697164">(</span><span class="op" id="2697165">)</span>&nbsp;<span class="op" id="2697167">==</span>&nbsp;<span class="ident" id="2697170">V</span><span class="op" id="2697171">.</span><span class="ident" id="2697172">Elem</span><span class="op" id="2697176">(</span><span class="op" id="2697177">)</span>&nbsp;<span class="op" id="2697179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697184">return</span>&nbsp;<span class="builtintype" id="2697191">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697203">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697263">return</span>&nbsp;<span class="ident" id="2697270">V</span><span class="op" id="2697271">.</span><span class="ident" id="2697272">ChanDir</span><span class="op" id="2697279">(</span><span class="op" id="2697280">)</span>&nbsp;<span class="op" id="2697282">==</span>&nbsp;<span class="ident" id="2697285">T</span><span class="op" id="2697286">.</span><span class="ident" id="2697287">ChanDir</span><span class="op" id="2697294">(</span><span class="op" id="2697295">)</span>&nbsp;<span class="op" id="2697297">&amp;&amp;</span>&nbsp;<span class="ident" id="2697300">T</span><span class="op" id="2697301">.</span><span class="ident" id="2697302">Elem</span><span class="op" id="2697306">(</span><span class="op" id="2697307">)</span>&nbsp;<span class="op" id="2697309">==</span>&nbsp;<span class="ident" id="2697312">V</span><span class="op" id="2697313">.</span><span class="ident" id="2697314">Elem</span><span class="op" id="2697318">(</span><span class="op" id="2697319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697323">case</span>&nbsp;<span class="ident" id="2697328">Func</span><span class="op" id="2697332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697336">t</span>&nbsp;<span class="op" id="2697338">:=</span>&nbsp;<span class="op" id="2697341">(</span><span class="op" id="2697342">*</span><span class="ident" id="2697343">funcType</span><span class="op" id="2697351">)</span><span class="op" id="2697352">(</span><span class="ident" id="2697353">unsafe</span><span class="op" id="2697359">.</span><span class="ident" id="2697360">Pointer</span><span class="op" id="2697367">(</span><span class="ident" id="2697368">T</span><span class="op" id="2697369">)</span><span class="op" id="2697370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697374">v</span>&nbsp;<span class="op" id="2697376">:=</span>&nbsp;<span class="op" id="2697379">(</span><span class="op" id="2697380">*</span><span class="ident" id="2697381">funcType</span><span class="op" id="2697389">)</span><span class="op" id="2697390">(</span><span class="ident" id="2697391">unsafe</span><span class="op" id="2697397">.</span><span class="ident" id="2697398">Pointer</span><span class="op" id="2697405">(</span><span class="ident" id="2697406">V</span><span class="op" id="2697407">)</span><span class="op" id="2697408">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697412">if</span>&nbsp;<span class="ident" id="2697415">t</span><span class="op" id="2697416">.</span><span class="ident" id="2697417">dotdotdot</span>&nbsp;<span class="op" id="2697427">!=</span>&nbsp;<span class="ident" id="2697430">v</span><span class="op" id="2697431">.</span><span class="ident" id="2697432">dotdotdot</span>&nbsp;<span class="op" id="2697442">||</span>&nbsp;<span class="builtinfunc" id="2697445">len</span><span class="op" id="2697448">(</span><span class="ident" id="2697449">t</span><span class="op" id="2697450">.</span><span class="ident" id="2697451">in</span><span class="op" id="2697453">)</span>&nbsp;<span class="op" id="2697455">!=</span>&nbsp;<span class="builtinfunc" id="2697458">len</span><span class="op" id="2697461">(</span><span class="ident" id="2697462">v</span><span class="op" id="2697463">.</span><span class="ident" id="2697464">in</span><span class="op" id="2697466">)</span>&nbsp;<span class="op" id="2697468">||</span>&nbsp;<span class="builtinfunc" id="2697471">len</span><span class="op" id="2697474">(</span><span class="ident" id="2697475">t</span><span class="op" id="2697476">.</span><span class="ident" id="2697477">out</span><span class="op" id="2697480">)</span>&nbsp;<span class="op" id="2697482">!=</span>&nbsp;<span class="builtinfunc" id="2697485">len</span><span class="op" id="2697488">(</span><span class="ident" id="2697489">v</span><span class="op" id="2697490">.</span><span class="ident" id="2697491">out</span><span class="op" id="2697494">)</span>&nbsp;<span class="op" id="2697496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697501">return</span>&nbsp;<span class="builtintype" id="2697508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697520">for</span>&nbsp;<span class="ident" id="2697524">i</span><span class="op" id="2697525">,</span>&nbsp;<span class="ident" id="2697527">typ</span>&nbsp;<span class="op" id="2697531">:=</span>&nbsp;<span class="keyword" id="2697534">range</span>&nbsp;<span class="ident" id="2697540">t</span><span class="op" id="2697541">.</span><span class="ident" id="2697542">in</span>&nbsp;<span class="op" id="2697545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697550">if</span>&nbsp;<span class="ident" id="2697553">typ</span>&nbsp;<span class="op" id="2697557">!=</span>&nbsp;<span class="ident" id="2697560">v</span><span class="op" id="2697561">.</span><span class="ident" id="2697562">in</span><span class="op" id="2697564">[</span><span class="ident" id="2697565">i</span><span class="op" id="2697566">]</span>&nbsp;<span class="op" id="2697568">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697574">return</span>&nbsp;<span class="builtintype" id="2697581">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697598">for</span>&nbsp;<span class="ident" id="2697602">i</span><span class="op" id="2697603">,</span>&nbsp;<span class="ident" id="2697605">typ</span>&nbsp;<span class="op" id="2697609">:=</span>&nbsp;<span class="keyword" id="2697612">range</span>&nbsp;<span class="ident" id="2697618">t</span><span class="op" id="2697619">.</span><span class="ident" id="2697620">out</span>&nbsp;<span class="op" id="2697624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697629">if</span>&nbsp;<span class="ident" id="2697632">typ</span>&nbsp;<span class="op" id="2697636">!=</span>&nbsp;<span class="ident" id="2697639">v</span><span class="op" id="2697640">.</span><span class="ident" id="2697641">out</span><span class="op" id="2697644">[</span><span class="ident" id="2697645">i</span><span class="op" id="2697646">]</span>&nbsp;<span class="op" id="2697648">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697654">return</span>&nbsp;<span class="builtintype" id="2697661">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697678">return</span>&nbsp;<span class="builtintype" id="2697685">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697692">case</span>&nbsp;<span class="ident" id="2697697">Interface</span><span class="op" id="2697706">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697710">t</span>&nbsp;<span class="op" id="2697712">:=</span>&nbsp;<span class="op" id="2697715">(</span><span class="op" id="2697716">*</span><span class="ident" id="2697717">interfaceType</span><span class="op" id="2697730">)</span><span class="op" id="2697731">(</span><span class="ident" id="2697732">unsafe</span><span class="op" id="2697738">.</span><span class="ident" id="2697739">Pointer</span><span class="op" id="2697746">(</span><span class="ident" id="2697747">T</span><span class="op" id="2697748">)</span><span class="op" id="2697749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697753">v</span>&nbsp;<span class="op" id="2697755">:=</span>&nbsp;<span class="op" id="2697758">(</span><span class="op" id="2697759">*</span><span class="ident" id="2697760">interfaceType</span><span class="op" id="2697773">)</span><span class="op" id="2697774">(</span><span class="ident" id="2697775">unsafe</span><span class="op" id="2697781">.</span><span class="ident" id="2697782">Pointer</span><span class="op" id="2697789">(</span><span class="ident" id="2697790">V</span><span class="op" id="2697791">)</span><span class="op" id="2697792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697796">if</span>&nbsp;<span class="builtinfunc" id="2697799">len</span><span class="op" id="2697802">(</span><span class="ident" id="2697803">t</span><span class="op" id="2697804">.</span><span class="ident" id="2697805">methods</span><span class="op" id="2697812">)</span>&nbsp;<span class="op" id="2697814">==</span>&nbsp;<span class="num" id="2697817">0</span>&nbsp;<span class="op" id="2697819">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2697822">len</span><span class="op" id="2697825">(</span><span class="ident" id="2697826">v</span><span class="op" id="2697827">.</span><span class="ident" id="2697828">methods</span><span class="op" id="2697835">)</span>&nbsp;<span class="op" id="2697837">==</span>&nbsp;<span class="num" id="2697840">0</span>&nbsp;<span class="op" id="2697842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697847">return</span>&nbsp;<span class="builtintype" id="2697854">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697865">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697908">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697941">return</span>&nbsp;<span class="builtintype" id="2697948">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697956">case</span>&nbsp;<span class="ident" id="2697961">Map</span><span class="op" id="2697964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697968">return</span>&nbsp;<span class="ident" id="2697975">T</span><span class="op" id="2697976">.</span><span class="ident" id="2697977">Key</span><span class="op" id="2697980">(</span><span class="op" id="2697981">)</span>&nbsp;<span class="op" id="2697983">==</span>&nbsp;<span class="ident" id="2697986">V</span><span class="op" id="2697987">.</span><span class="ident" id="2697988">Key</span><span class="op" id="2697991">(</span><span class="op" id="2697992">)</span>&nbsp;<span class="op" id="2697994">&amp;&amp;</span>&nbsp;<span class="ident" id="2697997">T</span><span class="op" id="2697998">.</span><span class="ident" id="2697999">Elem</span><span class="op" id="2698003">(</span><span class="op" id="2698004">)</span>&nbsp;<span class="op" id="2698006">==</span>&nbsp;<span class="ident" id="2698009">V</span><span class="op" id="2698010">.</span><span class="ident" id="2698011">Elem</span><span class="op" id="2698015">(</span><span class="op" id="2698016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698020">case</span>&nbsp;<span class="ident" id="2698025">Ptr</span><span class="op" id="2698028">,</span>&nbsp;<span class="ident" id="2698030">Slice</span><span class="op" id="2698035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698039">return</span>&nbsp;<span class="ident" id="2698046">T</span><span class="op" id="2698047">.</span><span class="ident" id="2698048">Elem</span><span class="op" id="2698052">(</span><span class="op" id="2698053">)</span>&nbsp;<span class="op" id="2698055">==</span>&nbsp;<span class="ident" id="2698058">V</span><span class="op" id="2698059">.</span><span class="ident" id="2698060">Elem</span><span class="op" id="2698064">(</span><span class="op" id="2698065">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698069">case</span>&nbsp;<span class="ident" id="2698074">Struct</span><span class="op" id="2698080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698084">t</span>&nbsp;<span class="op" id="2698086">:=</span>&nbsp;<span class="op" id="2698089">(</span><span class="op" id="2698090">*</span><span class="ident" id="2698091">structType</span><span class="op" id="2698101">)</span><span class="op" id="2698102">(</span><span class="ident" id="2698103">unsafe</span><span class="op" id="2698109">.</span><span class="ident" id="2698110">Pointer</span><span class="op" id="2698117">(</span><span class="ident" id="2698118">T</span><span class="op" id="2698119">)</span><span class="op" id="2698120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698124">v</span>&nbsp;<span class="op" id="2698126">:=</span>&nbsp;<span class="op" id="2698129">(</span><span class="op" id="2698130">*</span><span class="ident" id="2698131">structType</span><span class="op" id="2698141">)</span><span class="op" id="2698142">(</span><span class="ident" id="2698143">unsafe</span><span class="op" id="2698149">.</span><span class="ident" id="2698150">Pointer</span><span class="op" id="2698157">(</span><span class="ident" id="2698158">V</span><span class="op" id="2698159">)</span><span class="op" id="2698160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698164">if</span>&nbsp;<span class="builtinfunc" id="2698167">len</span><span class="op" id="2698170">(</span><span class="ident" id="2698171">t</span><span class="op" id="2698172">.</span><span class="ident" id="2698173">fields</span><span class="op" id="2698179">)</span>&nbsp;<span class="op" id="2698181">!=</span>&nbsp;<span class="builtinfunc" id="2698184">len</span><span class="op" id="2698187">(</span><span class="ident" id="2698188">v</span><span class="op" id="2698189">.</span><span class="ident" id="2698190">fields</span><span class="op" id="2698196">)</span>&nbsp;<span class="op" id="2698198">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698203">return</span>&nbsp;<span class="builtintype" id="2698210">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698222">for</span>&nbsp;<span class="ident" id="2698226">i</span>&nbsp;<span class="op" id="2698228">:=</span>&nbsp;<span class="keyword" id="2698231">range</span>&nbsp;<span class="ident" id="2698237">t</span><span class="op" id="2698238">.</span><span class="ident" id="2698239">fields</span>&nbsp;<span class="op" id="2698246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698251">tf</span>&nbsp;<span class="op" id="2698254">:=</span>&nbsp;<span class="op" id="2698257">&amp;</span><span class="ident" id="2698258">t</span><span class="op" id="2698259">.</span><span class="ident" id="2698260">fields</span><span class="op" id="2698266">[</span><span class="ident" id="2698267">i</span><span class="op" id="2698268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698273">vf</span>&nbsp;<span class="op" id="2698276">:=</span>&nbsp;<span class="op" id="2698279">&amp;</span><span class="ident" id="2698280">v</span><span class="op" id="2698281">.</span><span class="ident" id="2698282">fields</span><span class="op" id="2698288">[</span><span class="ident" id="2698289">i</span><span class="op" id="2698290">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698295">if</span>&nbsp;<span class="ident" id="2698298">tf</span><span class="op" id="2698300">.</span><span class="ident" id="2698301">name</span>&nbsp;<span class="op" id="2698306">!=</span>&nbsp;<span class="ident" id="2698309">vf</span><span class="op" id="2698311">.</span><span class="ident" id="2698312">name</span>&nbsp;<span class="op" id="2698317">&amp;&amp;</span>&nbsp;<span class="op" id="2698320">(</span><span class="ident" id="2698321">tf</span><span class="op" id="2698323">.</span><span class="ident" id="2698324">name</span>&nbsp;<span class="op" id="2698329">==</span>&nbsp;<span class="ident" id="2698332">nil</span>&nbsp;<span class="op" id="2698336">||</span>&nbsp;<span class="ident" id="2698339">vf</span><span class="op" id="2698341">.</span><span class="ident" id="2698342">name</span>&nbsp;<span class="op" id="2698347">==</span>&nbsp;<span class="ident" id="2698350">nil</span>&nbsp;<span class="op" id="2698354">||</span>&nbsp;<span class="op" id="2698357">*</span><span class="ident" id="2698358">tf</span><span class="op" id="2698360">.</span><span class="ident" id="2698361">name</span>&nbsp;<span class="op" id="2698366">!=</span>&nbsp;<span class="op" id="2698369">*</span><span class="ident" id="2698370">vf</span><span class="op" id="2698372">.</span><span class="ident" id="2698373">name</span><span class="op" id="2698377">)</span>&nbsp;<span class="op" id="2698379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698385">return</span>&nbsp;<span class="builtintype" id="2698392">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698406">if</span>&nbsp;<span class="ident" id="2698409">tf</span><span class="op" id="2698411">.</span><span class="ident" id="2698412">pkgPath</span>&nbsp;<span class="op" id="2698420">!=</span>&nbsp;<span class="ident" id="2698423">vf</span><span class="op" id="2698425">.</span><span class="ident" id="2698426">pkgPath</span>&nbsp;<span class="op" id="2698434">&amp;&amp;</span>&nbsp;<span class="op" id="2698437">(</span><span class="ident" id="2698438">tf</span><span class="op" id="2698440">.</span><span class="ident" id="2698441">pkgPath</span>&nbsp;<span class="op" id="2698449">==</span>&nbsp;<span class="ident" id="2698452">nil</span>&nbsp;<span class="op" id="2698456">||</span>&nbsp;<span class="ident" id="2698459">vf</span><span class="op" id="2698461">.</span><span class="ident" id="2698462">pkgPath</span>&nbsp;<span class="op" id="2698470">==</span>&nbsp;<span class="ident" id="2698473">nil</span>&nbsp;<span class="op" id="2698477">||</span>&nbsp;<span class="op" id="2698480">*</span><span class="ident" id="2698481">tf</span><span class="op" id="2698483">.</span><span class="ident" id="2698484">pkgPath</span>&nbsp;<span class="op" id="2698492">!=</span>&nbsp;<span class="op" id="2698495">*</span><span class="ident" id="2698496">vf</span><span class="op" id="2698498">.</span><span class="ident" id="2698499">pkgPath</span><span class="op" id="2698506">)</span>&nbsp;<span class="op" id="2698508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698514">return</span>&nbsp;<span class="builtintype" id="2698521">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698535">if</span>&nbsp;<span class="ident" id="2698538">tf</span><span class="op" id="2698540">.</span><span class="ident" id="2698541">typ</span>&nbsp;<span class="op" id="2698545">!=</span>&nbsp;<span class="ident" id="2698548">vf</span><span class="op" id="2698550">.</span><span class="ident" id="2698551">typ</span>&nbsp;<span class="op" id="2698555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698561">return</span>&nbsp;<span class="builtintype" id="2698568">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698582">if</span>&nbsp;<span class="ident" id="2698585">tf</span><span class="op" id="2698587">.</span><span class="ident" id="2698588">tag</span>&nbsp;<span class="op" id="2698592">!=</span>&nbsp;<span class="ident" id="2698595">vf</span><span class="op" id="2698597">.</span><span class="ident" id="2698598">tag</span>&nbsp;<span class="op" id="2698602">&amp;&amp;</span>&nbsp;<span class="op" id="2698605">(</span><span class="ident" id="2698606">tf</span><span class="op" id="2698608">.</span><span class="ident" id="2698609">tag</span>&nbsp;<span class="op" id="2698613">==</span>&nbsp;<span class="ident" id="2698616">nil</span>&nbsp;<span class="op" id="2698620">||</span>&nbsp;<span class="ident" id="2698623">vf</span><span class="op" id="2698625">.</span><span class="ident" id="2698626">tag</span>&nbsp;<span class="op" id="2698630">==</span>&nbsp;<span class="ident" id="2698633">nil</span>&nbsp;<span class="op" id="2698637">||</span>&nbsp;<span class="op" id="2698640">*</span><span class="ident" id="2698641">tf</span><span class="op" id="2698643">.</span><span class="ident" id="2698644">tag</span>&nbsp;<span class="op" id="2698648">!=</span>&nbsp;<span class="op" id="2698651">*</span><span class="ident" id="2698652">vf</span><span class="op" id="2698654">.</span><span class="ident" id="2698655">tag</span><span class="op" id="2698658">)</span>&nbsp;<span class="op" id="2698660">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698666">return</span>&nbsp;<span class="builtintype" id="2698673">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698687">if</span>&nbsp;<span class="ident" id="2698690">tf</span><span class="op" id="2698692">.</span><span class="ident" id="2698693">offset</span>&nbsp;<span class="op" id="2698700">!=</span>&nbsp;<span class="ident" id="2698703">vf</span><span class="op" id="2698705">.</span><span class="ident" id="2698706">offset</span>&nbsp;<span class="op" id="2698713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698719">return</span>&nbsp;<span class="builtintype" id="2698726">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698735">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698743">return</span>&nbsp;<span class="builtintype" id="2698750">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698760">return</span>&nbsp;<span class="builtintype" id="2698767">false</span><br>
<span class="lineno">1285</span><span class="op" id="2698773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2698776">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2698824">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2698895">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2698956">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2699015">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2699066">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2699119">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2699158">func</span>&nbsp;<span class="ident" id="2699163">typelinks</span><span class="op" id="2699172">(</span><span class="op" id="2699173">)</span>&nbsp;<span class="op" id="2699175">[</span><span class="op" id="2699176">]</span><span class="op" id="2699177">*</span><span class="ident" id="2699178">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2699185">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2699258">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2699294">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2699359">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2699415">func</span>&nbsp;<span class="ident" id="2699420">typesByString</span><span class="op" id="2699433">(</span><span class="ident" id="2699434">s</span>&nbsp;<span class="builtintype" id="2699436">string</span><span class="op" id="2699442">)</span>&nbsp;<span class="op" id="2699444">[</span><span class="op" id="2699445">]</span><span class="op" id="2699446">*</span><span class="ident" id="2699447">rtype</span>&nbsp;<span class="op" id="2699453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699456">typ</span>&nbsp;<span class="op" id="2699460">:=</span>&nbsp;<span class="ident" id="2699463">typelinks</span><span class="op" id="2699472">(</span><span class="op" id="2699473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699477">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699549">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699629">i</span><span class="op" id="2699630">,</span>&nbsp;<span class="ident" id="2699632">j</span>&nbsp;<span class="op" id="2699634">:=</span>&nbsp;<span class="num" id="2699637">0</span><span class="op" id="2699638">,</span>&nbsp;<span class="builtinfunc" id="2699640">len</span><span class="op" id="2699643">(</span><span class="ident" id="2699644">typ</span><span class="op" id="2699647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699650">for</span>&nbsp;<span class="ident" id="2699654">i</span>&nbsp;<span class="op" id="2699656">&lt;</span>&nbsp;<span class="ident" id="2699658">j</span>&nbsp;<span class="op" id="2699660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699664">h</span>&nbsp;<span class="op" id="2699666">:=</span>&nbsp;<span class="ident" id="2699669">i</span>&nbsp;<span class="op" id="2699671">+</span>&nbsp;<span class="op" id="2699673">(</span><span class="ident" id="2699674">j</span><span class="op" id="2699675">-</span><span class="ident" id="2699676">i</span><span class="op" id="2699677">)</span><span class="op" id="2699678">/</span><span class="num" id="2699679">2</span>&nbsp;<span class="comment" id="2699681">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699718">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699735">if</span>&nbsp;<span class="op" id="2699738">!</span><span class="op" id="2699739">(</span><span class="op" id="2699740">*</span><span class="ident" id="2699741">typ</span><span class="op" id="2699744">[</span><span class="ident" id="2699745">h</span><span class="op" id="2699746">]</span><span class="op" id="2699747">.</span><span class="builtintype" id="2699748">string</span>&nbsp;<span class="op" id="2699755">&gt;=</span>&nbsp;<span class="ident" id="2699758">s</span><span class="op" id="2699759">)</span>&nbsp;<span class="op" id="2699761">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699766">i</span>&nbsp;<span class="op" id="2699768">=</span>&nbsp;<span class="ident" id="2699770">h</span>&nbsp;<span class="op" id="2699772">+</span>&nbsp;<span class="num" id="2699774">1</span>&nbsp;<span class="comment" id="2699776">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699807">}</span>&nbsp;<span class="keyword" id="2699809">else</span>&nbsp;<span class="op" id="2699814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699819">j</span>&nbsp;<span class="op" id="2699821">=</span>&nbsp;<span class="ident" id="2699823">h</span>&nbsp;<span class="comment" id="2699825">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699856">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699859">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699933">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699999">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2700063">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700095">j</span>&nbsp;<span class="op" id="2700097">=</span>&nbsp;<span class="ident" id="2700099">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700102">for</span>&nbsp;<span class="ident" id="2700106">j</span>&nbsp;<span class="op" id="2700108">&lt;</span>&nbsp;<span class="builtinfunc" id="2700110">len</span><span class="op" id="2700113">(</span><span class="ident" id="2700114">typ</span><span class="op" id="2700117">)</span>&nbsp;<span class="op" id="2700119">&amp;&amp;</span>&nbsp;<span class="op" id="2700122">*</span><span class="ident" id="2700123">typ</span><span class="op" id="2700126">[</span><span class="ident" id="2700127">j</span><span class="op" id="2700128">]</span><span class="op" id="2700129">.</span><span class="builtintype" id="2700130">string</span>&nbsp;<span class="op" id="2700137">==</span>&nbsp;<span class="ident" id="2700140">s</span>&nbsp;<span class="op" id="2700142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700146">j</span><span class="op" id="2700147">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2700155">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700212">return</span>&nbsp;<span class="ident" id="2700219">typ</span><span class="op" id="2700222">[</span><span class="ident" id="2700223">i</span><span class="op" id="2700224">:</span><span class="ident" id="2700225">j</span><span class="op" id="2700226">]</span><br>
<span class="lineno"></span><span class="op" id="2700228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2700231">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2700293">var</span>&nbsp;<span class="ident" id="2700297">lookupCache</span>&nbsp;<span class="keyword" id="2700309">struct</span>&nbsp;<span class="op" id="2700316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700319">sync</span><span class="op" id="2700323">.</span><span class="ident" id="2700324">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700333">m</span>&nbsp;<span class="keyword" id="2700335">map</span><span class="op" id="2700338">[</span><span class="ident" id="2700339">cacheKey</span><span class="op" id="2700347">]</span><span class="op" id="2700348">*</span><span class="ident" id="2700349">rtype</span><br>
<span class="lineno"></span><span class="op" id="2700355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2700358">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2700411">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2700472">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2700529">type</span>&nbsp;<span class="ident" id="2700534">cacheKey</span>&nbsp;<span class="keyword" id="2700543">struct</span>&nbsp;<span class="op" id="2700550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700553">kind</span>&nbsp;&nbsp;<span class="ident" id="2700559">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700565">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700571">*</span><span class="ident" id="2700572">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700579">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700585">*</span><span class="ident" id="2700586">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700593">extra</span>&nbsp;<span class="builtintype" id="2700599">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2700607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2700610">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2700675">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2700717">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2700766">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2700829">func</span>&nbsp;<span class="ident" id="2700834">cacheGet</span><span class="op" id="2700842">(</span><span class="ident" id="2700843">k</span>&nbsp;<span class="ident" id="2700845">cacheKey</span><span class="op" id="2700853">)</span>&nbsp;<span class="ident" id="2700855">Type</span>&nbsp;<span class="op" id="2700860">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700863">lookupCache</span><span class="op" id="2700874">.</span><span class="ident" id="2700875">RLock</span><span class="op" id="2700880">(</span><span class="op" id="2700881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700884">t</span>&nbsp;<span class="op" id="2700886">:=</span>&nbsp;<span class="ident" id="2700889">lookupCache</span><span class="op" id="2700900">.</span><span class="ident" id="2700901">m</span><span class="op" id="2700902">[</span><span class="ident" id="2700903">k</span><span class="op" id="2700904">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700907">lookupCache</span><span class="op" id="2700918">.</span><span class="ident" id="2700919">RUnlock</span><span class="op" id="2700926">(</span><span class="op" id="2700927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700930">if</span>&nbsp;<span class="ident" id="2700933">t</span>&nbsp;<span class="op" id="2700935">!=</span>&nbsp;<span class="ident" id="2700938">nil</span>&nbsp;<span class="op" id="2700942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700946">return</span>&nbsp;<span class="ident" id="2700953">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700960">lookupCache</span><span class="op" id="2700971">.</span><span class="ident" id="2700972">Lock</span><span class="op" id="2700976">(</span><span class="op" id="2700977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700980">t</span>&nbsp;<span class="op" id="2700982">=</span>&nbsp;<span class="ident" id="2700984">lookupCache</span><span class="op" id="2700995">.</span><span class="ident" id="2700996">m</span><span class="op" id="2700997">[</span><span class="ident" id="2700998">k</span><span class="op" id="2700999">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701002">if</span>&nbsp;<span class="ident" id="2701005">t</span>&nbsp;<span class="op" id="2701007">!=</span>&nbsp;<span class="ident" id="2701010">nil</span>&nbsp;<span class="op" id="2701014">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701018">lookupCache</span><span class="op" id="2701029">.</span><span class="ident" id="2701030">Unlock</span><span class="op" id="2701036">(</span><span class="op" id="2701037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701041">return</span>&nbsp;<span class="ident" id="2701048">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701055">if</span>&nbsp;<span class="ident" id="2701058">lookupCache</span><span class="op" id="2701069">.</span><span class="ident" id="2701070">m</span>&nbsp;<span class="op" id="2701072">==</span>&nbsp;<span class="ident" id="2701075">nil</span>&nbsp;<span class="op" id="2701079">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701083">lookupCache</span><span class="op" id="2701094">.</span><span class="ident" id="2701095">m</span>&nbsp;<span class="op" id="2701097">=</span>&nbsp;<span class="builtinfunc" id="2701099">make</span><span class="op" id="2701103">(</span><span class="keyword" id="2701104">map</span><span class="op" id="2701107">[</span><span class="ident" id="2701108">cacheKey</span><span class="op" id="2701116">]</span><span class="op" id="2701117">*</span><span class="ident" id="2701118">rtype</span><span class="op" id="2701123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701130">return</span>&nbsp;<span class="ident" id="2701137">nil</span><br>
<span class="lineno"></span><span class="op" id="2701141">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2701144">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2701211">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2701276">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2701310">func</span>&nbsp;<span class="ident" id="2701315">cachePut</span><span class="op" id="2701323">(</span><span class="ident" id="2701324">k</span>&nbsp;<span class="ident" id="2701326">cacheKey</span><span class="op" id="2701334">,</span>&nbsp;<span class="ident" id="2701336">t</span>&nbsp;<span class="op" id="2701338">*</span><span class="ident" id="2701339">rtype</span><span class="op" id="2701344">)</span>&nbsp;<span class="ident" id="2701346">Type</span>&nbsp;<span class="op" id="2701351">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701354">lookupCache</span><span class="op" id="2701365">.</span><span class="ident" id="2701366">m</span><span class="op" id="2701367">[</span><span class="ident" id="2701368">k</span><span class="op" id="2701369">]</span>&nbsp;<span class="op" id="2701371">=</span>&nbsp;<span class="ident" id="2701373">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701376">lookupCache</span><span class="op" id="2701387">.</span><span class="ident" id="2701388">Unlock</span><span class="op" id="2701394">(</span><span class="op" id="2701395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701398">return</span>&nbsp;<span class="ident" id="2701405">t</span><br>
<span class="lineno"></span><span class="op" id="2701407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2701410">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2701488">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2701567">//</span><br>
<span class="lineno"></span><span class="comment" id="2701570">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2701639">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2701704">func</span>&nbsp;<span class="ident" id="2701709">ChanOf</span><span class="op" id="2701715">(</span><span class="ident" id="2701716">dir</span>&nbsp;<span class="ident" id="2701720">ChanDir</span><span class="op" id="2701727">,</span>&nbsp;<span class="ident" id="2701729">t</span>&nbsp;<span class="ident" id="2701731">Type</span><span class="op" id="2701735">)</span>&nbsp;<span class="ident" id="2701737">Type</span>&nbsp;<span class="op" id="2701742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701745">typ</span>&nbsp;<span class="op" id="2701749">:=</span>&nbsp;<span class="ident" id="2701752">t</span><span class="op" id="2701753">.</span><span class="op" id="2701754">(</span><span class="op" id="2701755">*</span><span class="ident" id="2701756">rtype</span><span class="op" id="2701761">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701765">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701784">ckey</span>&nbsp;<span class="op" id="2701789">:=</span>&nbsp;<span class="ident" id="2701792">cacheKey</span><span class="op" id="2701800">{</span><span class="ident" id="2701801">Chan</span><span class="op" id="2701805">,</span>&nbsp;<span class="ident" id="2701807">typ</span><span class="op" id="2701810">,</span>&nbsp;<span class="ident" id="2701812">nil</span><span class="op" id="2701815">,</span>&nbsp;<span class="builtintype" id="2701817">uintptr</span><span class="op" id="2701824">(</span><span class="ident" id="2701825">dir</span><span class="op" id="2701828">)</span><span class="op" id="2701829">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701832">if</span>&nbsp;<span class="ident" id="2701835">ch</span>&nbsp;<span class="op" id="2701838">:=</span>&nbsp;<span class="ident" id="2701841">cacheGet</span><span class="op" id="2701849">(</span><span class="ident" id="2701850">ckey</span><span class="op" id="2701854">)</span><span class="op" id="2701855">;</span>&nbsp;<span class="ident" id="2701857">ch</span>&nbsp;<span class="op" id="2701860">!=</span>&nbsp;<span class="ident" id="2701863">nil</span>&nbsp;<span class="op" id="2701867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701871">return</span>&nbsp;<span class="ident" id="2701878">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701886">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701954">if</span>&nbsp;<span class="ident" id="2701957">typ</span><span class="op" id="2701960">.</span><span class="ident" id="2701961">size</span>&nbsp;<span class="op" id="2701966">&gt;=</span>&nbsp;<span class="num" id="2701969">1</span><span class="op" id="2701970">&lt;&lt;</span><span class="num" id="2701972">16</span>&nbsp;<span class="op" id="2701975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701979">lookupCache</span><span class="op" id="2701990">.</span><span class="ident" id="2701991">Unlock</span><span class="op" id="2701997">(</span><span class="op" id="2701998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2702002">panic</span><span class="op" id="2702007">(</span><span class="string" id="2702008">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2702048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2702055">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2702080">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702127">var</span>&nbsp;<span class="ident" id="2702131">s</span>&nbsp;<span class="builtintype" id="2702133">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702141">switch</span>&nbsp;<span class="ident" id="2702148">dir</span>&nbsp;<span class="op" id="2702152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702155">default</span><span class="op" id="2702162">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702166">lookupCache</span><span class="op" id="2702177">.</span><span class="ident" id="2702178">Unlock</span><span class="op" id="2702184">(</span><span class="op" id="2702185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2702189">panic</span><span class="op" id="2702194">(</span><span class="string" id="2702195">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2702224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702227">case</span>&nbsp;<span class="ident" id="2702232">SendDir</span><span class="op" id="2702239">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702243">s</span>&nbsp;<span class="op" id="2702245">=</span>&nbsp;<span class="string" id="2702247">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2702257">+</span>&nbsp;<span class="op" id="2702259">*</span><span class="ident" id="2702260">typ</span><span class="op" id="2702263">.</span><span class="builtintype" id="2702264">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702272">case</span>&nbsp;<span class="ident" id="2702277">RecvDir</span><span class="op" id="2702284">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702288">s</span>&nbsp;<span class="op" id="2702290">=</span>&nbsp;<span class="string" id="2702292">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2702302">+</span>&nbsp;<span class="op" id="2702304">*</span><span class="ident" id="2702305">typ</span><span class="op" id="2702308">.</span><span class="builtintype" id="2702309">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702317">case</span>&nbsp;<span class="ident" id="2702322">BothDir</span><span class="op" id="2702329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702333">s</span>&nbsp;<span class="op" id="2702335">=</span>&nbsp;<span class="string" id="2702337">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2702345">+</span>&nbsp;<span class="op" id="2702347">*</span><span class="ident" id="2702348">typ</span><span class="op" id="2702351">.</span><span class="builtintype" id="2702352">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702363">for</span>&nbsp;<span class="ident" id="2702367">_</span><span class="op" id="2702368">,</span>&nbsp;<span class="ident" id="2702370">tt</span>&nbsp;<span class="op" id="2702373">:=</span>&nbsp;<span class="keyword" id="2702376">range</span>&nbsp;<span class="ident" id="2702382">typesByString</span><span class="op" id="2702395">(</span><span class="ident" id="2702396">s</span><span class="op" id="2702397">)</span>&nbsp;<span class="op" id="2702399">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702403">ch</span>&nbsp;<span class="op" id="2702406">:=</span>&nbsp;<span class="op" id="2702409">(</span><span class="op" id="2702410">*</span><span class="ident" id="2702411">chanType</span><span class="op" id="2702419">)</span><span class="op" id="2702420">(</span><span class="ident" id="2702421">unsafe</span><span class="op" id="2702427">.</span><span class="ident" id="2702428">Pointer</span><span class="op" id="2702435">(</span><span class="ident" id="2702436">tt</span><span class="op" id="2702438">)</span><span class="op" id="2702439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702443">if</span>&nbsp;<span class="ident" id="2702446">ch</span><span class="op" id="2702448">.</span><span class="ident" id="2702449">elem</span>&nbsp;<span class="op" id="2702454">==</span>&nbsp;<span class="ident" id="2702457">typ</span>&nbsp;<span class="op" id="2702461">&amp;&amp;</span>&nbsp;<span class="ident" id="2702464">ch</span><span class="op" id="2702466">.</span><span class="ident" id="2702467">dir</span>&nbsp;<span class="op" id="2702471">==</span>&nbsp;<span class="builtintype" id="2702474">uintptr</span><span class="op" id="2702481">(</span><span class="ident" id="2702482">dir</span><span class="op" id="2702485">)</span>&nbsp;<span class="op" id="2702487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702492">return</span>&nbsp;<span class="ident" id="2702499">cachePut</span><span class="op" id="2702507">(</span><span class="ident" id="2702508">ckey</span><span class="op" id="2702512">,</span>&nbsp;<span class="ident" id="2702514">tt</span><span class="op" id="2702516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702523">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2702527">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702552">var</span>&nbsp;<span class="ident" id="2702556">ichan</span>&nbsp;<span class="keyword" id="2702562">interface</span><span class="op" id="2702571">{</span><span class="op" id="2702572">}</span>&nbsp;<span class="op" id="2702574">=</span>&nbsp;<span class="op" id="2702576">(</span><span class="keyword" id="2702577">chan</span>&nbsp;<span class="ident" id="2702582">unsafe</span><span class="op" id="2702588">.</span><span class="ident" id="2702589">Pointer</span><span class="op" id="2702596">)</span><span class="op" id="2702597">(</span><span class="ident" id="2702598">nil</span><span class="op" id="2702601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702604">prototype</span>&nbsp;<span class="op" id="2702614">:=</span>&nbsp;<span class="op" id="2702617">*</span><span class="op" id="2702618">(</span><span class="op" id="2702619">*</span><span class="op" id="2702620">*</span><span class="ident" id="2702621">chanType</span><span class="op" id="2702629">)</span><span class="op" id="2702630">(</span><span class="ident" id="2702631">unsafe</span><span class="op" id="2702637">.</span><span class="ident" id="2702638">Pointer</span><span class="op" id="2702645">(</span><span class="op" id="2702646">&amp;</span><span class="ident" id="2702647">ichan</span><span class="op" id="2702652">)</span><span class="op" id="2702653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702656">ch</span>&nbsp;<span class="op" id="2702659">:=</span>&nbsp;<span class="builtinfunc" id="2702662">new</span><span class="op" id="2702665">(</span><span class="ident" id="2702666">chanType</span><span class="op" id="2702674">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702677">*</span><span class="ident" id="2702678">ch</span>&nbsp;<span class="op" id="2702681">=</span>&nbsp;<span class="op" id="2702683">*</span><span class="ident" id="2702684">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702695">ch</span><span class="op" id="2702697">.</span><span class="builtintype" id="2702698">string</span>&nbsp;<span class="op" id="2702705">=</span>&nbsp;<span class="op" id="2702707">&amp;</span><span class="ident" id="2702708">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702711">ch</span><span class="op" id="2702713">.</span><span class="ident" id="2702714">hash</span>&nbsp;<span class="op" id="2702719">=</span>&nbsp;<span class="ident" id="2702721">fnv1</span><span class="op" id="2702725">(</span><span class="ident" id="2702726">typ</span><span class="op" id="2702729">.</span><span class="ident" id="2702730">hash</span><span class="op" id="2702734">,</span>&nbsp;<span class="string" id="2702736">&#39;c&#39;</span><span class="op" id="2702739">,</span>&nbsp;<span class="builtintype" id="2702741">byte</span><span class="op" id="2702745">(</span><span class="ident" id="2702746">dir</span><span class="op" id="2702749">)</span><span class="op" id="2702750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702753">ch</span><span class="op" id="2702755">.</span><span class="ident" id="2702756">elem</span>&nbsp;<span class="op" id="2702761">=</span>&nbsp;<span class="ident" id="2702763">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702768">ch</span><span class="op" id="2702770">.</span><span class="ident" id="2702771">uncommonType</span>&nbsp;<span class="op" id="2702784">=</span>&nbsp;<span class="ident" id="2702786">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702791">ch</span><span class="op" id="2702793">.</span><span class="ident" id="2702794">ptrToThis</span>&nbsp;<span class="op" id="2702804">=</span>&nbsp;<span class="ident" id="2702806">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702811">ch</span><span class="op" id="2702813">.</span><span class="ident" id="2702814">zero</span>&nbsp;<span class="op" id="2702819">=</span>&nbsp;<span class="ident" id="2702821">unsafe</span><span class="op" id="2702827">.</span><span class="ident" id="2702828">Pointer</span><span class="op" id="2702835">(</span><span class="op" id="2702836">&amp;</span><span class="builtinfunc" id="2702837">make</span><span class="op" id="2702841">(</span><span class="op" id="2702842">[</span><span class="op" id="2702843">]</span><span class="builtintype" id="2702844">byte</span><span class="op" id="2702848">,</span>&nbsp;<span class="ident" id="2702850">ch</span><span class="op" id="2702852">.</span><span class="ident" id="2702853">size</span><span class="op" id="2702857">)</span><span class="op" id="2702858">[</span><span class="num" id="2702859">0</span><span class="op" id="2702860">]</span><span class="op" id="2702861">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702865">return</span>&nbsp;<span class="ident" id="2702872">cachePut</span><span class="op" id="2702880">(</span><span class="ident" id="2702881">ckey</span><span class="op" id="2702885">,</span>&nbsp;<span class="op" id="2702887">&amp;</span><span class="ident" id="2702888">ch</span><span class="op" id="2702890">.</span><span class="ident" id="2702891">rtype</span><span class="op" id="2702896">)</span><br>
<span class="lineno"></span><span class="op" id="2702898">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2702901">func</span>&nbsp;<span class="ident" id="2702906">ismapkey</span><span class="op" id="2702914">(</span><span class="op" id="2702915">*</span><span class="ident" id="2702916">rtype</span><span class="op" id="2702921">)</span>&nbsp;<span class="builtintype" id="2702923">bool</span>&nbsp;<span class="comment" id="2702928">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2702955">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2703023">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2703084">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2703126">//</span><br>
<span class="lineno"></span><span class="comment" id="2703129">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2703197">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2703247">func</span>&nbsp;<span class="ident" id="2703252">MapOf</span><span class="op" id="2703257">(</span><span class="ident" id="2703258">key</span><span class="op" id="2703261">,</span>&nbsp;<span class="ident" id="2703263">elem</span>&nbsp;<span class="ident" id="2703268">Type</span><span class="op" id="2703272">)</span>&nbsp;<span class="ident" id="2703274">Type</span>&nbsp;<span class="op" id="2703279">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703282">ktyp</span>&nbsp;<span class="op" id="2703287">:=</span>&nbsp;<span class="ident" id="2703290">key</span><span class="op" id="2703293">.</span><span class="op" id="2703294">(</span><span class="op" id="2703295">*</span><span class="ident" id="2703296">rtype</span><span class="op" id="2703301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703304">etyp</span>&nbsp;<span class="op" id="2703309">:=</span>&nbsp;<span class="ident" id="2703312">elem</span><span class="op" id="2703316">.</span><span class="op" id="2703317">(</span><span class="op" id="2703318">*</span><span class="ident" id="2703319">rtype</span><span class="op" id="2703324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703328">if</span>&nbsp;<span class="op" id="2703331">!</span><span class="ident" id="2703332">ismapkey</span><span class="op" id="2703340">(</span><span class="ident" id="2703341">ktyp</span><span class="op" id="2703345">)</span>&nbsp;<span class="op" id="2703347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2703351">panic</span><span class="op" id="2703356">(</span><span class="string" id="2703357">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2703392">+</span>&nbsp;<span class="ident" id="2703394">ktyp</span><span class="op" id="2703398">.</span><span class="ident" id="2703399">String</span><span class="op" id="2703405">(</span><span class="op" id="2703406">)</span><span class="op" id="2703407">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703414">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703433">ckey</span>&nbsp;<span class="op" id="2703438">:=</span>&nbsp;<span class="ident" id="2703441">cacheKey</span><span class="op" id="2703449">{</span><span class="ident" id="2703450">Map</span><span class="op" id="2703453">,</span>&nbsp;<span class="ident" id="2703455">ktyp</span><span class="op" id="2703459">,</span>&nbsp;<span class="ident" id="2703461">etyp</span><span class="op" id="2703465">,</span>&nbsp;<span class="num" id="2703467">0</span><span class="op" id="2703468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703471">if</span>&nbsp;<span class="ident" id="2703474">mt</span>&nbsp;<span class="op" id="2703477">:=</span>&nbsp;<span class="ident" id="2703480">cacheGet</span><span class="op" id="2703488">(</span><span class="ident" id="2703489">ckey</span><span class="op" id="2703493">)</span><span class="op" id="2703494">;</span>&nbsp;<span class="ident" id="2703496">mt</span>&nbsp;<span class="op" id="2703499">!=</span>&nbsp;<span class="ident" id="2703502">nil</span>&nbsp;<span class="op" id="2703506">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703510">return</span>&nbsp;<span class="ident" id="2703517">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703525">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703550">s</span>&nbsp;<span class="op" id="2703552">:=</span>&nbsp;<span class="string" id="2703555">&#34;map[&#34;</span>&nbsp;<span class="op" id="2703562">+</span>&nbsp;<span class="op" id="2703564">*</span><span class="ident" id="2703565">ktyp</span><span class="op" id="2703569">.</span><span class="builtintype" id="2703570">string</span>&nbsp;<span class="op" id="2703577">+</span>&nbsp;<span class="string" id="2703579">&#34;]&#34;</span>&nbsp;<span class="op" id="2703583">+</span>&nbsp;<span class="op" id="2703585">*</span><span class="ident" id="2703586">etyp</span><span class="op" id="2703590">.</span><span class="builtintype" id="2703591">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703599">for</span>&nbsp;<span class="ident" id="2703603">_</span><span class="op" id="2703604">,</span>&nbsp;<span class="ident" id="2703606">tt</span>&nbsp;<span class="op" id="2703609">:=</span>&nbsp;<span class="keyword" id="2703612">range</span>&nbsp;<span class="ident" id="2703618">typesByString</span><span class="op" id="2703631">(</span><span class="ident" id="2703632">s</span><span class="op" id="2703633">)</span>&nbsp;<span class="op" id="2703635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703639">mt</span>&nbsp;<span class="op" id="2703642">:=</span>&nbsp;<span class="op" id="2703645">(</span><span class="op" id="2703646">*</span><span class="ident" id="2703647">mapType</span><span class="op" id="2703654">)</span><span class="op" id="2703655">(</span><span class="ident" id="2703656">unsafe</span><span class="op" id="2703662">.</span><span class="ident" id="2703663">Pointer</span><span class="op" id="2703670">(</span><span class="ident" id="2703671">tt</span><span class="op" id="2703673">)</span><span class="op" id="2703674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703678">if</span>&nbsp;<span class="ident" id="2703681">mt</span><span class="op" id="2703683">.</span><span class="ident" id="2703684">key</span>&nbsp;<span class="op" id="2703688">==</span>&nbsp;<span class="ident" id="2703691">ktyp</span>&nbsp;<span class="op" id="2703696">&amp;&amp;</span>&nbsp;<span class="ident" id="2703699">mt</span><span class="op" id="2703701">.</span><span class="ident" id="2703702">elem</span>&nbsp;<span class="op" id="2703707">==</span>&nbsp;<span class="ident" id="2703710">etyp</span>&nbsp;<span class="op" id="2703715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703720">return</span>&nbsp;<span class="ident" id="2703727">cachePut</span><span class="op" id="2703735">(</span><span class="ident" id="2703736">ckey</span><span class="op" id="2703740">,</span>&nbsp;<span class="ident" id="2703742">tt</span><span class="op" id="2703744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703748">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703755">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703776">var</span>&nbsp;<span class="ident" id="2703780">imap</span>&nbsp;<span class="keyword" id="2703785">interface</span><span class="op" id="2703794">{</span><span class="op" id="2703795">}</span>&nbsp;<span class="op" id="2703797">=</span>&nbsp;<span class="op" id="2703799">(</span><span class="keyword" id="2703800">map</span><span class="op" id="2703803">[</span><span class="ident" id="2703804">unsafe</span><span class="op" id="2703810">.</span><span class="ident" id="2703811">Pointer</span><span class="op" id="2703818">]</span><span class="ident" id="2703819">unsafe</span><span class="op" id="2703825">.</span><span class="ident" id="2703826">Pointer</span><span class="op" id="2703833">)</span><span class="op" id="2703834">(</span><span class="ident" id="2703835">nil</span><span class="op" id="2703838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703841">prototype</span>&nbsp;<span class="op" id="2703851">:=</span>&nbsp;<span class="op" id="2703854">*</span><span class="op" id="2703855">(</span><span class="op" id="2703856">*</span><span class="op" id="2703857">*</span><span class="ident" id="2703858">mapType</span><span class="op" id="2703865">)</span><span class="op" id="2703866">(</span><span class="ident" id="2703867">unsafe</span><span class="op" id="2703873">.</span><span class="ident" id="2703874">Pointer</span><span class="op" id="2703881">(</span><span class="op" id="2703882">&amp;</span><span class="ident" id="2703883">imap</span><span class="op" id="2703887">)</span><span class="op" id="2703888">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703891">mt</span>&nbsp;<span class="op" id="2703894">:=</span>&nbsp;<span class="builtinfunc" id="2703897">new</span><span class="op" id="2703900">(</span><span class="ident" id="2703901">mapType</span><span class="op" id="2703908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703911">*</span><span class="ident" id="2703912">mt</span>&nbsp;<span class="op" id="2703915">=</span>&nbsp;<span class="op" id="2703917">*</span><span class="ident" id="2703918">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703929">mt</span><span class="op" id="2703931">.</span><span class="builtintype" id="2703932">string</span>&nbsp;<span class="op" id="2703939">=</span>&nbsp;<span class="op" id="2703941">&amp;</span><span class="ident" id="2703942">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703945">mt</span><span class="op" id="2703947">.</span><span class="ident" id="2703948">hash</span>&nbsp;<span class="op" id="2703953">=</span>&nbsp;<span class="ident" id="2703955">fnv1</span><span class="op" id="2703959">(</span><span class="ident" id="2703960">etyp</span><span class="op" id="2703964">.</span><span class="ident" id="2703965">hash</span><span class="op" id="2703969">,</span>&nbsp;<span class="string" id="2703971">&#39;m&#39;</span><span class="op" id="2703974">,</span>&nbsp;<span class="builtintype" id="2703976">byte</span><span class="op" id="2703980">(</span><span class="ident" id="2703981">ktyp</span><span class="op" id="2703985">.</span><span class="ident" id="2703986">hash</span><span class="op" id="2703990">&gt;&gt;</span><span class="num" id="2703992">24</span><span class="op" id="2703994">)</span><span class="op" id="2703995">,</span>&nbsp;<span class="builtintype" id="2703997">byte</span><span class="op" id="2704001">(</span><span class="ident" id="2704002">ktyp</span><span class="op" id="2704006">.</span><span class="ident" id="2704007">hash</span><span class="op" id="2704011">&gt;&gt;</span><span class="num" id="2704013">16</span><span class="op" id="2704015">)</span><span class="op" id="2704016">,</span>&nbsp;<span class="builtintype" id="2704018">byte</span><span class="op" id="2704022">(</span><span class="ident" id="2704023">ktyp</span><span class="op" id="2704027">.</span><span class="ident" id="2704028">hash</span><span class="op" id="2704032">&gt;&gt;</span><span class="num" id="2704034">8</span><span class="op" id="2704035">)</span><span class="op" id="2704036">,</span>&nbsp;<span class="builtintype" id="2704038">byte</span><span class="op" id="2704042">(</span><span class="ident" id="2704043">ktyp</span><span class="op" id="2704047">.</span><span class="ident" id="2704048">hash</span><span class="op" id="2704052">)</span><span class="op" id="2704053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704056">mt</span><span class="op" id="2704058">.</span><span class="ident" id="2704059">key</span>&nbsp;<span class="op" id="2704063">=</span>&nbsp;<span class="ident" id="2704065">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704071">mt</span><span class="op" id="2704073">.</span><span class="ident" id="2704074">elem</span>&nbsp;<span class="op" id="2704079">=</span>&nbsp;<span class="ident" id="2704081">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704087">mt</span><span class="op" id="2704089">.</span><span class="ident" id="2704090">bucket</span>&nbsp;<span class="op" id="2704097">=</span>&nbsp;<span class="ident" id="2704099">bucketOf</span><span class="op" id="2704107">(</span><span class="ident" id="2704108">ktyp</span><span class="op" id="2704112">,</span>&nbsp;<span class="ident" id="2704114">etyp</span><span class="op" id="2704118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704121">if</span>&nbsp;<span class="ident" id="2704124">ktyp</span><span class="op" id="2704128">.</span><span class="ident" id="2704129">size</span>&nbsp;<span class="op" id="2704134">&gt;</span>&nbsp;<span class="ident" id="2704136">maxKeySize</span>&nbsp;<span class="op" id="2704147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704151">mt</span><span class="op" id="2704153">.</span><span class="ident" id="2704154">keysize</span>&nbsp;<span class="op" id="2704162">=</span>&nbsp;<span class="builtintype" id="2704164">uint8</span><span class="op" id="2704169">(</span><span class="ident" id="2704170">ptrSize</span><span class="op" id="2704177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704181">mt</span><span class="op" id="2704183">.</span><span class="ident" id="2704184">indirectkey</span>&nbsp;<span class="op" id="2704196">=</span>&nbsp;<span class="num" id="2704198">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704201">}</span>&nbsp;<span class="keyword" id="2704203">else</span>&nbsp;<span class="op" id="2704208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704212">mt</span><span class="op" id="2704214">.</span><span class="ident" id="2704215">keysize</span>&nbsp;<span class="op" id="2704223">=</span>&nbsp;<span class="builtintype" id="2704225">uint8</span><span class="op" id="2704230">(</span><span class="ident" id="2704231">ktyp</span><span class="op" id="2704235">.</span><span class="ident" id="2704236">size</span><span class="op" id="2704240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704244">mt</span><span class="op" id="2704246">.</span><span class="ident" id="2704247">indirectkey</span>&nbsp;<span class="op" id="2704259">=</span>&nbsp;<span class="num" id="2704261">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704267">if</span>&nbsp;<span class="ident" id="2704270">etyp</span><span class="op" id="2704274">.</span><span class="ident" id="2704275">size</span>&nbsp;<span class="op" id="2704280">&gt;</span>&nbsp;<span class="ident" id="2704282">maxValSize</span>&nbsp;<span class="op" id="2704293">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704297">mt</span><span class="op" id="2704299">.</span><span class="ident" id="2704300">valuesize</span>&nbsp;<span class="op" id="2704310">=</span>&nbsp;<span class="builtintype" id="2704312">uint8</span><span class="op" id="2704317">(</span><span class="ident" id="2704318">ptrSize</span><span class="op" id="2704325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704329">mt</span><span class="op" id="2704331">.</span><span class="ident" id="2704332">indirectvalue</span>&nbsp;<span class="op" id="2704346">=</span>&nbsp;<span class="num" id="2704348">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704351">}</span>&nbsp;<span class="keyword" id="2704353">else</span>&nbsp;<span class="op" id="2704358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704362">mt</span><span class="op" id="2704364">.</span><span class="ident" id="2704365">valuesize</span>&nbsp;<span class="op" id="2704375">=</span>&nbsp;<span class="builtintype" id="2704377">uint8</span><span class="op" id="2704382">(</span><span class="ident" id="2704383">etyp</span><span class="op" id="2704387">.</span><span class="ident" id="2704388">size</span><span class="op" id="2704392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704396">mt</span><span class="op" id="2704398">.</span><span class="ident" id="2704399">indirectvalue</span>&nbsp;<span class="op" id="2704413">=</span>&nbsp;<span class="num" id="2704415">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704421">mt</span><span class="op" id="2704423">.</span><span class="ident" id="2704424">bucketsize</span>&nbsp;<span class="op" id="2704435">=</span>&nbsp;<span class="builtintype" id="2704437">uint16</span><span class="op" id="2704443">(</span><span class="ident" id="2704444">mt</span><span class="op" id="2704446">.</span><span class="ident" id="2704447">bucket</span><span class="op" id="2704453">.</span><span class="ident" id="2704454">size</span><span class="op" id="2704458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704461">mt</span><span class="op" id="2704463">.</span><span class="ident" id="2704464">uncommonType</span>&nbsp;<span class="op" id="2704477">=</span>&nbsp;<span class="ident" id="2704479">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704484">mt</span><span class="op" id="2704486">.</span><span class="ident" id="2704487">ptrToThis</span>&nbsp;<span class="op" id="2704497">=</span>&nbsp;<span class="ident" id="2704499">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704504">mt</span><span class="op" id="2704506">.</span><span class="ident" id="2704507">zero</span>&nbsp;<span class="op" id="2704512">=</span>&nbsp;<span class="ident" id="2704514">unsafe</span><span class="op" id="2704520">.</span><span class="ident" id="2704521">Pointer</span><span class="op" id="2704528">(</span><span class="op" id="2704529">&amp;</span><span class="builtinfunc" id="2704530">make</span><span class="op" id="2704534">(</span><span class="op" id="2704535">[</span><span class="op" id="2704536">]</span><span class="builtintype" id="2704537">byte</span><span class="op" id="2704541">,</span>&nbsp;<span class="ident" id="2704543">mt</span><span class="op" id="2704545">.</span><span class="ident" id="2704546">size</span><span class="op" id="2704550">)</span><span class="op" id="2704551">[</span><span class="num" id="2704552">0</span><span class="op" id="2704553">]</span><span class="op" id="2704554">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704558">return</span>&nbsp;<span class="ident" id="2704565">cachePut</span><span class="op" id="2704573">(</span><span class="ident" id="2704574">ckey</span><span class="op" id="2704578">,</span>&nbsp;<span class="op" id="2704580">&amp;</span><span class="ident" id="2704581">mt</span><span class="op" id="2704583">.</span><span class="ident" id="2704584">rtype</span><span class="op" id="2704589">)</span><br>
<span class="lineno"></span><span class="op" id="2704591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2704594">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2704658">type</span>&nbsp;<span class="ident" id="2704663">gcProg</span>&nbsp;<span class="keyword" id="2704670">struct</span>&nbsp;<span class="op" id="2704677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704680">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2704685">[</span><span class="op" id="2704686">]</span><span class="builtintype" id="2704687">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704693">size</span>&nbsp;<span class="builtintype" id="2704698">uintptr</span>&nbsp;<span class="comment" id="2704706">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2704731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2704734">func</span>&nbsp;<span class="op" id="2704739">(</span><span class="ident" id="2704740">gc</span>&nbsp;<span class="op" id="2704743">*</span><span class="ident" id="2704744">gcProg</span><span class="op" id="2704750">)</span>&nbsp;<span class="builtinfunc" id="2704752">append</span><span class="op" id="2704758">(</span><span class="ident" id="2704759">v</span>&nbsp;<span class="builtintype" id="2704761">byte</span><span class="op" id="2704765">)</span>&nbsp;<span class="op" id="2704767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704770">gc</span><span class="op" id="2704772">.</span><span class="ident" id="2704773">align</span><span class="op" id="2704778">(</span><span class="ident" id="2704779">unsafe</span><span class="op" id="2704785">.</span><span class="ident" id="2704786">Sizeof</span><span class="op" id="2704792">(</span><span class="builtintype" id="2704793">uintptr</span><span class="op" id="2704800">(</span><span class="num" id="2704801">0</span><span class="op" id="2704802">)</span><span class="op" id="2704803">)</span><span class="op" id="2704804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704807">gc</span><span class="op" id="2704809">.</span><span class="ident" id="2704810">appendWord</span><span class="op" id="2704820">(</span><span class="ident" id="2704821">v</span><span class="op" id="2704822">)</span><br>
<span class="lineno"></span><span class="op" id="2704824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2704827">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2704876">func</span>&nbsp;<span class="op" id="2704881">(</span><span class="ident" id="2704882">gc</span>&nbsp;<span class="op" id="2704885">*</span><span class="ident" id="2704886">gcProg</span><span class="op" id="2704892">)</span>&nbsp;<span class="ident" id="2704894">appendProg</span><span class="op" id="2704904">(</span><span class="ident" id="2704905">t</span>&nbsp;<span class="op" id="2704907">*</span><span class="ident" id="2704908">rtype</span><span class="op" id="2704913">)</span>&nbsp;<span class="op" id="2704915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704918">gc</span><span class="op" id="2704920">.</span><span class="ident" id="2704921">align</span><span class="op" id="2704926">(</span><span class="builtintype" id="2704927">uintptr</span><span class="op" id="2704934">(</span><span class="ident" id="2704935">t</span><span class="op" id="2704936">.</span><span class="ident" id="2704937">align</span><span class="op" id="2704942">)</span><span class="op" id="2704943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704946">if</span>&nbsp;<span class="op" id="2704949">!</span><span class="ident" id="2704950">t</span><span class="op" id="2704951">.</span><span class="ident" id="2704952">pointers</span><span class="op" id="2704960">(</span><span class="op" id="2704961">)</span>&nbsp;<span class="op" id="2704963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704967">gc</span><span class="op" id="2704969">.</span><span class="ident" id="2704970">size</span>&nbsp;<span class="op" id="2704975">+=</span>&nbsp;<span class="ident" id="2704978">t</span><span class="op" id="2704979">.</span><span class="ident" id="2704980">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704987">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704998">switch</span>&nbsp;<span class="ident" id="2705005">t</span><span class="op" id="2705006">.</span><span class="ident" id="2705007">Kind</span><span class="op" id="2705011">(</span><span class="op" id="2705012">)</span>&nbsp;<span class="op" id="2705014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705017">default</span><span class="op" id="2705024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2705028">panic</span><span class="op" id="2705033">(</span><span class="string" id="2705034">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2705087">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705090">case</span>&nbsp;<span class="ident" id="2705095">Ptr</span><span class="op" id="2705098">,</span>&nbsp;<span class="ident" id="2705100">UnsafePointer</span><span class="op" id="2705113">,</span>&nbsp;<span class="ident" id="2705115">Chan</span><span class="op" id="2705119">,</span>&nbsp;<span class="ident" id="2705121">Func</span><span class="op" id="2705125">,</span>&nbsp;<span class="ident" id="2705127">Map</span><span class="op" id="2705130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705134">gc</span><span class="op" id="2705136">.</span><span class="ident" id="2705137">appendWord</span><span class="op" id="2705147">(</span><span class="ident" id="2705148">bitsPointer</span><span class="op" id="2705159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705162">case</span>&nbsp;<span class="ident" id="2705167">Slice</span><span class="op" id="2705172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705176">gc</span><span class="op" id="2705178">.</span><span class="ident" id="2705179">appendWord</span><span class="op" id="2705189">(</span><span class="ident" id="2705190">bitsPointer</span><span class="op" id="2705201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705205">gc</span><span class="op" id="2705207">.</span><span class="ident" id="2705208">appendWord</span><span class="op" id="2705218">(</span><span class="ident" id="2705219">bitsScalar</span><span class="op" id="2705229">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705233">gc</span><span class="op" id="2705235">.</span><span class="ident" id="2705236">appendWord</span><span class="op" id="2705246">(</span><span class="ident" id="2705247">bitsScalar</span><span class="op" id="2705257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705260">case</span>&nbsp;<span class="ident" id="2705265">String</span><span class="op" id="2705271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705275">gc</span><span class="op" id="2705277">.</span><span class="ident" id="2705278">appendWord</span><span class="op" id="2705288">(</span><span class="ident" id="2705289">bitsPointer</span><span class="op" id="2705300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705304">gc</span><span class="op" id="2705306">.</span><span class="ident" id="2705307">appendWord</span><span class="op" id="2705317">(</span><span class="ident" id="2705318">bitsScalar</span><span class="op" id="2705328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705331">case</span>&nbsp;<span class="ident" id="2705336">Array</span><span class="op" id="2705341">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705345">c</span>&nbsp;<span class="op" id="2705347">:=</span>&nbsp;<span class="ident" id="2705350">t</span><span class="op" id="2705351">.</span><span class="ident" id="2705352">Len</span><span class="op" id="2705355">(</span><span class="op" id="2705356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705360">e</span>&nbsp;<span class="op" id="2705362">:=</span>&nbsp;<span class="ident" id="2705365">t</span><span class="op" id="2705366">.</span><span class="ident" id="2705367">Elem</span><span class="op" id="2705371">(</span><span class="op" id="2705372">)</span><span class="op" id="2705373">.</span><span class="ident" id="2705374">common</span><span class="op" id="2705380">(</span><span class="op" id="2705381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705385">for</span>&nbsp;<span class="ident" id="2705389">i</span>&nbsp;<span class="op" id="2705391">:=</span>&nbsp;<span class="num" id="2705394">0</span><span class="op" id="2705395">;</span>&nbsp;<span class="ident" id="2705397">i</span>&nbsp;<span class="op" id="2705399">&lt;</span>&nbsp;<span class="ident" id="2705401">c</span><span class="op" id="2705402">;</span>&nbsp;<span class="ident" id="2705404">i</span><span class="op" id="2705405">++</span>&nbsp;<span class="op" id="2705408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705413">gc</span><span class="op" id="2705415">.</span><span class="ident" id="2705416">appendProg</span><span class="op" id="2705426">(</span><span class="ident" id="2705427">e</span><span class="op" id="2705428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705432">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705435">case</span>&nbsp;<span class="ident" id="2705440">Interface</span><span class="op" id="2705449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705453">gc</span><span class="op" id="2705455">.</span><span class="ident" id="2705456">appendWord</span><span class="op" id="2705466">(</span><span class="ident" id="2705467">bitsMultiWord</span><span class="op" id="2705480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705484">if</span>&nbsp;<span class="ident" id="2705487">t</span><span class="op" id="2705488">.</span><span class="ident" id="2705489">NumMethod</span><span class="op" id="2705498">(</span><span class="op" id="2705499">)</span>&nbsp;<span class="op" id="2705501">==</span>&nbsp;<span class="num" id="2705504">0</span>&nbsp;<span class="op" id="2705506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705511">gc</span><span class="op" id="2705513">.</span><span class="ident" id="2705514">appendWord</span><span class="op" id="2705524">(</span><span class="ident" id="2705525">bitsEface</span><span class="op" id="2705534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705538">}</span>&nbsp;<span class="keyword" id="2705540">else</span>&nbsp;<span class="op" id="2705545">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705550">gc</span><span class="op" id="2705552">.</span><span class="ident" id="2705553">appendWord</span><span class="op" id="2705563">(</span><span class="ident" id="2705564">bitsIface</span><span class="op" id="2705573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705580">case</span>&nbsp;<span class="ident" id="2705585">Struct</span><span class="op" id="2705591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705595">c</span>&nbsp;<span class="op" id="2705597">:=</span>&nbsp;<span class="ident" id="2705600">t</span><span class="op" id="2705601">.</span><span class="ident" id="2705602">NumField</span><span class="op" id="2705610">(</span><span class="op" id="2705611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705615">for</span>&nbsp;<span class="ident" id="2705619">i</span>&nbsp;<span class="op" id="2705621">:=</span>&nbsp;<span class="num" id="2705624">0</span><span class="op" id="2705625">;</span>&nbsp;<span class="ident" id="2705627">i</span>&nbsp;<span class="op" id="2705629">&lt;</span>&nbsp;<span class="ident" id="2705631">c</span><span class="op" id="2705632">;</span>&nbsp;<span class="ident" id="2705634">i</span><span class="op" id="2705635">++</span>&nbsp;<span class="op" id="2705638">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705643">gc</span><span class="op" id="2705645">.</span><span class="ident" id="2705646">appendProg</span><span class="op" id="2705656">(</span><span class="ident" id="2705657">t</span><span class="op" id="2705658">.</span><span class="ident" id="2705659">Field</span><span class="op" id="2705664">(</span><span class="ident" id="2705665">i</span><span class="op" id="2705666">)</span><span class="op" id="2705667">.</span><span class="ident" id="2705668">Type</span><span class="op" id="2705672">.</span><span class="ident" id="2705673">common</span><span class="op" id="2705679">(</span><span class="op" id="2705680">)</span><span class="op" id="2705681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705689">gc</span><span class="op" id="2705691">.</span><span class="ident" id="2705692">align</span><span class="op" id="2705697">(</span><span class="builtintype" id="2705698">uintptr</span><span class="op" id="2705705">(</span><span class="ident" id="2705706">t</span><span class="op" id="2705707">.</span><span class="ident" id="2705708">align</span><span class="op" id="2705713">)</span><span class="op" id="2705714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705717">}</span><br>
<span class="lineno"></span><span class="op" id="2705719">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2705722">func</span>&nbsp;<span class="op" id="2705727">(</span><span class="ident" id="2705728">gc</span>&nbsp;<span class="op" id="2705731">*</span><span class="ident" id="2705732">gcProg</span><span class="op" id="2705738">)</span>&nbsp;<span class="ident" id="2705740">appendWord</span><span class="op" id="2705750">(</span><span class="ident" id="2705751">v</span>&nbsp;<span class="builtintype" id="2705753">byte</span><span class="op" id="2705757">)</span>&nbsp;<span class="op" id="2705759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705762">ptrsize</span>&nbsp;<span class="op" id="2705770">:=</span>&nbsp;<span class="ident" id="2705773">unsafe</span><span class="op" id="2705779">.</span><span class="ident" id="2705780">Sizeof</span><span class="op" id="2705786">(</span><span class="builtintype" id="2705787">uintptr</span><span class="op" id="2705794">(</span><span class="num" id="2705795">0</span><span class="op" id="2705796">)</span><span class="op" id="2705797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705800">if</span>&nbsp;<span class="ident" id="2705803">gc</span><span class="op" id="2705805">.</span><span class="ident" id="2705806">size</span><span class="op" id="2705810">%</span><span class="ident" id="2705811">ptrsize</span>&nbsp;<span class="op" id="2705819">!=</span>&nbsp;<span class="num" id="2705822">0</span>&nbsp;<span class="op" id="2705824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2705828">panic</span><span class="op" id="2705833">(</span><span class="string" id="2705834">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2705865">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705871">nptr</span>&nbsp;<span class="op" id="2705876">:=</span>&nbsp;<span class="ident" id="2705879">gc</span><span class="op" id="2705881">.</span><span class="ident" id="2705882">size</span>&nbsp;<span class="op" id="2705887">/</span>&nbsp;<span class="ident" id="2705889">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705898">for</span>&nbsp;<span class="builtintype" id="2705902">uintptr</span><span class="op" id="2705909">(</span><span class="builtinfunc" id="2705910">len</span><span class="op" id="2705913">(</span><span class="ident" id="2705914">gc</span><span class="op" id="2705916">.</span><span class="ident" id="2705917">gc</span><span class="op" id="2705919">)</span><span class="op" id="2705920">)</span>&nbsp;<span class="op" id="2705922">&lt;</span>&nbsp;<span class="ident" id="2705924">nptr</span><span class="op" id="2705928">/</span><span class="num" id="2705929">2</span><span class="op" id="2705930">+</span><span class="num" id="2705931">1</span>&nbsp;<span class="op" id="2705933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705937">gc</span><span class="op" id="2705939">.</span><span class="ident" id="2705940">gc</span>&nbsp;<span class="op" id="2705943">=</span>&nbsp;<span class="builtinfunc" id="2705945">append</span><span class="op" id="2705951">(</span><span class="ident" id="2705952">gc</span><span class="op" id="2705954">.</span><span class="ident" id="2705955">gc</span><span class="op" id="2705957">,</span>&nbsp;<span class="num" id="2705959">0x44</span><span class="op" id="2705963">)</span>&nbsp;<span class="comment" id="2705965">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705980">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705983">gc</span><span class="op" id="2705985">.</span><span class="ident" id="2705986">gc</span><span class="op" id="2705988">[</span><span class="ident" id="2705989">nptr</span><span class="op" id="2705993">/</span><span class="num" id="2705994">2</span><span class="op" id="2705995">]</span>&nbsp;<span class="op" id="2705997">&amp;=</span>&nbsp;<span class="op" id="2706000">^</span><span class="op" id="2706001">(</span><span class="num" id="2706002">3</span>&nbsp;<span class="op" id="2706004">&lt;&lt;</span>&nbsp;<span class="op" id="2706007">(</span><span class="op" id="2706008">(</span><span class="ident" id="2706009">nptr</span><span class="op" id="2706013">%</span><span class="num" id="2706014">2</span><span class="op" id="2706015">)</span><span class="op" id="2706016">*</span><span class="num" id="2706017">4</span>&nbsp;<span class="op" id="2706019">+</span>&nbsp;<span class="num" id="2706021">2</span><span class="op" id="2706022">)</span><span class="op" id="2706023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706026">gc</span><span class="op" id="2706028">.</span><span class="ident" id="2706029">gc</span><span class="op" id="2706031">[</span><span class="ident" id="2706032">nptr</span><span class="op" id="2706036">/</span><span class="num" id="2706037">2</span><span class="op" id="2706038">]</span>&nbsp;<span class="op" id="2706040">|=</span>&nbsp;<span class="ident" id="2706043">v</span>&nbsp;<span class="op" id="2706045">&lt;&lt;</span>&nbsp;<span class="op" id="2706048">(</span><span class="op" id="2706049">(</span><span class="ident" id="2706050">nptr</span><span class="op" id="2706054">%</span><span class="num" id="2706055">2</span><span class="op" id="2706056">)</span><span class="op" id="2706057">*</span><span class="num" id="2706058">4</span>&nbsp;<span class="op" id="2706060">+</span>&nbsp;<span class="num" id="2706062">2</span><span class="op" id="2706063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706066">gc</span><span class="op" id="2706068">.</span><span class="ident" id="2706069">size</span>&nbsp;<span class="op" id="2706074">+=</span>&nbsp;<span class="ident" id="2706077">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2706085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2706088">func</span>&nbsp;<span class="op" id="2706093">(</span><span class="ident" id="2706094">gc</span>&nbsp;<span class="op" id="2706097">*</span><span class="ident" id="2706098">gcProg</span><span class="op" id="2706104">)</span>&nbsp;<span class="ident" id="2706106">finalize</span><span class="op" id="2706114">(</span><span class="op" id="2706115">)</span>&nbsp;<span class="ident" id="2706117">unsafe</span><span class="op" id="2706123">.</span><span class="ident" id="2706124">Pointer</span>&nbsp;<span class="op" id="2706132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706135">if</span>&nbsp;<span class="ident" id="2706138">gc</span><span class="op" id="2706140">.</span><span class="ident" id="2706141">size</span>&nbsp;<span class="op" id="2706146">==</span>&nbsp;<span class="num" id="2706149">0</span>&nbsp;<span class="op" id="2706151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706155">return</span>&nbsp;<span class="ident" id="2706162">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706170">ptrsize</span>&nbsp;<span class="op" id="2706178">:=</span>&nbsp;<span class="ident" id="2706181">unsafe</span><span class="op" id="2706187">.</span><span class="ident" id="2706188">Sizeof</span><span class="op" id="2706194">(</span><span class="builtintype" id="2706195">uintptr</span><span class="op" id="2706202">(</span><span class="num" id="2706203">0</span><span class="op" id="2706204">)</span><span class="op" id="2706205">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706208">gc</span><span class="op" id="2706210">.</span><span class="ident" id="2706211">align</span><span class="op" id="2706216">(</span><span class="ident" id="2706217">ptrsize</span><span class="op" id="2706224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706227">nptr</span>&nbsp;<span class="op" id="2706232">:=</span>&nbsp;<span class="ident" id="2706235">gc</span><span class="op" id="2706237">.</span><span class="ident" id="2706238">size</span>&nbsp;<span class="op" id="2706243">/</span>&nbsp;<span class="ident" id="2706245">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706254">for</span>&nbsp;<span class="builtintype" id="2706258">uintptr</span><span class="op" id="2706265">(</span><span class="builtinfunc" id="2706266">len</span><span class="op" id="2706269">(</span><span class="ident" id="2706270">gc</span><span class="op" id="2706272">.</span><span class="ident" id="2706273">gc</span><span class="op" id="2706275">)</span><span class="op" id="2706276">)</span>&nbsp;<span class="op" id="2706278">&lt;</span>&nbsp;<span class="ident" id="2706280">nptr</span><span class="op" id="2706284">/</span><span class="num" id="2706285">2</span><span class="op" id="2706286">+</span><span class="num" id="2706287">1</span>&nbsp;<span class="op" id="2706289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706293">gc</span><span class="op" id="2706295">.</span><span class="ident" id="2706296">gc</span>&nbsp;<span class="op" id="2706299">=</span>&nbsp;<span class="builtinfunc" id="2706301">append</span><span class="op" id="2706307">(</span><span class="ident" id="2706308">gc</span><span class="op" id="2706310">.</span><span class="ident" id="2706311">gc</span><span class="op" id="2706313">,</span>&nbsp;<span class="num" id="2706315">0x44</span><span class="op" id="2706319">)</span>&nbsp;<span class="comment" id="2706321">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706336">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706339">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706393">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706421">if</span>&nbsp;<span class="ident" id="2706424">nptr</span><span class="op" id="2706428">%</span><span class="num" id="2706429">2</span>&nbsp;<span class="op" id="2706431">!=</span>&nbsp;<span class="num" id="2706434">0</span>&nbsp;<span class="op" id="2706436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706440">for</span>&nbsp;<span class="ident" id="2706444">i</span>&nbsp;<span class="op" id="2706446">:=</span>&nbsp;<span class="builtintype" id="2706449">uintptr</span><span class="op" id="2706456">(</span><span class="num" id="2706457">0</span><span class="op" id="2706458">)</span><span class="op" id="2706459">;</span>&nbsp;<span class="ident" id="2706461">i</span>&nbsp;<span class="op" id="2706463">&lt;</span>&nbsp;<span class="ident" id="2706465">nptr</span><span class="op" id="2706469">;</span>&nbsp;<span class="ident" id="2706471">i</span><span class="op" id="2706472">++</span>&nbsp;<span class="op" id="2706475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706480">gc</span><span class="op" id="2706482">.</span><span class="ident" id="2706483">appendWord</span><span class="op" id="2706493">(</span><span class="ident" id="2706494">extractGCWord</span><span class="op" id="2706507">(</span><span class="ident" id="2706508">gc</span><span class="op" id="2706510">.</span><span class="ident" id="2706511">gc</span><span class="op" id="2706513">,</span>&nbsp;<span class="ident" id="2706515">i</span><span class="op" id="2706516">)</span><span class="op" id="2706517">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706527">return</span>&nbsp;<span class="ident" id="2706534">unsafe</span><span class="op" id="2706540">.</span><span class="ident" id="2706541">Pointer</span><span class="op" id="2706548">(</span><span class="op" id="2706549">&amp;</span><span class="ident" id="2706550">gc</span><span class="op" id="2706552">.</span><span class="ident" id="2706553">gc</span><span class="op" id="2706555">[</span><span class="num" id="2706556">0</span><span class="op" id="2706557">]</span><span class="op" id="2706558">)</span><br>
<span class="lineno"></span><span class="op" id="2706560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2706563">func</span>&nbsp;<span class="ident" id="2706568">extractGCWord</span><span class="op" id="2706581">(</span><span class="ident" id="2706582">gc</span>&nbsp;<span class="op" id="2706585">[</span><span class="op" id="2706586">]</span><span class="builtintype" id="2706587">byte</span><span class="op" id="2706591">,</span>&nbsp;<span class="ident" id="2706593">i</span>&nbsp;<span class="builtintype" id="2706595">uintptr</span><span class="op" id="2706602">)</span>&nbsp;<span class="builtintype" id="2706604">byte</span>&nbsp;<span class="op" id="2706609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706612">return</span>&nbsp;<span class="op" id="2706619">(</span><span class="ident" id="2706620">gc</span><span class="op" id="2706622">[</span><span class="ident" id="2706623">i</span><span class="op" id="2706624">/</span><span class="num" id="2706625">2</span><span class="op" id="2706626">]</span>&nbsp;<span class="op" id="2706628">&gt;&gt;</span>&nbsp;<span class="op" id="2706631">(</span><span class="op" id="2706632">(</span><span class="ident" id="2706633">i</span><span class="op" id="2706634">%</span><span class="num" id="2706635">2</span><span class="op" id="2706636">)</span><span class="op" id="2706637">*</span><span class="num" id="2706638">4</span>&nbsp;<span class="op" id="2706640">+</span>&nbsp;<span class="num" id="2706642">2</span><span class="op" id="2706643">)</span><span class="op" id="2706644">)</span>&nbsp;<span class="op" id="2706646">&amp;</span>&nbsp;<span class="num" id="2706648">3</span><br>
<span class="lineno"></span><span class="op" id="2706650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2706653">func</span>&nbsp;<span class="op" id="2706658">(</span><span class="ident" id="2706659">gc</span>&nbsp;<span class="op" id="2706662">*</span><span class="ident" id="2706663">gcProg</span><span class="op" id="2706669">)</span>&nbsp;<span class="ident" id="2706671">align</span><span class="op" id="2706676">(</span><span class="ident" id="2706677">a</span>&nbsp;<span class="builtintype" id="2706679">uintptr</span><span class="op" id="2706686">)</span>&nbsp;<span class="op" id="2706688">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706691">gc</span><span class="op" id="2706693">.</span><span class="ident" id="2706694">size</span>&nbsp;<span class="op" id="2706699">=</span>&nbsp;<span class="ident" id="2706701">align</span><span class="op" id="2706706">(</span><span class="ident" id="2706707">gc</span><span class="op" id="2706709">.</span><span class="ident" id="2706710">size</span><span class="op" id="2706714">,</span>&nbsp;<span class="ident" id="2706716">a</span><span class="op" id="2706717">)</span><br>
<span class="lineno"></span><span class="op" id="2706719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2706722">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2706783">const</span>&nbsp;<span class="op" id="2706789">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706792">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706806">=</span>&nbsp;<span class="num" id="2706808">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706811">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2706825">=</span>&nbsp;<span class="num" id="2706827">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706830">bitsMultiWord</span>&nbsp;<span class="op" id="2706844">=</span>&nbsp;<span class="num" id="2706846">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706850">bitsIface</span>&nbsp;<span class="op" id="2706860">=</span>&nbsp;<span class="num" id="2706862">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706865">bitsEface</span>&nbsp;<span class="op" id="2706875">=</span>&nbsp;<span class="num" id="2706877">3</span><br>
<span class="lineno"></span><span class="op" id="2706879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2706882">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2706954">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2707026">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2707101">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2707132">const</span>&nbsp;<span class="op" id="2707138">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707141">bucketSize</span>&nbsp;<span class="op" id="2707152">=</span>&nbsp;<span class="num" id="2707154">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707157">maxKeySize</span>&nbsp;<span class="op" id="2707168">=</span>&nbsp;<span class="num" id="2707170">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707175">maxValSize</span>&nbsp;<span class="op" id="2707186">=</span>&nbsp;<span class="num" id="2707188">128</span><br>
<span class="lineno"></span><span class="op" id="2707192">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2707195">func</span>&nbsp;<span class="ident" id="2707200">bucketOf</span><span class="op" id="2707208">(</span><span class="ident" id="2707209">ktyp</span><span class="op" id="2707213">,</span>&nbsp;<span class="ident" id="2707215">etyp</span>&nbsp;<span class="op" id="2707220">*</span><span class="ident" id="2707221">rtype</span><span class="op" id="2707226">)</span>&nbsp;<span class="op" id="2707228">*</span><span class="ident" id="2707229">rtype</span>&nbsp;<span class="op" id="2707235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707238">if</span>&nbsp;<span class="ident" id="2707241">ktyp</span><span class="op" id="2707245">.</span><span class="ident" id="2707246">size</span>&nbsp;<span class="op" id="2707251">&gt;</span>&nbsp;<span class="ident" id="2707253">maxKeySize</span>&nbsp;<span class="op" id="2707264">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707268">ktyp</span>&nbsp;<span class="op" id="2707273">=</span>&nbsp;<span class="ident" id="2707275">PtrTo</span><span class="op" id="2707280">(</span><span class="ident" id="2707281">ktyp</span><span class="op" id="2707285">)</span><span class="op" id="2707286">.</span><span class="op" id="2707287">(</span><span class="op" id="2707288">*</span><span class="ident" id="2707289">rtype</span><span class="op" id="2707294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707300">if</span>&nbsp;<span class="ident" id="2707303">etyp</span><span class="op" id="2707307">.</span><span class="ident" id="2707308">size</span>&nbsp;<span class="op" id="2707313">&gt;</span>&nbsp;<span class="ident" id="2707315">maxValSize</span>&nbsp;<span class="op" id="2707326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707330">etyp</span>&nbsp;<span class="op" id="2707335">=</span>&nbsp;<span class="ident" id="2707337">PtrTo</span><span class="op" id="2707342">(</span><span class="ident" id="2707343">etyp</span><span class="op" id="2707347">)</span><span class="op" id="2707348">.</span><span class="op" id="2707349">(</span><span class="op" id="2707350">*</span><span class="ident" id="2707351">rtype</span><span class="op" id="2707356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707359">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707362">ptrsize</span>&nbsp;<span class="op" id="2707370">:=</span>&nbsp;<span class="ident" id="2707373">unsafe</span><span class="op" id="2707379">.</span><span class="ident" id="2707380">Sizeof</span><span class="op" id="2707386">(</span><span class="builtintype" id="2707387">uintptr</span><span class="op" id="2707394">(</span><span class="num" id="2707395">0</span><span class="op" id="2707396">)</span><span class="op" id="2707397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707401">var</span>&nbsp;<span class="ident" id="2707405">gc</span>&nbsp;<span class="ident" id="2707408">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2707416">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707428">for</span>&nbsp;<span class="ident" id="2707432">i</span>&nbsp;<span class="op" id="2707434">:=</span>&nbsp;<span class="num" id="2707437">0</span><span class="op" id="2707438">;</span>&nbsp;<span class="ident" id="2707440">i</span>&nbsp;<span class="op" id="2707442">&lt;</span>&nbsp;<span class="builtintype" id="2707444">int</span><span class="op" id="2707447">(</span><span class="ident" id="2707448">bucketSize</span><span class="op" id="2707458">*</span><span class="ident" id="2707459">unsafe</span><span class="op" id="2707465">.</span><span class="ident" id="2707466">Sizeof</span><span class="op" id="2707472">(</span><span class="builtintype" id="2707473">uint8</span><span class="op" id="2707478">(</span><span class="num" id="2707479">0</span><span class="op" id="2707480">)</span><span class="op" id="2707481">)</span><span class="op" id="2707482">/</span><span class="ident" id="2707483">ptrsize</span><span class="op" id="2707490">)</span><span class="op" id="2707491">;</span>&nbsp;<span class="ident" id="2707493">i</span><span class="op" id="2707494">++</span>&nbsp;<span class="op" id="2707497">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707501">gc</span><span class="op" id="2707503">.</span><span class="builtinfunc" id="2707504">append</span><span class="op" id="2707510">(</span><span class="ident" id="2707511">bitsScalar</span><span class="op" id="2707521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707527">gc</span><span class="op" id="2707529">.</span><span class="builtinfunc" id="2707530">append</span><span class="op" id="2707536">(</span><span class="ident" id="2707537">bitsPointer</span><span class="op" id="2707548">)</span>&nbsp;<span class="comment" id="2707550">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707563">if</span>&nbsp;<span class="ident" id="2707566">runtime</span><span class="op" id="2707573">.</span><span class="ident" id="2707574">GOARCH</span>&nbsp;<span class="op" id="2707581">==</span>&nbsp;<span class="string" id="2707584">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2707595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707599">gc</span><span class="op" id="2707601">.</span><span class="builtinfunc" id="2707602">append</span><span class="op" id="2707608">(</span><span class="ident" id="2707609">bitsScalar</span><span class="op" id="2707619">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2707625">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707634">for</span>&nbsp;<span class="ident" id="2707638">i</span>&nbsp;<span class="op" id="2707640">:=</span>&nbsp;<span class="num" id="2707643">0</span><span class="op" id="2707644">;</span>&nbsp;<span class="ident" id="2707646">i</span>&nbsp;<span class="op" id="2707648">&lt;</span>&nbsp;<span class="ident" id="2707650">bucketSize</span><span class="op" id="2707660">;</span>&nbsp;<span class="ident" id="2707662">i</span><span class="op" id="2707663">++</span>&nbsp;<span class="op" id="2707666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707670">gc</span><span class="op" id="2707672">.</span><span class="ident" id="2707673">appendProg</span><span class="op" id="2707683">(</span><span class="ident" id="2707684">ktyp</span><span class="op" id="2707688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707691">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2707694">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707705">for</span>&nbsp;<span class="ident" id="2707709">i</span>&nbsp;<span class="op" id="2707711">:=</span>&nbsp;<span class="num" id="2707714">0</span><span class="op" id="2707715">;</span>&nbsp;<span class="ident" id="2707717">i</span>&nbsp;<span class="op" id="2707719">&lt;</span>&nbsp;<span class="ident" id="2707721">bucketSize</span><span class="op" id="2707731">;</span>&nbsp;<span class="ident" id="2707733">i</span><span class="op" id="2707734">++</span>&nbsp;<span class="op" id="2707737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707741">gc</span><span class="op" id="2707743">.</span><span class="ident" id="2707744">appendProg</span><span class="op" id="2707754">(</span><span class="ident" id="2707755">etyp</span><span class="op" id="2707759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707766">b</span>&nbsp;<span class="op" id="2707768">:=</span>&nbsp;<span class="builtinfunc" id="2707771">new</span><span class="op" id="2707774">(</span><span class="ident" id="2707775">rtype</span><span class="op" id="2707780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707783">b</span><span class="op" id="2707784">.</span><span class="ident" id="2707785">size</span>&nbsp;<span class="op" id="2707790">=</span>&nbsp;<span class="ident" id="2707792">gc</span><span class="op" id="2707794">.</span><span class="ident" id="2707795">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707801">b</span><span class="op" id="2707802">.</span><span class="ident" id="2707803">gc</span><span class="op" id="2707805">[</span><span class="num" id="2707806">0</span><span class="op" id="2707807">]</span>&nbsp;<span class="op" id="2707809">=</span>&nbsp;<span class="ident" id="2707811">gc</span><span class="op" id="2707813">.</span><span class="ident" id="2707814">finalize</span><span class="op" id="2707822">(</span><span class="op" id="2707823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707826">s</span>&nbsp;<span class="op" id="2707828">:=</span>&nbsp;<span class="string" id="2707831">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2707841">+</span>&nbsp;<span class="op" id="2707843">*</span><span class="ident" id="2707844">ktyp</span><span class="op" id="2707848">.</span><span class="builtintype" id="2707849">string</span>&nbsp;<span class="op" id="2707856">+</span>&nbsp;<span class="string" id="2707858">&#34;,&#34;</span>&nbsp;<span class="op" id="2707862">+</span>&nbsp;<span class="op" id="2707864">*</span><span class="ident" id="2707865">etyp</span><span class="op" id="2707869">.</span><span class="builtintype" id="2707870">string</span>&nbsp;<span class="op" id="2707877">+</span>&nbsp;<span class="string" id="2707879">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707884">b</span><span class="op" id="2707885">.</span><span class="builtintype" id="2707886">string</span>&nbsp;<span class="op" id="2707893">=</span>&nbsp;<span class="op" id="2707895">&amp;</span><span class="ident" id="2707896">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707899">return</span>&nbsp;<span class="ident" id="2707906">b</span><br>
<span class="lineno"></span><span class="op" id="2707908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2707911">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2707966">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2708032">func</span>&nbsp;<span class="ident" id="2708037">SliceOf</span><span class="op" id="2708044">(</span><span class="ident" id="2708045">t</span>&nbsp;<span class="ident" id="2708047">Type</span><span class="op" id="2708051">)</span>&nbsp;<span class="ident" id="2708053">Type</span>&nbsp;<span class="op" id="2708058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708061">typ</span>&nbsp;<span class="op" id="2708065">:=</span>&nbsp;<span class="ident" id="2708068">t</span><span class="op" id="2708069">.</span><span class="op" id="2708070">(</span><span class="op" id="2708071">*</span><span class="ident" id="2708072">rtype</span><span class="op" id="2708077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708081">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708100">ckey</span>&nbsp;<span class="op" id="2708105">:=</span>&nbsp;<span class="ident" id="2708108">cacheKey</span><span class="op" id="2708116">{</span><span class="ident" id="2708117">Slice</span><span class="op" id="2708122">,</span>&nbsp;<span class="ident" id="2708124">typ</span><span class="op" id="2708127">,</span>&nbsp;<span class="ident" id="2708129">nil</span><span class="op" id="2708132">,</span>&nbsp;<span class="num" id="2708134">0</span><span class="op" id="2708135">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708138">if</span>&nbsp;<span class="ident" id="2708141">slice</span>&nbsp;<span class="op" id="2708147">:=</span>&nbsp;<span class="ident" id="2708150">cacheGet</span><span class="op" id="2708158">(</span><span class="ident" id="2708159">ckey</span><span class="op" id="2708163">)</span><span class="op" id="2708164">;</span>&nbsp;<span class="ident" id="2708166">slice</span>&nbsp;<span class="op" id="2708172">!=</span>&nbsp;<span class="ident" id="2708175">nil</span>&nbsp;<span class="op" id="2708179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708183">return</span>&nbsp;<span class="ident" id="2708190">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708201">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708226">s</span>&nbsp;<span class="op" id="2708228">:=</span>&nbsp;<span class="string" id="2708231">&#34;[]&#34;</span>&nbsp;<span class="op" id="2708236">+</span>&nbsp;<span class="op" id="2708238">*</span><span class="ident" id="2708239">typ</span><span class="op" id="2708242">.</span><span class="builtintype" id="2708243">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708251">for</span>&nbsp;<span class="ident" id="2708255">_</span><span class="op" id="2708256">,</span>&nbsp;<span class="ident" id="2708258">tt</span>&nbsp;<span class="op" id="2708261">:=</span>&nbsp;<span class="keyword" id="2708264">range</span>&nbsp;<span class="ident" id="2708270">typesByString</span><span class="op" id="2708283">(</span><span class="ident" id="2708284">s</span><span class="op" id="2708285">)</span>&nbsp;<span class="op" id="2708287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708291">slice</span>&nbsp;<span class="op" id="2708297">:=</span>&nbsp;<span class="op" id="2708300">(</span><span class="op" id="2708301">*</span><span class="ident" id="2708302">sliceType</span><span class="op" id="2708311">)</span><span class="op" id="2708312">(</span><span class="ident" id="2708313">unsafe</span><span class="op" id="2708319">.</span><span class="ident" id="2708320">Pointer</span><span class="op" id="2708327">(</span><span class="ident" id="2708328">tt</span><span class="op" id="2708330">)</span><span class="op" id="2708331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708335">if</span>&nbsp;<span class="ident" id="2708338">slice</span><span class="op" id="2708343">.</span><span class="ident" id="2708344">elem</span>&nbsp;<span class="op" id="2708349">==</span>&nbsp;<span class="ident" id="2708352">typ</span>&nbsp;<span class="op" id="2708356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708361">return</span>&nbsp;<span class="ident" id="2708368">cachePut</span><span class="op" id="2708376">(</span><span class="ident" id="2708377">ckey</span><span class="op" id="2708381">,</span>&nbsp;<span class="ident" id="2708383">tt</span><span class="op" id="2708385">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708396">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708419">var</span>&nbsp;<span class="ident" id="2708423">islice</span>&nbsp;<span class="keyword" id="2708430">interface</span><span class="op" id="2708439">{</span><span class="op" id="2708440">}</span>&nbsp;<span class="op" id="2708442">=</span>&nbsp;<span class="op" id="2708444">(</span><span class="op" id="2708445">[</span><span class="op" id="2708446">]</span><span class="ident" id="2708447">unsafe</span><span class="op" id="2708453">.</span><span class="ident" id="2708454">Pointer</span><span class="op" id="2708461">)</span><span class="op" id="2708462">(</span><span class="ident" id="2708463">nil</span><span class="op" id="2708466">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708469">prototype</span>&nbsp;<span class="op" id="2708479">:=</span>&nbsp;<span class="op" id="2708482">*</span><span class="op" id="2708483">(</span><span class="op" id="2708484">*</span><span class="op" id="2708485">*</span><span class="ident" id="2708486">sliceType</span><span class="op" id="2708495">)</span><span class="op" id="2708496">(</span><span class="ident" id="2708497">unsafe</span><span class="op" id="2708503">.</span><span class="ident" id="2708504">Pointer</span><span class="op" id="2708511">(</span><span class="op" id="2708512">&amp;</span><span class="ident" id="2708513">islice</span><span class="op" id="2708519">)</span><span class="op" id="2708520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708523">slice</span>&nbsp;<span class="op" id="2708529">:=</span>&nbsp;<span class="builtinfunc" id="2708532">new</span><span class="op" id="2708535">(</span><span class="ident" id="2708536">sliceType</span><span class="op" id="2708545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708548">*</span><span class="ident" id="2708549">slice</span>&nbsp;<span class="op" id="2708555">=</span>&nbsp;<span class="op" id="2708557">*</span><span class="ident" id="2708558">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708569">slice</span><span class="op" id="2708574">.</span><span class="builtintype" id="2708575">string</span>&nbsp;<span class="op" id="2708582">=</span>&nbsp;<span class="op" id="2708584">&amp;</span><span class="ident" id="2708585">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708588">slice</span><span class="op" id="2708593">.</span><span class="ident" id="2708594">hash</span>&nbsp;<span class="op" id="2708599">=</span>&nbsp;<span class="ident" id="2708601">fnv1</span><span class="op" id="2708605">(</span><span class="ident" id="2708606">typ</span><span class="op" id="2708609">.</span><span class="ident" id="2708610">hash</span><span class="op" id="2708614">,</span>&nbsp;<span class="string" id="2708616">&#39;[&#39;</span><span class="op" id="2708619">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708622">slice</span><span class="op" id="2708627">.</span><span class="ident" id="2708628">elem</span>&nbsp;<span class="op" id="2708633">=</span>&nbsp;<span class="ident" id="2708635">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708640">slice</span><span class="op" id="2708645">.</span><span class="ident" id="2708646">uncommonType</span>&nbsp;<span class="op" id="2708659">=</span>&nbsp;<span class="ident" id="2708661">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708666">slice</span><span class="op" id="2708671">.</span><span class="ident" id="2708672">ptrToThis</span>&nbsp;<span class="op" id="2708682">=</span>&nbsp;<span class="ident" id="2708684">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708689">slice</span><span class="op" id="2708694">.</span><span class="ident" id="2708695">zero</span>&nbsp;<span class="op" id="2708700">=</span>&nbsp;<span class="ident" id="2708702">unsafe</span><span class="op" id="2708708">.</span><span class="ident" id="2708709">Pointer</span><span class="op" id="2708716">(</span><span class="op" id="2708717">&amp;</span><span class="builtinfunc" id="2708718">make</span><span class="op" id="2708722">(</span><span class="op" id="2708723">[</span><span class="op" id="2708724">]</span><span class="builtintype" id="2708725">byte</span><span class="op" id="2708729">,</span>&nbsp;<span class="ident" id="2708731">slice</span><span class="op" id="2708736">.</span><span class="ident" id="2708737">size</span><span class="op" id="2708741">)</span><span class="op" id="2708742">[</span><span class="num" id="2708743">0</span><span class="op" id="2708744">]</span><span class="op" id="2708745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708749">return</span>&nbsp;<span class="ident" id="2708756">cachePut</span><span class="op" id="2708764">(</span><span class="ident" id="2708765">ckey</span><span class="op" id="2708769">,</span>&nbsp;<span class="op" id="2708771">&amp;</span><span class="ident" id="2708772">slice</span><span class="op" id="2708777">.</span><span class="ident" id="2708778">rtype</span><span class="op" id="2708783">)</span><br>
<span class="lineno"></span><span class="op" id="2708785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2708788">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2708861">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2708931">//</span><br>
<span class="lineno"></span><span class="comment" id="2708934">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2709009">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2709028">//</span><br>
<span class="lineno"></span><span class="comment" id="2709031">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2709108">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2709160">//</span><br>
<span class="lineno"></span><span class="comment" id="2709163">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2709218">func</span>&nbsp;<span class="ident" id="2709223">arrayOf</span><span class="op" id="2709230">(</span><span class="ident" id="2709231">count</span>&nbsp;<span class="builtintype" id="2709237">int</span><span class="op" id="2709240">,</span>&nbsp;<span class="ident" id="2709242">elem</span>&nbsp;<span class="ident" id="2709247">Type</span><span class="op" id="2709251">)</span>&nbsp;<span class="ident" id="2709253">Type</span>&nbsp;<span class="op" id="2709258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709261">typ</span>&nbsp;<span class="op" id="2709265">:=</span>&nbsp;<span class="ident" id="2709268">elem</span><span class="op" id="2709272">.</span><span class="op" id="2709273">(</span><span class="op" id="2709274">*</span><span class="ident" id="2709275">rtype</span><span class="op" id="2709280">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709283">slice</span>&nbsp;<span class="op" id="2709289">:=</span>&nbsp;<span class="ident" id="2709292">SliceOf</span><span class="op" id="2709299">(</span><span class="ident" id="2709300">elem</span><span class="op" id="2709304">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709308">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709327">ckey</span>&nbsp;<span class="op" id="2709332">:=</span>&nbsp;<span class="ident" id="2709335">cacheKey</span><span class="op" id="2709343">{</span><span class="ident" id="2709344">Array</span><span class="op" id="2709349">,</span>&nbsp;<span class="ident" id="2709351">typ</span><span class="op" id="2709354">,</span>&nbsp;<span class="ident" id="2709356">nil</span><span class="op" id="2709359">,</span>&nbsp;<span class="builtintype" id="2709361">uintptr</span><span class="op" id="2709368">(</span><span class="ident" id="2709369">count</span><span class="op" id="2709374">)</span><span class="op" id="2709375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709378">if</span>&nbsp;<span class="ident" id="2709381">slice</span>&nbsp;<span class="op" id="2709387">:=</span>&nbsp;<span class="ident" id="2709390">cacheGet</span><span class="op" id="2709398">(</span><span class="ident" id="2709399">ckey</span><span class="op" id="2709403">)</span><span class="op" id="2709404">;</span>&nbsp;<span class="ident" id="2709406">slice</span>&nbsp;<span class="op" id="2709412">!=</span>&nbsp;<span class="ident" id="2709415">nil</span>&nbsp;<span class="op" id="2709419">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709423">return</span>&nbsp;<span class="ident" id="2709430">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709441">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709466">s</span>&nbsp;<span class="op" id="2709468">:=</span>&nbsp;<span class="string" id="2709471">&#34;[&#34;</span>&nbsp;<span class="op" id="2709475">+</span>&nbsp;<span class="ident" id="2709477">strconv</span><span class="op" id="2709484">.</span><span class="ident" id="2709485">Itoa</span><span class="op" id="2709489">(</span><span class="ident" id="2709490">count</span><span class="op" id="2709495">)</span>&nbsp;<span class="op" id="2709497">+</span>&nbsp;<span class="string" id="2709499">&#34;]&#34;</span>&nbsp;<span class="op" id="2709503">+</span>&nbsp;<span class="op" id="2709505">*</span><span class="ident" id="2709506">typ</span><span class="op" id="2709509">.</span><span class="builtintype" id="2709510">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709518">for</span>&nbsp;<span class="ident" id="2709522">_</span><span class="op" id="2709523">,</span>&nbsp;<span class="ident" id="2709525">tt</span>&nbsp;<span class="op" id="2709528">:=</span>&nbsp;<span class="keyword" id="2709531">range</span>&nbsp;<span class="ident" id="2709537">typesByString</span><span class="op" id="2709550">(</span><span class="ident" id="2709551">s</span><span class="op" id="2709552">)</span>&nbsp;<span class="op" id="2709554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709558">slice</span>&nbsp;<span class="op" id="2709564">:=</span>&nbsp;<span class="op" id="2709567">(</span><span class="op" id="2709568">*</span><span class="ident" id="2709569">sliceType</span><span class="op" id="2709578">)</span><span class="op" id="2709579">(</span><span class="ident" id="2709580">unsafe</span><span class="op" id="2709586">.</span><span class="ident" id="2709587">Pointer</span><span class="op" id="2709594">(</span><span class="ident" id="2709595">tt</span><span class="op" id="2709597">)</span><span class="op" id="2709598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709602">if</span>&nbsp;<span class="ident" id="2709605">slice</span><span class="op" id="2709610">.</span><span class="ident" id="2709611">elem</span>&nbsp;<span class="op" id="2709616">==</span>&nbsp;<span class="ident" id="2709619">typ</span>&nbsp;<span class="op" id="2709623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709628">return</span>&nbsp;<span class="ident" id="2709635">cachePut</span><span class="op" id="2709643">(</span><span class="ident" id="2709644">ckey</span><span class="op" id="2709648">,</span>&nbsp;<span class="ident" id="2709650">tt</span><span class="op" id="2709652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709656">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709663">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709687">var</span>&nbsp;<span class="ident" id="2709691">iarray</span>&nbsp;<span class="keyword" id="2709698">interface</span><span class="op" id="2709707">{</span><span class="op" id="2709708">}</span>&nbsp;<span class="op" id="2709710">=</span>&nbsp;<span class="op" id="2709712">[</span><span class="num" id="2709713">1</span><span class="op" id="2709714">]</span><span class="ident" id="2709715">unsafe</span><span class="op" id="2709721">.</span><span class="ident" id="2709722">Pointer</span><span class="op" id="2709729">{</span><span class="op" id="2709730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709733">prototype</span>&nbsp;<span class="op" id="2709743">:=</span>&nbsp;<span class="op" id="2709746">*</span><span class="op" id="2709747">(</span><span class="op" id="2709748">*</span><span class="op" id="2709749">*</span><span class="ident" id="2709750">arrayType</span><span class="op" id="2709759">)</span><span class="op" id="2709760">(</span><span class="ident" id="2709761">unsafe</span><span class="op" id="2709767">.</span><span class="ident" id="2709768">Pointer</span><span class="op" id="2709775">(</span><span class="op" id="2709776">&amp;</span><span class="ident" id="2709777">iarray</span><span class="op" id="2709783">)</span><span class="op" id="2709784">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709787">array</span>&nbsp;<span class="op" id="2709793">:=</span>&nbsp;<span class="builtinfunc" id="2709796">new</span><span class="op" id="2709799">(</span><span class="ident" id="2709800">arrayType</span><span class="op" id="2709809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709812">*</span><span class="ident" id="2709813">array</span>&nbsp;<span class="op" id="2709819">=</span>&nbsp;<span class="op" id="2709821">*</span><span class="ident" id="2709822">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709833">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709874">array</span><span class="op" id="2709879">.</span><span class="builtintype" id="2709880">string</span>&nbsp;<span class="op" id="2709887">=</span>&nbsp;<span class="op" id="2709889">&amp;</span><span class="ident" id="2709890">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709893">array</span><span class="op" id="2709898">.</span><span class="ident" id="2709899">hash</span>&nbsp;<span class="op" id="2709904">=</span>&nbsp;<span class="ident" id="2709906">fnv1</span><span class="op" id="2709910">(</span><span class="ident" id="2709911">typ</span><span class="op" id="2709914">.</span><span class="ident" id="2709915">hash</span><span class="op" id="2709919">,</span>&nbsp;<span class="string" id="2709921">&#39;[&#39;</span><span class="op" id="2709924">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709927">for</span>&nbsp;<span class="ident" id="2709931">n</span>&nbsp;<span class="op" id="2709933">:=</span>&nbsp;<span class="builtintype" id="2709936">uint32</span><span class="op" id="2709942">(</span><span class="ident" id="2709943">count</span><span class="op" id="2709948">)</span><span class="op" id="2709949">;</span>&nbsp;<span class="ident" id="2709951">n</span>&nbsp;<span class="op" id="2709953">&gt;</span>&nbsp;<span class="num" id="2709955">0</span><span class="op" id="2709956">;</span>&nbsp;<span class="ident" id="2709958">n</span>&nbsp;<span class="op" id="2709960">&gt;&gt;=</span>&nbsp;<span class="num" id="2709964">8</span>&nbsp;<span class="op" id="2709966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709970">array</span><span class="op" id="2709975">.</span><span class="ident" id="2709976">hash</span>&nbsp;<span class="op" id="2709981">=</span>&nbsp;<span class="ident" id="2709983">fnv1</span><span class="op" id="2709987">(</span><span class="ident" id="2709988">array</span><span class="op" id="2709993">.</span><span class="ident" id="2709994">hash</span><span class="op" id="2709998">,</span>&nbsp;<span class="builtintype" id="2710000">byte</span><span class="op" id="2710004">(</span><span class="ident" id="2710005">n</span><span class="op" id="2710006">)</span><span class="op" id="2710007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710013">array</span><span class="op" id="2710018">.</span><span class="ident" id="2710019">hash</span>&nbsp;<span class="op" id="2710024">=</span>&nbsp;<span class="ident" id="2710026">fnv1</span><span class="op" id="2710030">(</span><span class="ident" id="2710031">array</span><span class="op" id="2710036">.</span><span class="ident" id="2710037">hash</span><span class="op" id="2710041">,</span>&nbsp;<span class="string" id="2710043">&#39;]&#39;</span><span class="op" id="2710046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710049">array</span><span class="op" id="2710054">.</span><span class="ident" id="2710055">elem</span>&nbsp;<span class="op" id="2710060">=</span>&nbsp;<span class="ident" id="2710062">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710067">max</span>&nbsp;<span class="op" id="2710071">:=</span>&nbsp;<span class="op" id="2710074">^</span><span class="builtintype" id="2710075">uintptr</span><span class="op" id="2710082">(</span><span class="num" id="2710083">0</span><span class="op" id="2710084">)</span>&nbsp;<span class="op" id="2710086">/</span>&nbsp;<span class="ident" id="2710088">typ</span><span class="op" id="2710091">.</span><span class="ident" id="2710092">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710098">if</span>&nbsp;<span class="builtintype" id="2710101">uintptr</span><span class="op" id="2710108">(</span><span class="ident" id="2710109">count</span><span class="op" id="2710114">)</span>&nbsp;<span class="op" id="2710116">&gt;</span>&nbsp;<span class="ident" id="2710118">max</span>&nbsp;<span class="op" id="2710122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2710126">panic</span><span class="op" id="2710131">(</span><span class="string" id="2710132">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2710196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710202">array</span><span class="op" id="2710207">.</span><span class="ident" id="2710208">size</span>&nbsp;<span class="op" id="2710213">=</span>&nbsp;<span class="ident" id="2710215">typ</span><span class="op" id="2710218">.</span><span class="ident" id="2710219">size</span>&nbsp;<span class="op" id="2710224">*</span>&nbsp;<span class="builtintype" id="2710226">uintptr</span><span class="op" id="2710233">(</span><span class="ident" id="2710234">count</span><span class="op" id="2710239">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710242">array</span><span class="op" id="2710247">.</span><span class="ident" id="2710248">align</span>&nbsp;<span class="op" id="2710254">=</span>&nbsp;<span class="ident" id="2710256">typ</span><span class="op" id="2710259">.</span><span class="ident" id="2710260">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710267">array</span><span class="op" id="2710272">.</span><span class="ident" id="2710273">fieldAlign</span>&nbsp;<span class="op" id="2710284">=</span>&nbsp;<span class="ident" id="2710286">typ</span><span class="op" id="2710289">.</span><span class="ident" id="2710290">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710302">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710322">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710341">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710351">array</span><span class="op" id="2710356">.</span><span class="ident" id="2710357">uncommonType</span>&nbsp;<span class="op" id="2710370">=</span>&nbsp;<span class="ident" id="2710372">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710377">array</span><span class="op" id="2710382">.</span><span class="ident" id="2710383">ptrToThis</span>&nbsp;<span class="op" id="2710393">=</span>&nbsp;<span class="ident" id="2710395">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710400">array</span><span class="op" id="2710405">.</span><span class="ident" id="2710406">zero</span>&nbsp;<span class="op" id="2710411">=</span>&nbsp;<span class="ident" id="2710413">unsafe</span><span class="op" id="2710419">.</span><span class="ident" id="2710420">Pointer</span><span class="op" id="2710427">(</span><span class="op" id="2710428">&amp;</span><span class="builtinfunc" id="2710429">make</span><span class="op" id="2710433">(</span><span class="op" id="2710434">[</span><span class="op" id="2710435">]</span><span class="builtintype" id="2710436">byte</span><span class="op" id="2710440">,</span>&nbsp;<span class="ident" id="2710442">array</span><span class="op" id="2710447">.</span><span class="ident" id="2710448">size</span><span class="op" id="2710452">)</span><span class="op" id="2710453">[</span><span class="num" id="2710454">0</span><span class="op" id="2710455">]</span><span class="op" id="2710456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710459">array</span><span class="op" id="2710464">.</span><span class="builtinfunc" id="2710465">len</span>&nbsp;<span class="op" id="2710469">=</span>&nbsp;<span class="builtintype" id="2710471">uintptr</span><span class="op" id="2710478">(</span><span class="ident" id="2710479">count</span><span class="op" id="2710484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710487">array</span><span class="op" id="2710492">.</span><span class="ident" id="2710493">slice</span>&nbsp;<span class="op" id="2710499">=</span>&nbsp;<span class="ident" id="2710501">slice</span><span class="op" id="2710506">.</span><span class="op" id="2710507">(</span><span class="op" id="2710508">*</span><span class="ident" id="2710509">rtype</span><span class="op" id="2710514">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710518">return</span>&nbsp;<span class="ident" id="2710525">cachePut</span><span class="op" id="2710533">(</span><span class="ident" id="2710534">ckey</span><span class="op" id="2710538">,</span>&nbsp;<span class="op" id="2710540">&amp;</span><span class="ident" id="2710541">array</span><span class="op" id="2710546">.</span><span class="ident" id="2710547">rtype</span><span class="op" id="2710552">)</span><br>
<span class="lineno"></span><span class="op" id="2710554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2710557">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2710621">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2710690">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2710756">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2710825">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2710867">func</span>&nbsp;<span class="ident" id="2710872">toType</span><span class="op" id="2710878">(</span><span class="ident" id="2710879">t</span>&nbsp;<span class="op" id="2710881">*</span><span class="ident" id="2710882">rtype</span><span class="op" id="2710887">)</span>&nbsp;<span class="ident" id="2710889">Type</span>&nbsp;<span class="op" id="2710894">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710897">if</span>&nbsp;<span class="ident" id="2710900">t</span>&nbsp;<span class="op" id="2710902">==</span>&nbsp;<span class="ident" id="2710905">nil</span>&nbsp;<span class="op" id="2710909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710913">return</span>&nbsp;<span class="ident" id="2710920">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710928">return</span>&nbsp;<span class="ident" id="2710935">t</span><br>
<span class="lineno"></span><span class="op" id="2710937">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2710940">type</span>&nbsp;<span class="ident" id="2710945">layoutKey</span>&nbsp;<span class="keyword" id="2710955">struct</span>&nbsp;<span class="op" id="2710962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710965">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2710970">*</span><span class="ident" id="2710971">rtype</span>&nbsp;<span class="comment" id="2710977">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711000">rcvr</span>&nbsp;<span class="op" id="2711005">*</span><span class="ident" id="2711006">rtype</span>&nbsp;<span class="comment" id="2711012">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2711045">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2711048">type</span>&nbsp;<span class="ident" id="2711053">layoutType</span>&nbsp;<span class="keyword" id="2711064">struct</span>&nbsp;<span class="op" id="2711071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711074">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711084">*</span><span class="ident" id="2711085">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711092">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2711102">uintptr</span>&nbsp;<span class="comment" id="2711110">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711132">retOffset</span>&nbsp;<span class="builtintype" id="2711142">uintptr</span>&nbsp;<span class="comment" id="2711150">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711179">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711189">*</span><span class="ident" id="2711190">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2711200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2711203">var</span>&nbsp;<span class="ident" id="2711207">layoutCache</span>&nbsp;<span class="keyword" id="2711219">struct</span>&nbsp;<span class="op" id="2711226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711229">sync</span><span class="op" id="2711233">.</span><span class="ident" id="2711234">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711243">m</span>&nbsp;<span class="keyword" id="2711245">map</span><span class="op" id="2711248">[</span><span class="ident" id="2711249">layoutKey</span><span class="op" id="2711258">]</span><span class="ident" id="2711259">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2711270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2711273">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2711341">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2711406">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2711466">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2711545">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2711613">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2711653">func</span>&nbsp;<span class="ident" id="2711658">funcLayout</span><span class="op" id="2711668">(</span><span class="ident" id="2711669">t</span>&nbsp;<span class="op" id="2711671">*</span><span class="ident" id="2711672">rtype</span><span class="op" id="2711677">,</span>&nbsp;<span class="ident" id="2711679">rcvr</span>&nbsp;<span class="op" id="2711684">*</span><span class="ident" id="2711685">rtype</span><span class="op" id="2711690">)</span>&nbsp;<span class="op" id="2711692">(</span><span class="ident" id="2711693">frametype</span>&nbsp;<span class="op" id="2711703">*</span><span class="ident" id="2711704">rtype</span><span class="op" id="2711709">,</span>&nbsp;<span class="ident" id="2711711">argSize</span><span class="op" id="2711718">,</span>&nbsp;<span class="ident" id="2711720">retOffset</span>&nbsp;<span class="builtintype" id="2711730">uintptr</span><span class="op" id="2711737">,</span>&nbsp;<span class="ident" id="2711739">stack</span>&nbsp;<span class="op" id="2711745">*</span><span class="ident" id="2711746">bitVector</span><span class="op" id="2711755">)</span>&nbsp;<span class="op" id="2711757">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711760">if</span>&nbsp;<span class="ident" id="2711763">t</span><span class="op" id="2711764">.</span><span class="ident" id="2711765">Kind</span><span class="op" id="2711769">(</span><span class="op" id="2711770">)</span>&nbsp;<span class="op" id="2711772">!=</span>&nbsp;<span class="ident" id="2711775">Func</span>&nbsp;<span class="op" id="2711780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2711784">panic</span><span class="op" id="2711789">(</span><span class="string" id="2711790">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2711828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711834">if</span>&nbsp;<span class="ident" id="2711837">rcvr</span>&nbsp;<span class="op" id="2711842">!=</span>&nbsp;<span class="ident" id="2711845">nil</span>&nbsp;<span class="op" id="2711849">&amp;&amp;</span>&nbsp;<span class="ident" id="2711852">rcvr</span><span class="op" id="2711856">.</span><span class="ident" id="2711857">Kind</span><span class="op" id="2711861">(</span><span class="op" id="2711862">)</span>&nbsp;<span class="op" id="2711864">==</span>&nbsp;<span class="ident" id="2711867">Interface</span>&nbsp;<span class="op" id="2711877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2711881">panic</span><span class="op" id="2711886">(</span><span class="string" id="2711887">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2711934">+</span>&nbsp;<span class="ident" id="2711936">rcvr</span><span class="op" id="2711940">.</span><span class="ident" id="2711941">String</span><span class="op" id="2711947">(</span><span class="op" id="2711948">)</span><span class="op" id="2711949">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711955">k</span>&nbsp;<span class="op" id="2711957">:=</span>&nbsp;<span class="ident" id="2711960">layoutKey</span><span class="op" id="2711969">{</span><span class="ident" id="2711970">t</span><span class="op" id="2711971">,</span>&nbsp;<span class="ident" id="2711973">rcvr</span><span class="op" id="2711977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711980">layoutCache</span><span class="op" id="2711991">.</span><span class="ident" id="2711992">RLock</span><span class="op" id="2711997">(</span><span class="op" id="2711998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712001">if</span>&nbsp;<span class="ident" id="2712004">x</span>&nbsp;<span class="op" id="2712006">:=</span>&nbsp;<span class="ident" id="2712009">layoutCache</span><span class="op" id="2712020">.</span><span class="ident" id="2712021">m</span><span class="op" id="2712022">[</span><span class="ident" id="2712023">k</span><span class="op" id="2712024">]</span><span class="op" id="2712025">;</span>&nbsp;<span class="ident" id="2712027">x</span><span class="op" id="2712028">.</span><span class="ident" id="2712029">t</span>&nbsp;<span class="op" id="2712031">!=</span>&nbsp;<span class="ident" id="2712034">nil</span>&nbsp;<span class="op" id="2712038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712042">layoutCache</span><span class="op" id="2712053">.</span><span class="ident" id="2712054">RUnlock</span><span class="op" id="2712061">(</span><span class="op" id="2712062">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712066">return</span>&nbsp;<span class="ident" id="2712073">x</span><span class="op" id="2712074">.</span><span class="ident" id="2712075">t</span><span class="op" id="2712076">,</span>&nbsp;<span class="ident" id="2712078">x</span><span class="op" id="2712079">.</span><span class="ident" id="2712080">argSize</span><span class="op" id="2712087">,</span>&nbsp;<span class="ident" id="2712089">x</span><span class="op" id="2712090">.</span><span class="ident" id="2712091">retOffset</span><span class="op" id="2712100">,</span>&nbsp;<span class="ident" id="2712102">x</span><span class="op" id="2712103">.</span><span class="ident" id="2712104">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712114">layoutCache</span><span class="op" id="2712125">.</span><span class="ident" id="2712126">RUnlock</span><span class="op" id="2712133">(</span><span class="op" id="2712134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712137">layoutCache</span><span class="op" id="2712148">.</span><span class="ident" id="2712149">Lock</span><span class="op" id="2712153">(</span><span class="op" id="2712154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712157">if</span>&nbsp;<span class="ident" id="2712160">x</span>&nbsp;<span class="op" id="2712162">:=</span>&nbsp;<span class="ident" id="2712165">layoutCache</span><span class="op" id="2712176">.</span><span class="ident" id="2712177">m</span><span class="op" id="2712178">[</span><span class="ident" id="2712179">k</span><span class="op" id="2712180">]</span><span class="op" id="2712181">;</span>&nbsp;<span class="ident" id="2712183">x</span><span class="op" id="2712184">.</span><span class="ident" id="2712185">t</span>&nbsp;<span class="op" id="2712187">!=</span>&nbsp;<span class="ident" id="2712190">nil</span>&nbsp;<span class="op" id="2712194">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712198">layoutCache</span><span class="op" id="2712209">.</span><span class="ident" id="2712210">Unlock</span><span class="op" id="2712216">(</span><span class="op" id="2712217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712221">return</span>&nbsp;<span class="ident" id="2712228">x</span><span class="op" id="2712229">.</span><span class="ident" id="2712230">t</span><span class="op" id="2712231">,</span>&nbsp;<span class="ident" id="2712233">x</span><span class="op" id="2712234">.</span><span class="ident" id="2712235">argSize</span><span class="op" id="2712242">,</span>&nbsp;<span class="ident" id="2712244">x</span><span class="op" id="2712245">.</span><span class="ident" id="2712246">retOffset</span><span class="op" id="2712255">,</span>&nbsp;<span class="ident" id="2712257">x</span><span class="op" id="2712258">.</span><span class="ident" id="2712259">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712270">tt</span>&nbsp;<span class="op" id="2712273">:=</span>&nbsp;<span class="op" id="2712276">(</span><span class="op" id="2712277">*</span><span class="ident" id="2712278">funcType</span><span class="op" id="2712286">)</span><span class="op" id="2712287">(</span><span class="ident" id="2712288">unsafe</span><span class="op" id="2712294">.</span><span class="ident" id="2712295">Pointer</span><span class="op" id="2712302">(</span><span class="ident" id="2712303">t</span><span class="op" id="2712304">)</span><span class="op" id="2712305">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712309">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712361">stack</span>&nbsp;<span class="op" id="2712367">=</span>&nbsp;<span class="builtinfunc" id="2712369">new</span><span class="op" id="2712372">(</span><span class="ident" id="2712373">bitVector</span><span class="op" id="2712382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712385">var</span>&nbsp;<span class="ident" id="2712389">gc</span>&nbsp;<span class="ident" id="2712392">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712400">var</span>&nbsp;<span class="ident" id="2712404">offset</span>&nbsp;<span class="builtintype" id="2712411">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712420">if</span>&nbsp;<span class="ident" id="2712423">rcvr</span>&nbsp;<span class="op" id="2712428">!=</span>&nbsp;<span class="ident" id="2712431">nil</span>&nbsp;<span class="op" id="2712435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712439">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712496">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712552">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712600">if</span>&nbsp;<span class="ident" id="2712603">ifaceIndir</span><span class="op" id="2712613">(</span><span class="ident" id="2712614">rcvr</span><span class="op" id="2712618">)</span>&nbsp;<span class="op" id="2712620">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712625">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712666">gc</span><span class="op" id="2712668">.</span><span class="builtinfunc" id="2712669">append</span><span class="op" id="2712675">(</span><span class="ident" id="2712676">bitsPointer</span><span class="op" id="2712687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712692">stack</span><span class="op" id="2712697">.</span><span class="ident" id="2712698">append2</span><span class="op" id="2712705">(</span><span class="ident" id="2712706">bitsPointer</span><span class="op" id="2712717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712721">}</span>&nbsp;<span class="keyword" id="2712723">else</span>&nbsp;<span class="keyword" id="2712728">if</span>&nbsp;<span class="ident" id="2712731">rcvr</span><span class="op" id="2712735">.</span><span class="ident" id="2712736">pointers</span><span class="op" id="2712744">(</span><span class="op" id="2712745">)</span>&nbsp;<span class="op" id="2712747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712752">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712809">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712842">gc</span><span class="op" id="2712844">.</span><span class="builtinfunc" id="2712845">append</span><span class="op" id="2712851">(</span><span class="ident" id="2712852">bitsPointer</span><span class="op" id="2712863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712868">stack</span><span class="op" id="2712873">.</span><span class="ident" id="2712874">append2</span><span class="op" id="2712881">(</span><span class="ident" id="2712882">bitsPointer</span><span class="op" id="2712893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712897">}</span>&nbsp;<span class="keyword" id="2712899">else</span>&nbsp;<span class="op" id="2712904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712909">gc</span><span class="op" id="2712911">.</span><span class="builtinfunc" id="2712912">append</span><span class="op" id="2712918">(</span><span class="ident" id="2712919">bitsScalar</span><span class="op" id="2712929">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712934">stack</span><span class="op" id="2712939">.</span><span class="ident" id="2712940">append2</span><span class="op" id="2712947">(</span><span class="ident" id="2712948">bitsScalar</span><span class="op" id="2712958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712966">offset</span>&nbsp;<span class="op" id="2712973">+=</span>&nbsp;<span class="ident" id="2712976">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712988">for</span>&nbsp;<span class="ident" id="2712992">_</span><span class="op" id="2712993">,</span>&nbsp;<span class="ident" id="2712995">arg</span>&nbsp;<span class="op" id="2712999">:=</span>&nbsp;<span class="keyword" id="2713002">range</span>&nbsp;<span class="ident" id="2713008">tt</span><span class="op" id="2713010">.</span><span class="ident" id="2713011">in</span>&nbsp;<span class="op" id="2713014">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713018">gc</span><span class="op" id="2713020">.</span><span class="ident" id="2713021">appendProg</span><span class="op" id="2713031">(</span><span class="ident" id="2713032">arg</span><span class="op" id="2713035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713039">addTypeBits</span><span class="op" id="2713050">(</span><span class="ident" id="2713051">stack</span><span class="op" id="2713056">,</span>&nbsp;<span class="op" id="2713058">&amp;</span><span class="ident" id="2713059">offset</span><span class="op" id="2713065">,</span>&nbsp;<span class="ident" id="2713067">arg</span><span class="op" id="2713070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713076">argSize</span>&nbsp;<span class="op" id="2713084">=</span>&nbsp;<span class="ident" id="2713086">gc</span><span class="op" id="2713088">.</span><span class="ident" id="2713089">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713095">if</span>&nbsp;<span class="ident" id="2713098">runtime</span><span class="op" id="2713105">.</span><span class="ident" id="2713106">GOARCH</span>&nbsp;<span class="op" id="2713113">==</span>&nbsp;<span class="string" id="2713116">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2713127">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713131">gc</span><span class="op" id="2713133">.</span><span class="ident" id="2713134">align</span><span class="op" id="2713139">(</span><span class="num" id="2713140">8</span><span class="op" id="2713141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713147">gc</span><span class="op" id="2713149">.</span><span class="ident" id="2713150">align</span><span class="op" id="2713155">(</span><span class="ident" id="2713156">ptrSize</span><span class="op" id="2713163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713166">retOffset</span>&nbsp;<span class="op" id="2713176">=</span>&nbsp;<span class="ident" id="2713178">gc</span><span class="op" id="2713180">.</span><span class="ident" id="2713181">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713187">for</span>&nbsp;<span class="ident" id="2713191">_</span><span class="op" id="2713192">,</span>&nbsp;<span class="ident" id="2713194">res</span>&nbsp;<span class="op" id="2713198">:=</span>&nbsp;<span class="keyword" id="2713201">range</span>&nbsp;<span class="ident" id="2713207">tt</span><span class="op" id="2713209">.</span><span class="ident" id="2713210">out</span>&nbsp;<span class="op" id="2713214">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713218">gc</span><span class="op" id="2713220">.</span><span class="ident" id="2713221">appendProg</span><span class="op" id="2713231">(</span><span class="ident" id="2713232">res</span><span class="op" id="2713235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2713239">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713282">gc</span><span class="op" id="2713284">.</span><span class="ident" id="2713285">align</span><span class="op" id="2713290">(</span><span class="ident" id="2713291">ptrSize</span><span class="op" id="2713298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2713302">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713343">x</span>&nbsp;<span class="op" id="2713345">:=</span>&nbsp;<span class="builtinfunc" id="2713348">new</span><span class="op" id="2713351">(</span><span class="ident" id="2713352">rtype</span><span class="op" id="2713357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713360">x</span><span class="op" id="2713361">.</span><span class="ident" id="2713362">size</span>&nbsp;<span class="op" id="2713367">=</span>&nbsp;<span class="ident" id="2713369">gc</span><span class="op" id="2713371">.</span><span class="ident" id="2713372">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713378">x</span><span class="op" id="2713379">.</span><span class="ident" id="2713380">gc</span><span class="op" id="2713382">[</span><span class="num" id="2713383">0</span><span class="op" id="2713384">]</span>&nbsp;<span class="op" id="2713386">=</span>&nbsp;<span class="ident" id="2713388">gc</span><span class="op" id="2713390">.</span><span class="ident" id="2713391">finalize</span><span class="op" id="2713399">(</span><span class="op" id="2713400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713403">var</span>&nbsp;<span class="ident" id="2713407">s</span>&nbsp;<span class="builtintype" id="2713409">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713417">if</span>&nbsp;<span class="ident" id="2713420">rcvr</span>&nbsp;<span class="op" id="2713425">!=</span>&nbsp;<span class="ident" id="2713428">nil</span>&nbsp;<span class="op" id="2713432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713436">s</span>&nbsp;<span class="op" id="2713438">=</span>&nbsp;<span class="string" id="2713440">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2713454">+</span>&nbsp;<span class="op" id="2713456">*</span><span class="ident" id="2713457">rcvr</span><span class="op" id="2713461">.</span><span class="builtintype" id="2713462">string</span>&nbsp;<span class="op" id="2713469">+</span>&nbsp;<span class="string" id="2713471">&#34;)(&#34;</span>&nbsp;<span class="op" id="2713476">+</span>&nbsp;<span class="op" id="2713478">*</span><span class="ident" id="2713479">t</span><span class="op" id="2713480">.</span><span class="builtintype" id="2713481">string</span>&nbsp;<span class="op" id="2713488">+</span>&nbsp;<span class="string" id="2713490">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713495">}</span>&nbsp;<span class="keyword" id="2713497">else</span>&nbsp;<span class="op" id="2713502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713506">s</span>&nbsp;<span class="op" id="2713508">=</span>&nbsp;<span class="string" id="2713510">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2713522">+</span>&nbsp;<span class="op" id="2713524">*</span><span class="ident" id="2713525">t</span><span class="op" id="2713526">.</span><span class="builtintype" id="2713527">string</span>&nbsp;<span class="op" id="2713534">+</span>&nbsp;<span class="string" id="2713536">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713541">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713544">x</span><span class="op" id="2713545">.</span><span class="builtintype" id="2713546">string</span>&nbsp;<span class="op" id="2713553">=</span>&nbsp;<span class="op" id="2713555">&amp;</span><span class="ident" id="2713556">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2713560">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713596">if</span>&nbsp;<span class="ident" id="2713599">layoutCache</span><span class="op" id="2713610">.</span><span class="ident" id="2713611">m</span>&nbsp;<span class="op" id="2713613">==</span>&nbsp;<span class="ident" id="2713616">nil</span>&nbsp;<span class="op" id="2713620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713624">layoutCache</span><span class="op" id="2713635">.</span><span class="ident" id="2713636">m</span>&nbsp;<span class="op" id="2713638">=</span>&nbsp;<span class="builtinfunc" id="2713640">make</span><span class="op" id="2713644">(</span><span class="keyword" id="2713645">map</span><span class="op" id="2713648">[</span><span class="ident" id="2713649">layoutKey</span><span class="op" id="2713658">]</span><span class="ident" id="2713659">layoutType</span><span class="op" id="2713669">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713675">layoutCache</span><span class="op" id="2713686">.</span><span class="ident" id="2713687">m</span><span class="op" id="2713688">[</span><span class="ident" id="2713689">k</span><span class="op" id="2713690">]</span>&nbsp;<span class="op" id="2713692">=</span>&nbsp;<span class="ident" id="2713694">layoutType</span><span class="op" id="2713704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713708">t</span><span class="op" id="2713709">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713719">x</span><span class="op" id="2713720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713724">argSize</span><span class="op" id="2713731">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2713735">argSize</span><span class="op" id="2713742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713746">retOffset</span><span class="op" id="2713755">:</span>&nbsp;<span class="ident" id="2713757">retOffset</span><span class="op" id="2713766">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713770">stack</span><span class="op" id="2713775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713781">stack</span><span class="op" id="2713786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713792">layoutCache</span><span class="op" id="2713803">.</span><span class="ident" id="2713804">Unlock</span><span class="op" id="2713810">(</span><span class="op" id="2713811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713814">return</span>&nbsp;<span class="ident" id="2713821">x</span><span class="op" id="2713822">,</span>&nbsp;<span class="ident" id="2713824">argSize</span><span class="op" id="2713831">,</span>&nbsp;<span class="ident" id="2713833">retOffset</span><span class="op" id="2713842">,</span>&nbsp;<span class="ident" id="2713844">stack</span><br>
<span class="lineno"></span><span class="op" id="2713850">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2713853">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2713929">func</span>&nbsp;<span class="ident" id="2713934">ifaceIndir</span><span class="op" id="2713944">(</span><span class="ident" id="2713945">t</span>&nbsp;<span class="op" id="2713947">*</span><span class="ident" id="2713948">rtype</span><span class="op" id="2713953">)</span>&nbsp;<span class="builtintype" id="2713955">bool</span>&nbsp;<span class="op" id="2713960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713963">return</span>&nbsp;<span class="ident" id="2713970">t</span><span class="op" id="2713971">.</span><span class="ident" id="2713972">kind</span><span class="op" id="2713976">&amp;</span><span class="ident" id="2713977">kindDirectIface</span>&nbsp;<span class="op" id="2713993">==</span>&nbsp;<span class="num" id="2713996">0</span><br>
<span class="lineno"></span><span class="op" id="2713998">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2714001">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2714052">type</span>&nbsp;<span class="ident" id="2714057">bitVector</span>&nbsp;<span class="keyword" id="2714067">struct</span>&nbsp;<span class="op" id="2714074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714077">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2714082">uint32</span>&nbsp;<span class="comment" id="2714089">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714108">data</span>&nbsp;<span class="op" id="2714113">[</span><span class="op" id="2714114">]</span><span class="builtintype" id="2714115">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2714120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2714123">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2714159">func</span>&nbsp;<span class="op" id="2714164">(</span><span class="ident" id="2714165">bv</span>&nbsp;<span class="op" id="2714168">*</span><span class="ident" id="2714169">bitVector</span><span class="op" id="2714178">)</span>&nbsp;<span class="ident" id="2714180">append2</span><span class="op" id="2714187">(</span><span class="ident" id="2714188">bits</span>&nbsp;<span class="builtintype" id="2714193">uint8</span><span class="op" id="2714198">)</span>&nbsp;<span class="op" id="2714200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714203">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714276">if</span>&nbsp;<span class="ident" id="2714279">bv</span><span class="op" id="2714281">.</span><span class="ident" id="2714282">n</span><span class="op" id="2714283">%</span><span class="num" id="2714284">8</span>&nbsp;<span class="op" id="2714286">==</span>&nbsp;<span class="num" id="2714289">0</span>&nbsp;<span class="op" id="2714291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714295">bv</span><span class="op" id="2714297">.</span><span class="ident" id="2714298">data</span>&nbsp;<span class="op" id="2714303">=</span>&nbsp;<span class="builtinfunc" id="2714305">append</span><span class="op" id="2714311">(</span><span class="ident" id="2714312">bv</span><span class="op" id="2714314">.</span><span class="ident" id="2714315">data</span><span class="op" id="2714319">,</span>&nbsp;<span class="num" id="2714321">0</span><span class="op" id="2714322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714328">bv</span><span class="op" id="2714330">.</span><span class="ident" id="2714331">data</span><span class="op" id="2714335">[</span><span class="ident" id="2714336">bv</span><span class="op" id="2714338">.</span><span class="ident" id="2714339">n</span><span class="op" id="2714340">/</span><span class="num" id="2714341">8</span><span class="op" id="2714342">]</span>&nbsp;<span class="op" id="2714344">|=</span>&nbsp;<span class="ident" id="2714347">bits</span>&nbsp;<span class="op" id="2714352">&lt;&lt;</span>&nbsp;<span class="op" id="2714355">(</span><span class="ident" id="2714356">bv</span><span class="op" id="2714358">.</span><span class="ident" id="2714359">n</span>&nbsp;<span class="op" id="2714361">%</span>&nbsp;<span class="num" id="2714363">8</span><span class="op" id="2714364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714367">bv</span><span class="op" id="2714369">.</span><span class="ident" id="2714370">n</span>&nbsp;<span class="op" id="2714372">+=</span>&nbsp;<span class="num" id="2714375">2</span><br>
<span class="lineno">1885</span><span class="op" id="2714377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2714380">func</span>&nbsp;<span class="ident" id="2714385">addTypeBits</span><span class="op" id="2714396">(</span><span class="ident" id="2714397">bv</span>&nbsp;<span class="op" id="2714400">*</span><span class="ident" id="2714401">bitVector</span><span class="op" id="2714410">,</span>&nbsp;<span class="ident" id="2714412">offset</span>&nbsp;<span class="op" id="2714419">*</span><span class="builtintype" id="2714420">uintptr</span><span class="op" id="2714427">,</span>&nbsp;<span class="ident" id="2714429">t</span>&nbsp;<span class="op" id="2714431">*</span><span class="ident" id="2714432">rtype</span><span class="op" id="2714437">)</span>&nbsp;<span class="op" id="2714439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714442">*</span><span class="ident" id="2714443">offset</span>&nbsp;<span class="op" id="2714450">=</span>&nbsp;<span class="ident" id="2714452">align</span><span class="op" id="2714457">(</span><span class="op" id="2714458">*</span><span class="ident" id="2714459">offset</span><span class="op" id="2714465">,</span>&nbsp;<span class="builtintype" id="2714467">uintptr</span><span class="op" id="2714474">(</span><span class="ident" id="2714475">t</span><span class="op" id="2714476">.</span><span class="ident" id="2714477">align</span><span class="op" id="2714482">)</span><span class="op" id="2714483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714486">if</span>&nbsp;<span class="ident" id="2714489">t</span><span class="op" id="2714490">.</span><span class="ident" id="2714491">kind</span><span class="op" id="2714495">&amp;</span><span class="ident" id="2714496">kindNoPointers</span>&nbsp;<span class="op" id="2714511">!=</span>&nbsp;<span class="num" id="2714514">0</span>&nbsp;<span class="op" id="2714516">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714520">*</span><span class="ident" id="2714521">offset</span>&nbsp;<span class="op" id="2714528">+=</span>&nbsp;<span class="ident" id="2714531">t</span><span class="op" id="2714532">.</span><span class="ident" id="2714533">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714540">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714552">switch</span>&nbsp;<span class="ident" id="2714559">Kind</span><span class="op" id="2714563">(</span><span class="ident" id="2714564">t</span><span class="op" id="2714565">.</span><span class="ident" id="2714566">kind</span>&nbsp;<span class="op" id="2714571">&amp;</span>&nbsp;<span class="ident" id="2714573">kindMask</span><span class="op" id="2714581">)</span>&nbsp;<span class="op" id="2714583">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714586">case</span>&nbsp;<span class="ident" id="2714591">Chan</span><span class="op" id="2714595">,</span>&nbsp;<span class="ident" id="2714597">Func</span><span class="op" id="2714601">,</span>&nbsp;<span class="ident" id="2714603">Map</span><span class="op" id="2714606">,</span>&nbsp;<span class="ident" id="2714608">Ptr</span><span class="op" id="2714611">,</span>&nbsp;<span class="ident" id="2714613">Slice</span><span class="op" id="2714618">,</span>&nbsp;<span class="ident" id="2714620">String</span><span class="op" id="2714626">,</span>&nbsp;<span class="ident" id="2714628">UnsafePointer</span><span class="op" id="2714641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714645">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714687">for</span>&nbsp;<span class="ident" id="2714691">bv</span><span class="op" id="2714693">.</span><span class="ident" id="2714694">n</span>&nbsp;<span class="op" id="2714696">&lt;</span>&nbsp;<span class="num" id="2714698">2</span><span class="op" id="2714699">*</span><span class="builtintype" id="2714700">uint32</span><span class="op" id="2714706">(</span><span class="op" id="2714707">*</span><span class="ident" id="2714708">offset</span><span class="op" id="2714714">/</span><span class="builtintype" id="2714715">uintptr</span><span class="op" id="2714722">(</span><span class="ident" id="2714723">ptrSize</span><span class="op" id="2714730">)</span><span class="op" id="2714731">)</span>&nbsp;<span class="op" id="2714733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714738">bv</span><span class="op" id="2714740">.</span><span class="ident" id="2714741">append2</span><span class="op" id="2714748">(</span><span class="ident" id="2714749">bitsScalar</span><span class="op" id="2714759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714763">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714767">bv</span><span class="op" id="2714769">.</span><span class="ident" id="2714770">append2</span><span class="op" id="2714777">(</span><span class="ident" id="2714778">bitsPointer</span><span class="op" id="2714789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714793">case</span>&nbsp;<span class="ident" id="2714798">Interface</span><span class="op" id="2714807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714811">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714827">for</span>&nbsp;<span class="ident" id="2714831">bv</span><span class="op" id="2714833">.</span><span class="ident" id="2714834">n</span>&nbsp;<span class="op" id="2714836">&lt;</span>&nbsp;<span class="num" id="2714838">2</span><span class="op" id="2714839">*</span><span class="builtintype" id="2714840">uint32</span><span class="op" id="2714846">(</span><span class="op" id="2714847">*</span><span class="ident" id="2714848">offset</span><span class="op" id="2714854">/</span><span class="builtintype" id="2714855">uintptr</span><span class="op" id="2714862">(</span><span class="ident" id="2714863">ptrSize</span><span class="op" id="2714870">)</span><span class="op" id="2714871">)</span>&nbsp;<span class="op" id="2714873">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714878">bv</span><span class="op" id="2714880">.</span><span class="ident" id="2714881">append2</span><span class="op" id="2714888">(</span><span class="ident" id="2714889">bitsScalar</span><span class="op" id="2714899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714907">bv</span><span class="op" id="2714909">.</span><span class="ident" id="2714910">append2</span><span class="op" id="2714917">(</span><span class="ident" id="2714918">bitsPointer</span><span class="op" id="2714929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714933">bv</span><span class="op" id="2714935">.</span><span class="ident" id="2714936">append2</span><span class="op" id="2714943">(</span><span class="ident" id="2714944">bitsPointer</span><span class="op" id="2714955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714959">case</span>&nbsp;<span class="ident" id="2714964">Array</span><span class="op" id="2714969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714973">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714996">tt</span>&nbsp;<span class="op" id="2714999">:=</span>&nbsp;<span class="op" id="2715002">(</span><span class="op" id="2715003">*</span><span class="ident" id="2715004">arrayType</span><span class="op" id="2715013">)</span><span class="op" id="2715014">(</span><span class="ident" id="2715015">unsafe</span><span class="op" id="2715021">.</span><span class="ident" id="2715022">Pointer</span><span class="op" id="2715029">(</span><span class="ident" id="2715030">t</span><span class="op" id="2715031">)</span><span class="op" id="2715032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715036">for</span>&nbsp;<span class="ident" id="2715040">i</span>&nbsp;<span class="op" id="2715042">:=</span>&nbsp;<span class="num" id="2715045">0</span><span class="op" id="2715046">;</span>&nbsp;<span class="ident" id="2715048">i</span>&nbsp;<span class="op" id="2715050">&lt;</span>&nbsp;<span class="builtintype" id="2715052">int</span><span class="op" id="2715055">(</span><span class="ident" id="2715056">tt</span><span class="op" id="2715058">.</span><span class="builtinfunc" id="2715059">len</span><span class="op" id="2715062">)</span><span class="op" id="2715063">;</span>&nbsp;<span class="ident" id="2715065">i</span><span class="op" id="2715066">++</span>&nbsp;<span class="op" id="2715069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715074">addTypeBits</span><span class="op" id="2715085">(</span><span class="ident" id="2715086">bv</span><span class="op" id="2715088">,</span>&nbsp;<span class="ident" id="2715090">offset</span><span class="op" id="2715096">,</span>&nbsp;<span class="ident" id="2715098">tt</span><span class="op" id="2715100">.</span><span class="ident" id="2715101">elem</span><span class="op" id="2715105">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715113">case</span>&nbsp;<span class="ident" id="2715118">Struct</span><span class="op" id="2715124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715128">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715146">tt</span>&nbsp;<span class="op" id="2715149">:=</span>&nbsp;<span class="op" id="2715152">(</span><span class="op" id="2715153">*</span><span class="ident" id="2715154">structType</span><span class="op" id="2715164">)</span><span class="op" id="2715165">(</span><span class="ident" id="2715166">unsafe</span><span class="op" id="2715172">.</span><span class="ident" id="2715173">Pointer</span><span class="op" id="2715180">(</span><span class="ident" id="2715181">t</span><span class="op" id="2715182">)</span><span class="op" id="2715183">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715187">start</span>&nbsp;<span class="op" id="2715193">:=</span>&nbsp;<span class="op" id="2715196">*</span><span class="ident" id="2715197">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715206">for</span>&nbsp;<span class="ident" id="2715210">i</span>&nbsp;<span class="op" id="2715212">:=</span>&nbsp;<span class="keyword" id="2715215">range</span>&nbsp;<span class="ident" id="2715221">tt</span><span class="op" id="2715223">.</span><span class="ident" id="2715224">fields</span>&nbsp;<span class="op" id="2715231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715236">f</span>&nbsp;<span class="op" id="2715238">:=</span>&nbsp;<span class="op" id="2715241">&amp;</span><span class="ident" id="2715242">tt</span><span class="op" id="2715244">.</span><span class="ident" id="2715245">fields</span><span class="op" id="2715251">[</span><span class="ident" id="2715252">i</span><span class="op" id="2715253">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715258">off</span>&nbsp;<span class="op" id="2715262">:=</span>&nbsp;<span class="ident" id="2715265">start</span>&nbsp;<span class="op" id="2715271">+</span>&nbsp;<span class="ident" id="2715273">f</span><span class="op" id="2715274">.</span><span class="ident" id="2715275">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715285">addTypeBits</span><span class="op" id="2715296">(</span><span class="ident" id="2715297">bv</span><span class="op" id="2715299">,</span>&nbsp;<span class="op" id="2715301">&amp;</span><span class="ident" id="2715302">off</span><span class="op" id="2715305">,</span>&nbsp;<span class="ident" id="2715307">f</span><span class="op" id="2715308">.</span><span class="ident" id="2715309">typ</span><span class="op" id="2715312">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715323">*</span><span class="ident" id="2715324">offset</span>&nbsp;<span class="op" id="2715331">+=</span>&nbsp;<span class="ident" id="2715334">t</span><span class="op" id="2715335">.</span><span class="ident" id="2715336">size</span><br>
<span class="lineno"></span><span class="op" id="2715341">}</span>
</div>
</body>
</html>
