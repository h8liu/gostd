<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7484147">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7484202">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7484256">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7484307">package</span>&nbsp;<span class="ident" id="7484315">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7484320">import</span>&nbsp;<span class="op" id="7484327">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484330">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484339">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484346">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484352">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484359">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484370">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7484381">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7484388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7484391">var</span>&nbsp;<span class="ident" id="7484395">rsaCertPEM</span>&nbsp;<span class="op" id="7484406">=</span>&nbsp;<span class="string" id="7484408">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB0zCCAX2gAwIBAgIJAI/M7BYjwB+uMA0GCSqGSIb3DQEBBQUAMEUxCzAJBgNV<br>
<span class="lineno"></span>BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX<br>
<span class="lineno">20</span>aWRnaXRzIFB0eSBMdGQwHhcNMTIwOTEyMjE1MjAyWhcNMTUwOTEyMjE1MjAyWjBF<br>
<span class="lineno"></span>MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50<br>
<span class="lineno"></span>ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANLJ<br>
<span class="lineno"></span>hPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wok/4xIA+ui35/MmNa<br>
<span class="lineno"></span>rtNuC+BdZ1tMuVCPFZcCAwEAAaNQME4wHQYDVR0OBBYEFJvKs8RfJaXTH08W+SGv<br>
<span class="lineno">25</span>zQyKn0H8MB8GA1UdIwQYMBaAFJvKs8RfJaXTH08W+SGvzQyKn0H8MAwGA1UdEwQF<br>
<span class="lineno"></span>MAMBAf8wDQYJKoZIhvcNAQEFBQADQQBJlffJHybjDGxRMqaRmDhX0+6v02TUKZsW<br>
<span class="lineno"></span>r5QuVbpQhH6u+0UgcW0jp9QwpxoPTLTWGXEWBBBurxFwiCBhkQ+V<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7485104">var</span>&nbsp;<span class="ident" id="7485108">rsaKeyPEM</span>&nbsp;<span class="op" id="7485118">=</span>&nbsp;<span class="string" id="7485120">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOwIBAAJBANLJhPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wo<br>
<span class="lineno"></span>k/4xIA+ui35/MmNartNuC+BdZ1tMuVCPFZcCAwEAAQJAEJ2N+zsR0Xn8/Q6twa4G<br>
<span class="lineno"></span>6OB1M1WO+k+ztnX/1SvNeWu8D6GImtupLTYgjZcHufykj09jiHmjHx8u8ZZB/o1N<br>
<span class="lineno">35</span>MQIhAPW+eyZo7ay3lMz1V01WVjNKK9QSn1MJlb06h/LuYv9FAiEA25WPedKgVyCW<br>
<span class="lineno"></span>SmUwbPw8fnTcpqDWE3yTO3vKcebqMSsCIBF3UmVue8YU3jybC3NxuXq3wNm34R8T<br>
<span class="lineno"></span>xVLHwDXh/6NJAiEAl2oHGGLz64BuAfjKrqwz7qMYr9HCLIe/YsoWq/olzScCIQDi<br>
<span class="lineno"></span>D2lWusoe2/nEqfDVVWGWlyJ7yOmqaVm/iNUN9B2N2g==<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">40</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7485621">//&nbsp;keyPEM&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;rsaKeyPEM,&nbsp;but&nbsp;declares&nbsp;itself&nbsp;as&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="7485685">//&nbsp;&#34;PRIVATE&nbsp;KEY&#34;,&nbsp;not&nbsp;&#34;RSA&nbsp;PRIVATE&nbsp;KEY&#34;.&nbsp;&nbsp;http://golang.org/issue/4477</span><br>
<span class="lineno"></span><span class="keyword" id="7485756">var</span>&nbsp;<span class="ident" id="7485760">keyPEM</span>&nbsp;<span class="op" id="7485767">=</span>&nbsp;<span class="string" id="7485769">`-----BEGIN&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">45</span>MIIBOwIBAAJBANLJhPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wo<br>
<span class="lineno"></span>k/4xIA+ui35/MmNartNuC+BdZ1tMuVCPFZcCAwEAAQJAEJ2N+zsR0Xn8/Q6twa4G<br>
<span class="lineno"></span>6OB1M1WO+k+ztnX/1SvNeWu8D6GImtupLTYgjZcHufykj09jiHmjHx8u8ZZB/o1N<br>
<span class="lineno"></span>MQIhAPW+eyZo7ay3lMz1V01WVjNKK9QSn1MJlb06h/LuYv9FAiEA25WPedKgVyCW<br>
<span class="lineno"></span>SmUwbPw8fnTcpqDWE3yTO3vKcebqMSsCIBF3UmVue8YU3jybC3NxuXq3wNm34R8T<br>
<span class="lineno">50</span>xVLHwDXh/6NJAiEAl2oHGGLz64BuAfjKrqwz7qMYr9HCLIe/YsoWq/olzScCIQDi<br>
<span class="lineno"></span>D2lWusoe2/nEqfDVVWGWlyJ7yOmqaVm/iNUN9B2N2g==<br>
<span class="lineno"></span>-----END&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7486262">var</span>&nbsp;<span class="ident" id="7486266">ecdsaCertPEM</span>&nbsp;<span class="op" id="7486279">=</span>&nbsp;<span class="string" id="7486281">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB/jCCAWICCQDscdUxw16XFDAJBgcqhkjOPQQBMEUxCzAJBgNVBAYTAkFVMRMw<br>
<span class="lineno"></span>EQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0<br>
<span class="lineno"></span>eSBMdGQwHhcNMTIxMTE0MTI0MDQ4WhcNMTUxMTE0MTI0MDQ4WjBFMQswCQYDVQQG<br>
<span class="lineno"></span>EwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lk<br>
<span class="lineno">60</span>Z2l0cyBQdHkgTHRkMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQBY9+my9OoeSUR<br>
<span class="lineno"></span>lDQdV/x8LsOuLilthhiS1Tz4aGDHIPwC1mlvnf7fg5lecYpMCrLLhauAc1UJXcgl<br>
<span class="lineno"></span>01xoLuzgtAEAgv2P/jgytzRSpUYvgLBt1UA0leLYBy6mQQbrNEuqT3INapKIcUv8<br>
<span class="lineno"></span>XxYP0xMEUksLPq6Ca+CRSqTtrd/23uTnapkwCQYHKoZIzj0EAQOBigAwgYYCQXJo<br>
<span class="lineno"></span>A7Sl2nLVf+4Iu/tAX/IF4MavARKC4PPHK3zfuGfPR3oCCcsAoz3kAzOeijvd0iXb<br>
<span class="lineno">65</span>H5jBImIxPL4WxQNiBTexAkF8D1EtpYuWdlVQ80/h/f4pBcGiXPqX5h2PQSQY7hP1<br>
<span class="lineno"></span>+jwM1FGS4fREIOvlBYr/SzzQRtwrvrzGYxDEDbsC0ZGRnA==<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="7487038">var</span>&nbsp;<span class="ident" id="7487042">ecdsaKeyPEM</span>&nbsp;<span class="op" id="7487054">=</span>&nbsp;<span class="string" id="7487056">`-----BEGIN&nbsp;EC&nbsp;PARAMETERS-----<br>
<span class="lineno"></span>BgUrgQQAIw==<br>
<span class="lineno"></span>-----END&nbsp;EC&nbsp;PARAMETERS-----<br>
<span class="lineno"></span>-----BEGIN&nbsp;EC&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIHcAgEBBEIBrsoKp0oqcv6/JovJJDoDVSGWdirrkgCWxrprGlzB9o0X8fV675X0<br>
<span class="lineno">75</span>NwuBenXFfeZvVcwluO7/Q9wkYoPd/t3jGImgBwYFK4EEACOhgYkDgYYABAFj36bL<br>
<span class="lineno"></span>06h5JRGUNB1X/Hwuw64uKW2GGJLVPPhoYMcg/ALWaW+d/t+DmV5xikwKssuFq4Bz<br>
<span class="lineno"></span>VQldyCXTXGgu7OC0AQCC/Y/+ODK3NFKlRi+AsG3VQDSV4tgHLqZBBus0S6pPcg1q<br>
<span class="lineno"></span>kohxS/xfFg/TEwRSSws+roJr4JFKpO2t3/be5OdqmQ==<br>
<span class="lineno"></span>-----END&nbsp;EC&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">80</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7487496">var</span>&nbsp;<span class="ident" id="7487500">keyPairTests</span>&nbsp;<span class="op" id="7487513">=</span>&nbsp;<span class="op" id="7487515">[</span><span class="op" id="7487516">]</span><span class="keyword" id="7487517">struct</span>&nbsp;<span class="op" id="7487524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487527">algo</span>&nbsp;<span class="builtintype" id="7487532">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487540">cert</span>&nbsp;<span class="builtintype" id="7487545">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487553">key</span>&nbsp;&nbsp;<span class="builtintype" id="7487558">string</span><br>
<span class="lineno"></span><span class="op" id="7487565">}</span><span class="op" id="7487566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487569">{</span><span class="string" id="7487570">&#34;ECDSA&#34;</span><span class="op" id="7487577">,</span>&nbsp;<span class="ident" id="7487579"><a href="/crypto/tls/tls_test.go.html#7486266">ecdsaCertPEM</a></span><span class="op" id="7487591">,</span>&nbsp;<span class="ident" id="7487593"><a href="/crypto/tls/tls_test.go.html#7487042">ecdsaKeyPEM</a></span><span class="op" id="7487604">}</span><span class="op" id="7487605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487608">{</span><span class="string" id="7487609">&#34;RSA&#34;</span><span class="op" id="7487614">,</span>&nbsp;<span class="ident" id="7487616"><a href="/crypto/tls/tls_test.go.html#7484395">rsaCertPEM</a></span><span class="op" id="7487626">,</span>&nbsp;<span class="ident" id="7487628"><a href="/crypto/tls/tls_test.go.html#7485108">rsaKeyPEM</a></span><span class="op" id="7487637">}</span><span class="op" id="7487638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487641">{</span><span class="string" id="7487642">&#34;RSA-untyped&#34;</span><span class="op" id="7487655">,</span>&nbsp;<span class="ident" id="7487657"><a href="/crypto/tls/tls_test.go.html#7484395">rsaCertPEM</a></span><span class="op" id="7487667">,</span>&nbsp;<span class="ident" id="7487669"><a href="/crypto/tls/tls_test.go.html#7485760">keyPEM</a></span><span class="op" id="7487675">}</span><span class="op" id="7487676">,</span>&nbsp;<span class="comment" id="7487678">//&nbsp;golang.org/issue/4477</span><br>
<span class="lineno">90</span><span class="op" id="7487703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7487706">func</span>&nbsp;<span class="ident" id="7487711">TestX509KeyPair</span><span class="op" id="7487726">(</span><span class="ident" id="7487727">t</span>&nbsp;<span class="op" id="7487729">*</span><span class="ident" id="7487730"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7487737">.</span><span class="ident" id="7487738">T</span><span class="op" id="7487739">)</span>&nbsp;<span class="op" id="7487741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487744">var</span>&nbsp;<span class="ident" id="7487748">pem</span>&nbsp;<span class="op" id="7487752">[</span><span class="op" id="7487753">]</span><span class="builtintype" id="7487754">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487760">for</span>&nbsp;<span class="ident" id="7487764">_</span><span class="op" id="7487765">,</span>&nbsp;<span class="ident" id="7487767">test</span>&nbsp;<span class="op" id="7487772">:=</span>&nbsp;<span class="keyword" id="7487775">range</span>&nbsp;<span class="ident" id="7487781"><a href="/crypto/tls/tls_test.go.html#7487500">keyPairTests</a></span>&nbsp;<span class="op" id="7487794">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487798"><a href="/crypto/tls/tls_test.go.html#7487748">pem</a></span>&nbsp;<span class="op" id="7487802">=</span>&nbsp;<span class="op" id="7487804">[</span><span class="op" id="7487805">]</span><span class="builtintype" id="7487806">byte</span><span class="op" id="7487810">(</span><span class="ident" id="7487811"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7487815">.</span><span class="ident" id="7487816">cert</span>&nbsp;<span class="op" id="7487821">+</span>&nbsp;<span class="ident" id="7487823"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7487827">.</span><span class="ident" id="7487828">key</span><span class="op" id="7487831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487835">if</span>&nbsp;<span class="ident" id="7487838">_</span><span class="op" id="7487839">,</span>&nbsp;<span class="ident" id="7487841">err</span>&nbsp;<span class="op" id="7487845">:=</span>&nbsp;<span class="ident" id="7487848"><a href="/crypto/tls/tls.go.html#3968629">X509KeyPair</a></span><span class="op" id="7487859">(</span><span class="ident" id="7487860"><a href="/crypto/tls/tls_test.go.html#7487748">pem</a></span><span class="op" id="7487863">,</span>&nbsp;<span class="ident" id="7487865"><a href="/crypto/tls/tls_test.go.html#7487748">pem</a></span><span class="op" id="7487868">)</span><span class="op" id="7487869">;</span>&nbsp;<span class="ident" id="7487871"><a href="/crypto/tls/tls_test.go.html#7487841">err</a></span>&nbsp;<span class="op" id="7487875">!=</span>&nbsp;<span class="ident" id="7487878">nil</span>&nbsp;<span class="op" id="7487882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487887"><a href="/crypto/tls/tls_test.go.html#7487727">t</a></span><span class="op" id="7487888">.</span><span class="ident" id="7487889">Errorf</span><span class="op" id="7487895">(</span><span class="string" id="7487896">&#34;Failed&nbsp;to&nbsp;load&nbsp;%s&nbsp;cert&nbsp;followed&nbsp;by&nbsp;%s&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7487943">,</span>&nbsp;<span class="ident" id="7487945"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7487949">.</span><span class="ident" id="7487950">algo</span><span class="op" id="7487954">,</span>&nbsp;<span class="ident" id="7487956"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7487960">.</span><span class="ident" id="7487961">algo</span><span class="op" id="7487965">,</span>&nbsp;<span class="ident" id="7487967"><a href="/crypto/tls/tls_test.go.html#7487841">err</a></span><span class="op" id="7487970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487978"><a href="/crypto/tls/tls_test.go.html#7487748">pem</a></span>&nbsp;<span class="op" id="7487982">=</span>&nbsp;<span class="op" id="7487984">[</span><span class="op" id="7487985">]</span><span class="builtintype" id="7487986">byte</span><span class="op" id="7487990">(</span><span class="ident" id="7487991"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7487995">.</span><span class="ident" id="7487996">key</span>&nbsp;<span class="op" id="7488000">+</span>&nbsp;<span class="ident" id="7488002"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7488006">.</span><span class="ident" id="7488007">cert</span><span class="op" id="7488011">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488015">if</span>&nbsp;<span class="ident" id="7488018">_</span><span class="op" id="7488019">,</span>&nbsp;<span class="ident" id="7488021">err</span>&nbsp;<span class="op" id="7488025">:=</span>&nbsp;<span class="ident" id="7488028"><a href="/crypto/tls/tls.go.html#3968629">X509KeyPair</a></span><span class="op" id="7488039">(</span><span class="ident" id="7488040"><a href="/crypto/tls/tls_test.go.html#7487748">pem</a></span><span class="op" id="7488043">,</span>&nbsp;<span class="ident" id="7488045"><a href="/crypto/tls/tls_test.go.html#7487748">pem</a></span><span class="op" id="7488048">)</span><span class="op" id="7488049">;</span>&nbsp;<span class="ident" id="7488051"><a href="/crypto/tls/tls_test.go.html#7488021">err</a></span>&nbsp;<span class="op" id="7488055">!=</span>&nbsp;<span class="ident" id="7488058">nil</span>&nbsp;<span class="op" id="7488062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488067"><a href="/crypto/tls/tls_test.go.html#7487727">t</a></span><span class="op" id="7488068">.</span><span class="ident" id="7488069">Errorf</span><span class="op" id="7488075">(</span><span class="string" id="7488076">&#34;Failed&nbsp;to&nbsp;load&nbsp;%s&nbsp;key&nbsp;followed&nbsp;by&nbsp;%s&nbsp;cert:&nbsp;%s&#34;</span><span class="op" id="7488123">,</span>&nbsp;<span class="ident" id="7488125"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7488129">.</span><span class="ident" id="7488130">algo</span><span class="op" id="7488134">,</span>&nbsp;<span class="ident" id="7488136"><a href="/crypto/tls/tls_test.go.html#7487767">test</a></span><span class="op" id="7488140">.</span><span class="ident" id="7488141">algo</span><span class="op" id="7488145">,</span>&nbsp;<span class="ident" id="7488147"><a href="/crypto/tls/tls_test.go.html#7488021">err</a></span><span class="op" id="7488150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488157">}</span><br>
<span class="lineno"></span><span class="op" id="7488159">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7488162">func</span>&nbsp;<span class="ident" id="7488167">TestX509MixedKeyPair</span><span class="op" id="7488187">(</span><span class="ident" id="7488188">t</span>&nbsp;<span class="op" id="7488190">*</span><span class="ident" id="7488191"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7488198">.</span><span class="ident" id="7488199">T</span><span class="op" id="7488200">)</span>&nbsp;<span class="op" id="7488202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488205">if</span>&nbsp;<span class="ident" id="7488208">_</span><span class="op" id="7488209">,</span>&nbsp;<span class="ident" id="7488211">err</span>&nbsp;<span class="op" id="7488215">:=</span>&nbsp;<span class="ident" id="7488218"><a href="/crypto/tls/tls.go.html#3968629">X509KeyPair</a></span><span class="op" id="7488229">(</span><span class="op" id="7488230">[</span><span class="op" id="7488231">]</span><span class="builtintype" id="7488232">byte</span><span class="op" id="7488236">(</span><span class="ident" id="7488237"><a href="/crypto/tls/tls_test.go.html#7484395">rsaCertPEM</a></span><span class="op" id="7488247">)</span><span class="op" id="7488248">,</span>&nbsp;<span class="op" id="7488250">[</span><span class="op" id="7488251">]</span><span class="builtintype" id="7488252">byte</span><span class="op" id="7488256">(</span><span class="ident" id="7488257"><a href="/crypto/tls/tls_test.go.html#7487042">ecdsaKeyPEM</a></span><span class="op" id="7488268">)</span><span class="op" id="7488269">)</span><span class="op" id="7488270">;</span>&nbsp;<span class="ident" id="7488272"><a href="/crypto/tls/tls_test.go.html#7488211">err</a></span>&nbsp;<span class="op" id="7488276">==</span>&nbsp;<span class="ident" id="7488279">nil</span>&nbsp;<span class="op" id="7488283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488287"><a href="/crypto/tls/tls_test.go.html#7488188">t</a></span><span class="op" id="7488288">.</span><span class="ident" id="7488289">Error</span><span class="op" id="7488294">(</span><span class="string" id="7488295">&#34;Load&nbsp;of&nbsp;RSA&nbsp;certificate&nbsp;succeeded&nbsp;with&nbsp;ECDSA&nbsp;private&nbsp;key&#34;</span><span class="op" id="7488353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488356">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488359">if</span>&nbsp;<span class="ident" id="7488362">_</span><span class="op" id="7488363">,</span>&nbsp;<span class="ident" id="7488365">err</span>&nbsp;<span class="op" id="7488369">:=</span>&nbsp;<span class="ident" id="7488372"><a href="/crypto/tls/tls.go.html#3968629">X509KeyPair</a></span><span class="op" id="7488383">(</span><span class="op" id="7488384">[</span><span class="op" id="7488385">]</span><span class="builtintype" id="7488386">byte</span><span class="op" id="7488390">(</span><span class="ident" id="7488391"><a href="/crypto/tls/tls_test.go.html#7486266">ecdsaCertPEM</a></span><span class="op" id="7488403">)</span><span class="op" id="7488404">,</span>&nbsp;<span class="op" id="7488406">[</span><span class="op" id="7488407">]</span><span class="builtintype" id="7488408">byte</span><span class="op" id="7488412">(</span><span class="ident" id="7488413"><a href="/crypto/tls/tls_test.go.html#7485108">rsaKeyPEM</a></span><span class="op" id="7488422">)</span><span class="op" id="7488423">)</span><span class="op" id="7488424">;</span>&nbsp;<span class="ident" id="7488426"><a href="/crypto/tls/tls_test.go.html#7488365">err</a></span>&nbsp;<span class="op" id="7488430">==</span>&nbsp;<span class="ident" id="7488433">nil</span>&nbsp;<span class="op" id="7488437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488441"><a href="/crypto/tls/tls_test.go.html#7488188">t</a></span><span class="op" id="7488442">.</span><span class="ident" id="7488443">Error</span><span class="op" id="7488448">(</span><span class="string" id="7488449">&#34;Load&nbsp;of&nbsp;ECDSA&nbsp;certificate&nbsp;succeeded&nbsp;with&nbsp;RSA&nbsp;private&nbsp;key&#34;</span><span class="op" id="7488507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488510">}</span><br>
<span class="lineno"></span><span class="op" id="7488512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7488515">func</span>&nbsp;<span class="ident" id="7488520">newLocalListener</span><span class="op" id="7488536">(</span><span class="ident" id="7488537">t</span>&nbsp;<span class="op" id="7488539">*</span><span class="ident" id="7488540"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7488547">.</span><span class="ident" id="7488548">T</span><span class="op" id="7488549">)</span>&nbsp;<span class="ident" id="7488551"><a href="/crypto/tls/tls_test.go.html#7484352">net</a></span><span class="op" id="7488554">.</span><span class="ident" id="7488555">Listener</span>&nbsp;<span class="op" id="7488564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488567">ln</span><span class="op" id="7488569">,</span>&nbsp;<span class="ident" id="7488571">err</span>&nbsp;<span class="op" id="7488575">:=</span>&nbsp;<span class="ident" id="7488578"><a href="/crypto/tls/tls_test.go.html#7484352">net</a></span><span class="op" id="7488581">.</span><span class="ident" id="7488582">Listen</span><span class="op" id="7488588">(</span><span class="string" id="7488589">&#34;tcp&#34;</span><span class="op" id="7488594">,</span>&nbsp;<span class="string" id="7488596">&#34;127.0.0.1:0&#34;</span><span class="op" id="7488609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488612">if</span>&nbsp;<span class="ident" id="7488615"><a href="/crypto/tls/tls_test.go.html#7488571">err</a></span>&nbsp;<span class="op" id="7488619">!=</span>&nbsp;<span class="ident" id="7488622">nil</span>&nbsp;<span class="op" id="7488626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488630"><a href="/crypto/tls/tls_test.go.html#7488567">ln</a></span><span class="op" id="7488632">,</span>&nbsp;<span class="ident" id="7488634"><a href="/crypto/tls/tls_test.go.html#7488571">err</a></span>&nbsp;<span class="op" id="7488638">=</span>&nbsp;<span class="ident" id="7488640"><a href="/crypto/tls/tls_test.go.html#7484352">net</a></span><span class="op" id="7488643">.</span><span class="ident" id="7488644">Listen</span><span class="op" id="7488650">(</span><span class="string" id="7488651">&#34;tcp6&#34;</span><span class="op" id="7488657">,</span>&nbsp;<span class="string" id="7488659">&#34;[::1]:0&#34;</span><span class="op" id="7488668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488671">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488674">if</span>&nbsp;<span class="ident" id="7488677"><a href="/crypto/tls/tls_test.go.html#7488571">err</a></span>&nbsp;<span class="op" id="7488681">!=</span>&nbsp;<span class="ident" id="7488684">nil</span>&nbsp;<span class="op" id="7488688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488692"><a href="/crypto/tls/tls_test.go.html#7488537">t</a></span><span class="op" id="7488693">.</span><span class="ident" id="7488694">Fatal</span><span class="op" id="7488699">(</span><span class="ident" id="7488700"><a href="/crypto/tls/tls_test.go.html#7488571">err</a></span><span class="op" id="7488703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488709">return</span>&nbsp;<span class="ident" id="7488716"><a href="/crypto/tls/tls_test.go.html#7488567">ln</a></span><br>
<span class="lineno"></span><span class="op" id="7488719">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7488722">func</span>&nbsp;<span class="ident" id="7488727">TestDialTimeout</span><span class="op" id="7488742">(</span><span class="ident" id="7488743">t</span>&nbsp;<span class="op" id="7488745">*</span><span class="ident" id="7488746"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7488753">.</span><span class="ident" id="7488754">T</span><span class="op" id="7488755">)</span>&nbsp;<span class="op" id="7488757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488760">if</span>&nbsp;<span class="ident" id="7488763"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7488770">.</span><span class="ident" id="7488771">Short</span><span class="op" id="7488776">(</span><span class="op" id="7488777">)</span>&nbsp;<span class="op" id="7488779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488783"><a href="/crypto/tls/tls_test.go.html#7488743">t</a></span><span class="op" id="7488784">.</span><span class="ident" id="7488785">Skip</span><span class="op" id="7488789">(</span><span class="string" id="7488790">&#34;skipping&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7488814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488817">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488820">listener</span>&nbsp;<span class="op" id="7488829">:=</span>&nbsp;<span class="ident" id="7488832"><a href="/crypto/tls/tls_test.go.html#7488520">newLocalListener</a></span><span class="op" id="7488848">(</span><span class="ident" id="7488849"><a href="/crypto/tls/tls_test.go.html#7488743">t</a></span><span class="op" id="7488850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488854">addr</span>&nbsp;<span class="op" id="7488859">:=</span>&nbsp;<span class="ident" id="7488862"><a href="/crypto/tls/tls_test.go.html#7488820">listener</a></span><span class="op" id="7488870">.</span><span class="ident" id="7488871">Addr</span><span class="op" id="7488875">(</span><span class="op" id="7488876">)</span><span class="op" id="7488877">.</span><span class="ident" id="7488878">String</span><span class="op" id="7488884">(</span><span class="op" id="7488885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488888">defer</span>&nbsp;<span class="ident" id="7488894"><a href="/crypto/tls/tls_test.go.html#7488820">listener</a></span><span class="op" id="7488902">.</span><span class="ident" id="7488903">Close</span><span class="op" id="7488908">(</span><span class="op" id="7488909">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488913">complete</span>&nbsp;<span class="op" id="7488922">:=</span>&nbsp;<span class="builtinfunc" id="7488925">make</span><span class="op" id="7488929">(</span><span class="keyword" id="7488930">chan</span>&nbsp;<span class="builtintype" id="7488935">bool</span><span class="op" id="7488939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488942">defer</span>&nbsp;<span class="builtinfunc" id="7488948">close</span><span class="op" id="7488953">(</span><span class="ident" id="7488954"><a href="/crypto/tls/tls_test.go.html#7488913">complete</a></span><span class="op" id="7488962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488966">go</span>&nbsp;<span class="keyword" id="7488969">func</span><span class="op" id="7488973">(</span><span class="op" id="7488974">)</span>&nbsp;<span class="op" id="7488976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488980">conn</span><span class="op" id="7488984">,</span>&nbsp;<span class="ident" id="7488986">err</span>&nbsp;<span class="op" id="7488990">:=</span>&nbsp;<span class="ident" id="7488993"><a href="/crypto/tls/tls_test.go.html#7488820">listener</a></span><span class="op" id="7489001">.</span><span class="ident" id="7489002">Accept</span><span class="op" id="7489008">(</span><span class="op" id="7489009">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489013">if</span>&nbsp;<span class="ident" id="7489016"><a href="/crypto/tls/tls_test.go.html#7488986">err</a></span>&nbsp;<span class="op" id="7489020">!=</span>&nbsp;<span class="ident" id="7489023">nil</span>&nbsp;<span class="op" id="7489027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489032"><a href="/crypto/tls/tls_test.go.html#7488743">t</a></span><span class="op" id="7489033">.</span><span class="ident" id="7489034">Error</span><span class="op" id="7489039">(</span><span class="ident" id="7489040"><a href="/crypto/tls/tls_test.go.html#7488986">err</a></span><span class="op" id="7489043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489048">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489061">&lt;-</span><span class="ident" id="7489063"><a href="/crypto/tls/tls_test.go.html#7488913">complete</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489074"><a href="/crypto/tls/tls_test.go.html#7488980">conn</a></span><span class="op" id="7489078">.</span><span class="ident" id="7489079">Close</span><span class="op" id="7489084">(</span><span class="op" id="7489085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489088">}</span><span class="op" id="7489089">(</span><span class="op" id="7489090">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489094">dialer</span>&nbsp;<span class="op" id="7489101">:=</span>&nbsp;<span class="op" id="7489104">&amp;</span><span class="ident" id="7489105"><a href="/crypto/tls/tls_test.go.html#7484352">net</a></span><span class="op" id="7489108">.</span><span class="ident" id="7489109">Dialer</span><span class="op" id="7489115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489119">Timeout</span><span class="op" id="7489126">:</span>&nbsp;<span class="num" id="7489128">10</span>&nbsp;<span class="op" id="7489131">*</span>&nbsp;<span class="ident" id="7489133"><a href="/crypto/tls/tls_test.go.html#7484381">time</a></span><span class="op" id="7489137">.</span><span class="ident" id="7489138">Millisecond</span><span class="op" id="7489149">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489156">var</span>&nbsp;<span class="ident" id="7489160">err</span>&nbsp;<span class="builtintype" id="7489164">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489171">if</span>&nbsp;<span class="ident" id="7489174">_</span><span class="op" id="7489175">,</span>&nbsp;<span class="ident" id="7489177"><a href="/crypto/tls/tls_test.go.html#7489160">err</a></span>&nbsp;<span class="op" id="7489181">=</span>&nbsp;<span class="ident" id="7489183"><a href="/crypto/tls/tls.go.html#3966353">DialWithDialer</a></span><span class="op" id="7489197">(</span><span class="ident" id="7489198"><a href="/crypto/tls/tls_test.go.html#7489094">dialer</a></span><span class="op" id="7489204">,</span>&nbsp;<span class="string" id="7489206">&#34;tcp&#34;</span><span class="op" id="7489211">,</span>&nbsp;<span class="ident" id="7489213"><a href="/crypto/tls/tls_test.go.html#7488854">addr</a></span><span class="op" id="7489217">,</span>&nbsp;<span class="ident" id="7489219">nil</span><span class="op" id="7489222">)</span><span class="op" id="7489223">;</span>&nbsp;<span class="ident" id="7489225"><a href="/crypto/tls/tls_test.go.html#7489160">err</a></span>&nbsp;<span class="op" id="7489229">==</span>&nbsp;<span class="ident" id="7489232">nil</span>&nbsp;<span class="op" id="7489236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489240"><a href="/crypto/tls/tls_test.go.html#7488743">t</a></span><span class="op" id="7489241">.</span><span class="ident" id="7489242">Fatal</span><span class="op" id="7489247">(</span><span class="string" id="7489248">&#34;DialWithTimeout&nbsp;completed&nbsp;successfully&#34;</span><span class="op" id="7489288">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489295">if</span>&nbsp;<span class="op" id="7489298">!</span><span class="ident" id="7489299"><a href="/crypto/tls/tls_test.go.html#7484359">strings</a></span><span class="op" id="7489306">.</span><span class="ident" id="7489307">Contains</span><span class="op" id="7489315">(</span><span class="ident" id="7489316"><a href="/crypto/tls/tls_test.go.html#7489160">err</a></span><span class="op" id="7489319">.</span><span class="ident" id="7489320">Error</span><span class="op" id="7489325">(</span><span class="op" id="7489326">)</span><span class="op" id="7489327">,</span>&nbsp;<span class="string" id="7489329">&#34;timed&nbsp;out&#34;</span><span class="op" id="7489340">)</span>&nbsp;<span class="op" id="7489342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489346"><a href="/crypto/tls/tls_test.go.html#7488743">t</a></span><span class="op" id="7489347">.</span><span class="ident" id="7489348">Errorf</span><span class="op" id="7489354">(</span><span class="string" id="7489355">&#34;resulting&nbsp;error&nbsp;not&nbsp;a&nbsp;timeout:&nbsp;%s&#34;</span><span class="op" id="7489390">,</span>&nbsp;<span class="ident" id="7489392"><a href="/crypto/tls/tls_test.go.html#7489160">err</a></span><span class="op" id="7489395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489398">}</span><br>
<span class="lineno">160</span><span class="op" id="7489400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7489403">//&nbsp;tests&nbsp;that&nbsp;Conn.Read&nbsp;returns&nbsp;(non-zero,&nbsp;io.EOF)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="7489465">//&nbsp;(non-zero,&nbsp;nil)&nbsp;when&nbsp;a&nbsp;Close&nbsp;(alertCloseNotify)&nbsp;is&nbsp;sitting&nbsp;right</span><br>
<span class="lineno"></span><span class="comment" id="7489533">//&nbsp;behind&nbsp;the&nbsp;application&nbsp;data&nbsp;in&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno">165</span><span class="keyword" id="7489579">func</span>&nbsp;<span class="ident" id="7489584">TestConnReadNonzeroAndEOF</span><span class="op" id="7489609">(</span><span class="ident" id="7489610">t</span>&nbsp;<span class="op" id="7489612">*</span><span class="ident" id="7489613"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7489620">.</span><span class="ident" id="7489621">T</span><span class="op" id="7489622">)</span>&nbsp;<span class="op" id="7489624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7489627">//&nbsp;This&nbsp;test&nbsp;is&nbsp;racy:&nbsp;it&nbsp;assumes&nbsp;that&nbsp;after&nbsp;a&nbsp;write&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7489685">//&nbsp;localhost&nbsp;TCP&nbsp;connection,&nbsp;the&nbsp;peer&nbsp;TCP&nbsp;connection&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7489743">//&nbsp;immediately&nbsp;read&nbsp;it.&nbsp;&nbsp;Because&nbsp;it&#39;s&nbsp;racy,&nbsp;we&nbsp;skip&nbsp;this&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7489806">//&nbsp;in&nbsp;short&nbsp;mode,&nbsp;and&nbsp;then&nbsp;retry&nbsp;it&nbsp;several&nbsp;times&nbsp;with&nbsp;an</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7489865">//&nbsp;increasing&nbsp;sleep&nbsp;in&nbsp;between&nbsp;our&nbsp;final&nbsp;write&nbsp;(via&nbsp;srv.Close</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7489928">//&nbsp;below)&nbsp;and&nbsp;the&nbsp;following&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489963">if</span>&nbsp;<span class="ident" id="7489966"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7489973">.</span><span class="ident" id="7489974">Short</span><span class="op" id="7489979">(</span><span class="op" id="7489980">)</span>&nbsp;<span class="op" id="7489982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489986"><a href="/crypto/tls/tls_test.go.html#7489610">t</a></span><span class="op" id="7489987">.</span><span class="ident" id="7489988">Skip</span><span class="op" id="7489992">(</span><span class="string" id="7489993">&#34;skipping&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7490017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490020">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490023">var</span>&nbsp;<span class="ident" id="7490027">err</span>&nbsp;<span class="builtintype" id="7490031">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490038">for</span>&nbsp;<span class="ident" id="7490042">delay</span>&nbsp;<span class="op" id="7490048">:=</span>&nbsp;<span class="ident" id="7490051"><a href="/crypto/tls/tls_test.go.html#7484381">time</a></span><span class="op" id="7490055">.</span><span class="ident" id="7490056">Millisecond</span><span class="op" id="7490067">;</span>&nbsp;<span class="ident" id="7490069"><a href="/crypto/tls/tls_test.go.html#7490042">delay</a></span>&nbsp;<span class="op" id="7490075">&lt;=</span>&nbsp;<span class="num" id="7490078">64</span><span class="op" id="7490080">*</span><span class="ident" id="7490081"><a href="/crypto/tls/tls_test.go.html#7484381">time</a></span><span class="op" id="7490085">.</span><span class="ident" id="7490086">Millisecond</span><span class="op" id="7490097">;</span>&nbsp;<span class="ident" id="7490099"><a href="/crypto/tls/tls_test.go.html#7490042">delay</a></span>&nbsp;<span class="op" id="7490105">*=</span>&nbsp;<span class="num" id="7490108">2</span>&nbsp;<span class="op" id="7490110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490114">if</span>&nbsp;<span class="ident" id="7490117"><a href="/crypto/tls/tls_test.go.html#7490027">err</a></span>&nbsp;<span class="op" id="7490121">=</span>&nbsp;<span class="ident" id="7490123"><a href="/crypto/tls/tls_test.go.html#7490212">testConnReadNonzeroAndEOF</a></span><span class="op" id="7490148">(</span><span class="ident" id="7490149"><a href="/crypto/tls/tls_test.go.html#7489610">t</a></span><span class="op" id="7490150">,</span>&nbsp;<span class="ident" id="7490152"><a href="/crypto/tls/tls_test.go.html#7490042">delay</a></span><span class="op" id="7490157">)</span><span class="op" id="7490158">;</span>&nbsp;<span class="ident" id="7490160"><a href="/crypto/tls/tls_test.go.html#7490027">err</a></span>&nbsp;<span class="op" id="7490164">==</span>&nbsp;<span class="ident" id="7490167">nil</span>&nbsp;<span class="op" id="7490171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490185">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490191"><a href="/crypto/tls/tls_test.go.html#7489610">t</a></span><span class="op" id="7490192">.</span><span class="ident" id="7490193">Error</span><span class="op" id="7490198">(</span><span class="ident" id="7490199"><a href="/crypto/tls/tls_test.go.html#7490027">err</a></span><span class="op" id="7490202">)</span><br>
<span class="lineno"></span><span class="op" id="7490204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7490207">func</span>&nbsp;<span class="ident" id="7490212">testConnReadNonzeroAndEOF</span><span class="op" id="7490237">(</span><span class="ident" id="7490238">t</span>&nbsp;<span class="op" id="7490240">*</span><span class="ident" id="7490241"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7490248">.</span><span class="ident" id="7490249">T</span><span class="op" id="7490250">,</span>&nbsp;<span class="ident" id="7490252">delay</span>&nbsp;<span class="ident" id="7490258"><a href="/crypto/tls/tls_test.go.html#7484381">time</a></span><span class="op" id="7490262">.</span><span class="ident" id="7490263">Duration</span><span class="op" id="7490271">)</span>&nbsp;<span class="builtintype" id="7490273">error</span>&nbsp;<span class="op" id="7490279">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490282">ln</span>&nbsp;<span class="op" id="7490285">:=</span>&nbsp;<span class="ident" id="7490288"><a href="/crypto/tls/tls_test.go.html#7488520">newLocalListener</a></span><span class="op" id="7490304">(</span><span class="ident" id="7490305"><a href="/crypto/tls/tls_test.go.html#7490238">t</a></span><span class="op" id="7490306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490309">defer</span>&nbsp;<span class="ident" id="7490315"><a href="/crypto/tls/tls_test.go.html#7490282">ln</a></span><span class="op" id="7490317">.</span><span class="ident" id="7490318">Close</span><span class="op" id="7490323">(</span><span class="op" id="7490324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490328">srvCh</span>&nbsp;<span class="op" id="7490334">:=</span>&nbsp;<span class="builtinfunc" id="7490337">make</span><span class="op" id="7490341">(</span><span class="keyword" id="7490342">chan</span>&nbsp;<span class="op" id="7490347">*</span><span class="ident" id="7490348"><a href="/crypto/tls/conn.go.html#3842235">Conn</a></span><span class="op" id="7490352">,</span>&nbsp;<span class="num" id="7490354">1</span><span class="op" id="7490355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490358">var</span>&nbsp;<span class="ident" id="7490362">serr</span>&nbsp;<span class="builtintype" id="7490367">error</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490374">go</span>&nbsp;<span class="keyword" id="7490377">func</span><span class="op" id="7490381">(</span><span class="op" id="7490382">)</span>&nbsp;<span class="op" id="7490384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490388">sconn</span><span class="op" id="7490393">,</span>&nbsp;<span class="ident" id="7490395">err</span>&nbsp;<span class="op" id="7490399">:=</span>&nbsp;<span class="ident" id="7490402"><a href="/crypto/tls/tls_test.go.html#7490282">ln</a></span><span class="op" id="7490404">.</span><span class="ident" id="7490405">Accept</span><span class="op" id="7490411">(</span><span class="op" id="7490412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490416">if</span>&nbsp;<span class="ident" id="7490419"><a href="/crypto/tls/tls_test.go.html#7490395">err</a></span>&nbsp;<span class="op" id="7490423">!=</span>&nbsp;<span class="ident" id="7490426">nil</span>&nbsp;<span class="op" id="7490430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490435"><a href="/crypto/tls/tls_test.go.html#7490362">serr</a></span>&nbsp;<span class="op" id="7490440">=</span>&nbsp;<span class="ident" id="7490442"><a href="/crypto/tls/tls_test.go.html#7490395">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490449"><a href="/crypto/tls/tls_test.go.html#7490328">srvCh</a></span>&nbsp;<span class="op" id="7490455">&lt;-</span>&nbsp;<span class="ident" id="7490458">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490465">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490478">serverConfig</span>&nbsp;<span class="op" id="7490491">:=</span>&nbsp;<span class="op" id="7490494">*</span><span class="ident" id="7490495"><a href="/crypto/tls/handshake_server_test.go.html#7444411">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490508">srv</span>&nbsp;<span class="op" id="7490512">:=</span>&nbsp;<span class="ident" id="7490515"><a href="/crypto/tls/tls.go.html#3964076">Server</a></span><span class="op" id="7490521">(</span><span class="ident" id="7490522"><a href="/crypto/tls/tls_test.go.html#7490388">sconn</a></span><span class="op" id="7490527">,</span>&nbsp;<span class="op" id="7490529">&amp;</span><span class="ident" id="7490530"><a href="/crypto/tls/tls_test.go.html#7490478">serverConfig</a></span><span class="op" id="7490542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490546">if</span>&nbsp;<span class="ident" id="7490549">err</span>&nbsp;<span class="op" id="7490553">:=</span>&nbsp;<span class="ident" id="7490556"><a href="/crypto/tls/tls_test.go.html#7490508">srv</a></span><span class="op" id="7490559">.</span><span class="ident" id="7490560">Handshake</span><span class="op" id="7490569">(</span><span class="op" id="7490570">)</span><span class="op" id="7490571">;</span>&nbsp;<span class="ident" id="7490573"><a href="/crypto/tls/tls_test.go.html#7490549">err</a></span>&nbsp;<span class="op" id="7490577">!=</span>&nbsp;<span class="ident" id="7490580">nil</span>&nbsp;<span class="op" id="7490584">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490589"><a href="/crypto/tls/tls_test.go.html#7490362">serr</a></span>&nbsp;<span class="op" id="7490594">=</span>&nbsp;<span class="ident" id="7490596"><a href="/crypto/tls/tls_test.go.html#7484339">fmt</a></span><span class="op" id="7490599">.</span><span class="ident" id="7490600">Errorf</span><span class="op" id="7490606">(</span><span class="string" id="7490607">&#34;handshake:&nbsp;%v&#34;</span><span class="op" id="7490622">,</span>&nbsp;<span class="ident" id="7490624"><a href="/crypto/tls/tls_test.go.html#7490549">err</a></span><span class="op" id="7490627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490632"><a href="/crypto/tls/tls_test.go.html#7490328">srvCh</a></span>&nbsp;<span class="op" id="7490638">&lt;-</span>&nbsp;<span class="ident" id="7490641">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490648">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490661"><a href="/crypto/tls/tls_test.go.html#7490328">srvCh</a></span>&nbsp;<span class="op" id="7490667">&lt;-</span>&nbsp;<span class="ident" id="7490670"><a href="/crypto/tls/tls_test.go.html#7490508">srv</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490675">}</span><span class="op" id="7490676">(</span><span class="op" id="7490677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490681">clientConfig</span>&nbsp;<span class="op" id="7490694">:=</span>&nbsp;<span class="op" id="7490697">*</span><span class="ident" id="7490698"><a href="/crypto/tls/handshake_server_test.go.html#7444411">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490710">conn</span><span class="op" id="7490714">,</span>&nbsp;<span class="ident" id="7490716">err</span>&nbsp;<span class="op" id="7490720">:=</span>&nbsp;<span class="ident" id="7490723"><a href="/crypto/tls/tls.go.html#3968005">Dial</a></span><span class="op" id="7490727">(</span><span class="string" id="7490728">&#34;tcp&#34;</span><span class="op" id="7490733">,</span>&nbsp;<span class="ident" id="7490735"><a href="/crypto/tls/tls_test.go.html#7490282">ln</a></span><span class="op" id="7490737">.</span><span class="ident" id="7490738">Addr</span><span class="op" id="7490742">(</span><span class="op" id="7490743">)</span><span class="op" id="7490744">.</span><span class="ident" id="7490745">String</span><span class="op" id="7490751">(</span><span class="op" id="7490752">)</span><span class="op" id="7490753">,</span>&nbsp;<span class="op" id="7490755">&amp;</span><span class="ident" id="7490756"><a href="/crypto/tls/tls_test.go.html#7490681">clientConfig</a></span><span class="op" id="7490768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490771">if</span>&nbsp;<span class="ident" id="7490774"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span>&nbsp;<span class="op" id="7490778">!=</span>&nbsp;<span class="ident" id="7490781">nil</span>&nbsp;<span class="op" id="7490785">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490789"><a href="/crypto/tls/tls_test.go.html#7490238">t</a></span><span class="op" id="7490790">.</span><span class="ident" id="7490791">Fatal</span><span class="op" id="7490796">(</span><span class="ident" id="7490797"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span><span class="op" id="7490800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490806">defer</span>&nbsp;<span class="ident" id="7490812"><a href="/crypto/tls/tls_test.go.html#7490710">conn</a></span><span class="op" id="7490816">.</span><span class="ident" id="7490817">Close</span><span class="op" id="7490822">(</span><span class="op" id="7490823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490827">srv</span>&nbsp;<span class="op" id="7490831">:=</span>&nbsp;<span class="op" id="7490834">&lt;-</span><span class="ident" id="7490836"><a href="/crypto/tls/tls_test.go.html#7490328">srvCh</a></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490843">if</span>&nbsp;<span class="ident" id="7490846"><a href="/crypto/tls/tls_test.go.html#7490827">srv</a></span>&nbsp;<span class="op" id="7490850">==</span>&nbsp;<span class="ident" id="7490853">nil</span>&nbsp;<span class="op" id="7490857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490861">return</span>&nbsp;<span class="ident" id="7490868"><a href="/crypto/tls/tls_test.go.html#7490362">serr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490878">buf</span>&nbsp;<span class="op" id="7490882">:=</span>&nbsp;<span class="builtinfunc" id="7490885">make</span><span class="op" id="7490889">(</span><span class="op" id="7490890">[</span><span class="op" id="7490891">]</span><span class="builtintype" id="7490892">byte</span><span class="op" id="7490896">,</span>&nbsp;<span class="num" id="7490898">6</span><span class="op" id="7490899">)</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490903"><a href="/crypto/tls/tls_test.go.html#7490827">srv</a></span><span class="op" id="7490906">.</span><span class="ident" id="7490907">Write</span><span class="op" id="7490912">(</span><span class="op" id="7490913">[</span><span class="op" id="7490914">]</span><span class="builtintype" id="7490915">byte</span><span class="op" id="7490919">(</span><span class="string" id="7490920">&#34;foobar&#34;</span><span class="op" id="7490928">)</span><span class="op" id="7490929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7490932">n</span><span class="op" id="7490933">,</span>&nbsp;<span class="ident" id="7490935"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span>&nbsp;<span class="op" id="7490939">:=</span>&nbsp;<span class="ident" id="7490942"><a href="/crypto/tls/tls_test.go.html#7490710">conn</a></span><span class="op" id="7490946">.</span><span class="ident" id="7490947">Read</span><span class="op" id="7490951">(</span><span class="ident" id="7490952"><a href="/crypto/tls/tls_test.go.html#7490878">buf</a></span><span class="op" id="7490955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7490958">if</span>&nbsp;<span class="ident" id="7490961"><a href="/crypto/tls/tls_test.go.html#7490932">n</a></span>&nbsp;<span class="op" id="7490963">!=</span>&nbsp;<span class="num" id="7490966">6</span>&nbsp;<span class="op" id="7490968">||</span>&nbsp;<span class="ident" id="7490971"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span>&nbsp;<span class="op" id="7490975">!=</span>&nbsp;<span class="ident" id="7490978">nil</span>&nbsp;<span class="op" id="7490982">||</span>&nbsp;<span class="builtintype" id="7490985">string</span><span class="op" id="7490991">(</span><span class="ident" id="7490992"><a href="/crypto/tls/tls_test.go.html#7490878">buf</a></span><span class="op" id="7490995">)</span>&nbsp;<span class="op" id="7490997">!=</span>&nbsp;<span class="string" id="7491000">&#34;foobar&#34;</span>&nbsp;<span class="op" id="7491009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491013">return</span>&nbsp;<span class="ident" id="7491020"><a href="/crypto/tls/tls_test.go.html#7484339">fmt</a></span><span class="op" id="7491023">.</span><span class="ident" id="7491024">Errorf</span><span class="op" id="7491030">(</span><span class="string" id="7491031">&#34;Read&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;data&nbsp;%q;&nbsp;want&nbsp;6,&nbsp;nil,&nbsp;foobar&#34;</span><span class="op" id="7491076">,</span>&nbsp;<span class="ident" id="7491078"><a href="/crypto/tls/tls_test.go.html#7490932">n</a></span><span class="op" id="7491079">,</span>&nbsp;<span class="ident" id="7491081"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span><span class="op" id="7491084">,</span>&nbsp;<span class="ident" id="7491086"><a href="/crypto/tls/tls_test.go.html#7490878">buf</a></span><span class="op" id="7491089">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491096"><a href="/crypto/tls/tls_test.go.html#7490827">srv</a></span><span class="op" id="7491099">.</span><span class="ident" id="7491100">Write</span><span class="op" id="7491105">(</span><span class="op" id="7491106">[</span><span class="op" id="7491107">]</span><span class="builtintype" id="7491108">byte</span><span class="op" id="7491112">(</span><span class="string" id="7491113">&#34;abcdef&#34;</span><span class="op" id="7491121">)</span><span class="op" id="7491122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491125"><a href="/crypto/tls/tls_test.go.html#7490827">srv</a></span><span class="op" id="7491128">.</span><span class="ident" id="7491129">Close</span><span class="op" id="7491134">(</span><span class="op" id="7491135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491138"><a href="/crypto/tls/tls_test.go.html#7484381">time</a></span><span class="op" id="7491142">.</span><span class="ident" id="7491143">Sleep</span><span class="op" id="7491148">(</span><span class="ident" id="7491149"><a href="/crypto/tls/tls_test.go.html#7490252">delay</a></span><span class="op" id="7491154">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491157"><a href="/crypto/tls/tls_test.go.html#7490932">n</a></span><span class="op" id="7491158">,</span>&nbsp;<span class="ident" id="7491160"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span>&nbsp;<span class="op" id="7491164">=</span>&nbsp;<span class="ident" id="7491166"><a href="/crypto/tls/tls_test.go.html#7490710">conn</a></span><span class="op" id="7491170">.</span><span class="ident" id="7491171">Read</span><span class="op" id="7491175">(</span><span class="ident" id="7491176"><a href="/crypto/tls/tls_test.go.html#7490878">buf</a></span><span class="op" id="7491179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491182">if</span>&nbsp;<span class="ident" id="7491185"><a href="/crypto/tls/tls_test.go.html#7490932">n</a></span>&nbsp;<span class="op" id="7491187">!=</span>&nbsp;<span class="num" id="7491190">6</span>&nbsp;<span class="op" id="7491192">||</span>&nbsp;<span class="builtintype" id="7491195">string</span><span class="op" id="7491201">(</span><span class="ident" id="7491202"><a href="/crypto/tls/tls_test.go.html#7490878">buf</a></span><span class="op" id="7491205">)</span>&nbsp;<span class="op" id="7491207">!=</span>&nbsp;<span class="string" id="7491210">&#34;abcdef&#34;</span>&nbsp;<span class="op" id="7491219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491223">return</span>&nbsp;<span class="ident" id="7491230"><a href="/crypto/tls/tls_test.go.html#7484339">fmt</a></span><span class="op" id="7491233">.</span><span class="ident" id="7491234">Errorf</span><span class="op" id="7491240">(</span><span class="string" id="7491241">&#34;Read&nbsp;=&nbsp;%d,&nbsp;buf=&nbsp;%q;&nbsp;want&nbsp;6,&nbsp;abcdef&#34;</span><span class="op" id="7491277">,</span>&nbsp;<span class="ident" id="7491279"><a href="/crypto/tls/tls_test.go.html#7490932">n</a></span><span class="op" id="7491280">,</span>&nbsp;<span class="ident" id="7491282"><a href="/crypto/tls/tls_test.go.html#7490878">buf</a></span><span class="op" id="7491285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491291">if</span>&nbsp;<span class="ident" id="7491294"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span>&nbsp;<span class="op" id="7491298">!=</span>&nbsp;<span class="ident" id="7491301"><a href="/crypto/tls/tls_test.go.html#7484346">io</a></span><span class="op" id="7491303">.</span><span class="ident" id="7491304">EOF</span>&nbsp;<span class="op" id="7491308">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491312">return</span>&nbsp;<span class="ident" id="7491319"><a href="/crypto/tls/tls_test.go.html#7484339">fmt</a></span><span class="op" id="7491322">.</span><span class="ident" id="7491323">Errorf</span><span class="op" id="7491329">(</span><span class="string" id="7491330">&#34;Second&nbsp;Read&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.EOF&#34;</span><span class="op" id="7491367">,</span>&nbsp;<span class="ident" id="7491369"><a href="/crypto/tls/tls_test.go.html#7490716">err</a></span><span class="op" id="7491372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491378">return</span>&nbsp;<span class="ident" id="7491385">nil</span><br>
<span class="lineno"></span><span class="op" id="7491389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7491392">func</span>&nbsp;<span class="ident" id="7491397">TestTLSUniqueMatches</span><span class="op" id="7491417">(</span><span class="ident" id="7491418">t</span>&nbsp;<span class="op" id="7491420">*</span><span class="ident" id="7491421"><a href="/crypto/tls/tls_test.go.html#7484370">testing</a></span><span class="op" id="7491428">.</span><span class="ident" id="7491429">T</span><span class="op" id="7491430">)</span>&nbsp;<span class="op" id="7491432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491435">ln</span>&nbsp;<span class="op" id="7491438">:=</span>&nbsp;<span class="ident" id="7491441"><a href="/crypto/tls/tls_test.go.html#7488520">newLocalListener</a></span><span class="op" id="7491457">(</span><span class="ident" id="7491458"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7491459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491462">defer</span>&nbsp;<span class="ident" id="7491468"><a href="/crypto/tls/tls_test.go.html#7491435">ln</a></span><span class="op" id="7491470">.</span><span class="ident" id="7491471">Close</span><span class="op" id="7491476">(</span><span class="op" id="7491477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491481">serverTLSUniques</span>&nbsp;<span class="op" id="7491498">:=</span>&nbsp;<span class="builtinfunc" id="7491501">make</span><span class="op" id="7491505">(</span><span class="keyword" id="7491506">chan</span>&nbsp;<span class="op" id="7491511">[</span><span class="op" id="7491512">]</span><span class="builtintype" id="7491513">byte</span><span class="op" id="7491517">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491520">go</span>&nbsp;<span class="keyword" id="7491523">func</span><span class="op" id="7491527">(</span><span class="op" id="7491528">)</span>&nbsp;<span class="op" id="7491530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491534">for</span>&nbsp;<span class="ident" id="7491538">i</span>&nbsp;<span class="op" id="7491540">:=</span>&nbsp;<span class="num" id="7491543">0</span><span class="op" id="7491544">;</span>&nbsp;<span class="ident" id="7491546"><a href="/crypto/tls/tls_test.go.html#7491538">i</a></span>&nbsp;<span class="op" id="7491548">&lt;</span>&nbsp;<span class="num" id="7491550">2</span><span class="op" id="7491551">;</span>&nbsp;<span class="ident" id="7491553"><a href="/crypto/tls/tls_test.go.html#7491538">i</a></span><span class="op" id="7491554">++</span>&nbsp;<span class="op" id="7491557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491562">sconn</span><span class="op" id="7491567">,</span>&nbsp;<span class="ident" id="7491569">err</span>&nbsp;<span class="op" id="7491573">:=</span>&nbsp;<span class="ident" id="7491576"><a href="/crypto/tls/tls_test.go.html#7491435">ln</a></span><span class="op" id="7491578">.</span><span class="ident" id="7491579">Accept</span><span class="op" id="7491585">(</span><span class="op" id="7491586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491591">if</span>&nbsp;<span class="ident" id="7491594"><a href="/crypto/tls/tls_test.go.html#7491569">err</a></span>&nbsp;<span class="op" id="7491598">!=</span>&nbsp;<span class="ident" id="7491601">nil</span>&nbsp;<span class="op" id="7491605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491611"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7491612">.</span><span class="ident" id="7491613">Fatal</span><span class="op" id="7491618">(</span><span class="ident" id="7491619"><a href="/crypto/tls/tls_test.go.html#7491569">err</a></span><span class="op" id="7491622">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491632">serverConfig</span>&nbsp;<span class="op" id="7491645">:=</span>&nbsp;<span class="op" id="7491648">*</span><span class="ident" id="7491649"><a href="/crypto/tls/handshake_server_test.go.html#7444411">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491663">srv</span>&nbsp;<span class="op" id="7491667">:=</span>&nbsp;<span class="ident" id="7491670"><a href="/crypto/tls/tls.go.html#3964076">Server</a></span><span class="op" id="7491676">(</span><span class="ident" id="7491677"><a href="/crypto/tls/tls_test.go.html#7491562">sconn</a></span><span class="op" id="7491682">,</span>&nbsp;<span class="op" id="7491684">&amp;</span><span class="ident" id="7491685"><a href="/crypto/tls/tls_test.go.html#7491632">serverConfig</a></span><span class="op" id="7491697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491702">if</span>&nbsp;<span class="ident" id="7491705">err</span>&nbsp;<span class="op" id="7491709">:=</span>&nbsp;<span class="ident" id="7491712"><a href="/crypto/tls/tls_test.go.html#7491663">srv</a></span><span class="op" id="7491715">.</span><span class="ident" id="7491716">Handshake</span><span class="op" id="7491725">(</span><span class="op" id="7491726">)</span><span class="op" id="7491727">;</span>&nbsp;<span class="ident" id="7491729"><a href="/crypto/tls/tls_test.go.html#7491705">err</a></span>&nbsp;<span class="op" id="7491733">!=</span>&nbsp;<span class="ident" id="7491736">nil</span>&nbsp;<span class="op" id="7491740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491746"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7491747">.</span><span class="ident" id="7491748">Fatal</span><span class="op" id="7491753">(</span><span class="ident" id="7491754"><a href="/crypto/tls/tls_test.go.html#7491705">err</a></span><span class="op" id="7491757">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491767"><a href="/crypto/tls/tls_test.go.html#7491481">serverTLSUniques</a></span>&nbsp;<span class="op" id="7491784">&lt;-</span>&nbsp;<span class="ident" id="7491787"><a href="/crypto/tls/tls_test.go.html#7491663">srv</a></span><span class="op" id="7491790">.</span><span class="ident" id="7491791">ConnectionState</span><span class="op" id="7491806">(</span><span class="op" id="7491807">)</span><span class="op" id="7491808">.</span><span class="ident" id="7491809">TLSUnique</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491824">}</span><span class="op" id="7491825">(</span><span class="op" id="7491826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491830">clientConfig</span>&nbsp;<span class="op" id="7491843">:=</span>&nbsp;<span class="op" id="7491846">*</span><span class="ident" id="7491847"><a href="/crypto/tls/handshake_server_test.go.html#7444411">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491859"><a href="/crypto/tls/tls_test.go.html#7491830">clientConfig</a></span><span class="op" id="7491871">.</span><span class="ident" id="7491872">ClientSessionCache</span>&nbsp;<span class="op" id="7491891">=</span>&nbsp;<span class="ident" id="7491893"><a href="/crypto/tls/common.go.html#3839758">NewLRUClientSessionCache</a></span><span class="op" id="7491917">(</span><span class="num" id="7491918">1</span><span class="op" id="7491919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491922">conn</span><span class="op" id="7491926">,</span>&nbsp;<span class="ident" id="7491928">err</span>&nbsp;<span class="op" id="7491932">:=</span>&nbsp;<span class="ident" id="7491935"><a href="/crypto/tls/tls.go.html#3968005">Dial</a></span><span class="op" id="7491939">(</span><span class="string" id="7491940">&#34;tcp&#34;</span><span class="op" id="7491945">,</span>&nbsp;<span class="ident" id="7491947"><a href="/crypto/tls/tls_test.go.html#7491435">ln</a></span><span class="op" id="7491949">.</span><span class="ident" id="7491950">Addr</span><span class="op" id="7491954">(</span><span class="op" id="7491955">)</span><span class="op" id="7491956">.</span><span class="ident" id="7491957">String</span><span class="op" id="7491963">(</span><span class="op" id="7491964">)</span><span class="op" id="7491965">,</span>&nbsp;<span class="op" id="7491967">&amp;</span><span class="ident" id="7491968"><a href="/crypto/tls/tls_test.go.html#7491830">clientConfig</a></span><span class="op" id="7491980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491983">if</span>&nbsp;<span class="ident" id="7491986"><a href="/crypto/tls/tls_test.go.html#7491928">err</a></span>&nbsp;<span class="op" id="7491990">!=</span>&nbsp;<span class="ident" id="7491993">nil</span>&nbsp;<span class="op" id="7491997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492001"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7492002">.</span><span class="ident" id="7492003">Fatal</span><span class="op" id="7492008">(</span><span class="ident" id="7492009"><a href="/crypto/tls/tls_test.go.html#7491928">err</a></span><span class="op" id="7492012">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492018">if</span>&nbsp;<span class="op" id="7492021">!</span><span class="ident" id="7492022"><a href="/crypto/tls/tls_test.go.html#7484330">bytes</a></span><span class="op" id="7492027">.</span><span class="ident" id="7492028">Equal</span><span class="op" id="7492033">(</span><span class="ident" id="7492034"><a href="/crypto/tls/tls_test.go.html#7491922">conn</a></span><span class="op" id="7492038">.</span><span class="ident" id="7492039">ConnectionState</span><span class="op" id="7492054">(</span><span class="op" id="7492055">)</span><span class="op" id="7492056">.</span><span class="ident" id="7492057">TLSUnique</span><span class="op" id="7492066">,</span>&nbsp;<span class="op" id="7492068">&lt;-</span><span class="ident" id="7492070"><a href="/crypto/tls/tls_test.go.html#7491481">serverTLSUniques</a></span><span class="op" id="7492086">)</span>&nbsp;<span class="op" id="7492088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492092"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7492093">.</span><span class="ident" id="7492094">Error</span><span class="op" id="7492099">(</span><span class="string" id="7492100">&#34;client&nbsp;and&nbsp;server&nbsp;channel&nbsp;bindings&nbsp;differ&#34;</span><span class="op" id="7492143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492149"><a href="/crypto/tls/tls_test.go.html#7491922">conn</a></span><span class="op" id="7492153">.</span><span class="ident" id="7492154">Close</span><span class="op" id="7492159">(</span><span class="op" id="7492160">)</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492164"><a href="/crypto/tls/tls_test.go.html#7491922">conn</a></span><span class="op" id="7492168">,</span>&nbsp;<span class="ident" id="7492170"><a href="/crypto/tls/tls_test.go.html#7491928">err</a></span>&nbsp;<span class="op" id="7492174">=</span>&nbsp;<span class="ident" id="7492176"><a href="/crypto/tls/tls.go.html#3968005">Dial</a></span><span class="op" id="7492180">(</span><span class="string" id="7492181">&#34;tcp&#34;</span><span class="op" id="7492186">,</span>&nbsp;<span class="ident" id="7492188"><a href="/crypto/tls/tls_test.go.html#7491435">ln</a></span><span class="op" id="7492190">.</span><span class="ident" id="7492191">Addr</span><span class="op" id="7492195">(</span><span class="op" id="7492196">)</span><span class="op" id="7492197">.</span><span class="ident" id="7492198">String</span><span class="op" id="7492204">(</span><span class="op" id="7492205">)</span><span class="op" id="7492206">,</span>&nbsp;<span class="op" id="7492208">&amp;</span><span class="ident" id="7492209"><a href="/crypto/tls/tls_test.go.html#7491830">clientConfig</a></span><span class="op" id="7492221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492224">if</span>&nbsp;<span class="ident" id="7492227"><a href="/crypto/tls/tls_test.go.html#7491928">err</a></span>&nbsp;<span class="op" id="7492231">!=</span>&nbsp;<span class="ident" id="7492234">nil</span>&nbsp;<span class="op" id="7492238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492242"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7492243">.</span><span class="ident" id="7492244">Fatal</span><span class="op" id="7492249">(</span><span class="ident" id="7492250"><a href="/crypto/tls/tls_test.go.html#7491928">err</a></span><span class="op" id="7492253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492256">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492259">defer</span>&nbsp;<span class="ident" id="7492265"><a href="/crypto/tls/tls_test.go.html#7491922">conn</a></span><span class="op" id="7492269">.</span><span class="ident" id="7492270">Close</span><span class="op" id="7492275">(</span><span class="op" id="7492276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492279">if</span>&nbsp;<span class="op" id="7492282">!</span><span class="ident" id="7492283"><a href="/crypto/tls/tls_test.go.html#7491922">conn</a></span><span class="op" id="7492287">.</span><span class="ident" id="7492288">ConnectionState</span><span class="op" id="7492303">(</span><span class="op" id="7492304">)</span><span class="op" id="7492305">.</span><span class="ident" id="7492306">DidResume</span>&nbsp;<span class="op" id="7492316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492320"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7492321">.</span><span class="ident" id="7492322">Error</span><span class="op" id="7492327">(</span><span class="string" id="7492328">&#34;second&nbsp;session&nbsp;did&nbsp;not&nbsp;use&nbsp;resumption&#34;</span><span class="op" id="7492367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492373">if</span>&nbsp;<span class="op" id="7492376">!</span><span class="ident" id="7492377"><a href="/crypto/tls/tls_test.go.html#7484330">bytes</a></span><span class="op" id="7492382">.</span><span class="ident" id="7492383">Equal</span><span class="op" id="7492388">(</span><span class="ident" id="7492389"><a href="/crypto/tls/tls_test.go.html#7491922">conn</a></span><span class="op" id="7492393">.</span><span class="ident" id="7492394">ConnectionState</span><span class="op" id="7492409">(</span><span class="op" id="7492410">)</span><span class="op" id="7492411">.</span><span class="ident" id="7492412">TLSUnique</span><span class="op" id="7492421">,</span>&nbsp;<span class="op" id="7492423">&lt;-</span><span class="ident" id="7492425"><a href="/crypto/tls/tls_test.go.html#7491481">serverTLSUniques</a></span><span class="op" id="7492441">)</span>&nbsp;<span class="op" id="7492443">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492447"><a href="/crypto/tls/tls_test.go.html#7491418">t</a></span><span class="op" id="7492448">.</span><span class="ident" id="7492449">Error</span><span class="op" id="7492454">(</span><span class="string" id="7492455">&#34;client&nbsp;and&nbsp;server&nbsp;channel&nbsp;bindings&nbsp;differ&nbsp;when&nbsp;session&nbsp;resumption&nbsp;is&nbsp;used&#34;</span><span class="op" id="7492530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492533">}</span><br>
<span class="lineno"></span><span class="op" id="7492535">}</span>
</div>
</body>
</html>
