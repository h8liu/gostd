<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3889135">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3889190">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3889244">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3889295">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889312">package</span>&nbsp;<span class="ident" id="3889320">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3889325">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3889353">func</span>&nbsp;<span class="ident" id="3889358">hasAsm</span><span class="op" id="3889364">(</span><span class="op" id="3889365">)</span>&nbsp;<span class="builtintype" id="3889367">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3889372">func</span>&nbsp;<span class="ident" id="3889377">encryptBlockAsm</span><span class="op" id="3889392">(</span><span class="ident" id="3889393">nr</span>&nbsp;<span class="builtintype" id="3889396">int</span><span class="op" id="3889399">,</span>&nbsp;<span class="ident" id="3889401">xk</span>&nbsp;<span class="op" id="3889404">*</span><span class="builtintype" id="3889405">uint32</span><span class="op" id="3889411">,</span>&nbsp;<span class="ident" id="3889413">dst</span><span class="op" id="3889416">,</span>&nbsp;<span class="ident" id="3889418">src</span>&nbsp;<span class="op" id="3889422">*</span><span class="builtintype" id="3889423">byte</span><span class="op" id="3889427">)</span><br>
<span class="lineno"></span><span class="keyword" id="3889429">func</span>&nbsp;<span class="ident" id="3889434">decryptBlockAsm</span><span class="op" id="3889449">(</span><span class="ident" id="3889450">nr</span>&nbsp;<span class="builtintype" id="3889453">int</span><span class="op" id="3889456">,</span>&nbsp;<span class="ident" id="3889458">xk</span>&nbsp;<span class="op" id="3889461">*</span><span class="builtintype" id="3889462">uint32</span><span class="op" id="3889468">,</span>&nbsp;<span class="ident" id="3889470">dst</span><span class="op" id="3889473">,</span>&nbsp;<span class="ident" id="3889475">src</span>&nbsp;<span class="op" id="3889479">*</span><span class="builtintype" id="3889480">byte</span><span class="op" id="3889484">)</span><br>
<span class="lineno"></span><span class="keyword" id="3889486">func</span>&nbsp;<span class="ident" id="3889491">expandKeyAsm</span><span class="op" id="3889503">(</span><span class="ident" id="3889504">nr</span>&nbsp;<span class="builtintype" id="3889507">int</span><span class="op" id="3889510">,</span>&nbsp;<span class="ident" id="3889512">key</span>&nbsp;<span class="op" id="3889516">*</span><span class="builtintype" id="3889517">byte</span><span class="op" id="3889521">,</span>&nbsp;<span class="ident" id="3889523">enc</span>&nbsp;<span class="op" id="3889527">*</span><span class="builtintype" id="3889528">uint32</span><span class="op" id="3889534">,</span>&nbsp;<span class="ident" id="3889536">dec</span>&nbsp;<span class="op" id="3889540">*</span><span class="builtintype" id="3889541">uint32</span><span class="op" id="3889547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3889550">var</span>&nbsp;<span class="ident" id="3889554">useAsm</span>&nbsp;<span class="op" id="3889561">=</span>&nbsp;<span class="ident" id="3889563">hasAsm</span><span class="op" id="3889569">(</span><span class="op" id="3889570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889573">func</span>&nbsp;<span class="ident" id="3889578">encryptBlock</span><span class="op" id="3889590">(</span><span class="ident" id="3889591">xk</span>&nbsp;<span class="op" id="3889594">[</span><span class="op" id="3889595">]</span><span class="builtintype" id="3889596">uint32</span><span class="op" id="3889602">,</span>&nbsp;<span class="ident" id="3889604">dst</span><span class="op" id="3889607">,</span>&nbsp;<span class="ident" id="3889609">src</span>&nbsp;<span class="op" id="3889613">[</span><span class="op" id="3889614">]</span><span class="builtintype" id="3889615">byte</span><span class="op" id="3889619">)</span>&nbsp;<span class="op" id="3889621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889624">if</span>&nbsp;<span class="ident" id="3889627">useAsm</span>&nbsp;<span class="op" id="3889634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889638">encryptBlockAsm</span><span class="op" id="3889653">(</span><span class="builtinfunc" id="3889654">len</span><span class="op" id="3889657">(</span><span class="ident" id="3889658">xk</span><span class="op" id="3889660">)</span><span class="op" id="3889661">/</span><span class="num" id="3889662">4</span><span class="op" id="3889663">-</span><span class="num" id="3889664">1</span><span class="op" id="3889665">,</span>&nbsp;<span class="op" id="3889667">&amp;</span><span class="ident" id="3889668">xk</span><span class="op" id="3889670">[</span><span class="num" id="3889671">0</span><span class="op" id="3889672">]</span><span class="op" id="3889673">,</span>&nbsp;<span class="op" id="3889675">&amp;</span><span class="ident" id="3889676">dst</span><span class="op" id="3889679">[</span><span class="num" id="3889680">0</span><span class="op" id="3889681">]</span><span class="op" id="3889682">,</span>&nbsp;<span class="op" id="3889684">&amp;</span><span class="ident" id="3889685">src</span><span class="op" id="3889688">[</span><span class="num" id="3889689">0</span><span class="op" id="3889690">]</span><span class="op" id="3889691">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889694">}</span>&nbsp;<span class="keyword" id="3889696">else</span>&nbsp;<span class="op" id="3889701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889705">encryptBlockGo</span><span class="op" id="3889719">(</span><span class="ident" id="3889720">xk</span><span class="op" id="3889722">,</span>&nbsp;<span class="ident" id="3889724">dst</span><span class="op" id="3889727">,</span>&nbsp;<span class="ident" id="3889729">src</span><span class="op" id="3889732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889735">}</span><br>
<span class="lineno"></span><span class="op" id="3889737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3889740">func</span>&nbsp;<span class="ident" id="3889745">decryptBlock</span><span class="op" id="3889757">(</span><span class="ident" id="3889758">xk</span>&nbsp;<span class="op" id="3889761">[</span><span class="op" id="3889762">]</span><span class="builtintype" id="3889763">uint32</span><span class="op" id="3889769">,</span>&nbsp;<span class="ident" id="3889771">dst</span><span class="op" id="3889774">,</span>&nbsp;<span class="ident" id="3889776">src</span>&nbsp;<span class="op" id="3889780">[</span><span class="op" id="3889781">]</span><span class="builtintype" id="3889782">byte</span><span class="op" id="3889786">)</span>&nbsp;<span class="op" id="3889788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889791">if</span>&nbsp;<span class="ident" id="3889794">useAsm</span>&nbsp;<span class="op" id="3889801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889805">decryptBlockAsm</span><span class="op" id="3889820">(</span><span class="builtinfunc" id="3889821">len</span><span class="op" id="3889824">(</span><span class="ident" id="3889825">xk</span><span class="op" id="3889827">)</span><span class="op" id="3889828">/</span><span class="num" id="3889829">4</span><span class="op" id="3889830">-</span><span class="num" id="3889831">1</span><span class="op" id="3889832">,</span>&nbsp;<span class="op" id="3889834">&amp;</span><span class="ident" id="3889835">xk</span><span class="op" id="3889837">[</span><span class="num" id="3889838">0</span><span class="op" id="3889839">]</span><span class="op" id="3889840">,</span>&nbsp;<span class="op" id="3889842">&amp;</span><span class="ident" id="3889843">dst</span><span class="op" id="3889846">[</span><span class="num" id="3889847">0</span><span class="op" id="3889848">]</span><span class="op" id="3889849">,</span>&nbsp;<span class="op" id="3889851">&amp;</span><span class="ident" id="3889852">src</span><span class="op" id="3889855">[</span><span class="num" id="3889856">0</span><span class="op" id="3889857">]</span><span class="op" id="3889858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889861">}</span>&nbsp;<span class="keyword" id="3889863">else</span>&nbsp;<span class="op" id="3889868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889872">decryptBlockGo</span><span class="op" id="3889886">(</span><span class="ident" id="3889887">xk</span><span class="op" id="3889889">,</span>&nbsp;<span class="ident" id="3889891">dst</span><span class="op" id="3889894">,</span>&nbsp;<span class="ident" id="3889896">src</span><span class="op" id="3889899">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889902">}</span><br>
<span class="lineno"></span><span class="op" id="3889904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889907">func</span>&nbsp;<span class="ident" id="3889912">expandKey</span><span class="op" id="3889921">(</span><span class="ident" id="3889922">key</span>&nbsp;<span class="op" id="3889926">[</span><span class="op" id="3889927">]</span><span class="builtintype" id="3889928">byte</span><span class="op" id="3889932">,</span>&nbsp;<span class="ident" id="3889934">enc</span><span class="op" id="3889937">,</span>&nbsp;<span class="ident" id="3889939">dec</span>&nbsp;<span class="op" id="3889943">[</span><span class="op" id="3889944">]</span><span class="builtintype" id="3889945">uint32</span><span class="op" id="3889951">)</span>&nbsp;<span class="op" id="3889953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889956">if</span>&nbsp;<span class="ident" id="3889959">useAsm</span>&nbsp;<span class="op" id="3889966">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889970">rounds</span>&nbsp;<span class="op" id="3889977">:=</span>&nbsp;<span class="num" id="3889980">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889985">switch</span>&nbsp;<span class="builtinfunc" id="3889992">len</span><span class="op" id="3889995">(</span><span class="ident" id="3889996">key</span><span class="op" id="3889999">)</span>&nbsp;<span class="op" id="3890001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890005">case</span>&nbsp;<span class="num" id="3890010">128</span>&nbsp;<span class="op" id="3890014">/</span>&nbsp;<span class="num" id="3890016">8</span><span class="op" id="3890017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890022">rounds</span>&nbsp;<span class="op" id="3890029">=</span>&nbsp;<span class="num" id="3890031">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890036">case</span>&nbsp;<span class="num" id="3890041">192</span>&nbsp;<span class="op" id="3890045">/</span>&nbsp;<span class="num" id="3890047">8</span><span class="op" id="3890048">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890053">rounds</span>&nbsp;<span class="op" id="3890060">=</span>&nbsp;<span class="num" id="3890062">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890067">case</span>&nbsp;<span class="num" id="3890072">256</span>&nbsp;<span class="op" id="3890076">/</span>&nbsp;<span class="num" id="3890078">8</span><span class="op" id="3890079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890084">rounds</span>&nbsp;<span class="op" id="3890091">=</span>&nbsp;<span class="num" id="3890093">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890102">expandKeyAsm</span><span class="op" id="3890114">(</span><span class="ident" id="3890115">rounds</span><span class="op" id="3890121">,</span>&nbsp;<span class="op" id="3890123">&amp;</span><span class="ident" id="3890124">key</span><span class="op" id="3890127">[</span><span class="num" id="3890128">0</span><span class="op" id="3890129">]</span><span class="op" id="3890130">,</span>&nbsp;<span class="op" id="3890132">&amp;</span><span class="ident" id="3890133">enc</span><span class="op" id="3890136">[</span><span class="num" id="3890137">0</span><span class="op" id="3890138">]</span><span class="op" id="3890139">,</span>&nbsp;<span class="op" id="3890141">&amp;</span><span class="ident" id="3890142">dec</span><span class="op" id="3890145">[</span><span class="num" id="3890146">0</span><span class="op" id="3890147">]</span><span class="op" id="3890148">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890151">}</span>&nbsp;<span class="keyword" id="3890153">else</span>&nbsp;<span class="op" id="3890158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890162">expandKeyGo</span><span class="op" id="3890173">(</span><span class="ident" id="3890174">key</span><span class="op" id="3890177">,</span>&nbsp;<span class="ident" id="3890179">enc</span><span class="op" id="3890182">,</span>&nbsp;<span class="ident" id="3890184">dec</span><span class="op" id="3890187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890190">}</span><br>
<span class="lineno"></span><span class="op" id="3890192">}</span>
</div>
</body>
</html>
