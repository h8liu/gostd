<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html" class="current">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2479586">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2479641">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2479695">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2479746">//&nbsp;+build&nbsp;linux</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2479763">package</span>&nbsp;<span class="ident" id="2479771">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2479780">import</span>&nbsp;<span class="op" id="2479787">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2479790">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2479799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2479802">//&nbsp;SysProcIDMap&nbsp;holds&nbsp;Container&nbsp;ID&nbsp;to&nbsp;Host&nbsp;ID&nbsp;mappings&nbsp;used&nbsp;for&nbsp;User&nbsp;Namespaces&nbsp;in&nbsp;Linux.</span><br>
<span class="lineno"></span><span class="comment" id="2479892">//&nbsp;See&nbsp;user_namespaces(7).</span><br>
<span class="lineno">15</span><span class="keyword" id="2479919">type</span>&nbsp;<span class="ident" id="2479924">SysProcIDMap</span>&nbsp;<span class="keyword" id="2479937">struct</span>&nbsp;<span class="op" id="2479944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2479947">ContainerID</span>&nbsp;<span class="builtintype" id="2479959">int</span>&nbsp;<span class="comment" id="2479963">//&nbsp;Container&nbsp;ID.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2479981">HostID</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2479993">int</span>&nbsp;<span class="comment" id="2479997">//&nbsp;Host&nbsp;ID.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480010">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480022">int</span>&nbsp;<span class="comment" id="2480026">//&nbsp;Size.</span><br>
<span class="lineno"></span><span class="op" id="2480035">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2480038">type</span>&nbsp;<span class="ident" id="2480043">SysProcAttr</span>&nbsp;<span class="keyword" id="2480055">struct</span>&nbsp;<span class="op" id="2480062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480065">Chroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480077">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480092">//&nbsp;Chroot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480104">Credential</span>&nbsp;&nbsp;<span class="op" id="2480116">*</span><span class="ident" id="2480117"><a href="/gostd/syscall/exec_unix.go.html#2493087">Credential</a></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480131">//&nbsp;Credential.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480147">Ptrace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480159">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480174">//&nbsp;Enable&nbsp;tracing.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480194">Setsid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480206">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480221">//&nbsp;Create&nbsp;session.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480241">Setpgid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480253">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480268">//&nbsp;Set&nbsp;process&nbsp;group&nbsp;ID&nbsp;to&nbsp;new&nbsp;pid&nbsp;(SYSV&nbsp;setpgrp)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480319">Setctty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480331">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480346">//&nbsp;Set&nbsp;controlling&nbsp;terminal&nbsp;to&nbsp;fd&nbsp;Ctty&nbsp;(only&nbsp;meaningful&nbsp;if&nbsp;Setsid&nbsp;is&nbsp;set)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480421">Noctty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480433">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480448">//&nbsp;Detach&nbsp;fd&nbsp;0&nbsp;from&nbsp;controlling&nbsp;terminal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480490">Ctty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2480502">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480517">//&nbsp;Controlling&nbsp;TTY&nbsp;fd&nbsp;(Linux&nbsp;only)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480553">Pdeathsig</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2480565"><a href="/gostd/syscall/syscall_unix.go.html#2546285">Signal</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480580">//&nbsp;Signal&nbsp;that&nbsp;the&nbsp;process&nbsp;will&nbsp;get&nbsp;when&nbsp;its&nbsp;parent&nbsp;dies&nbsp;(Linux&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480651">Cloneflags</span>&nbsp;&nbsp;<span class="builtintype" id="2480663">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2480678">//&nbsp;Flags&nbsp;for&nbsp;clone&nbsp;calls&nbsp;(Linux&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480717">UidMappings</span>&nbsp;<span class="op" id="2480729">[</span><span class="op" id="2480730">]</span><span class="ident" id="2480731"><a href="/gostd/syscall/exec_linux.go.html#2479924">SysProcIDMap</a></span>&nbsp;<span class="comment" id="2480744">//&nbsp;User&nbsp;ID&nbsp;mappings&nbsp;for&nbsp;user&nbsp;namespaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2480786">GidMappings</span>&nbsp;<span class="op" id="2480798">[</span><span class="op" id="2480799">]</span><span class="ident" id="2480800"><a href="/gostd/syscall/exec_linux.go.html#2479924">SysProcIDMap</a></span>&nbsp;<span class="comment" id="2480813">//&nbsp;Group&nbsp;ID&nbsp;mappings&nbsp;for&nbsp;user&nbsp;namespaces.</span><br>
<span class="lineno"></span><span class="op" id="2480855">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="2480858">//&nbsp;Implemented&nbsp;in&nbsp;runtime&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="2480893">func</span>&nbsp;<span class="ident" id="2480898">runtime_BeforeFork</span><span class="op" id="2480916">(</span><span class="op" id="2480917">)</span><br>
<span class="lineno"></span><span class="keyword" id="2480919">func</span>&nbsp;<span class="ident" id="2480924">runtime_AfterFork</span><span class="op" id="2480941">(</span><span class="op" id="2480942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="2480945">//&nbsp;Fork,&nbsp;dup&nbsp;fd&nbsp;onto&nbsp;0..len(fd),&nbsp;and&nbsp;exec(argv0,&nbsp;argvv,&nbsp;envv)&nbsp;in&nbsp;child.</span><br>
<span class="lineno"></span><span class="comment" id="2481017">//&nbsp;If&nbsp;a&nbsp;dup&nbsp;or&nbsp;exec&nbsp;fails,&nbsp;write&nbsp;the&nbsp;errno&nbsp;error&nbsp;to&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="comment" id="2481075">//&nbsp;(Pipe&nbsp;is&nbsp;close-on-exec&nbsp;so&nbsp;if&nbsp;exec&nbsp;succeeds,&nbsp;it&nbsp;will&nbsp;be&nbsp;closed.)</span><br>
<span class="lineno"></span><span class="comment" id="2481142">//&nbsp;In&nbsp;the&nbsp;child,&nbsp;this&nbsp;function&nbsp;must&nbsp;not&nbsp;acquire&nbsp;any&nbsp;locks,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="2481209">//&nbsp;they&nbsp;might&nbsp;have&nbsp;been&nbsp;locked&nbsp;at&nbsp;the&nbsp;time&nbsp;of&nbsp;the&nbsp;fork.&nbsp;&nbsp;This&nbsp;means</span><br>
<span class="lineno">45</span><span class="comment" id="2481277">//&nbsp;no&nbsp;rescheduling,&nbsp;no&nbsp;malloc&nbsp;calls,&nbsp;and&nbsp;no&nbsp;new&nbsp;stack&nbsp;segments.</span><br>
<span class="lineno"></span><span class="comment" id="2481341">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason&nbsp;compiler&nbsp;does&nbsp;not&nbsp;race&nbsp;instrument&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2481402">//&nbsp;The&nbsp;calls&nbsp;to&nbsp;RawSyscall&nbsp;are&nbsp;okay&nbsp;because&nbsp;they&nbsp;are&nbsp;assembly</span><br>
<span class="lineno"></span><span class="comment" id="2481464">//&nbsp;functions&nbsp;that&nbsp;do&nbsp;not&nbsp;grow&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="2481505">func</span>&nbsp;<span class="ident" id="2481510">forkAndExecInChild</span><span class="op" id="2481528">(</span><span class="ident" id="2481529">argv0</span>&nbsp;<span class="op" id="2481535">*</span><span class="builtintype" id="2481536">byte</span><span class="op" id="2481540">,</span>&nbsp;<span class="ident" id="2481542">argv</span><span class="op" id="2481546">,</span>&nbsp;<span class="ident" id="2481548">envv</span>&nbsp;<span class="op" id="2481553">[</span><span class="op" id="2481554">]</span><span class="op" id="2481555">*</span><span class="builtintype" id="2481556">byte</span><span class="op" id="2481560">,</span>&nbsp;<span class="ident" id="2481562">chroot</span><span class="op" id="2481568">,</span>&nbsp;<span class="ident" id="2481570">dir</span>&nbsp;<span class="op" id="2481574">*</span><span class="builtintype" id="2481575">byte</span><span class="op" id="2481579">,</span>&nbsp;<span class="ident" id="2481581">attr</span>&nbsp;<span class="op" id="2481586">*</span><span class="ident" id="2481587"><a href="/gostd/syscall/exec_unix.go.html#2493314">ProcAttr</a></span><span class="op" id="2481595">,</span>&nbsp;<span class="ident" id="2481597">sys</span>&nbsp;<span class="op" id="2481601">*</span><span class="ident" id="2481602"><a href="/gostd/syscall/exec_linux.go.html#2480043">SysProcAttr</a></span><span class="op" id="2481613">,</span>&nbsp;<span class="ident" id="2481615">pipe</span>&nbsp;<span class="builtintype" id="2481620">int</span><span class="op" id="2481623">)</span>&nbsp;<span class="op" id="2481625">(</span><span class="ident" id="2481626">pid</span>&nbsp;<span class="builtintype" id="2481630">int</span><span class="op" id="2481633">,</span>&nbsp;<span class="ident" id="2481635">err</span>&nbsp;<span class="ident" id="2481639"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><span class="op" id="2481644">)</span>&nbsp;<span class="op" id="2481646">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2481649">//&nbsp;Declare&nbsp;all&nbsp;variables&nbsp;at&nbsp;top&nbsp;in&nbsp;case&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2481694">//&nbsp;declarations&nbsp;require&nbsp;heap&nbsp;allocation&nbsp;(e.g.,&nbsp;err1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2481749">var</span>&nbsp;<span class="op" id="2481753">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2481757">r1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2481764">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2481774">err1</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2481781"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2481789">err2</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2481796"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2481804">nextfd</span>&nbsp;<span class="builtintype" id="2481811">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2481817">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2481824">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2481830">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2481837">[</span><span class="num" id="2481838">2</span><span class="op" id="2481839">]</span><span class="builtintype" id="2481840">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2481845">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2481849">//&nbsp;Guard&nbsp;against&nbsp;side&nbsp;effects&nbsp;of&nbsp;shuffling&nbsp;fds&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2481904">//&nbsp;Make&nbsp;sure&nbsp;that&nbsp;nextfd&nbsp;is&nbsp;beyond&nbsp;any&nbsp;currently&nbsp;open&nbsp;files&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2481968">//&nbsp;that&nbsp;we&nbsp;can&#39;t&nbsp;run&nbsp;the&nbsp;risk&nbsp;of&nbsp;overwriting&nbsp;any&nbsp;of&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482027">fd</span>&nbsp;<span class="op" id="2482030">:=</span>&nbsp;<span class="builtinfunc" id="2482033">make</span><span class="op" id="2482037">(</span><span class="op" id="2482038">[</span><span class="op" id="2482039">]</span><span class="builtintype" id="2482040">int</span><span class="op" id="2482043">,</span>&nbsp;<span class="builtinfunc" id="2482045">len</span><span class="op" id="2482048">(</span><span class="ident" id="2482049"><a href="/gostd/syscall/exec_linux.go.html#2481581">attr</a></span><span class="op" id="2482053">.</span><span class="ident" id="2482054"><a href="/gostd/syscall/exec_unix.go.html#2493413">Files</a></span><span class="op" id="2482059">)</span><span class="op" id="2482060">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482063"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span>&nbsp;<span class="op" id="2482070">=</span>&nbsp;<span class="builtinfunc" id="2482072">len</span><span class="op" id="2482075">(</span><span class="ident" id="2482076"><a href="/gostd/syscall/exec_linux.go.html#2481581">attr</a></span><span class="op" id="2482080">.</span><span class="ident" id="2482081"><a href="/gostd/syscall/exec_unix.go.html#2493413">Files</a></span><span class="op" id="2482086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482089">for</span>&nbsp;<span class="ident" id="2482093">i</span><span class="op" id="2482094">,</span>&nbsp;<span class="ident" id="2482096">ufd</span>&nbsp;<span class="op" id="2482100">:=</span>&nbsp;<span class="keyword" id="2482103">range</span>&nbsp;<span class="ident" id="2482109"><a href="/gostd/syscall/exec_linux.go.html#2481581">attr</a></span><span class="op" id="2482113">.</span><span class="ident" id="2482114"><a href="/gostd/syscall/exec_unix.go.html#2493413">Files</a></span>&nbsp;<span class="op" id="2482120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482124">if</span>&nbsp;<span class="ident" id="2482127"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span>&nbsp;<span class="op" id="2482134">&lt;</span>&nbsp;<span class="builtintype" id="2482136">int</span><span class="op" id="2482139">(</span><span class="ident" id="2482140"><a href="/gostd/syscall/exec_linux.go.html#2482096">ufd</a></span><span class="op" id="2482143">)</span>&nbsp;<span class="op" id="2482145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482150"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span>&nbsp;<span class="op" id="2482157">=</span>&nbsp;<span class="builtintype" id="2482159">int</span><span class="op" id="2482162">(</span><span class="ident" id="2482163"><a href="/gostd/syscall/exec_linux.go.html#2482096">ufd</a></span><span class="op" id="2482166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2482170">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482174"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2482176">[</span><span class="ident" id="2482177"><a href="/gostd/syscall/exec_linux.go.html#2482093">i</a></span><span class="op" id="2482178">]</span>&nbsp;<span class="op" id="2482180">=</span>&nbsp;<span class="builtintype" id="2482182">int</span><span class="op" id="2482185">(</span><span class="ident" id="2482186"><a href="/gostd/syscall/exec_linux.go.html#2482096">ufd</a></span><span class="op" id="2482189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2482192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482195"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2482201">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2482206">//&nbsp;Allocate&nbsp;another&nbsp;pipe&nbsp;for&nbsp;parent&nbsp;to&nbsp;child&nbsp;communication&nbsp;for</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2482270">//&nbsp;synchronizing&nbsp;writing&nbsp;of&nbsp;User&nbsp;ID/Group&nbsp;ID&nbsp;mappings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482326">if</span>&nbsp;<span class="ident" id="2482329"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2482332">.</span><span class="ident" id="2482333"><a href="/gostd/syscall/exec_linux.go.html#2480717">UidMappings</a></span>&nbsp;<span class="op" id="2482345">!=</span>&nbsp;<span class="builtintype" id="2482348">nil</span>&nbsp;<span class="op" id="2482352">||</span>&nbsp;<span class="ident" id="2482355"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2482358">.</span><span class="ident" id="2482359"><a href="/gostd/syscall/exec_linux.go.html#2480786">GidMappings</a></span>&nbsp;<span class="op" id="2482371">!=</span>&nbsp;<span class="builtintype" id="2482374">nil</span>&nbsp;<span class="op" id="2482378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482382">if</span>&nbsp;<span class="ident" id="2482385">err</span>&nbsp;<span class="op" id="2482389">:=</span>&nbsp;<span class="ident" id="2482392"><a href="/gostd/syscall/exec_linux.go.html#2487690">forkExecPipe</a></span><span class="op" id="2482404">(</span><span class="ident" id="2482405"><a href="/gostd/syscall/exec_linux.go.html#2481830">p</a></span><span class="op" id="2482406">[</span><span class="op" id="2482407">:</span><span class="op" id="2482408">]</span><span class="op" id="2482409">)</span><span class="op" id="2482410">;</span>&nbsp;<span class="ident" id="2482412"><a href="/gostd/syscall/exec_linux.go.html#2482385">err</a></span>&nbsp;<span class="op" id="2482416">!=</span>&nbsp;<span class="builtintype" id="2482419">nil</span>&nbsp;<span class="op" id="2482423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482428">return</span>&nbsp;<span class="num" id="2482435">0</span><span class="op" id="2482436">,</span>&nbsp;<span class="ident" id="2482438"><a href="/gostd/syscall/exec_linux.go.html#2482385">err</a></span><span class="op" id="2482441">.</span><span class="op" id="2482442">(</span><span class="ident" id="2482443"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><span class="op" id="2482448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2482452">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2482455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2482459">//&nbsp;About&nbsp;to&nbsp;call&nbsp;fork.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2482483">//&nbsp;No&nbsp;more&nbsp;allocation&nbsp;or&nbsp;calls&nbsp;of&nbsp;non-assembly&nbsp;functions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482542"><a href="/gostd/syscall/exec_linux.go.html#2480898">runtime_BeforeFork</a></span><span class="op" id="2482560">(</span><span class="op" id="2482561">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482564"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span><span class="op" id="2482566">,</span>&nbsp;<span class="ident" id="2482568">_</span><span class="op" id="2482569">,</span>&nbsp;<span class="ident" id="2482571"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2482576">=</span>&nbsp;<span class="ident" id="2482578"><a href="/gostd/syscall/syscall_unix.go.html#2544079">RawSyscall6</a></span><span class="op" id="2482589">(</span><span class="ident" id="2482590"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657822">SYS_CLONE</a></span><span class="op" id="2482599">,</span>&nbsp;<span class="builtintype" id="2482601">uintptr</span><span class="op" id="2482608">(</span><span class="ident" id="2482609"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604333">SIGCHLD</a></span><span class="op" id="2482616">)</span><span class="op" id="2482617">|</span><span class="ident" id="2482618"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2482621">.</span><span class="ident" id="2482622"><a href="/gostd/syscall/exec_linux.go.html#2480651">Cloneflags</a></span><span class="op" id="2482632">,</span>&nbsp;<span class="num" id="2482634">0</span><span class="op" id="2482635">,</span>&nbsp;<span class="num" id="2482637">0</span><span class="op" id="2482638">,</span>&nbsp;<span class="num" id="2482640">0</span><span class="op" id="2482641">,</span>&nbsp;<span class="num" id="2482643">0</span><span class="op" id="2482644">,</span>&nbsp;<span class="num" id="2482646">0</span><span class="op" id="2482647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482650">if</span>&nbsp;<span class="ident" id="2482653"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2482658">!=</span>&nbsp;<span class="num" id="2482661">0</span>&nbsp;<span class="op" id="2482663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482667"><a href="/gostd/syscall/exec_linux.go.html#2480924">runtime_AfterFork</a></span><span class="op" id="2482684">(</span><span class="op" id="2482685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482689">return</span>&nbsp;<span class="num" id="2482696">0</span><span class="op" id="2482697">,</span>&nbsp;<span class="ident" id="2482699"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2482705">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482709">if</span>&nbsp;<span class="ident" id="2482712"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span>&nbsp;<span class="op" id="2482715">!=</span>&nbsp;<span class="num" id="2482718">0</span>&nbsp;<span class="op" id="2482720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2482724">//&nbsp;parent;&nbsp;return&nbsp;PID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482748"><a href="/gostd/syscall/exec_linux.go.html#2480924">runtime_AfterFork</a></span><span class="op" id="2482765">(</span><span class="op" id="2482766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482770"><a href="/gostd/syscall/exec_linux.go.html#2481626">pid</a></span>&nbsp;<span class="op" id="2482774">=</span>&nbsp;<span class="builtintype" id="2482776">int</span><span class="op" id="2482779">(</span><span class="ident" id="2482780"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span><span class="op" id="2482782">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482787">if</span>&nbsp;<span class="ident" id="2482790"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2482793">.</span><span class="ident" id="2482794"><a href="/gostd/syscall/exec_linux.go.html#2480717">UidMappings</a></span>&nbsp;<span class="op" id="2482806">!=</span>&nbsp;<span class="builtintype" id="2482809">nil</span>&nbsp;<span class="op" id="2482813">||</span>&nbsp;<span class="ident" id="2482816"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2482819">.</span><span class="ident" id="2482820"><a href="/gostd/syscall/exec_linux.go.html#2480786">GidMappings</a></span>&nbsp;<span class="op" id="2482832">!=</span>&nbsp;<span class="builtintype" id="2482835">nil</span>&nbsp;<span class="op" id="2482839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482844"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2482849">(</span><span class="ident" id="2482850"><a href="/gostd/syscall/exec_linux.go.html#2481830">p</a></span><span class="op" id="2482851">[</span><span class="num" id="2482852">0</span><span class="op" id="2482853">]</span><span class="op" id="2482854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482859">err</span>&nbsp;<span class="op" id="2482863">:=</span>&nbsp;<span class="ident" id="2482866"><a href="/gostd/syscall/exec_linux.go.html#2488793">writeUidGidMappings</a></span><span class="op" id="2482885">(</span><span class="ident" id="2482886"><a href="/gostd/syscall/exec_linux.go.html#2481626">pid</a></span><span class="op" id="2482889">,</span>&nbsp;<span class="ident" id="2482891"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2482894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2482899">if</span>&nbsp;<span class="ident" id="2482902"><a href="/gostd/syscall/exec_linux.go.html#2482859">err</a></span>&nbsp;<span class="op" id="2482906">!=</span>&nbsp;<span class="builtintype" id="2482909">nil</span>&nbsp;<span class="op" id="2482913">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482919"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span>&nbsp;<span class="op" id="2482924">=</span>&nbsp;<span class="ident" id="2482926"><a href="/gostd/syscall/exec_linux.go.html#2482859">err</a></span><span class="op" id="2482929">.</span><span class="op" id="2482930">(</span><span class="ident" id="2482931"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><span class="op" id="2482936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2482941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2482946"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2482956">(</span><span class="ident" id="2482957"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656016">SYS_WRITE</a></span><span class="op" id="2482966">,</span>&nbsp;<span class="builtintype" id="2482968">uintptr</span><span class="op" id="2482975">(</span><span class="ident" id="2482976"><a href="/gostd/syscall/exec_linux.go.html#2481830">p</a></span><span class="op" id="2482977">[</span><span class="num" id="2482978">1</span><span class="op" id="2482979">]</span><span class="op" id="2482980">)</span><span class="op" id="2482981">,</span>&nbsp;<span class="builtintype" id="2482983">uintptr</span><span class="op" id="2482990">(</span><span class="ident" id="2482991"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2482997">.</span><span class="ident" id="2482998">Pointer</span><span class="op" id="2483005">(</span><span class="op" id="2483006">&amp;</span><span class="ident" id="2483007"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span><span class="op" id="2483011">)</span><span class="op" id="2483012">)</span><span class="op" id="2483013">,</span>&nbsp;<span class="ident" id="2483015"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2483021">.</span><span class="ident" id="2483022">Sizeof</span><span class="op" id="2483028">(</span><span class="ident" id="2483029"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span><span class="op" id="2483033">)</span><span class="op" id="2483034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483039"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2483044">(</span><span class="ident" id="2483045"><a href="/gostd/syscall/exec_linux.go.html#2481830">p</a></span><span class="op" id="2483046">[</span><span class="num" id="2483047">1</span><span class="op" id="2483048">]</span><span class="op" id="2483049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483053">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483058">return</span>&nbsp;<span class="ident" id="2483065"><a href="/gostd/syscall/exec_linux.go.html#2481626">pid</a></span><span class="op" id="2483068">,</span>&nbsp;<span class="num" id="2483070">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2483077">//&nbsp;Fork&nbsp;succeeded,&nbsp;now&nbsp;in&nbsp;child.</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2483112">//&nbsp;Wait&nbsp;for&nbsp;User&nbsp;ID/Group&nbsp;ID&nbsp;mappings&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483166">if</span>&nbsp;<span class="ident" id="2483169"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2483172">.</span><span class="ident" id="2483173"><a href="/gostd/syscall/exec_linux.go.html#2480717">UidMappings</a></span>&nbsp;<span class="op" id="2483185">!=</span>&nbsp;<span class="builtintype" id="2483188">nil</span>&nbsp;<span class="op" id="2483192">||</span>&nbsp;<span class="ident" id="2483195"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2483198">.</span><span class="ident" id="2483199"><a href="/gostd/syscall/exec_linux.go.html#2480786">GidMappings</a></span>&nbsp;<span class="op" id="2483211">!=</span>&nbsp;<span class="builtintype" id="2483214">nil</span>&nbsp;<span class="op" id="2483218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483222">if</span>&nbsp;<span class="ident" id="2483225">_</span><span class="op" id="2483226">,</span>&nbsp;<span class="ident" id="2483228">_</span><span class="op" id="2483229">,</span>&nbsp;<span class="ident" id="2483231"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483236">=</span>&nbsp;<span class="ident" id="2483238"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2483248">(</span><span class="ident" id="2483249"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656080">SYS_CLOSE</a></span><span class="op" id="2483258">,</span>&nbsp;<span class="builtintype" id="2483260">uintptr</span><span class="op" id="2483267">(</span><span class="ident" id="2483268"><a href="/gostd/syscall/exec_linux.go.html#2481830">p</a></span><span class="op" id="2483269">[</span><span class="num" id="2483270">1</span><span class="op" id="2483271">]</span><span class="op" id="2483272">)</span><span class="op" id="2483273">,</span>&nbsp;<span class="num" id="2483275">0</span><span class="op" id="2483276">,</span>&nbsp;<span class="num" id="2483278">0</span><span class="op" id="2483279">)</span><span class="op" id="2483280">;</span>&nbsp;<span class="ident" id="2483282"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483287">!=</span>&nbsp;<span class="num" id="2483290">0</span>&nbsp;<span class="op" id="2483292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483297">goto</span>&nbsp;<span class="ident" id="2483302"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483319"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span><span class="op" id="2483321">,</span>&nbsp;<span class="ident" id="2483323">_</span><span class="op" id="2483324">,</span>&nbsp;<span class="ident" id="2483326"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483331">=</span>&nbsp;<span class="ident" id="2483333"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2483343">(</span><span class="ident" id="2483344"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2655984">SYS_READ</a></span><span class="op" id="2483352">,</span>&nbsp;<span class="builtintype" id="2483354">uintptr</span><span class="op" id="2483361">(</span><span class="ident" id="2483362"><a href="/gostd/syscall/exec_linux.go.html#2481830">p</a></span><span class="op" id="2483363">[</span><span class="num" id="2483364">0</span><span class="op" id="2483365">]</span><span class="op" id="2483366">)</span><span class="op" id="2483367">,</span>&nbsp;<span class="builtintype" id="2483369">uintptr</span><span class="op" id="2483376">(</span><span class="ident" id="2483377"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2483383">.</span><span class="ident" id="2483384">Pointer</span><span class="op" id="2483391">(</span><span class="op" id="2483392">&amp;</span><span class="ident" id="2483393"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span><span class="op" id="2483397">)</span><span class="op" id="2483398">)</span><span class="op" id="2483399">,</span>&nbsp;<span class="ident" id="2483401"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2483407">.</span><span class="ident" id="2483408">Sizeof</span><span class="op" id="2483414">(</span><span class="ident" id="2483415"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span><span class="op" id="2483419">)</span><span class="op" id="2483420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483424">if</span>&nbsp;<span class="ident" id="2483427"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483432">!=</span>&nbsp;<span class="num" id="2483435">0</span>&nbsp;<span class="op" id="2483437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483442">goto</span>&nbsp;<span class="ident" id="2483447"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483460">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483464">if</span>&nbsp;<span class="ident" id="2483467"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span>&nbsp;<span class="op" id="2483470">!=</span>&nbsp;<span class="ident" id="2483473"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2483479">.</span><span class="ident" id="2483480">Sizeof</span><span class="op" id="2483486">(</span><span class="ident" id="2483487"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span><span class="op" id="2483491">)</span>&nbsp;<span class="op" id="2483493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483498"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483503">=</span>&nbsp;<span class="ident" id="2483505"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483515">goto</span>&nbsp;<span class="ident" id="2483520"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483537">if</span>&nbsp;<span class="ident" id="2483540"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span>&nbsp;<span class="op" id="2483545">!=</span>&nbsp;<span class="num" id="2483548">0</span>&nbsp;<span class="op" id="2483550">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483555"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483560">=</span>&nbsp;<span class="ident" id="2483562"><a href="/gostd/syscall/exec_linux.go.html#2481789">err2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483570">goto</span>&nbsp;<span class="ident" id="2483575"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2483595">//&nbsp;Parent&nbsp;death&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483619">if</span>&nbsp;<span class="ident" id="2483622"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2483625">.</span><span class="ident" id="2483626"><a href="/gostd/syscall/exec_linux.go.html#2480553">Pdeathsig</a></span>&nbsp;<span class="op" id="2483636">!=</span>&nbsp;<span class="num" id="2483639">0</span>&nbsp;<span class="op" id="2483641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483645">_</span><span class="op" id="2483646">,</span>&nbsp;<span class="ident" id="2483648">_</span><span class="op" id="2483649">,</span>&nbsp;<span class="ident" id="2483651"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483656">=</span>&nbsp;<span class="ident" id="2483658"><a href="/gostd/syscall/syscall_unix.go.html#2544079">RawSyscall6</a></span><span class="op" id="2483669">(</span><span class="ident" id="2483670"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2661212">SYS_PRCTL</a></span><span class="op" id="2483679">,</span>&nbsp;<span class="ident" id="2483681"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2580524">PR_SET_PDEATHSIG</a></span><span class="op" id="2483697">,</span>&nbsp;<span class="builtintype" id="2483699">uintptr</span><span class="op" id="2483706">(</span><span class="ident" id="2483707"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2483710">.</span><span class="ident" id="2483711"><a href="/gostd/syscall/exec_linux.go.html#2480553">Pdeathsig</a></span><span class="op" id="2483720">)</span><span class="op" id="2483721">,</span>&nbsp;<span class="num" id="2483723">0</span><span class="op" id="2483724">,</span>&nbsp;<span class="num" id="2483726">0</span><span class="op" id="2483727">,</span>&nbsp;<span class="num" id="2483729">0</span><span class="op" id="2483730">,</span>&nbsp;<span class="num" id="2483732">0</span><span class="op" id="2483733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483737">if</span>&nbsp;<span class="ident" id="2483740"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2483745">!=</span>&nbsp;<span class="num" id="2483748">0</span>&nbsp;<span class="op" id="2483750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483755">goto</span>&nbsp;<span class="ident" id="2483760"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2483773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2483778">//&nbsp;Signal&nbsp;self&nbsp;if&nbsp;parent&nbsp;is&nbsp;already&nbsp;dead.&nbsp;This&nbsp;might&nbsp;cause&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2483841">//&nbsp;duplicate&nbsp;signal&nbsp;in&nbsp;rare&nbsp;cases,&nbsp;but&nbsp;it&nbsp;won&#39;t&nbsp;matter&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2483903">//&nbsp;using&nbsp;SIGKILL.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483923"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span><span class="op" id="2483925">,</span>&nbsp;<span class="ident" id="2483927">_</span><span class="op" id="2483928">,</span>&nbsp;<span class="ident" id="2483930">_</span>&nbsp;<span class="op" id="2483932">=</span>&nbsp;<span class="ident" id="2483934"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2483944">(</span><span class="ident" id="2483945"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659614">SYS_GETPPID</a></span><span class="op" id="2483956">,</span>&nbsp;<span class="num" id="2483958">0</span><span class="op" id="2483959">,</span>&nbsp;<span class="num" id="2483961">0</span><span class="op" id="2483962">,</span>&nbsp;<span class="num" id="2483964">0</span><span class="op" id="2483965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2483969">if</span>&nbsp;<span class="ident" id="2483972"><a href="/gostd/syscall/exec_linux.go.html#2481757">r1</a></span>&nbsp;<span class="op" id="2483975">==</span>&nbsp;<span class="num" id="2483978">1</span>&nbsp;<span class="op" id="2483980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2483985">pid</span><span class="op" id="2483988">,</span>&nbsp;<span class="ident" id="2483990">_</span><span class="op" id="2483991">,</span>&nbsp;<span class="ident" id="2483993">_</span>&nbsp;<span class="op" id="2483995">:=</span>&nbsp;<span class="ident" id="2483998"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484008">(</span><span class="ident" id="2484009"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657261">SYS_GETPID</a></span><span class="op" id="2484019">,</span>&nbsp;<span class="num" id="2484021">0</span><span class="op" id="2484022">,</span>&nbsp;<span class="num" id="2484024">0</span><span class="op" id="2484025">,</span>&nbsp;<span class="num" id="2484027">0</span><span class="op" id="2484028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484033">_</span><span class="op" id="2484034">,</span>&nbsp;<span class="ident" id="2484036">_</span><span class="op" id="2484037">,</span>&nbsp;<span class="ident" id="2484039">err1</span>&nbsp;<span class="op" id="2484044">:=</span>&nbsp;<span class="ident" id="2484047"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484057">(</span><span class="ident" id="2484058"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2658020">SYS_KILL</a></span><span class="op" id="2484066">,</span>&nbsp;<span class="ident" id="2484068"><a href="/gostd/syscall/exec_linux.go.html#2483985">pid</a></span><span class="op" id="2484071">,</span>&nbsp;<span class="builtintype" id="2484073">uintptr</span><span class="op" id="2484080">(</span><span class="ident" id="2484081"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2484084">.</span><span class="ident" id="2484085"><a href="/gostd/syscall/exec_linux.go.html#2480553">Pdeathsig</a></span><span class="op" id="2484094">)</span><span class="op" id="2484095">,</span>&nbsp;<span class="num" id="2484097">0</span><span class="op" id="2484098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484103">if</span>&nbsp;<span class="ident" id="2484106"><a href="/gostd/syscall/exec_linux.go.html#2484039">err1</a></span>&nbsp;<span class="op" id="2484111">!=</span>&nbsp;<span class="num" id="2484114">0</span>&nbsp;<span class="op" id="2484116">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484122">goto</span>&nbsp;<span class="ident" id="2484127"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2484152">//&nbsp;Enable&nbsp;tracing&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484185">if</span>&nbsp;<span class="ident" id="2484188"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2484191">.</span><span class="ident" id="2484192"><a href="/gostd/syscall/exec_linux.go.html#2480147">Ptrace</a></span>&nbsp;<span class="op" id="2484199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484203">_</span><span class="op" id="2484204">,</span>&nbsp;<span class="ident" id="2484206">_</span><span class="op" id="2484207">,</span>&nbsp;<span class="ident" id="2484209"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484214">=</span>&nbsp;<span class="ident" id="2484216"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484226">(</span><span class="ident" id="2484227"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659308">SYS_PTRACE</a></span><span class="op" id="2484237">,</span>&nbsp;<span class="builtintype" id="2484239">uintptr</span><span class="op" id="2484246">(</span><span class="ident" id="2484247"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2583011">PTRACE_TRACEME</a></span><span class="op" id="2484261">)</span><span class="op" id="2484262">,</span>&nbsp;<span class="num" id="2484264">0</span><span class="op" id="2484265">,</span>&nbsp;<span class="num" id="2484267">0</span><span class="op" id="2484268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484272">if</span>&nbsp;<span class="ident" id="2484275"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484280">!=</span>&nbsp;<span class="num" id="2484283">0</span>&nbsp;<span class="op" id="2484285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484290">goto</span>&nbsp;<span class="ident" id="2484295"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2484315">//&nbsp;Session&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484330">if</span>&nbsp;<span class="ident" id="2484333"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2484336">.</span><span class="ident" id="2484337"><a href="/gostd/syscall/exec_linux.go.html#2480194">Setsid</a></span>&nbsp;<span class="op" id="2484344">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484348">_</span><span class="op" id="2484349">,</span>&nbsp;<span class="ident" id="2484351">_</span><span class="op" id="2484352">,</span>&nbsp;<span class="ident" id="2484354"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484359">=</span>&nbsp;<span class="ident" id="2484361"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484371">(</span><span class="ident" id="2484372"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659682">SYS_SETSID</a></span><span class="op" id="2484382">,</span>&nbsp;<span class="num" id="2484384">0</span><span class="op" id="2484385">,</span>&nbsp;<span class="num" id="2484387">0</span><span class="op" id="2484388">,</span>&nbsp;<span class="num" id="2484390">0</span><span class="op" id="2484391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484395">if</span>&nbsp;<span class="ident" id="2484398"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484403">!=</span>&nbsp;<span class="num" id="2484406">0</span>&nbsp;<span class="op" id="2484408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484413">goto</span>&nbsp;<span class="ident" id="2484418"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484434">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2484438">//&nbsp;Set&nbsp;process&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484460">if</span>&nbsp;<span class="ident" id="2484463"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2484466">.</span><span class="ident" id="2484467"><a href="/gostd/syscall/exec_linux.go.html#2480241">Setpgid</a></span>&nbsp;<span class="op" id="2484475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484479">_</span><span class="op" id="2484480">,</span>&nbsp;<span class="ident" id="2484482">_</span><span class="op" id="2484483">,</span>&nbsp;<span class="ident" id="2484485"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484490">=</span>&nbsp;<span class="ident" id="2484492"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484502">(</span><span class="ident" id="2484503"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659580">SYS_SETPGID</a></span><span class="op" id="2484514">,</span>&nbsp;<span class="num" id="2484516">0</span><span class="op" id="2484517">,</span>&nbsp;<span class="num" id="2484519">0</span><span class="op" id="2484520">,</span>&nbsp;<span class="num" id="2484522">0</span><span class="op" id="2484523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484527">if</span>&nbsp;<span class="ident" id="2484530"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484535">!=</span>&nbsp;<span class="num" id="2484538">0</span>&nbsp;<span class="op" id="2484540">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484545">goto</span>&nbsp;<span class="ident" id="2484550"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2484570">//&nbsp;Chroot</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484581">if</span>&nbsp;<span class="ident" id="2484584"><a href="/gostd/syscall/exec_linux.go.html#2481562">chroot</a></span>&nbsp;<span class="op" id="2484591">!=</span>&nbsp;<span class="builtintype" id="2484594">nil</span>&nbsp;<span class="op" id="2484598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484602">_</span><span class="op" id="2484603">,</span>&nbsp;<span class="ident" id="2484605">_</span><span class="op" id="2484606">,</span>&nbsp;<span class="ident" id="2484608"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484613">=</span>&nbsp;<span class="ident" id="2484615"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484625">(</span><span class="ident" id="2484626"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2661348">SYS_CHROOT</a></span><span class="op" id="2484636">,</span>&nbsp;<span class="builtintype" id="2484638">uintptr</span><span class="op" id="2484645">(</span><span class="ident" id="2484646"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2484652">.</span><span class="ident" id="2484653">Pointer</span><span class="op" id="2484660">(</span><span class="ident" id="2484661"><a href="/gostd/syscall/exec_linux.go.html#2481562">chroot</a></span><span class="op" id="2484667">)</span><span class="op" id="2484668">)</span><span class="op" id="2484669">,</span>&nbsp;<span class="num" id="2484671">0</span><span class="op" id="2484672">,</span>&nbsp;<span class="num" id="2484674">0</span><span class="op" id="2484675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484679">if</span>&nbsp;<span class="ident" id="2484682"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484687">!=</span>&nbsp;<span class="num" id="2484690">0</span>&nbsp;<span class="op" id="2484692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484697">goto</span>&nbsp;<span class="ident" id="2484702"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484715">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2484722">//&nbsp;User&nbsp;and&nbsp;groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484742">if</span>&nbsp;<span class="ident" id="2484745">cred</span>&nbsp;<span class="op" id="2484750">:=</span>&nbsp;<span class="ident" id="2484753"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2484756">.</span><span class="ident" id="2484757"><a href="/gostd/syscall/exec_linux.go.html#2480104">Credential</a></span><span class="op" id="2484767">;</span>&nbsp;<span class="ident" id="2484769"><a href="/gostd/syscall/exec_linux.go.html#2484745">cred</a></span>&nbsp;<span class="op" id="2484774">!=</span>&nbsp;<span class="builtintype" id="2484777">nil</span>&nbsp;<span class="op" id="2484781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484785">ngroups</span>&nbsp;<span class="op" id="2484793">:=</span>&nbsp;<span class="builtintype" id="2484796">uintptr</span><span class="op" id="2484803">(</span><span class="builtinfunc" id="2484804">len</span><span class="op" id="2484807">(</span><span class="ident" id="2484808"><a href="/gostd/syscall/exec_linux.go.html#2484745">cred</a></span><span class="op" id="2484812">.</span><span class="ident" id="2484813"><a href="/gostd/syscall/exec_unix.go.html#2493167">Groups</a></span><span class="op" id="2484819">)</span><span class="op" id="2484820">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484824">var</span>&nbsp;<span class="ident" id="2484828">groups</span>&nbsp;<span class="ident" id="2484835"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2484841">.</span><span class="ident" id="2484842">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484852">if</span>&nbsp;<span class="ident" id="2484855"><a href="/gostd/syscall/exec_linux.go.html#2484785">ngroups</a></span>&nbsp;<span class="op" id="2484863">&gt;</span>&nbsp;<span class="num" id="2484865">0</span>&nbsp;<span class="op" id="2484867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484872"><a href="/gostd/syscall/exec_linux.go.html#2484828">groups</a></span>&nbsp;<span class="op" id="2484879">=</span>&nbsp;<span class="ident" id="2484881"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2484887">.</span><span class="ident" id="2484888">Pointer</span><span class="op" id="2484895">(</span><span class="op" id="2484896">&amp;</span><span class="ident" id="2484897"><a href="/gostd/syscall/exec_linux.go.html#2484745">cred</a></span><span class="op" id="2484901">.</span><span class="ident" id="2484902"><a href="/gostd/syscall/exec_unix.go.html#2493167">Groups</a></span><span class="op" id="2484908">[</span><span class="num" id="2484909">0</span><span class="op" id="2484910">]</span><span class="op" id="2484911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2484915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2484919">_</span><span class="op" id="2484920">,</span>&nbsp;<span class="ident" id="2484922">_</span><span class="op" id="2484923">,</span>&nbsp;<span class="ident" id="2484925"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484930">=</span>&nbsp;<span class="ident" id="2484932"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2484942">(</span><span class="ident" id="2484943"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659818">SYS_SETGROUPS</a></span><span class="op" id="2484956">,</span>&nbsp;<span class="ident" id="2484958"><a href="/gostd/syscall/exec_linux.go.html#2484785">ngroups</a></span><span class="op" id="2484965">,</span>&nbsp;<span class="builtintype" id="2484967">uintptr</span><span class="op" id="2484974">(</span><span class="ident" id="2484975"><a href="/gostd/syscall/exec_linux.go.html#2484828">groups</a></span><span class="op" id="2484981">)</span><span class="op" id="2484982">,</span>&nbsp;<span class="num" id="2484984">0</span><span class="op" id="2484985">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2484989">if</span>&nbsp;<span class="ident" id="2484992"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2484997">!=</span>&nbsp;<span class="num" id="2485000">0</span>&nbsp;<span class="op" id="2485002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485007">goto</span>&nbsp;<span class="ident" id="2485012"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485029">_</span><span class="op" id="2485030">,</span>&nbsp;<span class="ident" id="2485032">_</span><span class="op" id="2485033">,</span>&nbsp;<span class="ident" id="2485035"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485040">=</span>&nbsp;<span class="ident" id="2485042"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485052">(</span><span class="ident" id="2485053"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659478">SYS_SETGID</a></span><span class="op" id="2485063">,</span>&nbsp;<span class="builtintype" id="2485065">uintptr</span><span class="op" id="2485072">(</span><span class="ident" id="2485073"><a href="/gostd/syscall/exec_linux.go.html#2484745">cred</a></span><span class="op" id="2485077">.</span><span class="ident" id="2485078"><a href="/gostd/syscall/exec_unix.go.html#2493137">Gid</a></span><span class="op" id="2485081">)</span><span class="op" id="2485082">,</span>&nbsp;<span class="num" id="2485084">0</span><span class="op" id="2485085">,</span>&nbsp;<span class="num" id="2485087">0</span><span class="op" id="2485088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485092">if</span>&nbsp;<span class="ident" id="2485095"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485100">!=</span>&nbsp;<span class="num" id="2485103">0</span>&nbsp;<span class="op" id="2485105">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485110">goto</span>&nbsp;<span class="ident" id="2485115"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485132">_</span><span class="op" id="2485133">,</span>&nbsp;<span class="ident" id="2485135">_</span><span class="op" id="2485136">,</span>&nbsp;<span class="ident" id="2485138"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485143">=</span>&nbsp;<span class="ident" id="2485145"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485155">(</span><span class="ident" id="2485156"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2659444">SYS_SETUID</a></span><span class="op" id="2485166">,</span>&nbsp;<span class="builtintype" id="2485168">uintptr</span><span class="op" id="2485175">(</span><span class="ident" id="2485176"><a href="/gostd/syscall/exec_linux.go.html#2484745">cred</a></span><span class="op" id="2485180">.</span><span class="ident" id="2485181"><a href="/gostd/syscall/exec_unix.go.html#2493108">Uid</a></span><span class="op" id="2485184">)</span><span class="op" id="2485185">,</span>&nbsp;<span class="num" id="2485187">0</span><span class="op" id="2485188">,</span>&nbsp;<span class="num" id="2485190">0</span><span class="op" id="2485191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485195">if</span>&nbsp;<span class="ident" id="2485198"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485203">!=</span>&nbsp;<span class="num" id="2485206">0</span>&nbsp;<span class="op" id="2485208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485213">goto</span>&nbsp;<span class="ident" id="2485218"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2485238">//&nbsp;Chdir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485248">if</span>&nbsp;<span class="ident" id="2485251"><a href="/gostd/syscall/exec_linux.go.html#2481570">dir</a></span>&nbsp;<span class="op" id="2485255">!=</span>&nbsp;<span class="builtintype" id="2485258">nil</span>&nbsp;<span class="op" id="2485262">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485266">_</span><span class="op" id="2485267">,</span>&nbsp;<span class="ident" id="2485269">_</span><span class="op" id="2485270">,</span>&nbsp;<span class="ident" id="2485272"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485277">=</span>&nbsp;<span class="ident" id="2485279"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485289">(</span><span class="ident" id="2485290"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2658614">SYS_CHDIR</a></span><span class="op" id="2485299">,</span>&nbsp;<span class="builtintype" id="2485301">uintptr</span><span class="op" id="2485308">(</span><span class="ident" id="2485309"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2485315">.</span><span class="ident" id="2485316">Pointer</span><span class="op" id="2485323">(</span><span class="ident" id="2485324"><a href="/gostd/syscall/exec_linux.go.html#2481570">dir</a></span><span class="op" id="2485327">)</span><span class="op" id="2485328">)</span><span class="op" id="2485329">,</span>&nbsp;<span class="num" id="2485331">0</span><span class="op" id="2485332">,</span>&nbsp;<span class="num" id="2485334">0</span><span class="op" id="2485335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485339">if</span>&nbsp;<span class="ident" id="2485342"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485347">!=</span>&nbsp;<span class="num" id="2485350">0</span>&nbsp;<span class="op" id="2485352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485357">goto</span>&nbsp;<span class="ident" id="2485362"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485378">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2485382">//&nbsp;Pass&nbsp;1:&nbsp;look&nbsp;for&nbsp;fd[i]&nbsp;&lt;&nbsp;i&nbsp;and&nbsp;move&nbsp;those&nbsp;up&nbsp;above&nbsp;len(fd)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2485445">//&nbsp;so&nbsp;that&nbsp;pass&nbsp;2&nbsp;won&#39;t&nbsp;stomp&nbsp;on&nbsp;an&nbsp;fd&nbsp;it&nbsp;needs&nbsp;later.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485501">if</span>&nbsp;<span class="ident" id="2485504"><a href="/gostd/syscall/exec_linux.go.html#2481615">pipe</a></span>&nbsp;<span class="op" id="2485509">&lt;</span>&nbsp;<span class="ident" id="2485511"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span>&nbsp;<span class="op" id="2485518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485522">_</span><span class="op" id="2485523">,</span>&nbsp;<span class="ident" id="2485525">_</span><span class="op" id="2485526">,</span>&nbsp;<span class="ident" id="2485528"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485533">=</span>&nbsp;<span class="ident" id="2485535"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485545">(</span><span class="ident" id="2485546"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657063">SYS_DUP2</a></span><span class="op" id="2485554">,</span>&nbsp;<span class="builtintype" id="2485556">uintptr</span><span class="op" id="2485563">(</span><span class="ident" id="2485564"><a href="/gostd/syscall/exec_linux.go.html#2481615">pipe</a></span><span class="op" id="2485568">)</span><span class="op" id="2485569">,</span>&nbsp;<span class="builtintype" id="2485571">uintptr</span><span class="op" id="2485578">(</span><span class="ident" id="2485579"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2485585">)</span><span class="op" id="2485586">,</span>&nbsp;<span class="num" id="2485588">0</span><span class="op" id="2485589">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485593">if</span>&nbsp;<span class="ident" id="2485596"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485601">!=</span>&nbsp;<span class="num" id="2485604">0</span>&nbsp;<span class="op" id="2485606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485611">goto</span>&nbsp;<span class="ident" id="2485616"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485633"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485643">(</span><span class="ident" id="2485644"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2658350">SYS_FCNTL</a></span><span class="op" id="2485653">,</span>&nbsp;<span class="builtintype" id="2485655">uintptr</span><span class="op" id="2485662">(</span><span class="ident" id="2485663"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2485669">)</span><span class="op" id="2485670">,</span>&nbsp;<span class="ident" id="2485672"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561885">F_SETFD</a></span><span class="op" id="2485679">,</span>&nbsp;<span class="ident" id="2485681"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561154">FD_CLOEXEC</a></span><span class="op" id="2485691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485695"><a href="/gostd/syscall/exec_linux.go.html#2481615">pipe</a></span>&nbsp;<span class="op" id="2485700">=</span>&nbsp;<span class="ident" id="2485702"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485711"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2485717">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485724">for</span>&nbsp;<span class="ident" id="2485728"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span>&nbsp;<span class="op" id="2485730">=</span>&nbsp;<span class="num" id="2485732">0</span><span class="op" id="2485733">;</span>&nbsp;<span class="ident" id="2485735"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span>&nbsp;<span class="op" id="2485737">&lt;</span>&nbsp;<span class="builtinfunc" id="2485739">len</span><span class="op" id="2485742">(</span><span class="ident" id="2485743"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2485745">)</span><span class="op" id="2485746">;</span>&nbsp;<span class="ident" id="2485748"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2485749">++</span>&nbsp;<span class="op" id="2485752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485756">if</span>&nbsp;<span class="ident" id="2485759"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2485761">[</span><span class="ident" id="2485762"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2485763">]</span>&nbsp;<span class="op" id="2485765">&gt;=</span>&nbsp;<span class="num" id="2485768">0</span>&nbsp;<span class="op" id="2485770">&amp;&amp;</span>&nbsp;<span class="ident" id="2485773"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2485775">[</span><span class="ident" id="2485776"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2485777">]</span>&nbsp;<span class="op" id="2485779">&lt;</span>&nbsp;<span class="builtintype" id="2485781">int</span><span class="op" id="2485784">(</span><span class="ident" id="2485785"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2485786">)</span>&nbsp;<span class="op" id="2485788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485793">_</span><span class="op" id="2485794">,</span>&nbsp;<span class="ident" id="2485796">_</span><span class="op" id="2485797">,</span>&nbsp;<span class="ident" id="2485799"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485804">=</span>&nbsp;<span class="ident" id="2485806"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485816">(</span><span class="ident" id="2485817"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657063">SYS_DUP2</a></span><span class="op" id="2485825">,</span>&nbsp;<span class="builtintype" id="2485827">uintptr</span><span class="op" id="2485834">(</span><span class="ident" id="2485835"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2485837">[</span><span class="ident" id="2485838"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2485839">]</span><span class="op" id="2485840">)</span><span class="op" id="2485841">,</span>&nbsp;<span class="builtintype" id="2485843">uintptr</span><span class="op" id="2485850">(</span><span class="ident" id="2485851"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2485857">)</span><span class="op" id="2485858">,</span>&nbsp;<span class="num" id="2485860">0</span><span class="op" id="2485861">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485866">if</span>&nbsp;<span class="ident" id="2485869"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2485874">!=</span>&nbsp;<span class="num" id="2485877">0</span>&nbsp;<span class="op" id="2485879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2485885">goto</span>&nbsp;<span class="ident" id="2485890"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2485904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485909"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2485919">(</span><span class="ident" id="2485920"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2658350">SYS_FCNTL</a></span><span class="op" id="2485929">,</span>&nbsp;<span class="builtintype" id="2485931">uintptr</span><span class="op" id="2485938">(</span><span class="ident" id="2485939"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2485945">)</span><span class="op" id="2485946">,</span>&nbsp;<span class="ident" id="2485948"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561885">F_SETFD</a></span><span class="op" id="2485955">,</span>&nbsp;<span class="ident" id="2485957"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561154">FD_CLOEXEC</a></span><span class="op" id="2485967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485972"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2485974">[</span><span class="ident" id="2485975"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2485976">]</span>&nbsp;<span class="op" id="2485978">=</span>&nbsp;<span class="ident" id="2485980"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2485990"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2485996">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486002">if</span>&nbsp;<span class="ident" id="2486005"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span>&nbsp;<span class="op" id="2486012">==</span>&nbsp;<span class="ident" id="2486015"><a href="/gostd/syscall/exec_linux.go.html#2481615">pipe</a></span>&nbsp;<span class="op" id="2486020">{</span>&nbsp;<span class="comment" id="2486022">//&nbsp;don&#39;t&nbsp;stomp&nbsp;on&nbsp;pipe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486049"><a href="/gostd/syscall/exec_linux.go.html#2481804">nextfd</a></span><span class="op" id="2486055">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486065">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486072">//&nbsp;Pass&nbsp;2:&nbsp;dup&nbsp;fd[i]&nbsp;down&nbsp;onto&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486107">for</span>&nbsp;<span class="ident" id="2486111"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span>&nbsp;<span class="op" id="2486113">=</span>&nbsp;<span class="num" id="2486115">0</span><span class="op" id="2486116">;</span>&nbsp;<span class="ident" id="2486118"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span>&nbsp;<span class="op" id="2486120">&lt;</span>&nbsp;<span class="builtinfunc" id="2486122">len</span><span class="op" id="2486125">(</span><span class="ident" id="2486126"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2486128">)</span><span class="op" id="2486129">;</span>&nbsp;<span class="ident" id="2486131"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486132">++</span>&nbsp;<span class="op" id="2486135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486139">if</span>&nbsp;<span class="ident" id="2486142"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2486144">[</span><span class="ident" id="2486145"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486146">]</span>&nbsp;<span class="op" id="2486148">==</span>&nbsp;<span class="op" id="2486151">-</span><span class="num" id="2486152">1</span>&nbsp;<span class="op" id="2486154">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486159"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2486169">(</span><span class="ident" id="2486170"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656080">SYS_CLOSE</a></span><span class="op" id="2486179">,</span>&nbsp;<span class="builtintype" id="2486181">uintptr</span><span class="op" id="2486188">(</span><span class="ident" id="2486189"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486190">)</span><span class="op" id="2486191">,</span>&nbsp;<span class="num" id="2486193">0</span><span class="op" id="2486194">,</span>&nbsp;<span class="num" id="2486196">0</span><span class="op" id="2486197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486202">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486217">if</span>&nbsp;<span class="ident" id="2486220"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2486222">[</span><span class="ident" id="2486223"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486224">]</span>&nbsp;<span class="op" id="2486226">==</span>&nbsp;<span class="builtintype" id="2486229">int</span><span class="op" id="2486232">(</span><span class="ident" id="2486233"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486234">)</span>&nbsp;<span class="op" id="2486236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486241">//&nbsp;dup2(i,&nbsp;i)&nbsp;won&#39;t&nbsp;clear&nbsp;close-on-exec&nbsp;flag&nbsp;on&nbsp;Linux,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486299">//&nbsp;probably&nbsp;not&nbsp;elsewhere&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486336">_</span><span class="op" id="2486337">,</span>&nbsp;<span class="ident" id="2486339">_</span><span class="op" id="2486340">,</span>&nbsp;<span class="ident" id="2486342"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2486347">=</span>&nbsp;<span class="ident" id="2486349"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2486359">(</span><span class="ident" id="2486360"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2658350">SYS_FCNTL</a></span><span class="op" id="2486369">,</span>&nbsp;<span class="builtintype" id="2486371">uintptr</span><span class="op" id="2486378">(</span><span class="ident" id="2486379"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2486381">[</span><span class="ident" id="2486382"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486383">]</span><span class="op" id="2486384">)</span><span class="op" id="2486385">,</span>&nbsp;<span class="ident" id="2486387"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561885">F_SETFD</a></span><span class="op" id="2486394">,</span>&nbsp;<span class="num" id="2486396">0</span><span class="op" id="2486397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486402">if</span>&nbsp;<span class="ident" id="2486405"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2486410">!=</span>&nbsp;<span class="num" id="2486413">0</span>&nbsp;<span class="op" id="2486415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486421">goto</span>&nbsp;<span class="ident" id="2486426"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486440">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486445">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486460">//&nbsp;The&nbsp;new&nbsp;fd&nbsp;is&nbsp;created&nbsp;NOT&nbsp;close-on-exec,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486506">//&nbsp;which&nbsp;is&nbsp;exactly&nbsp;what&nbsp;we&nbsp;want.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486542">_</span><span class="op" id="2486543">,</span>&nbsp;<span class="ident" id="2486545">_</span><span class="op" id="2486546">,</span>&nbsp;<span class="ident" id="2486548"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2486553">=</span>&nbsp;<span class="ident" id="2486555"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2486565">(</span><span class="ident" id="2486566"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657063">SYS_DUP2</a></span><span class="op" id="2486574">,</span>&nbsp;<span class="builtintype" id="2486576">uintptr</span><span class="op" id="2486583">(</span><span class="ident" id="2486584"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2486586">[</span><span class="ident" id="2486587"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486588">]</span><span class="op" id="2486589">)</span><span class="op" id="2486590">,</span>&nbsp;<span class="builtintype" id="2486592">uintptr</span><span class="op" id="2486599">(</span><span class="ident" id="2486600"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486601">)</span><span class="op" id="2486602">,</span>&nbsp;<span class="num" id="2486604">0</span><span class="op" id="2486605">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486609">if</span>&nbsp;<span class="ident" id="2486612"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2486617">!=</span>&nbsp;<span class="num" id="2486620">0</span>&nbsp;<span class="op" id="2486622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486627">goto</span>&nbsp;<span class="ident" id="2486632"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486652">//&nbsp;By&nbsp;convention,&nbsp;we&nbsp;don&#39;t&nbsp;close-on-exec&nbsp;the&nbsp;fds&nbsp;we&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486709">//&nbsp;started&nbsp;with,&nbsp;so&nbsp;if&nbsp;len(fd)&nbsp;&lt;&nbsp;3,&nbsp;close&nbsp;0,&nbsp;1,&nbsp;2&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486771">//&nbsp;Programs&nbsp;that&nbsp;know&nbsp;they&nbsp;inherit&nbsp;fds&nbsp;&gt;=&nbsp;3&nbsp;will&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486826">//&nbsp;to&nbsp;set&nbsp;them&nbsp;close-on-exec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486857">for</span>&nbsp;<span class="ident" id="2486861"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span>&nbsp;<span class="op" id="2486863">=</span>&nbsp;<span class="builtinfunc" id="2486865">len</span><span class="op" id="2486868">(</span><span class="ident" id="2486869"><a href="/gostd/syscall/exec_linux.go.html#2482027">fd</a></span><span class="op" id="2486871">)</span><span class="op" id="2486872">;</span>&nbsp;<span class="ident" id="2486874"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span>&nbsp;<span class="op" id="2486876">&lt;</span>&nbsp;<span class="num" id="2486878">3</span><span class="op" id="2486879">;</span>&nbsp;<span class="ident" id="2486881"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486882">++</span>&nbsp;<span class="op" id="2486885">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486889"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2486899">(</span><span class="ident" id="2486900"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656080">SYS_CLOSE</a></span><span class="op" id="2486909">,</span>&nbsp;<span class="builtintype" id="2486911">uintptr</span><span class="op" id="2486918">(</span><span class="ident" id="2486919"><a href="/gostd/syscall/exec_linux.go.html#2481817">i</a></span><span class="op" id="2486920">)</span><span class="op" id="2486921">,</span>&nbsp;<span class="num" id="2486923">0</span><span class="op" id="2486924">,</span>&nbsp;<span class="num" id="2486926">0</span><span class="op" id="2486927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2486930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2486934">//&nbsp;Detach&nbsp;fd&nbsp;0&nbsp;from&nbsp;tty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486959">if</span>&nbsp;<span class="ident" id="2486962"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2486965">.</span><span class="ident" id="2486966"><a href="/gostd/syscall/exec_linux.go.html#2480421">Noctty</a></span>&nbsp;<span class="op" id="2486973">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2486977">_</span><span class="op" id="2486978">,</span>&nbsp;<span class="ident" id="2486980">_</span><span class="op" id="2486981">,</span>&nbsp;<span class="ident" id="2486983"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2486988">=</span>&nbsp;<span class="ident" id="2486990"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2487000">(</span><span class="ident" id="2487001"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656502">SYS_IOCTL</a></span><span class="op" id="2487010">,</span>&nbsp;<span class="num" id="2487012">0</span><span class="op" id="2487013">,</span>&nbsp;<span class="builtintype" id="2487015">uintptr</span><span class="op" id="2487022">(</span><span class="ident" id="2487023"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2597521">TIOCNOTTY</a></span><span class="op" id="2487032">)</span><span class="op" id="2487033">,</span>&nbsp;<span class="num" id="2487035">0</span><span class="op" id="2487036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487040">if</span>&nbsp;<span class="ident" id="2487043"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2487048">!=</span>&nbsp;<span class="num" id="2487051">0</span>&nbsp;<span class="op" id="2487053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487058">goto</span>&nbsp;<span class="ident" id="2487063"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487079">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2487083">//&nbsp;Set&nbsp;the&nbsp;controlling&nbsp;TTY&nbsp;to&nbsp;Ctty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487119">if</span>&nbsp;<span class="ident" id="2487122"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2487125">.</span><span class="ident" id="2487126"><a href="/gostd/syscall/exec_linux.go.html#2480319">Setctty</a></span>&nbsp;<span class="op" id="2487134">&amp;&amp;</span>&nbsp;<span class="ident" id="2487137"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2487140">.</span><span class="ident" id="2487141"><a href="/gostd/syscall/exec_linux.go.html#2480490">Ctty</a></span>&nbsp;<span class="op" id="2487146">&gt;=</span>&nbsp;<span class="num" id="2487149">0</span>&nbsp;<span class="op" id="2487151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487155">_</span><span class="op" id="2487156">,</span>&nbsp;<span class="ident" id="2487158">_</span><span class="op" id="2487159">,</span>&nbsp;<span class="ident" id="2487161"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2487166">=</span>&nbsp;<span class="ident" id="2487168"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2487178">(</span><span class="ident" id="2487179"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656502">SYS_IOCTL</a></span><span class="op" id="2487188">,</span>&nbsp;<span class="builtintype" id="2487190">uintptr</span><span class="op" id="2487197">(</span><span class="ident" id="2487198"><a href="/gostd/syscall/exec_linux.go.html#2481597">sys</a></span><span class="op" id="2487201">.</span><span class="ident" id="2487202"><a href="/gostd/syscall/exec_linux.go.html#2480490">Ctty</a></span><span class="op" id="2487206">)</span><span class="op" id="2487207">,</span>&nbsp;<span class="builtintype" id="2487209">uintptr</span><span class="op" id="2487216">(</span><span class="ident" id="2487217"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2598059">TIOCSCTTY</a></span><span class="op" id="2487226">)</span><span class="op" id="2487227">,</span>&nbsp;<span class="num" id="2487229">0</span><span class="op" id="2487230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487234">if</span>&nbsp;<span class="ident" id="2487237"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2487242">!=</span>&nbsp;<span class="num" id="2487245">0</span>&nbsp;<span class="op" id="2487247">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487252">goto</span>&nbsp;<span class="ident" id="2487257"><a href="/gostd/syscall/exec_linux.go.html#2487440">childerror</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2487277">//&nbsp;Time&nbsp;to&nbsp;exec.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487295">_</span><span class="op" id="2487296">,</span>&nbsp;<span class="ident" id="2487298">_</span><span class="op" id="2487299">,</span>&nbsp;<span class="ident" id="2487301"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span>&nbsp;<span class="op" id="2487306">=</span>&nbsp;<span class="ident" id="2487308"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2487318">(</span><span class="ident" id="2487319"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657921">SYS_EXECVE</a></span><span class="op" id="2487329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2487333">uintptr</span><span class="op" id="2487340">(</span><span class="ident" id="2487341"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2487347">.</span><span class="ident" id="2487348">Pointer</span><span class="op" id="2487355">(</span><span class="ident" id="2487356"><a href="/gostd/syscall/exec_linux.go.html#2481529">argv0</a></span><span class="op" id="2487361">)</span><span class="op" id="2487362">)</span><span class="op" id="2487363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2487367">uintptr</span><span class="op" id="2487374">(</span><span class="ident" id="2487375"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2487381">.</span><span class="ident" id="2487382">Pointer</span><span class="op" id="2487389">(</span><span class="op" id="2487390">&amp;</span><span class="ident" id="2487391"><a href="/gostd/syscall/exec_linux.go.html#2481542">argv</a></span><span class="op" id="2487395">[</span><span class="num" id="2487396">0</span><span class="op" id="2487397">]</span><span class="op" id="2487398">)</span><span class="op" id="2487399">)</span><span class="op" id="2487400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2487404">uintptr</span><span class="op" id="2487411">(</span><span class="ident" id="2487412"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2487418">.</span><span class="ident" id="2487419">Pointer</span><span class="op" id="2487426">(</span><span class="op" id="2487427">&amp;</span><span class="ident" id="2487428"><a href="/gostd/syscall/exec_linux.go.html#2481548">envv</a></span><span class="op" id="2487432">[</span><span class="num" id="2487433">0</span><span class="op" id="2487434">]</span><span class="op" id="2487435">)</span><span class="op" id="2487436">)</span><span class="op" id="2487437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="ident" id="2487440">childerror</span><span class="op" id="2487450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2487453">//&nbsp;send&nbsp;error&nbsp;code&nbsp;on&nbsp;pipe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487481"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2487491">(</span><span class="ident" id="2487492"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656016">SYS_WRITE</a></span><span class="op" id="2487501">,</span>&nbsp;<span class="builtintype" id="2487503">uintptr</span><span class="op" id="2487510">(</span><span class="ident" id="2487511"><a href="/gostd/syscall/exec_linux.go.html#2481615">pipe</a></span><span class="op" id="2487515">)</span><span class="op" id="2487516">,</span>&nbsp;<span class="builtintype" id="2487518">uintptr</span><span class="op" id="2487525">(</span><span class="ident" id="2487526"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2487532">.</span><span class="ident" id="2487533">Pointer</span><span class="op" id="2487540">(</span><span class="op" id="2487541">&amp;</span><span class="ident" id="2487542"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span><span class="op" id="2487546">)</span><span class="op" id="2487547">)</span><span class="op" id="2487548">,</span>&nbsp;<span class="ident" id="2487550"><a href="/gostd/syscall/exec_linux.go.html#2479790">unsafe</a></span><span class="op" id="2487556">.</span><span class="ident" id="2487557">Sizeof</span><span class="op" id="2487563">(</span><span class="ident" id="2487564"><a href="/gostd/syscall/exec_linux.go.html#2481774">err1</a></span><span class="op" id="2487568">)</span><span class="op" id="2487569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487572">for</span>&nbsp;<span class="op" id="2487576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487580"><a href="/gostd/syscall/syscall_unix.go.html#2544009">RawSyscall</a></span><span class="op" id="2487590">(</span><span class="ident" id="2487591"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2657954">SYS_EXIT</a></span><span class="op" id="2487599">,</span>&nbsp;<span class="num" id="2487601">253</span><span class="op" id="2487604">,</span>&nbsp;<span class="num" id="2487606">0</span><span class="op" id="2487607">,</span>&nbsp;<span class="num" id="2487609">0</span><span class="op" id="2487610">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487613">}</span><br>
<span class="lineno"></span><span class="op" id="2487615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487618">//&nbsp;Try&nbsp;to&nbsp;open&nbsp;a&nbsp;pipe&nbsp;with&nbsp;O_CLOEXEC&nbsp;set&nbsp;on&nbsp;both&nbsp;file&nbsp;descriptors.</span><br>
<span class="lineno"></span><span class="keyword" id="2487685">func</span>&nbsp;<span class="ident" id="2487690">forkExecPipe</span><span class="op" id="2487702">(</span><span class="ident" id="2487703">p</span>&nbsp;<span class="op" id="2487705">[</span><span class="op" id="2487706">]</span><span class="builtintype" id="2487707">int</span><span class="op" id="2487710">)</span>&nbsp;<span class="op" id="2487712">(</span><span class="ident" id="2487713">err</span>&nbsp;<span class="builtintype" id="2487717">error</span><span class="op" id="2487722">)</span>&nbsp;<span class="op" id="2487724">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487727"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2487731">=</span>&nbsp;<span class="ident" id="2487733"><a href="/gostd/syscall/syscall_linux.go.html#2513170">Pipe2</a></span><span class="op" id="2487738">(</span><span class="ident" id="2487739"><a href="/gostd/syscall/exec_linux.go.html#2487703">p</a></span><span class="op" id="2487740">,</span>&nbsp;<span class="ident" id="2487742"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576992">O_CLOEXEC</a></span><span class="op" id="2487751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2487754">//&nbsp;pipe2&nbsp;was&nbsp;added&nbsp;in&nbsp;2.6.27&nbsp;and&nbsp;our&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;2.6.23,&nbsp;so&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2487829">//&nbsp;might&nbsp;not&nbsp;be&nbsp;implemented.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487859">if</span>&nbsp;<span class="ident" id="2487862"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2487866">==</span>&nbsp;<span class="ident" id="2487869"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2602846">ENOSYS</a></span>&nbsp;<span class="op" id="2487876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487880">if</span>&nbsp;<span class="ident" id="2487883"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2487887">=</span>&nbsp;<span class="ident" id="2487889"><a href="/gostd/syscall/syscall_linux.go.html#2512964">Pipe</a></span><span class="op" id="2487893">(</span><span class="ident" id="2487894"><a href="/gostd/syscall/exec_linux.go.html#2487703">p</a></span><span class="op" id="2487895">)</span><span class="op" id="2487896">;</span>&nbsp;<span class="ident" id="2487898"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2487902">!=</span>&nbsp;<span class="builtintype" id="2487905">nil</span>&nbsp;<span class="op" id="2487909">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487914">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487927">if</span>&nbsp;<span class="ident" id="2487930">_</span><span class="op" id="2487931">,</span>&nbsp;<span class="ident" id="2487933"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2487937">=</span>&nbsp;<span class="ident" id="2487939"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2621217">fcntl</a></span><span class="op" id="2487944">(</span><span class="ident" id="2487945"><a href="/gostd/syscall/exec_linux.go.html#2487703">p</a></span><span class="op" id="2487946">[</span><span class="num" id="2487947">0</span><span class="op" id="2487948">]</span><span class="op" id="2487949">,</span>&nbsp;<span class="ident" id="2487951"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561885">F_SETFD</a></span><span class="op" id="2487958">,</span>&nbsp;<span class="ident" id="2487960"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561154">FD_CLOEXEC</a></span><span class="op" id="2487970">)</span><span class="op" id="2487971">;</span>&nbsp;<span class="ident" id="2487973"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2487977">!=</span>&nbsp;<span class="builtintype" id="2487980">nil</span>&nbsp;<span class="op" id="2487984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2487989">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2487998">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488002">_</span><span class="op" id="2488003">,</span>&nbsp;<span class="ident" id="2488005"><a href="/gostd/syscall/exec_linux.go.html#2487713">err</a></span>&nbsp;<span class="op" id="2488009">=</span>&nbsp;<span class="ident" id="2488011"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2621217">fcntl</a></span><span class="op" id="2488016">(</span><span class="ident" id="2488017"><a href="/gostd/syscall/exec_linux.go.html#2487703">p</a></span><span class="op" id="2488018">[</span><span class="num" id="2488019">1</span><span class="op" id="2488020">]</span><span class="op" id="2488021">,</span>&nbsp;<span class="ident" id="2488023"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561885">F_SETFD</a></span><span class="op" id="2488030">,</span>&nbsp;<span class="ident" id="2488032"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2561154">FD_CLOEXEC</a></span><span class="op" id="2488042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488048">return</span><br>
<span class="lineno"></span><span class="op" id="2488055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2488058">//&nbsp;writeIDMappings&nbsp;writes&nbsp;the&nbsp;user&nbsp;namespace&nbsp;User&nbsp;ID&nbsp;or&nbsp;Group&nbsp;ID&nbsp;mappings&nbsp;to&nbsp;the&nbsp;specified&nbsp;path.</span><br>
<span class="lineno"></span><span class="keyword" id="2488155">func</span>&nbsp;<span class="ident" id="2488160">writeIDMappings</span><span class="op" id="2488175">(</span><span class="ident" id="2488176">path</span>&nbsp;<span class="builtintype" id="2488181">string</span><span class="op" id="2488187">,</span>&nbsp;<span class="ident" id="2488189">idMap</span>&nbsp;<span class="op" id="2488195">[</span><span class="op" id="2488196">]</span><span class="ident" id="2488197"><a href="/gostd/syscall/exec_linux.go.html#2479924">SysProcIDMap</a></span><span class="op" id="2488209">)</span>&nbsp;<span class="builtintype" id="2488211">error</span>&nbsp;<span class="op" id="2488217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488220">fd</span><span class="op" id="2488222">,</span>&nbsp;<span class="ident" id="2488224">err</span>&nbsp;<span class="op" id="2488228">:=</span>&nbsp;<span class="ident" id="2488231"><a href="/gostd/syscall/syscall_linux.go.html#2512590">Open</a></span><span class="op" id="2488235">(</span><span class="ident" id="2488236"><a href="/gostd/syscall/exec_linux.go.html#2488176">path</a></span><span class="op" id="2488240">,</span>&nbsp;<span class="ident" id="2488242"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2577587">O_RDWR</a></span><span class="op" id="2488248">,</span>&nbsp;<span class="num" id="2488250">0</span><span class="op" id="2488251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488254">if</span>&nbsp;<span class="ident" id="2488257"><a href="/gostd/syscall/exec_linux.go.html#2488224">err</a></span>&nbsp;<span class="op" id="2488261">!=</span>&nbsp;<span class="builtintype" id="2488264">nil</span>&nbsp;<span class="op" id="2488268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488272">return</span>&nbsp;<span class="ident" id="2488279"><a href="/gostd/syscall/exec_linux.go.html#2488224">err</a></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488288">data</span>&nbsp;<span class="op" id="2488293">:=</span>&nbsp;<span class="string" id="2488296">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488300">for</span>&nbsp;<span class="ident" id="2488304">_</span><span class="op" id="2488305">,</span>&nbsp;<span class="ident" id="2488307">im</span>&nbsp;<span class="op" id="2488310">:=</span>&nbsp;<span class="keyword" id="2488313">range</span>&nbsp;<span class="ident" id="2488319"><a href="/gostd/syscall/exec_linux.go.html#2488189">idMap</a></span>&nbsp;<span class="op" id="2488325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488329"><a href="/gostd/syscall/exec_linux.go.html#2488288">data</a></span>&nbsp;<span class="op" id="2488334">=</span>&nbsp;<span class="ident" id="2488336"><a href="/gostd/syscall/exec_linux.go.html#2488288">data</a></span>&nbsp;<span class="op" id="2488341">+</span>&nbsp;<span class="ident" id="2488343"><a href="/gostd/syscall/str.go.html#2508324">itoa</a></span><span class="op" id="2488347">(</span><span class="ident" id="2488348"><a href="/gostd/syscall/exec_linux.go.html#2488307">im</a></span><span class="op" id="2488350">.</span><span class="ident" id="2488351"><a href="/gostd/syscall/exec_linux.go.html#2479947">ContainerID</a></span><span class="op" id="2488362">)</span>&nbsp;<span class="op" id="2488364">+</span>&nbsp;<span class="string" id="2488366">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="2488370">+</span>&nbsp;<span class="ident" id="2488372"><a href="/gostd/syscall/str.go.html#2508324">itoa</a></span><span class="op" id="2488376">(</span><span class="ident" id="2488377"><a href="/gostd/syscall/exec_linux.go.html#2488307">im</a></span><span class="op" id="2488379">.</span><span class="ident" id="2488380"><a href="/gostd/syscall/exec_linux.go.html#2479981">HostID</a></span><span class="op" id="2488386">)</span>&nbsp;<span class="op" id="2488388">+</span>&nbsp;<span class="string" id="2488390">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="2488394">+</span>&nbsp;<span class="ident" id="2488396"><a href="/gostd/syscall/str.go.html#2508324">itoa</a></span><span class="op" id="2488400">(</span><span class="ident" id="2488401"><a href="/gostd/syscall/exec_linux.go.html#2488307">im</a></span><span class="op" id="2488403">.</span><span class="ident" id="2488404"><a href="/gostd/syscall/exec_linux.go.html#2480010">Size</a></span><span class="op" id="2488408">)</span>&nbsp;<span class="op" id="2488410">+</span>&nbsp;<span class="string" id="2488412">&#34;\n&#34;</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488422">bytes</span><span class="op" id="2488427">,</span>&nbsp;<span class="ident" id="2488429"><a href="/gostd/syscall/exec_linux.go.html#2488224">err</a></span>&nbsp;<span class="op" id="2488433">:=</span>&nbsp;<span class="ident" id="2488436"><a href="/gostd/syscall/syscall.go.html#2510678">ByteSliceFromString</a></span><span class="op" id="2488455">(</span><span class="ident" id="2488456"><a href="/gostd/syscall/exec_linux.go.html#2488288">data</a></span><span class="op" id="2488460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488463">if</span>&nbsp;<span class="ident" id="2488466"><a href="/gostd/syscall/exec_linux.go.html#2488224">err</a></span>&nbsp;<span class="op" id="2488470">!=</span>&nbsp;<span class="builtintype" id="2488473">nil</span>&nbsp;<span class="op" id="2488477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488481"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2488486">(</span><span class="ident" id="2488487"><a href="/gostd/syscall/exec_linux.go.html#2488220">fd</a></span><span class="op" id="2488489">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488493">return</span>&nbsp;<span class="ident" id="2488500"><a href="/gostd/syscall/exec_linux.go.html#2488224">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488509">if</span>&nbsp;<span class="ident" id="2488512">_</span><span class="op" id="2488513">,</span>&nbsp;<span class="ident" id="2488515">err</span>&nbsp;<span class="op" id="2488519">:=</span>&nbsp;<span class="ident" id="2488522"><a href="/gostd/syscall/syscall_unix.go.html#2546723">Write</a></span><span class="op" id="2488527">(</span><span class="ident" id="2488528"><a href="/gostd/syscall/exec_linux.go.html#2488220">fd</a></span><span class="op" id="2488530">,</span>&nbsp;<span class="ident" id="2488532"><a href="/gostd/syscall/exec_linux.go.html#2488422">bytes</a></span><span class="op" id="2488537">)</span><span class="op" id="2488538">;</span>&nbsp;<span class="ident" id="2488540"><a href="/gostd/syscall/exec_linux.go.html#2488515">err</a></span>&nbsp;<span class="op" id="2488544">!=</span>&nbsp;<span class="builtintype" id="2488547">nil</span>&nbsp;<span class="op" id="2488551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488555"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2488560">(</span><span class="ident" id="2488561"><a href="/gostd/syscall/exec_linux.go.html#2488220">fd</a></span><span class="op" id="2488563">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488567">return</span>&nbsp;<span class="ident" id="2488574"><a href="/gostd/syscall/exec_linux.go.html#2488515">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488583">if</span>&nbsp;<span class="ident" id="2488586">err</span>&nbsp;<span class="op" id="2488590">:=</span>&nbsp;<span class="ident" id="2488593"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2488598">(</span><span class="ident" id="2488599"><a href="/gostd/syscall/exec_linux.go.html#2488220">fd</a></span><span class="op" id="2488601">)</span><span class="op" id="2488602">;</span>&nbsp;<span class="ident" id="2488604"><a href="/gostd/syscall/exec_linux.go.html#2488586">err</a></span>&nbsp;<span class="op" id="2488608">!=</span>&nbsp;<span class="builtintype" id="2488611">nil</span>&nbsp;<span class="op" id="2488615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488619">return</span>&nbsp;<span class="ident" id="2488626"><a href="/gostd/syscall/exec_linux.go.html#2488586">err</a></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2488631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488635">return</span>&nbsp;<span class="builtintype" id="2488642">nil</span><br>
<span class="lineno"></span><span class="op" id="2488646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="2488649">//&nbsp;writeUidGidMappings&nbsp;writes&nbsp;User&nbsp;ID&nbsp;and&nbsp;Group&nbsp;ID&nbsp;mappings&nbsp;for&nbsp;user&nbsp;namespaces</span><br>
<span class="lineno"></span><span class="comment" id="2488729">//&nbsp;for&nbsp;a&nbsp;process&nbsp;and&nbsp;it&nbsp;is&nbsp;called&nbsp;from&nbsp;the&nbsp;parent&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="2488788">func</span>&nbsp;<span class="ident" id="2488793">writeUidGidMappings</span><span class="op" id="2488812">(</span><span class="ident" id="2488813">pid</span>&nbsp;<span class="builtintype" id="2488817">int</span><span class="op" id="2488820">,</span>&nbsp;<span class="ident" id="2488822">sys</span>&nbsp;<span class="op" id="2488826">*</span><span class="ident" id="2488827"><a href="/gostd/syscall/exec_linux.go.html#2480043">SysProcAttr</a></span><span class="op" id="2488838">)</span>&nbsp;<span class="builtintype" id="2488840">error</span>&nbsp;<span class="op" id="2488846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488849">if</span>&nbsp;<span class="ident" id="2488852"><a href="/gostd/syscall/exec_linux.go.html#2488822">sys</a></span><span class="op" id="2488855">.</span><span class="ident" id="2488856"><a href="/gostd/syscall/exec_linux.go.html#2480717">UidMappings</a></span>&nbsp;<span class="op" id="2488868">!=</span>&nbsp;<span class="builtintype" id="2488871">nil</span>&nbsp;<span class="op" id="2488875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2488879">uidf</span>&nbsp;<span class="op" id="2488884">:=</span>&nbsp;<span class="string" id="2488887">&#34;/proc/&#34;</span>&nbsp;<span class="op" id="2488896">+</span>&nbsp;<span class="ident" id="2488898"><a href="/gostd/syscall/str.go.html#2508324">itoa</a></span><span class="op" id="2488902">(</span><span class="ident" id="2488903"><a href="/gostd/syscall/exec_linux.go.html#2488813">pid</a></span><span class="op" id="2488906">)</span>&nbsp;<span class="op" id="2488908">+</span>&nbsp;<span class="string" id="2488910">&#34;/uid_map&#34;</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488923">if</span>&nbsp;<span class="ident" id="2488926">err</span>&nbsp;<span class="op" id="2488930">:=</span>&nbsp;<span class="ident" id="2488933"><a href="/gostd/syscall/exec_linux.go.html#2488160">writeIDMappings</a></span><span class="op" id="2488948">(</span><span class="ident" id="2488949"><a href="/gostd/syscall/exec_linux.go.html#2488879">uidf</a></span><span class="op" id="2488953">,</span>&nbsp;<span class="ident" id="2488955"><a href="/gostd/syscall/exec_linux.go.html#2488822">sys</a></span><span class="op" id="2488958">.</span><span class="ident" id="2488959"><a href="/gostd/syscall/exec_linux.go.html#2480717">UidMappings</a></span><span class="op" id="2488970">)</span><span class="op" id="2488971">;</span>&nbsp;<span class="ident" id="2488973"><a href="/gostd/syscall/exec_linux.go.html#2488926">err</a></span>&nbsp;<span class="op" id="2488977">!=</span>&nbsp;<span class="builtintype" id="2488980">nil</span>&nbsp;<span class="op" id="2488984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2488989">return</span>&nbsp;<span class="ident" id="2488996"><a href="/gostd/syscall/exec_linux.go.html#2488926">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489009">if</span>&nbsp;<span class="ident" id="2489012"><a href="/gostd/syscall/exec_linux.go.html#2488822">sys</a></span><span class="op" id="2489015">.</span><span class="ident" id="2489016"><a href="/gostd/syscall/exec_linux.go.html#2480786">GidMappings</a></span>&nbsp;<span class="op" id="2489028">!=</span>&nbsp;<span class="builtintype" id="2489031">nil</span>&nbsp;<span class="op" id="2489035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489039">gidf</span>&nbsp;<span class="op" id="2489044">:=</span>&nbsp;<span class="string" id="2489047">&#34;/proc/&#34;</span>&nbsp;<span class="op" id="2489056">+</span>&nbsp;<span class="ident" id="2489058"><a href="/gostd/syscall/str.go.html#2508324">itoa</a></span><span class="op" id="2489062">(</span><span class="ident" id="2489063"><a href="/gostd/syscall/exec_linux.go.html#2488813">pid</a></span><span class="op" id="2489066">)</span>&nbsp;<span class="op" id="2489068">+</span>&nbsp;<span class="string" id="2489070">&#34;/gid_map&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489083">if</span>&nbsp;<span class="ident" id="2489086">err</span>&nbsp;<span class="op" id="2489090">:=</span>&nbsp;<span class="ident" id="2489093"><a href="/gostd/syscall/exec_linux.go.html#2488160">writeIDMappings</a></span><span class="op" id="2489108">(</span><span class="ident" id="2489109"><a href="/gostd/syscall/exec_linux.go.html#2489039">gidf</a></span><span class="op" id="2489113">,</span>&nbsp;<span class="ident" id="2489115"><a href="/gostd/syscall/exec_linux.go.html#2488822">sys</a></span><span class="op" id="2489118">.</span><span class="ident" id="2489119"><a href="/gostd/syscall/exec_linux.go.html#2480786">GidMappings</a></span><span class="op" id="2489130">)</span><span class="op" id="2489131">;</span>&nbsp;<span class="ident" id="2489133"><a href="/gostd/syscall/exec_linux.go.html#2489086">err</a></span>&nbsp;<span class="op" id="2489137">!=</span>&nbsp;<span class="builtintype" id="2489140">nil</span>&nbsp;<span class="op" id="2489144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489149">return</span>&nbsp;<span class="ident" id="2489156"><a href="/gostd/syscall/exec_linux.go.html#2489086">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489162">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2489165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2489169">return</span>&nbsp;<span class="builtintype" id="2489176">nil</span><br>
<span class="lineno"></span><span class="op" id="2489180">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
