<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html" class="current">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3004806">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3004861">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3004915">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3004966">//&nbsp;Package&nbsp;ecdsa&nbsp;implements&nbsp;the&nbsp;Elliptic&nbsp;Curve&nbsp;Digital&nbsp;Signature&nbsp;Algorithm,&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3005045">//&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="3005071">package</span>&nbsp;<span class="ident" id="3005079">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3005086">//&nbsp;References:</span><br>
<span class="lineno">10</span><span class="comment" id="3005101">//&nbsp;&nbsp;&nbsp;[NSA]:&nbsp;Suite&nbsp;B&nbsp;implementer&#39;s&nbsp;guide&nbsp;to&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="3005156">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.nsa.gov/ia/_files/ecdsa.pdf</span><br>
<span class="lineno"></span><span class="comment" id="3005202">//&nbsp;&nbsp;&nbsp;[SECG]:&nbsp;SECG,&nbsp;SEC1</span><br>
<span class="lineno"></span><span class="comment" id="3005226">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3005283">import</span>&nbsp;<span class="op" id="3005290">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3005293">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3005303">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3005322">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3005339">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3005345">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3005356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3005359">//&nbsp;PublicKey&nbsp;represents&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3005404">type</span>&nbsp;<span class="ident" id="3005409">PublicKey</span>&nbsp;<span class="keyword" id="3005419">struct</span>&nbsp;<span class="op" id="3005426">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3005429"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005303">elliptic</a></span><span class="op" id="3005437">.</span><span class="ident" id="3005438"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3005445">X</span><span class="op" id="3005446">,</span>&nbsp;<span class="ident" id="3005448">Y</span>&nbsp;<span class="op" id="3005450">*</span><span class="ident" id="3005451"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3005454">.</span><span class="ident" id="3005455"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><span class="op" id="3005459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3005462">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;ECDSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">30</span><span class="keyword" id="3005508">type</span>&nbsp;<span class="ident" id="3005513">PrivateKey</span>&nbsp;<span class="keyword" id="3005524">struct</span>&nbsp;<span class="op" id="3005531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3005534"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3005545">D</span>&nbsp;<span class="op" id="3005547">*</span><span class="ident" id="3005548"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3005551">.</span><span class="ident" id="3005552"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><span class="op" id="3005556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="3005559">type</span>&nbsp;<span class="ident" id="3005564">ecdsaSignature</span>&nbsp;<span class="keyword" id="3005579">struct</span>&nbsp;<span class="op" id="3005586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3005589">R</span><span class="op" id="3005590">,</span>&nbsp;<span class="ident" id="3005592">S</span>&nbsp;<span class="op" id="3005594">*</span><span class="ident" id="3005595"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3005598">.</span><span class="ident" id="3005599"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><span class="op" id="3005603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3005606">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;priv.</span><br>
<span class="lineno">40</span><span class="keyword" id="3005662">func</span>&nbsp;<span class="op" id="3005667">(</span><span class="ident" id="3005668">priv</span>&nbsp;<span class="op" id="3005673">*</span><span class="ident" id="3005674"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="3005684">)</span>&nbsp;<span class="ident" id="3005686">Public</span><span class="op" id="3005692">(</span><span class="op" id="3005693">)</span>&nbsp;<span class="ident" id="3005695"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005293">crypto</a></span><span class="op" id="3005701">.</span><span class="ident" id="3005702"><a href="/gostd/crypto/crypto.go.html#3012471">PublicKey</a></span>&nbsp;<span class="op" id="3005712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3005715">return</span>&nbsp;<span class="op" id="3005722">&amp;</span><span class="ident" id="3005723"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005668">priv</a></span><span class="op" id="3005727">.</span><span class="ident" id="3005728"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><br>
<span class="lineno"></span><span class="op" id="3005738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3005741">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;priv,&nbsp;reading&nbsp;randomness&nbsp;from&nbsp;rand.&nbsp;This&nbsp;method&nbsp;is</span><br>
<span class="lineno">45</span><span class="comment" id="3005815">//&nbsp;intended&nbsp;to&nbsp;support&nbsp;keys&nbsp;where&nbsp;the&nbsp;private&nbsp;part&nbsp;is&nbsp;kept&nbsp;in,&nbsp;for&nbsp;example,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3005893">//&nbsp;hardware&nbsp;module.&nbsp;Common&nbsp;uses&nbsp;should&nbsp;use&nbsp;the&nbsp;Sign&nbsp;function&nbsp;in&nbsp;this&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="3005970">//&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="3005983">func</span>&nbsp;<span class="op" id="3005988">(</span><span class="ident" id="3005989">priv</span>&nbsp;<span class="op" id="3005994">*</span><span class="ident" id="3005995"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="3006005">)</span>&nbsp;<span class="ident" id="3006007">Sign</span><span class="op" id="3006011">(</span><span class="ident" id="3006012">rand</span>&nbsp;<span class="ident" id="3006017"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005339">io</a></span><span class="op" id="3006019">.</span><span class="ident" id="3006020"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3006026">,</span>&nbsp;<span class="ident" id="3006028">msg</span>&nbsp;<span class="op" id="3006032">[</span><span class="op" id="3006033">]</span><span class="builtintype" id="3006034">byte</span><span class="op" id="3006038">,</span>&nbsp;<span class="ident" id="3006040">opts</span>&nbsp;<span class="ident" id="3006045"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005293">crypto</a></span><span class="op" id="3006051">.</span><span class="ident" id="3006052"><a href="/gostd/crypto/crypto.go.html#3013580">SignerOpts</a></span><span class="op" id="3006062">)</span>&nbsp;<span class="op" id="3006064">(</span><span class="op" id="3006065">[</span><span class="op" id="3006066">]</span><span class="builtintype" id="3006067">byte</span><span class="op" id="3006071">,</span>&nbsp;<span class="builtintype" id="3006073">error</span><span class="op" id="3006078">)</span>&nbsp;<span class="op" id="3006080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006083">r</span><span class="op" id="3006084">,</span>&nbsp;<span class="ident" id="3006086">s</span><span class="op" id="3006087">,</span>&nbsp;<span class="ident" id="3006089">err</span>&nbsp;<span class="op" id="3006093">:=</span>&nbsp;<span class="ident" id="3006096"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008419">Sign</a></span><span class="op" id="3006100">(</span><span class="ident" id="3006101"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006012">rand</a></span><span class="op" id="3006105">,</span>&nbsp;<span class="ident" id="3006107"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005989">priv</a></span><span class="op" id="3006111">,</span>&nbsp;<span class="ident" id="3006113"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006028">msg</a></span><span class="op" id="3006116">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006119">if</span>&nbsp;<span class="ident" id="3006122"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006089">err</a></span>&nbsp;<span class="op" id="3006126">!=</span>&nbsp;<span class="builtintype" id="3006129">nil</span>&nbsp;<span class="op" id="3006133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006137">return</span>&nbsp;<span class="builtintype" id="3006144">nil</span><span class="op" id="3006147">,</span>&nbsp;<span class="ident" id="3006149"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006089">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3006154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006158">return</span>&nbsp;<span class="ident" id="3006165"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005322">asn1</a></span><span class="op" id="3006169">.</span><span class="ident" id="3006170"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="3006177">(</span><span class="ident" id="3006178"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005564">ecdsaSignature</a></span><span class="op" id="3006192">{</span><span class="ident" id="3006193"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006083">r</a></span><span class="op" id="3006194">,</span>&nbsp;<span class="ident" id="3006196"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006086">s</a></span><span class="op" id="3006197">}</span><span class="op" id="3006198">)</span><br>
<span class="lineno">55</span><span class="op" id="3006200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3006203">var</span>&nbsp;<span class="ident" id="3006207">one</span>&nbsp;<span class="op" id="3006211">=</span>&nbsp;<span class="builtinfunc" id="3006213">new</span><span class="op" id="3006216">(</span><span class="ident" id="3006217"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3006220">.</span><span class="ident" id="3006221"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3006224">)</span><span class="op" id="3006225">.</span><span class="ident" id="3006226"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="3006234">(</span><span class="num" id="3006235">1</span><span class="op" id="3006236">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3006239">//&nbsp;randFieldElement&nbsp;returns&nbsp;a&nbsp;random&nbsp;element&nbsp;of&nbsp;the&nbsp;field&nbsp;underlying&nbsp;the&nbsp;given</span><br>
<span class="lineno">60</span><span class="comment" id="3006318">//&nbsp;curve&nbsp;using&nbsp;the&nbsp;procedure&nbsp;given&nbsp;in&nbsp;[NSA]&nbsp;A.2.1.</span><br>
<span class="lineno"></span><span class="keyword" id="3006369">func</span>&nbsp;<span class="ident" id="3006374">randFieldElement</span><span class="op" id="3006390">(</span><span class="ident" id="3006391">c</span>&nbsp;<span class="ident" id="3006393"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005303">elliptic</a></span><span class="op" id="3006401">.</span><span class="ident" id="3006402"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="3006407">,</span>&nbsp;<span class="ident" id="3006409">rand</span>&nbsp;<span class="ident" id="3006414"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005339">io</a></span><span class="op" id="3006416">.</span><span class="ident" id="3006417"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3006423">)</span>&nbsp;<span class="op" id="3006425">(</span><span class="ident" id="3006426">k</span>&nbsp;<span class="op" id="3006428">*</span><span class="ident" id="3006429"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3006432">.</span><span class="ident" id="3006433"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3006436">,</span>&nbsp;<span class="ident" id="3006438">err</span>&nbsp;<span class="builtintype" id="3006442">error</span><span class="op" id="3006447">)</span>&nbsp;<span class="op" id="3006449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006452">params</span>&nbsp;<span class="op" id="3006459">:=</span>&nbsp;<span class="ident" id="3006462"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006391">c</a></span><span class="op" id="3006463">.</span><span class="ident" id="3006464"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3006470">(</span><span class="op" id="3006471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006474">b</span>&nbsp;<span class="op" id="3006476">:=</span>&nbsp;<span class="builtinfunc" id="3006479">make</span><span class="op" id="3006483">(</span><span class="op" id="3006484">[</span><span class="op" id="3006485">]</span><span class="builtintype" id="3006486">byte</span><span class="op" id="3006490">,</span>&nbsp;<span class="ident" id="3006492"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006452">params</a></span><span class="op" id="3006498">.</span><span class="ident" id="3006499"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016879">BitSize</a></span><span class="op" id="3006506">/</span><span class="num" id="3006507">8</span><span class="op" id="3006508">+</span><span class="num" id="3006509">8</span><span class="op" id="3006510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006513">_</span><span class="op" id="3006514">,</span>&nbsp;<span class="ident" id="3006516"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006438">err</a></span>&nbsp;<span class="op" id="3006520">=</span>&nbsp;<span class="ident" id="3006522"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005339">io</a></span><span class="op" id="3006524">.</span><span class="ident" id="3006525"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="3006533">(</span><span class="ident" id="3006534"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006409">rand</a></span><span class="op" id="3006538">,</span>&nbsp;<span class="ident" id="3006540"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006474">b</a></span><span class="op" id="3006541">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006544">if</span>&nbsp;<span class="ident" id="3006547"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006438">err</a></span>&nbsp;<span class="op" id="3006551">!=</span>&nbsp;<span class="builtintype" id="3006554">nil</span>&nbsp;<span class="op" id="3006558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3006570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006574"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006426">k</a></span>&nbsp;<span class="op" id="3006576">=</span>&nbsp;<span class="builtinfunc" id="3006578">new</span><span class="op" id="3006581">(</span><span class="ident" id="3006582"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3006585">.</span><span class="ident" id="3006586"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3006589">)</span><span class="op" id="3006590">.</span><span class="ident" id="3006591"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="3006599">(</span><span class="ident" id="3006600"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006474">b</a></span><span class="op" id="3006601">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006604">n</span>&nbsp;<span class="op" id="3006606">:=</span>&nbsp;<span class="builtinfunc" id="3006609">new</span><span class="op" id="3006612">(</span><span class="ident" id="3006613"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3006616">.</span><span class="ident" id="3006617"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3006620">)</span><span class="op" id="3006621">.</span><span class="ident" id="3006622"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3006625">(</span><span class="ident" id="3006626"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006452">params</a></span><span class="op" id="3006632">.</span><span class="ident" id="3006633"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><span class="op" id="3006634">,</span>&nbsp;<span class="ident" id="3006636"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006207">one</a></span><span class="op" id="3006639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006642"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006426">k</a></span><span class="op" id="3006643">.</span><span class="ident" id="3006644"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3006647">(</span><span class="ident" id="3006648"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006426">k</a></span><span class="op" id="3006649">,</span>&nbsp;<span class="ident" id="3006651"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006604">n</a></span><span class="op" id="3006652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006655"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006426">k</a></span><span class="op" id="3006656">.</span><span class="ident" id="3006657"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3006660">(</span><span class="ident" id="3006661"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006426">k</a></span><span class="op" id="3006662">,</span>&nbsp;<span class="ident" id="3006664"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006207">one</a></span><span class="op" id="3006667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006670">return</span><br>
<span class="lineno"></span><span class="op" id="3006677">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3006680">//&nbsp;GenerateKey&nbsp;generates&nbsp;a&nbsp;public&nbsp;and&nbsp;private&nbsp;key&nbsp;pair.</span><br>
<span class="lineno"></span><span class="keyword" id="3006736">func</span>&nbsp;<span class="ident" id="3006741">GenerateKey</span><span class="op" id="3006752">(</span><span class="ident" id="3006753">c</span>&nbsp;<span class="ident" id="3006755"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005303">elliptic</a></span><span class="op" id="3006763">.</span><span class="ident" id="3006764"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="3006769">,</span>&nbsp;<span class="ident" id="3006771">rand</span>&nbsp;<span class="ident" id="3006776"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005339">io</a></span><span class="op" id="3006778">.</span><span class="ident" id="3006779"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3006785">)</span>&nbsp;<span class="op" id="3006787">(</span><span class="ident" id="3006788">priv</span>&nbsp;<span class="op" id="3006793">*</span><span class="ident" id="3006794"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="3006804">,</span>&nbsp;<span class="ident" id="3006806">err</span>&nbsp;<span class="builtintype" id="3006810">error</span><span class="op" id="3006815">)</span>&nbsp;<span class="op" id="3006817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006820">k</span><span class="op" id="3006821">,</span>&nbsp;<span class="ident" id="3006823"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006806">err</a></span>&nbsp;<span class="op" id="3006827">:=</span>&nbsp;<span class="ident" id="3006830"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006374">randFieldElement</a></span><span class="op" id="3006846">(</span><span class="ident" id="3006847"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006753">c</a></span><span class="op" id="3006848">,</span>&nbsp;<span class="ident" id="3006850"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006771">rand</a></span><span class="op" id="3006854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006857">if</span>&nbsp;<span class="ident" id="3006860"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006806">err</a></span>&nbsp;<span class="op" id="3006864">!=</span>&nbsp;<span class="builtintype" id="3006867">nil</span>&nbsp;<span class="op" id="3006871">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3006875">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3006883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006887"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006788">priv</a></span>&nbsp;<span class="op" id="3006892">=</span>&nbsp;<span class="builtinfunc" id="3006894">new</span><span class="op" id="3006897">(</span><span class="ident" id="3006898"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="3006908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006911"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006788">priv</a></span><span class="op" id="3006915">.</span><span class="ident" id="3006916"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="3006925">.</span><span class="ident" id="3006926"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="3006932">=</span>&nbsp;<span class="ident" id="3006934"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006753">c</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006937"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006788">priv</a></span><span class="op" id="3006941">.</span><span class="ident" id="3006942"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005545">D</a></span>&nbsp;<span class="op" id="3006944">=</span>&nbsp;<span class="ident" id="3006946"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006820">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3006949"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006788">priv</a></span><span class="op" id="3006953">.</span><span class="ident" id="3006954"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="3006963">.</span><span class="ident" id="3006964"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="3006965">,</span>&nbsp;<span class="ident" id="3006967"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006788">priv</a></span><span class="op" id="3006971">.</span><span class="ident" id="3006972"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="3006981">.</span><span class="ident" id="3006982"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span>&nbsp;<span class="op" id="3006984">=</span>&nbsp;<span class="ident" id="3006986"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006753">c</a></span><span class="op" id="3006987">.</span><span class="ident" id="3006988"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016468">ScalarBaseMult</a></span><span class="op" id="3007002">(</span><span class="ident" id="3007003"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006820">k</a></span><span class="op" id="3007004">.</span><span class="ident" id="3007005"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="3007010">(</span><span class="op" id="3007011">)</span><span class="op" id="3007012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3007015">return</span><br>
<span class="lineno"></span><span class="op" id="3007022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="3007025">//&nbsp;hashToInt&nbsp;converts&nbsp;a&nbsp;hash&nbsp;value&nbsp;to&nbsp;an&nbsp;integer.&nbsp;There&nbsp;is&nbsp;some&nbsp;disagreement</span><br>
<span class="lineno"></span><span class="comment" id="3007102">//&nbsp;about&nbsp;how&nbsp;this&nbsp;is&nbsp;done.&nbsp;[NSA]&nbsp;suggests&nbsp;that&nbsp;this&nbsp;is&nbsp;done&nbsp;in&nbsp;the&nbsp;obvious</span><br>
<span class="lineno"></span><span class="comment" id="3007177">//&nbsp;manner,&nbsp;but&nbsp;[SECG]&nbsp;truncates&nbsp;the&nbsp;hash&nbsp;to&nbsp;the&nbsp;bit-length&nbsp;of&nbsp;the&nbsp;curve&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="3007255">//&nbsp;first.&nbsp;We&nbsp;follow&nbsp;[SECG]&nbsp;because&nbsp;that&#39;s&nbsp;what&nbsp;OpenSSL&nbsp;does.&nbsp;Additionally,</span><br>
<span class="lineno"></span><span class="comment" id="3007330">//&nbsp;OpenSSL&nbsp;right&nbsp;shifts&nbsp;excess&nbsp;bits&nbsp;from&nbsp;the&nbsp;number&nbsp;if&nbsp;the&nbsp;hash&nbsp;is&nbsp;too&nbsp;large</span><br>
<span class="lineno">95</span><span class="comment" id="3007407">//&nbsp;and&nbsp;we&nbsp;mirror&nbsp;that&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="3007434">func</span>&nbsp;<span class="ident" id="3007439">hashToInt</span><span class="op" id="3007448">(</span><span class="ident" id="3007449">hash</span>&nbsp;<span class="op" id="3007454">[</span><span class="op" id="3007455">]</span><span class="builtintype" id="3007456">byte</span><span class="op" id="3007460">,</span>&nbsp;<span class="ident" id="3007462">c</span>&nbsp;<span class="ident" id="3007464"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005303">elliptic</a></span><span class="op" id="3007472">.</span><span class="ident" id="3007473"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="3007478">)</span>&nbsp;<span class="op" id="3007480">*</span><span class="ident" id="3007481"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3007484">.</span><span class="ident" id="3007485"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="3007489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3007492">orderBits</span>&nbsp;<span class="op" id="3007502">:=</span>&nbsp;<span class="ident" id="3007505"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007462">c</a></span><span class="op" id="3007506">.</span><span class="ident" id="3007507"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3007513">(</span><span class="op" id="3007514">)</span><span class="op" id="3007515">.</span><span class="ident" id="3007516"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><span class="op" id="3007517">.</span><span class="ident" id="3007518"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="3007524">(</span><span class="op" id="3007525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3007528">orderBytes</span>&nbsp;<span class="op" id="3007539">:=</span>&nbsp;<span class="op" id="3007542">(</span><span class="ident" id="3007543"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007492">orderBits</a></span>&nbsp;<span class="op" id="3007553">+</span>&nbsp;<span class="num" id="3007555">7</span><span class="op" id="3007556">)</span>&nbsp;<span class="op" id="3007558">/</span>&nbsp;<span class="num" id="3007560">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3007563">if</span>&nbsp;<span class="builtinfunc" id="3007566">len</span><span class="op" id="3007569">(</span><span class="ident" id="3007570"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007449">hash</a></span><span class="op" id="3007574">)</span>&nbsp;<span class="op" id="3007576">&gt;</span>&nbsp;<span class="ident" id="3007578"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007528">orderBytes</a></span>&nbsp;<span class="op" id="3007589">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3007593"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007449">hash</a></span>&nbsp;<span class="op" id="3007598">=</span>&nbsp;<span class="ident" id="3007600"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007449">hash</a></span><span class="op" id="3007604">[</span><span class="op" id="3007605">:</span><span class="ident" id="3007606"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007528">orderBytes</a></span><span class="op" id="3007616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3007619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3007623">ret</span>&nbsp;<span class="op" id="3007627">:=</span>&nbsp;<span class="builtinfunc" id="3007630">new</span><span class="op" id="3007633">(</span><span class="ident" id="3007634"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3007637">.</span><span class="ident" id="3007638"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3007641">)</span><span class="op" id="3007642">.</span><span class="ident" id="3007643"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="3007651">(</span><span class="ident" id="3007652"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007449">hash</a></span><span class="op" id="3007656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3007659">excess</span>&nbsp;<span class="op" id="3007666">:=</span>&nbsp;<span class="builtinfunc" id="3007669">len</span><span class="op" id="3007672">(</span><span class="ident" id="3007673"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007449">hash</a></span><span class="op" id="3007677">)</span><span class="op" id="3007678">*</span><span class="num" id="3007679">8</span>&nbsp;<span class="op" id="3007681">-</span>&nbsp;<span class="ident" id="3007683"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007492">orderBits</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3007694">if</span>&nbsp;<span class="ident" id="3007697"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007659">excess</a></span>&nbsp;<span class="op" id="3007704">&gt;</span>&nbsp;<span class="num" id="3007706">0</span>&nbsp;<span class="op" id="3007708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3007712"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007623">ret</a></span><span class="op" id="3007715">.</span><span class="ident" id="3007716"><a href="/gostd/math/big/int.go.html#2054324">Rsh</a></span><span class="op" id="3007719">(</span><span class="ident" id="3007720"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007623">ret</a></span><span class="op" id="3007723">,</span>&nbsp;<span class="builtintype" id="3007725">uint</span><span class="op" id="3007729">(</span><span class="ident" id="3007730"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007659">excess</a></span><span class="op" id="3007736">)</span><span class="op" id="3007737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3007740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3007743">return</span>&nbsp;<span class="ident" id="3007750"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007623">ret</a></span><br>
<span class="lineno"></span><span class="op" id="3007754">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3007757">//&nbsp;fermatInverse&nbsp;calculates&nbsp;the&nbsp;inverse&nbsp;of&nbsp;k&nbsp;in&nbsp;GF(P)&nbsp;using&nbsp;Fermat&#39;s&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="3007834">//&nbsp;This&nbsp;has&nbsp;better&nbsp;constant-time&nbsp;properties&nbsp;than&nbsp;Euclid&#39;s&nbsp;method&nbsp;(implemented</span><br>
<span class="lineno"></span><span class="comment" id="3007912">//&nbsp;in&nbsp;math/big.Int.ModInverse)&nbsp;although&nbsp;math/big&nbsp;itself&nbsp;isn&#39;t&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="3007983">//&nbsp;constant-time&nbsp;so&nbsp;it&#39;s&nbsp;not&nbsp;perfect.</span><br>
<span class="lineno">115</span><span class="keyword" id="3008021">func</span>&nbsp;<span class="ident" id="3008026">fermatInverse</span><span class="op" id="3008039">(</span><span class="ident" id="3008040">k</span><span class="op" id="3008041">,</span>&nbsp;<span class="ident" id="3008043">N</span>&nbsp;<span class="op" id="3008045">*</span><span class="ident" id="3008046"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008049">.</span><span class="ident" id="3008050"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3008053">)</span>&nbsp;<span class="op" id="3008055">*</span><span class="ident" id="3008056"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008059">.</span><span class="ident" id="3008060"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="3008064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008067">two</span>&nbsp;<span class="op" id="3008071">:=</span>&nbsp;<span class="ident" id="3008074"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008077">.</span><span class="ident" id="3008078"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="3008084">(</span><span class="num" id="3008085">2</span><span class="op" id="3008086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008089">nMinus2</span>&nbsp;<span class="op" id="3008097">:=</span>&nbsp;<span class="builtinfunc" id="3008100">new</span><span class="op" id="3008103">(</span><span class="ident" id="3008104"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008107">.</span><span class="ident" id="3008108"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3008111">)</span><span class="op" id="3008112">.</span><span class="ident" id="3008113"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="3008116">(</span><span class="ident" id="3008117"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008043">N</a></span><span class="op" id="3008118">,</span>&nbsp;<span class="ident" id="3008120"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008067">two</a></span><span class="op" id="3008123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008126">return</span>&nbsp;<span class="builtinfunc" id="3008133">new</span><span class="op" id="3008136">(</span><span class="ident" id="3008137"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008140">.</span><span class="ident" id="3008141"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3008144">)</span><span class="op" id="3008145">.</span><span class="ident" id="3008146"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="3008149">(</span><span class="ident" id="3008150"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008040">k</a></span><span class="op" id="3008151">,</span>&nbsp;<span class="ident" id="3008153"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008089">nMinus2</a></span><span class="op" id="3008160">,</span>&nbsp;<span class="ident" id="3008162"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008043">N</a></span><span class="op" id="3008163">)</span><br>
<span class="lineno"></span><span class="op" id="3008165">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="3008168">//&nbsp;Sign&nbsp;signs&nbsp;an&nbsp;arbitrary&nbsp;length&nbsp;hash&nbsp;(which&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3008248">//&nbsp;larger&nbsp;message)&nbsp;using&nbsp;the&nbsp;private&nbsp;key,&nbsp;priv.&nbsp;It&nbsp;returns&nbsp;the&nbsp;signature&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3008326">//&nbsp;pair&nbsp;of&nbsp;integers.&nbsp;The&nbsp;security&nbsp;of&nbsp;the&nbsp;private&nbsp;key&nbsp;depends&nbsp;on&nbsp;the&nbsp;entropy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3008405">//&nbsp;rand.</span><br>
<span class="lineno">125</span><span class="keyword" id="3008414">func</span>&nbsp;<span class="ident" id="3008419">Sign</span><span class="op" id="3008423">(</span><span class="ident" id="3008424">rand</span>&nbsp;<span class="ident" id="3008429"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005339">io</a></span><span class="op" id="3008431">.</span><span class="ident" id="3008432"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="3008438">,</span>&nbsp;<span class="ident" id="3008440">priv</span>&nbsp;<span class="op" id="3008445">*</span><span class="ident" id="3008446"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="3008456">,</span>&nbsp;<span class="ident" id="3008458">hash</span>&nbsp;<span class="op" id="3008463">[</span><span class="op" id="3008464">]</span><span class="builtintype" id="3008465">byte</span><span class="op" id="3008469">)</span>&nbsp;<span class="op" id="3008471">(</span><span class="ident" id="3008472">r</span><span class="op" id="3008473">,</span>&nbsp;<span class="ident" id="3008475">s</span>&nbsp;<span class="op" id="3008477">*</span><span class="ident" id="3008478"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008481">.</span><span class="ident" id="3008482"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3008485">,</span>&nbsp;<span class="ident" id="3008487">err</span>&nbsp;<span class="builtintype" id="3008491">error</span><span class="op" id="3008496">)</span>&nbsp;<span class="op" id="3008498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3008501">//&nbsp;See&nbsp;[NSA]&nbsp;3.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008521">c</span>&nbsp;<span class="op" id="3008523">:=</span>&nbsp;<span class="ident" id="3008526"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008440">priv</a></span><span class="op" id="3008530">.</span><span class="ident" id="3008531"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="3008540">.</span><span class="ident" id="3008541"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008548">N</span>&nbsp;<span class="op" id="3008550">:=</span>&nbsp;<span class="ident" id="3008553"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008521">c</a></span><span class="op" id="3008554">.</span><span class="ident" id="3008555"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3008561">(</span><span class="op" id="3008562">)</span><span class="op" id="3008563">.</span><span class="ident" id="3008564"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008568">var</span>&nbsp;<span class="ident" id="3008572">k</span><span class="op" id="3008573">,</span>&nbsp;<span class="ident" id="3008575">kInv</span>&nbsp;<span class="op" id="3008580">*</span><span class="ident" id="3008581"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008584">.</span><span class="ident" id="3008585"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008590">for</span>&nbsp;<span class="op" id="3008594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008598">for</span>&nbsp;<span class="op" id="3008602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008607"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008572">k</a></span><span class="op" id="3008608">,</span>&nbsp;<span class="ident" id="3008610"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008487">err</a></span>&nbsp;<span class="op" id="3008614">=</span>&nbsp;<span class="ident" id="3008616"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006374">randFieldElement</a></span><span class="op" id="3008632">(</span><span class="ident" id="3008633"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008521">c</a></span><span class="op" id="3008634">,</span>&nbsp;<span class="ident" id="3008636"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008424">rand</a></span><span class="op" id="3008640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008645">if</span>&nbsp;<span class="ident" id="3008648"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008487">err</a></span>&nbsp;<span class="op" id="3008652">!=</span>&nbsp;<span class="builtintype" id="3008655">nil</span>&nbsp;<span class="op" id="3008659">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008665"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008472">r</a></span>&nbsp;<span class="op" id="3008667">=</span>&nbsp;<span class="builtintype" id="3008669">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008677">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3008687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008693"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008575">kInv</a></span>&nbsp;<span class="op" id="3008698">=</span>&nbsp;<span class="ident" id="3008700"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008026">fermatInverse</a></span><span class="op" id="3008713">(</span><span class="ident" id="3008714"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008572">k</a></span><span class="op" id="3008715">,</span>&nbsp;<span class="ident" id="3008717"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008548">N</a></span><span class="op" id="3008718">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008723"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008472">r</a></span><span class="op" id="3008724">,</span>&nbsp;<span class="ident" id="3008726">_</span>&nbsp;<span class="op" id="3008728">=</span>&nbsp;<span class="ident" id="3008730"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008440">priv</a></span><span class="op" id="3008734">.</span><span class="ident" id="3008735"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><span class="op" id="3008740">.</span><span class="ident" id="3008741"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016468">ScalarBaseMult</a></span><span class="op" id="3008755">(</span><span class="ident" id="3008756"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008572">k</a></span><span class="op" id="3008757">.</span><span class="ident" id="3008758"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="3008763">(</span><span class="op" id="3008764">)</span><span class="op" id="3008765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008770"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008472">r</a></span><span class="op" id="3008771">.</span><span class="ident" id="3008772"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3008775">(</span><span class="ident" id="3008776"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008472">r</a></span><span class="op" id="3008777">,</span>&nbsp;<span class="ident" id="3008779"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008548">N</a></span><span class="op" id="3008780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008785">if</span>&nbsp;<span class="ident" id="3008788"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008472">r</a></span><span class="op" id="3008789">.</span><span class="ident" id="3008790"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3008794">(</span><span class="op" id="3008795">)</span>&nbsp;<span class="op" id="3008797">!=</span>&nbsp;<span class="num" id="3008800">0</span>&nbsp;<span class="op" id="3008802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008808">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3008817">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3008821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008826">e</span>&nbsp;<span class="op" id="3008828">:=</span>&nbsp;<span class="ident" id="3008831"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007439">hashToInt</a></span><span class="op" id="3008840">(</span><span class="ident" id="3008841"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008458">hash</a></span><span class="op" id="3008845">,</span>&nbsp;<span class="ident" id="3008847"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008521">c</a></span><span class="op" id="3008848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008852"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span>&nbsp;<span class="op" id="3008854">=</span>&nbsp;<span class="builtinfunc" id="3008856">new</span><span class="op" id="3008859">(</span><span class="ident" id="3008860"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3008863">.</span><span class="ident" id="3008864"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3008867">)</span><span class="op" id="3008868">.</span><span class="ident" id="3008869"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3008872">(</span><span class="ident" id="3008873"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008440">priv</a></span><span class="op" id="3008877">.</span><span class="ident" id="3008878"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005545">D</a></span><span class="op" id="3008879">,</span>&nbsp;<span class="ident" id="3008881"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008472">r</a></span><span class="op" id="3008882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008886"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008887">.</span><span class="ident" id="3008888"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3008891">(</span><span class="ident" id="3008892"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008893">,</span>&nbsp;<span class="ident" id="3008895"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008826">e</a></span><span class="op" id="3008896">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008900"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008901">.</span><span class="ident" id="3008902"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3008905">(</span><span class="ident" id="3008906"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008907">,</span>&nbsp;<span class="ident" id="3008909"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008575">kInv</a></span><span class="op" id="3008913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3008917"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008918">.</span><span class="ident" id="3008919"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3008922">(</span><span class="ident" id="3008923"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008924">,</span>&nbsp;<span class="ident" id="3008926"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008548">N</a></span><span class="op" id="3008927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008931">if</span>&nbsp;<span class="ident" id="3008934"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008475">s</a></span><span class="op" id="3008935">.</span><span class="ident" id="3008936"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3008940">(</span><span class="op" id="3008941">)</span>&nbsp;<span class="op" id="3008943">!=</span>&nbsp;<span class="num" id="3008946">0</span>&nbsp;<span class="op" id="3008948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008953">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3008961">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3008964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3008968">return</span><br>
<span class="lineno"></span><span class="op" id="3008975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="3008978">//&nbsp;Verify&nbsp;verifies&nbsp;the&nbsp;signature&nbsp;in&nbsp;r,&nbsp;s&nbsp;of&nbsp;hash&nbsp;using&nbsp;the&nbsp;public&nbsp;key,&nbsp;pub.&nbsp;Its</span><br>
<span class="lineno"></span><span class="comment" id="3009058">//&nbsp;return&nbsp;value&nbsp;records&nbsp;whether&nbsp;the&nbsp;signature&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="3009114">func</span>&nbsp;<span class="ident" id="3009119">Verify</span><span class="op" id="3009125">(</span><span class="ident" id="3009126">pub</span>&nbsp;<span class="op" id="3009130">*</span><span class="ident" id="3009131"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><span class="op" id="3009140">,</span>&nbsp;<span class="ident" id="3009142">hash</span>&nbsp;<span class="op" id="3009147">[</span><span class="op" id="3009148">]</span><span class="builtintype" id="3009149">byte</span><span class="op" id="3009153">,</span>&nbsp;<span class="ident" id="3009155">r</span><span class="op" id="3009156">,</span>&nbsp;<span class="ident" id="3009158">s</span>&nbsp;<span class="op" id="3009160">*</span><span class="ident" id="3009161"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3009164">.</span><span class="ident" id="3009165"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3009168">)</span>&nbsp;<span class="builtintype" id="3009170">bool</span>&nbsp;<span class="op" id="3009175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3009178">//&nbsp;See&nbsp;[NSA]&nbsp;3.4.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009198">c</span>&nbsp;<span class="op" id="3009200">:=</span>&nbsp;<span class="ident" id="3009203"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009126">pub</a></span><span class="op" id="3009206">.</span><span class="ident" id="3009207"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009214">N</span>&nbsp;<span class="op" id="3009216">:=</span>&nbsp;<span class="ident" id="3009219"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009198">c</a></span><span class="op" id="3009220">.</span><span class="ident" id="3009221"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015945">Params</a></span><span class="op" id="3009227">(</span><span class="op" id="3009228">)</span><span class="op" id="3009229">.</span><span class="ident" id="3009230"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016729">N</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009234">if</span>&nbsp;<span class="ident" id="3009237"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009155">r</a></span><span class="op" id="3009238">.</span><span class="ident" id="3009239"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3009243">(</span><span class="op" id="3009244">)</span>&nbsp;<span class="op" id="3009246">==</span>&nbsp;<span class="num" id="3009249">0</span>&nbsp;<span class="op" id="3009251">||</span>&nbsp;<span class="ident" id="3009254"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009158">s</a></span><span class="op" id="3009255">.</span><span class="ident" id="3009256"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3009260">(</span><span class="op" id="3009261">)</span>&nbsp;<span class="op" id="3009263">==</span>&nbsp;<span class="num" id="3009266">0</span>&nbsp;<span class="op" id="3009268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009272">return</span>&nbsp;<span class="builtintype" id="3009279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3009286">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009289">if</span>&nbsp;<span class="ident" id="3009292"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009155">r</a></span><span class="op" id="3009293">.</span><span class="ident" id="3009294"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="3009297">(</span><span class="ident" id="3009298"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009214">N</a></span><span class="op" id="3009299">)</span>&nbsp;<span class="op" id="3009301">&gt;=</span>&nbsp;<span class="num" id="3009304">0</span>&nbsp;<span class="op" id="3009306">||</span>&nbsp;<span class="ident" id="3009309"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009158">s</a></span><span class="op" id="3009310">.</span><span class="ident" id="3009311"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="3009314">(</span><span class="ident" id="3009315"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009214">N</a></span><span class="op" id="3009316">)</span>&nbsp;<span class="op" id="3009318">&gt;=</span>&nbsp;<span class="num" id="3009321">0</span>&nbsp;<span class="op" id="3009323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009327">return</span>&nbsp;<span class="builtintype" id="3009334">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3009341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009344">e</span>&nbsp;<span class="op" id="3009346">:=</span>&nbsp;<span class="ident" id="3009349"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3007439">hashToInt</a></span><span class="op" id="3009358">(</span><span class="ident" id="3009359"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009142">hash</a></span><span class="op" id="3009363">,</span>&nbsp;<span class="ident" id="3009365"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009198">c</a></span><span class="op" id="3009366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009369">w</span>&nbsp;<span class="op" id="3009371">:=</span>&nbsp;<span class="builtinfunc" id="3009374">new</span><span class="op" id="3009377">(</span><span class="ident" id="3009378"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005345">big</a></span><span class="op" id="3009381">.</span><span class="ident" id="3009382"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3009385">)</span><span class="op" id="3009386">.</span><span class="ident" id="3009387"><a href="/gostd/math/big/int.go.html#2053864">ModInverse</a></span><span class="op" id="3009397">(</span><span class="ident" id="3009398"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009158">s</a></span><span class="op" id="3009399">,</span>&nbsp;<span class="ident" id="3009401"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009214">N</a></span><span class="op" id="3009402">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009406">u1</span>&nbsp;<span class="op" id="3009409">:=</span>&nbsp;<span class="ident" id="3009412"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009344">e</a></span><span class="op" id="3009413">.</span><span class="ident" id="3009414"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3009417">(</span><span class="ident" id="3009418"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009344">e</a></span><span class="op" id="3009419">,</span>&nbsp;<span class="ident" id="3009421"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009369">w</a></span><span class="op" id="3009422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009425"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009406">u1</a></span><span class="op" id="3009427">.</span><span class="ident" id="3009428"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3009431">(</span><span class="ident" id="3009432"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009406">u1</a></span><span class="op" id="3009434">,</span>&nbsp;<span class="ident" id="3009436"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009214">N</a></span><span class="op" id="3009437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009440">u2</span>&nbsp;<span class="op" id="3009443">:=</span>&nbsp;<span class="ident" id="3009446"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009369">w</a></span><span class="op" id="3009447">.</span><span class="ident" id="3009448"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="3009451">(</span><span class="ident" id="3009452"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009155">r</a></span><span class="op" id="3009453">,</span>&nbsp;<span class="ident" id="3009455"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009369">w</a></span><span class="op" id="3009456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009459"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009440">u2</a></span><span class="op" id="3009461">.</span><span class="ident" id="3009462"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3009465">(</span><span class="ident" id="3009466"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009440">u2</a></span><span class="op" id="3009468">,</span>&nbsp;<span class="ident" id="3009470"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009214">N</a></span><span class="op" id="3009471">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009475">x1</span><span class="op" id="3009477">,</span>&nbsp;<span class="ident" id="3009479">y1</span>&nbsp;<span class="op" id="3009482">:=</span>&nbsp;<span class="ident" id="3009485"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009198">c</a></span><span class="op" id="3009486">.</span><span class="ident" id="3009487"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016468">ScalarBaseMult</a></span><span class="op" id="3009501">(</span><span class="ident" id="3009502"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009406">u1</a></span><span class="op" id="3009504">.</span><span class="ident" id="3009505"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="3009510">(</span><span class="op" id="3009511">)</span><span class="op" id="3009512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009515">x2</span><span class="op" id="3009517">,</span>&nbsp;<span class="ident" id="3009519">y2</span>&nbsp;<span class="op" id="3009522">:=</span>&nbsp;<span class="ident" id="3009525"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009198">c</a></span><span class="op" id="3009526">.</span><span class="ident" id="3009527"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016298">ScalarMult</a></span><span class="op" id="3009537">(</span><span class="ident" id="3009538"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009126">pub</a></span><span class="op" id="3009541">.</span><span class="ident" id="3009542"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="3009543">,</span>&nbsp;<span class="ident" id="3009545"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009126">pub</a></span><span class="op" id="3009548">.</span><span class="ident" id="3009549"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span><span class="op" id="3009550">,</span>&nbsp;<span class="ident" id="3009552"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009440">u2</a></span><span class="op" id="3009554">.</span><span class="ident" id="3009555"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="3009560">(</span><span class="op" id="3009561">)</span><span class="op" id="3009562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009565">x</span><span class="op" id="3009566">,</span>&nbsp;<span class="ident" id="3009568">y</span>&nbsp;<span class="op" id="3009570">:=</span>&nbsp;<span class="ident" id="3009573"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009198">c</a></span><span class="op" id="3009574">.</span><span class="ident" id="3009575"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016111">Add</a></span><span class="op" id="3009578">(</span><span class="ident" id="3009579"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009475">x1</a></span><span class="op" id="3009581">,</span>&nbsp;<span class="ident" id="3009583"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009479">y1</a></span><span class="op" id="3009585">,</span>&nbsp;<span class="ident" id="3009587"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009515">x2</a></span><span class="op" id="3009589">,</span>&nbsp;<span class="ident" id="3009591"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009519">y2</a></span><span class="op" id="3009593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009596">if</span>&nbsp;<span class="ident" id="3009599"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009565">x</a></span><span class="op" id="3009600">.</span><span class="ident" id="3009601"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3009605">(</span><span class="op" id="3009606">)</span>&nbsp;<span class="op" id="3009608">==</span>&nbsp;<span class="num" id="3009611">0</span>&nbsp;<span class="op" id="3009613">&amp;&amp;</span>&nbsp;<span class="ident" id="3009616"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009568">y</a></span><span class="op" id="3009617">.</span><span class="ident" id="3009618"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="3009622">(</span><span class="op" id="3009623">)</span>&nbsp;<span class="op" id="3009625">==</span>&nbsp;<span class="num" id="3009628">0</span>&nbsp;<span class="op" id="3009630">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009634">return</span>&nbsp;<span class="builtintype" id="3009641">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3009648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3009651"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009565">x</a></span><span class="op" id="3009652">.</span><span class="ident" id="3009653"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="3009656">(</span><span class="ident" id="3009657"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009565">x</a></span><span class="op" id="3009658">,</span>&nbsp;<span class="ident" id="3009660"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009214">N</a></span><span class="op" id="3009661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3009664">return</span>&nbsp;<span class="ident" id="3009671"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009565">x</a></span><span class="op" id="3009672">.</span><span class="ident" id="3009673"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="3009676">(</span><span class="ident" id="3009677"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009155">r</a></span><span class="op" id="3009678">)</span>&nbsp;<span class="op" id="3009680">==</span>&nbsp;<span class="num" id="3009683">0</span><br>
<span class="lineno"></span><span class="op" id="3009685">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
