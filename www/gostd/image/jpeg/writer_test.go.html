<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7283609">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7283664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7283718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7283769">package</span>&nbsp;<span class="ident" id="7283777">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283783">import</span>&nbsp;<span class="op" id="7283790">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283793">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283802">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283809">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283818">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283833">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283846">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283859">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283872">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7283878">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7283888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7283891">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="7283970">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="7284049">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="7284074">var</span>&nbsp;<span class="ident" id="7284078">zigzag</span>&nbsp;<span class="op" id="7284085">=</span>&nbsp;<span class="op" id="7284087">[</span><span class="ident" id="7284088">blockSize</span><span class="op" id="7284097">]</span><span class="builtintype" id="7284098">int</span><span class="op" id="7284101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284104">0</span><span class="op" id="7284105">,</span>&nbsp;<span class="num" id="7284107">1</span><span class="op" id="7284108">,</span>&nbsp;<span class="num" id="7284110">5</span><span class="op" id="7284111">,</span>&nbsp;<span class="num" id="7284113">6</span><span class="op" id="7284114">,</span>&nbsp;<span class="num" id="7284116">14</span><span class="op" id="7284118">,</span>&nbsp;<span class="num" id="7284120">15</span><span class="op" id="7284122">,</span>&nbsp;<span class="num" id="7284124">27</span><span class="op" id="7284126">,</span>&nbsp;<span class="num" id="7284128">28</span><span class="op" id="7284130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284133">2</span><span class="op" id="7284134">,</span>&nbsp;<span class="num" id="7284136">4</span><span class="op" id="7284137">,</span>&nbsp;<span class="num" id="7284139">7</span><span class="op" id="7284140">,</span>&nbsp;<span class="num" id="7284142">13</span><span class="op" id="7284144">,</span>&nbsp;<span class="num" id="7284146">16</span><span class="op" id="7284148">,</span>&nbsp;<span class="num" id="7284150">26</span><span class="op" id="7284152">,</span>&nbsp;<span class="num" id="7284154">29</span><span class="op" id="7284156">,</span>&nbsp;<span class="num" id="7284158">42</span><span class="op" id="7284160">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284163">3</span><span class="op" id="7284164">,</span>&nbsp;<span class="num" id="7284166">8</span><span class="op" id="7284167">,</span>&nbsp;<span class="num" id="7284169">12</span><span class="op" id="7284171">,</span>&nbsp;<span class="num" id="7284173">17</span><span class="op" id="7284175">,</span>&nbsp;<span class="num" id="7284177">25</span><span class="op" id="7284179">,</span>&nbsp;<span class="num" id="7284181">30</span><span class="op" id="7284183">,</span>&nbsp;<span class="num" id="7284185">41</span><span class="op" id="7284187">,</span>&nbsp;<span class="num" id="7284189">43</span><span class="op" id="7284191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284194">9</span><span class="op" id="7284195">,</span>&nbsp;<span class="num" id="7284197">11</span><span class="op" id="7284199">,</span>&nbsp;<span class="num" id="7284201">18</span><span class="op" id="7284203">,</span>&nbsp;<span class="num" id="7284205">24</span><span class="op" id="7284207">,</span>&nbsp;<span class="num" id="7284209">31</span><span class="op" id="7284211">,</span>&nbsp;<span class="num" id="7284213">40</span><span class="op" id="7284215">,</span>&nbsp;<span class="num" id="7284217">44</span><span class="op" id="7284219">,</span>&nbsp;<span class="num" id="7284221">53</span><span class="op" id="7284223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284226">10</span><span class="op" id="7284228">,</span>&nbsp;<span class="num" id="7284230">19</span><span class="op" id="7284232">,</span>&nbsp;<span class="num" id="7284234">23</span><span class="op" id="7284236">,</span>&nbsp;<span class="num" id="7284238">32</span><span class="op" id="7284240">,</span>&nbsp;<span class="num" id="7284242">39</span><span class="op" id="7284244">,</span>&nbsp;<span class="num" id="7284246">45</span><span class="op" id="7284248">,</span>&nbsp;<span class="num" id="7284250">52</span><span class="op" id="7284252">,</span>&nbsp;<span class="num" id="7284254">54</span><span class="op" id="7284256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284259">20</span><span class="op" id="7284261">,</span>&nbsp;<span class="num" id="7284263">22</span><span class="op" id="7284265">,</span>&nbsp;<span class="num" id="7284267">33</span><span class="op" id="7284269">,</span>&nbsp;<span class="num" id="7284271">38</span><span class="op" id="7284273">,</span>&nbsp;<span class="num" id="7284275">46</span><span class="op" id="7284277">,</span>&nbsp;<span class="num" id="7284279">51</span><span class="op" id="7284281">,</span>&nbsp;<span class="num" id="7284283">55</span><span class="op" id="7284285">,</span>&nbsp;<span class="num" id="7284287">60</span><span class="op" id="7284289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284292">21</span><span class="op" id="7284294">,</span>&nbsp;<span class="num" id="7284296">34</span><span class="op" id="7284298">,</span>&nbsp;<span class="num" id="7284300">37</span><span class="op" id="7284302">,</span>&nbsp;<span class="num" id="7284304">47</span><span class="op" id="7284306">,</span>&nbsp;<span class="num" id="7284308">50</span><span class="op" id="7284310">,</span>&nbsp;<span class="num" id="7284312">56</span><span class="op" id="7284314">,</span>&nbsp;<span class="num" id="7284316">59</span><span class="op" id="7284318">,</span>&nbsp;<span class="num" id="7284320">61</span><span class="op" id="7284322">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284325">35</span><span class="op" id="7284327">,</span>&nbsp;<span class="num" id="7284329">36</span><span class="op" id="7284331">,</span>&nbsp;<span class="num" id="7284333">48</span><span class="op" id="7284335">,</span>&nbsp;<span class="num" id="7284337">49</span><span class="op" id="7284339">,</span>&nbsp;<span class="num" id="7284341">57</span><span class="op" id="7284343">,</span>&nbsp;<span class="num" id="7284345">58</span><span class="op" id="7284347">,</span>&nbsp;<span class="num" id="7284349">62</span><span class="op" id="7284351">,</span>&nbsp;<span class="num" id="7284353">63</span><span class="op" id="7284355">,</span><br>
<span class="lineno"></span><span class="op" id="7284357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7284360">func</span>&nbsp;<span class="ident" id="7284365">TestZigUnzig</span><span class="op" id="7284377">(</span><span class="ident" id="7284378">t</span>&nbsp;<span class="op" id="7284380">*</span><span class="ident" id="7284381">testing</span><span class="op" id="7284388">.</span><span class="ident" id="7284389">T</span><span class="op" id="7284390">)</span>&nbsp;<span class="op" id="7284392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284395">for</span>&nbsp;<span class="ident" id="7284399">i</span>&nbsp;<span class="op" id="7284401">:=</span>&nbsp;<span class="num" id="7284404">0</span><span class="op" id="7284405">;</span>&nbsp;<span class="ident" id="7284407">i</span>&nbsp;<span class="op" id="7284409">&lt;</span>&nbsp;<span class="ident" id="7284411">blockSize</span><span class="op" id="7284420">;</span>&nbsp;<span class="ident" id="7284422">i</span><span class="op" id="7284423">++</span>&nbsp;<span class="op" id="7284426">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284430">if</span>&nbsp;<span class="ident" id="7284433">unzig</span><span class="op" id="7284438">[</span><span class="ident" id="7284439">zigzag</span><span class="op" id="7284445">[</span><span class="ident" id="7284446">i</span><span class="op" id="7284447">]</span><span class="op" id="7284448">]</span>&nbsp;<span class="op" id="7284450">!=</span>&nbsp;<span class="ident" id="7284453">i</span>&nbsp;<span class="op" id="7284455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284460">t</span><span class="op" id="7284461">.</span><span class="ident" id="7284462">Errorf</span><span class="op" id="7284468">(</span><span class="string" id="7284469">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7284494">,</span>&nbsp;<span class="ident" id="7284496">i</span><span class="op" id="7284497">,</span>&nbsp;<span class="ident" id="7284499">unzig</span><span class="op" id="7284504">[</span><span class="ident" id="7284505">zigzag</span><span class="op" id="7284511">[</span><span class="ident" id="7284512">i</span><span class="op" id="7284513">]</span><span class="op" id="7284514">]</span><span class="op" id="7284515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7284523">if</span>&nbsp;<span class="ident" id="7284526">zigzag</span><span class="op" id="7284532">[</span><span class="ident" id="7284533">unzig</span><span class="op" id="7284538">[</span><span class="ident" id="7284539">i</span><span class="op" id="7284540">]</span><span class="op" id="7284541">]</span>&nbsp;<span class="op" id="7284543">!=</span>&nbsp;<span class="ident" id="7284546">i</span>&nbsp;<span class="op" id="7284548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7284553">t</span><span class="op" id="7284554">.</span><span class="ident" id="7284555">Errorf</span><span class="op" id="7284561">(</span><span class="string" id="7284562">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="7284587">,</span>&nbsp;<span class="ident" id="7284589">i</span><span class="op" id="7284590">,</span>&nbsp;<span class="ident" id="7284592">zigzag</span><span class="op" id="7284598">[</span><span class="ident" id="7284599">unzig</span><span class="op" id="7284604">[</span><span class="ident" id="7284605">i</span><span class="op" id="7284606">]</span><span class="op" id="7284607">]</span><span class="op" id="7284608">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284615">}</span><br>
<span class="lineno"></span><span class="op" id="7284617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7284620">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="7284691">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="7284752">var</span>&nbsp;<span class="ident" id="7284756">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="7284784">=</span>&nbsp;<span class="op" id="7284786">[</span><span class="ident" id="7284787">nQuantIndex</span><span class="op" id="7284798">]</span><span class="op" id="7284799">[</span><span class="ident" id="7284800">blockSize</span><span class="op" id="7284809">]</span><span class="builtintype" id="7284810">byte</span><span class="op" id="7284814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7284817">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7284832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284836">16</span><span class="op" id="7284838">,</span>&nbsp;<span class="num" id="7284840">11</span><span class="op" id="7284842">,</span>&nbsp;<span class="num" id="7284844">10</span><span class="op" id="7284846">,</span>&nbsp;<span class="num" id="7284848">16</span><span class="op" id="7284850">,</span>&nbsp;<span class="num" id="7284852">24</span><span class="op" id="7284854">,</span>&nbsp;<span class="num" id="7284856">40</span><span class="op" id="7284858">,</span>&nbsp;<span class="num" id="7284860">51</span><span class="op" id="7284862">,</span>&nbsp;<span class="num" id="7284864">61</span><span class="op" id="7284866">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284870">12</span><span class="op" id="7284872">,</span>&nbsp;<span class="num" id="7284874">12</span><span class="op" id="7284876">,</span>&nbsp;<span class="num" id="7284878">14</span><span class="op" id="7284880">,</span>&nbsp;<span class="num" id="7284882">19</span><span class="op" id="7284884">,</span>&nbsp;<span class="num" id="7284886">26</span><span class="op" id="7284888">,</span>&nbsp;<span class="num" id="7284890">58</span><span class="op" id="7284892">,</span>&nbsp;<span class="num" id="7284894">60</span><span class="op" id="7284896">,</span>&nbsp;<span class="num" id="7284898">55</span><span class="op" id="7284900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284904">14</span><span class="op" id="7284906">,</span>&nbsp;<span class="num" id="7284908">13</span><span class="op" id="7284910">,</span>&nbsp;<span class="num" id="7284912">16</span><span class="op" id="7284914">,</span>&nbsp;<span class="num" id="7284916">24</span><span class="op" id="7284918">,</span>&nbsp;<span class="num" id="7284920">40</span><span class="op" id="7284922">,</span>&nbsp;<span class="num" id="7284924">57</span><span class="op" id="7284926">,</span>&nbsp;<span class="num" id="7284928">69</span><span class="op" id="7284930">,</span>&nbsp;<span class="num" id="7284932">56</span><span class="op" id="7284934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284938">14</span><span class="op" id="7284940">,</span>&nbsp;<span class="num" id="7284942">17</span><span class="op" id="7284944">,</span>&nbsp;<span class="num" id="7284946">22</span><span class="op" id="7284948">,</span>&nbsp;<span class="num" id="7284950">29</span><span class="op" id="7284952">,</span>&nbsp;<span class="num" id="7284954">51</span><span class="op" id="7284956">,</span>&nbsp;<span class="num" id="7284958">87</span><span class="op" id="7284960">,</span>&nbsp;<span class="num" id="7284962">80</span><span class="op" id="7284964">,</span>&nbsp;<span class="num" id="7284966">62</span><span class="op" id="7284968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7284972">18</span><span class="op" id="7284974">,</span>&nbsp;<span class="num" id="7284976">22</span><span class="op" id="7284978">,</span>&nbsp;<span class="num" id="7284980">37</span><span class="op" id="7284982">,</span>&nbsp;<span class="num" id="7284984">56</span><span class="op" id="7284986">,</span>&nbsp;<span class="num" id="7284988">68</span><span class="op" id="7284990">,</span>&nbsp;<span class="num" id="7284992">109</span><span class="op" id="7284995">,</span>&nbsp;<span class="num" id="7284997">103</span><span class="op" id="7285000">,</span>&nbsp;<span class="num" id="7285002">77</span><span class="op" id="7285004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285008">24</span><span class="op" id="7285010">,</span>&nbsp;<span class="num" id="7285012">35</span><span class="op" id="7285014">,</span>&nbsp;<span class="num" id="7285016">55</span><span class="op" id="7285018">,</span>&nbsp;<span class="num" id="7285020">64</span><span class="op" id="7285022">,</span>&nbsp;<span class="num" id="7285024">81</span><span class="op" id="7285026">,</span>&nbsp;<span class="num" id="7285028">104</span><span class="op" id="7285031">,</span>&nbsp;<span class="num" id="7285033">113</span><span class="op" id="7285036">,</span>&nbsp;<span class="num" id="7285038">92</span><span class="op" id="7285040">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285044">49</span><span class="op" id="7285046">,</span>&nbsp;<span class="num" id="7285048">64</span><span class="op" id="7285050">,</span>&nbsp;<span class="num" id="7285052">78</span><span class="op" id="7285054">,</span>&nbsp;<span class="num" id="7285056">87</span><span class="op" id="7285058">,</span>&nbsp;<span class="num" id="7285060">103</span><span class="op" id="7285063">,</span>&nbsp;<span class="num" id="7285065">121</span><span class="op" id="7285068">,</span>&nbsp;<span class="num" id="7285070">120</span><span class="op" id="7285073">,</span>&nbsp;<span class="num" id="7285075">101</span><span class="op" id="7285078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285082">72</span><span class="op" id="7285084">,</span>&nbsp;<span class="num" id="7285086">92</span><span class="op" id="7285088">,</span>&nbsp;<span class="num" id="7285090">95</span><span class="op" id="7285092">,</span>&nbsp;<span class="num" id="7285094">98</span><span class="op" id="7285096">,</span>&nbsp;<span class="num" id="7285098">112</span><span class="op" id="7285101">,</span>&nbsp;<span class="num" id="7285103">100</span><span class="op" id="7285106">,</span>&nbsp;<span class="num" id="7285108">103</span><span class="op" id="7285111">,</span>&nbsp;<span class="num" id="7285113">99</span><span class="op" id="7285115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285118">}</span><span class="op" id="7285119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7285122">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285139">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285143">17</span><span class="op" id="7285145">,</span>&nbsp;<span class="num" id="7285147">18</span><span class="op" id="7285149">,</span>&nbsp;<span class="num" id="7285151">24</span><span class="op" id="7285153">,</span>&nbsp;<span class="num" id="7285155">47</span><span class="op" id="7285157">,</span>&nbsp;<span class="num" id="7285159">99</span><span class="op" id="7285161">,</span>&nbsp;<span class="num" id="7285163">99</span><span class="op" id="7285165">,</span>&nbsp;<span class="num" id="7285167">99</span><span class="op" id="7285169">,</span>&nbsp;<span class="num" id="7285171">99</span><span class="op" id="7285173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285177">18</span><span class="op" id="7285179">,</span>&nbsp;<span class="num" id="7285181">21</span><span class="op" id="7285183">,</span>&nbsp;<span class="num" id="7285185">26</span><span class="op" id="7285187">,</span>&nbsp;<span class="num" id="7285189">66</span><span class="op" id="7285191">,</span>&nbsp;<span class="num" id="7285193">99</span><span class="op" id="7285195">,</span>&nbsp;<span class="num" id="7285197">99</span><span class="op" id="7285199">,</span>&nbsp;<span class="num" id="7285201">99</span><span class="op" id="7285203">,</span>&nbsp;<span class="num" id="7285205">99</span><span class="op" id="7285207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285211">24</span><span class="op" id="7285213">,</span>&nbsp;<span class="num" id="7285215">26</span><span class="op" id="7285217">,</span>&nbsp;<span class="num" id="7285219">56</span><span class="op" id="7285221">,</span>&nbsp;<span class="num" id="7285223">99</span><span class="op" id="7285225">,</span>&nbsp;<span class="num" id="7285227">99</span><span class="op" id="7285229">,</span>&nbsp;<span class="num" id="7285231">99</span><span class="op" id="7285233">,</span>&nbsp;<span class="num" id="7285235">99</span><span class="op" id="7285237">,</span>&nbsp;<span class="num" id="7285239">99</span><span class="op" id="7285241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285245">47</span><span class="op" id="7285247">,</span>&nbsp;<span class="num" id="7285249">66</span><span class="op" id="7285251">,</span>&nbsp;<span class="num" id="7285253">99</span><span class="op" id="7285255">,</span>&nbsp;<span class="num" id="7285257">99</span><span class="op" id="7285259">,</span>&nbsp;<span class="num" id="7285261">99</span><span class="op" id="7285263">,</span>&nbsp;<span class="num" id="7285265">99</span><span class="op" id="7285267">,</span>&nbsp;<span class="num" id="7285269">99</span><span class="op" id="7285271">,</span>&nbsp;<span class="num" id="7285273">99</span><span class="op" id="7285275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285279">99</span><span class="op" id="7285281">,</span>&nbsp;<span class="num" id="7285283">99</span><span class="op" id="7285285">,</span>&nbsp;<span class="num" id="7285287">99</span><span class="op" id="7285289">,</span>&nbsp;<span class="num" id="7285291">99</span><span class="op" id="7285293">,</span>&nbsp;<span class="num" id="7285295">99</span><span class="op" id="7285297">,</span>&nbsp;<span class="num" id="7285299">99</span><span class="op" id="7285301">,</span>&nbsp;<span class="num" id="7285303">99</span><span class="op" id="7285305">,</span>&nbsp;<span class="num" id="7285307">99</span><span class="op" id="7285309">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285313">99</span><span class="op" id="7285315">,</span>&nbsp;<span class="num" id="7285317">99</span><span class="op" id="7285319">,</span>&nbsp;<span class="num" id="7285321">99</span><span class="op" id="7285323">,</span>&nbsp;<span class="num" id="7285325">99</span><span class="op" id="7285327">,</span>&nbsp;<span class="num" id="7285329">99</span><span class="op" id="7285331">,</span>&nbsp;<span class="num" id="7285333">99</span><span class="op" id="7285335">,</span>&nbsp;<span class="num" id="7285337">99</span><span class="op" id="7285339">,</span>&nbsp;<span class="num" id="7285341">99</span><span class="op" id="7285343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285347">99</span><span class="op" id="7285349">,</span>&nbsp;<span class="num" id="7285351">99</span><span class="op" id="7285353">,</span>&nbsp;<span class="num" id="7285355">99</span><span class="op" id="7285357">,</span>&nbsp;<span class="num" id="7285359">99</span><span class="op" id="7285361">,</span>&nbsp;<span class="num" id="7285363">99</span><span class="op" id="7285365">,</span>&nbsp;<span class="num" id="7285367">99</span><span class="op" id="7285369">,</span>&nbsp;<span class="num" id="7285371">99</span><span class="op" id="7285373">,</span>&nbsp;<span class="num" id="7285375">99</span><span class="op" id="7285377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7285381">99</span><span class="op" id="7285383">,</span>&nbsp;<span class="num" id="7285385">99</span><span class="op" id="7285387">,</span>&nbsp;<span class="num" id="7285389">99</span><span class="op" id="7285391">,</span>&nbsp;<span class="num" id="7285393">99</span><span class="op" id="7285395">,</span>&nbsp;<span class="num" id="7285397">99</span><span class="op" id="7285399">,</span>&nbsp;<span class="num" id="7285401">99</span><span class="op" id="7285403">,</span>&nbsp;<span class="num" id="7285405">99</span><span class="op" id="7285407">,</span>&nbsp;<span class="num" id="7285409">99</span><span class="op" id="7285411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285414">}</span><span class="op" id="7285415">,</span><br>
<span class="lineno"></span><span class="op" id="7285417">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7285420">func</span>&nbsp;<span class="ident" id="7285425">TestUnscaledQuant</span><span class="op" id="7285442">(</span><span class="ident" id="7285443">t</span>&nbsp;<span class="op" id="7285445">*</span><span class="ident" id="7285446">testing</span><span class="op" id="7285453">.</span><span class="ident" id="7285454">T</span><span class="op" id="7285455">)</span>&nbsp;<span class="op" id="7285457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285460">bad</span>&nbsp;<span class="op" id="7285464">:=</span>&nbsp;<span class="builtintype" id="7285467">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285474">for</span>&nbsp;<span class="ident" id="7285478">i</span>&nbsp;<span class="op" id="7285480">:=</span>&nbsp;<span class="ident" id="7285483">quantIndex</span><span class="op" id="7285493">(</span><span class="num" id="7285494">0</span><span class="op" id="7285495">)</span><span class="op" id="7285496">;</span>&nbsp;<span class="ident" id="7285498">i</span>&nbsp;<span class="op" id="7285500">&lt;</span>&nbsp;<span class="ident" id="7285502">nQuantIndex</span><span class="op" id="7285513">;</span>&nbsp;<span class="ident" id="7285515">i</span><span class="op" id="7285516">++</span>&nbsp;<span class="op" id="7285519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285523">for</span>&nbsp;<span class="ident" id="7285527">zig</span>&nbsp;<span class="op" id="7285531">:=</span>&nbsp;<span class="num" id="7285534">0</span><span class="op" id="7285535">;</span>&nbsp;<span class="ident" id="7285537">zig</span>&nbsp;<span class="op" id="7285541">&lt;</span>&nbsp;<span class="ident" id="7285543">blockSize</span><span class="op" id="7285552">;</span>&nbsp;<span class="ident" id="7285554">zig</span><span class="op" id="7285557">++</span>&nbsp;<span class="op" id="7285560">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285565">got</span>&nbsp;<span class="op" id="7285569">:=</span>&nbsp;<span class="ident" id="7285572">unscaledQuant</span><span class="op" id="7285585">[</span><span class="ident" id="7285586">i</span><span class="op" id="7285587">]</span><span class="op" id="7285588">[</span><span class="ident" id="7285589">zig</span><span class="op" id="7285592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285597">want</span>&nbsp;<span class="op" id="7285602">:=</span>&nbsp;<span class="ident" id="7285605">unscaledQuantInNaturalOrder</span><span class="op" id="7285632">[</span><span class="ident" id="7285633">i</span><span class="op" id="7285634">]</span><span class="op" id="7285635">[</span><span class="ident" id="7285636">unzig</span><span class="op" id="7285641">[</span><span class="ident" id="7285642">zig</span><span class="op" id="7285645">]</span><span class="op" id="7285646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285651">if</span>&nbsp;<span class="ident" id="7285654">got</span>&nbsp;<span class="op" id="7285658">!=</span>&nbsp;<span class="ident" id="7285661">want</span>&nbsp;<span class="op" id="7285666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285672">t</span><span class="op" id="7285673">.</span><span class="ident" id="7285674">Errorf</span><span class="op" id="7285680">(</span><span class="string" id="7285681">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7285712">,</span>&nbsp;<span class="ident" id="7285714">i</span><span class="op" id="7285715">,</span>&nbsp;<span class="ident" id="7285717">zig</span><span class="op" id="7285720">,</span>&nbsp;<span class="ident" id="7285722">got</span><span class="op" id="7285725">,</span>&nbsp;<span class="ident" id="7285727">want</span><span class="op" id="7285731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285737">bad</span>&nbsp;<span class="op" id="7285741">=</span>&nbsp;<span class="builtintype" id="7285743">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7285758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285761">if</span>&nbsp;<span class="ident" id="7285764">bad</span>&nbsp;<span class="op" id="7285768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285772">names</span>&nbsp;<span class="op" id="7285778">:=</span>&nbsp;<span class="op" id="7285781">[</span><span class="ident" id="7285782">nQuantIndex</span><span class="op" id="7285793">]</span><span class="builtintype" id="7285794">string</span><span class="op" id="7285800">{</span><span class="string" id="7285801">&#34;Luminance&#34;</span><span class="op" id="7285812">,</span>&nbsp;<span class="string" id="7285814">&#34;Chrominance&#34;</span><span class="op" id="7285827">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285831">buf</span>&nbsp;<span class="op" id="7285835">:=</span>&nbsp;<span class="op" id="7285838">&amp;</span><span class="ident" id="7285839">bytes</span><span class="op" id="7285844">.</span><span class="ident" id="7285845">Buffer</span><span class="op" id="7285851">{</span><span class="op" id="7285852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285856">for</span>&nbsp;<span class="ident" id="7285860">i</span><span class="op" id="7285861">,</span>&nbsp;<span class="ident" id="7285863">name</span>&nbsp;<span class="op" id="7285868">:=</span>&nbsp;<span class="keyword" id="7285871">range</span>&nbsp;<span class="ident" id="7285877">names</span>&nbsp;<span class="op" id="7285883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285888">fmt</span><span class="op" id="7285891">.</span><span class="ident" id="7285892">Fprintf</span><span class="op" id="7285899">(</span><span class="ident" id="7285900">buf</span><span class="op" id="7285903">,</span>&nbsp;<span class="string" id="7285905">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="7285918">,</span>&nbsp;<span class="ident" id="7285920">name</span><span class="op" id="7285924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7285929">for</span>&nbsp;<span class="ident" id="7285933">zig</span>&nbsp;<span class="op" id="7285937">:=</span>&nbsp;<span class="num" id="7285940">0</span><span class="op" id="7285941">;</span>&nbsp;<span class="ident" id="7285943">zig</span>&nbsp;<span class="op" id="7285947">&lt;</span>&nbsp;<span class="ident" id="7285949">blockSize</span><span class="op" id="7285958">;</span>&nbsp;<span class="ident" id="7285960">zig</span><span class="op" id="7285963">++</span>&nbsp;<span class="op" id="7285966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7285972">fmt</span><span class="op" id="7285975">.</span><span class="ident" id="7285976">Fprintf</span><span class="op" id="7285983">(</span><span class="ident" id="7285984">buf</span><span class="op" id="7285987">,</span>&nbsp;<span class="string" id="7285989">&#34;%d,&nbsp;&#34;</span><span class="op" id="7285995">,</span>&nbsp;<span class="ident" id="7285997">unscaledQuantInNaturalOrder</span><span class="op" id="7286024">[</span><span class="ident" id="7286025">i</span><span class="op" id="7286026">]</span><span class="op" id="7286027">[</span><span class="ident" id="7286028">unzig</span><span class="op" id="7286033">[</span><span class="ident" id="7286034">zig</span><span class="op" id="7286037">]</span><span class="op" id="7286038">]</span><span class="op" id="7286039">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286045">if</span>&nbsp;<span class="ident" id="7286048">zig</span><span class="op" id="7286051">%</span><span class="num" id="7286052">8</span>&nbsp;<span class="op" id="7286054">==</span>&nbsp;<span class="num" id="7286057">7</span>&nbsp;<span class="op" id="7286059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286066">buf</span><span class="op" id="7286069">.</span><span class="ident" id="7286070">WriteString</span><span class="op" id="7286081">(</span><span class="string" id="7286082">&#34;\n&#34;</span><span class="op" id="7286086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286102">buf</span><span class="op" id="7286105">.</span><span class="ident" id="7286106">WriteString</span><span class="op" id="7286117">(</span><span class="string" id="7286118">&#34;},\n&#34;</span><span class="op" id="7286124">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286132">t</span><span class="op" id="7286133">.</span><span class="ident" id="7286134">Logf</span><span class="op" id="7286138">(</span><span class="string" id="7286139">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="7286175">,</span>&nbsp;<span class="ident" id="7286177">buf</span><span class="op" id="7286180">.</span><span class="ident" id="7286181">String</span><span class="op" id="7286187">(</span><span class="op" id="7286188">)</span><span class="op" id="7286189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286192">}</span><br>
<span class="lineno"></span><span class="op" id="7286194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7286197">var</span>&nbsp;<span class="ident" id="7286201">testCase</span>&nbsp;<span class="op" id="7286210">=</span>&nbsp;<span class="op" id="7286212">[</span><span class="op" id="7286213">]</span><span class="keyword" id="7286214">struct</span>&nbsp;<span class="op" id="7286221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286224">filename</span>&nbsp;&nbsp;<span class="builtintype" id="7286234">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286242">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7286252">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286257">tolerance</span>&nbsp;<span class="ident" id="7286267">int64</span><br>
<span class="lineno"></span><span class="op" id="7286273">}</span><span class="op" id="7286274">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286277">{</span><span class="string" id="7286278">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7286305">,</span>&nbsp;<span class="num" id="7286307">1</span><span class="op" id="7286308">,</span>&nbsp;<span class="num" id="7286310">24</span>&nbsp;<span class="op" id="7286313">&lt;&lt;</span>&nbsp;<span class="num" id="7286316">8</span><span class="op" id="7286317">}</span><span class="op" id="7286318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286321">{</span><span class="string" id="7286322">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7286349">,</span>&nbsp;<span class="num" id="7286351">20</span><span class="op" id="7286353">,</span>&nbsp;<span class="num" id="7286355">12</span>&nbsp;<span class="op" id="7286358">&lt;&lt;</span>&nbsp;<span class="num" id="7286361">8</span><span class="op" id="7286362">}</span><span class="op" id="7286363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286366">{</span><span class="string" id="7286367">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7286394">,</span>&nbsp;<span class="num" id="7286396">60</span><span class="op" id="7286398">,</span>&nbsp;<span class="num" id="7286400">8</span>&nbsp;<span class="op" id="7286402">&lt;&lt;</span>&nbsp;<span class="num" id="7286405">8</span><span class="op" id="7286406">}</span><span class="op" id="7286407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286410">{</span><span class="string" id="7286411">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7286438">,</span>&nbsp;<span class="num" id="7286440">80</span><span class="op" id="7286442">,</span>&nbsp;<span class="num" id="7286444">6</span>&nbsp;<span class="op" id="7286446">&lt;&lt;</span>&nbsp;<span class="num" id="7286449">8</span><span class="op" id="7286450">}</span><span class="op" id="7286451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286454">{</span><span class="string" id="7286455">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7286482">,</span>&nbsp;<span class="num" id="7286484">90</span><span class="op" id="7286486">,</span>&nbsp;<span class="num" id="7286488">4</span>&nbsp;<span class="op" id="7286490">&lt;&lt;</span>&nbsp;<span class="num" id="7286493">8</span><span class="op" id="7286494">}</span><span class="op" id="7286495">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286498">{</span><span class="string" id="7286499">&#34;../testdata/video-001.png&#34;</span><span class="op" id="7286526">,</span>&nbsp;<span class="num" id="7286528">100</span><span class="op" id="7286531">,</span>&nbsp;<span class="num" id="7286533">2</span>&nbsp;<span class="op" id="7286535">&lt;&lt;</span>&nbsp;<span class="num" id="7286538">8</span><span class="op" id="7286539">}</span><span class="op" id="7286540">,</span><br>
<span class="lineno"></span><span class="op" id="7286542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7286545">func</span>&nbsp;<span class="ident" id="7286550">delta</span><span class="op" id="7286555">(</span><span class="ident" id="7286556">u0</span><span class="op" id="7286558">,</span>&nbsp;<span class="ident" id="7286560">u1</span>&nbsp;<span class="builtintype" id="7286563">uint32</span><span class="op" id="7286569">)</span>&nbsp;<span class="ident" id="7286571">int64</span>&nbsp;<span class="op" id="7286577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286580">d</span>&nbsp;<span class="op" id="7286582">:=</span>&nbsp;<span class="ident" id="7286585">int64</span><span class="op" id="7286590">(</span><span class="ident" id="7286591">u0</span><span class="op" id="7286593">)</span>&nbsp;<span class="op" id="7286595">-</span>&nbsp;<span class="ident" id="7286597">int64</span><span class="op" id="7286602">(</span><span class="ident" id="7286603">u1</span><span class="op" id="7286605">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286608">if</span>&nbsp;<span class="ident" id="7286611">d</span>&nbsp;<span class="op" id="7286613">&lt;</span>&nbsp;<span class="num" id="7286615">0</span>&nbsp;<span class="op" id="7286617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286621">return</span>&nbsp;<span class="op" id="7286628">-</span><span class="ident" id="7286629">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286635">return</span>&nbsp;<span class="ident" id="7286642">d</span><br>
<span class="lineno"></span><span class="op" id="7286644">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7286647">func</span>&nbsp;<span class="ident" id="7286652">readPng</span><span class="op" id="7286659">(</span><span class="ident" id="7286660">filename</span>&nbsp;<span class="builtintype" id="7286669">string</span><span class="op" id="7286675">)</span>&nbsp;<span class="op" id="7286677">(</span><span class="ident" id="7286678">image</span><span class="op" id="7286683">.</span><span class="ident" id="7286684">Image</span><span class="op" id="7286689">,</span>&nbsp;<span class="builtintype" id="7286691">error</span><span class="op" id="7286696">)</span>&nbsp;<span class="op" id="7286698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286701">f</span><span class="op" id="7286702">,</span>&nbsp;<span class="ident" id="7286704">err</span>&nbsp;<span class="op" id="7286708">:=</span>&nbsp;<span class="ident" id="7286711">os</span><span class="op" id="7286713">.</span><span class="ident" id="7286714">Open</span><span class="op" id="7286718">(</span><span class="ident" id="7286719">filename</span><span class="op" id="7286727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286730">if</span>&nbsp;<span class="ident" id="7286733">err</span>&nbsp;<span class="op" id="7286737">!=</span>&nbsp;<span class="ident" id="7286740">nil</span>&nbsp;<span class="op" id="7286744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286748">return</span>&nbsp;<span class="ident" id="7286755">nil</span><span class="op" id="7286758">,</span>&nbsp;<span class="ident" id="7286760">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286768">defer</span>&nbsp;<span class="ident" id="7286774">f</span><span class="op" id="7286775">.</span><span class="ident" id="7286776">Close</span><span class="op" id="7286781">(</span><span class="op" id="7286782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286785">return</span>&nbsp;<span class="ident" id="7286792">png</span><span class="op" id="7286795">.</span><span class="ident" id="7286796">Decode</span><span class="op" id="7286802">(</span><span class="ident" id="7286803">f</span><span class="op" id="7286804">)</span><br>
<span class="lineno"></span><span class="op" id="7286806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7286809">func</span>&nbsp;<span class="ident" id="7286814">TestWriter</span><span class="op" id="7286824">(</span><span class="ident" id="7286825">t</span>&nbsp;<span class="op" id="7286827">*</span><span class="ident" id="7286828">testing</span><span class="op" id="7286835">.</span><span class="ident" id="7286836">T</span><span class="op" id="7286837">)</span>&nbsp;<span class="op" id="7286839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286842">for</span>&nbsp;<span class="ident" id="7286846">_</span><span class="op" id="7286847">,</span>&nbsp;<span class="ident" id="7286849">tc</span>&nbsp;<span class="op" id="7286852">:=</span>&nbsp;<span class="keyword" id="7286855">range</span>&nbsp;<span class="ident" id="7286861">testCase</span>&nbsp;<span class="op" id="7286870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7286874">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286895">m0</span><span class="op" id="7286897">,</span>&nbsp;<span class="ident" id="7286899">err</span>&nbsp;<span class="op" id="7286903">:=</span>&nbsp;<span class="ident" id="7286906">readPng</span><span class="op" id="7286913">(</span><span class="ident" id="7286914">tc</span><span class="op" id="7286916">.</span><span class="ident" id="7286917">filename</span><span class="op" id="7286925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286929">if</span>&nbsp;<span class="ident" id="7286932">err</span>&nbsp;<span class="op" id="7286936">!=</span>&nbsp;<span class="ident" id="7286939">nil</span>&nbsp;<span class="op" id="7286943">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7286948">t</span><span class="op" id="7286949">.</span><span class="ident" id="7286950">Error</span><span class="op" id="7286955">(</span><span class="ident" id="7286956">tc</span><span class="op" id="7286958">.</span><span class="ident" id="7286959">filename</span><span class="op" id="7286967">,</span>&nbsp;<span class="ident" id="7286969">err</span><span class="op" id="7286972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7286977">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7286988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7286992">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287024">var</span>&nbsp;<span class="ident" id="7287028">buf</span>&nbsp;<span class="ident" id="7287032">bytes</span><span class="op" id="7287037">.</span><span class="ident" id="7287038">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287047">err</span>&nbsp;<span class="op" id="7287051">=</span>&nbsp;<span class="ident" id="7287053">Encode</span><span class="op" id="7287059">(</span><span class="op" id="7287060">&amp;</span><span class="ident" id="7287061">buf</span><span class="op" id="7287064">,</span>&nbsp;<span class="ident" id="7287066">m0</span><span class="op" id="7287068">,</span>&nbsp;<span class="op" id="7287070">&amp;</span><span class="ident" id="7287071">Options</span><span class="op" id="7287078">{</span><span class="ident" id="7287079">Quality</span><span class="op" id="7287086">:</span>&nbsp;<span class="ident" id="7287088">tc</span><span class="op" id="7287090">.</span><span class="ident" id="7287091">quality</span><span class="op" id="7287098">}</span><span class="op" id="7287099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287103">if</span>&nbsp;<span class="ident" id="7287106">err</span>&nbsp;<span class="op" id="7287110">!=</span>&nbsp;<span class="ident" id="7287113">nil</span>&nbsp;<span class="op" id="7287117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287122">t</span><span class="op" id="7287123">.</span><span class="ident" id="7287124">Error</span><span class="op" id="7287129">(</span><span class="ident" id="7287130">tc</span><span class="op" id="7287132">.</span><span class="ident" id="7287133">filename</span><span class="op" id="7287141">,</span>&nbsp;<span class="ident" id="7287143">err</span><span class="op" id="7287146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287151">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287162">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7287166">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287189">m1</span><span class="op" id="7287191">,</span>&nbsp;<span class="ident" id="7287193">err</span>&nbsp;<span class="op" id="7287197">:=</span>&nbsp;<span class="ident" id="7287200">Decode</span><span class="op" id="7287206">(</span><span class="op" id="7287207">&amp;</span><span class="ident" id="7287208">buf</span><span class="op" id="7287211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287215">if</span>&nbsp;<span class="ident" id="7287218">err</span>&nbsp;<span class="op" id="7287222">!=</span>&nbsp;<span class="ident" id="7287225">nil</span>&nbsp;<span class="op" id="7287229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287234">t</span><span class="op" id="7287235">.</span><span class="ident" id="7287236">Error</span><span class="op" id="7287241">(</span><span class="ident" id="7287242">tc</span><span class="op" id="7287244">.</span><span class="ident" id="7287245">filename</span><span class="op" id="7287253">,</span>&nbsp;<span class="ident" id="7287255">err</span><span class="op" id="7287258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287263">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287278">if</span>&nbsp;<span class="ident" id="7287281">m0</span><span class="op" id="7287283">.</span><span class="ident" id="7287284">Bounds</span><span class="op" id="7287290">(</span><span class="op" id="7287291">)</span>&nbsp;<span class="op" id="7287293">!=</span>&nbsp;<span class="ident" id="7287296">m1</span><span class="op" id="7287298">.</span><span class="ident" id="7287299">Bounds</span><span class="op" id="7287305">(</span><span class="op" id="7287306">)</span>&nbsp;<span class="op" id="7287308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287313">t</span><span class="op" id="7287314">.</span><span class="ident" id="7287315">Errorf</span><span class="op" id="7287321">(</span><span class="string" id="7287322">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7287352">,</span>&nbsp;<span class="ident" id="7287354">tc</span><span class="op" id="7287356">.</span><span class="ident" id="7287357">filename</span><span class="op" id="7287365">,</span>&nbsp;<span class="ident" id="7287367">m0</span><span class="op" id="7287369">.</span><span class="ident" id="7287370">Bounds</span><span class="op" id="7287376">(</span><span class="op" id="7287377">)</span><span class="op" id="7287378">,</span>&nbsp;<span class="ident" id="7287380">m1</span><span class="op" id="7287382">.</span><span class="ident" id="7287383">Bounds</span><span class="op" id="7287389">(</span><span class="op" id="7287390">)</span><span class="op" id="7287391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287396">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287407">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7287411">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287466">if</span>&nbsp;<span class="ident" id="7287469">averageDelta</span><span class="op" id="7287481">(</span><span class="ident" id="7287482">m0</span><span class="op" id="7287484">,</span>&nbsp;<span class="ident" id="7287486">m1</span><span class="op" id="7287488">)</span>&nbsp;<span class="op" id="7287490">&gt;</span>&nbsp;<span class="ident" id="7287492">tc</span><span class="op" id="7287494">.</span><span class="ident" id="7287495">tolerance</span>&nbsp;<span class="op" id="7287505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287510">t</span><span class="op" id="7287511">.</span><span class="ident" id="7287512">Errorf</span><span class="op" id="7287518">(</span><span class="string" id="7287519">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="7287562">,</span>&nbsp;<span class="ident" id="7287564">tc</span><span class="op" id="7287566">.</span><span class="ident" id="7287567">filename</span><span class="op" id="7287575">,</span>&nbsp;<span class="ident" id="7287577">tc</span><span class="op" id="7287579">.</span><span class="ident" id="7287580">quality</span><span class="op" id="7287587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287592">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287603">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287606">}</span><br>
<span class="lineno"></span><span class="op" id="7287608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7287611">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="7287685">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="7287717">func</span>&nbsp;<span class="ident" id="7287722">TestWriteGrayscale</span><span class="op" id="7287740">(</span><span class="ident" id="7287741">t</span>&nbsp;<span class="op" id="7287743">*</span><span class="ident" id="7287744">testing</span><span class="op" id="7287751">.</span><span class="ident" id="7287752">T</span><span class="op" id="7287753">)</span>&nbsp;<span class="op" id="7287755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287758">m0</span>&nbsp;<span class="op" id="7287761">:=</span>&nbsp;<span class="ident" id="7287764">image</span><span class="op" id="7287769">.</span><span class="ident" id="7287770">NewGray</span><span class="op" id="7287777">(</span><span class="ident" id="7287778">image</span><span class="op" id="7287783">.</span><span class="ident" id="7287784">Rect</span><span class="op" id="7287788">(</span><span class="num" id="7287789">0</span><span class="op" id="7287790">,</span>&nbsp;<span class="num" id="7287792">0</span><span class="op" id="7287793">,</span>&nbsp;<span class="num" id="7287795">32</span><span class="op" id="7287797">,</span>&nbsp;<span class="num" id="7287799">32</span><span class="op" id="7287801">)</span><span class="op" id="7287802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287805">for</span>&nbsp;<span class="ident" id="7287809">i</span>&nbsp;<span class="op" id="7287811">:=</span>&nbsp;<span class="keyword" id="7287814">range</span>&nbsp;<span class="ident" id="7287820">m0</span><span class="op" id="7287822">.</span><span class="ident" id="7287823">Pix</span>&nbsp;<span class="op" id="7287827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287831">m0</span><span class="op" id="7287833">.</span><span class="ident" id="7287834">Pix</span><span class="op" id="7287837">[</span><span class="ident" id="7287838">i</span><span class="op" id="7287839">]</span>&nbsp;<span class="op" id="7287841">=</span>&nbsp;<span class="builtintype" id="7287843">uint8</span><span class="op" id="7287848">(</span><span class="ident" id="7287849">i</span><span class="op" id="7287850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287853">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287856">var</span>&nbsp;<span class="ident" id="7287860">buf</span>&nbsp;<span class="ident" id="7287864">bytes</span><span class="op" id="7287869">.</span><span class="ident" id="7287870">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287878">if</span>&nbsp;<span class="ident" id="7287881">err</span>&nbsp;<span class="op" id="7287885">:=</span>&nbsp;<span class="ident" id="7287888">Encode</span><span class="op" id="7287894">(</span><span class="op" id="7287895">&amp;</span><span class="ident" id="7287896">buf</span><span class="op" id="7287899">,</span>&nbsp;<span class="ident" id="7287901">m0</span><span class="op" id="7287903">,</span>&nbsp;<span class="ident" id="7287905">nil</span><span class="op" id="7287908">)</span><span class="op" id="7287909">;</span>&nbsp;<span class="ident" id="7287911">err</span>&nbsp;<span class="op" id="7287915">!=</span>&nbsp;<span class="ident" id="7287918">nil</span>&nbsp;<span class="op" id="7287922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287926">t</span><span class="op" id="7287927">.</span><span class="ident" id="7287928">Fatal</span><span class="op" id="7287933">(</span><span class="ident" id="7287934">err</span><span class="op" id="7287937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7287940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287943">m1</span><span class="op" id="7287945">,</span>&nbsp;<span class="ident" id="7287947">err</span>&nbsp;<span class="op" id="7287951">:=</span>&nbsp;<span class="ident" id="7287954">Decode</span><span class="op" id="7287960">(</span><span class="op" id="7287961">&amp;</span><span class="ident" id="7287962">buf</span><span class="op" id="7287965">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7287968">if</span>&nbsp;<span class="ident" id="7287971">err</span>&nbsp;<span class="op" id="7287975">!=</span>&nbsp;<span class="ident" id="7287978">nil</span>&nbsp;<span class="op" id="7287982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7287986">t</span><span class="op" id="7287987">.</span><span class="ident" id="7287988">Fatal</span><span class="op" id="7287993">(</span><span class="ident" id="7287994">err</span><span class="op" id="7287997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288003">if</span>&nbsp;<span class="ident" id="7288006">m0</span><span class="op" id="7288008">.</span><span class="ident" id="7288009">Bounds</span><span class="op" id="7288015">(</span><span class="op" id="7288016">)</span>&nbsp;<span class="op" id="7288018">!=</span>&nbsp;<span class="ident" id="7288021">m1</span><span class="op" id="7288023">.</span><span class="ident" id="7288024">Bounds</span><span class="op" id="7288030">(</span><span class="op" id="7288031">)</span>&nbsp;<span class="op" id="7288033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288037">t</span><span class="op" id="7288038">.</span><span class="ident" id="7288039">Fatalf</span><span class="op" id="7288045">(</span><span class="string" id="7288046">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="7288072">,</span>&nbsp;<span class="ident" id="7288074">m0</span><span class="op" id="7288076">.</span><span class="ident" id="7288077">Bounds</span><span class="op" id="7288083">(</span><span class="op" id="7288084">)</span><span class="op" id="7288085">,</span>&nbsp;<span class="ident" id="7288087">m1</span><span class="op" id="7288089">.</span><span class="ident" id="7288090">Bounds</span><span class="op" id="7288096">(</span><span class="op" id="7288097">)</span><span class="op" id="7288098">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288104">if</span>&nbsp;<span class="ident" id="7288107">_</span><span class="op" id="7288108">,</span>&nbsp;<span class="ident" id="7288110">ok</span>&nbsp;<span class="op" id="7288113">:=</span>&nbsp;<span class="ident" id="7288116">m1</span><span class="op" id="7288118">.</span><span class="op" id="7288119">(</span><span class="op" id="7288120">*</span><span class="ident" id="7288121">image</span><span class="op" id="7288126">.</span><span class="ident" id="7288127">Gray</span><span class="op" id="7288131">)</span><span class="op" id="7288132">;</span>&nbsp;<span class="op" id="7288134">!</span><span class="ident" id="7288135">ok</span>&nbsp;<span class="op" id="7288138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288142">t</span><span class="op" id="7288143">.</span><span class="ident" id="7288144">Errorf</span><span class="op" id="7288150">(</span><span class="string" id="7288151">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="7288177">,</span>&nbsp;<span class="ident" id="7288179">m1</span><span class="op" id="7288181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7288187">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288241">want</span>&nbsp;<span class="op" id="7288246">:=</span>&nbsp;<span class="ident" id="7288249">int64</span><span class="op" id="7288254">(</span><span class="num" id="7288255">2</span>&nbsp;<span class="op" id="7288257">&lt;&lt;</span>&nbsp;<span class="num" id="7288260">8</span><span class="op" id="7288261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288264">if</span>&nbsp;<span class="ident" id="7288267">got</span>&nbsp;<span class="op" id="7288271">:=</span>&nbsp;<span class="ident" id="7288274">averageDelta</span><span class="op" id="7288286">(</span><span class="ident" id="7288287">m0</span><span class="op" id="7288289">,</span>&nbsp;<span class="ident" id="7288291">m1</span><span class="op" id="7288293">)</span><span class="op" id="7288294">;</span>&nbsp;<span class="ident" id="7288296">got</span>&nbsp;<span class="op" id="7288300">&gt;</span>&nbsp;<span class="ident" id="7288302">want</span>&nbsp;<span class="op" id="7288307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288311">t</span><span class="op" id="7288312">.</span><span class="ident" id="7288313">Errorf</span><span class="op" id="7288319">(</span><span class="string" id="7288320">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="7288364">,</span>&nbsp;<span class="ident" id="7288366">got</span><span class="op" id="7288369">,</span>&nbsp;<span class="ident" id="7288371">want</span><span class="op" id="7288375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288378">}</span><br>
<span class="lineno"></span><span class="op" id="7288380">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="7288383">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="7288459">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="7288484">func</span>&nbsp;<span class="ident" id="7288489">averageDelta</span><span class="op" id="7288501">(</span><span class="ident" id="7288502">m0</span><span class="op" id="7288504">,</span>&nbsp;<span class="ident" id="7288506">m1</span>&nbsp;<span class="ident" id="7288509">image</span><span class="op" id="7288514">.</span><span class="ident" id="7288515">Image</span><span class="op" id="7288520">)</span>&nbsp;<span class="ident" id="7288522">int64</span>&nbsp;<span class="op" id="7288528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288531">b</span>&nbsp;<span class="op" id="7288533">:=</span>&nbsp;<span class="ident" id="7288536">m0</span><span class="op" id="7288538">.</span><span class="ident" id="7288539">Bounds</span><span class="op" id="7288545">(</span><span class="op" id="7288546">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288549">var</span>&nbsp;<span class="ident" id="7288553">sum</span><span class="op" id="7288556">,</span>&nbsp;<span class="ident" id="7288558">n</span>&nbsp;<span class="ident" id="7288560">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288567">for</span>&nbsp;<span class="ident" id="7288571">y</span>&nbsp;<span class="op" id="7288573">:=</span>&nbsp;<span class="ident" id="7288576">b</span><span class="op" id="7288577">.</span><span class="ident" id="7288578">Min</span><span class="op" id="7288581">.</span><span class="ident" id="7288582">Y</span><span class="op" id="7288583">;</span>&nbsp;<span class="ident" id="7288585">y</span>&nbsp;<span class="op" id="7288587">&lt;</span>&nbsp;<span class="ident" id="7288589">b</span><span class="op" id="7288590">.</span><span class="ident" id="7288591">Max</span><span class="op" id="7288594">.</span><span class="ident" id="7288595">Y</span><span class="op" id="7288596">;</span>&nbsp;<span class="ident" id="7288598">y</span><span class="op" id="7288599">++</span>&nbsp;<span class="op" id="7288602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288606">for</span>&nbsp;<span class="ident" id="7288610">x</span>&nbsp;<span class="op" id="7288612">:=</span>&nbsp;<span class="ident" id="7288615">b</span><span class="op" id="7288616">.</span><span class="ident" id="7288617">Min</span><span class="op" id="7288620">.</span><span class="ident" id="7288621">X</span><span class="op" id="7288622">;</span>&nbsp;<span class="ident" id="7288624">x</span>&nbsp;<span class="op" id="7288626">&lt;</span>&nbsp;<span class="ident" id="7288628">b</span><span class="op" id="7288629">.</span><span class="ident" id="7288630">Max</span><span class="op" id="7288633">.</span><span class="ident" id="7288634">X</span><span class="op" id="7288635">;</span>&nbsp;<span class="ident" id="7288637">x</span><span class="op" id="7288638">++</span>&nbsp;<span class="op" id="7288641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288646">c0</span>&nbsp;<span class="op" id="7288649">:=</span>&nbsp;<span class="ident" id="7288652">m0</span><span class="op" id="7288654">.</span><span class="ident" id="7288655">At</span><span class="op" id="7288657">(</span><span class="ident" id="7288658">x</span><span class="op" id="7288659">,</span>&nbsp;<span class="ident" id="7288661">y</span><span class="op" id="7288662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288667">c1</span>&nbsp;<span class="op" id="7288670">:=</span>&nbsp;<span class="ident" id="7288673">m1</span><span class="op" id="7288675">.</span><span class="ident" id="7288676">At</span><span class="op" id="7288678">(</span><span class="ident" id="7288679">x</span><span class="op" id="7288680">,</span>&nbsp;<span class="ident" id="7288682">y</span><span class="op" id="7288683">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288688">r0</span><span class="op" id="7288690">,</span>&nbsp;<span class="ident" id="7288692">g0</span><span class="op" id="7288694">,</span>&nbsp;<span class="ident" id="7288696">b0</span><span class="op" id="7288698">,</span>&nbsp;<span class="ident" id="7288700">_</span>&nbsp;<span class="op" id="7288702">:=</span>&nbsp;<span class="ident" id="7288705">c0</span><span class="op" id="7288707">.</span><span class="ident" id="7288708">RGBA</span><span class="op" id="7288712">(</span><span class="op" id="7288713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288718">r1</span><span class="op" id="7288720">,</span>&nbsp;<span class="ident" id="7288722">g1</span><span class="op" id="7288724">,</span>&nbsp;<span class="ident" id="7288726">b1</span><span class="op" id="7288728">,</span>&nbsp;<span class="ident" id="7288730">_</span>&nbsp;<span class="op" id="7288732">:=</span>&nbsp;<span class="ident" id="7288735">c1</span><span class="op" id="7288737">.</span><span class="ident" id="7288738">RGBA</span><span class="op" id="7288742">(</span><span class="op" id="7288743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288748">sum</span>&nbsp;<span class="op" id="7288752">+=</span>&nbsp;<span class="ident" id="7288755">delta</span><span class="op" id="7288760">(</span><span class="ident" id="7288761">r0</span><span class="op" id="7288763">,</span>&nbsp;<span class="ident" id="7288765">r1</span><span class="op" id="7288767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288772">sum</span>&nbsp;<span class="op" id="7288776">+=</span>&nbsp;<span class="ident" id="7288779">delta</span><span class="op" id="7288784">(</span><span class="ident" id="7288785">g0</span><span class="op" id="7288787">,</span>&nbsp;<span class="ident" id="7288789">g1</span><span class="op" id="7288791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288796">sum</span>&nbsp;<span class="op" id="7288800">+=</span>&nbsp;<span class="ident" id="7288803">delta</span><span class="op" id="7288808">(</span><span class="ident" id="7288809">b0</span><span class="op" id="7288811">,</span>&nbsp;<span class="ident" id="7288813">b1</span><span class="op" id="7288815">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288820">n</span>&nbsp;<span class="op" id="7288822">+=</span>&nbsp;<span class="num" id="7288825">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7288832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7288835">return</span>&nbsp;<span class="ident" id="7288842">sum</span>&nbsp;<span class="op" id="7288846">/</span>&nbsp;<span class="ident" id="7288848">n</span><br>
<span class="lineno"></span><span class="op" id="7288850">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7288853">func</span>&nbsp;<span class="ident" id="7288858">BenchmarkEncode</span><span class="op" id="7288873">(</span><span class="ident" id="7288874">b</span>&nbsp;<span class="op" id="7288876">*</span><span class="ident" id="7288877">testing</span><span class="op" id="7288884">.</span><span class="ident" id="7288885">B</span><span class="op" id="7288886">)</span>&nbsp;<span class="op" id="7288888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288891">b</span><span class="op" id="7288892">.</span><span class="ident" id="7288893">StopTimer</span><span class="op" id="7288902">(</span><span class="op" id="7288903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288906">img</span>&nbsp;<span class="op" id="7288910">:=</span>&nbsp;<span class="ident" id="7288913">image</span><span class="op" id="7288918">.</span><span class="ident" id="7288919">NewRGBA</span><span class="op" id="7288926">(</span><span class="ident" id="7288927">image</span><span class="op" id="7288932">.</span><span class="ident" id="7288933">Rect</span><span class="op" id="7288937">(</span><span class="num" id="7288938">0</span><span class="op" id="7288939">,</span>&nbsp;<span class="num" id="7288941">0</span><span class="op" id="7288942">,</span>&nbsp;<span class="num" id="7288944">640</span><span class="op" id="7288947">,</span>&nbsp;<span class="num" id="7288949">480</span><span class="op" id="7288952">)</span><span class="op" id="7288953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288956">bo</span>&nbsp;<span class="op" id="7288959">:=</span>&nbsp;<span class="ident" id="7288962">img</span><span class="op" id="7288965">.</span><span class="ident" id="7288966">Bounds</span><span class="op" id="7288972">(</span><span class="op" id="7288973">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7288976">rnd</span>&nbsp;<span class="op" id="7288980">:=</span>&nbsp;<span class="ident" id="7288983">rand</span><span class="op" id="7288987">.</span><span class="ident" id="7288988">New</span><span class="op" id="7288991">(</span><span class="ident" id="7288992">rand</span><span class="op" id="7288996">.</span><span class="ident" id="7288997">NewSource</span><span class="op" id="7289006">(</span><span class="num" id="7289007">123</span><span class="op" id="7289010">)</span><span class="op" id="7289011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7289014">for</span>&nbsp;<span class="ident" id="7289018">y</span>&nbsp;<span class="op" id="7289020">:=</span>&nbsp;<span class="ident" id="7289023">bo</span><span class="op" id="7289025">.</span><span class="ident" id="7289026">Min</span><span class="op" id="7289029">.</span><span class="ident" id="7289030">Y</span><span class="op" id="7289031">;</span>&nbsp;<span class="ident" id="7289033">y</span>&nbsp;<span class="op" id="7289035">&lt;</span>&nbsp;<span class="ident" id="7289037">bo</span><span class="op" id="7289039">.</span><span class="ident" id="7289040">Max</span><span class="op" id="7289043">.</span><span class="ident" id="7289044">Y</span><span class="op" id="7289045">;</span>&nbsp;<span class="ident" id="7289047">y</span><span class="op" id="7289048">++</span>&nbsp;<span class="op" id="7289051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7289055">for</span>&nbsp;<span class="ident" id="7289059">x</span>&nbsp;<span class="op" id="7289061">:=</span>&nbsp;<span class="ident" id="7289064">bo</span><span class="op" id="7289066">.</span><span class="ident" id="7289067">Min</span><span class="op" id="7289070">.</span><span class="ident" id="7289071">X</span><span class="op" id="7289072">;</span>&nbsp;<span class="ident" id="7289074">x</span>&nbsp;<span class="op" id="7289076">&lt;</span>&nbsp;<span class="ident" id="7289078">bo</span><span class="op" id="7289080">.</span><span class="ident" id="7289081">Max</span><span class="op" id="7289084">.</span><span class="ident" id="7289085">X</span><span class="op" id="7289086">;</span>&nbsp;<span class="ident" id="7289088">x</span><span class="op" id="7289089">++</span>&nbsp;<span class="op" id="7289092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289097">img</span><span class="op" id="7289100">.</span><span class="ident" id="7289101">SetRGBA</span><span class="op" id="7289108">(</span><span class="ident" id="7289109">x</span><span class="op" id="7289110">,</span>&nbsp;<span class="ident" id="7289112">y</span><span class="op" id="7289113">,</span>&nbsp;<span class="ident" id="7289115">color</span><span class="op" id="7289120">.</span><span class="ident" id="7289121">RGBA</span><span class="op" id="7289125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7289131">uint8</span><span class="op" id="7289136">(</span><span class="ident" id="7289137">rnd</span><span class="op" id="7289140">.</span><span class="ident" id="7289141">Intn</span><span class="op" id="7289145">(</span><span class="num" id="7289146">256</span><span class="op" id="7289149">)</span><span class="op" id="7289150">)</span><span class="op" id="7289151">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7289157">uint8</span><span class="op" id="7289162">(</span><span class="ident" id="7289163">rnd</span><span class="op" id="7289166">.</span><span class="ident" id="7289167">Intn</span><span class="op" id="7289171">(</span><span class="num" id="7289172">256</span><span class="op" id="7289175">)</span><span class="op" id="7289176">)</span><span class="op" id="7289177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="7289183">uint8</span><span class="op" id="7289188">(</span><span class="ident" id="7289189">rnd</span><span class="op" id="7289192">.</span><span class="ident" id="7289193">Intn</span><span class="op" id="7289197">(</span><span class="num" id="7289198">256</span><span class="op" id="7289201">)</span><span class="op" id="7289202">)</span><span class="op" id="7289203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7289209">255</span><span class="op" id="7289212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289217">}</span><span class="op" id="7289218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289222">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289228">b</span><span class="op" id="7289229">.</span><span class="ident" id="7289230">SetBytes</span><span class="op" id="7289238">(</span><span class="num" id="7289239">640</span>&nbsp;<span class="op" id="7289243">*</span>&nbsp;<span class="num" id="7289245">480</span>&nbsp;<span class="op" id="7289249">*</span>&nbsp;<span class="num" id="7289251">4</span><span class="op" id="7289252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289255">b</span><span class="op" id="7289256">.</span><span class="ident" id="7289257">StartTimer</span><span class="op" id="7289267">(</span><span class="op" id="7289268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289271">options</span>&nbsp;<span class="op" id="7289279">:=</span>&nbsp;<span class="op" id="7289282">&amp;</span><span class="ident" id="7289283">Options</span><span class="op" id="7289290">{</span><span class="ident" id="7289291">Quality</span><span class="op" id="7289298">:</span>&nbsp;<span class="num" id="7289300">90</span><span class="op" id="7289302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7289305">for</span>&nbsp;<span class="ident" id="7289309">i</span>&nbsp;<span class="op" id="7289311">:=</span>&nbsp;<span class="num" id="7289314">0</span><span class="op" id="7289315">;</span>&nbsp;<span class="ident" id="7289317">i</span>&nbsp;<span class="op" id="7289319">&lt;</span>&nbsp;<span class="ident" id="7289321">b</span><span class="op" id="7289322">.</span><span class="ident" id="7289323">N</span><span class="op" id="7289324">;</span>&nbsp;<span class="ident" id="7289326">i</span><span class="op" id="7289327">++</span>&nbsp;<span class="op" id="7289330">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289334">Encode</span><span class="op" id="7289340">(</span><span class="ident" id="7289341">ioutil</span><span class="op" id="7289347">.</span><span class="ident" id="7289348">Discard</span><span class="op" id="7289355">,</span>&nbsp;<span class="ident" id="7289357">img</span><span class="op" id="7289360">,</span>&nbsp;<span class="ident" id="7289362">options</span><span class="op" id="7289369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289372">}</span><br>
<span class="lineno"></span><span class="op" id="7289374">}</span>
</div>
</body>
</html>
