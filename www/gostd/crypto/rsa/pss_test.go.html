<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html" class="current">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6802284">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6802339">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6802393">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6802444">package</span>&nbsp;<span class="ident" id="6802452">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6802457">import</span>&nbsp;<span class="op" id="6802464">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802467">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802476">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802485">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802503">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6802513">_</span>&nbsp;<span class="string" id="6802515">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802529">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802544">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6802559">_</span>&nbsp;<span class="string" id="6802561">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802578">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802594">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802606">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802612">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802623">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6802634">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6802644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6802647">func</span>&nbsp;<span class="ident" id="6802652">TestEMSAPSS</span><span class="op" id="6802663">(</span><span class="ident" id="6802664">t</span>&nbsp;<span class="op" id="6802666">*</span><span class="ident" id="6802667">testing</span><span class="op" id="6802674">.</span><span class="ident" id="6802675">T</span><span class="op" id="6802676">)</span>&nbsp;<span class="op" id="6802678">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6802681">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6802784">msg</span>&nbsp;<span class="op" id="6802788">:=</span>&nbsp;<span class="op" id="6802791">[</span><span class="op" id="6802792">]</span><span class="builtintype" id="6802793">byte</span><span class="op" id="6802797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6802801">0x85</span><span class="op" id="6802805">,</span>&nbsp;<span class="num" id="6802807">0x9e</span><span class="op" id="6802811">,</span>&nbsp;<span class="num" id="6802813">0xef</span><span class="op" id="6802817">,</span>&nbsp;<span class="num" id="6802819">0x2f</span><span class="op" id="6802823">,</span>&nbsp;<span class="num" id="6802825">0xd7</span><span class="op" id="6802829">,</span>&nbsp;<span class="num" id="6802831">0x8a</span><span class="op" id="6802835">,</span>&nbsp;<span class="num" id="6802837">0xca</span><span class="op" id="6802841">,</span>&nbsp;<span class="num" id="6802843">0x00</span><span class="op" id="6802847">,</span>&nbsp;<span class="num" id="6802849">0x30</span><span class="op" id="6802853">,</span>&nbsp;<span class="num" id="6802855">0x8b</span><span class="op" id="6802859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6802863">0xdc</span><span class="op" id="6802867">,</span>&nbsp;<span class="num" id="6802869">0x47</span><span class="op" id="6802873">,</span>&nbsp;<span class="num" id="6802875">0x11</span><span class="op" id="6802879">,</span>&nbsp;<span class="num" id="6802881">0x93</span><span class="op" id="6802885">,</span>&nbsp;<span class="num" id="6802887">0xbf</span><span class="op" id="6802891">,</span>&nbsp;<span class="num" id="6802893">0x55</span><span class="op" id="6802897">,</span>&nbsp;<span class="num" id="6802899">0xbf</span><span class="op" id="6802903">,</span>&nbsp;<span class="num" id="6802905">0x9d</span><span class="op" id="6802909">,</span>&nbsp;<span class="num" id="6802911">0x78</span><span class="op" id="6802915">,</span>&nbsp;<span class="num" id="6802917">0xdb</span><span class="op" id="6802921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6802925">0x8f</span><span class="op" id="6802929">,</span>&nbsp;<span class="num" id="6802931">0x8a</span><span class="op" id="6802935">,</span>&nbsp;<span class="num" id="6802937">0x67</span><span class="op" id="6802941">,</span>&nbsp;<span class="num" id="6802943">0x2b</span><span class="op" id="6802947">,</span>&nbsp;<span class="num" id="6802949">0x48</span><span class="op" id="6802953">,</span>&nbsp;<span class="num" id="6802955">0x46</span><span class="op" id="6802959">,</span>&nbsp;<span class="num" id="6802961">0x34</span><span class="op" id="6802965">,</span>&nbsp;<span class="num" id="6802967">0xf3</span><span class="op" id="6802971">,</span>&nbsp;<span class="num" id="6802973">0xc9</span><span class="op" id="6802977">,</span>&nbsp;<span class="num" id="6802979">0xc2</span><span class="op" id="6802983">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6802987">0x6e</span><span class="op" id="6802991">,</span>&nbsp;<span class="num" id="6802993">0x64</span><span class="op" id="6802997">,</span>&nbsp;<span class="num" id="6802999">0x78</span><span class="op" id="6803003">,</span>&nbsp;<span class="num" id="6803005">0xae</span><span class="op" id="6803009">,</span>&nbsp;<span class="num" id="6803011">0x10</span><span class="op" id="6803015">,</span>&nbsp;<span class="num" id="6803017">0x26</span><span class="op" id="6803021">,</span>&nbsp;<span class="num" id="6803023">0x0f</span><span class="op" id="6803027">,</span>&nbsp;<span class="num" id="6803029">0xe0</span><span class="op" id="6803033">,</span>&nbsp;<span class="num" id="6803035">0xdd</span><span class="op" id="6803039">,</span>&nbsp;<span class="num" id="6803041">0x8c</span><span class="op" id="6803045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803049">0x08</span><span class="op" id="6803053">,</span>&nbsp;<span class="num" id="6803055">0x2e</span><span class="op" id="6803059">,</span>&nbsp;<span class="num" id="6803061">0x53</span><span class="op" id="6803065">,</span>&nbsp;<span class="num" id="6803067">0xa5</span><span class="op" id="6803071">,</span>&nbsp;<span class="num" id="6803073">0x29</span><span class="op" id="6803077">,</span>&nbsp;<span class="num" id="6803079">0x3a</span><span class="op" id="6803083">,</span>&nbsp;<span class="num" id="6803085">0xf2</span><span class="op" id="6803089">,</span>&nbsp;<span class="num" id="6803091">0x17</span><span class="op" id="6803095">,</span>&nbsp;<span class="num" id="6803097">0x3c</span><span class="op" id="6803101">,</span>&nbsp;<span class="num" id="6803103">0xd5</span><span class="op" id="6803107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803111">0x0c</span><span class="op" id="6803115">,</span>&nbsp;<span class="num" id="6803117">0x6d</span><span class="op" id="6803121">,</span>&nbsp;<span class="num" id="6803123">0x5d</span><span class="op" id="6803127">,</span>&nbsp;<span class="num" id="6803129">0x35</span><span class="op" id="6803133">,</span>&nbsp;<span class="num" id="6803135">0x4f</span><span class="op" id="6803139">,</span>&nbsp;<span class="num" id="6803141">0xeb</span><span class="op" id="6803145">,</span>&nbsp;<span class="num" id="6803147">0xf7</span><span class="op" id="6803151">,</span>&nbsp;<span class="num" id="6803153">0x8b</span><span class="op" id="6803157">,</span>&nbsp;<span class="num" id="6803159">0x26</span><span class="op" id="6803163">,</span>&nbsp;<span class="num" id="6803165">0x02</span><span class="op" id="6803169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803173">0x1c</span><span class="op" id="6803177">,</span>&nbsp;<span class="num" id="6803179">0x25</span><span class="op" id="6803183">,</span>&nbsp;<span class="num" id="6803185">0xc0</span><span class="op" id="6803189">,</span>&nbsp;<span class="num" id="6803191">0x27</span><span class="op" id="6803195">,</span>&nbsp;<span class="num" id="6803197">0x12</span><span class="op" id="6803201">,</span>&nbsp;<span class="num" id="6803203">0xe7</span><span class="op" id="6803207">,</span>&nbsp;<span class="num" id="6803209">0x8c</span><span class="op" id="6803213">,</span>&nbsp;<span class="num" id="6803215">0xd4</span><span class="op" id="6803219">,</span>&nbsp;<span class="num" id="6803221">0x69</span><span class="op" id="6803225">,</span>&nbsp;<span class="num" id="6803227">0x4c</span><span class="op" id="6803231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803235">0x9f</span><span class="op" id="6803239">,</span>&nbsp;<span class="num" id="6803241">0x46</span><span class="op" id="6803245">,</span>&nbsp;<span class="num" id="6803247">0x97</span><span class="op" id="6803251">,</span>&nbsp;<span class="num" id="6803253">0x77</span><span class="op" id="6803257">,</span>&nbsp;<span class="num" id="6803259">0xe4</span><span class="op" id="6803263">,</span>&nbsp;<span class="num" id="6803265">0x51</span><span class="op" id="6803269">,</span>&nbsp;<span class="num" id="6803271">0xe7</span><span class="op" id="6803275">,</span>&nbsp;<span class="num" id="6803277">0xf8</span><span class="op" id="6803281">,</span>&nbsp;<span class="num" id="6803283">0xe9</span><span class="op" id="6803287">,</span>&nbsp;<span class="num" id="6803289">0xe0</span><span class="op" id="6803293">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803297">0x4c</span><span class="op" id="6803301">,</span>&nbsp;<span class="num" id="6803303">0xd3</span><span class="op" id="6803307">,</span>&nbsp;<span class="num" id="6803309">0x73</span><span class="op" id="6803313">,</span>&nbsp;<span class="num" id="6803315">0x9c</span><span class="op" id="6803319">,</span>&nbsp;<span class="num" id="6803321">0x6b</span><span class="op" id="6803325">,</span>&nbsp;<span class="num" id="6803327">0xbf</span><span class="op" id="6803331">,</span>&nbsp;<span class="num" id="6803333">0xed</span><span class="op" id="6803337">,</span>&nbsp;<span class="num" id="6803339">0xae</span><span class="op" id="6803343">,</span>&nbsp;<span class="num" id="6803345">0x48</span><span class="op" id="6803349">,</span>&nbsp;<span class="num" id="6803351">0x7f</span><span class="op" id="6803355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803359">0xb5</span><span class="op" id="6803363">,</span>&nbsp;<span class="num" id="6803365">0x56</span><span class="op" id="6803369">,</span>&nbsp;<span class="num" id="6803371">0x44</span><span class="op" id="6803375">,</span>&nbsp;<span class="num" id="6803377">0xe9</span><span class="op" id="6803381">,</span>&nbsp;<span class="num" id="6803383">0xca</span><span class="op" id="6803387">,</span>&nbsp;<span class="num" id="6803389">0x74</span><span class="op" id="6803393">,</span>&nbsp;<span class="num" id="6803395">0xff</span><span class="op" id="6803399">,</span>&nbsp;<span class="num" id="6803401">0x77</span><span class="op" id="6803405">,</span>&nbsp;<span class="num" id="6803407">0xa5</span><span class="op" id="6803411">,</span>&nbsp;<span class="num" id="6803413">0x3c</span><span class="op" id="6803417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803421">0xb7</span><span class="op" id="6803425">,</span>&nbsp;<span class="num" id="6803427">0x29</span><span class="op" id="6803431">,</span>&nbsp;<span class="num" id="6803433">0x80</span><span class="op" id="6803437">,</span>&nbsp;<span class="num" id="6803439">0x2f</span><span class="op" id="6803443">,</span>&nbsp;<span class="num" id="6803445">0x6e</span><span class="op" id="6803449">,</span>&nbsp;<span class="num" id="6803451">0xd4</span><span class="op" id="6803455">,</span>&nbsp;<span class="num" id="6803457">0xa5</span><span class="op" id="6803461">,</span>&nbsp;<span class="num" id="6803463">0xff</span><span class="op" id="6803467">,</span>&nbsp;<span class="num" id="6803469">0xa8</span><span class="op" id="6803473">,</span>&nbsp;<span class="num" id="6803475">0xba</span><span class="op" id="6803479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803483">0x15</span><span class="op" id="6803487">,</span>&nbsp;<span class="num" id="6803489">0x98</span><span class="op" id="6803493">,</span>&nbsp;<span class="num" id="6803495">0x90</span><span class="op" id="6803499">,</span>&nbsp;<span class="num" id="6803501">0xfc</span><span class="op" id="6803505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6803508">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6803511">salt</span>&nbsp;<span class="op" id="6803516">:=</span>&nbsp;<span class="op" id="6803519">[</span><span class="op" id="6803520">]</span><span class="builtintype" id="6803521">byte</span><span class="op" id="6803525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803529">0xe3</span><span class="op" id="6803533">,</span>&nbsp;<span class="num" id="6803535">0xb5</span><span class="op" id="6803539">,</span>&nbsp;<span class="num" id="6803541">0xd5</span><span class="op" id="6803545">,</span>&nbsp;<span class="num" id="6803547">0xd0</span><span class="op" id="6803551">,</span>&nbsp;<span class="num" id="6803553">0x02</span><span class="op" id="6803557">,</span>&nbsp;<span class="num" id="6803559">0xc1</span><span class="op" id="6803563">,</span>&nbsp;<span class="num" id="6803565">0xbc</span><span class="op" id="6803569">,</span>&nbsp;<span class="num" id="6803571">0xe5</span><span class="op" id="6803575">,</span>&nbsp;<span class="num" id="6803577">0x0c</span><span class="op" id="6803581">,</span>&nbsp;<span class="num" id="6803583">0x2b</span><span class="op" id="6803587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803591">0x65</span><span class="op" id="6803595">,</span>&nbsp;<span class="num" id="6803597">0xef</span><span class="op" id="6803601">,</span>&nbsp;<span class="num" id="6803603">0x88</span><span class="op" id="6803607">,</span>&nbsp;<span class="num" id="6803609">0xa1</span><span class="op" id="6803613">,</span>&nbsp;<span class="num" id="6803615">0x88</span><span class="op" id="6803619">,</span>&nbsp;<span class="num" id="6803621">0xd8</span><span class="op" id="6803625">,</span>&nbsp;<span class="num" id="6803627">0x3b</span><span class="op" id="6803631">,</span>&nbsp;<span class="num" id="6803633">0xce</span><span class="op" id="6803637">,</span>&nbsp;<span class="num" id="6803639">0x7e</span><span class="op" id="6803643">,</span>&nbsp;<span class="num" id="6803645">0x61</span><span class="op" id="6803649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6803652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6803655">expected</span>&nbsp;<span class="op" id="6803664">:=</span>&nbsp;<span class="op" id="6803667">[</span><span class="op" id="6803668">]</span><span class="builtintype" id="6803669">byte</span><span class="op" id="6803673">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803677">0x66</span><span class="op" id="6803681">,</span>&nbsp;<span class="num" id="6803683">0xe4</span><span class="op" id="6803687">,</span>&nbsp;<span class="num" id="6803689">0x67</span><span class="op" id="6803693">,</span>&nbsp;<span class="num" id="6803695">0x2e</span><span class="op" id="6803699">,</span>&nbsp;<span class="num" id="6803701">0x83</span><span class="op" id="6803705">,</span>&nbsp;<span class="num" id="6803707">0x6a</span><span class="op" id="6803711">,</span>&nbsp;<span class="num" id="6803713">0xd1</span><span class="op" id="6803717">,</span>&nbsp;<span class="num" id="6803719">0x21</span><span class="op" id="6803723">,</span>&nbsp;<span class="num" id="6803725">0xba</span><span class="op" id="6803729">,</span>&nbsp;<span class="num" id="6803731">0x24</span><span class="op" id="6803735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803739">0x4b</span><span class="op" id="6803743">,</span>&nbsp;<span class="num" id="6803745">0xed</span><span class="op" id="6803749">,</span>&nbsp;<span class="num" id="6803751">0x65</span><span class="op" id="6803755">,</span>&nbsp;<span class="num" id="6803757">0x76</span><span class="op" id="6803761">,</span>&nbsp;<span class="num" id="6803763">0xb8</span><span class="op" id="6803767">,</span>&nbsp;<span class="num" id="6803769">0x67</span><span class="op" id="6803773">,</span>&nbsp;<span class="num" id="6803775">0xd9</span><span class="op" id="6803779">,</span>&nbsp;<span class="num" id="6803781">0xa4</span><span class="op" id="6803785">,</span>&nbsp;<span class="num" id="6803787">0x47</span><span class="op" id="6803791">,</span>&nbsp;<span class="num" id="6803793">0xc2</span><span class="op" id="6803797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803801">0x8a</span><span class="op" id="6803805">,</span>&nbsp;<span class="num" id="6803807">0x6e</span><span class="op" id="6803811">,</span>&nbsp;<span class="num" id="6803813">0x66</span><span class="op" id="6803817">,</span>&nbsp;<span class="num" id="6803819">0xa5</span><span class="op" id="6803823">,</span>&nbsp;<span class="num" id="6803825">0xb8</span><span class="op" id="6803829">,</span>&nbsp;<span class="num" id="6803831">0x7d</span><span class="op" id="6803835">,</span>&nbsp;<span class="num" id="6803837">0xee</span><span class="op" id="6803841">,</span>&nbsp;<span class="num" id="6803843">0x7f</span><span class="op" id="6803847">,</span>&nbsp;<span class="num" id="6803849">0xbc</span><span class="op" id="6803853">,</span>&nbsp;<span class="num" id="6803855">0x7e</span><span class="op" id="6803859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803863">0x65</span><span class="op" id="6803867">,</span>&nbsp;<span class="num" id="6803869">0xaf</span><span class="op" id="6803873">,</span>&nbsp;<span class="num" id="6803875">0x50</span><span class="op" id="6803879">,</span>&nbsp;<span class="num" id="6803881">0x57</span><span class="op" id="6803885">,</span>&nbsp;<span class="num" id="6803887">0xf8</span><span class="op" id="6803891">,</span>&nbsp;<span class="num" id="6803893">0x6f</span><span class="op" id="6803897">,</span>&nbsp;<span class="num" id="6803899">0xae</span><span class="op" id="6803903">,</span>&nbsp;<span class="num" id="6803905">0x89</span><span class="op" id="6803909">,</span>&nbsp;<span class="num" id="6803911">0x84</span><span class="op" id="6803915">,</span>&nbsp;<span class="num" id="6803917">0xd9</span><span class="op" id="6803921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803925">0xba</span><span class="op" id="6803929">,</span>&nbsp;<span class="num" id="6803931">0x7f</span><span class="op" id="6803935">,</span>&nbsp;<span class="num" id="6803937">0x96</span><span class="op" id="6803941">,</span>&nbsp;<span class="num" id="6803943">0x9a</span><span class="op" id="6803947">,</span>&nbsp;<span class="num" id="6803949">0xd6</span><span class="op" id="6803953">,</span>&nbsp;<span class="num" id="6803955">0xfe</span><span class="op" id="6803959">,</span>&nbsp;<span class="num" id="6803961">0x02</span><span class="op" id="6803965">,</span>&nbsp;<span class="num" id="6803967">0xa4</span><span class="op" id="6803971">,</span>&nbsp;<span class="num" id="6803973">0xd7</span><span class="op" id="6803977">,</span>&nbsp;<span class="num" id="6803979">0x5f</span><span class="op" id="6803983">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6803987">0x74</span><span class="op" id="6803991">,</span>&nbsp;<span class="num" id="6803993">0x45</span><span class="op" id="6803997">,</span>&nbsp;<span class="num" id="6803999">0xfe</span><span class="op" id="6804003">,</span>&nbsp;<span class="num" id="6804005">0xfd</span><span class="op" id="6804009">,</span>&nbsp;<span class="num" id="6804011">0xd8</span><span class="op" id="6804015">,</span>&nbsp;<span class="num" id="6804017">0x5b</span><span class="op" id="6804021">,</span>&nbsp;<span class="num" id="6804023">0x6d</span><span class="op" id="6804027">,</span>&nbsp;<span class="num" id="6804029">0x3a</span><span class="op" id="6804033">,</span>&nbsp;<span class="num" id="6804035">0x47</span><span class="op" id="6804039">,</span>&nbsp;<span class="num" id="6804041">0x7c</span><span class="op" id="6804045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804049">0x28</span><span class="op" id="6804053">,</span>&nbsp;<span class="num" id="6804055">0xd2</span><span class="op" id="6804059">,</span>&nbsp;<span class="num" id="6804061">0x4b</span><span class="op" id="6804065">,</span>&nbsp;<span class="num" id="6804067">0xa1</span><span class="op" id="6804071">,</span>&nbsp;<span class="num" id="6804073">0xe3</span><span class="op" id="6804077">,</span>&nbsp;<span class="num" id="6804079">0x75</span><span class="op" id="6804083">,</span>&nbsp;<span class="num" id="6804085">0x6f</span><span class="op" id="6804089">,</span>&nbsp;<span class="num" id="6804091">0x79</span><span class="op" id="6804095">,</span>&nbsp;<span class="num" id="6804097">0x2d</span><span class="op" id="6804101">,</span>&nbsp;<span class="num" id="6804103">0xd1</span><span class="op" id="6804107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804111">0xdc</span><span class="op" id="6804115">,</span>&nbsp;<span class="num" id="6804117">0xe8</span><span class="op" id="6804121">,</span>&nbsp;<span class="num" id="6804123">0xca</span><span class="op" id="6804127">,</span>&nbsp;<span class="num" id="6804129">0x94</span><span class="op" id="6804133">,</span>&nbsp;<span class="num" id="6804135">0x44</span><span class="op" id="6804139">,</span>&nbsp;<span class="num" id="6804141">0x0e</span><span class="op" id="6804145">,</span>&nbsp;<span class="num" id="6804147">0xcb</span><span class="op" id="6804151">,</span>&nbsp;<span class="num" id="6804153">0x52</span><span class="op" id="6804157">,</span>&nbsp;<span class="num" id="6804159">0x79</span><span class="op" id="6804163">,</span>&nbsp;<span class="num" id="6804165">0xec</span><span class="op" id="6804169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804173">0xd3</span><span class="op" id="6804177">,</span>&nbsp;<span class="num" id="6804179">0x18</span><span class="op" id="6804183">,</span>&nbsp;<span class="num" id="6804185">0x3a</span><span class="op" id="6804189">,</span>&nbsp;<span class="num" id="6804191">0x31</span><span class="op" id="6804195">,</span>&nbsp;<span class="num" id="6804197">0x1f</span><span class="op" id="6804201">,</span>&nbsp;<span class="num" id="6804203">0xc8</span><span class="op" id="6804207">,</span>&nbsp;<span class="num" id="6804209">0x96</span><span class="op" id="6804213">,</span>&nbsp;<span class="num" id="6804215">0xda</span><span class="op" id="6804219">,</span>&nbsp;<span class="num" id="6804221">0x1c</span><span class="op" id="6804225">,</span>&nbsp;<span class="num" id="6804227">0xb3</span><span class="op" id="6804231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804235">0x93</span><span class="op" id="6804239">,</span>&nbsp;<span class="num" id="6804241">0x11</span><span class="op" id="6804245">,</span>&nbsp;<span class="num" id="6804247">0xaf</span><span class="op" id="6804251">,</span>&nbsp;<span class="num" id="6804253">0x37</span><span class="op" id="6804257">,</span>&nbsp;<span class="num" id="6804259">0xea</span><span class="op" id="6804263">,</span>&nbsp;<span class="num" id="6804265">0x4a</span><span class="op" id="6804269">,</span>&nbsp;<span class="num" id="6804271">0x75</span><span class="op" id="6804275">,</span>&nbsp;<span class="num" id="6804277">0xe2</span><span class="op" id="6804281">,</span>&nbsp;<span class="num" id="6804283">0x4b</span><span class="op" id="6804287">,</span>&nbsp;<span class="num" id="6804289">0xdb</span><span class="op" id="6804293">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804297">0xfd</span><span class="op" id="6804301">,</span>&nbsp;<span class="num" id="6804303">0x5c</span><span class="op" id="6804307">,</span>&nbsp;<span class="num" id="6804309">0x1d</span><span class="op" id="6804313">,</span>&nbsp;<span class="num" id="6804315">0xa0</span><span class="op" id="6804319">,</span>&nbsp;<span class="num" id="6804321">0xde</span><span class="op" id="6804325">,</span>&nbsp;<span class="num" id="6804327">0x7c</span><span class="op" id="6804331">,</span>&nbsp;<span class="num" id="6804333">0xec</span><span class="op" id="6804337">,</span>&nbsp;<span class="num" id="6804339">0xdf</span><span class="op" id="6804343">,</span>&nbsp;<span class="num" id="6804345">0x1a</span><span class="op" id="6804349">,</span>&nbsp;<span class="num" id="6804351">0x89</span><span class="op" id="6804355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804359">0x6f</span><span class="op" id="6804363">,</span>&nbsp;<span class="num" id="6804365">0x9d</span><span class="op" id="6804369">,</span>&nbsp;<span class="num" id="6804371">0x8b</span><span class="op" id="6804375">,</span>&nbsp;<span class="num" id="6804377">0xc8</span><span class="op" id="6804381">,</span>&nbsp;<span class="num" id="6804383">0x16</span><span class="op" id="6804387">,</span>&nbsp;<span class="num" id="6804389">0xd9</span><span class="op" id="6804393">,</span>&nbsp;<span class="num" id="6804395">0x7c</span><span class="op" id="6804399">,</span>&nbsp;<span class="num" id="6804401">0xd7</span><span class="op" id="6804405">,</span>&nbsp;<span class="num" id="6804407">0xa2</span><span class="op" id="6804411">,</span>&nbsp;<span class="num" id="6804413">0xc4</span><span class="op" id="6804417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6804421">0x3b</span><span class="op" id="6804425">,</span>&nbsp;<span class="num" id="6804427">0xad</span><span class="op" id="6804431">,</span>&nbsp;<span class="num" id="6804433">0x54</span><span class="op" id="6804437">,</span>&nbsp;<span class="num" id="6804439">0x6f</span><span class="op" id="6804443">,</span>&nbsp;<span class="num" id="6804445">0xbe</span><span class="op" id="6804449">,</span>&nbsp;<span class="num" id="6804451">0x8c</span><span class="op" id="6804455">,</span>&nbsp;<span class="num" id="6804457">0xfe</span><span class="op" id="6804461">,</span>&nbsp;<span class="num" id="6804463">0xbc</span><span class="op" id="6804467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6804470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804474">hash</span>&nbsp;<span class="op" id="6804479">:=</span>&nbsp;<span class="ident" id="6804482">sha1</span><span class="op" id="6804486">.</span><span class="ident" id="6804487">New</span><span class="op" id="6804490">(</span><span class="op" id="6804491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804494">hash</span><span class="op" id="6804498">.</span><span class="ident" id="6804499">Write</span><span class="op" id="6804504">(</span><span class="ident" id="6804505">msg</span><span class="op" id="6804508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804511">hashed</span>&nbsp;<span class="op" id="6804518">:=</span>&nbsp;<span class="ident" id="6804521">hash</span><span class="op" id="6804525">.</span><span class="ident" id="6804526">Sum</span><span class="op" id="6804529">(</span><span class="builtintype" id="6804530">nil</span><span class="op" id="6804533">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804537">encoded</span><span class="op" id="6804544">,</span>&nbsp;<span class="ident" id="6804546">err</span>&nbsp;<span class="op" id="6804550">:=</span>&nbsp;<span class="ident" id="6804553">emsaPSSEncode</span><span class="op" id="6804566">(</span><span class="ident" id="6804567">hashed</span><span class="op" id="6804573">,</span>&nbsp;<span class="num" id="6804575">1023</span><span class="op" id="6804579">,</span>&nbsp;<span class="ident" id="6804581">salt</span><span class="op" id="6804585">,</span>&nbsp;<span class="ident" id="6804587">sha1</span><span class="op" id="6804591">.</span><span class="ident" id="6804592">New</span><span class="op" id="6804595">(</span><span class="op" id="6804596">)</span><span class="op" id="6804597">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6804600">if</span>&nbsp;<span class="ident" id="6804603">err</span>&nbsp;<span class="op" id="6804607">!=</span>&nbsp;<span class="builtintype" id="6804610">nil</span>&nbsp;<span class="op" id="6804614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804618">t</span><span class="op" id="6804619">.</span><span class="ident" id="6804620">Errorf</span><span class="op" id="6804626">(</span><span class="string" id="6804627">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="6804659">,</span>&nbsp;<span class="ident" id="6804661">err</span><span class="op" id="6804664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6804667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6804670">if</span>&nbsp;<span class="op" id="6804673">!</span><span class="ident" id="6804674">bytes</span><span class="op" id="6804679">.</span><span class="ident" id="6804680">Equal</span><span class="op" id="6804685">(</span><span class="ident" id="6804686">encoded</span><span class="op" id="6804693">,</span>&nbsp;<span class="ident" id="6804695">expected</span><span class="op" id="6804703">)</span>&nbsp;<span class="op" id="6804705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804709">t</span><span class="op" id="6804710">.</span><span class="ident" id="6804711">Errorf</span><span class="op" id="6804717">(</span><span class="string" id="6804718">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6804749">,</span>&nbsp;<span class="ident" id="6804751">encoded</span><span class="op" id="6804758">,</span>&nbsp;<span class="ident" id="6804760">expected</span><span class="op" id="6804768">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6804771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6804775">if</span>&nbsp;<span class="ident" id="6804778">err</span>&nbsp;<span class="op" id="6804782">=</span>&nbsp;<span class="ident" id="6804784">emsaPSSVerify</span><span class="op" id="6804797">(</span><span class="ident" id="6804798">hashed</span><span class="op" id="6804804">,</span>&nbsp;<span class="ident" id="6804806">encoded</span><span class="op" id="6804813">,</span>&nbsp;<span class="num" id="6804815">1023</span><span class="op" id="6804819">,</span>&nbsp;<span class="builtinfunc" id="6804821">len</span><span class="op" id="6804824">(</span><span class="ident" id="6804825">salt</span><span class="op" id="6804829">)</span><span class="op" id="6804830">,</span>&nbsp;<span class="ident" id="6804832">sha1</span><span class="op" id="6804836">.</span><span class="ident" id="6804837">New</span><span class="op" id="6804840">(</span><span class="op" id="6804841">)</span><span class="op" id="6804842">)</span><span class="op" id="6804843">;</span>&nbsp;<span class="ident" id="6804845">err</span>&nbsp;<span class="op" id="6804849">!=</span>&nbsp;<span class="builtintype" id="6804852">nil</span>&nbsp;<span class="op" id="6804856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6804860">t</span><span class="op" id="6804861">.</span><span class="ident" id="6804862">Errorf</span><span class="op" id="6804868">(</span><span class="string" id="6804869">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="6804891">,</span>&nbsp;<span class="ident" id="6804893">err</span><span class="op" id="6804896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6804899">}</span><br>
<span class="lineno">75</span><span class="op" id="6804901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6804904">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6804969">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="6805033">func</span>&nbsp;<span class="ident" id="6805038">TestPSSGolden</span><span class="op" id="6805051">(</span><span class="ident" id="6805052">t</span>&nbsp;<span class="op" id="6805054">*</span><span class="ident" id="6805055">testing</span><span class="op" id="6805062">.</span><span class="ident" id="6805063">T</span><span class="op" id="6805064">)</span>&nbsp;<span class="op" id="6805066">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805069">inFile</span><span class="op" id="6805075">,</span>&nbsp;<span class="ident" id="6805077">err</span>&nbsp;<span class="op" id="6805081">:=</span>&nbsp;<span class="ident" id="6805084">os</span><span class="op" id="6805086">.</span><span class="ident" id="6805087">Open</span><span class="op" id="6805091">(</span><span class="string" id="6805092">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="6805119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805122">if</span>&nbsp;<span class="ident" id="6805125">err</span>&nbsp;<span class="op" id="6805129">!=</span>&nbsp;<span class="builtintype" id="6805132">nil</span>&nbsp;<span class="op" id="6805136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805140">t</span><span class="op" id="6805141">.</span><span class="ident" id="6805142">Fatalf</span><span class="op" id="6805148">(</span><span class="string" id="6805149">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="6805180">,</span>&nbsp;<span class="ident" id="6805182">err</span><span class="op" id="6805185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6805188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805191">defer</span>&nbsp;<span class="ident" id="6805197">inFile</span><span class="op" id="6805203">.</span><span class="ident" id="6805204">Close</span><span class="op" id="6805209">(</span><span class="op" id="6805210">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6805214">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6805279">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6805350">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6805420">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805455">const</span>&nbsp;<span class="ident" id="6805461">newKeyMarker</span>&nbsp;<span class="op" id="6805474">=</span>&nbsp;<span class="string" id="6805476">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805493">const</span>&nbsp;<span class="ident" id="6805499">newSignatureMarker</span>&nbsp;<span class="op" id="6805518">=</span>&nbsp;<span class="string" id="6805520">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805544">values</span>&nbsp;<span class="op" id="6805551">:=</span>&nbsp;<span class="builtinfunc" id="6805554">make</span><span class="op" id="6805558">(</span><span class="keyword" id="6805559">chan</span>&nbsp;<span class="builtintype" id="6805564">string</span><span class="op" id="6805570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805574">go</span>&nbsp;<span class="keyword" id="6805577">func</span><span class="op" id="6805581">(</span><span class="op" id="6805582">)</span>&nbsp;<span class="op" id="6805584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805588">defer</span>&nbsp;<span class="builtinfunc" id="6805594">close</span><span class="op" id="6805599">(</span><span class="ident" id="6805600">values</span><span class="op" id="6805606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805610">scanner</span>&nbsp;<span class="op" id="6805618">:=</span>&nbsp;<span class="ident" id="6805621">bufio</span><span class="op" id="6805626">.</span><span class="ident" id="6805627">NewScanner</span><span class="op" id="6805637">(</span><span class="ident" id="6805638">bzip2</span><span class="op" id="6805643">.</span><span class="ident" id="6805644">NewReader</span><span class="op" id="6805653">(</span><span class="ident" id="6805654">inFile</span><span class="op" id="6805660">)</span><span class="op" id="6805661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805665">var</span>&nbsp;<span class="ident" id="6805669">partialValue</span>&nbsp;<span class="builtintype" id="6805682">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805691">lastWasValue</span>&nbsp;<span class="op" id="6805704">:=</span>&nbsp;<span class="builtintype" id="6805707">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805715">for</span>&nbsp;<span class="ident" id="6805719">scanner</span><span class="op" id="6805726">.</span><span class="ident" id="6805727">Scan</span><span class="op" id="6805731">(</span><span class="op" id="6805732">)</span>&nbsp;<span class="op" id="6805734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805739">line</span>&nbsp;<span class="op" id="6805744">:=</span>&nbsp;<span class="ident" id="6805747">scanner</span><span class="op" id="6805754">.</span><span class="ident" id="6805755">Text</span><span class="op" id="6805759">(</span><span class="op" id="6805760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805765">switch</span>&nbsp;<span class="op" id="6805772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805777">case</span>&nbsp;<span class="builtinfunc" id="6805782">len</span><span class="op" id="6805785">(</span><span class="ident" id="6805786">line</span><span class="op" id="6805790">)</span>&nbsp;<span class="op" id="6805792">==</span>&nbsp;<span class="num" id="6805795">0</span><span class="op" id="6805796">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805802">if</span>&nbsp;<span class="builtinfunc" id="6805805">len</span><span class="op" id="6805808">(</span><span class="ident" id="6805809">partialValue</span><span class="op" id="6805821">)</span>&nbsp;<span class="op" id="6805823">&gt;</span>&nbsp;<span class="num" id="6805825">0</span>&nbsp;<span class="op" id="6805827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805834">values</span>&nbsp;<span class="op" id="6805841">&lt;-</span>&nbsp;<span class="ident" id="6805844">strings</span><span class="op" id="6805851">.</span><span class="ident" id="6805852">Replace</span><span class="op" id="6805859">(</span><span class="ident" id="6805860">partialValue</span><span class="op" id="6805872">,</span>&nbsp;<span class="string" id="6805874">&#34;&nbsp;&#34;</span><span class="op" id="6805877">,</span>&nbsp;<span class="string" id="6805879">&#34;&#34;</span><span class="op" id="6805881">,</span>&nbsp;<span class="op" id="6805883">-</span><span class="num" id="6805884">1</span><span class="op" id="6805885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805892">partialValue</span>&nbsp;<span class="op" id="6805905">=</span>&nbsp;<span class="string" id="6805907">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6805915">lastWasValue</span>&nbsp;<span class="op" id="6805928">=</span>&nbsp;<span class="builtintype" id="6805930">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6805939">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805945">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6805957">case</span>&nbsp;<span class="ident" id="6805962">strings</span><span class="op" id="6805969">.</span><span class="ident" id="6805970">HasPrefix</span><span class="op" id="6805979">(</span><span class="ident" id="6805980">line</span><span class="op" id="6805984">,</span>&nbsp;<span class="string" id="6805986">&#34;#&nbsp;======&#34;</span><span class="op" id="6805996">)</span>&nbsp;<span class="op" id="6805998">&amp;&amp;</span>&nbsp;<span class="ident" id="6806001">lastWasValue</span><span class="op" id="6806013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806019">values</span>&nbsp;<span class="op" id="6806026">&lt;-</span>&nbsp;<span class="ident" id="6806029">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806046">lastWasValue</span>&nbsp;<span class="op" id="6806059">=</span>&nbsp;<span class="builtintype" id="6806061">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806070">case</span>&nbsp;<span class="ident" id="6806075">strings</span><span class="op" id="6806082">.</span><span class="ident" id="6806083">HasPrefix</span><span class="op" id="6806092">(</span><span class="ident" id="6806093">line</span><span class="op" id="6806097">,</span>&nbsp;<span class="string" id="6806099">&#34;#&nbsp;------&#34;</span><span class="op" id="6806109">)</span>&nbsp;<span class="op" id="6806111">&amp;&amp;</span>&nbsp;<span class="ident" id="6806114">lastWasValue</span><span class="op" id="6806126">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806132">values</span>&nbsp;<span class="op" id="6806139">&lt;-</span>&nbsp;<span class="ident" id="6806142">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806165">lastWasValue</span>&nbsp;<span class="op" id="6806178">=</span>&nbsp;<span class="builtintype" id="6806180">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806189">case</span>&nbsp;<span class="ident" id="6806194">strings</span><span class="op" id="6806201">.</span><span class="ident" id="6806202">HasPrefix</span><span class="op" id="6806211">(</span><span class="ident" id="6806212">line</span><span class="op" id="6806216">,</span>&nbsp;<span class="string" id="6806218">&#34;#&#34;</span><span class="op" id="6806221">)</span><span class="op" id="6806222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806228">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806240">default</span><span class="op" id="6806247">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806253">partialValue</span>&nbsp;<span class="op" id="6806266">+=</span>&nbsp;<span class="ident" id="6806269">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806285">if</span>&nbsp;<span class="ident" id="6806288">err</span>&nbsp;<span class="op" id="6806292">:=</span>&nbsp;<span class="ident" id="6806295">scanner</span><span class="op" id="6806302">.</span><span class="ident" id="6806303">Err</span><span class="op" id="6806306">(</span><span class="op" id="6806307">)</span><span class="op" id="6806308">;</span>&nbsp;<span class="ident" id="6806310">err</span>&nbsp;<span class="op" id="6806314">!=</span>&nbsp;<span class="builtintype" id="6806317">nil</span>&nbsp;<span class="op" id="6806321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6806326">panic</span><span class="op" id="6806331">(</span><span class="ident" id="6806332">err</span><span class="op" id="6806335">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806342">}</span><span class="op" id="6806343">(</span><span class="op" id="6806344">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806348">var</span>&nbsp;<span class="ident" id="6806352">key</span>&nbsp;<span class="op" id="6806356">*</span><span class="ident" id="6806357">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806368">var</span>&nbsp;<span class="ident" id="6806372">hashed</span>&nbsp;<span class="op" id="6806379">[</span><span class="op" id="6806380">]</span><span class="builtintype" id="6806381">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806387">hash</span>&nbsp;<span class="op" id="6806392">:=</span>&nbsp;<span class="ident" id="6806395">crypto</span><span class="op" id="6806401">.</span><span class="ident" id="6806402">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806408">h</span>&nbsp;<span class="op" id="6806410">:=</span>&nbsp;<span class="ident" id="6806413">hash</span><span class="op" id="6806417">.</span><span class="ident" id="6806418">New</span><span class="op" id="6806421">(</span><span class="op" id="6806422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806425">opts</span>&nbsp;<span class="op" id="6806430">:=</span>&nbsp;<span class="op" id="6806433">&amp;</span><span class="ident" id="6806434">PSSOptions</span><span class="op" id="6806444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806448">SaltLength</span><span class="op" id="6806458">:</span>&nbsp;<span class="ident" id="6806460">PSSSaltLengthEqualsHash</span><span class="op" id="6806483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806486">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806490">for</span>&nbsp;<span class="ident" id="6806494">marker</span>&nbsp;<span class="op" id="6806501">:=</span>&nbsp;<span class="keyword" id="6806504">range</span>&nbsp;<span class="ident" id="6806510">values</span>&nbsp;<span class="op" id="6806517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806521">switch</span>&nbsp;<span class="ident" id="6806528">marker</span>&nbsp;<span class="op" id="6806535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806539">case</span>&nbsp;<span class="ident" id="6806544">newKeyMarker</span><span class="op" id="6806556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806561">key</span>&nbsp;<span class="op" id="6806565">=</span>&nbsp;<span class="builtinfunc" id="6806567">new</span><span class="op" id="6806570">(</span><span class="ident" id="6806571">PublicKey</span><span class="op" id="6806580">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806585">nHex</span><span class="op" id="6806589">,</span>&nbsp;<span class="ident" id="6806591">ok</span>&nbsp;<span class="op" id="6806594">:=</span>&nbsp;<span class="op" id="6806597">&lt;-</span><span class="ident" id="6806599">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806609">if</span>&nbsp;<span class="op" id="6806612">!</span><span class="ident" id="6806613">ok</span>&nbsp;<span class="op" id="6806616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806622">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806639">key</span><span class="op" id="6806642">.</span><span class="ident" id="6806643">N</span>&nbsp;<span class="op" id="6806645">=</span>&nbsp;<span class="ident" id="6806647">bigFromHex</span><span class="op" id="6806657">(</span><span class="ident" id="6806658">nHex</span><span class="op" id="6806662">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806667">key</span><span class="op" id="6806670">.</span><span class="ident" id="6806671">E</span>&nbsp;<span class="op" id="6806673">=</span>&nbsp;<span class="ident" id="6806675">intFromHex</span><span class="op" id="6806685">(</span><span class="op" id="6806686">&lt;-</span><span class="ident" id="6806688">values</span><span class="op" id="6806694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6806699">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806748">for</span>&nbsp;<span class="ident" id="6806752">i</span>&nbsp;<span class="op" id="6806754">:=</span>&nbsp;<span class="num" id="6806757">0</span><span class="op" id="6806758">;</span>&nbsp;<span class="ident" id="6806760">i</span>&nbsp;<span class="op" id="6806762">&lt;</span>&nbsp;<span class="num" id="6806764">6</span><span class="op" id="6806765">;</span>&nbsp;<span class="ident" id="6806767">i</span><span class="op" id="6806768">++</span>&nbsp;<span class="op" id="6806771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806777">&lt;-</span><span class="ident" id="6806779">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806789">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806793">case</span>&nbsp;<span class="ident" id="6806798">newSignatureMarker</span><span class="op" id="6806816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806821">msg</span>&nbsp;<span class="op" id="6806825">:=</span>&nbsp;<span class="ident" id="6806828">fromHex</span><span class="op" id="6806835">(</span><span class="op" id="6806836">&lt;-</span><span class="ident" id="6806838">values</span><span class="op" id="6806844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6806849">&lt;-</span><span class="ident" id="6806851">values</span>&nbsp;<span class="comment" id="6806858">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806874">sig</span>&nbsp;<span class="op" id="6806878">:=</span>&nbsp;<span class="ident" id="6806881">fromHex</span><span class="op" id="6806888">(</span><span class="op" id="6806889">&lt;-</span><span class="ident" id="6806891">values</span><span class="op" id="6806897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806903">h</span><span class="op" id="6806904">.</span><span class="ident" id="6806905">Reset</span><span class="op" id="6806910">(</span><span class="op" id="6806911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806916">h</span><span class="op" id="6806917">.</span><span class="ident" id="6806918">Write</span><span class="op" id="6806923">(</span><span class="ident" id="6806924">msg</span><span class="op" id="6806927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6806932">hashed</span>&nbsp;<span class="op" id="6806939">=</span>&nbsp;<span class="ident" id="6806941">h</span><span class="op" id="6806942">.</span><span class="ident" id="6806943">Sum</span><span class="op" id="6806946">(</span><span class="ident" id="6806947">hashed</span><span class="op" id="6806953">[</span><span class="op" id="6806954">:</span><span class="num" id="6806955">0</span><span class="op" id="6806956">]</span><span class="op" id="6806957">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6806963">if</span>&nbsp;<span class="ident" id="6806966">err</span>&nbsp;<span class="op" id="6806970">:=</span>&nbsp;<span class="ident" id="6806973">VerifyPSS</span><span class="op" id="6806982">(</span><span class="ident" id="6806983">key</span><span class="op" id="6806986">,</span>&nbsp;<span class="ident" id="6806988">hash</span><span class="op" id="6806992">,</span>&nbsp;<span class="ident" id="6806994">hashed</span><span class="op" id="6807000">,</span>&nbsp;<span class="ident" id="6807002">sig</span><span class="op" id="6807005">,</span>&nbsp;<span class="ident" id="6807007">opts</span><span class="op" id="6807011">)</span><span class="op" id="6807012">;</span>&nbsp;<span class="ident" id="6807014">err</span>&nbsp;<span class="op" id="6807018">!=</span>&nbsp;<span class="builtintype" id="6807021">nil</span>&nbsp;<span class="op" id="6807025">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807031">t</span><span class="op" id="6807032">.</span><span class="ident" id="6807033">Error</span><span class="op" id="6807038">(</span><span class="ident" id="6807039">err</span><span class="op" id="6807042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807051">default</span><span class="op" id="6807058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807063">t</span><span class="op" id="6807064">.</span><span class="ident" id="6807065">Fatalf</span><span class="op" id="6807071">(</span><span class="string" id="6807072">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="6807091">+</span>&nbsp;<span class="ident" id="6807093">marker</span><span class="op" id="6807099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807103">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807106">}</span><br>
<span class="lineno"></span><span class="op" id="6807108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6807111">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6807190">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="6807258">func</span>&nbsp;<span class="ident" id="6807263">TestPSSOpenSSL</span><span class="op" id="6807277">(</span><span class="ident" id="6807278">t</span>&nbsp;<span class="op" id="6807280">*</span><span class="ident" id="6807281">testing</span><span class="op" id="6807288">.</span><span class="ident" id="6807289">T</span><span class="op" id="6807290">)</span>&nbsp;<span class="op" id="6807292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807295">hash</span>&nbsp;<span class="op" id="6807300">:=</span>&nbsp;<span class="ident" id="6807303">crypto</span><span class="op" id="6807309">.</span><span class="ident" id="6807310">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807318">h</span>&nbsp;<span class="op" id="6807320">:=</span>&nbsp;<span class="ident" id="6807323">hash</span><span class="op" id="6807327">.</span><span class="ident" id="6807328">New</span><span class="op" id="6807331">(</span><span class="op" id="6807332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807335">h</span><span class="op" id="6807336">.</span><span class="ident" id="6807337">Write</span><span class="op" id="6807342">(</span><span class="op" id="6807343">[</span><span class="op" id="6807344">]</span><span class="builtintype" id="6807345">byte</span><span class="op" id="6807349">(</span><span class="string" id="6807350">&#34;testing&#34;</span><span class="op" id="6807359">)</span><span class="op" id="6807360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807363">hashed</span>&nbsp;<span class="op" id="6807370">:=</span>&nbsp;<span class="ident" id="6807373">h</span><span class="op" id="6807374">.</span><span class="ident" id="6807375">Sum</span><span class="op" id="6807378">(</span><span class="builtintype" id="6807379">nil</span><span class="op" id="6807382">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6807386">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807495">sig</span>&nbsp;<span class="op" id="6807499">:=</span>&nbsp;<span class="op" id="6807502">[</span><span class="op" id="6807503">]</span><span class="builtintype" id="6807504">byte</span><span class="op" id="6807508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807512">0x95</span><span class="op" id="6807516">,</span>&nbsp;<span class="num" id="6807518">0x59</span><span class="op" id="6807522">,</span>&nbsp;<span class="num" id="6807524">0x6f</span><span class="op" id="6807528">,</span>&nbsp;<span class="num" id="6807530">0xd3</span><span class="op" id="6807534">,</span>&nbsp;<span class="num" id="6807536">0x10</span><span class="op" id="6807540">,</span>&nbsp;<span class="num" id="6807542">0xa2</span><span class="op" id="6807546">,</span>&nbsp;<span class="num" id="6807548">0xe7</span><span class="op" id="6807552">,</span>&nbsp;<span class="num" id="6807554">0xa2</span><span class="op" id="6807558">,</span>&nbsp;<span class="num" id="6807560">0x92</span><span class="op" id="6807564">,</span>&nbsp;<span class="num" id="6807566">0x9d</span><span class="op" id="6807570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807574">0x4a</span><span class="op" id="6807578">,</span>&nbsp;<span class="num" id="6807580">0x07</span><span class="op" id="6807584">,</span>&nbsp;<span class="num" id="6807586">0x2e</span><span class="op" id="6807590">,</span>&nbsp;<span class="num" id="6807592">0x2b</span><span class="op" id="6807596">,</span>&nbsp;<span class="num" id="6807598">0x27</span><span class="op" id="6807602">,</span>&nbsp;<span class="num" id="6807604">0xcc</span><span class="op" id="6807608">,</span>&nbsp;<span class="num" id="6807610">0x06</span><span class="op" id="6807614">,</span>&nbsp;<span class="num" id="6807616">0xc2</span><span class="op" id="6807620">,</span>&nbsp;<span class="num" id="6807622">0x87</span><span class="op" id="6807626">,</span>&nbsp;<span class="num" id="6807628">0x2c</span><span class="op" id="6807632">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807636">0x52</span><span class="op" id="6807640">,</span>&nbsp;<span class="num" id="6807642">0xf0</span><span class="op" id="6807646">,</span>&nbsp;<span class="num" id="6807648">0x4a</span><span class="op" id="6807652">,</span>&nbsp;<span class="num" id="6807654">0xcc</span><span class="op" id="6807658">,</span>&nbsp;<span class="num" id="6807660">0x05</span><span class="op" id="6807664">,</span>&nbsp;<span class="num" id="6807666">0x94</span><span class="op" id="6807670">,</span>&nbsp;<span class="num" id="6807672">0xf2</span><span class="op" id="6807676">,</span>&nbsp;<span class="num" id="6807678">0xc3</span><span class="op" id="6807682">,</span>&nbsp;<span class="num" id="6807684">0x2e</span><span class="op" id="6807688">,</span>&nbsp;<span class="num" id="6807690">0x20</span><span class="op" id="6807694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807698">0xd7</span><span class="op" id="6807702">,</span>&nbsp;<span class="num" id="6807704">0x3e</span><span class="op" id="6807708">,</span>&nbsp;<span class="num" id="6807710">0x66</span><span class="op" id="6807714">,</span>&nbsp;<span class="num" id="6807716">0x62</span><span class="op" id="6807720">,</span>&nbsp;<span class="num" id="6807722">0xb5</span><span class="op" id="6807726">,</span>&nbsp;<span class="num" id="6807728">0x95</span><span class="op" id="6807732">,</span>&nbsp;<span class="num" id="6807734">0x2b</span><span class="op" id="6807738">,</span>&nbsp;<span class="num" id="6807740">0xa3</span><span class="op" id="6807744">,</span>&nbsp;<span class="num" id="6807746">0x93</span><span class="op" id="6807750">,</span>&nbsp;<span class="num" id="6807752">0x9a</span><span class="op" id="6807756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807760">0x66</span><span class="op" id="6807764">,</span>&nbsp;<span class="num" id="6807766">0x64</span><span class="op" id="6807770">,</span>&nbsp;<span class="num" id="6807772">0x25</span><span class="op" id="6807776">,</span>&nbsp;<span class="num" id="6807778">0xe0</span><span class="op" id="6807782">,</span>&nbsp;<span class="num" id="6807784">0x74</span><span class="op" id="6807788">,</span>&nbsp;<span class="num" id="6807790">0x66</span><span class="op" id="6807794">,</span>&nbsp;<span class="num" id="6807796">0x8c</span><span class="op" id="6807800">,</span>&nbsp;<span class="num" id="6807802">0x3e</span><span class="op" id="6807806">,</span>&nbsp;<span class="num" id="6807808">0x92</span><span class="op" id="6807812">,</span>&nbsp;<span class="num" id="6807814">0xeb</span><span class="op" id="6807818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807822">0xc6</span><span class="op" id="6807826">,</span>&nbsp;<span class="num" id="6807828">0xe6</span><span class="op" id="6807832">,</span>&nbsp;<span class="num" id="6807834">0xc0</span><span class="op" id="6807838">,</span>&nbsp;<span class="num" id="6807840">0x44</span><span class="op" id="6807844">,</span>&nbsp;<span class="num" id="6807846">0xf3</span><span class="op" id="6807850">,</span>&nbsp;<span class="num" id="6807852">0xb4</span><span class="op" id="6807856">,</span>&nbsp;<span class="num" id="6807858">0xb4</span><span class="op" id="6807862">,</span>&nbsp;<span class="num" id="6807864">0x2e</span><span class="op" id="6807868">,</span>&nbsp;<span class="num" id="6807870">0x8c</span><span class="op" id="6807874">,</span>&nbsp;<span class="num" id="6807876">0x66</span><span class="op" id="6807880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6807884">0x0a</span><span class="op" id="6807888">,</span>&nbsp;<span class="num" id="6807890">0x37</span><span class="op" id="6807894">,</span>&nbsp;<span class="num" id="6807896">0x9c</span><span class="op" id="6807900">,</span>&nbsp;<span class="num" id="6807902">0x69</span><span class="op" id="6807906">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807913">if</span>&nbsp;<span class="ident" id="6807916">err</span>&nbsp;<span class="op" id="6807920">:=</span>&nbsp;<span class="ident" id="6807923">VerifyPSS</span><span class="op" id="6807932">(</span><span class="op" id="6807933">&amp;</span><span class="ident" id="6807934">rsaPrivateKey</span><span class="op" id="6807947">.</span><span class="ident" id="6807948">PublicKey</span><span class="op" id="6807957">,</span>&nbsp;<span class="ident" id="6807959">hash</span><span class="op" id="6807963">,</span>&nbsp;<span class="ident" id="6807965">hashed</span><span class="op" id="6807971">,</span>&nbsp;<span class="ident" id="6807973">sig</span><span class="op" id="6807976">,</span>&nbsp;<span class="builtintype" id="6807978">nil</span><span class="op" id="6807981">)</span><span class="op" id="6807982">;</span>&nbsp;<span class="ident" id="6807984">err</span>&nbsp;<span class="op" id="6807988">!=</span>&nbsp;<span class="builtintype" id="6807991">nil</span>&nbsp;<span class="op" id="6807995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807999">t</span><span class="op" id="6808000">.</span><span class="ident" id="6808001">Error</span><span class="op" id="6808006">(</span><span class="ident" id="6808007">err</span><span class="op" id="6808010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808013">}</span><br>
<span class="lineno">190</span><span class="op" id="6808015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6808018">func</span>&nbsp;<span class="ident" id="6808023">TestPSSSigning</span><span class="op" id="6808037">(</span><span class="ident" id="6808038">t</span>&nbsp;<span class="op" id="6808040">*</span><span class="ident" id="6808041">testing</span><span class="op" id="6808048">.</span><span class="ident" id="6808049">T</span><span class="op" id="6808050">)</span>&nbsp;<span class="op" id="6808052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808055">var</span>&nbsp;<span class="ident" id="6808059">saltLengthCombinations</span>&nbsp;<span class="op" id="6808082">=</span>&nbsp;<span class="op" id="6808084">[</span><span class="op" id="6808085">]</span><span class="keyword" id="6808086">struct</span>&nbsp;<span class="op" id="6808093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808097">signSaltLength</span><span class="op" id="6808111">,</span>&nbsp;<span class="ident" id="6808113">verifySaltLength</span>&nbsp;<span class="builtintype" id="6808130">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808136">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6808169">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808175">}</span><span class="op" id="6808176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808180">{</span><span class="ident" id="6808181">PSSSaltLengthAuto</span><span class="op" id="6808198">,</span>&nbsp;<span class="ident" id="6808200">PSSSaltLengthAuto</span><span class="op" id="6808217">,</span>&nbsp;<span class="builtintype" id="6808219">true</span><span class="op" id="6808223">}</span><span class="op" id="6808224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808228">{</span><span class="ident" id="6808229">PSSSaltLengthEqualsHash</span><span class="op" id="6808252">,</span>&nbsp;<span class="ident" id="6808254">PSSSaltLengthAuto</span><span class="op" id="6808271">,</span>&nbsp;<span class="builtintype" id="6808273">true</span><span class="op" id="6808277">}</span><span class="op" id="6808278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808282">{</span><span class="ident" id="6808283">PSSSaltLengthEqualsHash</span><span class="op" id="6808306">,</span>&nbsp;<span class="ident" id="6808308">PSSSaltLengthEqualsHash</span><span class="op" id="6808331">,</span>&nbsp;<span class="builtintype" id="6808333">true</span><span class="op" id="6808337">}</span><span class="op" id="6808338">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808342">{</span><span class="ident" id="6808343">PSSSaltLengthEqualsHash</span><span class="op" id="6808366">,</span>&nbsp;<span class="num" id="6808368">8</span><span class="op" id="6808369">,</span>&nbsp;<span class="builtintype" id="6808371">false</span><span class="op" id="6808376">}</span><span class="op" id="6808377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808381">{</span><span class="ident" id="6808382">PSSSaltLengthAuto</span><span class="op" id="6808399">,</span>&nbsp;<span class="ident" id="6808401">PSSSaltLengthEqualsHash</span><span class="op" id="6808424">,</span>&nbsp;<span class="builtintype" id="6808426">false</span><span class="op" id="6808431">}</span><span class="op" id="6808432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808436">{</span><span class="num" id="6808437">8</span><span class="op" id="6808438">,</span>&nbsp;<span class="num" id="6808440">8</span><span class="op" id="6808441">,</span>&nbsp;<span class="builtintype" id="6808443">true</span><span class="op" id="6808447">}</span><span class="op" id="6808448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808455">hash</span>&nbsp;<span class="op" id="6808460">:=</span>&nbsp;<span class="ident" id="6808463">crypto</span><span class="op" id="6808469">.</span><span class="ident" id="6808470">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808475">h</span>&nbsp;<span class="op" id="6808477">:=</span>&nbsp;<span class="ident" id="6808480">hash</span><span class="op" id="6808484">.</span><span class="ident" id="6808485">New</span><span class="op" id="6808488">(</span><span class="op" id="6808489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808492">h</span><span class="op" id="6808493">.</span><span class="ident" id="6808494">Write</span><span class="op" id="6808499">(</span><span class="op" id="6808500">[</span><span class="op" id="6808501">]</span><span class="builtintype" id="6808502">byte</span><span class="op" id="6808506">(</span><span class="string" id="6808507">&#34;testing&#34;</span><span class="op" id="6808516">)</span><span class="op" id="6808517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808520">hashed</span>&nbsp;<span class="op" id="6808527">:=</span>&nbsp;<span class="ident" id="6808530">h</span><span class="op" id="6808531">.</span><span class="ident" id="6808532">Sum</span><span class="op" id="6808535">(</span><span class="builtintype" id="6808536">nil</span><span class="op" id="6808539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808542">var</span>&nbsp;<span class="ident" id="6808546">opts</span>&nbsp;<span class="ident" id="6808551">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808564">for</span>&nbsp;<span class="ident" id="6808568">i</span><span class="op" id="6808569">,</span>&nbsp;<span class="ident" id="6808571">test</span>&nbsp;<span class="op" id="6808576">:=</span>&nbsp;<span class="keyword" id="6808579">range</span>&nbsp;<span class="ident" id="6808585">saltLengthCombinations</span>&nbsp;<span class="op" id="6808608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808612">opts</span><span class="op" id="6808616">.</span><span class="ident" id="6808617">SaltLength</span>&nbsp;<span class="op" id="6808628">=</span>&nbsp;<span class="ident" id="6808630">test</span><span class="op" id="6808634">.</span><span class="ident" id="6808635">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808652">sig</span><span class="op" id="6808655">,</span>&nbsp;<span class="ident" id="6808657">err</span>&nbsp;<span class="op" id="6808661">:=</span>&nbsp;<span class="ident" id="6808664">SignPSS</span><span class="op" id="6808671">(</span><span class="ident" id="6808672">rand</span><span class="op" id="6808676">.</span><span class="ident" id="6808677">Reader</span><span class="op" id="6808683">,</span>&nbsp;<span class="ident" id="6808685">rsaPrivateKey</span><span class="op" id="6808698">,</span>&nbsp;<span class="ident" id="6808700">hash</span><span class="op" id="6808704">,</span>&nbsp;<span class="ident" id="6808706">hashed</span><span class="op" id="6808712">,</span>&nbsp;<span class="op" id="6808714">&amp;</span><span class="ident" id="6808715">opts</span><span class="op" id="6808719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808723">if</span>&nbsp;<span class="ident" id="6808726">err</span>&nbsp;<span class="op" id="6808730">!=</span>&nbsp;<span class="builtintype" id="6808733">nil</span>&nbsp;<span class="op" id="6808737">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808742">t</span><span class="op" id="6808743">.</span><span class="ident" id="6808744">Errorf</span><span class="op" id="6808750">(</span><span class="string" id="6808751">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6808781">,</span>&nbsp;<span class="ident" id="6808783">i</span><span class="op" id="6808784">,</span>&nbsp;<span class="ident" id="6808786">err</span><span class="op" id="6808789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808794">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808810">opts</span><span class="op" id="6808814">.</span><span class="ident" id="6808815">SaltLength</span>&nbsp;<span class="op" id="6808826">=</span>&nbsp;<span class="ident" id="6808828">test</span><span class="op" id="6808832">.</span><span class="ident" id="6808833">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808852">err</span>&nbsp;<span class="op" id="6808856">=</span>&nbsp;<span class="ident" id="6808858">VerifyPSS</span><span class="op" id="6808867">(</span><span class="op" id="6808868">&amp;</span><span class="ident" id="6808869">rsaPrivateKey</span><span class="op" id="6808882">.</span><span class="ident" id="6808883">PublicKey</span><span class="op" id="6808892">,</span>&nbsp;<span class="ident" id="6808894">hash</span><span class="op" id="6808898">,</span>&nbsp;<span class="ident" id="6808900">hashed</span><span class="op" id="6808906">,</span>&nbsp;<span class="ident" id="6808908">sig</span><span class="op" id="6808911">,</span>&nbsp;<span class="op" id="6808913">&amp;</span><span class="ident" id="6808914">opts</span><span class="op" id="6808918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808922">if</span>&nbsp;<span class="op" id="6808925">(</span><span class="ident" id="6808926">err</span>&nbsp;<span class="op" id="6808930">==</span>&nbsp;<span class="builtintype" id="6808933">nil</span><span class="op" id="6808936">)</span>&nbsp;<span class="op" id="6808938">!=</span>&nbsp;<span class="ident" id="6808941">test</span><span class="op" id="6808945">.</span><span class="ident" id="6808946">good</span>&nbsp;<span class="op" id="6808951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808956">t</span><span class="op" id="6808957">.</span><span class="ident" id="6808958">Errorf</span><span class="op" id="6808964">(</span><span class="string" id="6808965">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="6809003">,</span>&nbsp;<span class="ident" id="6809005">i</span><span class="op" id="6809006">,</span>&nbsp;<span class="ident" id="6809008">test</span><span class="op" id="6809012">.</span><span class="ident" id="6809013">good</span><span class="op" id="6809017">,</span>&nbsp;<span class="ident" id="6809019">err</span><span class="op" id="6809022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809029">}</span><br>
<span class="lineno">225</span><span class="op" id="6809031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6809034">func</span>&nbsp;<span class="ident" id="6809039">bigFromHex</span><span class="op" id="6809049">(</span><span class="ident" id="6809050">hex</span>&nbsp;<span class="builtintype" id="6809054">string</span><span class="op" id="6809060">)</span>&nbsp;<span class="op" id="6809062">*</span><span class="ident" id="6809063">big</span><span class="op" id="6809066">.</span><span class="ident" id="6809067">Int</span>&nbsp;<span class="op" id="6809071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809074">n</span><span class="op" id="6809075">,</span>&nbsp;<span class="ident" id="6809077">ok</span>&nbsp;<span class="op" id="6809080">:=</span>&nbsp;<span class="builtinfunc" id="6809083">new</span><span class="op" id="6809086">(</span><span class="ident" id="6809087">big</span><span class="op" id="6809090">.</span><span class="ident" id="6809091">Int</span><span class="op" id="6809094">)</span><span class="op" id="6809095">.</span><span class="ident" id="6809096">SetString</span><span class="op" id="6809105">(</span><span class="ident" id="6809106">hex</span><span class="op" id="6809109">,</span>&nbsp;<span class="num" id="6809111">16</span><span class="op" id="6809113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809116">if</span>&nbsp;<span class="op" id="6809119">!</span><span class="ident" id="6809120">ok</span>&nbsp;<span class="op" id="6809123">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6809127">panic</span><span class="op" id="6809132">(</span><span class="string" id="6809133">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="6809145">+</span>&nbsp;<span class="ident" id="6809147">hex</span><span class="op" id="6809150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809156">return</span>&nbsp;<span class="ident" id="6809163">n</span><br>
<span class="lineno"></span><span class="op" id="6809165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="6809168">func</span>&nbsp;<span class="ident" id="6809173">intFromHex</span><span class="op" id="6809183">(</span><span class="ident" id="6809184">hex</span>&nbsp;<span class="builtintype" id="6809188">string</span><span class="op" id="6809194">)</span>&nbsp;<span class="builtintype" id="6809196">int</span>&nbsp;<span class="op" id="6809200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809203">i</span><span class="op" id="6809204">,</span>&nbsp;<span class="ident" id="6809206">err</span>&nbsp;<span class="op" id="6809210">:=</span>&nbsp;<span class="ident" id="6809213">strconv</span><span class="op" id="6809220">.</span><span class="ident" id="6809221">ParseInt</span><span class="op" id="6809229">(</span><span class="ident" id="6809230">hex</span><span class="op" id="6809233">,</span>&nbsp;<span class="num" id="6809235">16</span><span class="op" id="6809237">,</span>&nbsp;<span class="num" id="6809239">32</span><span class="op" id="6809241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809244">if</span>&nbsp;<span class="ident" id="6809247">err</span>&nbsp;<span class="op" id="6809251">!=</span>&nbsp;<span class="builtintype" id="6809254">nil</span>&nbsp;<span class="op" id="6809258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6809262">panic</span><span class="op" id="6809267">(</span><span class="ident" id="6809268">err</span><span class="op" id="6809271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809274">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809277">return</span>&nbsp;<span class="builtintype" id="6809284">int</span><span class="op" id="6809287">(</span><span class="ident" id="6809288">i</span><span class="op" id="6809289">)</span><br>
<span class="lineno"></span><span class="op" id="6809291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6809294">func</span>&nbsp;<span class="ident" id="6809299">fromHex</span><span class="op" id="6809306">(</span><span class="ident" id="6809307">hexStr</span>&nbsp;<span class="builtintype" id="6809314">string</span><span class="op" id="6809320">)</span>&nbsp;<span class="op" id="6809322">[</span><span class="op" id="6809323">]</span><span class="builtintype" id="6809324">byte</span>&nbsp;<span class="op" id="6809329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809332">s</span><span class="op" id="6809333">,</span>&nbsp;<span class="ident" id="6809335">err</span>&nbsp;<span class="op" id="6809339">:=</span>&nbsp;<span class="ident" id="6809342">hex</span><span class="op" id="6809345">.</span><span class="ident" id="6809346">DecodeString</span><span class="op" id="6809358">(</span><span class="ident" id="6809359">hexStr</span><span class="op" id="6809365">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809368">if</span>&nbsp;<span class="ident" id="6809371">err</span>&nbsp;<span class="op" id="6809375">!=</span>&nbsp;<span class="builtintype" id="6809378">nil</span>&nbsp;<span class="op" id="6809382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6809386">panic</span><span class="op" id="6809391">(</span><span class="ident" id="6809392">err</span><span class="op" id="6809395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809401">return</span>&nbsp;<span class="ident" id="6809408">s</span><br>
<span class="lineno"></span><span class="op" id="6809410">}</span>
</div>
</body>
</html>
