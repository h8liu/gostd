<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html" class="current">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4352695">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4352751">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4352805">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4352856">package</span>&nbsp;<span class="ident" id="4352864">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4352875">import</span>&nbsp;<span class="op" id="4352882">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4352885">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4352894">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4352901">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4352906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4352909">//&nbsp;A&nbsp;Writer&nbsp;implements&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;writing</span><br>
<span class="lineno"></span><span class="comment" id="4352964">//&nbsp;requests&nbsp;or&nbsp;responses&nbsp;to&nbsp;a&nbsp;text&nbsp;protocol&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">15</span><span class="keyword" id="4353028">type</span>&nbsp;<span class="ident" id="4353033">Writer</span>&nbsp;<span class="keyword" id="4353040">struct</span>&nbsp;<span class="op" id="4353047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353050">W</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4353054">*</span><span class="ident" id="4353055"><a href="/gostd/net/textproto/writer.go.html#4352885">bufio</a></span><span class="op" id="4353060">.</span><span class="ident" id="4353061"><a href="/gostd/bufio/bufio.go.html#1366565">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353069">dot</span>&nbsp;<span class="op" id="4353073">*</span><span class="ident" id="4353074"><a href="/gostd/net/textproto/writer.go.html#4354104">dotWriter</a></span><br>
<span class="lineno"></span><span class="op" id="4353084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4353087">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4353135">func</span>&nbsp;<span class="ident" id="4353140">NewWriter</span><span class="op" id="4353149">(</span><span class="ident" id="4353150">w</span>&nbsp;<span class="op" id="4353152">*</span><span class="ident" id="4353153"><a href="/gostd/net/textproto/writer.go.html#4352885">bufio</a></span><span class="op" id="4353158">.</span><span class="ident" id="4353159"><a href="/gostd/bufio/bufio.go.html#1366565">Writer</a></span><span class="op" id="4353165">)</span>&nbsp;<span class="op" id="4353167">*</span><span class="ident" id="4353168"><a href="/gostd/net/textproto/writer.go.html#4353033">Writer</a></span>&nbsp;<span class="op" id="4353175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4353178">return</span>&nbsp;<span class="op" id="4353185">&amp;</span><span class="ident" id="4353186"><a href="/gostd/net/textproto/writer.go.html#4353033">Writer</a></span><span class="op" id="4353192">{</span><span class="ident" id="4353193"><a href="/gostd/net/textproto/writer.go.html#4353050">W</a></span><span class="op" id="4353194">:</span>&nbsp;<span class="ident" id="4353196"><a href="/gostd/net/textproto/writer.go.html#4353150">w</a></span><span class="op" id="4353197">}</span><br>
<span class="lineno"></span><span class="op" id="4353199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4353202">var</span>&nbsp;<span class="ident" id="4353206">crnl</span>&nbsp;<span class="op" id="4353211">=</span>&nbsp;<span class="op" id="4353213">[</span><span class="op" id="4353214">]</span><span class="builtintype" id="4353215">byte</span><span class="op" id="4353219">{</span><span class="string" id="4353220">&#39;\r&#39;</span><span class="op" id="4353224">,</span>&nbsp;<span class="string" id="4353226">&#39;\n&#39;</span><span class="op" id="4353230">}</span><br>
<span class="lineno"></span><span class="keyword" id="4353232">var</span>&nbsp;<span class="ident" id="4353236">dotcrnl</span>&nbsp;<span class="op" id="4353244">=</span>&nbsp;<span class="op" id="4353246">[</span><span class="op" id="4353247">]</span><span class="builtintype" id="4353248">byte</span><span class="op" id="4353252">{</span><span class="string" id="4353253">&#39;.&#39;</span><span class="op" id="4353256">,</span>&nbsp;<span class="string" id="4353258">&#39;\r&#39;</span><span class="op" id="4353262">,</span>&nbsp;<span class="string" id="4353264">&#39;\n&#39;</span><span class="op" id="4353268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4353271">//&nbsp;PrintfLine&nbsp;writes&nbsp;the&nbsp;formatted&nbsp;output&nbsp;followed&nbsp;by&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="keyword" id="4353331">func</span>&nbsp;<span class="op" id="4353336">(</span><span class="ident" id="4353337">w</span>&nbsp;<span class="op" id="4353339">*</span><span class="ident" id="4353340"><a href="/gostd/net/textproto/writer.go.html#4353033">Writer</a></span><span class="op" id="4353346">)</span>&nbsp;<span class="ident" id="4353348">PrintfLine</span><span class="op" id="4353358">(</span><span class="ident" id="4353359">format</span>&nbsp;<span class="builtintype" id="4353366">string</span><span class="op" id="4353372">,</span>&nbsp;<span class="ident" id="4353374">args</span>&nbsp;<span class="op" id="4353379">...</span><span class="keyword" id="4353382">interface</span><span class="op" id="4353391">{</span><span class="op" id="4353392">}</span><span class="op" id="4353393">)</span>&nbsp;<span class="builtintype" id="4353395">error</span>&nbsp;<span class="op" id="4353401">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353404"><a href="/gostd/net/textproto/writer.go.html#4353337">w</a></span><span class="op" id="4353405">.</span><span class="ident" id="4353406"><a href="/gostd/net/textproto/writer.go.html#4354025">closeDot</a></span><span class="op" id="4353414">(</span><span class="op" id="4353415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353418"><a href="/gostd/net/textproto/writer.go.html#4352894">fmt</a></span><span class="op" id="4353421">.</span><span class="ident" id="4353422"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4353429">(</span><span class="ident" id="4353430"><a href="/gostd/net/textproto/writer.go.html#4353337">w</a></span><span class="op" id="4353431">.</span><span class="ident" id="4353432"><a href="/gostd/net/textproto/writer.go.html#4353050">W</a></span><span class="op" id="4353433">,</span>&nbsp;<span class="ident" id="4353435"><a href="/gostd/net/textproto/writer.go.html#4353359">format</a></span><span class="op" id="4353441">,</span>&nbsp;<span class="ident" id="4353443"><a href="/gostd/net/textproto/writer.go.html#4353374">args</a></span><span class="op" id="4353447">...</span><span class="op" id="4353450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353453"><a href="/gostd/net/textproto/writer.go.html#4353337">w</a></span><span class="op" id="4353454">.</span><span class="ident" id="4353455"><a href="/gostd/net/textproto/writer.go.html#4353050">W</a></span><span class="op" id="4353456">.</span><span class="ident" id="4353457"><a href="/gostd/bufio/bufio.go.html#1368329">Write</a></span><span class="op" id="4353462">(</span><span class="ident" id="4353463"><a href="/gostd/net/textproto/writer.go.html#4353206">crnl</a></span><span class="op" id="4353467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4353470">return</span>&nbsp;<span class="ident" id="4353477"><a href="/gostd/net/textproto/writer.go.html#4353337">w</a></span><span class="op" id="4353478">.</span><span class="ident" id="4353479"><a href="/gostd/net/textproto/writer.go.html#4353050">W</a></span><span class="op" id="4353480">.</span><span class="ident" id="4353481"><a href="/gostd/bufio/bufio.go.html#1367486">Flush</a></span><span class="op" id="4353486">(</span><span class="op" id="4353487">)</span><br>
<span class="lineno"></span><span class="op" id="4353489">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4353492">//&nbsp;DotWriter&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;a&nbsp;dot-encoding&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4353569">//&nbsp;It&nbsp;takes&nbsp;care&nbsp;of&nbsp;inserting&nbsp;leading&nbsp;dots&nbsp;when&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4353628">//&nbsp;translating&nbsp;line-ending&nbsp;\n&nbsp;into&nbsp;\r\n,&nbsp;and&nbsp;adding&nbsp;the&nbsp;final&nbsp;.\r\n&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4353701">//&nbsp;when&nbsp;the&nbsp;DotWriter&nbsp;is&nbsp;closed.&nbsp;&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="4353763">//&nbsp;DotWriter&nbsp;before&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;a&nbsp;method&nbsp;on&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4353815">//</span><br>
<span class="lineno"></span><span class="comment" id="4353818">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Reader&#39;s&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="4353905">func</span>&nbsp;<span class="op" id="4353910">(</span><span class="ident" id="4353911">w</span>&nbsp;<span class="op" id="4353913">*</span><span class="ident" id="4353914"><a href="/gostd/net/textproto/writer.go.html#4353033">Writer</a></span><span class="op" id="4353920">)</span>&nbsp;<span class="ident" id="4353922">DotWriter</span><span class="op" id="4353931">(</span><span class="op" id="4353932">)</span>&nbsp;<span class="ident" id="4353934"><a href="/gostd/net/textproto/writer.go.html#4352901">io</a></span><span class="op" id="4353936">.</span><span class="ident" id="4353937"><a href="/gostd/io/io.go.html#1423540">WriteCloser</a></span>&nbsp;<span class="op" id="4353949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353952"><a href="/gostd/net/textproto/writer.go.html#4353911">w</a></span><span class="op" id="4353953">.</span><span class="ident" id="4353954"><a href="/gostd/net/textproto/writer.go.html#4354025">closeDot</a></span><span class="op" id="4353962">(</span><span class="op" id="4353963">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4353966"><a href="/gostd/net/textproto/writer.go.html#4353911">w</a></span><span class="op" id="4353967">.</span><span class="ident" id="4353968"><a href="/gostd/net/textproto/writer.go.html#4353069">dot</a></span>&nbsp;<span class="op" id="4353972">=</span>&nbsp;<span class="op" id="4353974">&amp;</span><span class="ident" id="4353975"><a href="/gostd/net/textproto/writer.go.html#4354104">dotWriter</a></span><span class="op" id="4353984">{</span><span class="ident" id="4353985"><a href="/gostd/net/textproto/writer.go.html#4354124">w</a></span><span class="op" id="4353986">:</span>&nbsp;<span class="ident" id="4353988"><a href="/gostd/net/textproto/writer.go.html#4353911">w</a></span><span class="op" id="4353989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4353992">return</span>&nbsp;<span class="ident" id="4353999"><a href="/gostd/net/textproto/writer.go.html#4353911">w</a></span><span class="op" id="4354000">.</span><span class="ident" id="4354001"><a href="/gostd/net/textproto/writer.go.html#4353069">dot</a></span><br>
<span class="lineno"></span><span class="op" id="4354005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4354008">func</span>&nbsp;<span class="op" id="4354013">(</span><span class="ident" id="4354014">w</span>&nbsp;<span class="op" id="4354016">*</span><span class="ident" id="4354017"><a href="/gostd/net/textproto/writer.go.html#4353033">Writer</a></span><span class="op" id="4354023">)</span>&nbsp;<span class="ident" id="4354025">closeDot</span><span class="op" id="4354033">(</span><span class="op" id="4354034">)</span>&nbsp;<span class="op" id="4354036">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354039">if</span>&nbsp;<span class="ident" id="4354042"><a href="/gostd/net/textproto/writer.go.html#4354014">w</a></span><span class="op" id="4354043">.</span><span class="ident" id="4354044"><a href="/gostd/net/textproto/writer.go.html#4353069">dot</a></span>&nbsp;<span class="op" id="4354048">!=</span>&nbsp;<span class="builtintype" id="4354051">nil</span>&nbsp;<span class="op" id="4354055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354059"><a href="/gostd/net/textproto/writer.go.html#4354014">w</a></span><span class="op" id="4354060">.</span><span class="ident" id="4354061"><a href="/gostd/net/textproto/writer.go.html#4353069">dot</a></span><span class="op" id="4354064">.</span><span class="ident" id="4354065"><a href="/gostd/net/textproto/writer.go.html#4354944">Close</a></span><span class="op" id="4354070">(</span><span class="op" id="4354071">)</span>&nbsp;<span class="comment" id="4354073">//&nbsp;sets&nbsp;w.dot&nbsp;=&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354094">}</span><br>
<span class="lineno"></span><span class="op" id="4354096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4354099">type</span>&nbsp;<span class="ident" id="4354104">dotWriter</span>&nbsp;<span class="keyword" id="4354114">struct</span>&nbsp;<span class="op" id="4354121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354124">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354130">*</span><span class="ident" id="4354131"><a href="/gostd/net/textproto/writer.go.html#4353033">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354139">state</span>&nbsp;<span class="builtintype" id="4354145">int</span><br>
<span class="lineno"></span><span class="op" id="4354149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="4354152">const</span>&nbsp;<span class="op" id="4354158">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354161">wstateBeginLine</span>&nbsp;<span class="op" id="4354177">=</span>&nbsp;<span class="ident" id="4354179">iota</span>&nbsp;<span class="comment" id="4354184">//&nbsp;beginning&nbsp;of&nbsp;line;&nbsp;initial&nbsp;state;&nbsp;must&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354235">wstateCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4354258">//&nbsp;wrote&nbsp;\r&nbsp;(possibly&nbsp;at&nbsp;end&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354297">wstateData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4354320">//&nbsp;writing&nbsp;data&nbsp;in&nbsp;middle&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span><span class="op" id="4354354">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4354357">func</span>&nbsp;<span class="op" id="4354362">(</span><span class="ident" id="4354363">d</span>&nbsp;<span class="op" id="4354365">*</span><span class="ident" id="4354366"><a href="/gostd/net/textproto/writer.go.html#4354104">dotWriter</a></span><span class="op" id="4354375">)</span>&nbsp;<span class="ident" id="4354377">Write</span><span class="op" id="4354382">(</span><span class="ident" id="4354383">b</span>&nbsp;<span class="op" id="4354385">[</span><span class="op" id="4354386">]</span><span class="builtintype" id="4354387">byte</span><span class="op" id="4354391">)</span>&nbsp;<span class="op" id="4354393">(</span><span class="ident" id="4354394">n</span>&nbsp;<span class="builtintype" id="4354396">int</span><span class="op" id="4354399">,</span>&nbsp;<span class="ident" id="4354401">err</span>&nbsp;<span class="builtintype" id="4354405">error</span><span class="op" id="4354410">)</span>&nbsp;<span class="op" id="4354412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354415">bw</span>&nbsp;<span class="op" id="4354418">:=</span>&nbsp;<span class="ident" id="4354421"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354422">.</span><span class="ident" id="4354423"><a href="/gostd/net/textproto/writer.go.html#4354124">w</a></span><span class="op" id="4354424">.</span><span class="ident" id="4354425"><a href="/gostd/net/textproto/writer.go.html#4353050">W</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354428">for</span>&nbsp;<span class="ident" id="4354432"><a href="/gostd/net/textproto/writer.go.html#4354394">n</a></span>&nbsp;<span class="op" id="4354434">&lt;</span>&nbsp;<span class="builtinfunc" id="4354436">len</span><span class="op" id="4354439">(</span><span class="ident" id="4354440"><a href="/gostd/net/textproto/writer.go.html#4354383">b</a></span><span class="op" id="4354441">)</span>&nbsp;<span class="op" id="4354443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354447">c</span>&nbsp;<span class="op" id="4354449">:=</span>&nbsp;<span class="ident" id="4354452"><a href="/gostd/net/textproto/writer.go.html#4354383">b</a></span><span class="op" id="4354453">[</span><span class="ident" id="4354454"><a href="/gostd/net/textproto/writer.go.html#4354394">n</a></span><span class="op" id="4354455">]</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354459">switch</span>&nbsp;<span class="ident" id="4354466"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354467">.</span><span class="ident" id="4354468"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4354474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354478">case</span>&nbsp;<span class="ident" id="4354483"><a href="/gostd/net/textproto/writer.go.html#4354161">wstateBeginLine</a></span><span class="op" id="4354498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354503"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354504">.</span><span class="ident" id="4354505"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4354511">=</span>&nbsp;<span class="ident" id="4354513"><a href="/gostd/net/textproto/writer.go.html#4354297">wstateData</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354527">if</span>&nbsp;<span class="ident" id="4354530"><a href="/gostd/net/textproto/writer.go.html#4354447">c</a></span>&nbsp;<span class="op" id="4354532">==</span>&nbsp;<span class="string" id="4354535">&#39;.&#39;</span>&nbsp;<span class="op" id="4354539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4354545">//&nbsp;escape&nbsp;leading&nbsp;dot</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354571"><a href="/gostd/net/textproto/writer.go.html#4354415">bw</a></span><span class="op" id="4354573">.</span><span class="ident" id="4354574"><a href="/gostd/bufio/bufio.go.html#1368805">WriteByte</a></span><span class="op" id="4354583">(</span><span class="string" id="4354584">&#39;.&#39;</span><span class="op" id="4354587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354597">fallthrough</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354612">case</span>&nbsp;<span class="ident" id="4354617"><a href="/gostd/net/textproto/writer.go.html#4354297">wstateData</a></span><span class="op" id="4354627">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354632">if</span>&nbsp;<span class="ident" id="4354635"><a href="/gostd/net/textproto/writer.go.html#4354447">c</a></span>&nbsp;<span class="op" id="4354637">==</span>&nbsp;<span class="string" id="4354640">&#39;\r&#39;</span>&nbsp;<span class="op" id="4354645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354651"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354652">.</span><span class="ident" id="4354653"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4354659">=</span>&nbsp;<span class="ident" id="4354661"><a href="/gostd/net/textproto/writer.go.html#4354235">wstateCR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354678">if</span>&nbsp;<span class="ident" id="4354681"><a href="/gostd/net/textproto/writer.go.html#4354447">c</a></span>&nbsp;<span class="op" id="4354683">==</span>&nbsp;<span class="string" id="4354686">&#39;\n&#39;</span>&nbsp;<span class="op" id="4354691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354697"><a href="/gostd/net/textproto/writer.go.html#4354415">bw</a></span><span class="op" id="4354699">.</span><span class="ident" id="4354700"><a href="/gostd/bufio/bufio.go.html#1368805">WriteByte</a></span><span class="op" id="4354709">(</span><span class="string" id="4354710">&#39;\r&#39;</span><span class="op" id="4354714">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354720"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354721">.</span><span class="ident" id="4354722"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4354728">=</span>&nbsp;<span class="ident" id="4354730"><a href="/gostd/net/textproto/writer.go.html#4354161">wstateBeginLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354754">case</span>&nbsp;<span class="ident" id="4354759"><a href="/gostd/net/textproto/writer.go.html#4354235">wstateCR</a></span><span class="op" id="4354767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354772"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354773">.</span><span class="ident" id="4354774"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4354780">=</span>&nbsp;<span class="ident" id="4354782"><a href="/gostd/net/textproto/writer.go.html#4354297">wstateData</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354796">if</span>&nbsp;<span class="ident" id="4354799"><a href="/gostd/net/textproto/writer.go.html#4354447">c</a></span>&nbsp;<span class="op" id="4354801">==</span>&nbsp;<span class="string" id="4354804">&#39;\n&#39;</span>&nbsp;<span class="op" id="4354809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354815"><a href="/gostd/net/textproto/writer.go.html#4354363">d</a></span><span class="op" id="4354816">.</span><span class="ident" id="4354817"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4354823">=</span>&nbsp;<span class="ident" id="4354825"><a href="/gostd/net/textproto/writer.go.html#4354161">wstateBeginLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354852">if</span>&nbsp;<span class="ident" id="4354855"><a href="/gostd/net/textproto/writer.go.html#4354401">err</a></span>&nbsp;<span class="op" id="4354859">=</span>&nbsp;<span class="ident" id="4354861"><a href="/gostd/net/textproto/writer.go.html#4354415">bw</a></span><span class="op" id="4354863">.</span><span class="ident" id="4354864"><a href="/gostd/bufio/bufio.go.html#1368805">WriteByte</a></span><span class="op" id="4354873">(</span><span class="ident" id="4354874"><a href="/gostd/net/textproto/writer.go.html#4354447">c</a></span><span class="op" id="4354875">)</span><span class="op" id="4354876">;</span>&nbsp;<span class="ident" id="4354878"><a href="/gostd/net/textproto/writer.go.html#4354401">err</a></span>&nbsp;<span class="op" id="4354882">!=</span>&nbsp;<span class="builtintype" id="4354885">nil</span>&nbsp;<span class="op" id="4354889">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354894">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354906"><a href="/gostd/net/textproto/writer.go.html#4354394">n</a></span><span class="op" id="4354907">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354914">return</span><br>
<span class="lineno">100</span><span class="op" id="4354921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4354924">func</span>&nbsp;<span class="op" id="4354929">(</span><span class="ident" id="4354930">d</span>&nbsp;<span class="op" id="4354932">*</span><span class="ident" id="4354933"><a href="/gostd/net/textproto/writer.go.html#4354104">dotWriter</a></span><span class="op" id="4354942">)</span>&nbsp;<span class="ident" id="4354944">Close</span><span class="op" id="4354949">(</span><span class="op" id="4354950">)</span>&nbsp;<span class="builtintype" id="4354952">error</span>&nbsp;<span class="op" id="4354958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4354961">if</span>&nbsp;<span class="ident" id="4354964"><a href="/gostd/net/textproto/writer.go.html#4354930">d</a></span><span class="op" id="4354965">.</span><span class="ident" id="4354966"><a href="/gostd/net/textproto/writer.go.html#4354124">w</a></span><span class="op" id="4354967">.</span><span class="ident" id="4354968"><a href="/gostd/net/textproto/writer.go.html#4353069">dot</a></span>&nbsp;<span class="op" id="4354972">==</span>&nbsp;<span class="ident" id="4354975"><a href="/gostd/net/textproto/writer.go.html#4354930">d</a></span>&nbsp;<span class="op" id="4354977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354981"><a href="/gostd/net/textproto/writer.go.html#4354930">d</a></span><span class="op" id="4354982">.</span><span class="ident" id="4354983"><a href="/gostd/net/textproto/writer.go.html#4354124">w</a></span><span class="op" id="4354984">.</span><span class="ident" id="4354985"><a href="/gostd/net/textproto/writer.go.html#4353069">dot</a></span>&nbsp;<span class="op" id="4354989">=</span>&nbsp;<span class="builtintype" id="4354991">nil</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4354996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4354999">bw</span>&nbsp;<span class="op" id="4355002">:=</span>&nbsp;<span class="ident" id="4355005"><a href="/gostd/net/textproto/writer.go.html#4354930">d</a></span><span class="op" id="4355006">.</span><span class="ident" id="4355007"><a href="/gostd/net/textproto/writer.go.html#4354124">w</a></span><span class="op" id="4355008">.</span><span class="ident" id="4355009"><a href="/gostd/net/textproto/writer.go.html#4353050">W</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355012">switch</span>&nbsp;<span class="ident" id="4355019"><a href="/gostd/net/textproto/writer.go.html#4354930">d</a></span><span class="op" id="4355020">.</span><span class="ident" id="4355021"><a href="/gostd/net/textproto/writer.go.html#4354139">state</a></span>&nbsp;<span class="op" id="4355027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355030">default</span><span class="op" id="4355037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4355041"><a href="/gostd/net/textproto/writer.go.html#4354999">bw</a></span><span class="op" id="4355043">.</span><span class="ident" id="4355044"><a href="/gostd/bufio/bufio.go.html#1368805">WriteByte</a></span><span class="op" id="4355053">(</span><span class="string" id="4355054">&#39;\r&#39;</span><span class="op" id="4355058">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355062">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355075">case</span>&nbsp;<span class="ident" id="4355080"><a href="/gostd/net/textproto/writer.go.html#4354235">wstateCR</a></span><span class="op" id="4355088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4355092"><a href="/gostd/net/textproto/writer.go.html#4354999">bw</a></span><span class="op" id="4355094">.</span><span class="ident" id="4355095"><a href="/gostd/bufio/bufio.go.html#1368805">WriteByte</a></span><span class="op" id="4355104">(</span><span class="string" id="4355105">&#39;\n&#39;</span><span class="op" id="4355109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355113">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355126">case</span>&nbsp;<span class="ident" id="4355131"><a href="/gostd/net/textproto/writer.go.html#4354161">wstateBeginLine</a></span><span class="op" id="4355146">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4355150"><a href="/gostd/net/textproto/writer.go.html#4354999">bw</a></span><span class="op" id="4355152">.</span><span class="ident" id="4355153"><a href="/gostd/bufio/bufio.go.html#1368329">Write</a></span><span class="op" id="4355158">(</span><span class="ident" id="4355159"><a href="/gostd/net/textproto/writer.go.html#4353236">dotcrnl</a></span><span class="op" id="4355166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4355169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4355172">return</span>&nbsp;<span class="ident" id="4355179"><a href="/gostd/net/textproto/writer.go.html#4354999">bw</a></span><span class="op" id="4355181">.</span><span class="ident" id="4355182"><a href="/gostd/bufio/bufio.go.html#1367486">Flush</a></span><span class="op" id="4355187">(</span><span class="op" id="4355188">)</span><br>
<span class="lineno"></span><span class="op" id="4355190">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
