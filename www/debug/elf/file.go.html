<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5607612">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5607668">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5607722">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5607773">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5607827">package</span>&nbsp;<span class="ident" id="5607835">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5607840">import</span>&nbsp;<span class="op" id="5607847">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607850">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607859">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607874">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607893">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607903">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607910">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5607916">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5607921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5607924">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5607957">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5607996">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5608043">type</span>&nbsp;<span class="ident" id="5608048">FileHeader</span>&nbsp;<span class="keyword" id="5608059">struct</span>&nbsp;<span class="op" id="5608066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608069">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608080"><a href="/debug/elf/elf.go.html#5546432">Class</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608087">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608098"><a href="/debug/elf/elf.go.html#5546935">Data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608104">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608115"><a href="/debug/elf/elf.go.html#5546038">Version</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608124">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608135"><a href="/debug/elf/elf.go.html#5547451">OSABI</a></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608142">ABIVersion</span>&nbsp;<span class="builtintype" id="5608153">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608160">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5608171"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5608177">.</span><span class="ident" id="5608178">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608189">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608200"><a href="/debug/elf/elf.go.html#5549020">Type</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608206">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608217"><a href="/debug/elf/elf.go.html#5549925">Machine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608226">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608237">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5608244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5608247">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5608286">type</span>&nbsp;<span class="ident" id="5608291">File</span>&nbsp;<span class="keyword" id="5608296">struct</span>&nbsp;<span class="op" id="5608303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608306"><a href="/debug/elf/file.go.html#5608048">FileHeader</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608318">Sections</span>&nbsp;&nbsp;<span class="op" id="5608328">[</span><span class="op" id="5608329">]</span><span class="op" id="5608330">*</span><span class="ident" id="5608331"><a href="/debug/elf/file.go.html#5608763">Section</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608340">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5608350">[</span><span class="op" id="5608351">]</span><span class="op" id="5608352">*</span><span class="ident" id="5608353"><a href="/debug/elf/file.go.html#5610024">Prog</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608359">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608369"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5608371">.</span><span class="ident" id="5608372">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608380">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5608390">[</span><span class="op" id="5608391">]</span><span class="ident" id="5608392"><a href="/debug/elf/file.go.html#5627591">verneed</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608401">gnuVersym</span>&nbsp;<span class="op" id="5608411">[</span><span class="op" id="5608412">]</span><span class="builtintype" id="5608413">byte</span><br>
<span class="lineno">45</span><span class="op" id="5608418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5608421">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5608480">type</span>&nbsp;<span class="ident" id="5608485">SectionHeader</span>&nbsp;<span class="keyword" id="5608499">struct</span>&nbsp;<span class="op" id="5608506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608509">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5608519">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608527">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608537"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608550">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608560"><a href="/debug/elf/elf.go.html#5558088">SectionFlag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608573">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608583">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608591">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608601">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608609">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5608619">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608627">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5608637">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608645">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5608655">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608663">Addralign</span>&nbsp;<span class="ident" id="5608673">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608681">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5608691">uint64</span><br>
<span class="lineno"></span><span class="op" id="5608698">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5608701">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5608758">type</span>&nbsp;<span class="ident" id="5608763">Section</span>&nbsp;<span class="keyword" id="5608771">struct</span>&nbsp;<span class="op" id="5608778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5608781"><a href="/debug/elf/file.go.html#5608485">SectionHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5608797">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5608835">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5608875">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5608910">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5608958">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5609008">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609032"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5609034">.</span><span class="ident" id="5609035">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609045">sr</span>&nbsp;<span class="op" id="5609048">*</span><span class="ident" id="5609049"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5609051">.</span><span class="ident" id="5609052">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5609066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5609069">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5609128">func</span>&nbsp;<span class="op" id="5609133">(</span><span class="ident" id="5609134">s</span>&nbsp;<span class="op" id="5609136">*</span><span class="ident" id="5609137"><a href="/debug/elf/file.go.html#5608763">Section</a></span><span class="op" id="5609144">)</span>&nbsp;<span class="ident" id="5609146">Data</span><span class="op" id="5609150">(</span><span class="op" id="5609151">)</span>&nbsp;<span class="op" id="5609153">(</span><span class="op" id="5609154">[</span><span class="op" id="5609155">]</span><span class="builtintype" id="5609156">byte</span><span class="op" id="5609160">,</span>&nbsp;<span class="builtintype" id="5609162">error</span><span class="op" id="5609167">)</span>&nbsp;<span class="op" id="5609169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609172">dat</span>&nbsp;<span class="op" id="5609176">:=</span>&nbsp;<span class="builtinfunc" id="5609179">make</span><span class="op" id="5609183">(</span><span class="op" id="5609184">[</span><span class="op" id="5609185">]</span><span class="builtintype" id="5609186">byte</span><span class="op" id="5609190">,</span>&nbsp;<span class="ident" id="5609192"><a href="/debug/elf/file.go.html#5609134">s</a></span><span class="op" id="5609193">.</span><span class="ident" id="5609194">sr</span><span class="op" id="5609196">.</span><span class="ident" id="5609197">Size</span><span class="op" id="5609201">(</span><span class="op" id="5609202">)</span><span class="op" id="5609203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609206">n</span><span class="op" id="5609207">,</span>&nbsp;<span class="ident" id="5609209">err</span>&nbsp;<span class="op" id="5609213">:=</span>&nbsp;<span class="ident" id="5609216"><a href="/debug/elf/file.go.html#5609134">s</a></span><span class="op" id="5609217">.</span><span class="ident" id="5609218">sr</span><span class="op" id="5609220">.</span><span class="ident" id="5609221">ReadAt</span><span class="op" id="5609227">(</span><span class="ident" id="5609228"><a href="/debug/elf/file.go.html#5609172">dat</a></span><span class="op" id="5609231">,</span>&nbsp;<span class="num" id="5609233">0</span><span class="op" id="5609234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609237">if</span>&nbsp;<span class="ident" id="5609240"><a href="/debug/elf/file.go.html#5609206">n</a></span>&nbsp;<span class="op" id="5609242">==</span>&nbsp;<span class="builtinfunc" id="5609245">len</span><span class="op" id="5609248">(</span><span class="ident" id="5609249"><a href="/debug/elf/file.go.html#5609172">dat</a></span><span class="op" id="5609252">)</span>&nbsp;<span class="op" id="5609254">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609258"><a href="/debug/elf/file.go.html#5609209">err</a></span>&nbsp;<span class="op" id="5609262">=</span>&nbsp;<span class="ident" id="5609264">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5609269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609272">return</span>&nbsp;<span class="ident" id="5609279"><a href="/debug/elf/file.go.html#5609172">dat</a></span><span class="op" id="5609282">[</span><span class="num" id="5609283">0</span><span class="op" id="5609284">:</span><span class="ident" id="5609285"><a href="/debug/elf/file.go.html#5609206">n</a></span><span class="op" id="5609286">]</span><span class="op" id="5609287">,</span>&nbsp;<span class="ident" id="5609289"><a href="/debug/elf/file.go.html#5609209">err</a></span><br>
<span class="lineno"></span><span class="op" id="5609293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5609296">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5609359">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5609384">func</span>&nbsp;<span class="op" id="5609389">(</span><span class="ident" id="5609390">f</span>&nbsp;<span class="op" id="5609392">*</span><span class="ident" id="5609393"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5609397">)</span>&nbsp;<span class="ident" id="5609399">stringTable</span><span class="op" id="5609410">(</span><span class="ident" id="5609411">link</span>&nbsp;<span class="builtintype" id="5609416">uint32</span><span class="op" id="5609422">)</span>&nbsp;<span class="op" id="5609424">(</span><span class="op" id="5609425">[</span><span class="op" id="5609426">]</span><span class="builtintype" id="5609427">byte</span><span class="op" id="5609431">,</span>&nbsp;<span class="builtintype" id="5609433">error</span><span class="op" id="5609438">)</span>&nbsp;<span class="op" id="5609440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609443">if</span>&nbsp;<span class="ident" id="5609446"><a href="/debug/elf/file.go.html#5609411">link</a></span>&nbsp;<span class="op" id="5609451">&lt;=</span>&nbsp;<span class="num" id="5609454">0</span>&nbsp;<span class="op" id="5609456">||</span>&nbsp;<span class="ident" id="5609459"><a href="/debug/elf/file.go.html#5609411">link</a></span>&nbsp;<span class="op" id="5609464">&gt;=</span>&nbsp;<span class="builtintype" id="5609467">uint32</span><span class="op" id="5609473">(</span><span class="builtinfunc" id="5609474">len</span><span class="op" id="5609477">(</span><span class="ident" id="5609478"><a href="/debug/elf/file.go.html#5609390">f</a></span><span class="op" id="5609479">.</span><span class="ident" id="5609480">Sections</span><span class="op" id="5609488">)</span><span class="op" id="5609489">)</span>&nbsp;<span class="op" id="5609491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609495">return</span>&nbsp;<span class="ident" id="5609502">nil</span><span class="op" id="5609505">,</span>&nbsp;<span class="ident" id="5609507"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5609513">.</span><span class="ident" id="5609514">New</span><span class="op" id="5609517">(</span><span class="string" id="5609518">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5609557">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5609560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5609563">return</span>&nbsp;<span class="ident" id="5609570"><a href="/debug/elf/file.go.html#5609390">f</a></span><span class="op" id="5609571">.</span><span class="ident" id="5609572">Sections</span><span class="op" id="5609580">[</span><span class="ident" id="5609581"><a href="/debug/elf/file.go.html#5609411">link</a></span><span class="op" id="5609585">]</span><span class="op" id="5609586">.</span><span class="ident" id="5609587">Data</span><span class="op" id="5609591">(</span><span class="op" id="5609592">)</span><br>
<span class="lineno"></span><span class="op" id="5609594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5609597">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5609655">func</span>&nbsp;<span class="op" id="5609660">(</span><span class="ident" id="5609661">s</span>&nbsp;<span class="op" id="5609663">*</span><span class="ident" id="5609664"><a href="/debug/elf/file.go.html#5608763">Section</a></span><span class="op" id="5609671">)</span>&nbsp;<span class="ident" id="5609673">Open</span><span class="op" id="5609677">(</span><span class="op" id="5609678">)</span>&nbsp;<span class="ident" id="5609680"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5609682">.</span><span class="ident" id="5609683">ReadSeeker</span>&nbsp;<span class="op" id="5609694">{</span>&nbsp;<span class="keyword" id="5609696">return</span>&nbsp;<span class="ident" id="5609703"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5609705">.</span><span class="ident" id="5609706">NewSectionReader</span><span class="op" id="5609722">(</span><span class="ident" id="5609723"><a href="/debug/elf/file.go.html#5609661">s</a></span><span class="op" id="5609724">.</span><span class="ident" id="5609725">sr</span><span class="op" id="5609727">,</span>&nbsp;<span class="num" id="5609729">0</span><span class="op" id="5609730">,</span>&nbsp;<span class="num" id="5609732">1</span><span class="op" id="5609733">&lt;&lt;</span><span class="num" id="5609735">63</span><span class="op" id="5609737">-</span><span class="num" id="5609738">1</span><span class="op" id="5609739">)</span>&nbsp;<span class="op" id="5609741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5609744">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5609800">type</span>&nbsp;<span class="ident" id="5609805">ProgHeader</span>&nbsp;<span class="keyword" id="5609816">struct</span>&nbsp;<span class="op" id="5609823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609826">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5609833"><a href="/debug/elf/elf.go.html#5559561">ProgType</a></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609843">Flags</span>&nbsp;&nbsp;<span class="ident" id="5609850"><a href="/debug/elf/elf.go.html#5560837">ProgFlag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609860">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5609867">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609875">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="5609882">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609890">Paddr</span>&nbsp;&nbsp;<span class="ident" id="5609897">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609905">Filesz</span>&nbsp;<span class="ident" id="5609912">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609920">Memsz</span>&nbsp;&nbsp;<span class="ident" id="5609927">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5609935">Align</span>&nbsp;&nbsp;<span class="ident" id="5609942">uint64</span><br>
<span class="lineno"></span><span class="op" id="5609949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5609952">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5610019">type</span>&nbsp;<span class="ident" id="5610024">Prog</span>&nbsp;<span class="keyword" id="5610029">struct</span>&nbsp;<span class="op" id="5610036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610039"><a href="/debug/elf/file.go.html#5609805">ProgHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610052">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610090">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610130">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610165">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610213">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5610263">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610287"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5610289">.</span><span class="ident" id="5610290">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610300">sr</span>&nbsp;<span class="op" id="5610303">*</span><span class="ident" id="5610304"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5610306">.</span><span class="ident" id="5610307">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5610321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5610324">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5610387">func</span>&nbsp;<span class="op" id="5610392">(</span><span class="ident" id="5610393">p</span>&nbsp;<span class="op" id="5610395">*</span><span class="ident" id="5610396"><a href="/debug/elf/file.go.html#5610024">Prog</a></span><span class="op" id="5610400">)</span>&nbsp;<span class="ident" id="5610402">Open</span><span class="op" id="5610406">(</span><span class="op" id="5610407">)</span>&nbsp;<span class="ident" id="5610409"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5610411">.</span><span class="ident" id="5610412">ReadSeeker</span>&nbsp;<span class="op" id="5610423">{</span>&nbsp;<span class="keyword" id="5610425">return</span>&nbsp;<span class="ident" id="5610432"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5610434">.</span><span class="ident" id="5610435">NewSectionReader</span><span class="op" id="5610451">(</span><span class="ident" id="5610452"><a href="/debug/elf/file.go.html#5610393">p</a></span><span class="op" id="5610453">.</span><span class="ident" id="5610454">sr</span><span class="op" id="5610456">,</span>&nbsp;<span class="num" id="5610458">0</span><span class="op" id="5610459">,</span>&nbsp;<span class="num" id="5610461">1</span><span class="op" id="5610462">&lt;&lt;</span><span class="num" id="5610464">63</span><span class="op" id="5610466">-</span><span class="num" id="5610467">1</span><span class="op" id="5610468">)</span>&nbsp;<span class="op" id="5610470">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5610473">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5610537">type</span>&nbsp;<span class="ident" id="5610542">Symbol</span>&nbsp;<span class="keyword" id="5610549">struct</span>&nbsp;<span class="op" id="5610556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610559">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5610571">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610579">Info</span><span class="op" id="5610583">,</span>&nbsp;<span class="ident" id="5610585">Other</span>&nbsp;<span class="builtintype" id="5610591">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610597">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5610609"><a href="/debug/elf/elf.go.html#5553812">SectionIndex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610623">Value</span><span class="op" id="5610628">,</span>&nbsp;<span class="ident" id="5610630">Size</span>&nbsp;<span class="ident" id="5610635">uint64</span><br>
<span class="lineno"></span><span class="op" id="5610642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5610645">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5610667">type</span>&nbsp;<span class="ident" id="5610672">FormatError</span>&nbsp;<span class="keyword" id="5610684">struct</span>&nbsp;<span class="op" id="5610691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610694">off</span>&nbsp;<span class="ident" id="5610698">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610705">msg</span>&nbsp;<span class="builtintype" id="5610709">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610717">val</span>&nbsp;<span class="keyword" id="5610721">interface</span><span class="op" id="5610730">{</span><span class="op" id="5610731">}</span><br>
<span class="lineno"></span><span class="op" id="5610733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5610736">func</span>&nbsp;<span class="op" id="5610741">(</span><span class="ident" id="5610742">e</span>&nbsp;<span class="op" id="5610744">*</span><span class="ident" id="5610745"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5610756">)</span>&nbsp;<span class="ident" id="5610758">Error</span><span class="op" id="5610763">(</span><span class="op" id="5610764">)</span>&nbsp;<span class="builtintype" id="5610766">string</span>&nbsp;<span class="op" id="5610773">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610776">msg</span>&nbsp;<span class="op" id="5610780">:=</span>&nbsp;<span class="ident" id="5610783"><a href="/debug/elf/file.go.html#5610742">e</a></span><span class="op" id="5610784">.</span><span class="ident" id="5610785">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610790">if</span>&nbsp;<span class="ident" id="5610793"><a href="/debug/elf/file.go.html#5610742">e</a></span><span class="op" id="5610794">.</span><span class="ident" id="5610795">val</span>&nbsp;<span class="op" id="5610799">!=</span>&nbsp;<span class="ident" id="5610802">nil</span>&nbsp;<span class="op" id="5610806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610810"><a href="/debug/elf/file.go.html#5610776">msg</a></span>&nbsp;<span class="op" id="5610814">+=</span>&nbsp;<span class="ident" id="5610817"><a href="/debug/elf/file.go.html#5607903">fmt</a></span><span class="op" id="5610820">.</span><span class="ident" id="5610821">Sprintf</span><span class="op" id="5610828">(</span><span class="string" id="5610829">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5610837">,</span>&nbsp;<span class="ident" id="5610839"><a href="/debug/elf/file.go.html#5610742">e</a></span><span class="op" id="5610840">.</span><span class="ident" id="5610841">val</span><span class="op" id="5610844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5610847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5610850"><a href="/debug/elf/file.go.html#5610776">msg</a></span>&nbsp;<span class="op" id="5610854">+=</span>&nbsp;<span class="ident" id="5610857"><a href="/debug/elf/file.go.html#5607903">fmt</a></span><span class="op" id="5610860">.</span><span class="ident" id="5610861">Sprintf</span><span class="op" id="5610868">(</span><span class="string" id="5610869">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5610892">,</span>&nbsp;<span class="ident" id="5610894"><a href="/debug/elf/file.go.html#5610742">e</a></span><span class="op" id="5610895">.</span><span class="ident" id="5610896">off</span><span class="op" id="5610899">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5610902">return</span>&nbsp;<span class="ident" id="5610909"><a href="/debug/elf/file.go.html#5610776">msg</a></span><br>
<span class="lineno"></span><span class="op" id="5610913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5610916">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5611001">func</span>&nbsp;<span class="ident" id="5611006">Open</span><span class="op" id="5611010">(</span><span class="ident" id="5611011">name</span>&nbsp;<span class="builtintype" id="5611016">string</span><span class="op" id="5611022">)</span>&nbsp;<span class="op" id="5611024">(</span><span class="op" id="5611025">*</span><span class="ident" id="5611026"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5611030">,</span>&nbsp;<span class="builtintype" id="5611032">error</span><span class="op" id="5611037">)</span>&nbsp;<span class="op" id="5611039">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611042">f</span><span class="op" id="5611043">,</span>&nbsp;<span class="ident" id="5611045">err</span>&nbsp;<span class="op" id="5611049">:=</span>&nbsp;<span class="ident" id="5611052"><a href="/debug/elf/file.go.html#5607916">os</a></span><span class="op" id="5611054">.</span><span class="ident" id="5611055">Open</span><span class="op" id="5611059">(</span><span class="ident" id="5611060"><a href="/debug/elf/file.go.html#5611011">name</a></span><span class="op" id="5611064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611067">if</span>&nbsp;<span class="ident" id="5611070"><a href="/debug/elf/file.go.html#5611045">err</a></span>&nbsp;<span class="op" id="5611074">!=</span>&nbsp;<span class="ident" id="5611077">nil</span>&nbsp;<span class="op" id="5611081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611085">return</span>&nbsp;<span class="ident" id="5611092">nil</span><span class="op" id="5611095">,</span>&nbsp;<span class="ident" id="5611097"><a href="/debug/elf/file.go.html#5611045">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611105">ff</span><span class="op" id="5611107">,</span>&nbsp;<span class="ident" id="5611109"><a href="/debug/elf/file.go.html#5611045">err</a></span>&nbsp;<span class="op" id="5611113">:=</span>&nbsp;<span class="ident" id="5611116"><a href="/debug/elf/file.go.html#5611866">NewFile</a></span><span class="op" id="5611123">(</span><span class="ident" id="5611124"><a href="/debug/elf/file.go.html#5611042">f</a></span><span class="op" id="5611125">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611128">if</span>&nbsp;<span class="ident" id="5611131"><a href="/debug/elf/file.go.html#5611045">err</a></span>&nbsp;<span class="op" id="5611135">!=</span>&nbsp;<span class="ident" id="5611138">nil</span>&nbsp;<span class="op" id="5611142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611146"><a href="/debug/elf/file.go.html#5611042">f</a></span><span class="op" id="5611147">.</span><span class="ident" id="5611148">Close</span><span class="op" id="5611153">(</span><span class="op" id="5611154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611158">return</span>&nbsp;<span class="ident" id="5611165">nil</span><span class="op" id="5611168">,</span>&nbsp;<span class="ident" id="5611170"><a href="/debug/elf/file.go.html#5611045">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611178"><a href="/debug/elf/file.go.html#5611105">ff</a></span><span class="op" id="5611180">.</span><span class="ident" id="5611181">closer</span>&nbsp;<span class="op" id="5611188">=</span>&nbsp;<span class="ident" id="5611190"><a href="/debug/elf/file.go.html#5611042">f</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611193">return</span>&nbsp;<span class="ident" id="5611200"><a href="/debug/elf/file.go.html#5611105">ff</a></span><span class="op" id="5611202">,</span>&nbsp;<span class="ident" id="5611204">nil</span><br>
<span class="lineno"></span><span class="op" id="5611208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5611211">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5611237">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5611304">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5611328">func</span>&nbsp;<span class="op" id="5611333">(</span><span class="ident" id="5611334">f</span>&nbsp;<span class="op" id="5611336">*</span><span class="ident" id="5611337"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5611341">)</span>&nbsp;<span class="ident" id="5611343">Close</span><span class="op" id="5611348">(</span><span class="op" id="5611349">)</span>&nbsp;<span class="builtintype" id="5611351">error</span>&nbsp;<span class="op" id="5611357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611360">var</span>&nbsp;<span class="ident" id="5611364">err</span>&nbsp;<span class="builtintype" id="5611368">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611375">if</span>&nbsp;<span class="ident" id="5611378"><a href="/debug/elf/file.go.html#5611334">f</a></span><span class="op" id="5611379">.</span><span class="ident" id="5611380">closer</span>&nbsp;<span class="op" id="5611387">!=</span>&nbsp;<span class="ident" id="5611390">nil</span>&nbsp;<span class="op" id="5611394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611398"><a href="/debug/elf/file.go.html#5611364">err</a></span>&nbsp;<span class="op" id="5611402">=</span>&nbsp;<span class="ident" id="5611404"><a href="/debug/elf/file.go.html#5611334">f</a></span><span class="op" id="5611405">.</span><span class="ident" id="5611406">closer</span><span class="op" id="5611412">.</span><span class="ident" id="5611413">Close</span><span class="op" id="5611418">(</span><span class="op" id="5611419">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611423"><a href="/debug/elf/file.go.html#5611334">f</a></span><span class="op" id="5611424">.</span><span class="ident" id="5611425">closer</span>&nbsp;<span class="op" id="5611432">=</span>&nbsp;<span class="ident" id="5611434">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611442">return</span>&nbsp;<span class="ident" id="5611449"><a href="/debug/elf/file.go.html#5611364">err</a></span><br>
<span class="lineno"></span><span class="op" id="5611453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5611456">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5611513">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5611564">func</span>&nbsp;<span class="op" id="5611569">(</span><span class="ident" id="5611570">f</span>&nbsp;<span class="op" id="5611572">*</span><span class="ident" id="5611573"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5611577">)</span>&nbsp;<span class="ident" id="5611579">SectionByType</span><span class="op" id="5611592">(</span><span class="ident" id="5611593">typ</span>&nbsp;<span class="ident" id="5611597"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><span class="op" id="5611608">)</span>&nbsp;<span class="op" id="5611610">*</span><span class="ident" id="5611611"><a href="/debug/elf/file.go.html#5608763">Section</a></span>&nbsp;<span class="op" id="5611619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611622">for</span>&nbsp;<span class="ident" id="5611626">_</span><span class="op" id="5611627">,</span>&nbsp;<span class="ident" id="5611629">s</span>&nbsp;<span class="op" id="5611631">:=</span>&nbsp;<span class="keyword" id="5611634">range</span>&nbsp;<span class="ident" id="5611640"><a href="/debug/elf/file.go.html#5611570">f</a></span><span class="op" id="5611641">.</span><span class="ident" id="5611642">Sections</span>&nbsp;<span class="op" id="5611651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611655">if</span>&nbsp;<span class="ident" id="5611658"><a href="/debug/elf/file.go.html#5611629">s</a></span><span class="op" id="5611659">.</span><span class="ident" id="5611660">Type</span>&nbsp;<span class="op" id="5611665">==</span>&nbsp;<span class="ident" id="5611668"><a href="/debug/elf/file.go.html#5611593">typ</a></span>&nbsp;<span class="op" id="5611672">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611677">return</span>&nbsp;<span class="ident" id="5611684"><a href="/debug/elf/file.go.html#5611629">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5611691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611694">return</span>&nbsp;<span class="ident" id="5611701">nil</span><br>
<span class="lineno"></span><span class="op" id="5611705">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5611708">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5611791">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5611861">func</span>&nbsp;<span class="ident" id="5611866">NewFile</span><span class="op" id="5611873">(</span><span class="ident" id="5611874">r</span>&nbsp;<span class="ident" id="5611876"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5611878">.</span><span class="ident" id="5611879">ReaderAt</span><span class="op" id="5611887">)</span>&nbsp;<span class="op" id="5611889">(</span><span class="op" id="5611890">*</span><span class="ident" id="5611891"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5611895">,</span>&nbsp;<span class="builtintype" id="5611897">error</span><span class="op" id="5611902">)</span>&nbsp;<span class="op" id="5611904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5611907">sr</span>&nbsp;<span class="op" id="5611910">:=</span>&nbsp;<span class="ident" id="5611913"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5611915">.</span><span class="ident" id="5611916">NewSectionReader</span><span class="op" id="5611932">(</span><span class="ident" id="5611933"><a href="/debug/elf/file.go.html#5611874">r</a></span><span class="op" id="5611934">,</span>&nbsp;<span class="num" id="5611936">0</span><span class="op" id="5611937">,</span>&nbsp;<span class="num" id="5611939">1</span><span class="op" id="5611940">&lt;&lt;</span><span class="num" id="5611942">63</span><span class="op" id="5611944">-</span><span class="num" id="5611945">1</span><span class="op" id="5611946">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5611949">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5611984">var</span>&nbsp;<span class="ident" id="5611988">ident</span>&nbsp;<span class="op" id="5611994">[</span><span class="num" id="5611995">16</span><span class="op" id="5611997">]</span><span class="builtintype" id="5611998">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612005">if</span>&nbsp;<span class="ident" id="5612008">_</span><span class="op" id="5612009">,</span>&nbsp;<span class="ident" id="5612011">err</span>&nbsp;<span class="op" id="5612015">:=</span>&nbsp;<span class="ident" id="5612018"><a href="/debug/elf/file.go.html#5611874">r</a></span><span class="op" id="5612019">.</span><span class="ident" id="5612020">ReadAt</span><span class="op" id="5612026">(</span><span class="ident" id="5612027"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612032">[</span><span class="num" id="5612033">0</span><span class="op" id="5612034">:</span><span class="op" id="5612035">]</span><span class="op" id="5612036">,</span>&nbsp;<span class="num" id="5612038">0</span><span class="op" id="5612039">)</span><span class="op" id="5612040">;</span>&nbsp;<span class="ident" id="5612042"><a href="/debug/elf/file.go.html#5612011">err</a></span>&nbsp;<span class="op" id="5612046">!=</span>&nbsp;<span class="ident" id="5612049">nil</span>&nbsp;<span class="op" id="5612053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612057">return</span>&nbsp;<span class="ident" id="5612064">nil</span><span class="op" id="5612067">,</span>&nbsp;<span class="ident" id="5612069"><a href="/debug/elf/file.go.html#5612011">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612074">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612077">if</span>&nbsp;<span class="ident" id="5612080"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612085">[</span><span class="num" id="5612086">0</span><span class="op" id="5612087">]</span>&nbsp;<span class="op" id="5612089">!=</span>&nbsp;<span class="string" id="5612092">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5612099">||</span>&nbsp;<span class="ident" id="5612102"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612107">[</span><span class="num" id="5612108">1</span><span class="op" id="5612109">]</span>&nbsp;<span class="op" id="5612111">!=</span>&nbsp;<span class="string" id="5612114">&#39;E&#39;</span>&nbsp;<span class="op" id="5612118">||</span>&nbsp;<span class="ident" id="5612121"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612126">[</span><span class="num" id="5612127">2</span><span class="op" id="5612128">]</span>&nbsp;<span class="op" id="5612130">!=</span>&nbsp;<span class="string" id="5612133">&#39;L&#39;</span>&nbsp;<span class="op" id="5612137">||</span>&nbsp;<span class="ident" id="5612140"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612145">[</span><span class="num" id="5612146">3</span><span class="op" id="5612147">]</span>&nbsp;<span class="op" id="5612149">!=</span>&nbsp;<span class="string" id="5612152">&#39;F&#39;</span>&nbsp;<span class="op" id="5612156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612160">return</span>&nbsp;<span class="ident" id="5612167">nil</span><span class="op" id="5612170">,</span>&nbsp;<span class="op" id="5612172">&amp;</span><span class="ident" id="5612173"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5612184">{</span><span class="num" id="5612185">0</span><span class="op" id="5612186">,</span>&nbsp;<span class="string" id="5612188">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5612206">,</span>&nbsp;<span class="ident" id="5612208"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612213">[</span><span class="num" id="5612214">0</span><span class="op" id="5612215">:</span><span class="num" id="5612216">4</span><span class="op" id="5612217">]</span><span class="op" id="5612218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612225">f</span>&nbsp;<span class="op" id="5612227">:=</span>&nbsp;<span class="builtinfunc" id="5612230">new</span><span class="op" id="5612233">(</span><span class="ident" id="5612234"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5612238">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612241"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612242">.</span><span class="ident" id="5612243">Class</span>&nbsp;<span class="op" id="5612249">=</span>&nbsp;<span class="ident" id="5612251"><a href="/debug/elf/elf.go.html#5546432">Class</a></span><span class="op" id="5612256">(</span><span class="ident" id="5612257"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612262">[</span><span class="ident" id="5612263"><a href="/debug/elf/elf.go.html#5545559">EI_CLASS</a></span><span class="op" id="5612271">]</span><span class="op" id="5612272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612275">switch</span>&nbsp;<span class="ident" id="5612282"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612283">.</span><span class="ident" id="5612284">Class</span>&nbsp;<span class="op" id="5612290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612293">case</span>&nbsp;<span class="ident" id="5612298"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span><span class="op" id="5612308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612311">case</span>&nbsp;<span class="ident" id="5612316"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span><span class="op" id="5612326">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5612330">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612337">default</span><span class="op" id="5612344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612348">return</span>&nbsp;<span class="ident" id="5612355">nil</span><span class="op" id="5612358">,</span>&nbsp;<span class="op" id="5612360">&amp;</span><span class="ident" id="5612361"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5612372">{</span><span class="num" id="5612373">0</span><span class="op" id="5612374">,</span>&nbsp;<span class="string" id="5612376">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5612395">,</span>&nbsp;<span class="ident" id="5612397"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612398">.</span><span class="ident" id="5612399">Class</span><span class="op" id="5612404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612411"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612412">.</span><span class="ident" id="5612413">Data</span>&nbsp;<span class="op" id="5612418">=</span>&nbsp;<span class="ident" id="5612420"><a href="/debug/elf/elf.go.html#5546935">Data</a></span><span class="op" id="5612424">(</span><span class="ident" id="5612425"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612430">[</span><span class="ident" id="5612431"><a href="/debug/elf/elf.go.html#5545603">EI_DATA</a></span><span class="op" id="5612438">]</span><span class="op" id="5612439">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612442">switch</span>&nbsp;<span class="ident" id="5612449"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612450">.</span><span class="ident" id="5612451">Data</span>&nbsp;<span class="op" id="5612456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612459">case</span>&nbsp;<span class="ident" id="5612464"><a href="/debug/elf/elf.go.html#5547004">ELFDATA2LSB</a></span><span class="op" id="5612475">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612479"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612480">.</span><span class="ident" id="5612481">ByteOrder</span>&nbsp;<span class="op" id="5612491">=</span>&nbsp;<span class="ident" id="5612493"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5612499">.</span><span class="ident" id="5612500">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612514">case</span>&nbsp;<span class="ident" id="5612519"><a href="/debug/elf/elf.go.html#5547062">ELFDATA2MSB</a></span><span class="op" id="5612530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612534"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612535">.</span><span class="ident" id="5612536">ByteOrder</span>&nbsp;<span class="op" id="5612546">=</span>&nbsp;<span class="ident" id="5612548"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5612554">.</span><span class="ident" id="5612555">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612566">default</span><span class="op" id="5612573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612577">return</span>&nbsp;<span class="ident" id="5612584">nil</span><span class="op" id="5612587">,</span>&nbsp;<span class="op" id="5612589">&amp;</span><span class="ident" id="5612590"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5612601">{</span><span class="num" id="5612602">0</span><span class="op" id="5612603">,</span>&nbsp;<span class="string" id="5612605">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5612632">,</span>&nbsp;<span class="ident" id="5612634"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612635">.</span><span class="ident" id="5612636">Data</span><span class="op" id="5612640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612647"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612648">.</span><span class="ident" id="5612649">Version</span>&nbsp;<span class="op" id="5612657">=</span>&nbsp;<span class="ident" id="5612659"><a href="/debug/elf/elf.go.html#5546038">Version</a></span><span class="op" id="5612666">(</span><span class="ident" id="5612667"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612672">[</span><span class="ident" id="5612673"><a href="/debug/elf/elf.go.html#5545642">EI_VERSION</a></span><span class="op" id="5612683">]</span><span class="op" id="5612684">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612687">if</span>&nbsp;<span class="ident" id="5612690"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612691">.</span><span class="ident" id="5612692">Version</span>&nbsp;<span class="op" id="5612700">!=</span>&nbsp;<span class="ident" id="5612703"><a href="/debug/elf/elf.go.html#5546085">EV_CURRENT</a></span>&nbsp;<span class="op" id="5612714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612718">return</span>&nbsp;<span class="ident" id="5612725">nil</span><span class="op" id="5612728">,</span>&nbsp;<span class="op" id="5612730">&amp;</span><span class="ident" id="5612731"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5612742">{</span><span class="num" id="5612743">0</span><span class="op" id="5612744">,</span>&nbsp;<span class="string" id="5612746">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5612767">,</span>&nbsp;<span class="ident" id="5612769"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612770">.</span><span class="ident" id="5612771">Version</span><span class="op" id="5612778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5612781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612785"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612786">.</span><span class="ident" id="5612787">OSABI</span>&nbsp;<span class="op" id="5612793">=</span>&nbsp;<span class="ident" id="5612795"><a href="/debug/elf/elf.go.html#5547451">OSABI</a></span><span class="op" id="5612800">(</span><span class="ident" id="5612801"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612806">[</span><span class="ident" id="5612807"><a href="/debug/elf/elf.go.html#5545688">EI_OSABI</a></span><span class="op" id="5612815">]</span><span class="op" id="5612816">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612819"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5612820">.</span><span class="ident" id="5612821">ABIVersion</span>&nbsp;<span class="op" id="5612832">=</span>&nbsp;<span class="ident" id="5612834"><a href="/debug/elf/file.go.html#5611988">ident</a></span><span class="op" id="5612839">[</span><span class="ident" id="5612840"><a href="/debug/elf/elf.go.html#5545752">EI_ABIVERSION</a></span><span class="op" id="5612853">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5612857">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612882">var</span>&nbsp;<span class="ident" id="5612886">phoff</span>&nbsp;<span class="ident" id="5612892">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612899">var</span>&nbsp;<span class="ident" id="5612903">phentsize</span><span class="op" id="5612912">,</span>&nbsp;<span class="ident" id="5612914">phnum</span>&nbsp;<span class="builtintype" id="5612920">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612925">var</span>&nbsp;<span class="ident" id="5612929">shoff</span>&nbsp;<span class="ident" id="5612935">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612942">var</span>&nbsp;<span class="ident" id="5612946">shentsize</span><span class="op" id="5612955">,</span>&nbsp;<span class="ident" id="5612957">shnum</span><span class="op" id="5612962">,</span>&nbsp;<span class="ident" id="5612964">shstrndx</span>&nbsp;<span class="builtintype" id="5612973">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5612978"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span>&nbsp;<span class="op" id="5612987">=</span>&nbsp;<span class="op" id="5612989">-</span><span class="num" id="5612990">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5612993">switch</span>&nbsp;<span class="ident" id="5613000"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613001">.</span><span class="ident" id="5613002">Class</span>&nbsp;<span class="op" id="5613008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613011">case</span>&nbsp;<span class="ident" id="5613016"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span><span class="op" id="5613026">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613030">hdr</span>&nbsp;<span class="op" id="5613034">:=</span>&nbsp;<span class="builtinfunc" id="5613037">new</span><span class="op" id="5613040">(</span><span class="ident" id="5613041"><a href="/debug/elf/elf.go.html#5600703">Header32</a></span><span class="op" id="5613049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613053"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5613055">.</span><span class="ident" id="5613056">Seek</span><span class="op" id="5613060">(</span><span class="num" id="5613061">0</span><span class="op" id="5613062">,</span>&nbsp;<span class="ident" id="5613064"><a href="/debug/elf/file.go.html#5607916">os</a></span><span class="op" id="5613066">.</span><span class="ident" id="5613067">SEEK_SET</span><span class="op" id="5613075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613079">if</span>&nbsp;<span class="ident" id="5613082">err</span>&nbsp;<span class="op" id="5613086">:=</span>&nbsp;<span class="ident" id="5613089"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5613095">.</span><span class="ident" id="5613096">Read</span><span class="op" id="5613100">(</span><span class="ident" id="5613101"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5613103">,</span>&nbsp;<span class="ident" id="5613105"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613106">.</span><span class="ident" id="5613107">ByteOrder</span><span class="op" id="5613116">,</span>&nbsp;<span class="ident" id="5613118"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613121">)</span><span class="op" id="5613122">;</span>&nbsp;<span class="ident" id="5613124"><a href="/debug/elf/file.go.html#5613082">err</a></span>&nbsp;<span class="op" id="5613128">!=</span>&nbsp;<span class="ident" id="5613131">nil</span>&nbsp;<span class="op" id="5613135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613140">return</span>&nbsp;<span class="ident" id="5613147">nil</span><span class="op" id="5613150">,</span>&nbsp;<span class="ident" id="5613152"><a href="/debug/elf/file.go.html#5613082">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613158">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613162"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613163">.</span><span class="ident" id="5613164">Type</span>&nbsp;<span class="op" id="5613169">=</span>&nbsp;<span class="ident" id="5613171"><a href="/debug/elf/elf.go.html#5549020">Type</a></span><span class="op" id="5613175">(</span><span class="ident" id="5613176"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613179">.</span><span class="ident" id="5613180">Type</span><span class="op" id="5613184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613188"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613189">.</span><span class="ident" id="5613190">Machine</span>&nbsp;<span class="op" id="5613198">=</span>&nbsp;<span class="ident" id="5613200"><a href="/debug/elf/elf.go.html#5549925">Machine</a></span><span class="op" id="5613207">(</span><span class="ident" id="5613208"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613211">.</span><span class="ident" id="5613212">Machine</span><span class="op" id="5613219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613223"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613224">.</span><span class="ident" id="5613225">Entry</span>&nbsp;<span class="op" id="5613231">=</span>&nbsp;<span class="ident" id="5613233">uint64</span><span class="op" id="5613239">(</span><span class="ident" id="5613240"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613243">.</span><span class="ident" id="5613244">Entry</span><span class="op" id="5613249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613253">if</span>&nbsp;<span class="ident" id="5613256">v</span>&nbsp;<span class="op" id="5613258">:=</span>&nbsp;<span class="ident" id="5613261"><a href="/debug/elf/elf.go.html#5546038">Version</a></span><span class="op" id="5613268">(</span><span class="ident" id="5613269"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613272">.</span><span class="ident" id="5613273">Version</span><span class="op" id="5613280">)</span><span class="op" id="5613281">;</span>&nbsp;<span class="ident" id="5613283"><a href="/debug/elf/file.go.html#5613256">v</a></span>&nbsp;<span class="op" id="5613285">!=</span>&nbsp;<span class="ident" id="5613288"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613289">.</span><span class="ident" id="5613290">Version</span>&nbsp;<span class="op" id="5613298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613303">return</span>&nbsp;<span class="ident" id="5613310">nil</span><span class="op" id="5613313">,</span>&nbsp;<span class="op" id="5613315">&amp;</span><span class="ident" id="5613316"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5613327">{</span><span class="num" id="5613328">0</span><span class="op" id="5613329">,</span>&nbsp;<span class="string" id="5613331">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5613355">,</span>&nbsp;<span class="ident" id="5613357"><a href="/debug/elf/file.go.html#5613256">v</a></span><span class="op" id="5613358">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613366"><a href="/debug/elf/file.go.html#5612886">phoff</a></span>&nbsp;<span class="op" id="5613372">=</span>&nbsp;<span class="ident" id="5613374">int64</span><span class="op" id="5613379">(</span><span class="ident" id="5613380"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613383">.</span><span class="ident" id="5613384">Phoff</span><span class="op" id="5613389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613393"><a href="/debug/elf/file.go.html#5612903">phentsize</a></span>&nbsp;<span class="op" id="5613403">=</span>&nbsp;<span class="builtintype" id="5613405">int</span><span class="op" id="5613408">(</span><span class="ident" id="5613409"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613412">.</span><span class="ident" id="5613413">Phentsize</span><span class="op" id="5613422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613426"><a href="/debug/elf/file.go.html#5612914">phnum</a></span>&nbsp;<span class="op" id="5613432">=</span>&nbsp;<span class="builtintype" id="5613434">int</span><span class="op" id="5613437">(</span><span class="ident" id="5613438"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613441">.</span><span class="ident" id="5613442">Phnum</span><span class="op" id="5613447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613451"><a href="/debug/elf/file.go.html#5612929">shoff</a></span>&nbsp;<span class="op" id="5613457">=</span>&nbsp;<span class="ident" id="5613459">int64</span><span class="op" id="5613464">(</span><span class="ident" id="5613465"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613468">.</span><span class="ident" id="5613469">Shoff</span><span class="op" id="5613474">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613478"><a href="/debug/elf/file.go.html#5612946">shentsize</a></span>&nbsp;<span class="op" id="5613488">=</span>&nbsp;<span class="builtintype" id="5613490">int</span><span class="op" id="5613493">(</span><span class="ident" id="5613494"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613497">.</span><span class="ident" id="5613498">Shentsize</span><span class="op" id="5613507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613511"><a href="/debug/elf/file.go.html#5612957">shnum</a></span>&nbsp;<span class="op" id="5613517">=</span>&nbsp;<span class="builtintype" id="5613519">int</span><span class="op" id="5613522">(</span><span class="ident" id="5613523"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613526">.</span><span class="ident" id="5613527">Shnum</span><span class="op" id="5613532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613536"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span>&nbsp;<span class="op" id="5613545">=</span>&nbsp;<span class="builtintype" id="5613547">int</span><span class="op" id="5613550">(</span><span class="ident" id="5613551"><a href="/debug/elf/file.go.html#5613030">hdr</a></span><span class="op" id="5613554">.</span><span class="ident" id="5613555">Shstrndx</span><span class="op" id="5613563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613566">case</span>&nbsp;<span class="ident" id="5613571"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span><span class="op" id="5613581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613585">hdr</span>&nbsp;<span class="op" id="5613589">:=</span>&nbsp;<span class="builtinfunc" id="5613592">new</span><span class="op" id="5613595">(</span><span class="ident" id="5613596"><a href="/debug/elf/elf.go.html#5603765">Header64</a></span><span class="op" id="5613604">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613608"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5613610">.</span><span class="ident" id="5613611">Seek</span><span class="op" id="5613615">(</span><span class="num" id="5613616">0</span><span class="op" id="5613617">,</span>&nbsp;<span class="ident" id="5613619"><a href="/debug/elf/file.go.html#5607916">os</a></span><span class="op" id="5613621">.</span><span class="ident" id="5613622">SEEK_SET</span><span class="op" id="5613630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613634">if</span>&nbsp;<span class="ident" id="5613637">err</span>&nbsp;<span class="op" id="5613641">:=</span>&nbsp;<span class="ident" id="5613644"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5613650">.</span><span class="ident" id="5613651">Read</span><span class="op" id="5613655">(</span><span class="ident" id="5613656"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5613658">,</span>&nbsp;<span class="ident" id="5613660"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613661">.</span><span class="ident" id="5613662">ByteOrder</span><span class="op" id="5613671">,</span>&nbsp;<span class="ident" id="5613673"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613676">)</span><span class="op" id="5613677">;</span>&nbsp;<span class="ident" id="5613679"><a href="/debug/elf/file.go.html#5613637">err</a></span>&nbsp;<span class="op" id="5613683">!=</span>&nbsp;<span class="ident" id="5613686">nil</span>&nbsp;<span class="op" id="5613690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613695">return</span>&nbsp;<span class="ident" id="5613702">nil</span><span class="op" id="5613705">,</span>&nbsp;<span class="ident" id="5613707"><a href="/debug/elf/file.go.html#5613637">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613717"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613718">.</span><span class="ident" id="5613719">Type</span>&nbsp;<span class="op" id="5613724">=</span>&nbsp;<span class="ident" id="5613726"><a href="/debug/elf/elf.go.html#5549020">Type</a></span><span class="op" id="5613730">(</span><span class="ident" id="5613731"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613734">.</span><span class="ident" id="5613735">Type</span><span class="op" id="5613739">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613743"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613744">.</span><span class="ident" id="5613745">Machine</span>&nbsp;<span class="op" id="5613753">=</span>&nbsp;<span class="ident" id="5613755"><a href="/debug/elf/elf.go.html#5549925">Machine</a></span><span class="op" id="5613762">(</span><span class="ident" id="5613763"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613766">.</span><span class="ident" id="5613767">Machine</span><span class="op" id="5613774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613778"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613779">.</span><span class="ident" id="5613780">Entry</span>&nbsp;<span class="op" id="5613786">=</span>&nbsp;<span class="ident" id="5613788">uint64</span><span class="op" id="5613794">(</span><span class="ident" id="5613795"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613798">.</span><span class="ident" id="5613799">Entry</span><span class="op" id="5613804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613808">if</span>&nbsp;<span class="ident" id="5613811">v</span>&nbsp;<span class="op" id="5613813">:=</span>&nbsp;<span class="ident" id="5613816"><a href="/debug/elf/elf.go.html#5546038">Version</a></span><span class="op" id="5613823">(</span><span class="ident" id="5613824"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613827">.</span><span class="ident" id="5613828">Version</span><span class="op" id="5613835">)</span><span class="op" id="5613836">;</span>&nbsp;<span class="ident" id="5613838"><a href="/debug/elf/file.go.html#5613811">v</a></span>&nbsp;<span class="op" id="5613840">!=</span>&nbsp;<span class="ident" id="5613843"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5613844">.</span><span class="ident" id="5613845">Version</span>&nbsp;<span class="op" id="5613853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5613858">return</span>&nbsp;<span class="ident" id="5613865">nil</span><span class="op" id="5613868">,</span>&nbsp;<span class="op" id="5613870">&amp;</span><span class="ident" id="5613871"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5613882">{</span><span class="num" id="5613883">0</span><span class="op" id="5613884">,</span>&nbsp;<span class="string" id="5613886">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5613910">,</span>&nbsp;<span class="ident" id="5613912"><a href="/debug/elf/file.go.html#5613811">v</a></span><span class="op" id="5613913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5613917">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613921"><a href="/debug/elf/file.go.html#5612886">phoff</a></span>&nbsp;<span class="op" id="5613927">=</span>&nbsp;<span class="ident" id="5613929">int64</span><span class="op" id="5613934">(</span><span class="ident" id="5613935"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613938">.</span><span class="ident" id="5613939">Phoff</span><span class="op" id="5613944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613948"><a href="/debug/elf/file.go.html#5612903">phentsize</a></span>&nbsp;<span class="op" id="5613958">=</span>&nbsp;<span class="builtintype" id="5613960">int</span><span class="op" id="5613963">(</span><span class="ident" id="5613964"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613967">.</span><span class="ident" id="5613968">Phentsize</span><span class="op" id="5613977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5613981"><a href="/debug/elf/file.go.html#5612914">phnum</a></span>&nbsp;<span class="op" id="5613987">=</span>&nbsp;<span class="builtintype" id="5613989">int</span><span class="op" id="5613992">(</span><span class="ident" id="5613993"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5613996">.</span><span class="ident" id="5613997">Phnum</span><span class="op" id="5614002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614006"><a href="/debug/elf/file.go.html#5612929">shoff</a></span>&nbsp;<span class="op" id="5614012">=</span>&nbsp;<span class="ident" id="5614014">int64</span><span class="op" id="5614019">(</span><span class="ident" id="5614020"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5614023">.</span><span class="ident" id="5614024">Shoff</span><span class="op" id="5614029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614033"><a href="/debug/elf/file.go.html#5612946">shentsize</a></span>&nbsp;<span class="op" id="5614043">=</span>&nbsp;<span class="builtintype" id="5614045">int</span><span class="op" id="5614048">(</span><span class="ident" id="5614049"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5614052">.</span><span class="ident" id="5614053">Shentsize</span><span class="op" id="5614062">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614066"><a href="/debug/elf/file.go.html#5612957">shnum</a></span>&nbsp;<span class="op" id="5614072">=</span>&nbsp;<span class="builtintype" id="5614074">int</span><span class="op" id="5614077">(</span><span class="ident" id="5614078"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5614081">.</span><span class="ident" id="5614082">Shnum</span><span class="op" id="5614087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614091"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span>&nbsp;<span class="op" id="5614100">=</span>&nbsp;<span class="builtintype" id="5614102">int</span><span class="op" id="5614105">(</span><span class="ident" id="5614106"><a href="/debug/elf/file.go.html#5613585">hdr</a></span><span class="op" id="5614109">.</span><span class="ident" id="5614110">Shstrndx</span><span class="op" id="5614118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614125">if</span>&nbsp;<span class="ident" id="5614128"><a href="/debug/elf/file.go.html#5612957">shnum</a></span>&nbsp;<span class="op" id="5614134">&gt;</span>&nbsp;<span class="num" id="5614136">0</span>&nbsp;<span class="op" id="5614138">&amp;&amp;</span>&nbsp;<span class="ident" id="5614141"><a href="/debug/elf/file.go.html#5612929">shoff</a></span>&nbsp;<span class="op" id="5614147">&gt;</span>&nbsp;<span class="num" id="5614149">0</span>&nbsp;<span class="op" id="5614151">&amp;&amp;</span>&nbsp;<span class="op" id="5614154">(</span><span class="ident" id="5614155"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span>&nbsp;<span class="op" id="5614164">&lt;</span>&nbsp;<span class="num" id="5614166">0</span>&nbsp;<span class="op" id="5614168">||</span>&nbsp;<span class="ident" id="5614171"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span>&nbsp;<span class="op" id="5614180">&gt;=</span>&nbsp;<span class="ident" id="5614183"><a href="/debug/elf/file.go.html#5612957">shnum</a></span><span class="op" id="5614188">)</span>&nbsp;<span class="op" id="5614190">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614194">return</span>&nbsp;<span class="ident" id="5614201">nil</span><span class="op" id="5614204">,</span>&nbsp;<span class="op" id="5614206">&amp;</span><span class="ident" id="5614207"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5614218">{</span><span class="num" id="5614219">0</span><span class="op" id="5614220">,</span>&nbsp;<span class="string" id="5614222">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5614244">,</span>&nbsp;<span class="ident" id="5614246"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span><span class="op" id="5614254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5614261">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614286"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5614287">.</span><span class="ident" id="5614288">Progs</span>&nbsp;<span class="op" id="5614294">=</span>&nbsp;<span class="builtinfunc" id="5614296">make</span><span class="op" id="5614300">(</span><span class="op" id="5614301">[</span><span class="op" id="5614302">]</span><span class="op" id="5614303">*</span><span class="ident" id="5614304"><a href="/debug/elf/file.go.html#5610024">Prog</a></span><span class="op" id="5614308">,</span>&nbsp;<span class="ident" id="5614310"><a href="/debug/elf/file.go.html#5612914">phnum</a></span><span class="op" id="5614315">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614318">for</span>&nbsp;<span class="ident" id="5614322">i</span>&nbsp;<span class="op" id="5614324">:=</span>&nbsp;<span class="num" id="5614327">0</span><span class="op" id="5614328">;</span>&nbsp;<span class="ident" id="5614330"><a href="/debug/elf/file.go.html#5614322">i</a></span>&nbsp;<span class="op" id="5614332">&lt;</span>&nbsp;<span class="ident" id="5614334"><a href="/debug/elf/file.go.html#5612914">phnum</a></span><span class="op" id="5614339">;</span>&nbsp;<span class="ident" id="5614341"><a href="/debug/elf/file.go.html#5614322">i</a></span><span class="op" id="5614342">++</span>&nbsp;<span class="op" id="5614345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614349">off</span>&nbsp;<span class="op" id="5614353">:=</span>&nbsp;<span class="ident" id="5614356"><a href="/debug/elf/file.go.html#5612886">phoff</a></span>&nbsp;<span class="op" id="5614362">+</span>&nbsp;<span class="ident" id="5614364">int64</span><span class="op" id="5614369">(</span><span class="ident" id="5614370"><a href="/debug/elf/file.go.html#5614322">i</a></span><span class="op" id="5614371">)</span><span class="op" id="5614372">*</span><span class="ident" id="5614373">int64</span><span class="op" id="5614378">(</span><span class="ident" id="5614379"><a href="/debug/elf/file.go.html#5612903">phentsize</a></span><span class="op" id="5614388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614392"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5614394">.</span><span class="ident" id="5614395">Seek</span><span class="op" id="5614399">(</span><span class="ident" id="5614400"><a href="/debug/elf/file.go.html#5614349">off</a></span><span class="op" id="5614403">,</span>&nbsp;<span class="ident" id="5614405"><a href="/debug/elf/file.go.html#5607916">os</a></span><span class="op" id="5614407">.</span><span class="ident" id="5614408">SEEK_SET</span><span class="op" id="5614416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614420">p</span>&nbsp;<span class="op" id="5614422">:=</span>&nbsp;<span class="builtinfunc" id="5614425">new</span><span class="op" id="5614428">(</span><span class="ident" id="5614429"><a href="/debug/elf/file.go.html#5610024">Prog</a></span><span class="op" id="5614433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614437">switch</span>&nbsp;<span class="ident" id="5614444"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5614445">.</span><span class="ident" id="5614446">Class</span>&nbsp;<span class="op" id="5614452">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614456">case</span>&nbsp;<span class="ident" id="5614461"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span><span class="op" id="5614471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614476">ph</span>&nbsp;<span class="op" id="5614479">:=</span>&nbsp;<span class="builtinfunc" id="5614482">new</span><span class="op" id="5614485">(</span><span class="ident" id="5614486"><a href="/debug/elf/elf.go.html#5602115">Prog32</a></span><span class="op" id="5614492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614497">if</span>&nbsp;<span class="ident" id="5614500">err</span>&nbsp;<span class="op" id="5614504">:=</span>&nbsp;<span class="ident" id="5614507"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5614513">.</span><span class="ident" id="5614514">Read</span><span class="op" id="5614518">(</span><span class="ident" id="5614519"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5614521">,</span>&nbsp;<span class="ident" id="5614523"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5614524">.</span><span class="ident" id="5614525">ByteOrder</span><span class="op" id="5614534">,</span>&nbsp;<span class="ident" id="5614536"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614538">)</span><span class="op" id="5614539">;</span>&nbsp;<span class="ident" id="5614541"><a href="/debug/elf/file.go.html#5614500">err</a></span>&nbsp;<span class="op" id="5614545">!=</span>&nbsp;<span class="ident" id="5614548">nil</span>&nbsp;<span class="op" id="5614552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614558">return</span>&nbsp;<span class="ident" id="5614565">nil</span><span class="op" id="5614568">,</span>&nbsp;<span class="ident" id="5614570"><a href="/debug/elf/file.go.html#5614500">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614577">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614582"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5614583">.</span><span class="ident" id="5614584">ProgHeader</span>&nbsp;<span class="op" id="5614595">=</span>&nbsp;<span class="ident" id="5614597"><a href="/debug/elf/file.go.html#5609805">ProgHeader</a></span><span class="op" id="5614607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614613">Type</span><span class="op" id="5614617">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5614621"><a href="/debug/elf/elf.go.html#5559561">ProgType</a></span><span class="op" id="5614629">(</span><span class="ident" id="5614630"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614632">.</span><span class="ident" id="5614633">Type</span><span class="op" id="5614637">)</span><span class="op" id="5614638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614644">Flags</span><span class="op" id="5614649">:</span>&nbsp;&nbsp;<span class="ident" id="5614652"><a href="/debug/elf/elf.go.html#5560837">ProgFlag</a></span><span class="op" id="5614660">(</span><span class="ident" id="5614661"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614663">.</span><span class="ident" id="5614664">Flags</span><span class="op" id="5614669">)</span><span class="op" id="5614670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614676">Off</span><span class="op" id="5614679">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5614684">uint64</span><span class="op" id="5614690">(</span><span class="ident" id="5614691"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614693">.</span><span class="ident" id="5614694">Off</span><span class="op" id="5614697">)</span><span class="op" id="5614698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614704">Vaddr</span><span class="op" id="5614709">:</span>&nbsp;&nbsp;<span class="ident" id="5614712">uint64</span><span class="op" id="5614718">(</span><span class="ident" id="5614719"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614721">.</span><span class="ident" id="5614722">Vaddr</span><span class="op" id="5614727">)</span><span class="op" id="5614728">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614734">Paddr</span><span class="op" id="5614739">:</span>&nbsp;&nbsp;<span class="ident" id="5614742">uint64</span><span class="op" id="5614748">(</span><span class="ident" id="5614749"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614751">.</span><span class="ident" id="5614752">Paddr</span><span class="op" id="5614757">)</span><span class="op" id="5614758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614764">Filesz</span><span class="op" id="5614770">:</span>&nbsp;<span class="ident" id="5614772">uint64</span><span class="op" id="5614778">(</span><span class="ident" id="5614779"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614781">.</span><span class="ident" id="5614782">Filesz</span><span class="op" id="5614788">)</span><span class="op" id="5614789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614795">Memsz</span><span class="op" id="5614800">:</span>&nbsp;&nbsp;<span class="ident" id="5614803">uint64</span><span class="op" id="5614809">(</span><span class="ident" id="5614810"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614812">.</span><span class="ident" id="5614813">Memsz</span><span class="op" id="5614818">)</span><span class="op" id="5614819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614825">Align</span><span class="op" id="5614830">:</span>&nbsp;&nbsp;<span class="ident" id="5614833">uint64</span><span class="op" id="5614839">(</span><span class="ident" id="5614840"><a href="/debug/elf/file.go.html#5614476">ph</a></span><span class="op" id="5614842">.</span><span class="ident" id="5614843">Align</span><span class="op" id="5614848">)</span><span class="op" id="5614849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614854">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614858">case</span>&nbsp;<span class="ident" id="5614863"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span><span class="op" id="5614873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614878">ph</span>&nbsp;<span class="op" id="5614881">:=</span>&nbsp;<span class="builtinfunc" id="5614884">new</span><span class="op" id="5614887">(</span><span class="ident" id="5614888"><a href="/debug/elf/elf.go.html#5605177">Prog64</a></span><span class="op" id="5614894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614899">if</span>&nbsp;<span class="ident" id="5614902">err</span>&nbsp;<span class="op" id="5614906">:=</span>&nbsp;<span class="ident" id="5614909"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5614915">.</span><span class="ident" id="5614916">Read</span><span class="op" id="5614920">(</span><span class="ident" id="5614921"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5614923">,</span>&nbsp;<span class="ident" id="5614925"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5614926">.</span><span class="ident" id="5614927">ByteOrder</span><span class="op" id="5614936">,</span>&nbsp;<span class="ident" id="5614938"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5614940">)</span><span class="op" id="5614941">;</span>&nbsp;<span class="ident" id="5614943"><a href="/debug/elf/file.go.html#5614902">err</a></span>&nbsp;<span class="op" id="5614947">!=</span>&nbsp;<span class="ident" id="5614950">nil</span>&nbsp;<span class="op" id="5614954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5614960">return</span>&nbsp;<span class="ident" id="5614967">nil</span><span class="op" id="5614970">,</span>&nbsp;<span class="ident" id="5614972"><a href="/debug/elf/file.go.html#5614902">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5614979">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5614984"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5614985">.</span><span class="ident" id="5614986">ProgHeader</span>&nbsp;<span class="op" id="5614997">=</span>&nbsp;<span class="ident" id="5614999"><a href="/debug/elf/file.go.html#5609805">ProgHeader</a></span><span class="op" id="5615009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615015">Type</span><span class="op" id="5615019">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5615023"><a href="/debug/elf/elf.go.html#5559561">ProgType</a></span><span class="op" id="5615031">(</span><span class="ident" id="5615032"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615034">.</span><span class="ident" id="5615035">Type</span><span class="op" id="5615039">)</span><span class="op" id="5615040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615046">Flags</span><span class="op" id="5615051">:</span>&nbsp;&nbsp;<span class="ident" id="5615054"><a href="/debug/elf/elf.go.html#5560837">ProgFlag</a></span><span class="op" id="5615062">(</span><span class="ident" id="5615063"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615065">.</span><span class="ident" id="5615066">Flags</span><span class="op" id="5615071">)</span><span class="op" id="5615072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615078">Off</span><span class="op" id="5615081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5615086">uint64</span><span class="op" id="5615092">(</span><span class="ident" id="5615093"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615095">.</span><span class="ident" id="5615096">Off</span><span class="op" id="5615099">)</span><span class="op" id="5615100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615106">Vaddr</span><span class="op" id="5615111">:</span>&nbsp;&nbsp;<span class="ident" id="5615114">uint64</span><span class="op" id="5615120">(</span><span class="ident" id="5615121"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615123">.</span><span class="ident" id="5615124">Vaddr</span><span class="op" id="5615129">)</span><span class="op" id="5615130">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615136">Paddr</span><span class="op" id="5615141">:</span>&nbsp;&nbsp;<span class="ident" id="5615144">uint64</span><span class="op" id="5615150">(</span><span class="ident" id="5615151"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615153">.</span><span class="ident" id="5615154">Paddr</span><span class="op" id="5615159">)</span><span class="op" id="5615160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615166">Filesz</span><span class="op" id="5615172">:</span>&nbsp;<span class="ident" id="5615174">uint64</span><span class="op" id="5615180">(</span><span class="ident" id="5615181"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615183">.</span><span class="ident" id="5615184">Filesz</span><span class="op" id="5615190">)</span><span class="op" id="5615191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615197">Memsz</span><span class="op" id="5615202">:</span>&nbsp;&nbsp;<span class="ident" id="5615205">uint64</span><span class="op" id="5615211">(</span><span class="ident" id="5615212"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615214">.</span><span class="ident" id="5615215">Memsz</span><span class="op" id="5615220">)</span><span class="op" id="5615221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615227">Align</span><span class="op" id="5615232">:</span>&nbsp;&nbsp;<span class="ident" id="5615235">uint64</span><span class="op" id="5615241">(</span><span class="ident" id="5615242"><a href="/debug/elf/file.go.html#5614878">ph</a></span><span class="op" id="5615244">.</span><span class="ident" id="5615245">Align</span><span class="op" id="5615250">)</span><span class="op" id="5615251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5615256">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5615260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615264"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5615265">.</span><span class="ident" id="5615266">sr</span>&nbsp;<span class="op" id="5615269">=</span>&nbsp;<span class="ident" id="5615271"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5615273">.</span><span class="ident" id="5615274">NewSectionReader</span><span class="op" id="5615290">(</span><span class="ident" id="5615291"><a href="/debug/elf/file.go.html#5611874">r</a></span><span class="op" id="5615292">,</span>&nbsp;<span class="ident" id="5615294">int64</span><span class="op" id="5615299">(</span><span class="ident" id="5615300"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5615301">.</span><span class="ident" id="5615302">Off</span><span class="op" id="5615305">)</span><span class="op" id="5615306">,</span>&nbsp;<span class="ident" id="5615308">int64</span><span class="op" id="5615313">(</span><span class="ident" id="5615314"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5615315">.</span><span class="ident" id="5615316">Filesz</span><span class="op" id="5615322">)</span><span class="op" id="5615323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615327"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5615328">.</span><span class="ident" id="5615329">ReaderAt</span>&nbsp;<span class="op" id="5615338">=</span>&nbsp;<span class="ident" id="5615340"><a href="/debug/elf/file.go.html#5614420">p</a></span><span class="op" id="5615341">.</span><span class="ident" id="5615342">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615347"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5615348">.</span><span class="ident" id="5615349">Progs</span><span class="op" id="5615354">[</span><span class="ident" id="5615355"><a href="/debug/elf/file.go.html#5614322">i</a></span><span class="op" id="5615356">]</span>&nbsp;<span class="op" id="5615358">=</span>&nbsp;<span class="ident" id="5615360"><a href="/debug/elf/file.go.html#5614420">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5615363">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5615367">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615392"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5615393">.</span><span class="ident" id="5615394">Sections</span>&nbsp;<span class="op" id="5615403">=</span>&nbsp;<span class="builtinfunc" id="5615405">make</span><span class="op" id="5615409">(</span><span class="op" id="5615410">[</span><span class="op" id="5615411">]</span><span class="op" id="5615412">*</span><span class="ident" id="5615413"><a href="/debug/elf/file.go.html#5608763">Section</a></span><span class="op" id="5615420">,</span>&nbsp;<span class="ident" id="5615422"><a href="/debug/elf/file.go.html#5612957">shnum</a></span><span class="op" id="5615427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615430">names</span>&nbsp;<span class="op" id="5615436">:=</span>&nbsp;<span class="builtinfunc" id="5615439">make</span><span class="op" id="5615443">(</span><span class="op" id="5615444">[</span><span class="op" id="5615445">]</span><span class="builtintype" id="5615446">uint32</span><span class="op" id="5615452">,</span>&nbsp;<span class="ident" id="5615454"><a href="/debug/elf/file.go.html#5612957">shnum</a></span><span class="op" id="5615459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5615462">for</span>&nbsp;<span class="ident" id="5615466">i</span>&nbsp;<span class="op" id="5615468">:=</span>&nbsp;<span class="num" id="5615471">0</span><span class="op" id="5615472">;</span>&nbsp;<span class="ident" id="5615474"><a href="/debug/elf/file.go.html#5615466">i</a></span>&nbsp;<span class="op" id="5615476">&lt;</span>&nbsp;<span class="ident" id="5615478"><a href="/debug/elf/file.go.html#5612957">shnum</a></span><span class="op" id="5615483">;</span>&nbsp;<span class="ident" id="5615485"><a href="/debug/elf/file.go.html#5615466">i</a></span><span class="op" id="5615486">++</span>&nbsp;<span class="op" id="5615489">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615493">off</span>&nbsp;<span class="op" id="5615497">:=</span>&nbsp;<span class="ident" id="5615500"><a href="/debug/elf/file.go.html#5612929">shoff</a></span>&nbsp;<span class="op" id="5615506">+</span>&nbsp;<span class="ident" id="5615508">int64</span><span class="op" id="5615513">(</span><span class="ident" id="5615514"><a href="/debug/elf/file.go.html#5615466">i</a></span><span class="op" id="5615515">)</span><span class="op" id="5615516">*</span><span class="ident" id="5615517">int64</span><span class="op" id="5615522">(</span><span class="ident" id="5615523"><a href="/debug/elf/file.go.html#5612946">shentsize</a></span><span class="op" id="5615532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615536"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5615538">.</span><span class="ident" id="5615539">Seek</span><span class="op" id="5615543">(</span><span class="ident" id="5615544"><a href="/debug/elf/file.go.html#5615493">off</a></span><span class="op" id="5615547">,</span>&nbsp;<span class="ident" id="5615549"><a href="/debug/elf/file.go.html#5607916">os</a></span><span class="op" id="5615551">.</span><span class="ident" id="5615552">SEEK_SET</span><span class="op" id="5615560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615564">s</span>&nbsp;<span class="op" id="5615566">:=</span>&nbsp;<span class="builtinfunc" id="5615569">new</span><span class="op" id="5615572">(</span><span class="ident" id="5615573"><a href="/debug/elf/file.go.html#5608763">Section</a></span><span class="op" id="5615580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5615584">switch</span>&nbsp;<span class="ident" id="5615591"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5615592">.</span><span class="ident" id="5615593">Class</span>&nbsp;<span class="op" id="5615599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5615603">case</span>&nbsp;<span class="ident" id="5615608"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span><span class="op" id="5615618">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615623">sh</span>&nbsp;<span class="op" id="5615626">:=</span>&nbsp;<span class="builtinfunc" id="5615629">new</span><span class="op" id="5615632">(</span><span class="ident" id="5615633"><a href="/debug/elf/elf.go.html#5601575">Section32</a></span><span class="op" id="5615642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5615647">if</span>&nbsp;<span class="ident" id="5615650">err</span>&nbsp;<span class="op" id="5615654">:=</span>&nbsp;<span class="ident" id="5615657"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5615663">.</span><span class="ident" id="5615664">Read</span><span class="op" id="5615668">(</span><span class="ident" id="5615669"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5615671">,</span>&nbsp;<span class="ident" id="5615673"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5615674">.</span><span class="ident" id="5615675">ByteOrder</span><span class="op" id="5615684">,</span>&nbsp;<span class="ident" id="5615686"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615688">)</span><span class="op" id="5615689">;</span>&nbsp;<span class="ident" id="5615691"><a href="/debug/elf/file.go.html#5615650">err</a></span>&nbsp;<span class="op" id="5615695">!=</span>&nbsp;<span class="ident" id="5615698">nil</span>&nbsp;<span class="op" id="5615702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5615708">return</span>&nbsp;<span class="ident" id="5615715">nil</span><span class="op" id="5615718">,</span>&nbsp;<span class="ident" id="5615720"><a href="/debug/elf/file.go.html#5615650">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5615727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615732"><a href="/debug/elf/file.go.html#5615430">names</a></span><span class="op" id="5615737">[</span><span class="ident" id="5615738"><a href="/debug/elf/file.go.html#5615466">i</a></span><span class="op" id="5615739">]</span>&nbsp;<span class="op" id="5615741">=</span>&nbsp;<span class="ident" id="5615743"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615745">.</span><span class="ident" id="5615746">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615754"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5615755">.</span><span class="ident" id="5615756">SectionHeader</span>&nbsp;<span class="op" id="5615770">=</span>&nbsp;<span class="ident" id="5615772"><a href="/debug/elf/file.go.html#5608485">SectionHeader</a></span><span class="op" id="5615785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615791">Type</span><span class="op" id="5615795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5615802"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><span class="op" id="5615813">(</span><span class="ident" id="5615814"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615816">.</span><span class="ident" id="5615817">Type</span><span class="op" id="5615821">)</span><span class="op" id="5615822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615828">Flags</span><span class="op" id="5615833">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5615839"><a href="/debug/elf/elf.go.html#5558088">SectionFlag</a></span><span class="op" id="5615850">(</span><span class="ident" id="5615851"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615853">.</span><span class="ident" id="5615854">Flags</span><span class="op" id="5615859">)</span><span class="op" id="5615860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615866">Addr</span><span class="op" id="5615870">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5615877">uint64</span><span class="op" id="5615883">(</span><span class="ident" id="5615884"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615886">.</span><span class="ident" id="5615887">Addr</span><span class="op" id="5615891">)</span><span class="op" id="5615892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615898">Offset</span><span class="op" id="5615904">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5615909">uint64</span><span class="op" id="5615915">(</span><span class="ident" id="5615916"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615918">.</span><span class="ident" id="5615919">Off</span><span class="op" id="5615922">)</span><span class="op" id="5615923">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615929">Size</span><span class="op" id="5615933">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5615940">uint64</span><span class="op" id="5615946">(</span><span class="ident" id="5615947"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615949">.</span><span class="ident" id="5615950">Size</span><span class="op" id="5615954">)</span><span class="op" id="5615955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615961">Link</span><span class="op" id="5615965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5615972">uint32</span><span class="op" id="5615978">(</span><span class="ident" id="5615979"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5615981">.</span><span class="ident" id="5615982">Link</span><span class="op" id="5615986">)</span><span class="op" id="5615987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5615993">Info</span><span class="op" id="5615997">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5616004">uint32</span><span class="op" id="5616010">(</span><span class="ident" id="5616011"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5616013">.</span><span class="ident" id="5616014">Info</span><span class="op" id="5616018">)</span><span class="op" id="5616019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616025">Addralign</span><span class="op" id="5616034">:</span>&nbsp;<span class="ident" id="5616036">uint64</span><span class="op" id="5616042">(</span><span class="ident" id="5616043"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5616045">.</span><span class="ident" id="5616046">Addralign</span><span class="op" id="5616055">)</span><span class="op" id="5616056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616062">Entsize</span><span class="op" id="5616069">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5616073">uint64</span><span class="op" id="5616079">(</span><span class="ident" id="5616080"><a href="/debug/elf/file.go.html#5615623">sh</a></span><span class="op" id="5616082">.</span><span class="ident" id="5616083">Entsize</span><span class="op" id="5616090">)</span><span class="op" id="5616091">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616100">case</span>&nbsp;<span class="ident" id="5616105"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span><span class="op" id="5616115">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616120">sh</span>&nbsp;<span class="op" id="5616123">:=</span>&nbsp;<span class="builtinfunc" id="5616126">new</span><span class="op" id="5616129">(</span><span class="ident" id="5616130"><a href="/debug/elf/elf.go.html#5604637">Section64</a></span><span class="op" id="5616139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616144">if</span>&nbsp;<span class="ident" id="5616147">err</span>&nbsp;<span class="op" id="5616151">:=</span>&nbsp;<span class="ident" id="5616154"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5616160">.</span><span class="ident" id="5616161">Read</span><span class="op" id="5616165">(</span><span class="ident" id="5616166"><a href="/debug/elf/file.go.html#5611907">sr</a></span><span class="op" id="5616168">,</span>&nbsp;<span class="ident" id="5616170"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5616171">.</span><span class="ident" id="5616172">ByteOrder</span><span class="op" id="5616181">,</span>&nbsp;<span class="ident" id="5616183"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616185">)</span><span class="op" id="5616186">;</span>&nbsp;<span class="ident" id="5616188"><a href="/debug/elf/file.go.html#5616147">err</a></span>&nbsp;<span class="op" id="5616192">!=</span>&nbsp;<span class="ident" id="5616195">nil</span>&nbsp;<span class="op" id="5616199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616205">return</span>&nbsp;<span class="ident" id="5616212">nil</span><span class="op" id="5616215">,</span>&nbsp;<span class="ident" id="5616217"><a href="/debug/elf/file.go.html#5616147">err</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616229"><a href="/debug/elf/file.go.html#5615430">names</a></span><span class="op" id="5616234">[</span><span class="ident" id="5616235"><a href="/debug/elf/file.go.html#5615466">i</a></span><span class="op" id="5616236">]</span>&nbsp;<span class="op" id="5616238">=</span>&nbsp;<span class="ident" id="5616240"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616242">.</span><span class="ident" id="5616243">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616251"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5616252">.</span><span class="ident" id="5616253">SectionHeader</span>&nbsp;<span class="op" id="5616267">=</span>&nbsp;<span class="ident" id="5616269"><a href="/debug/elf/file.go.html#5608485">SectionHeader</a></span><span class="op" id="5616282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616288">Type</span><span class="op" id="5616292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616299"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><span class="op" id="5616310">(</span><span class="ident" id="5616311"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616313">.</span><span class="ident" id="5616314">Type</span><span class="op" id="5616318">)</span><span class="op" id="5616319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616325">Flags</span><span class="op" id="5616330">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616336"><a href="/debug/elf/elf.go.html#5558088">SectionFlag</a></span><span class="op" id="5616347">(</span><span class="ident" id="5616348"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616350">.</span><span class="ident" id="5616351">Flags</span><span class="op" id="5616356">)</span><span class="op" id="5616357">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616363">Offset</span><span class="op" id="5616369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616374">uint64</span><span class="op" id="5616380">(</span><span class="ident" id="5616381"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616383">.</span><span class="ident" id="5616384">Off</span><span class="op" id="5616387">)</span><span class="op" id="5616388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616394">Size</span><span class="op" id="5616398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616405">uint64</span><span class="op" id="5616411">(</span><span class="ident" id="5616412"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616414">.</span><span class="ident" id="5616415">Size</span><span class="op" id="5616419">)</span><span class="op" id="5616420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616426">Addr</span><span class="op" id="5616430">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5616437">uint64</span><span class="op" id="5616443">(</span><span class="ident" id="5616444"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616446">.</span><span class="ident" id="5616447">Addr</span><span class="op" id="5616451">)</span><span class="op" id="5616452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616458">Link</span><span class="op" id="5616462">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5616469">uint32</span><span class="op" id="5616475">(</span><span class="ident" id="5616476"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616478">.</span><span class="ident" id="5616479">Link</span><span class="op" id="5616483">)</span><span class="op" id="5616484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616490">Info</span><span class="op" id="5616494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5616501">uint32</span><span class="op" id="5616507">(</span><span class="ident" id="5616508"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616510">.</span><span class="ident" id="5616511">Info</span><span class="op" id="5616515">)</span><span class="op" id="5616516">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616522">Addralign</span><span class="op" id="5616531">:</span>&nbsp;<span class="ident" id="5616533">uint64</span><span class="op" id="5616539">(</span><span class="ident" id="5616540"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616542">.</span><span class="ident" id="5616543">Addralign</span><span class="op" id="5616552">)</span><span class="op" id="5616553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616559">Entsize</span><span class="op" id="5616566">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5616570">uint64</span><span class="op" id="5616576">(</span><span class="ident" id="5616577"><a href="/debug/elf/file.go.html#5616120">sh</a></span><span class="op" id="5616579">.</span><span class="ident" id="5616580">Entsize</span><span class="op" id="5616587">)</span><span class="op" id="5616588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616601"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5616602">.</span><span class="ident" id="5616603">sr</span>&nbsp;<span class="op" id="5616606">=</span>&nbsp;<span class="ident" id="5616608"><a href="/debug/elf/file.go.html#5607910">io</a></span><span class="op" id="5616610">.</span><span class="ident" id="5616611">NewSectionReader</span><span class="op" id="5616627">(</span><span class="ident" id="5616628"><a href="/debug/elf/file.go.html#5611874">r</a></span><span class="op" id="5616629">,</span>&nbsp;<span class="ident" id="5616631">int64</span><span class="op" id="5616636">(</span><span class="ident" id="5616637"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5616638">.</span><span class="ident" id="5616639">Offset</span><span class="op" id="5616645">)</span><span class="op" id="5616646">,</span>&nbsp;<span class="ident" id="5616648">int64</span><span class="op" id="5616653">(</span><span class="ident" id="5616654"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5616655">.</span><span class="ident" id="5616656">Size</span><span class="op" id="5616660">)</span><span class="op" id="5616661">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616665"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5616666">.</span><span class="ident" id="5616667">ReaderAt</span>&nbsp;<span class="op" id="5616676">=</span>&nbsp;<span class="ident" id="5616678"><a href="/debug/elf/file.go.html#5615564">s</a></span><span class="op" id="5616679">.</span><span class="ident" id="5616680">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616685"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5616686">.</span><span class="ident" id="5616687">Sections</span><span class="op" id="5616695">[</span><span class="ident" id="5616696"><a href="/debug/elf/file.go.html#5615466">i</a></span><span class="op" id="5616697">]</span>&nbsp;<span class="op" id="5616699">=</span>&nbsp;<span class="ident" id="5616701"><a href="/debug/elf/file.go.html#5615564">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616708">if</span>&nbsp;<span class="builtinfunc" id="5616711">len</span><span class="op" id="5616714">(</span><span class="ident" id="5616715"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5616716">.</span><span class="ident" id="5616717">Sections</span><span class="op" id="5616725">)</span>&nbsp;<span class="op" id="5616727">==</span>&nbsp;<span class="num" id="5616730">0</span>&nbsp;<span class="op" id="5616732">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616736">return</span>&nbsp;<span class="ident" id="5616743"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5616744">,</span>&nbsp;<span class="ident" id="5616746">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5616755">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616793">shstrtab</span><span class="op" id="5616801">,</span>&nbsp;<span class="ident" id="5616803">err</span>&nbsp;<span class="op" id="5616807">:=</span>&nbsp;<span class="ident" id="5616810"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5616811">.</span><span class="ident" id="5616812">Sections</span><span class="op" id="5616820">[</span><span class="ident" id="5616821"><a href="/debug/elf/file.go.html#5612964">shstrndx</a></span><span class="op" id="5616829">]</span><span class="op" id="5616830">.</span><span class="ident" id="5616831">Data</span><span class="op" id="5616835">(</span><span class="op" id="5616836">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616839">if</span>&nbsp;<span class="ident" id="5616842"><a href="/debug/elf/file.go.html#5616803">err</a></span>&nbsp;<span class="op" id="5616846">!=</span>&nbsp;<span class="ident" id="5616849">nil</span>&nbsp;<span class="op" id="5616853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616857">return</span>&nbsp;<span class="ident" id="5616864">nil</span><span class="op" id="5616867">,</span>&nbsp;<span class="ident" id="5616869"><a href="/debug/elf/file.go.html#5616803">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5616874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616877">for</span>&nbsp;<span class="ident" id="5616881">i</span><span class="op" id="5616882">,</span>&nbsp;<span class="ident" id="5616884">s</span>&nbsp;<span class="op" id="5616886">:=</span>&nbsp;<span class="keyword" id="5616889">range</span>&nbsp;<span class="ident" id="5616895"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5616896">.</span><span class="ident" id="5616897">Sections</span>&nbsp;<span class="op" id="5616906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616910">var</span>&nbsp;<span class="ident" id="5616914">ok</span>&nbsp;<span class="builtintype" id="5616917">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5616924"><a href="/debug/elf/file.go.html#5616884">s</a></span><span class="op" id="5616925">.</span><span class="ident" id="5616926">Name</span><span class="op" id="5616930">,</span>&nbsp;<span class="ident" id="5616932"><a href="/debug/elf/file.go.html#5616914">ok</a></span>&nbsp;<span class="op" id="5616935">=</span>&nbsp;<span class="ident" id="5616937"><a href="/debug/elf/file.go.html#5619897">getString</a></span><span class="op" id="5616946">(</span><span class="ident" id="5616947"><a href="/debug/elf/file.go.html#5616793">shstrtab</a></span><span class="op" id="5616955">,</span>&nbsp;<span class="builtintype" id="5616957">int</span><span class="op" id="5616960">(</span><span class="ident" id="5616961"><a href="/debug/elf/file.go.html#5615430">names</a></span><span class="op" id="5616966">[</span><span class="ident" id="5616967"><a href="/debug/elf/file.go.html#5616881">i</a></span><span class="op" id="5616968">]</span><span class="op" id="5616969">)</span><span class="op" id="5616970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616974">if</span>&nbsp;<span class="op" id="5616977">!</span><span class="ident" id="5616978"><a href="/debug/elf/file.go.html#5616914">ok</a></span>&nbsp;<span class="op" id="5616981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5616986">return</span>&nbsp;<span class="ident" id="5616993">nil</span><span class="op" id="5616996">,</span>&nbsp;<span class="op" id="5616998">&amp;</span><span class="ident" id="5616999"><a href="/debug/elf/file.go.html#5610672">FormatError</a></span><span class="op" id="5617010">{</span><span class="ident" id="5617011"><a href="/debug/elf/file.go.html#5612929">shoff</a></span>&nbsp;<span class="op" id="5617017">+</span>&nbsp;<span class="ident" id="5617019">int64</span><span class="op" id="5617024">(</span><span class="ident" id="5617025"><a href="/debug/elf/file.go.html#5616881">i</a></span><span class="op" id="5617026">*</span><span class="ident" id="5617027"><a href="/debug/elf/file.go.html#5612946">shentsize</a></span><span class="op" id="5617036">)</span><span class="op" id="5617037">,</span>&nbsp;<span class="string" id="5617039">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5617063">,</span>&nbsp;<span class="ident" id="5617065"><a href="/debug/elf/file.go.html#5615430">names</a></span><span class="op" id="5617070">[</span><span class="ident" id="5617071"><a href="/debug/elf/file.go.html#5616881">i</a></span><span class="op" id="5617072">]</span><span class="op" id="5617073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5617077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5617080">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617084">return</span>&nbsp;<span class="ident" id="5617091"><a href="/debug/elf/file.go.html#5612225">f</a></span><span class="op" id="5617092">,</span>&nbsp;<span class="ident" id="5617094">nil</span><br>
<span class="lineno"></span><span class="op" id="5617098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5617101">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5617172">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5617236">func</span>&nbsp;<span class="op" id="5617241">(</span><span class="ident" id="5617242">f</span>&nbsp;<span class="op" id="5617244">*</span><span class="ident" id="5617245"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5617249">)</span>&nbsp;<span class="ident" id="5617251">getSymbols</span><span class="op" id="5617261">(</span><span class="ident" id="5617262">typ</span>&nbsp;<span class="ident" id="5617266"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><span class="op" id="5617277">)</span>&nbsp;<span class="op" id="5617279">(</span><span class="op" id="5617280">[</span><span class="op" id="5617281">]</span><span class="ident" id="5617282"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5617288">,</span>&nbsp;<span class="op" id="5617290">[</span><span class="op" id="5617291">]</span><span class="builtintype" id="5617292">byte</span><span class="op" id="5617296">,</span>&nbsp;<span class="builtintype" id="5617298">error</span><span class="op" id="5617303">)</span>&nbsp;<span class="op" id="5617305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617308">switch</span>&nbsp;<span class="ident" id="5617315"><a href="/debug/elf/file.go.html#5617242">f</a></span><span class="op" id="5617316">.</span><span class="ident" id="5617317">Class</span>&nbsp;<span class="op" id="5617323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617326">case</span>&nbsp;<span class="ident" id="5617331"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span><span class="op" id="5617341">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617345">return</span>&nbsp;<span class="ident" id="5617352"><a href="/debug/elf/file.go.html#5617242">f</a></span><span class="op" id="5617353">.</span><span class="ident" id="5617354">getSymbols64</span><span class="op" id="5617366">(</span><span class="ident" id="5617367"><a href="/debug/elf/file.go.html#5617262">typ</a></span><span class="op" id="5617370">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617374">case</span>&nbsp;<span class="ident" id="5617379"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span><span class="op" id="5617389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617393">return</span>&nbsp;<span class="ident" id="5617400"><a href="/debug/elf/file.go.html#5617242">f</a></span><span class="op" id="5617401">.</span><span class="ident" id="5617402">getSymbols32</span><span class="op" id="5617414">(</span><span class="ident" id="5617415"><a href="/debug/elf/file.go.html#5617262">typ</a></span><span class="op" id="5617418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5617421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617425">return</span>&nbsp;<span class="ident" id="5617432">nil</span><span class="op" id="5617435">,</span>&nbsp;<span class="ident" id="5617437">nil</span><span class="op" id="5617440">,</span>&nbsp;<span class="ident" id="5617442"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5617448">.</span><span class="ident" id="5617449">New</span><span class="op" id="5617452">(</span><span class="string" id="5617453">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5617470">)</span><br>
<span class="lineno"></span><span class="op" id="5617472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5617475">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5617543">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5617587">var</span>&nbsp;<span class="ident" id="5617591">ErrNoSymbols</span>&nbsp;<span class="op" id="5617604">=</span>&nbsp;<span class="ident" id="5617606"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5617612">.</span><span class="ident" id="5617613">New</span><span class="op" id="5617616">(</span><span class="string" id="5617617">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5617636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5617639">func</span>&nbsp;<span class="op" id="5617644">(</span><span class="ident" id="5617645">f</span>&nbsp;<span class="op" id="5617647">*</span><span class="ident" id="5617648"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5617652">)</span>&nbsp;<span class="ident" id="5617654">getSymbols32</span><span class="op" id="5617666">(</span><span class="ident" id="5617667">typ</span>&nbsp;<span class="ident" id="5617671"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><span class="op" id="5617682">)</span>&nbsp;<span class="op" id="5617684">(</span><span class="op" id="5617685">[</span><span class="op" id="5617686">]</span><span class="ident" id="5617687"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5617693">,</span>&nbsp;<span class="op" id="5617695">[</span><span class="op" id="5617696">]</span><span class="builtintype" id="5617697">byte</span><span class="op" id="5617701">,</span>&nbsp;<span class="builtintype" id="5617703">error</span><span class="op" id="5617708">)</span>&nbsp;<span class="op" id="5617710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5617713">symtabSection</span>&nbsp;<span class="op" id="5617727">:=</span>&nbsp;<span class="ident" id="5617730"><a href="/debug/elf/file.go.html#5617645">f</a></span><span class="op" id="5617731">.</span><span class="ident" id="5617732">SectionByType</span><span class="op" id="5617745">(</span><span class="ident" id="5617746"><a href="/debug/elf/file.go.html#5617667">typ</a></span><span class="op" id="5617749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617752">if</span>&nbsp;<span class="ident" id="5617755"><a href="/debug/elf/file.go.html#5617713">symtabSection</a></span>&nbsp;<span class="op" id="5617769">==</span>&nbsp;<span class="ident" id="5617772">nil</span>&nbsp;<span class="op" id="5617776">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617780">return</span>&nbsp;<span class="ident" id="5617787">nil</span><span class="op" id="5617790">,</span>&nbsp;<span class="ident" id="5617792">nil</span><span class="op" id="5617795">,</span>&nbsp;<span class="ident" id="5617797"><a href="/debug/elf/file.go.html#5617591">ErrNoSymbols</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5617811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5617815">data</span><span class="op" id="5617819">,</span>&nbsp;<span class="ident" id="5617821">err</span>&nbsp;<span class="op" id="5617825">:=</span>&nbsp;<span class="ident" id="5617828"><a href="/debug/elf/file.go.html#5617713">symtabSection</a></span><span class="op" id="5617841">.</span><span class="ident" id="5617842">Data</span><span class="op" id="5617846">(</span><span class="op" id="5617847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617850">if</span>&nbsp;<span class="ident" id="5617853"><a href="/debug/elf/file.go.html#5617821">err</a></span>&nbsp;<span class="op" id="5617857">!=</span>&nbsp;<span class="ident" id="5617860">nil</span>&nbsp;<span class="op" id="5617864">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617868">return</span>&nbsp;<span class="ident" id="5617875">nil</span><span class="op" id="5617878">,</span>&nbsp;<span class="ident" id="5617880">nil</span><span class="op" id="5617883">,</span>&nbsp;<span class="ident" id="5617885"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5617891">.</span><span class="ident" id="5617892">New</span><span class="op" id="5617895">(</span><span class="string" id="5617896">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5617924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5617927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5617930">symtab</span>&nbsp;<span class="op" id="5617937">:=</span>&nbsp;<span class="ident" id="5617940"><a href="/debug/elf/file.go.html#5607850">bytes</a></span><span class="op" id="5617945">.</span><span class="ident" id="5617946">NewReader</span><span class="op" id="5617955">(</span><span class="ident" id="5617956"><a href="/debug/elf/file.go.html#5617815">data</a></span><span class="op" id="5617960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617963">if</span>&nbsp;<span class="ident" id="5617966"><a href="/debug/elf/file.go.html#5617930">symtab</a></span><span class="op" id="5617972">.</span><span class="ident" id="5617973">Len</span><span class="op" id="5617976">(</span><span class="op" id="5617977">)</span><span class="op" id="5617978">%</span><span class="ident" id="5617979"><a href="/debug/elf/elf.go.html#5603419">Sym32Size</a></span>&nbsp;<span class="op" id="5617989">!=</span>&nbsp;<span class="num" id="5617992">0</span>&nbsp;<span class="op" id="5617994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5617998">return</span>&nbsp;<span class="ident" id="5618005">nil</span><span class="op" id="5618008">,</span>&nbsp;<span class="ident" id="5618010">nil</span><span class="op" id="5618013">,</span>&nbsp;<span class="ident" id="5618015"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5618021">.</span><span class="ident" id="5618022">New</span><span class="op" id="5618025">(</span><span class="string" id="5618026">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5618081">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5618084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618088">strdata</span><span class="op" id="5618095">,</span>&nbsp;<span class="ident" id="5618097"><a href="/debug/elf/file.go.html#5617821">err</a></span>&nbsp;<span class="op" id="5618101">:=</span>&nbsp;<span class="ident" id="5618104"><a href="/debug/elf/file.go.html#5617645">f</a></span><span class="op" id="5618105">.</span><span class="ident" id="5618106">stringTable</span><span class="op" id="5618117">(</span><span class="ident" id="5618118"><a href="/debug/elf/file.go.html#5617713">symtabSection</a></span><span class="op" id="5618131">.</span><span class="ident" id="5618132">Link</span><span class="op" id="5618136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618139">if</span>&nbsp;<span class="ident" id="5618142"><a href="/debug/elf/file.go.html#5617821">err</a></span>&nbsp;<span class="op" id="5618146">!=</span>&nbsp;<span class="ident" id="5618149">nil</span>&nbsp;<span class="op" id="5618153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618157">return</span>&nbsp;<span class="ident" id="5618164">nil</span><span class="op" id="5618167">,</span>&nbsp;<span class="ident" id="5618169">nil</span><span class="op" id="5618172">,</span>&nbsp;<span class="ident" id="5618174"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5618180">.</span><span class="ident" id="5618181">New</span><span class="op" id="5618184">(</span><span class="string" id="5618185">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5618219">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5618222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5618226">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618260">var</span>&nbsp;<span class="ident" id="5618264">skip</span>&nbsp;<span class="op" id="5618269">[</span><span class="ident" id="5618270"><a href="/debug/elf/elf.go.html#5603419">Sym32Size</a></span><span class="op" id="5618279">]</span><span class="builtintype" id="5618280">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618286"><a href="/debug/elf/file.go.html#5617930">symtab</a></span><span class="op" id="5618292">.</span><span class="ident" id="5618293">Read</span><span class="op" id="5618297">(</span><span class="ident" id="5618298"><a href="/debug/elf/file.go.html#5618264">skip</a></span><span class="op" id="5618302">[</span><span class="op" id="5618303">:</span><span class="op" id="5618304">]</span><span class="op" id="5618305">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618309">symbols</span>&nbsp;<span class="op" id="5618317">:=</span>&nbsp;<span class="builtinfunc" id="5618320">make</span><span class="op" id="5618324">(</span><span class="op" id="5618325">[</span><span class="op" id="5618326">]</span><span class="ident" id="5618327"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5618333">,</span>&nbsp;<span class="ident" id="5618335"><a href="/debug/elf/file.go.html#5617930">symtab</a></span><span class="op" id="5618341">.</span><span class="ident" id="5618342">Len</span><span class="op" id="5618345">(</span><span class="op" id="5618346">)</span><span class="op" id="5618347">/</span><span class="ident" id="5618348"><a href="/debug/elf/elf.go.html#5603419">Sym32Size</a></span><span class="op" id="5618357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618361">i</span>&nbsp;<span class="op" id="5618363">:=</span>&nbsp;<span class="num" id="5618366">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618369">var</span>&nbsp;<span class="ident" id="5618373">sym</span>&nbsp;<span class="ident" id="5618377"><a href="/debug/elf/elf.go.html#5603313">Sym32</a></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618384">for</span>&nbsp;<span class="ident" id="5618388"><a href="/debug/elf/file.go.html#5617930">symtab</a></span><span class="op" id="5618394">.</span><span class="ident" id="5618395">Len</span><span class="op" id="5618398">(</span><span class="op" id="5618399">)</span>&nbsp;<span class="op" id="5618401">&gt;</span>&nbsp;<span class="num" id="5618403">0</span>&nbsp;<span class="op" id="5618405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618409"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5618415">.</span><span class="ident" id="5618416">Read</span><span class="op" id="5618420">(</span><span class="ident" id="5618421"><a href="/debug/elf/file.go.html#5617930">symtab</a></span><span class="op" id="5618427">,</span>&nbsp;<span class="ident" id="5618429"><a href="/debug/elf/file.go.html#5617645">f</a></span><span class="op" id="5618430">.</span><span class="ident" id="5618431">ByteOrder</span><span class="op" id="5618440">,</span>&nbsp;<span class="op" id="5618442">&amp;</span><span class="ident" id="5618443"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618450">str</span><span class="op" id="5618453">,</span>&nbsp;<span class="ident" id="5618455">_</span>&nbsp;<span class="op" id="5618457">:=</span>&nbsp;<span class="ident" id="5618460"><a href="/debug/elf/file.go.html#5619897">getString</a></span><span class="op" id="5618469">(</span><span class="ident" id="5618470"><a href="/debug/elf/file.go.html#5618088">strdata</a></span><span class="op" id="5618477">,</span>&nbsp;<span class="builtintype" id="5618479">int</span><span class="op" id="5618482">(</span><span class="ident" id="5618483"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618486">.</span><span class="ident" id="5618487">Name</span><span class="op" id="5618491">)</span><span class="op" id="5618492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618496"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618503">[</span><span class="ident" id="5618504"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618505">]</span><span class="op" id="5618506">.</span><span class="ident" id="5618507">Name</span>&nbsp;<span class="op" id="5618512">=</span>&nbsp;<span class="ident" id="5618514"><a href="/debug/elf/file.go.html#5618450">str</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618520"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618527">[</span><span class="ident" id="5618528"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618529">]</span><span class="op" id="5618530">.</span><span class="ident" id="5618531">Info</span>&nbsp;<span class="op" id="5618536">=</span>&nbsp;<span class="ident" id="5618538"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618541">.</span><span class="ident" id="5618542">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618549"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618556">[</span><span class="ident" id="5618557"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618558">]</span><span class="op" id="5618559">.</span><span class="ident" id="5618560">Other</span>&nbsp;<span class="op" id="5618566">=</span>&nbsp;<span class="ident" id="5618568"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618571">.</span><span class="ident" id="5618572">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618580"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618587">[</span><span class="ident" id="5618588"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618589">]</span><span class="op" id="5618590">.</span><span class="ident" id="5618591">Section</span>&nbsp;<span class="op" id="5618599">=</span>&nbsp;<span class="ident" id="5618601"><a href="/debug/elf/elf.go.html#5553812">SectionIndex</a></span><span class="op" id="5618613">(</span><span class="ident" id="5618614"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618617">.</span><span class="ident" id="5618618">Shndx</span><span class="op" id="5618623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618627"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618634">[</span><span class="ident" id="5618635"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618636">]</span><span class="op" id="5618637">.</span><span class="ident" id="5618638">Value</span>&nbsp;<span class="op" id="5618644">=</span>&nbsp;<span class="ident" id="5618646">uint64</span><span class="op" id="5618652">(</span><span class="ident" id="5618653"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618656">.</span><span class="ident" id="5618657">Value</span><span class="op" id="5618662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618666"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618673">[</span><span class="ident" id="5618674"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618675">]</span><span class="op" id="5618676">.</span><span class="ident" id="5618677">Size</span>&nbsp;<span class="op" id="5618682">=</span>&nbsp;<span class="ident" id="5618684">uint64</span><span class="op" id="5618690">(</span><span class="ident" id="5618691"><a href="/debug/elf/file.go.html#5618373">sym</a></span><span class="op" id="5618694">.</span><span class="ident" id="5618695">Size</span><span class="op" id="5618699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618703"><a href="/debug/elf/file.go.html#5618361">i</a></span><span class="op" id="5618704">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5618708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618712">return</span>&nbsp;<span class="ident" id="5618719"><a href="/debug/elf/file.go.html#5618309">symbols</a></span><span class="op" id="5618726">,</span>&nbsp;<span class="ident" id="5618728"><a href="/debug/elf/file.go.html#5618088">strdata</a></span><span class="op" id="5618735">,</span>&nbsp;<span class="ident" id="5618737">nil</span><br>
<span class="lineno"></span><span class="op" id="5618741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5618744">func</span>&nbsp;<span class="op" id="5618749">(</span><span class="ident" id="5618750">f</span>&nbsp;<span class="op" id="5618752">*</span><span class="ident" id="5618753"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5618757">)</span>&nbsp;<span class="ident" id="5618759">getSymbols64</span><span class="op" id="5618771">(</span><span class="ident" id="5618772">typ</span>&nbsp;<span class="ident" id="5618776"><a href="/debug/elf/elf.go.html#5554908">SectionType</a></span><span class="op" id="5618787">)</span>&nbsp;<span class="op" id="5618789">(</span><span class="op" id="5618790">[</span><span class="op" id="5618791">]</span><span class="ident" id="5618792"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5618798">,</span>&nbsp;<span class="op" id="5618800">[</span><span class="op" id="5618801">]</span><span class="builtintype" id="5618802">byte</span><span class="op" id="5618806">,</span>&nbsp;<span class="builtintype" id="5618808">error</span><span class="op" id="5618813">)</span>&nbsp;<span class="op" id="5618815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618818">symtabSection</span>&nbsp;<span class="op" id="5618832">:=</span>&nbsp;<span class="ident" id="5618835"><a href="/debug/elf/file.go.html#5618750">f</a></span><span class="op" id="5618836">.</span><span class="ident" id="5618837">SectionByType</span><span class="op" id="5618850">(</span><span class="ident" id="5618851"><a href="/debug/elf/file.go.html#5618772">typ</a></span><span class="op" id="5618854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618857">if</span>&nbsp;<span class="ident" id="5618860"><a href="/debug/elf/file.go.html#5618818">symtabSection</a></span>&nbsp;<span class="op" id="5618874">==</span>&nbsp;<span class="ident" id="5618877">nil</span>&nbsp;<span class="op" id="5618881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618885">return</span>&nbsp;<span class="ident" id="5618892">nil</span><span class="op" id="5618895">,</span>&nbsp;<span class="ident" id="5618897">nil</span><span class="op" id="5618900">,</span>&nbsp;<span class="ident" id="5618902"><a href="/debug/elf/file.go.html#5617591">ErrNoSymbols</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5618916">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5618920">data</span><span class="op" id="5618924">,</span>&nbsp;<span class="ident" id="5618926">err</span>&nbsp;<span class="op" id="5618930">:=</span>&nbsp;<span class="ident" id="5618933"><a href="/debug/elf/file.go.html#5618818">symtabSection</a></span><span class="op" id="5618946">.</span><span class="ident" id="5618947">Data</span><span class="op" id="5618951">(</span><span class="op" id="5618952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618955">if</span>&nbsp;<span class="ident" id="5618958"><a href="/debug/elf/file.go.html#5618926">err</a></span>&nbsp;<span class="op" id="5618962">!=</span>&nbsp;<span class="ident" id="5618965">nil</span>&nbsp;<span class="op" id="5618969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5618973">return</span>&nbsp;<span class="ident" id="5618980">nil</span><span class="op" id="5618983">,</span>&nbsp;<span class="ident" id="5618985">nil</span><span class="op" id="5618988">,</span>&nbsp;<span class="ident" id="5618990"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5618996">.</span><span class="ident" id="5618997">New</span><span class="op" id="5619000">(</span><span class="string" id="5619001">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5619029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5619032">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619035">symtab</span>&nbsp;<span class="op" id="5619042">:=</span>&nbsp;<span class="ident" id="5619045"><a href="/debug/elf/file.go.html#5607850">bytes</a></span><span class="op" id="5619050">.</span><span class="ident" id="5619051">NewReader</span><span class="op" id="5619060">(</span><span class="ident" id="5619061"><a href="/debug/elf/file.go.html#5618920">data</a></span><span class="op" id="5619065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619068">if</span>&nbsp;<span class="ident" id="5619071"><a href="/debug/elf/file.go.html#5619035">symtab</a></span><span class="op" id="5619077">.</span><span class="ident" id="5619078">Len</span><span class="op" id="5619081">(</span><span class="op" id="5619082">)</span><span class="op" id="5619083">%</span><span class="ident" id="5619084"><a href="/debug/elf/elf.go.html#5606688">Sym64Size</a></span>&nbsp;<span class="op" id="5619094">!=</span>&nbsp;<span class="num" id="5619097">0</span>&nbsp;<span class="op" id="5619099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619103">return</span>&nbsp;<span class="ident" id="5619110">nil</span><span class="op" id="5619113">,</span>&nbsp;<span class="ident" id="5619115">nil</span><span class="op" id="5619118">,</span>&nbsp;<span class="ident" id="5619120"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5619126">.</span><span class="ident" id="5619127">New</span><span class="op" id="5619130">(</span><span class="string" id="5619131">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5619188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5619191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619195">strdata</span><span class="op" id="5619202">,</span>&nbsp;<span class="ident" id="5619204"><a href="/debug/elf/file.go.html#5618926">err</a></span>&nbsp;<span class="op" id="5619208">:=</span>&nbsp;<span class="ident" id="5619211"><a href="/debug/elf/file.go.html#5618750">f</a></span><span class="op" id="5619212">.</span><span class="ident" id="5619213">stringTable</span><span class="op" id="5619224">(</span><span class="ident" id="5619225"><a href="/debug/elf/file.go.html#5618818">symtabSection</a></span><span class="op" id="5619238">.</span><span class="ident" id="5619239">Link</span><span class="op" id="5619243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619246">if</span>&nbsp;<span class="ident" id="5619249"><a href="/debug/elf/file.go.html#5618926">err</a></span>&nbsp;<span class="op" id="5619253">!=</span>&nbsp;<span class="ident" id="5619256">nil</span>&nbsp;<span class="op" id="5619260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619264">return</span>&nbsp;<span class="ident" id="5619271">nil</span><span class="op" id="5619274">,</span>&nbsp;<span class="ident" id="5619276">nil</span><span class="op" id="5619279">,</span>&nbsp;<span class="ident" id="5619281"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5619287">.</span><span class="ident" id="5619288">New</span><span class="op" id="5619291">(</span><span class="string" id="5619292">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5619326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5619329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5619333">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619367">var</span>&nbsp;<span class="ident" id="5619371">skip</span>&nbsp;<span class="op" id="5619376">[</span><span class="ident" id="5619377"><a href="/debug/elf/elf.go.html#5606688">Sym64Size</a></span><span class="op" id="5619386">]</span><span class="builtintype" id="5619387">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619393"><a href="/debug/elf/file.go.html#5619035">symtab</a></span><span class="op" id="5619399">.</span><span class="ident" id="5619400">Read</span><span class="op" id="5619404">(</span><span class="ident" id="5619405"><a href="/debug/elf/file.go.html#5619371">skip</a></span><span class="op" id="5619409">[</span><span class="op" id="5619410">:</span><span class="op" id="5619411">]</span><span class="op" id="5619412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619416">symbols</span>&nbsp;<span class="op" id="5619424">:=</span>&nbsp;<span class="builtinfunc" id="5619427">make</span><span class="op" id="5619431">(</span><span class="op" id="5619432">[</span><span class="op" id="5619433">]</span><span class="ident" id="5619434"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5619440">,</span>&nbsp;<span class="ident" id="5619442"><a href="/debug/elf/file.go.html#5619035">symtab</a></span><span class="op" id="5619448">.</span><span class="ident" id="5619449">Len</span><span class="op" id="5619452">(</span><span class="op" id="5619453">)</span><span class="op" id="5619454">/</span><span class="ident" id="5619455"><a href="/debug/elf/elf.go.html#5606688">Sym64Size</a></span><span class="op" id="5619464">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619468">i</span>&nbsp;<span class="op" id="5619470">:=</span>&nbsp;<span class="num" id="5619473">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619476">var</span>&nbsp;<span class="ident" id="5619480">sym</span>&nbsp;<span class="ident" id="5619484"><a href="/debug/elf/elf.go.html#5606399">Sym64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619491">for</span>&nbsp;<span class="ident" id="5619495"><a href="/debug/elf/file.go.html#5619035">symtab</a></span><span class="op" id="5619501">.</span><span class="ident" id="5619502">Len</span><span class="op" id="5619505">(</span><span class="op" id="5619506">)</span>&nbsp;<span class="op" id="5619508">&gt;</span>&nbsp;<span class="num" id="5619510">0</span>&nbsp;<span class="op" id="5619512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619516"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5619522">.</span><span class="ident" id="5619523">Read</span><span class="op" id="5619527">(</span><span class="ident" id="5619528"><a href="/debug/elf/file.go.html#5619035">symtab</a></span><span class="op" id="5619534">,</span>&nbsp;<span class="ident" id="5619536"><a href="/debug/elf/file.go.html#5618750">f</a></span><span class="op" id="5619537">.</span><span class="ident" id="5619538">ByteOrder</span><span class="op" id="5619547">,</span>&nbsp;<span class="op" id="5619549">&amp;</span><span class="ident" id="5619550"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619553">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619557">str</span><span class="op" id="5619560">,</span>&nbsp;<span class="ident" id="5619562">_</span>&nbsp;<span class="op" id="5619564">:=</span>&nbsp;<span class="ident" id="5619567"><a href="/debug/elf/file.go.html#5619897">getString</a></span><span class="op" id="5619576">(</span><span class="ident" id="5619577"><a href="/debug/elf/file.go.html#5619195">strdata</a></span><span class="op" id="5619584">,</span>&nbsp;<span class="builtintype" id="5619586">int</span><span class="op" id="5619589">(</span><span class="ident" id="5619590"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619593">.</span><span class="ident" id="5619594">Name</span><span class="op" id="5619598">)</span><span class="op" id="5619599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619603"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619610">[</span><span class="ident" id="5619611"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619612">]</span><span class="op" id="5619613">.</span><span class="ident" id="5619614">Name</span>&nbsp;<span class="op" id="5619619">=</span>&nbsp;<span class="ident" id="5619621"><a href="/debug/elf/file.go.html#5619557">str</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619627"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619634">[</span><span class="ident" id="5619635"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619636">]</span><span class="op" id="5619637">.</span><span class="ident" id="5619638">Info</span>&nbsp;<span class="op" id="5619643">=</span>&nbsp;<span class="ident" id="5619645"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619648">.</span><span class="ident" id="5619649">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619656"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619663">[</span><span class="ident" id="5619664"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619665">]</span><span class="op" id="5619666">.</span><span class="ident" id="5619667">Other</span>&nbsp;<span class="op" id="5619673">=</span>&nbsp;<span class="ident" id="5619675"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619678">.</span><span class="ident" id="5619679">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619687"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619694">[</span><span class="ident" id="5619695"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619696">]</span><span class="op" id="5619697">.</span><span class="ident" id="5619698">Section</span>&nbsp;<span class="op" id="5619706">=</span>&nbsp;<span class="ident" id="5619708"><a href="/debug/elf/elf.go.html#5553812">SectionIndex</a></span><span class="op" id="5619720">(</span><span class="ident" id="5619721"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619724">.</span><span class="ident" id="5619725">Shndx</span><span class="op" id="5619730">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619734"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619741">[</span><span class="ident" id="5619742"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619743">]</span><span class="op" id="5619744">.</span><span class="ident" id="5619745">Value</span>&nbsp;<span class="op" id="5619751">=</span>&nbsp;<span class="ident" id="5619753"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619756">.</span><span class="ident" id="5619757">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619765"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619772">[</span><span class="ident" id="5619773"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619774">]</span><span class="op" id="5619775">.</span><span class="ident" id="5619776">Size</span>&nbsp;<span class="op" id="5619781">=</span>&nbsp;<span class="ident" id="5619783"><a href="/debug/elf/file.go.html#5619480">sym</a></span><span class="op" id="5619786">.</span><span class="ident" id="5619787">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5619794"><a href="/debug/elf/file.go.html#5619468">i</a></span><span class="op" id="5619795">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5619799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619803">return</span>&nbsp;<span class="ident" id="5619810"><a href="/debug/elf/file.go.html#5619416">symbols</a></span><span class="op" id="5619817">,</span>&nbsp;<span class="ident" id="5619819"><a href="/debug/elf/file.go.html#5619195">strdata</a></span><span class="op" id="5619826">,</span>&nbsp;<span class="ident" id="5619828">nil</span><br>
<span class="lineno"></span><span class="op" id="5619832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5619835">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5619892">func</span>&nbsp;<span class="ident" id="5619897">getString</span><span class="op" id="5619906">(</span><span class="ident" id="5619907">section</span>&nbsp;<span class="op" id="5619915">[</span><span class="op" id="5619916">]</span><span class="builtintype" id="5619917">byte</span><span class="op" id="5619921">,</span>&nbsp;<span class="ident" id="5619923">start</span>&nbsp;<span class="builtintype" id="5619929">int</span><span class="op" id="5619932">)</span>&nbsp;<span class="op" id="5619934">(</span><span class="builtintype" id="5619935">string</span><span class="op" id="5619941">,</span>&nbsp;<span class="builtintype" id="5619943">bool</span><span class="op" id="5619947">)</span>&nbsp;<span class="op" id="5619949">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619952">if</span>&nbsp;<span class="ident" id="5619955"><a href="/debug/elf/file.go.html#5619923">start</a></span>&nbsp;<span class="op" id="5619961">&lt;</span>&nbsp;<span class="num" id="5619963">0</span>&nbsp;<span class="op" id="5619965">||</span>&nbsp;<span class="ident" id="5619968"><a href="/debug/elf/file.go.html#5619923">start</a></span>&nbsp;<span class="op" id="5619974">&gt;=</span>&nbsp;<span class="builtinfunc" id="5619977">len</span><span class="op" id="5619980">(</span><span class="ident" id="5619981"><a href="/debug/elf/file.go.html#5619907">section</a></span><span class="op" id="5619988">)</span>&nbsp;<span class="op" id="5619990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5619994">return</span>&nbsp;<span class="string" id="5620001">&#34;&#34;</span><span class="op" id="5620003">,</span>&nbsp;<span class="builtintype" id="5620005">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620016">for</span>&nbsp;<span class="ident" id="5620020">end</span>&nbsp;<span class="op" id="5620024">:=</span>&nbsp;<span class="ident" id="5620027"><a href="/debug/elf/file.go.html#5619923">start</a></span><span class="op" id="5620032">;</span>&nbsp;<span class="ident" id="5620034"><a href="/debug/elf/file.go.html#5620020">end</a></span>&nbsp;<span class="op" id="5620038">&lt;</span>&nbsp;<span class="builtinfunc" id="5620040">len</span><span class="op" id="5620043">(</span><span class="ident" id="5620044"><a href="/debug/elf/file.go.html#5619907">section</a></span><span class="op" id="5620051">)</span><span class="op" id="5620052">;</span>&nbsp;<span class="ident" id="5620054"><a href="/debug/elf/file.go.html#5620020">end</a></span><span class="op" id="5620057">++</span>&nbsp;<span class="op" id="5620060">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620064">if</span>&nbsp;<span class="ident" id="5620067"><a href="/debug/elf/file.go.html#5619907">section</a></span><span class="op" id="5620074">[</span><span class="ident" id="5620075"><a href="/debug/elf/file.go.html#5620020">end</a></span><span class="op" id="5620078">]</span>&nbsp;<span class="op" id="5620080">==</span>&nbsp;<span class="num" id="5620083">0</span>&nbsp;<span class="op" id="5620085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620090">return</span>&nbsp;<span class="builtintype" id="5620097">string</span><span class="op" id="5620103">(</span><span class="ident" id="5620104"><a href="/debug/elf/file.go.html#5619907">section</a></span><span class="op" id="5620111">[</span><span class="ident" id="5620112"><a href="/debug/elf/file.go.html#5619923">start</a></span><span class="op" id="5620117">:</span><span class="ident" id="5620118"><a href="/debug/elf/file.go.html#5620020">end</a></span><span class="op" id="5620121">]</span><span class="op" id="5620122">)</span><span class="op" id="5620123">,</span>&nbsp;<span class="builtintype" id="5620125">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620138">return</span>&nbsp;<span class="string" id="5620145">&#34;&#34;</span><span class="op" id="5620147">,</span>&nbsp;<span class="builtintype" id="5620149">false</span><br>
<span class="lineno">510</span><span class="op" id="5620155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5620158">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5620226">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5620245">func</span>&nbsp;<span class="op" id="5620250">(</span><span class="ident" id="5620251">f</span>&nbsp;<span class="op" id="5620253">*</span><span class="ident" id="5620254"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5620258">)</span>&nbsp;<span class="ident" id="5620260">Section</span><span class="op" id="5620267">(</span><span class="ident" id="5620268">name</span>&nbsp;<span class="builtintype" id="5620273">string</span><span class="op" id="5620279">)</span>&nbsp;<span class="op" id="5620281">*</span><span class="ident" id="5620282"><a href="/debug/elf/file.go.html#5608763">Section</a></span>&nbsp;<span class="op" id="5620290">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620293">for</span>&nbsp;<span class="ident" id="5620297">_</span><span class="op" id="5620298">,</span>&nbsp;<span class="ident" id="5620300">s</span>&nbsp;<span class="op" id="5620302">:=</span>&nbsp;<span class="keyword" id="5620305">range</span>&nbsp;<span class="ident" id="5620311"><a href="/debug/elf/file.go.html#5620251">f</a></span><span class="op" id="5620312">.</span><span class="ident" id="5620313">Sections</span>&nbsp;<span class="op" id="5620322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620326">if</span>&nbsp;<span class="ident" id="5620329"><a href="/debug/elf/file.go.html#5620300">s</a></span><span class="op" id="5620330">.</span><span class="ident" id="5620331">Name</span>&nbsp;<span class="op" id="5620336">==</span>&nbsp;<span class="ident" id="5620339"><a href="/debug/elf/file.go.html#5620268">name</a></span>&nbsp;<span class="op" id="5620344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620349">return</span>&nbsp;<span class="ident" id="5620356"><a href="/debug/elf/file.go.html#5620300">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620363">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620366">return</span>&nbsp;<span class="ident" id="5620373">nil</span><br>
<span class="lineno"></span><span class="op" id="5620377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5620380">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5620458">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5620477">func</span>&nbsp;<span class="op" id="5620482">(</span><span class="ident" id="5620483">f</span>&nbsp;<span class="op" id="5620485">*</span><span class="ident" id="5620486"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5620490">)</span>&nbsp;<span class="ident" id="5620492">applyRelocations</span><span class="op" id="5620508">(</span><span class="ident" id="5620509">dst</span>&nbsp;<span class="op" id="5620513">[</span><span class="op" id="5620514">]</span><span class="builtintype" id="5620515">byte</span><span class="op" id="5620519">,</span>&nbsp;<span class="ident" id="5620521">rels</span>&nbsp;<span class="op" id="5620526">[</span><span class="op" id="5620527">]</span><span class="builtintype" id="5620528">byte</span><span class="op" id="5620532">)</span>&nbsp;<span class="builtintype" id="5620534">error</span>&nbsp;<span class="op" id="5620540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620543">if</span>&nbsp;<span class="ident" id="5620546"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620547">.</span><span class="ident" id="5620548">Class</span>&nbsp;<span class="op" id="5620554">==</span>&nbsp;<span class="ident" id="5620557"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span>&nbsp;<span class="op" id="5620568">&amp;&amp;</span>&nbsp;<span class="ident" id="5620571"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620572">.</span><span class="ident" id="5620573">Machine</span>&nbsp;<span class="op" id="5620581">==</span>&nbsp;<span class="ident" id="5620584"><a href="/debug/elf/elf.go.html#5552202">EM_X86_64</a></span>&nbsp;<span class="op" id="5620594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620598">return</span>&nbsp;<span class="ident" id="5620605"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620606">.</span><span class="ident" id="5620607">applyRelocationsAMD64</span><span class="op" id="5620628">(</span><span class="ident" id="5620629"><a href="/debug/elf/file.go.html#5620509">dst</a></span><span class="op" id="5620632">,</span>&nbsp;<span class="ident" id="5620634"><a href="/debug/elf/file.go.html#5620521">rels</a></span><span class="op" id="5620638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620644">if</span>&nbsp;<span class="ident" id="5620647"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620648">.</span><span class="ident" id="5620649">Class</span>&nbsp;<span class="op" id="5620655">==</span>&nbsp;<span class="ident" id="5620658"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span>&nbsp;<span class="op" id="5620669">&amp;&amp;</span>&nbsp;<span class="ident" id="5620672"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620673">.</span><span class="ident" id="5620674">Machine</span>&nbsp;<span class="op" id="5620682">==</span>&nbsp;<span class="ident" id="5620685"><a href="/debug/elf/elf.go.html#5550100">EM_386</a></span>&nbsp;<span class="op" id="5620692">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620696">return</span>&nbsp;<span class="ident" id="5620703"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620704">.</span><span class="ident" id="5620705">applyRelocations386</span><span class="op" id="5620724">(</span><span class="ident" id="5620725"><a href="/debug/elf/file.go.html#5620509">dst</a></span><span class="op" id="5620728">,</span>&nbsp;<span class="ident" id="5620730"><a href="/debug/elf/file.go.html#5620521">rels</a></span><span class="op" id="5620734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620740">if</span>&nbsp;<span class="ident" id="5620743"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620744">.</span><span class="ident" id="5620745">Class</span>&nbsp;<span class="op" id="5620751">==</span>&nbsp;<span class="ident" id="5620754"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span>&nbsp;<span class="op" id="5620765">&amp;&amp;</span>&nbsp;<span class="ident" id="5620768"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620769">.</span><span class="ident" id="5620770">Machine</span>&nbsp;<span class="op" id="5620778">==</span>&nbsp;<span class="ident" id="5620781"><a href="/debug/elf/elf.go.html#5552268">EM_AARCH64</a></span>&nbsp;<span class="op" id="5620792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620796">return</span>&nbsp;<span class="ident" id="5620803"><a href="/debug/elf/file.go.html#5620483">f</a></span><span class="op" id="5620804">.</span><span class="ident" id="5620805">applyRelocationsARM64</span><span class="op" id="5620826">(</span><span class="ident" id="5620827"><a href="/debug/elf/file.go.html#5620509">dst</a></span><span class="op" id="5620830">,</span>&nbsp;<span class="ident" id="5620832"><a href="/debug/elf/file.go.html#5620521">rels</a></span><span class="op" id="5620836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5620839">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620843">return</span>&nbsp;<span class="ident" id="5620850"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5620856">.</span><span class="ident" id="5620857">New</span><span class="op" id="5620860">(</span><span class="string" id="5620861">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5620878">)</span><br>
<span class="lineno"></span><span class="op" id="5620880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5620883">func</span>&nbsp;<span class="op" id="5620888">(</span><span class="ident" id="5620889">f</span>&nbsp;<span class="op" id="5620891">*</span><span class="ident" id="5620892"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5620896">)</span>&nbsp;<span class="ident" id="5620898">applyRelocationsAMD64</span><span class="op" id="5620919">(</span><span class="ident" id="5620920">dst</span>&nbsp;<span class="op" id="5620924">[</span><span class="op" id="5620925">]</span><span class="builtintype" id="5620926">byte</span><span class="op" id="5620930">,</span>&nbsp;<span class="ident" id="5620932">rels</span>&nbsp;<span class="op" id="5620937">[</span><span class="op" id="5620938">]</span><span class="builtintype" id="5620939">byte</span><span class="op" id="5620943">)</span>&nbsp;<span class="builtintype" id="5620945">error</span>&nbsp;<span class="op" id="5620951">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5620954">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5620984">if</span>&nbsp;<span class="builtinfunc" id="5620987">len</span><span class="op" id="5620990">(</span><span class="ident" id="5620991"><a href="/debug/elf/file.go.html#5620932">rels</a></span><span class="op" id="5620995">)</span><span class="op" id="5620996">%</span><span class="num" id="5620997">24</span>&nbsp;<span class="op" id="5621000">!=</span>&nbsp;<span class="num" id="5621003">0</span>&nbsp;<span class="op" id="5621005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621009">return</span>&nbsp;<span class="ident" id="5621016"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5621022">.</span><span class="ident" id="5621023">New</span><span class="op" id="5621026">(</span><span class="string" id="5621027">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5621081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5621084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621088">symbols</span><span class="op" id="5621095">,</span>&nbsp;<span class="ident" id="5621097">_</span><span class="op" id="5621098">,</span>&nbsp;<span class="ident" id="5621100">err</span>&nbsp;<span class="op" id="5621104">:=</span>&nbsp;<span class="ident" id="5621107"><a href="/debug/elf/file.go.html#5620889">f</a></span><span class="op" id="5621108">.</span><span class="ident" id="5621109">getSymbols</span><span class="op" id="5621119">(</span><span class="ident" id="5621120"><a href="/debug/elf/elf.go.html#5555076">SHT_SYMTAB</a></span><span class="op" id="5621130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621133">if</span>&nbsp;<span class="ident" id="5621136"><a href="/debug/elf/file.go.html#5621100">err</a></span>&nbsp;<span class="op" id="5621140">!=</span>&nbsp;<span class="ident" id="5621143">nil</span>&nbsp;<span class="op" id="5621147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621151">return</span>&nbsp;<span class="ident" id="5621158"><a href="/debug/elf/file.go.html#5621100">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5621163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621167">b</span>&nbsp;<span class="op" id="5621169">:=</span>&nbsp;<span class="ident" id="5621172"><a href="/debug/elf/file.go.html#5607850">bytes</a></span><span class="op" id="5621177">.</span><span class="ident" id="5621178">NewReader</span><span class="op" id="5621187">(</span><span class="ident" id="5621188"><a href="/debug/elf/file.go.html#5620932">rels</a></span><span class="op" id="5621192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621195">var</span>&nbsp;<span class="ident" id="5621199">rela</span>&nbsp;<span class="ident" id="5621204"><a href="/debug/elf/elf.go.html#5606009">Rela64</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621213">for</span>&nbsp;<span class="ident" id="5621217"><a href="/debug/elf/file.go.html#5621167">b</a></span><span class="op" id="5621218">.</span><span class="ident" id="5621219">Len</span><span class="op" id="5621222">(</span><span class="op" id="5621223">)</span>&nbsp;<span class="op" id="5621225">&gt;</span>&nbsp;<span class="num" id="5621227">0</span>&nbsp;<span class="op" id="5621229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621233"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5621239">.</span><span class="ident" id="5621240">Read</span><span class="op" id="5621244">(</span><span class="ident" id="5621245"><a href="/debug/elf/file.go.html#5621167">b</a></span><span class="op" id="5621246">,</span>&nbsp;<span class="ident" id="5621248"><a href="/debug/elf/file.go.html#5620889">f</a></span><span class="op" id="5621249">.</span><span class="ident" id="5621250">ByteOrder</span><span class="op" id="5621259">,</span>&nbsp;<span class="op" id="5621261">&amp;</span><span class="ident" id="5621262"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621266">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621270">symNo</span>&nbsp;<span class="op" id="5621276">:=</span>&nbsp;<span class="ident" id="5621279"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621283">.</span><span class="ident" id="5621284">Info</span>&nbsp;<span class="op" id="5621289">&gt;&gt;</span>&nbsp;<span class="num" id="5621292">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621297">t</span>&nbsp;<span class="op" id="5621299">:=</span>&nbsp;<span class="ident" id="5621302"><a href="/debug/elf/elf.go.html#5569697">R_X86_64</a></span><span class="op" id="5621310">(</span><span class="ident" id="5621311"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621315">.</span><span class="ident" id="5621316">Info</span>&nbsp;<span class="op" id="5621321">&amp;</span>&nbsp;<span class="num" id="5621323">0xffff</span><span class="op" id="5621329">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621334">if</span>&nbsp;<span class="ident" id="5621337"><a href="/debug/elf/file.go.html#5621270">symNo</a></span>&nbsp;<span class="op" id="5621343">==</span>&nbsp;<span class="num" id="5621346">0</span>&nbsp;<span class="op" id="5621348">||</span>&nbsp;<span class="ident" id="5621351"><a href="/debug/elf/file.go.html#5621270">symNo</a></span>&nbsp;<span class="op" id="5621357">&gt;</span>&nbsp;<span class="ident" id="5621359">uint64</span><span class="op" id="5621365">(</span><span class="builtinfunc" id="5621366">len</span><span class="op" id="5621369">(</span><span class="ident" id="5621370"><a href="/debug/elf/file.go.html#5621088">symbols</a></span><span class="op" id="5621377">)</span><span class="op" id="5621378">)</span>&nbsp;<span class="op" id="5621380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621385">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5621396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621400">sym</span>&nbsp;<span class="op" id="5621404">:=</span>&nbsp;<span class="op" id="5621407">&amp;</span><span class="ident" id="5621408"><a href="/debug/elf/file.go.html#5621088">symbols</a></span><span class="op" id="5621415">[</span><span class="ident" id="5621416"><a href="/debug/elf/file.go.html#5621270">symNo</a></span><span class="op" id="5621421">-</span><span class="num" id="5621422">1</span><span class="op" id="5621423">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621427">if</span>&nbsp;<span class="ident" id="5621430"><a href="/debug/elf/elf.go.html#5567990">SymType</a></span><span class="op" id="5621437">(</span><span class="ident" id="5621438"><a href="/debug/elf/file.go.html#5621400">sym</a></span><span class="op" id="5621441">.</span><span class="ident" id="5621442">Info</span><span class="op" id="5621446">&amp;</span><span class="num" id="5621447">0xf</span><span class="op" id="5621450">)</span>&nbsp;<span class="op" id="5621452">!=</span>&nbsp;<span class="ident" id="5621455"><a href="/debug/elf/elf.go.html#5568149">STT_SECTION</a></span>&nbsp;<span class="op" id="5621467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5621472">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621527">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5621538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5621543">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5621596">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5621651">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621698">switch</span>&nbsp;<span class="ident" id="5621705"><a href="/debug/elf/file.go.html#5621297">t</a></span>&nbsp;<span class="op" id="5621707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621711">case</span>&nbsp;<span class="ident" id="5621716"><a href="/debug/elf/elf.go.html#5569774">R_X86_64_64</a></span><span class="op" id="5621727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621732">if</span>&nbsp;<span class="ident" id="5621735"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621739">.</span><span class="ident" id="5621740">Off</span><span class="op" id="5621743">+</span><span class="num" id="5621744">8</span>&nbsp;<span class="op" id="5621746">&gt;=</span>&nbsp;<span class="ident" id="5621749">uint64</span><span class="op" id="5621755">(</span><span class="builtinfunc" id="5621756">len</span><span class="op" id="5621759">(</span><span class="ident" id="5621760"><a href="/debug/elf/file.go.html#5620920">dst</a></span><span class="op" id="5621763">)</span><span class="op" id="5621764">)</span>&nbsp;<span class="op" id="5621766">||</span>&nbsp;<span class="ident" id="5621769"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621773">.</span><span class="ident" id="5621774">Addend</span>&nbsp;<span class="op" id="5621781">&lt;</span>&nbsp;<span class="num" id="5621783">0</span>&nbsp;<span class="op" id="5621785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621791">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5621803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621808"><a href="/debug/elf/file.go.html#5620889">f</a></span><span class="op" id="5621809">.</span><span class="ident" id="5621810">ByteOrder</span><span class="op" id="5621819">.</span><span class="ident" id="5621820">PutUint64</span><span class="op" id="5621829">(</span><span class="ident" id="5621830"><a href="/debug/elf/file.go.html#5620920">dst</a></span><span class="op" id="5621833">[</span><span class="ident" id="5621834"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621838">.</span><span class="ident" id="5621839">Off</span><span class="op" id="5621842">:</span><span class="ident" id="5621843"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621847">.</span><span class="ident" id="5621848">Off</span><span class="op" id="5621851">+</span><span class="num" id="5621852">8</span><span class="op" id="5621853">]</span><span class="op" id="5621854">,</span>&nbsp;<span class="ident" id="5621856">uint64</span><span class="op" id="5621862">(</span><span class="ident" id="5621863"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621867">.</span><span class="ident" id="5621868">Addend</span><span class="op" id="5621874">)</span><span class="op" id="5621875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621879">case</span>&nbsp;<span class="ident" id="5621884"><a href="/debug/elf/elf.go.html#5570415">R_X86_64_32</a></span><span class="op" id="5621895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621900">if</span>&nbsp;<span class="ident" id="5621903"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621907">.</span><span class="ident" id="5621908">Off</span><span class="op" id="5621911">+</span><span class="num" id="5621912">4</span>&nbsp;<span class="op" id="5621914">&gt;=</span>&nbsp;<span class="ident" id="5621917">uint64</span><span class="op" id="5621923">(</span><span class="builtinfunc" id="5621924">len</span><span class="op" id="5621927">(</span><span class="ident" id="5621928"><a href="/debug/elf/file.go.html#5620920">dst</a></span><span class="op" id="5621931">)</span><span class="op" id="5621932">)</span>&nbsp;<span class="op" id="5621934">||</span>&nbsp;<span class="ident" id="5621937"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5621941">.</span><span class="ident" id="5621942">Addend</span>&nbsp;<span class="op" id="5621949">&lt;</span>&nbsp;<span class="num" id="5621951">0</span>&nbsp;<span class="op" id="5621953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5621959">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5621971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5621976"><a href="/debug/elf/file.go.html#5620889">f</a></span><span class="op" id="5621977">.</span><span class="ident" id="5621978">ByteOrder</span><span class="op" id="5621987">.</span><span class="ident" id="5621988">PutUint32</span><span class="op" id="5621997">(</span><span class="ident" id="5621998"><a href="/debug/elf/file.go.html#5620920">dst</a></span><span class="op" id="5622001">[</span><span class="ident" id="5622002"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5622006">.</span><span class="ident" id="5622007">Off</span><span class="op" id="5622010">:</span><span class="ident" id="5622011"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5622015">.</span><span class="ident" id="5622016">Off</span><span class="op" id="5622019">+</span><span class="num" id="5622020">4</span><span class="op" id="5622021">]</span><span class="op" id="5622022">,</span>&nbsp;<span class="builtintype" id="5622024">uint32</span><span class="op" id="5622030">(</span><span class="ident" id="5622031"><a href="/debug/elf/file.go.html#5621199">rela</a></span><span class="op" id="5622035">.</span><span class="ident" id="5622036">Addend</span><span class="op" id="5622042">)</span><span class="op" id="5622043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622054">return</span>&nbsp;<span class="ident" id="5622061">nil</span><br>
<span class="lineno"></span><span class="op" id="5622065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5622068">func</span>&nbsp;<span class="op" id="5622073">(</span><span class="ident" id="5622074">f</span>&nbsp;<span class="op" id="5622076">*</span><span class="ident" id="5622077"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5622081">)</span>&nbsp;<span class="ident" id="5622083">applyRelocations386</span><span class="op" id="5622102">(</span><span class="ident" id="5622103">dst</span>&nbsp;<span class="op" id="5622107">[</span><span class="op" id="5622108">]</span><span class="builtintype" id="5622109">byte</span><span class="op" id="5622113">,</span>&nbsp;<span class="ident" id="5622115">rels</span>&nbsp;<span class="op" id="5622120">[</span><span class="op" id="5622121">]</span><span class="builtintype" id="5622122">byte</span><span class="op" id="5622126">)</span>&nbsp;<span class="builtintype" id="5622128">error</span>&nbsp;<span class="op" id="5622134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5622137">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622165">if</span>&nbsp;<span class="builtinfunc" id="5622168">len</span><span class="op" id="5622171">(</span><span class="ident" id="5622172"><a href="/debug/elf/file.go.html#5622115">rels</a></span><span class="op" id="5622176">)</span><span class="op" id="5622177">%</span><span class="num" id="5622178">8</span>&nbsp;<span class="op" id="5622180">!=</span>&nbsp;<span class="num" id="5622183">0</span>&nbsp;<span class="op" id="5622185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622189">return</span>&nbsp;<span class="ident" id="5622196"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5622202">.</span><span class="ident" id="5622203">New</span><span class="op" id="5622206">(</span><span class="string" id="5622207">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5622260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622267">symbols</span><span class="op" id="5622274">,</span>&nbsp;<span class="ident" id="5622276">_</span><span class="op" id="5622277">,</span>&nbsp;<span class="ident" id="5622279">err</span>&nbsp;<span class="op" id="5622283">:=</span>&nbsp;<span class="ident" id="5622286"><a href="/debug/elf/file.go.html#5622074">f</a></span><span class="op" id="5622287">.</span><span class="ident" id="5622288">getSymbols</span><span class="op" id="5622298">(</span><span class="ident" id="5622299"><a href="/debug/elf/elf.go.html#5555076">SHT_SYMTAB</a></span><span class="op" id="5622309">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622312">if</span>&nbsp;<span class="ident" id="5622315"><a href="/debug/elf/file.go.html#5622279">err</a></span>&nbsp;<span class="op" id="5622319">!=</span>&nbsp;<span class="ident" id="5622322">nil</span>&nbsp;<span class="op" id="5622326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622330">return</span>&nbsp;<span class="ident" id="5622337"><a href="/debug/elf/file.go.html#5622279">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622346">b</span>&nbsp;<span class="op" id="5622348">:=</span>&nbsp;<span class="ident" id="5622351"><a href="/debug/elf/file.go.html#5607850">bytes</a></span><span class="op" id="5622356">.</span><span class="ident" id="5622357">NewReader</span><span class="op" id="5622366">(</span><span class="ident" id="5622367"><a href="/debug/elf/file.go.html#5622115">rels</a></span><span class="op" id="5622371">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622374">var</span>&nbsp;<span class="ident" id="5622378">rel</span>&nbsp;<span class="ident" id="5622382"><a href="/debug/elf/elf.go.html#5602773">Rel32</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622390">for</span>&nbsp;<span class="ident" id="5622394"><a href="/debug/elf/file.go.html#5622346">b</a></span><span class="op" id="5622395">.</span><span class="ident" id="5622396">Len</span><span class="op" id="5622399">(</span><span class="op" id="5622400">)</span>&nbsp;<span class="op" id="5622402">&gt;</span>&nbsp;<span class="num" id="5622404">0</span>&nbsp;<span class="op" id="5622406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622410"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5622416">.</span><span class="ident" id="5622417">Read</span><span class="op" id="5622421">(</span><span class="ident" id="5622422"><a href="/debug/elf/file.go.html#5622346">b</a></span><span class="op" id="5622423">,</span>&nbsp;<span class="ident" id="5622425"><a href="/debug/elf/file.go.html#5622074">f</a></span><span class="op" id="5622426">.</span><span class="ident" id="5622427">ByteOrder</span><span class="op" id="5622436">,</span>&nbsp;<span class="op" id="5622438">&amp;</span><span class="ident" id="5622439"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622446">symNo</span>&nbsp;<span class="op" id="5622452">:=</span>&nbsp;<span class="ident" id="5622455"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622458">.</span><span class="ident" id="5622459">Info</span>&nbsp;<span class="op" id="5622464">&gt;&gt;</span>&nbsp;<span class="num" id="5622467">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622471">t</span>&nbsp;<span class="op" id="5622473">:=</span>&nbsp;<span class="ident" id="5622476"><a href="/debug/elf/elf.go.html#5589028">R_386</a></span><span class="op" id="5622481">(</span><span class="ident" id="5622482"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622485">.</span><span class="ident" id="5622486">Info</span>&nbsp;<span class="op" id="5622491">&amp;</span>&nbsp;<span class="num" id="5622493">0xff</span><span class="op" id="5622497">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622502">if</span>&nbsp;<span class="ident" id="5622505"><a href="/debug/elf/file.go.html#5622446">symNo</a></span>&nbsp;<span class="op" id="5622511">==</span>&nbsp;<span class="num" id="5622514">0</span>&nbsp;<span class="op" id="5622516">||</span>&nbsp;<span class="ident" id="5622519"><a href="/debug/elf/file.go.html#5622446">symNo</a></span>&nbsp;<span class="op" id="5622525">&gt;</span>&nbsp;<span class="builtintype" id="5622527">uint32</span><span class="op" id="5622533">(</span><span class="builtinfunc" id="5622534">len</span><span class="op" id="5622537">(</span><span class="ident" id="5622538"><a href="/debug/elf/file.go.html#5622267">symbols</a></span><span class="op" id="5622545">)</span><span class="op" id="5622546">)</span>&nbsp;<span class="op" id="5622548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622553">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622564">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622568">sym</span>&nbsp;<span class="op" id="5622572">:=</span>&nbsp;<span class="op" id="5622575">&amp;</span><span class="ident" id="5622576"><a href="/debug/elf/file.go.html#5622267">symbols</a></span><span class="op" id="5622583">[</span><span class="ident" id="5622584"><a href="/debug/elf/file.go.html#5622446">symNo</a></span><span class="op" id="5622589">-</span><span class="num" id="5622590">1</span><span class="op" id="5622591">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622596">if</span>&nbsp;<span class="ident" id="5622599"><a href="/debug/elf/file.go.html#5622471">t</a></span>&nbsp;<span class="op" id="5622601">==</span>&nbsp;<span class="ident" id="5622604"><a href="/debug/elf/elf.go.html#5589100">R_386_32</a></span>&nbsp;<span class="op" id="5622613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622618">if</span>&nbsp;<span class="ident" id="5622621"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622624">.</span><span class="ident" id="5622625">Off</span><span class="op" id="5622628">+</span><span class="num" id="5622629">4</span>&nbsp;<span class="op" id="5622631">&gt;=</span>&nbsp;<span class="builtintype" id="5622634">uint32</span><span class="op" id="5622640">(</span><span class="builtinfunc" id="5622641">len</span><span class="op" id="5622644">(</span><span class="ident" id="5622645"><a href="/debug/elf/file.go.html#5622103">dst</a></span><span class="op" id="5622648">)</span><span class="op" id="5622649">)</span>&nbsp;<span class="op" id="5622651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622657">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622674">val</span>&nbsp;<span class="op" id="5622678">:=</span>&nbsp;<span class="ident" id="5622681"><a href="/debug/elf/file.go.html#5622074">f</a></span><span class="op" id="5622682">.</span><span class="ident" id="5622683">ByteOrder</span><span class="op" id="5622692">.</span><span class="ident" id="5622693">Uint32</span><span class="op" id="5622699">(</span><span class="ident" id="5622700"><a href="/debug/elf/file.go.html#5622103">dst</a></span><span class="op" id="5622703">[</span><span class="ident" id="5622704"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622707">.</span><span class="ident" id="5622708">Off</span>&nbsp;<span class="op" id="5622712">:</span>&nbsp;<span class="ident" id="5622714"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622717">.</span><span class="ident" id="5622718">Off</span><span class="op" id="5622721">+</span><span class="num" id="5622722">4</span><span class="op" id="5622723">]</span><span class="op" id="5622724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622729"><a href="/debug/elf/file.go.html#5622674">val</a></span>&nbsp;<span class="op" id="5622733">+=</span>&nbsp;<span class="builtintype" id="5622736">uint32</span><span class="op" id="5622742">(</span><span class="ident" id="5622743"><a href="/debug/elf/file.go.html#5622568">sym</a></span><span class="op" id="5622746">.</span><span class="ident" id="5622747">Value</span><span class="op" id="5622752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5622757"><a href="/debug/elf/file.go.html#5622074">f</a></span><span class="op" id="5622758">.</span><span class="ident" id="5622759">ByteOrder</span><span class="op" id="5622768">.</span><span class="ident" id="5622769">PutUint32</span><span class="op" id="5622778">(</span><span class="ident" id="5622779"><a href="/debug/elf/file.go.html#5622103">dst</a></span><span class="op" id="5622782">[</span><span class="ident" id="5622783"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622786">.</span><span class="ident" id="5622787">Off</span><span class="op" id="5622790">:</span><span class="ident" id="5622791"><a href="/debug/elf/file.go.html#5622378">rel</a></span><span class="op" id="5622794">.</span><span class="ident" id="5622795">Off</span><span class="op" id="5622798">+</span><span class="num" id="5622799">4</span><span class="op" id="5622800">]</span><span class="op" id="5622801">,</span>&nbsp;<span class="ident" id="5622803"><a href="/debug/elf/file.go.html#5622674">val</a></span><span class="op" id="5622806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622810">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5622813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622817">return</span>&nbsp;<span class="ident" id="5622824">nil</span><br>
<span class="lineno"></span><span class="op" id="5622828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5622831">func</span>&nbsp;<span class="op" id="5622836">(</span><span class="ident" id="5622837">f</span>&nbsp;<span class="op" id="5622839">*</span><span class="ident" id="5622840"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5622844">)</span>&nbsp;<span class="ident" id="5622846">applyRelocationsARM64</span><span class="op" id="5622867">(</span><span class="ident" id="5622868">dst</span>&nbsp;<span class="op" id="5622872">[</span><span class="op" id="5622873">]</span><span class="builtintype" id="5622874">byte</span><span class="op" id="5622878">,</span>&nbsp;<span class="ident" id="5622880">rels</span>&nbsp;<span class="op" id="5622885">[</span><span class="op" id="5622886">]</span><span class="builtintype" id="5622887">byte</span><span class="op" id="5622891">)</span>&nbsp;<span class="builtintype" id="5622893">error</span>&nbsp;<span class="op" id="5622899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5622902">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622932">if</span>&nbsp;<span class="builtinfunc" id="5622935">len</span><span class="op" id="5622938">(</span><span class="ident" id="5622939"><a href="/debug/elf/file.go.html#5622880">rels</a></span><span class="op" id="5622943">)</span><span class="op" id="5622944">%</span><span class="num" id="5622945">24</span>&nbsp;<span class="op" id="5622948">!=</span>&nbsp;<span class="num" id="5622951">0</span>&nbsp;<span class="op" id="5622953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5622957">return</span>&nbsp;<span class="ident" id="5622964"><a href="/debug/elf/file.go.html#5607893">errors</a></span><span class="op" id="5622970">.</span><span class="ident" id="5622971">New</span><span class="op" id="5622974">(</span><span class="string" id="5622975">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5623029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5623032">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623036">symbols</span><span class="op" id="5623043">,</span>&nbsp;<span class="ident" id="5623045">_</span><span class="op" id="5623046">,</span>&nbsp;<span class="ident" id="5623048">err</span>&nbsp;<span class="op" id="5623052">:=</span>&nbsp;<span class="ident" id="5623055"><a href="/debug/elf/file.go.html#5622837">f</a></span><span class="op" id="5623056">.</span><span class="ident" id="5623057">getSymbols</span><span class="op" id="5623067">(</span><span class="ident" id="5623068"><a href="/debug/elf/elf.go.html#5555076">SHT_SYMTAB</a></span><span class="op" id="5623078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623081">if</span>&nbsp;<span class="ident" id="5623084"><a href="/debug/elf/file.go.html#5623048">err</a></span>&nbsp;<span class="op" id="5623088">!=</span>&nbsp;<span class="ident" id="5623091">nil</span>&nbsp;<span class="op" id="5623095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623099">return</span>&nbsp;<span class="ident" id="5623106"><a href="/debug/elf/file.go.html#5623048">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5623111">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623115">b</span>&nbsp;<span class="op" id="5623117">:=</span>&nbsp;<span class="ident" id="5623120"><a href="/debug/elf/file.go.html#5607850">bytes</a></span><span class="op" id="5623125">.</span><span class="ident" id="5623126">NewReader</span><span class="op" id="5623135">(</span><span class="ident" id="5623136"><a href="/debug/elf/file.go.html#5622880">rels</a></span><span class="op" id="5623140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623143">var</span>&nbsp;<span class="ident" id="5623147">rela</span>&nbsp;<span class="ident" id="5623152"><a href="/debug/elf/elf.go.html#5606009">Rela64</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623161">for</span>&nbsp;<span class="ident" id="5623165"><a href="/debug/elf/file.go.html#5623115">b</a></span><span class="op" id="5623166">.</span><span class="ident" id="5623167">Len</span><span class="op" id="5623170">(</span><span class="op" id="5623171">)</span>&nbsp;<span class="op" id="5623173">&gt;</span>&nbsp;<span class="num" id="5623175">0</span>&nbsp;<span class="op" id="5623177">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623181"><a href="/debug/elf/file.go.html#5607874">binary</a></span><span class="op" id="5623187">.</span><span class="ident" id="5623188">Read</span><span class="op" id="5623192">(</span><span class="ident" id="5623193"><a href="/debug/elf/file.go.html#5623115">b</a></span><span class="op" id="5623194">,</span>&nbsp;<span class="ident" id="5623196"><a href="/debug/elf/file.go.html#5622837">f</a></span><span class="op" id="5623197">.</span><span class="ident" id="5623198">ByteOrder</span><span class="op" id="5623207">,</span>&nbsp;<span class="op" id="5623209">&amp;</span><span class="ident" id="5623210"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623218">symNo</span>&nbsp;<span class="op" id="5623224">:=</span>&nbsp;<span class="ident" id="5623227"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623231">.</span><span class="ident" id="5623232">Info</span>&nbsp;<span class="op" id="5623237">&gt;&gt;</span>&nbsp;<span class="num" id="5623240">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623245">t</span>&nbsp;<span class="op" id="5623247">:=</span>&nbsp;<span class="ident" id="5623250"><a href="/debug/elf/elf.go.html#5572312">R_AARCH64</a></span><span class="op" id="5623259">(</span><span class="ident" id="5623260"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623264">.</span><span class="ident" id="5623265">Info</span>&nbsp;<span class="op" id="5623270">&amp;</span>&nbsp;<span class="num" id="5623272">0xffff</span><span class="op" id="5623278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623283">if</span>&nbsp;<span class="ident" id="5623286"><a href="/debug/elf/file.go.html#5623218">symNo</a></span>&nbsp;<span class="op" id="5623292">==</span>&nbsp;<span class="num" id="5623295">0</span>&nbsp;<span class="op" id="5623297">||</span>&nbsp;<span class="ident" id="5623300"><a href="/debug/elf/file.go.html#5623218">symNo</a></span>&nbsp;<span class="op" id="5623306">&gt;</span>&nbsp;<span class="ident" id="5623308">uint64</span><span class="op" id="5623314">(</span><span class="builtinfunc" id="5623315">len</span><span class="op" id="5623318">(</span><span class="ident" id="5623319"><a href="/debug/elf/file.go.html#5623036">symbols</a></span><span class="op" id="5623326">)</span><span class="op" id="5623327">)</span>&nbsp;<span class="op" id="5623329">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623334">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5623345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623349">sym</span>&nbsp;<span class="op" id="5623353">:=</span>&nbsp;<span class="op" id="5623356">&amp;</span><span class="ident" id="5623357"><a href="/debug/elf/file.go.html#5623036">symbols</a></span><span class="op" id="5623364">[</span><span class="ident" id="5623365"><a href="/debug/elf/file.go.html#5623218">symNo</a></span><span class="op" id="5623370">-</span><span class="num" id="5623371">1</span><span class="op" id="5623372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623376">if</span>&nbsp;<span class="ident" id="5623379"><a href="/debug/elf/elf.go.html#5567990">SymType</a></span><span class="op" id="5623386">(</span><span class="ident" id="5623387"><a href="/debug/elf/file.go.html#5623349">sym</a></span><span class="op" id="5623390">.</span><span class="ident" id="5623391">Info</span><span class="op" id="5623395">&amp;</span><span class="num" id="5623396">0xf</span><span class="op" id="5623399">)</span>&nbsp;<span class="op" id="5623401">!=</span>&nbsp;<span class="ident" id="5623404"><a href="/debug/elf/elf.go.html#5568149">STT_SECTION</a></span>&nbsp;<span class="op" id="5623416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5623421">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623476">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5623487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5623492">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5623545">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5623600">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623647">switch</span>&nbsp;<span class="ident" id="5623654"><a href="/debug/elf/file.go.html#5623245">t</a></span>&nbsp;<span class="op" id="5623656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623660">case</span>&nbsp;<span class="ident" id="5623665"><a href="/debug/elf/elf.go.html#5575367">R_AARCH64_ABS64</a></span><span class="op" id="5623680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623685">if</span>&nbsp;<span class="ident" id="5623688"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623692">.</span><span class="ident" id="5623693">Off</span><span class="op" id="5623696">+</span><span class="num" id="5623697">8</span>&nbsp;<span class="op" id="5623699">&gt;=</span>&nbsp;<span class="ident" id="5623702">uint64</span><span class="op" id="5623708">(</span><span class="builtinfunc" id="5623709">len</span><span class="op" id="5623712">(</span><span class="ident" id="5623713"><a href="/debug/elf/file.go.html#5622868">dst</a></span><span class="op" id="5623716">)</span><span class="op" id="5623717">)</span>&nbsp;<span class="op" id="5623719">||</span>&nbsp;<span class="ident" id="5623722"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623726">.</span><span class="ident" id="5623727">Addend</span>&nbsp;<span class="op" id="5623734">&lt;</span>&nbsp;<span class="num" id="5623736">0</span>&nbsp;<span class="op" id="5623738">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623744">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5623756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623761"><a href="/debug/elf/file.go.html#5622837">f</a></span><span class="op" id="5623762">.</span><span class="ident" id="5623763">ByteOrder</span><span class="op" id="5623772">.</span><span class="ident" id="5623773">PutUint64</span><span class="op" id="5623782">(</span><span class="ident" id="5623783"><a href="/debug/elf/file.go.html#5622868">dst</a></span><span class="op" id="5623786">[</span><span class="ident" id="5623787"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623791">.</span><span class="ident" id="5623792">Off</span><span class="op" id="5623795">:</span><span class="ident" id="5623796"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623800">.</span><span class="ident" id="5623801">Off</span><span class="op" id="5623804">+</span><span class="num" id="5623805">8</span><span class="op" id="5623806">]</span><span class="op" id="5623807">,</span>&nbsp;<span class="ident" id="5623809">uint64</span><span class="op" id="5623815">(</span><span class="ident" id="5623816"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623820">.</span><span class="ident" id="5623821">Addend</span><span class="op" id="5623827">)</span><span class="op" id="5623828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623832">case</span>&nbsp;<span class="ident" id="5623837"><a href="/debug/elf/elf.go.html#5575426">R_AARCH64_ABS32</a></span><span class="op" id="5623852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623857">if</span>&nbsp;<span class="ident" id="5623860"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623864">.</span><span class="ident" id="5623865">Off</span><span class="op" id="5623868">+</span><span class="num" id="5623869">4</span>&nbsp;<span class="op" id="5623871">&gt;=</span>&nbsp;<span class="ident" id="5623874">uint64</span><span class="op" id="5623880">(</span><span class="builtinfunc" id="5623881">len</span><span class="op" id="5623884">(</span><span class="ident" id="5623885"><a href="/debug/elf/file.go.html#5622868">dst</a></span><span class="op" id="5623888">)</span><span class="op" id="5623889">)</span>&nbsp;<span class="op" id="5623891">||</span>&nbsp;<span class="ident" id="5623894"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623898">.</span><span class="ident" id="5623899">Addend</span>&nbsp;<span class="op" id="5623906">&lt;</span>&nbsp;<span class="num" id="5623908">0</span>&nbsp;<span class="op" id="5623910">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5623916">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5623928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5623933"><a href="/debug/elf/file.go.html#5622837">f</a></span><span class="op" id="5623934">.</span><span class="ident" id="5623935">ByteOrder</span><span class="op" id="5623944">.</span><span class="ident" id="5623945">PutUint32</span><span class="op" id="5623954">(</span><span class="ident" id="5623955"><a href="/debug/elf/file.go.html#5622868">dst</a></span><span class="op" id="5623958">[</span><span class="ident" id="5623959"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623963">.</span><span class="ident" id="5623964">Off</span><span class="op" id="5623967">:</span><span class="ident" id="5623968"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623972">.</span><span class="ident" id="5623973">Off</span><span class="op" id="5623976">+</span><span class="num" id="5623977">4</span><span class="op" id="5623978">]</span><span class="op" id="5623979">,</span>&nbsp;<span class="builtintype" id="5623981">uint32</span><span class="op" id="5623987">(</span><span class="ident" id="5623988"><a href="/debug/elf/file.go.html#5623147">rela</a></span><span class="op" id="5623992">.</span><span class="ident" id="5623993">Addend</span><span class="op" id="5623999">)</span><span class="op" id="5624000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624007">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624011">return</span>&nbsp;<span class="ident" id="5624018">nil</span><br>
<span class="lineno"></span><span class="op" id="5624022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5624025">func</span>&nbsp;<span class="op" id="5624030">(</span><span class="ident" id="5624031">f</span>&nbsp;<span class="op" id="5624033">*</span><span class="ident" id="5624034"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5624038">)</span>&nbsp;<span class="ident" id="5624040">DWARF</span><span class="op" id="5624045">(</span><span class="op" id="5624046">)</span>&nbsp;<span class="op" id="5624048">(</span><span class="op" id="5624049">*</span><span class="ident" id="5624050"><a href="/debug/elf/file.go.html#5607859">dwarf</a></span><span class="op" id="5624055">.</span><span class="ident" id="5624056">Data</span><span class="op" id="5624060">,</span>&nbsp;<span class="builtintype" id="5624062">error</span><span class="op" id="5624067">)</span>&nbsp;<span class="op" id="5624069">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5624072">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5624123">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5624178">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624237">var</span>&nbsp;<span class="ident" id="5624241">names</span>&nbsp;<span class="op" id="5624247">=</span>&nbsp;<span class="op" id="5624249">[</span><span class="op" id="5624250">...</span><span class="op" id="5624253">]</span><span class="builtintype" id="5624254">string</span><span class="op" id="5624260">{</span><span class="string" id="5624261">&#34;abbrev&#34;</span><span class="op" id="5624269">,</span>&nbsp;<span class="string" id="5624271">&#34;info&#34;</span><span class="op" id="5624277">,</span>&nbsp;<span class="string" id="5624279">&#34;str&#34;</span><span class="op" id="5624284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624287">var</span>&nbsp;<span class="ident" id="5624291">dat</span>&nbsp;<span class="op" id="5624295">[</span><span class="builtinfunc" id="5624296">len</span><span class="op" id="5624299">(</span><span class="ident" id="5624300"><a href="/debug/elf/file.go.html#5624241">names</a></span><span class="op" id="5624305">)</span><span class="op" id="5624306">]</span><span class="op" id="5624307">[</span><span class="op" id="5624308">]</span><span class="builtintype" id="5624309">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624315">for</span>&nbsp;<span class="ident" id="5624319">i</span><span class="op" id="5624320">,</span>&nbsp;<span class="ident" id="5624322">name</span>&nbsp;<span class="op" id="5624327">:=</span>&nbsp;<span class="keyword" id="5624330">range</span>&nbsp;<span class="ident" id="5624336"><a href="/debug/elf/file.go.html#5624241">names</a></span>&nbsp;<span class="op" id="5624342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624346"><a href="/debug/elf/file.go.html#5624322">name</a></span>&nbsp;<span class="op" id="5624351">=</span>&nbsp;<span class="string" id="5624353">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5624363">+</span>&nbsp;<span class="ident" id="5624365"><a href="/debug/elf/file.go.html#5624322">name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624372">s</span>&nbsp;<span class="op" id="5624374">:=</span>&nbsp;<span class="ident" id="5624377"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5624378">.</span><span class="ident" id="5624379">Section</span><span class="op" id="5624386">(</span><span class="ident" id="5624387"><a href="/debug/elf/file.go.html#5624322">name</a></span><span class="op" id="5624391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624395">if</span>&nbsp;<span class="ident" id="5624398"><a href="/debug/elf/file.go.html#5624372">s</a></span>&nbsp;<span class="op" id="5624400">==</span>&nbsp;<span class="ident" id="5624403">nil</span>&nbsp;<span class="op" id="5624407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624412">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624427">b</span><span class="op" id="5624428">,</span>&nbsp;<span class="ident" id="5624430">err</span>&nbsp;<span class="op" id="5624434">:=</span>&nbsp;<span class="ident" id="5624437"><a href="/debug/elf/file.go.html#5624372">s</a></span><span class="op" id="5624438">.</span><span class="ident" id="5624439">Data</span><span class="op" id="5624443">(</span><span class="op" id="5624444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624448">if</span>&nbsp;<span class="ident" id="5624451"><a href="/debug/elf/file.go.html#5624430">err</a></span>&nbsp;<span class="op" id="5624455">!=</span>&nbsp;<span class="ident" id="5624458">nil</span>&nbsp;<span class="op" id="5624462">&amp;&amp;</span>&nbsp;<span class="ident" id="5624465">uint64</span><span class="op" id="5624471">(</span><span class="builtinfunc" id="5624472">len</span><span class="op" id="5624475">(</span><span class="ident" id="5624476"><a href="/debug/elf/file.go.html#5624427">b</a></span><span class="op" id="5624477">)</span><span class="op" id="5624478">)</span>&nbsp;<span class="op" id="5624480">&lt;</span>&nbsp;<span class="ident" id="5624482"><a href="/debug/elf/file.go.html#5624372">s</a></span><span class="op" id="5624483">.</span><span class="ident" id="5624484">Size</span>&nbsp;<span class="op" id="5624489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624494">return</span>&nbsp;<span class="ident" id="5624501">nil</span><span class="op" id="5624504">,</span>&nbsp;<span class="ident" id="5624506"><a href="/debug/elf/file.go.html#5624430">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624512">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624516"><a href="/debug/elf/file.go.html#5624291">dat</a></span><span class="op" id="5624519">[</span><span class="ident" id="5624520"><a href="/debug/elf/file.go.html#5624319">i</a></span><span class="op" id="5624521">]</span>&nbsp;<span class="op" id="5624523">=</span>&nbsp;<span class="ident" id="5624525"><a href="/debug/elf/file.go.html#5624427">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5624532">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5624605">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624678">rela</span>&nbsp;<span class="op" id="5624683">:=</span>&nbsp;<span class="ident" id="5624686"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5624687">.</span><span class="ident" id="5624688">Section</span><span class="op" id="5624695">(</span><span class="string" id="5624696">&#34;.rela.debug_info&#34;</span><span class="op" id="5624714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624717">if</span>&nbsp;<span class="ident" id="5624720"><a href="/debug/elf/file.go.html#5624678">rela</a></span>&nbsp;<span class="op" id="5624725">!=</span>&nbsp;<span class="ident" id="5624728">nil</span>&nbsp;<span class="op" id="5624732">&amp;&amp;</span>&nbsp;<span class="ident" id="5624735"><a href="/debug/elf/file.go.html#5624678">rela</a></span><span class="op" id="5624739">.</span><span class="ident" id="5624740">Type</span>&nbsp;<span class="op" id="5624745">==</span>&nbsp;<span class="ident" id="5624748"><a href="/debug/elf/elf.go.html#5555220">SHT_RELA</a></span>&nbsp;<span class="op" id="5624757">&amp;&amp;</span>&nbsp;<span class="op" id="5624760">(</span><span class="ident" id="5624761"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5624762">.</span><span class="ident" id="5624763">Machine</span>&nbsp;<span class="op" id="5624771">==</span>&nbsp;<span class="ident" id="5624774"><a href="/debug/elf/elf.go.html#5552202">EM_X86_64</a></span>&nbsp;<span class="op" id="5624784">||</span>&nbsp;<span class="ident" id="5624787"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5624788">.</span><span class="ident" id="5624789">Machine</span>&nbsp;<span class="op" id="5624797">==</span>&nbsp;<span class="ident" id="5624800"><a href="/debug/elf/elf.go.html#5552268">EM_AARCH64</a></span><span class="op" id="5624810">)</span>&nbsp;<span class="op" id="5624812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624816">data</span><span class="op" id="5624820">,</span>&nbsp;<span class="ident" id="5624822">err</span>&nbsp;<span class="op" id="5624826">:=</span>&nbsp;<span class="ident" id="5624829"><a href="/debug/elf/file.go.html#5624678">rela</a></span><span class="op" id="5624833">.</span><span class="ident" id="5624834">Data</span><span class="op" id="5624838">(</span><span class="op" id="5624839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624843">if</span>&nbsp;<span class="ident" id="5624846"><a href="/debug/elf/file.go.html#5624822">err</a></span>&nbsp;<span class="op" id="5624850">!=</span>&nbsp;<span class="ident" id="5624853">nil</span>&nbsp;<span class="op" id="5624857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624862">return</span>&nbsp;<span class="ident" id="5624869">nil</span><span class="op" id="5624872">,</span>&nbsp;<span class="ident" id="5624874"><a href="/debug/elf/file.go.html#5624822">err</a></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5624884"><a href="/debug/elf/file.go.html#5624822">err</a></span>&nbsp;<span class="op" id="5624888">=</span>&nbsp;<span class="ident" id="5624890"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5624891">.</span><span class="ident" id="5624892">applyRelocations</span><span class="op" id="5624908">(</span><span class="ident" id="5624909"><a href="/debug/elf/file.go.html#5624291">dat</a></span><span class="op" id="5624912">[</span><span class="num" id="5624913">1</span><span class="op" id="5624914">]</span><span class="op" id="5624915">,</span>&nbsp;<span class="ident" id="5624917"><a href="/debug/elf/file.go.html#5624816">data</a></span><span class="op" id="5624921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624925">if</span>&nbsp;<span class="ident" id="5624928"><a href="/debug/elf/file.go.html#5624822">err</a></span>&nbsp;<span class="op" id="5624932">!=</span>&nbsp;<span class="ident" id="5624935">nil</span>&nbsp;<span class="op" id="5624939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5624944">return</span>&nbsp;<span class="ident" id="5624951">nil</span><span class="op" id="5624954">,</span>&nbsp;<span class="ident" id="5624956"><a href="/debug/elf/file.go.html#5624822">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624962">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5624965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5624969">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625035">rel</span>&nbsp;<span class="op" id="5625039">:=</span>&nbsp;<span class="ident" id="5625042"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5625043">.</span><span class="ident" id="5625044">Section</span><span class="op" id="5625051">(</span><span class="string" id="5625052">&#34;.rel.debug_info&#34;</span><span class="op" id="5625069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625072">if</span>&nbsp;<span class="ident" id="5625075"><a href="/debug/elf/file.go.html#5625035">rel</a></span>&nbsp;<span class="op" id="5625079">!=</span>&nbsp;<span class="ident" id="5625082">nil</span>&nbsp;<span class="op" id="5625086">&amp;&amp;</span>&nbsp;<span class="ident" id="5625089"><a href="/debug/elf/file.go.html#5625035">rel</a></span><span class="op" id="5625092">.</span><span class="ident" id="5625093">Type</span>&nbsp;<span class="op" id="5625098">==</span>&nbsp;<span class="ident" id="5625101"><a href="/debug/elf/elf.go.html#5555579">SHT_REL</a></span>&nbsp;<span class="op" id="5625109">&amp;&amp;</span>&nbsp;<span class="ident" id="5625112"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5625113">.</span><span class="ident" id="5625114">Machine</span>&nbsp;<span class="op" id="5625122">==</span>&nbsp;<span class="ident" id="5625125"><a href="/debug/elf/elf.go.html#5550100">EM_386</a></span>&nbsp;<span class="op" id="5625132">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625136">data</span><span class="op" id="5625140">,</span>&nbsp;<span class="ident" id="5625142">err</span>&nbsp;<span class="op" id="5625146">:=</span>&nbsp;<span class="ident" id="5625149"><a href="/debug/elf/file.go.html#5625035">rel</a></span><span class="op" id="5625152">.</span><span class="ident" id="5625153">Data</span><span class="op" id="5625157">(</span><span class="op" id="5625158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625162">if</span>&nbsp;<span class="ident" id="5625165"><a href="/debug/elf/file.go.html#5625142">err</a></span>&nbsp;<span class="op" id="5625169">!=</span>&nbsp;<span class="ident" id="5625172">nil</span>&nbsp;<span class="op" id="5625176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625181">return</span>&nbsp;<span class="ident" id="5625188">nil</span><span class="op" id="5625191">,</span>&nbsp;<span class="ident" id="5625193"><a href="/debug/elf/file.go.html#5625142">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625203"><a href="/debug/elf/file.go.html#5625142">err</a></span>&nbsp;<span class="op" id="5625207">=</span>&nbsp;<span class="ident" id="5625209"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5625210">.</span><span class="ident" id="5625211">applyRelocations</span><span class="op" id="5625227">(</span><span class="ident" id="5625228"><a href="/debug/elf/file.go.html#5624291">dat</a></span><span class="op" id="5625231">[</span><span class="num" id="5625232">1</span><span class="op" id="5625233">]</span><span class="op" id="5625234">,</span>&nbsp;<span class="ident" id="5625236"><a href="/debug/elf/file.go.html#5625136">data</a></span><span class="op" id="5625240">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625244">if</span>&nbsp;<span class="ident" id="5625247"><a href="/debug/elf/file.go.html#5625142">err</a></span>&nbsp;<span class="op" id="5625251">!=</span>&nbsp;<span class="ident" id="5625254">nil</span>&nbsp;<span class="op" id="5625258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625263">return</span>&nbsp;<span class="ident" id="5625270">nil</span><span class="op" id="5625273">,</span>&nbsp;<span class="ident" id="5625275"><a href="/debug/elf/file.go.html#5625142">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625288">abbrev</span><span class="op" id="5625294">,</span>&nbsp;<span class="ident" id="5625296">info</span><span class="op" id="5625300">,</span>&nbsp;<span class="ident" id="5625302">str</span>&nbsp;<span class="op" id="5625306">:=</span>&nbsp;<span class="ident" id="5625309"><a href="/debug/elf/file.go.html#5624291">dat</a></span><span class="op" id="5625312">[</span><span class="num" id="5625313">0</span><span class="op" id="5625314">]</span><span class="op" id="5625315">,</span>&nbsp;<span class="ident" id="5625317"><a href="/debug/elf/file.go.html#5624291">dat</a></span><span class="op" id="5625320">[</span><span class="num" id="5625321">1</span><span class="op" id="5625322">]</span><span class="op" id="5625323">,</span>&nbsp;<span class="ident" id="5625325"><a href="/debug/elf/file.go.html#5624291">dat</a></span><span class="op" id="5625328">[</span><span class="num" id="5625329">2</span><span class="op" id="5625330">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625333">d</span><span class="op" id="5625334">,</span>&nbsp;<span class="ident" id="5625336">err</span>&nbsp;<span class="op" id="5625340">:=</span>&nbsp;<span class="ident" id="5625343"><a href="/debug/elf/file.go.html#5607859">dwarf</a></span><span class="op" id="5625348">.</span><span class="ident" id="5625349">New</span><span class="op" id="5625352">(</span><span class="ident" id="5625353"><a href="/debug/elf/file.go.html#5625288">abbrev</a></span><span class="op" id="5625359">,</span>&nbsp;<span class="ident" id="5625361">nil</span><span class="op" id="5625364">,</span>&nbsp;<span class="ident" id="5625366">nil</span><span class="op" id="5625369">,</span>&nbsp;<span class="ident" id="5625371"><a href="/debug/elf/file.go.html#5625296">info</a></span><span class="op" id="5625375">,</span>&nbsp;<span class="ident" id="5625377">nil</span><span class="op" id="5625380">,</span>&nbsp;<span class="ident" id="5625382">nil</span><span class="op" id="5625385">,</span>&nbsp;<span class="ident" id="5625387">nil</span><span class="op" id="5625390">,</span>&nbsp;<span class="ident" id="5625392"><a href="/debug/elf/file.go.html#5625302">str</a></span><span class="op" id="5625395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625398">if</span>&nbsp;<span class="ident" id="5625401"><a href="/debug/elf/file.go.html#5625336">err</a></span>&nbsp;<span class="op" id="5625405">!=</span>&nbsp;<span class="ident" id="5625408">nil</span>&nbsp;<span class="op" id="5625412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625416">return</span>&nbsp;<span class="ident" id="5625423">nil</span><span class="op" id="5625426">,</span>&nbsp;<span class="ident" id="5625428"><a href="/debug/elf/file.go.html#5625336">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625433">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5625437">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625480">for</span>&nbsp;<span class="ident" id="5625484">i</span><span class="op" id="5625485">,</span>&nbsp;<span class="ident" id="5625487">s</span>&nbsp;<span class="op" id="5625489">:=</span>&nbsp;<span class="keyword" id="5625492">range</span>&nbsp;<span class="ident" id="5625498"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5625499">.</span><span class="ident" id="5625500">Sections</span>&nbsp;<span class="op" id="5625509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625513">if</span>&nbsp;<span class="ident" id="5625516"><a href="/debug/elf/file.go.html#5625487">s</a></span><span class="op" id="5625517">.</span><span class="ident" id="5625518">Name</span>&nbsp;<span class="op" id="5625523">==</span>&nbsp;<span class="string" id="5625526">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5625541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625546">b</span><span class="op" id="5625547">,</span>&nbsp;<span class="ident" id="5625549">err</span>&nbsp;<span class="op" id="5625553">:=</span>&nbsp;<span class="ident" id="5625556"><a href="/debug/elf/file.go.html#5625487">s</a></span><span class="op" id="5625557">.</span><span class="ident" id="5625558">Data</span><span class="op" id="5625562">(</span><span class="op" id="5625563">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625568">if</span>&nbsp;<span class="ident" id="5625571"><a href="/debug/elf/file.go.html#5625549">err</a></span>&nbsp;<span class="op" id="5625575">!=</span>&nbsp;<span class="ident" id="5625578">nil</span>&nbsp;<span class="op" id="5625582">&amp;&amp;</span>&nbsp;<span class="ident" id="5625585">uint64</span><span class="op" id="5625591">(</span><span class="builtinfunc" id="5625592">len</span><span class="op" id="5625595">(</span><span class="ident" id="5625596"><a href="/debug/elf/file.go.html#5625546">b</a></span><span class="op" id="5625597">)</span><span class="op" id="5625598">)</span>&nbsp;<span class="op" id="5625600">&lt;</span>&nbsp;<span class="ident" id="5625602"><a href="/debug/elf/file.go.html#5625487">s</a></span><span class="op" id="5625603">.</span><span class="ident" id="5625604">Size</span>&nbsp;<span class="op" id="5625609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625615">return</span>&nbsp;<span class="ident" id="5625622">nil</span><span class="op" id="5625625">,</span>&nbsp;<span class="ident" id="5625627"><a href="/debug/elf/file.go.html#5625549">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625640">for</span>&nbsp;<span class="ident" id="5625644">_</span><span class="op" id="5625645">,</span>&nbsp;<span class="ident" id="5625647">r</span>&nbsp;<span class="op" id="5625649">:=</span>&nbsp;<span class="keyword" id="5625652">range</span>&nbsp;<span class="ident" id="5625658"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5625659">.</span><span class="ident" id="5625660">Sections</span>&nbsp;<span class="op" id="5625669">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625675">if</span>&nbsp;<span class="ident" id="5625678"><a href="/debug/elf/file.go.html#5625647">r</a></span><span class="op" id="5625679">.</span><span class="ident" id="5625680">Type</span>&nbsp;<span class="op" id="5625685">!=</span>&nbsp;<span class="ident" id="5625688"><a href="/debug/elf/elf.go.html#5555220">SHT_RELA</a></span>&nbsp;<span class="op" id="5625697">&amp;&amp;</span>&nbsp;<span class="ident" id="5625700"><a href="/debug/elf/file.go.html#5625647">r</a></span><span class="op" id="5625701">.</span><span class="ident" id="5625702">Type</span>&nbsp;<span class="op" id="5625707">!=</span>&nbsp;<span class="ident" id="5625710"><a href="/debug/elf/elf.go.html#5555579">SHT_REL</a></span>&nbsp;<span class="op" id="5625718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625725">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625744">if</span>&nbsp;<span class="builtintype" id="5625747">int</span><span class="op" id="5625750">(</span><span class="ident" id="5625751"><a href="/debug/elf/file.go.html#5625647">r</a></span><span class="op" id="5625752">.</span><span class="ident" id="5625753">Info</span><span class="op" id="5625757">)</span>&nbsp;<span class="op" id="5625759">!=</span>&nbsp;<span class="ident" id="5625762"><a href="/debug/elf/file.go.html#5625484">i</a></span>&nbsp;<span class="op" id="5625764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625771">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625790">rd</span><span class="op" id="5625792">,</span>&nbsp;<span class="ident" id="5625794">err</span>&nbsp;<span class="op" id="5625798">:=</span>&nbsp;<span class="ident" id="5625801"><a href="/debug/elf/file.go.html#5625647">r</a></span><span class="op" id="5625802">.</span><span class="ident" id="5625803">Data</span><span class="op" id="5625807">(</span><span class="op" id="5625808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625814">if</span>&nbsp;<span class="ident" id="5625817"><a href="/debug/elf/file.go.html#5625794">err</a></span>&nbsp;<span class="op" id="5625821">!=</span>&nbsp;<span class="ident" id="5625824">nil</span>&nbsp;<span class="op" id="5625828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625835">return</span>&nbsp;<span class="ident" id="5625842">nil</span><span class="op" id="5625845">,</span>&nbsp;<span class="ident" id="5625847"><a href="/debug/elf/file.go.html#5625794">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625855">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625861"><a href="/debug/elf/file.go.html#5625794">err</a></span>&nbsp;<span class="op" id="5625865">=</span>&nbsp;<span class="ident" id="5625867"><a href="/debug/elf/file.go.html#5624031">f</a></span><span class="op" id="5625868">.</span><span class="ident" id="5625869">applyRelocations</span><span class="op" id="5625885">(</span><span class="ident" id="5625886"><a href="/debug/elf/file.go.html#5625546">b</a></span><span class="op" id="5625887">,</span>&nbsp;<span class="ident" id="5625889"><a href="/debug/elf/file.go.html#5625790">rd</a></span><span class="op" id="5625891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625897">if</span>&nbsp;<span class="ident" id="5625900"><a href="/debug/elf/file.go.html#5625794">err</a></span>&nbsp;<span class="op" id="5625904">!=</span>&nbsp;<span class="ident" id="5625907">nil</span>&nbsp;<span class="op" id="5625911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5625918">return</span>&nbsp;<span class="ident" id="5625925">nil</span><span class="op" id="5625928">,</span>&nbsp;<span class="ident" id="5625930"><a href="/debug/elf/file.go.html#5625794">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5625943">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5625949"><a href="/debug/elf/file.go.html#5625549">err</a></span>&nbsp;<span class="op" id="5625953">=</span>&nbsp;<span class="ident" id="5625955"><a href="/debug/elf/file.go.html#5625333">d</a></span><span class="op" id="5625956">.</span><span class="ident" id="5625957">AddTypes</span><span class="op" id="5625965">(</span><span class="ident" id="5625966"><a href="/debug/elf/file.go.html#5607903">fmt</a></span><span class="op" id="5625969">.</span><span class="ident" id="5625970">Sprintf</span><span class="op" id="5625977">(</span><span class="string" id="5625978">&#34;types-%d&#34;</span><span class="op" id="5625988">,</span>&nbsp;<span class="ident" id="5625990"><a href="/debug/elf/file.go.html#5625484">i</a></span><span class="op" id="5625991">)</span><span class="op" id="5625992">,</span>&nbsp;<span class="ident" id="5625994"><a href="/debug/elf/file.go.html#5625546">b</a></span><span class="op" id="5625995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5626000">if</span>&nbsp;<span class="ident" id="5626003"><a href="/debug/elf/file.go.html#5625549">err</a></span>&nbsp;<span class="op" id="5626007">!=</span>&nbsp;<span class="ident" id="5626010">nil</span>&nbsp;<span class="op" id="5626014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5626020">return</span>&nbsp;<span class="ident" id="5626027">nil</span><span class="op" id="5626030">,</span>&nbsp;<span class="ident" id="5626032"><a href="/debug/elf/file.go.html#5625549">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5626039">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5626043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5626046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5626050">return</span>&nbsp;<span class="ident" id="5626057"><a href="/debug/elf/file.go.html#5625333">d</a></span><span class="op" id="5626058">,</span>&nbsp;<span class="ident" id="5626060">nil</span><br>
<span class="lineno"></span><span class="op" id="5626064">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5626067">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5626150">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5626171">//</span><br>
<span class="lineno"></span><span class="comment" id="5626174">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5626250">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5626324">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5626370">func</span>&nbsp;<span class="op" id="5626375">(</span><span class="ident" id="5626376">f</span>&nbsp;<span class="op" id="5626378">*</span><span class="ident" id="5626379"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5626383">)</span>&nbsp;<span class="ident" id="5626385">Symbols</span><span class="op" id="5626392">(</span><span class="op" id="5626393">)</span>&nbsp;<span class="op" id="5626395">(</span><span class="op" id="5626396">[</span><span class="op" id="5626397">]</span><span class="ident" id="5626398"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5626404">,</span>&nbsp;<span class="builtintype" id="5626406">error</span><span class="op" id="5626411">)</span>&nbsp;<span class="op" id="5626413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5626416">sym</span><span class="op" id="5626419">,</span>&nbsp;<span class="ident" id="5626421">_</span><span class="op" id="5626422">,</span>&nbsp;<span class="ident" id="5626424">err</span>&nbsp;<span class="op" id="5626428">:=</span>&nbsp;<span class="ident" id="5626431"><a href="/debug/elf/file.go.html#5626376">f</a></span><span class="op" id="5626432">.</span><span class="ident" id="5626433">getSymbols</span><span class="op" id="5626443">(</span><span class="ident" id="5626444"><a href="/debug/elf/elf.go.html#5555076">SHT_SYMTAB</a></span><span class="op" id="5626454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5626457">return</span>&nbsp;<span class="ident" id="5626464"><a href="/debug/elf/file.go.html#5626416">sym</a></span><span class="op" id="5626467">,</span>&nbsp;<span class="ident" id="5626469"><a href="/debug/elf/file.go.html#5626424">err</a></span><br>
<span class="lineno">770</span><span class="op" id="5626473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5626476">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5626546">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5626595">//</span><br>
<span class="lineno">775</span><span class="comment" id="5626598">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5626682">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5626756">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5626802">func</span>&nbsp;<span class="op" id="5626807">(</span><span class="ident" id="5626808">f</span>&nbsp;<span class="op" id="5626810">*</span><span class="ident" id="5626811"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5626815">)</span>&nbsp;<span class="ident" id="5626817">DynamicSymbols</span><span class="op" id="5626831">(</span><span class="op" id="5626832">)</span>&nbsp;<span class="op" id="5626834">(</span><span class="op" id="5626835">[</span><span class="op" id="5626836">]</span><span class="ident" id="5626837"><a href="/debug/elf/file.go.html#5610542">Symbol</a></span><span class="op" id="5626843">,</span>&nbsp;<span class="builtintype" id="5626845">error</span><span class="op" id="5626850">)</span>&nbsp;<span class="op" id="5626852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5626855">sym</span><span class="op" id="5626858">,</span>&nbsp;<span class="ident" id="5626860">_</span><span class="op" id="5626861">,</span>&nbsp;<span class="ident" id="5626863">err</span>&nbsp;<span class="op" id="5626867">:=</span>&nbsp;<span class="ident" id="5626870"><a href="/debug/elf/file.go.html#5626808">f</a></span><span class="op" id="5626871">.</span><span class="ident" id="5626872">getSymbols</span><span class="op" id="5626882">(</span><span class="ident" id="5626883"><a href="/debug/elf/elf.go.html#5555740">SHT_DYNSYM</a></span><span class="op" id="5626893">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5626896">return</span>&nbsp;<span class="ident" id="5626903"><a href="/debug/elf/file.go.html#5626855">sym</a></span><span class="op" id="5626906">,</span>&nbsp;<span class="ident" id="5626908"><a href="/debug/elf/file.go.html#5626863">err</a></span><br>
<span class="lineno"></span><span class="op" id="5626912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5626915">type</span>&nbsp;<span class="ident" id="5626920">ImportedSymbol</span>&nbsp;<span class="keyword" id="5626935">struct</span>&nbsp;<span class="op" id="5626942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5626945">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5626953">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5626961">Version</span>&nbsp;<span class="builtintype" id="5626969">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5626977">Library</span>&nbsp;<span class="builtintype" id="5626985">string</span><br>
<span class="lineno"></span><span class="op" id="5626992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5626995">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5627047">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5627102">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5627156">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5627192">func</span>&nbsp;<span class="op" id="5627197">(</span><span class="ident" id="5627198">f</span>&nbsp;<span class="op" id="5627200">*</span><span class="ident" id="5627201"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5627205">)</span>&nbsp;<span class="ident" id="5627207">ImportedSymbols</span><span class="op" id="5627222">(</span><span class="op" id="5627223">)</span>&nbsp;<span class="op" id="5627225">(</span><span class="op" id="5627226">[</span><span class="op" id="5627227">]</span><span class="ident" id="5627228"><a href="/debug/elf/file.go.html#5626920">ImportedSymbol</a></span><span class="op" id="5627242">,</span>&nbsp;<span class="builtintype" id="5627244">error</span><span class="op" id="5627249">)</span>&nbsp;<span class="op" id="5627251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627254">sym</span><span class="op" id="5627257">,</span>&nbsp;<span class="ident" id="5627259">str</span><span class="op" id="5627262">,</span>&nbsp;<span class="ident" id="5627264">err</span>&nbsp;<span class="op" id="5627268">:=</span>&nbsp;<span class="ident" id="5627271"><a href="/debug/elf/file.go.html#5627198">f</a></span><span class="op" id="5627272">.</span><span class="ident" id="5627273">getSymbols</span><span class="op" id="5627283">(</span><span class="ident" id="5627284"><a href="/debug/elf/elf.go.html#5555740">SHT_DYNSYM</a></span><span class="op" id="5627294">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627297">if</span>&nbsp;<span class="ident" id="5627300"><a href="/debug/elf/file.go.html#5627264">err</a></span>&nbsp;<span class="op" id="5627304">!=</span>&nbsp;<span class="ident" id="5627307">nil</span>&nbsp;<span class="op" id="5627311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627315">return</span>&nbsp;<span class="ident" id="5627322">nil</span><span class="op" id="5627325">,</span>&nbsp;<span class="ident" id="5627327"><a href="/debug/elf/file.go.html#5627264">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5627332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627335"><a href="/debug/elf/file.go.html#5627198">f</a></span><span class="op" id="5627336">.</span><span class="ident" id="5627337">gnuVersionInit</span><span class="op" id="5627351">(</span><span class="ident" id="5627352"><a href="/debug/elf/file.go.html#5627259">str</a></span><span class="op" id="5627355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627358">var</span>&nbsp;<span class="ident" id="5627362">all</span>&nbsp;<span class="op" id="5627366">[</span><span class="op" id="5627367">]</span><span class="ident" id="5627368"><a href="/debug/elf/file.go.html#5626920">ImportedSymbol</a></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627384">for</span>&nbsp;<span class="ident" id="5627388">i</span><span class="op" id="5627389">,</span>&nbsp;<span class="ident" id="5627391">s</span>&nbsp;<span class="op" id="5627393">:=</span>&nbsp;<span class="keyword" id="5627396">range</span>&nbsp;<span class="ident" id="5627402"><a href="/debug/elf/file.go.html#5627254">sym</a></span>&nbsp;<span class="op" id="5627406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627410">if</span>&nbsp;<span class="ident" id="5627413"><a href="/debug/elf/elf.go.html#5603440">ST_BIND</a></span><span class="op" id="5627420">(</span><span class="ident" id="5627421"><a href="/debug/elf/file.go.html#5627391">s</a></span><span class="op" id="5627422">.</span><span class="ident" id="5627423">Info</span><span class="op" id="5627427">)</span>&nbsp;<span class="op" id="5627429">==</span>&nbsp;<span class="ident" id="5627432"><a href="/debug/elf/elf.go.html#5567257">STB_GLOBAL</a></span>&nbsp;<span class="op" id="5627443">&amp;&amp;</span>&nbsp;<span class="ident" id="5627446"><a href="/debug/elf/file.go.html#5627391">s</a></span><span class="op" id="5627447">.</span><span class="ident" id="5627448">Section</span>&nbsp;<span class="op" id="5627456">==</span>&nbsp;<span class="ident" id="5627459"><a href="/debug/elf/elf.go.html#5553839">SHN_UNDEF</a></span>&nbsp;<span class="op" id="5627469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627474"><a href="/debug/elf/file.go.html#5627362">all</a></span>&nbsp;<span class="op" id="5627478">=</span>&nbsp;<span class="builtinfunc" id="5627480">append</span><span class="op" id="5627486">(</span><span class="ident" id="5627487"><a href="/debug/elf/file.go.html#5627362">all</a></span><span class="op" id="5627490">,</span>&nbsp;<span class="ident" id="5627492"><a href="/debug/elf/file.go.html#5626920">ImportedSymbol</a></span><span class="op" id="5627506">{</span><span class="ident" id="5627507">Name</span><span class="op" id="5627511">:</span>&nbsp;<span class="ident" id="5627513"><a href="/debug/elf/file.go.html#5627391">s</a></span><span class="op" id="5627514">.</span><span class="ident" id="5627515">Name</span><span class="op" id="5627519">}</span><span class="op" id="5627520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627525"><a href="/debug/elf/file.go.html#5627198">f</a></span><span class="op" id="5627526">.</span><span class="ident" id="5627527">gnuVersion</span><span class="op" id="5627537">(</span><span class="ident" id="5627538"><a href="/debug/elf/file.go.html#5627388">i</a></span><span class="op" id="5627539">,</span>&nbsp;<span class="op" id="5627541">&amp;</span><span class="ident" id="5627542"><a href="/debug/elf/file.go.html#5627362">all</a></span><span class="op" id="5627545">[</span><span class="builtinfunc" id="5627546">len</span><span class="op" id="5627549">(</span><span class="ident" id="5627550"><a href="/debug/elf/file.go.html#5627362">all</a></span><span class="op" id="5627553">)</span><span class="op" id="5627554">-</span><span class="num" id="5627555">1</span><span class="op" id="5627556">]</span><span class="op" id="5627557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5627561">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5627564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627567">return</span>&nbsp;<span class="ident" id="5627574"><a href="/debug/elf/file.go.html#5627362">all</a></span><span class="op" id="5627577">,</span>&nbsp;<span class="ident" id="5627579">nil</span><br>
<span class="lineno"></span><span class="op" id="5627583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5627586">type</span>&nbsp;<span class="ident" id="5627591">verneed</span>&nbsp;<span class="keyword" id="5627599">struct</span>&nbsp;<span class="op" id="5627606">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627609">File</span>&nbsp;<span class="builtintype" id="5627614">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627622">Name</span>&nbsp;<span class="builtintype" id="5627627">string</span><br>
<span class="lineno"></span><span class="op" id="5627634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5627637">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5627685">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5627720">func</span>&nbsp;<span class="op" id="5627725">(</span><span class="ident" id="5627726">f</span>&nbsp;<span class="op" id="5627728">*</span><span class="ident" id="5627729"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5627733">)</span>&nbsp;<span class="ident" id="5627735">gnuVersionInit</span><span class="op" id="5627749">(</span><span class="ident" id="5627750">str</span>&nbsp;<span class="op" id="5627754">[</span><span class="op" id="5627755">]</span><span class="builtintype" id="5627756">byte</span><span class="op" id="5627760">)</span>&nbsp;<span class="op" id="5627762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5627765">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627801">vn</span>&nbsp;<span class="op" id="5627804">:=</span>&nbsp;<span class="ident" id="5627807"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5627808">.</span><span class="ident" id="5627809">SectionByType</span><span class="op" id="5627822">(</span><span class="ident" id="5627823"><a href="/debug/elf/elf.go.html#5556602">SHT_GNU_VERNEED</a></span><span class="op" id="5627838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627841">if</span>&nbsp;<span class="ident" id="5627844"><a href="/debug/elf/file.go.html#5627801">vn</a></span>&nbsp;<span class="op" id="5627847">==</span>&nbsp;<span class="ident" id="5627850">nil</span>&nbsp;<span class="op" id="5627854">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5627866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627869">d</span><span class="op" id="5627870">,</span>&nbsp;<span class="ident" id="5627872">_</span>&nbsp;<span class="op" id="5627874">:=</span>&nbsp;<span class="ident" id="5627877"><a href="/debug/elf/file.go.html#5627801">vn</a></span><span class="op" id="5627879">.</span><span class="ident" id="5627880">Data</span><span class="op" id="5627884">(</span><span class="op" id="5627885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627889">var</span>&nbsp;<span class="ident" id="5627893">need</span>&nbsp;<span class="op" id="5627898">[</span><span class="op" id="5627899">]</span><span class="ident" id="5627900"><a href="/debug/elf/file.go.html#5627591">verneed</a></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627909">i</span>&nbsp;<span class="op" id="5627911">:=</span>&nbsp;<span class="num" id="5627914">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627917">for</span>&nbsp;<span class="op" id="5627921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627925">if</span>&nbsp;<span class="ident" id="5627928"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5627929">+</span><span class="num" id="5627930">16</span>&nbsp;<span class="op" id="5627933">&gt;</span>&nbsp;<span class="builtinfunc" id="5627935">len</span><span class="op" id="5627938">(</span><span class="ident" id="5627939"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5627940">)</span>&nbsp;<span class="op" id="5627942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5627947">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5627955">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5627959">vers</span>&nbsp;<span class="op" id="5627964">:=</span>&nbsp;<span class="ident" id="5627967"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5627968">.</span><span class="ident" id="5627969">ByteOrder</span><span class="op" id="5627978">.</span><span class="ident" id="5627979">Uint16</span><span class="op" id="5627985">(</span><span class="ident" id="5627986"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5627987">[</span><span class="ident" id="5627988"><a href="/debug/elf/file.go.html#5627909">i</a></span>&nbsp;<span class="op" id="5627990">:</span>&nbsp;<span class="ident" id="5627992"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5627993">+</span><span class="num" id="5627994">2</span><span class="op" id="5627995">]</span><span class="op" id="5627996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628000">if</span>&nbsp;<span class="ident" id="5628003"><a href="/debug/elf/file.go.html#5627959">vers</a></span>&nbsp;<span class="op" id="5628008">!=</span>&nbsp;<span class="num" id="5628011">1</span>&nbsp;<span class="op" id="5628013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628018">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628030">cnt</span>&nbsp;<span class="op" id="5628034">:=</span>&nbsp;<span class="ident" id="5628037"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628038">.</span><span class="ident" id="5628039">ByteOrder</span><span class="op" id="5628048">.</span><span class="ident" id="5628049">Uint16</span><span class="op" id="5628055">(</span><span class="ident" id="5628056"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628057">[</span><span class="ident" id="5628058"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628059">+</span><span class="num" id="5628060">2</span>&nbsp;<span class="op" id="5628062">:</span>&nbsp;<span class="ident" id="5628064"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628065">+</span><span class="num" id="5628066">4</span><span class="op" id="5628067">]</span><span class="op" id="5628068">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628072">fileoff</span>&nbsp;<span class="op" id="5628080">:=</span>&nbsp;<span class="ident" id="5628083"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628084">.</span><span class="ident" id="5628085">ByteOrder</span><span class="op" id="5628094">.</span><span class="ident" id="5628095">Uint32</span><span class="op" id="5628101">(</span><span class="ident" id="5628102"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628103">[</span><span class="ident" id="5628104"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628105">+</span><span class="num" id="5628106">4</span>&nbsp;<span class="op" id="5628108">:</span>&nbsp;<span class="ident" id="5628110"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628111">+</span><span class="num" id="5628112">8</span><span class="op" id="5628113">]</span><span class="op" id="5628114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628118">aux</span>&nbsp;<span class="op" id="5628122">:=</span>&nbsp;<span class="ident" id="5628125"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628126">.</span><span class="ident" id="5628127">ByteOrder</span><span class="op" id="5628136">.</span><span class="ident" id="5628137">Uint32</span><span class="op" id="5628143">(</span><span class="ident" id="5628144"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628145">[</span><span class="ident" id="5628146"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628147">+</span><span class="num" id="5628148">8</span>&nbsp;<span class="op" id="5628150">:</span>&nbsp;<span class="ident" id="5628152"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628153">+</span><span class="num" id="5628154">12</span><span class="op" id="5628156">]</span><span class="op" id="5628157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628161">next</span>&nbsp;<span class="op" id="5628166">:=</span>&nbsp;<span class="ident" id="5628169"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628170">.</span><span class="ident" id="5628171">ByteOrder</span><span class="op" id="5628180">.</span><span class="ident" id="5628181">Uint32</span><span class="op" id="5628187">(</span><span class="ident" id="5628188"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628189">[</span><span class="ident" id="5628190"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628191">+</span><span class="num" id="5628192">12</span>&nbsp;<span class="op" id="5628195">:</span>&nbsp;<span class="ident" id="5628197"><a href="/debug/elf/file.go.html#5627909">i</a></span><span class="op" id="5628198">+</span><span class="num" id="5628199">16</span><span class="op" id="5628201">]</span><span class="op" id="5628202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628206">file</span><span class="op" id="5628210">,</span>&nbsp;<span class="ident" id="5628212">_</span>&nbsp;<span class="op" id="5628214">:=</span>&nbsp;<span class="ident" id="5628217"><a href="/debug/elf/file.go.html#5619897">getString</a></span><span class="op" id="5628226">(</span><span class="ident" id="5628227"><a href="/debug/elf/file.go.html#5627750">str</a></span><span class="op" id="5628230">,</span>&nbsp;<span class="builtintype" id="5628232">int</span><span class="op" id="5628235">(</span><span class="ident" id="5628236"><a href="/debug/elf/file.go.html#5628072">fileoff</a></span><span class="op" id="5628243">)</span><span class="op" id="5628244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628249">var</span>&nbsp;<span class="ident" id="5628253">name</span>&nbsp;<span class="builtintype" id="5628258">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628267">j</span>&nbsp;<span class="op" id="5628269">:=</span>&nbsp;<span class="ident" id="5628272"><a href="/debug/elf/file.go.html#5627909">i</a></span>&nbsp;<span class="op" id="5628274">+</span>&nbsp;<span class="builtintype" id="5628276">int</span><span class="op" id="5628279">(</span><span class="ident" id="5628280"><a href="/debug/elf/file.go.html#5628118">aux</a></span><span class="op" id="5628283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628287">for</span>&nbsp;<span class="ident" id="5628291">c</span>&nbsp;<span class="op" id="5628293">:=</span>&nbsp;<span class="num" id="5628296">0</span><span class="op" id="5628297">;</span>&nbsp;<span class="ident" id="5628299"><a href="/debug/elf/file.go.html#5628291">c</a></span>&nbsp;<span class="op" id="5628301">&lt;</span>&nbsp;<span class="builtintype" id="5628303">int</span><span class="op" id="5628306">(</span><span class="ident" id="5628307"><a href="/debug/elf/file.go.html#5628030">cnt</a></span><span class="op" id="5628310">)</span><span class="op" id="5628311">;</span>&nbsp;<span class="ident" id="5628313"><a href="/debug/elf/file.go.html#5628291">c</a></span><span class="op" id="5628314">++</span>&nbsp;<span class="op" id="5628317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628322">if</span>&nbsp;<span class="ident" id="5628325"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628326">+</span><span class="num" id="5628327">16</span>&nbsp;<span class="op" id="5628330">&gt;</span>&nbsp;<span class="builtinfunc" id="5628332">len</span><span class="op" id="5628335">(</span><span class="ident" id="5628336"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628337">)</span>&nbsp;<span class="op" id="5628339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628345">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5628359">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5628402">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628448">other</span>&nbsp;<span class="op" id="5628454">:=</span>&nbsp;<span class="ident" id="5628457"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628458">.</span><span class="ident" id="5628459">ByteOrder</span><span class="op" id="5628468">.</span><span class="ident" id="5628469">Uint16</span><span class="op" id="5628475">(</span><span class="ident" id="5628476"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628477">[</span><span class="ident" id="5628478"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628479">+</span><span class="num" id="5628480">6</span>&nbsp;<span class="op" id="5628482">:</span>&nbsp;<span class="ident" id="5628484"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628485">+</span><span class="num" id="5628486">8</span><span class="op" id="5628487">]</span><span class="op" id="5628488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628493">nameoff</span>&nbsp;<span class="op" id="5628501">:=</span>&nbsp;<span class="ident" id="5628504"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628505">.</span><span class="ident" id="5628506">ByteOrder</span><span class="op" id="5628515">.</span><span class="ident" id="5628516">Uint32</span><span class="op" id="5628522">(</span><span class="ident" id="5628523"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628524">[</span><span class="ident" id="5628525"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628526">+</span><span class="num" id="5628527">8</span>&nbsp;<span class="op" id="5628529">:</span>&nbsp;<span class="ident" id="5628531"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628532">+</span><span class="num" id="5628533">12</span><span class="op" id="5628535">]</span><span class="op" id="5628536">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628541">next</span>&nbsp;<span class="op" id="5628546">:=</span>&nbsp;<span class="ident" id="5628549"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628550">.</span><span class="ident" id="5628551">ByteOrder</span><span class="op" id="5628560">.</span><span class="ident" id="5628561">Uint32</span><span class="op" id="5628567">(</span><span class="ident" id="5628568"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5628569">[</span><span class="ident" id="5628570"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628571">+</span><span class="num" id="5628572">12</span>&nbsp;<span class="op" id="5628575">:</span>&nbsp;<span class="ident" id="5628577"><a href="/debug/elf/file.go.html#5628267">j</a></span><span class="op" id="5628578">+</span><span class="num" id="5628579">16</span><span class="op" id="5628581">]</span><span class="op" id="5628582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628587"><a href="/debug/elf/file.go.html#5628253">name</a></span><span class="op" id="5628591">,</span>&nbsp;<span class="ident" id="5628593">_</span>&nbsp;<span class="op" id="5628595">=</span>&nbsp;<span class="ident" id="5628597"><a href="/debug/elf/file.go.html#5619897">getString</a></span><span class="op" id="5628606">(</span><span class="ident" id="5628607"><a href="/debug/elf/file.go.html#5627750">str</a></span><span class="op" id="5628610">,</span>&nbsp;<span class="builtintype" id="5628612">int</span><span class="op" id="5628615">(</span><span class="ident" id="5628616"><a href="/debug/elf/file.go.html#5628493">nameoff</a></span><span class="op" id="5628623">)</span><span class="op" id="5628624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628629">ndx</span>&nbsp;<span class="op" id="5628633">:=</span>&nbsp;<span class="builtintype" id="5628636">int</span><span class="op" id="5628639">(</span><span class="ident" id="5628640"><a href="/debug/elf/file.go.html#5628448">other</a></span><span class="op" id="5628645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628650">if</span>&nbsp;<span class="ident" id="5628653"><a href="/debug/elf/file.go.html#5628629">ndx</a></span>&nbsp;<span class="op" id="5628657">&gt;=</span>&nbsp;<span class="builtinfunc" id="5628660">len</span><span class="op" id="5628663">(</span><span class="ident" id="5628664"><a href="/debug/elf/file.go.html#5627893">need</a></span><span class="op" id="5628668">)</span>&nbsp;<span class="op" id="5628670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628676">a</span>&nbsp;<span class="op" id="5628678">:=</span>&nbsp;<span class="builtinfunc" id="5628681">make</span><span class="op" id="5628685">(</span><span class="op" id="5628686">[</span><span class="op" id="5628687">]</span><span class="ident" id="5628688"><a href="/debug/elf/file.go.html#5627591">verneed</a></span><span class="op" id="5628695">,</span>&nbsp;<span class="num" id="5628697">2</span><span class="op" id="5628698">*</span><span class="op" id="5628699">(</span><span class="ident" id="5628700"><a href="/debug/elf/file.go.html#5628629">ndx</a></span><span class="op" id="5628703">+</span><span class="num" id="5628704">1</span><span class="op" id="5628705">)</span><span class="op" id="5628706">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5628712">copy</span><span class="op" id="5628716">(</span><span class="ident" id="5628717"><a href="/debug/elf/file.go.html#5628676">a</a></span><span class="op" id="5628718">,</span>&nbsp;<span class="ident" id="5628720"><a href="/debug/elf/file.go.html#5627893">need</a></span><span class="op" id="5628724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628730"><a href="/debug/elf/file.go.html#5627893">need</a></span>&nbsp;<span class="op" id="5628735">=</span>&nbsp;<span class="ident" id="5628737"><a href="/debug/elf/file.go.html#5628676">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628748"><a href="/debug/elf/file.go.html#5627893">need</a></span><span class="op" id="5628752">[</span><span class="ident" id="5628753"><a href="/debug/elf/file.go.html#5628629">ndx</a></span><span class="op" id="5628756">]</span>&nbsp;<span class="op" id="5628758">=</span>&nbsp;<span class="ident" id="5628760"><a href="/debug/elf/file.go.html#5627591">verneed</a></span><span class="op" id="5628767">{</span><span class="ident" id="5628768"><a href="/debug/elf/file.go.html#5628206">file</a></span><span class="op" id="5628772">,</span>&nbsp;<span class="ident" id="5628774"><a href="/debug/elf/file.go.html#5628253">name</a></span><span class="op" id="5628778">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628783">if</span>&nbsp;<span class="ident" id="5628786"><a href="/debug/elf/file.go.html#5628541">next</a></span>&nbsp;<span class="op" id="5628791">==</span>&nbsp;<span class="num" id="5628794">0</span>&nbsp;<span class="op" id="5628796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628802">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628816"><a href="/debug/elf/file.go.html#5628267">j</a></span>&nbsp;<span class="op" id="5628818">+=</span>&nbsp;<span class="builtintype" id="5628821">int</span><span class="op" id="5628824">(</span><span class="ident" id="5628825"><a href="/debug/elf/file.go.html#5628541">next</a></span><span class="op" id="5628829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628833">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628838">if</span>&nbsp;<span class="ident" id="5628841"><a href="/debug/elf/file.go.html#5628161">next</a></span>&nbsp;<span class="op" id="5628846">==</span>&nbsp;<span class="num" id="5628849">0</span>&nbsp;<span class="op" id="5628851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628856">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628868"><a href="/debug/elf/file.go.html#5627909">i</a></span>&nbsp;<span class="op" id="5628870">+=</span>&nbsp;<span class="builtintype" id="5628873">int</span><span class="op" id="5628876">(</span><span class="ident" id="5628877"><a href="/debug/elf/file.go.html#5628161">next</a></span><span class="op" id="5628881">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5628884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5628888">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5628946">vs</span>&nbsp;<span class="op" id="5628949">:=</span>&nbsp;<span class="ident" id="5628952"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5628953">.</span><span class="ident" id="5628954">SectionByType</span><span class="op" id="5628967">(</span><span class="ident" id="5628968"><a href="/debug/elf/elf.go.html#5556679">SHT_GNU_VERSYM</a></span><span class="op" id="5628982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5628985">if</span>&nbsp;<span class="ident" id="5628988"><a href="/debug/elf/file.go.html#5628946">vs</a></span>&nbsp;<span class="op" id="5628991">==</span>&nbsp;<span class="ident" id="5628994">nil</span>&nbsp;<span class="op" id="5628998">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629002">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5629010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629013"><a href="/debug/elf/file.go.html#5627869">d</a></span><span class="op" id="5629014">,</span>&nbsp;<span class="ident" id="5629016">_</span>&nbsp;<span class="op" id="5629018">=</span>&nbsp;<span class="ident" id="5629020"><a href="/debug/elf/file.go.html#5628946">vs</a></span><span class="op" id="5629022">.</span><span class="ident" id="5629023">Data</span><span class="op" id="5629027">(</span><span class="op" id="5629028">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629032"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5629033">.</span><span class="ident" id="5629034">gnuNeed</span>&nbsp;<span class="op" id="5629042">=</span>&nbsp;<span class="ident" id="5629044"><a href="/debug/elf/file.go.html#5627893">need</a></span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629050"><a href="/debug/elf/file.go.html#5627726">f</a></span><span class="op" id="5629051">.</span><span class="ident" id="5629052">gnuVersym</span>&nbsp;<span class="op" id="5629062">=</span>&nbsp;<span class="ident" id="5629064"><a href="/debug/elf/file.go.html#5627869">d</a></span><br>
<span class="lineno"></span><span class="op" id="5629066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5629069">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5629128">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5629177">func</span>&nbsp;<span class="op" id="5629182">(</span><span class="ident" id="5629183">f</span>&nbsp;<span class="op" id="5629185">*</span><span class="ident" id="5629186"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5629190">)</span>&nbsp;<span class="ident" id="5629192">gnuVersion</span><span class="op" id="5629202">(</span><span class="ident" id="5629203">i</span>&nbsp;<span class="builtintype" id="5629205">int</span><span class="op" id="5629208">,</span>&nbsp;<span class="ident" id="5629210">sym</span>&nbsp;<span class="op" id="5629214">*</span><span class="ident" id="5629215"><a href="/debug/elf/file.go.html#5626920">ImportedSymbol</a></span><span class="op" id="5629229">)</span>&nbsp;<span class="op" id="5629231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5629234">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629263"><a href="/debug/elf/file.go.html#5629203">i</a></span>&nbsp;<span class="op" id="5629265">=</span>&nbsp;<span class="op" id="5629267">(</span><span class="ident" id="5629268"><a href="/debug/elf/file.go.html#5629203">i</a></span>&nbsp;<span class="op" id="5629270">+</span>&nbsp;<span class="num" id="5629272">1</span><span class="op" id="5629273">)</span>&nbsp;<span class="op" id="5629275">*</span>&nbsp;<span class="num" id="5629277">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629280">if</span>&nbsp;<span class="ident" id="5629283"><a href="/debug/elf/file.go.html#5629203">i</a></span>&nbsp;<span class="op" id="5629285">&gt;=</span>&nbsp;<span class="builtinfunc" id="5629288">len</span><span class="op" id="5629291">(</span><span class="ident" id="5629292"><a href="/debug/elf/file.go.html#5629183">f</a></span><span class="op" id="5629293">.</span><span class="ident" id="5629294">gnuVersym</span><span class="op" id="5629303">)</span>&nbsp;<span class="op" id="5629305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629309">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5629317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629320">j</span>&nbsp;<span class="op" id="5629322">:=</span>&nbsp;<span class="builtintype" id="5629325">int</span><span class="op" id="5629328">(</span><span class="ident" id="5629329"><a href="/debug/elf/file.go.html#5629183">f</a></span><span class="op" id="5629330">.</span><span class="ident" id="5629331">ByteOrder</span><span class="op" id="5629340">.</span><span class="ident" id="5629341">Uint16</span><span class="op" id="5629347">(</span><span class="ident" id="5629348"><a href="/debug/elf/file.go.html#5629183">f</a></span><span class="op" id="5629349">.</span><span class="ident" id="5629350">gnuVersym</span><span class="op" id="5629359">[</span><span class="ident" id="5629360"><a href="/debug/elf/file.go.html#5629203">i</a></span><span class="op" id="5629361">:</span><span class="op" id="5629362">]</span><span class="op" id="5629363">)</span><span class="op" id="5629364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629367">if</span>&nbsp;<span class="ident" id="5629370"><a href="/debug/elf/file.go.html#5629320">j</a></span>&nbsp;<span class="op" id="5629372">&lt;</span>&nbsp;<span class="num" id="5629374">2</span>&nbsp;<span class="op" id="5629376">||</span>&nbsp;<span class="ident" id="5629379"><a href="/debug/elf/file.go.html#5629320">j</a></span>&nbsp;<span class="op" id="5629381">&gt;=</span>&nbsp;<span class="builtinfunc" id="5629384">len</span><span class="op" id="5629387">(</span><span class="ident" id="5629388"><a href="/debug/elf/file.go.html#5629183">f</a></span><span class="op" id="5629389">.</span><span class="ident" id="5629390">gnuNeed</span><span class="op" id="5629397">)</span>&nbsp;<span class="op" id="5629399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629403">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5629411">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629414">n</span>&nbsp;<span class="op" id="5629416">:=</span>&nbsp;<span class="op" id="5629419">&amp;</span><span class="ident" id="5629420"><a href="/debug/elf/file.go.html#5629183">f</a></span><span class="op" id="5629421">.</span><span class="ident" id="5629422">gnuNeed</span><span class="op" id="5629429">[</span><span class="ident" id="5629430"><a href="/debug/elf/file.go.html#5629320">j</a></span><span class="op" id="5629431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629434"><a href="/debug/elf/file.go.html#5629210">sym</a></span><span class="op" id="5629437">.</span><span class="ident" id="5629438">Library</span>&nbsp;<span class="op" id="5629446">=</span>&nbsp;<span class="ident" id="5629448"><a href="/debug/elf/file.go.html#5629414">n</a></span><span class="op" id="5629449">.</span><span class="ident" id="5629450">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5629456"><a href="/debug/elf/file.go.html#5629210">sym</a></span><span class="op" id="5629459">.</span><span class="ident" id="5629460">Version</span>&nbsp;<span class="op" id="5629468">=</span>&nbsp;<span class="ident" id="5629470"><a href="/debug/elf/file.go.html#5629414">n</a></span><span class="op" id="5629471">.</span><span class="ident" id="5629472">Name</span><br>
<span class="lineno"></span><span class="op" id="5629477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5629480">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5629536">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5629591">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5629639">func</span>&nbsp;<span class="op" id="5629644">(</span><span class="ident" id="5629645">f</span>&nbsp;<span class="op" id="5629647">*</span><span class="ident" id="5629648"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5629652">)</span>&nbsp;<span class="ident" id="5629654">ImportedLibraries</span><span class="op" id="5629671">(</span><span class="op" id="5629672">)</span>&nbsp;<span class="op" id="5629674">(</span><span class="op" id="5629675">[</span><span class="op" id="5629676">]</span><span class="builtintype" id="5629677">string</span><span class="op" id="5629683">,</span>&nbsp;<span class="builtintype" id="5629685">error</span><span class="op" id="5629690">)</span>&nbsp;<span class="op" id="5629692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629695">return</span>&nbsp;<span class="ident" id="5629702"><a href="/debug/elf/file.go.html#5629645">f</a></span><span class="op" id="5629703">.</span><span class="ident" id="5629704">DynString</span><span class="op" id="5629713">(</span><span class="ident" id="5629714"><a href="/debug/elf/elf.go.html#5561488">DT_NEEDED</a></span><span class="op" id="5629723">)</span><br>
<span class="lineno">905</span><span class="op" id="5629725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5629728">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5629808">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5629820">//</span><br>
<span class="lineno">910</span><span class="comment" id="5629823">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5629907">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5629922">func</span>&nbsp;<span class="op" id="5629927">(</span><span class="ident" id="5629928">f</span>&nbsp;<span class="op" id="5629930">*</span><span class="ident" id="5629931"><a href="/debug/elf/file.go.html#5608291">File</a></span><span class="op" id="5629935">)</span>&nbsp;<span class="ident" id="5629937">DynString</span><span class="op" id="5629946">(</span><span class="ident" id="5629947">tag</span>&nbsp;<span class="ident" id="5629951"><a href="/debug/elf/elf.go.html#5561413">DynTag</a></span><span class="op" id="5629957">)</span>&nbsp;<span class="op" id="5629959">(</span><span class="op" id="5629960">[</span><span class="op" id="5629961">]</span><span class="builtintype" id="5629962">string</span><span class="op" id="5629968">,</span>&nbsp;<span class="builtintype" id="5629970">error</span><span class="op" id="5629975">)</span>&nbsp;<span class="op" id="5629977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629980">switch</span>&nbsp;<span class="ident" id="5629987"><a href="/debug/elf/file.go.html#5629947">tag</a></span>&nbsp;<span class="op" id="5629991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5629994">case</span>&nbsp;<span class="ident" id="5629999"><a href="/debug/elf/elf.go.html#5561488">DT_NEEDED</a></span><span class="op" id="5630008">,</span>&nbsp;<span class="ident" id="5630010"><a href="/debug/elf/elf.go.html#5562380">DT_SONAME</a></span><span class="op" id="5630019">,</span>&nbsp;<span class="ident" id="5630021"><a href="/debug/elf/elf.go.html#5562458">DT_RPATH</a></span><span class="op" id="5630029">,</span>&nbsp;<span class="ident" id="5630031"><a href="/debug/elf/elf.go.html#5563516">DT_RUNPATH</a></span><span class="op" id="5630041">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630044">default</span><span class="op" id="5630051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630055">return</span>&nbsp;<span class="ident" id="5630062">nil</span><span class="op" id="5630065">,</span>&nbsp;<span class="ident" id="5630067"><a href="/debug/elf/file.go.html#5607903">fmt</a></span><span class="op" id="5630070">.</span><span class="ident" id="5630071">Errorf</span><span class="op" id="5630077">(</span><span class="string" id="5630078">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5630104">,</span>&nbsp;<span class="ident" id="5630106"><a href="/debug/elf/file.go.html#5629947">tag</a></span><span class="op" id="5630109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630115">ds</span>&nbsp;<span class="op" id="5630118">:=</span>&nbsp;<span class="ident" id="5630121"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630122">.</span><span class="ident" id="5630123">SectionByType</span><span class="op" id="5630136">(</span><span class="ident" id="5630137"><a href="/debug/elf/elf.go.html#5555380">SHT_DYNAMIC</a></span><span class="op" id="5630148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630151">if</span>&nbsp;<span class="ident" id="5630154"><a href="/debug/elf/file.go.html#5630115">ds</a></span>&nbsp;<span class="op" id="5630157">==</span>&nbsp;<span class="ident" id="5630160">nil</span>&nbsp;<span class="op" id="5630164">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5630168">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630202">return</span>&nbsp;<span class="ident" id="5630209">nil</span><span class="op" id="5630212">,</span>&nbsp;<span class="ident" id="5630214">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630222">d</span><span class="op" id="5630223">,</span>&nbsp;<span class="ident" id="5630225">err</span>&nbsp;<span class="op" id="5630229">:=</span>&nbsp;<span class="ident" id="5630232"><a href="/debug/elf/file.go.html#5630115">ds</a></span><span class="op" id="5630234">.</span><span class="ident" id="5630235">Data</span><span class="op" id="5630239">(</span><span class="op" id="5630240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630243">if</span>&nbsp;<span class="ident" id="5630246"><a href="/debug/elf/file.go.html#5630225">err</a></span>&nbsp;<span class="op" id="5630250">!=</span>&nbsp;<span class="ident" id="5630253">nil</span>&nbsp;<span class="op" id="5630257">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630261">return</span>&nbsp;<span class="ident" id="5630268">nil</span><span class="op" id="5630271">,</span>&nbsp;<span class="ident" id="5630273"><a href="/debug/elf/file.go.html#5630225">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630281">str</span><span class="op" id="5630284">,</span>&nbsp;<span class="ident" id="5630286"><a href="/debug/elf/file.go.html#5630225">err</a></span>&nbsp;<span class="op" id="5630290">:=</span>&nbsp;<span class="ident" id="5630293"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630294">.</span><span class="ident" id="5630295">stringTable</span><span class="op" id="5630306">(</span><span class="ident" id="5630307"><a href="/debug/elf/file.go.html#5630115">ds</a></span><span class="op" id="5630309">.</span><span class="ident" id="5630310">Link</span><span class="op" id="5630314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630317">if</span>&nbsp;<span class="ident" id="5630320"><a href="/debug/elf/file.go.html#5630225">err</a></span>&nbsp;<span class="op" id="5630324">!=</span>&nbsp;<span class="ident" id="5630327">nil</span>&nbsp;<span class="op" id="5630331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630335">return</span>&nbsp;<span class="ident" id="5630342">nil</span><span class="op" id="5630345">,</span>&nbsp;<span class="ident" id="5630347"><a href="/debug/elf/file.go.html#5630225">err</a></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630355">var</span>&nbsp;<span class="ident" id="5630359">all</span>&nbsp;<span class="op" id="5630363">[</span><span class="op" id="5630364">]</span><span class="builtintype" id="5630365">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630373">for</span>&nbsp;<span class="builtinfunc" id="5630377">len</span><span class="op" id="5630380">(</span><span class="ident" id="5630381"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630382">)</span>&nbsp;<span class="op" id="5630384">&gt;</span>&nbsp;<span class="num" id="5630386">0</span>&nbsp;<span class="op" id="5630388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630392">var</span>&nbsp;<span class="ident" id="5630396">t</span>&nbsp;<span class="ident" id="5630398"><a href="/debug/elf/elf.go.html#5561413">DynTag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630407">var</span>&nbsp;<span class="ident" id="5630411">v</span>&nbsp;<span class="ident" id="5630413">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630422">switch</span>&nbsp;<span class="ident" id="5630429"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630430">.</span><span class="ident" id="5630431">Class</span>&nbsp;<span class="op" id="5630437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630441">case</span>&nbsp;<span class="ident" id="5630446"><a href="/debug/elf/elf.go.html#5546498">ELFCLASS32</a></span><span class="op" id="5630456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630461"><a href="/debug/elf/file.go.html#5630396">t</a></span>&nbsp;<span class="op" id="5630463">=</span>&nbsp;<span class="ident" id="5630465"><a href="/debug/elf/elf.go.html#5561413">DynTag</a></span><span class="op" id="5630471">(</span><span class="ident" id="5630472"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630473">.</span><span class="ident" id="5630474">ByteOrder</span><span class="op" id="5630483">.</span><span class="ident" id="5630484">Uint32</span><span class="op" id="5630490">(</span><span class="ident" id="5630491"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630492">[</span><span class="num" id="5630493">0</span><span class="op" id="5630494">:</span><span class="num" id="5630495">4</span><span class="op" id="5630496">]</span><span class="op" id="5630497">)</span><span class="op" id="5630498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630503"><a href="/debug/elf/file.go.html#5630411">v</a></span>&nbsp;<span class="op" id="5630505">=</span>&nbsp;<span class="ident" id="5630507">uint64</span><span class="op" id="5630513">(</span><span class="ident" id="5630514"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630515">.</span><span class="ident" id="5630516">ByteOrder</span><span class="op" id="5630525">.</span><span class="ident" id="5630526">Uint32</span><span class="op" id="5630532">(</span><span class="ident" id="5630533"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630534">[</span><span class="num" id="5630535">4</span><span class="op" id="5630536">:</span><span class="num" id="5630537">8</span><span class="op" id="5630538">]</span><span class="op" id="5630539">)</span><span class="op" id="5630540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630545"><a href="/debug/elf/file.go.html#5630222">d</a></span>&nbsp;<span class="op" id="5630547">=</span>&nbsp;<span class="ident" id="5630549"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630550">[</span><span class="num" id="5630551">8</span><span class="op" id="5630552">:</span><span class="op" id="5630553">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630557">case</span>&nbsp;<span class="ident" id="5630562"><a href="/debug/elf/elf.go.html#5546549">ELFCLASS64</a></span><span class="op" id="5630572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630577"><a href="/debug/elf/file.go.html#5630396">t</a></span>&nbsp;<span class="op" id="5630579">=</span>&nbsp;<span class="ident" id="5630581"><a href="/debug/elf/elf.go.html#5561413">DynTag</a></span><span class="op" id="5630587">(</span><span class="ident" id="5630588"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630589">.</span><span class="ident" id="5630590">ByteOrder</span><span class="op" id="5630599">.</span><span class="ident" id="5630600">Uint64</span><span class="op" id="5630606">(</span><span class="ident" id="5630607"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630608">[</span><span class="num" id="5630609">0</span><span class="op" id="5630610">:</span><span class="num" id="5630611">8</span><span class="op" id="5630612">]</span><span class="op" id="5630613">)</span><span class="op" id="5630614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630619"><a href="/debug/elf/file.go.html#5630411">v</a></span>&nbsp;<span class="op" id="5630621">=</span>&nbsp;<span class="ident" id="5630623"><a href="/debug/elf/file.go.html#5629928">f</a></span><span class="op" id="5630624">.</span><span class="ident" id="5630625">ByteOrder</span><span class="op" id="5630634">.</span><span class="ident" id="5630635">Uint64</span><span class="op" id="5630641">(</span><span class="ident" id="5630642"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630643">[</span><span class="num" id="5630644">8</span><span class="op" id="5630645">:</span><span class="num" id="5630646">16</span><span class="op" id="5630648">]</span><span class="op" id="5630649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630654"><a href="/debug/elf/file.go.html#5630222">d</a></span>&nbsp;<span class="op" id="5630656">=</span>&nbsp;<span class="ident" id="5630658"><a href="/debug/elf/file.go.html#5630222">d</a></span><span class="op" id="5630659">[</span><span class="num" id="5630660">16</span><span class="op" id="5630662">:</span><span class="op" id="5630663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630667">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630671">if</span>&nbsp;<span class="ident" id="5630674"><a href="/debug/elf/file.go.html#5630396">t</a></span>&nbsp;<span class="op" id="5630676">==</span>&nbsp;<span class="ident" id="5630679"><a href="/debug/elf/file.go.html#5629947">tag</a></span>&nbsp;<span class="op" id="5630683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630688">s</span><span class="op" id="5630689">,</span>&nbsp;<span class="ident" id="5630691">ok</span>&nbsp;<span class="op" id="5630694">:=</span>&nbsp;<span class="ident" id="5630697"><a href="/debug/elf/file.go.html#5619897">getString</a></span><span class="op" id="5630706">(</span><span class="ident" id="5630707"><a href="/debug/elf/file.go.html#5630281">str</a></span><span class="op" id="5630710">,</span>&nbsp;<span class="builtintype" id="5630712">int</span><span class="op" id="5630715">(</span><span class="ident" id="5630716"><a href="/debug/elf/file.go.html#5630411">v</a></span><span class="op" id="5630717">)</span><span class="op" id="5630718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630723">if</span>&nbsp;<span class="ident" id="5630726"><a href="/debug/elf/file.go.html#5630691">ok</a></span>&nbsp;<span class="op" id="5630729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5630735"><a href="/debug/elf/file.go.html#5630359">all</a></span>&nbsp;<span class="op" id="5630739">=</span>&nbsp;<span class="builtinfunc" id="5630741">append</span><span class="op" id="5630747">(</span><span class="ident" id="5630748"><a href="/debug/elf/file.go.html#5630359">all</a></span><span class="op" id="5630751">,</span>&nbsp;<span class="ident" id="5630753"><a href="/debug/elf/file.go.html#5630688">s</a></span><span class="op" id="5630754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630759">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5630766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5630769">return</span>&nbsp;<span class="ident" id="5630776"><a href="/debug/elf/file.go.html#5630359">all</a></span><span class="op" id="5630779">,</span>&nbsp;<span class="ident" id="5630781">nil</span><br>
<span class="lineno"></span><span class="op" id="5630785">}</span>
</div>
</body>
</html>
