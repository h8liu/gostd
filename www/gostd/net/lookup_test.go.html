<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html" class="current">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7567705">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7567760">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7567814">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7567865">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="7567929">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7567956">package</span>&nbsp;<span class="ident" id="7567964">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7567969">import</span>&nbsp;<span class="op" id="7567976">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7567979">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7567987">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7567998">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7568008">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7568011">var</span>&nbsp;<span class="ident" id="7568015">testExternal</span>&nbsp;<span class="op" id="7568028">=</span>&nbsp;<span class="ident" id="7568030">flag</span><span class="op" id="7568034">.</span><span class="ident" id="7568035">Bool</span><span class="op" id="7568039">(</span><span class="string" id="7568040">&#34;external&#34;</span><span class="op" id="7568050">,</span>&nbsp;<span class="builtintype" id="7568052">true</span><span class="op" id="7568056">,</span>&nbsp;<span class="string" id="7568058">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="7568107">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7568110">var</span>&nbsp;<span class="ident" id="7568114">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="7568135">=</span>&nbsp;<span class="op" id="7568137">[</span><span class="op" id="7568138">]</span><span class="keyword" id="7568139">struct</span>&nbsp;<span class="op" id="7568146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568149">service</span><span class="op" id="7568156">,</span>&nbsp;<span class="ident" id="7568158">proto</span><span class="op" id="7568163">,</span>&nbsp;<span class="ident" id="7568165">name</span>&nbsp;<span class="builtintype" id="7568170">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568178">cname</span><span class="op" id="7568183">,</span>&nbsp;<span class="ident" id="7568185">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7568199">string</span><br>
<span class="lineno"></span><span class="op" id="7568206">}</span><span class="op" id="7568207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7568214">&#34;xmpp-server&#34;</span><span class="op" id="7568227">,</span>&nbsp;<span class="string" id="7568229">&#34;tcp&#34;</span><span class="op" id="7568234">,</span>&nbsp;<span class="string" id="7568236">&#34;google.com&#34;</span><span class="op" id="7568248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7568252">&#34;.google.com&#34;</span><span class="op" id="7568265">,</span>&nbsp;<span class="string" id="7568267">&#34;.google.com&#34;</span><span class="op" id="7568280">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568283">}</span><span class="op" id="7568284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7568291">&#34;&#34;</span><span class="op" id="7568293">,</span>&nbsp;<span class="string" id="7568295">&#34;&#34;</span><span class="op" id="7568297">,</span>&nbsp;<span class="string" id="7568299">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="7568329">,</span>&nbsp;<span class="comment" id="7568331">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7568359">&#34;.google.com&#34;</span><span class="op" id="7568372">,</span>&nbsp;<span class="string" id="7568374">&#34;.google.com&#34;</span><span class="op" id="7568387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568390">}</span><span class="op" id="7568391">,</span><br>
<span class="lineno">30</span><span class="op" id="7568393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7568396">func</span>&nbsp;<span class="ident" id="7568401">TestLookupGoogleSRV</span><span class="op" id="7568420">(</span><span class="ident" id="7568421">t</span>&nbsp;<span class="op" id="7568423">*</span><span class="ident" id="7568424">testing</span><span class="op" id="7568431">.</span><span class="ident" id="7568432">T</span><span class="op" id="7568433">)</span>&nbsp;<span class="op" id="7568435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568438">if</span>&nbsp;<span class="ident" id="7568441">testing</span><span class="op" id="7568448">.</span><span class="ident" id="7568449">Short</span><span class="op" id="7568454">(</span><span class="op" id="7568455">)</span>&nbsp;<span class="op" id="7568457">||</span>&nbsp;<span class="op" id="7568460">!</span><span class="op" id="7568461">*</span><span class="ident" id="7568462">testExternal</span>&nbsp;<span class="op" id="7568475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568479">t</span><span class="op" id="7568480">.</span><span class="ident" id="7568481">Skip</span><span class="op" id="7568485">(</span><span class="string" id="7568486">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7568527">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568534">for</span>&nbsp;<span class="ident" id="7568538">_</span><span class="op" id="7568539">,</span>&nbsp;<span class="ident" id="7568541">tt</span>&nbsp;<span class="op" id="7568544">:=</span>&nbsp;<span class="keyword" id="7568547">range</span>&nbsp;<span class="ident" id="7568553">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="7568574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568578">cname</span><span class="op" id="7568583">,</span>&nbsp;<span class="ident" id="7568585">srvs</span><span class="op" id="7568589">,</span>&nbsp;<span class="ident" id="7568591">err</span>&nbsp;<span class="op" id="7568595">:=</span>&nbsp;<span class="ident" id="7568598">LookupSRV</span><span class="op" id="7568607">(</span><span class="ident" id="7568608">tt</span><span class="op" id="7568610">.</span><span class="ident" id="7568611">service</span><span class="op" id="7568618">,</span>&nbsp;<span class="ident" id="7568620">tt</span><span class="op" id="7568622">.</span><span class="ident" id="7568623">proto</span><span class="op" id="7568628">,</span>&nbsp;<span class="ident" id="7568630">tt</span><span class="op" id="7568632">.</span><span class="ident" id="7568633">name</span><span class="op" id="7568637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568641">if</span>&nbsp;<span class="ident" id="7568644">err</span>&nbsp;<span class="op" id="7568648">!=</span>&nbsp;<span class="ident" id="7568651">nil</span>&nbsp;<span class="op" id="7568655">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568660">t</span><span class="op" id="7568661">.</span><span class="ident" id="7568662">Fatal</span><span class="op" id="7568667">(</span><span class="ident" id="7568668">err</span><span class="op" id="7568671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568679">if</span>&nbsp;<span class="builtinfunc" id="7568682">len</span><span class="op" id="7568685">(</span><span class="ident" id="7568686">srvs</span><span class="op" id="7568690">)</span>&nbsp;<span class="op" id="7568692">==</span>&nbsp;<span class="num" id="7568695">0</span>&nbsp;<span class="op" id="7568697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568702">t</span><span class="op" id="7568703">.</span><span class="ident" id="7568704">Error</span><span class="op" id="7568709">(</span><span class="string" id="7568710">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7568725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568729">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568733">if</span>&nbsp;<span class="op" id="7568736">!</span><span class="ident" id="7568737">strings</span><span class="op" id="7568744">.</span><span class="ident" id="7568745">Contains</span><span class="op" id="7568753">(</span><span class="ident" id="7568754">cname</span><span class="op" id="7568759">,</span>&nbsp;<span class="ident" id="7568761">tt</span><span class="op" id="7568763">.</span><span class="ident" id="7568764">cname</span><span class="op" id="7568769">)</span>&nbsp;<span class="op" id="7568771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568776">t</span><span class="op" id="7568777">.</span><span class="ident" id="7568778">Errorf</span><span class="op" id="7568784">(</span><span class="string" id="7568785">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7568802">,</span>&nbsp;<span class="ident" id="7568804">cname</span><span class="op" id="7568809">,</span>&nbsp;<span class="ident" id="7568811">tt</span><span class="op" id="7568813">.</span><span class="ident" id="7568814">cname</span><span class="op" id="7568819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568827">for</span>&nbsp;<span class="ident" id="7568831">_</span><span class="op" id="7568832">,</span>&nbsp;<span class="ident" id="7568834">srv</span>&nbsp;<span class="op" id="7568838">:=</span>&nbsp;<span class="keyword" id="7568841">range</span>&nbsp;<span class="ident" id="7568847">srvs</span>&nbsp;<span class="op" id="7568852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7568857">if</span>&nbsp;<span class="op" id="7568860">!</span><span class="ident" id="7568861">strings</span><span class="op" id="7568868">.</span><span class="ident" id="7568869">Contains</span><span class="op" id="7568877">(</span><span class="ident" id="7568878">srv</span><span class="op" id="7568881">.</span><span class="ident" id="7568882">Target</span><span class="op" id="7568888">,</span>&nbsp;<span class="ident" id="7568890">tt</span><span class="op" id="7568892">.</span><span class="ident" id="7568893">target</span><span class="op" id="7568899">)</span>&nbsp;<span class="op" id="7568901">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7568907">t</span><span class="op" id="7568908">.</span><span class="ident" id="7568909">Errorf</span><span class="op" id="7568915">(</span><span class="string" id="7568916">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="7568953">,</span>&nbsp;<span class="ident" id="7568955">srv</span><span class="op" id="7568958">,</span>&nbsp;<span class="ident" id="7568960">tt</span><span class="op" id="7568962">.</span><span class="ident" id="7568963">target</span><span class="op" id="7568969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7568981">}</span><br>
<span class="lineno"></span><span class="op" id="7568983">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7568986">func</span>&nbsp;<span class="ident" id="7568991">TestLookupGmailMX</span><span class="op" id="7569008">(</span><span class="ident" id="7569009">t</span>&nbsp;<span class="op" id="7569011">*</span><span class="ident" id="7569012">testing</span><span class="op" id="7569019">.</span><span class="ident" id="7569020">T</span><span class="op" id="7569021">)</span>&nbsp;<span class="op" id="7569023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569026">if</span>&nbsp;<span class="ident" id="7569029">testing</span><span class="op" id="7569036">.</span><span class="ident" id="7569037">Short</span><span class="op" id="7569042">(</span><span class="op" id="7569043">)</span>&nbsp;<span class="op" id="7569045">||</span>&nbsp;<span class="op" id="7569048">!</span><span class="op" id="7569049">*</span><span class="ident" id="7569050">testExternal</span>&nbsp;<span class="op" id="7569063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569067">t</span><span class="op" id="7569068">.</span><span class="ident" id="7569069">Skip</span><span class="op" id="7569073">(</span><span class="string" id="7569074">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7569115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569118">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569122">mxs</span><span class="op" id="7569125">,</span>&nbsp;<span class="ident" id="7569127">err</span>&nbsp;<span class="op" id="7569131">:=</span>&nbsp;<span class="ident" id="7569134">LookupMX</span><span class="op" id="7569142">(</span><span class="string" id="7569143">&#34;gmail.com&#34;</span><span class="op" id="7569154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569157">if</span>&nbsp;<span class="ident" id="7569160">err</span>&nbsp;<span class="op" id="7569164">!=</span>&nbsp;<span class="ident" id="7569167">nil</span>&nbsp;<span class="op" id="7569171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569175">t</span><span class="op" id="7569176">.</span><span class="ident" id="7569177">Fatal</span><span class="op" id="7569182">(</span><span class="ident" id="7569183">err</span><span class="op" id="7569186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569189">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569192">if</span>&nbsp;<span class="builtinfunc" id="7569195">len</span><span class="op" id="7569198">(</span><span class="ident" id="7569199">mxs</span><span class="op" id="7569202">)</span>&nbsp;<span class="op" id="7569204">==</span>&nbsp;<span class="num" id="7569207">0</span>&nbsp;<span class="op" id="7569209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569213">t</span><span class="op" id="7569214">.</span><span class="ident" id="7569215">Error</span><span class="op" id="7569220">(</span><span class="string" id="7569221">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7569236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569242">for</span>&nbsp;<span class="ident" id="7569246">_</span><span class="op" id="7569247">,</span>&nbsp;<span class="ident" id="7569249">mx</span>&nbsp;<span class="op" id="7569252">:=</span>&nbsp;<span class="keyword" id="7569255">range</span>&nbsp;<span class="ident" id="7569261">mxs</span>&nbsp;<span class="op" id="7569265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569269">if</span>&nbsp;<span class="op" id="7569272">!</span><span class="ident" id="7569273">strings</span><span class="op" id="7569280">.</span><span class="ident" id="7569281">Contains</span><span class="op" id="7569289">(</span><span class="ident" id="7569290">mx</span><span class="op" id="7569292">.</span><span class="ident" id="7569293">Host</span><span class="op" id="7569297">,</span>&nbsp;<span class="string" id="7569299">&#34;.google.com&#34;</span><span class="op" id="7569312">)</span>&nbsp;<span class="op" id="7569314">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569319">t</span><span class="op" id="7569320">.</span><span class="ident" id="7569321">Errorf</span><span class="op" id="7569327">(</span><span class="string" id="7569328">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="7569375">,</span>&nbsp;<span class="ident" id="7569377">mx</span><span class="op" id="7569379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569386">}</span><br>
<span class="lineno"></span><span class="op" id="7569388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7569391">func</span>&nbsp;<span class="ident" id="7569396">TestLookupGmailNS</span><span class="op" id="7569413">(</span><span class="ident" id="7569414">t</span>&nbsp;<span class="op" id="7569416">*</span><span class="ident" id="7569417">testing</span><span class="op" id="7569424">.</span><span class="ident" id="7569425">T</span><span class="op" id="7569426">)</span>&nbsp;<span class="op" id="7569428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569431">if</span>&nbsp;<span class="ident" id="7569434">testing</span><span class="op" id="7569441">.</span><span class="ident" id="7569442">Short</span><span class="op" id="7569447">(</span><span class="op" id="7569448">)</span>&nbsp;<span class="op" id="7569450">||</span>&nbsp;<span class="op" id="7569453">!</span><span class="op" id="7569454">*</span><span class="ident" id="7569455">testExternal</span>&nbsp;<span class="op" id="7569468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569472">t</span><span class="op" id="7569473">.</span><span class="ident" id="7569474">Skip</span><span class="op" id="7569478">(</span><span class="string" id="7569479">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7569520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569527">nss</span><span class="op" id="7569530">,</span>&nbsp;<span class="ident" id="7569532">err</span>&nbsp;<span class="op" id="7569536">:=</span>&nbsp;<span class="ident" id="7569539">LookupNS</span><span class="op" id="7569547">(</span><span class="string" id="7569548">&#34;gmail.com&#34;</span><span class="op" id="7569559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569562">if</span>&nbsp;<span class="ident" id="7569565">err</span>&nbsp;<span class="op" id="7569569">!=</span>&nbsp;<span class="ident" id="7569572">nil</span>&nbsp;<span class="op" id="7569576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569580">t</span><span class="op" id="7569581">.</span><span class="ident" id="7569582">Fatal</span><span class="op" id="7569587">(</span><span class="ident" id="7569588">err</span><span class="op" id="7569591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569597">if</span>&nbsp;<span class="builtinfunc" id="7569600">len</span><span class="op" id="7569603">(</span><span class="ident" id="7569604">nss</span><span class="op" id="7569607">)</span>&nbsp;<span class="op" id="7569609">==</span>&nbsp;<span class="num" id="7569612">0</span>&nbsp;<span class="op" id="7569614">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569618">t</span><span class="op" id="7569619">.</span><span class="ident" id="7569620">Error</span><span class="op" id="7569625">(</span><span class="string" id="7569626">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7569641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569647">for</span>&nbsp;<span class="ident" id="7569651">_</span><span class="op" id="7569652">,</span>&nbsp;<span class="ident" id="7569654">ns</span>&nbsp;<span class="op" id="7569657">:=</span>&nbsp;<span class="keyword" id="7569660">range</span>&nbsp;<span class="ident" id="7569666">nss</span>&nbsp;<span class="op" id="7569670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569674">if</span>&nbsp;<span class="op" id="7569677">!</span><span class="ident" id="7569678">strings</span><span class="op" id="7569685">.</span><span class="ident" id="7569686">Contains</span><span class="op" id="7569694">(</span><span class="ident" id="7569695">ns</span><span class="op" id="7569697">.</span><span class="ident" id="7569698">Host</span><span class="op" id="7569702">,</span>&nbsp;<span class="string" id="7569704">&#34;.google.com&#34;</span><span class="op" id="7569717">)</span>&nbsp;<span class="op" id="7569719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569724">t</span><span class="op" id="7569725">.</span><span class="ident" id="7569726">Errorf</span><span class="op" id="7569732">(</span><span class="string" id="7569733">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="7569780">,</span>&nbsp;<span class="ident" id="7569782">ns</span><span class="op" id="7569784">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569791">}</span><br>
<span class="lineno"></span><span class="op" id="7569793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7569796">func</span>&nbsp;<span class="ident" id="7569801">TestLookupGmailTXT</span><span class="op" id="7569819">(</span><span class="ident" id="7569820">t</span>&nbsp;<span class="op" id="7569822">*</span><span class="ident" id="7569823">testing</span><span class="op" id="7569830">.</span><span class="ident" id="7569831">T</span><span class="op" id="7569832">)</span>&nbsp;<span class="op" id="7569834">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569837">if</span>&nbsp;<span class="ident" id="7569840">testing</span><span class="op" id="7569847">.</span><span class="ident" id="7569848">Short</span><span class="op" id="7569853">(</span><span class="op" id="7569854">)</span>&nbsp;<span class="op" id="7569856">||</span>&nbsp;<span class="op" id="7569859">!</span><span class="op" id="7569860">*</span><span class="ident" id="7569861">testExternal</span>&nbsp;<span class="op" id="7569874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569878">t</span><span class="op" id="7569879">.</span><span class="ident" id="7569880">Skip</span><span class="op" id="7569884">(</span><span class="string" id="7569885">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7569926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7569929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569933">txts</span><span class="op" id="7569937">,</span>&nbsp;<span class="ident" id="7569939">err</span>&nbsp;<span class="op" id="7569943">:=</span>&nbsp;<span class="ident" id="7569946">LookupTXT</span><span class="op" id="7569955">(</span><span class="string" id="7569956">&#34;gmail.com&#34;</span><span class="op" id="7569967">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7569970">if</span>&nbsp;<span class="ident" id="7569973">err</span>&nbsp;<span class="op" id="7569977">!=</span>&nbsp;<span class="ident" id="7569980">nil</span>&nbsp;<span class="op" id="7569984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7569988">t</span><span class="op" id="7569989">.</span><span class="ident" id="7569990">Fatal</span><span class="op" id="7569995">(</span><span class="ident" id="7569996">err</span><span class="op" id="7569999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570005">if</span>&nbsp;<span class="builtinfunc" id="7570008">len</span><span class="op" id="7570011">(</span><span class="ident" id="7570012">txts</span><span class="op" id="7570016">)</span>&nbsp;<span class="op" id="7570018">==</span>&nbsp;<span class="num" id="7570021">0</span>&nbsp;<span class="op" id="7570023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570027">t</span><span class="op" id="7570028">.</span><span class="ident" id="7570029">Error</span><span class="op" id="7570034">(</span><span class="string" id="7570035">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7570050">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570056">for</span>&nbsp;<span class="ident" id="7570060">_</span><span class="op" id="7570061">,</span>&nbsp;<span class="ident" id="7570063">txt</span>&nbsp;<span class="op" id="7570067">:=</span>&nbsp;<span class="keyword" id="7570070">range</span>&nbsp;<span class="ident" id="7570076">txts</span>&nbsp;<span class="op" id="7570081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570085">if</span>&nbsp;<span class="op" id="7570088">!</span><span class="ident" id="7570089">strings</span><span class="op" id="7570096">.</span><span class="ident" id="7570097">Contains</span><span class="op" id="7570105">(</span><span class="ident" id="7570106">txt</span><span class="op" id="7570109">,</span>&nbsp;<span class="string" id="7570111">&#34;spf&#34;</span><span class="op" id="7570116">)</span>&nbsp;<span class="op" id="7570118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570123">t</span><span class="op" id="7570124">.</span><span class="ident" id="7570125">Errorf</span><span class="op" id="7570131">(</span><span class="string" id="7570132">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="7570159">,</span>&nbsp;<span class="ident" id="7570161">txt</span><span class="op" id="7570164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570168">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570171">}</span><br>
<span class="lineno"></span><span class="op" id="7570173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7570176">var</span>&nbsp;<span class="ident" id="7570180">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="7570207">=</span>&nbsp;<span class="op" id="7570209">[</span><span class="op" id="7570210">]</span><span class="keyword" id="7570211">struct</span>&nbsp;<span class="op" id="7570218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570221">addr</span>&nbsp;<span class="builtintype" id="7570226">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570234">name</span>&nbsp;<span class="builtintype" id="7570239">string</span><br>
<span class="lineno"></span><span class="op" id="7570246">}</span><span class="op" id="7570247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570250">{</span><span class="string" id="7570251">&#34;8.8.8.8&#34;</span><span class="op" id="7570260">,</span>&nbsp;<span class="string" id="7570262">&#34;.google.com.&#34;</span><span class="op" id="7570276">}</span><span class="op" id="7570277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570280">{</span><span class="string" id="7570281">&#34;8.8.4.4&#34;</span><span class="op" id="7570290">,</span>&nbsp;<span class="string" id="7570292">&#34;.google.com.&#34;</span><span class="op" id="7570306">}</span><span class="op" id="7570307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570310">{</span><span class="string" id="7570311">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="7570333">,</span>&nbsp;<span class="string" id="7570335">&#34;.google.com.&#34;</span><span class="op" id="7570349">}</span><span class="op" id="7570350">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570353">{</span><span class="string" id="7570354">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="7570376">,</span>&nbsp;<span class="string" id="7570378">&#34;.google.com.&#34;</span><span class="op" id="7570392">}</span><span class="op" id="7570393">,</span><br>
<span class="lineno"></span><span class="op" id="7570395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7570398">func</span>&nbsp;<span class="ident" id="7570403">TestLookupGooglePublicDNSAddr</span><span class="op" id="7570432">(</span><span class="ident" id="7570433">t</span>&nbsp;<span class="op" id="7570435">*</span><span class="ident" id="7570436">testing</span><span class="op" id="7570443">.</span><span class="ident" id="7570444">T</span><span class="op" id="7570445">)</span>&nbsp;<span class="op" id="7570447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570450">if</span>&nbsp;<span class="ident" id="7570453">testing</span><span class="op" id="7570460">.</span><span class="ident" id="7570461">Short</span><span class="op" id="7570466">(</span><span class="op" id="7570467">)</span>&nbsp;<span class="op" id="7570469">||</span>&nbsp;<span class="op" id="7570472">!</span><span class="op" id="7570473">*</span><span class="ident" id="7570474">testExternal</span>&nbsp;<span class="op" id="7570487">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570491">t</span><span class="op" id="7570492">.</span><span class="ident" id="7570493">Skip</span><span class="op" id="7570497">(</span><span class="string" id="7570498">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7570539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570546">for</span>&nbsp;<span class="ident" id="7570550">_</span><span class="op" id="7570551">,</span>&nbsp;<span class="ident" id="7570553">tt</span>&nbsp;<span class="op" id="7570556">:=</span>&nbsp;<span class="keyword" id="7570559">range</span>&nbsp;<span class="ident" id="7570565">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="7570592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570596">names</span><span class="op" id="7570601">,</span>&nbsp;<span class="ident" id="7570603">err</span>&nbsp;<span class="op" id="7570607">:=</span>&nbsp;<span class="ident" id="7570610">LookupAddr</span><span class="op" id="7570620">(</span><span class="ident" id="7570621">tt</span><span class="op" id="7570623">.</span><span class="ident" id="7570624">addr</span><span class="op" id="7570628">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570632">if</span>&nbsp;<span class="ident" id="7570635">err</span>&nbsp;<span class="op" id="7570639">!=</span>&nbsp;<span class="ident" id="7570642">nil</span>&nbsp;<span class="op" id="7570646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570651">t</span><span class="op" id="7570652">.</span><span class="ident" id="7570653">Fatal</span><span class="op" id="7570658">(</span><span class="ident" id="7570659">err</span><span class="op" id="7570662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570670">if</span>&nbsp;<span class="builtinfunc" id="7570673">len</span><span class="op" id="7570676">(</span><span class="ident" id="7570677">names</span><span class="op" id="7570682">)</span>&nbsp;<span class="op" id="7570684">==</span>&nbsp;<span class="num" id="7570687">0</span>&nbsp;<span class="op" id="7570689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570694">t</span><span class="op" id="7570695">.</span><span class="ident" id="7570696">Error</span><span class="op" id="7570701">(</span><span class="string" id="7570702">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7570717">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570725">for</span>&nbsp;<span class="ident" id="7570729">_</span><span class="op" id="7570730">,</span>&nbsp;<span class="ident" id="7570732">name</span>&nbsp;<span class="op" id="7570737">:=</span>&nbsp;<span class="keyword" id="7570740">range</span>&nbsp;<span class="ident" id="7570746">names</span>&nbsp;<span class="op" id="7570752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570757">if</span>&nbsp;<span class="op" id="7570760">!</span><span class="ident" id="7570761">strings</span><span class="op" id="7570768">.</span><span class="ident" id="7570769">HasSuffix</span><span class="op" id="7570778">(</span><span class="ident" id="7570779">name</span><span class="op" id="7570783">,</span>&nbsp;<span class="ident" id="7570785">tt</span><span class="op" id="7570787">.</span><span class="ident" id="7570788">name</span><span class="op" id="7570792">)</span>&nbsp;<span class="op" id="7570794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570800">t</span><span class="op" id="7570801">.</span><span class="ident" id="7570802">Errorf</span><span class="op" id="7570808">(</span><span class="string" id="7570809">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="7570846">,</span>&nbsp;<span class="ident" id="7570848">name</span><span class="op" id="7570852">,</span>&nbsp;<span class="ident" id="7570854">tt</span><span class="op" id="7570856">.</span><span class="ident" id="7570857">name</span><span class="op" id="7570861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570866">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7570873">}</span><br>
<span class="lineno"></span><span class="op" id="7570875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7570878">func</span>&nbsp;<span class="ident" id="7570883">TestLookupIANACNAME</span><span class="op" id="7570902">(</span><span class="ident" id="7570903">t</span>&nbsp;<span class="op" id="7570905">*</span><span class="ident" id="7570906">testing</span><span class="op" id="7570913">.</span><span class="ident" id="7570914">T</span><span class="op" id="7570915">)</span>&nbsp;<span class="op" id="7570917">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7570920">if</span>&nbsp;<span class="ident" id="7570923">testing</span><span class="op" id="7570930">.</span><span class="ident" id="7570931">Short</span><span class="op" id="7570936">(</span><span class="op" id="7570937">)</span>&nbsp;<span class="op" id="7570939">||</span>&nbsp;<span class="op" id="7570942">!</span><span class="op" id="7570943">*</span><span class="ident" id="7570944">testExternal</span>&nbsp;<span class="op" id="7570957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7570961">t</span><span class="op" id="7570962">.</span><span class="ident" id="7570963">Skip</span><span class="op" id="7570967">(</span><span class="string" id="7570968">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7571009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571016">cname</span><span class="op" id="7571021">,</span>&nbsp;<span class="ident" id="7571023">err</span>&nbsp;<span class="op" id="7571027">:=</span>&nbsp;<span class="ident" id="7571030">LookupCNAME</span><span class="op" id="7571041">(</span><span class="string" id="7571042">&#34;www.iana.org&#34;</span><span class="op" id="7571056">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571059">if</span>&nbsp;<span class="ident" id="7571062">err</span>&nbsp;<span class="op" id="7571066">!=</span>&nbsp;<span class="ident" id="7571069">nil</span>&nbsp;<span class="op" id="7571073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571077">t</span><span class="op" id="7571078">.</span><span class="ident" id="7571079">Fatal</span><span class="op" id="7571084">(</span><span class="ident" id="7571085">err</span><span class="op" id="7571088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571094">if</span>&nbsp;<span class="op" id="7571097">!</span><span class="ident" id="7571098">strings</span><span class="op" id="7571105">.</span><span class="ident" id="7571106">HasSuffix</span><span class="op" id="7571115">(</span><span class="ident" id="7571116">cname</span><span class="op" id="7571121">,</span>&nbsp;<span class="string" id="7571123">&#34;.icann.org.&#34;</span><span class="op" id="7571136">)</span>&nbsp;<span class="op" id="7571138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571142">t</span><span class="op" id="7571143">.</span><span class="ident" id="7571144">Errorf</span><span class="op" id="7571150">(</span><span class="string" id="7571151">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="7571197">,</span>&nbsp;<span class="ident" id="7571199">cname</span><span class="op" id="7571204">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571207">}</span><br>
<span class="lineno"></span><span class="op" id="7571209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7571212">func</span>&nbsp;<span class="ident" id="7571217">TestLookupGoogleHost</span><span class="op" id="7571237">(</span><span class="ident" id="7571238">t</span>&nbsp;<span class="op" id="7571240">*</span><span class="ident" id="7571241">testing</span><span class="op" id="7571248">.</span><span class="ident" id="7571249">T</span><span class="op" id="7571250">)</span>&nbsp;<span class="op" id="7571252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571255">if</span>&nbsp;<span class="ident" id="7571258">testing</span><span class="op" id="7571265">.</span><span class="ident" id="7571266">Short</span><span class="op" id="7571271">(</span><span class="op" id="7571272">)</span>&nbsp;<span class="op" id="7571274">||</span>&nbsp;<span class="op" id="7571277">!</span><span class="op" id="7571278">*</span><span class="ident" id="7571279">testExternal</span>&nbsp;<span class="op" id="7571292">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571296">t</span><span class="op" id="7571297">.</span><span class="ident" id="7571298">Skip</span><span class="op" id="7571302">(</span><span class="string" id="7571303">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7571344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571351">addrs</span><span class="op" id="7571356">,</span>&nbsp;<span class="ident" id="7571358">err</span>&nbsp;<span class="op" id="7571362">:=</span>&nbsp;<span class="ident" id="7571365">LookupHost</span><span class="op" id="7571375">(</span><span class="string" id="7571376">&#34;google.com&#34;</span><span class="op" id="7571388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571391">if</span>&nbsp;<span class="ident" id="7571394">err</span>&nbsp;<span class="op" id="7571398">!=</span>&nbsp;<span class="ident" id="7571401">nil</span>&nbsp;<span class="op" id="7571405">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571409">t</span><span class="op" id="7571410">.</span><span class="ident" id="7571411">Fatal</span><span class="op" id="7571416">(</span><span class="ident" id="7571417">err</span><span class="op" id="7571420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571426">if</span>&nbsp;<span class="builtinfunc" id="7571429">len</span><span class="op" id="7571432">(</span><span class="ident" id="7571433">addrs</span><span class="op" id="7571438">)</span>&nbsp;<span class="op" id="7571440">==</span>&nbsp;<span class="num" id="7571443">0</span>&nbsp;<span class="op" id="7571445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571449">t</span><span class="op" id="7571450">.</span><span class="ident" id="7571451">Error</span><span class="op" id="7571456">(</span><span class="string" id="7571457">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7571472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571475">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571478">for</span>&nbsp;<span class="ident" id="7571482">_</span><span class="op" id="7571483">,</span>&nbsp;<span class="ident" id="7571485">addr</span>&nbsp;<span class="op" id="7571490">:=</span>&nbsp;<span class="keyword" id="7571493">range</span>&nbsp;<span class="ident" id="7571499">addrs</span>&nbsp;<span class="op" id="7571505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571509">if</span>&nbsp;<span class="ident" id="7571512">ParseIP</span><span class="op" id="7571519">(</span><span class="ident" id="7571520">addr</span><span class="op" id="7571524">)</span>&nbsp;<span class="op" id="7571526">==</span>&nbsp;<span class="ident" id="7571529">nil</span>&nbsp;<span class="op" id="7571533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571538">t</span><span class="op" id="7571539">.</span><span class="ident" id="7571540">Errorf</span><span class="op" id="7571546">(</span><span class="string" id="7571547">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="7571582">,</span>&nbsp;<span class="ident" id="7571584">addr</span><span class="op" id="7571588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571595">}</span><br>
<span class="lineno">175</span><span class="op" id="7571597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7571600">func</span>&nbsp;<span class="ident" id="7571605">TestLookupGoogleIP</span><span class="op" id="7571623">(</span><span class="ident" id="7571624">t</span>&nbsp;<span class="op" id="7571626">*</span><span class="ident" id="7571627">testing</span><span class="op" id="7571634">.</span><span class="ident" id="7571635">T</span><span class="op" id="7571636">)</span>&nbsp;<span class="op" id="7571638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571641">if</span>&nbsp;<span class="ident" id="7571644">testing</span><span class="op" id="7571651">.</span><span class="ident" id="7571652">Short</span><span class="op" id="7571657">(</span><span class="op" id="7571658">)</span>&nbsp;<span class="op" id="7571660">||</span>&nbsp;<span class="op" id="7571663">!</span><span class="op" id="7571664">*</span><span class="ident" id="7571665">testExternal</span>&nbsp;<span class="op" id="7571678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571682">t</span><span class="op" id="7571683">.</span><span class="ident" id="7571684">Skip</span><span class="op" id="7571688">(</span><span class="string" id="7571689">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7571730">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571737">ips</span><span class="op" id="7571740">,</span>&nbsp;<span class="ident" id="7571742">err</span>&nbsp;<span class="op" id="7571746">:=</span>&nbsp;<span class="ident" id="7571749">LookupIP</span><span class="op" id="7571757">(</span><span class="string" id="7571758">&#34;google.com&#34;</span><span class="op" id="7571770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571773">if</span>&nbsp;<span class="ident" id="7571776">err</span>&nbsp;<span class="op" id="7571780">!=</span>&nbsp;<span class="ident" id="7571783">nil</span>&nbsp;<span class="op" id="7571787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571791">t</span><span class="op" id="7571792">.</span><span class="ident" id="7571793">Fatal</span><span class="op" id="7571798">(</span><span class="ident" id="7571799">err</span><span class="op" id="7571802">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571808">if</span>&nbsp;<span class="builtinfunc" id="7571811">len</span><span class="op" id="7571814">(</span><span class="ident" id="7571815">ips</span><span class="op" id="7571818">)</span>&nbsp;<span class="op" id="7571820">==</span>&nbsp;<span class="num" id="7571823">0</span>&nbsp;<span class="op" id="7571825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571829">t</span><span class="op" id="7571830">.</span><span class="ident" id="7571831">Error</span><span class="op" id="7571836">(</span><span class="string" id="7571837">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7571852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571858">for</span>&nbsp;<span class="ident" id="7571862">_</span><span class="op" id="7571863">,</span>&nbsp;<span class="ident" id="7571865">ip</span>&nbsp;<span class="op" id="7571868">:=</span>&nbsp;<span class="keyword" id="7571871">range</span>&nbsp;<span class="ident" id="7571877">ips</span>&nbsp;<span class="op" id="7571881">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7571885">if</span>&nbsp;<span class="ident" id="7571888">ip</span><span class="op" id="7571890">.</span><span class="ident" id="7571891">To4</span><span class="op" id="7571894">(</span><span class="op" id="7571895">)</span>&nbsp;<span class="op" id="7571897">==</span>&nbsp;<span class="ident" id="7571900">nil</span>&nbsp;<span class="op" id="7571904">&amp;&amp;</span>&nbsp;<span class="ident" id="7571907">ip</span><span class="op" id="7571909">.</span><span class="ident" id="7571910">To16</span><span class="op" id="7571914">(</span><span class="op" id="7571915">)</span>&nbsp;<span class="op" id="7571917">==</span>&nbsp;<span class="ident" id="7571920">nil</span>&nbsp;<span class="op" id="7571924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7571929">t</span><span class="op" id="7571930">.</span><span class="ident" id="7571931">Errorf</span><span class="op" id="7571937">(</span><span class="string" id="7571938">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="7571966">,</span>&nbsp;<span class="ident" id="7571968">ip</span><span class="op" id="7571970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7571977">}</span><br>
<span class="lineno"></span><span class="op" id="7571979">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="7571982">var</span>&nbsp;<span class="ident" id="7571986">revAddrTests</span>&nbsp;<span class="op" id="7571999">=</span>&nbsp;<span class="op" id="7572001">[</span><span class="op" id="7572002">]</span><span class="keyword" id="7572003">struct</span>&nbsp;<span class="op" id="7572010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7572013">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7572023">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7572031">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7572041">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7572049">ErrPrefix</span>&nbsp;<span class="builtintype" id="7572059">string</span><br>
<span class="lineno">200</span><span class="op" id="7572066">}</span><span class="op" id="7572067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572070">{</span><span class="string" id="7572071">&#34;1.2.3.4&#34;</span><span class="op" id="7572080">,</span>&nbsp;<span class="string" id="7572082">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="7572105">,</span>&nbsp;<span class="string" id="7572107">&#34;&#34;</span><span class="op" id="7572109">}</span><span class="op" id="7572110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572113">{</span><span class="string" id="7572114">&#34;245.110.36.114&#34;</span><span class="op" id="7572130">,</span>&nbsp;<span class="string" id="7572132">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="7572162">,</span>&nbsp;<span class="string" id="7572164">&#34;&#34;</span><span class="op" id="7572166">}</span><span class="op" id="7572167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572170">{</span><span class="string" id="7572171">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="7572191">,</span>&nbsp;<span class="string" id="7572193">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="7572220">,</span>&nbsp;<span class="string" id="7572222">&#34;&#34;</span><span class="op" id="7572224">}</span><span class="op" id="7572225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572228">{</span><span class="string" id="7572229">&#34;::1&#34;</span><span class="op" id="7572234">,</span>&nbsp;<span class="string" id="7572236">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="7572311">,</span>&nbsp;<span class="string" id="7572313">&#34;&#34;</span><span class="op" id="7572315">}</span><span class="op" id="7572316">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572319">{</span><span class="string" id="7572320">&#34;1::&#34;</span><span class="op" id="7572325">,</span>&nbsp;<span class="string" id="7572327">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="7572402">,</span>&nbsp;<span class="string" id="7572404">&#34;&#34;</span><span class="op" id="7572406">}</span><span class="op" id="7572407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572410">{</span><span class="string" id="7572411">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="7572431">,</span>&nbsp;<span class="string" id="7572433">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="7572508">,</span>&nbsp;<span class="string" id="7572510">&#34;&#34;</span><span class="op" id="7572512">}</span><span class="op" id="7572513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572516">{</span><span class="string" id="7572517">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="7572556">,</span>&nbsp;<span class="string" id="7572558">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="7572633">,</span>&nbsp;<span class="string" id="7572635">&#34;&#34;</span><span class="op" id="7572637">}</span><span class="op" id="7572638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572641">{</span><span class="string" id="7572642">&#34;1.2.3&#34;</span><span class="op" id="7572649">,</span>&nbsp;<span class="string" id="7572651">&#34;&#34;</span><span class="op" id="7572653">,</span>&nbsp;<span class="string" id="7572655">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7572677">}</span><span class="op" id="7572678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572681">{</span><span class="string" id="7572682">&#34;1.2.3.4.5&#34;</span><span class="op" id="7572693">,</span>&nbsp;<span class="string" id="7572695">&#34;&#34;</span><span class="op" id="7572697">,</span>&nbsp;<span class="string" id="7572699">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7572721">}</span><span class="op" id="7572722">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572725">{</span><span class="string" id="7572726">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="7572752">,</span>&nbsp;<span class="string" id="7572754">&#34;&#34;</span><span class="op" id="7572756">,</span>&nbsp;<span class="string" id="7572758">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7572780">}</span><span class="op" id="7572781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7572784">{</span><span class="string" id="7572785">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="7572816">,</span>&nbsp;<span class="string" id="7572818">&#34;&#34;</span><span class="op" id="7572820">,</span>&nbsp;<span class="string" id="7572822">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7572844">}</span><span class="op" id="7572845">,</span><br>
<span class="lineno"></span><span class="op" id="7572847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7572850">func</span>&nbsp;<span class="ident" id="7572855">TestReverseAddress</span><span class="op" id="7572873">(</span><span class="ident" id="7572874">t</span>&nbsp;<span class="op" id="7572876">*</span><span class="ident" id="7572877">testing</span><span class="op" id="7572884">.</span><span class="ident" id="7572885">T</span><span class="op" id="7572886">)</span>&nbsp;<span class="op" id="7572888">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7572891">for</span>&nbsp;<span class="ident" id="7572895">i</span><span class="op" id="7572896">,</span>&nbsp;<span class="ident" id="7572898">tt</span>&nbsp;<span class="op" id="7572901">:=</span>&nbsp;<span class="keyword" id="7572904">range</span>&nbsp;<span class="ident" id="7572910">revAddrTests</span>&nbsp;<span class="op" id="7572923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7572927">a</span><span class="op" id="7572928">,</span>&nbsp;<span class="ident" id="7572930">err</span>&nbsp;<span class="op" id="7572934">:=</span>&nbsp;<span class="ident" id="7572937">reverseaddr</span><span class="op" id="7572948">(</span><span class="ident" id="7572949">tt</span><span class="op" id="7572951">.</span><span class="ident" id="7572952">Addr</span><span class="op" id="7572956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7572960">if</span>&nbsp;<span class="builtinfunc" id="7572963">len</span><span class="op" id="7572966">(</span><span class="ident" id="7572967">tt</span><span class="op" id="7572969">.</span><span class="ident" id="7572970">ErrPrefix</span><span class="op" id="7572979">)</span>&nbsp;<span class="op" id="7572981">&gt;</span>&nbsp;<span class="num" id="7572983">0</span>&nbsp;<span class="op" id="7572985">&amp;&amp;</span>&nbsp;<span class="ident" id="7572988">err</span>&nbsp;<span class="op" id="7572992">==</span>&nbsp;<span class="ident" id="7572995">nil</span>&nbsp;<span class="op" id="7572999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7573004">t</span><span class="op" id="7573005">.</span><span class="ident" id="7573006">Errorf</span><span class="op" id="7573012">(</span><span class="string" id="7573013">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="7573050">,</span>&nbsp;<span class="ident" id="7573052">i</span><span class="op" id="7573053">,</span>&nbsp;<span class="ident" id="7573055">tt</span><span class="op" id="7573057">.</span><span class="ident" id="7573058">ErrPrefix</span><span class="op" id="7573067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7573072">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7573083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7573087">if</span>&nbsp;<span class="builtinfunc" id="7573090">len</span><span class="op" id="7573093">(</span><span class="ident" id="7573094">tt</span><span class="op" id="7573096">.</span><span class="ident" id="7573097">ErrPrefix</span><span class="op" id="7573106">)</span>&nbsp;<span class="op" id="7573108">==</span>&nbsp;<span class="num" id="7573111">0</span>&nbsp;<span class="op" id="7573113">&amp;&amp;</span>&nbsp;<span class="ident" id="7573116">err</span>&nbsp;<span class="op" id="7573120">!=</span>&nbsp;<span class="ident" id="7573123">nil</span>&nbsp;<span class="op" id="7573127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7573132">t</span><span class="op" id="7573133">.</span><span class="ident" id="7573134">Errorf</span><span class="op" id="7573140">(</span><span class="string" id="7573141">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="7573178">,</span>&nbsp;<span class="ident" id="7573180">i</span><span class="op" id="7573181">,</span>&nbsp;<span class="ident" id="7573183">err</span><span class="op" id="7573186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7573190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7573194">if</span>&nbsp;<span class="ident" id="7573197">err</span>&nbsp;<span class="op" id="7573201">!=</span>&nbsp;<span class="ident" id="7573204">nil</span>&nbsp;<span class="op" id="7573208">&amp;&amp;</span>&nbsp;<span class="ident" id="7573211">err</span><span class="op" id="7573214">.</span><span class="op" id="7573215">(</span><span class="op" id="7573216">*</span><span class="ident" id="7573217">DNSError</span><span class="op" id="7573225">)</span><span class="op" id="7573226">.</span><span class="ident" id="7573227">Err</span>&nbsp;<span class="op" id="7573231">!=</span>&nbsp;<span class="ident" id="7573234">tt</span><span class="op" id="7573236">.</span><span class="ident" id="7573237">ErrPrefix</span>&nbsp;<span class="op" id="7573247">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7573252">t</span><span class="op" id="7573253">.</span><span class="ident" id="7573254">Errorf</span><span class="op" id="7573260">(</span><span class="string" id="7573261">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="7573306">,</span>&nbsp;<span class="ident" id="7573308">i</span><span class="op" id="7573309">,</span>&nbsp;<span class="ident" id="7573311">tt</span><span class="op" id="7573313">.</span><span class="ident" id="7573314">ErrPrefix</span><span class="op" id="7573323">,</span>&nbsp;<span class="ident" id="7573325">err</span><span class="op" id="7573328">.</span><span class="op" id="7573329">(</span><span class="op" id="7573330">*</span><span class="ident" id="7573331">DNSError</span><span class="op" id="7573339">)</span><span class="op" id="7573340">.</span><span class="ident" id="7573341">Err</span><span class="op" id="7573344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7573348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7573352">if</span>&nbsp;<span class="ident" id="7573355">a</span>&nbsp;<span class="op" id="7573357">!=</span>&nbsp;<span class="ident" id="7573360">tt</span><span class="op" id="7573362">.</span><span class="ident" id="7573363">Reverse</span>&nbsp;<span class="op" id="7573371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7573376">t</span><span class="op" id="7573377">.</span><span class="ident" id="7573378">Errorf</span><span class="op" id="7573384">(</span><span class="string" id="7573385">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="7573429">,</span>&nbsp;<span class="ident" id="7573431">i</span><span class="op" id="7573432">,</span>&nbsp;<span class="ident" id="7573434">tt</span><span class="op" id="7573436">.</span><span class="ident" id="7573437">Reverse</span><span class="op" id="7573444">,</span>&nbsp;<span class="ident" id="7573446">a</span><span class="op" id="7573447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7573451">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7573454">}</span><br>
<span class="lineno"></span><span class="op" id="7573456">}</span>
</div>
</body>
</html>
