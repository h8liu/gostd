<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4293302">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4293357">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4293411">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4293462">package</span>&nbsp;<span class="ident" id="4293470">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4293476">import</span>&nbsp;<span class="op" id="4293483">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4293486">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4293500">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4293517">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4293527">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4293538">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4293541">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4293630">type</span>&nbsp;<span class="ident" id="4293635">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4293651">struct</span>&nbsp;<span class="op" id="4293658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293661">Version</span>&nbsp;<span class="builtintype" id="4293669">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293674">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4293682">*</span><span class="ident" id="4293683"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293686">.</span><span class="ident" id="4293687">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293692">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4293700">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293705">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4293713">*</span><span class="ident" id="4293714"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293717">.</span><span class="ident" id="4293718">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293723">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4293731">*</span><span class="ident" id="4293732"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293735">.</span><span class="ident" id="4293736">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293741">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4293749">*</span><span class="ident" id="4293750"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293753">.</span><span class="ident" id="4293754">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293759">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293832">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4293837">*</span><span class="ident" id="4293838"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293841">.</span><span class="ident" id="4293842">Int</span>&nbsp;<span class="string" id="4293846">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293865">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4293870">*</span><span class="ident" id="4293871"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293874">.</span><span class="ident" id="4293875">Int</span>&nbsp;<span class="string" id="4293879">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293898">Qinv</span>&nbsp;<span class="op" id="4293903">*</span><span class="ident" id="4293904"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4293907">.</span><span class="ident" id="4293908">Int</span>&nbsp;<span class="string" id="4293912">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293932">AdditionalPrimes</span>&nbsp;<span class="op" id="4293949">[</span><span class="op" id="4293950">]</span><span class="ident" id="4293951"><a href="/crypto/x509/pkcs1.go.html#4294011">pkcs1AdditionalRSAPrime</a></span>&nbsp;<span class="string" id="4293975">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4294003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4294006">type</span>&nbsp;<span class="ident" id="4294011">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4294035">struct</span>&nbsp;<span class="op" id="4294042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294045">Prime</span>&nbsp;<span class="op" id="4294051">*</span><span class="ident" id="4294052"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4294055">.</span><span class="ident" id="4294056">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294062">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294122">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4294128">*</span><span class="ident" id="4294129"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4294132">.</span><span class="ident" id="4294133">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294138">Coeff</span>&nbsp;<span class="op" id="4294144">*</span><span class="ident" id="4294145"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4294148">.</span><span class="ident" id="4294149">Int</span><br>
<span class="lineno"></span><span class="op" id="4294153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4294156">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4294247">func</span>&nbsp;<span class="ident" id="4294252">ParsePKCS1PrivateKey</span><span class="op" id="4294272">(</span><span class="ident" id="4294273">der</span>&nbsp;<span class="op" id="4294277">[</span><span class="op" id="4294278">]</span><span class="builtintype" id="4294279">byte</span><span class="op" id="4294283">)</span>&nbsp;<span class="op" id="4294285">(</span><span class="ident" id="4294286">key</span>&nbsp;<span class="op" id="4294290">*</span><span class="ident" id="4294291"><a href="/crypto/x509/pkcs1.go.html#4293486">rsa</a></span><span class="op" id="4294294">.</span><span class="ident" id="4294295">PrivateKey</span><span class="op" id="4294305">,</span>&nbsp;<span class="ident" id="4294307">err</span>&nbsp;<span class="builtintype" id="4294311">error</span><span class="op" id="4294316">)</span>&nbsp;<span class="op" id="4294318">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294321">var</span>&nbsp;<span class="ident" id="4294325">priv</span>&nbsp;<span class="ident" id="4294330"><a href="/crypto/x509/pkcs1.go.html#4293635">pkcs1PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294347">rest</span><span class="op" id="4294351">,</span>&nbsp;<span class="ident" id="4294353"><a href="/crypto/x509/pkcs1.go.html#4294307">err</a></span>&nbsp;<span class="op" id="4294357">:=</span>&nbsp;<span class="ident" id="4294360"><a href="/crypto/x509/pkcs1.go.html#4293500">asn1</a></span><span class="op" id="4294364">.</span><span class="ident" id="4294365">Unmarshal</span><span class="op" id="4294374">(</span><span class="ident" id="4294375"><a href="/crypto/x509/pkcs1.go.html#4294273">der</a></span><span class="op" id="4294378">,</span>&nbsp;<span class="op" id="4294380">&amp;</span><span class="ident" id="4294381"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294388">if</span>&nbsp;<span class="builtinfunc" id="4294391">len</span><span class="op" id="4294394">(</span><span class="ident" id="4294395"><a href="/crypto/x509/pkcs1.go.html#4294347">rest</a></span><span class="op" id="4294399">)</span>&nbsp;<span class="op" id="4294401">&gt;</span>&nbsp;<span class="num" id="4294403">0</span>&nbsp;<span class="op" id="4294405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294409"><a href="/crypto/x509/pkcs1.go.html#4294307">err</a></span>&nbsp;<span class="op" id="4294413">=</span>&nbsp;<span class="ident" id="4294415"><a href="/crypto/x509/pkcs1.go.html#4293500">asn1</a></span><span class="op" id="4294419">.</span><span class="ident" id="4294420">SyntaxError</span><span class="op" id="4294431">{</span><span class="ident" id="4294432">Msg</span><span class="op" id="4294435">:</span>&nbsp;<span class="string" id="4294437">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4294452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294456">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294467">if</span>&nbsp;<span class="ident" id="4294470"><a href="/crypto/x509/pkcs1.go.html#4294307">err</a></span>&nbsp;<span class="op" id="4294474">!=</span>&nbsp;<span class="ident" id="4294477">nil</span>&nbsp;<span class="op" id="4294481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294485">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294497">if</span>&nbsp;<span class="ident" id="4294500"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294504">.</span><span class="ident" id="4294505">Version</span>&nbsp;<span class="op" id="4294513">&gt;</span>&nbsp;<span class="num" id="4294515">1</span>&nbsp;<span class="op" id="4294517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294521">return</span>&nbsp;<span class="ident" id="4294528">nil</span><span class="op" id="4294531">,</span>&nbsp;<span class="ident" id="4294533"><a href="/crypto/x509/pkcs1.go.html#4293517">errors</a></span><span class="op" id="4294539">.</span><span class="ident" id="4294540">New</span><span class="op" id="4294543">(</span><span class="string" id="4294544">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4294583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294590">if</span>&nbsp;<span class="ident" id="4294593"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294597">.</span><span class="ident" id="4294598">N</span><span class="op" id="4294599">.</span><span class="ident" id="4294600">Sign</span><span class="op" id="4294604">(</span><span class="op" id="4294605">)</span>&nbsp;<span class="op" id="4294607">&lt;=</span>&nbsp;<span class="num" id="4294610">0</span>&nbsp;<span class="op" id="4294612">||</span>&nbsp;<span class="ident" id="4294615"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294619">.</span><span class="ident" id="4294620">D</span><span class="op" id="4294621">.</span><span class="ident" id="4294622">Sign</span><span class="op" id="4294626">(</span><span class="op" id="4294627">)</span>&nbsp;<span class="op" id="4294629">&lt;=</span>&nbsp;<span class="num" id="4294632">0</span>&nbsp;<span class="op" id="4294634">||</span>&nbsp;<span class="ident" id="4294637"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294641">.</span><span class="ident" id="4294642">P</span><span class="op" id="4294643">.</span><span class="ident" id="4294644">Sign</span><span class="op" id="4294648">(</span><span class="op" id="4294649">)</span>&nbsp;<span class="op" id="4294651">&lt;=</span>&nbsp;<span class="num" id="4294654">0</span>&nbsp;<span class="op" id="4294656">||</span>&nbsp;<span class="ident" id="4294659"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294663">.</span><span class="ident" id="4294664">Q</span><span class="op" id="4294665">.</span><span class="ident" id="4294666">Sign</span><span class="op" id="4294670">(</span><span class="op" id="4294671">)</span>&nbsp;<span class="op" id="4294673">&lt;=</span>&nbsp;<span class="num" id="4294676">0</span>&nbsp;<span class="op" id="4294678">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294682">return</span>&nbsp;<span class="ident" id="4294689">nil</span><span class="op" id="4294692">,</span>&nbsp;<span class="ident" id="4294694"><a href="/crypto/x509/pkcs1.go.html#4293517">errors</a></span><span class="op" id="4294700">.</span><span class="ident" id="4294701">New</span><span class="op" id="4294704">(</span><span class="string" id="4294705">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4294756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294763"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span>&nbsp;<span class="op" id="4294767">=</span>&nbsp;<span class="builtinfunc" id="4294769">new</span><span class="op" id="4294772">(</span><span class="ident" id="4294773"><a href="/crypto/x509/pkcs1.go.html#4293486">rsa</a></span><span class="op" id="4294776">.</span><span class="ident" id="4294777">PrivateKey</span><span class="op" id="4294787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294790"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4294793">.</span><span class="ident" id="4294794">PublicKey</span>&nbsp;<span class="op" id="4294804">=</span>&nbsp;<span class="ident" id="4294806"><a href="/crypto/x509/pkcs1.go.html#4293486">rsa</a></span><span class="op" id="4294809">.</span><span class="ident" id="4294810">PublicKey</span><span class="op" id="4294819">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294823">E</span><span class="op" id="4294824">:</span>&nbsp;<span class="ident" id="4294826"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294830">.</span><span class="ident" id="4294831">E</span><span class="op" id="4294832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294836">N</span><span class="op" id="4294837">:</span>&nbsp;<span class="ident" id="4294839"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294843">.</span><span class="ident" id="4294844">N</span><span class="op" id="4294845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294852"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4294855">.</span><span class="ident" id="4294856">D</span>&nbsp;<span class="op" id="4294858">=</span>&nbsp;<span class="ident" id="4294860"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294864">.</span><span class="ident" id="4294865">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294868"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4294871">.</span><span class="ident" id="4294872">Primes</span>&nbsp;<span class="op" id="4294879">=</span>&nbsp;<span class="builtinfunc" id="4294881">make</span><span class="op" id="4294885">(</span><span class="op" id="4294886">[</span><span class="op" id="4294887">]</span><span class="op" id="4294888">*</span><span class="ident" id="4294889"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4294892">.</span><span class="ident" id="4294893">Int</span><span class="op" id="4294896">,</span>&nbsp;<span class="num" id="4294898">2</span><span class="op" id="4294899">+</span><span class="builtinfunc" id="4294900">len</span><span class="op" id="4294903">(</span><span class="ident" id="4294904"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294908">.</span><span class="ident" id="4294909">AdditionalPrimes</span><span class="op" id="4294925">)</span><span class="op" id="4294926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294929"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4294932">.</span><span class="ident" id="4294933">Primes</span><span class="op" id="4294939">[</span><span class="num" id="4294940">0</span><span class="op" id="4294941">]</span>&nbsp;<span class="op" id="4294943">=</span>&nbsp;<span class="ident" id="4294945"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294949">.</span><span class="ident" id="4294950">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294953"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4294956">.</span><span class="ident" id="4294957">Primes</span><span class="op" id="4294963">[</span><span class="num" id="4294964">1</span><span class="op" id="4294965">]</span>&nbsp;<span class="op" id="4294967">=</span>&nbsp;<span class="ident" id="4294969"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294973">.</span><span class="ident" id="4294974">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294977">for</span>&nbsp;<span class="ident" id="4294981">i</span><span class="op" id="4294982">,</span>&nbsp;<span class="ident" id="4294984">a</span>&nbsp;<span class="op" id="4294986">:=</span>&nbsp;<span class="keyword" id="4294989">range</span>&nbsp;<span class="ident" id="4294995"><a href="/crypto/x509/pkcs1.go.html#4294325">priv</a></span><span class="op" id="4294999">.</span><span class="ident" id="4295000">AdditionalPrimes</span>&nbsp;<span class="op" id="4295017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295021">if</span>&nbsp;<span class="ident" id="4295024"><a href="/crypto/x509/pkcs1.go.html#4294984">a</a></span><span class="op" id="4295025">.</span><span class="ident" id="4295026">Prime</span><span class="op" id="4295031">.</span><span class="ident" id="4295032">Sign</span><span class="op" id="4295036">(</span><span class="op" id="4295037">)</span>&nbsp;<span class="op" id="4295039">&lt;=</span>&nbsp;<span class="num" id="4295042">0</span>&nbsp;<span class="op" id="4295044">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295049">return</span>&nbsp;<span class="ident" id="4295056">nil</span><span class="op" id="4295059">,</span>&nbsp;<span class="ident" id="4295061"><a href="/crypto/x509/pkcs1.go.html#4293517">errors</a></span><span class="op" id="4295067">.</span><span class="ident" id="4295068">New</span><span class="op" id="4295071">(</span><span class="string" id="4295072">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4295123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295131"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4295134">.</span><span class="ident" id="4295135">Primes</span><span class="op" id="4295141">[</span><span class="ident" id="4295142"><a href="/crypto/x509/pkcs1.go.html#4294981">i</a></span><span class="op" id="4295143">+</span><span class="num" id="4295144">2</span><span class="op" id="4295145">]</span>&nbsp;<span class="op" id="4295147">=</span>&nbsp;<span class="ident" id="4295149"><a href="/crypto/x509/pkcs1.go.html#4294984">a</a></span><span class="op" id="4295150">.</span><span class="ident" id="4295151">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4295159">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4295222">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295246"><a href="/crypto/x509/pkcs1.go.html#4294307">err</a></span>&nbsp;<span class="op" id="4295250">=</span>&nbsp;<span class="ident" id="4295252"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4295255">.</span><span class="ident" id="4295256">Validate</span><span class="op" id="4295264">(</span><span class="op" id="4295265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295268">if</span>&nbsp;<span class="ident" id="4295271"><a href="/crypto/x509/pkcs1.go.html#4294307">err</a></span>&nbsp;<span class="op" id="4295275">!=</span>&nbsp;<span class="ident" id="4295278">nil</span>&nbsp;<span class="op" id="4295282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295286">return</span>&nbsp;<span class="ident" id="4295293">nil</span><span class="op" id="4295296">,</span>&nbsp;<span class="ident" id="4295298"><a href="/crypto/x509/pkcs1.go.html#4294307">err</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295306"><a href="/crypto/x509/pkcs1.go.html#4294286">key</a></span><span class="op" id="4295309">.</span><span class="ident" id="4295310">Precompute</span><span class="op" id="4295320">(</span><span class="op" id="4295321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295325">return</span><br>
<span class="lineno"></span><span class="op" id="4295332">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4295335">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4295411">func</span>&nbsp;<span class="ident" id="4295416">MarshalPKCS1PrivateKey</span><span class="op" id="4295438">(</span><span class="ident" id="4295439">key</span>&nbsp;<span class="op" id="4295443">*</span><span class="ident" id="4295444"><a href="/crypto/x509/pkcs1.go.html#4293486">rsa</a></span><span class="op" id="4295447">.</span><span class="ident" id="4295448">PrivateKey</span><span class="op" id="4295458">)</span>&nbsp;<span class="op" id="4295460">[</span><span class="op" id="4295461">]</span><span class="builtintype" id="4295462">byte</span>&nbsp;<span class="op" id="4295467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295470"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295473">.</span><span class="ident" id="4295474">Precompute</span><span class="op" id="4295484">(</span><span class="op" id="4295485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295489">version</span>&nbsp;<span class="op" id="4295497">:=</span>&nbsp;<span class="num" id="4295500">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295503">if</span>&nbsp;<span class="builtinfunc" id="4295506">len</span><span class="op" id="4295509">(</span><span class="ident" id="4295510"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295513">.</span><span class="ident" id="4295514">Primes</span><span class="op" id="4295520">)</span>&nbsp;<span class="op" id="4295522">&gt;</span>&nbsp;<span class="num" id="4295524">2</span>&nbsp;<span class="op" id="4295526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295530"><a href="/crypto/x509/pkcs1.go.html#4295489">version</a></span>&nbsp;<span class="op" id="4295538">=</span>&nbsp;<span class="num" id="4295540">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295547">priv</span>&nbsp;<span class="op" id="4295552">:=</span>&nbsp;<span class="ident" id="4295555"><a href="/crypto/x509/pkcs1.go.html#4293635">pkcs1PrivateKey</a></span><span class="op" id="4295570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295574">Version</span><span class="op" id="4295581">:</span>&nbsp;<span class="ident" id="4295583"><a href="/crypto/x509/pkcs1.go.html#4295489">version</a></span><span class="op" id="4295590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295594">N</span><span class="op" id="4295595">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295603"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295606">.</span><span class="ident" id="4295607">N</span><span class="op" id="4295608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295612">E</span><span class="op" id="4295613">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295621"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295624">.</span><span class="ident" id="4295625">PublicKey</span><span class="op" id="4295634">.</span><span class="ident" id="4295635">E</span><span class="op" id="4295636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295640">D</span><span class="op" id="4295641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295649"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295652">.</span><span class="ident" id="4295653">D</span><span class="op" id="4295654">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295658">P</span><span class="op" id="4295659">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295667"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295670">.</span><span class="ident" id="4295671">Primes</span><span class="op" id="4295677">[</span><span class="num" id="4295678">0</span><span class="op" id="4295679">]</span><span class="op" id="4295680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295684">Q</span><span class="op" id="4295685">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295693"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295696">.</span><span class="ident" id="4295697">Primes</span><span class="op" id="4295703">[</span><span class="num" id="4295704">1</span><span class="op" id="4295705">]</span><span class="op" id="4295706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295710">Dp</span><span class="op" id="4295712">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295719"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295722">.</span><span class="ident" id="4295723">Precomputed</span><span class="op" id="4295734">.</span><span class="ident" id="4295735">Dp</span><span class="op" id="4295737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295741">Dq</span><span class="op" id="4295743">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295750"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295753">.</span><span class="ident" id="4295754">Precomputed</span><span class="op" id="4295765">.</span><span class="ident" id="4295766">Dq</span><span class="op" id="4295768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295772">Qinv</span><span class="op" id="4295776">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295781"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295784">.</span><span class="ident" id="4295785">Precomputed</span><span class="op" id="4295796">.</span><span class="ident" id="4295797">Qinv</span><span class="op" id="4295801">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295808"><a href="/crypto/x509/pkcs1.go.html#4295547">priv</a></span><span class="op" id="4295812">.</span><span class="ident" id="4295813">AdditionalPrimes</span>&nbsp;<span class="op" id="4295830">=</span>&nbsp;<span class="builtinfunc" id="4295832">make</span><span class="op" id="4295836">(</span><span class="op" id="4295837">[</span><span class="op" id="4295838">]</span><span class="ident" id="4295839"><a href="/crypto/x509/pkcs1.go.html#4294011">pkcs1AdditionalRSAPrime</a></span><span class="op" id="4295862">,</span>&nbsp;<span class="builtinfunc" id="4295864">len</span><span class="op" id="4295867">(</span><span class="ident" id="4295868"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295871">.</span><span class="ident" id="4295872">Precomputed</span><span class="op" id="4295883">.</span><span class="ident" id="4295884">CRTValues</span><span class="op" id="4295893">)</span><span class="op" id="4295894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295897">for</span>&nbsp;<span class="ident" id="4295901">i</span><span class="op" id="4295902">,</span>&nbsp;<span class="ident" id="4295904">values</span>&nbsp;<span class="op" id="4295911">:=</span>&nbsp;<span class="keyword" id="4295914">range</span>&nbsp;<span class="ident" id="4295920"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295923">.</span><span class="ident" id="4295924">Precomputed</span><span class="op" id="4295935">.</span><span class="ident" id="4295936">CRTValues</span>&nbsp;<span class="op" id="4295946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295950"><a href="/crypto/x509/pkcs1.go.html#4295547">priv</a></span><span class="op" id="4295954">.</span><span class="ident" id="4295955">AdditionalPrimes</span><span class="op" id="4295971">[</span><span class="ident" id="4295972"><a href="/crypto/x509/pkcs1.go.html#4295901">i</a></span><span class="op" id="4295973">]</span><span class="op" id="4295974">.</span><span class="ident" id="4295975">Prime</span>&nbsp;<span class="op" id="4295981">=</span>&nbsp;<span class="ident" id="4295983"><a href="/crypto/x509/pkcs1.go.html#4295439">key</a></span><span class="op" id="4295986">.</span><span class="ident" id="4295987">Primes</span><span class="op" id="4295993">[</span><span class="num" id="4295994">2</span><span class="op" id="4295995">+</span><span class="ident" id="4295996"><a href="/crypto/x509/pkcs1.go.html#4295901">i</a></span><span class="op" id="4295997">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296001"><a href="/crypto/x509/pkcs1.go.html#4295547">priv</a></span><span class="op" id="4296005">.</span><span class="ident" id="4296006">AdditionalPrimes</span><span class="op" id="4296022">[</span><span class="ident" id="4296023"><a href="/crypto/x509/pkcs1.go.html#4295901">i</a></span><span class="op" id="4296024">]</span><span class="op" id="4296025">.</span><span class="ident" id="4296026">Exp</span>&nbsp;<span class="op" id="4296030">=</span>&nbsp;<span class="ident" id="4296032"><a href="/crypto/x509/pkcs1.go.html#4295904">values</a></span><span class="op" id="4296038">.</span><span class="ident" id="4296039">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296045"><a href="/crypto/x509/pkcs1.go.html#4295547">priv</a></span><span class="op" id="4296049">.</span><span class="ident" id="4296050">AdditionalPrimes</span><span class="op" id="4296066">[</span><span class="ident" id="4296067"><a href="/crypto/x509/pkcs1.go.html#4295901">i</a></span><span class="op" id="4296068">]</span><span class="op" id="4296069">.</span><span class="ident" id="4296070">Coeff</span>&nbsp;<span class="op" id="4296076">=</span>&nbsp;<span class="ident" id="4296078"><a href="/crypto/x509/pkcs1.go.html#4295904">values</a></span><span class="op" id="4296084">.</span><span class="ident" id="4296085">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4296092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296096">b</span><span class="op" id="4296097">,</span>&nbsp;<span class="ident" id="4296099">_</span>&nbsp;<span class="op" id="4296101">:=</span>&nbsp;<span class="ident" id="4296104"><a href="/crypto/x509/pkcs1.go.html#4293500">asn1</a></span><span class="op" id="4296108">.</span><span class="ident" id="4296109">Marshal</span><span class="op" id="4296116">(</span><span class="ident" id="4296117"><a href="/crypto/x509/pkcs1.go.html#4295547">priv</a></span><span class="op" id="4296121">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296124">return</span>&nbsp;<span class="ident" id="4296131"><a href="/crypto/x509/pkcs1.go.html#4296096">b</a></span><br>
<span class="lineno"></span><span class="op" id="4296133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4296136">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4296205">type</span>&nbsp;<span class="ident" id="4296210">rsaPublicKey</span>&nbsp;<span class="keyword" id="4296223">struct</span>&nbsp;<span class="op" id="4296230">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296233">N</span>&nbsp;<span class="op" id="4296235">*</span><span class="ident" id="4296236"><a href="/crypto/x509/pkcs1.go.html#4293527">big</a></span><span class="op" id="4296239">.</span><span class="ident" id="4296240">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296245">E</span>&nbsp;<span class="builtintype" id="4296247">int</span><br>
<span class="lineno"></span><span class="op" id="4296251">}</span>
</div>
</body>
</html>
