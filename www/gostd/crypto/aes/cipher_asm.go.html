<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3875300">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3875355">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3875409">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3875460">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3875477">package</span>&nbsp;<span class="ident" id="3875485">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3875490">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3875518">func</span>&nbsp;<span class="ident" id="3875523">hasAsm</span><span class="op" id="3875529">(</span><span class="op" id="3875530">)</span>&nbsp;<span class="builtintype" id="3875532">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3875537">func</span>&nbsp;<span class="ident" id="3875542">encryptBlockAsm</span><span class="op" id="3875557">(</span><span class="ident" id="3875558">nr</span>&nbsp;<span class="builtintype" id="3875561">int</span><span class="op" id="3875564">,</span>&nbsp;<span class="ident" id="3875566">xk</span>&nbsp;<span class="op" id="3875569">*</span><span class="builtintype" id="3875570">uint32</span><span class="op" id="3875576">,</span>&nbsp;<span class="ident" id="3875578">dst</span><span class="op" id="3875581">,</span>&nbsp;<span class="ident" id="3875583">src</span>&nbsp;<span class="op" id="3875587">*</span><span class="builtintype" id="3875588">byte</span><span class="op" id="3875592">)</span><br>
<span class="lineno"></span><span class="keyword" id="3875594">func</span>&nbsp;<span class="ident" id="3875599">decryptBlockAsm</span><span class="op" id="3875614">(</span><span class="ident" id="3875615">nr</span>&nbsp;<span class="builtintype" id="3875618">int</span><span class="op" id="3875621">,</span>&nbsp;<span class="ident" id="3875623">xk</span>&nbsp;<span class="op" id="3875626">*</span><span class="builtintype" id="3875627">uint32</span><span class="op" id="3875633">,</span>&nbsp;<span class="ident" id="3875635">dst</span><span class="op" id="3875638">,</span>&nbsp;<span class="ident" id="3875640">src</span>&nbsp;<span class="op" id="3875644">*</span><span class="builtintype" id="3875645">byte</span><span class="op" id="3875649">)</span><br>
<span class="lineno"></span><span class="keyword" id="3875651">func</span>&nbsp;<span class="ident" id="3875656">expandKeyAsm</span><span class="op" id="3875668">(</span><span class="ident" id="3875669">nr</span>&nbsp;<span class="builtintype" id="3875672">int</span><span class="op" id="3875675">,</span>&nbsp;<span class="ident" id="3875677">key</span>&nbsp;<span class="op" id="3875681">*</span><span class="builtintype" id="3875682">byte</span><span class="op" id="3875686">,</span>&nbsp;<span class="ident" id="3875688">enc</span>&nbsp;<span class="op" id="3875692">*</span><span class="builtintype" id="3875693">uint32</span><span class="op" id="3875699">,</span>&nbsp;<span class="ident" id="3875701">dec</span>&nbsp;<span class="op" id="3875705">*</span><span class="builtintype" id="3875706">uint32</span><span class="op" id="3875712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3875715">var</span>&nbsp;<span class="ident" id="3875719">useAsm</span>&nbsp;<span class="op" id="3875726">=</span>&nbsp;<span class="ident" id="3875728">hasAsm</span><span class="op" id="3875734">(</span><span class="op" id="3875735">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3875738">func</span>&nbsp;<span class="ident" id="3875743">encryptBlock</span><span class="op" id="3875755">(</span><span class="ident" id="3875756">xk</span>&nbsp;<span class="op" id="3875759">[</span><span class="op" id="3875760">]</span><span class="builtintype" id="3875761">uint32</span><span class="op" id="3875767">,</span>&nbsp;<span class="ident" id="3875769">dst</span><span class="op" id="3875772">,</span>&nbsp;<span class="ident" id="3875774">src</span>&nbsp;<span class="op" id="3875778">[</span><span class="op" id="3875779">]</span><span class="builtintype" id="3875780">byte</span><span class="op" id="3875784">)</span>&nbsp;<span class="op" id="3875786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875789">if</span>&nbsp;<span class="ident" id="3875792">useAsm</span>&nbsp;<span class="op" id="3875799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875803">encryptBlockAsm</span><span class="op" id="3875818">(</span><span class="builtinfunc" id="3875819">len</span><span class="op" id="3875822">(</span><span class="ident" id="3875823">xk</span><span class="op" id="3875825">)</span><span class="op" id="3875826">/</span><span class="num" id="3875827">4</span><span class="op" id="3875828">-</span><span class="num" id="3875829">1</span><span class="op" id="3875830">,</span>&nbsp;<span class="op" id="3875832">&amp;</span><span class="ident" id="3875833">xk</span><span class="op" id="3875835">[</span><span class="num" id="3875836">0</span><span class="op" id="3875837">]</span><span class="op" id="3875838">,</span>&nbsp;<span class="op" id="3875840">&amp;</span><span class="ident" id="3875841">dst</span><span class="op" id="3875844">[</span><span class="num" id="3875845">0</span><span class="op" id="3875846">]</span><span class="op" id="3875847">,</span>&nbsp;<span class="op" id="3875849">&amp;</span><span class="ident" id="3875850">src</span><span class="op" id="3875853">[</span><span class="num" id="3875854">0</span><span class="op" id="3875855">]</span><span class="op" id="3875856">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875859">}</span>&nbsp;<span class="keyword" id="3875861">else</span>&nbsp;<span class="op" id="3875866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875870">encryptBlockGo</span><span class="op" id="3875884">(</span><span class="ident" id="3875885">xk</span><span class="op" id="3875887">,</span>&nbsp;<span class="ident" id="3875889">dst</span><span class="op" id="3875892">,</span>&nbsp;<span class="ident" id="3875894">src</span><span class="op" id="3875897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875900">}</span><br>
<span class="lineno"></span><span class="op" id="3875902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3875905">func</span>&nbsp;<span class="ident" id="3875910">decryptBlock</span><span class="op" id="3875922">(</span><span class="ident" id="3875923">xk</span>&nbsp;<span class="op" id="3875926">[</span><span class="op" id="3875927">]</span><span class="builtintype" id="3875928">uint32</span><span class="op" id="3875934">,</span>&nbsp;<span class="ident" id="3875936">dst</span><span class="op" id="3875939">,</span>&nbsp;<span class="ident" id="3875941">src</span>&nbsp;<span class="op" id="3875945">[</span><span class="op" id="3875946">]</span><span class="builtintype" id="3875947">byte</span><span class="op" id="3875951">)</span>&nbsp;<span class="op" id="3875953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875956">if</span>&nbsp;<span class="ident" id="3875959">useAsm</span>&nbsp;<span class="op" id="3875966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875970">decryptBlockAsm</span><span class="op" id="3875985">(</span><span class="builtinfunc" id="3875986">len</span><span class="op" id="3875989">(</span><span class="ident" id="3875990">xk</span><span class="op" id="3875992">)</span><span class="op" id="3875993">/</span><span class="num" id="3875994">4</span><span class="op" id="3875995">-</span><span class="num" id="3875996">1</span><span class="op" id="3875997">,</span>&nbsp;<span class="op" id="3875999">&amp;</span><span class="ident" id="3876000">xk</span><span class="op" id="3876002">[</span><span class="num" id="3876003">0</span><span class="op" id="3876004">]</span><span class="op" id="3876005">,</span>&nbsp;<span class="op" id="3876007">&amp;</span><span class="ident" id="3876008">dst</span><span class="op" id="3876011">[</span><span class="num" id="3876012">0</span><span class="op" id="3876013">]</span><span class="op" id="3876014">,</span>&nbsp;<span class="op" id="3876016">&amp;</span><span class="ident" id="3876017">src</span><span class="op" id="3876020">[</span><span class="num" id="3876021">0</span><span class="op" id="3876022">]</span><span class="op" id="3876023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876026">}</span>&nbsp;<span class="keyword" id="3876028">else</span>&nbsp;<span class="op" id="3876033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876037">decryptBlockGo</span><span class="op" id="3876051">(</span><span class="ident" id="3876052">xk</span><span class="op" id="3876054">,</span>&nbsp;<span class="ident" id="3876056">dst</span><span class="op" id="3876059">,</span>&nbsp;<span class="ident" id="3876061">src</span><span class="op" id="3876064">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876067">}</span><br>
<span class="lineno"></span><span class="op" id="3876069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3876072">func</span>&nbsp;<span class="ident" id="3876077">expandKey</span><span class="op" id="3876086">(</span><span class="ident" id="3876087">key</span>&nbsp;<span class="op" id="3876091">[</span><span class="op" id="3876092">]</span><span class="builtintype" id="3876093">byte</span><span class="op" id="3876097">,</span>&nbsp;<span class="ident" id="3876099">enc</span><span class="op" id="3876102">,</span>&nbsp;<span class="ident" id="3876104">dec</span>&nbsp;<span class="op" id="3876108">[</span><span class="op" id="3876109">]</span><span class="builtintype" id="3876110">uint32</span><span class="op" id="3876116">)</span>&nbsp;<span class="op" id="3876118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876121">if</span>&nbsp;<span class="ident" id="3876124">useAsm</span>&nbsp;<span class="op" id="3876131">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876135">rounds</span>&nbsp;<span class="op" id="3876142">:=</span>&nbsp;<span class="num" id="3876145">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876150">switch</span>&nbsp;<span class="builtinfunc" id="3876157">len</span><span class="op" id="3876160">(</span><span class="ident" id="3876161">key</span><span class="op" id="3876164">)</span>&nbsp;<span class="op" id="3876166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876170">case</span>&nbsp;<span class="num" id="3876175">128</span>&nbsp;<span class="op" id="3876179">/</span>&nbsp;<span class="num" id="3876181">8</span><span class="op" id="3876182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876187">rounds</span>&nbsp;<span class="op" id="3876194">=</span>&nbsp;<span class="num" id="3876196">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876201">case</span>&nbsp;<span class="num" id="3876206">192</span>&nbsp;<span class="op" id="3876210">/</span>&nbsp;<span class="num" id="3876212">8</span><span class="op" id="3876213">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876218">rounds</span>&nbsp;<span class="op" id="3876225">=</span>&nbsp;<span class="num" id="3876227">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876232">case</span>&nbsp;<span class="num" id="3876237">256</span>&nbsp;<span class="op" id="3876241">/</span>&nbsp;<span class="num" id="3876243">8</span><span class="op" id="3876244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876249">rounds</span>&nbsp;<span class="op" id="3876256">=</span>&nbsp;<span class="num" id="3876258">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876267">expandKeyAsm</span><span class="op" id="3876279">(</span><span class="ident" id="3876280">rounds</span><span class="op" id="3876286">,</span>&nbsp;<span class="op" id="3876288">&amp;</span><span class="ident" id="3876289">key</span><span class="op" id="3876292">[</span><span class="num" id="3876293">0</span><span class="op" id="3876294">]</span><span class="op" id="3876295">,</span>&nbsp;<span class="op" id="3876297">&amp;</span><span class="ident" id="3876298">enc</span><span class="op" id="3876301">[</span><span class="num" id="3876302">0</span><span class="op" id="3876303">]</span><span class="op" id="3876304">,</span>&nbsp;<span class="op" id="3876306">&amp;</span><span class="ident" id="3876307">dec</span><span class="op" id="3876310">[</span><span class="num" id="3876311">0</span><span class="op" id="3876312">]</span><span class="op" id="3876313">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876316">}</span>&nbsp;<span class="keyword" id="3876318">else</span>&nbsp;<span class="op" id="3876323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876327">expandKeyGo</span><span class="op" id="3876338">(</span><span class="ident" id="3876339">key</span><span class="op" id="3876342">,</span>&nbsp;<span class="ident" id="3876344">enc</span><span class="op" id="3876347">,</span>&nbsp;<span class="ident" id="3876349">dec</span><span class="op" id="3876352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876355">}</span><br>
<span class="lineno"></span><span class="op" id="3876357">}</span>
</div>
</body>
</html>
