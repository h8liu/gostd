<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html" class="current">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6649525">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6649580">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6649634">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6649685">package</span>&nbsp;<span class="ident" id="6649693">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6649698">import</span>&nbsp;<span class="op" id="6649705">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6649708">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6649724">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6649735">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6649745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6649748">func</span>&nbsp;<span class="ident" id="6649753">TestDNSParseSRVReply</span><span class="op" id="6649773">(</span><span class="ident" id="6649774">t</span>&nbsp;<span class="op" id="6649776">*</span><span class="ident" id="6649777"><a href="/gostd/net/dnsmsg_test.go.html#6649735">testing</a></span><span class="op" id="6649784">.</span><span class="ident" id="6649785"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6649786">)</span>&nbsp;<span class="op" id="6649788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649791">data</span><span class="op" id="6649795">,</span>&nbsp;<span class="ident" id="6649797">err</span>&nbsp;<span class="op" id="6649801">:=</span>&nbsp;<span class="ident" id="6649804"><a href="/gostd/net/dnsmsg_test.go.html#6649708">hex</a></span><span class="op" id="6649807">.</span><span class="ident" id="6649808"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="6649820">(</span><span class="ident" id="6649821"><a href="/gostd/net/dnsmsg_test.go.html#6651928">dnsSRVReply</a></span><span class="op" id="6649832">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649835">if</span>&nbsp;<span class="ident" id="6649838"><a href="/gostd/net/dnsmsg_test.go.html#6649797">err</a></span>&nbsp;<span class="op" id="6649842">!=</span>&nbsp;<span class="builtintype" id="6649845">nil</span>&nbsp;<span class="op" id="6649849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649853"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6649854">.</span><span class="ident" id="6649855"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6649860">(</span><span class="ident" id="6649861"><a href="/gostd/net/dnsmsg_test.go.html#6649797">err</a></span><span class="op" id="6649864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649870">msg</span>&nbsp;<span class="op" id="6649874">:=</span>&nbsp;<span class="builtinfunc" id="6649877">new</span><span class="op" id="6649880">(</span><span class="ident" id="6649881"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="6649887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649890">ok</span>&nbsp;<span class="op" id="6649893">:=</span>&nbsp;<span class="ident" id="6649896"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6649899">.</span><span class="ident" id="6649900"><a href="/gostd/net/dnsmsg.go.html#3247295">Unpack</a></span><span class="op" id="6649906">(</span><span class="ident" id="6649907"><a href="/gostd/net/dnsmsg_test.go.html#6649791">data</a></span><span class="op" id="6649911">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6649914">if</span>&nbsp;<span class="op" id="6649917">!</span><span class="ident" id="6649918"><a href="/gostd/net/dnsmsg_test.go.html#6649890">ok</a></span>&nbsp;<span class="op" id="6649921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649925"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6649926">.</span><span class="ident" id="6649927"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6649933">(</span><span class="string" id="6649934">&#34;unpacking&nbsp;packet&nbsp;failed&#34;</span><span class="op" id="6649959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6649962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649965"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6649968">.</span><span class="ident" id="6649969"><a href="/gostd/net/dnsmsg.go.html#3248603">String</a></span><span class="op" id="6649975">(</span><span class="op" id="6649976">)</span>&nbsp;<span class="comment" id="6649978">//&nbsp;exercise&nbsp;this&nbsp;code&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650006">if</span>&nbsp;<span class="ident" id="6650009">g</span><span class="op" id="6650010">,</span>&nbsp;<span class="ident" id="6650012">e</span>&nbsp;<span class="op" id="6650014">:=</span>&nbsp;<span class="builtinfunc" id="6650017">len</span><span class="op" id="6650020">(</span><span class="ident" id="6650021"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6650024">.</span><span class="ident" id="6650025"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="6650031">)</span><span class="op" id="6650032">,</span>&nbsp;<span class="num" id="6650034">5</span><span class="op" id="6650035">;</span>&nbsp;<span class="ident" id="6650037"><a href="/gostd/net/dnsmsg_test.go.html#6650009">g</a></span>&nbsp;<span class="op" id="6650039">!=</span>&nbsp;<span class="ident" id="6650042"><a href="/gostd/net/dnsmsg_test.go.html#6650012">e</a></span>&nbsp;<span class="op" id="6650044">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650048"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650049">.</span><span class="ident" id="6650050"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6650056">(</span><span class="string" id="6650057">&#34;len(msg.answer)&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6650088">,</span>&nbsp;<span class="ident" id="6650090"><a href="/gostd/net/dnsmsg_test.go.html#6650009">g</a></span><span class="op" id="6650091">,</span>&nbsp;<span class="ident" id="6650093"><a href="/gostd/net/dnsmsg_test.go.html#6650012">e</a></span><span class="op" id="6650094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650100">for</span>&nbsp;<span class="ident" id="6650104">idx</span><span class="op" id="6650107">,</span>&nbsp;<span class="ident" id="6650109">rr</span>&nbsp;<span class="op" id="6650112">:=</span>&nbsp;<span class="keyword" id="6650115">range</span>&nbsp;<span class="ident" id="6650121"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6650124">.</span><span class="ident" id="6650125"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span>&nbsp;<span class="op" id="6650132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650136">if</span>&nbsp;<span class="ident" id="6650139">g</span><span class="op" id="6650140">,</span>&nbsp;<span class="ident" id="6650142">e</span>&nbsp;<span class="op" id="6650144">:=</span>&nbsp;<span class="ident" id="6650147"><a href="/gostd/net/dnsmsg_test.go.html#6650109">rr</a></span><span class="op" id="6650149">.</span><span class="ident" id="6650150"><a href="/gostd/net/dnsmsg.go.html#3231814">Header</a></span><span class="op" id="6650156">(</span><span class="op" id="6650157">)</span><span class="op" id="6650158">.</span><span class="ident" id="6650159"><a href="/gostd/net/dnsmsg.go.html#3231372">Rrtype</a></span><span class="op" id="6650165">,</span>&nbsp;<span class="builtintype" id="6650167">uint16</span><span class="op" id="6650173">(</span><span class="ident" id="6650174"><a href="/gostd/net/dnsmsg.go.html#3229100">dnsTypeSRV</a></span><span class="op" id="6650184">)</span><span class="op" id="6650185">;</span>&nbsp;<span class="ident" id="6650187"><a href="/gostd/net/dnsmsg_test.go.html#6650139">g</a></span>&nbsp;<span class="op" id="6650189">!=</span>&nbsp;<span class="ident" id="6650192"><a href="/gostd/net/dnsmsg_test.go.html#6650142">e</a></span>&nbsp;<span class="op" id="6650194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650199"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650200">.</span><span class="ident" id="6650201"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6650207">(</span><span class="string" id="6650208">&#34;rr[%d].Header().Rrtype&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6650246">,</span>&nbsp;<span class="ident" id="6650248"><a href="/gostd/net/dnsmsg_test.go.html#6650104">idx</a></span><span class="op" id="6650251">,</span>&nbsp;<span class="ident" id="6650253"><a href="/gostd/net/dnsmsg_test.go.html#6650139">g</a></span><span class="op" id="6650254">,</span>&nbsp;<span class="ident" id="6650256"><a href="/gostd/net/dnsmsg_test.go.html#6650142">e</a></span><span class="op" id="6650257">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650265">if</span>&nbsp;<span class="ident" id="6650268">_</span><span class="op" id="6650269">,</span>&nbsp;<span class="ident" id="6650271">ok</span>&nbsp;<span class="op" id="6650274">:=</span>&nbsp;<span class="ident" id="6650277"><a href="/gostd/net/dnsmsg_test.go.html#6650109">rr</a></span><span class="op" id="6650279">.</span><span class="op" id="6650280">(</span><span class="op" id="6650281">*</span><span class="ident" id="6650282"><a href="/gostd/net/dnsmsg.go.html#3235398">dnsRR_SRV</a></span><span class="op" id="6650291">)</span><span class="op" id="6650292">;</span>&nbsp;<span class="op" id="6650294">!</span><span class="ident" id="6650295"><a href="/gostd/net/dnsmsg_test.go.html#6650271">ok</a></span>&nbsp;<span class="op" id="6650298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650303"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650304">.</span><span class="ident" id="6650305"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6650311">(</span><span class="string" id="6650312">&#34;answer[%d]&nbsp;=&nbsp;%T;&nbsp;want&nbsp;*dnsRR_SRV&#34;</span><span class="op" id="6650346">,</span>&nbsp;<span class="ident" id="6650348"><a href="/gostd/net/dnsmsg_test.go.html#6650104">idx</a></span><span class="op" id="6650351">,</span>&nbsp;<span class="ident" id="6650353"><a href="/gostd/net/dnsmsg_test.go.html#6650109">rr</a></span><span class="op" id="6650355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650362">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650365">_</span><span class="op" id="6650366">,</span>&nbsp;<span class="ident" id="6650368">addrs</span><span class="op" id="6650373">,</span>&nbsp;<span class="ident" id="6650375"><a href="/gostd/net/dnsmsg_test.go.html#6649797">err</a></span>&nbsp;<span class="op" id="6650379">:=</span>&nbsp;<span class="ident" id="6650382"><a href="/gostd/net/dnsclient.go.html#3210274">answer</a></span><span class="op" id="6650388">(</span><span class="string" id="6650389">&#34;_xmpp-server._tcp.google.com.&#34;</span><span class="op" id="6650420">,</span>&nbsp;<span class="string" id="6650422">&#34;foo:53&#34;</span><span class="op" id="6650430">,</span>&nbsp;<span class="ident" id="6650432"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6650435">,</span>&nbsp;<span class="builtintype" id="6650437">uint16</span><span class="op" id="6650443">(</span><span class="ident" id="6650444"><a href="/gostd/net/dnsmsg.go.html#3229100">dnsTypeSRV</a></span><span class="op" id="6650454">)</span><span class="op" id="6650455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650458">if</span>&nbsp;<span class="ident" id="6650461"><a href="/gostd/net/dnsmsg_test.go.html#6649797">err</a></span>&nbsp;<span class="op" id="6650465">!=</span>&nbsp;<span class="builtintype" id="6650468">nil</span>&nbsp;<span class="op" id="6650472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650476"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650477">.</span><span class="ident" id="6650478"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6650484">(</span><span class="string" id="6650485">&#34;answer:&nbsp;%v&#34;</span><span class="op" id="6650497">,</span>&nbsp;<span class="ident" id="6650499"><a href="/gostd/net/dnsmsg_test.go.html#6649797">err</a></span><span class="op" id="6650502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650508">if</span>&nbsp;<span class="ident" id="6650511">g</span><span class="op" id="6650512">,</span>&nbsp;<span class="ident" id="6650514">e</span>&nbsp;<span class="op" id="6650516">:=</span>&nbsp;<span class="builtinfunc" id="6650519">len</span><span class="op" id="6650522">(</span><span class="ident" id="6650523"><a href="/gostd/net/dnsmsg_test.go.html#6650368">addrs</a></span><span class="op" id="6650528">)</span><span class="op" id="6650529">,</span>&nbsp;<span class="num" id="6650531">5</span><span class="op" id="6650532">;</span>&nbsp;<span class="ident" id="6650534"><a href="/gostd/net/dnsmsg_test.go.html#6650511">g</a></span>&nbsp;<span class="op" id="6650536">!=</span>&nbsp;<span class="ident" id="6650539"><a href="/gostd/net/dnsmsg_test.go.html#6650514">e</a></span>&nbsp;<span class="op" id="6650541">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650545"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650546">.</span><span class="ident" id="6650547"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6650553">(</span><span class="string" id="6650554">&#34;len(addrs)&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6650580">,</span>&nbsp;<span class="ident" id="6650582"><a href="/gostd/net/dnsmsg_test.go.html#6650511">g</a></span><span class="op" id="6650583">,</span>&nbsp;<span class="ident" id="6650585"><a href="/gostd/net/dnsmsg_test.go.html#6650514">e</a></span><span class="op" id="6650586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650590"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650591">.</span><span class="ident" id="6650592"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="6650596">(</span><span class="string" id="6650597">&#34;addrs&nbsp;=&nbsp;%#v&#34;</span><span class="op" id="6650610">,</span>&nbsp;<span class="ident" id="6650612"><a href="/gostd/net/dnsmsg_test.go.html#6650368">addrs</a></span><span class="op" id="6650617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6650623">//&nbsp;repack&nbsp;and&nbsp;unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650646">data2</span><span class="op" id="6650651">,</span>&nbsp;<span class="ident" id="6650653"><a href="/gostd/net/dnsmsg_test.go.html#6649890">ok</a></span>&nbsp;<span class="op" id="6650656">:=</span>&nbsp;<span class="ident" id="6650659"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6650662">.</span><span class="ident" id="6650663"><a href="/gostd/net/dnsmsg.go.html#3245999">Pack</a></span><span class="op" id="6650667">(</span><span class="op" id="6650668">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650671">msg2</span>&nbsp;<span class="op" id="6650676">:=</span>&nbsp;<span class="builtinfunc" id="6650679">new</span><span class="op" id="6650682">(</span><span class="ident" id="6650683"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="6650689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650692"><a href="/gostd/net/dnsmsg_test.go.html#6650671">msg2</a></span><span class="op" id="6650696">.</span><span class="ident" id="6650697"><a href="/gostd/net/dnsmsg.go.html#3247295">Unpack</a></span><span class="op" id="6650703">(</span><span class="ident" id="6650704"><a href="/gostd/net/dnsmsg_test.go.html#6650646">data2</a></span><span class="op" id="6650709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650712">switch</span>&nbsp;<span class="op" id="6650719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650722">case</span>&nbsp;<span class="op" id="6650727">!</span><span class="ident" id="6650728"><a href="/gostd/net/dnsmsg_test.go.html#6649890">ok</a></span><span class="op" id="6650730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650734"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650735">.</span><span class="ident" id="6650736"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6650742">(</span><span class="string" id="6650743">&#34;failed&nbsp;to&nbsp;repack&nbsp;message&#34;</span><span class="op" id="6650769">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650772">case</span>&nbsp;<span class="op" id="6650777">!</span><span class="ident" id="6650778"><a href="/gostd/net/dnsmsg_test.go.html#6649724">reflect</a></span><span class="op" id="6650785">.</span><span class="ident" id="6650786"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="6650795">(</span><span class="ident" id="6650796"><a href="/gostd/net/dnsmsg_test.go.html#6649870">msg</a></span><span class="op" id="6650799">,</span>&nbsp;<span class="ident" id="6650801"><a href="/gostd/net/dnsmsg_test.go.html#6650671">msg2</a></span><span class="op" id="6650805">)</span><span class="op" id="6650806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650810"><a href="/gostd/net/dnsmsg_test.go.html#6649774">t</a></span><span class="op" id="6650811">.</span><span class="ident" id="6650812"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6650818">(</span><span class="string" id="6650819">&#34;repacked&nbsp;message&nbsp;differs&nbsp;from&nbsp;original&#34;</span><span class="op" id="6650859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6650862">}</span><br>
<span class="lineno"></span><span class="op" id="6650864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="6650867">func</span>&nbsp;<span class="ident" id="6650872">TestDNSParseCorruptSRVReply</span><span class="op" id="6650899">(</span><span class="ident" id="6650900">t</span>&nbsp;<span class="op" id="6650902">*</span><span class="ident" id="6650903"><a href="/gostd/net/dnsmsg_test.go.html#6649735">testing</a></span><span class="op" id="6650910">.</span><span class="ident" id="6650911"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6650912">)</span>&nbsp;<span class="op" id="6650914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650917">data</span><span class="op" id="6650921">,</span>&nbsp;<span class="ident" id="6650923">err</span>&nbsp;<span class="op" id="6650927">:=</span>&nbsp;<span class="ident" id="6650930"><a href="/gostd/net/dnsmsg_test.go.html#6649708">hex</a></span><span class="op" id="6650933">.</span><span class="ident" id="6650934"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="6650946">(</span><span class="ident" id="6650947"><a href="/gostd/net/dnsmsg_test.go.html#6652720">dnsSRVCorruptReply</a></span><span class="op" id="6650965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6650968">if</span>&nbsp;<span class="ident" id="6650971"><a href="/gostd/net/dnsmsg_test.go.html#6650923">err</a></span>&nbsp;<span class="op" id="6650975">!=</span>&nbsp;<span class="builtintype" id="6650978">nil</span>&nbsp;<span class="op" id="6650982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6650986"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6650987">.</span><span class="ident" id="6650988"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6650993">(</span><span class="ident" id="6650994"><a href="/gostd/net/dnsmsg_test.go.html#6650923">err</a></span><span class="op" id="6650997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651000">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651003">msg</span>&nbsp;<span class="op" id="6651007">:=</span>&nbsp;<span class="builtinfunc" id="6651010">new</span><span class="op" id="6651013">(</span><span class="ident" id="6651014"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="6651020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651023">ok</span>&nbsp;<span class="op" id="6651026">:=</span>&nbsp;<span class="ident" id="6651029"><a href="/gostd/net/dnsmsg_test.go.html#6651003">msg</a></span><span class="op" id="6651032">.</span><span class="ident" id="6651033"><a href="/gostd/net/dnsmsg.go.html#3247295">Unpack</a></span><span class="op" id="6651039">(</span><span class="ident" id="6651040"><a href="/gostd/net/dnsmsg_test.go.html#6650917">data</a></span><span class="op" id="6651044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651047">if</span>&nbsp;<span class="op" id="6651050">!</span><span class="ident" id="6651051"><a href="/gostd/net/dnsmsg_test.go.html#6651023">ok</a></span>&nbsp;<span class="op" id="6651054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651058"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651059">.</span><span class="ident" id="6651060"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6651066">(</span><span class="string" id="6651067">&#34;unpacking&nbsp;packet&nbsp;failed&#34;</span><span class="op" id="6651092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651095">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651098"><a href="/gostd/net/dnsmsg_test.go.html#6651003">msg</a></span><span class="op" id="6651101">.</span><span class="ident" id="6651102"><a href="/gostd/net/dnsmsg.go.html#3248603">String</a></span><span class="op" id="6651108">(</span><span class="op" id="6651109">)</span>&nbsp;<span class="comment" id="6651111">//&nbsp;exercise&nbsp;this&nbsp;code&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651139">if</span>&nbsp;<span class="ident" id="6651142">g</span><span class="op" id="6651143">,</span>&nbsp;<span class="ident" id="6651145">e</span>&nbsp;<span class="op" id="6651147">:=</span>&nbsp;<span class="builtinfunc" id="6651150">len</span><span class="op" id="6651153">(</span><span class="ident" id="6651154"><a href="/gostd/net/dnsmsg_test.go.html#6651003">msg</a></span><span class="op" id="6651157">.</span><span class="ident" id="6651158"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="6651164">)</span><span class="op" id="6651165">,</span>&nbsp;<span class="num" id="6651167">5</span><span class="op" id="6651168">;</span>&nbsp;<span class="ident" id="6651170"><a href="/gostd/net/dnsmsg_test.go.html#6651142">g</a></span>&nbsp;<span class="op" id="6651172">!=</span>&nbsp;<span class="ident" id="6651175"><a href="/gostd/net/dnsmsg_test.go.html#6651145">e</a></span>&nbsp;<span class="op" id="6651177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651181"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651182">.</span><span class="ident" id="6651183"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6651189">(</span><span class="string" id="6651190">&#34;len(msg.answer)&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6651221">,</span>&nbsp;<span class="ident" id="6651223"><a href="/gostd/net/dnsmsg_test.go.html#6651142">g</a></span><span class="op" id="6651224">,</span>&nbsp;<span class="ident" id="6651226"><a href="/gostd/net/dnsmsg_test.go.html#6651145">e</a></span><span class="op" id="6651227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651233">for</span>&nbsp;<span class="ident" id="6651237">idx</span><span class="op" id="6651240">,</span>&nbsp;<span class="ident" id="6651242">rr</span>&nbsp;<span class="op" id="6651245">:=</span>&nbsp;<span class="keyword" id="6651248">range</span>&nbsp;<span class="ident" id="6651254"><a href="/gostd/net/dnsmsg_test.go.html#6651003">msg</a></span><span class="op" id="6651257">.</span><span class="ident" id="6651258"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span>&nbsp;<span class="op" id="6651265">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651269">if</span>&nbsp;<span class="ident" id="6651272">g</span><span class="op" id="6651273">,</span>&nbsp;<span class="ident" id="6651275">e</span>&nbsp;<span class="op" id="6651277">:=</span>&nbsp;<span class="ident" id="6651280"><a href="/gostd/net/dnsmsg_test.go.html#6651242">rr</a></span><span class="op" id="6651282">.</span><span class="ident" id="6651283"><a href="/gostd/net/dnsmsg.go.html#3231814">Header</a></span><span class="op" id="6651289">(</span><span class="op" id="6651290">)</span><span class="op" id="6651291">.</span><span class="ident" id="6651292"><a href="/gostd/net/dnsmsg.go.html#3231372">Rrtype</a></span><span class="op" id="6651298">,</span>&nbsp;<span class="builtintype" id="6651300">uint16</span><span class="op" id="6651306">(</span><span class="ident" id="6651307"><a href="/gostd/net/dnsmsg.go.html#3229100">dnsTypeSRV</a></span><span class="op" id="6651317">)</span><span class="op" id="6651318">;</span>&nbsp;<span class="ident" id="6651320"><a href="/gostd/net/dnsmsg_test.go.html#6651272">g</a></span>&nbsp;<span class="op" id="6651322">!=</span>&nbsp;<span class="ident" id="6651325"><a href="/gostd/net/dnsmsg_test.go.html#6651275">e</a></span>&nbsp;<span class="op" id="6651327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651332"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651333">.</span><span class="ident" id="6651334"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6651340">(</span><span class="string" id="6651341">&#34;rr[%d].Header().Rrtype&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6651379">,</span>&nbsp;<span class="ident" id="6651381"><a href="/gostd/net/dnsmsg_test.go.html#6651237">idx</a></span><span class="op" id="6651384">,</span>&nbsp;<span class="ident" id="6651386"><a href="/gostd/net/dnsmsg_test.go.html#6651272">g</a></span><span class="op" id="6651387">,</span>&nbsp;<span class="ident" id="6651389"><a href="/gostd/net/dnsmsg_test.go.html#6651275">e</a></span><span class="op" id="6651390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651398">if</span>&nbsp;<span class="ident" id="6651401"><a href="/gostd/net/dnsmsg_test.go.html#6651237">idx</a></span>&nbsp;<span class="op" id="6651405">==</span>&nbsp;<span class="num" id="6651408">4</span>&nbsp;<span class="op" id="6651410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651415">if</span>&nbsp;<span class="ident" id="6651418">_</span><span class="op" id="6651419">,</span>&nbsp;<span class="ident" id="6651421">ok</span>&nbsp;<span class="op" id="6651424">:=</span>&nbsp;<span class="ident" id="6651427"><a href="/gostd/net/dnsmsg_test.go.html#6651242">rr</a></span><span class="op" id="6651429">.</span><span class="op" id="6651430">(</span><span class="op" id="6651431">*</span><span class="ident" id="6651432"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><span class="op" id="6651444">)</span><span class="op" id="6651445">;</span>&nbsp;<span class="op" id="6651447">!</span><span class="ident" id="6651448"><a href="/gostd/net/dnsmsg_test.go.html#6651421">ok</a></span>&nbsp;<span class="op" id="6651451">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651457"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651458">.</span><span class="ident" id="6651459"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6651465">(</span><span class="string" id="6651466">&#34;answer[%d]&nbsp;=&nbsp;%T;&nbsp;want&nbsp;*dnsRR_Header&#34;</span><span class="op" id="6651503">,</span>&nbsp;<span class="ident" id="6651505"><a href="/gostd/net/dnsmsg_test.go.html#6651237">idx</a></span><span class="op" id="6651508">,</span>&nbsp;<span class="ident" id="6651510"><a href="/gostd/net/dnsmsg_test.go.html#6651242">rr</a></span><span class="op" id="6651512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651521">}</span>&nbsp;<span class="keyword" id="6651523">else</span>&nbsp;<span class="op" id="6651528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651533">if</span>&nbsp;<span class="ident" id="6651536">_</span><span class="op" id="6651537">,</span>&nbsp;<span class="ident" id="6651539">ok</span>&nbsp;<span class="op" id="6651542">:=</span>&nbsp;<span class="ident" id="6651545"><a href="/gostd/net/dnsmsg_test.go.html#6651242">rr</a></span><span class="op" id="6651547">.</span><span class="op" id="6651548">(</span><span class="op" id="6651549">*</span><span class="ident" id="6651550"><a href="/gostd/net/dnsmsg.go.html#3235398">dnsRR_SRV</a></span><span class="op" id="6651559">)</span><span class="op" id="6651560">;</span>&nbsp;<span class="op" id="6651562">!</span><span class="ident" id="6651563"><a href="/gostd/net/dnsmsg_test.go.html#6651539">ok</a></span>&nbsp;<span class="op" id="6651566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651572"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651573">.</span><span class="ident" id="6651574"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6651580">(</span><span class="string" id="6651581">&#34;answer[%d]&nbsp;=&nbsp;%T;&nbsp;want&nbsp;*dnsRR_SRV&#34;</span><span class="op" id="6651615">,</span>&nbsp;<span class="ident" id="6651617"><a href="/gostd/net/dnsmsg_test.go.html#6651237">idx</a></span><span class="op" id="6651620">,</span>&nbsp;<span class="ident" id="6651622"><a href="/gostd/net/dnsmsg_test.go.html#6651242">rr</a></span><span class="op" id="6651624">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651639">_</span><span class="op" id="6651640">,</span>&nbsp;<span class="ident" id="6651642">addrs</span><span class="op" id="6651647">,</span>&nbsp;<span class="ident" id="6651649"><a href="/gostd/net/dnsmsg_test.go.html#6650923">err</a></span>&nbsp;<span class="op" id="6651653">:=</span>&nbsp;<span class="ident" id="6651656"><a href="/gostd/net/dnsclient.go.html#3210274">answer</a></span><span class="op" id="6651662">(</span><span class="string" id="6651663">&#34;_xmpp-server._tcp.google.com.&#34;</span><span class="op" id="6651694">,</span>&nbsp;<span class="string" id="6651696">&#34;foo:53&#34;</span><span class="op" id="6651704">,</span>&nbsp;<span class="ident" id="6651706"><a href="/gostd/net/dnsmsg_test.go.html#6651003">msg</a></span><span class="op" id="6651709">,</span>&nbsp;<span class="builtintype" id="6651711">uint16</span><span class="op" id="6651717">(</span><span class="ident" id="6651718"><a href="/gostd/net/dnsmsg.go.html#3229100">dnsTypeSRV</a></span><span class="op" id="6651728">)</span><span class="op" id="6651729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651732">if</span>&nbsp;<span class="ident" id="6651735"><a href="/gostd/net/dnsmsg_test.go.html#6650923">err</a></span>&nbsp;<span class="op" id="6651739">!=</span>&nbsp;<span class="builtintype" id="6651742">nil</span>&nbsp;<span class="op" id="6651746">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651750"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651751">.</span><span class="ident" id="6651752"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6651758">(</span><span class="string" id="6651759">&#34;answer:&nbsp;%v&#34;</span><span class="op" id="6651771">,</span>&nbsp;<span class="ident" id="6651773"><a href="/gostd/net/dnsmsg_test.go.html#6650923">err</a></span><span class="op" id="6651776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6651782">if</span>&nbsp;<span class="ident" id="6651785">g</span><span class="op" id="6651786">,</span>&nbsp;<span class="ident" id="6651788">e</span>&nbsp;<span class="op" id="6651790">:=</span>&nbsp;<span class="builtinfunc" id="6651793">len</span><span class="op" id="6651796">(</span><span class="ident" id="6651797"><a href="/gostd/net/dnsmsg_test.go.html#6651642">addrs</a></span><span class="op" id="6651802">)</span><span class="op" id="6651803">,</span>&nbsp;<span class="num" id="6651805">4</span><span class="op" id="6651806">;</span>&nbsp;<span class="ident" id="6651808"><a href="/gostd/net/dnsmsg_test.go.html#6651785">g</a></span>&nbsp;<span class="op" id="6651810">!=</span>&nbsp;<span class="ident" id="6651813"><a href="/gostd/net/dnsmsg_test.go.html#6651788">e</a></span>&nbsp;<span class="op" id="6651815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651819"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651820">.</span><span class="ident" id="6651821"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6651827">(</span><span class="string" id="6651828">&#34;len(addrs)&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6651854">,</span>&nbsp;<span class="ident" id="6651856"><a href="/gostd/net/dnsmsg_test.go.html#6651785">g</a></span><span class="op" id="6651857">,</span>&nbsp;<span class="ident" id="6651859"><a href="/gostd/net/dnsmsg_test.go.html#6651788">e</a></span><span class="op" id="6651860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6651864"><a href="/gostd/net/dnsmsg_test.go.html#6650900">t</a></span><span class="op" id="6651865">.</span><span class="ident" id="6651866"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="6651870">(</span><span class="string" id="6651871">&#34;addrs&nbsp;=&nbsp;%#v&#34;</span><span class="op" id="6651884">,</span>&nbsp;<span class="ident" id="6651886"><a href="/gostd/net/dnsmsg_test.go.html#6651642">addrs</a></span><span class="op" id="6651891">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6651894">}</span><br>
<span class="lineno"></span><span class="op" id="6651896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6651899">//&nbsp;Valid&nbsp;DNS&nbsp;SRV&nbsp;reply</span><br>
<span class="lineno"></span><span class="keyword" id="6651922">const</span>&nbsp;<span class="ident" id="6651928">dnsSRVReply</span>&nbsp;<span class="op" id="6651940">=</span>&nbsp;<span class="string" id="6651942">&#34;0901818000010005000000000c5f786d70702d736572766572045f74637006676f6f67&#34;</span>&nbsp;<span class="op" id="6652015">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652018">&#34;6c6503636f6d0000210001c00c002100010000012c00210014000014950c786d70702d&#34;</span>&nbsp;<span class="op" id="6652091">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652094">&#34;73657276657234016c06676f6f676c6503636f6d00c00c002100010000012c00210014&#34;</span>&nbsp;<span class="op" id="6652167">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652170">&#34;000014950c786d70702d73657276657232016c06676f6f676c6503636f6d00c00c0021&#34;</span>&nbsp;<span class="op" id="6652243">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652246">&#34;00010000012c00210014000014950c786d70702d73657276657233016c06676f6f676c&#34;</span>&nbsp;<span class="op" id="6652319">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652322">&#34;6503636f6d00c00c002100010000012c00200005000014950b786d70702d7365727665&#34;</span>&nbsp;<span class="op" id="6652395">+</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652398">&#34;72016c06676f6f676c6503636f6d00c00c002100010000012c00210014000014950c78&#34;</span>&nbsp;<span class="op" id="6652471">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652474">&#34;6d70702d73657276657231016c06676f6f676c6503636f6d00&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6652528">//&nbsp;Corrupt&nbsp;DNS&nbsp;SRV&nbsp;reply,&nbsp;with&nbsp;its&nbsp;final&nbsp;RR&nbsp;having&nbsp;a&nbsp;bogus&nbsp;length</span><br>
<span class="lineno"></span><span class="comment" id="6652594">//&nbsp;(perhaps&nbsp;it&nbsp;was&nbsp;truncated,&nbsp;or&nbsp;it&#39;s&nbsp;malicious)&nbsp;The&nbsp;mutation&nbsp;is&nbsp;the</span><br>
<span class="lineno">105</span><span class="comment" id="6652663">//&nbsp;capital&nbsp;&#34;FF&#34;&nbsp;below,&nbsp;instead&nbsp;of&nbsp;the&nbsp;proper&nbsp;&#34;21&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6652714">const</span>&nbsp;<span class="ident" id="6652720">dnsSRVCorruptReply</span>&nbsp;<span class="op" id="6652739">=</span>&nbsp;<span class="string" id="6652741">&#34;0901818000010005000000000c5f786d70702d736572766572045f74637006676f6f67&#34;</span>&nbsp;<span class="op" id="6652814">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652817">&#34;6c6503636f6d0000210001c00c002100010000012c00210014000014950c786d70702d&#34;</span>&nbsp;<span class="op" id="6652890">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652893">&#34;73657276657234016c06676f6f676c6503636f6d00c00c002100010000012c00210014&#34;</span>&nbsp;<span class="op" id="6652966">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6652969">&#34;000014950c786d70702d73657276657232016c06676f6f676c6503636f6d00c00c0021&#34;</span>&nbsp;<span class="op" id="6653042">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6653045">&#34;00010000012c00210014000014950c786d70702d73657276657233016c06676f6f676c&#34;</span>&nbsp;<span class="op" id="6653118">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6653121">&#34;6503636f6d00c00c002100010000012c00200005000014950b786d70702d7365727665&#34;</span>&nbsp;<span class="op" id="6653194">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6653197">&#34;72016c06676f6f676c6503636f6d00c00c002100010000012c00FF0014000014950c78&#34;</span>&nbsp;<span class="op" id="6653270">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6653273">&#34;6d70702d73657276657231016c06676f6f676c6503636f6d00&#34;</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
