<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3446672">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3446728">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3446782">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3446833">package</span>&nbsp;<span class="ident" id="3446841">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3446846">import</span>&nbsp;<span class="op" id="3446853">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3446856">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3446862">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3446872">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3446875">func</span>&nbsp;<span class="ident" id="3446880">setIPv4MulticastInterface</span><span class="op" id="3446905">(</span><span class="ident" id="3446906">fd</span>&nbsp;<span class="op" id="3446909">*</span><span class="ident" id="3446910">netFD</span><span class="op" id="3446915">,</span>&nbsp;<span class="ident" id="3446917">ifi</span>&nbsp;<span class="op" id="3446921">*</span><span class="ident" id="3446922">Interface</span><span class="op" id="3446931">)</span>&nbsp;<span class="builtintype" id="3446933">error</span>&nbsp;<span class="op" id="3446939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446942">var</span>&nbsp;<span class="ident" id="3446946">v</span>&nbsp;<span class="builtintype" id="3446948">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446955">if</span>&nbsp;<span class="ident" id="3446958">ifi</span>&nbsp;<span class="op" id="3446962">!=</span>&nbsp;<span class="ident" id="3446965">nil</span>&nbsp;<span class="op" id="3446969">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446973">v</span>&nbsp;<span class="op" id="3446975">=</span>&nbsp;<span class="builtintype" id="3446977">int32</span><span class="op" id="3446982">(</span><span class="ident" id="3446983">ifi</span><span class="op" id="3446986">.</span><span class="ident" id="3446987">Index</span><span class="op" id="3446992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3446995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446998">mreq</span>&nbsp;<span class="op" id="3447003">:=</span>&nbsp;<span class="op" id="3447006">&amp;</span><span class="ident" id="3447007">syscall</span><span class="op" id="3447014">.</span><span class="ident" id="3447015">IPMreqn</span><span class="op" id="3447022">{</span><span class="ident" id="3447023">Ifindex</span><span class="op" id="3447030">:</span>&nbsp;<span class="ident" id="3447032">v</span><span class="op" id="3447033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447036">if</span>&nbsp;<span class="ident" id="3447039">err</span>&nbsp;<span class="op" id="3447043">:=</span>&nbsp;<span class="ident" id="3447046">fd</span><span class="op" id="3447048">.</span><span class="ident" id="3447049">incref</span><span class="op" id="3447055">(</span><span class="op" id="3447056">)</span><span class="op" id="3447057">;</span>&nbsp;<span class="ident" id="3447059">err</span>&nbsp;<span class="op" id="3447063">!=</span>&nbsp;<span class="ident" id="3447066">nil</span>&nbsp;<span class="op" id="3447070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447074">return</span>&nbsp;<span class="ident" id="3447081">err</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447089">defer</span>&nbsp;<span class="ident" id="3447095">fd</span><span class="op" id="3447097">.</span><span class="ident" id="3447098">decref</span><span class="op" id="3447104">(</span><span class="op" id="3447105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447108">return</span>&nbsp;<span class="ident" id="3447115">os</span><span class="op" id="3447117">.</span><span class="ident" id="3447118">NewSyscallError</span><span class="op" id="3447133">(</span><span class="string" id="3447134">&#34;setsockopt&#34;</span><span class="op" id="3447146">,</span>&nbsp;<span class="ident" id="3447148">syscall</span><span class="op" id="3447155">.</span><span class="ident" id="3447156">SetsockoptIPMreqn</span><span class="op" id="3447173">(</span><span class="ident" id="3447174">fd</span><span class="op" id="3447176">.</span><span class="ident" id="3447177">sysfd</span><span class="op" id="3447182">,</span>&nbsp;<span class="ident" id="3447184">syscall</span><span class="op" id="3447191">.</span><span class="ident" id="3447192">IPPROTO_IP</span><span class="op" id="3447202">,</span>&nbsp;<span class="ident" id="3447204">syscall</span><span class="op" id="3447211">.</span><span class="ident" id="3447212">IP_MULTICAST_IF</span><span class="op" id="3447227">,</span>&nbsp;<span class="ident" id="3447229">mreq</span><span class="op" id="3447233">)</span><span class="op" id="3447234">)</span><br>
<span class="lineno"></span><span class="op" id="3447236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3447239">func</span>&nbsp;<span class="ident" id="3447244">setIPv4MulticastLoopback</span><span class="op" id="3447268">(</span><span class="ident" id="3447269">fd</span>&nbsp;<span class="op" id="3447272">*</span><span class="ident" id="3447273">netFD</span><span class="op" id="3447278">,</span>&nbsp;<span class="ident" id="3447280">v</span>&nbsp;<span class="builtintype" id="3447282">bool</span><span class="op" id="3447286">)</span>&nbsp;<span class="builtintype" id="3447288">error</span>&nbsp;<span class="op" id="3447294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447297">if</span>&nbsp;<span class="ident" id="3447300">err</span>&nbsp;<span class="op" id="3447304">:=</span>&nbsp;<span class="ident" id="3447307">fd</span><span class="op" id="3447309">.</span><span class="ident" id="3447310">incref</span><span class="op" id="3447316">(</span><span class="op" id="3447317">)</span><span class="op" id="3447318">;</span>&nbsp;<span class="ident" id="3447320">err</span>&nbsp;<span class="op" id="3447324">!=</span>&nbsp;<span class="ident" id="3447327">nil</span>&nbsp;<span class="op" id="3447331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447335">return</span>&nbsp;<span class="ident" id="3447342">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447350">defer</span>&nbsp;<span class="ident" id="3447356">fd</span><span class="op" id="3447358">.</span><span class="ident" id="3447359">decref</span><span class="op" id="3447365">(</span><span class="op" id="3447366">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447369">return</span>&nbsp;<span class="ident" id="3447376">os</span><span class="op" id="3447378">.</span><span class="ident" id="3447379">NewSyscallError</span><span class="op" id="3447394">(</span><span class="string" id="3447395">&#34;setsockopt&#34;</span><span class="op" id="3447407">,</span>&nbsp;<span class="ident" id="3447409">syscall</span><span class="op" id="3447416">.</span><span class="ident" id="3447417">SetsockoptInt</span><span class="op" id="3447430">(</span><span class="ident" id="3447431">fd</span><span class="op" id="3447433">.</span><span class="ident" id="3447434">sysfd</span><span class="op" id="3447439">,</span>&nbsp;<span class="ident" id="3447441">syscall</span><span class="op" id="3447448">.</span><span class="ident" id="3447449">IPPROTO_IP</span><span class="op" id="3447459">,</span>&nbsp;<span class="ident" id="3447461">syscall</span><span class="op" id="3447468">.</span><span class="ident" id="3447469">IP_MULTICAST_LOOP</span><span class="op" id="3447486">,</span>&nbsp;<span class="ident" id="3447488">boolint</span><span class="op" id="3447495">(</span><span class="ident" id="3447496">v</span><span class="op" id="3447497">)</span><span class="op" id="3447498">)</span><span class="op" id="3447499">)</span><br>
<span class="lineno"></span><span class="op" id="3447501">}</span>
</div>
</body>
</html>
