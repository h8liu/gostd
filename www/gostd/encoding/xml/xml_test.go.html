<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html" class="current">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8030186">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8030242">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8030296">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8030347">package</span>&nbsp;<span class="ident" id="8030355">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8030360">import</span>&nbsp;<span class="op" id="8030367">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030370">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030379">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030386">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030392">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030403">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030414">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030425">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8030440">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8030443">const</span>&nbsp;<span class="ident" id="8030449">testInput</span>&nbsp;<span class="op" id="8030459">=</span>&nbsp;<span class="string" id="8030461">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="8030678">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8030681">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="8030690">+</span>&nbsp;<span class="string" id="8030692">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8030982">var</span>&nbsp;<span class="ident" id="8030986">testEntity</span>&nbsp;<span class="op" id="8030997">=</span>&nbsp;<span class="keyword" id="8030999">map</span><span class="op" id="8031002">[</span><span class="builtintype" id="8031003">string</span><span class="op" id="8031009">]</span><span class="builtintype" id="8031010">string</span><span class="op" id="8031016">{</span><span class="string" id="8031017">&#34;何&#34;</span><span class="op" id="8031022">:</span>&nbsp;<span class="string" id="8031024">&#34;What&#34;</span><span class="op" id="8031030">,</span>&nbsp;<span class="string" id="8031032">&#34;is-it&#34;</span><span class="op" id="8031039">:</span>&nbsp;<span class="string" id="8031041">&#34;is&nbsp;it?&#34;</span><span class="op" id="8031049">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8031052">var</span>&nbsp;<span class="ident" id="8031056">rawTokens</span>&nbsp;<span class="op" id="8031066">=</span>&nbsp;<span class="op" id="8031068">[</span><span class="op" id="8031069">]</span><span class="ident" id="8031070">Token</span><span class="op" id="8031075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031078">CharData</span><span class="op" id="8031086">(</span><span class="string" id="8031087">&#34;\n&#34;</span><span class="op" id="8031091">)</span><span class="op" id="8031092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031095">ProcInst</span><span class="op" id="8031103">{</span><span class="string" id="8031104">&#34;xml&#34;</span><span class="op" id="8031109">,</span>&nbsp;<span class="op" id="8031111">[</span><span class="op" id="8031112">]</span><span class="builtintype" id="8031113">byte</span><span class="op" id="8031117">(</span><span class="string" id="8031118">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8031150">)</span><span class="op" id="8031151">}</span><span class="op" id="8031152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031155">CharData</span><span class="op" id="8031163">(</span><span class="string" id="8031164">&#34;\n&#34;</span><span class="op" id="8031168">)</span><span class="op" id="8031169">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031172">Directive</span><span class="op" id="8031181">(</span><span class="string" id="8031182">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8031304">)</span><span class="op" id="8031305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031308">CharData</span><span class="op" id="8031316">(</span><span class="string" id="8031317">&#34;\n&#34;</span><span class="op" id="8031321">)</span><span class="op" id="8031322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031325">StartElement</span><span class="op" id="8031337">{</span><span class="ident" id="8031338">Name</span><span class="op" id="8031342">{</span><span class="string" id="8031343">&#34;&#34;</span><span class="op" id="8031345">,</span>&nbsp;<span class="string" id="8031347">&#34;body&#34;</span><span class="op" id="8031353">}</span><span class="op" id="8031354">,</span>&nbsp;<span class="op" id="8031356">[</span><span class="op" id="8031357">]</span><span class="ident" id="8031358">Attr</span><span class="op" id="8031362">{</span><span class="op" id="8031363">{</span><span class="ident" id="8031364">Name</span><span class="op" id="8031368">{</span><span class="string" id="8031369">&#34;xmlns&#34;</span><span class="op" id="8031376">,</span>&nbsp;<span class="string" id="8031378">&#34;foo&#34;</span><span class="op" id="8031383">}</span><span class="op" id="8031384">,</span>&nbsp;<span class="string" id="8031386">&#34;ns1&#34;</span><span class="op" id="8031391">}</span><span class="op" id="8031392">,</span>&nbsp;<span class="op" id="8031394">{</span><span class="ident" id="8031395">Name</span><span class="op" id="8031399">{</span><span class="string" id="8031400">&#34;&#34;</span><span class="op" id="8031402">,</span>&nbsp;<span class="string" id="8031404">&#34;xmlns&#34;</span><span class="op" id="8031411">}</span><span class="op" id="8031412">,</span>&nbsp;<span class="string" id="8031414">&#34;ns2&#34;</span><span class="op" id="8031419">}</span><span class="op" id="8031420">,</span>&nbsp;<span class="op" id="8031422">{</span><span class="ident" id="8031423">Name</span><span class="op" id="8031427">{</span><span class="string" id="8031428">&#34;xmlns&#34;</span><span class="op" id="8031435">,</span>&nbsp;<span class="string" id="8031437">&#34;tag&#34;</span><span class="op" id="8031442">}</span><span class="op" id="8031443">,</span>&nbsp;<span class="string" id="8031445">&#34;ns3&#34;</span><span class="op" id="8031450">}</span><span class="op" id="8031451">}</span><span class="op" id="8031452">}</span><span class="op" id="8031453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031456">CharData</span><span class="op" id="8031464">(</span><span class="string" id="8031465">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8031471">)</span><span class="op" id="8031472">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031475">StartElement</span><span class="op" id="8031487">{</span><span class="ident" id="8031488">Name</span><span class="op" id="8031492">{</span><span class="string" id="8031493">&#34;&#34;</span><span class="op" id="8031495">,</span>&nbsp;<span class="string" id="8031497">&#34;hello&#34;</span><span class="op" id="8031504">}</span><span class="op" id="8031505">,</span>&nbsp;<span class="op" id="8031507">[</span><span class="op" id="8031508">]</span><span class="ident" id="8031509">Attr</span><span class="op" id="8031513">{</span><span class="op" id="8031514">{</span><span class="ident" id="8031515">Name</span><span class="op" id="8031519">{</span><span class="string" id="8031520">&#34;&#34;</span><span class="op" id="8031522">,</span>&nbsp;<span class="string" id="8031524">&#34;lang&#34;</span><span class="op" id="8031530">}</span><span class="op" id="8031531">,</span>&nbsp;<span class="string" id="8031533">&#34;en&#34;</span><span class="op" id="8031537">}</span><span class="op" id="8031538">}</span><span class="op" id="8031539">}</span><span class="op" id="8031540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031543">CharData</span><span class="op" id="8031551">(</span><span class="string" id="8031552">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8031575">)</span><span class="op" id="8031576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031579">EndElement</span><span class="op" id="8031589">{</span><span class="ident" id="8031590">Name</span><span class="op" id="8031594">{</span><span class="string" id="8031595">&#34;&#34;</span><span class="op" id="8031597">,</span>&nbsp;<span class="string" id="8031599">&#34;hello&#34;</span><span class="op" id="8031606">}</span><span class="op" id="8031607">}</span><span class="op" id="8031608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031611">CharData</span><span class="op" id="8031619">(</span><span class="string" id="8031620">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8031626">)</span><span class="op" id="8031627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031630">StartElement</span><span class="op" id="8031642">{</span><span class="ident" id="8031643">Name</span><span class="op" id="8031647">{</span><span class="string" id="8031648">&#34;&#34;</span><span class="op" id="8031650">,</span>&nbsp;<span class="string" id="8031652">&#34;query&#34;</span><span class="op" id="8031659">}</span><span class="op" id="8031660">,</span>&nbsp;<span class="op" id="8031662">[</span><span class="op" id="8031663">]</span><span class="ident" id="8031664">Attr</span><span class="op" id="8031668">{</span><span class="op" id="8031669">}</span><span class="op" id="8031670">}</span><span class="op" id="8031671">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031674">CharData</span><span class="op" id="8031682">(</span><span class="string" id="8031683">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8031696">)</span><span class="op" id="8031697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031700">EndElement</span><span class="op" id="8031710">{</span><span class="ident" id="8031711">Name</span><span class="op" id="8031715">{</span><span class="string" id="8031716">&#34;&#34;</span><span class="op" id="8031718">,</span>&nbsp;<span class="string" id="8031720">&#34;query&#34;</span><span class="op" id="8031727">}</span><span class="op" id="8031728">}</span><span class="op" id="8031729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031732">CharData</span><span class="op" id="8031740">(</span><span class="string" id="8031741">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8031747">)</span><span class="op" id="8031748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031751">StartElement</span><span class="op" id="8031763">{</span><span class="ident" id="8031764">Name</span><span class="op" id="8031768">{</span><span class="string" id="8031769">&#34;&#34;</span><span class="op" id="8031771">,</span>&nbsp;<span class="string" id="8031773">&#34;goodbye&#34;</span><span class="op" id="8031782">}</span><span class="op" id="8031783">,</span>&nbsp;<span class="op" id="8031785">[</span><span class="op" id="8031786">]</span><span class="ident" id="8031787">Attr</span><span class="op" id="8031791">{</span><span class="op" id="8031792">}</span><span class="op" id="8031793">}</span><span class="op" id="8031794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031797">EndElement</span><span class="op" id="8031807">{</span><span class="ident" id="8031808">Name</span><span class="op" id="8031812">{</span><span class="string" id="8031813">&#34;&#34;</span><span class="op" id="8031815">,</span>&nbsp;<span class="string" id="8031817">&#34;goodbye&#34;</span><span class="op" id="8031826">}</span><span class="op" id="8031827">}</span><span class="op" id="8031828">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031831">CharData</span><span class="op" id="8031839">(</span><span class="string" id="8031840">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8031846">)</span><span class="op" id="8031847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031850">StartElement</span><span class="op" id="8031862">{</span><span class="ident" id="8031863">Name</span><span class="op" id="8031867">{</span><span class="string" id="8031868">&#34;&#34;</span><span class="op" id="8031870">,</span>&nbsp;<span class="string" id="8031872">&#34;outer&#34;</span><span class="op" id="8031879">}</span><span class="op" id="8031880">,</span>&nbsp;<span class="op" id="8031882">[</span><span class="op" id="8031883">]</span><span class="ident" id="8031884">Attr</span><span class="op" id="8031888">{</span><span class="op" id="8031889">{</span><span class="ident" id="8031890">Name</span><span class="op" id="8031894">{</span><span class="string" id="8031895">&#34;foo&#34;</span><span class="op" id="8031900">,</span>&nbsp;<span class="string" id="8031902">&#34;attr&#34;</span><span class="op" id="8031908">}</span><span class="op" id="8031909">,</span>&nbsp;<span class="string" id="8031911">&#34;value&#34;</span><span class="op" id="8031918">}</span><span class="op" id="8031919">,</span>&nbsp;<span class="op" id="8031921">{</span><span class="ident" id="8031922">Name</span><span class="op" id="8031926">{</span><span class="string" id="8031927">&#34;xmlns&#34;</span><span class="op" id="8031934">,</span>&nbsp;<span class="string" id="8031936">&#34;tag&#34;</span><span class="op" id="8031941">}</span><span class="op" id="8031942">,</span>&nbsp;<span class="string" id="8031944">&#34;ns4&#34;</span><span class="op" id="8031949">}</span><span class="op" id="8031950">}</span><span class="op" id="8031951">}</span><span class="op" id="8031952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031955">CharData</span><span class="op" id="8031963">(</span><span class="string" id="8031964">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8031972">)</span><span class="op" id="8031973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8031976">StartElement</span><span class="op" id="8031988">{</span><span class="ident" id="8031989">Name</span><span class="op" id="8031993">{</span><span class="string" id="8031994">&#34;&#34;</span><span class="op" id="8031996">,</span>&nbsp;<span class="string" id="8031998">&#34;inner&#34;</span><span class="op" id="8032005">}</span><span class="op" id="8032006">,</span>&nbsp;<span class="op" id="8032008">[</span><span class="op" id="8032009">]</span><span class="ident" id="8032010">Attr</span><span class="op" id="8032014">{</span><span class="op" id="8032015">}</span><span class="op" id="8032016">}</span><span class="op" id="8032017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032020">EndElement</span><span class="op" id="8032030">{</span><span class="ident" id="8032031">Name</span><span class="op" id="8032035">{</span><span class="string" id="8032036">&#34;&#34;</span><span class="op" id="8032038">,</span>&nbsp;<span class="string" id="8032040">&#34;inner&#34;</span><span class="op" id="8032047">}</span><span class="op" id="8032048">}</span><span class="op" id="8032049">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032052">CharData</span><span class="op" id="8032060">(</span><span class="string" id="8032061">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8032067">)</span><span class="op" id="8032068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032071">EndElement</span><span class="op" id="8032081">{</span><span class="ident" id="8032082">Name</span><span class="op" id="8032086">{</span><span class="string" id="8032087">&#34;&#34;</span><span class="op" id="8032089">,</span>&nbsp;<span class="string" id="8032091">&#34;outer&#34;</span><span class="op" id="8032098">}</span><span class="op" id="8032099">}</span><span class="op" id="8032100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032103">CharData</span><span class="op" id="8032111">(</span><span class="string" id="8032112">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8032118">)</span><span class="op" id="8032119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032122">StartElement</span><span class="op" id="8032134">{</span><span class="ident" id="8032135">Name</span><span class="op" id="8032139">{</span><span class="string" id="8032140">&#34;tag&#34;</span><span class="op" id="8032145">,</span>&nbsp;<span class="string" id="8032147">&#34;name&#34;</span><span class="op" id="8032153">}</span><span class="op" id="8032154">,</span>&nbsp;<span class="op" id="8032156">[</span><span class="op" id="8032157">]</span><span class="ident" id="8032158">Attr</span><span class="op" id="8032162">{</span><span class="op" id="8032163">}</span><span class="op" id="8032164">}</span><span class="op" id="8032165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032168">CharData</span><span class="op" id="8032176">(</span><span class="string" id="8032177">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8032185">)</span><span class="op" id="8032186">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032189">CharData</span><span class="op" id="8032197">(</span><span class="string" id="8032198">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8032215">)</span><span class="op" id="8032216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032219">CharData</span><span class="op" id="8032227">(</span><span class="string" id="8032228">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8032234">)</span><span class="op" id="8032235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032238">EndElement</span><span class="op" id="8032248">{</span><span class="ident" id="8032249">Name</span><span class="op" id="8032253">{</span><span class="string" id="8032254">&#34;tag&#34;</span><span class="op" id="8032259">,</span>&nbsp;<span class="string" id="8032261">&#34;name&#34;</span><span class="op" id="8032267">}</span><span class="op" id="8032268">}</span><span class="op" id="8032269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032272">CharData</span><span class="op" id="8032280">(</span><span class="string" id="8032281">&#34;\n&#34;</span><span class="op" id="8032285">)</span><span class="op" id="8032286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032289">EndElement</span><span class="op" id="8032299">{</span><span class="ident" id="8032300">Name</span><span class="op" id="8032304">{</span><span class="string" id="8032305">&#34;&#34;</span><span class="op" id="8032307">,</span>&nbsp;<span class="string" id="8032309">&#34;body&#34;</span><span class="op" id="8032315">}</span><span class="op" id="8032316">}</span><span class="op" id="8032317">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032320">Comment</span><span class="op" id="8032327">(</span><span class="string" id="8032328">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8032353">)</span><span class="op" id="8032354">,</span><br>
<span class="lineno"></span><span class="op" id="8032356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8032359">var</span>&nbsp;<span class="ident" id="8032363">cookedTokens</span>&nbsp;<span class="op" id="8032376">=</span>&nbsp;<span class="op" id="8032378">[</span><span class="op" id="8032379">]</span><span class="ident" id="8032380">Token</span><span class="op" id="8032385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032388">CharData</span><span class="op" id="8032396">(</span><span class="string" id="8032397">&#34;\n&#34;</span><span class="op" id="8032401">)</span><span class="op" id="8032402">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032405">ProcInst</span><span class="op" id="8032413">{</span><span class="string" id="8032414">&#34;xml&#34;</span><span class="op" id="8032419">,</span>&nbsp;<span class="op" id="8032421">[</span><span class="op" id="8032422">]</span><span class="builtintype" id="8032423">byte</span><span class="op" id="8032427">(</span><span class="string" id="8032428">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8032460">)</span><span class="op" id="8032461">}</span><span class="op" id="8032462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032465">CharData</span><span class="op" id="8032473">(</span><span class="string" id="8032474">&#34;\n&#34;</span><span class="op" id="8032478">)</span><span class="op" id="8032479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032482">Directive</span><span class="op" id="8032491">(</span><span class="string" id="8032492">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8032614">)</span><span class="op" id="8032615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032618">CharData</span><span class="op" id="8032626">(</span><span class="string" id="8032627">&#34;\n&#34;</span><span class="op" id="8032631">)</span><span class="op" id="8032632">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032635">StartElement</span><span class="op" id="8032647">{</span><span class="ident" id="8032648">Name</span><span class="op" id="8032652">{</span><span class="string" id="8032653">&#34;ns2&#34;</span><span class="op" id="8032658">,</span>&nbsp;<span class="string" id="8032660">&#34;body&#34;</span><span class="op" id="8032666">}</span><span class="op" id="8032667">,</span>&nbsp;<span class="op" id="8032669">[</span><span class="op" id="8032670">]</span><span class="ident" id="8032671">Attr</span><span class="op" id="8032675">{</span><span class="op" id="8032676">{</span><span class="ident" id="8032677">Name</span><span class="op" id="8032681">{</span><span class="string" id="8032682">&#34;xmlns&#34;</span><span class="op" id="8032689">,</span>&nbsp;<span class="string" id="8032691">&#34;foo&#34;</span><span class="op" id="8032696">}</span><span class="op" id="8032697">,</span>&nbsp;<span class="string" id="8032699">&#34;ns1&#34;</span><span class="op" id="8032704">}</span><span class="op" id="8032705">,</span>&nbsp;<span class="op" id="8032707">{</span><span class="ident" id="8032708">Name</span><span class="op" id="8032712">{</span><span class="string" id="8032713">&#34;&#34;</span><span class="op" id="8032715">,</span>&nbsp;<span class="string" id="8032717">&#34;xmlns&#34;</span><span class="op" id="8032724">}</span><span class="op" id="8032725">,</span>&nbsp;<span class="string" id="8032727">&#34;ns2&#34;</span><span class="op" id="8032732">}</span><span class="op" id="8032733">,</span>&nbsp;<span class="op" id="8032735">{</span><span class="ident" id="8032736">Name</span><span class="op" id="8032740">{</span><span class="string" id="8032741">&#34;xmlns&#34;</span><span class="op" id="8032748">,</span>&nbsp;<span class="string" id="8032750">&#34;tag&#34;</span><span class="op" id="8032755">}</span><span class="op" id="8032756">,</span>&nbsp;<span class="string" id="8032758">&#34;ns3&#34;</span><span class="op" id="8032763">}</span><span class="op" id="8032764">}</span><span class="op" id="8032765">}</span><span class="op" id="8032766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032769">CharData</span><span class="op" id="8032777">(</span><span class="string" id="8032778">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8032784">)</span><span class="op" id="8032785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032788">StartElement</span><span class="op" id="8032800">{</span><span class="ident" id="8032801">Name</span><span class="op" id="8032805">{</span><span class="string" id="8032806">&#34;ns2&#34;</span><span class="op" id="8032811">,</span>&nbsp;<span class="string" id="8032813">&#34;hello&#34;</span><span class="op" id="8032820">}</span><span class="op" id="8032821">,</span>&nbsp;<span class="op" id="8032823">[</span><span class="op" id="8032824">]</span><span class="ident" id="8032825">Attr</span><span class="op" id="8032829">{</span><span class="op" id="8032830">{</span><span class="ident" id="8032831">Name</span><span class="op" id="8032835">{</span><span class="string" id="8032836">&#34;&#34;</span><span class="op" id="8032838">,</span>&nbsp;<span class="string" id="8032840">&#34;lang&#34;</span><span class="op" id="8032846">}</span><span class="op" id="8032847">,</span>&nbsp;<span class="string" id="8032849">&#34;en&#34;</span><span class="op" id="8032853">}</span><span class="op" id="8032854">}</span><span class="op" id="8032855">}</span><span class="op" id="8032856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032859">CharData</span><span class="op" id="8032867">(</span><span class="string" id="8032868">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8032891">)</span><span class="op" id="8032892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032895">EndElement</span><span class="op" id="8032905">{</span><span class="ident" id="8032906">Name</span><span class="op" id="8032910">{</span><span class="string" id="8032911">&#34;ns2&#34;</span><span class="op" id="8032916">,</span>&nbsp;<span class="string" id="8032918">&#34;hello&#34;</span><span class="op" id="8032925">}</span><span class="op" id="8032926">}</span><span class="op" id="8032927">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032930">CharData</span><span class="op" id="8032938">(</span><span class="string" id="8032939">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8032945">)</span><span class="op" id="8032946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032949">StartElement</span><span class="op" id="8032961">{</span><span class="ident" id="8032962">Name</span><span class="op" id="8032966">{</span><span class="string" id="8032967">&#34;ns2&#34;</span><span class="op" id="8032972">,</span>&nbsp;<span class="string" id="8032974">&#34;query&#34;</span><span class="op" id="8032981">}</span><span class="op" id="8032982">,</span>&nbsp;<span class="op" id="8032984">[</span><span class="op" id="8032985">]</span><span class="ident" id="8032986">Attr</span><span class="op" id="8032990">{</span><span class="op" id="8032991">}</span><span class="op" id="8032992">}</span><span class="op" id="8032993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8032996">CharData</span><span class="op" id="8033004">(</span><span class="string" id="8033005">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8033018">)</span><span class="op" id="8033019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033022">EndElement</span><span class="op" id="8033032">{</span><span class="ident" id="8033033">Name</span><span class="op" id="8033037">{</span><span class="string" id="8033038">&#34;ns2&#34;</span><span class="op" id="8033043">,</span>&nbsp;<span class="string" id="8033045">&#34;query&#34;</span><span class="op" id="8033052">}</span><span class="op" id="8033053">}</span><span class="op" id="8033054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033057">CharData</span><span class="op" id="8033065">(</span><span class="string" id="8033066">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8033072">)</span><span class="op" id="8033073">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033076">StartElement</span><span class="op" id="8033088">{</span><span class="ident" id="8033089">Name</span><span class="op" id="8033093">{</span><span class="string" id="8033094">&#34;ns2&#34;</span><span class="op" id="8033099">,</span>&nbsp;<span class="string" id="8033101">&#34;goodbye&#34;</span><span class="op" id="8033110">}</span><span class="op" id="8033111">,</span>&nbsp;<span class="op" id="8033113">[</span><span class="op" id="8033114">]</span><span class="ident" id="8033115">Attr</span><span class="op" id="8033119">{</span><span class="op" id="8033120">}</span><span class="op" id="8033121">}</span><span class="op" id="8033122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033125">EndElement</span><span class="op" id="8033135">{</span><span class="ident" id="8033136">Name</span><span class="op" id="8033140">{</span><span class="string" id="8033141">&#34;ns2&#34;</span><span class="op" id="8033146">,</span>&nbsp;<span class="string" id="8033148">&#34;goodbye&#34;</span><span class="op" id="8033157">}</span><span class="op" id="8033158">}</span><span class="op" id="8033159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033162">CharData</span><span class="op" id="8033170">(</span><span class="string" id="8033171">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8033177">)</span><span class="op" id="8033178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033181">StartElement</span><span class="op" id="8033193">{</span><span class="ident" id="8033194">Name</span><span class="op" id="8033198">{</span><span class="string" id="8033199">&#34;ns2&#34;</span><span class="op" id="8033204">,</span>&nbsp;<span class="string" id="8033206">&#34;outer&#34;</span><span class="op" id="8033213">}</span><span class="op" id="8033214">,</span>&nbsp;<span class="op" id="8033216">[</span><span class="op" id="8033217">]</span><span class="ident" id="8033218">Attr</span><span class="op" id="8033222">{</span><span class="op" id="8033223">{</span><span class="ident" id="8033224">Name</span><span class="op" id="8033228">{</span><span class="string" id="8033229">&#34;ns1&#34;</span><span class="op" id="8033234">,</span>&nbsp;<span class="string" id="8033236">&#34;attr&#34;</span><span class="op" id="8033242">}</span><span class="op" id="8033243">,</span>&nbsp;<span class="string" id="8033245">&#34;value&#34;</span><span class="op" id="8033252">}</span><span class="op" id="8033253">,</span>&nbsp;<span class="op" id="8033255">{</span><span class="ident" id="8033256">Name</span><span class="op" id="8033260">{</span><span class="string" id="8033261">&#34;xmlns&#34;</span><span class="op" id="8033268">,</span>&nbsp;<span class="string" id="8033270">&#34;tag&#34;</span><span class="op" id="8033275">}</span><span class="op" id="8033276">,</span>&nbsp;<span class="string" id="8033278">&#34;ns4&#34;</span><span class="op" id="8033283">}</span><span class="op" id="8033284">}</span><span class="op" id="8033285">}</span><span class="op" id="8033286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033289">CharData</span><span class="op" id="8033297">(</span><span class="string" id="8033298">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8033306">)</span><span class="op" id="8033307">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033310">StartElement</span><span class="op" id="8033322">{</span><span class="ident" id="8033323">Name</span><span class="op" id="8033327">{</span><span class="string" id="8033328">&#34;ns2&#34;</span><span class="op" id="8033333">,</span>&nbsp;<span class="string" id="8033335">&#34;inner&#34;</span><span class="op" id="8033342">}</span><span class="op" id="8033343">,</span>&nbsp;<span class="op" id="8033345">[</span><span class="op" id="8033346">]</span><span class="ident" id="8033347">Attr</span><span class="op" id="8033351">{</span><span class="op" id="8033352">}</span><span class="op" id="8033353">}</span><span class="op" id="8033354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033357">EndElement</span><span class="op" id="8033367">{</span><span class="ident" id="8033368">Name</span><span class="op" id="8033372">{</span><span class="string" id="8033373">&#34;ns2&#34;</span><span class="op" id="8033378">,</span>&nbsp;<span class="string" id="8033380">&#34;inner&#34;</span><span class="op" id="8033387">}</span><span class="op" id="8033388">}</span><span class="op" id="8033389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033392">CharData</span><span class="op" id="8033400">(</span><span class="string" id="8033401">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8033407">)</span><span class="op" id="8033408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033411">EndElement</span><span class="op" id="8033421">{</span><span class="ident" id="8033422">Name</span><span class="op" id="8033426">{</span><span class="string" id="8033427">&#34;ns2&#34;</span><span class="op" id="8033432">,</span>&nbsp;<span class="string" id="8033434">&#34;outer&#34;</span><span class="op" id="8033441">}</span><span class="op" id="8033442">}</span><span class="op" id="8033443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033446">CharData</span><span class="op" id="8033454">(</span><span class="string" id="8033455">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8033461">)</span><span class="op" id="8033462">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033465">StartElement</span><span class="op" id="8033477">{</span><span class="ident" id="8033478">Name</span><span class="op" id="8033482">{</span><span class="string" id="8033483">&#34;ns3&#34;</span><span class="op" id="8033488">,</span>&nbsp;<span class="string" id="8033490">&#34;name&#34;</span><span class="op" id="8033496">}</span><span class="op" id="8033497">,</span>&nbsp;<span class="op" id="8033499">[</span><span class="op" id="8033500">]</span><span class="ident" id="8033501">Attr</span><span class="op" id="8033505">{</span><span class="op" id="8033506">}</span><span class="op" id="8033507">}</span><span class="op" id="8033508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033511">CharData</span><span class="op" id="8033519">(</span><span class="string" id="8033520">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8033528">)</span><span class="op" id="8033529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033532">CharData</span><span class="op" id="8033540">(</span><span class="string" id="8033541">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8033558">)</span><span class="op" id="8033559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033562">CharData</span><span class="op" id="8033570">(</span><span class="string" id="8033571">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8033577">)</span><span class="op" id="8033578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033581">EndElement</span><span class="op" id="8033591">{</span><span class="ident" id="8033592">Name</span><span class="op" id="8033596">{</span><span class="string" id="8033597">&#34;ns3&#34;</span><span class="op" id="8033602">,</span>&nbsp;<span class="string" id="8033604">&#34;name&#34;</span><span class="op" id="8033610">}</span><span class="op" id="8033611">}</span><span class="op" id="8033612">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033615">CharData</span><span class="op" id="8033623">(</span><span class="string" id="8033624">&#34;\n&#34;</span><span class="op" id="8033628">)</span><span class="op" id="8033629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033632">EndElement</span><span class="op" id="8033642">{</span><span class="ident" id="8033643">Name</span><span class="op" id="8033647">{</span><span class="string" id="8033648">&#34;ns2&#34;</span><span class="op" id="8033653">,</span>&nbsp;<span class="string" id="8033655">&#34;body&#34;</span><span class="op" id="8033661">}</span><span class="op" id="8033662">}</span><span class="op" id="8033663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033666">Comment</span><span class="op" id="8033673">(</span><span class="string" id="8033674">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8033699">)</span><span class="op" id="8033700">,</span><br>
<span class="lineno"></span><span class="op" id="8033702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8033705">const</span>&nbsp;<span class="ident" id="8033711">testInputAltEncoding</span>&nbsp;<span class="op" id="8033732">=</span>&nbsp;<span class="string" id="8033734">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8033808">var</span>&nbsp;<span class="ident" id="8033812">rawTokensAltEncoding</span>&nbsp;<span class="op" id="8033833">=</span>&nbsp;<span class="op" id="8033835">[</span><span class="op" id="8033836">]</span><span class="ident" id="8033837">Token</span><span class="op" id="8033842">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033845">CharData</span><span class="op" id="8033853">(</span><span class="string" id="8033854">&#34;\n&#34;</span><span class="op" id="8033858">)</span><span class="op" id="8033859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033862">ProcInst</span><span class="op" id="8033870">{</span><span class="string" id="8033871">&#34;xml&#34;</span><span class="op" id="8033876">,</span>&nbsp;<span class="op" id="8033878">[</span><span class="op" id="8033879">]</span><span class="builtintype" id="8033880">byte</span><span class="op" id="8033884">(</span><span class="string" id="8033885">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="8033931">)</span><span class="op" id="8033932">}</span><span class="op" id="8033933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033936">CharData</span><span class="op" id="8033944">(</span><span class="string" id="8033945">&#34;\n&#34;</span><span class="op" id="8033949">)</span><span class="op" id="8033950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033953">StartElement</span><span class="op" id="8033965">{</span><span class="ident" id="8033966">Name</span><span class="op" id="8033970">{</span><span class="string" id="8033971">&#34;&#34;</span><span class="op" id="8033973">,</span>&nbsp;<span class="string" id="8033975">&#34;tag&#34;</span><span class="op" id="8033980">}</span><span class="op" id="8033981">,</span>&nbsp;<span class="op" id="8033983">[</span><span class="op" id="8033984">]</span><span class="ident" id="8033985">Attr</span><span class="op" id="8033989">{</span><span class="op" id="8033990">}</span><span class="op" id="8033991">}</span><span class="op" id="8033992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8033995">CharData</span><span class="op" id="8034003">(</span><span class="string" id="8034004">&#34;value&#34;</span><span class="op" id="8034011">)</span><span class="op" id="8034012">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034015">EndElement</span><span class="op" id="8034025">{</span><span class="ident" id="8034026">Name</span><span class="op" id="8034030">{</span><span class="string" id="8034031">&#34;&#34;</span><span class="op" id="8034033">,</span>&nbsp;<span class="string" id="8034035">&#34;tag&#34;</span><span class="op" id="8034040">}</span><span class="op" id="8034041">}</span><span class="op" id="8034042">,</span><br>
<span class="lineno"></span><span class="op" id="8034044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8034047">var</span>&nbsp;<span class="ident" id="8034051">xmlInput</span>&nbsp;<span class="op" id="8034060">=</span>&nbsp;<span class="op" id="8034062">[</span><span class="op" id="8034063">]</span><span class="builtintype" id="8034064">string</span><span class="op" id="8034070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034073">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034098">&#34;&lt;&#34;</span><span class="op" id="8034101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034104">&#34;&lt;t&#34;</span><span class="op" id="8034108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034111">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="8034116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034119">&#34;&lt;t/&#34;</span><span class="op" id="8034124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034127">&#34;&lt;!&#34;</span><span class="op" id="8034131">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034134">&#34;&lt;!-&#34;</span><span class="op" id="8034139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034142">&#34;&lt;!--&#34;</span><span class="op" id="8034148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034151">&#34;&lt;!--c-&#34;</span><span class="op" id="8034159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034162">&#34;&lt;!--c--&#34;</span><span class="op" id="8034171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034174">&#34;&lt;!d&#34;</span><span class="op" id="8034179">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034182">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="8034189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034192">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="8034200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034203">&#34;&lt;?&#34;</span><span class="op" id="8034207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034210">&#34;&lt;?p&#34;</span><span class="op" id="8034215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034218">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="8034224">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034227">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="8034234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034237">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="8034245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034248">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="8034257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034260">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="8034269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034272">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="8034282">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034285">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="8034301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034304">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="8034321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034324">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="8034342">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034346">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034370">&#34;&lt;&gt;&#34;</span><span class="op" id="8034374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034377">&#34;&lt;t/a&#34;</span><span class="op" id="8034383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034386">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="8034393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034396">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="8034403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034406">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034452">&#34;&lt;/0&gt;&#34;</span><span class="op" id="8034458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034461">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="8034471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034474">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="8034485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034488">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="8034499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034502">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="8034518">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034521">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="8034528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034531">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="8034539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034542">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="8034551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8034554">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034608">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="8034617">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034620">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="8034628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034631">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="8034640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8034643">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="8034660">,</span><br>
<span class="lineno"></span><span class="op" id="8034662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="8034665">func</span>&nbsp;<span class="ident" id="8034670">TestRawToken</span><span class="op" id="8034682">(</span><span class="ident" id="8034683">t</span>&nbsp;<span class="op" id="8034685">*</span><span class="ident" id="8034686">testing</span><span class="op" id="8034693">.</span><span class="ident" id="8034694">T</span><span class="op" id="8034695">)</span>&nbsp;<span class="op" id="8034697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034700">d</span>&nbsp;<span class="op" id="8034702">:=</span>&nbsp;<span class="ident" id="8034705">NewDecoder</span><span class="op" id="8034715">(</span><span class="ident" id="8034716">strings</span><span class="op" id="8034723">.</span><span class="ident" id="8034724">NewReader</span><span class="op" id="8034733">(</span><span class="ident" id="8034734">testInput</span><span class="op" id="8034743">)</span><span class="op" id="8034744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034747">d</span><span class="op" id="8034748">.</span><span class="ident" id="8034749">Entity</span>&nbsp;<span class="op" id="8034756">=</span>&nbsp;<span class="ident" id="8034758">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8034770">testRawToken</span><span class="op" id="8034782">(</span><span class="ident" id="8034783">t</span><span class="op" id="8034784">,</span>&nbsp;<span class="ident" id="8034786">d</span><span class="op" id="8034787">,</span>&nbsp;<span class="ident" id="8034789">testInput</span><span class="op" id="8034798">,</span>&nbsp;<span class="ident" id="8034800">rawTokens</span><span class="op" id="8034809">)</span><br>
<span class="lineno"></span><span class="op" id="8034811">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8034814">const</span>&nbsp;<span class="ident" id="8034820">nonStrictInput</span>&nbsp;<span class="op" id="8034835">=</span>&nbsp;<span class="string" id="8034837">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8034999">var</span>&nbsp;<span class="ident" id="8035003">nonStringEntity</span>&nbsp;<span class="op" id="8035019">=</span>&nbsp;<span class="keyword" id="8035021">map</span><span class="op" id="8035024">[</span><span class="builtintype" id="8035025">string</span><span class="op" id="8035031">]</span><span class="builtintype" id="8035032">string</span><span class="op" id="8035038">{</span><span class="string" id="8035039">&#34;&#34;</span><span class="op" id="8035041">:</span>&nbsp;<span class="string" id="8035043">&#34;oops!&#34;</span><span class="op" id="8035050">,</span>&nbsp;<span class="string" id="8035052">&#34;0a&#34;</span><span class="op" id="8035056">:</span>&nbsp;<span class="string" id="8035058">&#34;oops!&#34;</span><span class="op" id="8035065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8035068">var</span>&nbsp;<span class="ident" id="8035072">nonStrictTokens</span>&nbsp;<span class="op" id="8035088">=</span>&nbsp;<span class="op" id="8035090">[</span><span class="op" id="8035091">]</span><span class="ident" id="8035092">Token</span><span class="op" id="8035097">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035100">CharData</span><span class="op" id="8035108">(</span><span class="string" id="8035109">&#34;\n&#34;</span><span class="op" id="8035113">)</span><span class="op" id="8035114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035117">StartElement</span><span class="op" id="8035129">{</span><span class="ident" id="8035130">Name</span><span class="op" id="8035134">{</span><span class="string" id="8035135">&#34;&#34;</span><span class="op" id="8035137">,</span>&nbsp;<span class="string" id="8035139">&#34;tag&#34;</span><span class="op" id="8035144">}</span><span class="op" id="8035145">,</span>&nbsp;<span class="op" id="8035147">[</span><span class="op" id="8035148">]</span><span class="ident" id="8035149">Attr</span><span class="op" id="8035153">{</span><span class="op" id="8035154">}</span><span class="op" id="8035155">}</span><span class="op" id="8035156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035159">CharData</span><span class="op" id="8035167">(</span><span class="string" id="8035168">&#34;non&amp;entity&#34;</span><span class="op" id="8035180">)</span><span class="op" id="8035181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035184">EndElement</span><span class="op" id="8035194">{</span><span class="ident" id="8035195">Name</span><span class="op" id="8035199">{</span><span class="string" id="8035200">&#34;&#34;</span><span class="op" id="8035202">,</span>&nbsp;<span class="string" id="8035204">&#34;tag&#34;</span><span class="op" id="8035209">}</span><span class="op" id="8035210">}</span><span class="op" id="8035211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035214">CharData</span><span class="op" id="8035222">(</span><span class="string" id="8035223">&#34;\n&#34;</span><span class="op" id="8035227">)</span><span class="op" id="8035228">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035231">StartElement</span><span class="op" id="8035243">{</span><span class="ident" id="8035244">Name</span><span class="op" id="8035248">{</span><span class="string" id="8035249">&#34;&#34;</span><span class="op" id="8035251">,</span>&nbsp;<span class="string" id="8035253">&#34;tag&#34;</span><span class="op" id="8035258">}</span><span class="op" id="8035259">,</span>&nbsp;<span class="op" id="8035261">[</span><span class="op" id="8035262">]</span><span class="ident" id="8035263">Attr</span><span class="op" id="8035267">{</span><span class="op" id="8035268">}</span><span class="op" id="8035269">}</span><span class="op" id="8035270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035273">CharData</span><span class="op" id="8035281">(</span><span class="string" id="8035282">&#34;&amp;unknown;entity&#34;</span><span class="op" id="8035299">)</span><span class="op" id="8035300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035303">EndElement</span><span class="op" id="8035313">{</span><span class="ident" id="8035314">Name</span><span class="op" id="8035318">{</span><span class="string" id="8035319">&#34;&#34;</span><span class="op" id="8035321">,</span>&nbsp;<span class="string" id="8035323">&#34;tag&#34;</span><span class="op" id="8035328">}</span><span class="op" id="8035329">}</span><span class="op" id="8035330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035333">CharData</span><span class="op" id="8035341">(</span><span class="string" id="8035342">&#34;\n&#34;</span><span class="op" id="8035346">)</span><span class="op" id="8035347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035350">StartElement</span><span class="op" id="8035362">{</span><span class="ident" id="8035363">Name</span><span class="op" id="8035367">{</span><span class="string" id="8035368">&#34;&#34;</span><span class="op" id="8035370">,</span>&nbsp;<span class="string" id="8035372">&#34;tag&#34;</span><span class="op" id="8035377">}</span><span class="op" id="8035378">,</span>&nbsp;<span class="op" id="8035380">[</span><span class="op" id="8035381">]</span><span class="ident" id="8035382">Attr</span><span class="op" id="8035386">{</span><span class="op" id="8035387">}</span><span class="op" id="8035388">}</span><span class="op" id="8035389">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035392">CharData</span><span class="op" id="8035400">(</span><span class="string" id="8035401">&#34;&amp;#123&#34;</span><span class="op" id="8035408">)</span><span class="op" id="8035409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035412">EndElement</span><span class="op" id="8035422">{</span><span class="ident" id="8035423">Name</span><span class="op" id="8035427">{</span><span class="string" id="8035428">&#34;&#34;</span><span class="op" id="8035430">,</span>&nbsp;<span class="string" id="8035432">&#34;tag&#34;</span><span class="op" id="8035437">}</span><span class="op" id="8035438">}</span><span class="op" id="8035439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035442">CharData</span><span class="op" id="8035450">(</span><span class="string" id="8035451">&#34;\n&#34;</span><span class="op" id="8035455">)</span><span class="op" id="8035456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035459">StartElement</span><span class="op" id="8035471">{</span><span class="ident" id="8035472">Name</span><span class="op" id="8035476">{</span><span class="string" id="8035477">&#34;&#34;</span><span class="op" id="8035479">,</span>&nbsp;<span class="string" id="8035481">&#34;tag&#34;</span><span class="op" id="8035486">}</span><span class="op" id="8035487">,</span>&nbsp;<span class="op" id="8035489">[</span><span class="op" id="8035490">]</span><span class="ident" id="8035491">Attr</span><span class="op" id="8035495">{</span><span class="op" id="8035496">}</span><span class="op" id="8035497">}</span><span class="op" id="8035498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035501">CharData</span><span class="op" id="8035509">(</span><span class="string" id="8035510">&#34;&amp;#zzz;&#34;</span><span class="op" id="8035518">)</span><span class="op" id="8035519">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035522">EndElement</span><span class="op" id="8035532">{</span><span class="ident" id="8035533">Name</span><span class="op" id="8035537">{</span><span class="string" id="8035538">&#34;&#34;</span><span class="op" id="8035540">,</span>&nbsp;<span class="string" id="8035542">&#34;tag&#34;</span><span class="op" id="8035547">}</span><span class="op" id="8035548">}</span><span class="op" id="8035549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035552">CharData</span><span class="op" id="8035560">(</span><span class="string" id="8035561">&#34;\n&#34;</span><span class="op" id="8035565">)</span><span class="op" id="8035566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035569">StartElement</span><span class="op" id="8035581">{</span><span class="ident" id="8035582">Name</span><span class="op" id="8035586">{</span><span class="string" id="8035587">&#34;&#34;</span><span class="op" id="8035589">,</span>&nbsp;<span class="string" id="8035591">&#34;tag&#34;</span><span class="op" id="8035596">}</span><span class="op" id="8035597">,</span>&nbsp;<span class="op" id="8035599">[</span><span class="op" id="8035600">]</span><span class="ident" id="8035601">Attr</span><span class="op" id="8035605">{</span><span class="op" id="8035606">}</span><span class="op" id="8035607">}</span><span class="op" id="8035608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035611">CharData</span><span class="op" id="8035619">(</span><span class="string" id="8035620">&#34;&amp;なまえ3;&#34;</span><span class="op" id="8035634">)</span><span class="op" id="8035635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035638">EndElement</span><span class="op" id="8035648">{</span><span class="ident" id="8035649">Name</span><span class="op" id="8035653">{</span><span class="string" id="8035654">&#34;&#34;</span><span class="op" id="8035656">,</span>&nbsp;<span class="string" id="8035658">&#34;tag&#34;</span><span class="op" id="8035663">}</span><span class="op" id="8035664">}</span><span class="op" id="8035665">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035668">CharData</span><span class="op" id="8035676">(</span><span class="string" id="8035677">&#34;\n&#34;</span><span class="op" id="8035681">)</span><span class="op" id="8035682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035685">StartElement</span><span class="op" id="8035697">{</span><span class="ident" id="8035698">Name</span><span class="op" id="8035702">{</span><span class="string" id="8035703">&#34;&#34;</span><span class="op" id="8035705">,</span>&nbsp;<span class="string" id="8035707">&#34;tag&#34;</span><span class="op" id="8035712">}</span><span class="op" id="8035713">,</span>&nbsp;<span class="op" id="8035715">[</span><span class="op" id="8035716">]</span><span class="ident" id="8035717">Attr</span><span class="op" id="8035721">{</span><span class="op" id="8035722">}</span><span class="op" id="8035723">}</span><span class="op" id="8035724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035727">CharData</span><span class="op" id="8035735">(</span><span class="string" id="8035736">&#34;&amp;lt-gt;&#34;</span><span class="op" id="8035745">)</span><span class="op" id="8035746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035749">EndElement</span><span class="op" id="8035759">{</span><span class="ident" id="8035760">Name</span><span class="op" id="8035764">{</span><span class="string" id="8035765">&#34;&#34;</span><span class="op" id="8035767">,</span>&nbsp;<span class="string" id="8035769">&#34;tag&#34;</span><span class="op" id="8035774">}</span><span class="op" id="8035775">}</span><span class="op" id="8035776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035779">CharData</span><span class="op" id="8035787">(</span><span class="string" id="8035788">&#34;\n&#34;</span><span class="op" id="8035792">)</span><span class="op" id="8035793">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035796">StartElement</span><span class="op" id="8035808">{</span><span class="ident" id="8035809">Name</span><span class="op" id="8035813">{</span><span class="string" id="8035814">&#34;&#34;</span><span class="op" id="8035816">,</span>&nbsp;<span class="string" id="8035818">&#34;tag&#34;</span><span class="op" id="8035823">}</span><span class="op" id="8035824">,</span>&nbsp;<span class="op" id="8035826">[</span><span class="op" id="8035827">]</span><span class="ident" id="8035828">Attr</span><span class="op" id="8035832">{</span><span class="op" id="8035833">}</span><span class="op" id="8035834">}</span><span class="op" id="8035835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035838">CharData</span><span class="op" id="8035846">(</span><span class="string" id="8035847">&#34;&amp;;&#34;</span><span class="op" id="8035851">)</span><span class="op" id="8035852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035855">EndElement</span><span class="op" id="8035865">{</span><span class="ident" id="8035866">Name</span><span class="op" id="8035870">{</span><span class="string" id="8035871">&#34;&#34;</span><span class="op" id="8035873">,</span>&nbsp;<span class="string" id="8035875">&#34;tag&#34;</span><span class="op" id="8035880">}</span><span class="op" id="8035881">}</span><span class="op" id="8035882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035885">CharData</span><span class="op" id="8035893">(</span><span class="string" id="8035894">&#34;\n&#34;</span><span class="op" id="8035898">)</span><span class="op" id="8035899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035902">StartElement</span><span class="op" id="8035914">{</span><span class="ident" id="8035915">Name</span><span class="op" id="8035919">{</span><span class="string" id="8035920">&#34;&#34;</span><span class="op" id="8035922">,</span>&nbsp;<span class="string" id="8035924">&#34;tag&#34;</span><span class="op" id="8035929">}</span><span class="op" id="8035930">,</span>&nbsp;<span class="op" id="8035932">[</span><span class="op" id="8035933">]</span><span class="ident" id="8035934">Attr</span><span class="op" id="8035938">{</span><span class="op" id="8035939">}</span><span class="op" id="8035940">}</span><span class="op" id="8035941">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035944">CharData</span><span class="op" id="8035952">(</span><span class="string" id="8035953">&#34;&amp;0a;&#34;</span><span class="op" id="8035959">)</span><span class="op" id="8035960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035963">EndElement</span><span class="op" id="8035973">{</span><span class="ident" id="8035974">Name</span><span class="op" id="8035978">{</span><span class="string" id="8035979">&#34;&#34;</span><span class="op" id="8035981">,</span>&nbsp;<span class="string" id="8035983">&#34;tag&#34;</span><span class="op" id="8035988">}</span><span class="op" id="8035989">}</span><span class="op" id="8035990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8035993">CharData</span><span class="op" id="8036001">(</span><span class="string" id="8036002">&#34;\n&#34;</span><span class="op" id="8036006">)</span><span class="op" id="8036007">,</span><br>
<span class="lineno"></span><span class="op" id="8036009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="8036012">func</span>&nbsp;<span class="ident" id="8036017">TestNonStrictRawToken</span><span class="op" id="8036038">(</span><span class="ident" id="8036039">t</span>&nbsp;<span class="op" id="8036041">*</span><span class="ident" id="8036042">testing</span><span class="op" id="8036049">.</span><span class="ident" id="8036050">T</span><span class="op" id="8036051">)</span>&nbsp;<span class="op" id="8036053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036056">d</span>&nbsp;<span class="op" id="8036058">:=</span>&nbsp;<span class="ident" id="8036061">NewDecoder</span><span class="op" id="8036071">(</span><span class="ident" id="8036072">strings</span><span class="op" id="8036079">.</span><span class="ident" id="8036080">NewReader</span><span class="op" id="8036089">(</span><span class="ident" id="8036090">nonStrictInput</span><span class="op" id="8036104">)</span><span class="op" id="8036105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036108">d</span><span class="op" id="8036109">.</span><span class="ident" id="8036110">Strict</span>&nbsp;<span class="op" id="8036117">=</span>&nbsp;<span class="builtintype" id="8036119">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036126">testRawToken</span><span class="op" id="8036138">(</span><span class="ident" id="8036139">t</span><span class="op" id="8036140">,</span>&nbsp;<span class="ident" id="8036142">d</span><span class="op" id="8036143">,</span>&nbsp;<span class="ident" id="8036145">nonStrictInput</span><span class="op" id="8036159">,</span>&nbsp;<span class="ident" id="8036161">nonStrictTokens</span><span class="op" id="8036176">)</span><br>
<span class="lineno"></span><span class="op" id="8036178">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="8036181">type</span>&nbsp;<span class="ident" id="8036186">downCaser</span>&nbsp;<span class="keyword" id="8036196">struct</span>&nbsp;<span class="op" id="8036203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036206">t</span>&nbsp;<span class="op" id="8036208">*</span><span class="ident" id="8036209">testing</span><span class="op" id="8036216">.</span><span class="ident" id="8036217">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036220">r</span>&nbsp;<span class="ident" id="8036222">io</span><span class="op" id="8036224">.</span><span class="ident" id="8036225">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="8036236">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="8036239">func</span>&nbsp;<span class="op" id="8036244">(</span><span class="ident" id="8036245">d</span>&nbsp;<span class="op" id="8036247">*</span><span class="ident" id="8036248">downCaser</span><span class="op" id="8036257">)</span>&nbsp;<span class="ident" id="8036259">ReadByte</span><span class="op" id="8036267">(</span><span class="op" id="8036268">)</span>&nbsp;<span class="op" id="8036270">(</span><span class="ident" id="8036271">c</span>&nbsp;<span class="builtintype" id="8036273">byte</span><span class="op" id="8036277">,</span>&nbsp;<span class="ident" id="8036279">err</span>&nbsp;<span class="builtintype" id="8036283">error</span><span class="op" id="8036288">)</span>&nbsp;<span class="op" id="8036290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036293">c</span><span class="op" id="8036294">,</span>&nbsp;<span class="ident" id="8036296">err</span>&nbsp;<span class="op" id="8036300">=</span>&nbsp;<span class="ident" id="8036302">d</span><span class="op" id="8036303">.</span><span class="ident" id="8036304">r</span><span class="op" id="8036305">.</span><span class="ident" id="8036306">ReadByte</span><span class="op" id="8036314">(</span><span class="op" id="8036315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8036318">if</span>&nbsp;<span class="ident" id="8036321">c</span>&nbsp;<span class="op" id="8036323">&gt;=</span>&nbsp;<span class="string" id="8036326">&#39;A&#39;</span>&nbsp;<span class="op" id="8036330">&amp;&amp;</span>&nbsp;<span class="ident" id="8036333">c</span>&nbsp;<span class="op" id="8036335">&lt;=</span>&nbsp;<span class="string" id="8036338">&#39;Z&#39;</span>&nbsp;<span class="op" id="8036342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036346">c</span>&nbsp;<span class="op" id="8036348">+=</span>&nbsp;<span class="string" id="8036351">&#39;a&#39;</span>&nbsp;<span class="op" id="8036355">-</span>&nbsp;<span class="string" id="8036357">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8036362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8036365">return</span><br>
<span class="lineno"></span><span class="op" id="8036372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8036375">func</span>&nbsp;<span class="op" id="8036380">(</span><span class="ident" id="8036381">d</span>&nbsp;<span class="op" id="8036383">*</span><span class="ident" id="8036384">downCaser</span><span class="op" id="8036393">)</span>&nbsp;<span class="ident" id="8036395">Read</span><span class="op" id="8036399">(</span><span class="ident" id="8036400">p</span>&nbsp;<span class="op" id="8036402">[</span><span class="op" id="8036403">]</span><span class="builtintype" id="8036404">byte</span><span class="op" id="8036408">)</span>&nbsp;<span class="op" id="8036410">(</span><span class="builtintype" id="8036411">int</span><span class="op" id="8036414">,</span>&nbsp;<span class="builtintype" id="8036416">error</span><span class="op" id="8036421">)</span>&nbsp;<span class="op" id="8036423">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036426">d</span><span class="op" id="8036427">.</span><span class="ident" id="8036428">t</span><span class="op" id="8036429">.</span><span class="ident" id="8036430">Fatalf</span><span class="op" id="8036436">(</span><span class="string" id="8036437">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="8036479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8036482">panic</span><span class="op" id="8036487">(</span><span class="string" id="8036488">&#34;unreachable&#34;</span><span class="op" id="8036501">)</span><br>
<span class="lineno"></span><span class="op" id="8036503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8036506">func</span>&nbsp;<span class="ident" id="8036511">TestRawTokenAltEncoding</span><span class="op" id="8036534">(</span><span class="ident" id="8036535">t</span>&nbsp;<span class="op" id="8036537">*</span><span class="ident" id="8036538">testing</span><span class="op" id="8036545">.</span><span class="ident" id="8036546">T</span><span class="op" id="8036547">)</span>&nbsp;<span class="op" id="8036549">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036552">d</span>&nbsp;<span class="op" id="8036554">:=</span>&nbsp;<span class="ident" id="8036557">NewDecoder</span><span class="op" id="8036567">(</span><span class="ident" id="8036568">strings</span><span class="op" id="8036575">.</span><span class="ident" id="8036576">NewReader</span><span class="op" id="8036585">(</span><span class="ident" id="8036586">testInputAltEncoding</span><span class="op" id="8036606">)</span><span class="op" id="8036607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036610">d</span><span class="op" id="8036611">.</span><span class="ident" id="8036612">CharsetReader</span>&nbsp;<span class="op" id="8036626">=</span>&nbsp;<span class="keyword" id="8036628">func</span><span class="op" id="8036632">(</span><span class="ident" id="8036633">charset</span>&nbsp;<span class="builtintype" id="8036641">string</span><span class="op" id="8036647">,</span>&nbsp;<span class="ident" id="8036649">input</span>&nbsp;<span class="ident" id="8036655">io</span><span class="op" id="8036657">.</span><span class="ident" id="8036658">Reader</span><span class="op" id="8036664">)</span>&nbsp;<span class="op" id="8036666">(</span><span class="ident" id="8036667">io</span><span class="op" id="8036669">.</span><span class="ident" id="8036670">Reader</span><span class="op" id="8036676">,</span>&nbsp;<span class="builtintype" id="8036678">error</span><span class="op" id="8036683">)</span>&nbsp;<span class="op" id="8036685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8036689">if</span>&nbsp;<span class="ident" id="8036692">charset</span>&nbsp;<span class="op" id="8036700">!=</span>&nbsp;<span class="string" id="8036703">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="8036725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036730">t</span><span class="op" id="8036731">.</span><span class="ident" id="8036732">Fatalf</span><span class="op" id="8036738">(</span><span class="string" id="8036739">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="8036762">,</span>&nbsp;<span class="ident" id="8036764">charset</span><span class="op" id="8036771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8036775">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8036779">return</span>&nbsp;<span class="op" id="8036786">&amp;</span><span class="ident" id="8036787">downCaser</span><span class="op" id="8036796">{</span><span class="ident" id="8036797">t</span><span class="op" id="8036798">,</span>&nbsp;<span class="ident" id="8036800">input</span><span class="op" id="8036805">.</span><span class="op" id="8036806">(</span><span class="ident" id="8036807">io</span><span class="op" id="8036809">.</span><span class="ident" id="8036810">ByteReader</span><span class="op" id="8036820">)</span><span class="op" id="8036821">}</span><span class="op" id="8036822">,</span>&nbsp;<span class="builtintype" id="8036824">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8036829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036832">testRawToken</span><span class="op" id="8036844">(</span><span class="ident" id="8036845">t</span><span class="op" id="8036846">,</span>&nbsp;<span class="ident" id="8036848">d</span><span class="op" id="8036849">,</span>&nbsp;<span class="ident" id="8036851">testInputAltEncoding</span><span class="op" id="8036871">,</span>&nbsp;<span class="ident" id="8036873">rawTokensAltEncoding</span><span class="op" id="8036893">)</span><br>
<span class="lineno"></span><span class="op" id="8036895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="8036898">func</span>&nbsp;<span class="ident" id="8036903">TestRawTokenAltEncodingNoConverter</span><span class="op" id="8036937">(</span><span class="ident" id="8036938">t</span>&nbsp;<span class="op" id="8036940">*</span><span class="ident" id="8036941">testing</span><span class="op" id="8036948">.</span><span class="ident" id="8036949">T</span><span class="op" id="8036950">)</span>&nbsp;<span class="op" id="8036952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8036955">d</span>&nbsp;<span class="op" id="8036957">:=</span>&nbsp;<span class="ident" id="8036960">NewDecoder</span><span class="op" id="8036970">(</span><span class="ident" id="8036971">strings</span><span class="op" id="8036978">.</span><span class="ident" id="8036979">NewReader</span><span class="op" id="8036988">(</span><span class="ident" id="8036989">testInputAltEncoding</span><span class="op" id="8037009">)</span><span class="op" id="8037010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037013">token</span><span class="op" id="8037018">,</span>&nbsp;<span class="ident" id="8037020">err</span>&nbsp;<span class="op" id="8037024">:=</span>&nbsp;<span class="ident" id="8037027">d</span><span class="op" id="8037028">.</span><span class="ident" id="8037029">RawToken</span><span class="op" id="8037037">(</span><span class="op" id="8037038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037041">if</span>&nbsp;<span class="ident" id="8037044">token</span>&nbsp;<span class="op" id="8037050">==</span>&nbsp;<span class="builtintype" id="8037053">nil</span>&nbsp;<span class="op" id="8037057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037061">t</span><span class="op" id="8037062">.</span><span class="ident" id="8037063">Fatalf</span><span class="op" id="8037069">(</span><span class="string" id="8037070">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8037111">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037117">if</span>&nbsp;<span class="ident" id="8037120">err</span>&nbsp;<span class="op" id="8037124">!=</span>&nbsp;<span class="builtintype" id="8037127">nil</span>&nbsp;<span class="op" id="8037131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037135">t</span><span class="op" id="8037136">.</span><span class="ident" id="8037137">Fatal</span><span class="op" id="8037142">(</span><span class="ident" id="8037143">err</span><span class="op" id="8037146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037152">token</span><span class="op" id="8037157">,</span>&nbsp;<span class="ident" id="8037159">err</span>&nbsp;<span class="op" id="8037163">=</span>&nbsp;<span class="ident" id="8037165">d</span><span class="op" id="8037166">.</span><span class="ident" id="8037167">RawToken</span><span class="op" id="8037175">(</span><span class="op" id="8037176">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037179">if</span>&nbsp;<span class="ident" id="8037182">token</span>&nbsp;<span class="op" id="8037188">!=</span>&nbsp;<span class="builtintype" id="8037191">nil</span>&nbsp;<span class="op" id="8037195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037199">t</span><span class="op" id="8037200">.</span><span class="ident" id="8037201">Errorf</span><span class="op" id="8037207">(</span><span class="string" id="8037208">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8037239">,</span>&nbsp;<span class="ident" id="8037241">token</span><span class="op" id="8037246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037252">if</span>&nbsp;<span class="ident" id="8037255">err</span>&nbsp;<span class="op" id="8037259">==</span>&nbsp;<span class="builtintype" id="8037262">nil</span>&nbsp;<span class="op" id="8037266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037270">t</span><span class="op" id="8037271">.</span><span class="ident" id="8037272">Fatalf</span><span class="op" id="8037278">(</span><span class="string" id="8037279">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8037322">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037328">const</span>&nbsp;<span class="ident" id="8037334">encoding</span>&nbsp;<span class="op" id="8037343">=</span>&nbsp;<span class="string" id="8037345">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037368">if</span>&nbsp;<span class="op" id="8037371">!</span><span class="ident" id="8037372">strings</span><span class="op" id="8037379">.</span><span class="ident" id="8037380">Contains</span><span class="op" id="8037388">(</span><span class="ident" id="8037389">err</span><span class="op" id="8037392">.</span><span class="ident" id="8037393">Error</span><span class="op" id="8037398">(</span><span class="op" id="8037399">)</span><span class="op" id="8037400">,</span>&nbsp;<span class="ident" id="8037402">encoding</span><span class="op" id="8037410">)</span>&nbsp;<span class="op" id="8037412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037416">t</span><span class="op" id="8037417">.</span><span class="ident" id="8037418">Errorf</span><span class="op" id="8037424">(</span><span class="string" id="8037425">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8037470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037475">encoding</span><span class="op" id="8037483">,</span>&nbsp;<span class="ident" id="8037485">err</span><span class="op" id="8037488">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037491">}</span><br>
<span class="lineno"></span><span class="op" id="8037493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8037496">func</span>&nbsp;<span class="ident" id="8037501">testRawToken</span><span class="op" id="8037513">(</span><span class="ident" id="8037514">t</span>&nbsp;<span class="op" id="8037516">*</span><span class="ident" id="8037517">testing</span><span class="op" id="8037524">.</span><span class="ident" id="8037525">T</span><span class="op" id="8037526">,</span>&nbsp;<span class="ident" id="8037528">d</span>&nbsp;<span class="op" id="8037530">*</span><span class="ident" id="8037531">Decoder</span><span class="op" id="8037538">,</span>&nbsp;<span class="ident" id="8037540">raw</span>&nbsp;<span class="builtintype" id="8037544">string</span><span class="op" id="8037550">,</span>&nbsp;<span class="ident" id="8037552">rawTokens</span>&nbsp;<span class="op" id="8037562">[</span><span class="op" id="8037563">]</span><span class="ident" id="8037564">Token</span><span class="op" id="8037569">)</span>&nbsp;<span class="op" id="8037571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037574">lastEnd</span>&nbsp;<span class="op" id="8037582">:=</span>&nbsp;<span class="ident" id="8037585">int64</span><span class="op" id="8037590">(</span><span class="num" id="8037591">0</span><span class="op" id="8037592">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037595">for</span>&nbsp;<span class="ident" id="8037599">i</span><span class="op" id="8037600">,</span>&nbsp;<span class="ident" id="8037602">want</span>&nbsp;<span class="op" id="8037607">:=</span>&nbsp;<span class="keyword" id="8037610">range</span>&nbsp;<span class="ident" id="8037616">rawTokens</span>&nbsp;<span class="op" id="8037626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037630">start</span>&nbsp;<span class="op" id="8037636">:=</span>&nbsp;<span class="ident" id="8037639">d</span><span class="op" id="8037640">.</span><span class="ident" id="8037641">InputOffset</span><span class="op" id="8037652">(</span><span class="op" id="8037653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037657">have</span><span class="op" id="8037661">,</span>&nbsp;<span class="ident" id="8037663">err</span>&nbsp;<span class="op" id="8037667">:=</span>&nbsp;<span class="ident" id="8037670">d</span><span class="op" id="8037671">.</span><span class="ident" id="8037672">RawToken</span><span class="op" id="8037680">(</span><span class="op" id="8037681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037685">end</span>&nbsp;<span class="op" id="8037689">:=</span>&nbsp;<span class="ident" id="8037692">d</span><span class="op" id="8037693">.</span><span class="ident" id="8037694">InputOffset</span><span class="op" id="8037705">(</span><span class="op" id="8037706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037710">if</span>&nbsp;<span class="ident" id="8037713">err</span>&nbsp;<span class="op" id="8037717">!=</span>&nbsp;<span class="builtintype" id="8037720">nil</span>&nbsp;<span class="op" id="8037724">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037729">t</span><span class="op" id="8037730">.</span><span class="ident" id="8037731">Fatalf</span><span class="op" id="8037737">(</span><span class="string" id="8037738">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8037770">,</span>&nbsp;<span class="ident" id="8037772">i</span><span class="op" id="8037773">,</span>&nbsp;<span class="ident" id="8037775">err</span><span class="op" id="8037778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037786">if</span>&nbsp;<span class="op" id="8037789">!</span><span class="ident" id="8037790">reflect</span><span class="op" id="8037797">.</span><span class="ident" id="8037798">DeepEqual</span><span class="op" id="8037807">(</span><span class="ident" id="8037808">have</span><span class="op" id="8037812">,</span>&nbsp;<span class="ident" id="8037814">want</span><span class="op" id="8037818">)</span>&nbsp;<span class="op" id="8037820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037825">var</span>&nbsp;<span class="ident" id="8037829">shave</span><span class="op" id="8037834">,</span>&nbsp;<span class="ident" id="8037836">swant</span>&nbsp;<span class="builtintype" id="8037842">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037852">if</span>&nbsp;<span class="ident" id="8037855">_</span><span class="op" id="8037856">,</span>&nbsp;<span class="ident" id="8037858">ok</span>&nbsp;<span class="op" id="8037861">:=</span>&nbsp;<span class="ident" id="8037864">have</span><span class="op" id="8037868">.</span><span class="op" id="8037869">(</span><span class="ident" id="8037870">CharData</span><span class="op" id="8037878">)</span><span class="op" id="8037879">;</span>&nbsp;<span class="ident" id="8037881">ok</span>&nbsp;<span class="op" id="8037884">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037890">shave</span>&nbsp;<span class="op" id="8037896">=</span>&nbsp;<span class="ident" id="8037898">fmt</span><span class="op" id="8037901">.</span><span class="ident" id="8037902">Sprintf</span><span class="op" id="8037909">(</span><span class="string" id="8037910">&#34;CharData(%q)&#34;</span><span class="op" id="8037924">,</span>&nbsp;<span class="ident" id="8037926">have</span><span class="op" id="8037930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037935">}</span>&nbsp;<span class="keyword" id="8037937">else</span>&nbsp;<span class="op" id="8037942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8037948">shave</span>&nbsp;<span class="op" id="8037954">=</span>&nbsp;<span class="ident" id="8037956">fmt</span><span class="op" id="8037959">.</span><span class="ident" id="8037960">Sprintf</span><span class="op" id="8037967">(</span><span class="string" id="8037968">&#34;%#v&#34;</span><span class="op" id="8037973">,</span>&nbsp;<span class="ident" id="8037975">have</span><span class="op" id="8037979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8037984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8037989">if</span>&nbsp;<span class="ident" id="8037992">_</span><span class="op" id="8037993">,</span>&nbsp;<span class="ident" id="8037995">ok</span>&nbsp;<span class="op" id="8037998">:=</span>&nbsp;<span class="ident" id="8038001">want</span><span class="op" id="8038005">.</span><span class="op" id="8038006">(</span><span class="ident" id="8038007">CharData</span><span class="op" id="8038015">)</span><span class="op" id="8038016">;</span>&nbsp;<span class="ident" id="8038018">ok</span>&nbsp;<span class="op" id="8038021">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038027">swant</span>&nbsp;<span class="op" id="8038033">=</span>&nbsp;<span class="ident" id="8038035">fmt</span><span class="op" id="8038038">.</span><span class="ident" id="8038039">Sprintf</span><span class="op" id="8038046">(</span><span class="string" id="8038047">&#34;CharData(%q)&#34;</span><span class="op" id="8038061">,</span>&nbsp;<span class="ident" id="8038063">want</span><span class="op" id="8038067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038072">}</span>&nbsp;<span class="keyword" id="8038074">else</span>&nbsp;<span class="op" id="8038079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038085">swant</span>&nbsp;<span class="op" id="8038091">=</span>&nbsp;<span class="ident" id="8038093">fmt</span><span class="op" id="8038096">.</span><span class="ident" id="8038097">Sprintf</span><span class="op" id="8038104">(</span><span class="string" id="8038105">&#34;%#v&#34;</span><span class="op" id="8038110">,</span>&nbsp;<span class="ident" id="8038112">want</span><span class="op" id="8038116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038126">t</span><span class="op" id="8038127">.</span><span class="ident" id="8038128">Errorf</span><span class="op" id="8038134">(</span><span class="string" id="8038135">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8038159">,</span>&nbsp;<span class="ident" id="8038161">i</span><span class="op" id="8038162">,</span>&nbsp;<span class="ident" id="8038164">shave</span><span class="op" id="8038169">,</span>&nbsp;<span class="ident" id="8038171">swant</span><span class="op" id="8038176">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8038185">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038236">switch</span>&nbsp;<span class="op" id="8038243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038247">case</span>&nbsp;<span class="ident" id="8038252">start</span>&nbsp;<span class="op" id="8038258">&lt;</span>&nbsp;<span class="ident" id="8038260">lastEnd</span><span class="op" id="8038267">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038272">t</span><span class="op" id="8038273">.</span><span class="ident" id="8038274">Errorf</span><span class="op" id="8038280">(</span><span class="string" id="8038281">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="8038341">,</span>&nbsp;<span class="ident" id="8038343">i</span><span class="op" id="8038344">,</span>&nbsp;<span class="ident" id="8038346">start</span><span class="op" id="8038351">,</span>&nbsp;<span class="ident" id="8038353">end</span><span class="op" id="8038356">,</span>&nbsp;<span class="ident" id="8038358">have</span><span class="op" id="8038362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038366">case</span>&nbsp;<span class="ident" id="8038371">start</span>&nbsp;<span class="op" id="8038377">&gt;=</span>&nbsp;<span class="ident" id="8038380">end</span><span class="op" id="8038383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8038388">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038439">if</span>&nbsp;<span class="ident" id="8038442">start</span>&nbsp;<span class="op" id="8038448">==</span>&nbsp;<span class="ident" id="8038451">end</span>&nbsp;<span class="op" id="8038455">&amp;&amp;</span>&nbsp;<span class="ident" id="8038458">end</span>&nbsp;<span class="op" id="8038462">==</span>&nbsp;<span class="ident" id="8038465">lastEnd</span>&nbsp;<span class="op" id="8038473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038479">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038493">t</span><span class="op" id="8038494">.</span><span class="ident" id="8038495">Errorf</span><span class="op" id="8038501">(</span><span class="string" id="8038502">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="8038546">,</span>&nbsp;<span class="ident" id="8038548">i</span><span class="op" id="8038549">,</span>&nbsp;<span class="ident" id="8038551">start</span><span class="op" id="8038556">,</span>&nbsp;<span class="ident" id="8038558">end</span><span class="op" id="8038561">,</span>&nbsp;<span class="ident" id="8038563">have</span><span class="op" id="8038567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038571">case</span>&nbsp;<span class="ident" id="8038576">end</span>&nbsp;<span class="op" id="8038580">&gt;</span>&nbsp;<span class="ident" id="8038582">int64</span><span class="op" id="8038587">(</span><span class="builtinfunc" id="8038588">len</span><span class="op" id="8038591">(</span><span class="ident" id="8038592">raw</span><span class="op" id="8038595">)</span><span class="op" id="8038596">)</span><span class="op" id="8038597">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038602">t</span><span class="op" id="8038603">.</span><span class="ident" id="8038604">Errorf</span><span class="op" id="8038610">(</span><span class="string" id="8038611">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="8038667">,</span>&nbsp;<span class="ident" id="8038669">i</span><span class="op" id="8038670">,</span>&nbsp;<span class="ident" id="8038672">start</span><span class="op" id="8038677">,</span>&nbsp;<span class="ident" id="8038679">end</span><span class="op" id="8038682">,</span>&nbsp;<span class="ident" id="8038684">have</span><span class="op" id="8038688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038692">default</span><span class="op" id="8038699">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038704">text</span>&nbsp;<span class="op" id="8038709">:=</span>&nbsp;<span class="ident" id="8038712">raw</span><span class="op" id="8038715">[</span><span class="ident" id="8038716">start</span><span class="op" id="8038721">:</span><span class="ident" id="8038722">end</span><span class="op" id="8038725">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8038730">if</span>&nbsp;<span class="ident" id="8038733">strings</span><span class="op" id="8038740">.</span><span class="ident" id="8038741">ContainsAny</span><span class="op" id="8038752">(</span><span class="ident" id="8038753">text</span><span class="op" id="8038757">,</span>&nbsp;<span class="string" id="8038759">&#34;&lt;&gt;&#34;</span><span class="op" id="8038763">)</span>&nbsp;<span class="op" id="8038765">&amp;&amp;</span>&nbsp;<span class="op" id="8038768">(</span><span class="op" id="8038769">!</span><span class="ident" id="8038770">strings</span><span class="op" id="8038777">.</span><span class="ident" id="8038778">HasPrefix</span><span class="op" id="8038787">(</span><span class="ident" id="8038788">text</span><span class="op" id="8038792">,</span>&nbsp;<span class="string" id="8038794">&#34;&lt;&#34;</span><span class="op" id="8038797">)</span>&nbsp;<span class="op" id="8038799">||</span>&nbsp;<span class="op" id="8038802">!</span><span class="ident" id="8038803">strings</span><span class="op" id="8038810">.</span><span class="ident" id="8038811">HasSuffix</span><span class="op" id="8038820">(</span><span class="ident" id="8038821">text</span><span class="op" id="8038825">,</span>&nbsp;<span class="string" id="8038827">&#34;&gt;&#34;</span><span class="op" id="8038830">)</span><span class="op" id="8038831">)</span>&nbsp;<span class="op" id="8038833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038839">t</span><span class="op" id="8038840">.</span><span class="ident" id="8038841">Errorf</span><span class="op" id="8038847">(</span><span class="string" id="8038848">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="8038891">,</span>&nbsp;<span class="ident" id="8038893">i</span><span class="op" id="8038894">,</span>&nbsp;<span class="ident" id="8038896">text</span><span class="op" id="8038900">,</span>&nbsp;<span class="ident" id="8038902">have</span><span class="op" id="8038906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038915">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8038919">lastEnd</span>&nbsp;<span class="op" id="8038927">=</span>&nbsp;<span class="ident" id="8038929">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8038934">}</span><br>
<span class="lineno"></span><span class="op" id="8038936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8038939">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="8039010">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="8039078">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8039136">var</span>&nbsp;<span class="ident" id="8039140">nestedDirectivesInput</span>&nbsp;<span class="op" id="8039162">=</span>&nbsp;<span class="string" id="8039164">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8039430">var</span>&nbsp;<span class="ident" id="8039434">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8039457">=</span>&nbsp;<span class="op" id="8039459">[</span><span class="op" id="8039460">]</span><span class="ident" id="8039461">Token</span><span class="op" id="8039466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039469">CharData</span><span class="op" id="8039477">(</span><span class="string" id="8039478">&#34;\n&#34;</span><span class="op" id="8039482">)</span><span class="op" id="8039483">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039486">Directive</span><span class="op" id="8039495">(</span><span class="string" id="8039496">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8039567">)</span><span class="op" id="8039568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039571">CharData</span><span class="op" id="8039579">(</span><span class="string" id="8039580">&#34;\n&#34;</span><span class="op" id="8039584">)</span><span class="op" id="8039585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039588">Directive</span><span class="op" id="8039597">(</span><span class="string" id="8039598">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="8039627">)</span><span class="op" id="8039628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039631">CharData</span><span class="op" id="8039639">(</span><span class="string" id="8039640">&#34;\n&#34;</span><span class="op" id="8039644">)</span><span class="op" id="8039645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039648">Directive</span><span class="op" id="8039657">(</span><span class="string" id="8039658">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="8039687">)</span><span class="op" id="8039688">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039691">CharData</span><span class="op" id="8039699">(</span><span class="string" id="8039700">&#34;\n&#34;</span><span class="op" id="8039704">)</span><span class="op" id="8039705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039708">Directive</span><span class="op" id="8039717">(</span><span class="string" id="8039718">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="8039747">)</span><span class="op" id="8039748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039751">CharData</span><span class="op" id="8039759">(</span><span class="string" id="8039760">&#34;\n&#34;</span><span class="op" id="8039764">)</span><span class="op" id="8039765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039768">Directive</span><span class="op" id="8039777">(</span><span class="string" id="8039778">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="8039807">)</span><span class="op" id="8039808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039811">CharData</span><span class="op" id="8039819">(</span><span class="string" id="8039820">&#34;\n&#34;</span><span class="op" id="8039824">)</span><span class="op" id="8039825">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039828">Directive</span><span class="op" id="8039837">(</span><span class="string" id="8039838">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="8039868">)</span><span class="op" id="8039869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039872">CharData</span><span class="op" id="8039880">(</span><span class="string" id="8039881">&#34;\n&#34;</span><span class="op" id="8039885">)</span><span class="op" id="8039886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039889">Directive</span><span class="op" id="8039898">(</span><span class="string" id="8039899">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="8039929">)</span><span class="op" id="8039930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039933">CharData</span><span class="op" id="8039941">(</span><span class="string" id="8039942">&#34;\n&#34;</span><span class="op" id="8039946">)</span><span class="op" id="8039947">,</span><br>
<span class="lineno"></span><span class="op" id="8039949">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="8039952">func</span>&nbsp;<span class="ident" id="8039957">TestNestedDirectives</span><span class="op" id="8039977">(</span><span class="ident" id="8039978">t</span>&nbsp;<span class="op" id="8039980">*</span><span class="ident" id="8039981">testing</span><span class="op" id="8039988">.</span><span class="ident" id="8039989">T</span><span class="op" id="8039990">)</span>&nbsp;<span class="op" id="8039992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8039995">d</span>&nbsp;<span class="op" id="8039997">:=</span>&nbsp;<span class="ident" id="8040000">NewDecoder</span><span class="op" id="8040010">(</span><span class="ident" id="8040011">strings</span><span class="op" id="8040018">.</span><span class="ident" id="8040019">NewReader</span><span class="op" id="8040028">(</span><span class="ident" id="8040029">nestedDirectivesInput</span><span class="op" id="8040050">)</span><span class="op" id="8040051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040055">for</span>&nbsp;<span class="ident" id="8040059">i</span><span class="op" id="8040060">,</span>&nbsp;<span class="ident" id="8040062">want</span>&nbsp;<span class="op" id="8040067">:=</span>&nbsp;<span class="keyword" id="8040070">range</span>&nbsp;<span class="ident" id="8040076">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8040099">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040103">have</span><span class="op" id="8040107">,</span>&nbsp;<span class="ident" id="8040109">err</span>&nbsp;<span class="op" id="8040113">:=</span>&nbsp;<span class="ident" id="8040116">d</span><span class="op" id="8040117">.</span><span class="ident" id="8040118">Token</span><span class="op" id="8040123">(</span><span class="op" id="8040124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040128">if</span>&nbsp;<span class="ident" id="8040131">err</span>&nbsp;<span class="op" id="8040135">!=</span>&nbsp;<span class="builtintype" id="8040138">nil</span>&nbsp;<span class="op" id="8040142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040147">t</span><span class="op" id="8040148">.</span><span class="ident" id="8040149">Fatalf</span><span class="op" id="8040155">(</span><span class="string" id="8040156">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8040188">,</span>&nbsp;<span class="ident" id="8040190">i</span><span class="op" id="8040191">,</span>&nbsp;<span class="ident" id="8040193">err</span><span class="op" id="8040196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040204">if</span>&nbsp;<span class="op" id="8040207">!</span><span class="ident" id="8040208">reflect</span><span class="op" id="8040215">.</span><span class="ident" id="8040216">DeepEqual</span><span class="op" id="8040225">(</span><span class="ident" id="8040226">have</span><span class="op" id="8040230">,</span>&nbsp;<span class="ident" id="8040232">want</span><span class="op" id="8040236">)</span>&nbsp;<span class="op" id="8040238">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040243">t</span><span class="op" id="8040244">.</span><span class="ident" id="8040245">Errorf</span><span class="op" id="8040251">(</span><span class="string" id="8040252">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8040277">,</span>&nbsp;<span class="ident" id="8040279">i</span><span class="op" id="8040280">,</span>&nbsp;<span class="ident" id="8040282">have</span><span class="op" id="8040286">,</span>&nbsp;<span class="ident" id="8040288">want</span><span class="op" id="8040292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040299">}</span><br>
<span class="lineno"></span><span class="op" id="8040301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="8040304">func</span>&nbsp;<span class="ident" id="8040309">TestToken</span><span class="op" id="8040318">(</span><span class="ident" id="8040319">t</span>&nbsp;<span class="op" id="8040321">*</span><span class="ident" id="8040322">testing</span><span class="op" id="8040329">.</span><span class="ident" id="8040330">T</span><span class="op" id="8040331">)</span>&nbsp;<span class="op" id="8040333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040336">d</span>&nbsp;<span class="op" id="8040338">:=</span>&nbsp;<span class="ident" id="8040341">NewDecoder</span><span class="op" id="8040351">(</span><span class="ident" id="8040352">strings</span><span class="op" id="8040359">.</span><span class="ident" id="8040360">NewReader</span><span class="op" id="8040369">(</span><span class="ident" id="8040370">testInput</span><span class="op" id="8040379">)</span><span class="op" id="8040380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040383">d</span><span class="op" id="8040384">.</span><span class="ident" id="8040385">Entity</span>&nbsp;<span class="op" id="8040392">=</span>&nbsp;<span class="ident" id="8040394">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040407">for</span>&nbsp;<span class="ident" id="8040411">i</span><span class="op" id="8040412">,</span>&nbsp;<span class="ident" id="8040414">want</span>&nbsp;<span class="op" id="8040419">:=</span>&nbsp;<span class="keyword" id="8040422">range</span>&nbsp;<span class="ident" id="8040428">cookedTokens</span>&nbsp;<span class="op" id="8040441">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040445">have</span><span class="op" id="8040449">,</span>&nbsp;<span class="ident" id="8040451">err</span>&nbsp;<span class="op" id="8040455">:=</span>&nbsp;<span class="ident" id="8040458">d</span><span class="op" id="8040459">.</span><span class="ident" id="8040460">Token</span><span class="op" id="8040465">(</span><span class="op" id="8040466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040470">if</span>&nbsp;<span class="ident" id="8040473">err</span>&nbsp;<span class="op" id="8040477">!=</span>&nbsp;<span class="builtintype" id="8040480">nil</span>&nbsp;<span class="op" id="8040484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040489">t</span><span class="op" id="8040490">.</span><span class="ident" id="8040491">Fatalf</span><span class="op" id="8040497">(</span><span class="string" id="8040498">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8040530">,</span>&nbsp;<span class="ident" id="8040532">i</span><span class="op" id="8040533">,</span>&nbsp;<span class="ident" id="8040535">err</span><span class="op" id="8040538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040546">if</span>&nbsp;<span class="op" id="8040549">!</span><span class="ident" id="8040550">reflect</span><span class="op" id="8040557">.</span><span class="ident" id="8040558">DeepEqual</span><span class="op" id="8040567">(</span><span class="ident" id="8040568">have</span><span class="op" id="8040572">,</span>&nbsp;<span class="ident" id="8040574">want</span><span class="op" id="8040578">)</span>&nbsp;<span class="op" id="8040580">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040585">t</span><span class="op" id="8040586">.</span><span class="ident" id="8040587">Errorf</span><span class="op" id="8040593">(</span><span class="string" id="8040594">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8040619">,</span>&nbsp;<span class="ident" id="8040621">i</span><span class="op" id="8040622">,</span>&nbsp;<span class="ident" id="8040624">have</span><span class="op" id="8040628">,</span>&nbsp;<span class="ident" id="8040630">want</span><span class="op" id="8040634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040641">}</span><br>
<span class="lineno"></span><span class="op" id="8040643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="8040646">func</span>&nbsp;<span class="ident" id="8040651">TestSyntax</span><span class="op" id="8040661">(</span><span class="ident" id="8040662">t</span>&nbsp;<span class="op" id="8040664">*</span><span class="ident" id="8040665">testing</span><span class="op" id="8040672">.</span><span class="ident" id="8040673">T</span><span class="op" id="8040674">)</span>&nbsp;<span class="op" id="8040676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040679">for</span>&nbsp;<span class="ident" id="8040683">i</span>&nbsp;<span class="op" id="8040685">:=</span>&nbsp;<span class="keyword" id="8040688">range</span>&nbsp;<span class="ident" id="8040694">xmlInput</span>&nbsp;<span class="op" id="8040703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040707">d</span>&nbsp;<span class="op" id="8040709">:=</span>&nbsp;<span class="ident" id="8040712">NewDecoder</span><span class="op" id="8040722">(</span><span class="ident" id="8040723">strings</span><span class="op" id="8040730">.</span><span class="ident" id="8040731">NewReader</span><span class="op" id="8040740">(</span><span class="ident" id="8040741">xmlInput</span><span class="op" id="8040749">[</span><span class="ident" id="8040750">i</span><span class="op" id="8040751">]</span><span class="op" id="8040752">)</span><span class="op" id="8040753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040757">var</span>&nbsp;<span class="ident" id="8040761">err</span>&nbsp;<span class="builtintype" id="8040765">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040773">for</span>&nbsp;<span class="ident" id="8040777">_</span><span class="op" id="8040778">,</span>&nbsp;<span class="ident" id="8040780">err</span>&nbsp;<span class="op" id="8040784">=</span>&nbsp;<span class="ident" id="8040786">d</span><span class="op" id="8040787">.</span><span class="ident" id="8040788">Token</span><span class="op" id="8040793">(</span><span class="op" id="8040794">)</span><span class="op" id="8040795">;</span>&nbsp;<span class="ident" id="8040797">err</span>&nbsp;<span class="op" id="8040801">==</span>&nbsp;<span class="builtintype" id="8040804">nil</span><span class="op" id="8040807">;</span>&nbsp;<span class="ident" id="8040809">_</span><span class="op" id="8040810">,</span>&nbsp;<span class="ident" id="8040812">err</span>&nbsp;<span class="op" id="8040816">=</span>&nbsp;<span class="ident" id="8040818">d</span><span class="op" id="8040819">.</span><span class="ident" id="8040820">Token</span><span class="op" id="8040825">(</span><span class="op" id="8040826">)</span>&nbsp;<span class="op" id="8040828">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8040836">if</span>&nbsp;<span class="ident" id="8040839">_</span><span class="op" id="8040840">,</span>&nbsp;<span class="ident" id="8040842">ok</span>&nbsp;<span class="op" id="8040845">:=</span>&nbsp;<span class="ident" id="8040848">err</span><span class="op" id="8040851">.</span><span class="op" id="8040852">(</span><span class="op" id="8040853">*</span><span class="ident" id="8040854">SyntaxError</span><span class="op" id="8040865">)</span><span class="op" id="8040866">;</span>&nbsp;<span class="op" id="8040868">!</span><span class="ident" id="8040869">ok</span>&nbsp;<span class="op" id="8040872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040877">t</span><span class="op" id="8040878">.</span><span class="ident" id="8040879">Fatalf</span><span class="op" id="8040885">(</span><span class="string" id="8040886">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="8040936">,</span>&nbsp;<span class="ident" id="8040938">xmlInput</span><span class="op" id="8040946">[</span><span class="ident" id="8040947">i</span><span class="op" id="8040948">]</span><span class="op" id="8040949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8040956">}</span><br>
<span class="lineno">400</span><span class="op" id="8040958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8040961">type</span>&nbsp;<span class="ident" id="8040966">allScalars</span>&nbsp;<span class="keyword" id="8040977">struct</span>&nbsp;<span class="op" id="8040984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8040987">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8040997">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041003">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041013">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041019">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041029">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041035">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041045">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041051">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041061">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041066">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041076">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041082">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041092">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041099">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041109">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041116">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041126">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041133">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041143">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041148">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041158">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041165">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041175">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041183">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041193">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041201">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041211">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041219">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041229">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041238">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041248">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041257">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041267">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041276">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041286">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041294">PtrString</span>&nbsp;<span class="op" id="8041304">*</span><span class="builtintype" id="8041305">string</span><br>
<span class="lineno"></span><span class="op" id="8041312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8041315">var</span>&nbsp;<span class="ident" id="8041319">all</span>&nbsp;<span class="op" id="8041323">=</span>&nbsp;<span class="ident" id="8041325">allScalars</span><span class="op" id="8041335">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041338">True1</span><span class="op" id="8041343">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041349">true</span><span class="op" id="8041353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041356">True2</span><span class="op" id="8041361">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041367">true</span><span class="op" id="8041371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041374">False1</span><span class="op" id="8041380">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041385">false</span><span class="op" id="8041390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041393">False2</span><span class="op" id="8041399">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8041404">false</span><span class="op" id="8041409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041412">Int</span><span class="op" id="8041415">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041423">1</span><span class="op" id="8041424">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041427">Int8</span><span class="op" id="8041431">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8041438">-</span><span class="num" id="8041439">2</span><span class="op" id="8041440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041443">Int16</span><span class="op" id="8041448">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041454">3</span><span class="op" id="8041455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041458">Int32</span><span class="op" id="8041463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8041469">-</span><span class="num" id="8041470">4</span><span class="op" id="8041471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041474">Int64</span><span class="op" id="8041479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041485">5</span><span class="op" id="8041486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041489">Uint</span><span class="op" id="8041493">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041500">6</span><span class="op" id="8041501">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041504">Uint8</span><span class="op" id="8041509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041515">7</span><span class="op" id="8041516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041519">Uint16</span><span class="op" id="8041525">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041530">8</span><span class="op" id="8041531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041534">Uint32</span><span class="op" id="8041540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041545">9</span><span class="op" id="8041546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041549">Uint64</span><span class="op" id="8041555">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8041560">10</span><span class="op" id="8041562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041565">Uintptr</span><span class="op" id="8041572">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8041576">11</span><span class="op" id="8041578">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041581">Float32</span><span class="op" id="8041588">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8041592">13.0</span><span class="op" id="8041596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041599">Float64</span><span class="op" id="8041606">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8041610">14.0</span><span class="op" id="8041614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041617">String</span><span class="op" id="8041623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8041628">&#34;15&#34;</span><span class="op" id="8041632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8041635">PtrString</span><span class="op" id="8041644">:</span>&nbsp;<span class="op" id="8041646">&amp;</span><span class="ident" id="8041647">sixteen</span><span class="op" id="8041654">,</span><br>
<span class="lineno"></span><span class="op" id="8041656">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="8041659">var</span>&nbsp;<span class="ident" id="8041663">sixteen</span>&nbsp;<span class="op" id="8041671">=</span>&nbsp;<span class="string" id="8041673">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8041679">const</span>&nbsp;<span class="ident" id="8041685">testScalarsInput</span>&nbsp;<span class="op" id="8041702">=</span>&nbsp;<span class="string" id="8041704">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="8042140">func</span>&nbsp;<span class="ident" id="8042145">TestAllScalars</span><span class="op" id="8042159">(</span><span class="ident" id="8042160">t</span>&nbsp;<span class="op" id="8042162">*</span><span class="ident" id="8042163">testing</span><span class="op" id="8042170">.</span><span class="ident" id="8042171">T</span><span class="op" id="8042172">)</span>&nbsp;<span class="op" id="8042174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042177">var</span>&nbsp;<span class="ident" id="8042181">a</span>&nbsp;<span class="ident" id="8042183">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042195">err</span>&nbsp;<span class="op" id="8042199">:=</span>&nbsp;<span class="ident" id="8042202">Unmarshal</span><span class="op" id="8042211">(</span><span class="op" id="8042212">[</span><span class="op" id="8042213">]</span><span class="builtintype" id="8042214">byte</span><span class="op" id="8042218">(</span><span class="ident" id="8042219">testScalarsInput</span><span class="op" id="8042235">)</span><span class="op" id="8042236">,</span>&nbsp;<span class="op" id="8042238">&amp;</span><span class="ident" id="8042239">a</span><span class="op" id="8042240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042244">if</span>&nbsp;<span class="ident" id="8042247">err</span>&nbsp;<span class="op" id="8042251">!=</span>&nbsp;<span class="builtintype" id="8042254">nil</span>&nbsp;<span class="op" id="8042258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042262">t</span><span class="op" id="8042263">.</span><span class="ident" id="8042264">Fatal</span><span class="op" id="8042269">(</span><span class="ident" id="8042270">err</span><span class="op" id="8042273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8042276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042279">if</span>&nbsp;<span class="op" id="8042282">!</span><span class="ident" id="8042283">reflect</span><span class="op" id="8042290">.</span><span class="ident" id="8042291">DeepEqual</span><span class="op" id="8042300">(</span><span class="ident" id="8042301">a</span><span class="op" id="8042302">,</span>&nbsp;<span class="ident" id="8042304">all</span><span class="op" id="8042307">)</span>&nbsp;<span class="op" id="8042309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042313">t</span><span class="op" id="8042314">.</span><span class="ident" id="8042315">Errorf</span><span class="op" id="8042321">(</span><span class="string" id="8042322">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="8042341">,</span>&nbsp;<span class="ident" id="8042343">a</span><span class="op" id="8042344">,</span>&nbsp;<span class="ident" id="8042346">all</span><span class="op" id="8042349">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8042352">}</span><br>
<span class="lineno"></span><span class="op" id="8042354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8042357">type</span>&nbsp;<span class="ident" id="8042362">item</span>&nbsp;<span class="keyword" id="8042367">struct</span>&nbsp;<span class="op" id="8042374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042377">Field_a</span>&nbsp;<span class="builtintype" id="8042385">string</span><br>
<span class="lineno">485</span><span class="op" id="8042392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8042395">func</span>&nbsp;<span class="ident" id="8042400">TestIssue569</span><span class="op" id="8042412">(</span><span class="ident" id="8042413">t</span>&nbsp;<span class="op" id="8042415">*</span><span class="ident" id="8042416">testing</span><span class="op" id="8042423">.</span><span class="ident" id="8042424">T</span><span class="op" id="8042425">)</span>&nbsp;<span class="op" id="8042427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042430">data</span>&nbsp;<span class="op" id="8042435">:=</span>&nbsp;<span class="string" id="8042438">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042478">var</span>&nbsp;<span class="ident" id="8042482">i</span>&nbsp;<span class="ident" id="8042484">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042490">err</span>&nbsp;<span class="op" id="8042494">:=</span>&nbsp;<span class="ident" id="8042497">Unmarshal</span><span class="op" id="8042506">(</span><span class="op" id="8042507">[</span><span class="op" id="8042508">]</span><span class="builtintype" id="8042509">byte</span><span class="op" id="8042513">(</span><span class="ident" id="8042514">data</span><span class="op" id="8042518">)</span><span class="op" id="8042519">,</span>&nbsp;<span class="op" id="8042521">&amp;</span><span class="ident" id="8042522">i</span><span class="op" id="8042523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042527">if</span>&nbsp;<span class="ident" id="8042530">err</span>&nbsp;<span class="op" id="8042534">!=</span>&nbsp;<span class="builtintype" id="8042537">nil</span>&nbsp;<span class="op" id="8042541">||</span>&nbsp;<span class="ident" id="8042544">i</span><span class="op" id="8042545">.</span><span class="ident" id="8042546">Field_a</span>&nbsp;<span class="op" id="8042554">!=</span>&nbsp;<span class="string" id="8042557">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8042564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042568">t</span><span class="op" id="8042569">.</span><span class="ident" id="8042570">Fatal</span><span class="op" id="8042575">(</span><span class="string" id="8042576">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="8042592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8042595">}</span><br>
<span class="lineno">495</span><span class="op" id="8042597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8042600">func</span>&nbsp;<span class="ident" id="8042605">TestUnquotedAttrs</span><span class="op" id="8042622">(</span><span class="ident" id="8042623">t</span>&nbsp;<span class="op" id="8042625">*</span><span class="ident" id="8042626">testing</span><span class="op" id="8042633">.</span><span class="ident" id="8042634">T</span><span class="op" id="8042635">)</span>&nbsp;<span class="op" id="8042637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042640">data</span>&nbsp;<span class="op" id="8042645">:=</span>&nbsp;<span class="string" id="8042648">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042674">d</span>&nbsp;<span class="op" id="8042676">:=</span>&nbsp;<span class="ident" id="8042679">NewDecoder</span><span class="op" id="8042689">(</span><span class="ident" id="8042690">strings</span><span class="op" id="8042697">.</span><span class="ident" id="8042698">NewReader</span><span class="op" id="8042707">(</span><span class="ident" id="8042708">data</span><span class="op" id="8042712">)</span><span class="op" id="8042713">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042716">d</span><span class="op" id="8042717">.</span><span class="ident" id="8042718">Strict</span>&nbsp;<span class="op" id="8042725">=</span>&nbsp;<span class="builtintype" id="8042727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042734">token</span><span class="op" id="8042739">,</span>&nbsp;<span class="ident" id="8042741">err</span>&nbsp;<span class="op" id="8042745">:=</span>&nbsp;<span class="ident" id="8042748">d</span><span class="op" id="8042749">.</span><span class="ident" id="8042750">Token</span><span class="op" id="8042755">(</span><span class="op" id="8042756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042759">if</span>&nbsp;<span class="ident" id="8042762">_</span><span class="op" id="8042763">,</span>&nbsp;<span class="ident" id="8042765">ok</span>&nbsp;<span class="op" id="8042768">:=</span>&nbsp;<span class="ident" id="8042771">err</span><span class="op" id="8042774">.</span><span class="op" id="8042775">(</span><span class="op" id="8042776">*</span><span class="ident" id="8042777">SyntaxError</span><span class="op" id="8042788">)</span><span class="op" id="8042789">;</span>&nbsp;<span class="ident" id="8042791">ok</span>&nbsp;<span class="op" id="8042794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042798">t</span><span class="op" id="8042799">.</span><span class="ident" id="8042800">Errorf</span><span class="op" id="8042806">(</span><span class="string" id="8042807">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8042829">,</span>&nbsp;<span class="ident" id="8042831">err</span><span class="op" id="8042834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8042837">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042840">if</span>&nbsp;<span class="ident" id="8042843">token</span><span class="op" id="8042848">.</span><span class="op" id="8042849">(</span><span class="ident" id="8042850">StartElement</span><span class="op" id="8042862">)</span><span class="op" id="8042863">.</span><span class="ident" id="8042864">Name</span><span class="op" id="8042868">.</span><span class="ident" id="8042869">Local</span>&nbsp;<span class="op" id="8042875">!=</span>&nbsp;<span class="string" id="8042878">&#34;tag&#34;</span>&nbsp;<span class="op" id="8042884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042888">t</span><span class="op" id="8042889">.</span><span class="ident" id="8042890">Errorf</span><span class="op" id="8042896">(</span><span class="string" id="8042897">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8042922">,</span>&nbsp;<span class="ident" id="8042924">token</span><span class="op" id="8042929">.</span><span class="op" id="8042930">(</span><span class="ident" id="8042931">StartElement</span><span class="op" id="8042943">)</span><span class="op" id="8042944">.</span><span class="ident" id="8042945">Name</span><span class="op" id="8042949">.</span><span class="ident" id="8042950">Local</span><span class="op" id="8042955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8042958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8042961">attr</span>&nbsp;<span class="op" id="8042966">:=</span>&nbsp;<span class="ident" id="8042969">token</span><span class="op" id="8042974">.</span><span class="op" id="8042975">(</span><span class="ident" id="8042976">StartElement</span><span class="op" id="8042988">)</span><span class="op" id="8042989">.</span><span class="ident" id="8042990">Attr</span><span class="op" id="8042994">[</span><span class="num" id="8042995">0</span><span class="op" id="8042996">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8042999">if</span>&nbsp;<span class="ident" id="8043002">attr</span><span class="op" id="8043006">.</span><span class="ident" id="8043007">Value</span>&nbsp;<span class="op" id="8043013">!=</span>&nbsp;<span class="string" id="8043016">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="8043028">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043032">t</span><span class="op" id="8043033">.</span><span class="ident" id="8043034">Errorf</span><span class="op" id="8043040">(</span><span class="string" id="8043041">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8043073">,</span>&nbsp;<span class="ident" id="8043075">attr</span><span class="op" id="8043079">.</span><span class="ident" id="8043080">Value</span><span class="op" id="8043085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8043091">if</span>&nbsp;<span class="ident" id="8043094">attr</span><span class="op" id="8043098">.</span><span class="ident" id="8043099">Name</span><span class="op" id="8043103">.</span><span class="ident" id="8043104">Local</span>&nbsp;<span class="op" id="8043110">!=</span>&nbsp;<span class="string" id="8043113">&#34;attr&#34;</span>&nbsp;<span class="op" id="8043120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043124">t</span><span class="op" id="8043125">.</span><span class="ident" id="8043126">Errorf</span><span class="op" id="8043132">(</span><span class="string" id="8043133">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8043164">,</span>&nbsp;<span class="ident" id="8043166">attr</span><span class="op" id="8043170">.</span><span class="ident" id="8043171">Name</span><span class="op" id="8043175">.</span><span class="ident" id="8043176">Local</span><span class="op" id="8043181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043184">}</span><br>
<span class="lineno">515</span><span class="op" id="8043186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8043189">func</span>&nbsp;<span class="ident" id="8043194">TestValuelessAttrs</span><span class="op" id="8043212">(</span><span class="ident" id="8043213">t</span>&nbsp;<span class="op" id="8043215">*</span><span class="ident" id="8043216">testing</span><span class="op" id="8043223">.</span><span class="ident" id="8043224">T</span><span class="op" id="8043225">)</span>&nbsp;<span class="op" id="8043227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043230">tests</span>&nbsp;<span class="op" id="8043236">:=</span>&nbsp;<span class="op" id="8043239">[</span><span class="op" id="8043240">]</span><span class="op" id="8043241">[</span><span class="num" id="8043242">3</span><span class="op" id="8043243">]</span><span class="builtintype" id="8043244">string</span><span class="op" id="8043250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043254">{</span><span class="string" id="8043255">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="8043267">,</span>&nbsp;<span class="string" id="8043269">&#34;p&#34;</span><span class="op" id="8043272">,</span>&nbsp;<span class="string" id="8043274">&#34;nowrap&#34;</span><span class="op" id="8043282">}</span><span class="op" id="8043283">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043287">{</span><span class="string" id="8043288">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="8043301">,</span>&nbsp;<span class="string" id="8043303">&#34;p&#34;</span><span class="op" id="8043306">,</span>&nbsp;<span class="string" id="8043308">&#34;nowrap&#34;</span><span class="op" id="8043316">}</span><span class="op" id="8043317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043321">{</span><span class="string" id="8043322">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="8043340">,</span>&nbsp;<span class="string" id="8043342">&#34;input&#34;</span><span class="op" id="8043349">,</span>&nbsp;<span class="string" id="8043351">&#34;checked&#34;</span><span class="op" id="8043360">}</span><span class="op" id="8043361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043365">{</span><span class="string" id="8043366">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="8043385">,</span>&nbsp;<span class="string" id="8043387">&#34;input&#34;</span><span class="op" id="8043394">,</span>&nbsp;<span class="string" id="8043396">&#34;checked&#34;</span><span class="op" id="8043405">}</span><span class="op" id="8043406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8043412">for</span>&nbsp;<span class="ident" id="8043416">_</span><span class="op" id="8043417">,</span>&nbsp;<span class="ident" id="8043419">test</span>&nbsp;<span class="op" id="8043424">:=</span>&nbsp;<span class="keyword" id="8043427">range</span>&nbsp;<span class="ident" id="8043433">tests</span>&nbsp;<span class="op" id="8043439">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043443">d</span>&nbsp;<span class="op" id="8043445">:=</span>&nbsp;<span class="ident" id="8043448">NewDecoder</span><span class="op" id="8043458">(</span><span class="ident" id="8043459">strings</span><span class="op" id="8043466">.</span><span class="ident" id="8043467">NewReader</span><span class="op" id="8043476">(</span><span class="ident" id="8043477">test</span><span class="op" id="8043481">[</span><span class="num" id="8043482">0</span><span class="op" id="8043483">]</span><span class="op" id="8043484">)</span><span class="op" id="8043485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043489">d</span><span class="op" id="8043490">.</span><span class="ident" id="8043491">Strict</span>&nbsp;<span class="op" id="8043498">=</span>&nbsp;<span class="builtintype" id="8043500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043508">token</span><span class="op" id="8043513">,</span>&nbsp;<span class="ident" id="8043515">err</span>&nbsp;<span class="op" id="8043519">:=</span>&nbsp;<span class="ident" id="8043522">d</span><span class="op" id="8043523">.</span><span class="ident" id="8043524">Token</span><span class="op" id="8043529">(</span><span class="op" id="8043530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8043534">if</span>&nbsp;<span class="ident" id="8043537">_</span><span class="op" id="8043538">,</span>&nbsp;<span class="ident" id="8043540">ok</span>&nbsp;<span class="op" id="8043543">:=</span>&nbsp;<span class="ident" id="8043546">err</span><span class="op" id="8043549">.</span><span class="op" id="8043550">(</span><span class="op" id="8043551">*</span><span class="ident" id="8043552">SyntaxError</span><span class="op" id="8043563">)</span><span class="op" id="8043564">;</span>&nbsp;<span class="ident" id="8043566">ok</span>&nbsp;<span class="op" id="8043569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043574">t</span><span class="op" id="8043575">.</span><span class="ident" id="8043576">Errorf</span><span class="op" id="8043582">(</span><span class="string" id="8043583">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8043605">,</span>&nbsp;<span class="ident" id="8043607">err</span><span class="op" id="8043610">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8043618">if</span>&nbsp;<span class="ident" id="8043621">token</span><span class="op" id="8043626">.</span><span class="op" id="8043627">(</span><span class="ident" id="8043628">StartElement</span><span class="op" id="8043640">)</span><span class="op" id="8043641">.</span><span class="ident" id="8043642">Name</span><span class="op" id="8043646">.</span><span class="ident" id="8043647">Local</span>&nbsp;<span class="op" id="8043653">!=</span>&nbsp;<span class="ident" id="8043656">test</span><span class="op" id="8043660">[</span><span class="num" id="8043661">1</span><span class="op" id="8043662">]</span>&nbsp;<span class="op" id="8043664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043669">t</span><span class="op" id="8043670">.</span><span class="ident" id="8043671">Errorf</span><span class="op" id="8043677">(</span><span class="string" id="8043678">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8043703">,</span>&nbsp;<span class="ident" id="8043705">token</span><span class="op" id="8043710">.</span><span class="op" id="8043711">(</span><span class="ident" id="8043712">StartElement</span><span class="op" id="8043724">)</span><span class="op" id="8043725">.</span><span class="ident" id="8043726">Name</span><span class="op" id="8043730">.</span><span class="ident" id="8043731">Local</span><span class="op" id="8043736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043744">attr</span>&nbsp;<span class="op" id="8043749">:=</span>&nbsp;<span class="ident" id="8043752">token</span><span class="op" id="8043757">.</span><span class="op" id="8043758">(</span><span class="ident" id="8043759">StartElement</span><span class="op" id="8043771">)</span><span class="op" id="8043772">.</span><span class="ident" id="8043773">Attr</span><span class="op" id="8043777">[</span><span class="num" id="8043778">0</span><span class="op" id="8043779">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8043783">if</span>&nbsp;<span class="ident" id="8043786">attr</span><span class="op" id="8043790">.</span><span class="ident" id="8043791">Value</span>&nbsp;<span class="op" id="8043797">!=</span>&nbsp;<span class="ident" id="8043800">test</span><span class="op" id="8043804">[</span><span class="num" id="8043805">2</span><span class="op" id="8043806">]</span>&nbsp;<span class="op" id="8043808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043813">t</span><span class="op" id="8043814">.</span><span class="ident" id="8043815">Errorf</span><span class="op" id="8043821">(</span><span class="string" id="8043822">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8043854">,</span>&nbsp;<span class="ident" id="8043856">attr</span><span class="op" id="8043860">.</span><span class="ident" id="8043861">Value</span><span class="op" id="8043866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8043874">if</span>&nbsp;<span class="ident" id="8043877">attr</span><span class="op" id="8043881">.</span><span class="ident" id="8043882">Name</span><span class="op" id="8043886">.</span><span class="ident" id="8043887">Local</span>&nbsp;<span class="op" id="8043893">!=</span>&nbsp;<span class="ident" id="8043896">test</span><span class="op" id="8043900">[</span><span class="num" id="8043901">2</span><span class="op" id="8043902">]</span>&nbsp;<span class="op" id="8043904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8043909">t</span><span class="op" id="8043910">.</span><span class="ident" id="8043911">Errorf</span><span class="op" id="8043917">(</span><span class="string" id="8043918">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8043949">,</span>&nbsp;<span class="ident" id="8043951">attr</span><span class="op" id="8043955">.</span><span class="ident" id="8043956">Name</span><span class="op" id="8043960">.</span><span class="ident" id="8043961">Local</span><span class="op" id="8043966">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8043973">}</span><br>
<span class="lineno"></span><span class="op" id="8043975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8043978">func</span>&nbsp;<span class="ident" id="8043983">TestCopyTokenCharData</span><span class="op" id="8044004">(</span><span class="ident" id="8044005">t</span>&nbsp;<span class="op" id="8044007">*</span><span class="ident" id="8044008">testing</span><span class="op" id="8044015">.</span><span class="ident" id="8044016">T</span><span class="op" id="8044017">)</span>&nbsp;<span class="op" id="8044019">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044022">data</span>&nbsp;<span class="op" id="8044027">:=</span>&nbsp;<span class="op" id="8044030">[</span><span class="op" id="8044031">]</span><span class="builtintype" id="8044032">byte</span><span class="op" id="8044036">(</span><span class="string" id="8044037">&#34;same&nbsp;data&#34;</span><span class="op" id="8044048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044051">var</span>&nbsp;<span class="ident" id="8044055">tok1</span>&nbsp;<span class="ident" id="8044060">Token</span>&nbsp;<span class="op" id="8044066">=</span>&nbsp;<span class="ident" id="8044068">CharData</span><span class="op" id="8044076">(</span><span class="ident" id="8044077">data</span><span class="op" id="8044081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044084">tok2</span>&nbsp;<span class="op" id="8044089">:=</span>&nbsp;<span class="ident" id="8044092">CopyToken</span><span class="op" id="8044101">(</span><span class="ident" id="8044102">tok1</span><span class="op" id="8044106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044109">if</span>&nbsp;<span class="op" id="8044112">!</span><span class="ident" id="8044113">reflect</span><span class="op" id="8044120">.</span><span class="ident" id="8044121">DeepEqual</span><span class="op" id="8044130">(</span><span class="ident" id="8044131">tok1</span><span class="op" id="8044135">,</span>&nbsp;<span class="ident" id="8044137">tok2</span><span class="op" id="8044141">)</span>&nbsp;<span class="op" id="8044143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044147">t</span><span class="op" id="8044148">.</span><span class="ident" id="8044149">Error</span><span class="op" id="8044154">(</span><span class="string" id="8044155">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="8044188">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8044191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044194">data</span><span class="op" id="8044198">[</span><span class="num" id="8044199">1</span><span class="op" id="8044200">]</span>&nbsp;<span class="op" id="8044202">=</span>&nbsp;<span class="string" id="8044204">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044209">if</span>&nbsp;<span class="ident" id="8044212">reflect</span><span class="op" id="8044219">.</span><span class="ident" id="8044220">DeepEqual</span><span class="op" id="8044229">(</span><span class="ident" id="8044230">tok1</span><span class="op" id="8044234">,</span>&nbsp;<span class="ident" id="8044236">tok2</span><span class="op" id="8044240">)</span>&nbsp;<span class="op" id="8044242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044246">t</span><span class="op" id="8044247">.</span><span class="ident" id="8044248">Error</span><span class="op" id="8044253">(</span><span class="string" id="8044254">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8044293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8044296">}</span><br>
<span class="lineno">555</span><span class="op" id="8044298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8044301">func</span>&nbsp;<span class="ident" id="8044306">TestCopyTokenStartElement</span><span class="op" id="8044331">(</span><span class="ident" id="8044332">t</span>&nbsp;<span class="op" id="8044334">*</span><span class="ident" id="8044335">testing</span><span class="op" id="8044342">.</span><span class="ident" id="8044343">T</span><span class="op" id="8044344">)</span>&nbsp;<span class="op" id="8044346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044349">elt</span>&nbsp;<span class="op" id="8044353">:=</span>&nbsp;<span class="ident" id="8044356">StartElement</span><span class="op" id="8044368">{</span><span class="ident" id="8044369">Name</span><span class="op" id="8044373">{</span><span class="string" id="8044374">&#34;&#34;</span><span class="op" id="8044376">,</span>&nbsp;<span class="string" id="8044378">&#34;hello&#34;</span><span class="op" id="8044385">}</span><span class="op" id="8044386">,</span>&nbsp;<span class="op" id="8044388">[</span><span class="op" id="8044389">]</span><span class="ident" id="8044390">Attr</span><span class="op" id="8044394">{</span><span class="op" id="8044395">{</span><span class="ident" id="8044396">Name</span><span class="op" id="8044400">{</span><span class="string" id="8044401">&#34;&#34;</span><span class="op" id="8044403">,</span>&nbsp;<span class="string" id="8044405">&#34;lang&#34;</span><span class="op" id="8044411">}</span><span class="op" id="8044412">,</span>&nbsp;<span class="string" id="8044414">&#34;en&#34;</span><span class="op" id="8044418">}</span><span class="op" id="8044419">}</span><span class="op" id="8044420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044423">var</span>&nbsp;<span class="ident" id="8044427">tok1</span>&nbsp;<span class="ident" id="8044432">Token</span>&nbsp;<span class="op" id="8044438">=</span>&nbsp;<span class="ident" id="8044440">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044445">tok2</span>&nbsp;<span class="op" id="8044450">:=</span>&nbsp;<span class="ident" id="8044453">CopyToken</span><span class="op" id="8044462">(</span><span class="ident" id="8044463">tok1</span><span class="op" id="8044467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044470">if</span>&nbsp;<span class="ident" id="8044473">tok1</span><span class="op" id="8044477">.</span><span class="op" id="8044478">(</span><span class="ident" id="8044479">StartElement</span><span class="op" id="8044491">)</span><span class="op" id="8044492">.</span><span class="ident" id="8044493">Attr</span><span class="op" id="8044497">[</span><span class="num" id="8044498">0</span><span class="op" id="8044499">]</span><span class="op" id="8044500">.</span><span class="ident" id="8044501">Value</span>&nbsp;<span class="op" id="8044507">!=</span>&nbsp;<span class="string" id="8044510">&#34;en&#34;</span>&nbsp;<span class="op" id="8044515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044519">t</span><span class="op" id="8044520">.</span><span class="ident" id="8044521">Error</span><span class="op" id="8044526">(</span><span class="string" id="8044527">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="8044556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8044559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044562">if</span>&nbsp;<span class="op" id="8044565">!</span><span class="ident" id="8044566">reflect</span><span class="op" id="8044573">.</span><span class="ident" id="8044574">DeepEqual</span><span class="op" id="8044583">(</span><span class="ident" id="8044584">tok1</span><span class="op" id="8044588">,</span>&nbsp;<span class="ident" id="8044590">tok2</span><span class="op" id="8044594">)</span>&nbsp;<span class="op" id="8044596">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044600">t</span><span class="op" id="8044601">.</span><span class="ident" id="8044602">Error</span><span class="op" id="8044607">(</span><span class="string" id="8044608">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="8044649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8044652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044655">tok1</span><span class="op" id="8044659">.</span><span class="op" id="8044660">(</span><span class="ident" id="8044661">StartElement</span><span class="op" id="8044673">)</span><span class="op" id="8044674">.</span><span class="ident" id="8044675">Attr</span><span class="op" id="8044679">[</span><span class="num" id="8044680">0</span><span class="op" id="8044681">]</span>&nbsp;<span class="op" id="8044683">=</span>&nbsp;<span class="ident" id="8044685">Attr</span><span class="op" id="8044689">{</span><span class="ident" id="8044690">Name</span><span class="op" id="8044694">{</span><span class="string" id="8044695">&#34;&#34;</span><span class="op" id="8044697">,</span>&nbsp;<span class="string" id="8044699">&#34;lang&#34;</span><span class="op" id="8044705">}</span><span class="op" id="8044706">,</span>&nbsp;<span class="string" id="8044708">&#34;de&#34;</span><span class="op" id="8044712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044715">if</span>&nbsp;<span class="ident" id="8044718">reflect</span><span class="op" id="8044725">.</span><span class="ident" id="8044726">DeepEqual</span><span class="op" id="8044735">(</span><span class="ident" id="8044736">tok1</span><span class="op" id="8044740">,</span>&nbsp;<span class="ident" id="8044742">tok2</span><span class="op" id="8044746">)</span>&nbsp;<span class="op" id="8044748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044752">t</span><span class="op" id="8044753">.</span><span class="ident" id="8044754">Error</span><span class="op" id="8044759">(</span><span class="string" id="8044760">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8044799">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8044802">}</span><br>
<span class="lineno"></span><span class="op" id="8044804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8044807">func</span>&nbsp;<span class="ident" id="8044812">TestSyntaxErrorLineNum</span><span class="op" id="8044834">(</span><span class="ident" id="8044835">t</span>&nbsp;<span class="op" id="8044837">*</span><span class="ident" id="8044838">testing</span><span class="op" id="8044845">.</span><span class="ident" id="8044846">T</span><span class="op" id="8044847">)</span>&nbsp;<span class="op" id="8044849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044852">testInput</span>&nbsp;<span class="op" id="8044862">:=</span>&nbsp;<span class="string" id="8044865">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8044893">d</span>&nbsp;<span class="op" id="8044895">:=</span>&nbsp;<span class="ident" id="8044898">NewDecoder</span><span class="op" id="8044908">(</span><span class="ident" id="8044909">strings</span><span class="op" id="8044916">.</span><span class="ident" id="8044917">NewReader</span><span class="op" id="8044926">(</span><span class="ident" id="8044927">testInput</span><span class="op" id="8044936">)</span><span class="op" id="8044937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044940">var</span>&nbsp;<span class="ident" id="8044944">err</span>&nbsp;<span class="builtintype" id="8044948">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8044955">for</span>&nbsp;<span class="ident" id="8044959">_</span><span class="op" id="8044960">,</span>&nbsp;<span class="ident" id="8044962">err</span>&nbsp;<span class="op" id="8044966">=</span>&nbsp;<span class="ident" id="8044968">d</span><span class="op" id="8044969">.</span><span class="ident" id="8044970">Token</span><span class="op" id="8044975">(</span><span class="op" id="8044976">)</span><span class="op" id="8044977">;</span>&nbsp;<span class="ident" id="8044979">err</span>&nbsp;<span class="op" id="8044983">==</span>&nbsp;<span class="builtintype" id="8044986">nil</span><span class="op" id="8044989">;</span>&nbsp;<span class="ident" id="8044991">_</span><span class="op" id="8044992">,</span>&nbsp;<span class="ident" id="8044994">err</span>&nbsp;<span class="op" id="8044998">=</span>&nbsp;<span class="ident" id="8045000">d</span><span class="op" id="8045001">.</span><span class="ident" id="8045002">Token</span><span class="op" id="8045007">(</span><span class="op" id="8045008">)</span>&nbsp;<span class="op" id="8045010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045016">synerr</span><span class="op" id="8045022">,</span>&nbsp;<span class="ident" id="8045024">ok</span>&nbsp;<span class="op" id="8045027">:=</span>&nbsp;<span class="ident" id="8045030">err</span><span class="op" id="8045033">.</span><span class="op" id="8045034">(</span><span class="op" id="8045035">*</span><span class="ident" id="8045036">SyntaxError</span><span class="op" id="8045047">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045050">if</span>&nbsp;<span class="op" id="8045053">!</span><span class="ident" id="8045054">ok</span>&nbsp;<span class="op" id="8045057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045061">t</span><span class="op" id="8045062">.</span><span class="ident" id="8045063">Error</span><span class="op" id="8045068">(</span><span class="string" id="8045069">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="8045092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045098">if</span>&nbsp;<span class="ident" id="8045101">synerr</span><span class="op" id="8045107">.</span><span class="ident" id="8045108">Line</span>&nbsp;<span class="op" id="8045113">!=</span>&nbsp;<span class="num" id="8045116">3</span>&nbsp;<span class="op" id="8045118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045122">t</span><span class="op" id="8045123">.</span><span class="ident" id="8045124">Error</span><span class="op" id="8045129">(</span><span class="string" id="8045130">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="8045176">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045179">}</span><br>
<span class="lineno"></span><span class="op" id="8045181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8045184">func</span>&nbsp;<span class="ident" id="8045189">TestTrailingRawToken</span><span class="op" id="8045209">(</span><span class="ident" id="8045210">t</span>&nbsp;<span class="op" id="8045212">*</span><span class="ident" id="8045213">testing</span><span class="op" id="8045220">.</span><span class="ident" id="8045221">T</span><span class="op" id="8045222">)</span>&nbsp;<span class="op" id="8045224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045227">input</span>&nbsp;<span class="op" id="8045233">:=</span>&nbsp;<span class="string" id="8045236">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045253">d</span>&nbsp;<span class="op" id="8045255">:=</span>&nbsp;<span class="ident" id="8045258">NewDecoder</span><span class="op" id="8045268">(</span><span class="ident" id="8045269">strings</span><span class="op" id="8045276">.</span><span class="ident" id="8045277">NewReader</span><span class="op" id="8045286">(</span><span class="ident" id="8045287">input</span><span class="op" id="8045292">)</span><span class="op" id="8045293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045296">var</span>&nbsp;<span class="ident" id="8045300">err</span>&nbsp;<span class="builtintype" id="8045304">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045311">for</span>&nbsp;<span class="ident" id="8045315">_</span><span class="op" id="8045316">,</span>&nbsp;<span class="ident" id="8045318">err</span>&nbsp;<span class="op" id="8045322">=</span>&nbsp;<span class="ident" id="8045324">d</span><span class="op" id="8045325">.</span><span class="ident" id="8045326">RawToken</span><span class="op" id="8045334">(</span><span class="op" id="8045335">)</span><span class="op" id="8045336">;</span>&nbsp;<span class="ident" id="8045338">err</span>&nbsp;<span class="op" id="8045342">==</span>&nbsp;<span class="builtintype" id="8045345">nil</span><span class="op" id="8045348">;</span>&nbsp;<span class="ident" id="8045350">_</span><span class="op" id="8045351">,</span>&nbsp;<span class="ident" id="8045353">err</span>&nbsp;<span class="op" id="8045357">=</span>&nbsp;<span class="ident" id="8045359">d</span><span class="op" id="8045360">.</span><span class="ident" id="8045361">RawToken</span><span class="op" id="8045369">(</span><span class="op" id="8045370">)</span>&nbsp;<span class="op" id="8045372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045378">if</span>&nbsp;<span class="ident" id="8045381">err</span>&nbsp;<span class="op" id="8045385">!=</span>&nbsp;<span class="ident" id="8045388">io</span><span class="op" id="8045390">.</span><span class="ident" id="8045391">EOF</span>&nbsp;<span class="op" id="8045395">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045399">t</span><span class="op" id="8045400">.</span><span class="ident" id="8045401">Fatalf</span><span class="op" id="8045407">(</span><span class="string" id="8045408">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8045446">,</span>&nbsp;<span class="ident" id="8045448">err</span><span class="op" id="8045451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045454">}</span><br>
<span class="lineno"></span><span class="op" id="8045456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8045459">func</span>&nbsp;<span class="ident" id="8045464">TestTrailingToken</span><span class="op" id="8045481">(</span><span class="ident" id="8045482">t</span>&nbsp;<span class="op" id="8045484">*</span><span class="ident" id="8045485">testing</span><span class="op" id="8045492">.</span><span class="ident" id="8045493">T</span><span class="op" id="8045494">)</span>&nbsp;<span class="op" id="8045496">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045499">input</span>&nbsp;<span class="op" id="8045505">:=</span>&nbsp;<span class="string" id="8045508">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045525">d</span>&nbsp;<span class="op" id="8045527">:=</span>&nbsp;<span class="ident" id="8045530">NewDecoder</span><span class="op" id="8045540">(</span><span class="ident" id="8045541">strings</span><span class="op" id="8045548">.</span><span class="ident" id="8045549">NewReader</span><span class="op" id="8045558">(</span><span class="ident" id="8045559">input</span><span class="op" id="8045564">)</span><span class="op" id="8045565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045568">var</span>&nbsp;<span class="ident" id="8045572">err</span>&nbsp;<span class="builtintype" id="8045576">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045583">for</span>&nbsp;<span class="ident" id="8045587">_</span><span class="op" id="8045588">,</span>&nbsp;<span class="ident" id="8045590">err</span>&nbsp;<span class="op" id="8045594">=</span>&nbsp;<span class="ident" id="8045596">d</span><span class="op" id="8045597">.</span><span class="ident" id="8045598">Token</span><span class="op" id="8045603">(</span><span class="op" id="8045604">)</span><span class="op" id="8045605">;</span>&nbsp;<span class="ident" id="8045607">err</span>&nbsp;<span class="op" id="8045611">==</span>&nbsp;<span class="builtintype" id="8045614">nil</span><span class="op" id="8045617">;</span>&nbsp;<span class="ident" id="8045619">_</span><span class="op" id="8045620">,</span>&nbsp;<span class="ident" id="8045622">err</span>&nbsp;<span class="op" id="8045626">=</span>&nbsp;<span class="ident" id="8045628">d</span><span class="op" id="8045629">.</span><span class="ident" id="8045630">Token</span><span class="op" id="8045635">(</span><span class="op" id="8045636">)</span>&nbsp;<span class="op" id="8045638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045641">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045644">if</span>&nbsp;<span class="ident" id="8045647">err</span>&nbsp;<span class="op" id="8045651">!=</span>&nbsp;<span class="ident" id="8045654">io</span><span class="op" id="8045656">.</span><span class="ident" id="8045657">EOF</span>&nbsp;<span class="op" id="8045661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045665">t</span><span class="op" id="8045666">.</span><span class="ident" id="8045667">Fatalf</span><span class="op" id="8045673">(</span><span class="string" id="8045674">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8045709">,</span>&nbsp;<span class="ident" id="8045711">err</span><span class="op" id="8045714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045717">}</span><br>
<span class="lineno"></span><span class="op" id="8045719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="8045722">func</span>&nbsp;<span class="ident" id="8045727">TestEntityInsideCDATA</span><span class="op" id="8045748">(</span><span class="ident" id="8045749">t</span>&nbsp;<span class="op" id="8045751">*</span><span class="ident" id="8045752">testing</span><span class="op" id="8045759">.</span><span class="ident" id="8045760">T</span><span class="op" id="8045761">)</span>&nbsp;<span class="op" id="8045763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045766">input</span>&nbsp;<span class="op" id="8045772">:=</span>&nbsp;<span class="string" id="8045775">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045814">d</span>&nbsp;<span class="op" id="8045816">:=</span>&nbsp;<span class="ident" id="8045819">NewDecoder</span><span class="op" id="8045829">(</span><span class="ident" id="8045830">strings</span><span class="op" id="8045837">.</span><span class="ident" id="8045838">NewReader</span><span class="op" id="8045847">(</span><span class="ident" id="8045848">input</span><span class="op" id="8045853">)</span><span class="op" id="8045854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045857">var</span>&nbsp;<span class="ident" id="8045861">err</span>&nbsp;<span class="builtintype" id="8045865">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045872">for</span>&nbsp;<span class="ident" id="8045876">_</span><span class="op" id="8045877">,</span>&nbsp;<span class="ident" id="8045879">err</span>&nbsp;<span class="op" id="8045883">=</span>&nbsp;<span class="ident" id="8045885">d</span><span class="op" id="8045886">.</span><span class="ident" id="8045887">Token</span><span class="op" id="8045892">(</span><span class="op" id="8045893">)</span><span class="op" id="8045894">;</span>&nbsp;<span class="ident" id="8045896">err</span>&nbsp;<span class="op" id="8045900">==</span>&nbsp;<span class="builtintype" id="8045903">nil</span><span class="op" id="8045906">;</span>&nbsp;<span class="ident" id="8045908">_</span><span class="op" id="8045909">,</span>&nbsp;<span class="ident" id="8045911">err</span>&nbsp;<span class="op" id="8045915">=</span>&nbsp;<span class="ident" id="8045917">d</span><span class="op" id="8045918">.</span><span class="ident" id="8045919">Token</span><span class="op" id="8045924">(</span><span class="op" id="8045925">)</span>&nbsp;<span class="op" id="8045927">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8045930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8045933">if</span>&nbsp;<span class="ident" id="8045936">err</span>&nbsp;<span class="op" id="8045940">!=</span>&nbsp;<span class="ident" id="8045943">io</span><span class="op" id="8045945">.</span><span class="ident" id="8045946">EOF</span>&nbsp;<span class="op" id="8045950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8045954">t</span><span class="op" id="8045955">.</span><span class="ident" id="8045956">Fatalf</span><span class="op" id="8045962">(</span><span class="string" id="8045963">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8045998">,</span>&nbsp;<span class="ident" id="8046000">err</span><span class="op" id="8046003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046006">}</span><br>
<span class="lineno"></span><span class="op" id="8046008">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="8046011">var</span>&nbsp;<span class="ident" id="8046015">characterTests</span>&nbsp;<span class="op" id="8046030">=</span>&nbsp;<span class="op" id="8046032">[</span><span class="op" id="8046033">]</span><span class="keyword" id="8046034">struct</span>&nbsp;<span class="op" id="8046041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8046044">in</span>&nbsp;&nbsp;<span class="builtintype" id="8046048">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8046056">err</span>&nbsp;<span class="builtintype" id="8046060">string</span><br>
<span class="lineno"></span><span class="op" id="8046067">}</span><span class="op" id="8046068">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046071">{</span><span class="string" id="8046072">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="8046084">,</span>&nbsp;<span class="string" id="8046086">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="8046117">}</span><span class="op" id="8046118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046121">{</span><span class="string" id="8046122">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="8046157">,</span>&nbsp;<span class="string" id="8046159">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="8046190">}</span><span class="op" id="8046191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046194">{</span><span class="string" id="8046195">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="8046215">,</span>&nbsp;<span class="string" id="8046217">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="8046248">}</span><span class="op" id="8046249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046252">{</span><span class="string" id="8046253">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="8046312">,</span>&nbsp;<span class="string" id="8046314">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="8046345">}</span><span class="op" id="8046346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046349">{</span><span class="string" id="8046350">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="8046408">,</span>&nbsp;<span class="string" id="8046410">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="8046446">}</span><span class="op" id="8046447">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046450">{</span><span class="string" id="8046451">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8046473">,</span>&nbsp;<span class="string" id="8046475">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8046521">}</span><span class="op" id="8046522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046525">{</span><span class="string" id="8046526">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8046545">,</span>&nbsp;<span class="string" id="8046547">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8046590">}</span><span class="op" id="8046591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046594">{</span><span class="string" id="8046595">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="8046622">,</span>&nbsp;<span class="string" id="8046624">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="8046659">}</span><span class="op" id="8046660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046663">{</span><span class="string" id="8046664">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="8046684">,</span>&nbsp;<span class="string" id="8046686">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="8046720">}</span><span class="op" id="8046721">,</span><br>
<span class="lineno"></span><span class="op" id="8046723">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="8046726">func</span>&nbsp;<span class="ident" id="8046731">TestDisallowedCharacters</span><span class="op" id="8046755">(</span><span class="ident" id="8046756">t</span>&nbsp;<span class="op" id="8046758">*</span><span class="ident" id="8046759">testing</span><span class="op" id="8046766">.</span><span class="ident" id="8046767">T</span><span class="op" id="8046768">)</span>&nbsp;<span class="op" id="8046770">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8046774">for</span>&nbsp;<span class="ident" id="8046778">i</span><span class="op" id="8046779">,</span>&nbsp;<span class="ident" id="8046781">tt</span>&nbsp;<span class="op" id="8046784">:=</span>&nbsp;<span class="keyword" id="8046787">range</span>&nbsp;<span class="ident" id="8046793">characterTests</span>&nbsp;<span class="op" id="8046808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8046812">d</span>&nbsp;<span class="op" id="8046814">:=</span>&nbsp;<span class="ident" id="8046817">NewDecoder</span><span class="op" id="8046827">(</span><span class="ident" id="8046828">strings</span><span class="op" id="8046835">.</span><span class="ident" id="8046836">NewReader</span><span class="op" id="8046845">(</span><span class="ident" id="8046846">tt</span><span class="op" id="8046848">.</span><span class="ident" id="8046849">in</span><span class="op" id="8046851">)</span><span class="op" id="8046852">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8046856">var</span>&nbsp;<span class="ident" id="8046860">err</span>&nbsp;<span class="builtintype" id="8046864">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8046873">for</span>&nbsp;<span class="ident" id="8046877">err</span>&nbsp;<span class="op" id="8046881">==</span>&nbsp;<span class="builtintype" id="8046884">nil</span>&nbsp;<span class="op" id="8046888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8046893">_</span><span class="op" id="8046894">,</span>&nbsp;<span class="ident" id="8046896">err</span>&nbsp;<span class="op" id="8046900">=</span>&nbsp;<span class="ident" id="8046902">d</span><span class="op" id="8046903">.</span><span class="ident" id="8046904">Token</span><span class="op" id="8046909">(</span><span class="op" id="8046910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8046914">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8046918">synerr</span><span class="op" id="8046924">,</span>&nbsp;<span class="ident" id="8046926">ok</span>&nbsp;<span class="op" id="8046929">:=</span>&nbsp;<span class="ident" id="8046932">err</span><span class="op" id="8046935">.</span><span class="op" id="8046936">(</span><span class="op" id="8046937">*</span><span class="ident" id="8046938">SyntaxError</span><span class="op" id="8046949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8046953">if</span>&nbsp;<span class="op" id="8046956">!</span><span class="ident" id="8046957">ok</span>&nbsp;<span class="op" id="8046960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8046965">t</span><span class="op" id="8046966">.</span><span class="ident" id="8046967">Fatalf</span><span class="op" id="8046973">(</span><span class="string" id="8046974">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="8047024">,</span>&nbsp;<span class="ident" id="8047026">i</span><span class="op" id="8047027">,</span>&nbsp;<span class="ident" id="8047029">err</span><span class="op" id="8047032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8047040">if</span>&nbsp;<span class="ident" id="8047043">synerr</span><span class="op" id="8047049">.</span><span class="ident" id="8047050">Msg</span>&nbsp;<span class="op" id="8047054">!=</span>&nbsp;<span class="ident" id="8047057">tt</span><span class="op" id="8047059">.</span><span class="ident" id="8047060">err</span>&nbsp;<span class="op" id="8047064">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8047069">t</span><span class="op" id="8047070">.</span><span class="ident" id="8047071">Fatalf</span><span class="op" id="8047077">(</span><span class="string" id="8047078">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8047122">,</span>&nbsp;<span class="ident" id="8047124">i</span><span class="op" id="8047125">,</span>&nbsp;<span class="ident" id="8047127">tt</span><span class="op" id="8047129">.</span><span class="ident" id="8047130">err</span><span class="op" id="8047133">,</span>&nbsp;<span class="ident" id="8047135">synerr</span><span class="op" id="8047141">.</span><span class="ident" id="8047142">Msg</span><span class="op" id="8047145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047152">}</span><br>
<span class="lineno"></span><span class="op" id="8047154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="8047157">type</span>&nbsp;<span class="ident" id="8047162">procInstEncodingTest</span>&nbsp;<span class="keyword" id="8047183">struct</span>&nbsp;<span class="op" id="8047190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8047193">expect</span><span class="op" id="8047199">,</span>&nbsp;<span class="ident" id="8047201">got</span>&nbsp;<span class="builtintype" id="8047205">string</span><br>
<span class="lineno"></span><span class="op" id="8047212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8047215">var</span>&nbsp;<span class="ident" id="8047219">procInstTests</span>&nbsp;<span class="op" id="8047233">=</span>&nbsp;<span class="op" id="8047235">[</span><span class="op" id="8047236">]</span><span class="keyword" id="8047237">struct</span>&nbsp;<span class="op" id="8047244">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8047247">input</span><span class="op" id="8047252">,</span>&nbsp;<span class="ident" id="8047254">expect</span>&nbsp;<span class="builtintype" id="8047261">string</span><br>
<span class="lineno"></span><span class="op" id="8047268">}</span><span class="op" id="8047269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047272">{</span><span class="string" id="8047273">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="8047305">,</span>&nbsp;<span class="string" id="8047307">&#34;utf-8&#34;</span><span class="op" id="8047314">}</span><span class="op" id="8047315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047318">{</span><span class="string" id="8047319">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="8047351">,</span>&nbsp;<span class="string" id="8047353">&#34;utf-8&#34;</span><span class="op" id="8047360">}</span><span class="op" id="8047361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047364">{</span><span class="string" id="8047365">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="8047398">,</span>&nbsp;<span class="string" id="8047400">&#34;utf-8&#34;</span><span class="op" id="8047407">}</span><span class="op" id="8047408">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047411">{</span><span class="string" id="8047412">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="8047442">,</span>&nbsp;<span class="string" id="8047444">&#34;&#34;</span><span class="op" id="8047446">}</span><span class="op" id="8047447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047450">{</span><span class="string" id="8047451">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="8047468">,</span>&nbsp;<span class="string" id="8047470">&#34;FOO&#34;</span><span class="op" id="8047475">}</span><span class="op" id="8047476">,</span><br>
<span class="lineno"></span><span class="op" id="8047478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8047481">func</span>&nbsp;<span class="ident" id="8047486">TestProcInstEncoding</span><span class="op" id="8047506">(</span><span class="ident" id="8047507">t</span>&nbsp;<span class="op" id="8047509">*</span><span class="ident" id="8047510">testing</span><span class="op" id="8047517">.</span><span class="ident" id="8047518">T</span><span class="op" id="8047519">)</span>&nbsp;<span class="op" id="8047521">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8047524">for</span>&nbsp;<span class="ident" id="8047528">_</span><span class="op" id="8047529">,</span>&nbsp;<span class="ident" id="8047531">test</span>&nbsp;<span class="op" id="8047536">:=</span>&nbsp;<span class="keyword" id="8047539">range</span>&nbsp;<span class="ident" id="8047545">procInstTests</span>&nbsp;<span class="op" id="8047559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8047563">got</span>&nbsp;<span class="op" id="8047567">:=</span>&nbsp;<span class="ident" id="8047570">procInstEncoding</span><span class="op" id="8047586">(</span><span class="ident" id="8047587">test</span><span class="op" id="8047591">.</span><span class="ident" id="8047592">input</span><span class="op" id="8047597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8047601">if</span>&nbsp;<span class="ident" id="8047604">got</span>&nbsp;<span class="op" id="8047608">!=</span>&nbsp;<span class="ident" id="8047611">test</span><span class="op" id="8047615">.</span><span class="ident" id="8047616">expect</span>&nbsp;<span class="op" id="8047623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8047628">t</span><span class="op" id="8047629">.</span><span class="ident" id="8047630">Errorf</span><span class="op" id="8047636">(</span><span class="string" id="8047637">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8047673">,</span>&nbsp;<span class="ident" id="8047675">test</span><span class="op" id="8047679">.</span><span class="ident" id="8047680">input</span><span class="op" id="8047685">,</span>&nbsp;<span class="ident" id="8047687">got</span><span class="op" id="8047690">,</span>&nbsp;<span class="ident" id="8047692">test</span><span class="op" id="8047696">.</span><span class="ident" id="8047697">expect</span><span class="op" id="8047703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047707">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8047710">}</span><br>
<span class="lineno"></span><span class="op" id="8047712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8047715">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="8047776">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8047811">var</span>&nbsp;<span class="ident" id="8047815">directivesWithCommentsInput</span>&nbsp;<span class="op" id="8047843">=</span>&nbsp;<span class="string" id="8047845">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8048081">var</span>&nbsp;<span class="ident" id="8048085">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8048114">=</span>&nbsp;<span class="op" id="8048116">[</span><span class="op" id="8048117">]</span><span class="ident" id="8048118">Token</span><span class="op" id="8048123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048126">CharData</span><span class="op" id="8048134">(</span><span class="string" id="8048135">&#34;\n&#34;</span><span class="op" id="8048139">)</span><span class="op" id="8048140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048143">Directive</span><span class="op" id="8048152">(</span><span class="string" id="8048153">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8048224">)</span><span class="op" id="8048225">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048228">CharData</span><span class="op" id="8048236">(</span><span class="string" id="8048237">&#34;\n&#34;</span><span class="op" id="8048241">)</span><span class="op" id="8048242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048245">Directive</span><span class="op" id="8048254">(</span><span class="string" id="8048255">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8048288">)</span><span class="op" id="8048289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048292">CharData</span><span class="op" id="8048300">(</span><span class="string" id="8048301">&#34;\n&#34;</span><span class="op" id="8048305">)</span><span class="op" id="8048306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048309">Directive</span><span class="op" id="8048318">(</span><span class="string" id="8048319">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8048364">)</span><span class="op" id="8048365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048368">CharData</span><span class="op" id="8048376">(</span><span class="string" id="8048377">&#34;\n&#34;</span><span class="op" id="8048381">)</span><span class="op" id="8048382">,</span><br>
<span class="lineno">695</span><span class="op" id="8048384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8048387">func</span>&nbsp;<span class="ident" id="8048392">TestDirectivesWithComments</span><span class="op" id="8048418">(</span><span class="ident" id="8048419">t</span>&nbsp;<span class="op" id="8048421">*</span><span class="ident" id="8048422">testing</span><span class="op" id="8048429">.</span><span class="ident" id="8048430">T</span><span class="op" id="8048431">)</span>&nbsp;<span class="op" id="8048433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048436">d</span>&nbsp;<span class="op" id="8048438">:=</span>&nbsp;<span class="ident" id="8048441">NewDecoder</span><span class="op" id="8048451">(</span><span class="ident" id="8048452">strings</span><span class="op" id="8048459">.</span><span class="ident" id="8048460">NewReader</span><span class="op" id="8048469">(</span><span class="ident" id="8048470">directivesWithCommentsInput</span><span class="op" id="8048497">)</span><span class="op" id="8048498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8048502">for</span>&nbsp;<span class="ident" id="8048506">i</span><span class="op" id="8048507">,</span>&nbsp;<span class="ident" id="8048509">want</span>&nbsp;<span class="op" id="8048514">:=</span>&nbsp;<span class="keyword" id="8048517">range</span>&nbsp;<span class="ident" id="8048523">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8048552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048556">have</span><span class="op" id="8048560">,</span>&nbsp;<span class="ident" id="8048562">err</span>&nbsp;<span class="op" id="8048566">:=</span>&nbsp;<span class="ident" id="8048569">d</span><span class="op" id="8048570">.</span><span class="ident" id="8048571">Token</span><span class="op" id="8048576">(</span><span class="op" id="8048577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8048581">if</span>&nbsp;<span class="ident" id="8048584">err</span>&nbsp;<span class="op" id="8048588">!=</span>&nbsp;<span class="builtintype" id="8048591">nil</span>&nbsp;<span class="op" id="8048595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048600">t</span><span class="op" id="8048601">.</span><span class="ident" id="8048602">Fatalf</span><span class="op" id="8048608">(</span><span class="string" id="8048609">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8048641">,</span>&nbsp;<span class="ident" id="8048643">i</span><span class="op" id="8048644">,</span>&nbsp;<span class="ident" id="8048646">err</span><span class="op" id="8048649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8048653">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8048657">if</span>&nbsp;<span class="op" id="8048660">!</span><span class="ident" id="8048661">reflect</span><span class="op" id="8048668">.</span><span class="ident" id="8048669">DeepEqual</span><span class="op" id="8048678">(</span><span class="ident" id="8048679">have</span><span class="op" id="8048683">,</span>&nbsp;<span class="ident" id="8048685">want</span><span class="op" id="8048689">)</span>&nbsp;<span class="op" id="8048691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048696">t</span><span class="op" id="8048697">.</span><span class="ident" id="8048698">Errorf</span><span class="op" id="8048704">(</span><span class="string" id="8048705">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8048730">,</span>&nbsp;<span class="ident" id="8048732">i</span><span class="op" id="8048733">,</span>&nbsp;<span class="ident" id="8048735">have</span><span class="op" id="8048739">,</span>&nbsp;<span class="ident" id="8048741">want</span><span class="op" id="8048745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8048749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8048752">}</span><br>
<span class="lineno"></span><span class="op" id="8048754">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="8048757">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="8048811">type</span>&nbsp;<span class="ident" id="8048816">errWriter</span>&nbsp;<span class="keyword" id="8048826">struct</span><span class="op" id="8048832">{</span><span class="op" id="8048833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8048836">func</span>&nbsp;<span class="op" id="8048841">(</span><span class="ident" id="8048842">errWriter</span><span class="op" id="8048851">)</span>&nbsp;<span class="ident" id="8048853">Write</span><span class="op" id="8048858">(</span><span class="ident" id="8048859">p</span>&nbsp;<span class="op" id="8048861">[</span><span class="op" id="8048862">]</span><span class="builtintype" id="8048863">byte</span><span class="op" id="8048867">)</span>&nbsp;<span class="op" id="8048869">(</span><span class="ident" id="8048870">n</span>&nbsp;<span class="builtintype" id="8048872">int</span><span class="op" id="8048875">,</span>&nbsp;<span class="ident" id="8048877">err</span>&nbsp;<span class="builtintype" id="8048881">error</span><span class="op" id="8048886">)</span>&nbsp;<span class="op" id="8048888">{</span>&nbsp;<span class="keyword" id="8048890">return</span>&nbsp;<span class="num" id="8048897">0</span><span class="op" id="8048898">,</span>&nbsp;<span class="ident" id="8048900">fmt</span><span class="op" id="8048903">.</span><span class="ident" id="8048904">Errorf</span><span class="op" id="8048910">(</span><span class="string" id="8048911">&#34;unwritable&#34;</span><span class="op" id="8048923">)</span>&nbsp;<span class="op" id="8048925">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="8048928">func</span>&nbsp;<span class="ident" id="8048933">TestEscapeTextIOErrors</span><span class="op" id="8048955">(</span><span class="ident" id="8048956">t</span>&nbsp;<span class="op" id="8048958">*</span><span class="ident" id="8048959">testing</span><span class="op" id="8048966">.</span><span class="ident" id="8048967">T</span><span class="op" id="8048968">)</span>&nbsp;<span class="op" id="8048970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8048973">expectErr</span>&nbsp;<span class="op" id="8048983">:=</span>&nbsp;<span class="string" id="8048986">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049000">err</span>&nbsp;<span class="op" id="8049004">:=</span>&nbsp;<span class="ident" id="8049007">EscapeText</span><span class="op" id="8049017">(</span><span class="ident" id="8049018">errWriter</span><span class="op" id="8049027">{</span><span class="op" id="8049028">}</span><span class="op" id="8049029">,</span>&nbsp;<span class="op" id="8049031">[</span><span class="op" id="8049032">]</span><span class="builtintype" id="8049033">byte</span><span class="op" id="8049037">{</span><span class="string" id="8049038">&#39;A&#39;</span><span class="op" id="8049041">}</span><span class="op" id="8049042">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8049046">if</span>&nbsp;<span class="ident" id="8049049">err</span>&nbsp;<span class="op" id="8049053">==</span>&nbsp;<span class="builtintype" id="8049056">nil</span>&nbsp;<span class="op" id="8049060">||</span>&nbsp;<span class="ident" id="8049063">err</span><span class="op" id="8049066">.</span><span class="ident" id="8049067">Error</span><span class="op" id="8049072">(</span><span class="op" id="8049073">)</span>&nbsp;<span class="op" id="8049075">!=</span>&nbsp;<span class="ident" id="8049078">expectErr</span>&nbsp;<span class="op" id="8049088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049092">t</span><span class="op" id="8049093">.</span><span class="ident" id="8049094">Errorf</span><span class="op" id="8049100">(</span><span class="string" id="8049101">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8049119">,</span>&nbsp;<span class="ident" id="8049121">err</span><span class="op" id="8049124">,</span>&nbsp;<span class="ident" id="8049126">expectErr</span><span class="op" id="8049135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8049138">}</span><br>
<span class="lineno"></span><span class="op" id="8049140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="8049143">func</span>&nbsp;<span class="ident" id="8049148">TestEscapeTextInvalidChar</span><span class="op" id="8049173">(</span><span class="ident" id="8049174">t</span>&nbsp;<span class="op" id="8049176">*</span><span class="ident" id="8049177">testing</span><span class="op" id="8049184">.</span><span class="ident" id="8049185">T</span><span class="op" id="8049186">)</span>&nbsp;<span class="op" id="8049188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049191">input</span>&nbsp;<span class="op" id="8049197">:=</span>&nbsp;<span class="op" id="8049200">[</span><span class="op" id="8049201">]</span><span class="builtintype" id="8049202">byte</span><span class="op" id="8049206">(</span><span class="string" id="8049207">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="8049234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049237">expected</span>&nbsp;<span class="op" id="8049246">:=</span>&nbsp;<span class="string" id="8049249">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049281">buff</span>&nbsp;<span class="op" id="8049286">:=</span>&nbsp;<span class="builtinfunc" id="8049289">new</span><span class="op" id="8049292">(</span><span class="ident" id="8049293">bytes</span><span class="op" id="8049298">.</span><span class="ident" id="8049299">Buffer</span><span class="op" id="8049305">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8049308">if</span>&nbsp;<span class="ident" id="8049311">err</span>&nbsp;<span class="op" id="8049315">:=</span>&nbsp;<span class="ident" id="8049318">EscapeText</span><span class="op" id="8049328">(</span><span class="ident" id="8049329">buff</span><span class="op" id="8049333">,</span>&nbsp;<span class="ident" id="8049335">input</span><span class="op" id="8049340">)</span><span class="op" id="8049341">;</span>&nbsp;<span class="ident" id="8049343">err</span>&nbsp;<span class="op" id="8049347">!=</span>&nbsp;<span class="builtintype" id="8049350">nil</span>&nbsp;<span class="op" id="8049354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049358">t</span><span class="op" id="8049359">.</span><span class="ident" id="8049360">Fatalf</span><span class="op" id="8049366">(</span><span class="string" id="8049367">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8049386">,</span>&nbsp;<span class="ident" id="8049388">err</span><span class="op" id="8049391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8049394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049397">text</span>&nbsp;<span class="op" id="8049402">:=</span>&nbsp;<span class="ident" id="8049405">buff</span><span class="op" id="8049409">.</span><span class="ident" id="8049410">String</span><span class="op" id="8049416">(</span><span class="op" id="8049417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8049421">if</span>&nbsp;<span class="ident" id="8049424">text</span>&nbsp;<span class="op" id="8049429">!=</span>&nbsp;<span class="ident" id="8049432">expected</span>&nbsp;<span class="op" id="8049441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049445">t</span><span class="op" id="8049446">.</span><span class="ident" id="8049447">Errorf</span><span class="op" id="8049453">(</span><span class="string" id="8049454">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8049472">,</span>&nbsp;<span class="ident" id="8049474">text</span><span class="op" id="8049478">,</span>&nbsp;<span class="ident" id="8049480">expected</span><span class="op" id="8049488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8049491">}</span><br>
<span class="lineno"></span><span class="op" id="8049493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="8049496">func</span>&nbsp;<span class="ident" id="8049501">TestIssue5880</span><span class="op" id="8049514">(</span><span class="ident" id="8049515">t</span>&nbsp;<span class="op" id="8049517">*</span><span class="ident" id="8049518">testing</span><span class="op" id="8049525">.</span><span class="ident" id="8049526">T</span><span class="op" id="8049527">)</span>&nbsp;<span class="op" id="8049529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8049532">type</span>&nbsp;<span class="ident" id="8049537">T</span>&nbsp;<span class="op" id="8049539">[</span><span class="op" id="8049540">]</span><span class="builtintype" id="8049541">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049547">data</span><span class="op" id="8049551">,</span>&nbsp;<span class="ident" id="8049553">err</span>&nbsp;<span class="op" id="8049557">:=</span>&nbsp;<span class="ident" id="8049560">Marshal</span><span class="op" id="8049567">(</span><span class="ident" id="8049568">T</span><span class="op" id="8049569">{</span><span class="num" id="8049570">192</span><span class="op" id="8049573">,</span>&nbsp;<span class="num" id="8049575">168</span><span class="op" id="8049578">,</span>&nbsp;<span class="num" id="8049580">0</span><span class="op" id="8049581">,</span>&nbsp;<span class="num" id="8049583">1</span><span class="op" id="8049584">}</span><span class="op" id="8049585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8049588">if</span>&nbsp;<span class="ident" id="8049591">err</span>&nbsp;<span class="op" id="8049595">!=</span>&nbsp;<span class="builtintype" id="8049598">nil</span>&nbsp;<span class="op" id="8049602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049606">t</span><span class="op" id="8049607">.</span><span class="ident" id="8049608">Errorf</span><span class="op" id="8049614">(</span><span class="string" id="8049615">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8049634">,</span>&nbsp;<span class="ident" id="8049636">err</span><span class="op" id="8049639">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8049642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8049645">if</span>&nbsp;<span class="op" id="8049648">!</span><span class="ident" id="8049649">utf8</span><span class="op" id="8049653">.</span><span class="ident" id="8049654">Valid</span><span class="op" id="8049659">(</span><span class="ident" id="8049660">data</span><span class="op" id="8049664">)</span>&nbsp;<span class="op" id="8049666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8049670">t</span><span class="op" id="8049671">.</span><span class="ident" id="8049672">Errorf</span><span class="op" id="8049678">(</span><span class="string" id="8049679">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="8049716">,</span>&nbsp;<span class="ident" id="8049718">data</span><span class="op" id="8049722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8049725">}</span><br>
<span class="lineno"></span><span class="op" id="8049727">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
