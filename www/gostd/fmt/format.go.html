<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html" class="current">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2019499">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2019554">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2019608">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2019659">package</span>&nbsp;<span class="ident" id="2019667">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2019672">import</span>&nbsp;<span class="op" id="2019679">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2019682">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2019690">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2019701">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2019716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2019719">const</span>&nbsp;<span class="op" id="2019725">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2019728">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2019761">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2019808">nByte</span>&nbsp;<span class="op" id="2019814">=</span>&nbsp;<span class="num" id="2019816">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2019821">ldigits</span>&nbsp;<span class="op" id="2019829">=</span>&nbsp;<span class="string" id="2019831">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2019851">udigits</span>&nbsp;<span class="op" id="2019859">=</span>&nbsp;<span class="string" id="2019861">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2019880">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2019883">const</span>&nbsp;<span class="op" id="2019889">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2019892">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2019901">=</span>&nbsp;<span class="builtintype" id="2019903">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2019909">unsigned</span>&nbsp;<span class="op" id="2019918">=</span>&nbsp;<span class="builtintype" id="2019920">false</span><br>
<span class="lineno">25</span><span class="op" id="2019926">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2019929">var</span>&nbsp;<span class="ident" id="2019933">padZeroBytes</span>&nbsp;<span class="op" id="2019946">=</span>&nbsp;<span class="builtinfunc" id="2019948">make</span><span class="op" id="2019952">(</span><span class="op" id="2019953">[</span><span class="op" id="2019954">]</span><span class="builtintype" id="2019955">byte</span><span class="op" id="2019959">,</span>&nbsp;<span class="ident" id="2019961">nByte</span><span class="op" id="2019966">)</span><br>
<span class="lineno"></span><span class="keyword" id="2019968">var</span>&nbsp;<span class="ident" id="2019972">padSpaceBytes</span>&nbsp;<span class="op" id="2019986">=</span>&nbsp;<span class="builtinfunc" id="2019988">make</span><span class="op" id="2019992">(</span><span class="op" id="2019993">[</span><span class="op" id="2019994">]</span><span class="builtintype" id="2019995">byte</span><span class="op" id="2019999">,</span>&nbsp;<span class="ident" id="2020001">nByte</span><span class="op" id="2020006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2020009">func</span>&nbsp;<span class="ident" id="2020014">init</span><span class="op" id="2020018">(</span><span class="op" id="2020019">)</span>&nbsp;<span class="op" id="2020021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2020024">for</span>&nbsp;<span class="ident" id="2020028">i</span>&nbsp;<span class="op" id="2020030">:=</span>&nbsp;<span class="num" id="2020033">0</span><span class="op" id="2020034">;</span>&nbsp;<span class="ident" id="2020036">i</span>&nbsp;<span class="op" id="2020038">&lt;</span>&nbsp;<span class="ident" id="2020040">nByte</span><span class="op" id="2020045">;</span>&nbsp;<span class="ident" id="2020047">i</span><span class="op" id="2020048">++</span>&nbsp;<span class="op" id="2020051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020055">padZeroBytes</span><span class="op" id="2020067">[</span><span class="ident" id="2020068">i</span><span class="op" id="2020069">]</span>&nbsp;<span class="op" id="2020071">=</span>&nbsp;<span class="string" id="2020073">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020079">padSpaceBytes</span><span class="op" id="2020092">[</span><span class="ident" id="2020093">i</span><span class="op" id="2020094">]</span>&nbsp;<span class="op" id="2020096">=</span>&nbsp;<span class="string" id="2020098">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2020103">}</span><br>
<span class="lineno">35</span><span class="op" id="2020105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2020108">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2020164">type</span>&nbsp;<span class="ident" id="2020169">fmtFlags</span>&nbsp;<span class="keyword" id="2020178">struct</span>&nbsp;<span class="op" id="2020185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020188">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2020200">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020206">precPresent</span>&nbsp;<span class="builtintype" id="2020218">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020224">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020236">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020242">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020254">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020260">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020272">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020278">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020290">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020296">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020308">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020314">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020326">bool</span>&nbsp;<span class="comment" id="2020331">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020372">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2020384">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2020391">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2020450">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2020517">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020571">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2020578">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020584">sharpV</span>&nbsp;<span class="builtintype" id="2020591">bool</span><br>
<span class="lineno"></span><span class="op" id="2020596">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2020599">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2020649">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2020708">type</span>&nbsp;<span class="ident" id="2020713">fmt</span>&nbsp;<span class="keyword" id="2020717">struct</span>&nbsp;<span class="op" id="2020724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020727">intbuf</span>&nbsp;<span class="op" id="2020734">[</span><span class="ident" id="2020735">nByte</span><span class="op" id="2020740">]</span><span class="builtintype" id="2020741">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020747">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2020754">*</span><span class="ident" id="2020755">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2020763">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020784">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2020789">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020794">prec</span>&nbsp;<span class="builtintype" id="2020799">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020804">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2020813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2020816">func</span>&nbsp;<span class="op" id="2020821">(</span><span class="ident" id="2020822">f</span>&nbsp;<span class="op" id="2020824">*</span><span class="ident" id="2020825">fmt</span><span class="op" id="2020828">)</span>&nbsp;<span class="ident" id="2020830">clearflags</span><span class="op" id="2020840">(</span><span class="op" id="2020841">)</span>&nbsp;<span class="op" id="2020843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020846">f</span><span class="op" id="2020847">.</span><span class="ident" id="2020848">fmtFlags</span>&nbsp;<span class="op" id="2020857">=</span>&nbsp;<span class="ident" id="2020859">fmtFlags</span><span class="op" id="2020867">{</span><span class="op" id="2020868">}</span><br>
<span class="lineno"></span><span class="op" id="2020870">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2020873">func</span>&nbsp;<span class="op" id="2020878">(</span><span class="ident" id="2020879">f</span>&nbsp;<span class="op" id="2020881">*</span><span class="ident" id="2020882">fmt</span><span class="op" id="2020885">)</span>&nbsp;<span class="ident" id="2020887">init</span><span class="op" id="2020891">(</span><span class="ident" id="2020892">buf</span>&nbsp;<span class="op" id="2020896">*</span><span class="ident" id="2020897">buffer</span><span class="op" id="2020903">)</span>&nbsp;<span class="op" id="2020905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020908">f</span><span class="op" id="2020909">.</span><span class="ident" id="2020910">buf</span>&nbsp;<span class="op" id="2020914">=</span>&nbsp;<span class="ident" id="2020916">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2020921">f</span><span class="op" id="2020922">.</span><span class="ident" id="2020923">clearflags</span><span class="op" id="2020933">(</span><span class="op" id="2020934">)</span><br>
<span class="lineno"></span><span class="op" id="2020936">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2020939">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2021025">func</span>&nbsp;<span class="op" id="2021030">(</span><span class="ident" id="2021031">f</span>&nbsp;<span class="op" id="2021033">*</span><span class="ident" id="2021034">fmt</span><span class="op" id="2021037">)</span>&nbsp;<span class="ident" id="2021039">computePadding</span><span class="op" id="2021053">(</span><span class="ident" id="2021054">width</span>&nbsp;<span class="builtintype" id="2021060">int</span><span class="op" id="2021063">)</span>&nbsp;<span class="op" id="2021065">(</span><span class="ident" id="2021066">padding</span>&nbsp;<span class="op" id="2021074">[</span><span class="op" id="2021075">]</span><span class="builtintype" id="2021076">byte</span><span class="op" id="2021080">,</span>&nbsp;<span class="ident" id="2021082">leftWidth</span><span class="op" id="2021091">,</span>&nbsp;<span class="ident" id="2021093">rightWidth</span>&nbsp;<span class="builtintype" id="2021104">int</span><span class="op" id="2021107">)</span>&nbsp;<span class="op" id="2021109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021112">left</span>&nbsp;<span class="op" id="2021117">:=</span>&nbsp;<span class="op" id="2021120">!</span><span class="ident" id="2021121">f</span><span class="op" id="2021122">.</span><span class="ident" id="2021123">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021130">w</span>&nbsp;<span class="op" id="2021132">:=</span>&nbsp;<span class="ident" id="2021135">f</span><span class="op" id="2021136">.</span><span class="ident" id="2021137">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021142">if</span>&nbsp;<span class="ident" id="2021145">w</span>&nbsp;<span class="op" id="2021147">&lt;</span>&nbsp;<span class="num" id="2021149">0</span>&nbsp;<span class="op" id="2021151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021155">left</span>&nbsp;<span class="op" id="2021160">=</span>&nbsp;<span class="builtintype" id="2021162">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021170">w</span>&nbsp;<span class="op" id="2021172">=</span>&nbsp;<span class="op" id="2021174">-</span><span class="ident" id="2021175">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021181">w</span>&nbsp;<span class="op" id="2021183">-=</span>&nbsp;<span class="ident" id="2021186">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021193">if</span>&nbsp;<span class="ident" id="2021196">w</span>&nbsp;<span class="op" id="2021198">&gt;</span>&nbsp;<span class="num" id="2021200">0</span>&nbsp;<span class="op" id="2021202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021206">if</span>&nbsp;<span class="ident" id="2021209">left</span>&nbsp;<span class="op" id="2021214">&amp;&amp;</span>&nbsp;<span class="ident" id="2021217">f</span><span class="op" id="2021218">.</span><span class="ident" id="2021219">zero</span>&nbsp;<span class="op" id="2021224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021229">return</span>&nbsp;<span class="ident" id="2021236">padZeroBytes</span><span class="op" id="2021248">,</span>&nbsp;<span class="ident" id="2021250">w</span><span class="op" id="2021251">,</span>&nbsp;<span class="num" id="2021253">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021261">if</span>&nbsp;<span class="ident" id="2021264">left</span>&nbsp;<span class="op" id="2021269">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021274">return</span>&nbsp;<span class="ident" id="2021281">padSpaceBytes</span><span class="op" id="2021294">,</span>&nbsp;<span class="ident" id="2021296">w</span><span class="op" id="2021297">,</span>&nbsp;<span class="num" id="2021299">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021303">}</span>&nbsp;<span class="keyword" id="2021305">else</span>&nbsp;<span class="op" id="2021310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2021315">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021356">return</span>&nbsp;<span class="ident" id="2021363">padSpaceBytes</span><span class="op" id="2021376">,</span>&nbsp;<span class="num" id="2021378">0</span><span class="op" id="2021379">,</span>&nbsp;<span class="ident" id="2021381">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021385">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021391">return</span><br>
<span class="lineno"></span><span class="op" id="2021398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2021401">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2021447">func</span>&nbsp;<span class="op" id="2021452">(</span><span class="ident" id="2021453">f</span>&nbsp;<span class="op" id="2021455">*</span><span class="ident" id="2021456">fmt</span><span class="op" id="2021459">)</span>&nbsp;<span class="ident" id="2021461">writePadding</span><span class="op" id="2021473">(</span><span class="ident" id="2021474">n</span>&nbsp;<span class="builtintype" id="2021476">int</span><span class="op" id="2021479">,</span>&nbsp;<span class="ident" id="2021481">padding</span>&nbsp;<span class="op" id="2021489">[</span><span class="op" id="2021490">]</span><span class="builtintype" id="2021491">byte</span><span class="op" id="2021495">)</span>&nbsp;<span class="op" id="2021497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021500">for</span>&nbsp;<span class="ident" id="2021504">n</span>&nbsp;<span class="op" id="2021506">&gt;</span>&nbsp;<span class="num" id="2021508">0</span>&nbsp;<span class="op" id="2021510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021514">m</span>&nbsp;<span class="op" id="2021516">:=</span>&nbsp;<span class="ident" id="2021519">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021523">if</span>&nbsp;<span class="ident" id="2021526">m</span>&nbsp;<span class="op" id="2021528">&gt;</span>&nbsp;<span class="ident" id="2021530">nByte</span>&nbsp;<span class="op" id="2021536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021541">m</span>&nbsp;<span class="op" id="2021543">=</span>&nbsp;<span class="ident" id="2021545">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021557">f</span><span class="op" id="2021558">.</span><span class="ident" id="2021559">buf</span><span class="op" id="2021562">.</span><span class="ident" id="2021563">Write</span><span class="op" id="2021568">(</span><span class="ident" id="2021569">padding</span><span class="op" id="2021576">[</span><span class="num" id="2021577">0</span><span class="op" id="2021578">:</span><span class="ident" id="2021579">m</span><span class="op" id="2021580">]</span><span class="op" id="2021581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021585">n</span>&nbsp;<span class="op" id="2021587">-=</span>&nbsp;<span class="ident" id="2021590">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021593">}</span><br>
<span class="lineno"></span><span class="op" id="2021595">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2021598">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2021677">func</span>&nbsp;<span class="op" id="2021682">(</span><span class="ident" id="2021683">f</span>&nbsp;<span class="op" id="2021685">*</span><span class="ident" id="2021686">fmt</span><span class="op" id="2021689">)</span>&nbsp;<span class="ident" id="2021691">pad</span><span class="op" id="2021694">(</span><span class="ident" id="2021695">b</span>&nbsp;<span class="op" id="2021697">[</span><span class="op" id="2021698">]</span><span class="builtintype" id="2021699">byte</span><span class="op" id="2021703">)</span>&nbsp;<span class="op" id="2021705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021708">if</span>&nbsp;<span class="op" id="2021711">!</span><span class="ident" id="2021712">f</span><span class="op" id="2021713">.</span><span class="ident" id="2021714">widPresent</span>&nbsp;<span class="op" id="2021725">||</span>&nbsp;<span class="ident" id="2021728">f</span><span class="op" id="2021729">.</span><span class="ident" id="2021730">wid</span>&nbsp;<span class="op" id="2021734">==</span>&nbsp;<span class="num" id="2021737">0</span>&nbsp;<span class="op" id="2021739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021743">f</span><span class="op" id="2021744">.</span><span class="ident" id="2021745">buf</span><span class="op" id="2021748">.</span><span class="ident" id="2021749">Write</span><span class="op" id="2021754">(</span><span class="ident" id="2021755">b</span><span class="op" id="2021756">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021760">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021771">padding</span><span class="op" id="2021778">,</span>&nbsp;<span class="ident" id="2021780">left</span><span class="op" id="2021784">,</span>&nbsp;<span class="ident" id="2021786">right</span>&nbsp;<span class="op" id="2021792">:=</span>&nbsp;<span class="ident" id="2021795">f</span><span class="op" id="2021796">.</span><span class="ident" id="2021797">computePadding</span><span class="op" id="2021811">(</span><span class="ident" id="2021812">utf8</span><span class="op" id="2021816">.</span><span class="ident" id="2021817">RuneCount</span><span class="op" id="2021826">(</span><span class="ident" id="2021827">b</span><span class="op" id="2021828">)</span><span class="op" id="2021829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021832">if</span>&nbsp;<span class="ident" id="2021835">left</span>&nbsp;<span class="op" id="2021840">&gt;</span>&nbsp;<span class="num" id="2021842">0</span>&nbsp;<span class="op" id="2021844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021848">f</span><span class="op" id="2021849">.</span><span class="ident" id="2021850">writePadding</span><span class="op" id="2021862">(</span><span class="ident" id="2021863">left</span><span class="op" id="2021867">,</span>&nbsp;<span class="ident" id="2021869">padding</span><span class="op" id="2021876">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021882">f</span><span class="op" id="2021883">.</span><span class="ident" id="2021884">buf</span><span class="op" id="2021887">.</span><span class="ident" id="2021888">Write</span><span class="op" id="2021893">(</span><span class="ident" id="2021894">b</span><span class="op" id="2021895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2021898">if</span>&nbsp;<span class="ident" id="2021901">right</span>&nbsp;<span class="op" id="2021907">&gt;</span>&nbsp;<span class="num" id="2021909">0</span>&nbsp;<span class="op" id="2021911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2021915">f</span><span class="op" id="2021916">.</span><span class="ident" id="2021917">writePadding</span><span class="op" id="2021929">(</span><span class="ident" id="2021930">right</span><span class="op" id="2021935">,</span>&nbsp;<span class="ident" id="2021937">padding</span><span class="op" id="2021944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2021947">}</span><br>
<span class="lineno">125</span><span class="op" id="2021949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2021952">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2022035">func</span>&nbsp;<span class="op" id="2022040">(</span><span class="ident" id="2022041">f</span>&nbsp;<span class="op" id="2022043">*</span><span class="ident" id="2022044">fmt</span><span class="op" id="2022047">)</span>&nbsp;<span class="ident" id="2022049">padString</span><span class="op" id="2022058">(</span><span class="ident" id="2022059">s</span>&nbsp;<span class="builtintype" id="2022061">string</span><span class="op" id="2022067">)</span>&nbsp;<span class="op" id="2022069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022072">if</span>&nbsp;<span class="op" id="2022075">!</span><span class="ident" id="2022076">f</span><span class="op" id="2022077">.</span><span class="ident" id="2022078">widPresent</span>&nbsp;<span class="op" id="2022089">||</span>&nbsp;<span class="ident" id="2022092">f</span><span class="op" id="2022093">.</span><span class="ident" id="2022094">wid</span>&nbsp;<span class="op" id="2022098">==</span>&nbsp;<span class="num" id="2022101">0</span>&nbsp;<span class="op" id="2022103">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022107">f</span><span class="op" id="2022108">.</span><span class="ident" id="2022109">buf</span><span class="op" id="2022112">.</span><span class="ident" id="2022113">WriteString</span><span class="op" id="2022124">(</span><span class="ident" id="2022125">s</span><span class="op" id="2022126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022130">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022141">padding</span><span class="op" id="2022148">,</span>&nbsp;<span class="ident" id="2022150">left</span><span class="op" id="2022154">,</span>&nbsp;<span class="ident" id="2022156">right</span>&nbsp;<span class="op" id="2022162">:=</span>&nbsp;<span class="ident" id="2022165">f</span><span class="op" id="2022166">.</span><span class="ident" id="2022167">computePadding</span><span class="op" id="2022181">(</span><span class="ident" id="2022182">utf8</span><span class="op" id="2022186">.</span><span class="ident" id="2022187">RuneCountInString</span><span class="op" id="2022204">(</span><span class="ident" id="2022205">s</span><span class="op" id="2022206">)</span><span class="op" id="2022207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022210">if</span>&nbsp;<span class="ident" id="2022213">left</span>&nbsp;<span class="op" id="2022218">&gt;</span>&nbsp;<span class="num" id="2022220">0</span>&nbsp;<span class="op" id="2022222">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022226">f</span><span class="op" id="2022227">.</span><span class="ident" id="2022228">writePadding</span><span class="op" id="2022240">(</span><span class="ident" id="2022241">left</span><span class="op" id="2022245">,</span>&nbsp;<span class="ident" id="2022247">padding</span><span class="op" id="2022254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022260">f</span><span class="op" id="2022261">.</span><span class="ident" id="2022262">buf</span><span class="op" id="2022265">.</span><span class="ident" id="2022266">WriteString</span><span class="op" id="2022277">(</span><span class="ident" id="2022278">s</span><span class="op" id="2022279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022282">if</span>&nbsp;<span class="ident" id="2022285">right</span>&nbsp;<span class="op" id="2022291">&gt;</span>&nbsp;<span class="num" id="2022293">0</span>&nbsp;<span class="op" id="2022295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022299">f</span><span class="op" id="2022300">.</span><span class="ident" id="2022301">writePadding</span><span class="op" id="2022313">(</span><span class="ident" id="2022314">right</span><span class="op" id="2022319">,</span>&nbsp;<span class="ident" id="2022321">padding</span><span class="op" id="2022328">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022331">}</span><br>
<span class="lineno"></span><span class="op" id="2022333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2022336">var</span>&nbsp;<span class="op" id="2022340">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022343">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2022354">=</span>&nbsp;<span class="op" id="2022356">[</span><span class="op" id="2022357">]</span><span class="builtintype" id="2022358">byte</span><span class="op" id="2022362">(</span><span class="string" id="2022363">&#34;true&#34;</span><span class="op" id="2022369">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022372">falseBytes</span>&nbsp;<span class="op" id="2022383">=</span>&nbsp;<span class="op" id="2022385">[</span><span class="op" id="2022386">]</span><span class="builtintype" id="2022387">byte</span><span class="op" id="2022391">(</span><span class="string" id="2022392">&#34;false&#34;</span><span class="op" id="2022399">)</span><br>
<span class="lineno"></span><span class="op" id="2022401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2022404">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2022438">func</span>&nbsp;<span class="op" id="2022443">(</span><span class="ident" id="2022444">f</span>&nbsp;<span class="op" id="2022446">*</span><span class="ident" id="2022447">fmt</span><span class="op" id="2022450">)</span>&nbsp;<span class="ident" id="2022452">fmt_boolean</span><span class="op" id="2022463">(</span><span class="ident" id="2022464">v</span>&nbsp;<span class="builtintype" id="2022466">bool</span><span class="op" id="2022470">)</span>&nbsp;<span class="op" id="2022472">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022475">if</span>&nbsp;<span class="ident" id="2022478">v</span>&nbsp;<span class="op" id="2022480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022484">f</span><span class="op" id="2022485">.</span><span class="ident" id="2022486">pad</span><span class="op" id="2022489">(</span><span class="ident" id="2022490">trueBytes</span><span class="op" id="2022499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022502">}</span>&nbsp;<span class="keyword" id="2022504">else</span>&nbsp;<span class="op" id="2022509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022513">f</span><span class="op" id="2022514">.</span><span class="ident" id="2022515">pad</span><span class="op" id="2022518">(</span><span class="ident" id="2022519">falseBytes</span><span class="op" id="2022529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022532">}</span><br>
<span class="lineno">155</span><span class="op" id="2022534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2022537">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2022619">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2022650">func</span>&nbsp;<span class="op" id="2022655">(</span><span class="ident" id="2022656">f</span>&nbsp;<span class="op" id="2022658">*</span><span class="ident" id="2022659">fmt</span><span class="op" id="2022662">)</span>&nbsp;<span class="ident" id="2022664">integer</span><span class="op" id="2022671">(</span><span class="ident" id="2022672">a</span>&nbsp;<span class="ident" id="2022674">int64</span><span class="op" id="2022679">,</span>&nbsp;<span class="ident" id="2022681">base</span>&nbsp;<span class="ident" id="2022686">uint64</span><span class="op" id="2022692">,</span>&nbsp;<span class="ident" id="2022694">signedness</span>&nbsp;<span class="builtintype" id="2022705">bool</span><span class="op" id="2022709">,</span>&nbsp;<span class="ident" id="2022711">digits</span>&nbsp;<span class="builtintype" id="2022718">string</span><span class="op" id="2022724">)</span>&nbsp;<span class="op" id="2022726">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2022729">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022785">if</span>&nbsp;<span class="ident" id="2022788">f</span><span class="op" id="2022789">.</span><span class="ident" id="2022790">precPresent</span>&nbsp;<span class="op" id="2022802">&amp;&amp;</span>&nbsp;<span class="ident" id="2022805">f</span><span class="op" id="2022806">.</span><span class="ident" id="2022807">prec</span>&nbsp;<span class="op" id="2022812">==</span>&nbsp;<span class="num" id="2022815">0</span>&nbsp;<span class="op" id="2022817">&amp;&amp;</span>&nbsp;<span class="ident" id="2022820">a</span>&nbsp;<span class="op" id="2022822">==</span>&nbsp;<span class="num" id="2022825">0</span>&nbsp;<span class="op" id="2022827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022831">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022843">var</span>&nbsp;<span class="ident" id="2022847">buf</span>&nbsp;<span class="op" id="2022851">[</span><span class="op" id="2022852">]</span><span class="builtintype" id="2022853">byte</span>&nbsp;<span class="op" id="2022858">=</span>&nbsp;<span class="ident" id="2022860">f</span><span class="op" id="2022861">.</span><span class="ident" id="2022862">intbuf</span><span class="op" id="2022868">[</span><span class="num" id="2022869">0</span><span class="op" id="2022870">:</span><span class="op" id="2022871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022874">if</span>&nbsp;<span class="ident" id="2022877">f</span><span class="op" id="2022878">.</span><span class="ident" id="2022879">widPresent</span>&nbsp;<span class="op" id="2022890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022894">width</span>&nbsp;<span class="op" id="2022900">:=</span>&nbsp;<span class="ident" id="2022903">f</span><span class="op" id="2022904">.</span><span class="ident" id="2022905">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022911">if</span>&nbsp;<span class="ident" id="2022914">base</span>&nbsp;<span class="op" id="2022919">==</span>&nbsp;<span class="num" id="2022922">16</span>&nbsp;<span class="op" id="2022925">&amp;&amp;</span>&nbsp;<span class="ident" id="2022928">f</span><span class="op" id="2022929">.</span><span class="ident" id="2022930">sharp</span>&nbsp;<span class="op" id="2022936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2022941">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2022963">width</span>&nbsp;<span class="op" id="2022969">+=</span>&nbsp;<span class="num" id="2022972">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2022976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2022980">if</span>&nbsp;<span class="ident" id="2022983">width</span>&nbsp;<span class="op" id="2022989">&gt;</span>&nbsp;<span class="ident" id="2022991">nByte</span>&nbsp;<span class="op" id="2022997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023002">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023043">buf</span>&nbsp;<span class="op" id="2023047">=</span>&nbsp;<span class="builtinfunc" id="2023049">make</span><span class="op" id="2023053">(</span><span class="op" id="2023054">[</span><span class="op" id="2023055">]</span><span class="builtintype" id="2023056">byte</span><span class="op" id="2023060">,</span>&nbsp;<span class="ident" id="2023062">width</span><span class="op" id="2023067">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2023071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2023074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023078">negative</span>&nbsp;<span class="op" id="2023087">:=</span>&nbsp;<span class="ident" id="2023090">signedness</span>&nbsp;<span class="op" id="2023101">==</span>&nbsp;<span class="ident" id="2023104">signed</span>&nbsp;<span class="op" id="2023111">&amp;&amp;</span>&nbsp;<span class="ident" id="2023114">a</span>&nbsp;<span class="op" id="2023116">&lt;</span>&nbsp;<span class="num" id="2023118">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2023121">if</span>&nbsp;<span class="ident" id="2023124">negative</span>&nbsp;<span class="op" id="2023133">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023137">a</span>&nbsp;<span class="op" id="2023139">=</span>&nbsp;<span class="op" id="2023141">-</span><span class="ident" id="2023142">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2023145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023149">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023214">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023259">prec</span>&nbsp;<span class="op" id="2023264">:=</span>&nbsp;<span class="num" id="2023267">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2023270">if</span>&nbsp;<span class="ident" id="2023273">f</span><span class="op" id="2023274">.</span><span class="ident" id="2023275">precPresent</span>&nbsp;<span class="op" id="2023287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023291">prec</span>&nbsp;<span class="op" id="2023296">=</span>&nbsp;<span class="ident" id="2023298">f</span><span class="op" id="2023299">.</span><span class="ident" id="2023300">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023307">f</span><span class="op" id="2023308">.</span><span class="ident" id="2023309">zero</span>&nbsp;<span class="op" id="2023314">=</span>&nbsp;<span class="builtintype" id="2023316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2023323">}</span>&nbsp;<span class="keyword" id="2023325">else</span>&nbsp;<span class="keyword" id="2023330">if</span>&nbsp;<span class="ident" id="2023333">f</span><span class="op" id="2023334">.</span><span class="ident" id="2023335">zero</span>&nbsp;<span class="op" id="2023340">&amp;&amp;</span>&nbsp;<span class="ident" id="2023343">f</span><span class="op" id="2023344">.</span><span class="ident" id="2023345">widPresent</span>&nbsp;<span class="op" id="2023356">&amp;&amp;</span>&nbsp;<span class="op" id="2023359">!</span><span class="ident" id="2023360">f</span><span class="op" id="2023361">.</span><span class="ident" id="2023362">minus</span>&nbsp;<span class="op" id="2023368">&amp;&amp;</span>&nbsp;<span class="ident" id="2023371">f</span><span class="op" id="2023372">.</span><span class="ident" id="2023373">wid</span>&nbsp;<span class="op" id="2023377">&gt;</span>&nbsp;<span class="num" id="2023379">0</span>&nbsp;<span class="op" id="2023381">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023385">prec</span>&nbsp;<span class="op" id="2023390">=</span>&nbsp;<span class="ident" id="2023392">f</span><span class="op" id="2023393">.</span><span class="ident" id="2023394">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2023400">if</span>&nbsp;<span class="ident" id="2023403">negative</span>&nbsp;<span class="op" id="2023412">||</span>&nbsp;<span class="ident" id="2023415">f</span><span class="op" id="2023416">.</span><span class="ident" id="2023417">plus</span>&nbsp;<span class="op" id="2023422">||</span>&nbsp;<span class="ident" id="2023425">f</span><span class="op" id="2023426">.</span><span class="ident" id="2023427">space</span>&nbsp;<span class="op" id="2023433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023438">prec</span><span class="op" id="2023442">--</span>&nbsp;<span class="comment" id="2023445">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2023470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2023473">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023477">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023555">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023609">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023680">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023745">i</span>&nbsp;<span class="op" id="2023747">:=</span>&nbsp;<span class="builtinfunc" id="2023750">len</span><span class="op" id="2023753">(</span><span class="ident" id="2023754">buf</span><span class="op" id="2023757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023760">ua</span>&nbsp;<span class="op" id="2023763">:=</span>&nbsp;<span class="ident" id="2023766">uint64</span><span class="op" id="2023772">(</span><span class="ident" id="2023773">a</span><span class="op" id="2023774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023777">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2023848">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2023888">switch</span>&nbsp;<span class="ident" id="2023895">base</span>&nbsp;<span class="op" id="2023900">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2023903">case</span>&nbsp;<span class="num" id="2023908">10</span><span class="op" id="2023910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2023914">for</span>&nbsp;<span class="ident" id="2023918">ua</span>&nbsp;<span class="op" id="2023921">&gt;=</span>&nbsp;<span class="num" id="2023924">10</span>&nbsp;<span class="op" id="2023927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023932">i</span><span class="op" id="2023933">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023939">next</span>&nbsp;<span class="op" id="2023944">:=</span>&nbsp;<span class="ident" id="2023947">ua</span>&nbsp;<span class="op" id="2023950">/</span>&nbsp;<span class="num" id="2023952">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023958">buf</span><span class="op" id="2023961">[</span><span class="ident" id="2023962">i</span><span class="op" id="2023963">]</span>&nbsp;<span class="op" id="2023965">=</span>&nbsp;<span class="builtintype" id="2023967">byte</span><span class="op" id="2023971">(</span><span class="string" id="2023972">&#39;0&#39;</span>&nbsp;<span class="op" id="2023976">+</span>&nbsp;<span class="ident" id="2023978">ua</span>&nbsp;<span class="op" id="2023981">-</span>&nbsp;<span class="ident" id="2023983">next</span><span class="op" id="2023987">*</span><span class="num" id="2023988">10</span><span class="op" id="2023990">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2023995">ua</span>&nbsp;<span class="op" id="2023998">=</span>&nbsp;<span class="ident" id="2024000">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024010">case</span>&nbsp;<span class="num" id="2024015">16</span><span class="op" id="2024017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024021">for</span>&nbsp;<span class="ident" id="2024025">ua</span>&nbsp;<span class="op" id="2024028">&gt;=</span>&nbsp;<span class="num" id="2024031">16</span>&nbsp;<span class="op" id="2024034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024039">i</span><span class="op" id="2024040">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024046">buf</span><span class="op" id="2024049">[</span><span class="ident" id="2024050">i</span><span class="op" id="2024051">]</span>&nbsp;<span class="op" id="2024053">=</span>&nbsp;<span class="ident" id="2024055">digits</span><span class="op" id="2024061">[</span><span class="ident" id="2024062">ua</span><span class="op" id="2024064">&amp;</span><span class="num" id="2024065">0xF</span><span class="op" id="2024068">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024073">ua</span>&nbsp;<span class="op" id="2024076">&gt;&gt;=</span>&nbsp;<span class="num" id="2024080">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024087">case</span>&nbsp;<span class="num" id="2024092">8</span><span class="op" id="2024093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024097">for</span>&nbsp;<span class="ident" id="2024101">ua</span>&nbsp;<span class="op" id="2024104">&gt;=</span>&nbsp;<span class="num" id="2024107">8</span>&nbsp;<span class="op" id="2024109">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024114">i</span><span class="op" id="2024115">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024121">buf</span><span class="op" id="2024124">[</span><span class="ident" id="2024125">i</span><span class="op" id="2024126">]</span>&nbsp;<span class="op" id="2024128">=</span>&nbsp;<span class="builtintype" id="2024130">byte</span><span class="op" id="2024134">(</span><span class="string" id="2024135">&#39;0&#39;</span>&nbsp;<span class="op" id="2024139">+</span>&nbsp;<span class="ident" id="2024141">ua</span><span class="op" id="2024143">&amp;</span><span class="num" id="2024144">7</span><span class="op" id="2024145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024150">ua</span>&nbsp;<span class="op" id="2024153">&gt;&gt;=</span>&nbsp;<span class="num" id="2024157">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024164">case</span>&nbsp;<span class="num" id="2024169">2</span><span class="op" id="2024170">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024174">for</span>&nbsp;<span class="ident" id="2024178">ua</span>&nbsp;<span class="op" id="2024181">&gt;=</span>&nbsp;<span class="num" id="2024184">2</span>&nbsp;<span class="op" id="2024186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024191">i</span><span class="op" id="2024192">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024198">buf</span><span class="op" id="2024201">[</span><span class="ident" id="2024202">i</span><span class="op" id="2024203">]</span>&nbsp;<span class="op" id="2024205">=</span>&nbsp;<span class="builtintype" id="2024207">byte</span><span class="op" id="2024211">(</span><span class="string" id="2024212">&#39;0&#39;</span>&nbsp;<span class="op" id="2024216">+</span>&nbsp;<span class="ident" id="2024218">ua</span><span class="op" id="2024220">&amp;</span><span class="num" id="2024221">1</span><span class="op" id="2024222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024227">ua</span>&nbsp;<span class="op" id="2024230">&gt;&gt;=</span>&nbsp;<span class="num" id="2024234">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024238">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024241">default</span><span class="op" id="2024248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2024252">panic</span><span class="op" id="2024257">(</span><span class="string" id="2024258">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2024291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024297">i</span><span class="op" id="2024298">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024302">buf</span><span class="op" id="2024305">[</span><span class="ident" id="2024306">i</span><span class="op" id="2024307">]</span>&nbsp;<span class="op" id="2024309">=</span>&nbsp;<span class="ident" id="2024311">digits</span><span class="op" id="2024317">[</span><span class="ident" id="2024318">ua</span><span class="op" id="2024320">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024323">for</span>&nbsp;<span class="ident" id="2024327">i</span>&nbsp;<span class="op" id="2024329">&gt;</span>&nbsp;<span class="num" id="2024331">0</span>&nbsp;<span class="op" id="2024333">&amp;&amp;</span>&nbsp;<span class="ident" id="2024336">prec</span>&nbsp;<span class="op" id="2024341">&gt;</span>&nbsp;<span class="builtinfunc" id="2024343">len</span><span class="op" id="2024346">(</span><span class="ident" id="2024347">buf</span><span class="op" id="2024350">)</span><span class="op" id="2024351">-</span><span class="ident" id="2024352">i</span>&nbsp;<span class="op" id="2024354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024358">i</span><span class="op" id="2024359">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024364">buf</span><span class="op" id="2024367">[</span><span class="ident" id="2024368">i</span><span class="op" id="2024369">]</span>&nbsp;<span class="op" id="2024371">=</span>&nbsp;<span class="string" id="2024373">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2024382">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024416">if</span>&nbsp;<span class="ident" id="2024419">f</span><span class="op" id="2024420">.</span><span class="ident" id="2024421">sharp</span>&nbsp;<span class="op" id="2024427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024431">switch</span>&nbsp;<span class="ident" id="2024438">base</span>&nbsp;<span class="op" id="2024443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024447">case</span>&nbsp;<span class="num" id="2024452">8</span><span class="op" id="2024453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024458">if</span>&nbsp;<span class="ident" id="2024461">buf</span><span class="op" id="2024464">[</span><span class="ident" id="2024465">i</span><span class="op" id="2024466">]</span>&nbsp;<span class="op" id="2024468">!=</span>&nbsp;<span class="string" id="2024471">&#39;0&#39;</span>&nbsp;<span class="op" id="2024475">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024481">i</span><span class="op" id="2024482">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024489">buf</span><span class="op" id="2024492">[</span><span class="ident" id="2024493">i</span><span class="op" id="2024494">]</span>&nbsp;<span class="op" id="2024496">=</span>&nbsp;<span class="string" id="2024498">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024509">case</span>&nbsp;<span class="num" id="2024514">16</span><span class="op" id="2024516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024521">i</span><span class="op" id="2024522">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024528">buf</span><span class="op" id="2024531">[</span><span class="ident" id="2024532">i</span><span class="op" id="2024533">]</span>&nbsp;<span class="op" id="2024535">=</span>&nbsp;<span class="string" id="2024537">&#39;x&#39;</span>&nbsp;<span class="op" id="2024541">+</span>&nbsp;<span class="ident" id="2024543">digits</span><span class="op" id="2024549">[</span><span class="num" id="2024550">10</span><span class="op" id="2024552">]</span>&nbsp;<span class="op" id="2024554">-</span>&nbsp;<span class="string" id="2024556">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024563">i</span><span class="op" id="2024564">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024570">buf</span><span class="op" id="2024573">[</span><span class="ident" id="2024574">i</span><span class="op" id="2024575">]</span>&nbsp;<span class="op" id="2024577">=</span>&nbsp;<span class="string" id="2024579">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024588">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024591">if</span>&nbsp;<span class="ident" id="2024594">f</span><span class="op" id="2024595">.</span><span class="ident" id="2024596">unicode</span>&nbsp;<span class="op" id="2024604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024608">i</span><span class="op" id="2024609">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024614">buf</span><span class="op" id="2024617">[</span><span class="ident" id="2024618">i</span><span class="op" id="2024619">]</span>&nbsp;<span class="op" id="2024621">=</span>&nbsp;<span class="string" id="2024623">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024629">i</span><span class="op" id="2024630">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024635">buf</span><span class="op" id="2024638">[</span><span class="ident" id="2024639">i</span><span class="op" id="2024640">]</span>&nbsp;<span class="op" id="2024642">=</span>&nbsp;<span class="string" id="2024644">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024653">if</span>&nbsp;<span class="ident" id="2024656">negative</span>&nbsp;<span class="op" id="2024665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024669">i</span><span class="op" id="2024670">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024675">buf</span><span class="op" id="2024678">[</span><span class="ident" id="2024679">i</span><span class="op" id="2024680">]</span>&nbsp;<span class="op" id="2024682">=</span>&nbsp;<span class="string" id="2024684">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024689">}</span>&nbsp;<span class="keyword" id="2024691">else</span>&nbsp;<span class="keyword" id="2024696">if</span>&nbsp;<span class="ident" id="2024699">f</span><span class="op" id="2024700">.</span><span class="ident" id="2024701">plus</span>&nbsp;<span class="op" id="2024706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024710">i</span><span class="op" id="2024711">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024716">buf</span><span class="op" id="2024719">[</span><span class="ident" id="2024720">i</span><span class="op" id="2024721">]</span>&nbsp;<span class="op" id="2024723">=</span>&nbsp;<span class="string" id="2024725">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024730">}</span>&nbsp;<span class="keyword" id="2024732">else</span>&nbsp;<span class="keyword" id="2024737">if</span>&nbsp;<span class="ident" id="2024740">f</span><span class="op" id="2024741">.</span><span class="ident" id="2024742">space</span>&nbsp;<span class="op" id="2024748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024752">i</span><span class="op" id="2024753">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024758">buf</span><span class="op" id="2024761">[</span><span class="ident" id="2024762">i</span><span class="op" id="2024763">]</span>&nbsp;<span class="op" id="2024765">=</span>&nbsp;<span class="string" id="2024767">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2024772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2024776">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2024845">if</span>&nbsp;<span class="ident" id="2024848">f</span><span class="op" id="2024849">.</span><span class="ident" id="2024850">unicode</span>&nbsp;<span class="op" id="2024858">&amp;&amp;</span>&nbsp;<span class="ident" id="2024861">f</span><span class="op" id="2024862">.</span><span class="ident" id="2024863">uniQuote</span>&nbsp;<span class="op" id="2024872">&amp;&amp;</span>&nbsp;<span class="ident" id="2024875">a</span>&nbsp;<span class="op" id="2024877">&gt;=</span>&nbsp;<span class="num" id="2024880">0</span>&nbsp;<span class="op" id="2024882">&amp;&amp;</span>&nbsp;<span class="ident" id="2024885">a</span>&nbsp;<span class="op" id="2024887">&lt;=</span>&nbsp;<span class="ident" id="2024890">utf8</span><span class="op" id="2024894">.</span><span class="ident" id="2024895">MaxRune</span>&nbsp;<span class="op" id="2024903">&amp;&amp;</span>&nbsp;<span class="ident" id="2024906">strconv</span><span class="op" id="2024913">.</span><span class="ident" id="2024914">IsPrint</span><span class="op" id="2024921">(</span><span class="builtintype" id="2024922">rune</span><span class="op" id="2024926">(</span><span class="ident" id="2024927">a</span><span class="op" id="2024928">)</span><span class="op" id="2024929">)</span>&nbsp;<span class="op" id="2024931">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024935">runeWidth</span>&nbsp;<span class="op" id="2024945">:=</span>&nbsp;<span class="ident" id="2024948">utf8</span><span class="op" id="2024952">.</span><span class="ident" id="2024953">RuneLen</span><span class="op" id="2024960">(</span><span class="builtintype" id="2024961">rune</span><span class="op" id="2024965">(</span><span class="ident" id="2024966">a</span><span class="op" id="2024967">)</span><span class="op" id="2024968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024972">width</span>&nbsp;<span class="op" id="2024978">:=</span>&nbsp;<span class="num" id="2024981">1</span>&nbsp;<span class="op" id="2024983">+</span>&nbsp;<span class="num" id="2024985">1</span>&nbsp;<span class="op" id="2024987">+</span>&nbsp;<span class="ident" id="2024989">runeWidth</span>&nbsp;<span class="op" id="2024999">+</span>&nbsp;<span class="num" id="2025001">1</span>&nbsp;<span class="comment" id="2025003">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2025034">copy</span><span class="op" id="2025038">(</span><span class="ident" id="2025039">buf</span><span class="op" id="2025042">[</span><span class="ident" id="2025043">i</span><span class="op" id="2025044">-</span><span class="ident" id="2025045">width</span><span class="op" id="2025050">:</span><span class="op" id="2025051">]</span><span class="op" id="2025052">,</span>&nbsp;<span class="ident" id="2025054">buf</span><span class="op" id="2025057">[</span><span class="ident" id="2025058">i</span><span class="op" id="2025059">:</span><span class="op" id="2025060">]</span><span class="op" id="2025061">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2025065">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025102">i</span>&nbsp;<span class="op" id="2025104">-=</span>&nbsp;<span class="ident" id="2025107">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2025115">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025147">j</span>&nbsp;<span class="op" id="2025149">:=</span>&nbsp;<span class="builtinfunc" id="2025152">len</span><span class="op" id="2025155">(</span><span class="ident" id="2025156">buf</span><span class="op" id="2025159">)</span>&nbsp;<span class="op" id="2025161">-</span>&nbsp;<span class="ident" id="2025163">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025171">buf</span><span class="op" id="2025174">[</span><span class="ident" id="2025175">j</span><span class="op" id="2025176">]</span>&nbsp;<span class="op" id="2025178">=</span>&nbsp;<span class="string" id="2025180">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025186">j</span><span class="op" id="2025187">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025192">buf</span><span class="op" id="2025195">[</span><span class="ident" id="2025196">j</span><span class="op" id="2025197">]</span>&nbsp;<span class="op" id="2025199">=</span>&nbsp;<span class="string" id="2025201">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025208">j</span><span class="op" id="2025209">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025214">utf8</span><span class="op" id="2025218">.</span><span class="ident" id="2025219">EncodeRune</span><span class="op" id="2025229">(</span><span class="ident" id="2025230">buf</span><span class="op" id="2025233">[</span><span class="ident" id="2025234">j</span><span class="op" id="2025235">:</span><span class="op" id="2025236">]</span><span class="op" id="2025237">,</span>&nbsp;<span class="builtintype" id="2025239">rune</span><span class="op" id="2025243">(</span><span class="ident" id="2025244">a</span><span class="op" id="2025245">)</span><span class="op" id="2025246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025250">j</span>&nbsp;<span class="op" id="2025252">+=</span>&nbsp;<span class="ident" id="2025255">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025267">buf</span><span class="op" id="2025270">[</span><span class="ident" id="2025271">j</span><span class="op" id="2025272">]</span>&nbsp;<span class="op" id="2025274">=</span>&nbsp;<span class="string" id="2025276">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2025282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025286">f</span><span class="op" id="2025287">.</span><span class="ident" id="2025288">pad</span><span class="op" id="2025291">(</span><span class="ident" id="2025292">buf</span><span class="op" id="2025295">[</span><span class="ident" id="2025296">i</span><span class="op" id="2025297">:</span><span class="op" id="2025298">]</span><span class="op" id="2025299">)</span><br>
<span class="lineno"></span><span class="op" id="2025301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025304">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2025377">func</span>&nbsp;<span class="op" id="2025382">(</span><span class="ident" id="2025383">f</span>&nbsp;<span class="op" id="2025385">*</span><span class="ident" id="2025386">fmt</span><span class="op" id="2025389">)</span>&nbsp;<span class="ident" id="2025391">truncate</span><span class="op" id="2025399">(</span><span class="ident" id="2025400">s</span>&nbsp;<span class="builtintype" id="2025402">string</span><span class="op" id="2025408">)</span>&nbsp;<span class="builtintype" id="2025410">string</span>&nbsp;<span class="op" id="2025417">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025420">if</span>&nbsp;<span class="ident" id="2025423">f</span><span class="op" id="2025424">.</span><span class="ident" id="2025425">precPresent</span>&nbsp;<span class="op" id="2025437">&amp;&amp;</span>&nbsp;<span class="ident" id="2025440">f</span><span class="op" id="2025441">.</span><span class="ident" id="2025442">prec</span>&nbsp;<span class="op" id="2025447">&lt;</span>&nbsp;<span class="ident" id="2025449">utf8</span><span class="op" id="2025453">.</span><span class="ident" id="2025454">RuneCountInString</span><span class="op" id="2025471">(</span><span class="ident" id="2025472">s</span><span class="op" id="2025473">)</span>&nbsp;<span class="op" id="2025475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025479">n</span>&nbsp;<span class="op" id="2025481">:=</span>&nbsp;<span class="ident" id="2025484">f</span><span class="op" id="2025485">.</span><span class="ident" id="2025486">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025493">for</span>&nbsp;<span class="ident" id="2025497">i</span>&nbsp;<span class="op" id="2025499">:=</span>&nbsp;<span class="keyword" id="2025502">range</span>&nbsp;<span class="ident" id="2025508">s</span>&nbsp;<span class="op" id="2025510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025515">if</span>&nbsp;<span class="ident" id="2025518">n</span>&nbsp;<span class="op" id="2025520">==</span>&nbsp;<span class="num" id="2025523">0</span>&nbsp;<span class="op" id="2025525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025531">s</span>&nbsp;<span class="op" id="2025533">=</span>&nbsp;<span class="ident" id="2025535">s</span><span class="op" id="2025536">[</span><span class="op" id="2025537">:</span><span class="ident" id="2025538">i</span><span class="op" id="2025539">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025545">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2025554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025559">n</span><span class="op" id="2025560">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2025565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2025568">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025571">return</span>&nbsp;<span class="ident" id="2025578">s</span><br>
<span class="lineno"></span><span class="op" id="2025580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025583">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2025610">func</span>&nbsp;<span class="op" id="2025615">(</span><span class="ident" id="2025616">f</span>&nbsp;<span class="op" id="2025618">*</span><span class="ident" id="2025619">fmt</span><span class="op" id="2025622">)</span>&nbsp;<span class="ident" id="2025624">fmt_s</span><span class="op" id="2025629">(</span><span class="ident" id="2025630">s</span>&nbsp;<span class="builtintype" id="2025632">string</span><span class="op" id="2025638">)</span>&nbsp;<span class="op" id="2025640">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025643">s</span>&nbsp;<span class="op" id="2025645">=</span>&nbsp;<span class="ident" id="2025647">f</span><span class="op" id="2025648">.</span><span class="ident" id="2025649">truncate</span><span class="op" id="2025657">(</span><span class="ident" id="2025658">s</span><span class="op" id="2025659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025662">f</span><span class="op" id="2025663">.</span><span class="ident" id="2025664">padString</span><span class="op" id="2025673">(</span><span class="ident" id="2025674">s</span><span class="op" id="2025675">)</span><br>
<span class="lineno"></span><span class="op" id="2025677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025680">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2025762">func</span>&nbsp;<span class="op" id="2025767">(</span><span class="ident" id="2025768">f</span>&nbsp;<span class="op" id="2025770">*</span><span class="ident" id="2025771">fmt</span><span class="op" id="2025774">)</span>&nbsp;<span class="ident" id="2025776">fmt_sbx</span><span class="op" id="2025783">(</span><span class="ident" id="2025784">s</span>&nbsp;<span class="builtintype" id="2025786">string</span><span class="op" id="2025792">,</span>&nbsp;<span class="ident" id="2025794">b</span>&nbsp;<span class="op" id="2025796">[</span><span class="op" id="2025797">]</span><span class="builtintype" id="2025798">byte</span><span class="op" id="2025802">,</span>&nbsp;<span class="ident" id="2025804">digits</span>&nbsp;<span class="builtintype" id="2025811">string</span><span class="op" id="2025817">)</span>&nbsp;<span class="op" id="2025819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025822">n</span>&nbsp;<span class="op" id="2025824">:=</span>&nbsp;<span class="builtinfunc" id="2025827">len</span><span class="op" id="2025830">(</span><span class="ident" id="2025831">b</span><span class="op" id="2025832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025835">if</span>&nbsp;<span class="ident" id="2025838">b</span>&nbsp;<span class="op" id="2025840">==</span>&nbsp;<span class="builtintype" id="2025843">nil</span>&nbsp;<span class="op" id="2025847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025851">n</span>&nbsp;<span class="op" id="2025853">=</span>&nbsp;<span class="builtinfunc" id="2025855">len</span><span class="op" id="2025858">(</span><span class="ident" id="2025859">s</span><span class="op" id="2025860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2025863">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025866">x</span>&nbsp;<span class="op" id="2025868">:=</span>&nbsp;<span class="ident" id="2025871">digits</span><span class="op" id="2025877">[</span><span class="num" id="2025878">10</span><span class="op" id="2025880">]</span>&nbsp;<span class="op" id="2025882">-</span>&nbsp;<span class="string" id="2025884">&#39;a&#39;</span>&nbsp;<span class="op" id="2025888">+</span>&nbsp;<span class="string" id="2025890">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2025895">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025934">var</span>&nbsp;<span class="ident" id="2025938">buf</span>&nbsp;<span class="op" id="2025942">[</span><span class="op" id="2025943">]</span><span class="builtintype" id="2025944">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025950">for</span>&nbsp;<span class="ident" id="2025954">i</span>&nbsp;<span class="op" id="2025956">:=</span>&nbsp;<span class="num" id="2025959">0</span><span class="op" id="2025960">;</span>&nbsp;<span class="ident" id="2025962">i</span>&nbsp;<span class="op" id="2025964">&lt;</span>&nbsp;<span class="ident" id="2025966">n</span><span class="op" id="2025967">;</span>&nbsp;<span class="ident" id="2025969">i</span><span class="op" id="2025970">++</span>&nbsp;<span class="op" id="2025973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2025977">if</span>&nbsp;<span class="ident" id="2025980">i</span>&nbsp;<span class="op" id="2025982">&gt;</span>&nbsp;<span class="num" id="2025984">0</span>&nbsp;<span class="op" id="2025986">&amp;&amp;</span>&nbsp;<span class="ident" id="2025989">f</span><span class="op" id="2025990">.</span><span class="ident" id="2025991">space</span>&nbsp;<span class="op" id="2025997">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026002">buf</span>&nbsp;<span class="op" id="2026006">=</span>&nbsp;<span class="builtinfunc" id="2026008">append</span><span class="op" id="2026014">(</span><span class="ident" id="2026015">buf</span><span class="op" id="2026018">,</span>&nbsp;<span class="string" id="2026020">&#39;&nbsp;&#39;</span><span class="op" id="2026023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026031">if</span>&nbsp;<span class="ident" id="2026034">f</span><span class="op" id="2026035">.</span><span class="ident" id="2026036">sharp</span>&nbsp;<span class="op" id="2026042">&amp;&amp;</span>&nbsp;<span class="op" id="2026045">(</span><span class="ident" id="2026046">f</span><span class="op" id="2026047">.</span><span class="ident" id="2026048">space</span>&nbsp;<span class="op" id="2026054">||</span>&nbsp;<span class="ident" id="2026057">i</span>&nbsp;<span class="op" id="2026059">==</span>&nbsp;<span class="num" id="2026062">0</span><span class="op" id="2026063">)</span>&nbsp;<span class="op" id="2026065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026070">buf</span>&nbsp;<span class="op" id="2026074">=</span>&nbsp;<span class="builtinfunc" id="2026076">append</span><span class="op" id="2026082">(</span><span class="ident" id="2026083">buf</span><span class="op" id="2026086">,</span>&nbsp;<span class="string" id="2026088">&#39;0&#39;</span><span class="op" id="2026091">,</span>&nbsp;<span class="ident" id="2026093">x</span><span class="op" id="2026094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026098">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026102">var</span>&nbsp;<span class="ident" id="2026106">c</span>&nbsp;<span class="builtintype" id="2026108">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026115">if</span>&nbsp;<span class="ident" id="2026118">b</span>&nbsp;<span class="op" id="2026120">==</span>&nbsp;<span class="builtintype" id="2026123">nil</span>&nbsp;<span class="op" id="2026127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026132">c</span>&nbsp;<span class="op" id="2026134">=</span>&nbsp;<span class="ident" id="2026136">s</span><span class="op" id="2026137">[</span><span class="ident" id="2026138">i</span><span class="op" id="2026139">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026143">}</span>&nbsp;<span class="keyword" id="2026145">else</span>&nbsp;<span class="op" id="2026150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026155">c</span>&nbsp;<span class="op" id="2026157">=</span>&nbsp;<span class="ident" id="2026159">b</span><span class="op" id="2026160">[</span><span class="ident" id="2026161">i</span><span class="op" id="2026162">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026170">buf</span>&nbsp;<span class="op" id="2026174">=</span>&nbsp;<span class="builtinfunc" id="2026176">append</span><span class="op" id="2026182">(</span><span class="ident" id="2026183">buf</span><span class="op" id="2026186">,</span>&nbsp;<span class="ident" id="2026188">digits</span><span class="op" id="2026194">[</span><span class="ident" id="2026195">c</span><span class="op" id="2026196">&gt;&gt;</span><span class="num" id="2026198">4</span><span class="op" id="2026199">]</span><span class="op" id="2026200">,</span>&nbsp;<span class="ident" id="2026202">digits</span><span class="op" id="2026208">[</span><span class="ident" id="2026209">c</span><span class="op" id="2026210">&amp;</span><span class="num" id="2026211">0xF</span><span class="op" id="2026214">]</span><span class="op" id="2026215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026221">f</span><span class="op" id="2026222">.</span><span class="ident" id="2026223">pad</span><span class="op" id="2026226">(</span><span class="ident" id="2026227">buf</span><span class="op" id="2026230">)</span><br>
<span class="lineno"></span><span class="op" id="2026232">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2026235">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2026302">func</span>&nbsp;<span class="op" id="2026307">(</span><span class="ident" id="2026308">f</span>&nbsp;<span class="op" id="2026310">*</span><span class="ident" id="2026311">fmt</span><span class="op" id="2026314">)</span>&nbsp;<span class="ident" id="2026316">fmt_sx</span><span class="op" id="2026322">(</span><span class="ident" id="2026323">s</span><span class="op" id="2026324">,</span>&nbsp;<span class="ident" id="2026326">digits</span>&nbsp;<span class="builtintype" id="2026333">string</span><span class="op" id="2026339">)</span>&nbsp;<span class="op" id="2026341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026344">if</span>&nbsp;<span class="ident" id="2026347">f</span><span class="op" id="2026348">.</span><span class="ident" id="2026349">precPresent</span>&nbsp;<span class="op" id="2026361">&amp;&amp;</span>&nbsp;<span class="ident" id="2026364">f</span><span class="op" id="2026365">.</span><span class="ident" id="2026366">prec</span>&nbsp;<span class="op" id="2026371">&lt;</span>&nbsp;<span class="builtinfunc" id="2026373">len</span><span class="op" id="2026376">(</span><span class="ident" id="2026377">s</span><span class="op" id="2026378">)</span>&nbsp;<span class="op" id="2026380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026384">s</span>&nbsp;<span class="op" id="2026386">=</span>&nbsp;<span class="ident" id="2026388">s</span><span class="op" id="2026389">[</span><span class="op" id="2026390">:</span><span class="ident" id="2026391">f</span><span class="op" id="2026392">.</span><span class="ident" id="2026393">prec</span><span class="op" id="2026397">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026403">f</span><span class="op" id="2026404">.</span><span class="ident" id="2026405">fmt_sbx</span><span class="op" id="2026412">(</span><span class="ident" id="2026413">s</span><span class="op" id="2026414">,</span>&nbsp;<span class="builtintype" id="2026416">nil</span><span class="op" id="2026419">,</span>&nbsp;<span class="ident" id="2026421">digits</span><span class="op" id="2026427">)</span><br>
<span class="lineno"></span><span class="op" id="2026429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026432">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2026503">func</span>&nbsp;<span class="op" id="2026508">(</span><span class="ident" id="2026509">f</span>&nbsp;<span class="op" id="2026511">*</span><span class="ident" id="2026512">fmt</span><span class="op" id="2026515">)</span>&nbsp;<span class="ident" id="2026517">fmt_bx</span><span class="op" id="2026523">(</span><span class="ident" id="2026524">b</span>&nbsp;<span class="op" id="2026526">[</span><span class="op" id="2026527">]</span><span class="builtintype" id="2026528">byte</span><span class="op" id="2026532">,</span>&nbsp;<span class="ident" id="2026534">digits</span>&nbsp;<span class="builtintype" id="2026541">string</span><span class="op" id="2026547">)</span>&nbsp;<span class="op" id="2026549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026552">if</span>&nbsp;<span class="ident" id="2026555">f</span><span class="op" id="2026556">.</span><span class="ident" id="2026557">precPresent</span>&nbsp;<span class="op" id="2026569">&amp;&amp;</span>&nbsp;<span class="ident" id="2026572">f</span><span class="op" id="2026573">.</span><span class="ident" id="2026574">prec</span>&nbsp;<span class="op" id="2026579">&lt;</span>&nbsp;<span class="builtinfunc" id="2026581">len</span><span class="op" id="2026584">(</span><span class="ident" id="2026585">b</span><span class="op" id="2026586">)</span>&nbsp;<span class="op" id="2026588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026592">b</span>&nbsp;<span class="op" id="2026594">=</span>&nbsp;<span class="ident" id="2026596">b</span><span class="op" id="2026597">[</span><span class="op" id="2026598">:</span><span class="ident" id="2026599">f</span><span class="op" id="2026600">.</span><span class="ident" id="2026601">prec</span><span class="op" id="2026605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026611">f</span><span class="op" id="2026612">.</span><span class="ident" id="2026613">fmt_sbx</span><span class="op" id="2026620">(</span><span class="string" id="2026621">&#34;&#34;</span><span class="op" id="2026623">,</span>&nbsp;<span class="ident" id="2026625">b</span><span class="op" id="2026626">,</span>&nbsp;<span class="ident" id="2026628">digits</span><span class="op" id="2026634">)</span><br>
<span class="lineno">355</span><span class="op" id="2026636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026639">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2026713">func</span>&nbsp;<span class="op" id="2026718">(</span><span class="ident" id="2026719">f</span>&nbsp;<span class="op" id="2026721">*</span><span class="ident" id="2026722">fmt</span><span class="op" id="2026725">)</span>&nbsp;<span class="ident" id="2026727">fmt_q</span><span class="op" id="2026732">(</span><span class="ident" id="2026733">s</span>&nbsp;<span class="builtintype" id="2026735">string</span><span class="op" id="2026741">)</span>&nbsp;<span class="op" id="2026743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026746">s</span>&nbsp;<span class="op" id="2026748">=</span>&nbsp;<span class="ident" id="2026750">f</span><span class="op" id="2026751">.</span><span class="ident" id="2026752">truncate</span><span class="op" id="2026760">(</span><span class="ident" id="2026761">s</span><span class="op" id="2026762">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026765">var</span>&nbsp;<span class="ident" id="2026769">quoted</span>&nbsp;<span class="builtintype" id="2026776">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026784">if</span>&nbsp;<span class="ident" id="2026787">f</span><span class="op" id="2026788">.</span><span class="ident" id="2026789">sharp</span>&nbsp;<span class="op" id="2026795">&amp;&amp;</span>&nbsp;<span class="ident" id="2026798">strconv</span><span class="op" id="2026805">.</span><span class="ident" id="2026806">CanBackquote</span><span class="op" id="2026818">(</span><span class="ident" id="2026819">s</span><span class="op" id="2026820">)</span>&nbsp;<span class="op" id="2026822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026826">quoted</span>&nbsp;<span class="op" id="2026833">=</span>&nbsp;<span class="string" id="2026835">&#34;`&#34;</span>&nbsp;<span class="op" id="2026839">+</span>&nbsp;<span class="ident" id="2026841">s</span>&nbsp;<span class="op" id="2026843">+</span>&nbsp;<span class="string" id="2026845">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026850">}</span>&nbsp;<span class="keyword" id="2026852">else</span>&nbsp;<span class="op" id="2026857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026861">if</span>&nbsp;<span class="ident" id="2026864">f</span><span class="op" id="2026865">.</span><span class="ident" id="2026866">plus</span>&nbsp;<span class="op" id="2026871">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026876">quoted</span>&nbsp;<span class="op" id="2026883">=</span>&nbsp;<span class="ident" id="2026885">strconv</span><span class="op" id="2026892">.</span><span class="ident" id="2026893">QuoteToASCII</span><span class="op" id="2026905">(</span><span class="ident" id="2026906">s</span><span class="op" id="2026907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026911">}</span>&nbsp;<span class="keyword" id="2026913">else</span>&nbsp;<span class="op" id="2026918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026923">quoted</span>&nbsp;<span class="op" id="2026930">=</span>&nbsp;<span class="ident" id="2026932">strconv</span><span class="op" id="2026939">.</span><span class="ident" id="2026940">Quote</span><span class="op" id="2026945">(</span><span class="ident" id="2026946">s</span><span class="op" id="2026947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026954">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026957">f</span><span class="op" id="2026958">.</span><span class="ident" id="2026959">padString</span><span class="op" id="2026968">(</span><span class="ident" id="2026969">quoted</span><span class="op" id="2026975">)</span><br>
<span class="lineno"></span><span class="op" id="2026977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2026980">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2027061">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2027127">func</span>&nbsp;<span class="op" id="2027132">(</span><span class="ident" id="2027133">f</span>&nbsp;<span class="op" id="2027135">*</span><span class="ident" id="2027136">fmt</span><span class="op" id="2027139">)</span>&nbsp;<span class="ident" id="2027141">fmt_qc</span><span class="op" id="2027147">(</span><span class="ident" id="2027148">c</span>&nbsp;<span class="ident" id="2027150">int64</span><span class="op" id="2027155">)</span>&nbsp;<span class="op" id="2027157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027160">var</span>&nbsp;<span class="ident" id="2027164">quoted</span>&nbsp;<span class="op" id="2027171">[</span><span class="op" id="2027172">]</span><span class="builtintype" id="2027173">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027179">if</span>&nbsp;<span class="ident" id="2027182">f</span><span class="op" id="2027183">.</span><span class="ident" id="2027184">plus</span>&nbsp;<span class="op" id="2027189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027193">quoted</span>&nbsp;<span class="op" id="2027200">=</span>&nbsp;<span class="ident" id="2027202">strconv</span><span class="op" id="2027209">.</span><span class="ident" id="2027210">AppendQuoteRuneToASCII</span><span class="op" id="2027232">(</span><span class="ident" id="2027233">f</span><span class="op" id="2027234">.</span><span class="ident" id="2027235">intbuf</span><span class="op" id="2027241">[</span><span class="num" id="2027242">0</span><span class="op" id="2027243">:</span><span class="num" id="2027244">0</span><span class="op" id="2027245">]</span><span class="op" id="2027246">,</span>&nbsp;<span class="builtintype" id="2027248">rune</span><span class="op" id="2027252">(</span><span class="ident" id="2027253">c</span><span class="op" id="2027254">)</span><span class="op" id="2027255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027258">}</span>&nbsp;<span class="keyword" id="2027260">else</span>&nbsp;<span class="op" id="2027265">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027269">quoted</span>&nbsp;<span class="op" id="2027276">=</span>&nbsp;<span class="ident" id="2027278">strconv</span><span class="op" id="2027285">.</span><span class="ident" id="2027286">AppendQuoteRune</span><span class="op" id="2027301">(</span><span class="ident" id="2027302">f</span><span class="op" id="2027303">.</span><span class="ident" id="2027304">intbuf</span><span class="op" id="2027310">[</span><span class="num" id="2027311">0</span><span class="op" id="2027312">:</span><span class="num" id="2027313">0</span><span class="op" id="2027314">]</span><span class="op" id="2027315">,</span>&nbsp;<span class="builtintype" id="2027317">rune</span><span class="op" id="2027321">(</span><span class="ident" id="2027322">c</span><span class="op" id="2027323">)</span><span class="op" id="2027324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027330">f</span><span class="op" id="2027331">.</span><span class="ident" id="2027332">pad</span><span class="op" id="2027335">(</span><span class="ident" id="2027336">quoted</span><span class="op" id="2027342">)</span><br>
<span class="lineno"></span><span class="op" id="2027344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2027347">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2027366">func</span>&nbsp;<span class="ident" id="2027371">doPrec</span><span class="op" id="2027377">(</span><span class="ident" id="2027378">f</span>&nbsp;<span class="op" id="2027380">*</span><span class="ident" id="2027381">fmt</span><span class="op" id="2027384">,</span>&nbsp;<span class="ident" id="2027386">def</span>&nbsp;<span class="builtintype" id="2027390">int</span><span class="op" id="2027393">)</span>&nbsp;<span class="builtintype" id="2027395">int</span>&nbsp;<span class="op" id="2027399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027402">if</span>&nbsp;<span class="ident" id="2027405">f</span><span class="op" id="2027406">.</span><span class="ident" id="2027407">precPresent</span>&nbsp;<span class="op" id="2027419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027423">return</span>&nbsp;<span class="ident" id="2027430">f</span><span class="op" id="2027431">.</span><span class="ident" id="2027432">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027441">return</span>&nbsp;<span class="ident" id="2027448">def</span><br>
<span class="lineno"></span><span class="op" id="2027452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2027455">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2027556">func</span>&nbsp;<span class="op" id="2027561">(</span><span class="ident" id="2027562">f</span>&nbsp;<span class="op" id="2027564">*</span><span class="ident" id="2027565">fmt</span><span class="op" id="2027568">)</span>&nbsp;<span class="ident" id="2027570">formatFloat</span><span class="op" id="2027581">(</span><span class="ident" id="2027582">v</span>&nbsp;<span class="builtintype" id="2027584">float64</span><span class="op" id="2027591">,</span>&nbsp;<span class="ident" id="2027593">verb</span>&nbsp;<span class="builtintype" id="2027598">byte</span><span class="op" id="2027602">,</span>&nbsp;<span class="ident" id="2027604">prec</span><span class="op" id="2027608">,</span>&nbsp;<span class="ident" id="2027610">n</span>&nbsp;<span class="builtintype" id="2027612">int</span><span class="op" id="2027615">)</span>&nbsp;<span class="op" id="2027617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2027620">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027685">num</span>&nbsp;<span class="op" id="2027689">:=</span>&nbsp;<span class="ident" id="2027692">strconv</span><span class="op" id="2027699">.</span><span class="ident" id="2027700">AppendFloat</span><span class="op" id="2027711">(</span><span class="ident" id="2027712">f</span><span class="op" id="2027713">.</span><span class="ident" id="2027714">intbuf</span><span class="op" id="2027720">[</span><span class="num" id="2027721">0</span><span class="op" id="2027722">:</span><span class="num" id="2027723">1</span><span class="op" id="2027724">]</span><span class="op" id="2027725">,</span>&nbsp;<span class="ident" id="2027727">v</span><span class="op" id="2027728">,</span>&nbsp;<span class="ident" id="2027730">verb</span><span class="op" id="2027734">,</span>&nbsp;<span class="ident" id="2027736">prec</span><span class="op" id="2027740">,</span>&nbsp;<span class="ident" id="2027742">n</span><span class="op" id="2027743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027746">if</span>&nbsp;<span class="ident" id="2027749">num</span><span class="op" id="2027752">[</span><span class="num" id="2027753">1</span><span class="op" id="2027754">]</span>&nbsp;<span class="op" id="2027756">==</span>&nbsp;<span class="string" id="2027759">&#39;-&#39;</span>&nbsp;<span class="op" id="2027763">||</span>&nbsp;<span class="ident" id="2027766">num</span><span class="op" id="2027769">[</span><span class="num" id="2027770">1</span><span class="op" id="2027771">]</span>&nbsp;<span class="op" id="2027773">==</span>&nbsp;<span class="string" id="2027776">&#39;+&#39;</span>&nbsp;<span class="op" id="2027780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027784">num</span>&nbsp;<span class="op" id="2027788">=</span>&nbsp;<span class="ident" id="2027790">num</span><span class="op" id="2027793">[</span><span class="num" id="2027794">1</span><span class="op" id="2027795">:</span><span class="op" id="2027796">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027799">}</span>&nbsp;<span class="keyword" id="2027801">else</span>&nbsp;<span class="op" id="2027806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027810">num</span><span class="op" id="2027813">[</span><span class="num" id="2027814">0</span><span class="op" id="2027815">]</span>&nbsp;<span class="op" id="2027817">=</span>&nbsp;<span class="string" id="2027819">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2027827">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027930">if</span>&nbsp;<span class="ident" id="2027933">math</span><span class="op" id="2027937">.</span><span class="ident" id="2027938">IsInf</span><span class="op" id="2027943">(</span><span class="ident" id="2027944">v</span><span class="op" id="2027945">,</span>&nbsp;<span class="num" id="2027947">0</span><span class="op" id="2027948">)</span>&nbsp;<span class="op" id="2027950">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027954">if</span>&nbsp;<span class="ident" id="2027957">f</span><span class="op" id="2027958">.</span><span class="ident" id="2027959">zero</span>&nbsp;<span class="op" id="2027964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027969">defer</span>&nbsp;<span class="keyword" id="2027975">func</span><span class="op" id="2027979">(</span><span class="op" id="2027980">)</span>&nbsp;<span class="op" id="2027982">{</span>&nbsp;<span class="ident" id="2027984">f</span><span class="op" id="2027985">.</span><span class="ident" id="2027986">zero</span>&nbsp;<span class="op" id="2027991">=</span>&nbsp;<span class="builtintype" id="2027993">true</span>&nbsp;<span class="op" id="2027998">}</span><span class="op" id="2027999">(</span><span class="op" id="2028000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028005">f</span><span class="op" id="2028006">.</span><span class="ident" id="2028007">zero</span>&nbsp;<span class="op" id="2028012">=</span>&nbsp;<span class="builtintype" id="2028014">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028025">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028028">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028075">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028142">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028221">if</span>&nbsp;<span class="ident" id="2028224">f</span><span class="op" id="2028225">.</span><span class="ident" id="2028226">zero</span>&nbsp;<span class="op" id="2028231">&amp;&amp;</span>&nbsp;<span class="ident" id="2028234">f</span><span class="op" id="2028235">.</span><span class="ident" id="2028236">widPresent</span>&nbsp;<span class="op" id="2028247">&amp;&amp;</span>&nbsp;<span class="ident" id="2028250">f</span><span class="op" id="2028251">.</span><span class="ident" id="2028252">wid</span>&nbsp;<span class="op" id="2028256">&gt;</span>&nbsp;<span class="builtinfunc" id="2028258">len</span><span class="op" id="2028261">(</span><span class="ident" id="2028262">num</span><span class="op" id="2028265">)</span>&nbsp;<span class="op" id="2028267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028271">if</span>&nbsp;<span class="ident" id="2028274">f</span><span class="op" id="2028275">.</span><span class="ident" id="2028276">space</span>&nbsp;<span class="op" id="2028282">&amp;&amp;</span>&nbsp;<span class="ident" id="2028285">v</span>&nbsp;<span class="op" id="2028287">&gt;=</span>&nbsp;<span class="num" id="2028290">0</span>&nbsp;<span class="op" id="2028292">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028297">f</span><span class="op" id="2028298">.</span><span class="ident" id="2028299">buf</span><span class="op" id="2028302">.</span><span class="ident" id="2028303">WriteByte</span><span class="op" id="2028312">(</span><span class="string" id="2028313">&#39;&nbsp;&#39;</span><span class="op" id="2028316">)</span>&nbsp;<span class="comment" id="2028318">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028382">f</span><span class="op" id="2028383">.</span><span class="ident" id="2028384">wid</span><span class="op" id="2028387">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028392">}</span>&nbsp;<span class="keyword" id="2028394">else</span>&nbsp;<span class="keyword" id="2028399">if</span>&nbsp;<span class="ident" id="2028402">f</span><span class="op" id="2028403">.</span><span class="ident" id="2028404">plus</span>&nbsp;<span class="op" id="2028409">||</span>&nbsp;<span class="ident" id="2028412">v</span>&nbsp;<span class="op" id="2028414">&lt;</span>&nbsp;<span class="num" id="2028416">0</span>&nbsp;<span class="op" id="2028418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028423">f</span><span class="op" id="2028424">.</span><span class="ident" id="2028425">buf</span><span class="op" id="2028428">.</span><span class="ident" id="2028429">WriteByte</span><span class="op" id="2028438">(</span><span class="ident" id="2028439">num</span><span class="op" id="2028442">[</span><span class="num" id="2028443">0</span><span class="op" id="2028444">]</span><span class="op" id="2028445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028450">f</span><span class="op" id="2028451">.</span><span class="ident" id="2028452">wid</span><span class="op" id="2028455">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028464">f</span><span class="op" id="2028465">.</span><span class="ident" id="2028466">pad</span><span class="op" id="2028469">(</span><span class="ident" id="2028470">num</span><span class="op" id="2028473">[</span><span class="num" id="2028474">1</span><span class="op" id="2028475">:</span><span class="op" id="2028476">]</span><span class="op" id="2028477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028481">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028492">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028546">if</span>&nbsp;<span class="ident" id="2028549">f</span><span class="op" id="2028550">.</span><span class="ident" id="2028551">space</span>&nbsp;<span class="op" id="2028557">&amp;&amp;</span>&nbsp;<span class="ident" id="2028560">num</span><span class="op" id="2028563">[</span><span class="num" id="2028564">0</span><span class="op" id="2028565">]</span>&nbsp;<span class="op" id="2028567">==</span>&nbsp;<span class="string" id="2028570">&#39;+&#39;</span>&nbsp;<span class="op" id="2028574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028578">num</span><span class="op" id="2028581">[</span><span class="num" id="2028582">0</span><span class="op" id="2028583">]</span>&nbsp;<span class="op" id="2028585">=</span>&nbsp;<span class="string" id="2028587">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028593">f</span><span class="op" id="2028594">.</span><span class="ident" id="2028595">pad</span><span class="op" id="2028598">(</span><span class="ident" id="2028599">num</span><span class="op" id="2028602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028606">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028614">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028617">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028697">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028785">if</span>&nbsp;<span class="ident" id="2028788">f</span><span class="op" id="2028789">.</span><span class="ident" id="2028790">plus</span>&nbsp;<span class="op" id="2028795">||</span>&nbsp;<span class="ident" id="2028798">num</span><span class="op" id="2028801">[</span><span class="num" id="2028802">0</span><span class="op" id="2028803">]</span>&nbsp;<span class="op" id="2028805">==</span>&nbsp;<span class="string" id="2028808">&#39;-&#39;</span>&nbsp;<span class="op" id="2028812">||</span>&nbsp;<span class="ident" id="2028815">math</span><span class="op" id="2028819">.</span><span class="ident" id="2028820">IsInf</span><span class="op" id="2028825">(</span><span class="ident" id="2028826">v</span><span class="op" id="2028827">,</span>&nbsp;<span class="num" id="2028829">0</span><span class="op" id="2028830">)</span>&nbsp;<span class="op" id="2028832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028836">f</span><span class="op" id="2028837">.</span><span class="ident" id="2028838">pad</span><span class="op" id="2028841">(</span><span class="ident" id="2028842">num</span><span class="op" id="2028845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028849">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2028860">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028940">f</span><span class="op" id="2028941">.</span><span class="ident" id="2028942">pad</span><span class="op" id="2028945">(</span><span class="ident" id="2028946">num</span><span class="op" id="2028949">[</span><span class="num" id="2028950">1</span><span class="op" id="2028951">:</span><span class="op" id="2028952">]</span><span class="op" id="2028953">)</span><br>
<span class="lineno"></span><span class="op" id="2028955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2028958">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2029010">func</span>&nbsp;<span class="op" id="2029015">(</span><span class="ident" id="2029016">f</span>&nbsp;<span class="op" id="2029018">*</span><span class="ident" id="2029019">fmt</span><span class="op" id="2029022">)</span>&nbsp;<span class="ident" id="2029024">fmt_e64</span><span class="op" id="2029031">(</span><span class="ident" id="2029032">v</span>&nbsp;<span class="builtintype" id="2029034">float64</span><span class="op" id="2029041">)</span>&nbsp;<span class="op" id="2029043">{</span>&nbsp;<span class="ident" id="2029045">f</span><span class="op" id="2029046">.</span><span class="ident" id="2029047">formatFloat</span><span class="op" id="2029058">(</span><span class="ident" id="2029059">v</span><span class="op" id="2029060">,</span>&nbsp;<span class="string" id="2029062">&#39;e&#39;</span><span class="op" id="2029065">,</span>&nbsp;<span class="ident" id="2029067">doPrec</span><span class="op" id="2029073">(</span><span class="ident" id="2029074">f</span><span class="op" id="2029075">,</span>&nbsp;<span class="num" id="2029077">6</span><span class="op" id="2029078">)</span><span class="op" id="2029079">,</span>&nbsp;<span class="num" id="2029081">64</span><span class="op" id="2029083">)</span>&nbsp;<span class="op" id="2029085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2029088">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2029140">func</span>&nbsp;<span class="op" id="2029145">(</span><span class="ident" id="2029146">f</span>&nbsp;<span class="op" id="2029148">*</span><span class="ident" id="2029149">fmt</span><span class="op" id="2029152">)</span>&nbsp;<span class="ident" id="2029154">fmt_E64</span><span class="op" id="2029161">(</span><span class="ident" id="2029162">v</span>&nbsp;<span class="builtintype" id="2029164">float64</span><span class="op" id="2029171">)</span>&nbsp;<span class="op" id="2029173">{</span>&nbsp;<span class="ident" id="2029175">f</span><span class="op" id="2029176">.</span><span class="ident" id="2029177">formatFloat</span><span class="op" id="2029188">(</span><span class="ident" id="2029189">v</span><span class="op" id="2029190">,</span>&nbsp;<span class="string" id="2029192">&#39;E&#39;</span><span class="op" id="2029195">,</span>&nbsp;<span class="ident" id="2029197">doPrec</span><span class="op" id="2029203">(</span><span class="ident" id="2029204">f</span><span class="op" id="2029205">,</span>&nbsp;<span class="num" id="2029207">6</span><span class="op" id="2029208">)</span><span class="op" id="2029209">,</span>&nbsp;<span class="num" id="2029211">64</span><span class="op" id="2029213">)</span>&nbsp;<span class="op" id="2029215">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2029218">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2029266">func</span>&nbsp;<span class="op" id="2029271">(</span><span class="ident" id="2029272">f</span>&nbsp;<span class="op" id="2029274">*</span><span class="ident" id="2029275">fmt</span><span class="op" id="2029278">)</span>&nbsp;<span class="ident" id="2029280">fmt_f64</span><span class="op" id="2029287">(</span><span class="ident" id="2029288">v</span>&nbsp;<span class="builtintype" id="2029290">float64</span><span class="op" id="2029297">)</span>&nbsp;<span class="op" id="2029299">{</span>&nbsp;<span class="ident" id="2029301">f</span><span class="op" id="2029302">.</span><span class="ident" id="2029303">formatFloat</span><span class="op" id="2029314">(</span><span class="ident" id="2029315">v</span><span class="op" id="2029316">,</span>&nbsp;<span class="string" id="2029318">&#39;f&#39;</span><span class="op" id="2029321">,</span>&nbsp;<span class="ident" id="2029323">doPrec</span><span class="op" id="2029329">(</span><span class="ident" id="2029330">f</span><span class="op" id="2029331">,</span>&nbsp;<span class="num" id="2029333">6</span><span class="op" id="2029334">)</span><span class="op" id="2029335">,</span>&nbsp;<span class="num" id="2029337">64</span><span class="op" id="2029339">)</span>&nbsp;<span class="op" id="2029341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2029344">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2029415">func</span>&nbsp;<span class="op" id="2029420">(</span><span class="ident" id="2029421">f</span>&nbsp;<span class="op" id="2029423">*</span><span class="ident" id="2029424">fmt</span><span class="op" id="2029427">)</span>&nbsp;<span class="ident" id="2029429">fmt_g64</span><span class="op" id="2029436">(</span><span class="ident" id="2029437">v</span>&nbsp;<span class="builtintype" id="2029439">float64</span><span class="op" id="2029446">)</span>&nbsp;<span class="op" id="2029448">{</span>&nbsp;<span class="ident" id="2029450">f</span><span class="op" id="2029451">.</span><span class="ident" id="2029452">formatFloat</span><span class="op" id="2029463">(</span><span class="ident" id="2029464">v</span><span class="op" id="2029465">,</span>&nbsp;<span class="string" id="2029467">&#39;g&#39;</span><span class="op" id="2029470">,</span>&nbsp;<span class="ident" id="2029472">doPrec</span><span class="op" id="2029478">(</span><span class="ident" id="2029479">f</span><span class="op" id="2029480">,</span>&nbsp;<span class="op" id="2029482">-</span><span class="num" id="2029483">1</span><span class="op" id="2029484">)</span><span class="op" id="2029485">,</span>&nbsp;<span class="num" id="2029487">64</span><span class="op" id="2029489">)</span>&nbsp;<span class="op" id="2029491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2029494">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2029565">func</span>&nbsp;<span class="op" id="2029570">(</span><span class="ident" id="2029571">f</span>&nbsp;<span class="op" id="2029573">*</span><span class="ident" id="2029574">fmt</span><span class="op" id="2029577">)</span>&nbsp;<span class="ident" id="2029579">fmt_G64</span><span class="op" id="2029586">(</span><span class="ident" id="2029587">v</span>&nbsp;<span class="builtintype" id="2029589">float64</span><span class="op" id="2029596">)</span>&nbsp;<span class="op" id="2029598">{</span>&nbsp;<span class="ident" id="2029600">f</span><span class="op" id="2029601">.</span><span class="ident" id="2029602">formatFloat</span><span class="op" id="2029613">(</span><span class="ident" id="2029614">v</span><span class="op" id="2029615">,</span>&nbsp;<span class="string" id="2029617">&#39;G&#39;</span><span class="op" id="2029620">,</span>&nbsp;<span class="ident" id="2029622">doPrec</span><span class="op" id="2029628">(</span><span class="ident" id="2029629">f</span><span class="op" id="2029630">,</span>&nbsp;<span class="op" id="2029632">-</span><span class="num" id="2029633">1</span><span class="op" id="2029634">)</span><span class="op" id="2029635">,</span>&nbsp;<span class="num" id="2029637">64</span><span class="op" id="2029639">)</span>&nbsp;<span class="op" id="2029641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2029644">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2029719">func</span>&nbsp;<span class="op" id="2029724">(</span><span class="ident" id="2029725">f</span>&nbsp;<span class="op" id="2029727">*</span><span class="ident" id="2029728">fmt</span><span class="op" id="2029731">)</span>&nbsp;<span class="ident" id="2029733">fmt_fb64</span><span class="op" id="2029741">(</span><span class="ident" id="2029742">v</span>&nbsp;<span class="builtintype" id="2029744">float64</span><span class="op" id="2029751">)</span>&nbsp;<span class="op" id="2029753">{</span>&nbsp;<span class="ident" id="2029755">f</span><span class="op" id="2029756">.</span><span class="ident" id="2029757">formatFloat</span><span class="op" id="2029768">(</span><span class="ident" id="2029769">v</span><span class="op" id="2029770">,</span>&nbsp;<span class="string" id="2029772">&#39;b&#39;</span><span class="op" id="2029775">,</span>&nbsp;<span class="num" id="2029777">0</span><span class="op" id="2029778">,</span>&nbsp;<span class="num" id="2029780">64</span><span class="op" id="2029782">)</span>&nbsp;<span class="op" id="2029784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2029787">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2029798">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2029834">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2029890">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2029942">func</span>&nbsp;<span class="op" id="2029947">(</span><span class="ident" id="2029948">f</span>&nbsp;<span class="op" id="2029950">*</span><span class="ident" id="2029951">fmt</span><span class="op" id="2029954">)</span>&nbsp;<span class="ident" id="2029956">fmt_e32</span><span class="op" id="2029963">(</span><span class="ident" id="2029964">v</span>&nbsp;<span class="builtintype" id="2029966">float32</span><span class="op" id="2029973">)</span>&nbsp;<span class="op" id="2029975">{</span>&nbsp;<span class="ident" id="2029977">f</span><span class="op" id="2029978">.</span><span class="ident" id="2029979">formatFloat</span><span class="op" id="2029990">(</span><span class="builtintype" id="2029991">float64</span><span class="op" id="2029998">(</span><span class="ident" id="2029999">v</span><span class="op" id="2030000">)</span><span class="op" id="2030001">,</span>&nbsp;<span class="string" id="2030003">&#39;e&#39;</span><span class="op" id="2030006">,</span>&nbsp;<span class="ident" id="2030008">doPrec</span><span class="op" id="2030014">(</span><span class="ident" id="2030015">f</span><span class="op" id="2030016">,</span>&nbsp;<span class="num" id="2030018">6</span><span class="op" id="2030019">)</span><span class="op" id="2030020">,</span>&nbsp;<span class="num" id="2030022">32</span><span class="op" id="2030024">)</span>&nbsp;<span class="op" id="2030026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2030029">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2030081">func</span>&nbsp;<span class="op" id="2030086">(</span><span class="ident" id="2030087">f</span>&nbsp;<span class="op" id="2030089">*</span><span class="ident" id="2030090">fmt</span><span class="op" id="2030093">)</span>&nbsp;<span class="ident" id="2030095">fmt_E32</span><span class="op" id="2030102">(</span><span class="ident" id="2030103">v</span>&nbsp;<span class="builtintype" id="2030105">float32</span><span class="op" id="2030112">)</span>&nbsp;<span class="op" id="2030114">{</span>&nbsp;<span class="ident" id="2030116">f</span><span class="op" id="2030117">.</span><span class="ident" id="2030118">formatFloat</span><span class="op" id="2030129">(</span><span class="builtintype" id="2030130">float64</span><span class="op" id="2030137">(</span><span class="ident" id="2030138">v</span><span class="op" id="2030139">)</span><span class="op" id="2030140">,</span>&nbsp;<span class="string" id="2030142">&#39;E&#39;</span><span class="op" id="2030145">,</span>&nbsp;<span class="ident" id="2030147">doPrec</span><span class="op" id="2030153">(</span><span class="ident" id="2030154">f</span><span class="op" id="2030155">,</span>&nbsp;<span class="num" id="2030157">6</span><span class="op" id="2030158">)</span><span class="op" id="2030159">,</span>&nbsp;<span class="num" id="2030161">32</span><span class="op" id="2030163">)</span>&nbsp;<span class="op" id="2030165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2030168">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2030216">func</span>&nbsp;<span class="op" id="2030221">(</span><span class="ident" id="2030222">f</span>&nbsp;<span class="op" id="2030224">*</span><span class="ident" id="2030225">fmt</span><span class="op" id="2030228">)</span>&nbsp;<span class="ident" id="2030230">fmt_f32</span><span class="op" id="2030237">(</span><span class="ident" id="2030238">v</span>&nbsp;<span class="builtintype" id="2030240">float32</span><span class="op" id="2030247">)</span>&nbsp;<span class="op" id="2030249">{</span>&nbsp;<span class="ident" id="2030251">f</span><span class="op" id="2030252">.</span><span class="ident" id="2030253">formatFloat</span><span class="op" id="2030264">(</span><span class="builtintype" id="2030265">float64</span><span class="op" id="2030272">(</span><span class="ident" id="2030273">v</span><span class="op" id="2030274">)</span><span class="op" id="2030275">,</span>&nbsp;<span class="string" id="2030277">&#39;f&#39;</span><span class="op" id="2030280">,</span>&nbsp;<span class="ident" id="2030282">doPrec</span><span class="op" id="2030288">(</span><span class="ident" id="2030289">f</span><span class="op" id="2030290">,</span>&nbsp;<span class="num" id="2030292">6</span><span class="op" id="2030293">)</span><span class="op" id="2030294">,</span>&nbsp;<span class="num" id="2030296">32</span><span class="op" id="2030298">)</span>&nbsp;<span class="op" id="2030300">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2030303">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2030374">func</span>&nbsp;<span class="op" id="2030379">(</span><span class="ident" id="2030380">f</span>&nbsp;<span class="op" id="2030382">*</span><span class="ident" id="2030383">fmt</span><span class="op" id="2030386">)</span>&nbsp;<span class="ident" id="2030388">fmt_g32</span><span class="op" id="2030395">(</span><span class="ident" id="2030396">v</span>&nbsp;<span class="builtintype" id="2030398">float32</span><span class="op" id="2030405">)</span>&nbsp;<span class="op" id="2030407">{</span>&nbsp;<span class="ident" id="2030409">f</span><span class="op" id="2030410">.</span><span class="ident" id="2030411">formatFloat</span><span class="op" id="2030422">(</span><span class="builtintype" id="2030423">float64</span><span class="op" id="2030430">(</span><span class="ident" id="2030431">v</span><span class="op" id="2030432">)</span><span class="op" id="2030433">,</span>&nbsp;<span class="string" id="2030435">&#39;g&#39;</span><span class="op" id="2030438">,</span>&nbsp;<span class="ident" id="2030440">doPrec</span><span class="op" id="2030446">(</span><span class="ident" id="2030447">f</span><span class="op" id="2030448">,</span>&nbsp;<span class="op" id="2030450">-</span><span class="num" id="2030451">1</span><span class="op" id="2030452">)</span><span class="op" id="2030453">,</span>&nbsp;<span class="num" id="2030455">32</span><span class="op" id="2030457">)</span>&nbsp;<span class="op" id="2030459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2030462">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2030533">func</span>&nbsp;<span class="op" id="2030538">(</span><span class="ident" id="2030539">f</span>&nbsp;<span class="op" id="2030541">*</span><span class="ident" id="2030542">fmt</span><span class="op" id="2030545">)</span>&nbsp;<span class="ident" id="2030547">fmt_G32</span><span class="op" id="2030554">(</span><span class="ident" id="2030555">v</span>&nbsp;<span class="builtintype" id="2030557">float32</span><span class="op" id="2030564">)</span>&nbsp;<span class="op" id="2030566">{</span>&nbsp;<span class="ident" id="2030568">f</span><span class="op" id="2030569">.</span><span class="ident" id="2030570">formatFloat</span><span class="op" id="2030581">(</span><span class="builtintype" id="2030582">float64</span><span class="op" id="2030589">(</span><span class="ident" id="2030590">v</span><span class="op" id="2030591">)</span><span class="op" id="2030592">,</span>&nbsp;<span class="string" id="2030594">&#39;G&#39;</span><span class="op" id="2030597">,</span>&nbsp;<span class="ident" id="2030599">doPrec</span><span class="op" id="2030605">(</span><span class="ident" id="2030606">f</span><span class="op" id="2030607">,</span>&nbsp;<span class="op" id="2030609">-</span><span class="num" id="2030610">1</span><span class="op" id="2030611">)</span><span class="op" id="2030612">,</span>&nbsp;<span class="num" id="2030614">32</span><span class="op" id="2030616">)</span>&nbsp;<span class="op" id="2030618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2030621">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2030696">func</span>&nbsp;<span class="op" id="2030701">(</span><span class="ident" id="2030702">f</span>&nbsp;<span class="op" id="2030704">*</span><span class="ident" id="2030705">fmt</span><span class="op" id="2030708">)</span>&nbsp;<span class="ident" id="2030710">fmt_fb32</span><span class="op" id="2030718">(</span><span class="ident" id="2030719">v</span>&nbsp;<span class="builtintype" id="2030721">float32</span><span class="op" id="2030728">)</span>&nbsp;<span class="op" id="2030730">{</span>&nbsp;<span class="ident" id="2030732">f</span><span class="op" id="2030733">.</span><span class="ident" id="2030734">formatFloat</span><span class="op" id="2030745">(</span><span class="builtintype" id="2030746">float64</span><span class="op" id="2030753">(</span><span class="ident" id="2030754">v</span><span class="op" id="2030755">)</span><span class="op" id="2030756">,</span>&nbsp;<span class="string" id="2030758">&#39;b&#39;</span><span class="op" id="2030761">,</span>&nbsp;<span class="num" id="2030763">0</span><span class="op" id="2030764">,</span>&nbsp;<span class="num" id="2030766">32</span><span class="op" id="2030768">)</span>&nbsp;<span class="op" id="2030770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2030773">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2030827">func</span>&nbsp;<span class="op" id="2030832">(</span><span class="ident" id="2030833">f</span>&nbsp;<span class="op" id="2030835">*</span><span class="ident" id="2030836">fmt</span><span class="op" id="2030839">)</span>&nbsp;<span class="ident" id="2030841">fmt_c64</span><span class="op" id="2030848">(</span><span class="ident" id="2030849">v</span>&nbsp;<span class="builtintype" id="2030851">complex64</span><span class="op" id="2030860">,</span>&nbsp;<span class="ident" id="2030862">verb</span>&nbsp;<span class="builtintype" id="2030867">rune</span><span class="op" id="2030871">)</span>&nbsp;<span class="op" id="2030873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030876">f</span><span class="op" id="2030877">.</span><span class="ident" id="2030878">fmt_complex</span><span class="op" id="2030889">(</span><span class="builtintype" id="2030890">float64</span><span class="op" id="2030897">(</span><span class="builtinfunc" id="2030898">real</span><span class="op" id="2030902">(</span><span class="ident" id="2030903">v</span><span class="op" id="2030904">)</span><span class="op" id="2030905">)</span><span class="op" id="2030906">,</span>&nbsp;<span class="builtintype" id="2030908">float64</span><span class="op" id="2030915">(</span><span class="builtinfunc" id="2030916">imag</span><span class="op" id="2030920">(</span><span class="ident" id="2030921">v</span><span class="op" id="2030922">)</span><span class="op" id="2030923">)</span><span class="op" id="2030924">,</span>&nbsp;<span class="num" id="2030926">32</span><span class="op" id="2030928">,</span>&nbsp;<span class="ident" id="2030930">verb</span><span class="op" id="2030934">)</span><br>
<span class="lineno"></span><span class="op" id="2030936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2030939">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2030995">func</span>&nbsp;<span class="op" id="2031000">(</span><span class="ident" id="2031001">f</span>&nbsp;<span class="op" id="2031003">*</span><span class="ident" id="2031004">fmt</span><span class="op" id="2031007">)</span>&nbsp;<span class="ident" id="2031009">fmt_c128</span><span class="op" id="2031017">(</span><span class="ident" id="2031018">v</span>&nbsp;<span class="builtintype" id="2031020">complex128</span><span class="op" id="2031030">,</span>&nbsp;<span class="ident" id="2031032">verb</span>&nbsp;<span class="builtintype" id="2031037">rune</span><span class="op" id="2031041">)</span>&nbsp;<span class="op" id="2031043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031046">f</span><span class="op" id="2031047">.</span><span class="ident" id="2031048">fmt_complex</span><span class="op" id="2031059">(</span><span class="builtinfunc" id="2031060">real</span><span class="op" id="2031064">(</span><span class="ident" id="2031065">v</span><span class="op" id="2031066">)</span><span class="op" id="2031067">,</span>&nbsp;<span class="builtinfunc" id="2031069">imag</span><span class="op" id="2031073">(</span><span class="ident" id="2031074">v</span><span class="op" id="2031075">)</span><span class="op" id="2031076">,</span>&nbsp;<span class="num" id="2031078">64</span><span class="op" id="2031080">,</span>&nbsp;<span class="ident" id="2031082">verb</span><span class="op" id="2031086">)</span><br>
<span class="lineno"></span><span class="op" id="2031088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2031091">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2031142">func</span>&nbsp;<span class="op" id="2031147">(</span><span class="ident" id="2031148">f</span>&nbsp;<span class="op" id="2031150">*</span><span class="ident" id="2031151">fmt</span><span class="op" id="2031154">)</span>&nbsp;<span class="ident" id="2031156">fmt_complex</span><span class="op" id="2031167">(</span><span class="ident" id="2031168">r</span><span class="op" id="2031169">,</span>&nbsp;<span class="ident" id="2031171">j</span>&nbsp;<span class="builtintype" id="2031173">float64</span><span class="op" id="2031180">,</span>&nbsp;<span class="ident" id="2031182">size</span>&nbsp;<span class="builtintype" id="2031187">int</span><span class="op" id="2031190">,</span>&nbsp;<span class="ident" id="2031192">verb</span>&nbsp;<span class="builtintype" id="2031197">rune</span><span class="op" id="2031201">)</span>&nbsp;<span class="op" id="2031203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031206">f</span><span class="op" id="2031207">.</span><span class="ident" id="2031208">buf</span><span class="op" id="2031211">.</span><span class="ident" id="2031212">WriteByte</span><span class="op" id="2031221">(</span><span class="string" id="2031222">&#39;(&#39;</span><span class="op" id="2031225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031228">oldPlus</span>&nbsp;<span class="op" id="2031236">:=</span>&nbsp;<span class="ident" id="2031239">f</span><span class="op" id="2031240">.</span><span class="ident" id="2031241">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031247">oldSpace</span>&nbsp;<span class="op" id="2031256">:=</span>&nbsp;<span class="ident" id="2031259">f</span><span class="op" id="2031260">.</span><span class="ident" id="2031261">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031268">oldWid</span>&nbsp;<span class="op" id="2031275">:=</span>&nbsp;<span class="ident" id="2031278">f</span><span class="op" id="2031279">.</span><span class="ident" id="2031280">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031285">for</span>&nbsp;<span class="ident" id="2031289">i</span>&nbsp;<span class="op" id="2031291">:=</span>&nbsp;<span class="num" id="2031294">0</span><span class="op" id="2031295">;</span>&nbsp;<span class="op" id="2031297">;</span>&nbsp;<span class="ident" id="2031299">i</span><span class="op" id="2031300">++</span>&nbsp;<span class="op" id="2031303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031307">switch</span>&nbsp;<span class="ident" id="2031314">verb</span>&nbsp;<span class="op" id="2031319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031323">case</span>&nbsp;<span class="string" id="2031328">&#39;b&#39;</span><span class="op" id="2031331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031336">f</span><span class="op" id="2031337">.</span><span class="ident" id="2031338">formatFloat</span><span class="op" id="2031349">(</span><span class="ident" id="2031350">r</span><span class="op" id="2031351">,</span>&nbsp;<span class="string" id="2031353">&#39;b&#39;</span><span class="op" id="2031356">,</span>&nbsp;<span class="num" id="2031358">0</span><span class="op" id="2031359">,</span>&nbsp;<span class="ident" id="2031361">size</span><span class="op" id="2031365">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031369">case</span>&nbsp;<span class="string" id="2031374">&#39;e&#39;</span><span class="op" id="2031377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031382">f</span><span class="op" id="2031383">.</span><span class="ident" id="2031384">formatFloat</span><span class="op" id="2031395">(</span><span class="ident" id="2031396">r</span><span class="op" id="2031397">,</span>&nbsp;<span class="string" id="2031399">&#39;e&#39;</span><span class="op" id="2031402">,</span>&nbsp;<span class="ident" id="2031404">doPrec</span><span class="op" id="2031410">(</span><span class="ident" id="2031411">f</span><span class="op" id="2031412">,</span>&nbsp;<span class="num" id="2031414">6</span><span class="op" id="2031415">)</span><span class="op" id="2031416">,</span>&nbsp;<span class="ident" id="2031418">size</span><span class="op" id="2031422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031426">case</span>&nbsp;<span class="string" id="2031431">&#39;E&#39;</span><span class="op" id="2031434">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031439">f</span><span class="op" id="2031440">.</span><span class="ident" id="2031441">formatFloat</span><span class="op" id="2031452">(</span><span class="ident" id="2031453">r</span><span class="op" id="2031454">,</span>&nbsp;<span class="string" id="2031456">&#39;E&#39;</span><span class="op" id="2031459">,</span>&nbsp;<span class="ident" id="2031461">doPrec</span><span class="op" id="2031467">(</span><span class="ident" id="2031468">f</span><span class="op" id="2031469">,</span>&nbsp;<span class="num" id="2031471">6</span><span class="op" id="2031472">)</span><span class="op" id="2031473">,</span>&nbsp;<span class="ident" id="2031475">size</span><span class="op" id="2031479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031483">case</span>&nbsp;<span class="string" id="2031488">&#39;f&#39;</span><span class="op" id="2031491">,</span>&nbsp;<span class="string" id="2031493">&#39;F&#39;</span><span class="op" id="2031496">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031501">f</span><span class="op" id="2031502">.</span><span class="ident" id="2031503">formatFloat</span><span class="op" id="2031514">(</span><span class="ident" id="2031515">r</span><span class="op" id="2031516">,</span>&nbsp;<span class="string" id="2031518">&#39;f&#39;</span><span class="op" id="2031521">,</span>&nbsp;<span class="ident" id="2031523">doPrec</span><span class="op" id="2031529">(</span><span class="ident" id="2031530">f</span><span class="op" id="2031531">,</span>&nbsp;<span class="num" id="2031533">6</span><span class="op" id="2031534">)</span><span class="op" id="2031535">,</span>&nbsp;<span class="ident" id="2031537">size</span><span class="op" id="2031541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031545">case</span>&nbsp;<span class="string" id="2031550">&#39;g&#39;</span><span class="op" id="2031553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031558">f</span><span class="op" id="2031559">.</span><span class="ident" id="2031560">formatFloat</span><span class="op" id="2031571">(</span><span class="ident" id="2031572">r</span><span class="op" id="2031573">,</span>&nbsp;<span class="string" id="2031575">&#39;g&#39;</span><span class="op" id="2031578">,</span>&nbsp;<span class="ident" id="2031580">doPrec</span><span class="op" id="2031586">(</span><span class="ident" id="2031587">f</span><span class="op" id="2031588">,</span>&nbsp;<span class="op" id="2031590">-</span><span class="num" id="2031591">1</span><span class="op" id="2031592">)</span><span class="op" id="2031593">,</span>&nbsp;<span class="ident" id="2031595">size</span><span class="op" id="2031599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031603">case</span>&nbsp;<span class="string" id="2031608">&#39;G&#39;</span><span class="op" id="2031611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031616">f</span><span class="op" id="2031617">.</span><span class="ident" id="2031618">formatFloat</span><span class="op" id="2031629">(</span><span class="ident" id="2031630">r</span><span class="op" id="2031631">,</span>&nbsp;<span class="string" id="2031633">&#39;G&#39;</span><span class="op" id="2031636">,</span>&nbsp;<span class="ident" id="2031638">doPrec</span><span class="op" id="2031644">(</span><span class="ident" id="2031645">f</span><span class="op" id="2031646">,</span>&nbsp;<span class="op" id="2031648">-</span><span class="num" id="2031649">1</span><span class="op" id="2031650">)</span><span class="op" id="2031651">,</span>&nbsp;<span class="ident" id="2031653">size</span><span class="op" id="2031657">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031665">if</span>&nbsp;<span class="ident" id="2031668">i</span>&nbsp;<span class="op" id="2031670">!=</span>&nbsp;<span class="num" id="2031673">0</span>&nbsp;<span class="op" id="2031675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031680">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2031692">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031731">f</span><span class="op" id="2031732">.</span><span class="ident" id="2031733">plus</span>&nbsp;<span class="op" id="2031738">=</span>&nbsp;<span class="builtintype" id="2031740">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031747">f</span><span class="op" id="2031748">.</span><span class="ident" id="2031749">space</span>&nbsp;<span class="op" id="2031755">=</span>&nbsp;<span class="builtintype" id="2031757">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031765">f</span><span class="op" id="2031766">.</span><span class="ident" id="2031767">wid</span>&nbsp;<span class="op" id="2031771">=</span>&nbsp;<span class="ident" id="2031773">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031782">r</span>&nbsp;<span class="op" id="2031784">=</span>&nbsp;<span class="ident" id="2031786">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031789">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031792">f</span><span class="op" id="2031793">.</span><span class="ident" id="2031794">space</span>&nbsp;<span class="op" id="2031800">=</span>&nbsp;<span class="ident" id="2031802">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031812">f</span><span class="op" id="2031813">.</span><span class="ident" id="2031814">plus</span>&nbsp;<span class="op" id="2031819">=</span>&nbsp;<span class="ident" id="2031821">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031830">f</span><span class="op" id="2031831">.</span><span class="ident" id="2031832">wid</span>&nbsp;<span class="op" id="2031836">=</span>&nbsp;<span class="ident" id="2031838">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031846">f</span><span class="op" id="2031847">.</span><span class="ident" id="2031848">buf</span><span class="op" id="2031851">.</span><span class="ident" id="2031852">Write</span><span class="op" id="2031857">(</span><span class="ident" id="2031858">irparenBytes</span><span class="op" id="2031870">)</span><br>
<span class="lineno"></span><span class="op" id="2031872">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
