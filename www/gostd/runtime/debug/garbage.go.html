<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5762726">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5762782">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5762836">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5762887">package</span>&nbsp;<span class="ident" id="5762895">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5762902">import</span>&nbsp;<span class="op" id="5762909">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5762912">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5762923">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5762931">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5762938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5762941">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5763006">type</span>&nbsp;<span class="ident" id="5763011">GCStats</span>&nbsp;<span class="keyword" id="5763019">struct</span>&nbsp;<span class="op" id="5763026">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763029">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5763044">time</span><span class="op" id="5763048">.</span><span class="ident" id="5763049">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5763060">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763088">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5763103">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5763119">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763153">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5763168">time</span><span class="op" id="5763172">.</span><span class="ident" id="5763173">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5763184">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763220">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5763235">[</span><span class="op" id="5763236">]</span><span class="ident" id="5763237">time</span><span class="op" id="5763241">.</span><span class="ident" id="5763242">Duration</span>&nbsp;<span class="comment" id="5763251">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763288">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5763303">[</span><span class="op" id="5763304">]</span><span class="ident" id="5763305">time</span><span class="op" id="5763309">.</span><span class="ident" id="5763310">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5763319">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763366">PauseQuantiles</span>&nbsp;<span class="op" id="5763381">[</span><span class="op" id="5763382">]</span><span class="ident" id="5763383">time</span><span class="op" id="5763387">.</span><span class="ident" id="5763388">Duration</span><br>
<span class="lineno"></span><span class="op" id="5763397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5763400">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5763469">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5763536">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5763612">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5763679">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5763756">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5763819">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5763890">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5763933">func</span>&nbsp;<span class="ident" id="5763938">ReadGCStats</span><span class="op" id="5763949">(</span><span class="ident" id="5763950">stats</span>&nbsp;<span class="op" id="5763956">*</span><span class="ident" id="5763957">GCStats</span><span class="op" id="5763964">)</span>&nbsp;<span class="op" id="5763966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5763969">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764031">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764094">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764158">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764214">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764239">const</span>&nbsp;<span class="ident" id="5764245">maxPause</span>&nbsp;<span class="op" id="5764254">=</span>&nbsp;<span class="builtinfunc" id="5764256">len</span><span class="op" id="5764259">(</span><span class="op" id="5764260">(</span><span class="op" id="5764261">(</span><span class="op" id="5764262">*</span><span class="ident" id="5764263">runtime</span><span class="op" id="5764270">.</span><span class="ident" id="5764271">MemStats</span><span class="op" id="5764279">)</span><span class="op" id="5764280">(</span><span class="ident" id="5764281">nil</span><span class="op" id="5764284">)</span><span class="op" id="5764285">)</span><span class="op" id="5764286">.</span><span class="ident" id="5764287">PauseNs</span><span class="op" id="5764294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764297">if</span>&nbsp;<span class="builtinfunc" id="5764300">cap</span><span class="op" id="5764303">(</span><span class="ident" id="5764304">stats</span><span class="op" id="5764309">.</span><span class="ident" id="5764310">Pause</span><span class="op" id="5764315">)</span>&nbsp;<span class="op" id="5764317">&lt;</span>&nbsp;<span class="num" id="5764319">2</span><span class="op" id="5764320">*</span><span class="ident" id="5764321">maxPause</span><span class="op" id="5764329">+</span><span class="num" id="5764330">3</span>&nbsp;<span class="op" id="5764332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764336">stats</span><span class="op" id="5764341">.</span><span class="ident" id="5764342">Pause</span>&nbsp;<span class="op" id="5764348">=</span>&nbsp;<span class="builtinfunc" id="5764350">make</span><span class="op" id="5764354">(</span><span class="op" id="5764355">[</span><span class="op" id="5764356">]</span><span class="ident" id="5764357">time</span><span class="op" id="5764361">.</span><span class="ident" id="5764362">Duration</span><span class="op" id="5764370">,</span>&nbsp;<span class="num" id="5764372">2</span><span class="op" id="5764373">*</span><span class="ident" id="5764374">maxPause</span><span class="op" id="5764382">+</span><span class="num" id="5764383">3</span><span class="op" id="5764384">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764391">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764457">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764525">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764588">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764647">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764715">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764735">readGCStats</span><span class="op" id="5764746">(</span><span class="op" id="5764747">&amp;</span><span class="ident" id="5764748">stats</span><span class="op" id="5764753">.</span><span class="ident" id="5764754">Pause</span><span class="op" id="5764759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764762">n</span>&nbsp;<span class="op" id="5764764">:=</span>&nbsp;<span class="builtinfunc" id="5764767">len</span><span class="op" id="5764770">(</span><span class="ident" id="5764771">stats</span><span class="op" id="5764776">.</span><span class="ident" id="5764777">Pause</span><span class="op" id="5764782">)</span>&nbsp;<span class="op" id="5764784">-</span>&nbsp;<span class="num" id="5764786">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764789">stats</span><span class="op" id="5764794">.</span><span class="ident" id="5764795">LastGC</span>&nbsp;<span class="op" id="5764802">=</span>&nbsp;<span class="ident" id="5764804">time</span><span class="op" id="5764808">.</span><span class="ident" id="5764809">Unix</span><span class="op" id="5764813">(</span><span class="num" id="5764814">0</span><span class="op" id="5764815">,</span>&nbsp;<span class="ident" id="5764817">int64</span><span class="op" id="5764822">(</span><span class="ident" id="5764823">stats</span><span class="op" id="5764828">.</span><span class="ident" id="5764829">Pause</span><span class="op" id="5764834">[</span><span class="ident" id="5764835">n</span><span class="op" id="5764836">]</span><span class="op" id="5764837">)</span><span class="op" id="5764838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764841">stats</span><span class="op" id="5764846">.</span><span class="ident" id="5764847">NumGC</span>&nbsp;<span class="op" id="5764853">=</span>&nbsp;<span class="ident" id="5764855">int64</span><span class="op" id="5764860">(</span><span class="ident" id="5764861">stats</span><span class="op" id="5764866">.</span><span class="ident" id="5764867">Pause</span><span class="op" id="5764872">[</span><span class="ident" id="5764873">n</span><span class="op" id="5764874">+</span><span class="num" id="5764875">1</span><span class="op" id="5764876">]</span><span class="op" id="5764877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764880">stats</span><span class="op" id="5764885">.</span><span class="ident" id="5764886">PauseTotal</span>&nbsp;<span class="op" id="5764897">=</span>&nbsp;<span class="ident" id="5764899">stats</span><span class="op" id="5764904">.</span><span class="ident" id="5764905">Pause</span><span class="op" id="5764910">[</span><span class="ident" id="5764911">n</span><span class="op" id="5764912">+</span><span class="num" id="5764913">2</span><span class="op" id="5764914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764917">n</span>&nbsp;<span class="op" id="5764919">/=</span>&nbsp;<span class="num" id="5764922">2</span>&nbsp;<span class="comment" id="5764924">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764962">stats</span><span class="op" id="5764967">.</span><span class="ident" id="5764968">Pause</span>&nbsp;<span class="op" id="5764974">=</span>&nbsp;<span class="ident" id="5764976">stats</span><span class="op" id="5764981">.</span><span class="ident" id="5764982">Pause</span><span class="op" id="5764987">[</span><span class="op" id="5764988">:</span><span class="ident" id="5764989">n</span><span class="op" id="5764990">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764994">if</span>&nbsp;<span class="builtinfunc" id="5764997">cap</span><span class="op" id="5765000">(</span><span class="ident" id="5765001">stats</span><span class="op" id="5765006">.</span><span class="ident" id="5765007">PauseEnd</span><span class="op" id="5765015">)</span>&nbsp;<span class="op" id="5765017">&lt;</span>&nbsp;<span class="ident" id="5765019">maxPause</span>&nbsp;<span class="op" id="5765028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765032">stats</span><span class="op" id="5765037">.</span><span class="ident" id="5765038">PauseEnd</span>&nbsp;<span class="op" id="5765047">=</span>&nbsp;<span class="builtinfunc" id="5765049">make</span><span class="op" id="5765053">(</span><span class="op" id="5765054">[</span><span class="op" id="5765055">]</span><span class="ident" id="5765056">time</span><span class="op" id="5765060">.</span><span class="ident" id="5765061">Time</span><span class="op" id="5765065">,</span>&nbsp;<span class="num" id="5765067">0</span><span class="op" id="5765068">,</span>&nbsp;<span class="ident" id="5765070">maxPause</span><span class="op" id="5765078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765084">stats</span><span class="op" id="5765089">.</span><span class="ident" id="5765090">PauseEnd</span>&nbsp;<span class="op" id="5765099">=</span>&nbsp;<span class="ident" id="5765101">stats</span><span class="op" id="5765106">.</span><span class="ident" id="5765107">PauseEnd</span><span class="op" id="5765115">[</span><span class="op" id="5765116">:</span><span class="num" id="5765117">0</span><span class="op" id="5765118">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765121">for</span>&nbsp;<span class="ident" id="5765125">_</span><span class="op" id="5765126">,</span>&nbsp;<span class="ident" id="5765128">ns</span>&nbsp;<span class="op" id="5765131">:=</span>&nbsp;<span class="keyword" id="5765134">range</span>&nbsp;<span class="ident" id="5765140">stats</span><span class="op" id="5765145">.</span><span class="ident" id="5765146">Pause</span><span class="op" id="5765151">[</span><span class="ident" id="5765152">n</span>&nbsp;<span class="op" id="5765154">:</span>&nbsp;<span class="ident" id="5765156">n</span><span class="op" id="5765157">+</span><span class="ident" id="5765158">n</span><span class="op" id="5765159">]</span>&nbsp;<span class="op" id="5765161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765165">stats</span><span class="op" id="5765170">.</span><span class="ident" id="5765171">PauseEnd</span>&nbsp;<span class="op" id="5765180">=</span>&nbsp;<span class="builtinfunc" id="5765182">append</span><span class="op" id="5765188">(</span><span class="ident" id="5765189">stats</span><span class="op" id="5765194">.</span><span class="ident" id="5765195">PauseEnd</span><span class="op" id="5765203">,</span>&nbsp;<span class="ident" id="5765205">time</span><span class="op" id="5765209">.</span><span class="ident" id="5765210">Unix</span><span class="op" id="5765214">(</span><span class="num" id="5765215">0</span><span class="op" id="5765216">,</span>&nbsp;<span class="ident" id="5765218">int64</span><span class="op" id="5765223">(</span><span class="ident" id="5765224">ns</span><span class="op" id="5765226">)</span><span class="op" id="5765227">)</span><span class="op" id="5765228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765235">if</span>&nbsp;<span class="builtinfunc" id="5765238">len</span><span class="op" id="5765241">(</span><span class="ident" id="5765242">stats</span><span class="op" id="5765247">.</span><span class="ident" id="5765248">PauseQuantiles</span><span class="op" id="5765262">)</span>&nbsp;<span class="op" id="5765264">&gt;</span>&nbsp;<span class="num" id="5765266">0</span>&nbsp;<span class="op" id="5765268">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765272">if</span>&nbsp;<span class="ident" id="5765275">n</span>&nbsp;<span class="op" id="5765277">==</span>&nbsp;<span class="num" id="5765280">0</span>&nbsp;<span class="op" id="5765282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765287">for</span>&nbsp;<span class="ident" id="5765291">i</span>&nbsp;<span class="op" id="5765293">:=</span>&nbsp;<span class="keyword" id="5765296">range</span>&nbsp;<span class="ident" id="5765302">stats</span><span class="op" id="5765307">.</span><span class="ident" id="5765308">PauseQuantiles</span>&nbsp;<span class="op" id="5765323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765329">stats</span><span class="op" id="5765334">.</span><span class="ident" id="5765335">PauseQuantiles</span><span class="op" id="5765349">[</span><span class="ident" id="5765350">i</span><span class="op" id="5765351">]</span>&nbsp;<span class="op" id="5765353">=</span>&nbsp;<span class="num" id="5765355">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765364">}</span>&nbsp;<span class="keyword" id="5765366">else</span>&nbsp;<span class="op" id="5765371">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5765376">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5765441">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765494">sorted</span>&nbsp;<span class="op" id="5765501">:=</span>&nbsp;<span class="ident" id="5765504">stats</span><span class="op" id="5765509">.</span><span class="ident" id="5765510">Pause</span><span class="op" id="5765515">[</span><span class="ident" id="5765516">n</span>&nbsp;<span class="op" id="5765518">:</span>&nbsp;<span class="ident" id="5765520">n</span><span class="op" id="5765521">+</span><span class="ident" id="5765522">n</span><span class="op" id="5765523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5765528">copy</span><span class="op" id="5765532">(</span><span class="ident" id="5765533">sorted</span><span class="op" id="5765539">,</span>&nbsp;<span class="ident" id="5765541">stats</span><span class="op" id="5765546">.</span><span class="ident" id="5765547">Pause</span><span class="op" id="5765552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765557">sort</span><span class="op" id="5765561">.</span><span class="ident" id="5765562">Sort</span><span class="op" id="5765566">(</span><span class="ident" id="5765567">byDuration</span><span class="op" id="5765577">(</span><span class="ident" id="5765578">sorted</span><span class="op" id="5765584">)</span><span class="op" id="5765585">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765590">nq</span>&nbsp;<span class="op" id="5765593">:=</span>&nbsp;<span class="builtinfunc" id="5765596">len</span><span class="op" id="5765599">(</span><span class="ident" id="5765600">stats</span><span class="op" id="5765605">.</span><span class="ident" id="5765606">PauseQuantiles</span><span class="op" id="5765620">)</span>&nbsp;<span class="op" id="5765622">-</span>&nbsp;<span class="num" id="5765624">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765629">for</span>&nbsp;<span class="ident" id="5765633">i</span>&nbsp;<span class="op" id="5765635">:=</span>&nbsp;<span class="num" id="5765638">0</span><span class="op" id="5765639">;</span>&nbsp;<span class="ident" id="5765641">i</span>&nbsp;<span class="op" id="5765643">&lt;</span>&nbsp;<span class="ident" id="5765645">nq</span><span class="op" id="5765647">;</span>&nbsp;<span class="ident" id="5765649">i</span><span class="op" id="5765650">++</span>&nbsp;<span class="op" id="5765653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765659">stats</span><span class="op" id="5765664">.</span><span class="ident" id="5765665">PauseQuantiles</span><span class="op" id="5765679">[</span><span class="ident" id="5765680">i</span><span class="op" id="5765681">]</span>&nbsp;<span class="op" id="5765683">=</span>&nbsp;<span class="ident" id="5765685">sorted</span><span class="op" id="5765691">[</span><span class="builtinfunc" id="5765692">len</span><span class="op" id="5765695">(</span><span class="ident" id="5765696">sorted</span><span class="op" id="5765702">)</span><span class="op" id="5765703">*</span><span class="ident" id="5765704">i</span><span class="op" id="5765705">/</span><span class="ident" id="5765706">nq</span><span class="op" id="5765708">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765718">stats</span><span class="op" id="5765723">.</span><span class="ident" id="5765724">PauseQuantiles</span><span class="op" id="5765738">[</span><span class="ident" id="5765739">nq</span><span class="op" id="5765741">]</span>&nbsp;<span class="op" id="5765743">=</span>&nbsp;<span class="ident" id="5765745">sorted</span><span class="op" id="5765751">[</span><span class="builtinfunc" id="5765752">len</span><span class="op" id="5765755">(</span><span class="ident" id="5765756">sorted</span><span class="op" id="5765762">)</span><span class="op" id="5765763">-</span><span class="num" id="5765764">1</span><span class="op" id="5765765">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765772">}</span><br>
<span class="lineno"></span><span class="op" id="5765774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5765777">type</span>&nbsp;<span class="ident" id="5765782">byDuration</span>&nbsp;<span class="op" id="5765793">[</span><span class="op" id="5765794">]</span><span class="ident" id="5765795">time</span><span class="op" id="5765799">.</span><span class="ident" id="5765800">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5765810">func</span>&nbsp;<span class="op" id="5765815">(</span><span class="ident" id="5765816">x</span>&nbsp;<span class="ident" id="5765818">byDuration</span><span class="op" id="5765828">)</span>&nbsp;<span class="ident" id="5765830">Len</span><span class="op" id="5765833">(</span><span class="op" id="5765834">)</span>&nbsp;<span class="builtintype" id="5765836">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5765850">{</span>&nbsp;<span class="keyword" id="5765852">return</span>&nbsp;<span class="builtinfunc" id="5765859">len</span><span class="op" id="5765862">(</span><span class="ident" id="5765863">x</span><span class="op" id="5765864">)</span>&nbsp;<span class="op" id="5765866">}</span><br>
<span class="lineno"></span><span class="keyword" id="5765868">func</span>&nbsp;<span class="op" id="5765873">(</span><span class="ident" id="5765874">x</span>&nbsp;<span class="ident" id="5765876">byDuration</span><span class="op" id="5765886">)</span>&nbsp;<span class="ident" id="5765888">Swap</span><span class="op" id="5765892">(</span><span class="ident" id="5765893">i</span><span class="op" id="5765894">,</span>&nbsp;<span class="ident" id="5765896">j</span>&nbsp;<span class="builtintype" id="5765898">int</span><span class="op" id="5765901">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5765908">{</span>&nbsp;<span class="ident" id="5765910">x</span><span class="op" id="5765911">[</span><span class="ident" id="5765912">i</span><span class="op" id="5765913">]</span><span class="op" id="5765914">,</span>&nbsp;<span class="ident" id="5765916">x</span><span class="op" id="5765917">[</span><span class="ident" id="5765918">j</span><span class="op" id="5765919">]</span>&nbsp;<span class="op" id="5765921">=</span>&nbsp;<span class="ident" id="5765923">x</span><span class="op" id="5765924">[</span><span class="ident" id="5765925">j</span><span class="op" id="5765926">]</span><span class="op" id="5765927">,</span>&nbsp;<span class="ident" id="5765929">x</span><span class="op" id="5765930">[</span><span class="ident" id="5765931">i</span><span class="op" id="5765932">]</span>&nbsp;<span class="op" id="5765934">}</span><br>
<span class="lineno"></span><span class="keyword" id="5765936">func</span>&nbsp;<span class="op" id="5765941">(</span><span class="ident" id="5765942">x</span>&nbsp;<span class="ident" id="5765944">byDuration</span><span class="op" id="5765954">)</span>&nbsp;<span class="ident" id="5765956">Less</span><span class="op" id="5765960">(</span><span class="ident" id="5765961">i</span><span class="op" id="5765962">,</span>&nbsp;<span class="ident" id="5765964">j</span>&nbsp;<span class="builtintype" id="5765966">int</span><span class="op" id="5765969">)</span>&nbsp;<span class="builtintype" id="5765971">bool</span>&nbsp;<span class="op" id="5765976">{</span>&nbsp;<span class="keyword" id="5765978">return</span>&nbsp;<span class="ident" id="5765985">x</span><span class="op" id="5765986">[</span><span class="ident" id="5765987">i</span><span class="op" id="5765988">]</span>&nbsp;<span class="op" id="5765990">&lt;</span>&nbsp;<span class="ident" id="5765992">x</span><span class="op" id="5765993">[</span><span class="ident" id="5765994">j</span><span class="op" id="5765995">]</span>&nbsp;<span class="op" id="5765997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5766000">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5766063">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5766133">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5766214">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5766260">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5766329">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5766379">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5766433">func</span>&nbsp;<span class="ident" id="5766438">SetGCPercent</span><span class="op" id="5766450">(</span><span class="ident" id="5766451">percent</span>&nbsp;<span class="builtintype" id="5766459">int</span><span class="op" id="5766462">)</span>&nbsp;<span class="builtintype" id="5766464">int</span>&nbsp;<span class="op" id="5766468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766471">old</span>&nbsp;<span class="op" id="5766475">:=</span>&nbsp;<span class="ident" id="5766478">setGCPercent</span><span class="op" id="5766490">(</span><span class="builtintype" id="5766491">int32</span><span class="op" id="5766496">(</span><span class="ident" id="5766497">percent</span><span class="op" id="5766504">)</span><span class="op" id="5766505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766508">runtime</span><span class="op" id="5766515">.</span><span class="ident" id="5766516">GC</span><span class="op" id="5766518">(</span><span class="op" id="5766519">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766522">return</span>&nbsp;<span class="builtintype" id="5766529">int</span><span class="op" id="5766532">(</span><span class="ident" id="5766533">old</span><span class="op" id="5766536">)</span><br>
<span class="lineno"></span><span class="op" id="5766538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5766541">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5766600">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5766660">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5766727">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5766792">func</span>&nbsp;<span class="ident" id="5766797">FreeOSMemory</span><span class="op" id="5766809">(</span><span class="op" id="5766810">)</span>&nbsp;<span class="op" id="5766812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766815">freeOSMemory</span><span class="op" id="5766827">(</span><span class="op" id="5766828">)</span><br>
<span class="lineno"></span><span class="op" id="5766830">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5766833">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5766887">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5766931">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5766995">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5767019">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5767064">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5767140">//</span><br>
<span class="lineno"></span><span class="comment" id="5767143">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5767207">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5767277">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5767294">func</span>&nbsp;<span class="ident" id="5767299">SetMaxStack</span><span class="op" id="5767310">(</span><span class="ident" id="5767311">bytes</span>&nbsp;<span class="builtintype" id="5767317">int</span><span class="op" id="5767320">)</span>&nbsp;<span class="builtintype" id="5767322">int</span>&nbsp;<span class="op" id="5767326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767329">return</span>&nbsp;<span class="ident" id="5767336">setMaxStack</span><span class="op" id="5767347">(</span><span class="ident" id="5767348">bytes</span><span class="op" id="5767353">)</span><br>
<span class="lineno"></span><span class="op" id="5767355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5767358">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5767419">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5767491">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5767526">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5767573">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5767615">//</span><br>
<span class="lineno"></span><span class="comment" id="5767618">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5767695">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5767769">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5767857">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5767930">//</span><br>
<span class="lineno"></span><span class="comment" id="5767933">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5767999">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5768067">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5768138">func</span>&nbsp;<span class="ident" id="5768143">SetMaxThreads</span><span class="op" id="5768156">(</span><span class="ident" id="5768157">threads</span>&nbsp;<span class="builtintype" id="5768165">int</span><span class="op" id="5768168">)</span>&nbsp;<span class="builtintype" id="5768170">int</span>&nbsp;<span class="op" id="5768174">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768177">return</span>&nbsp;<span class="ident" id="5768184">setMaxThreads</span><span class="op" id="5768197">(</span><span class="ident" id="5768198">threads</span><span class="op" id="5768205">)</span><br>
<span class="lineno"></span><span class="op" id="5768207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5768210">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5768283">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5768358">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5768437">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5768505">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5768577">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5768649">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5768704">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5768762">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5768798">func</span>&nbsp;<span class="ident" id="5768803">SetPanicOnFault</span><span class="op" id="5768818">(</span><span class="ident" id="5768819">enabled</span>&nbsp;<span class="builtintype" id="5768827">bool</span><span class="op" id="5768831">)</span>&nbsp;<span class="builtintype" id="5768833">bool</span>&nbsp;<span class="op" id="5768838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768841">return</span>&nbsp;<span class="ident" id="5768848">setPanicOnFault</span><span class="op" id="5768863">(</span><span class="ident" id="5768864">enabled</span><span class="op" id="5768871">)</span><br>
<span class="lineno"></span><span class="op" id="5768873">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5768876">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5768945">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5768981">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5769053">func</span>&nbsp;<span class="ident" id="5769058">WriteHeapDump</span><span class="op" id="5769071">(</span><span class="ident" id="5769072">fd</span>&nbsp;<span class="builtintype" id="5769075">uintptr</span><span class="op" id="5769082">)</span>
</div>
</body>
</html>
