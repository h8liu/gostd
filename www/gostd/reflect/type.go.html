<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2811622">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2811677">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2811731">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2811782">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2811855">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2811935">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2812011">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2812052">//</span><br>
<span class="lineno">10</span><span class="comment" id="2812055">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2812124">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2812191">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2812209">//</span><br>
<span class="lineno"></span><span class="comment" id="2812212">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2812285">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2812343">package</span>&nbsp;<span class="ident" id="2812351">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2812360">import</span>&nbsp;<span class="op" id="2812367">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2812370">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2812381">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2812392">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2812400">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2812409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2812412">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2812456">//</span><br>
<span class="lineno"></span><span class="comment" id="2812459">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2812522">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2812581">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2812640">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2812692">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2812754">type</span>&nbsp;<span class="ident" id="2812759">Type</span>&nbsp;<span class="keyword" id="2812764">interface</span>&nbsp;<span class="op" id="2812774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812777">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812815">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812870">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2812910">Align</span><span class="op" id="2812915">(</span><span class="op" id="2812916">)</span>&nbsp;<span class="builtintype" id="2812918">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812924">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2812984">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813032">FieldAlign</span><span class="op" id="2813042">(</span><span class="op" id="2813043">)</span>&nbsp;<span class="builtintype" id="2813045">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813051">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813112">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813169">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813173">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813247">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813316">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813320">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813390">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813459">Method</span><span class="op" id="2813465">(</span><span class="builtintype" id="2813466">int</span><span class="op" id="2813469">)</span>&nbsp;<span class="ident" id="2813471">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813480">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813545">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813610">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813614">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813688">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813757">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813761">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813831">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2813900">MethodByName</span><span class="op" id="2813912">(</span><span class="builtintype" id="2813913">string</span><span class="op" id="2813919">)</span>&nbsp;<span class="op" id="2813921">(</span><span class="ident" id="2813922">Method</span><span class="op" id="2813928">,</span>&nbsp;<span class="builtintype" id="2813930">bool</span><span class="op" id="2813934">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2813938">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814008">NumMethod</span><span class="op" id="2814017">(</span><span class="op" id="2814018">)</span>&nbsp;<span class="builtintype" id="2814020">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814026">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814079">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814129">Name</span><span class="op" id="2814133">(</span><span class="op" id="2814134">)</span>&nbsp;<span class="builtintype" id="2814136">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814145">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814219">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814288">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814370">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814417">PkgPath</span><span class="op" id="2814424">(</span><span class="op" id="2814425">)</span>&nbsp;<span class="builtintype" id="2814427">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814436">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814489">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814554">Size</span><span class="op" id="2814558">(</span><span class="op" id="2814559">)</span>&nbsp;<span class="builtintype" id="2814561">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814571">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814627">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814689">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814748">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814812">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814844">String</span><span class="op" id="2814850">(</span><span class="op" id="2814851">)</span>&nbsp;<span class="builtintype" id="2814853">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814862">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814911">Kind</span><span class="op" id="2814915">(</span><span class="op" id="2814916">)</span>&nbsp;<span class="ident" id="2814918">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2814925">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2814998">Implements</span><span class="op" id="2815008">(</span><span class="ident" id="2815009">u</span>&nbsp;<span class="ident" id="2815011">Type</span><span class="op" id="2815015">)</span>&nbsp;<span class="builtintype" id="2815017">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815024">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815102">AssignableTo</span><span class="op" id="2815114">(</span><span class="ident" id="2815115">u</span>&nbsp;<span class="ident" id="2815117">Type</span><span class="op" id="2815121">)</span>&nbsp;<span class="builtintype" id="2815123">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815130">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815210">ConvertibleTo</span><span class="op" id="2815223">(</span><span class="ident" id="2815224">u</span>&nbsp;<span class="ident" id="2815226">Type</span><span class="op" id="2815230">)</span>&nbsp;<span class="builtintype" id="2815232">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815239">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815306">Comparable</span><span class="op" id="2815316">(</span><span class="op" id="2815317">)</span>&nbsp;<span class="builtintype" id="2815319">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815326">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815388">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815431">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815435">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815475">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815496">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815520">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815566">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815585">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815599">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815615">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815688">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815735">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815786">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815843">Bits</span><span class="op" id="2815847">(</span><span class="op" id="2815848">)</span>&nbsp;<span class="builtintype" id="2815850">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815856">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815904">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2815950">ChanDir</span><span class="op" id="2815957">(</span><span class="op" id="2815958">)</span>&nbsp;<span class="ident" id="2815960">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2815970">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816041">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816119">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816149">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816153">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816224">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816228">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816247">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816289">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816337">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816364">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816368">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816422">IsVariadic</span><span class="op" id="2816432">(</span><span class="op" id="2816433">)</span>&nbsp;<span class="builtintype" id="2816435">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816442">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816482">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816555">Elem</span><span class="op" id="2816559">(</span><span class="op" id="2816560">)</span>&nbsp;<span class="ident" id="2816562">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816569">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816615">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816663">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816719">Field</span><span class="op" id="2816724">(</span><span class="ident" id="2816725">i</span>&nbsp;<span class="builtintype" id="2816727">int</span><span class="op" id="2816730">)</span>&nbsp;<span class="ident" id="2816732">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816746">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816802">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816864">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816899">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2816947">FieldByIndex</span><span class="op" id="2816959">(</span><span class="ident" id="2816960">index</span>&nbsp;<span class="op" id="2816966">[</span><span class="op" id="2816967">]</span><span class="builtintype" id="2816968">int</span><span class="op" id="2816971">)</span>&nbsp;<span class="ident" id="2816973">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2816987">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817048">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817101">FieldByName</span><span class="op" id="2817112">(</span><span class="ident" id="2817113">name</span>&nbsp;<span class="builtintype" id="2817118">string</span><span class="op" id="2817124">)</span>&nbsp;<span class="op" id="2817126">(</span><span class="ident" id="2817127">StructField</span><span class="op" id="2817138">,</span>&nbsp;<span class="builtintype" id="2817140">bool</span><span class="op" id="2817144">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817148">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817211">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817277">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817302">FieldByNameFunc</span><span class="op" id="2817317">(</span><span class="ident" id="2817318">match</span>&nbsp;<span class="keyword" id="2817324">func</span><span class="op" id="2817328">(</span><span class="builtintype" id="2817329">string</span><span class="op" id="2817335">)</span>&nbsp;<span class="builtintype" id="2817337">bool</span><span class="op" id="2817341">)</span>&nbsp;<span class="op" id="2817343">(</span><span class="ident" id="2817344">StructField</span><span class="op" id="2817355">,</span>&nbsp;<span class="builtintype" id="2817357">bool</span><span class="op" id="2817361">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817365">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817432">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817478">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817531">In</span><span class="op" id="2817533">(</span><span class="ident" id="2817534">i</span>&nbsp;<span class="builtintype" id="2817536">int</span><span class="op" id="2817539">)</span>&nbsp;<span class="ident" id="2817541">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817548">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817587">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817632">Key</span><span class="op" id="2817635">(</span><span class="op" id="2817636">)</span>&nbsp;<span class="ident" id="2817638">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817645">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817685">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817732">Len</span><span class="op" id="2817735">(</span><span class="op" id="2817736">)</span>&nbsp;<span class="builtintype" id="2817738">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817744">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817794">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817842">NumField</span><span class="op" id="2817850">(</span><span class="op" id="2817851">)</span>&nbsp;<span class="builtintype" id="2817853">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817859">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817918">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817964">NumIn</span><span class="op" id="2817969">(</span><span class="op" id="2817970">)</span>&nbsp;<span class="builtintype" id="2817972">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2817978">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2818039">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818085">NumOut</span><span class="op" id="2818091">(</span><span class="op" id="2818092">)</span>&nbsp;<span class="builtintype" id="2818094">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2818100">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2818169">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2818215">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818269">Out</span><span class="op" id="2818272">(</span><span class="ident" id="2818273">i</span>&nbsp;<span class="builtintype" id="2818275">int</span><span class="op" id="2818278">)</span>&nbsp;<span class="ident" id="2818280">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818287">common</span><span class="op" id="2818293">(</span><span class="op" id="2818294">)</span>&nbsp;<span class="op" id="2818296">*</span><span class="ident" id="2818297">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818304">uncommon</span><span class="op" id="2818312">(</span><span class="op" id="2818313">)</span>&nbsp;<span class="op" id="2818315">*</span><span class="ident" id="2818316">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2818329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2818332">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2818419">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2818492">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2818569">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2818641">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2818704">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2818791">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818839">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2819034">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2819105">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2819143">type</span>&nbsp;<span class="ident" id="2819148">Kind</span>&nbsp;<span class="builtintype" id="2819153">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2819159">const</span>&nbsp;<span class="op" id="2819165">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819168">Invalid</span>&nbsp;<span class="ident" id="2819176">Kind</span>&nbsp;<span class="op" id="2819181">=</span>&nbsp;<span class="ident" id="2819183">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819189">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819195">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819200">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819206">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819213">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819220">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819227">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819233">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819240">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819248">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819256">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819264">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819273">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819282">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819291">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819302">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819314">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819321">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819327">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819333">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819344">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819349">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819354">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819361">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819369">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819377">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2819391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2819394">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2819448">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2819508">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2819571">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2819637">type</span>&nbsp;<span class="ident" id="2819642">rtype</span>&nbsp;<span class="keyword" id="2819648">struct</span>&nbsp;<span class="op" id="2819655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819658">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2819672">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819681">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2819695">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819713">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819765">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2819779">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819797">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819816">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2819830">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819848">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819889">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2819903">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819921">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819966">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2819980">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2819998">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820020">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820034">*</span><span class="ident" id="2820035">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820052">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820100">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820114">[</span><span class="num" id="2820115">2</span><span class="op" id="2820116">]</span><span class="ident" id="2820117">unsafe</span><span class="op" id="2820123">.</span><span class="ident" id="2820124">Pointer</span>&nbsp;<span class="comment" id="2820132">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2820160">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820174">*</span><span class="builtintype" id="2820175">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820192">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820243">*</span><span class="ident" id="2820244">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820275">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820308">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820322">*</span><span class="ident" id="2820323">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820340">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820408">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820422">unsafe</span><span class="op" id="2820428">.</span><span class="ident" id="2820429">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820440">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2820465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2820468">type</span>&nbsp;<span class="ident" id="2820473">typeAlg</span>&nbsp;<span class="keyword" id="2820481">struct</span>&nbsp;<span class="op" id="2820488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2820491">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2820537">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820577">hash</span>&nbsp;<span class="keyword" id="2820582">func</span><span class="op" id="2820586">(</span><span class="ident" id="2820587">unsafe</span><span class="op" id="2820593">.</span><span class="ident" id="2820594">Pointer</span><span class="op" id="2820601">,</span>&nbsp;<span class="builtintype" id="2820603">uintptr</span><span class="op" id="2820610">,</span>&nbsp;<span class="builtintype" id="2820612">uintptr</span><span class="op" id="2820619">)</span>&nbsp;<span class="builtintype" id="2820621">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2820630">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2820678">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820730">equal</span>&nbsp;<span class="keyword" id="2820736">func</span><span class="op" id="2820740">(</span><span class="ident" id="2820741">unsafe</span><span class="op" id="2820747">.</span><span class="ident" id="2820748">Pointer</span><span class="op" id="2820755">,</span>&nbsp;<span class="ident" id="2820757">unsafe</span><span class="op" id="2820763">.</span><span class="ident" id="2820764">Pointer</span><span class="op" id="2820771">,</span>&nbsp;<span class="builtintype" id="2820773">uintptr</span><span class="op" id="2820780">)</span>&nbsp;<span class="builtintype" id="2820782">bool</span><br>
<span class="lineno"></span><span class="op" id="2820787">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2820790">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2820822">type</span>&nbsp;<span class="ident" id="2820827">method</span>&nbsp;<span class="keyword" id="2820834">struct</span>&nbsp;<span class="op" id="2820841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820844">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820852">*</span><span class="builtintype" id="2820853">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820867">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820886">pkgPath</span>&nbsp;<span class="op" id="2820894">*</span><span class="builtintype" id="2820895">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820909">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820959">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820967">*</span><span class="ident" id="2820968">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820982">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821017">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821025">*</span><span class="ident" id="2821026">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821040">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821084">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821092">unsafe</span><span class="op" id="2821098">.</span><span class="ident" id="2821099">Pointer</span>&nbsp;<span class="comment" id="2821107">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821157">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821165">unsafe</span><span class="op" id="2821171">.</span><span class="ident" id="2821172">Pointer</span>&nbsp;<span class="comment" id="2821180">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2821214">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2821217">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2821281">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2821353">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2821421">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2821469">type</span>&nbsp;<span class="ident" id="2821474">uncommonType</span>&nbsp;<span class="keyword" id="2821487">struct</span>&nbsp;<span class="op" id="2821494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821497">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821505">*</span><span class="builtintype" id="2821506">string</span>&nbsp;&nbsp;<span class="comment" id="2821514">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821531">pkgPath</span>&nbsp;<span class="op" id="2821539">*</span><span class="builtintype" id="2821540">string</span>&nbsp;&nbsp;<span class="comment" id="2821548">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821605">methods</span>&nbsp;<span class="op" id="2821613">[</span><span class="op" id="2821614">]</span><span class="ident" id="2821615">method</span>&nbsp;<span class="comment" id="2821622">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2821654">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2821657">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2821707">type</span>&nbsp;<span class="ident" id="2821712">ChanDir</span>&nbsp;<span class="builtintype" id="2821720">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2821725">const</span>&nbsp;<span class="op" id="2821731">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821734">RecvDir</span>&nbsp;<span class="ident" id="2821742">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821762">=</span>&nbsp;<span class="num" id="2821764">1</span>&nbsp;<span class="op" id="2821766">&lt;&lt;</span>&nbsp;<span class="ident" id="2821769">iota</span>&nbsp;<span class="comment" id="2821774">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821785">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821825">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821836">BothDir</span>&nbsp;<span class="op" id="2821844">=</span>&nbsp;<span class="ident" id="2821846">RecvDir</span>&nbsp;<span class="op" id="2821854">|</span>&nbsp;<span class="ident" id="2821856">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821876">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2821884">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2821887">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2821931">type</span>&nbsp;<span class="ident" id="2821936">arrayType</span>&nbsp;<span class="keyword" id="2821946">struct</span>&nbsp;<span class="op" id="2821953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821956">rtype</span>&nbsp;<span class="string" id="2821962">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2821981">elem</span>&nbsp;&nbsp;<span class="op" id="2821987">*</span><span class="ident" id="2821988">rtype</span>&nbsp;<span class="comment" id="2821994">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822017">slice</span>&nbsp;<span class="op" id="2822023">*</span><span class="ident" id="2822024">rtype</span>&nbsp;<span class="comment" id="2822030">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2822045">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2822051">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2822059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2822062">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2822101">type</span>&nbsp;<span class="ident" id="2822106">chanType</span>&nbsp;<span class="keyword" id="2822115">struct</span>&nbsp;<span class="op" id="2822122">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822125">rtype</span>&nbsp;<span class="string" id="2822131">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822149">elem</span>&nbsp;&nbsp;<span class="op" id="2822155">*</span><span class="ident" id="2822156">rtype</span>&nbsp;&nbsp;<span class="comment" id="2822163">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822188">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2822194">uintptr</span>&nbsp;<span class="comment" id="2822202">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2822233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2822236">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2822276">type</span>&nbsp;<span class="ident" id="2822281">funcType</span>&nbsp;<span class="keyword" id="2822290">struct</span>&nbsp;<span class="op" id="2822297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822300">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2822310">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822328">dotdotdot</span>&nbsp;<span class="builtintype" id="2822338">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822347">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822379">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822389">[</span><span class="op" id="2822390">]</span><span class="op" id="2822391">*</span><span class="ident" id="2822392">rtype</span>&nbsp;<span class="comment" id="2822398">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822424">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822434">[</span><span class="op" id="2822435">]</span><span class="op" id="2822436">*</span><span class="ident" id="2822437">rtype</span>&nbsp;<span class="comment" id="2822443">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2822469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2822472">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2822524">type</span>&nbsp;<span class="ident" id="2822529">imethod</span>&nbsp;<span class="keyword" id="2822537">struct</span>&nbsp;<span class="op" id="2822544">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822547">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822555">*</span><span class="builtintype" id="2822556">string</span>&nbsp;<span class="comment" id="2822563">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822582">pkgPath</span>&nbsp;<span class="op" id="2822590">*</span><span class="builtintype" id="2822591">string</span>&nbsp;<span class="comment" id="2822598">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822648">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822656">*</span><span class="ident" id="2822657">rtype</span>&nbsp;&nbsp;<span class="comment" id="2822664">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2822691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2822694">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2822741">type</span>&nbsp;<span class="ident" id="2822746">interfaceType</span>&nbsp;<span class="keyword" id="2822760">struct</span>&nbsp;<span class="op" id="2822767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822770">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2822778">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822801">methods</span>&nbsp;<span class="op" id="2822809">[</span><span class="op" id="2822810">]</span><span class="ident" id="2822811">imethod</span>&nbsp;<span class="comment" id="2822819">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2822837">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2822840">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2822874">type</span>&nbsp;<span class="ident" id="2822879">mapType</span>&nbsp;<span class="keyword" id="2822887">struct</span>&nbsp;<span class="op" id="2822894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822897">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2822911">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822928">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822942">*</span><span class="ident" id="2822943">rtype</span>&nbsp;<span class="comment" id="2822949">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2822966">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822980">*</span><span class="ident" id="2822981">rtype</span>&nbsp;<span class="comment" id="2822987">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823016">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823030">*</span><span class="ident" id="2823031">rtype</span>&nbsp;<span class="comment" id="2823037">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823067">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823081">*</span><span class="ident" id="2823082">rtype</span>&nbsp;<span class="comment" id="2823088">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823112">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823126">uint8</span>&nbsp;&nbsp;<span class="comment" id="2823133">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823154">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823168">uint8</span>&nbsp;&nbsp;<span class="comment" id="2823175">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823218">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823232">uint8</span>&nbsp;&nbsp;<span class="comment" id="2823239">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823262">indirectvalue</span>&nbsp;<span class="builtintype" id="2823276">uint8</span>&nbsp;&nbsp;<span class="comment" id="2823283">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823330">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2823344">uint16</span>&nbsp;<span class="comment" id="2823351">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2823369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2823372">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2823410">type</span>&nbsp;<span class="ident" id="2823415">ptrType</span>&nbsp;<span class="keyword" id="2823423">struct</span>&nbsp;<span class="op" id="2823430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823433">rtype</span>&nbsp;<span class="string" id="2823439">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823456">elem</span>&nbsp;&nbsp;<span class="op" id="2823462">*</span><span class="ident" id="2823463">rtype</span>&nbsp;<span class="comment" id="2823469">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2823506">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2823509">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2823547">type</span>&nbsp;<span class="ident" id="2823552">sliceType</span>&nbsp;<span class="keyword" id="2823562">struct</span>&nbsp;<span class="op" id="2823569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823572">rtype</span>&nbsp;<span class="string" id="2823578">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823597">elem</span>&nbsp;&nbsp;<span class="op" id="2823603">*</span><span class="ident" id="2823604">rtype</span>&nbsp;<span class="comment" id="2823610">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2823632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2823635">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2823651">type</span>&nbsp;<span class="ident" id="2823656">structField</span>&nbsp;<span class="keyword" id="2823668">struct</span>&nbsp;<span class="op" id="2823675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823678">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823686">*</span><span class="builtintype" id="2823687">string</span>&nbsp;<span class="comment" id="2823694">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823722">pkgPath</span>&nbsp;<span class="op" id="2823730">*</span><span class="builtintype" id="2823731">string</span>&nbsp;<span class="comment" id="2823738">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823788">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823796">*</span><span class="ident" id="2823797">rtype</span>&nbsp;&nbsp;<span class="comment" id="2823804">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823822">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823830">*</span><span class="builtintype" id="2823831">string</span>&nbsp;<span class="comment" id="2823838">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823856">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2823864">uintptr</span>&nbsp;<span class="comment" id="2823872">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2823910">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2823913">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2823953">type</span>&nbsp;<span class="ident" id="2823958">structType</span>&nbsp;<span class="keyword" id="2823969">struct</span>&nbsp;<span class="op" id="2823976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2823979">rtype</span>&nbsp;&nbsp;<span class="string" id="2823986">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824006">fields</span>&nbsp;<span class="op" id="2824013">[</span><span class="op" id="2824014">]</span><span class="ident" id="2824015">structField</span>&nbsp;<span class="comment" id="2824027">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2824047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2824050">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2824206">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2824244">type</span>&nbsp;<span class="ident" id="2824249">Method</span>&nbsp;<span class="keyword" id="2824256">struct</span>&nbsp;<span class="op" id="2824263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824266">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824295">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824368">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824438">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824507">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2824528">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824589">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2824597">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824605">PkgPath</span>&nbsp;<span class="builtintype" id="2824613">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824622">Type</span>&nbsp;&nbsp;<span class="ident" id="2824628">Type</span>&nbsp;&nbsp;<span class="comment" id="2824634">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824650">Func</span>&nbsp;&nbsp;<span class="ident" id="2824656">Value</span>&nbsp;<span class="comment" id="2824662">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824703">Index</span>&nbsp;<span class="builtintype" id="2824709">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2824715">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2824740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2824743">const</span>&nbsp;<span class="op" id="2824749">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824752">kindDirectIface</span>&nbsp;<span class="op" id="2824768">=</span>&nbsp;<span class="num" id="2824770">1</span>&nbsp;<span class="op" id="2824772">&lt;&lt;</span>&nbsp;<span class="num" id="2824775">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824778">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824794">=</span>&nbsp;<span class="num" id="2824796">1</span>&nbsp;<span class="op" id="2824798">&lt;&lt;</span>&nbsp;<span class="num" id="2824801">6</span>&nbsp;<span class="comment" id="2824803">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824836">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2824852">=</span>&nbsp;<span class="num" id="2824854">1</span>&nbsp;<span class="op" id="2824856">&lt;&lt;</span>&nbsp;<span class="num" id="2824859">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2824862">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2824878">=</span>&nbsp;<span class="op" id="2824880">(</span><span class="num" id="2824881">1</span>&nbsp;<span class="op" id="2824883">&lt;&lt;</span>&nbsp;<span class="num" id="2824886">5</span><span class="op" id="2824887">)</span>&nbsp;<span class="op" id="2824889">-</span>&nbsp;<span class="num" id="2824891">1</span><br>
<span class="lineno"></span><span class="op" id="2824893">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2824896">func</span>&nbsp;<span class="op" id="2824901">(</span><span class="ident" id="2824902">k</span>&nbsp;<span class="ident" id="2824904">Kind</span><span class="op" id="2824908">)</span>&nbsp;<span class="ident" id="2824910">String</span><span class="op" id="2824916">(</span><span class="op" id="2824917">)</span>&nbsp;<span class="builtintype" id="2824919">string</span>&nbsp;<span class="op" id="2824926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824929">if</span>&nbsp;<span class="builtintype" id="2824932">int</span><span class="op" id="2824935">(</span><span class="ident" id="2824936">k</span><span class="op" id="2824937">)</span>&nbsp;<span class="op" id="2824939">&lt;</span>&nbsp;<span class="builtinfunc" id="2824941">len</span><span class="op" id="2824944">(</span><span class="ident" id="2824945">kindNames</span><span class="op" id="2824954">)</span>&nbsp;<span class="op" id="2824956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824960">return</span>&nbsp;<span class="ident" id="2824967">kindNames</span><span class="op" id="2824976">[</span><span class="ident" id="2824977">k</span><span class="op" id="2824978">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2824981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2824984">return</span>&nbsp;<span class="string" id="2824991">&#34;kind&#34;</span>&nbsp;<span class="op" id="2824998">+</span>&nbsp;<span class="ident" id="2825000">strconv</span><span class="op" id="2825007">.</span><span class="ident" id="2825008">Itoa</span><span class="op" id="2825012">(</span><span class="builtintype" id="2825013">int</span><span class="op" id="2825016">(</span><span class="ident" id="2825017">k</span><span class="op" id="2825018">)</span><span class="op" id="2825019">)</span><br>
<span class="lineno">410</span><span class="op" id="2825021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2825024">var</span>&nbsp;<span class="ident" id="2825028">kindNames</span>&nbsp;<span class="op" id="2825038">=</span>&nbsp;<span class="op" id="2825040">[</span><span class="op" id="2825041">]</span><span class="builtintype" id="2825042">string</span><span class="op" id="2825048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825051">Invalid</span><span class="op" id="2825058">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825066">&#34;invalid&#34;</span><span class="op" id="2825075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825078">Bool</span><span class="op" id="2825082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825093">&#34;bool&#34;</span><span class="op" id="2825099">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825102">Int</span><span class="op" id="2825105">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825117">&#34;int&#34;</span><span class="op" id="2825122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825125">Int8</span><span class="op" id="2825129">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825140">&#34;int8&#34;</span><span class="op" id="2825146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825149">Int16</span><span class="op" id="2825154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825164">&#34;int16&#34;</span><span class="op" id="2825171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825174">Int32</span><span class="op" id="2825179">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825189">&#34;int32&#34;</span><span class="op" id="2825196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825199">Int64</span><span class="op" id="2825204">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825214">&#34;int64&#34;</span><span class="op" id="2825221">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825224">Uint</span><span class="op" id="2825228">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825239">&#34;uint&#34;</span><span class="op" id="2825245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825248">Uint8</span><span class="op" id="2825253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825263">&#34;uint8&#34;</span><span class="op" id="2825270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825273">Uint16</span><span class="op" id="2825279">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825288">&#34;uint16&#34;</span><span class="op" id="2825296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825299">Uint32</span><span class="op" id="2825305">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825314">&#34;uint32&#34;</span><span class="op" id="2825322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825325">Uint64</span><span class="op" id="2825331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825340">&#34;uint64&#34;</span><span class="op" id="2825348">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825351">Uintptr</span><span class="op" id="2825358">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825366">&#34;uintptr&#34;</span><span class="op" id="2825375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825378">Float32</span><span class="op" id="2825385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825393">&#34;float32&#34;</span><span class="op" id="2825402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825405">Float64</span><span class="op" id="2825412">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825420">&#34;float64&#34;</span><span class="op" id="2825429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825432">Complex64</span><span class="op" id="2825441">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825447">&#34;complex64&#34;</span><span class="op" id="2825458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825461">Complex128</span><span class="op" id="2825471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825476">&#34;complex128&#34;</span><span class="op" id="2825488">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825491">Array</span><span class="op" id="2825496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825506">&#34;array&#34;</span><span class="op" id="2825513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825516">Chan</span><span class="op" id="2825520">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825531">&#34;chan&#34;</span><span class="op" id="2825537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825540">Func</span><span class="op" id="2825544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825555">&#34;func&#34;</span><span class="op" id="2825561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825564">Interface</span><span class="op" id="2825573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825579">&#34;interface&#34;</span><span class="op" id="2825590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825593">Map</span><span class="op" id="2825596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825608">&#34;map&#34;</span><span class="op" id="2825613">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825616">Ptr</span><span class="op" id="2825619">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825631">&#34;ptr&#34;</span><span class="op" id="2825636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825639">Slice</span><span class="op" id="2825644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825654">&#34;slice&#34;</span><span class="op" id="2825661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825664">String</span><span class="op" id="2825670">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825679">&#34;string&#34;</span><span class="op" id="2825687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825690">Struct</span><span class="op" id="2825696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2825705">&#34;struct&#34;</span><span class="op" id="2825713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2825716">UnsafePointer</span><span class="op" id="2825729">:</span>&nbsp;<span class="string" id="2825731">&#34;unsafe.Pointer&#34;</span><span class="op" id="2825747">,</span><br>
<span class="lineno">440</span><span class="op" id="2825749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2825752">func</span>&nbsp;<span class="op" id="2825757">(</span><span class="ident" id="2825758">t</span>&nbsp;<span class="op" id="2825760">*</span><span class="ident" id="2825761">uncommonType</span><span class="op" id="2825773">)</span>&nbsp;<span class="ident" id="2825775">uncommon</span><span class="op" id="2825783">(</span><span class="op" id="2825784">)</span>&nbsp;<span class="op" id="2825786">*</span><span class="ident" id="2825787">uncommonType</span>&nbsp;<span class="op" id="2825800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825803">return</span>&nbsp;<span class="ident" id="2825810">t</span><br>
<span class="lineno"></span><span class="op" id="2825812">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2825815">func</span>&nbsp;<span class="op" id="2825820">(</span><span class="ident" id="2825821">t</span>&nbsp;<span class="op" id="2825823">*</span><span class="ident" id="2825824">uncommonType</span><span class="op" id="2825836">)</span>&nbsp;<span class="ident" id="2825838">PkgPath</span><span class="op" id="2825845">(</span><span class="op" id="2825846">)</span>&nbsp;<span class="builtintype" id="2825848">string</span>&nbsp;<span class="op" id="2825855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825858">if</span>&nbsp;<span class="ident" id="2825861">t</span>&nbsp;<span class="op" id="2825863">==</span>&nbsp;<span class="ident" id="2825866">nil</span>&nbsp;<span class="op" id="2825870">||</span>&nbsp;<span class="ident" id="2825873">t</span><span class="op" id="2825874">.</span><span class="ident" id="2825875">pkgPath</span>&nbsp;<span class="op" id="2825883">==</span>&nbsp;<span class="ident" id="2825886">nil</span>&nbsp;<span class="op" id="2825890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825894">return</span>&nbsp;<span class="string" id="2825901">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2825905">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825908">return</span>&nbsp;<span class="op" id="2825915">*</span><span class="ident" id="2825916">t</span><span class="op" id="2825917">.</span><span class="ident" id="2825918">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2825926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2825929">func</span>&nbsp;<span class="op" id="2825934">(</span><span class="ident" id="2825935">t</span>&nbsp;<span class="op" id="2825937">*</span><span class="ident" id="2825938">uncommonType</span><span class="op" id="2825950">)</span>&nbsp;<span class="ident" id="2825952">Name</span><span class="op" id="2825956">(</span><span class="op" id="2825957">)</span>&nbsp;<span class="builtintype" id="2825959">string</span>&nbsp;<span class="op" id="2825966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2825969">if</span>&nbsp;<span class="ident" id="2825972">t</span>&nbsp;<span class="op" id="2825974">==</span>&nbsp;<span class="ident" id="2825977">nil</span>&nbsp;<span class="op" id="2825981">||</span>&nbsp;<span class="ident" id="2825984">t</span><span class="op" id="2825985">.</span><span class="ident" id="2825986">name</span>&nbsp;<span class="op" id="2825991">==</span>&nbsp;<span class="ident" id="2825994">nil</span>&nbsp;<span class="op" id="2825998">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826002">return</span>&nbsp;<span class="string" id="2826009">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2826013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826016">return</span>&nbsp;<span class="op" id="2826023">*</span><span class="ident" id="2826024">t</span><span class="op" id="2826025">.</span><span class="ident" id="2826026">name</span><br>
<span class="lineno"></span><span class="op" id="2826031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2826034">func</span>&nbsp;<span class="op" id="2826039">(</span><span class="ident" id="2826040">t</span>&nbsp;<span class="op" id="2826042">*</span><span class="ident" id="2826043">rtype</span><span class="op" id="2826048">)</span>&nbsp;<span class="ident" id="2826050">String</span><span class="op" id="2826056">(</span><span class="op" id="2826057">)</span>&nbsp;<span class="builtintype" id="2826059">string</span>&nbsp;<span class="op" id="2826066">{</span>&nbsp;<span class="keyword" id="2826068">return</span>&nbsp;<span class="op" id="2826075">*</span><span class="ident" id="2826076">t</span><span class="op" id="2826077">.</span><span class="builtintype" id="2826078">string</span>&nbsp;<span class="op" id="2826085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2826088">func</span>&nbsp;<span class="op" id="2826093">(</span><span class="ident" id="2826094">t</span>&nbsp;<span class="op" id="2826096">*</span><span class="ident" id="2826097">rtype</span><span class="op" id="2826102">)</span>&nbsp;<span class="ident" id="2826104">Size</span><span class="op" id="2826108">(</span><span class="op" id="2826109">)</span>&nbsp;<span class="builtintype" id="2826111">uintptr</span>&nbsp;<span class="op" id="2826119">{</span>&nbsp;<span class="keyword" id="2826121">return</span>&nbsp;<span class="ident" id="2826128">t</span><span class="op" id="2826129">.</span><span class="ident" id="2826130">size</span>&nbsp;<span class="op" id="2826135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2826138">func</span>&nbsp;<span class="op" id="2826143">(</span><span class="ident" id="2826144">t</span>&nbsp;<span class="op" id="2826146">*</span><span class="ident" id="2826147">rtype</span><span class="op" id="2826152">)</span>&nbsp;<span class="ident" id="2826154">Bits</span><span class="op" id="2826158">(</span><span class="op" id="2826159">)</span>&nbsp;<span class="builtintype" id="2826161">int</span>&nbsp;<span class="op" id="2826165">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826168">if</span>&nbsp;<span class="ident" id="2826171">t</span>&nbsp;<span class="op" id="2826173">==</span>&nbsp;<span class="ident" id="2826176">nil</span>&nbsp;<span class="op" id="2826180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2826184">panic</span><span class="op" id="2826189">(</span><span class="string" id="2826190">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2826217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2826220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826223">k</span>&nbsp;<span class="op" id="2826225">:=</span>&nbsp;<span class="ident" id="2826228">t</span><span class="op" id="2826229">.</span><span class="ident" id="2826230">Kind</span><span class="op" id="2826234">(</span><span class="op" id="2826235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826238">if</span>&nbsp;<span class="ident" id="2826241">k</span>&nbsp;<span class="op" id="2826243">&lt;</span>&nbsp;<span class="ident" id="2826245">Int</span>&nbsp;<span class="op" id="2826249">||</span>&nbsp;<span class="ident" id="2826252">k</span>&nbsp;<span class="op" id="2826254">&gt;</span>&nbsp;<span class="ident" id="2826256">Complex128</span>&nbsp;<span class="op" id="2826267">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2826271">panic</span><span class="op" id="2826276">(</span><span class="string" id="2826277">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2826317">+</span>&nbsp;<span class="ident" id="2826319">t</span><span class="op" id="2826320">.</span><span class="ident" id="2826321">String</span><span class="op" id="2826327">(</span><span class="op" id="2826328">)</span><span class="op" id="2826329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2826332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826335">return</span>&nbsp;<span class="builtintype" id="2826342">int</span><span class="op" id="2826345">(</span><span class="ident" id="2826346">t</span><span class="op" id="2826347">.</span><span class="ident" id="2826348">size</span><span class="op" id="2826352">)</span>&nbsp;<span class="op" id="2826354">*</span>&nbsp;<span class="num" id="2826356">8</span><br>
<span class="lineno"></span><span class="op" id="2826358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2826361">func</span>&nbsp;<span class="op" id="2826366">(</span><span class="ident" id="2826367">t</span>&nbsp;<span class="op" id="2826369">*</span><span class="ident" id="2826370">rtype</span><span class="op" id="2826375">)</span>&nbsp;<span class="ident" id="2826377">Align</span><span class="op" id="2826382">(</span><span class="op" id="2826383">)</span>&nbsp;<span class="builtintype" id="2826385">int</span>&nbsp;<span class="op" id="2826389">{</span>&nbsp;<span class="keyword" id="2826391">return</span>&nbsp;<span class="builtintype" id="2826398">int</span><span class="op" id="2826401">(</span><span class="ident" id="2826402">t</span><span class="op" id="2826403">.</span><span class="ident" id="2826404">align</span><span class="op" id="2826409">)</span>&nbsp;<span class="op" id="2826411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2826414">func</span>&nbsp;<span class="op" id="2826419">(</span><span class="ident" id="2826420">t</span>&nbsp;<span class="op" id="2826422">*</span><span class="ident" id="2826423">rtype</span><span class="op" id="2826428">)</span>&nbsp;<span class="ident" id="2826430">FieldAlign</span><span class="op" id="2826440">(</span><span class="op" id="2826441">)</span>&nbsp;<span class="builtintype" id="2826443">int</span>&nbsp;<span class="op" id="2826447">{</span>&nbsp;<span class="keyword" id="2826449">return</span>&nbsp;<span class="builtintype" id="2826456">int</span><span class="op" id="2826459">(</span><span class="ident" id="2826460">t</span><span class="op" id="2826461">.</span><span class="ident" id="2826462">fieldAlign</span><span class="op" id="2826472">)</span>&nbsp;<span class="op" id="2826474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2826477">func</span>&nbsp;<span class="op" id="2826482">(</span><span class="ident" id="2826483">t</span>&nbsp;<span class="op" id="2826485">*</span><span class="ident" id="2826486">rtype</span><span class="op" id="2826491">)</span>&nbsp;<span class="ident" id="2826493">Kind</span><span class="op" id="2826497">(</span><span class="op" id="2826498">)</span>&nbsp;<span class="ident" id="2826500">Kind</span>&nbsp;<span class="op" id="2826505">{</span>&nbsp;<span class="keyword" id="2826507">return</span>&nbsp;<span class="ident" id="2826514">Kind</span><span class="op" id="2826518">(</span><span class="ident" id="2826519">t</span><span class="op" id="2826520">.</span><span class="ident" id="2826521">kind</span>&nbsp;<span class="op" id="2826526">&amp;</span>&nbsp;<span class="ident" id="2826528">kindMask</span><span class="op" id="2826536">)</span>&nbsp;<span class="op" id="2826538">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2826541">func</span>&nbsp;<span class="op" id="2826546">(</span><span class="ident" id="2826547">t</span>&nbsp;<span class="op" id="2826549">*</span><span class="ident" id="2826550">rtype</span><span class="op" id="2826555">)</span>&nbsp;<span class="ident" id="2826557">pointers</span><span class="op" id="2826565">(</span><span class="op" id="2826566">)</span>&nbsp;<span class="builtintype" id="2826568">bool</span>&nbsp;<span class="op" id="2826573">{</span>&nbsp;<span class="keyword" id="2826575">return</span>&nbsp;<span class="ident" id="2826582">t</span><span class="op" id="2826583">.</span><span class="ident" id="2826584">kind</span><span class="op" id="2826588">&amp;</span><span class="ident" id="2826589">kindNoPointers</span>&nbsp;<span class="op" id="2826604">==</span>&nbsp;<span class="num" id="2826607">0</span>&nbsp;<span class="op" id="2826609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2826612">func</span>&nbsp;<span class="op" id="2826617">(</span><span class="ident" id="2826618">t</span>&nbsp;<span class="op" id="2826620">*</span><span class="ident" id="2826621">rtype</span><span class="op" id="2826626">)</span>&nbsp;<span class="ident" id="2826628">common</span><span class="op" id="2826634">(</span><span class="op" id="2826635">)</span>&nbsp;<span class="op" id="2826637">*</span><span class="ident" id="2826638">rtype</span>&nbsp;<span class="op" id="2826644">{</span>&nbsp;<span class="keyword" id="2826646">return</span>&nbsp;<span class="ident" id="2826653">t</span>&nbsp;<span class="op" id="2826655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2826658">func</span>&nbsp;<span class="op" id="2826663">(</span><span class="ident" id="2826664">t</span>&nbsp;<span class="op" id="2826666">*</span><span class="ident" id="2826667">uncommonType</span><span class="op" id="2826679">)</span>&nbsp;<span class="ident" id="2826681">Method</span><span class="op" id="2826687">(</span><span class="ident" id="2826688">i</span>&nbsp;<span class="builtintype" id="2826690">int</span><span class="op" id="2826693">)</span>&nbsp;<span class="op" id="2826695">(</span><span class="ident" id="2826696">m</span>&nbsp;<span class="ident" id="2826698">Method</span><span class="op" id="2826704">)</span>&nbsp;<span class="op" id="2826706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826709">if</span>&nbsp;<span class="ident" id="2826712">t</span>&nbsp;<span class="op" id="2826714">==</span>&nbsp;<span class="ident" id="2826717">nil</span>&nbsp;<span class="op" id="2826721">||</span>&nbsp;<span class="ident" id="2826724">i</span>&nbsp;<span class="op" id="2826726">&lt;</span>&nbsp;<span class="num" id="2826728">0</span>&nbsp;<span class="op" id="2826730">||</span>&nbsp;<span class="ident" id="2826733">i</span>&nbsp;<span class="op" id="2826735">&gt;=</span>&nbsp;<span class="builtinfunc" id="2826738">len</span><span class="op" id="2826741">(</span><span class="ident" id="2826742">t</span><span class="op" id="2826743">.</span><span class="ident" id="2826744">methods</span><span class="op" id="2826751">)</span>&nbsp;<span class="op" id="2826753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2826757">panic</span><span class="op" id="2826762">(</span><span class="string" id="2826763">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2826799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2826802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826805">p</span>&nbsp;<span class="op" id="2826807">:=</span>&nbsp;<span class="op" id="2826810">&amp;</span><span class="ident" id="2826811">t</span><span class="op" id="2826812">.</span><span class="ident" id="2826813">methods</span><span class="op" id="2826820">[</span><span class="ident" id="2826821">i</span><span class="op" id="2826822">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826825">if</span>&nbsp;<span class="ident" id="2826828">p</span><span class="op" id="2826829">.</span><span class="ident" id="2826830">name</span>&nbsp;<span class="op" id="2826835">!=</span>&nbsp;<span class="ident" id="2826838">nil</span>&nbsp;<span class="op" id="2826842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826846">m</span><span class="op" id="2826847">.</span><span class="ident" id="2826848">Name</span>&nbsp;<span class="op" id="2826853">=</span>&nbsp;<span class="op" id="2826855">*</span><span class="ident" id="2826856">p</span><span class="op" id="2826857">.</span><span class="ident" id="2826858">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2826864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826867">fl</span>&nbsp;<span class="op" id="2826870">:=</span>&nbsp;<span class="ident" id="2826873">flag</span><span class="op" id="2826877">(</span><span class="ident" id="2826878">Func</span><span class="op" id="2826882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2826885">if</span>&nbsp;<span class="ident" id="2826888">p</span><span class="op" id="2826889">.</span><span class="ident" id="2826890">pkgPath</span>&nbsp;<span class="op" id="2826898">!=</span>&nbsp;<span class="ident" id="2826901">nil</span>&nbsp;<span class="op" id="2826905">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826909">m</span><span class="op" id="2826910">.</span><span class="ident" id="2826911">PkgPath</span>&nbsp;<span class="op" id="2826919">=</span>&nbsp;<span class="op" id="2826921">*</span><span class="ident" id="2826922">p</span><span class="op" id="2826923">.</span><span class="ident" id="2826924">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826934">fl</span>&nbsp;<span class="op" id="2826937">|=</span>&nbsp;<span class="ident" id="2826940">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2826948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826951">mt</span>&nbsp;<span class="op" id="2826954">:=</span>&nbsp;<span class="ident" id="2826957">p</span><span class="op" id="2826958">.</span><span class="ident" id="2826959">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826964">m</span><span class="op" id="2826965">.</span><span class="ident" id="2826966">Type</span>&nbsp;<span class="op" id="2826971">=</span>&nbsp;<span class="ident" id="2826973">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2826977">fn</span>&nbsp;<span class="op" id="2826980">:=</span>&nbsp;<span class="ident" id="2826983">unsafe</span><span class="op" id="2826989">.</span><span class="ident" id="2826990">Pointer</span><span class="op" id="2826997">(</span><span class="op" id="2826998">&amp;</span><span class="ident" id="2826999">p</span><span class="op" id="2827000">.</span><span class="ident" id="2827001">tfn</span><span class="op" id="2827004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827007">m</span><span class="op" id="2827008">.</span><span class="ident" id="2827009">Func</span>&nbsp;<span class="op" id="2827014">=</span>&nbsp;<span class="ident" id="2827016">Value</span><span class="op" id="2827021">{</span><span class="ident" id="2827022">mt</span><span class="op" id="2827024">,</span>&nbsp;<span class="ident" id="2827026">fn</span><span class="op" id="2827028">,</span>&nbsp;<span class="ident" id="2827030">fl</span><span class="op" id="2827032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827035">m</span><span class="op" id="2827036">.</span><span class="ident" id="2827037">Index</span>&nbsp;<span class="op" id="2827043">=</span>&nbsp;<span class="ident" id="2827045">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827048">return</span><br>
<span class="lineno"></span><span class="op" id="2827055">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2827058">func</span>&nbsp;<span class="op" id="2827063">(</span><span class="ident" id="2827064">t</span>&nbsp;<span class="op" id="2827066">*</span><span class="ident" id="2827067">uncommonType</span><span class="op" id="2827079">)</span>&nbsp;<span class="ident" id="2827081">NumMethod</span><span class="op" id="2827090">(</span><span class="op" id="2827091">)</span>&nbsp;<span class="builtintype" id="2827093">int</span>&nbsp;<span class="op" id="2827097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827100">if</span>&nbsp;<span class="ident" id="2827103">t</span>&nbsp;<span class="op" id="2827105">==</span>&nbsp;<span class="ident" id="2827108">nil</span>&nbsp;<span class="op" id="2827112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827116">return</span>&nbsp;<span class="num" id="2827123">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2827126">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827129">return</span>&nbsp;<span class="builtinfunc" id="2827136">len</span><span class="op" id="2827139">(</span><span class="ident" id="2827140">t</span><span class="op" id="2827141">.</span><span class="ident" id="2827142">methods</span><span class="op" id="2827149">)</span><br>
<span class="lineno"></span><span class="op" id="2827151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2827154">func</span>&nbsp;<span class="op" id="2827159">(</span><span class="ident" id="2827160">t</span>&nbsp;<span class="op" id="2827162">*</span><span class="ident" id="2827163">uncommonType</span><span class="op" id="2827175">)</span>&nbsp;<span class="ident" id="2827177">MethodByName</span><span class="op" id="2827189">(</span><span class="ident" id="2827190">name</span>&nbsp;<span class="builtintype" id="2827195">string</span><span class="op" id="2827201">)</span>&nbsp;<span class="op" id="2827203">(</span><span class="ident" id="2827204">m</span>&nbsp;<span class="ident" id="2827206">Method</span><span class="op" id="2827212">,</span>&nbsp;<span class="ident" id="2827214">ok</span>&nbsp;<span class="builtintype" id="2827217">bool</span><span class="op" id="2827221">)</span>&nbsp;<span class="op" id="2827223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827226">if</span>&nbsp;<span class="ident" id="2827229">t</span>&nbsp;<span class="op" id="2827231">==</span>&nbsp;<span class="ident" id="2827234">nil</span>&nbsp;<span class="op" id="2827238">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2827250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827253">var</span>&nbsp;<span class="ident" id="2827257">p</span>&nbsp;<span class="op" id="2827259">*</span><span class="ident" id="2827260">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827268">for</span>&nbsp;<span class="ident" id="2827272">i</span>&nbsp;<span class="op" id="2827274">:=</span>&nbsp;<span class="keyword" id="2827277">range</span>&nbsp;<span class="ident" id="2827283">t</span><span class="op" id="2827284">.</span><span class="ident" id="2827285">methods</span>&nbsp;<span class="op" id="2827293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827297">p</span>&nbsp;<span class="op" id="2827299">=</span>&nbsp;<span class="op" id="2827301">&amp;</span><span class="ident" id="2827302">t</span><span class="op" id="2827303">.</span><span class="ident" id="2827304">methods</span><span class="op" id="2827311">[</span><span class="ident" id="2827312">i</span><span class="op" id="2827313">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827317">if</span>&nbsp;<span class="ident" id="2827320">p</span><span class="op" id="2827321">.</span><span class="ident" id="2827322">name</span>&nbsp;<span class="op" id="2827327">!=</span>&nbsp;<span class="ident" id="2827330">nil</span>&nbsp;<span class="op" id="2827334">&amp;&amp;</span>&nbsp;<span class="op" id="2827337">*</span><span class="ident" id="2827338">p</span><span class="op" id="2827339">.</span><span class="ident" id="2827340">name</span>&nbsp;<span class="op" id="2827345">==</span>&nbsp;<span class="ident" id="2827348">name</span>&nbsp;<span class="op" id="2827353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827358">return</span>&nbsp;<span class="ident" id="2827365">t</span><span class="op" id="2827366">.</span><span class="ident" id="2827367">Method</span><span class="op" id="2827373">(</span><span class="ident" id="2827374">i</span><span class="op" id="2827375">)</span><span class="op" id="2827376">,</span>&nbsp;<span class="builtintype" id="2827378">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2827385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2827388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827391">return</span><br>
<span class="lineno">525</span><span class="op" id="2827398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2827401">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2827451">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2827506">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2827544">func</span>&nbsp;<span class="op" id="2827549">(</span><span class="ident" id="2827550">t</span>&nbsp;<span class="op" id="2827552">*</span><span class="ident" id="2827553">rtype</span><span class="op" id="2827558">)</span>&nbsp;<span class="ident" id="2827560">NumMethod</span><span class="op" id="2827569">(</span><span class="op" id="2827570">)</span>&nbsp;<span class="builtintype" id="2827572">int</span>&nbsp;<span class="op" id="2827576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827579">if</span>&nbsp;<span class="ident" id="2827582">t</span><span class="op" id="2827583">.</span><span class="ident" id="2827584">Kind</span><span class="op" id="2827588">(</span><span class="op" id="2827589">)</span>&nbsp;<span class="op" id="2827591">==</span>&nbsp;<span class="ident" id="2827594">Interface</span>&nbsp;<span class="op" id="2827604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827608">tt</span>&nbsp;<span class="op" id="2827611">:=</span>&nbsp;<span class="op" id="2827614">(</span><span class="op" id="2827615">*</span><span class="ident" id="2827616">interfaceType</span><span class="op" id="2827629">)</span><span class="op" id="2827630">(</span><span class="ident" id="2827631">unsafe</span><span class="op" id="2827637">.</span><span class="ident" id="2827638">Pointer</span><span class="op" id="2827645">(</span><span class="ident" id="2827646">t</span><span class="op" id="2827647">)</span><span class="op" id="2827648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827652">return</span>&nbsp;<span class="ident" id="2827659">tt</span><span class="op" id="2827661">.</span><span class="ident" id="2827662">NumMethod</span><span class="op" id="2827671">(</span><span class="op" id="2827672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2827675">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827678">return</span>&nbsp;<span class="ident" id="2827685">t</span><span class="op" id="2827686">.</span><span class="ident" id="2827687">uncommonType</span><span class="op" id="2827699">.</span><span class="ident" id="2827700">NumMethod</span><span class="op" id="2827709">(</span><span class="op" id="2827710">)</span><br>
<span class="lineno"></span><span class="op" id="2827712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2827715">func</span>&nbsp;<span class="op" id="2827720">(</span><span class="ident" id="2827721">t</span>&nbsp;<span class="op" id="2827723">*</span><span class="ident" id="2827724">rtype</span><span class="op" id="2827729">)</span>&nbsp;<span class="ident" id="2827731">Method</span><span class="op" id="2827737">(</span><span class="ident" id="2827738">i</span>&nbsp;<span class="builtintype" id="2827740">int</span><span class="op" id="2827743">)</span>&nbsp;<span class="op" id="2827745">(</span><span class="ident" id="2827746">m</span>&nbsp;<span class="ident" id="2827748">Method</span><span class="op" id="2827754">)</span>&nbsp;<span class="op" id="2827756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827759">if</span>&nbsp;<span class="ident" id="2827762">t</span><span class="op" id="2827763">.</span><span class="ident" id="2827764">Kind</span><span class="op" id="2827768">(</span><span class="op" id="2827769">)</span>&nbsp;<span class="op" id="2827771">==</span>&nbsp;<span class="ident" id="2827774">Interface</span>&nbsp;<span class="op" id="2827784">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827788">tt</span>&nbsp;<span class="op" id="2827791">:=</span>&nbsp;<span class="op" id="2827794">(</span><span class="op" id="2827795">*</span><span class="ident" id="2827796">interfaceType</span><span class="op" id="2827809">)</span><span class="op" id="2827810">(</span><span class="ident" id="2827811">unsafe</span><span class="op" id="2827817">.</span><span class="ident" id="2827818">Pointer</span><span class="op" id="2827825">(</span><span class="ident" id="2827826">t</span><span class="op" id="2827827">)</span><span class="op" id="2827828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827832">return</span>&nbsp;<span class="ident" id="2827839">tt</span><span class="op" id="2827841">.</span><span class="ident" id="2827842">Method</span><span class="op" id="2827848">(</span><span class="ident" id="2827849">i</span><span class="op" id="2827850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2827853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827856">return</span>&nbsp;<span class="ident" id="2827863">t</span><span class="op" id="2827864">.</span><span class="ident" id="2827865">uncommonType</span><span class="op" id="2827877">.</span><span class="ident" id="2827878">Method</span><span class="op" id="2827884">(</span><span class="ident" id="2827885">i</span><span class="op" id="2827886">)</span><br>
<span class="lineno"></span><span class="op" id="2827888">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2827891">func</span>&nbsp;<span class="op" id="2827896">(</span><span class="ident" id="2827897">t</span>&nbsp;<span class="op" id="2827899">*</span><span class="ident" id="2827900">rtype</span><span class="op" id="2827905">)</span>&nbsp;<span class="ident" id="2827907">MethodByName</span><span class="op" id="2827919">(</span><span class="ident" id="2827920">name</span>&nbsp;<span class="builtintype" id="2827925">string</span><span class="op" id="2827931">)</span>&nbsp;<span class="op" id="2827933">(</span><span class="ident" id="2827934">m</span>&nbsp;<span class="ident" id="2827936">Method</span><span class="op" id="2827942">,</span>&nbsp;<span class="ident" id="2827944">ok</span>&nbsp;<span class="builtintype" id="2827947">bool</span><span class="op" id="2827951">)</span>&nbsp;<span class="op" id="2827953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2827956">if</span>&nbsp;<span class="ident" id="2827959">t</span><span class="op" id="2827960">.</span><span class="ident" id="2827961">Kind</span><span class="op" id="2827965">(</span><span class="op" id="2827966">)</span>&nbsp;<span class="op" id="2827968">==</span>&nbsp;<span class="ident" id="2827971">Interface</span>&nbsp;<span class="op" id="2827981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2827985">tt</span>&nbsp;<span class="op" id="2827988">:=</span>&nbsp;<span class="op" id="2827991">(</span><span class="op" id="2827992">*</span><span class="ident" id="2827993">interfaceType</span><span class="op" id="2828006">)</span><span class="op" id="2828007">(</span><span class="ident" id="2828008">unsafe</span><span class="op" id="2828014">.</span><span class="ident" id="2828015">Pointer</span><span class="op" id="2828022">(</span><span class="ident" id="2828023">t</span><span class="op" id="2828024">)</span><span class="op" id="2828025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828029">return</span>&nbsp;<span class="ident" id="2828036">tt</span><span class="op" id="2828038">.</span><span class="ident" id="2828039">MethodByName</span><span class="op" id="2828051">(</span><span class="ident" id="2828052">name</span><span class="op" id="2828056">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828062">return</span>&nbsp;<span class="ident" id="2828069">t</span><span class="op" id="2828070">.</span><span class="ident" id="2828071">uncommonType</span><span class="op" id="2828083">.</span><span class="ident" id="2828084">MethodByName</span><span class="op" id="2828096">(</span><span class="ident" id="2828097">name</span><span class="op" id="2828101">)</span><br>
<span class="lineno"></span><span class="op" id="2828103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2828106">func</span>&nbsp;<span class="op" id="2828111">(</span><span class="ident" id="2828112">t</span>&nbsp;<span class="op" id="2828114">*</span><span class="ident" id="2828115">rtype</span><span class="op" id="2828120">)</span>&nbsp;<span class="ident" id="2828122">PkgPath</span><span class="op" id="2828129">(</span><span class="op" id="2828130">)</span>&nbsp;<span class="builtintype" id="2828132">string</span>&nbsp;<span class="op" id="2828139">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828142">return</span>&nbsp;<span class="ident" id="2828149">t</span><span class="op" id="2828150">.</span><span class="ident" id="2828151">uncommonType</span><span class="op" id="2828163">.</span><span class="ident" id="2828164">PkgPath</span><span class="op" id="2828171">(</span><span class="op" id="2828172">)</span><br>
<span class="lineno"></span><span class="op" id="2828174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2828177">func</span>&nbsp;<span class="op" id="2828182">(</span><span class="ident" id="2828183">t</span>&nbsp;<span class="op" id="2828185">*</span><span class="ident" id="2828186">rtype</span><span class="op" id="2828191">)</span>&nbsp;<span class="ident" id="2828193">Name</span><span class="op" id="2828197">(</span><span class="op" id="2828198">)</span>&nbsp;<span class="builtintype" id="2828200">string</span>&nbsp;<span class="op" id="2828207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828210">return</span>&nbsp;<span class="ident" id="2828217">t</span><span class="op" id="2828218">.</span><span class="ident" id="2828219">uncommonType</span><span class="op" id="2828231">.</span><span class="ident" id="2828232">Name</span><span class="op" id="2828236">(</span><span class="op" id="2828237">)</span><br>
<span class="lineno">560</span><span class="op" id="2828239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2828242">func</span>&nbsp;<span class="op" id="2828247">(</span><span class="ident" id="2828248">t</span>&nbsp;<span class="op" id="2828250">*</span><span class="ident" id="2828251">rtype</span><span class="op" id="2828256">)</span>&nbsp;<span class="ident" id="2828258">ChanDir</span><span class="op" id="2828265">(</span><span class="op" id="2828266">)</span>&nbsp;<span class="ident" id="2828268">ChanDir</span>&nbsp;<span class="op" id="2828276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828279">if</span>&nbsp;<span class="ident" id="2828282">t</span><span class="op" id="2828283">.</span><span class="ident" id="2828284">Kind</span><span class="op" id="2828288">(</span><span class="op" id="2828289">)</span>&nbsp;<span class="op" id="2828291">!=</span>&nbsp;<span class="ident" id="2828294">Chan</span>&nbsp;<span class="op" id="2828299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2828303">panic</span><span class="op" id="2828308">(</span><span class="string" id="2828309">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2828344">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828350">tt</span>&nbsp;<span class="op" id="2828353">:=</span>&nbsp;<span class="op" id="2828356">(</span><span class="op" id="2828357">*</span><span class="ident" id="2828358">chanType</span><span class="op" id="2828366">)</span><span class="op" id="2828367">(</span><span class="ident" id="2828368">unsafe</span><span class="op" id="2828374">.</span><span class="ident" id="2828375">Pointer</span><span class="op" id="2828382">(</span><span class="ident" id="2828383">t</span><span class="op" id="2828384">)</span><span class="op" id="2828385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828388">return</span>&nbsp;<span class="ident" id="2828395">ChanDir</span><span class="op" id="2828402">(</span><span class="ident" id="2828403">tt</span><span class="op" id="2828405">.</span><span class="ident" id="2828406">dir</span><span class="op" id="2828409">)</span><br>
<span class="lineno"></span><span class="op" id="2828411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2828414">func</span>&nbsp;<span class="op" id="2828419">(</span><span class="ident" id="2828420">t</span>&nbsp;<span class="op" id="2828422">*</span><span class="ident" id="2828423">rtype</span><span class="op" id="2828428">)</span>&nbsp;<span class="ident" id="2828430">IsVariadic</span><span class="op" id="2828440">(</span><span class="op" id="2828441">)</span>&nbsp;<span class="builtintype" id="2828443">bool</span>&nbsp;<span class="op" id="2828448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828451">if</span>&nbsp;<span class="ident" id="2828454">t</span><span class="op" id="2828455">.</span><span class="ident" id="2828456">Kind</span><span class="op" id="2828460">(</span><span class="op" id="2828461">)</span>&nbsp;<span class="op" id="2828463">!=</span>&nbsp;<span class="ident" id="2828466">Func</span>&nbsp;<span class="op" id="2828471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2828475">panic</span><span class="op" id="2828480">(</span><span class="string" id="2828481">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2828519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2828522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828525">tt</span>&nbsp;<span class="op" id="2828528">:=</span>&nbsp;<span class="op" id="2828531">(</span><span class="op" id="2828532">*</span><span class="ident" id="2828533">funcType</span><span class="op" id="2828541">)</span><span class="op" id="2828542">(</span><span class="ident" id="2828543">unsafe</span><span class="op" id="2828549">.</span><span class="ident" id="2828550">Pointer</span><span class="op" id="2828557">(</span><span class="ident" id="2828558">t</span><span class="op" id="2828559">)</span><span class="op" id="2828560">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828563">return</span>&nbsp;<span class="ident" id="2828570">tt</span><span class="op" id="2828572">.</span><span class="ident" id="2828573">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2828583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2828586">func</span>&nbsp;<span class="op" id="2828591">(</span><span class="ident" id="2828592">t</span>&nbsp;<span class="op" id="2828594">*</span><span class="ident" id="2828595">rtype</span><span class="op" id="2828600">)</span>&nbsp;<span class="ident" id="2828602">Elem</span><span class="op" id="2828606">(</span><span class="op" id="2828607">)</span>&nbsp;<span class="ident" id="2828609">Type</span>&nbsp;<span class="op" id="2828614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828617">switch</span>&nbsp;<span class="ident" id="2828624">t</span><span class="op" id="2828625">.</span><span class="ident" id="2828626">Kind</span><span class="op" id="2828630">(</span><span class="op" id="2828631">)</span>&nbsp;<span class="op" id="2828633">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828636">case</span>&nbsp;<span class="ident" id="2828641">Array</span><span class="op" id="2828646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828650">tt</span>&nbsp;<span class="op" id="2828653">:=</span>&nbsp;<span class="op" id="2828656">(</span><span class="op" id="2828657">*</span><span class="ident" id="2828658">arrayType</span><span class="op" id="2828667">)</span><span class="op" id="2828668">(</span><span class="ident" id="2828669">unsafe</span><span class="op" id="2828675">.</span><span class="ident" id="2828676">Pointer</span><span class="op" id="2828683">(</span><span class="ident" id="2828684">t</span><span class="op" id="2828685">)</span><span class="op" id="2828686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828690">return</span>&nbsp;<span class="ident" id="2828697">toType</span><span class="op" id="2828703">(</span><span class="ident" id="2828704">tt</span><span class="op" id="2828706">.</span><span class="ident" id="2828707">elem</span><span class="op" id="2828711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828714">case</span>&nbsp;<span class="ident" id="2828719">Chan</span><span class="op" id="2828723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828727">tt</span>&nbsp;<span class="op" id="2828730">:=</span>&nbsp;<span class="op" id="2828733">(</span><span class="op" id="2828734">*</span><span class="ident" id="2828735">chanType</span><span class="op" id="2828743">)</span><span class="op" id="2828744">(</span><span class="ident" id="2828745">unsafe</span><span class="op" id="2828751">.</span><span class="ident" id="2828752">Pointer</span><span class="op" id="2828759">(</span><span class="ident" id="2828760">t</span><span class="op" id="2828761">)</span><span class="op" id="2828762">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828766">return</span>&nbsp;<span class="ident" id="2828773">toType</span><span class="op" id="2828779">(</span><span class="ident" id="2828780">tt</span><span class="op" id="2828782">.</span><span class="ident" id="2828783">elem</span><span class="op" id="2828787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828790">case</span>&nbsp;<span class="ident" id="2828795">Map</span><span class="op" id="2828798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828802">tt</span>&nbsp;<span class="op" id="2828805">:=</span>&nbsp;<span class="op" id="2828808">(</span><span class="op" id="2828809">*</span><span class="ident" id="2828810">mapType</span><span class="op" id="2828817">)</span><span class="op" id="2828818">(</span><span class="ident" id="2828819">unsafe</span><span class="op" id="2828825">.</span><span class="ident" id="2828826">Pointer</span><span class="op" id="2828833">(</span><span class="ident" id="2828834">t</span><span class="op" id="2828835">)</span><span class="op" id="2828836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828840">return</span>&nbsp;<span class="ident" id="2828847">toType</span><span class="op" id="2828853">(</span><span class="ident" id="2828854">tt</span><span class="op" id="2828856">.</span><span class="ident" id="2828857">elem</span><span class="op" id="2828861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828864">case</span>&nbsp;<span class="ident" id="2828869">Ptr</span><span class="op" id="2828872">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828876">tt</span>&nbsp;<span class="op" id="2828879">:=</span>&nbsp;<span class="op" id="2828882">(</span><span class="op" id="2828883">*</span><span class="ident" id="2828884">ptrType</span><span class="op" id="2828891">)</span><span class="op" id="2828892">(</span><span class="ident" id="2828893">unsafe</span><span class="op" id="2828899">.</span><span class="ident" id="2828900">Pointer</span><span class="op" id="2828907">(</span><span class="ident" id="2828908">t</span><span class="op" id="2828909">)</span><span class="op" id="2828910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828914">return</span>&nbsp;<span class="ident" id="2828921">toType</span><span class="op" id="2828927">(</span><span class="ident" id="2828928">tt</span><span class="op" id="2828930">.</span><span class="ident" id="2828931">elem</span><span class="op" id="2828935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828938">case</span>&nbsp;<span class="ident" id="2828943">Slice</span><span class="op" id="2828948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2828952">tt</span>&nbsp;<span class="op" id="2828955">:=</span>&nbsp;<span class="op" id="2828958">(</span><span class="op" id="2828959">*</span><span class="ident" id="2828960">sliceType</span><span class="op" id="2828969">)</span><span class="op" id="2828970">(</span><span class="ident" id="2828971">unsafe</span><span class="op" id="2828977">.</span><span class="ident" id="2828978">Pointer</span><span class="op" id="2828985">(</span><span class="ident" id="2828986">t</span><span class="op" id="2828987">)</span><span class="op" id="2828988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2828992">return</span>&nbsp;<span class="ident" id="2828999">toType</span><span class="op" id="2829005">(</span><span class="ident" id="2829006">tt</span><span class="op" id="2829008">.</span><span class="ident" id="2829009">elem</span><span class="op" id="2829013">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2829019">panic</span><span class="op" id="2829024">(</span><span class="string" id="2829025">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2829056">)</span><br>
<span class="lineno"></span><span class="op" id="2829058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2829061">func</span>&nbsp;<span class="op" id="2829066">(</span><span class="ident" id="2829067">t</span>&nbsp;<span class="op" id="2829069">*</span><span class="ident" id="2829070">rtype</span><span class="op" id="2829075">)</span>&nbsp;<span class="ident" id="2829077">Field</span><span class="op" id="2829082">(</span><span class="ident" id="2829083">i</span>&nbsp;<span class="builtintype" id="2829085">int</span><span class="op" id="2829088">)</span>&nbsp;<span class="ident" id="2829090">StructField</span>&nbsp;<span class="op" id="2829102">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829105">if</span>&nbsp;<span class="ident" id="2829108">t</span><span class="op" id="2829109">.</span><span class="ident" id="2829110">Kind</span><span class="op" id="2829114">(</span><span class="op" id="2829115">)</span>&nbsp;<span class="op" id="2829117">!=</span>&nbsp;<span class="ident" id="2829120">Struct</span>&nbsp;<span class="op" id="2829127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2829131">panic</span><span class="op" id="2829136">(</span><span class="string" id="2829137">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2829172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829178">tt</span>&nbsp;<span class="op" id="2829181">:=</span>&nbsp;<span class="op" id="2829184">(</span><span class="op" id="2829185">*</span><span class="ident" id="2829186">structType</span><span class="op" id="2829196">)</span><span class="op" id="2829197">(</span><span class="ident" id="2829198">unsafe</span><span class="op" id="2829204">.</span><span class="ident" id="2829205">Pointer</span><span class="op" id="2829212">(</span><span class="ident" id="2829213">t</span><span class="op" id="2829214">)</span><span class="op" id="2829215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829218">return</span>&nbsp;<span class="ident" id="2829225">tt</span><span class="op" id="2829227">.</span><span class="ident" id="2829228">Field</span><span class="op" id="2829233">(</span><span class="ident" id="2829234">i</span><span class="op" id="2829235">)</span><br>
<span class="lineno">605</span><span class="op" id="2829237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2829240">func</span>&nbsp;<span class="op" id="2829245">(</span><span class="ident" id="2829246">t</span>&nbsp;<span class="op" id="2829248">*</span><span class="ident" id="2829249">rtype</span><span class="op" id="2829254">)</span>&nbsp;<span class="ident" id="2829256">FieldByIndex</span><span class="op" id="2829268">(</span><span class="ident" id="2829269">index</span>&nbsp;<span class="op" id="2829275">[</span><span class="op" id="2829276">]</span><span class="builtintype" id="2829277">int</span><span class="op" id="2829280">)</span>&nbsp;<span class="ident" id="2829282">StructField</span>&nbsp;<span class="op" id="2829294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829297">if</span>&nbsp;<span class="ident" id="2829300">t</span><span class="op" id="2829301">.</span><span class="ident" id="2829302">Kind</span><span class="op" id="2829306">(</span><span class="op" id="2829307">)</span>&nbsp;<span class="op" id="2829309">!=</span>&nbsp;<span class="ident" id="2829312">Struct</span>&nbsp;<span class="op" id="2829319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2829323">panic</span><span class="op" id="2829328">(</span><span class="string" id="2829329">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2829371">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829377">tt</span>&nbsp;<span class="op" id="2829380">:=</span>&nbsp;<span class="op" id="2829383">(</span><span class="op" id="2829384">*</span><span class="ident" id="2829385">structType</span><span class="op" id="2829395">)</span><span class="op" id="2829396">(</span><span class="ident" id="2829397">unsafe</span><span class="op" id="2829403">.</span><span class="ident" id="2829404">Pointer</span><span class="op" id="2829411">(</span><span class="ident" id="2829412">t</span><span class="op" id="2829413">)</span><span class="op" id="2829414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829417">return</span>&nbsp;<span class="ident" id="2829424">tt</span><span class="op" id="2829426">.</span><span class="ident" id="2829427">FieldByIndex</span><span class="op" id="2829439">(</span><span class="ident" id="2829440">index</span><span class="op" id="2829445">)</span><br>
<span class="lineno"></span><span class="op" id="2829447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2829450">func</span>&nbsp;<span class="op" id="2829455">(</span><span class="ident" id="2829456">t</span>&nbsp;<span class="op" id="2829458">*</span><span class="ident" id="2829459">rtype</span><span class="op" id="2829464">)</span>&nbsp;<span class="ident" id="2829466">FieldByName</span><span class="op" id="2829477">(</span><span class="ident" id="2829478">name</span>&nbsp;<span class="builtintype" id="2829483">string</span><span class="op" id="2829489">)</span>&nbsp;<span class="op" id="2829491">(</span><span class="ident" id="2829492">StructField</span><span class="op" id="2829503">,</span>&nbsp;<span class="builtintype" id="2829505">bool</span><span class="op" id="2829509">)</span>&nbsp;<span class="op" id="2829511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829514">if</span>&nbsp;<span class="ident" id="2829517">t</span><span class="op" id="2829518">.</span><span class="ident" id="2829519">Kind</span><span class="op" id="2829523">(</span><span class="op" id="2829524">)</span>&nbsp;<span class="op" id="2829526">!=</span>&nbsp;<span class="ident" id="2829529">Struct</span>&nbsp;<span class="op" id="2829536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2829540">panic</span><span class="op" id="2829545">(</span><span class="string" id="2829546">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2829587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829593">tt</span>&nbsp;<span class="op" id="2829596">:=</span>&nbsp;<span class="op" id="2829599">(</span><span class="op" id="2829600">*</span><span class="ident" id="2829601">structType</span><span class="op" id="2829611">)</span><span class="op" id="2829612">(</span><span class="ident" id="2829613">unsafe</span><span class="op" id="2829619">.</span><span class="ident" id="2829620">Pointer</span><span class="op" id="2829627">(</span><span class="ident" id="2829628">t</span><span class="op" id="2829629">)</span><span class="op" id="2829630">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829633">return</span>&nbsp;<span class="ident" id="2829640">tt</span><span class="op" id="2829642">.</span><span class="ident" id="2829643">FieldByName</span><span class="op" id="2829654">(</span><span class="ident" id="2829655">name</span><span class="op" id="2829659">)</span><br>
<span class="lineno"></span><span class="op" id="2829661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2829664">func</span>&nbsp;<span class="op" id="2829669">(</span><span class="ident" id="2829670">t</span>&nbsp;<span class="op" id="2829672">*</span><span class="ident" id="2829673">rtype</span><span class="op" id="2829678">)</span>&nbsp;<span class="ident" id="2829680">FieldByNameFunc</span><span class="op" id="2829695">(</span><span class="ident" id="2829696">match</span>&nbsp;<span class="keyword" id="2829702">func</span><span class="op" id="2829706">(</span><span class="builtintype" id="2829707">string</span><span class="op" id="2829713">)</span>&nbsp;<span class="builtintype" id="2829715">bool</span><span class="op" id="2829719">)</span>&nbsp;<span class="op" id="2829721">(</span><span class="ident" id="2829722">StructField</span><span class="op" id="2829733">,</span>&nbsp;<span class="builtintype" id="2829735">bool</span><span class="op" id="2829739">)</span>&nbsp;<span class="op" id="2829741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829744">if</span>&nbsp;<span class="ident" id="2829747">t</span><span class="op" id="2829748">.</span><span class="ident" id="2829749">Kind</span><span class="op" id="2829753">(</span><span class="op" id="2829754">)</span>&nbsp;<span class="op" id="2829756">!=</span>&nbsp;<span class="ident" id="2829759">Struct</span>&nbsp;<span class="op" id="2829766">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2829770">panic</span><span class="op" id="2829775">(</span><span class="string" id="2829776">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2829821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2829824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2829827">tt</span>&nbsp;<span class="op" id="2829830">:=</span>&nbsp;<span class="op" id="2829833">(</span><span class="op" id="2829834">*</span><span class="ident" id="2829835">structType</span><span class="op" id="2829845">)</span><span class="op" id="2829846">(</span><span class="ident" id="2829847">unsafe</span><span class="op" id="2829853">.</span><span class="ident" id="2829854">Pointer</span><span class="op" id="2829861">(</span><span class="ident" id="2829862">t</span><span class="op" id="2829863">)</span><span class="op" id="2829864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829867">return</span>&nbsp;<span class="ident" id="2829874">tt</span><span class="op" id="2829876">.</span><span class="ident" id="2829877">FieldByNameFunc</span><span class="op" id="2829892">(</span><span class="ident" id="2829893">match</span><span class="op" id="2829898">)</span><br>
<span class="lineno"></span><span class="op" id="2829900">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2829903">func</span>&nbsp;<span class="op" id="2829908">(</span><span class="ident" id="2829909">t</span>&nbsp;<span class="op" id="2829911">*</span><span class="ident" id="2829912">rtype</span><span class="op" id="2829917">)</span>&nbsp;<span class="ident" id="2829919">In</span><span class="op" id="2829921">(</span><span class="ident" id="2829922">i</span>&nbsp;<span class="builtintype" id="2829924">int</span><span class="op" id="2829927">)</span>&nbsp;<span class="ident" id="2829929">Type</span>&nbsp;<span class="op" id="2829934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2829937">if</span>&nbsp;<span class="ident" id="2829940">t</span><span class="op" id="2829941">.</span><span class="ident" id="2829942">Kind</span><span class="op" id="2829946">(</span><span class="op" id="2829947">)</span>&nbsp;<span class="op" id="2829949">!=</span>&nbsp;<span class="ident" id="2829952">Func</span>&nbsp;<span class="op" id="2829957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2829961">panic</span><span class="op" id="2829966">(</span><span class="string" id="2829967">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2829997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830000">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830003">tt</span>&nbsp;<span class="op" id="2830006">:=</span>&nbsp;<span class="op" id="2830009">(</span><span class="op" id="2830010">*</span><span class="ident" id="2830011">funcType</span><span class="op" id="2830019">)</span><span class="op" id="2830020">(</span><span class="ident" id="2830021">unsafe</span><span class="op" id="2830027">.</span><span class="ident" id="2830028">Pointer</span><span class="op" id="2830035">(</span><span class="ident" id="2830036">t</span><span class="op" id="2830037">)</span><span class="op" id="2830038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830041">return</span>&nbsp;<span class="ident" id="2830048">toType</span><span class="op" id="2830054">(</span><span class="ident" id="2830055">tt</span><span class="op" id="2830057">.</span><span class="ident" id="2830058">in</span><span class="op" id="2830060">[</span><span class="ident" id="2830061">i</span><span class="op" id="2830062">]</span><span class="op" id="2830063">)</span><br>
<span class="lineno"></span><span class="op" id="2830065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830068">func</span>&nbsp;<span class="op" id="2830073">(</span><span class="ident" id="2830074">t</span>&nbsp;<span class="op" id="2830076">*</span><span class="ident" id="2830077">rtype</span><span class="op" id="2830082">)</span>&nbsp;<span class="ident" id="2830084">Key</span><span class="op" id="2830087">(</span><span class="op" id="2830088">)</span>&nbsp;<span class="ident" id="2830090">Type</span>&nbsp;<span class="op" id="2830095">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830098">if</span>&nbsp;<span class="ident" id="2830101">t</span><span class="op" id="2830102">.</span><span class="ident" id="2830103">Kind</span><span class="op" id="2830107">(</span><span class="op" id="2830108">)</span>&nbsp;<span class="op" id="2830110">!=</span>&nbsp;<span class="ident" id="2830113">Map</span>&nbsp;<span class="op" id="2830117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2830121">panic</span><span class="op" id="2830126">(</span><span class="string" id="2830127">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2830157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830163">tt</span>&nbsp;<span class="op" id="2830166">:=</span>&nbsp;<span class="op" id="2830169">(</span><span class="op" id="2830170">*</span><span class="ident" id="2830171">mapType</span><span class="op" id="2830178">)</span><span class="op" id="2830179">(</span><span class="ident" id="2830180">unsafe</span><span class="op" id="2830186">.</span><span class="ident" id="2830187">Pointer</span><span class="op" id="2830194">(</span><span class="ident" id="2830195">t</span><span class="op" id="2830196">)</span><span class="op" id="2830197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830200">return</span>&nbsp;<span class="ident" id="2830207">toType</span><span class="op" id="2830213">(</span><span class="ident" id="2830214">tt</span><span class="op" id="2830216">.</span><span class="ident" id="2830217">key</span><span class="op" id="2830220">)</span><br>
<span class="lineno">645</span><span class="op" id="2830222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830225">func</span>&nbsp;<span class="op" id="2830230">(</span><span class="ident" id="2830231">t</span>&nbsp;<span class="op" id="2830233">*</span><span class="ident" id="2830234">rtype</span><span class="op" id="2830239">)</span>&nbsp;<span class="ident" id="2830241">Len</span><span class="op" id="2830244">(</span><span class="op" id="2830245">)</span>&nbsp;<span class="builtintype" id="2830247">int</span>&nbsp;<span class="op" id="2830251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830254">if</span>&nbsp;<span class="ident" id="2830257">t</span><span class="op" id="2830258">.</span><span class="ident" id="2830259">Kind</span><span class="op" id="2830263">(</span><span class="op" id="2830264">)</span>&nbsp;<span class="op" id="2830266">!=</span>&nbsp;<span class="ident" id="2830269">Array</span>&nbsp;<span class="op" id="2830275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2830279">panic</span><span class="op" id="2830284">(</span><span class="string" id="2830285">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2830317">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830323">tt</span>&nbsp;<span class="op" id="2830326">:=</span>&nbsp;<span class="op" id="2830329">(</span><span class="op" id="2830330">*</span><span class="ident" id="2830331">arrayType</span><span class="op" id="2830340">)</span><span class="op" id="2830341">(</span><span class="ident" id="2830342">unsafe</span><span class="op" id="2830348">.</span><span class="ident" id="2830349">Pointer</span><span class="op" id="2830356">(</span><span class="ident" id="2830357">t</span><span class="op" id="2830358">)</span><span class="op" id="2830359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830362">return</span>&nbsp;<span class="builtintype" id="2830369">int</span><span class="op" id="2830372">(</span><span class="ident" id="2830373">tt</span><span class="op" id="2830375">.</span><span class="builtinfunc" id="2830376">len</span><span class="op" id="2830379">)</span><br>
<span class="lineno"></span><span class="op" id="2830381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2830384">func</span>&nbsp;<span class="op" id="2830389">(</span><span class="ident" id="2830390">t</span>&nbsp;<span class="op" id="2830392">*</span><span class="ident" id="2830393">rtype</span><span class="op" id="2830398">)</span>&nbsp;<span class="ident" id="2830400">NumField</span><span class="op" id="2830408">(</span><span class="op" id="2830409">)</span>&nbsp;<span class="builtintype" id="2830411">int</span>&nbsp;<span class="op" id="2830415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830418">if</span>&nbsp;<span class="ident" id="2830421">t</span><span class="op" id="2830422">.</span><span class="ident" id="2830423">Kind</span><span class="op" id="2830427">(</span><span class="op" id="2830428">)</span>&nbsp;<span class="op" id="2830430">!=</span>&nbsp;<span class="ident" id="2830433">Struct</span>&nbsp;<span class="op" id="2830440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2830444">panic</span><span class="op" id="2830449">(</span><span class="string" id="2830450">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2830488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830494">tt</span>&nbsp;<span class="op" id="2830497">:=</span>&nbsp;<span class="op" id="2830500">(</span><span class="op" id="2830501">*</span><span class="ident" id="2830502">structType</span><span class="op" id="2830512">)</span><span class="op" id="2830513">(</span><span class="ident" id="2830514">unsafe</span><span class="op" id="2830520">.</span><span class="ident" id="2830521">Pointer</span><span class="op" id="2830528">(</span><span class="ident" id="2830529">t</span><span class="op" id="2830530">)</span><span class="op" id="2830531">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830534">return</span>&nbsp;<span class="builtinfunc" id="2830541">len</span><span class="op" id="2830544">(</span><span class="ident" id="2830545">tt</span><span class="op" id="2830547">.</span><span class="ident" id="2830548">fields</span><span class="op" id="2830554">)</span><br>
<span class="lineno"></span><span class="op" id="2830556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830559">func</span>&nbsp;<span class="op" id="2830564">(</span><span class="ident" id="2830565">t</span>&nbsp;<span class="op" id="2830567">*</span><span class="ident" id="2830568">rtype</span><span class="op" id="2830573">)</span>&nbsp;<span class="ident" id="2830575">NumIn</span><span class="op" id="2830580">(</span><span class="op" id="2830581">)</span>&nbsp;<span class="builtintype" id="2830583">int</span>&nbsp;<span class="op" id="2830587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830590">if</span>&nbsp;<span class="ident" id="2830593">t</span><span class="op" id="2830594">.</span><span class="ident" id="2830595">Kind</span><span class="op" id="2830599">(</span><span class="op" id="2830600">)</span>&nbsp;<span class="op" id="2830602">!=</span>&nbsp;<span class="ident" id="2830605">Func</span>&nbsp;<span class="op" id="2830610">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2830614">panic</span><span class="op" id="2830619">(</span><span class="string" id="2830620">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2830653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830659">tt</span>&nbsp;<span class="op" id="2830662">:=</span>&nbsp;<span class="op" id="2830665">(</span><span class="op" id="2830666">*</span><span class="ident" id="2830667">funcType</span><span class="op" id="2830675">)</span><span class="op" id="2830676">(</span><span class="ident" id="2830677">unsafe</span><span class="op" id="2830683">.</span><span class="ident" id="2830684">Pointer</span><span class="op" id="2830691">(</span><span class="ident" id="2830692">t</span><span class="op" id="2830693">)</span><span class="op" id="2830694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830697">return</span>&nbsp;<span class="builtinfunc" id="2830704">len</span><span class="op" id="2830707">(</span><span class="ident" id="2830708">tt</span><span class="op" id="2830710">.</span><span class="ident" id="2830711">in</span><span class="op" id="2830713">)</span><br>
<span class="lineno"></span><span class="op" id="2830715">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2830718">func</span>&nbsp;<span class="op" id="2830723">(</span><span class="ident" id="2830724">t</span>&nbsp;<span class="op" id="2830726">*</span><span class="ident" id="2830727">rtype</span><span class="op" id="2830732">)</span>&nbsp;<span class="ident" id="2830734">NumOut</span><span class="op" id="2830740">(</span><span class="op" id="2830741">)</span>&nbsp;<span class="builtintype" id="2830743">int</span>&nbsp;<span class="op" id="2830747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830750">if</span>&nbsp;<span class="ident" id="2830753">t</span><span class="op" id="2830754">.</span><span class="ident" id="2830755">Kind</span><span class="op" id="2830759">(</span><span class="op" id="2830760">)</span>&nbsp;<span class="op" id="2830762">!=</span>&nbsp;<span class="ident" id="2830765">Func</span>&nbsp;<span class="op" id="2830770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2830774">panic</span><span class="op" id="2830779">(</span><span class="string" id="2830780">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2830814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830817">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830820">tt</span>&nbsp;<span class="op" id="2830823">:=</span>&nbsp;<span class="op" id="2830826">(</span><span class="op" id="2830827">*</span><span class="ident" id="2830828">funcType</span><span class="op" id="2830836">)</span><span class="op" id="2830837">(</span><span class="ident" id="2830838">unsafe</span><span class="op" id="2830844">.</span><span class="ident" id="2830845">Pointer</span><span class="op" id="2830852">(</span><span class="ident" id="2830853">t</span><span class="op" id="2830854">)</span><span class="op" id="2830855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830858">return</span>&nbsp;<span class="builtinfunc" id="2830865">len</span><span class="op" id="2830868">(</span><span class="ident" id="2830869">tt</span><span class="op" id="2830871">.</span><span class="ident" id="2830872">out</span><span class="op" id="2830875">)</span><br>
<span class="lineno"></span><span class="op" id="2830877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2830880">func</span>&nbsp;<span class="op" id="2830885">(</span><span class="ident" id="2830886">t</span>&nbsp;<span class="op" id="2830888">*</span><span class="ident" id="2830889">rtype</span><span class="op" id="2830894">)</span>&nbsp;<span class="ident" id="2830896">Out</span><span class="op" id="2830899">(</span><span class="ident" id="2830900">i</span>&nbsp;<span class="builtintype" id="2830902">int</span><span class="op" id="2830905">)</span>&nbsp;<span class="ident" id="2830907">Type</span>&nbsp;<span class="op" id="2830912">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2830915">if</span>&nbsp;<span class="ident" id="2830918">t</span><span class="op" id="2830919">.</span><span class="ident" id="2830920">Kind</span><span class="op" id="2830924">(</span><span class="op" id="2830925">)</span>&nbsp;<span class="op" id="2830927">!=</span>&nbsp;<span class="ident" id="2830930">Func</span>&nbsp;<span class="op" id="2830935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2830939">panic</span><span class="op" id="2830944">(</span><span class="string" id="2830945">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2830976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2830979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2830982">tt</span>&nbsp;<span class="op" id="2830985">:=</span>&nbsp;<span class="op" id="2830988">(</span><span class="op" id="2830989">*</span><span class="ident" id="2830990">funcType</span><span class="op" id="2830998">)</span><span class="op" id="2830999">(</span><span class="ident" id="2831000">unsafe</span><span class="op" id="2831006">.</span><span class="ident" id="2831007">Pointer</span><span class="op" id="2831014">(</span><span class="ident" id="2831015">t</span><span class="op" id="2831016">)</span><span class="op" id="2831017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831020">return</span>&nbsp;<span class="ident" id="2831027">toType</span><span class="op" id="2831033">(</span><span class="ident" id="2831034">tt</span><span class="op" id="2831036">.</span><span class="ident" id="2831037">out</span><span class="op" id="2831040">[</span><span class="ident" id="2831041">i</span><span class="op" id="2831042">]</span><span class="op" id="2831043">)</span><br>
<span class="lineno">685</span><span class="op" id="2831045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2831048">func</span>&nbsp;<span class="op" id="2831053">(</span><span class="ident" id="2831054">d</span>&nbsp;<span class="ident" id="2831056">ChanDir</span><span class="op" id="2831063">)</span>&nbsp;<span class="ident" id="2831065">String</span><span class="op" id="2831071">(</span><span class="op" id="2831072">)</span>&nbsp;<span class="builtintype" id="2831074">string</span>&nbsp;<span class="op" id="2831081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831084">switch</span>&nbsp;<span class="ident" id="2831091">d</span>&nbsp;<span class="op" id="2831093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831096">case</span>&nbsp;<span class="ident" id="2831101">SendDir</span><span class="op" id="2831108">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831112">return</span>&nbsp;<span class="string" id="2831119">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831129">case</span>&nbsp;<span class="ident" id="2831134">RecvDir</span><span class="op" id="2831141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831145">return</span>&nbsp;<span class="string" id="2831152">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831162">case</span>&nbsp;<span class="ident" id="2831167">BothDir</span><span class="op" id="2831174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831178">return</span>&nbsp;<span class="string" id="2831185">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831196">return</span>&nbsp;<span class="string" id="2831203">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2831213">+</span>&nbsp;<span class="ident" id="2831215">strconv</span><span class="op" id="2831222">.</span><span class="ident" id="2831223">Itoa</span><span class="op" id="2831227">(</span><span class="builtintype" id="2831228">int</span><span class="op" id="2831231">(</span><span class="ident" id="2831232">d</span><span class="op" id="2831233">)</span><span class="op" id="2831234">)</span><br>
<span class="lineno"></span><span class="op" id="2831236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2831239">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2831299">func</span>&nbsp;<span class="op" id="2831304">(</span><span class="ident" id="2831305">t</span>&nbsp;<span class="op" id="2831307">*</span><span class="ident" id="2831308">interfaceType</span><span class="op" id="2831321">)</span>&nbsp;<span class="ident" id="2831323">Method</span><span class="op" id="2831329">(</span><span class="ident" id="2831330">i</span>&nbsp;<span class="builtintype" id="2831332">int</span><span class="op" id="2831335">)</span>&nbsp;<span class="op" id="2831337">(</span><span class="ident" id="2831338">m</span>&nbsp;<span class="ident" id="2831340">Method</span><span class="op" id="2831346">)</span>&nbsp;<span class="op" id="2831348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831351">if</span>&nbsp;<span class="ident" id="2831354">i</span>&nbsp;<span class="op" id="2831356">&lt;</span>&nbsp;<span class="num" id="2831358">0</span>&nbsp;<span class="op" id="2831360">||</span>&nbsp;<span class="ident" id="2831363">i</span>&nbsp;<span class="op" id="2831365">&gt;=</span>&nbsp;<span class="builtinfunc" id="2831368">len</span><span class="op" id="2831371">(</span><span class="ident" id="2831372">t</span><span class="op" id="2831373">.</span><span class="ident" id="2831374">methods</span><span class="op" id="2831381">)</span>&nbsp;<span class="op" id="2831383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831387">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831398">p</span>&nbsp;<span class="op" id="2831400">:=</span>&nbsp;<span class="op" id="2831403">&amp;</span><span class="ident" id="2831404">t</span><span class="op" id="2831405">.</span><span class="ident" id="2831406">methods</span><span class="op" id="2831413">[</span><span class="ident" id="2831414">i</span><span class="op" id="2831415">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831418">m</span><span class="op" id="2831419">.</span><span class="ident" id="2831420">Name</span>&nbsp;<span class="op" id="2831425">=</span>&nbsp;<span class="op" id="2831427">*</span><span class="ident" id="2831428">p</span><span class="op" id="2831429">.</span><span class="ident" id="2831430">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831436">if</span>&nbsp;<span class="ident" id="2831439">p</span><span class="op" id="2831440">.</span><span class="ident" id="2831441">pkgPath</span>&nbsp;<span class="op" id="2831449">!=</span>&nbsp;<span class="ident" id="2831452">nil</span>&nbsp;<span class="op" id="2831456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831460">m</span><span class="op" id="2831461">.</span><span class="ident" id="2831462">PkgPath</span>&nbsp;<span class="op" id="2831470">=</span>&nbsp;<span class="op" id="2831472">*</span><span class="ident" id="2831473">p</span><span class="op" id="2831474">.</span><span class="ident" id="2831475">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831487">m</span><span class="op" id="2831488">.</span><span class="ident" id="2831489">Type</span>&nbsp;<span class="op" id="2831494">=</span>&nbsp;<span class="ident" id="2831496">toType</span><span class="op" id="2831502">(</span><span class="ident" id="2831503">p</span><span class="op" id="2831504">.</span><span class="ident" id="2831505">typ</span><span class="op" id="2831508">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831511">m</span><span class="op" id="2831512">.</span><span class="ident" id="2831513">Index</span>&nbsp;<span class="op" id="2831519">=</span>&nbsp;<span class="ident" id="2831521">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831524">return</span><br>
<span class="lineno"></span><span class="op" id="2831531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2831534">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2831613">func</span>&nbsp;<span class="op" id="2831618">(</span><span class="ident" id="2831619">t</span>&nbsp;<span class="op" id="2831621">*</span><span class="ident" id="2831622">interfaceType</span><span class="op" id="2831635">)</span>&nbsp;<span class="ident" id="2831637">NumMethod</span><span class="op" id="2831646">(</span><span class="op" id="2831647">)</span>&nbsp;<span class="builtintype" id="2831649">int</span>&nbsp;<span class="op" id="2831653">{</span>&nbsp;<span class="keyword" id="2831655">return</span>&nbsp;<span class="builtinfunc" id="2831662">len</span><span class="op" id="2831665">(</span><span class="ident" id="2831666">t</span><span class="op" id="2831667">.</span><span class="ident" id="2831668">methods</span><span class="op" id="2831675">)</span>&nbsp;<span class="op" id="2831677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2831680">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2831749">func</span>&nbsp;<span class="op" id="2831754">(</span><span class="ident" id="2831755">t</span>&nbsp;<span class="op" id="2831757">*</span><span class="ident" id="2831758">interfaceType</span><span class="op" id="2831771">)</span>&nbsp;<span class="ident" id="2831773">MethodByName</span><span class="op" id="2831785">(</span><span class="ident" id="2831786">name</span>&nbsp;<span class="builtintype" id="2831791">string</span><span class="op" id="2831797">)</span>&nbsp;<span class="op" id="2831799">(</span><span class="ident" id="2831800">m</span>&nbsp;<span class="ident" id="2831802">Method</span><span class="op" id="2831808">,</span>&nbsp;<span class="ident" id="2831810">ok</span>&nbsp;<span class="builtintype" id="2831813">bool</span><span class="op" id="2831817">)</span>&nbsp;<span class="op" id="2831819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831822">if</span>&nbsp;<span class="ident" id="2831825">t</span>&nbsp;<span class="op" id="2831827">==</span>&nbsp;<span class="ident" id="2831830">nil</span>&nbsp;<span class="op" id="2831834">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831838">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831849">var</span>&nbsp;<span class="ident" id="2831853">p</span>&nbsp;<span class="op" id="2831855">*</span><span class="ident" id="2831856">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831865">for</span>&nbsp;<span class="ident" id="2831869">i</span>&nbsp;<span class="op" id="2831871">:=</span>&nbsp;<span class="keyword" id="2831874">range</span>&nbsp;<span class="ident" id="2831880">t</span><span class="op" id="2831881">.</span><span class="ident" id="2831882">methods</span>&nbsp;<span class="op" id="2831890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2831894">p</span>&nbsp;<span class="op" id="2831896">=</span>&nbsp;<span class="op" id="2831898">&amp;</span><span class="ident" id="2831899">t</span><span class="op" id="2831900">.</span><span class="ident" id="2831901">methods</span><span class="op" id="2831908">[</span><span class="ident" id="2831909">i</span><span class="op" id="2831910">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831914">if</span>&nbsp;<span class="op" id="2831917">*</span><span class="ident" id="2831918">p</span><span class="op" id="2831919">.</span><span class="ident" id="2831920">name</span>&nbsp;<span class="op" id="2831925">==</span>&nbsp;<span class="ident" id="2831928">name</span>&nbsp;<span class="op" id="2831933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831938">return</span>&nbsp;<span class="ident" id="2831945">t</span><span class="op" id="2831946">.</span><span class="ident" id="2831947">Method</span><span class="op" id="2831953">(</span><span class="ident" id="2831954">i</span><span class="op" id="2831955">)</span><span class="op" id="2831956">,</span>&nbsp;<span class="builtintype" id="2831958">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2831968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2831971">return</span><br>
<span class="lineno">730</span><span class="op" id="2831978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2831981">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2832036">type</span>&nbsp;<span class="ident" id="2832041">StructField</span>&nbsp;<span class="keyword" id="2832053">struct</span>&nbsp;<span class="op" id="2832060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2832063">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2832091">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2832164">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2832232">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832293">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2832301">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832309">PkgPath</span>&nbsp;<span class="builtintype" id="2832317">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832326">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832336">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2832346">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832361">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2832371">StructTag</span>&nbsp;<span class="comment" id="2832381">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832402">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2832412">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2832422">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832457">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2832467">[</span><span class="op" id="2832468">]</span><span class="builtintype" id="2832469">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2832477">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2832518">Anonymous</span>&nbsp;<span class="builtintype" id="2832528">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2832538">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2832562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2832565">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2832617">//</span><br>
<span class="lineno">750</span><span class="comment" id="2832620">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2832673">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2832722">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2832782">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2832847">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2832913">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2832957">type</span>&nbsp;<span class="ident" id="2832962">StructTag</span>&nbsp;<span class="builtintype" id="2832972">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2832980">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2833044">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2833113">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2833176">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2833211">func</span>&nbsp;<span class="op" id="2833216">(</span><span class="ident" id="2833217">tag</span>&nbsp;<span class="ident" id="2833221">StructTag</span><span class="op" id="2833230">)</span>&nbsp;<span class="ident" id="2833232">Get</span><span class="op" id="2833235">(</span><span class="ident" id="2833236">key</span>&nbsp;<span class="builtintype" id="2833240">string</span><span class="op" id="2833246">)</span>&nbsp;<span class="builtintype" id="2833248">string</span>&nbsp;<span class="op" id="2833255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833258">for</span>&nbsp;<span class="ident" id="2833262">tag</span>&nbsp;<span class="op" id="2833266">!=</span>&nbsp;<span class="string" id="2833269">&#34;&#34;</span>&nbsp;<span class="op" id="2833272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833276">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833300">i</span>&nbsp;<span class="op" id="2833302">:=</span>&nbsp;<span class="num" id="2833305">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833309">for</span>&nbsp;<span class="ident" id="2833313">i</span>&nbsp;<span class="op" id="2833315">&lt;</span>&nbsp;<span class="builtinfunc" id="2833317">len</span><span class="op" id="2833320">(</span><span class="ident" id="2833321">tag</span><span class="op" id="2833324">)</span>&nbsp;<span class="op" id="2833326">&amp;&amp;</span>&nbsp;<span class="ident" id="2833329">tag</span><span class="op" id="2833332">[</span><span class="ident" id="2833333">i</span><span class="op" id="2833334">]</span>&nbsp;<span class="op" id="2833336">==</span>&nbsp;<span class="string" id="2833339">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2833343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833348">i</span><span class="op" id="2833349">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833358">tag</span>&nbsp;<span class="op" id="2833362">=</span>&nbsp;<span class="ident" id="2833364">tag</span><span class="op" id="2833367">[</span><span class="ident" id="2833368">i</span><span class="op" id="2833369">:</span><span class="op" id="2833370">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833374">if</span>&nbsp;<span class="ident" id="2833377">tag</span>&nbsp;<span class="op" id="2833381">==</span>&nbsp;<span class="string" id="2833384">&#34;&#34;</span>&nbsp;<span class="op" id="2833387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833392">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833405">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833425">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833467">i</span>&nbsp;<span class="op" id="2833469">=</span>&nbsp;<span class="num" id="2833471">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833475">for</span>&nbsp;<span class="ident" id="2833479">i</span>&nbsp;<span class="op" id="2833481">&lt;</span>&nbsp;<span class="builtinfunc" id="2833483">len</span><span class="op" id="2833486">(</span><span class="ident" id="2833487">tag</span><span class="op" id="2833490">)</span>&nbsp;<span class="op" id="2833492">&amp;&amp;</span>&nbsp;<span class="ident" id="2833495">tag</span><span class="op" id="2833498">[</span><span class="ident" id="2833499">i</span><span class="op" id="2833500">]</span>&nbsp;<span class="op" id="2833502">!=</span>&nbsp;<span class="string" id="2833505">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2833509">&amp;&amp;</span>&nbsp;<span class="ident" id="2833512">tag</span><span class="op" id="2833515">[</span><span class="ident" id="2833516">i</span><span class="op" id="2833517">]</span>&nbsp;<span class="op" id="2833519">!=</span>&nbsp;<span class="string" id="2833522">&#39;:&#39;</span>&nbsp;<span class="op" id="2833526">&amp;&amp;</span>&nbsp;<span class="ident" id="2833529">tag</span><span class="op" id="2833532">[</span><span class="ident" id="2833533">i</span><span class="op" id="2833534">]</span>&nbsp;<span class="op" id="2833536">!=</span>&nbsp;<span class="string" id="2833539">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2833543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833548">i</span><span class="op" id="2833549">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833554">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833558">if</span>&nbsp;<span class="ident" id="2833561">i</span><span class="op" id="2833562">+</span><span class="num" id="2833563">1</span>&nbsp;<span class="op" id="2833565">&gt;=</span>&nbsp;<span class="builtinfunc" id="2833568">len</span><span class="op" id="2833571">(</span><span class="ident" id="2833572">tag</span><span class="op" id="2833575">)</span>&nbsp;<span class="op" id="2833577">||</span>&nbsp;<span class="ident" id="2833580">tag</span><span class="op" id="2833583">[</span><span class="ident" id="2833584">i</span><span class="op" id="2833585">]</span>&nbsp;<span class="op" id="2833587">!=</span>&nbsp;<span class="string" id="2833590">&#39;:&#39;</span>&nbsp;<span class="op" id="2833594">||</span>&nbsp;<span class="ident" id="2833597">tag</span><span class="op" id="2833600">[</span><span class="ident" id="2833601">i</span><span class="op" id="2833602">+</span><span class="num" id="2833603">1</span><span class="op" id="2833604">]</span>&nbsp;<span class="op" id="2833606">!=</span>&nbsp;<span class="string" id="2833609">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2833613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833618">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833630">name</span>&nbsp;<span class="op" id="2833635">:=</span>&nbsp;<span class="builtintype" id="2833638">string</span><span class="op" id="2833644">(</span><span class="ident" id="2833645">tag</span><span class="op" id="2833648">[</span><span class="op" id="2833649">:</span><span class="ident" id="2833650">i</span><span class="op" id="2833651">]</span><span class="op" id="2833652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833656">tag</span>&nbsp;<span class="op" id="2833660">=</span>&nbsp;<span class="ident" id="2833662">tag</span><span class="op" id="2833665">[</span><span class="ident" id="2833666">i</span><span class="op" id="2833667">+</span><span class="num" id="2833668">1</span><span class="op" id="2833669">:</span><span class="op" id="2833670">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2833675">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833713">i</span>&nbsp;<span class="op" id="2833715">=</span>&nbsp;<span class="num" id="2833717">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833721">for</span>&nbsp;<span class="ident" id="2833725">i</span>&nbsp;<span class="op" id="2833727">&lt;</span>&nbsp;<span class="builtinfunc" id="2833729">len</span><span class="op" id="2833732">(</span><span class="ident" id="2833733">tag</span><span class="op" id="2833736">)</span>&nbsp;<span class="op" id="2833738">&amp;&amp;</span>&nbsp;<span class="ident" id="2833741">tag</span><span class="op" id="2833744">[</span><span class="ident" id="2833745">i</span><span class="op" id="2833746">]</span>&nbsp;<span class="op" id="2833748">!=</span>&nbsp;<span class="string" id="2833751">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2833755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833760">if</span>&nbsp;<span class="ident" id="2833763">tag</span><span class="op" id="2833766">[</span><span class="ident" id="2833767">i</span><span class="op" id="2833768">]</span>&nbsp;<span class="op" id="2833770">==</span>&nbsp;<span class="string" id="2833773">&#39;\\&#39;</span>&nbsp;<span class="op" id="2833778">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833784">i</span><span class="op" id="2833785">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833796">i</span><span class="op" id="2833797">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833806">if</span>&nbsp;<span class="ident" id="2833809">i</span>&nbsp;<span class="op" id="2833811">&gt;=</span>&nbsp;<span class="builtinfunc" id="2833814">len</span><span class="op" id="2833817">(</span><span class="ident" id="2833818">tag</span><span class="op" id="2833821">)</span>&nbsp;<span class="op" id="2833823">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833828">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833840">qvalue</span>&nbsp;<span class="op" id="2833847">:=</span>&nbsp;<span class="builtintype" id="2833850">string</span><span class="op" id="2833856">(</span><span class="ident" id="2833857">tag</span><span class="op" id="2833860">[</span><span class="op" id="2833861">:</span><span class="ident" id="2833862">i</span><span class="op" id="2833863">+</span><span class="num" id="2833864">1</span><span class="op" id="2833865">]</span><span class="op" id="2833866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833870">tag</span>&nbsp;<span class="op" id="2833874">=</span>&nbsp;<span class="ident" id="2833876">tag</span><span class="op" id="2833879">[</span><span class="ident" id="2833880">i</span><span class="op" id="2833881">+</span><span class="num" id="2833882">1</span><span class="op" id="2833883">:</span><span class="op" id="2833884">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833889">if</span>&nbsp;<span class="ident" id="2833892">key</span>&nbsp;<span class="op" id="2833896">==</span>&nbsp;<span class="ident" id="2833899">name</span>&nbsp;<span class="op" id="2833904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2833909">value</span><span class="op" id="2833914">,</span>&nbsp;<span class="ident" id="2833916">_</span>&nbsp;<span class="op" id="2833918">:=</span>&nbsp;<span class="ident" id="2833921">strconv</span><span class="op" id="2833928">.</span><span class="ident" id="2833929">Unquote</span><span class="op" id="2833936">(</span><span class="ident" id="2833937">qvalue</span><span class="op" id="2833943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833948">return</span>&nbsp;<span class="ident" id="2833955">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2833966">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2833969">return</span>&nbsp;<span class="string" id="2833976">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2833979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2833982">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2834022">func</span>&nbsp;<span class="op" id="2834027">(</span><span class="ident" id="2834028">t</span>&nbsp;<span class="op" id="2834030">*</span><span class="ident" id="2834031">structType</span><span class="op" id="2834041">)</span>&nbsp;<span class="ident" id="2834043">Field</span><span class="op" id="2834048">(</span><span class="ident" id="2834049">i</span>&nbsp;<span class="builtintype" id="2834051">int</span><span class="op" id="2834054">)</span>&nbsp;<span class="op" id="2834056">(</span><span class="ident" id="2834057">f</span>&nbsp;<span class="ident" id="2834059">StructField</span><span class="op" id="2834070">)</span>&nbsp;<span class="op" id="2834072">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834075">if</span>&nbsp;<span class="ident" id="2834078">i</span>&nbsp;<span class="op" id="2834080">&lt;</span>&nbsp;<span class="num" id="2834082">0</span>&nbsp;<span class="op" id="2834084">||</span>&nbsp;<span class="ident" id="2834087">i</span>&nbsp;<span class="op" id="2834089">&gt;=</span>&nbsp;<span class="builtinfunc" id="2834092">len</span><span class="op" id="2834095">(</span><span class="ident" id="2834096">t</span><span class="op" id="2834097">.</span><span class="ident" id="2834098">fields</span><span class="op" id="2834104">)</span>&nbsp;<span class="op" id="2834106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834110">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834121">p</span>&nbsp;<span class="op" id="2834123">:=</span>&nbsp;<span class="op" id="2834126">&amp;</span><span class="ident" id="2834127">t</span><span class="op" id="2834128">.</span><span class="ident" id="2834129">fields</span><span class="op" id="2834135">[</span><span class="ident" id="2834136">i</span><span class="op" id="2834137">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834140">f</span><span class="op" id="2834141">.</span><span class="ident" id="2834142">Type</span>&nbsp;<span class="op" id="2834147">=</span>&nbsp;<span class="ident" id="2834149">toType</span><span class="op" id="2834155">(</span><span class="ident" id="2834156">p</span><span class="op" id="2834157">.</span><span class="ident" id="2834158">typ</span><span class="op" id="2834161">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834164">if</span>&nbsp;<span class="ident" id="2834167">p</span><span class="op" id="2834168">.</span><span class="ident" id="2834169">name</span>&nbsp;<span class="op" id="2834174">!=</span>&nbsp;<span class="ident" id="2834177">nil</span>&nbsp;<span class="op" id="2834181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834185">f</span><span class="op" id="2834186">.</span><span class="ident" id="2834187">Name</span>&nbsp;<span class="op" id="2834192">=</span>&nbsp;<span class="op" id="2834194">*</span><span class="ident" id="2834195">p</span><span class="op" id="2834196">.</span><span class="ident" id="2834197">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834203">}</span>&nbsp;<span class="keyword" id="2834205">else</span>&nbsp;<span class="op" id="2834210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834214">t</span>&nbsp;<span class="op" id="2834216">:=</span>&nbsp;<span class="ident" id="2834219">f</span><span class="op" id="2834220">.</span><span class="ident" id="2834221">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834228">if</span>&nbsp;<span class="ident" id="2834231">t</span><span class="op" id="2834232">.</span><span class="ident" id="2834233">Kind</span><span class="op" id="2834237">(</span><span class="op" id="2834238">)</span>&nbsp;<span class="op" id="2834240">==</span>&nbsp;<span class="ident" id="2834243">Ptr</span>&nbsp;<span class="op" id="2834247">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834252">t</span>&nbsp;<span class="op" id="2834254">=</span>&nbsp;<span class="ident" id="2834256">t</span><span class="op" id="2834257">.</span><span class="ident" id="2834258">Elem</span><span class="op" id="2834262">(</span><span class="op" id="2834263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834271">f</span><span class="op" id="2834272">.</span><span class="ident" id="2834273">Name</span>&nbsp;<span class="op" id="2834278">=</span>&nbsp;<span class="ident" id="2834280">t</span><span class="op" id="2834281">.</span><span class="ident" id="2834282">Name</span><span class="op" id="2834286">(</span><span class="op" id="2834287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834291">f</span><span class="op" id="2834292">.</span><span class="ident" id="2834293">Anonymous</span>&nbsp;<span class="op" id="2834303">=</span>&nbsp;<span class="builtintype" id="2834305">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834311">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834314">if</span>&nbsp;<span class="ident" id="2834317">p</span><span class="op" id="2834318">.</span><span class="ident" id="2834319">pkgPath</span>&nbsp;<span class="op" id="2834327">!=</span>&nbsp;<span class="ident" id="2834330">nil</span>&nbsp;<span class="op" id="2834334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834338">f</span><span class="op" id="2834339">.</span><span class="ident" id="2834340">PkgPath</span>&nbsp;<span class="op" id="2834348">=</span>&nbsp;<span class="op" id="2834350">*</span><span class="ident" id="2834351">p</span><span class="op" id="2834352">.</span><span class="ident" id="2834353">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834365">if</span>&nbsp;<span class="ident" id="2834368">p</span><span class="op" id="2834369">.</span><span class="ident" id="2834370">tag</span>&nbsp;<span class="op" id="2834374">!=</span>&nbsp;<span class="ident" id="2834377">nil</span>&nbsp;<span class="op" id="2834381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834385">f</span><span class="op" id="2834386">.</span><span class="ident" id="2834387">Tag</span>&nbsp;<span class="op" id="2834391">=</span>&nbsp;<span class="ident" id="2834393">StructTag</span><span class="op" id="2834402">(</span><span class="op" id="2834403">*</span><span class="ident" id="2834404">p</span><span class="op" id="2834405">.</span><span class="ident" id="2834406">tag</span><span class="op" id="2834409">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2834412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834415">f</span><span class="op" id="2834416">.</span><span class="ident" id="2834417">Offset</span>&nbsp;<span class="op" id="2834424">=</span>&nbsp;<span class="ident" id="2834426">p</span><span class="op" id="2834427">.</span><span class="ident" id="2834428">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834437">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834497">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834558">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834617">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834677">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834737">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2834795">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2834846">f</span><span class="op" id="2834847">.</span><span class="ident" id="2834848">Index</span>&nbsp;<span class="op" id="2834854">=</span>&nbsp;<span class="op" id="2834856">[</span><span class="op" id="2834857">]</span><span class="builtintype" id="2834858">int</span><span class="op" id="2834861">{</span><span class="ident" id="2834862">i</span><span class="op" id="2834863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2834866">return</span><br>
<span class="lineno"></span><span class="op" id="2834873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2834876">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2834943">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2834985">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2835050">func</span>&nbsp;<span class="op" id="2835055">(</span><span class="ident" id="2835056">t</span>&nbsp;<span class="op" id="2835058">*</span><span class="ident" id="2835059">structType</span><span class="op" id="2835069">)</span>&nbsp;<span class="ident" id="2835071">FieldByIndex</span><span class="op" id="2835083">(</span><span class="ident" id="2835084">index</span>&nbsp;<span class="op" id="2835090">[</span><span class="op" id="2835091">]</span><span class="builtintype" id="2835092">int</span><span class="op" id="2835095">)</span>&nbsp;<span class="op" id="2835097">(</span><span class="ident" id="2835098">f</span>&nbsp;<span class="ident" id="2835100">StructField</span><span class="op" id="2835111">)</span>&nbsp;<span class="op" id="2835113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835116">f</span><span class="op" id="2835117">.</span><span class="ident" id="2835118">Type</span>&nbsp;<span class="op" id="2835123">=</span>&nbsp;<span class="ident" id="2835125">toType</span><span class="op" id="2835131">(</span><span class="op" id="2835132">&amp;</span><span class="ident" id="2835133">t</span><span class="op" id="2835134">.</span><span class="ident" id="2835135">rtype</span><span class="op" id="2835140">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835143">for</span>&nbsp;<span class="ident" id="2835147">i</span><span class="op" id="2835148">,</span>&nbsp;<span class="ident" id="2835150">x</span>&nbsp;<span class="op" id="2835152">:=</span>&nbsp;<span class="keyword" id="2835155">range</span>&nbsp;<span class="ident" id="2835161">index</span>&nbsp;<span class="op" id="2835167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835171">if</span>&nbsp;<span class="ident" id="2835174">i</span>&nbsp;<span class="op" id="2835176">&gt;</span>&nbsp;<span class="num" id="2835178">0</span>&nbsp;<span class="op" id="2835180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835185">ft</span>&nbsp;<span class="op" id="2835188">:=</span>&nbsp;<span class="ident" id="2835191">f</span><span class="op" id="2835192">.</span><span class="ident" id="2835193">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835201">if</span>&nbsp;<span class="ident" id="2835204">ft</span><span class="op" id="2835206">.</span><span class="ident" id="2835207">Kind</span><span class="op" id="2835211">(</span><span class="op" id="2835212">)</span>&nbsp;<span class="op" id="2835214">==</span>&nbsp;<span class="ident" id="2835217">Ptr</span>&nbsp;<span class="op" id="2835221">&amp;&amp;</span>&nbsp;<span class="ident" id="2835224">ft</span><span class="op" id="2835226">.</span><span class="ident" id="2835227">Elem</span><span class="op" id="2835231">(</span><span class="op" id="2835232">)</span><span class="op" id="2835233">.</span><span class="ident" id="2835234">Kind</span><span class="op" id="2835238">(</span><span class="op" id="2835239">)</span>&nbsp;<span class="op" id="2835241">==</span>&nbsp;<span class="ident" id="2835244">Struct</span>&nbsp;<span class="op" id="2835251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835257">ft</span>&nbsp;<span class="op" id="2835260">=</span>&nbsp;<span class="ident" id="2835262">ft</span><span class="op" id="2835264">.</span><span class="ident" id="2835265">Elem</span><span class="op" id="2835269">(</span><span class="op" id="2835270">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835280">f</span><span class="op" id="2835281">.</span><span class="ident" id="2835282">Type</span>&nbsp;<span class="op" id="2835287">=</span>&nbsp;<span class="ident" id="2835289">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835298">f</span>&nbsp;<span class="op" id="2835300">=</span>&nbsp;<span class="ident" id="2835302">f</span><span class="op" id="2835303">.</span><span class="ident" id="2835304">Type</span><span class="op" id="2835308">.</span><span class="ident" id="2835309">Field</span><span class="op" id="2835314">(</span><span class="ident" id="2835315">x</span><span class="op" id="2835316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2835319">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2835322">return</span><br>
<span class="lineno"></span><span class="op" id="2835329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2835332">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2835405">type</span>&nbsp;<span class="ident" id="2835410">fieldScan</span>&nbsp;<span class="keyword" id="2835420">struct</span>&nbsp;<span class="op" id="2835427">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835430">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2835436">*</span><span class="ident" id="2835437">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2835449">index</span>&nbsp;<span class="op" id="2835455">[</span><span class="op" id="2835456">]</span><span class="builtintype" id="2835457">int</span><br>
<span class="lineno"></span><span class="op" id="2835461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2835464">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2835539">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2835607">func</span>&nbsp;<span class="op" id="2835612">(</span><span class="ident" id="2835613">t</span>&nbsp;<span class="op" id="2835615">*</span><span class="ident" id="2835616">structType</span><span class="op" id="2835626">)</span>&nbsp;<span class="ident" id="2835628">FieldByNameFunc</span><span class="op" id="2835643">(</span><span class="ident" id="2835644">match</span>&nbsp;<span class="keyword" id="2835650">func</span><span class="op" id="2835654">(</span><span class="builtintype" id="2835655">string</span><span class="op" id="2835661">)</span>&nbsp;<span class="builtintype" id="2835663">bool</span><span class="op" id="2835667">)</span>&nbsp;<span class="op" id="2835669">(</span><span class="ident" id="2835670">result</span>&nbsp;<span class="ident" id="2835677">StructField</span><span class="op" id="2835688">,</span>&nbsp;<span class="ident" id="2835690">ok</span>&nbsp;<span class="builtintype" id="2835693">bool</span><span class="op" id="2835697">)</span>&nbsp;<span class="op" id="2835699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835702">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835794">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835885">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2835977">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836048">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836097">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836156">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836211">current</span>&nbsp;<span class="op" id="2836219">:=</span>&nbsp;<span class="op" id="2836222">[</span><span class="op" id="2836223">]</span><span class="ident" id="2836224">fieldScan</span><span class="op" id="2836233">{</span><span class="op" id="2836234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2836237">next</span>&nbsp;<span class="op" id="2836242">:=</span>&nbsp;<span class="op" id="2836245">[</span><span class="op" id="2836246">]</span><span class="ident" id="2836247">fieldScan</span><span class="op" id="2836256">{</span><span class="op" id="2836257">{</span><span class="ident" id="2836258">typ</span><span class="op" id="2836261">:</span>&nbsp;<span class="ident" id="2836263">t</span><span class="op" id="2836264">}</span><span class="op" id="2836265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836269">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836337">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836402">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836471">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836548">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836621">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2836656">var</span>&nbsp;<span class="ident" id="2836660">nextCount</span>&nbsp;<span class="keyword" id="2836670">map</span><span class="op" id="2836673">[</span><span class="op" id="2836674">*</span><span class="ident" id="2836675">structType</span><span class="op" id="2836685">]</span><span class="builtintype" id="2836686">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836692">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836759">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836821">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836890">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2836962">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837037">visited</span>&nbsp;<span class="op" id="2837045">:=</span>&nbsp;<span class="keyword" id="2837048">map</span><span class="op" id="2837051">[</span><span class="op" id="2837052">*</span><span class="ident" id="2837053">structType</span><span class="op" id="2837063">]</span><span class="builtintype" id="2837064">bool</span><span class="op" id="2837068">{</span><span class="op" id="2837069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837073">for</span>&nbsp;<span class="builtinfunc" id="2837077">len</span><span class="op" id="2837080">(</span><span class="ident" id="2837081">next</span><span class="op" id="2837085">)</span>&nbsp;<span class="op" id="2837087">&gt;</span>&nbsp;<span class="num" id="2837089">0</span>&nbsp;<span class="op" id="2837091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837095">current</span><span class="op" id="2837102">,</span>&nbsp;<span class="ident" id="2837104">next</span>&nbsp;<span class="op" id="2837109">=</span>&nbsp;<span class="ident" id="2837111">next</span><span class="op" id="2837115">,</span>&nbsp;<span class="ident" id="2837117">current</span><span class="op" id="2837124">[</span><span class="op" id="2837125">:</span><span class="num" id="2837126">0</span><span class="op" id="2837127">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837131">count</span>&nbsp;<span class="op" id="2837137">:=</span>&nbsp;<span class="ident" id="2837140">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837152">nextCount</span>&nbsp;<span class="op" id="2837162">=</span>&nbsp;<span class="ident" id="2837164">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837171">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837239">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837324">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837399">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837488">for</span>&nbsp;<span class="ident" id="2837492">_</span><span class="op" id="2837493">,</span>&nbsp;<span class="ident" id="2837495">scan</span>&nbsp;<span class="op" id="2837500">:=</span>&nbsp;<span class="keyword" id="2837503">range</span>&nbsp;<span class="ident" id="2837509">current</span>&nbsp;<span class="op" id="2837517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837522">t</span>&nbsp;<span class="op" id="2837524">:=</span>&nbsp;<span class="ident" id="2837527">scan</span><span class="op" id="2837531">.</span><span class="ident" id="2837532">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837539">if</span>&nbsp;<span class="ident" id="2837542">visited</span><span class="op" id="2837549">[</span><span class="ident" id="2837550">t</span><span class="op" id="2837551">]</span>&nbsp;<span class="op" id="2837553">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837559">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837624">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837692">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837745">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837757">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837762">visited</span><span class="op" id="2837769">[</span><span class="ident" id="2837770">t</span><span class="op" id="2837771">]</span>&nbsp;<span class="op" id="2837773">=</span>&nbsp;<span class="builtintype" id="2837775">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837783">for</span>&nbsp;<span class="ident" id="2837787">i</span>&nbsp;<span class="op" id="2837789">:=</span>&nbsp;<span class="keyword" id="2837792">range</span>&nbsp;<span class="ident" id="2837798">t</span><span class="op" id="2837799">.</span><span class="ident" id="2837800">fields</span>&nbsp;<span class="op" id="2837807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837813">f</span>&nbsp;<span class="op" id="2837815">:=</span>&nbsp;<span class="op" id="2837818">&amp;</span><span class="ident" id="2837819">t</span><span class="op" id="2837820">.</span><span class="ident" id="2837821">fields</span><span class="op" id="2837827">[</span><span class="ident" id="2837828">i</span><span class="op" id="2837829">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837835">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837874">var</span>&nbsp;<span class="ident" id="2837878">fname</span>&nbsp;<span class="builtintype" id="2837884">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837895">var</span>&nbsp;<span class="ident" id="2837899">ntyp</span>&nbsp;<span class="op" id="2837904">*</span><span class="ident" id="2837905">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2837915">if</span>&nbsp;<span class="ident" id="2837918">f</span><span class="op" id="2837919">.</span><span class="ident" id="2837920">name</span>&nbsp;<span class="op" id="2837925">!=</span>&nbsp;<span class="ident" id="2837928">nil</span>&nbsp;<span class="op" id="2837932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2837939">fname</span>&nbsp;<span class="op" id="2837945">=</span>&nbsp;<span class="op" id="2837947">*</span><span class="ident" id="2837948">f</span><span class="op" id="2837949">.</span><span class="ident" id="2837950">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2837959">}</span>&nbsp;<span class="keyword" id="2837961">else</span>&nbsp;<span class="op" id="2837966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2837973">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838014">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838044">ntyp</span>&nbsp;<span class="op" id="2838049">=</span>&nbsp;<span class="ident" id="2838051">f</span><span class="op" id="2838052">.</span><span class="ident" id="2838053">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838062">if</span>&nbsp;<span class="ident" id="2838065">ntyp</span><span class="op" id="2838069">.</span><span class="ident" id="2838070">Kind</span><span class="op" id="2838074">(</span><span class="op" id="2838075">)</span>&nbsp;<span class="op" id="2838077">==</span>&nbsp;<span class="ident" id="2838080">Ptr</span>&nbsp;<span class="op" id="2838084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838092">ntyp</span>&nbsp;<span class="op" id="2838097">=</span>&nbsp;<span class="ident" id="2838099">ntyp</span><span class="op" id="2838103">.</span><span class="ident" id="2838104">Elem</span><span class="op" id="2838108">(</span><span class="op" id="2838109">)</span><span class="op" id="2838110">.</span><span class="ident" id="2838111">common</span><span class="op" id="2838117">(</span><span class="op" id="2838118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838125">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838132">fname</span>&nbsp;<span class="op" id="2838138">=</span>&nbsp;<span class="ident" id="2838140">ntyp</span><span class="op" id="2838144">.</span><span class="ident" id="2838145">Name</span><span class="op" id="2838149">(</span><span class="op" id="2838150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838163">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838185">if</span>&nbsp;<span class="ident" id="2838188">match</span><span class="op" id="2838193">(</span><span class="ident" id="2838194">fname</span><span class="op" id="2838199">)</span>&nbsp;<span class="op" id="2838201">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838208">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838232">if</span>&nbsp;<span class="ident" id="2838235">count</span><span class="op" id="2838240">[</span><span class="ident" id="2838241">t</span><span class="op" id="2838242">]</span>&nbsp;<span class="op" id="2838244">&gt;</span>&nbsp;<span class="num" id="2838246">1</span>&nbsp;<span class="op" id="2838248">||</span>&nbsp;<span class="ident" id="2838251">ok</span>&nbsp;<span class="op" id="2838254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838262">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838327">return</span>&nbsp;<span class="ident" id="2838334">StructField</span><span class="op" id="2838345">{</span><span class="op" id="2838346">}</span><span class="op" id="2838347">,</span>&nbsp;<span class="builtintype" id="2838349">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838360">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838367">result</span>&nbsp;<span class="op" id="2838374">=</span>&nbsp;<span class="ident" id="2838376">t</span><span class="op" id="2838377">.</span><span class="ident" id="2838378">Field</span><span class="op" id="2838383">(</span><span class="ident" id="2838384">i</span><span class="op" id="2838385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838392">result</span><span class="op" id="2838398">.</span><span class="ident" id="2838399">Index</span>&nbsp;<span class="op" id="2838405">=</span>&nbsp;<span class="ident" id="2838407">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838416">result</span><span class="op" id="2838422">.</span><span class="ident" id="2838423">Index</span>&nbsp;<span class="op" id="2838429">=</span>&nbsp;<span class="builtinfunc" id="2838431">append</span><span class="op" id="2838437">(</span><span class="ident" id="2838438">result</span><span class="op" id="2838444">.</span><span class="ident" id="2838445">Index</span><span class="op" id="2838450">,</span>&nbsp;<span class="ident" id="2838452">scan</span><span class="op" id="2838456">.</span><span class="ident" id="2838457">index</span><span class="op" id="2838462">...</span><span class="op" id="2838465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838472">result</span><span class="op" id="2838478">.</span><span class="ident" id="2838479">Index</span>&nbsp;<span class="op" id="2838485">=</span>&nbsp;<span class="builtinfunc" id="2838487">append</span><span class="op" id="2838493">(</span><span class="ident" id="2838494">result</span><span class="op" id="2838500">.</span><span class="ident" id="2838501">Index</span><span class="op" id="2838506">,</span>&nbsp;<span class="ident" id="2838508">i</span><span class="op" id="2838509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838516">ok</span>&nbsp;<span class="op" id="2838519">=</span>&nbsp;<span class="builtintype" id="2838521">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838531">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838551">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838619">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2838689">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838747">if</span>&nbsp;<span class="ident" id="2838750">ok</span>&nbsp;<span class="op" id="2838753">||</span>&nbsp;<span class="ident" id="2838756">ntyp</span>&nbsp;<span class="op" id="2838761">==</span>&nbsp;<span class="ident" id="2838764">nil</span>&nbsp;<span class="op" id="2838768">||</span>&nbsp;<span class="ident" id="2838771">ntyp</span><span class="op" id="2838775">.</span><span class="ident" id="2838776">Kind</span><span class="op" id="2838780">(</span><span class="op" id="2838781">)</span>&nbsp;<span class="op" id="2838783">!=</span>&nbsp;<span class="ident" id="2838786">Struct</span>&nbsp;<span class="op" id="2838793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838800">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838819">styp</span>&nbsp;<span class="op" id="2838824">:=</span>&nbsp;<span class="op" id="2838827">(</span><span class="op" id="2838828">*</span><span class="ident" id="2838829">structType</span><span class="op" id="2838839">)</span><span class="op" id="2838840">(</span><span class="ident" id="2838841">unsafe</span><span class="op" id="2838847">.</span><span class="ident" id="2838848">Pointer</span><span class="op" id="2838855">(</span><span class="ident" id="2838856">ntyp</span><span class="op" id="2838860">)</span><span class="op" id="2838861">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838867">if</span>&nbsp;<span class="ident" id="2838870">nextCount</span><span class="op" id="2838879">[</span><span class="ident" id="2838880">styp</span><span class="op" id="2838884">]</span>&nbsp;<span class="op" id="2838886">&gt;</span>&nbsp;<span class="num" id="2838888">0</span>&nbsp;<span class="op" id="2838890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2838897">nextCount</span><span class="op" id="2838906">[</span><span class="ident" id="2838907">styp</span><span class="op" id="2838911">]</span>&nbsp;<span class="op" id="2838913">=</span>&nbsp;<span class="num" id="2838915">2</span>&nbsp;<span class="comment" id="2838917">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838955">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2838968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2838974">if</span>&nbsp;<span class="ident" id="2838977">nextCount</span>&nbsp;<span class="op" id="2838987">==</span>&nbsp;<span class="ident" id="2838990">nil</span>&nbsp;<span class="op" id="2838994">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839001">nextCount</span>&nbsp;<span class="op" id="2839011">=</span>&nbsp;<span class="keyword" id="2839013">map</span><span class="op" id="2839016">[</span><span class="op" id="2839017">*</span><span class="ident" id="2839018">structType</span><span class="op" id="2839028">]</span><span class="builtintype" id="2839029">int</span><span class="op" id="2839032">{</span><span class="op" id="2839033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839045">nextCount</span><span class="op" id="2839054">[</span><span class="ident" id="2839055">styp</span><span class="op" id="2839059">]</span>&nbsp;<span class="op" id="2839061">=</span>&nbsp;<span class="num" id="2839063">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839069">if</span>&nbsp;<span class="ident" id="2839072">count</span><span class="op" id="2839077">[</span><span class="ident" id="2839078">t</span><span class="op" id="2839079">]</span>&nbsp;<span class="op" id="2839081">&gt;</span>&nbsp;<span class="num" id="2839083">1</span>&nbsp;<span class="op" id="2839085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839092">nextCount</span><span class="op" id="2839101">[</span><span class="ident" id="2839102">styp</span><span class="op" id="2839106">]</span>&nbsp;<span class="op" id="2839108">=</span>&nbsp;<span class="num" id="2839110">2</span>&nbsp;<span class="comment" id="2839112">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839155">var</span>&nbsp;<span class="ident" id="2839159">index</span>&nbsp;<span class="op" id="2839165">[</span><span class="op" id="2839166">]</span><span class="builtintype" id="2839167">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839175">index</span>&nbsp;<span class="op" id="2839181">=</span>&nbsp;<span class="builtinfunc" id="2839183">append</span><span class="op" id="2839189">(</span><span class="ident" id="2839190">index</span><span class="op" id="2839195">,</span>&nbsp;<span class="ident" id="2839197">scan</span><span class="op" id="2839201">.</span><span class="ident" id="2839202">index</span><span class="op" id="2839207">...</span><span class="op" id="2839210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839216">index</span>&nbsp;<span class="op" id="2839222">=</span>&nbsp;<span class="builtinfunc" id="2839224">append</span><span class="op" id="2839230">(</span><span class="ident" id="2839231">index</span><span class="op" id="2839236">,</span>&nbsp;<span class="ident" id="2839238">i</span><span class="op" id="2839239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839245">next</span>&nbsp;<span class="op" id="2839250">=</span>&nbsp;<span class="builtinfunc" id="2839252">append</span><span class="op" id="2839258">(</span><span class="ident" id="2839259">next</span><span class="op" id="2839263">,</span>&nbsp;<span class="ident" id="2839265">fieldScan</span><span class="op" id="2839274">{</span><span class="ident" id="2839275">styp</span><span class="op" id="2839279">,</span>&nbsp;<span class="ident" id="2839281">index</span><span class="op" id="2839286">}</span><span class="op" id="2839287">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839300">if</span>&nbsp;<span class="ident" id="2839303">ok</span>&nbsp;<span class="op" id="2839306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839311">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839319">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839325">return</span><br>
<span class="lineno"></span><span class="op" id="2839332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2839335">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2839395">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2839448">func</span>&nbsp;<span class="op" id="2839453">(</span><span class="ident" id="2839454">t</span>&nbsp;<span class="op" id="2839456">*</span><span class="ident" id="2839457">structType</span><span class="op" id="2839467">)</span>&nbsp;<span class="ident" id="2839469">FieldByName</span><span class="op" id="2839480">(</span><span class="ident" id="2839481">name</span>&nbsp;<span class="builtintype" id="2839486">string</span><span class="op" id="2839492">)</span>&nbsp;<span class="op" id="2839494">(</span><span class="ident" id="2839495">f</span>&nbsp;<span class="ident" id="2839497">StructField</span><span class="op" id="2839508">,</span>&nbsp;<span class="ident" id="2839510">present</span>&nbsp;<span class="builtintype" id="2839518">bool</span><span class="op" id="2839522">)</span>&nbsp;<span class="op" id="2839524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2839527">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839599">hasAnon</span>&nbsp;<span class="op" id="2839607">:=</span>&nbsp;<span class="builtintype" id="2839610">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839617">if</span>&nbsp;<span class="ident" id="2839620">name</span>&nbsp;<span class="op" id="2839625">!=</span>&nbsp;<span class="string" id="2839628">&#34;&#34;</span>&nbsp;<span class="op" id="2839631">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839635">for</span>&nbsp;<span class="ident" id="2839639">i</span>&nbsp;<span class="op" id="2839641">:=</span>&nbsp;<span class="keyword" id="2839644">range</span>&nbsp;<span class="ident" id="2839650">t</span><span class="op" id="2839651">.</span><span class="ident" id="2839652">fields</span>&nbsp;<span class="op" id="2839659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839664">tf</span>&nbsp;<span class="op" id="2839667">:=</span>&nbsp;<span class="op" id="2839670">&amp;</span><span class="ident" id="2839671">t</span><span class="op" id="2839672">.</span><span class="ident" id="2839673">fields</span><span class="op" id="2839679">[</span><span class="ident" id="2839680">i</span><span class="op" id="2839681">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839686">if</span>&nbsp;<span class="ident" id="2839689">tf</span><span class="op" id="2839691">.</span><span class="ident" id="2839692">name</span>&nbsp;<span class="op" id="2839697">==</span>&nbsp;<span class="ident" id="2839700">nil</span>&nbsp;<span class="op" id="2839704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2839710">hasAnon</span>&nbsp;<span class="op" id="2839718">=</span>&nbsp;<span class="builtintype" id="2839720">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839729">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839746">if</span>&nbsp;<span class="op" id="2839749">*</span><span class="ident" id="2839750">tf</span><span class="op" id="2839752">.</span><span class="ident" id="2839753">name</span>&nbsp;<span class="op" id="2839758">==</span>&nbsp;<span class="ident" id="2839761">name</span>&nbsp;<span class="op" id="2839766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839772">return</span>&nbsp;<span class="ident" id="2839779">t</span><span class="op" id="2839780">.</span><span class="ident" id="2839781">Field</span><span class="op" id="2839786">(</span><span class="ident" id="2839787">i</span><span class="op" id="2839788">)</span><span class="op" id="2839789">,</span>&nbsp;<span class="builtintype" id="2839791">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839803">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839809">if</span>&nbsp;<span class="op" id="2839812">!</span><span class="ident" id="2839813">hasAnon</span>&nbsp;<span class="op" id="2839821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839825">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2839833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2839836">return</span>&nbsp;<span class="ident" id="2839843">t</span><span class="op" id="2839844">.</span><span class="ident" id="2839845">FieldByNameFunc</span><span class="op" id="2839860">(</span><span class="keyword" id="2839861">func</span><span class="op" id="2839865">(</span><span class="ident" id="2839866">s</span>&nbsp;<span class="builtintype" id="2839868">string</span><span class="op" id="2839874">)</span>&nbsp;<span class="builtintype" id="2839876">bool</span>&nbsp;<span class="op" id="2839881">{</span>&nbsp;<span class="keyword" id="2839883">return</span>&nbsp;<span class="ident" id="2839890">s</span>&nbsp;<span class="op" id="2839892">==</span>&nbsp;<span class="ident" id="2839895">name</span>&nbsp;<span class="op" id="2839900">}</span><span class="op" id="2839901">)</span><br>
<span class="lineno">1000</span><span class="op" id="2839903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2839906">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2839977">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2840005">func</span>&nbsp;<span class="ident" id="2840010">TypeOf</span><span class="op" id="2840016">(</span><span class="ident" id="2840017">i</span>&nbsp;<span class="keyword" id="2840019">interface</span><span class="op" id="2840028">{</span><span class="op" id="2840029">}</span><span class="op" id="2840030">)</span>&nbsp;<span class="ident" id="2840032">Type</span>&nbsp;<span class="op" id="2840037">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840040">eface</span>&nbsp;<span class="op" id="2840046">:=</span>&nbsp;<span class="op" id="2840049">*</span><span class="op" id="2840050">(</span><span class="op" id="2840051">*</span><span class="ident" id="2840052">emptyInterface</span><span class="op" id="2840066">)</span><span class="op" id="2840067">(</span><span class="ident" id="2840068">unsafe</span><span class="op" id="2840074">.</span><span class="ident" id="2840075">Pointer</span><span class="op" id="2840082">(</span><span class="op" id="2840083">&amp;</span><span class="ident" id="2840084">i</span><span class="op" id="2840085">)</span><span class="op" id="2840086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840089">return</span>&nbsp;<span class="ident" id="2840096">toType</span><span class="op" id="2840102">(</span><span class="ident" id="2840103">eface</span><span class="op" id="2840108">.</span><span class="ident" id="2840109">typ</span><span class="op" id="2840112">)</span><br>
<span class="lineno"></span><span class="op" id="2840114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2840117">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2840151">var</span>&nbsp;<span class="ident" id="2840155">ptrMap</span>&nbsp;<span class="keyword" id="2840162">struct</span>&nbsp;<span class="op" id="2840169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840172">sync</span><span class="op" id="2840176">.</span><span class="ident" id="2840177">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840186">m</span>&nbsp;<span class="keyword" id="2840188">map</span><span class="op" id="2840191">[</span><span class="op" id="2840192">*</span><span class="ident" id="2840193">rtype</span><span class="op" id="2840198">]</span><span class="op" id="2840199">*</span><span class="ident" id="2840200">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2840208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2840211">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2840261">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2840329">func</span>&nbsp;<span class="ident" id="2840334">PtrTo</span><span class="op" id="2840339">(</span><span class="ident" id="2840340">t</span>&nbsp;<span class="ident" id="2840342">Type</span><span class="op" id="2840346">)</span>&nbsp;<span class="ident" id="2840348">Type</span>&nbsp;<span class="op" id="2840353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840356">return</span>&nbsp;<span class="ident" id="2840363">t</span><span class="op" id="2840364">.</span><span class="op" id="2840365">(</span><span class="op" id="2840366">*</span><span class="ident" id="2840367">rtype</span><span class="op" id="2840372">)</span><span class="op" id="2840373">.</span><span class="ident" id="2840374">ptrTo</span><span class="op" id="2840379">(</span><span class="op" id="2840380">)</span><br>
<span class="lineno"></span><span class="op" id="2840382">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2840385">func</span>&nbsp;<span class="op" id="2840390">(</span><span class="ident" id="2840391">t</span>&nbsp;<span class="op" id="2840393">*</span><span class="ident" id="2840394">rtype</span><span class="op" id="2840399">)</span>&nbsp;<span class="ident" id="2840401">ptrTo</span><span class="op" id="2840406">(</span><span class="op" id="2840407">)</span>&nbsp;<span class="op" id="2840409">*</span><span class="ident" id="2840410">rtype</span>&nbsp;<span class="op" id="2840416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840419">if</span>&nbsp;<span class="ident" id="2840422">p</span>&nbsp;<span class="op" id="2840424">:=</span>&nbsp;<span class="ident" id="2840427">t</span><span class="op" id="2840428">.</span><span class="ident" id="2840429">ptrToThis</span><span class="op" id="2840438">;</span>&nbsp;<span class="ident" id="2840440">p</span>&nbsp;<span class="op" id="2840442">!=</span>&nbsp;<span class="ident" id="2840445">nil</span>&nbsp;<span class="op" id="2840449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840453">return</span>&nbsp;<span class="ident" id="2840460">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2840463">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840467">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840498">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840550">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840604">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840663">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840708">ptrMap</span><span class="op" id="2840714">.</span><span class="ident" id="2840715">RLock</span><span class="op" id="2840720">(</span><span class="op" id="2840721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840724">if</span>&nbsp;<span class="ident" id="2840727">m</span>&nbsp;<span class="op" id="2840729">:=</span>&nbsp;<span class="ident" id="2840732">ptrMap</span><span class="op" id="2840738">.</span><span class="ident" id="2840739">m</span><span class="op" id="2840740">;</span>&nbsp;<span class="ident" id="2840742">m</span>&nbsp;<span class="op" id="2840744">!=</span>&nbsp;<span class="ident" id="2840747">nil</span>&nbsp;<span class="op" id="2840751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840755">if</span>&nbsp;<span class="ident" id="2840758">p</span>&nbsp;<span class="op" id="2840760">:=</span>&nbsp;<span class="ident" id="2840763">m</span><span class="op" id="2840764">[</span><span class="ident" id="2840765">t</span><span class="op" id="2840766">]</span><span class="op" id="2840767">;</span>&nbsp;<span class="ident" id="2840769">p</span>&nbsp;<span class="op" id="2840771">!=</span>&nbsp;<span class="ident" id="2840774">nil</span>&nbsp;<span class="op" id="2840778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840783">ptrMap</span><span class="op" id="2840789">.</span><span class="ident" id="2840790">RUnlock</span><span class="op" id="2840797">(</span><span class="op" id="2840798">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840803">return</span>&nbsp;<span class="op" id="2840810">&amp;</span><span class="ident" id="2840811">p</span><span class="op" id="2840812">.</span><span class="ident" id="2840813">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2840821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2840824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840827">ptrMap</span><span class="op" id="2840833">.</span><span class="ident" id="2840834">RUnlock</span><span class="op" id="2840841">(</span><span class="op" id="2840842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840845">ptrMap</span><span class="op" id="2840851">.</span><span class="ident" id="2840852">Lock</span><span class="op" id="2840856">(</span><span class="op" id="2840857">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840860">if</span>&nbsp;<span class="ident" id="2840863">ptrMap</span><span class="op" id="2840869">.</span><span class="ident" id="2840870">m</span>&nbsp;<span class="op" id="2840872">==</span>&nbsp;<span class="ident" id="2840875">nil</span>&nbsp;<span class="op" id="2840879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840883">ptrMap</span><span class="op" id="2840889">.</span><span class="ident" id="2840890">m</span>&nbsp;<span class="op" id="2840892">=</span>&nbsp;<span class="builtinfunc" id="2840894">make</span><span class="op" id="2840898">(</span><span class="keyword" id="2840899">map</span><span class="op" id="2840902">[</span><span class="op" id="2840903">*</span><span class="ident" id="2840904">rtype</span><span class="op" id="2840909">]</span><span class="op" id="2840910">*</span><span class="ident" id="2840911">ptrType</span><span class="op" id="2840918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2840921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2840924">p</span>&nbsp;<span class="op" id="2840926">:=</span>&nbsp;<span class="ident" id="2840929">ptrMap</span><span class="op" id="2840935">.</span><span class="ident" id="2840936">m</span><span class="op" id="2840937">[</span><span class="ident" id="2840938">t</span><span class="op" id="2840939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2840942">if</span>&nbsp;<span class="ident" id="2840945">p</span>&nbsp;<span class="op" id="2840947">!=</span>&nbsp;<span class="ident" id="2840950">nil</span>&nbsp;<span class="op" id="2840954">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2840958">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841012">ptrMap</span><span class="op" id="2841018">.</span><span class="ident" id="2841019">Unlock</span><span class="op" id="2841025">(</span><span class="op" id="2841026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841030">return</span>&nbsp;<span class="op" id="2841037">&amp;</span><span class="ident" id="2841038">p</span><span class="op" id="2841039">.</span><span class="ident" id="2841040">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841051">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841106">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841133">p</span>&nbsp;<span class="op" id="2841135">=</span>&nbsp;<span class="builtinfunc" id="2841137">new</span><span class="op" id="2841140">(</span><span class="ident" id="2841141">ptrType</span><span class="op" id="2841148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841151">var</span>&nbsp;<span class="ident" id="2841155">iptr</span>&nbsp;<span class="keyword" id="2841160">interface</span><span class="op" id="2841169">{</span><span class="op" id="2841170">}</span>&nbsp;<span class="op" id="2841172">=</span>&nbsp;<span class="op" id="2841174">(</span><span class="op" id="2841175">*</span><span class="ident" id="2841176">unsafe</span><span class="op" id="2841182">.</span><span class="ident" id="2841183">Pointer</span><span class="op" id="2841190">)</span><span class="op" id="2841191">(</span><span class="ident" id="2841192">nil</span><span class="op" id="2841195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841198">prototype</span>&nbsp;<span class="op" id="2841208">:=</span>&nbsp;<span class="op" id="2841211">*</span><span class="op" id="2841212">(</span><span class="op" id="2841213">*</span><span class="op" id="2841214">*</span><span class="ident" id="2841215">ptrType</span><span class="op" id="2841222">)</span><span class="op" id="2841223">(</span><span class="ident" id="2841224">unsafe</span><span class="op" id="2841230">.</span><span class="ident" id="2841231">Pointer</span><span class="op" id="2841238">(</span><span class="op" id="2841239">&amp;</span><span class="ident" id="2841240">iptr</span><span class="op" id="2841244">)</span><span class="op" id="2841245">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841248">*</span><span class="ident" id="2841249">p</span>&nbsp;<span class="op" id="2841251">=</span>&nbsp;<span class="op" id="2841253">*</span><span class="ident" id="2841254">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841266">s</span>&nbsp;<span class="op" id="2841268">:=</span>&nbsp;<span class="string" id="2841271">&#34;*&#34;</span>&nbsp;<span class="op" id="2841275">+</span>&nbsp;<span class="op" id="2841277">*</span><span class="ident" id="2841278">t</span><span class="op" id="2841279">.</span><span class="builtintype" id="2841280">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841288">p</span><span class="op" id="2841289">.</span><span class="builtintype" id="2841290">string</span>&nbsp;<span class="op" id="2841297">=</span>&nbsp;<span class="op" id="2841299">&amp;</span><span class="ident" id="2841300">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841304">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841360">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841409">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841460">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2841512">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841542">p</span><span class="op" id="2841543">.</span><span class="ident" id="2841544">hash</span>&nbsp;<span class="op" id="2841549">=</span>&nbsp;<span class="ident" id="2841551">fnv1</span><span class="op" id="2841555">(</span><span class="ident" id="2841556">t</span><span class="op" id="2841557">.</span><span class="ident" id="2841558">hash</span><span class="op" id="2841562">,</span>&nbsp;<span class="string" id="2841564">&#39;*&#39;</span><span class="op" id="2841567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841571">p</span><span class="op" id="2841572">.</span><span class="ident" id="2841573">uncommonType</span>&nbsp;<span class="op" id="2841586">=</span>&nbsp;<span class="ident" id="2841588">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841593">p</span><span class="op" id="2841594">.</span><span class="ident" id="2841595">ptrToThis</span>&nbsp;<span class="op" id="2841605">=</span>&nbsp;<span class="ident" id="2841607">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841612">p</span><span class="op" id="2841613">.</span><span class="ident" id="2841614">zero</span>&nbsp;<span class="op" id="2841619">=</span>&nbsp;<span class="ident" id="2841621">unsafe</span><span class="op" id="2841627">.</span><span class="ident" id="2841628">Pointer</span><span class="op" id="2841635">(</span><span class="op" id="2841636">&amp;</span><span class="builtinfunc" id="2841637">make</span><span class="op" id="2841641">(</span><span class="op" id="2841642">[</span><span class="op" id="2841643">]</span><span class="builtintype" id="2841644">byte</span><span class="op" id="2841648">,</span>&nbsp;<span class="ident" id="2841650">p</span><span class="op" id="2841651">.</span><span class="ident" id="2841652">size</span><span class="op" id="2841656">)</span><span class="op" id="2841657">[</span><span class="num" id="2841658">0</span><span class="op" id="2841659">]</span><span class="op" id="2841660">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841663">p</span><span class="op" id="2841664">.</span><span class="ident" id="2841665">elem</span>&nbsp;<span class="op" id="2841670">=</span>&nbsp;<span class="ident" id="2841672">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841676">ptrMap</span><span class="op" id="2841682">.</span><span class="ident" id="2841683">m</span><span class="op" id="2841684">[</span><span class="ident" id="2841685">t</span><span class="op" id="2841686">]</span>&nbsp;<span class="op" id="2841688">=</span>&nbsp;<span class="ident" id="2841690">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841693">ptrMap</span><span class="op" id="2841699">.</span><span class="ident" id="2841700">Unlock</span><span class="op" id="2841706">(</span><span class="op" id="2841707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841710">return</span>&nbsp;<span class="op" id="2841717">&amp;</span><span class="ident" id="2841718">p</span><span class="op" id="2841719">.</span><span class="ident" id="2841720">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2841726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2841729">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2841815">func</span>&nbsp;<span class="ident" id="2841820">fnv1</span><span class="op" id="2841824">(</span><span class="ident" id="2841825">x</span>&nbsp;<span class="builtintype" id="2841827">uint32</span><span class="op" id="2841833">,</span>&nbsp;<span class="ident" id="2841835">list</span>&nbsp;<span class="op" id="2841840">...</span><span class="builtintype" id="2841843">byte</span><span class="op" id="2841847">)</span>&nbsp;<span class="builtintype" id="2841849">uint32</span>&nbsp;<span class="op" id="2841856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841859">for</span>&nbsp;<span class="ident" id="2841863">_</span><span class="op" id="2841864">,</span>&nbsp;<span class="ident" id="2841866">b</span>&nbsp;<span class="op" id="2841868">:=</span>&nbsp;<span class="keyword" id="2841871">range</span>&nbsp;<span class="ident" id="2841877">list</span>&nbsp;<span class="op" id="2841882">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2841886">x</span>&nbsp;<span class="op" id="2841888">=</span>&nbsp;<span class="ident" id="2841890">x</span><span class="op" id="2841891">*</span><span class="num" id="2841892">16777619</span>&nbsp;<span class="op" id="2841901">^</span>&nbsp;<span class="builtintype" id="2841903">uint32</span><span class="op" id="2841909">(</span><span class="ident" id="2841910">b</span><span class="op" id="2841911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2841914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841917">return</span>&nbsp;<span class="ident" id="2841924">x</span><br>
<span class="lineno"></span><span class="op" id="2841926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2841929">func</span>&nbsp;<span class="op" id="2841934">(</span><span class="ident" id="2841935">t</span>&nbsp;<span class="op" id="2841937">*</span><span class="ident" id="2841938">rtype</span><span class="op" id="2841943">)</span>&nbsp;<span class="ident" id="2841945">Implements</span><span class="op" id="2841955">(</span><span class="ident" id="2841956">u</span>&nbsp;<span class="ident" id="2841958">Type</span><span class="op" id="2841962">)</span>&nbsp;<span class="builtintype" id="2841964">bool</span>&nbsp;<span class="op" id="2841969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2841972">if</span>&nbsp;<span class="ident" id="2841975">u</span>&nbsp;<span class="op" id="2841977">==</span>&nbsp;<span class="ident" id="2841980">nil</span>&nbsp;<span class="op" id="2841984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2841988">panic</span><span class="op" id="2841993">(</span><span class="string" id="2841994">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2842039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842045">if</span>&nbsp;<span class="ident" id="2842048">u</span><span class="op" id="2842049">.</span><span class="ident" id="2842050">Kind</span><span class="op" id="2842054">(</span><span class="op" id="2842055">)</span>&nbsp;<span class="op" id="2842057">!=</span>&nbsp;<span class="ident" id="2842060">Interface</span>&nbsp;<span class="op" id="2842070">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2842074">panic</span><span class="op" id="2842079">(</span><span class="string" id="2842080">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2842135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842141">return</span>&nbsp;<span class="ident" id="2842148">implements</span><span class="op" id="2842158">(</span><span class="ident" id="2842159">u</span><span class="op" id="2842160">.</span><span class="op" id="2842161">(</span><span class="op" id="2842162">*</span><span class="ident" id="2842163">rtype</span><span class="op" id="2842168">)</span><span class="op" id="2842169">,</span>&nbsp;<span class="ident" id="2842171">t</span><span class="op" id="2842172">)</span><br>
<span class="lineno"></span><span class="op" id="2842174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2842177">func</span>&nbsp;<span class="op" id="2842182">(</span><span class="ident" id="2842183">t</span>&nbsp;<span class="op" id="2842185">*</span><span class="ident" id="2842186">rtype</span><span class="op" id="2842191">)</span>&nbsp;<span class="ident" id="2842193">AssignableTo</span><span class="op" id="2842205">(</span><span class="ident" id="2842206">u</span>&nbsp;<span class="ident" id="2842208">Type</span><span class="op" id="2842212">)</span>&nbsp;<span class="builtintype" id="2842214">bool</span>&nbsp;<span class="op" id="2842219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842222">if</span>&nbsp;<span class="ident" id="2842225">u</span>&nbsp;<span class="op" id="2842227">==</span>&nbsp;<span class="ident" id="2842230">nil</span>&nbsp;<span class="op" id="2842234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2842238">panic</span><span class="op" id="2842243">(</span><span class="string" id="2842244">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2842291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842297">uu</span>&nbsp;<span class="op" id="2842300">:=</span>&nbsp;<span class="ident" id="2842303">u</span><span class="op" id="2842304">.</span><span class="op" id="2842305">(</span><span class="op" id="2842306">*</span><span class="ident" id="2842307">rtype</span><span class="op" id="2842312">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842315">return</span>&nbsp;<span class="ident" id="2842322">directlyAssignable</span><span class="op" id="2842340">(</span><span class="ident" id="2842341">uu</span><span class="op" id="2842343">,</span>&nbsp;<span class="ident" id="2842345">t</span><span class="op" id="2842346">)</span>&nbsp;<span class="op" id="2842348">||</span>&nbsp;<span class="ident" id="2842351">implements</span><span class="op" id="2842361">(</span><span class="ident" id="2842362">uu</span><span class="op" id="2842364">,</span>&nbsp;<span class="ident" id="2842366">t</span><span class="op" id="2842367">)</span><br>
<span class="lineno"></span><span class="op" id="2842369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2842372">func</span>&nbsp;<span class="op" id="2842377">(</span><span class="ident" id="2842378">t</span>&nbsp;<span class="op" id="2842380">*</span><span class="ident" id="2842381">rtype</span><span class="op" id="2842386">)</span>&nbsp;<span class="ident" id="2842388">ConvertibleTo</span><span class="op" id="2842401">(</span><span class="ident" id="2842402">u</span>&nbsp;<span class="ident" id="2842404">Type</span><span class="op" id="2842408">)</span>&nbsp;<span class="builtintype" id="2842410">bool</span>&nbsp;<span class="op" id="2842415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842418">if</span>&nbsp;<span class="ident" id="2842421">u</span>&nbsp;<span class="op" id="2842423">==</span>&nbsp;<span class="ident" id="2842426">nil</span>&nbsp;<span class="op" id="2842430">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2842434">panic</span><span class="op" id="2842439">(</span><span class="string" id="2842440">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2842488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842494">uu</span>&nbsp;<span class="op" id="2842497">:=</span>&nbsp;<span class="ident" id="2842500">u</span><span class="op" id="2842501">.</span><span class="op" id="2842502">(</span><span class="op" id="2842503">*</span><span class="ident" id="2842504">rtype</span><span class="op" id="2842509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842512">return</span>&nbsp;<span class="ident" id="2842519">convertOp</span><span class="op" id="2842528">(</span><span class="ident" id="2842529">uu</span><span class="op" id="2842531">,</span>&nbsp;<span class="ident" id="2842533">t</span><span class="op" id="2842534">)</span>&nbsp;<span class="op" id="2842536">!=</span>&nbsp;<span class="ident" id="2842539">nil</span><br>
<span class="lineno"></span><span class="op" id="2842543">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2842546">func</span>&nbsp;<span class="op" id="2842551">(</span><span class="ident" id="2842552">t</span>&nbsp;<span class="op" id="2842554">*</span><span class="ident" id="2842555">rtype</span><span class="op" id="2842560">)</span>&nbsp;<span class="ident" id="2842562">Comparable</span><span class="op" id="2842572">(</span><span class="op" id="2842573">)</span>&nbsp;<span class="builtintype" id="2842575">bool</span>&nbsp;<span class="op" id="2842580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842583">return</span>&nbsp;<span class="ident" id="2842590">t</span><span class="op" id="2842591">.</span><span class="ident" id="2842592">alg</span>&nbsp;<span class="op" id="2842596">!=</span>&nbsp;<span class="ident" id="2842599">nil</span>&nbsp;<span class="op" id="2842603">&amp;&amp;</span>&nbsp;<span class="ident" id="2842606">t</span><span class="op" id="2842607">.</span><span class="ident" id="2842608">alg</span><span class="op" id="2842611">.</span><span class="ident" id="2842612">equal</span>&nbsp;<span class="op" id="2842618">!=</span>&nbsp;<span class="ident" id="2842621">nil</span><br>
<span class="lineno"></span><span class="op" id="2842625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2842628">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2842702">func</span>&nbsp;<span class="ident" id="2842707">implements</span><span class="op" id="2842717">(</span><span class="ident" id="2842718">T</span><span class="op" id="2842719">,</span>&nbsp;<span class="ident" id="2842721">V</span>&nbsp;<span class="op" id="2842723">*</span><span class="ident" id="2842724">rtype</span><span class="op" id="2842729">)</span>&nbsp;<span class="builtintype" id="2842731">bool</span>&nbsp;<span class="op" id="2842736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842739">if</span>&nbsp;<span class="ident" id="2842742">T</span><span class="op" id="2842743">.</span><span class="ident" id="2842744">Kind</span><span class="op" id="2842748">(</span><span class="op" id="2842749">)</span>&nbsp;<span class="op" id="2842751">!=</span>&nbsp;<span class="ident" id="2842754">Interface</span>&nbsp;<span class="op" id="2842764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842768">return</span>&nbsp;<span class="builtintype" id="2842775">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842782">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2842785">t</span>&nbsp;<span class="op" id="2842787">:=</span>&nbsp;<span class="op" id="2842790">(</span><span class="op" id="2842791">*</span><span class="ident" id="2842792">interfaceType</span><span class="op" id="2842805">)</span><span class="op" id="2842806">(</span><span class="ident" id="2842807">unsafe</span><span class="op" id="2842813">.</span><span class="ident" id="2842814">Pointer</span><span class="op" id="2842821">(</span><span class="ident" id="2842822">T</span><span class="op" id="2842823">)</span><span class="op" id="2842824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842827">if</span>&nbsp;<span class="builtinfunc" id="2842830">len</span><span class="op" id="2842833">(</span><span class="ident" id="2842834">t</span><span class="op" id="2842835">.</span><span class="ident" id="2842836">methods</span><span class="op" id="2842843">)</span>&nbsp;<span class="op" id="2842845">==</span>&nbsp;<span class="num" id="2842848">0</span>&nbsp;<span class="op" id="2842850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2842854">return</span>&nbsp;<span class="builtintype" id="2842861">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2842867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2842871">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2842925">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2842985">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843031">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843093">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843151">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843211">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843272">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843329">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843388">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843452">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2843506">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843539">if</span>&nbsp;<span class="ident" id="2843542">V</span><span class="op" id="2843543">.</span><span class="ident" id="2843544">Kind</span><span class="op" id="2843548">(</span><span class="op" id="2843549">)</span>&nbsp;<span class="op" id="2843551">==</span>&nbsp;<span class="ident" id="2843554">Interface</span>&nbsp;<span class="op" id="2843564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843568">v</span>&nbsp;<span class="op" id="2843570">:=</span>&nbsp;<span class="op" id="2843573">(</span><span class="op" id="2843574">*</span><span class="ident" id="2843575">interfaceType</span><span class="op" id="2843588">)</span><span class="op" id="2843589">(</span><span class="ident" id="2843590">unsafe</span><span class="op" id="2843596">.</span><span class="ident" id="2843597">Pointer</span><span class="op" id="2843604">(</span><span class="ident" id="2843605">V</span><span class="op" id="2843606">)</span><span class="op" id="2843607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843611">i</span>&nbsp;<span class="op" id="2843613">:=</span>&nbsp;<span class="num" id="2843616">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843620">for</span>&nbsp;<span class="ident" id="2843624">j</span>&nbsp;<span class="op" id="2843626">:=</span>&nbsp;<span class="num" id="2843629">0</span><span class="op" id="2843630">;</span>&nbsp;<span class="ident" id="2843632">j</span>&nbsp;<span class="op" id="2843634">&lt;</span>&nbsp;<span class="builtinfunc" id="2843636">len</span><span class="op" id="2843639">(</span><span class="ident" id="2843640">v</span><span class="op" id="2843641">.</span><span class="ident" id="2843642">methods</span><span class="op" id="2843649">)</span><span class="op" id="2843650">;</span>&nbsp;<span class="ident" id="2843652">j</span><span class="op" id="2843653">++</span>&nbsp;<span class="op" id="2843656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843661">tm</span>&nbsp;<span class="op" id="2843664">:=</span>&nbsp;<span class="op" id="2843667">&amp;</span><span class="ident" id="2843668">t</span><span class="op" id="2843669">.</span><span class="ident" id="2843670">methods</span><span class="op" id="2843677">[</span><span class="ident" id="2843678">i</span><span class="op" id="2843679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843684">vm</span>&nbsp;<span class="op" id="2843687">:=</span>&nbsp;<span class="op" id="2843690">&amp;</span><span class="ident" id="2843691">v</span><span class="op" id="2843692">.</span><span class="ident" id="2843693">methods</span><span class="op" id="2843700">[</span><span class="ident" id="2843701">j</span><span class="op" id="2843702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843707">if</span>&nbsp;<span class="ident" id="2843710">vm</span><span class="op" id="2843712">.</span><span class="ident" id="2843713">name</span>&nbsp;<span class="op" id="2843718">==</span>&nbsp;<span class="ident" id="2843721">tm</span><span class="op" id="2843723">.</span><span class="ident" id="2843724">name</span>&nbsp;<span class="op" id="2843729">&amp;&amp;</span>&nbsp;<span class="ident" id="2843732">vm</span><span class="op" id="2843734">.</span><span class="ident" id="2843735">pkgPath</span>&nbsp;<span class="op" id="2843743">==</span>&nbsp;<span class="ident" id="2843746">tm</span><span class="op" id="2843748">.</span><span class="ident" id="2843749">pkgPath</span>&nbsp;<span class="op" id="2843757">&amp;&amp;</span>&nbsp;<span class="ident" id="2843760">vm</span><span class="op" id="2843762">.</span><span class="ident" id="2843763">typ</span>&nbsp;<span class="op" id="2843767">==</span>&nbsp;<span class="ident" id="2843770">tm</span><span class="op" id="2843772">.</span><span class="ident" id="2843773">typ</span>&nbsp;<span class="op" id="2843777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843783">if</span>&nbsp;<span class="ident" id="2843786">i</span><span class="op" id="2843787">++</span><span class="op" id="2843789">;</span>&nbsp;<span class="ident" id="2843791">i</span>&nbsp;<span class="op" id="2843793">&gt;=</span>&nbsp;<span class="builtinfunc" id="2843796">len</span><span class="op" id="2843799">(</span><span class="ident" id="2843800">t</span><span class="op" id="2843801">.</span><span class="ident" id="2843802">methods</span><span class="op" id="2843809">)</span>&nbsp;<span class="op" id="2843811">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843818">return</span>&nbsp;<span class="builtintype" id="2843825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843847">return</span>&nbsp;<span class="builtintype" id="2843854">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843865">v</span>&nbsp;<span class="op" id="2843867">:=</span>&nbsp;<span class="ident" id="2843870">V</span><span class="op" id="2843871">.</span><span class="ident" id="2843872">uncommon</span><span class="op" id="2843880">(</span><span class="op" id="2843881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843884">if</span>&nbsp;<span class="ident" id="2843887">v</span>&nbsp;<span class="op" id="2843889">==</span>&nbsp;<span class="ident" id="2843892">nil</span>&nbsp;<span class="op" id="2843896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843900">return</span>&nbsp;<span class="builtintype" id="2843907">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2843914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843917">i</span>&nbsp;<span class="op" id="2843919">:=</span>&nbsp;<span class="num" id="2843922">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2843925">for</span>&nbsp;<span class="ident" id="2843929">j</span>&nbsp;<span class="op" id="2843931">:=</span>&nbsp;<span class="num" id="2843934">0</span><span class="op" id="2843935">;</span>&nbsp;<span class="ident" id="2843937">j</span>&nbsp;<span class="op" id="2843939">&lt;</span>&nbsp;<span class="builtinfunc" id="2843941">len</span><span class="op" id="2843944">(</span><span class="ident" id="2843945">v</span><span class="op" id="2843946">.</span><span class="ident" id="2843947">methods</span><span class="op" id="2843954">)</span><span class="op" id="2843955">;</span>&nbsp;<span class="ident" id="2843957">j</span><span class="op" id="2843958">++</span>&nbsp;<span class="op" id="2843961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843965">tm</span>&nbsp;<span class="op" id="2843968">:=</span>&nbsp;<span class="op" id="2843971">&amp;</span><span class="ident" id="2843972">t</span><span class="op" id="2843973">.</span><span class="ident" id="2843974">methods</span><span class="op" id="2843981">[</span><span class="ident" id="2843982">i</span><span class="op" id="2843983">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2843987">vm</span>&nbsp;<span class="op" id="2843990">:=</span>&nbsp;<span class="op" id="2843993">&amp;</span><span class="ident" id="2843994">v</span><span class="op" id="2843995">.</span><span class="ident" id="2843996">methods</span><span class="op" id="2844003">[</span><span class="ident" id="2844004">j</span><span class="op" id="2844005">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844009">if</span>&nbsp;<span class="ident" id="2844012">vm</span><span class="op" id="2844014">.</span><span class="ident" id="2844015">name</span>&nbsp;<span class="op" id="2844020">==</span>&nbsp;<span class="ident" id="2844023">tm</span><span class="op" id="2844025">.</span><span class="ident" id="2844026">name</span>&nbsp;<span class="op" id="2844031">&amp;&amp;</span>&nbsp;<span class="ident" id="2844034">vm</span><span class="op" id="2844036">.</span><span class="ident" id="2844037">pkgPath</span>&nbsp;<span class="op" id="2844045">==</span>&nbsp;<span class="ident" id="2844048">tm</span><span class="op" id="2844050">.</span><span class="ident" id="2844051">pkgPath</span>&nbsp;<span class="op" id="2844059">&amp;&amp;</span>&nbsp;<span class="ident" id="2844062">vm</span><span class="op" id="2844064">.</span><span class="ident" id="2844065">mtyp</span>&nbsp;<span class="op" id="2844070">==</span>&nbsp;<span class="ident" id="2844073">tm</span><span class="op" id="2844075">.</span><span class="ident" id="2844076">typ</span>&nbsp;<span class="op" id="2844080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844085">if</span>&nbsp;<span class="ident" id="2844088">i</span><span class="op" id="2844089">++</span><span class="op" id="2844091">;</span>&nbsp;<span class="ident" id="2844093">i</span>&nbsp;<span class="op" id="2844095">&gt;=</span>&nbsp;<span class="builtinfunc" id="2844098">len</span><span class="op" id="2844101">(</span><span class="ident" id="2844102">t</span><span class="op" id="2844103">.</span><span class="ident" id="2844104">methods</span><span class="op" id="2844111">)</span>&nbsp;<span class="op" id="2844113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844119">return</span>&nbsp;<span class="builtintype" id="2844126">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844138">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844144">return</span>&nbsp;<span class="builtintype" id="2844151">false</span><br>
<span class="lineno"></span><span class="op" id="2844157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2844160">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2844234">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2844284">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2844336">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2844392">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2844458">func</span>&nbsp;<span class="ident" id="2844463">directlyAssignable</span><span class="op" id="2844481">(</span><span class="ident" id="2844482">T</span><span class="op" id="2844483">,</span>&nbsp;<span class="ident" id="2844485">V</span>&nbsp;<span class="op" id="2844487">*</span><span class="ident" id="2844488">rtype</span><span class="op" id="2844493">)</span>&nbsp;<span class="builtintype" id="2844495">bool</span>&nbsp;<span class="op" id="2844500">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2844503">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844537">if</span>&nbsp;<span class="ident" id="2844540">T</span>&nbsp;<span class="op" id="2844542">==</span>&nbsp;<span class="ident" id="2844545">V</span>&nbsp;<span class="op" id="2844547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844551">return</span>&nbsp;<span class="builtintype" id="2844558">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2844568">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2844622">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844660">if</span>&nbsp;<span class="ident" id="2844663">T</span><span class="op" id="2844664">.</span><span class="ident" id="2844665">Name</span><span class="op" id="2844669">(</span><span class="op" id="2844670">)</span>&nbsp;<span class="op" id="2844672">!=</span>&nbsp;<span class="string" id="2844675">&#34;&#34;</span>&nbsp;<span class="op" id="2844678">&amp;&amp;</span>&nbsp;<span class="ident" id="2844681">V</span><span class="op" id="2844682">.</span><span class="ident" id="2844683">Name</span><span class="op" id="2844687">(</span><span class="op" id="2844688">)</span>&nbsp;<span class="op" id="2844690">!=</span>&nbsp;<span class="string" id="2844693">&#34;&#34;</span>&nbsp;<span class="op" id="2844696">||</span>&nbsp;<span class="ident" id="2844699">T</span><span class="op" id="2844700">.</span><span class="ident" id="2844701">Kind</span><span class="op" id="2844705">(</span><span class="op" id="2844706">)</span>&nbsp;<span class="op" id="2844708">!=</span>&nbsp;<span class="ident" id="2844711">V</span><span class="op" id="2844712">.</span><span class="ident" id="2844713">Kind</span><span class="op" id="2844717">(</span><span class="op" id="2844718">)</span>&nbsp;<span class="op" id="2844720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844724">return</span>&nbsp;<span class="builtintype" id="2844731">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844738">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2844742">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844802">return</span>&nbsp;<span class="ident" id="2844809">haveIdenticalUnderlyingType</span><span class="op" id="2844836">(</span><span class="ident" id="2844837">T</span><span class="op" id="2844838">,</span>&nbsp;<span class="ident" id="2844840">V</span><span class="op" id="2844841">)</span><br>
<span class="lineno"></span><span class="op" id="2844843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2844846">func</span>&nbsp;<span class="ident" id="2844851">haveIdenticalUnderlyingType</span><span class="op" id="2844878">(</span><span class="ident" id="2844879">T</span><span class="op" id="2844880">,</span>&nbsp;<span class="ident" id="2844882">V</span>&nbsp;<span class="op" id="2844884">*</span><span class="ident" id="2844885">rtype</span><span class="op" id="2844890">)</span>&nbsp;<span class="builtintype" id="2844892">bool</span>&nbsp;<span class="op" id="2844897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844900">if</span>&nbsp;<span class="ident" id="2844903">T</span>&nbsp;<span class="op" id="2844905">==</span>&nbsp;<span class="ident" id="2844908">V</span>&nbsp;<span class="op" id="2844910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844914">return</span>&nbsp;<span class="builtintype" id="2844921">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2844931">kind</span>&nbsp;<span class="op" id="2844936">:=</span>&nbsp;<span class="ident" id="2844939">T</span><span class="op" id="2844940">.</span><span class="ident" id="2844941">Kind</span><span class="op" id="2844945">(</span><span class="op" id="2844946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844949">if</span>&nbsp;<span class="ident" id="2844952">kind</span>&nbsp;<span class="op" id="2844957">!=</span>&nbsp;<span class="ident" id="2844960">V</span><span class="op" id="2844961">.</span><span class="ident" id="2844962">Kind</span><span class="op" id="2844966">(</span><span class="op" id="2844967">)</span>&nbsp;<span class="op" id="2844969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2844973">return</span>&nbsp;<span class="builtintype" id="2844980">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2844987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2844991">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845055">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845098">if</span>&nbsp;<span class="ident" id="2845101">Bool</span>&nbsp;<span class="op" id="2845106">&lt;=</span>&nbsp;<span class="ident" id="2845109">kind</span>&nbsp;<span class="op" id="2845114">&amp;&amp;</span>&nbsp;<span class="ident" id="2845117">kind</span>&nbsp;<span class="op" id="2845122">&lt;=</span>&nbsp;<span class="ident" id="2845125">Complex128</span>&nbsp;<span class="op" id="2845136">||</span>&nbsp;<span class="ident" id="2845139">kind</span>&nbsp;<span class="op" id="2845144">==</span>&nbsp;<span class="ident" id="2845147">String</span>&nbsp;<span class="op" id="2845154">||</span>&nbsp;<span class="ident" id="2845157">kind</span>&nbsp;<span class="op" id="2845162">==</span>&nbsp;<span class="ident" id="2845165">UnsafePointer</span>&nbsp;<span class="op" id="2845179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845183">return</span>&nbsp;<span class="builtintype" id="2845190">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845196">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845200">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845221">switch</span>&nbsp;<span class="ident" id="2845228">kind</span>&nbsp;<span class="op" id="2845233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845236">case</span>&nbsp;<span class="ident" id="2845241">Array</span><span class="op" id="2845246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845250">return</span>&nbsp;<span class="ident" id="2845257">T</span><span class="op" id="2845258">.</span><span class="ident" id="2845259">Elem</span><span class="op" id="2845263">(</span><span class="op" id="2845264">)</span>&nbsp;<span class="op" id="2845266">==</span>&nbsp;<span class="ident" id="2845269">V</span><span class="op" id="2845270">.</span><span class="ident" id="2845271">Elem</span><span class="op" id="2845275">(</span><span class="op" id="2845276">)</span>&nbsp;<span class="op" id="2845278">&amp;&amp;</span>&nbsp;<span class="ident" id="2845281">T</span><span class="op" id="2845282">.</span><span class="ident" id="2845283">Len</span><span class="op" id="2845286">(</span><span class="op" id="2845287">)</span>&nbsp;<span class="op" id="2845289">==</span>&nbsp;<span class="ident" id="2845292">V</span><span class="op" id="2845293">.</span><span class="ident" id="2845294">Len</span><span class="op" id="2845297">(</span><span class="op" id="2845298">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845302">case</span>&nbsp;<span class="ident" id="2845307">Chan</span><span class="op" id="2845311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845315">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845334">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845396">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845452">if</span>&nbsp;<span class="ident" id="2845455">V</span><span class="op" id="2845456">.</span><span class="ident" id="2845457">ChanDir</span><span class="op" id="2845464">(</span><span class="op" id="2845465">)</span>&nbsp;<span class="op" id="2845467">==</span>&nbsp;<span class="ident" id="2845470">BothDir</span>&nbsp;<span class="op" id="2845478">&amp;&amp;</span>&nbsp;<span class="ident" id="2845481">T</span><span class="op" id="2845482">.</span><span class="ident" id="2845483">Elem</span><span class="op" id="2845487">(</span><span class="op" id="2845488">)</span>&nbsp;<span class="op" id="2845490">==</span>&nbsp;<span class="ident" id="2845493">V</span><span class="op" id="2845494">.</span><span class="ident" id="2845495">Elem</span><span class="op" id="2845499">(</span><span class="op" id="2845500">)</span>&nbsp;<span class="op" id="2845502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845507">return</span>&nbsp;<span class="builtintype" id="2845514">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2845526">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845586">return</span>&nbsp;<span class="ident" id="2845593">V</span><span class="op" id="2845594">.</span><span class="ident" id="2845595">ChanDir</span><span class="op" id="2845602">(</span><span class="op" id="2845603">)</span>&nbsp;<span class="op" id="2845605">==</span>&nbsp;<span class="ident" id="2845608">T</span><span class="op" id="2845609">.</span><span class="ident" id="2845610">ChanDir</span><span class="op" id="2845617">(</span><span class="op" id="2845618">)</span>&nbsp;<span class="op" id="2845620">&amp;&amp;</span>&nbsp;<span class="ident" id="2845623">T</span><span class="op" id="2845624">.</span><span class="ident" id="2845625">Elem</span><span class="op" id="2845629">(</span><span class="op" id="2845630">)</span>&nbsp;<span class="op" id="2845632">==</span>&nbsp;<span class="ident" id="2845635">V</span><span class="op" id="2845636">.</span><span class="ident" id="2845637">Elem</span><span class="op" id="2845641">(</span><span class="op" id="2845642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845646">case</span>&nbsp;<span class="ident" id="2845651">Func</span><span class="op" id="2845655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845659">t</span>&nbsp;<span class="op" id="2845661">:=</span>&nbsp;<span class="op" id="2845664">(</span><span class="op" id="2845665">*</span><span class="ident" id="2845666">funcType</span><span class="op" id="2845674">)</span><span class="op" id="2845675">(</span><span class="ident" id="2845676">unsafe</span><span class="op" id="2845682">.</span><span class="ident" id="2845683">Pointer</span><span class="op" id="2845690">(</span><span class="ident" id="2845691">T</span><span class="op" id="2845692">)</span><span class="op" id="2845693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2845697">v</span>&nbsp;<span class="op" id="2845699">:=</span>&nbsp;<span class="op" id="2845702">(</span><span class="op" id="2845703">*</span><span class="ident" id="2845704">funcType</span><span class="op" id="2845712">)</span><span class="op" id="2845713">(</span><span class="ident" id="2845714">unsafe</span><span class="op" id="2845720">.</span><span class="ident" id="2845721">Pointer</span><span class="op" id="2845728">(</span><span class="ident" id="2845729">V</span><span class="op" id="2845730">)</span><span class="op" id="2845731">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845735">if</span>&nbsp;<span class="ident" id="2845738">t</span><span class="op" id="2845739">.</span><span class="ident" id="2845740">dotdotdot</span>&nbsp;<span class="op" id="2845750">!=</span>&nbsp;<span class="ident" id="2845753">v</span><span class="op" id="2845754">.</span><span class="ident" id="2845755">dotdotdot</span>&nbsp;<span class="op" id="2845765">||</span>&nbsp;<span class="builtinfunc" id="2845768">len</span><span class="op" id="2845771">(</span><span class="ident" id="2845772">t</span><span class="op" id="2845773">.</span><span class="ident" id="2845774">in</span><span class="op" id="2845776">)</span>&nbsp;<span class="op" id="2845778">!=</span>&nbsp;<span class="builtinfunc" id="2845781">len</span><span class="op" id="2845784">(</span><span class="ident" id="2845785">v</span><span class="op" id="2845786">.</span><span class="ident" id="2845787">in</span><span class="op" id="2845789">)</span>&nbsp;<span class="op" id="2845791">||</span>&nbsp;<span class="builtinfunc" id="2845794">len</span><span class="op" id="2845797">(</span><span class="ident" id="2845798">t</span><span class="op" id="2845799">.</span><span class="ident" id="2845800">out</span><span class="op" id="2845803">)</span>&nbsp;<span class="op" id="2845805">!=</span>&nbsp;<span class="builtinfunc" id="2845808">len</span><span class="op" id="2845811">(</span><span class="ident" id="2845812">v</span><span class="op" id="2845813">.</span><span class="ident" id="2845814">out</span><span class="op" id="2845817">)</span>&nbsp;<span class="op" id="2845819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845824">return</span>&nbsp;<span class="builtintype" id="2845831">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845843">for</span>&nbsp;<span class="ident" id="2845847">i</span><span class="op" id="2845848">,</span>&nbsp;<span class="ident" id="2845850">typ</span>&nbsp;<span class="op" id="2845854">:=</span>&nbsp;<span class="keyword" id="2845857">range</span>&nbsp;<span class="ident" id="2845863">t</span><span class="op" id="2845864">.</span><span class="ident" id="2845865">in</span>&nbsp;<span class="op" id="2845868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845873">if</span>&nbsp;<span class="ident" id="2845876">typ</span>&nbsp;<span class="op" id="2845880">!=</span>&nbsp;<span class="ident" id="2845883">v</span><span class="op" id="2845884">.</span><span class="ident" id="2845885">in</span><span class="op" id="2845887">[</span><span class="ident" id="2845888">i</span><span class="op" id="2845889">]</span>&nbsp;<span class="op" id="2845891">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845897">return</span>&nbsp;<span class="builtintype" id="2845904">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845921">for</span>&nbsp;<span class="ident" id="2845925">i</span><span class="op" id="2845926">,</span>&nbsp;<span class="ident" id="2845928">typ</span>&nbsp;<span class="op" id="2845932">:=</span>&nbsp;<span class="keyword" id="2845935">range</span>&nbsp;<span class="ident" id="2845941">t</span><span class="op" id="2845942">.</span><span class="ident" id="2845943">out</span>&nbsp;<span class="op" id="2845947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845952">if</span>&nbsp;<span class="ident" id="2845955">typ</span>&nbsp;<span class="op" id="2845959">!=</span>&nbsp;<span class="ident" id="2845962">v</span><span class="op" id="2845963">.</span><span class="ident" id="2845964">out</span><span class="op" id="2845967">[</span><span class="ident" id="2845968">i</span><span class="op" id="2845969">]</span>&nbsp;<span class="op" id="2845971">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2845977">return</span>&nbsp;<span class="builtintype" id="2845984">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2845997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846001">return</span>&nbsp;<span class="builtintype" id="2846008">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846015">case</span>&nbsp;<span class="ident" id="2846020">Interface</span><span class="op" id="2846029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846033">t</span>&nbsp;<span class="op" id="2846035">:=</span>&nbsp;<span class="op" id="2846038">(</span><span class="op" id="2846039">*</span><span class="ident" id="2846040">interfaceType</span><span class="op" id="2846053">)</span><span class="op" id="2846054">(</span><span class="ident" id="2846055">unsafe</span><span class="op" id="2846061">.</span><span class="ident" id="2846062">Pointer</span><span class="op" id="2846069">(</span><span class="ident" id="2846070">T</span><span class="op" id="2846071">)</span><span class="op" id="2846072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846076">v</span>&nbsp;<span class="op" id="2846078">:=</span>&nbsp;<span class="op" id="2846081">(</span><span class="op" id="2846082">*</span><span class="ident" id="2846083">interfaceType</span><span class="op" id="2846096">)</span><span class="op" id="2846097">(</span><span class="ident" id="2846098">unsafe</span><span class="op" id="2846104">.</span><span class="ident" id="2846105">Pointer</span><span class="op" id="2846112">(</span><span class="ident" id="2846113">V</span><span class="op" id="2846114">)</span><span class="op" id="2846115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846119">if</span>&nbsp;<span class="builtinfunc" id="2846122">len</span><span class="op" id="2846125">(</span><span class="ident" id="2846126">t</span><span class="op" id="2846127">.</span><span class="ident" id="2846128">methods</span><span class="op" id="2846135">)</span>&nbsp;<span class="op" id="2846137">==</span>&nbsp;<span class="num" id="2846140">0</span>&nbsp;<span class="op" id="2846142">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2846145">len</span><span class="op" id="2846148">(</span><span class="ident" id="2846149">v</span><span class="op" id="2846150">.</span><span class="ident" id="2846151">methods</span><span class="op" id="2846158">)</span>&nbsp;<span class="op" id="2846160">==</span>&nbsp;<span class="num" id="2846163">0</span>&nbsp;<span class="op" id="2846165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846170">return</span>&nbsp;<span class="builtintype" id="2846177">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2846188">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2846231">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846264">return</span>&nbsp;<span class="builtintype" id="2846271">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846279">case</span>&nbsp;<span class="ident" id="2846284">Map</span><span class="op" id="2846287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846291">return</span>&nbsp;<span class="ident" id="2846298">T</span><span class="op" id="2846299">.</span><span class="ident" id="2846300">Key</span><span class="op" id="2846303">(</span><span class="op" id="2846304">)</span>&nbsp;<span class="op" id="2846306">==</span>&nbsp;<span class="ident" id="2846309">V</span><span class="op" id="2846310">.</span><span class="ident" id="2846311">Key</span><span class="op" id="2846314">(</span><span class="op" id="2846315">)</span>&nbsp;<span class="op" id="2846317">&amp;&amp;</span>&nbsp;<span class="ident" id="2846320">T</span><span class="op" id="2846321">.</span><span class="ident" id="2846322">Elem</span><span class="op" id="2846326">(</span><span class="op" id="2846327">)</span>&nbsp;<span class="op" id="2846329">==</span>&nbsp;<span class="ident" id="2846332">V</span><span class="op" id="2846333">.</span><span class="ident" id="2846334">Elem</span><span class="op" id="2846338">(</span><span class="op" id="2846339">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846343">case</span>&nbsp;<span class="ident" id="2846348">Ptr</span><span class="op" id="2846351">,</span>&nbsp;<span class="ident" id="2846353">Slice</span><span class="op" id="2846358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846362">return</span>&nbsp;<span class="ident" id="2846369">T</span><span class="op" id="2846370">.</span><span class="ident" id="2846371">Elem</span><span class="op" id="2846375">(</span><span class="op" id="2846376">)</span>&nbsp;<span class="op" id="2846378">==</span>&nbsp;<span class="ident" id="2846381">V</span><span class="op" id="2846382">.</span><span class="ident" id="2846383">Elem</span><span class="op" id="2846387">(</span><span class="op" id="2846388">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846392">case</span>&nbsp;<span class="ident" id="2846397">Struct</span><span class="op" id="2846403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846407">t</span>&nbsp;<span class="op" id="2846409">:=</span>&nbsp;<span class="op" id="2846412">(</span><span class="op" id="2846413">*</span><span class="ident" id="2846414">structType</span><span class="op" id="2846424">)</span><span class="op" id="2846425">(</span><span class="ident" id="2846426">unsafe</span><span class="op" id="2846432">.</span><span class="ident" id="2846433">Pointer</span><span class="op" id="2846440">(</span><span class="ident" id="2846441">T</span><span class="op" id="2846442">)</span><span class="op" id="2846443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846447">v</span>&nbsp;<span class="op" id="2846449">:=</span>&nbsp;<span class="op" id="2846452">(</span><span class="op" id="2846453">*</span><span class="ident" id="2846454">structType</span><span class="op" id="2846464">)</span><span class="op" id="2846465">(</span><span class="ident" id="2846466">unsafe</span><span class="op" id="2846472">.</span><span class="ident" id="2846473">Pointer</span><span class="op" id="2846480">(</span><span class="ident" id="2846481">V</span><span class="op" id="2846482">)</span><span class="op" id="2846483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846487">if</span>&nbsp;<span class="builtinfunc" id="2846490">len</span><span class="op" id="2846493">(</span><span class="ident" id="2846494">t</span><span class="op" id="2846495">.</span><span class="ident" id="2846496">fields</span><span class="op" id="2846502">)</span>&nbsp;<span class="op" id="2846504">!=</span>&nbsp;<span class="builtinfunc" id="2846507">len</span><span class="op" id="2846510">(</span><span class="ident" id="2846511">v</span><span class="op" id="2846512">.</span><span class="ident" id="2846513">fields</span><span class="op" id="2846519">)</span>&nbsp;<span class="op" id="2846521">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846526">return</span>&nbsp;<span class="builtintype" id="2846533">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846545">for</span>&nbsp;<span class="ident" id="2846549">i</span>&nbsp;<span class="op" id="2846551">:=</span>&nbsp;<span class="keyword" id="2846554">range</span>&nbsp;<span class="ident" id="2846560">t</span><span class="op" id="2846561">.</span><span class="ident" id="2846562">fields</span>&nbsp;<span class="op" id="2846569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846574">tf</span>&nbsp;<span class="op" id="2846577">:=</span>&nbsp;<span class="op" id="2846580">&amp;</span><span class="ident" id="2846581">t</span><span class="op" id="2846582">.</span><span class="ident" id="2846583">fields</span><span class="op" id="2846589">[</span><span class="ident" id="2846590">i</span><span class="op" id="2846591">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2846596">vf</span>&nbsp;<span class="op" id="2846599">:=</span>&nbsp;<span class="op" id="2846602">&amp;</span><span class="ident" id="2846603">v</span><span class="op" id="2846604">.</span><span class="ident" id="2846605">fields</span><span class="op" id="2846611">[</span><span class="ident" id="2846612">i</span><span class="op" id="2846613">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846618">if</span>&nbsp;<span class="ident" id="2846621">tf</span><span class="op" id="2846623">.</span><span class="ident" id="2846624">name</span>&nbsp;<span class="op" id="2846629">!=</span>&nbsp;<span class="ident" id="2846632">vf</span><span class="op" id="2846634">.</span><span class="ident" id="2846635">name</span>&nbsp;<span class="op" id="2846640">&amp;&amp;</span>&nbsp;<span class="op" id="2846643">(</span><span class="ident" id="2846644">tf</span><span class="op" id="2846646">.</span><span class="ident" id="2846647">name</span>&nbsp;<span class="op" id="2846652">==</span>&nbsp;<span class="ident" id="2846655">nil</span>&nbsp;<span class="op" id="2846659">||</span>&nbsp;<span class="ident" id="2846662">vf</span><span class="op" id="2846664">.</span><span class="ident" id="2846665">name</span>&nbsp;<span class="op" id="2846670">==</span>&nbsp;<span class="ident" id="2846673">nil</span>&nbsp;<span class="op" id="2846677">||</span>&nbsp;<span class="op" id="2846680">*</span><span class="ident" id="2846681">tf</span><span class="op" id="2846683">.</span><span class="ident" id="2846684">name</span>&nbsp;<span class="op" id="2846689">!=</span>&nbsp;<span class="op" id="2846692">*</span><span class="ident" id="2846693">vf</span><span class="op" id="2846695">.</span><span class="ident" id="2846696">name</span><span class="op" id="2846700">)</span>&nbsp;<span class="op" id="2846702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846708">return</span>&nbsp;<span class="builtintype" id="2846715">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846729">if</span>&nbsp;<span class="ident" id="2846732">tf</span><span class="op" id="2846734">.</span><span class="ident" id="2846735">pkgPath</span>&nbsp;<span class="op" id="2846743">!=</span>&nbsp;<span class="ident" id="2846746">vf</span><span class="op" id="2846748">.</span><span class="ident" id="2846749">pkgPath</span>&nbsp;<span class="op" id="2846757">&amp;&amp;</span>&nbsp;<span class="op" id="2846760">(</span><span class="ident" id="2846761">tf</span><span class="op" id="2846763">.</span><span class="ident" id="2846764">pkgPath</span>&nbsp;<span class="op" id="2846772">==</span>&nbsp;<span class="ident" id="2846775">nil</span>&nbsp;<span class="op" id="2846779">||</span>&nbsp;<span class="ident" id="2846782">vf</span><span class="op" id="2846784">.</span><span class="ident" id="2846785">pkgPath</span>&nbsp;<span class="op" id="2846793">==</span>&nbsp;<span class="ident" id="2846796">nil</span>&nbsp;<span class="op" id="2846800">||</span>&nbsp;<span class="op" id="2846803">*</span><span class="ident" id="2846804">tf</span><span class="op" id="2846806">.</span><span class="ident" id="2846807">pkgPath</span>&nbsp;<span class="op" id="2846815">!=</span>&nbsp;<span class="op" id="2846818">*</span><span class="ident" id="2846819">vf</span><span class="op" id="2846821">.</span><span class="ident" id="2846822">pkgPath</span><span class="op" id="2846829">)</span>&nbsp;<span class="op" id="2846831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846837">return</span>&nbsp;<span class="builtintype" id="2846844">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846858">if</span>&nbsp;<span class="ident" id="2846861">tf</span><span class="op" id="2846863">.</span><span class="ident" id="2846864">typ</span>&nbsp;<span class="op" id="2846868">!=</span>&nbsp;<span class="ident" id="2846871">vf</span><span class="op" id="2846873">.</span><span class="ident" id="2846874">typ</span>&nbsp;<span class="op" id="2846878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846884">return</span>&nbsp;<span class="builtintype" id="2846891">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2846900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846905">if</span>&nbsp;<span class="ident" id="2846908">tf</span><span class="op" id="2846910">.</span><span class="ident" id="2846911">tag</span>&nbsp;<span class="op" id="2846915">!=</span>&nbsp;<span class="ident" id="2846918">vf</span><span class="op" id="2846920">.</span><span class="ident" id="2846921">tag</span>&nbsp;<span class="op" id="2846925">&amp;&amp;</span>&nbsp;<span class="op" id="2846928">(</span><span class="ident" id="2846929">tf</span><span class="op" id="2846931">.</span><span class="ident" id="2846932">tag</span>&nbsp;<span class="op" id="2846936">==</span>&nbsp;<span class="ident" id="2846939">nil</span>&nbsp;<span class="op" id="2846943">||</span>&nbsp;<span class="ident" id="2846946">vf</span><span class="op" id="2846948">.</span><span class="ident" id="2846949">tag</span>&nbsp;<span class="op" id="2846953">==</span>&nbsp;<span class="ident" id="2846956">nil</span>&nbsp;<span class="op" id="2846960">||</span>&nbsp;<span class="op" id="2846963">*</span><span class="ident" id="2846964">tf</span><span class="op" id="2846966">.</span><span class="ident" id="2846967">tag</span>&nbsp;<span class="op" id="2846971">!=</span>&nbsp;<span class="op" id="2846974">*</span><span class="ident" id="2846975">vf</span><span class="op" id="2846977">.</span><span class="ident" id="2846978">tag</span><span class="op" id="2846981">)</span>&nbsp;<span class="op" id="2846983">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2846989">return</span>&nbsp;<span class="builtintype" id="2846996">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847010">if</span>&nbsp;<span class="ident" id="2847013">tf</span><span class="op" id="2847015">.</span><span class="ident" id="2847016">offset</span>&nbsp;<span class="op" id="2847023">!=</span>&nbsp;<span class="ident" id="2847026">vf</span><span class="op" id="2847028">.</span><span class="ident" id="2847029">offset</span>&nbsp;<span class="op" id="2847036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847042">return</span>&nbsp;<span class="builtintype" id="2847049">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847058">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847066">return</span>&nbsp;<span class="builtintype" id="2847073">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2847079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847083">return</span>&nbsp;<span class="builtintype" id="2847090">false</span><br>
<span class="lineno">1285</span><span class="op" id="2847096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2847099">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2847147">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2847218">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2847279">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2847338">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2847389">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2847442">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2847481">func</span>&nbsp;<span class="ident" id="2847486">typelinks</span><span class="op" id="2847495">(</span><span class="op" id="2847496">)</span>&nbsp;<span class="op" id="2847498">[</span><span class="op" id="2847499">]</span><span class="op" id="2847500">*</span><span class="ident" id="2847501">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2847508">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2847581">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2847617">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2847682">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2847738">func</span>&nbsp;<span class="ident" id="2847743">typesByString</span><span class="op" id="2847756">(</span><span class="ident" id="2847757">s</span>&nbsp;<span class="builtintype" id="2847759">string</span><span class="op" id="2847765">)</span>&nbsp;<span class="op" id="2847767">[</span><span class="op" id="2847768">]</span><span class="op" id="2847769">*</span><span class="ident" id="2847770">rtype</span>&nbsp;<span class="op" id="2847776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847779">typ</span>&nbsp;<span class="op" id="2847783">:=</span>&nbsp;<span class="ident" id="2847786">typelinks</span><span class="op" id="2847795">(</span><span class="op" id="2847796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2847800">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2847872">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847952">i</span><span class="op" id="2847953">,</span>&nbsp;<span class="ident" id="2847955">j</span>&nbsp;<span class="op" id="2847957">:=</span>&nbsp;<span class="num" id="2847960">0</span><span class="op" id="2847961">,</span>&nbsp;<span class="builtinfunc" id="2847963">len</span><span class="op" id="2847966">(</span><span class="ident" id="2847967">typ</span><span class="op" id="2847970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2847973">for</span>&nbsp;<span class="ident" id="2847977">i</span>&nbsp;<span class="op" id="2847979">&lt;</span>&nbsp;<span class="ident" id="2847981">j</span>&nbsp;<span class="op" id="2847983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2847987">h</span>&nbsp;<span class="op" id="2847989">:=</span>&nbsp;<span class="ident" id="2847992">i</span>&nbsp;<span class="op" id="2847994">+</span>&nbsp;<span class="op" id="2847996">(</span><span class="ident" id="2847997">j</span><span class="op" id="2847998">-</span><span class="ident" id="2847999">i</span><span class="op" id="2848000">)</span><span class="op" id="2848001">/</span><span class="num" id="2848002">2</span>&nbsp;<span class="comment" id="2848004">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848041">//&nbsp;i&nbsp;&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848058">if</span>&nbsp;<span class="op" id="2848061">!</span><span class="op" id="2848062">(</span><span class="op" id="2848063">*</span><span class="ident" id="2848064">typ</span><span class="op" id="2848067">[</span><span class="ident" id="2848068">h</span><span class="op" id="2848069">]</span><span class="op" id="2848070">.</span><span class="builtintype" id="2848071">string</span>&nbsp;<span class="op" id="2848078">&gt;=</span>&nbsp;<span class="ident" id="2848081">s</span><span class="op" id="2848082">)</span>&nbsp;<span class="op" id="2848084">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848089">i</span>&nbsp;<span class="op" id="2848091">=</span>&nbsp;<span class="ident" id="2848093">h</span>&nbsp;<span class="op" id="2848095">+</span>&nbsp;<span class="num" id="2848097">1</span>&nbsp;<span class="comment" id="2848099">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848130">}</span>&nbsp;<span class="keyword" id="2848132">else</span>&nbsp;<span class="op" id="2848137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848142">j</span>&nbsp;<span class="op" id="2848144">=</span>&nbsp;<span class="ident" id="2848146">h</span>&nbsp;<span class="comment" id="2848148">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848179">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848182">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848256">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848322">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848386">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848418">j</span>&nbsp;<span class="op" id="2848420">=</span>&nbsp;<span class="ident" id="2848422">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848425">for</span>&nbsp;<span class="ident" id="2848429">j</span>&nbsp;<span class="op" id="2848431">&lt;</span>&nbsp;<span class="builtinfunc" id="2848433">len</span><span class="op" id="2848436">(</span><span class="ident" id="2848437">typ</span><span class="op" id="2848440">)</span>&nbsp;<span class="op" id="2848442">&amp;&amp;</span>&nbsp;<span class="op" id="2848445">*</span><span class="ident" id="2848446">typ</span><span class="op" id="2848449">[</span><span class="ident" id="2848450">j</span><span class="op" id="2848451">]</span><span class="op" id="2848452">.</span><span class="builtintype" id="2848453">string</span>&nbsp;<span class="op" id="2848460">==</span>&nbsp;<span class="ident" id="2848463">s</span>&nbsp;<span class="op" id="2848465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848469">j</span><span class="op" id="2848470">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2848474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2848478">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2848535">return</span>&nbsp;<span class="ident" id="2848542">typ</span><span class="op" id="2848545">[</span><span class="ident" id="2848546">i</span><span class="op" id="2848547">:</span><span class="ident" id="2848548">j</span><span class="op" id="2848549">]</span><br>
<span class="lineno"></span><span class="op" id="2848551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2848554">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2848616">var</span>&nbsp;<span class="ident" id="2848620">lookupCache</span>&nbsp;<span class="keyword" id="2848632">struct</span>&nbsp;<span class="op" id="2848639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848642">sync</span><span class="op" id="2848646">.</span><span class="ident" id="2848647">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848656">m</span>&nbsp;<span class="keyword" id="2848658">map</span><span class="op" id="2848661">[</span><span class="ident" id="2848662">cacheKey</span><span class="op" id="2848670">]</span><span class="op" id="2848671">*</span><span class="ident" id="2848672">rtype</span><br>
<span class="lineno"></span><span class="op" id="2848678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2848681">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2848734">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2848795">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2848852">type</span>&nbsp;<span class="ident" id="2848857">cacheKey</span>&nbsp;<span class="keyword" id="2848866">struct</span>&nbsp;<span class="op" id="2848873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848876">kind</span>&nbsp;&nbsp;<span class="ident" id="2848882">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848888">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848894">*</span><span class="ident" id="2848895">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848902">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2848908">*</span><span class="ident" id="2848909">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2848916">extra</span>&nbsp;<span class="builtintype" id="2848922">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2848930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2848933">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2848998">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2849040">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2849089">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2849152">func</span>&nbsp;<span class="ident" id="2849157">cacheGet</span><span class="op" id="2849165">(</span><span class="ident" id="2849166">k</span>&nbsp;<span class="ident" id="2849168">cacheKey</span><span class="op" id="2849176">)</span>&nbsp;<span class="ident" id="2849178">Type</span>&nbsp;<span class="op" id="2849183">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849186">lookupCache</span><span class="op" id="2849197">.</span><span class="ident" id="2849198">RLock</span><span class="op" id="2849203">(</span><span class="op" id="2849204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849207">t</span>&nbsp;<span class="op" id="2849209">:=</span>&nbsp;<span class="ident" id="2849212">lookupCache</span><span class="op" id="2849223">.</span><span class="ident" id="2849224">m</span><span class="op" id="2849225">[</span><span class="ident" id="2849226">k</span><span class="op" id="2849227">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849230">lookupCache</span><span class="op" id="2849241">.</span><span class="ident" id="2849242">RUnlock</span><span class="op" id="2849249">(</span><span class="op" id="2849250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849253">if</span>&nbsp;<span class="ident" id="2849256">t</span>&nbsp;<span class="op" id="2849258">!=</span>&nbsp;<span class="ident" id="2849261">nil</span>&nbsp;<span class="op" id="2849265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849269">return</span>&nbsp;<span class="ident" id="2849276">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2849279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849283">lookupCache</span><span class="op" id="2849294">.</span><span class="ident" id="2849295">Lock</span><span class="op" id="2849299">(</span><span class="op" id="2849300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849303">t</span>&nbsp;<span class="op" id="2849305">=</span>&nbsp;<span class="ident" id="2849307">lookupCache</span><span class="op" id="2849318">.</span><span class="ident" id="2849319">m</span><span class="op" id="2849320">[</span><span class="ident" id="2849321">k</span><span class="op" id="2849322">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849325">if</span>&nbsp;<span class="ident" id="2849328">t</span>&nbsp;<span class="op" id="2849330">!=</span>&nbsp;<span class="ident" id="2849333">nil</span>&nbsp;<span class="op" id="2849337">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849341">lookupCache</span><span class="op" id="2849352">.</span><span class="ident" id="2849353">Unlock</span><span class="op" id="2849359">(</span><span class="op" id="2849360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849364">return</span>&nbsp;<span class="ident" id="2849371">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2849374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849378">if</span>&nbsp;<span class="ident" id="2849381">lookupCache</span><span class="op" id="2849392">.</span><span class="ident" id="2849393">m</span>&nbsp;<span class="op" id="2849395">==</span>&nbsp;<span class="ident" id="2849398">nil</span>&nbsp;<span class="op" id="2849402">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849406">lookupCache</span><span class="op" id="2849417">.</span><span class="ident" id="2849418">m</span>&nbsp;<span class="op" id="2849420">=</span>&nbsp;<span class="builtinfunc" id="2849422">make</span><span class="op" id="2849426">(</span><span class="keyword" id="2849427">map</span><span class="op" id="2849430">[</span><span class="ident" id="2849431">cacheKey</span><span class="op" id="2849439">]</span><span class="op" id="2849440">*</span><span class="ident" id="2849441">rtype</span><span class="op" id="2849446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2849449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849453">return</span>&nbsp;<span class="ident" id="2849460">nil</span><br>
<span class="lineno"></span><span class="op" id="2849464">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2849467">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2849534">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2849599">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2849633">func</span>&nbsp;<span class="ident" id="2849638">cachePut</span><span class="op" id="2849646">(</span><span class="ident" id="2849647">k</span>&nbsp;<span class="ident" id="2849649">cacheKey</span><span class="op" id="2849657">,</span>&nbsp;<span class="ident" id="2849659">t</span>&nbsp;<span class="op" id="2849661">*</span><span class="ident" id="2849662">rtype</span><span class="op" id="2849667">)</span>&nbsp;<span class="ident" id="2849669">Type</span>&nbsp;<span class="op" id="2849674">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849677">lookupCache</span><span class="op" id="2849688">.</span><span class="ident" id="2849689">m</span><span class="op" id="2849690">[</span><span class="ident" id="2849691">k</span><span class="op" id="2849692">]</span>&nbsp;<span class="op" id="2849694">=</span>&nbsp;<span class="ident" id="2849696">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2849699">lookupCache</span><span class="op" id="2849710">.</span><span class="ident" id="2849711">Unlock</span><span class="op" id="2849717">(</span><span class="op" id="2849718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2849721">return</span>&nbsp;<span class="ident" id="2849728">t</span><br>
<span class="lineno"></span><span class="op" id="2849730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2849733">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2849811">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2849890">//</span><br>
<span class="lineno"></span><span class="comment" id="2849893">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2849962">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2850027">func</span>&nbsp;<span class="ident" id="2850032">ChanOf</span><span class="op" id="2850038">(</span><span class="ident" id="2850039">dir</span>&nbsp;<span class="ident" id="2850043">ChanDir</span><span class="op" id="2850050">,</span>&nbsp;<span class="ident" id="2850052">t</span>&nbsp;<span class="ident" id="2850054">Type</span><span class="op" id="2850058">)</span>&nbsp;<span class="ident" id="2850060">Type</span>&nbsp;<span class="op" id="2850065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850068">typ</span>&nbsp;<span class="op" id="2850072">:=</span>&nbsp;<span class="ident" id="2850075">t</span><span class="op" id="2850076">.</span><span class="op" id="2850077">(</span><span class="op" id="2850078">*</span><span class="ident" id="2850079">rtype</span><span class="op" id="2850084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2850088">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850107">ckey</span>&nbsp;<span class="op" id="2850112">:=</span>&nbsp;<span class="ident" id="2850115">cacheKey</span><span class="op" id="2850123">{</span><span class="ident" id="2850124">Chan</span><span class="op" id="2850128">,</span>&nbsp;<span class="ident" id="2850130">typ</span><span class="op" id="2850133">,</span>&nbsp;<span class="ident" id="2850135">nil</span><span class="op" id="2850138">,</span>&nbsp;<span class="builtintype" id="2850140">uintptr</span><span class="op" id="2850147">(</span><span class="ident" id="2850148">dir</span><span class="op" id="2850151">)</span><span class="op" id="2850152">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850155">if</span>&nbsp;<span class="ident" id="2850158">ch</span>&nbsp;<span class="op" id="2850161">:=</span>&nbsp;<span class="ident" id="2850164">cacheGet</span><span class="op" id="2850172">(</span><span class="ident" id="2850173">ckey</span><span class="op" id="2850177">)</span><span class="op" id="2850178">;</span>&nbsp;<span class="ident" id="2850180">ch</span>&nbsp;<span class="op" id="2850183">!=</span>&nbsp;<span class="ident" id="2850186">nil</span>&nbsp;<span class="op" id="2850190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850194">return</span>&nbsp;<span class="ident" id="2850201">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2850209">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850277">if</span>&nbsp;<span class="ident" id="2850280">typ</span><span class="op" id="2850283">.</span><span class="ident" id="2850284">size</span>&nbsp;<span class="op" id="2850289">&gt;=</span>&nbsp;<span class="num" id="2850292">1</span><span class="op" id="2850293">&lt;&lt;</span><span class="num" id="2850295">16</span>&nbsp;<span class="op" id="2850298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850302">lookupCache</span><span class="op" id="2850313">.</span><span class="ident" id="2850314">Unlock</span><span class="op" id="2850320">(</span><span class="op" id="2850321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2850325">panic</span><span class="op" id="2850330">(</span><span class="string" id="2850331">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2850371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2850378">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2850403">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850450">var</span>&nbsp;<span class="ident" id="2850454">s</span>&nbsp;<span class="builtintype" id="2850456">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850464">switch</span>&nbsp;<span class="ident" id="2850471">dir</span>&nbsp;<span class="op" id="2850475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850478">default</span><span class="op" id="2850485">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850489">lookupCache</span><span class="op" id="2850500">.</span><span class="ident" id="2850501">Unlock</span><span class="op" id="2850507">(</span><span class="op" id="2850508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2850512">panic</span><span class="op" id="2850517">(</span><span class="string" id="2850518">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2850547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850550">case</span>&nbsp;<span class="ident" id="2850555">SendDir</span><span class="op" id="2850562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850566">s</span>&nbsp;<span class="op" id="2850568">=</span>&nbsp;<span class="string" id="2850570">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2850580">+</span>&nbsp;<span class="op" id="2850582">*</span><span class="ident" id="2850583">typ</span><span class="op" id="2850586">.</span><span class="builtintype" id="2850587">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850595">case</span>&nbsp;<span class="ident" id="2850600">RecvDir</span><span class="op" id="2850607">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850611">s</span>&nbsp;<span class="op" id="2850613">=</span>&nbsp;<span class="string" id="2850615">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2850625">+</span>&nbsp;<span class="op" id="2850627">*</span><span class="ident" id="2850628">typ</span><span class="op" id="2850631">.</span><span class="builtintype" id="2850632">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850640">case</span>&nbsp;<span class="ident" id="2850645">BothDir</span><span class="op" id="2850652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850656">s</span>&nbsp;<span class="op" id="2850658">=</span>&nbsp;<span class="string" id="2850660">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2850668">+</span>&nbsp;<span class="op" id="2850670">*</span><span class="ident" id="2850671">typ</span><span class="op" id="2850674">.</span><span class="builtintype" id="2850675">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850686">for</span>&nbsp;<span class="ident" id="2850690">_</span><span class="op" id="2850691">,</span>&nbsp;<span class="ident" id="2850693">tt</span>&nbsp;<span class="op" id="2850696">:=</span>&nbsp;<span class="keyword" id="2850699">range</span>&nbsp;<span class="ident" id="2850705">typesByString</span><span class="op" id="2850718">(</span><span class="ident" id="2850719">s</span><span class="op" id="2850720">)</span>&nbsp;<span class="op" id="2850722">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850726">ch</span>&nbsp;<span class="op" id="2850729">:=</span>&nbsp;<span class="op" id="2850732">(</span><span class="op" id="2850733">*</span><span class="ident" id="2850734">chanType</span><span class="op" id="2850742">)</span><span class="op" id="2850743">(</span><span class="ident" id="2850744">unsafe</span><span class="op" id="2850750">.</span><span class="ident" id="2850751">Pointer</span><span class="op" id="2850758">(</span><span class="ident" id="2850759">tt</span><span class="op" id="2850761">)</span><span class="op" id="2850762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850766">if</span>&nbsp;<span class="ident" id="2850769">ch</span><span class="op" id="2850771">.</span><span class="ident" id="2850772">elem</span>&nbsp;<span class="op" id="2850777">==</span>&nbsp;<span class="ident" id="2850780">typ</span>&nbsp;<span class="op" id="2850784">&amp;&amp;</span>&nbsp;<span class="ident" id="2850787">ch</span><span class="op" id="2850789">.</span><span class="ident" id="2850790">dir</span>&nbsp;<span class="op" id="2850794">==</span>&nbsp;<span class="builtintype" id="2850797">uintptr</span><span class="op" id="2850804">(</span><span class="ident" id="2850805">dir</span><span class="op" id="2850808">)</span>&nbsp;<span class="op" id="2850810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850815">return</span>&nbsp;<span class="ident" id="2850822">cachePut</span><span class="op" id="2850830">(</span><span class="ident" id="2850831">ckey</span><span class="op" id="2850835">,</span>&nbsp;<span class="ident" id="2850837">tt</span><span class="op" id="2850839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2850846">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2850850">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2850875">var</span>&nbsp;<span class="ident" id="2850879">ichan</span>&nbsp;<span class="keyword" id="2850885">interface</span><span class="op" id="2850894">{</span><span class="op" id="2850895">}</span>&nbsp;<span class="op" id="2850897">=</span>&nbsp;<span class="op" id="2850899">(</span><span class="keyword" id="2850900">chan</span>&nbsp;<span class="ident" id="2850905">unsafe</span><span class="op" id="2850911">.</span><span class="ident" id="2850912">Pointer</span><span class="op" id="2850919">)</span><span class="op" id="2850920">(</span><span class="ident" id="2850921">nil</span><span class="op" id="2850924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850927">prototype</span>&nbsp;<span class="op" id="2850937">:=</span>&nbsp;<span class="op" id="2850940">*</span><span class="op" id="2850941">(</span><span class="op" id="2850942">*</span><span class="op" id="2850943">*</span><span class="ident" id="2850944">chanType</span><span class="op" id="2850952">)</span><span class="op" id="2850953">(</span><span class="ident" id="2850954">unsafe</span><span class="op" id="2850960">.</span><span class="ident" id="2850961">Pointer</span><span class="op" id="2850968">(</span><span class="op" id="2850969">&amp;</span><span class="ident" id="2850970">ichan</span><span class="op" id="2850975">)</span><span class="op" id="2850976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2850979">ch</span>&nbsp;<span class="op" id="2850982">:=</span>&nbsp;<span class="builtinfunc" id="2850985">new</span><span class="op" id="2850988">(</span><span class="ident" id="2850989">chanType</span><span class="op" id="2850997">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851000">*</span><span class="ident" id="2851001">ch</span>&nbsp;<span class="op" id="2851004">=</span>&nbsp;<span class="op" id="2851006">*</span><span class="ident" id="2851007">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851018">ch</span><span class="op" id="2851020">.</span><span class="builtintype" id="2851021">string</span>&nbsp;<span class="op" id="2851028">=</span>&nbsp;<span class="op" id="2851030">&amp;</span><span class="ident" id="2851031">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851034">ch</span><span class="op" id="2851036">.</span><span class="ident" id="2851037">hash</span>&nbsp;<span class="op" id="2851042">=</span>&nbsp;<span class="ident" id="2851044">fnv1</span><span class="op" id="2851048">(</span><span class="ident" id="2851049">typ</span><span class="op" id="2851052">.</span><span class="ident" id="2851053">hash</span><span class="op" id="2851057">,</span>&nbsp;<span class="string" id="2851059">&#39;c&#39;</span><span class="op" id="2851062">,</span>&nbsp;<span class="builtintype" id="2851064">byte</span><span class="op" id="2851068">(</span><span class="ident" id="2851069">dir</span><span class="op" id="2851072">)</span><span class="op" id="2851073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851076">ch</span><span class="op" id="2851078">.</span><span class="ident" id="2851079">elem</span>&nbsp;<span class="op" id="2851084">=</span>&nbsp;<span class="ident" id="2851086">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851091">ch</span><span class="op" id="2851093">.</span><span class="ident" id="2851094">uncommonType</span>&nbsp;<span class="op" id="2851107">=</span>&nbsp;<span class="ident" id="2851109">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851114">ch</span><span class="op" id="2851116">.</span><span class="ident" id="2851117">ptrToThis</span>&nbsp;<span class="op" id="2851127">=</span>&nbsp;<span class="ident" id="2851129">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851134">ch</span><span class="op" id="2851136">.</span><span class="ident" id="2851137">zero</span>&nbsp;<span class="op" id="2851142">=</span>&nbsp;<span class="ident" id="2851144">unsafe</span><span class="op" id="2851150">.</span><span class="ident" id="2851151">Pointer</span><span class="op" id="2851158">(</span><span class="op" id="2851159">&amp;</span><span class="builtinfunc" id="2851160">make</span><span class="op" id="2851164">(</span><span class="op" id="2851165">[</span><span class="op" id="2851166">]</span><span class="builtintype" id="2851167">byte</span><span class="op" id="2851171">,</span>&nbsp;<span class="ident" id="2851173">ch</span><span class="op" id="2851175">.</span><span class="ident" id="2851176">size</span><span class="op" id="2851180">)</span><span class="op" id="2851181">[</span><span class="num" id="2851182">0</span><span class="op" id="2851183">]</span><span class="op" id="2851184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851188">return</span>&nbsp;<span class="ident" id="2851195">cachePut</span><span class="op" id="2851203">(</span><span class="ident" id="2851204">ckey</span><span class="op" id="2851208">,</span>&nbsp;<span class="op" id="2851210">&amp;</span><span class="ident" id="2851211">ch</span><span class="op" id="2851213">.</span><span class="ident" id="2851214">rtype</span><span class="op" id="2851219">)</span><br>
<span class="lineno"></span><span class="op" id="2851221">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2851224">func</span>&nbsp;<span class="ident" id="2851229">ismapkey</span><span class="op" id="2851237">(</span><span class="op" id="2851238">*</span><span class="ident" id="2851239">rtype</span><span class="op" id="2851244">)</span>&nbsp;<span class="builtintype" id="2851246">bool</span>&nbsp;<span class="comment" id="2851251">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2851278">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2851346">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2851407">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2851449">//</span><br>
<span class="lineno"></span><span class="comment" id="2851452">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2851520">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2851570">func</span>&nbsp;<span class="ident" id="2851575">MapOf</span><span class="op" id="2851580">(</span><span class="ident" id="2851581">key</span><span class="op" id="2851584">,</span>&nbsp;<span class="ident" id="2851586">elem</span>&nbsp;<span class="ident" id="2851591">Type</span><span class="op" id="2851595">)</span>&nbsp;<span class="ident" id="2851597">Type</span>&nbsp;<span class="op" id="2851602">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851605">ktyp</span>&nbsp;<span class="op" id="2851610">:=</span>&nbsp;<span class="ident" id="2851613">key</span><span class="op" id="2851616">.</span><span class="op" id="2851617">(</span><span class="op" id="2851618">*</span><span class="ident" id="2851619">rtype</span><span class="op" id="2851624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851627">etyp</span>&nbsp;<span class="op" id="2851632">:=</span>&nbsp;<span class="ident" id="2851635">elem</span><span class="op" id="2851639">.</span><span class="op" id="2851640">(</span><span class="op" id="2851641">*</span><span class="ident" id="2851642">rtype</span><span class="op" id="2851647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851651">if</span>&nbsp;<span class="op" id="2851654">!</span><span class="ident" id="2851655">ismapkey</span><span class="op" id="2851663">(</span><span class="ident" id="2851664">ktyp</span><span class="op" id="2851668">)</span>&nbsp;<span class="op" id="2851670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2851674">panic</span><span class="op" id="2851679">(</span><span class="string" id="2851680">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2851715">+</span>&nbsp;<span class="ident" id="2851717">ktyp</span><span class="op" id="2851721">.</span><span class="ident" id="2851722">String</span><span class="op" id="2851728">(</span><span class="op" id="2851729">)</span><span class="op" id="2851730">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851737">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851756">ckey</span>&nbsp;<span class="op" id="2851761">:=</span>&nbsp;<span class="ident" id="2851764">cacheKey</span><span class="op" id="2851772">{</span><span class="ident" id="2851773">Map</span><span class="op" id="2851776">,</span>&nbsp;<span class="ident" id="2851778">ktyp</span><span class="op" id="2851782">,</span>&nbsp;<span class="ident" id="2851784">etyp</span><span class="op" id="2851788">,</span>&nbsp;<span class="num" id="2851790">0</span><span class="op" id="2851791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851794">if</span>&nbsp;<span class="ident" id="2851797">mt</span>&nbsp;<span class="op" id="2851800">:=</span>&nbsp;<span class="ident" id="2851803">cacheGet</span><span class="op" id="2851811">(</span><span class="ident" id="2851812">ckey</span><span class="op" id="2851816">)</span><span class="op" id="2851817">;</span>&nbsp;<span class="ident" id="2851819">mt</span>&nbsp;<span class="op" id="2851822">!=</span>&nbsp;<span class="ident" id="2851825">nil</span>&nbsp;<span class="op" id="2851829">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851833">return</span>&nbsp;<span class="ident" id="2851840">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2851844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2851848">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851873">s</span>&nbsp;<span class="op" id="2851875">:=</span>&nbsp;<span class="string" id="2851878">&#34;map[&#34;</span>&nbsp;<span class="op" id="2851885">+</span>&nbsp;<span class="op" id="2851887">*</span><span class="ident" id="2851888">ktyp</span><span class="op" id="2851892">.</span><span class="builtintype" id="2851893">string</span>&nbsp;<span class="op" id="2851900">+</span>&nbsp;<span class="string" id="2851902">&#34;]&#34;</span>&nbsp;<span class="op" id="2851906">+</span>&nbsp;<span class="op" id="2851908">*</span><span class="ident" id="2851909">etyp</span><span class="op" id="2851913">.</span><span class="builtintype" id="2851914">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2851922">for</span>&nbsp;<span class="ident" id="2851926">_</span><span class="op" id="2851927">,</span>&nbsp;<span class="ident" id="2851929">tt</span>&nbsp;<span class="op" id="2851932">:=</span>&nbsp;<span class="keyword" id="2851935">range</span>&nbsp;<span class="ident" id="2851941">typesByString</span><span class="op" id="2851954">(</span><span class="ident" id="2851955">s</span><span class="op" id="2851956">)</span>&nbsp;<span class="op" id="2851958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2851962">mt</span>&nbsp;<span class="op" id="2851965">:=</span>&nbsp;<span class="op" id="2851968">(</span><span class="op" id="2851969">*</span><span class="ident" id="2851970">mapType</span><span class="op" id="2851977">)</span><span class="op" id="2851978">(</span><span class="ident" id="2851979">unsafe</span><span class="op" id="2851985">.</span><span class="ident" id="2851986">Pointer</span><span class="op" id="2851993">(</span><span class="ident" id="2851994">tt</span><span class="op" id="2851996">)</span><span class="op" id="2851997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852001">if</span>&nbsp;<span class="ident" id="2852004">mt</span><span class="op" id="2852006">.</span><span class="ident" id="2852007">key</span>&nbsp;<span class="op" id="2852011">==</span>&nbsp;<span class="ident" id="2852014">ktyp</span>&nbsp;<span class="op" id="2852019">&amp;&amp;</span>&nbsp;<span class="ident" id="2852022">mt</span><span class="op" id="2852024">.</span><span class="ident" id="2852025">elem</span>&nbsp;<span class="op" id="2852030">==</span>&nbsp;<span class="ident" id="2852033">etyp</span>&nbsp;<span class="op" id="2852038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852043">return</span>&nbsp;<span class="ident" id="2852050">cachePut</span><span class="op" id="2852058">(</span><span class="ident" id="2852059">ckey</span><span class="op" id="2852063">,</span>&nbsp;<span class="ident" id="2852065">tt</span><span class="op" id="2852067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852071">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2852078">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852099">var</span>&nbsp;<span class="ident" id="2852103">imap</span>&nbsp;<span class="keyword" id="2852108">interface</span><span class="op" id="2852117">{</span><span class="op" id="2852118">}</span>&nbsp;<span class="op" id="2852120">=</span>&nbsp;<span class="op" id="2852122">(</span><span class="keyword" id="2852123">map</span><span class="op" id="2852126">[</span><span class="ident" id="2852127">unsafe</span><span class="op" id="2852133">.</span><span class="ident" id="2852134">Pointer</span><span class="op" id="2852141">]</span><span class="ident" id="2852142">unsafe</span><span class="op" id="2852148">.</span><span class="ident" id="2852149">Pointer</span><span class="op" id="2852156">)</span><span class="op" id="2852157">(</span><span class="ident" id="2852158">nil</span><span class="op" id="2852161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852164">prototype</span>&nbsp;<span class="op" id="2852174">:=</span>&nbsp;<span class="op" id="2852177">*</span><span class="op" id="2852178">(</span><span class="op" id="2852179">*</span><span class="op" id="2852180">*</span><span class="ident" id="2852181">mapType</span><span class="op" id="2852188">)</span><span class="op" id="2852189">(</span><span class="ident" id="2852190">unsafe</span><span class="op" id="2852196">.</span><span class="ident" id="2852197">Pointer</span><span class="op" id="2852204">(</span><span class="op" id="2852205">&amp;</span><span class="ident" id="2852206">imap</span><span class="op" id="2852210">)</span><span class="op" id="2852211">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852214">mt</span>&nbsp;<span class="op" id="2852217">:=</span>&nbsp;<span class="builtinfunc" id="2852220">new</span><span class="op" id="2852223">(</span><span class="ident" id="2852224">mapType</span><span class="op" id="2852231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852234">*</span><span class="ident" id="2852235">mt</span>&nbsp;<span class="op" id="2852238">=</span>&nbsp;<span class="op" id="2852240">*</span><span class="ident" id="2852241">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852252">mt</span><span class="op" id="2852254">.</span><span class="builtintype" id="2852255">string</span>&nbsp;<span class="op" id="2852262">=</span>&nbsp;<span class="op" id="2852264">&amp;</span><span class="ident" id="2852265">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852268">mt</span><span class="op" id="2852270">.</span><span class="ident" id="2852271">hash</span>&nbsp;<span class="op" id="2852276">=</span>&nbsp;<span class="ident" id="2852278">fnv1</span><span class="op" id="2852282">(</span><span class="ident" id="2852283">etyp</span><span class="op" id="2852287">.</span><span class="ident" id="2852288">hash</span><span class="op" id="2852292">,</span>&nbsp;<span class="string" id="2852294">&#39;m&#39;</span><span class="op" id="2852297">,</span>&nbsp;<span class="builtintype" id="2852299">byte</span><span class="op" id="2852303">(</span><span class="ident" id="2852304">ktyp</span><span class="op" id="2852308">.</span><span class="ident" id="2852309">hash</span><span class="op" id="2852313">&gt;&gt;</span><span class="num" id="2852315">24</span><span class="op" id="2852317">)</span><span class="op" id="2852318">,</span>&nbsp;<span class="builtintype" id="2852320">byte</span><span class="op" id="2852324">(</span><span class="ident" id="2852325">ktyp</span><span class="op" id="2852329">.</span><span class="ident" id="2852330">hash</span><span class="op" id="2852334">&gt;&gt;</span><span class="num" id="2852336">16</span><span class="op" id="2852338">)</span><span class="op" id="2852339">,</span>&nbsp;<span class="builtintype" id="2852341">byte</span><span class="op" id="2852345">(</span><span class="ident" id="2852346">ktyp</span><span class="op" id="2852350">.</span><span class="ident" id="2852351">hash</span><span class="op" id="2852355">&gt;&gt;</span><span class="num" id="2852357">8</span><span class="op" id="2852358">)</span><span class="op" id="2852359">,</span>&nbsp;<span class="builtintype" id="2852361">byte</span><span class="op" id="2852365">(</span><span class="ident" id="2852366">ktyp</span><span class="op" id="2852370">.</span><span class="ident" id="2852371">hash</span><span class="op" id="2852375">)</span><span class="op" id="2852376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852379">mt</span><span class="op" id="2852381">.</span><span class="ident" id="2852382">key</span>&nbsp;<span class="op" id="2852386">=</span>&nbsp;<span class="ident" id="2852388">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852394">mt</span><span class="op" id="2852396">.</span><span class="ident" id="2852397">elem</span>&nbsp;<span class="op" id="2852402">=</span>&nbsp;<span class="ident" id="2852404">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852410">mt</span><span class="op" id="2852412">.</span><span class="ident" id="2852413">bucket</span>&nbsp;<span class="op" id="2852420">=</span>&nbsp;<span class="ident" id="2852422">bucketOf</span><span class="op" id="2852430">(</span><span class="ident" id="2852431">ktyp</span><span class="op" id="2852435">,</span>&nbsp;<span class="ident" id="2852437">etyp</span><span class="op" id="2852441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852444">if</span>&nbsp;<span class="ident" id="2852447">ktyp</span><span class="op" id="2852451">.</span><span class="ident" id="2852452">size</span>&nbsp;<span class="op" id="2852457">&gt;</span>&nbsp;<span class="ident" id="2852459">maxKeySize</span>&nbsp;<span class="op" id="2852470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852474">mt</span><span class="op" id="2852476">.</span><span class="ident" id="2852477">keysize</span>&nbsp;<span class="op" id="2852485">=</span>&nbsp;<span class="builtintype" id="2852487">uint8</span><span class="op" id="2852492">(</span><span class="ident" id="2852493">ptrSize</span><span class="op" id="2852500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852504">mt</span><span class="op" id="2852506">.</span><span class="ident" id="2852507">indirectkey</span>&nbsp;<span class="op" id="2852519">=</span>&nbsp;<span class="num" id="2852521">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852524">}</span>&nbsp;<span class="keyword" id="2852526">else</span>&nbsp;<span class="op" id="2852531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852535">mt</span><span class="op" id="2852537">.</span><span class="ident" id="2852538">keysize</span>&nbsp;<span class="op" id="2852546">=</span>&nbsp;<span class="builtintype" id="2852548">uint8</span><span class="op" id="2852553">(</span><span class="ident" id="2852554">ktyp</span><span class="op" id="2852558">.</span><span class="ident" id="2852559">size</span><span class="op" id="2852563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852567">mt</span><span class="op" id="2852569">.</span><span class="ident" id="2852570">indirectkey</span>&nbsp;<span class="op" id="2852582">=</span>&nbsp;<span class="num" id="2852584">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852590">if</span>&nbsp;<span class="ident" id="2852593">etyp</span><span class="op" id="2852597">.</span><span class="ident" id="2852598">size</span>&nbsp;<span class="op" id="2852603">&gt;</span>&nbsp;<span class="ident" id="2852605">maxValSize</span>&nbsp;<span class="op" id="2852616">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852620">mt</span><span class="op" id="2852622">.</span><span class="ident" id="2852623">valuesize</span>&nbsp;<span class="op" id="2852633">=</span>&nbsp;<span class="builtintype" id="2852635">uint8</span><span class="op" id="2852640">(</span><span class="ident" id="2852641">ptrSize</span><span class="op" id="2852648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852652">mt</span><span class="op" id="2852654">.</span><span class="ident" id="2852655">indirectvalue</span>&nbsp;<span class="op" id="2852669">=</span>&nbsp;<span class="num" id="2852671">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852674">}</span>&nbsp;<span class="keyword" id="2852676">else</span>&nbsp;<span class="op" id="2852681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852685">mt</span><span class="op" id="2852687">.</span><span class="ident" id="2852688">valuesize</span>&nbsp;<span class="op" id="2852698">=</span>&nbsp;<span class="builtintype" id="2852700">uint8</span><span class="op" id="2852705">(</span><span class="ident" id="2852706">etyp</span><span class="op" id="2852710">.</span><span class="ident" id="2852711">size</span><span class="op" id="2852715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852719">mt</span><span class="op" id="2852721">.</span><span class="ident" id="2852722">indirectvalue</span>&nbsp;<span class="op" id="2852736">=</span>&nbsp;<span class="num" id="2852738">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2852741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852744">mt</span><span class="op" id="2852746">.</span><span class="ident" id="2852747">bucketsize</span>&nbsp;<span class="op" id="2852758">=</span>&nbsp;<span class="builtintype" id="2852760">uint16</span><span class="op" id="2852766">(</span><span class="ident" id="2852767">mt</span><span class="op" id="2852769">.</span><span class="ident" id="2852770">bucket</span><span class="op" id="2852776">.</span><span class="ident" id="2852777">size</span><span class="op" id="2852781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852784">mt</span><span class="op" id="2852786">.</span><span class="ident" id="2852787">uncommonType</span>&nbsp;<span class="op" id="2852800">=</span>&nbsp;<span class="ident" id="2852802">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852807">mt</span><span class="op" id="2852809">.</span><span class="ident" id="2852810">ptrToThis</span>&nbsp;<span class="op" id="2852820">=</span>&nbsp;<span class="ident" id="2852822">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2852827">mt</span><span class="op" id="2852829">.</span><span class="ident" id="2852830">zero</span>&nbsp;<span class="op" id="2852835">=</span>&nbsp;<span class="ident" id="2852837">unsafe</span><span class="op" id="2852843">.</span><span class="ident" id="2852844">Pointer</span><span class="op" id="2852851">(</span><span class="op" id="2852852">&amp;</span><span class="builtinfunc" id="2852853">make</span><span class="op" id="2852857">(</span><span class="op" id="2852858">[</span><span class="op" id="2852859">]</span><span class="builtintype" id="2852860">byte</span><span class="op" id="2852864">,</span>&nbsp;<span class="ident" id="2852866">mt</span><span class="op" id="2852868">.</span><span class="ident" id="2852869">size</span><span class="op" id="2852873">)</span><span class="op" id="2852874">[</span><span class="num" id="2852875">0</span><span class="op" id="2852876">]</span><span class="op" id="2852877">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2852881">return</span>&nbsp;<span class="ident" id="2852888">cachePut</span><span class="op" id="2852896">(</span><span class="ident" id="2852897">ckey</span><span class="op" id="2852901">,</span>&nbsp;<span class="op" id="2852903">&amp;</span><span class="ident" id="2852904">mt</span><span class="op" id="2852906">.</span><span class="ident" id="2852907">rtype</span><span class="op" id="2852912">)</span><br>
<span class="lineno"></span><span class="op" id="2852914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2852917">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2852981">type</span>&nbsp;<span class="ident" id="2852986">gcProg</span>&nbsp;<span class="keyword" id="2852993">struct</span>&nbsp;<span class="op" id="2853000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853003">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2853008">[</span><span class="op" id="2853009">]</span><span class="builtintype" id="2853010">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853016">size</span>&nbsp;<span class="builtintype" id="2853021">uintptr</span>&nbsp;<span class="comment" id="2853029">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2853054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2853057">func</span>&nbsp;<span class="op" id="2853062">(</span><span class="ident" id="2853063">gc</span>&nbsp;<span class="op" id="2853066">*</span><span class="ident" id="2853067">gcProg</span><span class="op" id="2853073">)</span>&nbsp;<span class="builtinfunc" id="2853075">append</span><span class="op" id="2853081">(</span><span class="ident" id="2853082">v</span>&nbsp;<span class="builtintype" id="2853084">byte</span><span class="op" id="2853088">)</span>&nbsp;<span class="op" id="2853090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853093">gc</span><span class="op" id="2853095">.</span><span class="ident" id="2853096">align</span><span class="op" id="2853101">(</span><span class="ident" id="2853102">unsafe</span><span class="op" id="2853108">.</span><span class="ident" id="2853109">Sizeof</span><span class="op" id="2853115">(</span><span class="builtintype" id="2853116">uintptr</span><span class="op" id="2853123">(</span><span class="num" id="2853124">0</span><span class="op" id="2853125">)</span><span class="op" id="2853126">)</span><span class="op" id="2853127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853130">gc</span><span class="op" id="2853132">.</span><span class="ident" id="2853133">appendWord</span><span class="op" id="2853143">(</span><span class="ident" id="2853144">v</span><span class="op" id="2853145">)</span><br>
<span class="lineno"></span><span class="op" id="2853147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2853150">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2853199">func</span>&nbsp;<span class="op" id="2853204">(</span><span class="ident" id="2853205">gc</span>&nbsp;<span class="op" id="2853208">*</span><span class="ident" id="2853209">gcProg</span><span class="op" id="2853215">)</span>&nbsp;<span class="ident" id="2853217">appendProg</span><span class="op" id="2853227">(</span><span class="ident" id="2853228">t</span>&nbsp;<span class="op" id="2853230">*</span><span class="ident" id="2853231">rtype</span><span class="op" id="2853236">)</span>&nbsp;<span class="op" id="2853238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853241">gc</span><span class="op" id="2853243">.</span><span class="ident" id="2853244">align</span><span class="op" id="2853249">(</span><span class="builtintype" id="2853250">uintptr</span><span class="op" id="2853257">(</span><span class="ident" id="2853258">t</span><span class="op" id="2853259">.</span><span class="ident" id="2853260">align</span><span class="op" id="2853265">)</span><span class="op" id="2853266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853269">if</span>&nbsp;<span class="op" id="2853272">!</span><span class="ident" id="2853273">t</span><span class="op" id="2853274">.</span><span class="ident" id="2853275">pointers</span><span class="op" id="2853283">(</span><span class="op" id="2853284">)</span>&nbsp;<span class="op" id="2853286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853290">gc</span><span class="op" id="2853292">.</span><span class="ident" id="2853293">size</span>&nbsp;<span class="op" id="2853298">+=</span>&nbsp;<span class="ident" id="2853301">t</span><span class="op" id="2853302">.</span><span class="ident" id="2853303">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853310">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853321">switch</span>&nbsp;<span class="ident" id="2853328">t</span><span class="op" id="2853329">.</span><span class="ident" id="2853330">Kind</span><span class="op" id="2853334">(</span><span class="op" id="2853335">)</span>&nbsp;<span class="op" id="2853337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853340">default</span><span class="op" id="2853347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2853351">panic</span><span class="op" id="2853356">(</span><span class="string" id="2853357">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2853410">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853413">case</span>&nbsp;<span class="ident" id="2853418">Ptr</span><span class="op" id="2853421">,</span>&nbsp;<span class="ident" id="2853423">UnsafePointer</span><span class="op" id="2853436">,</span>&nbsp;<span class="ident" id="2853438">Chan</span><span class="op" id="2853442">,</span>&nbsp;<span class="ident" id="2853444">Func</span><span class="op" id="2853448">,</span>&nbsp;<span class="ident" id="2853450">Map</span><span class="op" id="2853453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853457">gc</span><span class="op" id="2853459">.</span><span class="ident" id="2853460">appendWord</span><span class="op" id="2853470">(</span><span class="ident" id="2853471">bitsPointer</span><span class="op" id="2853482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853485">case</span>&nbsp;<span class="ident" id="2853490">Slice</span><span class="op" id="2853495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853499">gc</span><span class="op" id="2853501">.</span><span class="ident" id="2853502">appendWord</span><span class="op" id="2853512">(</span><span class="ident" id="2853513">bitsPointer</span><span class="op" id="2853524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853528">gc</span><span class="op" id="2853530">.</span><span class="ident" id="2853531">appendWord</span><span class="op" id="2853541">(</span><span class="ident" id="2853542">bitsScalar</span><span class="op" id="2853552">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853556">gc</span><span class="op" id="2853558">.</span><span class="ident" id="2853559">appendWord</span><span class="op" id="2853569">(</span><span class="ident" id="2853570">bitsScalar</span><span class="op" id="2853580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853583">case</span>&nbsp;<span class="ident" id="2853588">String</span><span class="op" id="2853594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853598">gc</span><span class="op" id="2853600">.</span><span class="ident" id="2853601">appendWord</span><span class="op" id="2853611">(</span><span class="ident" id="2853612">bitsPointer</span><span class="op" id="2853623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853627">gc</span><span class="op" id="2853629">.</span><span class="ident" id="2853630">appendWord</span><span class="op" id="2853640">(</span><span class="ident" id="2853641">bitsScalar</span><span class="op" id="2853651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853654">case</span>&nbsp;<span class="ident" id="2853659">Array</span><span class="op" id="2853664">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853668">c</span>&nbsp;<span class="op" id="2853670">:=</span>&nbsp;<span class="ident" id="2853673">t</span><span class="op" id="2853674">.</span><span class="ident" id="2853675">Len</span><span class="op" id="2853678">(</span><span class="op" id="2853679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853683">e</span>&nbsp;<span class="op" id="2853685">:=</span>&nbsp;<span class="ident" id="2853688">t</span><span class="op" id="2853689">.</span><span class="ident" id="2853690">Elem</span><span class="op" id="2853694">(</span><span class="op" id="2853695">)</span><span class="op" id="2853696">.</span><span class="ident" id="2853697">common</span><span class="op" id="2853703">(</span><span class="op" id="2853704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853708">for</span>&nbsp;<span class="ident" id="2853712">i</span>&nbsp;<span class="op" id="2853714">:=</span>&nbsp;<span class="num" id="2853717">0</span><span class="op" id="2853718">;</span>&nbsp;<span class="ident" id="2853720">i</span>&nbsp;<span class="op" id="2853722">&lt;</span>&nbsp;<span class="ident" id="2853724">c</span><span class="op" id="2853725">;</span>&nbsp;<span class="ident" id="2853727">i</span><span class="op" id="2853728">++</span>&nbsp;<span class="op" id="2853731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853736">gc</span><span class="op" id="2853738">.</span><span class="ident" id="2853739">appendProg</span><span class="op" id="2853749">(</span><span class="ident" id="2853750">e</span><span class="op" id="2853751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853755">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853758">case</span>&nbsp;<span class="ident" id="2853763">Interface</span><span class="op" id="2853772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853776">gc</span><span class="op" id="2853778">.</span><span class="ident" id="2853779">appendWord</span><span class="op" id="2853789">(</span><span class="ident" id="2853790">bitsMultiWord</span><span class="op" id="2853803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853807">if</span>&nbsp;<span class="ident" id="2853810">t</span><span class="op" id="2853811">.</span><span class="ident" id="2853812">NumMethod</span><span class="op" id="2853821">(</span><span class="op" id="2853822">)</span>&nbsp;<span class="op" id="2853824">==</span>&nbsp;<span class="num" id="2853827">0</span>&nbsp;<span class="op" id="2853829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853834">gc</span><span class="op" id="2853836">.</span><span class="ident" id="2853837">appendWord</span><span class="op" id="2853847">(</span><span class="ident" id="2853848">bitsEface</span><span class="op" id="2853857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853861">}</span>&nbsp;<span class="keyword" id="2853863">else</span>&nbsp;<span class="op" id="2853868">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853873">gc</span><span class="op" id="2853875">.</span><span class="ident" id="2853876">appendWord</span><span class="op" id="2853886">(</span><span class="ident" id="2853887">bitsIface</span><span class="op" id="2853896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2853900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853903">case</span>&nbsp;<span class="ident" id="2853908">Struct</span><span class="op" id="2853914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853918">c</span>&nbsp;<span class="op" id="2853920">:=</span>&nbsp;<span class="ident" id="2853923">t</span><span class="op" id="2853924">.</span><span class="ident" id="2853925">NumField</span><span class="op" id="2853933">(</span><span class="op" id="2853934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2853938">for</span>&nbsp;<span class="ident" id="2853942">i</span>&nbsp;<span class="op" id="2853944">:=</span>&nbsp;<span class="num" id="2853947">0</span><span class="op" id="2853948">;</span>&nbsp;<span class="ident" id="2853950">i</span>&nbsp;<span class="op" id="2853952">&lt;</span>&nbsp;<span class="ident" id="2853954">c</span><span class="op" id="2853955">;</span>&nbsp;<span class="ident" id="2853957">i</span><span class="op" id="2853958">++</span>&nbsp;<span class="op" id="2853961">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2853966">gc</span><span class="op" id="2853968">.</span><span class="ident" id="2853969">appendProg</span><span class="op" id="2853979">(</span><span class="ident" id="2853980">t</span><span class="op" id="2853981">.</span><span class="ident" id="2853982">Field</span><span class="op" id="2853987">(</span><span class="ident" id="2853988">i</span><span class="op" id="2853989">)</span><span class="op" id="2853990">.</span><span class="ident" id="2853991">Type</span><span class="op" id="2853995">.</span><span class="ident" id="2853996">common</span><span class="op" id="2854002">(</span><span class="op" id="2854003">)</span><span class="op" id="2854004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854012">gc</span><span class="op" id="2854014">.</span><span class="ident" id="2854015">align</span><span class="op" id="2854020">(</span><span class="builtintype" id="2854021">uintptr</span><span class="op" id="2854028">(</span><span class="ident" id="2854029">t</span><span class="op" id="2854030">.</span><span class="ident" id="2854031">align</span><span class="op" id="2854036">)</span><span class="op" id="2854037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854040">}</span><br>
<span class="lineno"></span><span class="op" id="2854042">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2854045">func</span>&nbsp;<span class="op" id="2854050">(</span><span class="ident" id="2854051">gc</span>&nbsp;<span class="op" id="2854054">*</span><span class="ident" id="2854055">gcProg</span><span class="op" id="2854061">)</span>&nbsp;<span class="ident" id="2854063">appendWord</span><span class="op" id="2854073">(</span><span class="ident" id="2854074">v</span>&nbsp;<span class="builtintype" id="2854076">byte</span><span class="op" id="2854080">)</span>&nbsp;<span class="op" id="2854082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854085">ptrsize</span>&nbsp;<span class="op" id="2854093">:=</span>&nbsp;<span class="ident" id="2854096">unsafe</span><span class="op" id="2854102">.</span><span class="ident" id="2854103">Sizeof</span><span class="op" id="2854109">(</span><span class="builtintype" id="2854110">uintptr</span><span class="op" id="2854117">(</span><span class="num" id="2854118">0</span><span class="op" id="2854119">)</span><span class="op" id="2854120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854123">if</span>&nbsp;<span class="ident" id="2854126">gc</span><span class="op" id="2854128">.</span><span class="ident" id="2854129">size</span><span class="op" id="2854133">%</span><span class="ident" id="2854134">ptrsize</span>&nbsp;<span class="op" id="2854142">!=</span>&nbsp;<span class="num" id="2854145">0</span>&nbsp;<span class="op" id="2854147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2854151">panic</span><span class="op" id="2854156">(</span><span class="string" id="2854157">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2854188">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854194">nptr</span>&nbsp;<span class="op" id="2854199">:=</span>&nbsp;<span class="ident" id="2854202">gc</span><span class="op" id="2854204">.</span><span class="ident" id="2854205">size</span>&nbsp;<span class="op" id="2854210">/</span>&nbsp;<span class="ident" id="2854212">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854221">for</span>&nbsp;<span class="builtintype" id="2854225">uintptr</span><span class="op" id="2854232">(</span><span class="builtinfunc" id="2854233">len</span><span class="op" id="2854236">(</span><span class="ident" id="2854237">gc</span><span class="op" id="2854239">.</span><span class="ident" id="2854240">gc</span><span class="op" id="2854242">)</span><span class="op" id="2854243">)</span>&nbsp;<span class="op" id="2854245">&lt;</span>&nbsp;<span class="ident" id="2854247">nptr</span><span class="op" id="2854251">/</span><span class="num" id="2854252">2</span><span class="op" id="2854253">+</span><span class="num" id="2854254">1</span>&nbsp;<span class="op" id="2854256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854260">gc</span><span class="op" id="2854262">.</span><span class="ident" id="2854263">gc</span>&nbsp;<span class="op" id="2854266">=</span>&nbsp;<span class="builtinfunc" id="2854268">append</span><span class="op" id="2854274">(</span><span class="ident" id="2854275">gc</span><span class="op" id="2854277">.</span><span class="ident" id="2854278">gc</span><span class="op" id="2854280">,</span>&nbsp;<span class="num" id="2854282">0x44</span><span class="op" id="2854286">)</span>&nbsp;<span class="comment" id="2854288">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854303">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854306">gc</span><span class="op" id="2854308">.</span><span class="ident" id="2854309">gc</span><span class="op" id="2854311">[</span><span class="ident" id="2854312">nptr</span><span class="op" id="2854316">/</span><span class="num" id="2854317">2</span><span class="op" id="2854318">]</span>&nbsp;<span class="op" id="2854320">&amp;=</span>&nbsp;<span class="op" id="2854323">^</span><span class="op" id="2854324">(</span><span class="num" id="2854325">3</span>&nbsp;<span class="op" id="2854327">&lt;&lt;</span>&nbsp;<span class="op" id="2854330">(</span><span class="op" id="2854331">(</span><span class="ident" id="2854332">nptr</span><span class="op" id="2854336">%</span><span class="num" id="2854337">2</span><span class="op" id="2854338">)</span><span class="op" id="2854339">*</span><span class="num" id="2854340">4</span>&nbsp;<span class="op" id="2854342">+</span>&nbsp;<span class="num" id="2854344">2</span><span class="op" id="2854345">)</span><span class="op" id="2854346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854349">gc</span><span class="op" id="2854351">.</span><span class="ident" id="2854352">gc</span><span class="op" id="2854354">[</span><span class="ident" id="2854355">nptr</span><span class="op" id="2854359">/</span><span class="num" id="2854360">2</span><span class="op" id="2854361">]</span>&nbsp;<span class="op" id="2854363">|=</span>&nbsp;<span class="ident" id="2854366">v</span>&nbsp;<span class="op" id="2854368">&lt;&lt;</span>&nbsp;<span class="op" id="2854371">(</span><span class="op" id="2854372">(</span><span class="ident" id="2854373">nptr</span><span class="op" id="2854377">%</span><span class="num" id="2854378">2</span><span class="op" id="2854379">)</span><span class="op" id="2854380">*</span><span class="num" id="2854381">4</span>&nbsp;<span class="op" id="2854383">+</span>&nbsp;<span class="num" id="2854385">2</span><span class="op" id="2854386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854389">gc</span><span class="op" id="2854391">.</span><span class="ident" id="2854392">size</span>&nbsp;<span class="op" id="2854397">+=</span>&nbsp;<span class="ident" id="2854400">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2854408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2854411">func</span>&nbsp;<span class="op" id="2854416">(</span><span class="ident" id="2854417">gc</span>&nbsp;<span class="op" id="2854420">*</span><span class="ident" id="2854421">gcProg</span><span class="op" id="2854427">)</span>&nbsp;<span class="ident" id="2854429">finalize</span><span class="op" id="2854437">(</span><span class="op" id="2854438">)</span>&nbsp;<span class="ident" id="2854440">unsafe</span><span class="op" id="2854446">.</span><span class="ident" id="2854447">Pointer</span>&nbsp;<span class="op" id="2854455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854458">if</span>&nbsp;<span class="ident" id="2854461">gc</span><span class="op" id="2854463">.</span><span class="ident" id="2854464">size</span>&nbsp;<span class="op" id="2854469">==</span>&nbsp;<span class="num" id="2854472">0</span>&nbsp;<span class="op" id="2854474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854478">return</span>&nbsp;<span class="ident" id="2854485">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854493">ptrsize</span>&nbsp;<span class="op" id="2854501">:=</span>&nbsp;<span class="ident" id="2854504">unsafe</span><span class="op" id="2854510">.</span><span class="ident" id="2854511">Sizeof</span><span class="op" id="2854517">(</span><span class="builtintype" id="2854518">uintptr</span><span class="op" id="2854525">(</span><span class="num" id="2854526">0</span><span class="op" id="2854527">)</span><span class="op" id="2854528">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854531">gc</span><span class="op" id="2854533">.</span><span class="ident" id="2854534">align</span><span class="op" id="2854539">(</span><span class="ident" id="2854540">ptrsize</span><span class="op" id="2854547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854550">nptr</span>&nbsp;<span class="op" id="2854555">:=</span>&nbsp;<span class="ident" id="2854558">gc</span><span class="op" id="2854560">.</span><span class="ident" id="2854561">size</span>&nbsp;<span class="op" id="2854566">/</span>&nbsp;<span class="ident" id="2854568">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854577">for</span>&nbsp;<span class="builtintype" id="2854581">uintptr</span><span class="op" id="2854588">(</span><span class="builtinfunc" id="2854589">len</span><span class="op" id="2854592">(</span><span class="ident" id="2854593">gc</span><span class="op" id="2854595">.</span><span class="ident" id="2854596">gc</span><span class="op" id="2854598">)</span><span class="op" id="2854599">)</span>&nbsp;<span class="op" id="2854601">&lt;</span>&nbsp;<span class="ident" id="2854603">nptr</span><span class="op" id="2854607">/</span><span class="num" id="2854608">2</span><span class="op" id="2854609">+</span><span class="num" id="2854610">1</span>&nbsp;<span class="op" id="2854612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854616">gc</span><span class="op" id="2854618">.</span><span class="ident" id="2854619">gc</span>&nbsp;<span class="op" id="2854622">=</span>&nbsp;<span class="builtinfunc" id="2854624">append</span><span class="op" id="2854630">(</span><span class="ident" id="2854631">gc</span><span class="op" id="2854633">.</span><span class="ident" id="2854634">gc</span><span class="op" id="2854636">,</span>&nbsp;<span class="num" id="2854638">0x44</span><span class="op" id="2854642">)</span>&nbsp;<span class="comment" id="2854644">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854659">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2854662">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2854716">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854744">if</span>&nbsp;<span class="ident" id="2854747">nptr</span><span class="op" id="2854751">%</span><span class="num" id="2854752">2</span>&nbsp;<span class="op" id="2854754">!=</span>&nbsp;<span class="num" id="2854757">0</span>&nbsp;<span class="op" id="2854759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854763">for</span>&nbsp;<span class="ident" id="2854767">i</span>&nbsp;<span class="op" id="2854769">:=</span>&nbsp;<span class="builtintype" id="2854772">uintptr</span><span class="op" id="2854779">(</span><span class="num" id="2854780">0</span><span class="op" id="2854781">)</span><span class="op" id="2854782">;</span>&nbsp;<span class="ident" id="2854784">i</span>&nbsp;<span class="op" id="2854786">&lt;</span>&nbsp;<span class="ident" id="2854788">nptr</span><span class="op" id="2854792">;</span>&nbsp;<span class="ident" id="2854794">i</span><span class="op" id="2854795">++</span>&nbsp;<span class="op" id="2854798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2854803">gc</span><span class="op" id="2854805">.</span><span class="ident" id="2854806">appendWord</span><span class="op" id="2854816">(</span><span class="ident" id="2854817">extractGCWord</span><span class="op" id="2854830">(</span><span class="ident" id="2854831">gc</span><span class="op" id="2854833">.</span><span class="ident" id="2854834">gc</span><span class="op" id="2854836">,</span>&nbsp;<span class="ident" id="2854838">i</span><span class="op" id="2854839">)</span><span class="op" id="2854840">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2854847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854850">return</span>&nbsp;<span class="ident" id="2854857">unsafe</span><span class="op" id="2854863">.</span><span class="ident" id="2854864">Pointer</span><span class="op" id="2854871">(</span><span class="op" id="2854872">&amp;</span><span class="ident" id="2854873">gc</span><span class="op" id="2854875">.</span><span class="ident" id="2854876">gc</span><span class="op" id="2854878">[</span><span class="num" id="2854879">0</span><span class="op" id="2854880">]</span><span class="op" id="2854881">)</span><br>
<span class="lineno"></span><span class="op" id="2854883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2854886">func</span>&nbsp;<span class="ident" id="2854891">extractGCWord</span><span class="op" id="2854904">(</span><span class="ident" id="2854905">gc</span>&nbsp;<span class="op" id="2854908">[</span><span class="op" id="2854909">]</span><span class="builtintype" id="2854910">byte</span><span class="op" id="2854914">,</span>&nbsp;<span class="ident" id="2854916">i</span>&nbsp;<span class="builtintype" id="2854918">uintptr</span><span class="op" id="2854925">)</span>&nbsp;<span class="builtintype" id="2854927">byte</span>&nbsp;<span class="op" id="2854932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2854935">return</span>&nbsp;<span class="op" id="2854942">(</span><span class="ident" id="2854943">gc</span><span class="op" id="2854945">[</span><span class="ident" id="2854946">i</span><span class="op" id="2854947">/</span><span class="num" id="2854948">2</span><span class="op" id="2854949">]</span>&nbsp;<span class="op" id="2854951">&gt;&gt;</span>&nbsp;<span class="op" id="2854954">(</span><span class="op" id="2854955">(</span><span class="ident" id="2854956">i</span><span class="op" id="2854957">%</span><span class="num" id="2854958">2</span><span class="op" id="2854959">)</span><span class="op" id="2854960">*</span><span class="num" id="2854961">4</span>&nbsp;<span class="op" id="2854963">+</span>&nbsp;<span class="num" id="2854965">2</span><span class="op" id="2854966">)</span><span class="op" id="2854967">)</span>&nbsp;<span class="op" id="2854969">&amp;</span>&nbsp;<span class="num" id="2854971">3</span><br>
<span class="lineno"></span><span class="op" id="2854973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2854976">func</span>&nbsp;<span class="op" id="2854981">(</span><span class="ident" id="2854982">gc</span>&nbsp;<span class="op" id="2854985">*</span><span class="ident" id="2854986">gcProg</span><span class="op" id="2854992">)</span>&nbsp;<span class="ident" id="2854994">align</span><span class="op" id="2854999">(</span><span class="ident" id="2855000">a</span>&nbsp;<span class="builtintype" id="2855002">uintptr</span><span class="op" id="2855009">)</span>&nbsp;<span class="op" id="2855011">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855014">gc</span><span class="op" id="2855016">.</span><span class="ident" id="2855017">size</span>&nbsp;<span class="op" id="2855022">=</span>&nbsp;<span class="ident" id="2855024">align</span><span class="op" id="2855029">(</span><span class="ident" id="2855030">gc</span><span class="op" id="2855032">.</span><span class="ident" id="2855033">size</span><span class="op" id="2855037">,</span>&nbsp;<span class="ident" id="2855039">a</span><span class="op" id="2855040">)</span><br>
<span class="lineno"></span><span class="op" id="2855042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2855045">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2855106">const</span>&nbsp;<span class="op" id="2855112">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855115">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2855129">=</span>&nbsp;<span class="num" id="2855131">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855134">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2855148">=</span>&nbsp;<span class="num" id="2855150">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855153">bitsMultiWord</span>&nbsp;<span class="op" id="2855167">=</span>&nbsp;<span class="num" id="2855169">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855173">bitsIface</span>&nbsp;<span class="op" id="2855183">=</span>&nbsp;<span class="num" id="2855185">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855188">bitsEface</span>&nbsp;<span class="op" id="2855198">=</span>&nbsp;<span class="num" id="2855200">3</span><br>
<span class="lineno"></span><span class="op" id="2855202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2855205">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2855277">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2855349">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2855424">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2855455">const</span>&nbsp;<span class="op" id="2855461">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855464">bucketSize</span>&nbsp;<span class="op" id="2855475">=</span>&nbsp;<span class="num" id="2855477">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855480">maxKeySize</span>&nbsp;<span class="op" id="2855491">=</span>&nbsp;<span class="num" id="2855493">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855498">maxValSize</span>&nbsp;<span class="op" id="2855509">=</span>&nbsp;<span class="num" id="2855511">128</span><br>
<span class="lineno"></span><span class="op" id="2855515">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2855518">func</span>&nbsp;<span class="ident" id="2855523">bucketOf</span><span class="op" id="2855531">(</span><span class="ident" id="2855532">ktyp</span><span class="op" id="2855536">,</span>&nbsp;<span class="ident" id="2855538">etyp</span>&nbsp;<span class="op" id="2855543">*</span><span class="ident" id="2855544">rtype</span><span class="op" id="2855549">)</span>&nbsp;<span class="op" id="2855551">*</span><span class="ident" id="2855552">rtype</span>&nbsp;<span class="op" id="2855558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855561">if</span>&nbsp;<span class="ident" id="2855564">ktyp</span><span class="op" id="2855568">.</span><span class="ident" id="2855569">size</span>&nbsp;<span class="op" id="2855574">&gt;</span>&nbsp;<span class="ident" id="2855576">maxKeySize</span>&nbsp;<span class="op" id="2855587">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855591">ktyp</span>&nbsp;<span class="op" id="2855596">=</span>&nbsp;<span class="ident" id="2855598">PtrTo</span><span class="op" id="2855603">(</span><span class="ident" id="2855604">ktyp</span><span class="op" id="2855608">)</span><span class="op" id="2855609">.</span><span class="op" id="2855610">(</span><span class="op" id="2855611">*</span><span class="ident" id="2855612">rtype</span><span class="op" id="2855617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855623">if</span>&nbsp;<span class="ident" id="2855626">etyp</span><span class="op" id="2855630">.</span><span class="ident" id="2855631">size</span>&nbsp;<span class="op" id="2855636">&gt;</span>&nbsp;<span class="ident" id="2855638">maxValSize</span>&nbsp;<span class="op" id="2855649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855653">etyp</span>&nbsp;<span class="op" id="2855658">=</span>&nbsp;<span class="ident" id="2855660">PtrTo</span><span class="op" id="2855665">(</span><span class="ident" id="2855666">etyp</span><span class="op" id="2855670">)</span><span class="op" id="2855671">.</span><span class="op" id="2855672">(</span><span class="op" id="2855673">*</span><span class="ident" id="2855674">rtype</span><span class="op" id="2855679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855682">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855685">ptrsize</span>&nbsp;<span class="op" id="2855693">:=</span>&nbsp;<span class="ident" id="2855696">unsafe</span><span class="op" id="2855702">.</span><span class="ident" id="2855703">Sizeof</span><span class="op" id="2855709">(</span><span class="builtintype" id="2855710">uintptr</span><span class="op" id="2855717">(</span><span class="num" id="2855718">0</span><span class="op" id="2855719">)</span><span class="op" id="2855720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855724">var</span>&nbsp;<span class="ident" id="2855728">gc</span>&nbsp;<span class="ident" id="2855731">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2855739">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855751">for</span>&nbsp;<span class="ident" id="2855755">i</span>&nbsp;<span class="op" id="2855757">:=</span>&nbsp;<span class="num" id="2855760">0</span><span class="op" id="2855761">;</span>&nbsp;<span class="ident" id="2855763">i</span>&nbsp;<span class="op" id="2855765">&lt;</span>&nbsp;<span class="builtintype" id="2855767">int</span><span class="op" id="2855770">(</span><span class="ident" id="2855771">bucketSize</span><span class="op" id="2855781">*</span><span class="ident" id="2855782">unsafe</span><span class="op" id="2855788">.</span><span class="ident" id="2855789">Sizeof</span><span class="op" id="2855795">(</span><span class="builtintype" id="2855796">uint8</span><span class="op" id="2855801">(</span><span class="num" id="2855802">0</span><span class="op" id="2855803">)</span><span class="op" id="2855804">)</span><span class="op" id="2855805">/</span><span class="ident" id="2855806">ptrsize</span><span class="op" id="2855813">)</span><span class="op" id="2855814">;</span>&nbsp;<span class="ident" id="2855816">i</span><span class="op" id="2855817">++</span>&nbsp;<span class="op" id="2855820">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855824">gc</span><span class="op" id="2855826">.</span><span class="builtinfunc" id="2855827">append</span><span class="op" id="2855833">(</span><span class="ident" id="2855834">bitsScalar</span><span class="op" id="2855844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855850">gc</span><span class="op" id="2855852">.</span><span class="builtinfunc" id="2855853">append</span><span class="op" id="2855859">(</span><span class="ident" id="2855860">bitsPointer</span><span class="op" id="2855871">)</span>&nbsp;<span class="comment" id="2855873">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855886">if</span>&nbsp;<span class="ident" id="2855889">runtime</span><span class="op" id="2855896">.</span><span class="ident" id="2855897">GOARCH</span>&nbsp;<span class="op" id="2855904">==</span>&nbsp;<span class="string" id="2855907">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2855918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855922">gc</span><span class="op" id="2855924">.</span><span class="builtinfunc" id="2855925">append</span><span class="op" id="2855931">(</span><span class="ident" id="2855932">bitsScalar</span><span class="op" id="2855942">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2855945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2855948">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2855957">for</span>&nbsp;<span class="ident" id="2855961">i</span>&nbsp;<span class="op" id="2855963">:=</span>&nbsp;<span class="num" id="2855966">0</span><span class="op" id="2855967">;</span>&nbsp;<span class="ident" id="2855969">i</span>&nbsp;<span class="op" id="2855971">&lt;</span>&nbsp;<span class="ident" id="2855973">bucketSize</span><span class="op" id="2855983">;</span>&nbsp;<span class="ident" id="2855985">i</span><span class="op" id="2855986">++</span>&nbsp;<span class="op" id="2855989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2855993">gc</span><span class="op" id="2855995">.</span><span class="ident" id="2855996">appendProg</span><span class="op" id="2856006">(</span><span class="ident" id="2856007">ktyp</span><span class="op" id="2856011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856014">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856017">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856028">for</span>&nbsp;<span class="ident" id="2856032">i</span>&nbsp;<span class="op" id="2856034">:=</span>&nbsp;<span class="num" id="2856037">0</span><span class="op" id="2856038">;</span>&nbsp;<span class="ident" id="2856040">i</span>&nbsp;<span class="op" id="2856042">&lt;</span>&nbsp;<span class="ident" id="2856044">bucketSize</span><span class="op" id="2856054">;</span>&nbsp;<span class="ident" id="2856056">i</span><span class="op" id="2856057">++</span>&nbsp;<span class="op" id="2856060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856064">gc</span><span class="op" id="2856066">.</span><span class="ident" id="2856067">appendProg</span><span class="op" id="2856077">(</span><span class="ident" id="2856078">etyp</span><span class="op" id="2856082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856089">b</span>&nbsp;<span class="op" id="2856091">:=</span>&nbsp;<span class="builtinfunc" id="2856094">new</span><span class="op" id="2856097">(</span><span class="ident" id="2856098">rtype</span><span class="op" id="2856103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856106">b</span><span class="op" id="2856107">.</span><span class="ident" id="2856108">size</span>&nbsp;<span class="op" id="2856113">=</span>&nbsp;<span class="ident" id="2856115">gc</span><span class="op" id="2856117">.</span><span class="ident" id="2856118">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856124">b</span><span class="op" id="2856125">.</span><span class="ident" id="2856126">gc</span><span class="op" id="2856128">[</span><span class="num" id="2856129">0</span><span class="op" id="2856130">]</span>&nbsp;<span class="op" id="2856132">=</span>&nbsp;<span class="ident" id="2856134">gc</span><span class="op" id="2856136">.</span><span class="ident" id="2856137">finalize</span><span class="op" id="2856145">(</span><span class="op" id="2856146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856149">s</span>&nbsp;<span class="op" id="2856151">:=</span>&nbsp;<span class="string" id="2856154">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2856164">+</span>&nbsp;<span class="op" id="2856166">*</span><span class="ident" id="2856167">ktyp</span><span class="op" id="2856171">.</span><span class="builtintype" id="2856172">string</span>&nbsp;<span class="op" id="2856179">+</span>&nbsp;<span class="string" id="2856181">&#34;,&#34;</span>&nbsp;<span class="op" id="2856185">+</span>&nbsp;<span class="op" id="2856187">*</span><span class="ident" id="2856188">etyp</span><span class="op" id="2856192">.</span><span class="builtintype" id="2856193">string</span>&nbsp;<span class="op" id="2856200">+</span>&nbsp;<span class="string" id="2856202">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856207">b</span><span class="op" id="2856208">.</span><span class="builtintype" id="2856209">string</span>&nbsp;<span class="op" id="2856216">=</span>&nbsp;<span class="op" id="2856218">&amp;</span><span class="ident" id="2856219">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856222">return</span>&nbsp;<span class="ident" id="2856229">b</span><br>
<span class="lineno"></span><span class="op" id="2856231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2856234">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2856289">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2856355">func</span>&nbsp;<span class="ident" id="2856360">SliceOf</span><span class="op" id="2856367">(</span><span class="ident" id="2856368">t</span>&nbsp;<span class="ident" id="2856370">Type</span><span class="op" id="2856374">)</span>&nbsp;<span class="ident" id="2856376">Type</span>&nbsp;<span class="op" id="2856381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856384">typ</span>&nbsp;<span class="op" id="2856388">:=</span>&nbsp;<span class="ident" id="2856391">t</span><span class="op" id="2856392">.</span><span class="op" id="2856393">(</span><span class="op" id="2856394">*</span><span class="ident" id="2856395">rtype</span><span class="op" id="2856400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856404">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856423">ckey</span>&nbsp;<span class="op" id="2856428">:=</span>&nbsp;<span class="ident" id="2856431">cacheKey</span><span class="op" id="2856439">{</span><span class="ident" id="2856440">Slice</span><span class="op" id="2856445">,</span>&nbsp;<span class="ident" id="2856447">typ</span><span class="op" id="2856450">,</span>&nbsp;<span class="ident" id="2856452">nil</span><span class="op" id="2856455">,</span>&nbsp;<span class="num" id="2856457">0</span><span class="op" id="2856458">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856461">if</span>&nbsp;<span class="ident" id="2856464">slice</span>&nbsp;<span class="op" id="2856470">:=</span>&nbsp;<span class="ident" id="2856473">cacheGet</span><span class="op" id="2856481">(</span><span class="ident" id="2856482">ckey</span><span class="op" id="2856486">)</span><span class="op" id="2856487">;</span>&nbsp;<span class="ident" id="2856489">slice</span>&nbsp;<span class="op" id="2856495">!=</span>&nbsp;<span class="ident" id="2856498">nil</span>&nbsp;<span class="op" id="2856502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856506">return</span>&nbsp;<span class="ident" id="2856513">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856524">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856549">s</span>&nbsp;<span class="op" id="2856551">:=</span>&nbsp;<span class="string" id="2856554">&#34;[]&#34;</span>&nbsp;<span class="op" id="2856559">+</span>&nbsp;<span class="op" id="2856561">*</span><span class="ident" id="2856562">typ</span><span class="op" id="2856565">.</span><span class="builtintype" id="2856566">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856574">for</span>&nbsp;<span class="ident" id="2856578">_</span><span class="op" id="2856579">,</span>&nbsp;<span class="ident" id="2856581">tt</span>&nbsp;<span class="op" id="2856584">:=</span>&nbsp;<span class="keyword" id="2856587">range</span>&nbsp;<span class="ident" id="2856593">typesByString</span><span class="op" id="2856606">(</span><span class="ident" id="2856607">s</span><span class="op" id="2856608">)</span>&nbsp;<span class="op" id="2856610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856614">slice</span>&nbsp;<span class="op" id="2856620">:=</span>&nbsp;<span class="op" id="2856623">(</span><span class="op" id="2856624">*</span><span class="ident" id="2856625">sliceType</span><span class="op" id="2856634">)</span><span class="op" id="2856635">(</span><span class="ident" id="2856636">unsafe</span><span class="op" id="2856642">.</span><span class="ident" id="2856643">Pointer</span><span class="op" id="2856650">(</span><span class="ident" id="2856651">tt</span><span class="op" id="2856653">)</span><span class="op" id="2856654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856658">if</span>&nbsp;<span class="ident" id="2856661">slice</span><span class="op" id="2856666">.</span><span class="ident" id="2856667">elem</span>&nbsp;<span class="op" id="2856672">==</span>&nbsp;<span class="ident" id="2856675">typ</span>&nbsp;<span class="op" id="2856679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856684">return</span>&nbsp;<span class="ident" id="2856691">cachePut</span><span class="op" id="2856699">(</span><span class="ident" id="2856700">ckey</span><span class="op" id="2856704">,</span>&nbsp;<span class="ident" id="2856706">tt</span><span class="op" id="2856708">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2856719">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2856742">var</span>&nbsp;<span class="ident" id="2856746">islice</span>&nbsp;<span class="keyword" id="2856753">interface</span><span class="op" id="2856762">{</span><span class="op" id="2856763">}</span>&nbsp;<span class="op" id="2856765">=</span>&nbsp;<span class="op" id="2856767">(</span><span class="op" id="2856768">[</span><span class="op" id="2856769">]</span><span class="ident" id="2856770">unsafe</span><span class="op" id="2856776">.</span><span class="ident" id="2856777">Pointer</span><span class="op" id="2856784">)</span><span class="op" id="2856785">(</span><span class="ident" id="2856786">nil</span><span class="op" id="2856789">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856792">prototype</span>&nbsp;<span class="op" id="2856802">:=</span>&nbsp;<span class="op" id="2856805">*</span><span class="op" id="2856806">(</span><span class="op" id="2856807">*</span><span class="op" id="2856808">*</span><span class="ident" id="2856809">sliceType</span><span class="op" id="2856818">)</span><span class="op" id="2856819">(</span><span class="ident" id="2856820">unsafe</span><span class="op" id="2856826">.</span><span class="ident" id="2856827">Pointer</span><span class="op" id="2856834">(</span><span class="op" id="2856835">&amp;</span><span class="ident" id="2856836">islice</span><span class="op" id="2856842">)</span><span class="op" id="2856843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856846">slice</span>&nbsp;<span class="op" id="2856852">:=</span>&nbsp;<span class="builtinfunc" id="2856855">new</span><span class="op" id="2856858">(</span><span class="ident" id="2856859">sliceType</span><span class="op" id="2856868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2856871">*</span><span class="ident" id="2856872">slice</span>&nbsp;<span class="op" id="2856878">=</span>&nbsp;<span class="op" id="2856880">*</span><span class="ident" id="2856881">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856892">slice</span><span class="op" id="2856897">.</span><span class="builtintype" id="2856898">string</span>&nbsp;<span class="op" id="2856905">=</span>&nbsp;<span class="op" id="2856907">&amp;</span><span class="ident" id="2856908">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856911">slice</span><span class="op" id="2856916">.</span><span class="ident" id="2856917">hash</span>&nbsp;<span class="op" id="2856922">=</span>&nbsp;<span class="ident" id="2856924">fnv1</span><span class="op" id="2856928">(</span><span class="ident" id="2856929">typ</span><span class="op" id="2856932">.</span><span class="ident" id="2856933">hash</span><span class="op" id="2856937">,</span>&nbsp;<span class="string" id="2856939">&#39;[&#39;</span><span class="op" id="2856942">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856945">slice</span><span class="op" id="2856950">.</span><span class="ident" id="2856951">elem</span>&nbsp;<span class="op" id="2856956">=</span>&nbsp;<span class="ident" id="2856958">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856963">slice</span><span class="op" id="2856968">.</span><span class="ident" id="2856969">uncommonType</span>&nbsp;<span class="op" id="2856982">=</span>&nbsp;<span class="ident" id="2856984">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2856989">slice</span><span class="op" id="2856994">.</span><span class="ident" id="2856995">ptrToThis</span>&nbsp;<span class="op" id="2857005">=</span>&nbsp;<span class="ident" id="2857007">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857012">slice</span><span class="op" id="2857017">.</span><span class="ident" id="2857018">zero</span>&nbsp;<span class="op" id="2857023">=</span>&nbsp;<span class="ident" id="2857025">unsafe</span><span class="op" id="2857031">.</span><span class="ident" id="2857032">Pointer</span><span class="op" id="2857039">(</span><span class="op" id="2857040">&amp;</span><span class="builtinfunc" id="2857041">make</span><span class="op" id="2857045">(</span><span class="op" id="2857046">[</span><span class="op" id="2857047">]</span><span class="builtintype" id="2857048">byte</span><span class="op" id="2857052">,</span>&nbsp;<span class="ident" id="2857054">slice</span><span class="op" id="2857059">.</span><span class="ident" id="2857060">size</span><span class="op" id="2857064">)</span><span class="op" id="2857065">[</span><span class="num" id="2857066">0</span><span class="op" id="2857067">]</span><span class="op" id="2857068">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857072">return</span>&nbsp;<span class="ident" id="2857079">cachePut</span><span class="op" id="2857087">(</span><span class="ident" id="2857088">ckey</span><span class="op" id="2857092">,</span>&nbsp;<span class="op" id="2857094">&amp;</span><span class="ident" id="2857095">slice</span><span class="op" id="2857100">.</span><span class="ident" id="2857101">rtype</span><span class="op" id="2857106">)</span><br>
<span class="lineno"></span><span class="op" id="2857108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2857111">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2857184">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2857254">//</span><br>
<span class="lineno"></span><span class="comment" id="2857257">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2857332">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2857351">//</span><br>
<span class="lineno"></span><span class="comment" id="2857354">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2857431">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2857483">//</span><br>
<span class="lineno"></span><span class="comment" id="2857486">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2857541">func</span>&nbsp;<span class="ident" id="2857546">arrayOf</span><span class="op" id="2857553">(</span><span class="ident" id="2857554">count</span>&nbsp;<span class="builtintype" id="2857560">int</span><span class="op" id="2857563">,</span>&nbsp;<span class="ident" id="2857565">elem</span>&nbsp;<span class="ident" id="2857570">Type</span><span class="op" id="2857574">)</span>&nbsp;<span class="ident" id="2857576">Type</span>&nbsp;<span class="op" id="2857581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857584">typ</span>&nbsp;<span class="op" id="2857588">:=</span>&nbsp;<span class="ident" id="2857591">elem</span><span class="op" id="2857595">.</span><span class="op" id="2857596">(</span><span class="op" id="2857597">*</span><span class="ident" id="2857598">rtype</span><span class="op" id="2857603">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857606">slice</span>&nbsp;<span class="op" id="2857612">:=</span>&nbsp;<span class="ident" id="2857615">SliceOf</span><span class="op" id="2857622">(</span><span class="ident" id="2857623">elem</span><span class="op" id="2857627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2857631">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857650">ckey</span>&nbsp;<span class="op" id="2857655">:=</span>&nbsp;<span class="ident" id="2857658">cacheKey</span><span class="op" id="2857666">{</span><span class="ident" id="2857667">Array</span><span class="op" id="2857672">,</span>&nbsp;<span class="ident" id="2857674">typ</span><span class="op" id="2857677">,</span>&nbsp;<span class="ident" id="2857679">nil</span><span class="op" id="2857682">,</span>&nbsp;<span class="builtintype" id="2857684">uintptr</span><span class="op" id="2857691">(</span><span class="ident" id="2857692">count</span><span class="op" id="2857697">)</span><span class="op" id="2857698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857701">if</span>&nbsp;<span class="ident" id="2857704">slice</span>&nbsp;<span class="op" id="2857710">:=</span>&nbsp;<span class="ident" id="2857713">cacheGet</span><span class="op" id="2857721">(</span><span class="ident" id="2857722">ckey</span><span class="op" id="2857726">)</span><span class="op" id="2857727">;</span>&nbsp;<span class="ident" id="2857729">slice</span>&nbsp;<span class="op" id="2857735">!=</span>&nbsp;<span class="ident" id="2857738">nil</span>&nbsp;<span class="op" id="2857742">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857746">return</span>&nbsp;<span class="ident" id="2857753">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2857760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2857764">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857789">s</span>&nbsp;<span class="op" id="2857791">:=</span>&nbsp;<span class="string" id="2857794">&#34;[&#34;</span>&nbsp;<span class="op" id="2857798">+</span>&nbsp;<span class="ident" id="2857800">strconv</span><span class="op" id="2857807">.</span><span class="ident" id="2857808">Itoa</span><span class="op" id="2857812">(</span><span class="ident" id="2857813">count</span><span class="op" id="2857818">)</span>&nbsp;<span class="op" id="2857820">+</span>&nbsp;<span class="string" id="2857822">&#34;]&#34;</span>&nbsp;<span class="op" id="2857826">+</span>&nbsp;<span class="op" id="2857828">*</span><span class="ident" id="2857829">typ</span><span class="op" id="2857832">.</span><span class="builtintype" id="2857833">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857841">for</span>&nbsp;<span class="ident" id="2857845">_</span><span class="op" id="2857846">,</span>&nbsp;<span class="ident" id="2857848">tt</span>&nbsp;<span class="op" id="2857851">:=</span>&nbsp;<span class="keyword" id="2857854">range</span>&nbsp;<span class="ident" id="2857860">typesByString</span><span class="op" id="2857873">(</span><span class="ident" id="2857874">s</span><span class="op" id="2857875">)</span>&nbsp;<span class="op" id="2857877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2857881">slice</span>&nbsp;<span class="op" id="2857887">:=</span>&nbsp;<span class="op" id="2857890">(</span><span class="op" id="2857891">*</span><span class="ident" id="2857892">sliceType</span><span class="op" id="2857901">)</span><span class="op" id="2857902">(</span><span class="ident" id="2857903">unsafe</span><span class="op" id="2857909">.</span><span class="ident" id="2857910">Pointer</span><span class="op" id="2857917">(</span><span class="ident" id="2857918">tt</span><span class="op" id="2857920">)</span><span class="op" id="2857921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857925">if</span>&nbsp;<span class="ident" id="2857928">slice</span><span class="op" id="2857933">.</span><span class="ident" id="2857934">elem</span>&nbsp;<span class="op" id="2857939">==</span>&nbsp;<span class="ident" id="2857942">typ</span>&nbsp;<span class="op" id="2857946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2857951">return</span>&nbsp;<span class="ident" id="2857958">cachePut</span><span class="op" id="2857966">(</span><span class="ident" id="2857967">ckey</span><span class="op" id="2857971">,</span>&nbsp;<span class="ident" id="2857973">tt</span><span class="op" id="2857975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2857979">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2857982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2857986">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2858010">var</span>&nbsp;<span class="ident" id="2858014">iarray</span>&nbsp;<span class="keyword" id="2858021">interface</span><span class="op" id="2858030">{</span><span class="op" id="2858031">}</span>&nbsp;<span class="op" id="2858033">=</span>&nbsp;<span class="op" id="2858035">[</span><span class="num" id="2858036">1</span><span class="op" id="2858037">]</span><span class="ident" id="2858038">unsafe</span><span class="op" id="2858044">.</span><span class="ident" id="2858045">Pointer</span><span class="op" id="2858052">{</span><span class="op" id="2858053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858056">prototype</span>&nbsp;<span class="op" id="2858066">:=</span>&nbsp;<span class="op" id="2858069">*</span><span class="op" id="2858070">(</span><span class="op" id="2858071">*</span><span class="op" id="2858072">*</span><span class="ident" id="2858073">arrayType</span><span class="op" id="2858082">)</span><span class="op" id="2858083">(</span><span class="ident" id="2858084">unsafe</span><span class="op" id="2858090">.</span><span class="ident" id="2858091">Pointer</span><span class="op" id="2858098">(</span><span class="op" id="2858099">&amp;</span><span class="ident" id="2858100">iarray</span><span class="op" id="2858106">)</span><span class="op" id="2858107">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858110">array</span>&nbsp;<span class="op" id="2858116">:=</span>&nbsp;<span class="builtinfunc" id="2858119">new</span><span class="op" id="2858122">(</span><span class="ident" id="2858123">arrayType</span><span class="op" id="2858132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2858135">*</span><span class="ident" id="2858136">array</span>&nbsp;<span class="op" id="2858142">=</span>&nbsp;<span class="op" id="2858144">*</span><span class="ident" id="2858145">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858156">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858197">array</span><span class="op" id="2858202">.</span><span class="builtintype" id="2858203">string</span>&nbsp;<span class="op" id="2858210">=</span>&nbsp;<span class="op" id="2858212">&amp;</span><span class="ident" id="2858213">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858216">array</span><span class="op" id="2858221">.</span><span class="ident" id="2858222">hash</span>&nbsp;<span class="op" id="2858227">=</span>&nbsp;<span class="ident" id="2858229">fnv1</span><span class="op" id="2858233">(</span><span class="ident" id="2858234">typ</span><span class="op" id="2858237">.</span><span class="ident" id="2858238">hash</span><span class="op" id="2858242">,</span>&nbsp;<span class="string" id="2858244">&#39;[&#39;</span><span class="op" id="2858247">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2858250">for</span>&nbsp;<span class="ident" id="2858254">n</span>&nbsp;<span class="op" id="2858256">:=</span>&nbsp;<span class="builtintype" id="2858259">uint32</span><span class="op" id="2858265">(</span><span class="ident" id="2858266">count</span><span class="op" id="2858271">)</span><span class="op" id="2858272">;</span>&nbsp;<span class="ident" id="2858274">n</span>&nbsp;<span class="op" id="2858276">&gt;</span>&nbsp;<span class="num" id="2858278">0</span><span class="op" id="2858279">;</span>&nbsp;<span class="ident" id="2858281">n</span>&nbsp;<span class="op" id="2858283">&gt;&gt;=</span>&nbsp;<span class="num" id="2858287">8</span>&nbsp;<span class="op" id="2858289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858293">array</span><span class="op" id="2858298">.</span><span class="ident" id="2858299">hash</span>&nbsp;<span class="op" id="2858304">=</span>&nbsp;<span class="ident" id="2858306">fnv1</span><span class="op" id="2858310">(</span><span class="ident" id="2858311">array</span><span class="op" id="2858316">.</span><span class="ident" id="2858317">hash</span><span class="op" id="2858321">,</span>&nbsp;<span class="builtintype" id="2858323">byte</span><span class="op" id="2858327">(</span><span class="ident" id="2858328">n</span><span class="op" id="2858329">)</span><span class="op" id="2858330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2858333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858336">array</span><span class="op" id="2858341">.</span><span class="ident" id="2858342">hash</span>&nbsp;<span class="op" id="2858347">=</span>&nbsp;<span class="ident" id="2858349">fnv1</span><span class="op" id="2858353">(</span><span class="ident" id="2858354">array</span><span class="op" id="2858359">.</span><span class="ident" id="2858360">hash</span><span class="op" id="2858364">,</span>&nbsp;<span class="string" id="2858366">&#39;]&#39;</span><span class="op" id="2858369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858372">array</span><span class="op" id="2858377">.</span><span class="ident" id="2858378">elem</span>&nbsp;<span class="op" id="2858383">=</span>&nbsp;<span class="ident" id="2858385">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858390">max</span>&nbsp;<span class="op" id="2858394">:=</span>&nbsp;<span class="op" id="2858397">^</span><span class="builtintype" id="2858398">uintptr</span><span class="op" id="2858405">(</span><span class="num" id="2858406">0</span><span class="op" id="2858407">)</span>&nbsp;<span class="op" id="2858409">/</span>&nbsp;<span class="ident" id="2858411">typ</span><span class="op" id="2858414">.</span><span class="ident" id="2858415">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2858421">if</span>&nbsp;<span class="builtintype" id="2858424">uintptr</span><span class="op" id="2858431">(</span><span class="ident" id="2858432">count</span><span class="op" id="2858437">)</span>&nbsp;<span class="op" id="2858439">&gt;</span>&nbsp;<span class="ident" id="2858441">max</span>&nbsp;<span class="op" id="2858445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2858449">panic</span><span class="op" id="2858454">(</span><span class="string" id="2858455">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2858519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2858522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858525">array</span><span class="op" id="2858530">.</span><span class="ident" id="2858531">size</span>&nbsp;<span class="op" id="2858536">=</span>&nbsp;<span class="ident" id="2858538">typ</span><span class="op" id="2858541">.</span><span class="ident" id="2858542">size</span>&nbsp;<span class="op" id="2858547">*</span>&nbsp;<span class="builtintype" id="2858549">uintptr</span><span class="op" id="2858556">(</span><span class="ident" id="2858557">count</span><span class="op" id="2858562">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858565">array</span><span class="op" id="2858570">.</span><span class="ident" id="2858571">align</span>&nbsp;<span class="op" id="2858577">=</span>&nbsp;<span class="ident" id="2858579">typ</span><span class="op" id="2858582">.</span><span class="ident" id="2858583">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858590">array</span><span class="op" id="2858595">.</span><span class="ident" id="2858596">fieldAlign</span>&nbsp;<span class="op" id="2858607">=</span>&nbsp;<span class="ident" id="2858609">typ</span><span class="op" id="2858612">.</span><span class="ident" id="2858613">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858625">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858645">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2858664">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858674">array</span><span class="op" id="2858679">.</span><span class="ident" id="2858680">uncommonType</span>&nbsp;<span class="op" id="2858693">=</span>&nbsp;<span class="ident" id="2858695">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858700">array</span><span class="op" id="2858705">.</span><span class="ident" id="2858706">ptrToThis</span>&nbsp;<span class="op" id="2858716">=</span>&nbsp;<span class="ident" id="2858718">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858723">array</span><span class="op" id="2858728">.</span><span class="ident" id="2858729">zero</span>&nbsp;<span class="op" id="2858734">=</span>&nbsp;<span class="ident" id="2858736">unsafe</span><span class="op" id="2858742">.</span><span class="ident" id="2858743">Pointer</span><span class="op" id="2858750">(</span><span class="op" id="2858751">&amp;</span><span class="builtinfunc" id="2858752">make</span><span class="op" id="2858756">(</span><span class="op" id="2858757">[</span><span class="op" id="2858758">]</span><span class="builtintype" id="2858759">byte</span><span class="op" id="2858763">,</span>&nbsp;<span class="ident" id="2858765">array</span><span class="op" id="2858770">.</span><span class="ident" id="2858771">size</span><span class="op" id="2858775">)</span><span class="op" id="2858776">[</span><span class="num" id="2858777">0</span><span class="op" id="2858778">]</span><span class="op" id="2858779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858782">array</span><span class="op" id="2858787">.</span><span class="builtinfunc" id="2858788">len</span>&nbsp;<span class="op" id="2858792">=</span>&nbsp;<span class="builtintype" id="2858794">uintptr</span><span class="op" id="2858801">(</span><span class="ident" id="2858802">count</span><span class="op" id="2858807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2858810">array</span><span class="op" id="2858815">.</span><span class="ident" id="2858816">slice</span>&nbsp;<span class="op" id="2858822">=</span>&nbsp;<span class="ident" id="2858824">slice</span><span class="op" id="2858829">.</span><span class="op" id="2858830">(</span><span class="op" id="2858831">*</span><span class="ident" id="2858832">rtype</span><span class="op" id="2858837">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2858841">return</span>&nbsp;<span class="ident" id="2858848">cachePut</span><span class="op" id="2858856">(</span><span class="ident" id="2858857">ckey</span><span class="op" id="2858861">,</span>&nbsp;<span class="op" id="2858863">&amp;</span><span class="ident" id="2858864">array</span><span class="op" id="2858869">.</span><span class="ident" id="2858870">rtype</span><span class="op" id="2858875">)</span><br>
<span class="lineno"></span><span class="op" id="2858877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2858880">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2858944">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2859013">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2859079">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2859148">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2859190">func</span>&nbsp;<span class="ident" id="2859195">toType</span><span class="op" id="2859201">(</span><span class="ident" id="2859202">t</span>&nbsp;<span class="op" id="2859204">*</span><span class="ident" id="2859205">rtype</span><span class="op" id="2859210">)</span>&nbsp;<span class="ident" id="2859212">Type</span>&nbsp;<span class="op" id="2859217">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2859220">if</span>&nbsp;<span class="ident" id="2859223">t</span>&nbsp;<span class="op" id="2859225">==</span>&nbsp;<span class="ident" id="2859228">nil</span>&nbsp;<span class="op" id="2859232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2859236">return</span>&nbsp;<span class="ident" id="2859243">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2859248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2859251">return</span>&nbsp;<span class="ident" id="2859258">t</span><br>
<span class="lineno"></span><span class="op" id="2859260">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2859263">type</span>&nbsp;<span class="ident" id="2859268">layoutKey</span>&nbsp;<span class="keyword" id="2859278">struct</span>&nbsp;<span class="op" id="2859285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859288">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859293">*</span><span class="ident" id="2859294">rtype</span>&nbsp;<span class="comment" id="2859300">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859323">rcvr</span>&nbsp;<span class="op" id="2859328">*</span><span class="ident" id="2859329">rtype</span>&nbsp;<span class="comment" id="2859335">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2859368">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2859371">type</span>&nbsp;<span class="ident" id="2859376">layoutType</span>&nbsp;<span class="keyword" id="2859387">struct</span>&nbsp;<span class="op" id="2859394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859397">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859407">*</span><span class="ident" id="2859408">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859415">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2859425">uintptr</span>&nbsp;<span class="comment" id="2859433">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859455">retOffset</span>&nbsp;<span class="builtintype" id="2859465">uintptr</span>&nbsp;<span class="comment" id="2859473">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859502">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2859512">*</span><span class="ident" id="2859513">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2859523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2859526">var</span>&nbsp;<span class="ident" id="2859530">layoutCache</span>&nbsp;<span class="keyword" id="2859542">struct</span>&nbsp;<span class="op" id="2859549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859552">sync</span><span class="op" id="2859556">.</span><span class="ident" id="2859557">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2859566">m</span>&nbsp;<span class="keyword" id="2859568">map</span><span class="op" id="2859571">[</span><span class="ident" id="2859572">layoutKey</span><span class="op" id="2859581">]</span><span class="ident" id="2859582">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2859593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2859596">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2859664">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2859729">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2859789">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2859868">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2859936">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2859976">func</span>&nbsp;<span class="ident" id="2859981">funcLayout</span><span class="op" id="2859991">(</span><span class="ident" id="2859992">t</span>&nbsp;<span class="op" id="2859994">*</span><span class="ident" id="2859995">rtype</span><span class="op" id="2860000">,</span>&nbsp;<span class="ident" id="2860002">rcvr</span>&nbsp;<span class="op" id="2860007">*</span><span class="ident" id="2860008">rtype</span><span class="op" id="2860013">)</span>&nbsp;<span class="op" id="2860015">(</span><span class="ident" id="2860016">frametype</span>&nbsp;<span class="op" id="2860026">*</span><span class="ident" id="2860027">rtype</span><span class="op" id="2860032">,</span>&nbsp;<span class="ident" id="2860034">argSize</span><span class="op" id="2860041">,</span>&nbsp;<span class="ident" id="2860043">retOffset</span>&nbsp;<span class="builtintype" id="2860053">uintptr</span><span class="op" id="2860060">,</span>&nbsp;<span class="ident" id="2860062">stack</span>&nbsp;<span class="op" id="2860068">*</span><span class="ident" id="2860069">bitVector</span><span class="op" id="2860078">)</span>&nbsp;<span class="op" id="2860080">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860083">if</span>&nbsp;<span class="ident" id="2860086">t</span><span class="op" id="2860087">.</span><span class="ident" id="2860088">Kind</span><span class="op" id="2860092">(</span><span class="op" id="2860093">)</span>&nbsp;<span class="op" id="2860095">!=</span>&nbsp;<span class="ident" id="2860098">Func</span>&nbsp;<span class="op" id="2860103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2860107">panic</span><span class="op" id="2860112">(</span><span class="string" id="2860113">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2860151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860157">if</span>&nbsp;<span class="ident" id="2860160">rcvr</span>&nbsp;<span class="op" id="2860165">!=</span>&nbsp;<span class="ident" id="2860168">nil</span>&nbsp;<span class="op" id="2860172">&amp;&amp;</span>&nbsp;<span class="ident" id="2860175">rcvr</span><span class="op" id="2860179">.</span><span class="ident" id="2860180">Kind</span><span class="op" id="2860184">(</span><span class="op" id="2860185">)</span>&nbsp;<span class="op" id="2860187">==</span>&nbsp;<span class="ident" id="2860190">Interface</span>&nbsp;<span class="op" id="2860200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2860204">panic</span><span class="op" id="2860209">(</span><span class="string" id="2860210">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2860257">+</span>&nbsp;<span class="ident" id="2860259">rcvr</span><span class="op" id="2860263">.</span><span class="ident" id="2860264">String</span><span class="op" id="2860270">(</span><span class="op" id="2860271">)</span><span class="op" id="2860272">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860278">k</span>&nbsp;<span class="op" id="2860280">:=</span>&nbsp;<span class="ident" id="2860283">layoutKey</span><span class="op" id="2860292">{</span><span class="ident" id="2860293">t</span><span class="op" id="2860294">,</span>&nbsp;<span class="ident" id="2860296">rcvr</span><span class="op" id="2860300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860303">layoutCache</span><span class="op" id="2860314">.</span><span class="ident" id="2860315">RLock</span><span class="op" id="2860320">(</span><span class="op" id="2860321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860324">if</span>&nbsp;<span class="ident" id="2860327">x</span>&nbsp;<span class="op" id="2860329">:=</span>&nbsp;<span class="ident" id="2860332">layoutCache</span><span class="op" id="2860343">.</span><span class="ident" id="2860344">m</span><span class="op" id="2860345">[</span><span class="ident" id="2860346">k</span><span class="op" id="2860347">]</span><span class="op" id="2860348">;</span>&nbsp;<span class="ident" id="2860350">x</span><span class="op" id="2860351">.</span><span class="ident" id="2860352">t</span>&nbsp;<span class="op" id="2860354">!=</span>&nbsp;<span class="ident" id="2860357">nil</span>&nbsp;<span class="op" id="2860361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860365">layoutCache</span><span class="op" id="2860376">.</span><span class="ident" id="2860377">RUnlock</span><span class="op" id="2860384">(</span><span class="op" id="2860385">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860389">return</span>&nbsp;<span class="ident" id="2860396">x</span><span class="op" id="2860397">.</span><span class="ident" id="2860398">t</span><span class="op" id="2860399">,</span>&nbsp;<span class="ident" id="2860401">x</span><span class="op" id="2860402">.</span><span class="ident" id="2860403">argSize</span><span class="op" id="2860410">,</span>&nbsp;<span class="ident" id="2860412">x</span><span class="op" id="2860413">.</span><span class="ident" id="2860414">retOffset</span><span class="op" id="2860423">,</span>&nbsp;<span class="ident" id="2860425">x</span><span class="op" id="2860426">.</span><span class="ident" id="2860427">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860437">layoutCache</span><span class="op" id="2860448">.</span><span class="ident" id="2860449">RUnlock</span><span class="op" id="2860456">(</span><span class="op" id="2860457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860460">layoutCache</span><span class="op" id="2860471">.</span><span class="ident" id="2860472">Lock</span><span class="op" id="2860476">(</span><span class="op" id="2860477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860480">if</span>&nbsp;<span class="ident" id="2860483">x</span>&nbsp;<span class="op" id="2860485">:=</span>&nbsp;<span class="ident" id="2860488">layoutCache</span><span class="op" id="2860499">.</span><span class="ident" id="2860500">m</span><span class="op" id="2860501">[</span><span class="ident" id="2860502">k</span><span class="op" id="2860503">]</span><span class="op" id="2860504">;</span>&nbsp;<span class="ident" id="2860506">x</span><span class="op" id="2860507">.</span><span class="ident" id="2860508">t</span>&nbsp;<span class="op" id="2860510">!=</span>&nbsp;<span class="ident" id="2860513">nil</span>&nbsp;<span class="op" id="2860517">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860521">layoutCache</span><span class="op" id="2860532">.</span><span class="ident" id="2860533">Unlock</span><span class="op" id="2860539">(</span><span class="op" id="2860540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860544">return</span>&nbsp;<span class="ident" id="2860551">x</span><span class="op" id="2860552">.</span><span class="ident" id="2860553">t</span><span class="op" id="2860554">,</span>&nbsp;<span class="ident" id="2860556">x</span><span class="op" id="2860557">.</span><span class="ident" id="2860558">argSize</span><span class="op" id="2860565">,</span>&nbsp;<span class="ident" id="2860567">x</span><span class="op" id="2860568">.</span><span class="ident" id="2860569">retOffset</span><span class="op" id="2860578">,</span>&nbsp;<span class="ident" id="2860580">x</span><span class="op" id="2860581">.</span><span class="ident" id="2860582">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2860589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860593">tt</span>&nbsp;<span class="op" id="2860596">:=</span>&nbsp;<span class="op" id="2860599">(</span><span class="op" id="2860600">*</span><span class="ident" id="2860601">funcType</span><span class="op" id="2860609">)</span><span class="op" id="2860610">(</span><span class="ident" id="2860611">unsafe</span><span class="op" id="2860617">.</span><span class="ident" id="2860618">Pointer</span><span class="op" id="2860625">(</span><span class="ident" id="2860626">t</span><span class="op" id="2860627">)</span><span class="op" id="2860628">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2860632">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860684">stack</span>&nbsp;<span class="op" id="2860690">=</span>&nbsp;<span class="builtinfunc" id="2860692">new</span><span class="op" id="2860695">(</span><span class="ident" id="2860696">bitVector</span><span class="op" id="2860705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860708">var</span>&nbsp;<span class="ident" id="2860712">gc</span>&nbsp;<span class="ident" id="2860715">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860723">var</span>&nbsp;<span class="ident" id="2860727">offset</span>&nbsp;<span class="builtintype" id="2860734">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860743">if</span>&nbsp;<span class="ident" id="2860746">rcvr</span>&nbsp;<span class="op" id="2860751">!=</span>&nbsp;<span class="ident" id="2860754">nil</span>&nbsp;<span class="op" id="2860758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2860762">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2860819">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2860875">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2860923">if</span>&nbsp;<span class="ident" id="2860926">ifaceIndir</span><span class="op" id="2860936">(</span><span class="ident" id="2860937">rcvr</span><span class="op" id="2860941">)</span>&nbsp;<span class="op" id="2860943">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2860948">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2860989">gc</span><span class="op" id="2860991">.</span><span class="builtinfunc" id="2860992">append</span><span class="op" id="2860998">(</span><span class="ident" id="2860999">bitsPointer</span><span class="op" id="2861010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861015">stack</span><span class="op" id="2861020">.</span><span class="ident" id="2861021">append2</span><span class="op" id="2861028">(</span><span class="ident" id="2861029">bitsPointer</span><span class="op" id="2861040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861044">}</span>&nbsp;<span class="keyword" id="2861046">else</span>&nbsp;<span class="keyword" id="2861051">if</span>&nbsp;<span class="ident" id="2861054">rcvr</span><span class="op" id="2861058">.</span><span class="ident" id="2861059">pointers</span><span class="op" id="2861067">(</span><span class="op" id="2861068">)</span>&nbsp;<span class="op" id="2861070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861075">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861132">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861165">gc</span><span class="op" id="2861167">.</span><span class="builtinfunc" id="2861168">append</span><span class="op" id="2861174">(</span><span class="ident" id="2861175">bitsPointer</span><span class="op" id="2861186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861191">stack</span><span class="op" id="2861196">.</span><span class="ident" id="2861197">append2</span><span class="op" id="2861204">(</span><span class="ident" id="2861205">bitsPointer</span><span class="op" id="2861216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861220">}</span>&nbsp;<span class="keyword" id="2861222">else</span>&nbsp;<span class="op" id="2861227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861232">gc</span><span class="op" id="2861234">.</span><span class="builtinfunc" id="2861235">append</span><span class="op" id="2861241">(</span><span class="ident" id="2861242">bitsScalar</span><span class="op" id="2861252">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861257">stack</span><span class="op" id="2861262">.</span><span class="ident" id="2861263">append2</span><span class="op" id="2861270">(</span><span class="ident" id="2861271">bitsScalar</span><span class="op" id="2861281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861289">offset</span>&nbsp;<span class="op" id="2861296">+=</span>&nbsp;<span class="ident" id="2861299">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861311">for</span>&nbsp;<span class="ident" id="2861315">_</span><span class="op" id="2861316">,</span>&nbsp;<span class="ident" id="2861318">arg</span>&nbsp;<span class="op" id="2861322">:=</span>&nbsp;<span class="keyword" id="2861325">range</span>&nbsp;<span class="ident" id="2861331">tt</span><span class="op" id="2861333">.</span><span class="ident" id="2861334">in</span>&nbsp;<span class="op" id="2861337">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861341">gc</span><span class="op" id="2861343">.</span><span class="ident" id="2861344">appendProg</span><span class="op" id="2861354">(</span><span class="ident" id="2861355">arg</span><span class="op" id="2861358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861362">addTypeBits</span><span class="op" id="2861373">(</span><span class="ident" id="2861374">stack</span><span class="op" id="2861379">,</span>&nbsp;<span class="op" id="2861381">&amp;</span><span class="ident" id="2861382">offset</span><span class="op" id="2861388">,</span>&nbsp;<span class="ident" id="2861390">arg</span><span class="op" id="2861393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861399">argSize</span>&nbsp;<span class="op" id="2861407">=</span>&nbsp;<span class="ident" id="2861409">gc</span><span class="op" id="2861411">.</span><span class="ident" id="2861412">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861418">if</span>&nbsp;<span class="ident" id="2861421">runtime</span><span class="op" id="2861428">.</span><span class="ident" id="2861429">GOARCH</span>&nbsp;<span class="op" id="2861436">==</span>&nbsp;<span class="string" id="2861439">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2861450">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861454">gc</span><span class="op" id="2861456">.</span><span class="ident" id="2861457">align</span><span class="op" id="2861462">(</span><span class="num" id="2861463">8</span><span class="op" id="2861464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861470">gc</span><span class="op" id="2861472">.</span><span class="ident" id="2861473">align</span><span class="op" id="2861478">(</span><span class="ident" id="2861479">ptrSize</span><span class="op" id="2861486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861489">retOffset</span>&nbsp;<span class="op" id="2861499">=</span>&nbsp;<span class="ident" id="2861501">gc</span><span class="op" id="2861503">.</span><span class="ident" id="2861504">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861510">for</span>&nbsp;<span class="ident" id="2861514">_</span><span class="op" id="2861515">,</span>&nbsp;<span class="ident" id="2861517">res</span>&nbsp;<span class="op" id="2861521">:=</span>&nbsp;<span class="keyword" id="2861524">range</span>&nbsp;<span class="ident" id="2861530">tt</span><span class="op" id="2861532">.</span><span class="ident" id="2861533">out</span>&nbsp;<span class="op" id="2861537">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861541">gc</span><span class="op" id="2861543">.</span><span class="ident" id="2861544">appendProg</span><span class="op" id="2861554">(</span><span class="ident" id="2861555">res</span><span class="op" id="2861558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861562">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861605">gc</span><span class="op" id="2861607">.</span><span class="ident" id="2861608">align</span><span class="op" id="2861613">(</span><span class="ident" id="2861614">ptrSize</span><span class="op" id="2861621">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861625">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861666">x</span>&nbsp;<span class="op" id="2861668">:=</span>&nbsp;<span class="builtinfunc" id="2861671">new</span><span class="op" id="2861674">(</span><span class="ident" id="2861675">rtype</span><span class="op" id="2861680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861683">x</span><span class="op" id="2861684">.</span><span class="ident" id="2861685">size</span>&nbsp;<span class="op" id="2861690">=</span>&nbsp;<span class="ident" id="2861692">gc</span><span class="op" id="2861694">.</span><span class="ident" id="2861695">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861701">x</span><span class="op" id="2861702">.</span><span class="ident" id="2861703">gc</span><span class="op" id="2861705">[</span><span class="num" id="2861706">0</span><span class="op" id="2861707">]</span>&nbsp;<span class="op" id="2861709">=</span>&nbsp;<span class="ident" id="2861711">gc</span><span class="op" id="2861713">.</span><span class="ident" id="2861714">finalize</span><span class="op" id="2861722">(</span><span class="op" id="2861723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861726">var</span>&nbsp;<span class="ident" id="2861730">s</span>&nbsp;<span class="builtintype" id="2861732">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861740">if</span>&nbsp;<span class="ident" id="2861743">rcvr</span>&nbsp;<span class="op" id="2861748">!=</span>&nbsp;<span class="ident" id="2861751">nil</span>&nbsp;<span class="op" id="2861755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861759">s</span>&nbsp;<span class="op" id="2861761">=</span>&nbsp;<span class="string" id="2861763">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2861777">+</span>&nbsp;<span class="op" id="2861779">*</span><span class="ident" id="2861780">rcvr</span><span class="op" id="2861784">.</span><span class="builtintype" id="2861785">string</span>&nbsp;<span class="op" id="2861792">+</span>&nbsp;<span class="string" id="2861794">&#34;)(&#34;</span>&nbsp;<span class="op" id="2861799">+</span>&nbsp;<span class="op" id="2861801">*</span><span class="ident" id="2861802">t</span><span class="op" id="2861803">.</span><span class="builtintype" id="2861804">string</span>&nbsp;<span class="op" id="2861811">+</span>&nbsp;<span class="string" id="2861813">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861818">}</span>&nbsp;<span class="keyword" id="2861820">else</span>&nbsp;<span class="op" id="2861825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861829">s</span>&nbsp;<span class="op" id="2861831">=</span>&nbsp;<span class="string" id="2861833">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2861845">+</span>&nbsp;<span class="op" id="2861847">*</span><span class="ident" id="2861848">t</span><span class="op" id="2861849">.</span><span class="builtintype" id="2861850">string</span>&nbsp;<span class="op" id="2861857">+</span>&nbsp;<span class="string" id="2861859">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861864">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861867">x</span><span class="op" id="2861868">.</span><span class="builtintype" id="2861869">string</span>&nbsp;<span class="op" id="2861876">=</span>&nbsp;<span class="op" id="2861878">&amp;</span><span class="ident" id="2861879">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2861883">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2861919">if</span>&nbsp;<span class="ident" id="2861922">layoutCache</span><span class="op" id="2861933">.</span><span class="ident" id="2861934">m</span>&nbsp;<span class="op" id="2861936">==</span>&nbsp;<span class="ident" id="2861939">nil</span>&nbsp;<span class="op" id="2861943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861947">layoutCache</span><span class="op" id="2861958">.</span><span class="ident" id="2861959">m</span>&nbsp;<span class="op" id="2861961">=</span>&nbsp;<span class="builtinfunc" id="2861963">make</span><span class="op" id="2861967">(</span><span class="keyword" id="2861968">map</span><span class="op" id="2861971">[</span><span class="ident" id="2861972">layoutKey</span><span class="op" id="2861981">]</span><span class="ident" id="2861982">layoutType</span><span class="op" id="2861992">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2861995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2861998">layoutCache</span><span class="op" id="2862009">.</span><span class="ident" id="2862010">m</span><span class="op" id="2862011">[</span><span class="ident" id="2862012">k</span><span class="op" id="2862013">]</span>&nbsp;<span class="op" id="2862015">=</span>&nbsp;<span class="ident" id="2862017">layoutType</span><span class="op" id="2862027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862031">t</span><span class="op" id="2862032">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862042">x</span><span class="op" id="2862043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862047">argSize</span><span class="op" id="2862054">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2862058">argSize</span><span class="op" id="2862065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862069">retOffset</span><span class="op" id="2862078">:</span>&nbsp;<span class="ident" id="2862080">retOffset</span><span class="op" id="2862089">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862093">stack</span><span class="op" id="2862098">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2862104">stack</span><span class="op" id="2862109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862115">layoutCache</span><span class="op" id="2862126">.</span><span class="ident" id="2862127">Unlock</span><span class="op" id="2862133">(</span><span class="op" id="2862134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862137">return</span>&nbsp;<span class="ident" id="2862144">x</span><span class="op" id="2862145">,</span>&nbsp;<span class="ident" id="2862147">argSize</span><span class="op" id="2862154">,</span>&nbsp;<span class="ident" id="2862156">retOffset</span><span class="op" id="2862165">,</span>&nbsp;<span class="ident" id="2862167">stack</span><br>
<span class="lineno"></span><span class="op" id="2862173">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2862176">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2862252">func</span>&nbsp;<span class="ident" id="2862257">ifaceIndir</span><span class="op" id="2862267">(</span><span class="ident" id="2862268">t</span>&nbsp;<span class="op" id="2862270">*</span><span class="ident" id="2862271">rtype</span><span class="op" id="2862276">)</span>&nbsp;<span class="builtintype" id="2862278">bool</span>&nbsp;<span class="op" id="2862283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862286">return</span>&nbsp;<span class="ident" id="2862293">t</span><span class="op" id="2862294">.</span><span class="ident" id="2862295">kind</span><span class="op" id="2862299">&amp;</span><span class="ident" id="2862300">kindDirectIface</span>&nbsp;<span class="op" id="2862316">==</span>&nbsp;<span class="num" id="2862319">0</span><br>
<span class="lineno"></span><span class="op" id="2862321">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2862324">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2862375">type</span>&nbsp;<span class="ident" id="2862380">bitVector</span>&nbsp;<span class="keyword" id="2862390">struct</span>&nbsp;<span class="op" id="2862397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862400">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2862405">uint32</span>&nbsp;<span class="comment" id="2862412">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862431">data</span>&nbsp;<span class="op" id="2862436">[</span><span class="op" id="2862437">]</span><span class="builtintype" id="2862438">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2862443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2862446">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2862482">func</span>&nbsp;<span class="op" id="2862487">(</span><span class="ident" id="2862488">bv</span>&nbsp;<span class="op" id="2862491">*</span><span class="ident" id="2862492">bitVector</span><span class="op" id="2862501">)</span>&nbsp;<span class="ident" id="2862503">append2</span><span class="op" id="2862510">(</span><span class="ident" id="2862511">bits</span>&nbsp;<span class="builtintype" id="2862516">uint8</span><span class="op" id="2862521">)</span>&nbsp;<span class="op" id="2862523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2862526">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862599">if</span>&nbsp;<span class="ident" id="2862602">bv</span><span class="op" id="2862604">.</span><span class="ident" id="2862605">n</span><span class="op" id="2862606">%</span><span class="num" id="2862607">8</span>&nbsp;<span class="op" id="2862609">==</span>&nbsp;<span class="num" id="2862612">0</span>&nbsp;<span class="op" id="2862614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862618">bv</span><span class="op" id="2862620">.</span><span class="ident" id="2862621">data</span>&nbsp;<span class="op" id="2862626">=</span>&nbsp;<span class="builtinfunc" id="2862628">append</span><span class="op" id="2862634">(</span><span class="ident" id="2862635">bv</span><span class="op" id="2862637">.</span><span class="ident" id="2862638">data</span><span class="op" id="2862642">,</span>&nbsp;<span class="num" id="2862644">0</span><span class="op" id="2862645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862651">bv</span><span class="op" id="2862653">.</span><span class="ident" id="2862654">data</span><span class="op" id="2862658">[</span><span class="ident" id="2862659">bv</span><span class="op" id="2862661">.</span><span class="ident" id="2862662">n</span><span class="op" id="2862663">/</span><span class="num" id="2862664">8</span><span class="op" id="2862665">]</span>&nbsp;<span class="op" id="2862667">|=</span>&nbsp;<span class="ident" id="2862670">bits</span>&nbsp;<span class="op" id="2862675">&lt;&lt;</span>&nbsp;<span class="op" id="2862678">(</span><span class="ident" id="2862679">bv</span><span class="op" id="2862681">.</span><span class="ident" id="2862682">n</span>&nbsp;<span class="op" id="2862684">%</span>&nbsp;<span class="num" id="2862686">8</span><span class="op" id="2862687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2862690">bv</span><span class="op" id="2862692">.</span><span class="ident" id="2862693">n</span>&nbsp;<span class="op" id="2862695">+=</span>&nbsp;<span class="num" id="2862698">2</span><br>
<span class="lineno">1885</span><span class="op" id="2862700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2862703">func</span>&nbsp;<span class="ident" id="2862708">addTypeBits</span><span class="op" id="2862719">(</span><span class="ident" id="2862720">bv</span>&nbsp;<span class="op" id="2862723">*</span><span class="ident" id="2862724">bitVector</span><span class="op" id="2862733">,</span>&nbsp;<span class="ident" id="2862735">offset</span>&nbsp;<span class="op" id="2862742">*</span><span class="builtintype" id="2862743">uintptr</span><span class="op" id="2862750">,</span>&nbsp;<span class="ident" id="2862752">t</span>&nbsp;<span class="op" id="2862754">*</span><span class="ident" id="2862755">rtype</span><span class="op" id="2862760">)</span>&nbsp;<span class="op" id="2862762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862765">*</span><span class="ident" id="2862766">offset</span>&nbsp;<span class="op" id="2862773">=</span>&nbsp;<span class="ident" id="2862775">align</span><span class="op" id="2862780">(</span><span class="op" id="2862781">*</span><span class="ident" id="2862782">offset</span><span class="op" id="2862788">,</span>&nbsp;<span class="builtintype" id="2862790">uintptr</span><span class="op" id="2862797">(</span><span class="ident" id="2862798">t</span><span class="op" id="2862799">.</span><span class="ident" id="2862800">align</span><span class="op" id="2862805">)</span><span class="op" id="2862806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862809">if</span>&nbsp;<span class="ident" id="2862812">t</span><span class="op" id="2862813">.</span><span class="ident" id="2862814">kind</span><span class="op" id="2862818">&amp;</span><span class="ident" id="2862819">kindNoPointers</span>&nbsp;<span class="op" id="2862834">!=</span>&nbsp;<span class="num" id="2862837">0</span>&nbsp;<span class="op" id="2862839">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862843">*</span><span class="ident" id="2862844">offset</span>&nbsp;<span class="op" id="2862851">+=</span>&nbsp;<span class="ident" id="2862854">t</span><span class="op" id="2862855">.</span><span class="ident" id="2862856">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2862871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862875">switch</span>&nbsp;<span class="ident" id="2862882">Kind</span><span class="op" id="2862886">(</span><span class="ident" id="2862887">t</span><span class="op" id="2862888">.</span><span class="ident" id="2862889">kind</span>&nbsp;<span class="op" id="2862894">&amp;</span>&nbsp;<span class="ident" id="2862896">kindMask</span><span class="op" id="2862904">)</span>&nbsp;<span class="op" id="2862906">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2862909">case</span>&nbsp;<span class="ident" id="2862914">Chan</span><span class="op" id="2862918">,</span>&nbsp;<span class="ident" id="2862920">Func</span><span class="op" id="2862924">,</span>&nbsp;<span class="ident" id="2862926">Map</span><span class="op" id="2862929">,</span>&nbsp;<span class="ident" id="2862931">Ptr</span><span class="op" id="2862934">,</span>&nbsp;<span class="ident" id="2862936">Slice</span><span class="op" id="2862941">,</span>&nbsp;<span class="ident" id="2862943">String</span><span class="op" id="2862949">,</span>&nbsp;<span class="ident" id="2862951">UnsafePointer</span><span class="op" id="2862964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2862968">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863010">for</span>&nbsp;<span class="ident" id="2863014">bv</span><span class="op" id="2863016">.</span><span class="ident" id="2863017">n</span>&nbsp;<span class="op" id="2863019">&lt;</span>&nbsp;<span class="num" id="2863021">2</span><span class="op" id="2863022">*</span><span class="builtintype" id="2863023">uint32</span><span class="op" id="2863029">(</span><span class="op" id="2863030">*</span><span class="ident" id="2863031">offset</span><span class="op" id="2863037">/</span><span class="builtintype" id="2863038">uintptr</span><span class="op" id="2863045">(</span><span class="ident" id="2863046">ptrSize</span><span class="op" id="2863053">)</span><span class="op" id="2863054">)</span>&nbsp;<span class="op" id="2863056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863061">bv</span><span class="op" id="2863063">.</span><span class="ident" id="2863064">append2</span><span class="op" id="2863071">(</span><span class="ident" id="2863072">bitsScalar</span><span class="op" id="2863082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863086">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863090">bv</span><span class="op" id="2863092">.</span><span class="ident" id="2863093">append2</span><span class="op" id="2863100">(</span><span class="ident" id="2863101">bitsPointer</span><span class="op" id="2863112">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863116">case</span>&nbsp;<span class="ident" id="2863121">Interface</span><span class="op" id="2863130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863134">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863150">for</span>&nbsp;<span class="ident" id="2863154">bv</span><span class="op" id="2863156">.</span><span class="ident" id="2863157">n</span>&nbsp;<span class="op" id="2863159">&lt;</span>&nbsp;<span class="num" id="2863161">2</span><span class="op" id="2863162">*</span><span class="builtintype" id="2863163">uint32</span><span class="op" id="2863169">(</span><span class="op" id="2863170">*</span><span class="ident" id="2863171">offset</span><span class="op" id="2863177">/</span><span class="builtintype" id="2863178">uintptr</span><span class="op" id="2863185">(</span><span class="ident" id="2863186">ptrSize</span><span class="op" id="2863193">)</span><span class="op" id="2863194">)</span>&nbsp;<span class="op" id="2863196">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863201">bv</span><span class="op" id="2863203">.</span><span class="ident" id="2863204">append2</span><span class="op" id="2863211">(</span><span class="ident" id="2863212">bitsScalar</span><span class="op" id="2863222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863230">bv</span><span class="op" id="2863232">.</span><span class="ident" id="2863233">append2</span><span class="op" id="2863240">(</span><span class="ident" id="2863241">bitsPointer</span><span class="op" id="2863252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863256">bv</span><span class="op" id="2863258">.</span><span class="ident" id="2863259">append2</span><span class="op" id="2863266">(</span><span class="ident" id="2863267">bitsPointer</span><span class="op" id="2863278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863282">case</span>&nbsp;<span class="ident" id="2863287">Array</span><span class="op" id="2863292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863296">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863319">tt</span>&nbsp;<span class="op" id="2863322">:=</span>&nbsp;<span class="op" id="2863325">(</span><span class="op" id="2863326">*</span><span class="ident" id="2863327">arrayType</span><span class="op" id="2863336">)</span><span class="op" id="2863337">(</span><span class="ident" id="2863338">unsafe</span><span class="op" id="2863344">.</span><span class="ident" id="2863345">Pointer</span><span class="op" id="2863352">(</span><span class="ident" id="2863353">t</span><span class="op" id="2863354">)</span><span class="op" id="2863355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863359">for</span>&nbsp;<span class="ident" id="2863363">i</span>&nbsp;<span class="op" id="2863365">:=</span>&nbsp;<span class="num" id="2863368">0</span><span class="op" id="2863369">;</span>&nbsp;<span class="ident" id="2863371">i</span>&nbsp;<span class="op" id="2863373">&lt;</span>&nbsp;<span class="builtintype" id="2863375">int</span><span class="op" id="2863378">(</span><span class="ident" id="2863379">tt</span><span class="op" id="2863381">.</span><span class="builtinfunc" id="2863382">len</span><span class="op" id="2863385">)</span><span class="op" id="2863386">;</span>&nbsp;<span class="ident" id="2863388">i</span><span class="op" id="2863389">++</span>&nbsp;<span class="op" id="2863392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863397">addTypeBits</span><span class="op" id="2863408">(</span><span class="ident" id="2863409">bv</span><span class="op" id="2863411">,</span>&nbsp;<span class="ident" id="2863413">offset</span><span class="op" id="2863419">,</span>&nbsp;<span class="ident" id="2863421">tt</span><span class="op" id="2863423">.</span><span class="ident" id="2863424">elem</span><span class="op" id="2863428">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863436">case</span>&nbsp;<span class="ident" id="2863441">Struct</span><span class="op" id="2863447">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2863451">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863469">tt</span>&nbsp;<span class="op" id="2863472">:=</span>&nbsp;<span class="op" id="2863475">(</span><span class="op" id="2863476">*</span><span class="ident" id="2863477">structType</span><span class="op" id="2863487">)</span><span class="op" id="2863488">(</span><span class="ident" id="2863489">unsafe</span><span class="op" id="2863495">.</span><span class="ident" id="2863496">Pointer</span><span class="op" id="2863503">(</span><span class="ident" id="2863504">t</span><span class="op" id="2863505">)</span><span class="op" id="2863506">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863510">start</span>&nbsp;<span class="op" id="2863516">:=</span>&nbsp;<span class="op" id="2863519">*</span><span class="ident" id="2863520">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2863529">for</span>&nbsp;<span class="ident" id="2863533">i</span>&nbsp;<span class="op" id="2863535">:=</span>&nbsp;<span class="keyword" id="2863538">range</span>&nbsp;<span class="ident" id="2863544">tt</span><span class="op" id="2863546">.</span><span class="ident" id="2863547">fields</span>&nbsp;<span class="op" id="2863554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863559">f</span>&nbsp;<span class="op" id="2863561">:=</span>&nbsp;<span class="op" id="2863564">&amp;</span><span class="ident" id="2863565">tt</span><span class="op" id="2863567">.</span><span class="ident" id="2863568">fields</span><span class="op" id="2863574">[</span><span class="ident" id="2863575">i</span><span class="op" id="2863576">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863581">off</span>&nbsp;<span class="op" id="2863585">:=</span>&nbsp;<span class="ident" id="2863588">start</span>&nbsp;<span class="op" id="2863594">+</span>&nbsp;<span class="ident" id="2863596">f</span><span class="op" id="2863597">.</span><span class="ident" id="2863598">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2863608">addTypeBits</span><span class="op" id="2863619">(</span><span class="ident" id="2863620">bv</span><span class="op" id="2863622">,</span>&nbsp;<span class="op" id="2863624">&amp;</span><span class="ident" id="2863625">off</span><span class="op" id="2863628">,</span>&nbsp;<span class="ident" id="2863630">f</span><span class="op" id="2863631">.</span><span class="ident" id="2863632">typ</span><span class="op" id="2863635">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2863646">*</span><span class="ident" id="2863647">offset</span>&nbsp;<span class="op" id="2863654">+=</span>&nbsp;<span class="ident" id="2863657">t</span><span class="op" id="2863658">.</span><span class="ident" id="2863659">size</span><br>
<span class="lineno"></span><span class="op" id="2863664">}</span>
</div>
</body>
</html>
