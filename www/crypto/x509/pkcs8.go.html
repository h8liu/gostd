<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4296254">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4296309">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4296363">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4296414">package</span>&nbsp;<span class="ident" id="4296422">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4296428">import</span>&nbsp;<span class="op" id="4296435">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4296438">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4296458">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4296475">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4296485">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4296491">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4296494">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4296545">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4296605">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4296621">type</span>&nbsp;<span class="ident" id="4296626">pkcs8</span>&nbsp;<span class="keyword" id="4296632">struct</span>&nbsp;<span class="op" id="4296639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296642">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4296653">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296658">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4296669"><a href="/crypto/x509/pkcs8.go.html#4296438">pkix</a></span><span class="op" id="4296673">.</span><span class="ident" id="4296674">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296695">PrivateKey</span>&nbsp;<span class="op" id="4296706">[</span><span class="op" id="4296707">]</span><span class="builtintype" id="4296708">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4296714">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4296746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4296749">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4296820">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4296880">func</span>&nbsp;<span class="ident" id="4296885">ParsePKCS8PrivateKey</span><span class="op" id="4296905">(</span><span class="ident" id="4296906">der</span>&nbsp;<span class="op" id="4296910">[</span><span class="op" id="4296911">]</span><span class="builtintype" id="4296912">byte</span><span class="op" id="4296916">)</span>&nbsp;<span class="op" id="4296918">(</span><span class="ident" id="4296919">key</span>&nbsp;<span class="keyword" id="4296923">interface</span><span class="op" id="4296932">{</span><span class="op" id="4296933">}</span><span class="op" id="4296934">,</span>&nbsp;<span class="ident" id="4296936">err</span>&nbsp;<span class="builtintype" id="4296940">error</span><span class="op" id="4296945">)</span>&nbsp;<span class="op" id="4296947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296950">var</span>&nbsp;<span class="ident" id="4296954">privKey</span>&nbsp;<span class="ident" id="4296962"><a href="/crypto/x509/pkcs8.go.html#4296626">pkcs8</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296969">if</span>&nbsp;<span class="ident" id="4296972">_</span><span class="op" id="4296973">,</span>&nbsp;<span class="ident" id="4296975">err</span>&nbsp;<span class="op" id="4296979">:=</span>&nbsp;<span class="ident" id="4296982"><a href="/crypto/x509/pkcs8.go.html#4296458">asn1</a></span><span class="op" id="4296986">.</span><span class="ident" id="4296987">Unmarshal</span><span class="op" id="4296996">(</span><span class="ident" id="4296997"><a href="/crypto/x509/pkcs8.go.html#4296906">der</a></span><span class="op" id="4297000">,</span>&nbsp;<span class="op" id="4297002">&amp;</span><span class="ident" id="4297003"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297010">)</span><span class="op" id="4297011">;</span>&nbsp;<span class="ident" id="4297013"><a href="/crypto/x509/pkcs8.go.html#4296975">err</a></span>&nbsp;<span class="op" id="4297017">!=</span>&nbsp;<span class="ident" id="4297020">nil</span>&nbsp;<span class="op" id="4297024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297028">return</span>&nbsp;<span class="ident" id="4297035">nil</span><span class="op" id="4297038">,</span>&nbsp;<span class="ident" id="4297040"><a href="/crypto/x509/pkcs8.go.html#4296975">err</a></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297048">switch</span>&nbsp;<span class="op" id="4297055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297058">case</span>&nbsp;<span class="ident" id="4297063"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297070">.</span><span class="ident" id="4297071">Algo</span><span class="op" id="4297075">.</span><span class="ident" id="4297076">Algorithm</span><span class="op" id="4297085">.</span><span class="ident" id="4297086">Equal</span><span class="op" id="4297091">(</span><span class="ident" id="4297092"><a href="/crypto/x509/x509.go.html#4324932">oidPublicKeyRSA</a></span><span class="op" id="4297107">)</span><span class="op" id="4297108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297112"><a href="/crypto/x509/pkcs8.go.html#4296919">key</a></span><span class="op" id="4297115">,</span>&nbsp;<span class="ident" id="4297117"><a href="/crypto/x509/pkcs8.go.html#4296936">err</a></span>&nbsp;<span class="op" id="4297121">=</span>&nbsp;<span class="ident" id="4297123"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="4297143">(</span><span class="ident" id="4297144"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297151">.</span><span class="ident" id="4297152">PrivateKey</span><span class="op" id="4297162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297166">if</span>&nbsp;<span class="ident" id="4297169"><a href="/crypto/x509/pkcs8.go.html#4296936">err</a></span>&nbsp;<span class="op" id="4297173">!=</span>&nbsp;<span class="ident" id="4297176">nil</span>&nbsp;<span class="op" id="4297180">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297185">return</span>&nbsp;<span class="ident" id="4297192">nil</span><span class="op" id="4297195">,</span>&nbsp;<span class="ident" id="4297197"><a href="/crypto/x509/pkcs8.go.html#4296475">errors</a></span><span class="op" id="4297203">.</span><span class="ident" id="4297204">New</span><span class="op" id="4297207">(</span><span class="string" id="4297208">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4297269">+</span>&nbsp;<span class="ident" id="4297271"><a href="/crypto/x509/pkcs8.go.html#4296936">err</a></span><span class="op" id="4297274">.</span><span class="ident" id="4297275">Error</span><span class="op" id="4297280">(</span><span class="op" id="4297281">)</span><span class="op" id="4297282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297290">return</span>&nbsp;<span class="ident" id="4297297"><a href="/crypto/x509/pkcs8.go.html#4296919">key</a></span><span class="op" id="4297300">,</span>&nbsp;<span class="ident" id="4297302">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297308">case</span>&nbsp;<span class="ident" id="4297313"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297320">.</span><span class="ident" id="4297321">Algo</span><span class="op" id="4297325">.</span><span class="ident" id="4297326">Algorithm</span><span class="op" id="4297335">.</span><span class="ident" id="4297336">Equal</span><span class="op" id="4297341">(</span><span class="ident" id="4297342"><a href="/crypto/x509/x509.go.html#4325070">oidPublicKeyECDSA</a></span><span class="op" id="4297359">)</span><span class="op" id="4297360">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297364">bytes</span>&nbsp;<span class="op" id="4297370">:=</span>&nbsp;<span class="ident" id="4297373"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297380">.</span><span class="ident" id="4297381">Algo</span><span class="op" id="4297385">.</span><span class="ident" id="4297386">Parameters</span><span class="op" id="4297396">.</span><span class="ident" id="4297397">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297409">namedCurveOID</span>&nbsp;<span class="op" id="4297423">:=</span>&nbsp;<span class="builtinfunc" id="4297426">new</span><span class="op" id="4297429">(</span><span class="ident" id="4297430"><a href="/crypto/x509/pkcs8.go.html#4296458">asn1</a></span><span class="op" id="4297434">.</span><span class="ident" id="4297435">ObjectIdentifier</span><span class="op" id="4297451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297455">if</span>&nbsp;<span class="ident" id="4297458">_</span><span class="op" id="4297459">,</span>&nbsp;<span class="ident" id="4297461">err</span>&nbsp;<span class="op" id="4297465">:=</span>&nbsp;<span class="ident" id="4297468"><a href="/crypto/x509/pkcs8.go.html#4296458">asn1</a></span><span class="op" id="4297472">.</span><span class="ident" id="4297473">Unmarshal</span><span class="op" id="4297482">(</span><span class="ident" id="4297483"><a href="/crypto/x509/pkcs8.go.html#4297364">bytes</a></span><span class="op" id="4297488">,</span>&nbsp;<span class="ident" id="4297490"><a href="/crypto/x509/pkcs8.go.html#4297409">namedCurveOID</a></span><span class="op" id="4297503">)</span><span class="op" id="4297504">;</span>&nbsp;<span class="ident" id="4297506"><a href="/crypto/x509/pkcs8.go.html#4297461">err</a></span>&nbsp;<span class="op" id="4297510">!=</span>&nbsp;<span class="ident" id="4297513">nil</span>&nbsp;<span class="op" id="4297517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297522"><a href="/crypto/x509/pkcs8.go.html#4297409">namedCurveOID</a></span>&nbsp;<span class="op" id="4297536">=</span>&nbsp;<span class="ident" id="4297538">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297544">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297548"><a href="/crypto/x509/pkcs8.go.html#4296919">key</a></span><span class="op" id="4297551">,</span>&nbsp;<span class="ident" id="4297553"><a href="/crypto/x509/pkcs8.go.html#4296936">err</a></span>&nbsp;<span class="op" id="4297557">=</span>&nbsp;<span class="ident" id="4297559"><a href="/crypto/x509/sec1.go.html#4301690">parseECPrivateKey</a></span><span class="op" id="4297576">(</span><span class="ident" id="4297577"><a href="/crypto/x509/pkcs8.go.html#4297409">namedCurveOID</a></span><span class="op" id="4297590">,</span>&nbsp;<span class="ident" id="4297592"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297599">.</span><span class="ident" id="4297600">PrivateKey</span><span class="op" id="4297610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297614">if</span>&nbsp;<span class="ident" id="4297617"><a href="/crypto/x509/pkcs8.go.html#4296936">err</a></span>&nbsp;<span class="op" id="4297621">!=</span>&nbsp;<span class="ident" id="4297624">nil</span>&nbsp;<span class="op" id="4297628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297633">return</span>&nbsp;<span class="ident" id="4297640">nil</span><span class="op" id="4297643">,</span>&nbsp;<span class="ident" id="4297645"><a href="/crypto/x509/pkcs8.go.html#4296475">errors</a></span><span class="op" id="4297651">.</span><span class="ident" id="4297652">New</span><span class="op" id="4297655">(</span><span class="string" id="4297656">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4297716">+</span>&nbsp;<span class="ident" id="4297718"><a href="/crypto/x509/pkcs8.go.html#4296936">err</a></span><span class="op" id="4297721">.</span><span class="ident" id="4297722">Error</span><span class="op" id="4297727">(</span><span class="op" id="4297728">)</span><span class="op" id="4297729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297737">return</span>&nbsp;<span class="ident" id="4297744"><a href="/crypto/x509/pkcs8.go.html#4296919">key</a></span><span class="op" id="4297747">,</span>&nbsp;<span class="ident" id="4297749">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297755">default</span><span class="op" id="4297762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297766">return</span>&nbsp;<span class="ident" id="4297773">nil</span><span class="op" id="4297776">,</span>&nbsp;<span class="ident" id="4297778"><a href="/crypto/x509/pkcs8.go.html#4296485">fmt</a></span><span class="op" id="4297781">.</span><span class="ident" id="4297782">Errorf</span><span class="op" id="4297788">(</span><span class="string" id="4297789">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4297861">,</span>&nbsp;<span class="ident" id="4297863"><a href="/crypto/x509/pkcs8.go.html#4296954">privKey</a></span><span class="op" id="4297870">.</span><span class="ident" id="4297871">Algo</span><span class="op" id="4297875">.</span><span class="ident" id="4297876">Algorithm</span><span class="op" id="4297885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297888">}</span><br>
<span class="lineno"></span><span class="op" id="4297890">}</span>
</div>
</body>
</html>
