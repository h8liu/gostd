<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html" class="current">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2338878">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2338933">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2338987">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2339038">package</span>&nbsp;<span class="ident" id="2339046">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2339051">import</span>&nbsp;<span class="op" id="2339058">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2339061">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2339069">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2339080">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2339095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2339098">const</span>&nbsp;<span class="op" id="2339104">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339107">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339140">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339187">nByte</span>&nbsp;<span class="op" id="2339193">=</span>&nbsp;<span class="num" id="2339195">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339200">ldigits</span>&nbsp;<span class="op" id="2339208">=</span>&nbsp;<span class="string" id="2339210">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339230">udigits</span>&nbsp;<span class="op" id="2339238">=</span>&nbsp;<span class="string" id="2339240">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2339259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2339262">const</span>&nbsp;<span class="op" id="2339268">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339271">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2339280">=</span>&nbsp;<span class="builtintype" id="2339282">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339288">unsigned</span>&nbsp;<span class="op" id="2339297">=</span>&nbsp;<span class="builtintype" id="2339299">false</span><br>
<span class="lineno">25</span><span class="op" id="2339305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2339308">var</span>&nbsp;<span class="ident" id="2339312">padZeroBytes</span>&nbsp;<span class="op" id="2339325">=</span>&nbsp;<span class="builtinfunc" id="2339327">make</span><span class="op" id="2339331">(</span><span class="op" id="2339332">[</span><span class="op" id="2339333">]</span><span class="builtintype" id="2339334">byte</span><span class="op" id="2339338">,</span>&nbsp;<span class="ident" id="2339340">nByte</span><span class="op" id="2339345">)</span><br>
<span class="lineno"></span><span class="keyword" id="2339347">var</span>&nbsp;<span class="ident" id="2339351">padSpaceBytes</span>&nbsp;<span class="op" id="2339365">=</span>&nbsp;<span class="builtinfunc" id="2339367">make</span><span class="op" id="2339371">(</span><span class="op" id="2339372">[</span><span class="op" id="2339373">]</span><span class="builtintype" id="2339374">byte</span><span class="op" id="2339378">,</span>&nbsp;<span class="ident" id="2339380">nByte</span><span class="op" id="2339385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2339388">func</span>&nbsp;<span class="ident" id="2339393">init</span><span class="op" id="2339397">(</span><span class="op" id="2339398">)</span>&nbsp;<span class="op" id="2339400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2339403">for</span>&nbsp;<span class="ident" id="2339407">i</span>&nbsp;<span class="op" id="2339409">:=</span>&nbsp;<span class="num" id="2339412">0</span><span class="op" id="2339413">;</span>&nbsp;<span class="ident" id="2339415">i</span>&nbsp;<span class="op" id="2339417">&lt;</span>&nbsp;<span class="ident" id="2339419">nByte</span><span class="op" id="2339424">;</span>&nbsp;<span class="ident" id="2339426">i</span><span class="op" id="2339427">++</span>&nbsp;<span class="op" id="2339430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339434">padZeroBytes</span><span class="op" id="2339446">[</span><span class="ident" id="2339447">i</span><span class="op" id="2339448">]</span>&nbsp;<span class="op" id="2339450">=</span>&nbsp;<span class="string" id="2339452">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339458">padSpaceBytes</span><span class="op" id="2339471">[</span><span class="ident" id="2339472">i</span><span class="op" id="2339473">]</span>&nbsp;<span class="op" id="2339475">=</span>&nbsp;<span class="string" id="2339477">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2339482">}</span><br>
<span class="lineno">35</span><span class="op" id="2339484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2339487">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2339543">type</span>&nbsp;<span class="ident" id="2339548">fmtFlags</span>&nbsp;<span class="keyword" id="2339557">struct</span>&nbsp;<span class="op" id="2339564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339567">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2339579">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339585">precPresent</span>&nbsp;<span class="builtintype" id="2339597">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339603">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339615">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339621">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339633">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339639">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339651">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339657">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339669">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339675">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339687">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339693">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339705">bool</span>&nbsp;<span class="comment" id="2339710">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339751">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2339763">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339770">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339829">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2339896">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339950">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2339957">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2339963">sharpV</span>&nbsp;<span class="builtintype" id="2339970">bool</span><br>
<span class="lineno"></span><span class="op" id="2339975">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2339978">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2340028">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2340087">type</span>&nbsp;<span class="ident" id="2340092">fmt</span>&nbsp;<span class="keyword" id="2340096">struct</span>&nbsp;<span class="op" id="2340103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340106">intbuf</span>&nbsp;<span class="op" id="2340113">[</span><span class="ident" id="2340114">nByte</span><span class="op" id="2340119">]</span><span class="builtintype" id="2340120">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340126">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340133">*</span><span class="ident" id="2340134">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2340142">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340163">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2340168">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340173">prec</span>&nbsp;<span class="builtintype" id="2340178">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340183">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2340192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2340195">func</span>&nbsp;<span class="op" id="2340200">(</span><span class="ident" id="2340201">f</span>&nbsp;<span class="op" id="2340203">*</span><span class="ident" id="2340204">fmt</span><span class="op" id="2340207">)</span>&nbsp;<span class="ident" id="2340209">clearflags</span><span class="op" id="2340219">(</span><span class="op" id="2340220">)</span>&nbsp;<span class="op" id="2340222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340225">f</span><span class="op" id="2340226">.</span><span class="ident" id="2340227">fmtFlags</span>&nbsp;<span class="op" id="2340236">=</span>&nbsp;<span class="ident" id="2340238">fmtFlags</span><span class="op" id="2340246">{</span><span class="op" id="2340247">}</span><br>
<span class="lineno"></span><span class="op" id="2340249">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2340252">func</span>&nbsp;<span class="op" id="2340257">(</span><span class="ident" id="2340258">f</span>&nbsp;<span class="op" id="2340260">*</span><span class="ident" id="2340261">fmt</span><span class="op" id="2340264">)</span>&nbsp;<span class="ident" id="2340266">init</span><span class="op" id="2340270">(</span><span class="ident" id="2340271">buf</span>&nbsp;<span class="op" id="2340275">*</span><span class="ident" id="2340276">buffer</span><span class="op" id="2340282">)</span>&nbsp;<span class="op" id="2340284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340287">f</span><span class="op" id="2340288">.</span><span class="ident" id="2340289">buf</span>&nbsp;<span class="op" id="2340293">=</span>&nbsp;<span class="ident" id="2340295">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340300">f</span><span class="op" id="2340301">.</span><span class="ident" id="2340302">clearflags</span><span class="op" id="2340312">(</span><span class="op" id="2340313">)</span><br>
<span class="lineno"></span><span class="op" id="2340315">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2340318">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2340404">func</span>&nbsp;<span class="op" id="2340409">(</span><span class="ident" id="2340410">f</span>&nbsp;<span class="op" id="2340412">*</span><span class="ident" id="2340413">fmt</span><span class="op" id="2340416">)</span>&nbsp;<span class="ident" id="2340418">computePadding</span><span class="op" id="2340432">(</span><span class="ident" id="2340433">width</span>&nbsp;<span class="builtintype" id="2340439">int</span><span class="op" id="2340442">)</span>&nbsp;<span class="op" id="2340444">(</span><span class="ident" id="2340445">padding</span>&nbsp;<span class="op" id="2340453">[</span><span class="op" id="2340454">]</span><span class="builtintype" id="2340455">byte</span><span class="op" id="2340459">,</span>&nbsp;<span class="ident" id="2340461">leftWidth</span><span class="op" id="2340470">,</span>&nbsp;<span class="ident" id="2340472">rightWidth</span>&nbsp;<span class="builtintype" id="2340483">int</span><span class="op" id="2340486">)</span>&nbsp;<span class="op" id="2340488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340491">left</span>&nbsp;<span class="op" id="2340496">:=</span>&nbsp;<span class="op" id="2340499">!</span><span class="ident" id="2340500">f</span><span class="op" id="2340501">.</span><span class="ident" id="2340502">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340509">w</span>&nbsp;<span class="op" id="2340511">:=</span>&nbsp;<span class="ident" id="2340514">f</span><span class="op" id="2340515">.</span><span class="ident" id="2340516">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340521">if</span>&nbsp;<span class="ident" id="2340524">w</span>&nbsp;<span class="op" id="2340526">&lt;</span>&nbsp;<span class="num" id="2340528">0</span>&nbsp;<span class="op" id="2340530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340534">left</span>&nbsp;<span class="op" id="2340539">=</span>&nbsp;<span class="builtintype" id="2340541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340549">w</span>&nbsp;<span class="op" id="2340551">=</span>&nbsp;<span class="op" id="2340553">-</span><span class="ident" id="2340554">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340560">w</span>&nbsp;<span class="op" id="2340562">-=</span>&nbsp;<span class="ident" id="2340565">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340572">if</span>&nbsp;<span class="ident" id="2340575">w</span>&nbsp;<span class="op" id="2340577">&gt;</span>&nbsp;<span class="num" id="2340579">0</span>&nbsp;<span class="op" id="2340581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340585">if</span>&nbsp;<span class="ident" id="2340588">left</span>&nbsp;<span class="op" id="2340593">&amp;&amp;</span>&nbsp;<span class="ident" id="2340596">f</span><span class="op" id="2340597">.</span><span class="ident" id="2340598">zero</span>&nbsp;<span class="op" id="2340603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340608">return</span>&nbsp;<span class="ident" id="2340615">padZeroBytes</span><span class="op" id="2340627">,</span>&nbsp;<span class="ident" id="2340629">w</span><span class="op" id="2340630">,</span>&nbsp;<span class="num" id="2340632">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340640">if</span>&nbsp;<span class="ident" id="2340643">left</span>&nbsp;<span class="op" id="2340648">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340653">return</span>&nbsp;<span class="ident" id="2340660">padSpaceBytes</span><span class="op" id="2340673">,</span>&nbsp;<span class="ident" id="2340675">w</span><span class="op" id="2340676">,</span>&nbsp;<span class="num" id="2340678">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340682">}</span>&nbsp;<span class="keyword" id="2340684">else</span>&nbsp;<span class="op" id="2340689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2340694">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340735">return</span>&nbsp;<span class="ident" id="2340742">padSpaceBytes</span><span class="op" id="2340755">,</span>&nbsp;<span class="num" id="2340757">0</span><span class="op" id="2340758">,</span>&nbsp;<span class="ident" id="2340760">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340764">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340770">return</span><br>
<span class="lineno"></span><span class="op" id="2340777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2340780">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2340826">func</span>&nbsp;<span class="op" id="2340831">(</span><span class="ident" id="2340832">f</span>&nbsp;<span class="op" id="2340834">*</span><span class="ident" id="2340835">fmt</span><span class="op" id="2340838">)</span>&nbsp;<span class="ident" id="2340840">writePadding</span><span class="op" id="2340852">(</span><span class="ident" id="2340853">n</span>&nbsp;<span class="builtintype" id="2340855">int</span><span class="op" id="2340858">,</span>&nbsp;<span class="ident" id="2340860">padding</span>&nbsp;<span class="op" id="2340868">[</span><span class="op" id="2340869">]</span><span class="builtintype" id="2340870">byte</span><span class="op" id="2340874">)</span>&nbsp;<span class="op" id="2340876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340879">for</span>&nbsp;<span class="ident" id="2340883">n</span>&nbsp;<span class="op" id="2340885">&gt;</span>&nbsp;<span class="num" id="2340887">0</span>&nbsp;<span class="op" id="2340889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340893">m</span>&nbsp;<span class="op" id="2340895">:=</span>&nbsp;<span class="ident" id="2340898">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2340902">if</span>&nbsp;<span class="ident" id="2340905">m</span>&nbsp;<span class="op" id="2340907">&gt;</span>&nbsp;<span class="ident" id="2340909">nByte</span>&nbsp;<span class="op" id="2340915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340920">m</span>&nbsp;<span class="op" id="2340922">=</span>&nbsp;<span class="ident" id="2340924">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340936">f</span><span class="op" id="2340937">.</span><span class="ident" id="2340938">buf</span><span class="op" id="2340941">.</span><span class="ident" id="2340942">Write</span><span class="op" id="2340947">(</span><span class="ident" id="2340948">padding</span><span class="op" id="2340955">[</span><span class="num" id="2340956">0</span><span class="op" id="2340957">:</span><span class="ident" id="2340958">m</span><span class="op" id="2340959">]</span><span class="op" id="2340960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2340964">n</span>&nbsp;<span class="op" id="2340966">-=</span>&nbsp;<span class="ident" id="2340969">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2340972">}</span><br>
<span class="lineno"></span><span class="op" id="2340974">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2340977">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2341056">func</span>&nbsp;<span class="op" id="2341061">(</span><span class="ident" id="2341062">f</span>&nbsp;<span class="op" id="2341064">*</span><span class="ident" id="2341065">fmt</span><span class="op" id="2341068">)</span>&nbsp;<span class="ident" id="2341070">pad</span><span class="op" id="2341073">(</span><span class="ident" id="2341074">b</span>&nbsp;<span class="op" id="2341076">[</span><span class="op" id="2341077">]</span><span class="builtintype" id="2341078">byte</span><span class="op" id="2341082">)</span>&nbsp;<span class="op" id="2341084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341087">if</span>&nbsp;<span class="op" id="2341090">!</span><span class="ident" id="2341091">f</span><span class="op" id="2341092">.</span><span class="ident" id="2341093">widPresent</span>&nbsp;<span class="op" id="2341104">||</span>&nbsp;<span class="ident" id="2341107">f</span><span class="op" id="2341108">.</span><span class="ident" id="2341109">wid</span>&nbsp;<span class="op" id="2341113">==</span>&nbsp;<span class="num" id="2341116">0</span>&nbsp;<span class="op" id="2341118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341122">f</span><span class="op" id="2341123">.</span><span class="ident" id="2341124">buf</span><span class="op" id="2341127">.</span><span class="ident" id="2341128">Write</span><span class="op" id="2341133">(</span><span class="ident" id="2341134">b</span><span class="op" id="2341135">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341139">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341150">padding</span><span class="op" id="2341157">,</span>&nbsp;<span class="ident" id="2341159">left</span><span class="op" id="2341163">,</span>&nbsp;<span class="ident" id="2341165">right</span>&nbsp;<span class="op" id="2341171">:=</span>&nbsp;<span class="ident" id="2341174">f</span><span class="op" id="2341175">.</span><span class="ident" id="2341176">computePadding</span><span class="op" id="2341190">(</span><span class="ident" id="2341191">utf8</span><span class="op" id="2341195">.</span><span class="ident" id="2341196">RuneCount</span><span class="op" id="2341205">(</span><span class="ident" id="2341206">b</span><span class="op" id="2341207">)</span><span class="op" id="2341208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341211">if</span>&nbsp;<span class="ident" id="2341214">left</span>&nbsp;<span class="op" id="2341219">&gt;</span>&nbsp;<span class="num" id="2341221">0</span>&nbsp;<span class="op" id="2341223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341227">f</span><span class="op" id="2341228">.</span><span class="ident" id="2341229">writePadding</span><span class="op" id="2341241">(</span><span class="ident" id="2341242">left</span><span class="op" id="2341246">,</span>&nbsp;<span class="ident" id="2341248">padding</span><span class="op" id="2341255">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341261">f</span><span class="op" id="2341262">.</span><span class="ident" id="2341263">buf</span><span class="op" id="2341266">.</span><span class="ident" id="2341267">Write</span><span class="op" id="2341272">(</span><span class="ident" id="2341273">b</span><span class="op" id="2341274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341277">if</span>&nbsp;<span class="ident" id="2341280">right</span>&nbsp;<span class="op" id="2341286">&gt;</span>&nbsp;<span class="num" id="2341288">0</span>&nbsp;<span class="op" id="2341290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341294">f</span><span class="op" id="2341295">.</span><span class="ident" id="2341296">writePadding</span><span class="op" id="2341308">(</span><span class="ident" id="2341309">right</span><span class="op" id="2341314">,</span>&nbsp;<span class="ident" id="2341316">padding</span><span class="op" id="2341323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341326">}</span><br>
<span class="lineno">125</span><span class="op" id="2341328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2341331">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2341414">func</span>&nbsp;<span class="op" id="2341419">(</span><span class="ident" id="2341420">f</span>&nbsp;<span class="op" id="2341422">*</span><span class="ident" id="2341423">fmt</span><span class="op" id="2341426">)</span>&nbsp;<span class="ident" id="2341428">padString</span><span class="op" id="2341437">(</span><span class="ident" id="2341438">s</span>&nbsp;<span class="builtintype" id="2341440">string</span><span class="op" id="2341446">)</span>&nbsp;<span class="op" id="2341448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341451">if</span>&nbsp;<span class="op" id="2341454">!</span><span class="ident" id="2341455">f</span><span class="op" id="2341456">.</span><span class="ident" id="2341457">widPresent</span>&nbsp;<span class="op" id="2341468">||</span>&nbsp;<span class="ident" id="2341471">f</span><span class="op" id="2341472">.</span><span class="ident" id="2341473">wid</span>&nbsp;<span class="op" id="2341477">==</span>&nbsp;<span class="num" id="2341480">0</span>&nbsp;<span class="op" id="2341482">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341486">f</span><span class="op" id="2341487">.</span><span class="ident" id="2341488">buf</span><span class="op" id="2341491">.</span><span class="ident" id="2341492">WriteString</span><span class="op" id="2341503">(</span><span class="ident" id="2341504">s</span><span class="op" id="2341505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341509">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341520">padding</span><span class="op" id="2341527">,</span>&nbsp;<span class="ident" id="2341529">left</span><span class="op" id="2341533">,</span>&nbsp;<span class="ident" id="2341535">right</span>&nbsp;<span class="op" id="2341541">:=</span>&nbsp;<span class="ident" id="2341544">f</span><span class="op" id="2341545">.</span><span class="ident" id="2341546">computePadding</span><span class="op" id="2341560">(</span><span class="ident" id="2341561">utf8</span><span class="op" id="2341565">.</span><span class="ident" id="2341566">RuneCountInString</span><span class="op" id="2341583">(</span><span class="ident" id="2341584">s</span><span class="op" id="2341585">)</span><span class="op" id="2341586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341589">if</span>&nbsp;<span class="ident" id="2341592">left</span>&nbsp;<span class="op" id="2341597">&gt;</span>&nbsp;<span class="num" id="2341599">0</span>&nbsp;<span class="op" id="2341601">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341605">f</span><span class="op" id="2341606">.</span><span class="ident" id="2341607">writePadding</span><span class="op" id="2341619">(</span><span class="ident" id="2341620">left</span><span class="op" id="2341624">,</span>&nbsp;<span class="ident" id="2341626">padding</span><span class="op" id="2341633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341639">f</span><span class="op" id="2341640">.</span><span class="ident" id="2341641">buf</span><span class="op" id="2341644">.</span><span class="ident" id="2341645">WriteString</span><span class="op" id="2341656">(</span><span class="ident" id="2341657">s</span><span class="op" id="2341658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341661">if</span>&nbsp;<span class="ident" id="2341664">right</span>&nbsp;<span class="op" id="2341670">&gt;</span>&nbsp;<span class="num" id="2341672">0</span>&nbsp;<span class="op" id="2341674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341678">f</span><span class="op" id="2341679">.</span><span class="ident" id="2341680">writePadding</span><span class="op" id="2341692">(</span><span class="ident" id="2341693">right</span><span class="op" id="2341698">,</span>&nbsp;<span class="ident" id="2341700">padding</span><span class="op" id="2341707">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341710">}</span><br>
<span class="lineno"></span><span class="op" id="2341712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2341715">var</span>&nbsp;<span class="op" id="2341719">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341722">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2341733">=</span>&nbsp;<span class="op" id="2341735">[</span><span class="op" id="2341736">]</span><span class="builtintype" id="2341737">byte</span><span class="op" id="2341741">(</span><span class="string" id="2341742">&#34;true&#34;</span><span class="op" id="2341748">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341751">falseBytes</span>&nbsp;<span class="op" id="2341762">=</span>&nbsp;<span class="op" id="2341764">[</span><span class="op" id="2341765">]</span><span class="builtintype" id="2341766">byte</span><span class="op" id="2341770">(</span><span class="string" id="2341771">&#34;false&#34;</span><span class="op" id="2341778">)</span><br>
<span class="lineno"></span><span class="op" id="2341780">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2341783">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2341817">func</span>&nbsp;<span class="op" id="2341822">(</span><span class="ident" id="2341823">f</span>&nbsp;<span class="op" id="2341825">*</span><span class="ident" id="2341826">fmt</span><span class="op" id="2341829">)</span>&nbsp;<span class="ident" id="2341831">fmt_boolean</span><span class="op" id="2341842">(</span><span class="ident" id="2341843">v</span>&nbsp;<span class="builtintype" id="2341845">bool</span><span class="op" id="2341849">)</span>&nbsp;<span class="op" id="2341851">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2341854">if</span>&nbsp;<span class="ident" id="2341857">v</span>&nbsp;<span class="op" id="2341859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341863">f</span><span class="op" id="2341864">.</span><span class="ident" id="2341865">pad</span><span class="op" id="2341868">(</span><span class="ident" id="2341869">trueBytes</span><span class="op" id="2341878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341881">}</span>&nbsp;<span class="keyword" id="2341883">else</span>&nbsp;<span class="op" id="2341888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2341892">f</span><span class="op" id="2341893">.</span><span class="ident" id="2341894">pad</span><span class="op" id="2341897">(</span><span class="ident" id="2341898">falseBytes</span><span class="op" id="2341908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2341911">}</span><br>
<span class="lineno">155</span><span class="op" id="2341913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2341916">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2341998">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2342029">func</span>&nbsp;<span class="op" id="2342034">(</span><span class="ident" id="2342035">f</span>&nbsp;<span class="op" id="2342037">*</span><span class="ident" id="2342038">fmt</span><span class="op" id="2342041">)</span>&nbsp;<span class="ident" id="2342043">integer</span><span class="op" id="2342050">(</span><span class="ident" id="2342051">a</span>&nbsp;<span class="ident" id="2342053">int64</span><span class="op" id="2342058">,</span>&nbsp;<span class="ident" id="2342060">base</span>&nbsp;<span class="ident" id="2342065">uint64</span><span class="op" id="2342071">,</span>&nbsp;<span class="ident" id="2342073">signedness</span>&nbsp;<span class="builtintype" id="2342084">bool</span><span class="op" id="2342088">,</span>&nbsp;<span class="ident" id="2342090">digits</span>&nbsp;<span class="builtintype" id="2342097">string</span><span class="op" id="2342103">)</span>&nbsp;<span class="op" id="2342105">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342108">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342164">if</span>&nbsp;<span class="ident" id="2342167">f</span><span class="op" id="2342168">.</span><span class="ident" id="2342169">precPresent</span>&nbsp;<span class="op" id="2342181">&amp;&amp;</span>&nbsp;<span class="ident" id="2342184">f</span><span class="op" id="2342185">.</span><span class="ident" id="2342186">prec</span>&nbsp;<span class="op" id="2342191">==</span>&nbsp;<span class="num" id="2342194">0</span>&nbsp;<span class="op" id="2342196">&amp;&amp;</span>&nbsp;<span class="ident" id="2342199">a</span>&nbsp;<span class="op" id="2342201">==</span>&nbsp;<span class="num" id="2342204">0</span>&nbsp;<span class="op" id="2342206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342210">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342222">var</span>&nbsp;<span class="ident" id="2342226">buf</span>&nbsp;<span class="op" id="2342230">[</span><span class="op" id="2342231">]</span><span class="builtintype" id="2342232">byte</span>&nbsp;<span class="op" id="2342237">=</span>&nbsp;<span class="ident" id="2342239">f</span><span class="op" id="2342240">.</span><span class="ident" id="2342241">intbuf</span><span class="op" id="2342247">[</span><span class="num" id="2342248">0</span><span class="op" id="2342249">:</span><span class="op" id="2342250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342253">if</span>&nbsp;<span class="ident" id="2342256">f</span><span class="op" id="2342257">.</span><span class="ident" id="2342258">widPresent</span>&nbsp;<span class="op" id="2342269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342273">width</span>&nbsp;<span class="op" id="2342279">:=</span>&nbsp;<span class="ident" id="2342282">f</span><span class="op" id="2342283">.</span><span class="ident" id="2342284">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342290">if</span>&nbsp;<span class="ident" id="2342293">base</span>&nbsp;<span class="op" id="2342298">==</span>&nbsp;<span class="num" id="2342301">16</span>&nbsp;<span class="op" id="2342304">&amp;&amp;</span>&nbsp;<span class="ident" id="2342307">f</span><span class="op" id="2342308">.</span><span class="ident" id="2342309">sharp</span>&nbsp;<span class="op" id="2342315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342320">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342342">width</span>&nbsp;<span class="op" id="2342348">+=</span>&nbsp;<span class="num" id="2342351">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342359">if</span>&nbsp;<span class="ident" id="2342362">width</span>&nbsp;<span class="op" id="2342368">&gt;</span>&nbsp;<span class="ident" id="2342370">nByte</span>&nbsp;<span class="op" id="2342376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342381">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342422">buf</span>&nbsp;<span class="op" id="2342426">=</span>&nbsp;<span class="builtinfunc" id="2342428">make</span><span class="op" id="2342432">(</span><span class="op" id="2342433">[</span><span class="op" id="2342434">]</span><span class="builtintype" id="2342435">byte</span><span class="op" id="2342439">,</span>&nbsp;<span class="ident" id="2342441">width</span><span class="op" id="2342446">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342457">negative</span>&nbsp;<span class="op" id="2342466">:=</span>&nbsp;<span class="ident" id="2342469">signedness</span>&nbsp;<span class="op" id="2342480">==</span>&nbsp;<span class="ident" id="2342483">signed</span>&nbsp;<span class="op" id="2342490">&amp;&amp;</span>&nbsp;<span class="ident" id="2342493">a</span>&nbsp;<span class="op" id="2342495">&lt;</span>&nbsp;<span class="num" id="2342497">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342500">if</span>&nbsp;<span class="ident" id="2342503">negative</span>&nbsp;<span class="op" id="2342512">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342516">a</span>&nbsp;<span class="op" id="2342518">=</span>&nbsp;<span class="op" id="2342520">-</span><span class="ident" id="2342521">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342528">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342593">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342638">prec</span>&nbsp;<span class="op" id="2342643">:=</span>&nbsp;<span class="num" id="2342646">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342649">if</span>&nbsp;<span class="ident" id="2342652">f</span><span class="op" id="2342653">.</span><span class="ident" id="2342654">precPresent</span>&nbsp;<span class="op" id="2342666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342670">prec</span>&nbsp;<span class="op" id="2342675">=</span>&nbsp;<span class="ident" id="2342677">f</span><span class="op" id="2342678">.</span><span class="ident" id="2342679">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342686">f</span><span class="op" id="2342687">.</span><span class="ident" id="2342688">zero</span>&nbsp;<span class="op" id="2342693">=</span>&nbsp;<span class="builtintype" id="2342695">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342702">}</span>&nbsp;<span class="keyword" id="2342704">else</span>&nbsp;<span class="keyword" id="2342709">if</span>&nbsp;<span class="ident" id="2342712">f</span><span class="op" id="2342713">.</span><span class="ident" id="2342714">zero</span>&nbsp;<span class="op" id="2342719">&amp;&amp;</span>&nbsp;<span class="ident" id="2342722">f</span><span class="op" id="2342723">.</span><span class="ident" id="2342724">widPresent</span>&nbsp;<span class="op" id="2342735">&amp;&amp;</span>&nbsp;<span class="op" id="2342738">!</span><span class="ident" id="2342739">f</span><span class="op" id="2342740">.</span><span class="ident" id="2342741">minus</span>&nbsp;<span class="op" id="2342747">&amp;&amp;</span>&nbsp;<span class="ident" id="2342750">f</span><span class="op" id="2342751">.</span><span class="ident" id="2342752">wid</span>&nbsp;<span class="op" id="2342756">&gt;</span>&nbsp;<span class="num" id="2342758">0</span>&nbsp;<span class="op" id="2342760">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342764">prec</span>&nbsp;<span class="op" id="2342769">=</span>&nbsp;<span class="ident" id="2342771">f</span><span class="op" id="2342772">.</span><span class="ident" id="2342773">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2342779">if</span>&nbsp;<span class="ident" id="2342782">negative</span>&nbsp;<span class="op" id="2342791">||</span>&nbsp;<span class="ident" id="2342794">f</span><span class="op" id="2342795">.</span><span class="ident" id="2342796">plus</span>&nbsp;<span class="op" id="2342801">||</span>&nbsp;<span class="ident" id="2342804">f</span><span class="op" id="2342805">.</span><span class="ident" id="2342806">space</span>&nbsp;<span class="op" id="2342812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2342817">prec</span><span class="op" id="2342821">--</span>&nbsp;<span class="comment" id="2342824">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2342852">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342856">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342934">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2342988">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2343059">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343124">i</span>&nbsp;<span class="op" id="2343126">:=</span>&nbsp;<span class="builtinfunc" id="2343129">len</span><span class="op" id="2343132">(</span><span class="ident" id="2343133">buf</span><span class="op" id="2343136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343139">ua</span>&nbsp;<span class="op" id="2343142">:=</span>&nbsp;<span class="ident" id="2343145">uint64</span><span class="op" id="2343151">(</span><span class="ident" id="2343152">a</span><span class="op" id="2343153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2343156">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2343227">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343267">switch</span>&nbsp;<span class="ident" id="2343274">base</span>&nbsp;<span class="op" id="2343279">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343282">case</span>&nbsp;<span class="num" id="2343287">10</span><span class="op" id="2343289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343293">for</span>&nbsp;<span class="ident" id="2343297">ua</span>&nbsp;<span class="op" id="2343300">&gt;=</span>&nbsp;<span class="num" id="2343303">10</span>&nbsp;<span class="op" id="2343306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343311">i</span><span class="op" id="2343312">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343318">next</span>&nbsp;<span class="op" id="2343323">:=</span>&nbsp;<span class="ident" id="2343326">ua</span>&nbsp;<span class="op" id="2343329">/</span>&nbsp;<span class="num" id="2343331">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343337">buf</span><span class="op" id="2343340">[</span><span class="ident" id="2343341">i</span><span class="op" id="2343342">]</span>&nbsp;<span class="op" id="2343344">=</span>&nbsp;<span class="builtintype" id="2343346">byte</span><span class="op" id="2343350">(</span><span class="string" id="2343351">&#39;0&#39;</span>&nbsp;<span class="op" id="2343355">+</span>&nbsp;<span class="ident" id="2343357">ua</span>&nbsp;<span class="op" id="2343360">-</span>&nbsp;<span class="ident" id="2343362">next</span><span class="op" id="2343366">*</span><span class="num" id="2343367">10</span><span class="op" id="2343369">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343374">ua</span>&nbsp;<span class="op" id="2343377">=</span>&nbsp;<span class="ident" id="2343379">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343389">case</span>&nbsp;<span class="num" id="2343394">16</span><span class="op" id="2343396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343400">for</span>&nbsp;<span class="ident" id="2343404">ua</span>&nbsp;<span class="op" id="2343407">&gt;=</span>&nbsp;<span class="num" id="2343410">16</span>&nbsp;<span class="op" id="2343413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343418">i</span><span class="op" id="2343419">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343425">buf</span><span class="op" id="2343428">[</span><span class="ident" id="2343429">i</span><span class="op" id="2343430">]</span>&nbsp;<span class="op" id="2343432">=</span>&nbsp;<span class="ident" id="2343434">digits</span><span class="op" id="2343440">[</span><span class="ident" id="2343441">ua</span><span class="op" id="2343443">&amp;</span><span class="num" id="2343444">0xF</span><span class="op" id="2343447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343452">ua</span>&nbsp;<span class="op" id="2343455">&gt;&gt;=</span>&nbsp;<span class="num" id="2343459">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343466">case</span>&nbsp;<span class="num" id="2343471">8</span><span class="op" id="2343472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343476">for</span>&nbsp;<span class="ident" id="2343480">ua</span>&nbsp;<span class="op" id="2343483">&gt;=</span>&nbsp;<span class="num" id="2343486">8</span>&nbsp;<span class="op" id="2343488">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343493">i</span><span class="op" id="2343494">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343500">buf</span><span class="op" id="2343503">[</span><span class="ident" id="2343504">i</span><span class="op" id="2343505">]</span>&nbsp;<span class="op" id="2343507">=</span>&nbsp;<span class="builtintype" id="2343509">byte</span><span class="op" id="2343513">(</span><span class="string" id="2343514">&#39;0&#39;</span>&nbsp;<span class="op" id="2343518">+</span>&nbsp;<span class="ident" id="2343520">ua</span><span class="op" id="2343522">&amp;</span><span class="num" id="2343523">7</span><span class="op" id="2343524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343529">ua</span>&nbsp;<span class="op" id="2343532">&gt;&gt;=</span>&nbsp;<span class="num" id="2343536">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343543">case</span>&nbsp;<span class="num" id="2343548">2</span><span class="op" id="2343549">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343553">for</span>&nbsp;<span class="ident" id="2343557">ua</span>&nbsp;<span class="op" id="2343560">&gt;=</span>&nbsp;<span class="num" id="2343563">2</span>&nbsp;<span class="op" id="2343565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343570">i</span><span class="op" id="2343571">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343577">buf</span><span class="op" id="2343580">[</span><span class="ident" id="2343581">i</span><span class="op" id="2343582">]</span>&nbsp;<span class="op" id="2343584">=</span>&nbsp;<span class="builtintype" id="2343586">byte</span><span class="op" id="2343590">(</span><span class="string" id="2343591">&#39;0&#39;</span>&nbsp;<span class="op" id="2343595">+</span>&nbsp;<span class="ident" id="2343597">ua</span><span class="op" id="2343599">&amp;</span><span class="num" id="2343600">1</span><span class="op" id="2343601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343606">ua</span>&nbsp;<span class="op" id="2343609">&gt;&gt;=</span>&nbsp;<span class="num" id="2343613">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343617">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343620">default</span><span class="op" id="2343627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2343631">panic</span><span class="op" id="2343636">(</span><span class="string" id="2343637">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2343670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343676">i</span><span class="op" id="2343677">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343681">buf</span><span class="op" id="2343684">[</span><span class="ident" id="2343685">i</span><span class="op" id="2343686">]</span>&nbsp;<span class="op" id="2343688">=</span>&nbsp;<span class="ident" id="2343690">digits</span><span class="op" id="2343696">[</span><span class="ident" id="2343697">ua</span><span class="op" id="2343699">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343702">for</span>&nbsp;<span class="ident" id="2343706">i</span>&nbsp;<span class="op" id="2343708">&gt;</span>&nbsp;<span class="num" id="2343710">0</span>&nbsp;<span class="op" id="2343712">&amp;&amp;</span>&nbsp;<span class="ident" id="2343715">prec</span>&nbsp;<span class="op" id="2343720">&gt;</span>&nbsp;<span class="builtinfunc" id="2343722">len</span><span class="op" id="2343725">(</span><span class="ident" id="2343726">buf</span><span class="op" id="2343729">)</span><span class="op" id="2343730">-</span><span class="ident" id="2343731">i</span>&nbsp;<span class="op" id="2343733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343737">i</span><span class="op" id="2343738">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343743">buf</span><span class="op" id="2343746">[</span><span class="ident" id="2343747">i</span><span class="op" id="2343748">]</span>&nbsp;<span class="op" id="2343750">=</span>&nbsp;<span class="string" id="2343752">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2343761">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343795">if</span>&nbsp;<span class="ident" id="2343798">f</span><span class="op" id="2343799">.</span><span class="ident" id="2343800">sharp</span>&nbsp;<span class="op" id="2343806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343810">switch</span>&nbsp;<span class="ident" id="2343817">base</span>&nbsp;<span class="op" id="2343822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343826">case</span>&nbsp;<span class="num" id="2343831">8</span><span class="op" id="2343832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343837">if</span>&nbsp;<span class="ident" id="2343840">buf</span><span class="op" id="2343843">[</span><span class="ident" id="2343844">i</span><span class="op" id="2343845">]</span>&nbsp;<span class="op" id="2343847">!=</span>&nbsp;<span class="string" id="2343850">&#39;0&#39;</span>&nbsp;<span class="op" id="2343854">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343860">i</span><span class="op" id="2343861">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343868">buf</span><span class="op" id="2343871">[</span><span class="ident" id="2343872">i</span><span class="op" id="2343873">]</span>&nbsp;<span class="op" id="2343875">=</span>&nbsp;<span class="string" id="2343877">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343888">case</span>&nbsp;<span class="num" id="2343893">16</span><span class="op" id="2343895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343900">i</span><span class="op" id="2343901">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343907">buf</span><span class="op" id="2343910">[</span><span class="ident" id="2343911">i</span><span class="op" id="2343912">]</span>&nbsp;<span class="op" id="2343914">=</span>&nbsp;<span class="string" id="2343916">&#39;x&#39;</span>&nbsp;<span class="op" id="2343920">+</span>&nbsp;<span class="ident" id="2343922">digits</span><span class="op" id="2343928">[</span><span class="num" id="2343929">10</span><span class="op" id="2343931">]</span>&nbsp;<span class="op" id="2343933">-</span>&nbsp;<span class="string" id="2343935">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343942">i</span><span class="op" id="2343943">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343949">buf</span><span class="op" id="2343952">[</span><span class="ident" id="2343953">i</span><span class="op" id="2343954">]</span>&nbsp;<span class="op" id="2343956">=</span>&nbsp;<span class="string" id="2343958">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2343967">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2343970">if</span>&nbsp;<span class="ident" id="2343973">f</span><span class="op" id="2343974">.</span><span class="ident" id="2343975">unicode</span>&nbsp;<span class="op" id="2343983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343987">i</span><span class="op" id="2343988">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2343993">buf</span><span class="op" id="2343996">[</span><span class="ident" id="2343997">i</span><span class="op" id="2343998">]</span>&nbsp;<span class="op" id="2344000">=</span>&nbsp;<span class="string" id="2344002">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344008">i</span><span class="op" id="2344009">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344014">buf</span><span class="op" id="2344017">[</span><span class="ident" id="2344018">i</span><span class="op" id="2344019">]</span>&nbsp;<span class="op" id="2344021">=</span>&nbsp;<span class="string" id="2344023">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344032">if</span>&nbsp;<span class="ident" id="2344035">negative</span>&nbsp;<span class="op" id="2344044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344048">i</span><span class="op" id="2344049">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344054">buf</span><span class="op" id="2344057">[</span><span class="ident" id="2344058">i</span><span class="op" id="2344059">]</span>&nbsp;<span class="op" id="2344061">=</span>&nbsp;<span class="string" id="2344063">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344068">}</span>&nbsp;<span class="keyword" id="2344070">else</span>&nbsp;<span class="keyword" id="2344075">if</span>&nbsp;<span class="ident" id="2344078">f</span><span class="op" id="2344079">.</span><span class="ident" id="2344080">plus</span>&nbsp;<span class="op" id="2344085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344089">i</span><span class="op" id="2344090">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344095">buf</span><span class="op" id="2344098">[</span><span class="ident" id="2344099">i</span><span class="op" id="2344100">]</span>&nbsp;<span class="op" id="2344102">=</span>&nbsp;<span class="string" id="2344104">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344109">}</span>&nbsp;<span class="keyword" id="2344111">else</span>&nbsp;<span class="keyword" id="2344116">if</span>&nbsp;<span class="ident" id="2344119">f</span><span class="op" id="2344120">.</span><span class="ident" id="2344121">space</span>&nbsp;<span class="op" id="2344127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344131">i</span><span class="op" id="2344132">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344137">buf</span><span class="op" id="2344140">[</span><span class="ident" id="2344141">i</span><span class="op" id="2344142">]</span>&nbsp;<span class="op" id="2344144">=</span>&nbsp;<span class="string" id="2344146">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2344155">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344224">if</span>&nbsp;<span class="ident" id="2344227">f</span><span class="op" id="2344228">.</span><span class="ident" id="2344229">unicode</span>&nbsp;<span class="op" id="2344237">&amp;&amp;</span>&nbsp;<span class="ident" id="2344240">f</span><span class="op" id="2344241">.</span><span class="ident" id="2344242">uniQuote</span>&nbsp;<span class="op" id="2344251">&amp;&amp;</span>&nbsp;<span class="ident" id="2344254">a</span>&nbsp;<span class="op" id="2344256">&gt;=</span>&nbsp;<span class="num" id="2344259">0</span>&nbsp;<span class="op" id="2344261">&amp;&amp;</span>&nbsp;<span class="ident" id="2344264">a</span>&nbsp;<span class="op" id="2344266">&lt;=</span>&nbsp;<span class="ident" id="2344269">utf8</span><span class="op" id="2344273">.</span><span class="ident" id="2344274">MaxRune</span>&nbsp;<span class="op" id="2344282">&amp;&amp;</span>&nbsp;<span class="ident" id="2344285">strconv</span><span class="op" id="2344292">.</span><span class="ident" id="2344293">IsPrint</span><span class="op" id="2344300">(</span><span class="builtintype" id="2344301">rune</span><span class="op" id="2344305">(</span><span class="ident" id="2344306">a</span><span class="op" id="2344307">)</span><span class="op" id="2344308">)</span>&nbsp;<span class="op" id="2344310">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344314">runeWidth</span>&nbsp;<span class="op" id="2344324">:=</span>&nbsp;<span class="ident" id="2344327">utf8</span><span class="op" id="2344331">.</span><span class="ident" id="2344332">RuneLen</span><span class="op" id="2344339">(</span><span class="builtintype" id="2344340">rune</span><span class="op" id="2344344">(</span><span class="ident" id="2344345">a</span><span class="op" id="2344346">)</span><span class="op" id="2344347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344351">width</span>&nbsp;<span class="op" id="2344357">:=</span>&nbsp;<span class="num" id="2344360">1</span>&nbsp;<span class="op" id="2344362">+</span>&nbsp;<span class="num" id="2344364">1</span>&nbsp;<span class="op" id="2344366">+</span>&nbsp;<span class="ident" id="2344368">runeWidth</span>&nbsp;<span class="op" id="2344378">+</span>&nbsp;<span class="num" id="2344380">1</span>&nbsp;<span class="comment" id="2344382">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2344413">copy</span><span class="op" id="2344417">(</span><span class="ident" id="2344418">buf</span><span class="op" id="2344421">[</span><span class="ident" id="2344422">i</span><span class="op" id="2344423">-</span><span class="ident" id="2344424">width</span><span class="op" id="2344429">:</span><span class="op" id="2344430">]</span><span class="op" id="2344431">,</span>&nbsp;<span class="ident" id="2344433">buf</span><span class="op" id="2344436">[</span><span class="ident" id="2344437">i</span><span class="op" id="2344438">:</span><span class="op" id="2344439">]</span><span class="op" id="2344440">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2344444">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344481">i</span>&nbsp;<span class="op" id="2344483">-=</span>&nbsp;<span class="ident" id="2344486">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2344494">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344526">j</span>&nbsp;<span class="op" id="2344528">:=</span>&nbsp;<span class="builtinfunc" id="2344531">len</span><span class="op" id="2344534">(</span><span class="ident" id="2344535">buf</span><span class="op" id="2344538">)</span>&nbsp;<span class="op" id="2344540">-</span>&nbsp;<span class="ident" id="2344542">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344550">buf</span><span class="op" id="2344553">[</span><span class="ident" id="2344554">j</span><span class="op" id="2344555">]</span>&nbsp;<span class="op" id="2344557">=</span>&nbsp;<span class="string" id="2344559">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344565">j</span><span class="op" id="2344566">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344571">buf</span><span class="op" id="2344574">[</span><span class="ident" id="2344575">j</span><span class="op" id="2344576">]</span>&nbsp;<span class="op" id="2344578">=</span>&nbsp;<span class="string" id="2344580">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344587">j</span><span class="op" id="2344588">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344593">utf8</span><span class="op" id="2344597">.</span><span class="ident" id="2344598">EncodeRune</span><span class="op" id="2344608">(</span><span class="ident" id="2344609">buf</span><span class="op" id="2344612">[</span><span class="ident" id="2344613">j</span><span class="op" id="2344614">:</span><span class="op" id="2344615">]</span><span class="op" id="2344616">,</span>&nbsp;<span class="builtintype" id="2344618">rune</span><span class="op" id="2344622">(</span><span class="ident" id="2344623">a</span><span class="op" id="2344624">)</span><span class="op" id="2344625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344629">j</span>&nbsp;<span class="op" id="2344631">+=</span>&nbsp;<span class="ident" id="2344634">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344646">buf</span><span class="op" id="2344649">[</span><span class="ident" id="2344650">j</span><span class="op" id="2344651">]</span>&nbsp;<span class="op" id="2344653">=</span>&nbsp;<span class="string" id="2344655">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344665">f</span><span class="op" id="2344666">.</span><span class="ident" id="2344667">pad</span><span class="op" id="2344670">(</span><span class="ident" id="2344671">buf</span><span class="op" id="2344674">[</span><span class="ident" id="2344675">i</span><span class="op" id="2344676">:</span><span class="op" id="2344677">]</span><span class="op" id="2344678">)</span><br>
<span class="lineno"></span><span class="op" id="2344680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2344683">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2344756">func</span>&nbsp;<span class="op" id="2344761">(</span><span class="ident" id="2344762">f</span>&nbsp;<span class="op" id="2344764">*</span><span class="ident" id="2344765">fmt</span><span class="op" id="2344768">)</span>&nbsp;<span class="ident" id="2344770">truncate</span><span class="op" id="2344778">(</span><span class="ident" id="2344779">s</span>&nbsp;<span class="builtintype" id="2344781">string</span><span class="op" id="2344787">)</span>&nbsp;<span class="builtintype" id="2344789">string</span>&nbsp;<span class="op" id="2344796">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344799">if</span>&nbsp;<span class="ident" id="2344802">f</span><span class="op" id="2344803">.</span><span class="ident" id="2344804">precPresent</span>&nbsp;<span class="op" id="2344816">&amp;&amp;</span>&nbsp;<span class="ident" id="2344819">f</span><span class="op" id="2344820">.</span><span class="ident" id="2344821">prec</span>&nbsp;<span class="op" id="2344826">&lt;</span>&nbsp;<span class="ident" id="2344828">utf8</span><span class="op" id="2344832">.</span><span class="ident" id="2344833">RuneCountInString</span><span class="op" id="2344850">(</span><span class="ident" id="2344851">s</span><span class="op" id="2344852">)</span>&nbsp;<span class="op" id="2344854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344858">n</span>&nbsp;<span class="op" id="2344860">:=</span>&nbsp;<span class="ident" id="2344863">f</span><span class="op" id="2344864">.</span><span class="ident" id="2344865">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344872">for</span>&nbsp;<span class="ident" id="2344876">i</span>&nbsp;<span class="op" id="2344878">:=</span>&nbsp;<span class="keyword" id="2344881">range</span>&nbsp;<span class="ident" id="2344887">s</span>&nbsp;<span class="op" id="2344889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344894">if</span>&nbsp;<span class="ident" id="2344897">n</span>&nbsp;<span class="op" id="2344899">==</span>&nbsp;<span class="num" id="2344902">0</span>&nbsp;<span class="op" id="2344904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344910">s</span>&nbsp;<span class="op" id="2344912">=</span>&nbsp;<span class="ident" id="2344914">s</span><span class="op" id="2344915">[</span><span class="op" id="2344916">:</span><span class="ident" id="2344917">i</span><span class="op" id="2344918">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344924">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2344938">n</span><span class="op" id="2344939">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2344947">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2344950">return</span>&nbsp;<span class="ident" id="2344957">s</span><br>
<span class="lineno"></span><span class="op" id="2344959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2344962">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2344989">func</span>&nbsp;<span class="op" id="2344994">(</span><span class="ident" id="2344995">f</span>&nbsp;<span class="op" id="2344997">*</span><span class="ident" id="2344998">fmt</span><span class="op" id="2345001">)</span>&nbsp;<span class="ident" id="2345003">fmt_s</span><span class="op" id="2345008">(</span><span class="ident" id="2345009">s</span>&nbsp;<span class="builtintype" id="2345011">string</span><span class="op" id="2345017">)</span>&nbsp;<span class="op" id="2345019">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345022">s</span>&nbsp;<span class="op" id="2345024">=</span>&nbsp;<span class="ident" id="2345026">f</span><span class="op" id="2345027">.</span><span class="ident" id="2345028">truncate</span><span class="op" id="2345036">(</span><span class="ident" id="2345037">s</span><span class="op" id="2345038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345041">f</span><span class="op" id="2345042">.</span><span class="ident" id="2345043">padString</span><span class="op" id="2345052">(</span><span class="ident" id="2345053">s</span><span class="op" id="2345054">)</span><br>
<span class="lineno"></span><span class="op" id="2345056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2345059">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2345141">func</span>&nbsp;<span class="op" id="2345146">(</span><span class="ident" id="2345147">f</span>&nbsp;<span class="op" id="2345149">*</span><span class="ident" id="2345150">fmt</span><span class="op" id="2345153">)</span>&nbsp;<span class="ident" id="2345155">fmt_sbx</span><span class="op" id="2345162">(</span><span class="ident" id="2345163">s</span>&nbsp;<span class="builtintype" id="2345165">string</span><span class="op" id="2345171">,</span>&nbsp;<span class="ident" id="2345173">b</span>&nbsp;<span class="op" id="2345175">[</span><span class="op" id="2345176">]</span><span class="builtintype" id="2345177">byte</span><span class="op" id="2345181">,</span>&nbsp;<span class="ident" id="2345183">digits</span>&nbsp;<span class="builtintype" id="2345190">string</span><span class="op" id="2345196">)</span>&nbsp;<span class="op" id="2345198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345201">n</span>&nbsp;<span class="op" id="2345203">:=</span>&nbsp;<span class="builtinfunc" id="2345206">len</span><span class="op" id="2345209">(</span><span class="ident" id="2345210">b</span><span class="op" id="2345211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345214">if</span>&nbsp;<span class="ident" id="2345217">b</span>&nbsp;<span class="op" id="2345219">==</span>&nbsp;<span class="builtintype" id="2345222">nil</span>&nbsp;<span class="op" id="2345226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345230">n</span>&nbsp;<span class="op" id="2345232">=</span>&nbsp;<span class="builtinfunc" id="2345234">len</span><span class="op" id="2345237">(</span><span class="ident" id="2345238">s</span><span class="op" id="2345239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345242">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345245">x</span>&nbsp;<span class="op" id="2345247">:=</span>&nbsp;<span class="ident" id="2345250">digits</span><span class="op" id="2345256">[</span><span class="num" id="2345257">10</span><span class="op" id="2345259">]</span>&nbsp;<span class="op" id="2345261">-</span>&nbsp;<span class="string" id="2345263">&#39;a&#39;</span>&nbsp;<span class="op" id="2345267">+</span>&nbsp;<span class="string" id="2345269">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2345274">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345313">var</span>&nbsp;<span class="ident" id="2345317">buf</span>&nbsp;<span class="op" id="2345321">[</span><span class="op" id="2345322">]</span><span class="builtintype" id="2345323">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345329">for</span>&nbsp;<span class="ident" id="2345333">i</span>&nbsp;<span class="op" id="2345335">:=</span>&nbsp;<span class="num" id="2345338">0</span><span class="op" id="2345339">;</span>&nbsp;<span class="ident" id="2345341">i</span>&nbsp;<span class="op" id="2345343">&lt;</span>&nbsp;<span class="ident" id="2345345">n</span><span class="op" id="2345346">;</span>&nbsp;<span class="ident" id="2345348">i</span><span class="op" id="2345349">++</span>&nbsp;<span class="op" id="2345352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345356">if</span>&nbsp;<span class="ident" id="2345359">i</span>&nbsp;<span class="op" id="2345361">&gt;</span>&nbsp;<span class="num" id="2345363">0</span>&nbsp;<span class="op" id="2345365">&amp;&amp;</span>&nbsp;<span class="ident" id="2345368">f</span><span class="op" id="2345369">.</span><span class="ident" id="2345370">space</span>&nbsp;<span class="op" id="2345376">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345381">buf</span>&nbsp;<span class="op" id="2345385">=</span>&nbsp;<span class="builtinfunc" id="2345387">append</span><span class="op" id="2345393">(</span><span class="ident" id="2345394">buf</span><span class="op" id="2345397">,</span>&nbsp;<span class="string" id="2345399">&#39;&nbsp;&#39;</span><span class="op" id="2345402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345410">if</span>&nbsp;<span class="ident" id="2345413">f</span><span class="op" id="2345414">.</span><span class="ident" id="2345415">sharp</span>&nbsp;<span class="op" id="2345421">&amp;&amp;</span>&nbsp;<span class="op" id="2345424">(</span><span class="ident" id="2345425">f</span><span class="op" id="2345426">.</span><span class="ident" id="2345427">space</span>&nbsp;<span class="op" id="2345433">||</span>&nbsp;<span class="ident" id="2345436">i</span>&nbsp;<span class="op" id="2345438">==</span>&nbsp;<span class="num" id="2345441">0</span><span class="op" id="2345442">)</span>&nbsp;<span class="op" id="2345444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345449">buf</span>&nbsp;<span class="op" id="2345453">=</span>&nbsp;<span class="builtinfunc" id="2345455">append</span><span class="op" id="2345461">(</span><span class="ident" id="2345462">buf</span><span class="op" id="2345465">,</span>&nbsp;<span class="string" id="2345467">&#39;0&#39;</span><span class="op" id="2345470">,</span>&nbsp;<span class="ident" id="2345472">x</span><span class="op" id="2345473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345477">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345481">var</span>&nbsp;<span class="ident" id="2345485">c</span>&nbsp;<span class="builtintype" id="2345487">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345494">if</span>&nbsp;<span class="ident" id="2345497">b</span>&nbsp;<span class="op" id="2345499">==</span>&nbsp;<span class="builtintype" id="2345502">nil</span>&nbsp;<span class="op" id="2345506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345511">c</span>&nbsp;<span class="op" id="2345513">=</span>&nbsp;<span class="ident" id="2345515">s</span><span class="op" id="2345516">[</span><span class="ident" id="2345517">i</span><span class="op" id="2345518">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345522">}</span>&nbsp;<span class="keyword" id="2345524">else</span>&nbsp;<span class="op" id="2345529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345534">c</span>&nbsp;<span class="op" id="2345536">=</span>&nbsp;<span class="ident" id="2345538">b</span><span class="op" id="2345539">[</span><span class="ident" id="2345540">i</span><span class="op" id="2345541">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345549">buf</span>&nbsp;<span class="op" id="2345553">=</span>&nbsp;<span class="builtinfunc" id="2345555">append</span><span class="op" id="2345561">(</span><span class="ident" id="2345562">buf</span><span class="op" id="2345565">,</span>&nbsp;<span class="ident" id="2345567">digits</span><span class="op" id="2345573">[</span><span class="ident" id="2345574">c</span><span class="op" id="2345575">&gt;&gt;</span><span class="num" id="2345577">4</span><span class="op" id="2345578">]</span><span class="op" id="2345579">,</span>&nbsp;<span class="ident" id="2345581">digits</span><span class="op" id="2345587">[</span><span class="ident" id="2345588">c</span><span class="op" id="2345589">&amp;</span><span class="num" id="2345590">0xF</span><span class="op" id="2345593">]</span><span class="op" id="2345594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345600">f</span><span class="op" id="2345601">.</span><span class="ident" id="2345602">pad</span><span class="op" id="2345605">(</span><span class="ident" id="2345606">buf</span><span class="op" id="2345609">)</span><br>
<span class="lineno"></span><span class="op" id="2345611">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2345614">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2345681">func</span>&nbsp;<span class="op" id="2345686">(</span><span class="ident" id="2345687">f</span>&nbsp;<span class="op" id="2345689">*</span><span class="ident" id="2345690">fmt</span><span class="op" id="2345693">)</span>&nbsp;<span class="ident" id="2345695">fmt_sx</span><span class="op" id="2345701">(</span><span class="ident" id="2345702">s</span><span class="op" id="2345703">,</span>&nbsp;<span class="ident" id="2345705">digits</span>&nbsp;<span class="builtintype" id="2345712">string</span><span class="op" id="2345718">)</span>&nbsp;<span class="op" id="2345720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345723">if</span>&nbsp;<span class="ident" id="2345726">f</span><span class="op" id="2345727">.</span><span class="ident" id="2345728">precPresent</span>&nbsp;<span class="op" id="2345740">&amp;&amp;</span>&nbsp;<span class="ident" id="2345743">f</span><span class="op" id="2345744">.</span><span class="ident" id="2345745">prec</span>&nbsp;<span class="op" id="2345750">&lt;</span>&nbsp;<span class="builtinfunc" id="2345752">len</span><span class="op" id="2345755">(</span><span class="ident" id="2345756">s</span><span class="op" id="2345757">)</span>&nbsp;<span class="op" id="2345759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345763">s</span>&nbsp;<span class="op" id="2345765">=</span>&nbsp;<span class="ident" id="2345767">s</span><span class="op" id="2345768">[</span><span class="op" id="2345769">:</span><span class="ident" id="2345770">f</span><span class="op" id="2345771">.</span><span class="ident" id="2345772">prec</span><span class="op" id="2345776">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345782">f</span><span class="op" id="2345783">.</span><span class="ident" id="2345784">fmt_sbx</span><span class="op" id="2345791">(</span><span class="ident" id="2345792">s</span><span class="op" id="2345793">,</span>&nbsp;<span class="builtintype" id="2345795">nil</span><span class="op" id="2345798">,</span>&nbsp;<span class="ident" id="2345800">digits</span><span class="op" id="2345806">)</span><br>
<span class="lineno"></span><span class="op" id="2345808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2345811">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2345882">func</span>&nbsp;<span class="op" id="2345887">(</span><span class="ident" id="2345888">f</span>&nbsp;<span class="op" id="2345890">*</span><span class="ident" id="2345891">fmt</span><span class="op" id="2345894">)</span>&nbsp;<span class="ident" id="2345896">fmt_bx</span><span class="op" id="2345902">(</span><span class="ident" id="2345903">b</span>&nbsp;<span class="op" id="2345905">[</span><span class="op" id="2345906">]</span><span class="builtintype" id="2345907">byte</span><span class="op" id="2345911">,</span>&nbsp;<span class="ident" id="2345913">digits</span>&nbsp;<span class="builtintype" id="2345920">string</span><span class="op" id="2345926">)</span>&nbsp;<span class="op" id="2345928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2345931">if</span>&nbsp;<span class="ident" id="2345934">f</span><span class="op" id="2345935">.</span><span class="ident" id="2345936">precPresent</span>&nbsp;<span class="op" id="2345948">&amp;&amp;</span>&nbsp;<span class="ident" id="2345951">f</span><span class="op" id="2345952">.</span><span class="ident" id="2345953">prec</span>&nbsp;<span class="op" id="2345958">&lt;</span>&nbsp;<span class="builtinfunc" id="2345960">len</span><span class="op" id="2345963">(</span><span class="ident" id="2345964">b</span><span class="op" id="2345965">)</span>&nbsp;<span class="op" id="2345967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345971">b</span>&nbsp;<span class="op" id="2345973">=</span>&nbsp;<span class="ident" id="2345975">b</span><span class="op" id="2345976">[</span><span class="op" id="2345977">:</span><span class="ident" id="2345978">f</span><span class="op" id="2345979">.</span><span class="ident" id="2345980">prec</span><span class="op" id="2345984">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2345987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2345990">f</span><span class="op" id="2345991">.</span><span class="ident" id="2345992">fmt_sbx</span><span class="op" id="2345999">(</span><span class="string" id="2346000">&#34;&#34;</span><span class="op" id="2346002">,</span>&nbsp;<span class="ident" id="2346004">b</span><span class="op" id="2346005">,</span>&nbsp;<span class="ident" id="2346007">digits</span><span class="op" id="2346013">)</span><br>
<span class="lineno">355</span><span class="op" id="2346015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2346018">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2346092">func</span>&nbsp;<span class="op" id="2346097">(</span><span class="ident" id="2346098">f</span>&nbsp;<span class="op" id="2346100">*</span><span class="ident" id="2346101">fmt</span><span class="op" id="2346104">)</span>&nbsp;<span class="ident" id="2346106">fmt_q</span><span class="op" id="2346111">(</span><span class="ident" id="2346112">s</span>&nbsp;<span class="builtintype" id="2346114">string</span><span class="op" id="2346120">)</span>&nbsp;<span class="op" id="2346122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346125">s</span>&nbsp;<span class="op" id="2346127">=</span>&nbsp;<span class="ident" id="2346129">f</span><span class="op" id="2346130">.</span><span class="ident" id="2346131">truncate</span><span class="op" id="2346139">(</span><span class="ident" id="2346140">s</span><span class="op" id="2346141">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346144">var</span>&nbsp;<span class="ident" id="2346148">quoted</span>&nbsp;<span class="builtintype" id="2346155">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346163">if</span>&nbsp;<span class="ident" id="2346166">f</span><span class="op" id="2346167">.</span><span class="ident" id="2346168">sharp</span>&nbsp;<span class="op" id="2346174">&amp;&amp;</span>&nbsp;<span class="ident" id="2346177">strconv</span><span class="op" id="2346184">.</span><span class="ident" id="2346185">CanBackquote</span><span class="op" id="2346197">(</span><span class="ident" id="2346198">s</span><span class="op" id="2346199">)</span>&nbsp;<span class="op" id="2346201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346205">quoted</span>&nbsp;<span class="op" id="2346212">=</span>&nbsp;<span class="string" id="2346214">&#34;`&#34;</span>&nbsp;<span class="op" id="2346218">+</span>&nbsp;<span class="ident" id="2346220">s</span>&nbsp;<span class="op" id="2346222">+</span>&nbsp;<span class="string" id="2346224">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346229">}</span>&nbsp;<span class="keyword" id="2346231">else</span>&nbsp;<span class="op" id="2346236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346240">if</span>&nbsp;<span class="ident" id="2346243">f</span><span class="op" id="2346244">.</span><span class="ident" id="2346245">plus</span>&nbsp;<span class="op" id="2346250">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346255">quoted</span>&nbsp;<span class="op" id="2346262">=</span>&nbsp;<span class="ident" id="2346264">strconv</span><span class="op" id="2346271">.</span><span class="ident" id="2346272">QuoteToASCII</span><span class="op" id="2346284">(</span><span class="ident" id="2346285">s</span><span class="op" id="2346286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346290">}</span>&nbsp;<span class="keyword" id="2346292">else</span>&nbsp;<span class="op" id="2346297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346302">quoted</span>&nbsp;<span class="op" id="2346309">=</span>&nbsp;<span class="ident" id="2346311">strconv</span><span class="op" id="2346318">.</span><span class="ident" id="2346319">Quote</span><span class="op" id="2346324">(</span><span class="ident" id="2346325">s</span><span class="op" id="2346326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346333">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346336">f</span><span class="op" id="2346337">.</span><span class="ident" id="2346338">padString</span><span class="op" id="2346347">(</span><span class="ident" id="2346348">quoted</span><span class="op" id="2346354">)</span><br>
<span class="lineno"></span><span class="op" id="2346356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2346359">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2346440">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2346506">func</span>&nbsp;<span class="op" id="2346511">(</span><span class="ident" id="2346512">f</span>&nbsp;<span class="op" id="2346514">*</span><span class="ident" id="2346515">fmt</span><span class="op" id="2346518">)</span>&nbsp;<span class="ident" id="2346520">fmt_qc</span><span class="op" id="2346526">(</span><span class="ident" id="2346527">c</span>&nbsp;<span class="ident" id="2346529">int64</span><span class="op" id="2346534">)</span>&nbsp;<span class="op" id="2346536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346539">var</span>&nbsp;<span class="ident" id="2346543">quoted</span>&nbsp;<span class="op" id="2346550">[</span><span class="op" id="2346551">]</span><span class="builtintype" id="2346552">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346558">if</span>&nbsp;<span class="ident" id="2346561">f</span><span class="op" id="2346562">.</span><span class="ident" id="2346563">plus</span>&nbsp;<span class="op" id="2346568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346572">quoted</span>&nbsp;<span class="op" id="2346579">=</span>&nbsp;<span class="ident" id="2346581">strconv</span><span class="op" id="2346588">.</span><span class="ident" id="2346589">AppendQuoteRuneToASCII</span><span class="op" id="2346611">(</span><span class="ident" id="2346612">f</span><span class="op" id="2346613">.</span><span class="ident" id="2346614">intbuf</span><span class="op" id="2346620">[</span><span class="num" id="2346621">0</span><span class="op" id="2346622">:</span><span class="num" id="2346623">0</span><span class="op" id="2346624">]</span><span class="op" id="2346625">,</span>&nbsp;<span class="builtintype" id="2346627">rune</span><span class="op" id="2346631">(</span><span class="ident" id="2346632">c</span><span class="op" id="2346633">)</span><span class="op" id="2346634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346637">}</span>&nbsp;<span class="keyword" id="2346639">else</span>&nbsp;<span class="op" id="2346644">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346648">quoted</span>&nbsp;<span class="op" id="2346655">=</span>&nbsp;<span class="ident" id="2346657">strconv</span><span class="op" id="2346664">.</span><span class="ident" id="2346665">AppendQuoteRune</span><span class="op" id="2346680">(</span><span class="ident" id="2346681">f</span><span class="op" id="2346682">.</span><span class="ident" id="2346683">intbuf</span><span class="op" id="2346689">[</span><span class="num" id="2346690">0</span><span class="op" id="2346691">:</span><span class="num" id="2346692">0</span><span class="op" id="2346693">]</span><span class="op" id="2346694">,</span>&nbsp;<span class="builtintype" id="2346696">rune</span><span class="op" id="2346700">(</span><span class="ident" id="2346701">c</span><span class="op" id="2346702">)</span><span class="op" id="2346703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2346709">f</span><span class="op" id="2346710">.</span><span class="ident" id="2346711">pad</span><span class="op" id="2346714">(</span><span class="ident" id="2346715">quoted</span><span class="op" id="2346721">)</span><br>
<span class="lineno"></span><span class="op" id="2346723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2346726">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2346745">func</span>&nbsp;<span class="ident" id="2346750">doPrec</span><span class="op" id="2346756">(</span><span class="ident" id="2346757">f</span>&nbsp;<span class="op" id="2346759">*</span><span class="ident" id="2346760">fmt</span><span class="op" id="2346763">,</span>&nbsp;<span class="ident" id="2346765">def</span>&nbsp;<span class="builtintype" id="2346769">int</span><span class="op" id="2346772">)</span>&nbsp;<span class="builtintype" id="2346774">int</span>&nbsp;<span class="op" id="2346778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346781">if</span>&nbsp;<span class="ident" id="2346784">f</span><span class="op" id="2346785">.</span><span class="ident" id="2346786">precPresent</span>&nbsp;<span class="op" id="2346798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346802">return</span>&nbsp;<span class="ident" id="2346809">f</span><span class="op" id="2346810">.</span><span class="ident" id="2346811">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2346817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2346820">return</span>&nbsp;<span class="ident" id="2346827">def</span><br>
<span class="lineno"></span><span class="op" id="2346831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2346834">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2346935">func</span>&nbsp;<span class="op" id="2346940">(</span><span class="ident" id="2346941">f</span>&nbsp;<span class="op" id="2346943">*</span><span class="ident" id="2346944">fmt</span><span class="op" id="2346947">)</span>&nbsp;<span class="ident" id="2346949">formatFloat</span><span class="op" id="2346960">(</span><span class="ident" id="2346961">v</span>&nbsp;<span class="builtintype" id="2346963">float64</span><span class="op" id="2346970">,</span>&nbsp;<span class="ident" id="2346972">verb</span>&nbsp;<span class="builtintype" id="2346977">byte</span><span class="op" id="2346981">,</span>&nbsp;<span class="ident" id="2346983">prec</span><span class="op" id="2346987">,</span>&nbsp;<span class="ident" id="2346989">n</span>&nbsp;<span class="builtintype" id="2346991">int</span><span class="op" id="2346994">)</span>&nbsp;<span class="op" id="2346996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2346999">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347064">num</span>&nbsp;<span class="op" id="2347068">:=</span>&nbsp;<span class="ident" id="2347071">strconv</span><span class="op" id="2347078">.</span><span class="ident" id="2347079">AppendFloat</span><span class="op" id="2347090">(</span><span class="ident" id="2347091">f</span><span class="op" id="2347092">.</span><span class="ident" id="2347093">intbuf</span><span class="op" id="2347099">[</span><span class="num" id="2347100">0</span><span class="op" id="2347101">:</span><span class="num" id="2347102">1</span><span class="op" id="2347103">]</span><span class="op" id="2347104">,</span>&nbsp;<span class="ident" id="2347106">v</span><span class="op" id="2347107">,</span>&nbsp;<span class="ident" id="2347109">verb</span><span class="op" id="2347113">,</span>&nbsp;<span class="ident" id="2347115">prec</span><span class="op" id="2347119">,</span>&nbsp;<span class="ident" id="2347121">n</span><span class="op" id="2347122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347125">if</span>&nbsp;<span class="ident" id="2347128">num</span><span class="op" id="2347131">[</span><span class="num" id="2347132">1</span><span class="op" id="2347133">]</span>&nbsp;<span class="op" id="2347135">==</span>&nbsp;<span class="string" id="2347138">&#39;-&#39;</span>&nbsp;<span class="op" id="2347142">||</span>&nbsp;<span class="ident" id="2347145">num</span><span class="op" id="2347148">[</span><span class="num" id="2347149">1</span><span class="op" id="2347150">]</span>&nbsp;<span class="op" id="2347152">==</span>&nbsp;<span class="string" id="2347155">&#39;+&#39;</span>&nbsp;<span class="op" id="2347159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347163">num</span>&nbsp;<span class="op" id="2347167">=</span>&nbsp;<span class="ident" id="2347169">num</span><span class="op" id="2347172">[</span><span class="num" id="2347173">1</span><span class="op" id="2347174">:</span><span class="op" id="2347175">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347178">}</span>&nbsp;<span class="keyword" id="2347180">else</span>&nbsp;<span class="op" id="2347185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347189">num</span><span class="op" id="2347192">[</span><span class="num" id="2347193">0</span><span class="op" id="2347194">]</span>&nbsp;<span class="op" id="2347196">=</span>&nbsp;<span class="string" id="2347198">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347206">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347309">if</span>&nbsp;<span class="ident" id="2347312">math</span><span class="op" id="2347316">.</span><span class="ident" id="2347317">IsInf</span><span class="op" id="2347322">(</span><span class="ident" id="2347323">v</span><span class="op" id="2347324">,</span>&nbsp;<span class="num" id="2347326">0</span><span class="op" id="2347327">)</span>&nbsp;<span class="op" id="2347329">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347333">if</span>&nbsp;<span class="ident" id="2347336">f</span><span class="op" id="2347337">.</span><span class="ident" id="2347338">zero</span>&nbsp;<span class="op" id="2347343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347348">defer</span>&nbsp;<span class="keyword" id="2347354">func</span><span class="op" id="2347358">(</span><span class="op" id="2347359">)</span>&nbsp;<span class="op" id="2347361">{</span>&nbsp;<span class="ident" id="2347363">f</span><span class="op" id="2347364">.</span><span class="ident" id="2347365">zero</span>&nbsp;<span class="op" id="2347370">=</span>&nbsp;<span class="builtintype" id="2347372">true</span>&nbsp;<span class="op" id="2347377">}</span><span class="op" id="2347378">(</span><span class="op" id="2347379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347384">f</span><span class="op" id="2347385">.</span><span class="ident" id="2347386">zero</span>&nbsp;<span class="op" id="2347391">=</span>&nbsp;<span class="builtintype" id="2347393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347404">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347407">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347454">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347521">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347600">if</span>&nbsp;<span class="ident" id="2347603">f</span><span class="op" id="2347604">.</span><span class="ident" id="2347605">zero</span>&nbsp;<span class="op" id="2347610">&amp;&amp;</span>&nbsp;<span class="ident" id="2347613">f</span><span class="op" id="2347614">.</span><span class="ident" id="2347615">widPresent</span>&nbsp;<span class="op" id="2347626">&amp;&amp;</span>&nbsp;<span class="ident" id="2347629">f</span><span class="op" id="2347630">.</span><span class="ident" id="2347631">wid</span>&nbsp;<span class="op" id="2347635">&gt;</span>&nbsp;<span class="builtinfunc" id="2347637">len</span><span class="op" id="2347640">(</span><span class="ident" id="2347641">num</span><span class="op" id="2347644">)</span>&nbsp;<span class="op" id="2347646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347650">if</span>&nbsp;<span class="ident" id="2347653">f</span><span class="op" id="2347654">.</span><span class="ident" id="2347655">space</span>&nbsp;<span class="op" id="2347661">&amp;&amp;</span>&nbsp;<span class="ident" id="2347664">v</span>&nbsp;<span class="op" id="2347666">&gt;=</span>&nbsp;<span class="num" id="2347669">0</span>&nbsp;<span class="op" id="2347671">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347676">f</span><span class="op" id="2347677">.</span><span class="ident" id="2347678">buf</span><span class="op" id="2347681">.</span><span class="ident" id="2347682">WriteByte</span><span class="op" id="2347691">(</span><span class="string" id="2347692">&#39;&nbsp;&#39;</span><span class="op" id="2347695">)</span>&nbsp;<span class="comment" id="2347697">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347761">f</span><span class="op" id="2347762">.</span><span class="ident" id="2347763">wid</span><span class="op" id="2347766">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347771">}</span>&nbsp;<span class="keyword" id="2347773">else</span>&nbsp;<span class="keyword" id="2347778">if</span>&nbsp;<span class="ident" id="2347781">f</span><span class="op" id="2347782">.</span><span class="ident" id="2347783">plus</span>&nbsp;<span class="op" id="2347788">||</span>&nbsp;<span class="ident" id="2347791">v</span>&nbsp;<span class="op" id="2347793">&lt;</span>&nbsp;<span class="num" id="2347795">0</span>&nbsp;<span class="op" id="2347797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347802">f</span><span class="op" id="2347803">.</span><span class="ident" id="2347804">buf</span><span class="op" id="2347807">.</span><span class="ident" id="2347808">WriteByte</span><span class="op" id="2347817">(</span><span class="ident" id="2347818">num</span><span class="op" id="2347821">[</span><span class="num" id="2347822">0</span><span class="op" id="2347823">]</span><span class="op" id="2347824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347829">f</span><span class="op" id="2347830">.</span><span class="ident" id="2347831">wid</span><span class="op" id="2347834">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347843">f</span><span class="op" id="2347844">.</span><span class="ident" id="2347845">pad</span><span class="op" id="2347848">(</span><span class="ident" id="2347849">num</span><span class="op" id="2347852">[</span><span class="num" id="2347853">1</span><span class="op" id="2347854">:</span><span class="op" id="2347855">]</span><span class="op" id="2347856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347860">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347871">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347925">if</span>&nbsp;<span class="ident" id="2347928">f</span><span class="op" id="2347929">.</span><span class="ident" id="2347930">space</span>&nbsp;<span class="op" id="2347936">&amp;&amp;</span>&nbsp;<span class="ident" id="2347939">num</span><span class="op" id="2347942">[</span><span class="num" id="2347943">0</span><span class="op" id="2347944">]</span>&nbsp;<span class="op" id="2347946">==</span>&nbsp;<span class="string" id="2347949">&#39;+&#39;</span>&nbsp;<span class="op" id="2347953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347957">num</span><span class="op" id="2347960">[</span><span class="num" id="2347961">0</span><span class="op" id="2347962">]</span>&nbsp;<span class="op" id="2347964">=</span>&nbsp;<span class="string" id="2347966">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2347972">f</span><span class="op" id="2347973">.</span><span class="ident" id="2347974">pad</span><span class="op" id="2347977">(</span><span class="ident" id="2347978">num</span><span class="op" id="2347981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2347985">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2347993">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2347996">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2348076">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348164">if</span>&nbsp;<span class="ident" id="2348167">f</span><span class="op" id="2348168">.</span><span class="ident" id="2348169">plus</span>&nbsp;<span class="op" id="2348174">||</span>&nbsp;<span class="ident" id="2348177">num</span><span class="op" id="2348180">[</span><span class="num" id="2348181">0</span><span class="op" id="2348182">]</span>&nbsp;<span class="op" id="2348184">==</span>&nbsp;<span class="string" id="2348187">&#39;-&#39;</span>&nbsp;<span class="op" id="2348191">||</span>&nbsp;<span class="ident" id="2348194">math</span><span class="op" id="2348198">.</span><span class="ident" id="2348199">IsInf</span><span class="op" id="2348204">(</span><span class="ident" id="2348205">v</span><span class="op" id="2348206">,</span>&nbsp;<span class="num" id="2348208">0</span><span class="op" id="2348209">)</span>&nbsp;<span class="op" id="2348211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348215">f</span><span class="op" id="2348216">.</span><span class="ident" id="2348217">pad</span><span class="op" id="2348220">(</span><span class="ident" id="2348221">num</span><span class="op" id="2348224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2348228">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2348236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2348239">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2348319">f</span><span class="op" id="2348320">.</span><span class="ident" id="2348321">pad</span><span class="op" id="2348324">(</span><span class="ident" id="2348325">num</span><span class="op" id="2348328">[</span><span class="num" id="2348329">1</span><span class="op" id="2348330">:</span><span class="op" id="2348331">]</span><span class="op" id="2348332">)</span><br>
<span class="lineno"></span><span class="op" id="2348334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2348337">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2348389">func</span>&nbsp;<span class="op" id="2348394">(</span><span class="ident" id="2348395">f</span>&nbsp;<span class="op" id="2348397">*</span><span class="ident" id="2348398">fmt</span><span class="op" id="2348401">)</span>&nbsp;<span class="ident" id="2348403">fmt_e64</span><span class="op" id="2348410">(</span><span class="ident" id="2348411">v</span>&nbsp;<span class="builtintype" id="2348413">float64</span><span class="op" id="2348420">)</span>&nbsp;<span class="op" id="2348422">{</span>&nbsp;<span class="ident" id="2348424">f</span><span class="op" id="2348425">.</span><span class="ident" id="2348426">formatFloat</span><span class="op" id="2348437">(</span><span class="ident" id="2348438">v</span><span class="op" id="2348439">,</span>&nbsp;<span class="string" id="2348441">&#39;e&#39;</span><span class="op" id="2348444">,</span>&nbsp;<span class="ident" id="2348446">doPrec</span><span class="op" id="2348452">(</span><span class="ident" id="2348453">f</span><span class="op" id="2348454">,</span>&nbsp;<span class="num" id="2348456">6</span><span class="op" id="2348457">)</span><span class="op" id="2348458">,</span>&nbsp;<span class="num" id="2348460">64</span><span class="op" id="2348462">)</span>&nbsp;<span class="op" id="2348464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2348467">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2348519">func</span>&nbsp;<span class="op" id="2348524">(</span><span class="ident" id="2348525">f</span>&nbsp;<span class="op" id="2348527">*</span><span class="ident" id="2348528">fmt</span><span class="op" id="2348531">)</span>&nbsp;<span class="ident" id="2348533">fmt_E64</span><span class="op" id="2348540">(</span><span class="ident" id="2348541">v</span>&nbsp;<span class="builtintype" id="2348543">float64</span><span class="op" id="2348550">)</span>&nbsp;<span class="op" id="2348552">{</span>&nbsp;<span class="ident" id="2348554">f</span><span class="op" id="2348555">.</span><span class="ident" id="2348556">formatFloat</span><span class="op" id="2348567">(</span><span class="ident" id="2348568">v</span><span class="op" id="2348569">,</span>&nbsp;<span class="string" id="2348571">&#39;E&#39;</span><span class="op" id="2348574">,</span>&nbsp;<span class="ident" id="2348576">doPrec</span><span class="op" id="2348582">(</span><span class="ident" id="2348583">f</span><span class="op" id="2348584">,</span>&nbsp;<span class="num" id="2348586">6</span><span class="op" id="2348587">)</span><span class="op" id="2348588">,</span>&nbsp;<span class="num" id="2348590">64</span><span class="op" id="2348592">)</span>&nbsp;<span class="op" id="2348594">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2348597">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2348645">func</span>&nbsp;<span class="op" id="2348650">(</span><span class="ident" id="2348651">f</span>&nbsp;<span class="op" id="2348653">*</span><span class="ident" id="2348654">fmt</span><span class="op" id="2348657">)</span>&nbsp;<span class="ident" id="2348659">fmt_f64</span><span class="op" id="2348666">(</span><span class="ident" id="2348667">v</span>&nbsp;<span class="builtintype" id="2348669">float64</span><span class="op" id="2348676">)</span>&nbsp;<span class="op" id="2348678">{</span>&nbsp;<span class="ident" id="2348680">f</span><span class="op" id="2348681">.</span><span class="ident" id="2348682">formatFloat</span><span class="op" id="2348693">(</span><span class="ident" id="2348694">v</span><span class="op" id="2348695">,</span>&nbsp;<span class="string" id="2348697">&#39;f&#39;</span><span class="op" id="2348700">,</span>&nbsp;<span class="ident" id="2348702">doPrec</span><span class="op" id="2348708">(</span><span class="ident" id="2348709">f</span><span class="op" id="2348710">,</span>&nbsp;<span class="num" id="2348712">6</span><span class="op" id="2348713">)</span><span class="op" id="2348714">,</span>&nbsp;<span class="num" id="2348716">64</span><span class="op" id="2348718">)</span>&nbsp;<span class="op" id="2348720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2348723">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2348794">func</span>&nbsp;<span class="op" id="2348799">(</span><span class="ident" id="2348800">f</span>&nbsp;<span class="op" id="2348802">*</span><span class="ident" id="2348803">fmt</span><span class="op" id="2348806">)</span>&nbsp;<span class="ident" id="2348808">fmt_g64</span><span class="op" id="2348815">(</span><span class="ident" id="2348816">v</span>&nbsp;<span class="builtintype" id="2348818">float64</span><span class="op" id="2348825">)</span>&nbsp;<span class="op" id="2348827">{</span>&nbsp;<span class="ident" id="2348829">f</span><span class="op" id="2348830">.</span><span class="ident" id="2348831">formatFloat</span><span class="op" id="2348842">(</span><span class="ident" id="2348843">v</span><span class="op" id="2348844">,</span>&nbsp;<span class="string" id="2348846">&#39;g&#39;</span><span class="op" id="2348849">,</span>&nbsp;<span class="ident" id="2348851">doPrec</span><span class="op" id="2348857">(</span><span class="ident" id="2348858">f</span><span class="op" id="2348859">,</span>&nbsp;<span class="op" id="2348861">-</span><span class="num" id="2348862">1</span><span class="op" id="2348863">)</span><span class="op" id="2348864">,</span>&nbsp;<span class="num" id="2348866">64</span><span class="op" id="2348868">)</span>&nbsp;<span class="op" id="2348870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2348873">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2348944">func</span>&nbsp;<span class="op" id="2348949">(</span><span class="ident" id="2348950">f</span>&nbsp;<span class="op" id="2348952">*</span><span class="ident" id="2348953">fmt</span><span class="op" id="2348956">)</span>&nbsp;<span class="ident" id="2348958">fmt_G64</span><span class="op" id="2348965">(</span><span class="ident" id="2348966">v</span>&nbsp;<span class="builtintype" id="2348968">float64</span><span class="op" id="2348975">)</span>&nbsp;<span class="op" id="2348977">{</span>&nbsp;<span class="ident" id="2348979">f</span><span class="op" id="2348980">.</span><span class="ident" id="2348981">formatFloat</span><span class="op" id="2348992">(</span><span class="ident" id="2348993">v</span><span class="op" id="2348994">,</span>&nbsp;<span class="string" id="2348996">&#39;G&#39;</span><span class="op" id="2348999">,</span>&nbsp;<span class="ident" id="2349001">doPrec</span><span class="op" id="2349007">(</span><span class="ident" id="2349008">f</span><span class="op" id="2349009">,</span>&nbsp;<span class="op" id="2349011">-</span><span class="num" id="2349012">1</span><span class="op" id="2349013">)</span><span class="op" id="2349014">,</span>&nbsp;<span class="num" id="2349016">64</span><span class="op" id="2349018">)</span>&nbsp;<span class="op" id="2349020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2349023">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2349098">func</span>&nbsp;<span class="op" id="2349103">(</span><span class="ident" id="2349104">f</span>&nbsp;<span class="op" id="2349106">*</span><span class="ident" id="2349107">fmt</span><span class="op" id="2349110">)</span>&nbsp;<span class="ident" id="2349112">fmt_fb64</span><span class="op" id="2349120">(</span><span class="ident" id="2349121">v</span>&nbsp;<span class="builtintype" id="2349123">float64</span><span class="op" id="2349130">)</span>&nbsp;<span class="op" id="2349132">{</span>&nbsp;<span class="ident" id="2349134">f</span><span class="op" id="2349135">.</span><span class="ident" id="2349136">formatFloat</span><span class="op" id="2349147">(</span><span class="ident" id="2349148">v</span><span class="op" id="2349149">,</span>&nbsp;<span class="string" id="2349151">&#39;b&#39;</span><span class="op" id="2349154">,</span>&nbsp;<span class="num" id="2349156">0</span><span class="op" id="2349157">,</span>&nbsp;<span class="num" id="2349159">64</span><span class="op" id="2349161">)</span>&nbsp;<span class="op" id="2349163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2349166">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2349177">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2349213">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2349269">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2349321">func</span>&nbsp;<span class="op" id="2349326">(</span><span class="ident" id="2349327">f</span>&nbsp;<span class="op" id="2349329">*</span><span class="ident" id="2349330">fmt</span><span class="op" id="2349333">)</span>&nbsp;<span class="ident" id="2349335">fmt_e32</span><span class="op" id="2349342">(</span><span class="ident" id="2349343">v</span>&nbsp;<span class="builtintype" id="2349345">float32</span><span class="op" id="2349352">)</span>&nbsp;<span class="op" id="2349354">{</span>&nbsp;<span class="ident" id="2349356">f</span><span class="op" id="2349357">.</span><span class="ident" id="2349358">formatFloat</span><span class="op" id="2349369">(</span><span class="builtintype" id="2349370">float64</span><span class="op" id="2349377">(</span><span class="ident" id="2349378">v</span><span class="op" id="2349379">)</span><span class="op" id="2349380">,</span>&nbsp;<span class="string" id="2349382">&#39;e&#39;</span><span class="op" id="2349385">,</span>&nbsp;<span class="ident" id="2349387">doPrec</span><span class="op" id="2349393">(</span><span class="ident" id="2349394">f</span><span class="op" id="2349395">,</span>&nbsp;<span class="num" id="2349397">6</span><span class="op" id="2349398">)</span><span class="op" id="2349399">,</span>&nbsp;<span class="num" id="2349401">32</span><span class="op" id="2349403">)</span>&nbsp;<span class="op" id="2349405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2349408">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2349460">func</span>&nbsp;<span class="op" id="2349465">(</span><span class="ident" id="2349466">f</span>&nbsp;<span class="op" id="2349468">*</span><span class="ident" id="2349469">fmt</span><span class="op" id="2349472">)</span>&nbsp;<span class="ident" id="2349474">fmt_E32</span><span class="op" id="2349481">(</span><span class="ident" id="2349482">v</span>&nbsp;<span class="builtintype" id="2349484">float32</span><span class="op" id="2349491">)</span>&nbsp;<span class="op" id="2349493">{</span>&nbsp;<span class="ident" id="2349495">f</span><span class="op" id="2349496">.</span><span class="ident" id="2349497">formatFloat</span><span class="op" id="2349508">(</span><span class="builtintype" id="2349509">float64</span><span class="op" id="2349516">(</span><span class="ident" id="2349517">v</span><span class="op" id="2349518">)</span><span class="op" id="2349519">,</span>&nbsp;<span class="string" id="2349521">&#39;E&#39;</span><span class="op" id="2349524">,</span>&nbsp;<span class="ident" id="2349526">doPrec</span><span class="op" id="2349532">(</span><span class="ident" id="2349533">f</span><span class="op" id="2349534">,</span>&nbsp;<span class="num" id="2349536">6</span><span class="op" id="2349537">)</span><span class="op" id="2349538">,</span>&nbsp;<span class="num" id="2349540">32</span><span class="op" id="2349542">)</span>&nbsp;<span class="op" id="2349544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2349547">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2349595">func</span>&nbsp;<span class="op" id="2349600">(</span><span class="ident" id="2349601">f</span>&nbsp;<span class="op" id="2349603">*</span><span class="ident" id="2349604">fmt</span><span class="op" id="2349607">)</span>&nbsp;<span class="ident" id="2349609">fmt_f32</span><span class="op" id="2349616">(</span><span class="ident" id="2349617">v</span>&nbsp;<span class="builtintype" id="2349619">float32</span><span class="op" id="2349626">)</span>&nbsp;<span class="op" id="2349628">{</span>&nbsp;<span class="ident" id="2349630">f</span><span class="op" id="2349631">.</span><span class="ident" id="2349632">formatFloat</span><span class="op" id="2349643">(</span><span class="builtintype" id="2349644">float64</span><span class="op" id="2349651">(</span><span class="ident" id="2349652">v</span><span class="op" id="2349653">)</span><span class="op" id="2349654">,</span>&nbsp;<span class="string" id="2349656">&#39;f&#39;</span><span class="op" id="2349659">,</span>&nbsp;<span class="ident" id="2349661">doPrec</span><span class="op" id="2349667">(</span><span class="ident" id="2349668">f</span><span class="op" id="2349669">,</span>&nbsp;<span class="num" id="2349671">6</span><span class="op" id="2349672">)</span><span class="op" id="2349673">,</span>&nbsp;<span class="num" id="2349675">32</span><span class="op" id="2349677">)</span>&nbsp;<span class="op" id="2349679">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2349682">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2349753">func</span>&nbsp;<span class="op" id="2349758">(</span><span class="ident" id="2349759">f</span>&nbsp;<span class="op" id="2349761">*</span><span class="ident" id="2349762">fmt</span><span class="op" id="2349765">)</span>&nbsp;<span class="ident" id="2349767">fmt_g32</span><span class="op" id="2349774">(</span><span class="ident" id="2349775">v</span>&nbsp;<span class="builtintype" id="2349777">float32</span><span class="op" id="2349784">)</span>&nbsp;<span class="op" id="2349786">{</span>&nbsp;<span class="ident" id="2349788">f</span><span class="op" id="2349789">.</span><span class="ident" id="2349790">formatFloat</span><span class="op" id="2349801">(</span><span class="builtintype" id="2349802">float64</span><span class="op" id="2349809">(</span><span class="ident" id="2349810">v</span><span class="op" id="2349811">)</span><span class="op" id="2349812">,</span>&nbsp;<span class="string" id="2349814">&#39;g&#39;</span><span class="op" id="2349817">,</span>&nbsp;<span class="ident" id="2349819">doPrec</span><span class="op" id="2349825">(</span><span class="ident" id="2349826">f</span><span class="op" id="2349827">,</span>&nbsp;<span class="op" id="2349829">-</span><span class="num" id="2349830">1</span><span class="op" id="2349831">)</span><span class="op" id="2349832">,</span>&nbsp;<span class="num" id="2349834">32</span><span class="op" id="2349836">)</span>&nbsp;<span class="op" id="2349838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2349841">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2349912">func</span>&nbsp;<span class="op" id="2349917">(</span><span class="ident" id="2349918">f</span>&nbsp;<span class="op" id="2349920">*</span><span class="ident" id="2349921">fmt</span><span class="op" id="2349924">)</span>&nbsp;<span class="ident" id="2349926">fmt_G32</span><span class="op" id="2349933">(</span><span class="ident" id="2349934">v</span>&nbsp;<span class="builtintype" id="2349936">float32</span><span class="op" id="2349943">)</span>&nbsp;<span class="op" id="2349945">{</span>&nbsp;<span class="ident" id="2349947">f</span><span class="op" id="2349948">.</span><span class="ident" id="2349949">formatFloat</span><span class="op" id="2349960">(</span><span class="builtintype" id="2349961">float64</span><span class="op" id="2349968">(</span><span class="ident" id="2349969">v</span><span class="op" id="2349970">)</span><span class="op" id="2349971">,</span>&nbsp;<span class="string" id="2349973">&#39;G&#39;</span><span class="op" id="2349976">,</span>&nbsp;<span class="ident" id="2349978">doPrec</span><span class="op" id="2349984">(</span><span class="ident" id="2349985">f</span><span class="op" id="2349986">,</span>&nbsp;<span class="op" id="2349988">-</span><span class="num" id="2349989">1</span><span class="op" id="2349990">)</span><span class="op" id="2349991">,</span>&nbsp;<span class="num" id="2349993">32</span><span class="op" id="2349995">)</span>&nbsp;<span class="op" id="2349997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2350000">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2350075">func</span>&nbsp;<span class="op" id="2350080">(</span><span class="ident" id="2350081">f</span>&nbsp;<span class="op" id="2350083">*</span><span class="ident" id="2350084">fmt</span><span class="op" id="2350087">)</span>&nbsp;<span class="ident" id="2350089">fmt_fb32</span><span class="op" id="2350097">(</span><span class="ident" id="2350098">v</span>&nbsp;<span class="builtintype" id="2350100">float32</span><span class="op" id="2350107">)</span>&nbsp;<span class="op" id="2350109">{</span>&nbsp;<span class="ident" id="2350111">f</span><span class="op" id="2350112">.</span><span class="ident" id="2350113">formatFloat</span><span class="op" id="2350124">(</span><span class="builtintype" id="2350125">float64</span><span class="op" id="2350132">(</span><span class="ident" id="2350133">v</span><span class="op" id="2350134">)</span><span class="op" id="2350135">,</span>&nbsp;<span class="string" id="2350137">&#39;b&#39;</span><span class="op" id="2350140">,</span>&nbsp;<span class="num" id="2350142">0</span><span class="op" id="2350143">,</span>&nbsp;<span class="num" id="2350145">32</span><span class="op" id="2350147">)</span>&nbsp;<span class="op" id="2350149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2350152">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2350206">func</span>&nbsp;<span class="op" id="2350211">(</span><span class="ident" id="2350212">f</span>&nbsp;<span class="op" id="2350214">*</span><span class="ident" id="2350215">fmt</span><span class="op" id="2350218">)</span>&nbsp;<span class="ident" id="2350220">fmt_c64</span><span class="op" id="2350227">(</span><span class="ident" id="2350228">v</span>&nbsp;<span class="builtintype" id="2350230">complex64</span><span class="op" id="2350239">,</span>&nbsp;<span class="ident" id="2350241">verb</span>&nbsp;<span class="builtintype" id="2350246">rune</span><span class="op" id="2350250">)</span>&nbsp;<span class="op" id="2350252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350255">f</span><span class="op" id="2350256">.</span><span class="ident" id="2350257">fmt_complex</span><span class="op" id="2350268">(</span><span class="builtintype" id="2350269">float64</span><span class="op" id="2350276">(</span><span class="builtinfunc" id="2350277">real</span><span class="op" id="2350281">(</span><span class="ident" id="2350282">v</span><span class="op" id="2350283">)</span><span class="op" id="2350284">)</span><span class="op" id="2350285">,</span>&nbsp;<span class="builtintype" id="2350287">float64</span><span class="op" id="2350294">(</span><span class="builtinfunc" id="2350295">imag</span><span class="op" id="2350299">(</span><span class="ident" id="2350300">v</span><span class="op" id="2350301">)</span><span class="op" id="2350302">)</span><span class="op" id="2350303">,</span>&nbsp;<span class="num" id="2350305">32</span><span class="op" id="2350307">,</span>&nbsp;<span class="ident" id="2350309">verb</span><span class="op" id="2350313">)</span><br>
<span class="lineno"></span><span class="op" id="2350315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2350318">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2350374">func</span>&nbsp;<span class="op" id="2350379">(</span><span class="ident" id="2350380">f</span>&nbsp;<span class="op" id="2350382">*</span><span class="ident" id="2350383">fmt</span><span class="op" id="2350386">)</span>&nbsp;<span class="ident" id="2350388">fmt_c128</span><span class="op" id="2350396">(</span><span class="ident" id="2350397">v</span>&nbsp;<span class="builtintype" id="2350399">complex128</span><span class="op" id="2350409">,</span>&nbsp;<span class="ident" id="2350411">verb</span>&nbsp;<span class="builtintype" id="2350416">rune</span><span class="op" id="2350420">)</span>&nbsp;<span class="op" id="2350422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350425">f</span><span class="op" id="2350426">.</span><span class="ident" id="2350427">fmt_complex</span><span class="op" id="2350438">(</span><span class="builtinfunc" id="2350439">real</span><span class="op" id="2350443">(</span><span class="ident" id="2350444">v</span><span class="op" id="2350445">)</span><span class="op" id="2350446">,</span>&nbsp;<span class="builtinfunc" id="2350448">imag</span><span class="op" id="2350452">(</span><span class="ident" id="2350453">v</span><span class="op" id="2350454">)</span><span class="op" id="2350455">,</span>&nbsp;<span class="num" id="2350457">64</span><span class="op" id="2350459">,</span>&nbsp;<span class="ident" id="2350461">verb</span><span class="op" id="2350465">)</span><br>
<span class="lineno"></span><span class="op" id="2350467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2350470">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2350521">func</span>&nbsp;<span class="op" id="2350526">(</span><span class="ident" id="2350527">f</span>&nbsp;<span class="op" id="2350529">*</span><span class="ident" id="2350530">fmt</span><span class="op" id="2350533">)</span>&nbsp;<span class="ident" id="2350535">fmt_complex</span><span class="op" id="2350546">(</span><span class="ident" id="2350547">r</span><span class="op" id="2350548">,</span>&nbsp;<span class="ident" id="2350550">j</span>&nbsp;<span class="builtintype" id="2350552">float64</span><span class="op" id="2350559">,</span>&nbsp;<span class="ident" id="2350561">size</span>&nbsp;<span class="builtintype" id="2350566">int</span><span class="op" id="2350569">,</span>&nbsp;<span class="ident" id="2350571">verb</span>&nbsp;<span class="builtintype" id="2350576">rune</span><span class="op" id="2350580">)</span>&nbsp;<span class="op" id="2350582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350585">f</span><span class="op" id="2350586">.</span><span class="ident" id="2350587">buf</span><span class="op" id="2350590">.</span><span class="ident" id="2350591">WriteByte</span><span class="op" id="2350600">(</span><span class="string" id="2350601">&#39;(&#39;</span><span class="op" id="2350604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350607">oldPlus</span>&nbsp;<span class="op" id="2350615">:=</span>&nbsp;<span class="ident" id="2350618">f</span><span class="op" id="2350619">.</span><span class="ident" id="2350620">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350626">oldSpace</span>&nbsp;<span class="op" id="2350635">:=</span>&nbsp;<span class="ident" id="2350638">f</span><span class="op" id="2350639">.</span><span class="ident" id="2350640">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350647">oldWid</span>&nbsp;<span class="op" id="2350654">:=</span>&nbsp;<span class="ident" id="2350657">f</span><span class="op" id="2350658">.</span><span class="ident" id="2350659">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350664">for</span>&nbsp;<span class="ident" id="2350668">i</span>&nbsp;<span class="op" id="2350670">:=</span>&nbsp;<span class="num" id="2350673">0</span><span class="op" id="2350674">;</span>&nbsp;<span class="op" id="2350676">;</span>&nbsp;<span class="ident" id="2350678">i</span><span class="op" id="2350679">++</span>&nbsp;<span class="op" id="2350682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350686">switch</span>&nbsp;<span class="ident" id="2350693">verb</span>&nbsp;<span class="op" id="2350698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350702">case</span>&nbsp;<span class="string" id="2350707">&#39;b&#39;</span><span class="op" id="2350710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350715">f</span><span class="op" id="2350716">.</span><span class="ident" id="2350717">formatFloat</span><span class="op" id="2350728">(</span><span class="ident" id="2350729">r</span><span class="op" id="2350730">,</span>&nbsp;<span class="string" id="2350732">&#39;b&#39;</span><span class="op" id="2350735">,</span>&nbsp;<span class="num" id="2350737">0</span><span class="op" id="2350738">,</span>&nbsp;<span class="ident" id="2350740">size</span><span class="op" id="2350744">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350748">case</span>&nbsp;<span class="string" id="2350753">&#39;e&#39;</span><span class="op" id="2350756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350761">f</span><span class="op" id="2350762">.</span><span class="ident" id="2350763">formatFloat</span><span class="op" id="2350774">(</span><span class="ident" id="2350775">r</span><span class="op" id="2350776">,</span>&nbsp;<span class="string" id="2350778">&#39;e&#39;</span><span class="op" id="2350781">,</span>&nbsp;<span class="ident" id="2350783">doPrec</span><span class="op" id="2350789">(</span><span class="ident" id="2350790">f</span><span class="op" id="2350791">,</span>&nbsp;<span class="num" id="2350793">6</span><span class="op" id="2350794">)</span><span class="op" id="2350795">,</span>&nbsp;<span class="ident" id="2350797">size</span><span class="op" id="2350801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350805">case</span>&nbsp;<span class="string" id="2350810">&#39;E&#39;</span><span class="op" id="2350813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350818">f</span><span class="op" id="2350819">.</span><span class="ident" id="2350820">formatFloat</span><span class="op" id="2350831">(</span><span class="ident" id="2350832">r</span><span class="op" id="2350833">,</span>&nbsp;<span class="string" id="2350835">&#39;E&#39;</span><span class="op" id="2350838">,</span>&nbsp;<span class="ident" id="2350840">doPrec</span><span class="op" id="2350846">(</span><span class="ident" id="2350847">f</span><span class="op" id="2350848">,</span>&nbsp;<span class="num" id="2350850">6</span><span class="op" id="2350851">)</span><span class="op" id="2350852">,</span>&nbsp;<span class="ident" id="2350854">size</span><span class="op" id="2350858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350862">case</span>&nbsp;<span class="string" id="2350867">&#39;f&#39;</span><span class="op" id="2350870">,</span>&nbsp;<span class="string" id="2350872">&#39;F&#39;</span><span class="op" id="2350875">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350880">f</span><span class="op" id="2350881">.</span><span class="ident" id="2350882">formatFloat</span><span class="op" id="2350893">(</span><span class="ident" id="2350894">r</span><span class="op" id="2350895">,</span>&nbsp;<span class="string" id="2350897">&#39;f&#39;</span><span class="op" id="2350900">,</span>&nbsp;<span class="ident" id="2350902">doPrec</span><span class="op" id="2350908">(</span><span class="ident" id="2350909">f</span><span class="op" id="2350910">,</span>&nbsp;<span class="num" id="2350912">6</span><span class="op" id="2350913">)</span><span class="op" id="2350914">,</span>&nbsp;<span class="ident" id="2350916">size</span><span class="op" id="2350920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350924">case</span>&nbsp;<span class="string" id="2350929">&#39;g&#39;</span><span class="op" id="2350932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350937">f</span><span class="op" id="2350938">.</span><span class="ident" id="2350939">formatFloat</span><span class="op" id="2350950">(</span><span class="ident" id="2350951">r</span><span class="op" id="2350952">,</span>&nbsp;<span class="string" id="2350954">&#39;g&#39;</span><span class="op" id="2350957">,</span>&nbsp;<span class="ident" id="2350959">doPrec</span><span class="op" id="2350965">(</span><span class="ident" id="2350966">f</span><span class="op" id="2350967">,</span>&nbsp;<span class="op" id="2350969">-</span><span class="num" id="2350970">1</span><span class="op" id="2350971">)</span><span class="op" id="2350972">,</span>&nbsp;<span class="ident" id="2350974">size</span><span class="op" id="2350978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2350982">case</span>&nbsp;<span class="string" id="2350987">&#39;G&#39;</span><span class="op" id="2350990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2350995">f</span><span class="op" id="2350996">.</span><span class="ident" id="2350997">formatFloat</span><span class="op" id="2351008">(</span><span class="ident" id="2351009">r</span><span class="op" id="2351010">,</span>&nbsp;<span class="string" id="2351012">&#39;G&#39;</span><span class="op" id="2351015">,</span>&nbsp;<span class="ident" id="2351017">doPrec</span><span class="op" id="2351023">(</span><span class="ident" id="2351024">f</span><span class="op" id="2351025">,</span>&nbsp;<span class="op" id="2351027">-</span><span class="num" id="2351028">1</span><span class="op" id="2351029">)</span><span class="op" id="2351030">,</span>&nbsp;<span class="ident" id="2351032">size</span><span class="op" id="2351036">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2351040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351044">if</span>&nbsp;<span class="ident" id="2351047">i</span>&nbsp;<span class="op" id="2351049">!=</span>&nbsp;<span class="num" id="2351052">0</span>&nbsp;<span class="op" id="2351054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2351059">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2351067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2351071">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351110">f</span><span class="op" id="2351111">.</span><span class="ident" id="2351112">plus</span>&nbsp;<span class="op" id="2351117">=</span>&nbsp;<span class="builtintype" id="2351119">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351126">f</span><span class="op" id="2351127">.</span><span class="ident" id="2351128">space</span>&nbsp;<span class="op" id="2351134">=</span>&nbsp;<span class="builtintype" id="2351136">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351144">f</span><span class="op" id="2351145">.</span><span class="ident" id="2351146">wid</span>&nbsp;<span class="op" id="2351150">=</span>&nbsp;<span class="ident" id="2351152">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351161">r</span>&nbsp;<span class="op" id="2351163">=</span>&nbsp;<span class="ident" id="2351165">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2351168">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351171">f</span><span class="op" id="2351172">.</span><span class="ident" id="2351173">space</span>&nbsp;<span class="op" id="2351179">=</span>&nbsp;<span class="ident" id="2351181">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351191">f</span><span class="op" id="2351192">.</span><span class="ident" id="2351193">plus</span>&nbsp;<span class="op" id="2351198">=</span>&nbsp;<span class="ident" id="2351200">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351209">f</span><span class="op" id="2351210">.</span><span class="ident" id="2351211">wid</span>&nbsp;<span class="op" id="2351215">=</span>&nbsp;<span class="ident" id="2351217">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2351225">f</span><span class="op" id="2351226">.</span><span class="ident" id="2351227">buf</span><span class="op" id="2351230">.</span><span class="ident" id="2351231">Write</span><span class="op" id="2351236">(</span><span class="ident" id="2351237">irparenBytes</span><span class="op" id="2351249">)</span><br>
<span class="lineno"></span><span class="op" id="2351251">}</span>
</div>
</body>
</html>
