<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html" class="current">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2569174">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2569229">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2569283">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2569334">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2569357">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2569403">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2569441">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2569506">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2569563">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569608">package</span>&nbsp;<span class="ident" id="2569616">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569625">import</span>&nbsp;<span class="string" id="2569632">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2569642">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2569661">//sys&nbsp;&nbsp;&nbsp;&nbsp;open(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569729">func</span>&nbsp;<span class="ident" id="2569734">Open</span><span class="op" id="2569738">(</span><span class="ident" id="2569739">path</span>&nbsp;<span class="builtintype" id="2569744">string</span><span class="op" id="2569750">,</span>&nbsp;<span class="ident" id="2569752">mode</span>&nbsp;<span class="builtintype" id="2569757">int</span><span class="op" id="2569760">,</span>&nbsp;<span class="ident" id="2569762">perm</span>&nbsp;<span class="builtintype" id="2569767">uint32</span><span class="op" id="2569773">)</span>&nbsp;<span class="op" id="2569775">(</span><span class="ident" id="2569776">fd</span>&nbsp;<span class="builtintype" id="2569779">int</span><span class="op" id="2569782">,</span>&nbsp;<span class="ident" id="2569784">err</span>&nbsp;<span class="builtintype" id="2569788">error</span><span class="op" id="2569793">)</span>&nbsp;<span class="op" id="2569795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2569798">return</span>&nbsp;<span class="ident" id="2569805">open</span><span class="op" id="2569809">(</span><span class="ident" id="2569810">path</span><span class="op" id="2569814">,</span>&nbsp;<span class="ident" id="2569816">mode</span><span class="op" id="2569820">|</span><span class="ident" id="2569821">O_LARGEFILE</span><span class="op" id="2569832">,</span>&nbsp;<span class="ident" id="2569834">perm</span><span class="op" id="2569838">)</span><br>
<span class="lineno"></span><span class="op" id="2569840">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2569843">//sys&nbsp;&nbsp;&nbsp;&nbsp;openat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2569925">func</span>&nbsp;<span class="ident" id="2569930">Openat</span><span class="op" id="2569936">(</span><span class="ident" id="2569937">dirfd</span>&nbsp;<span class="builtintype" id="2569943">int</span><span class="op" id="2569946">,</span>&nbsp;<span class="ident" id="2569948">path</span>&nbsp;<span class="builtintype" id="2569953">string</span><span class="op" id="2569959">,</span>&nbsp;<span class="ident" id="2569961">flags</span>&nbsp;<span class="builtintype" id="2569967">int</span><span class="op" id="2569970">,</span>&nbsp;<span class="ident" id="2569972">mode</span>&nbsp;<span class="builtintype" id="2569977">uint32</span><span class="op" id="2569983">)</span>&nbsp;<span class="op" id="2569985">(</span><span class="ident" id="2569986">fd</span>&nbsp;<span class="builtintype" id="2569989">int</span><span class="op" id="2569992">,</span>&nbsp;<span class="ident" id="2569994">err</span>&nbsp;<span class="builtintype" id="2569998">error</span><span class="op" id="2570003">)</span>&nbsp;<span class="op" id="2570005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570008">return</span>&nbsp;<span class="ident" id="2570015">openat</span><span class="op" id="2570021">(</span><span class="ident" id="2570022">dirfd</span><span class="op" id="2570027">,</span>&nbsp;<span class="ident" id="2570029">path</span><span class="op" id="2570033">,</span>&nbsp;<span class="ident" id="2570035">flags</span><span class="op" id="2570040">|</span><span class="ident" id="2570041">O_LARGEFILE</span><span class="op" id="2570052">,</span>&nbsp;<span class="ident" id="2570054">mode</span><span class="op" id="2570058">)</span><br>
<span class="lineno">30</span><span class="op" id="2570060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2570063">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;pipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570103">func</span>&nbsp;<span class="ident" id="2570108">Pipe</span><span class="op" id="2570112">(</span><span class="ident" id="2570113">p</span>&nbsp;<span class="op" id="2570115">[</span><span class="op" id="2570116">]</span><span class="builtintype" id="2570117">int</span><span class="op" id="2570120">)</span>&nbsp;<span class="op" id="2570122">(</span><span class="ident" id="2570123">err</span>&nbsp;<span class="builtintype" id="2570127">error</span><span class="op" id="2570132">)</span>&nbsp;<span class="op" id="2570134">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570137">if</span>&nbsp;<span class="builtinfunc" id="2570140">len</span><span class="op" id="2570143">(</span><span class="ident" id="2570144">p</span><span class="op" id="2570145">)</span>&nbsp;<span class="op" id="2570147">!=</span>&nbsp;<span class="num" id="2570150">2</span>&nbsp;<span class="op" id="2570152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570156">return</span>&nbsp;<span class="ident" id="2570163">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2570171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570174">var</span>&nbsp;<span class="ident" id="2570178">pp</span>&nbsp;<span class="op" id="2570181">[</span><span class="num" id="2570182">2</span><span class="op" id="2570183">]</span><span class="ident" id="2570184">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570192">err</span>&nbsp;<span class="op" id="2570196">=</span>&nbsp;<span class="ident" id="2570198">pipe</span><span class="op" id="2570202">(</span><span class="op" id="2570203">&amp;</span><span class="ident" id="2570204">pp</span><span class="op" id="2570206">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570209">p</span><span class="op" id="2570210">[</span><span class="num" id="2570211">0</span><span class="op" id="2570212">]</span>&nbsp;<span class="op" id="2570214">=</span>&nbsp;<span class="builtintype" id="2570216">int</span><span class="op" id="2570219">(</span><span class="ident" id="2570220">pp</span><span class="op" id="2570222">[</span><span class="num" id="2570223">0</span><span class="op" id="2570224">]</span><span class="op" id="2570225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570228">p</span><span class="op" id="2570229">[</span><span class="num" id="2570230">1</span><span class="op" id="2570231">]</span>&nbsp;<span class="op" id="2570233">=</span>&nbsp;<span class="builtintype" id="2570235">int</span><span class="op" id="2570238">(</span><span class="ident" id="2570239">pp</span><span class="op" id="2570241">[</span><span class="num" id="2570242">1</span><span class="op" id="2570243">]</span><span class="op" id="2570244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570247">return</span><br>
<span class="lineno"></span><span class="op" id="2570254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2570257">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570309">func</span>&nbsp;<span class="ident" id="2570314">Pipe2</span><span class="op" id="2570319">(</span><span class="ident" id="2570320">p</span>&nbsp;<span class="op" id="2570322">[</span><span class="op" id="2570323">]</span><span class="builtintype" id="2570324">int</span><span class="op" id="2570327">,</span>&nbsp;<span class="ident" id="2570329">flags</span>&nbsp;<span class="builtintype" id="2570335">int</span><span class="op" id="2570338">)</span>&nbsp;<span class="op" id="2570340">(</span><span class="ident" id="2570341">err</span>&nbsp;<span class="builtintype" id="2570345">error</span><span class="op" id="2570350">)</span>&nbsp;<span class="op" id="2570352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570355">if</span>&nbsp;<span class="builtinfunc" id="2570358">len</span><span class="op" id="2570361">(</span><span class="ident" id="2570362">p</span><span class="op" id="2570363">)</span>&nbsp;<span class="op" id="2570365">!=</span>&nbsp;<span class="num" id="2570368">2</span>&nbsp;<span class="op" id="2570370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570374">return</span>&nbsp;<span class="ident" id="2570381">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2570389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570392">var</span>&nbsp;<span class="ident" id="2570396">pp</span>&nbsp;<span class="op" id="2570399">[</span><span class="num" id="2570400">2</span><span class="op" id="2570401">]</span><span class="ident" id="2570402">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570410">err</span>&nbsp;<span class="op" id="2570414">=</span>&nbsp;<span class="ident" id="2570416">pipe2</span><span class="op" id="2570421">(</span><span class="op" id="2570422">&amp;</span><span class="ident" id="2570423">pp</span><span class="op" id="2570425">,</span>&nbsp;<span class="ident" id="2570427">flags</span><span class="op" id="2570432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570435">p</span><span class="op" id="2570436">[</span><span class="num" id="2570437">0</span><span class="op" id="2570438">]</span>&nbsp;<span class="op" id="2570440">=</span>&nbsp;<span class="builtintype" id="2570442">int</span><span class="op" id="2570445">(</span><span class="ident" id="2570446">pp</span><span class="op" id="2570448">[</span><span class="num" id="2570449">0</span><span class="op" id="2570450">]</span><span class="op" id="2570451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570454">p</span><span class="op" id="2570455">[</span><span class="num" id="2570456">1</span><span class="op" id="2570457">]</span>&nbsp;<span class="op" id="2570459">=</span>&nbsp;<span class="builtintype" id="2570461">int</span><span class="op" id="2570464">(</span><span class="ident" id="2570465">pp</span><span class="op" id="2570467">[</span><span class="num" id="2570468">1</span><span class="op" id="2570469">]</span><span class="op" id="2570470">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570473">return</span><br>
<span class="lineno"></span><span class="op" id="2570480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2570483">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2570541">func</span>&nbsp;<span class="ident" id="2570546">Utimes</span><span class="op" id="2570552">(</span><span class="ident" id="2570553">path</span>&nbsp;<span class="builtintype" id="2570558">string</span><span class="op" id="2570564">,</span>&nbsp;<span class="ident" id="2570566">tv</span>&nbsp;<span class="op" id="2570569">[</span><span class="op" id="2570570">]</span><span class="ident" id="2570571">Timeval</span><span class="op" id="2570578">)</span>&nbsp;<span class="op" id="2570580">(</span><span class="ident" id="2570581">err</span>&nbsp;<span class="builtintype" id="2570585">error</span><span class="op" id="2570590">)</span>&nbsp;<span class="op" id="2570592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570595">if</span>&nbsp;<span class="builtinfunc" id="2570598">len</span><span class="op" id="2570601">(</span><span class="ident" id="2570602">tv</span><span class="op" id="2570604">)</span>&nbsp;<span class="op" id="2570606">!=</span>&nbsp;<span class="num" id="2570609">2</span>&nbsp;<span class="op" id="2570611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570615">return</span>&nbsp;<span class="ident" id="2570622">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2570630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570633">return</span>&nbsp;<span class="ident" id="2570640">utimes</span><span class="op" id="2570646">(</span><span class="ident" id="2570647">path</span><span class="op" id="2570651">,</span>&nbsp;<span class="op" id="2570653">(</span><span class="op" id="2570654">*</span><span class="op" id="2570655">[</span><span class="num" id="2570656">2</span><span class="op" id="2570657">]</span><span class="ident" id="2570658">Timeval</span><span class="op" id="2570665">)</span><span class="op" id="2570666">(</span><span class="ident" id="2570667">unsafe</span><span class="op" id="2570673">.</span><span class="ident" id="2570674">Pointer</span><span class="op" id="2570681">(</span><span class="op" id="2570682">&amp;</span><span class="ident" id="2570683">tv</span><span class="op" id="2570685">[</span><span class="num" id="2570686">0</span><span class="op" id="2570687">]</span><span class="op" id="2570688">)</span><span class="op" id="2570689">)</span><span class="op" id="2570690">)</span><br>
<span class="lineno">65</span><span class="op" id="2570692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2570695">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2570768">func</span>&nbsp;<span class="ident" id="2570773">UtimesNano</span><span class="op" id="2570783">(</span><span class="ident" id="2570784">path</span>&nbsp;<span class="builtintype" id="2570789">string</span><span class="op" id="2570795">,</span>&nbsp;<span class="ident" id="2570797">ts</span>&nbsp;<span class="op" id="2570800">[</span><span class="op" id="2570801">]</span><span class="ident" id="2570802">Timespec</span><span class="op" id="2570810">)</span>&nbsp;<span class="op" id="2570812">(</span><span class="ident" id="2570813">err</span>&nbsp;<span class="builtintype" id="2570817">error</span><span class="op" id="2570822">)</span>&nbsp;<span class="op" id="2570824">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570827">if</span>&nbsp;<span class="builtinfunc" id="2570830">len</span><span class="op" id="2570833">(</span><span class="ident" id="2570834">ts</span><span class="op" id="2570836">)</span>&nbsp;<span class="op" id="2570838">!=</span>&nbsp;<span class="num" id="2570841">2</span>&nbsp;<span class="op" id="2570843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570847">return</span>&nbsp;<span class="ident" id="2570854">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2570862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2570865">err</span>&nbsp;<span class="op" id="2570869">=</span>&nbsp;<span class="ident" id="2570871">utimensat</span><span class="op" id="2570880">(</span><span class="ident" id="2570881">_AT_FDCWD</span><span class="op" id="2570890">,</span>&nbsp;<span class="ident" id="2570892">path</span><span class="op" id="2570896">,</span>&nbsp;<span class="op" id="2570898">(</span><span class="op" id="2570899">*</span><span class="op" id="2570900">[</span><span class="num" id="2570901">2</span><span class="op" id="2570902">]</span><span class="ident" id="2570903">Timespec</span><span class="op" id="2570911">)</span><span class="op" id="2570912">(</span><span class="ident" id="2570913">unsafe</span><span class="op" id="2570919">.</span><span class="ident" id="2570920">Pointer</span><span class="op" id="2570927">(</span><span class="op" id="2570928">&amp;</span><span class="ident" id="2570929">ts</span><span class="op" id="2570931">[</span><span class="num" id="2570932">0</span><span class="op" id="2570933">]</span><span class="op" id="2570934">)</span><span class="op" id="2570935">)</span><span class="op" id="2570936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570939">if</span>&nbsp;<span class="ident" id="2570942">err</span>&nbsp;<span class="op" id="2570946">!=</span>&nbsp;<span class="ident" id="2570949">ENOSYS</span>&nbsp;<span class="op" id="2570956">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2570960">return</span>&nbsp;<span class="ident" id="2570967">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2570972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2570975">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2571050">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571113">var</span>&nbsp;<span class="ident" id="2571117">tv</span>&nbsp;<span class="op" id="2571120">[</span><span class="num" id="2571121">2</span><span class="op" id="2571122">]</span><span class="ident" id="2571123">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571132">for</span>&nbsp;<span class="ident" id="2571136">i</span>&nbsp;<span class="op" id="2571138">:=</span>&nbsp;<span class="num" id="2571141">0</span><span class="op" id="2571142">;</span>&nbsp;<span class="ident" id="2571144">i</span>&nbsp;<span class="op" id="2571146">&lt;</span>&nbsp;<span class="num" id="2571148">2</span><span class="op" id="2571149">;</span>&nbsp;<span class="ident" id="2571151">i</span><span class="op" id="2571152">++</span>&nbsp;<span class="op" id="2571155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571159">tv</span><span class="op" id="2571161">[</span><span class="ident" id="2571162">i</span><span class="op" id="2571163">]</span><span class="op" id="2571164">.</span><span class="ident" id="2571165">Sec</span>&nbsp;<span class="op" id="2571169">=</span>&nbsp;<span class="ident" id="2571171">ts</span><span class="op" id="2571173">[</span><span class="ident" id="2571174">i</span><span class="op" id="2571175">]</span><span class="op" id="2571176">.</span><span class="ident" id="2571177">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571183">tv</span><span class="op" id="2571185">[</span><span class="ident" id="2571186">i</span><span class="op" id="2571187">]</span><span class="op" id="2571188">.</span><span class="ident" id="2571189">Usec</span>&nbsp;<span class="op" id="2571194">=</span>&nbsp;<span class="ident" id="2571196">ts</span><span class="op" id="2571198">[</span><span class="ident" id="2571199">i</span><span class="op" id="2571200">]</span><span class="op" id="2571201">.</span><span class="ident" id="2571202">Nsec</span>&nbsp;<span class="op" id="2571207">/</span>&nbsp;<span class="num" id="2571209">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2571215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571218">return</span>&nbsp;<span class="ident" id="2571225">utimes</span><span class="op" id="2571231">(</span><span class="ident" id="2571232">path</span><span class="op" id="2571236">,</span>&nbsp;<span class="op" id="2571238">(</span><span class="op" id="2571239">*</span><span class="op" id="2571240">[</span><span class="num" id="2571241">2</span><span class="op" id="2571242">]</span><span class="ident" id="2571243">Timeval</span><span class="op" id="2571250">)</span><span class="op" id="2571251">(</span><span class="ident" id="2571252">unsafe</span><span class="op" id="2571258">.</span><span class="ident" id="2571259">Pointer</span><span class="op" id="2571266">(</span><span class="op" id="2571267">&amp;</span><span class="ident" id="2571268">tv</span><span class="op" id="2571270">[</span><span class="num" id="2571271">0</span><span class="op" id="2571272">]</span><span class="op" id="2571273">)</span><span class="op" id="2571274">)</span><span class="op" id="2571275">)</span><br>
<span class="lineno">85</span><span class="op" id="2571277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2571280">//sys&nbsp;&nbsp;&nbsp;&nbsp;futimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571351">func</span>&nbsp;<span class="ident" id="2571356">Futimesat</span><span class="op" id="2571365">(</span><span class="ident" id="2571366">dirfd</span>&nbsp;<span class="builtintype" id="2571372">int</span><span class="op" id="2571375">,</span>&nbsp;<span class="ident" id="2571377">path</span>&nbsp;<span class="builtintype" id="2571382">string</span><span class="op" id="2571388">,</span>&nbsp;<span class="ident" id="2571390">tv</span>&nbsp;<span class="op" id="2571393">[</span><span class="op" id="2571394">]</span><span class="ident" id="2571395">Timeval</span><span class="op" id="2571402">)</span>&nbsp;<span class="op" id="2571404">(</span><span class="ident" id="2571405">err</span>&nbsp;<span class="builtintype" id="2571409">error</span><span class="op" id="2571414">)</span>&nbsp;<span class="op" id="2571416">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571419">if</span>&nbsp;<span class="builtinfunc" id="2571422">len</span><span class="op" id="2571425">(</span><span class="ident" id="2571426">tv</span><span class="op" id="2571428">)</span>&nbsp;<span class="op" id="2571430">!=</span>&nbsp;<span class="num" id="2571433">2</span>&nbsp;<span class="op" id="2571435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571439">return</span>&nbsp;<span class="ident" id="2571446">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2571454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571457">pathp</span><span class="op" id="2571462">,</span>&nbsp;<span class="ident" id="2571464">err</span>&nbsp;<span class="op" id="2571468">:=</span>&nbsp;<span class="ident" id="2571471">BytePtrFromString</span><span class="op" id="2571488">(</span><span class="ident" id="2571489">path</span><span class="op" id="2571493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571496">if</span>&nbsp;<span class="ident" id="2571499">err</span>&nbsp;<span class="op" id="2571503">!=</span>&nbsp;<span class="ident" id="2571506">nil</span>&nbsp;<span class="op" id="2571510">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571514">return</span>&nbsp;<span class="ident" id="2571521">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2571526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571529">err</span>&nbsp;<span class="op" id="2571533">=</span>&nbsp;<span class="ident" id="2571535">futimesat</span><span class="op" id="2571544">(</span><span class="ident" id="2571545">dirfd</span><span class="op" id="2571550">,</span>&nbsp;<span class="ident" id="2571552">pathp</span><span class="op" id="2571557">,</span>&nbsp;<span class="op" id="2571559">(</span><span class="op" id="2571560">*</span><span class="op" id="2571561">[</span><span class="num" id="2571562">2</span><span class="op" id="2571563">]</span><span class="ident" id="2571564">Timeval</span><span class="op" id="2571571">)</span><span class="op" id="2571572">(</span><span class="ident" id="2571573">unsafe</span><span class="op" id="2571579">.</span><span class="ident" id="2571580">Pointer</span><span class="op" id="2571587">(</span><span class="op" id="2571588">&amp;</span><span class="ident" id="2571589">tv</span><span class="op" id="2571591">[</span><span class="num" id="2571592">0</span><span class="op" id="2571593">]</span><span class="op" id="2571594">)</span><span class="op" id="2571595">)</span><span class="op" id="2571596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571599">use</span><span class="op" id="2571602">(</span><span class="ident" id="2571603">unsafe</span><span class="op" id="2571609">.</span><span class="ident" id="2571610">Pointer</span><span class="op" id="2571617">(</span><span class="ident" id="2571618">pathp</span><span class="op" id="2571623">)</span><span class="op" id="2571624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571627">return</span>&nbsp;<span class="ident" id="2571634">err</span><br>
<span class="lineno">100</span><span class="op" id="2571638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571641">func</span>&nbsp;<span class="ident" id="2571646">Futimes</span><span class="op" id="2571653">(</span><span class="ident" id="2571654">fd</span>&nbsp;<span class="builtintype" id="2571657">int</span><span class="op" id="2571660">,</span>&nbsp;<span class="ident" id="2571662">tv</span>&nbsp;<span class="op" id="2571665">[</span><span class="op" id="2571666">]</span><span class="ident" id="2571667">Timeval</span><span class="op" id="2571674">)</span>&nbsp;<span class="op" id="2571676">(</span><span class="ident" id="2571677">err</span>&nbsp;<span class="builtintype" id="2571681">error</span><span class="op" id="2571686">)</span>&nbsp;<span class="op" id="2571688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2571691">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2571750">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571780">return</span>&nbsp;<span class="ident" id="2571787">Utimes</span><span class="op" id="2571793">(</span><span class="string" id="2571794">&#34;/proc/self/fd/&#34;</span><span class="op" id="2571810">+</span><span class="ident" id="2571811">itoa</span><span class="op" id="2571815">(</span><span class="ident" id="2571816">fd</span><span class="op" id="2571818">)</span><span class="op" id="2571819">,</span>&nbsp;<span class="ident" id="2571821">tv</span><span class="op" id="2571823">)</span><br>
<span class="lineno"></span><span class="op" id="2571825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571828">const</span>&nbsp;<span class="ident" id="2571834">ImplementsGetwd</span>&nbsp;<span class="op" id="2571850">=</span>&nbsp;<span class="builtintype" id="2571852">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2571858">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2571903">func</span>&nbsp;<span class="ident" id="2571908">Getwd</span><span class="op" id="2571913">(</span><span class="op" id="2571914">)</span>&nbsp;<span class="op" id="2571916">(</span><span class="ident" id="2571917">wd</span>&nbsp;<span class="builtintype" id="2571920">string</span><span class="op" id="2571926">,</span>&nbsp;<span class="ident" id="2571928">err</span>&nbsp;<span class="builtintype" id="2571932">error</span><span class="op" id="2571937">)</span>&nbsp;<span class="op" id="2571939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571942">var</span>&nbsp;<span class="ident" id="2571946">buf</span>&nbsp;<span class="op" id="2571950">[</span><span class="ident" id="2571951">PathMax</span><span class="op" id="2571958">]</span><span class="builtintype" id="2571959">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2571965">n</span><span class="op" id="2571966">,</span>&nbsp;<span class="ident" id="2571968">err</span>&nbsp;<span class="op" id="2571972">:=</span>&nbsp;<span class="ident" id="2571975">Getcwd</span><span class="op" id="2571981">(</span><span class="ident" id="2571982">buf</span><span class="op" id="2571985">[</span><span class="num" id="2571986">0</span><span class="op" id="2571987">:</span><span class="op" id="2571988">]</span><span class="op" id="2571989">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2571992">if</span>&nbsp;<span class="ident" id="2571995">err</span>&nbsp;<span class="op" id="2571999">!=</span>&nbsp;<span class="ident" id="2572002">nil</span>&nbsp;<span class="op" id="2572006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572010">return</span>&nbsp;<span class="string" id="2572017">&#34;&#34;</span><span class="op" id="2572019">,</span>&nbsp;<span class="ident" id="2572021">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2572029">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572103">if</span>&nbsp;<span class="ident" id="2572106">n</span>&nbsp;<span class="op" id="2572108">&lt;</span>&nbsp;<span class="num" id="2572110">1</span>&nbsp;<span class="op" id="2572112">||</span>&nbsp;<span class="ident" id="2572115">n</span>&nbsp;<span class="op" id="2572117">&gt;</span>&nbsp;<span class="builtinfunc" id="2572119">len</span><span class="op" id="2572122">(</span><span class="ident" id="2572123">buf</span><span class="op" id="2572126">)</span>&nbsp;<span class="op" id="2572128">||</span>&nbsp;<span class="ident" id="2572131">buf</span><span class="op" id="2572134">[</span><span class="ident" id="2572135">n</span><span class="op" id="2572136">-</span><span class="num" id="2572137">1</span><span class="op" id="2572138">]</span>&nbsp;<span class="op" id="2572140">!=</span>&nbsp;<span class="num" id="2572143">0</span>&nbsp;<span class="op" id="2572145">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572149">return</span>&nbsp;<span class="string" id="2572156">&#34;&#34;</span><span class="op" id="2572158">,</span>&nbsp;<span class="ident" id="2572160">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572171">return</span>&nbsp;<span class="builtintype" id="2572178">string</span><span class="op" id="2572184">(</span><span class="ident" id="2572185">buf</span><span class="op" id="2572188">[</span><span class="num" id="2572189">0</span>&nbsp;<span class="op" id="2572191">:</span>&nbsp;<span class="ident" id="2572193">n</span><span class="op" id="2572194">-</span><span class="num" id="2572195">1</span><span class="op" id="2572196">]</span><span class="op" id="2572197">)</span><span class="op" id="2572198">,</span>&nbsp;<span class="ident" id="2572200">nil</span><br>
<span class="lineno"></span><span class="op" id="2572204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2572207">func</span>&nbsp;<span class="ident" id="2572212">Getgroups</span><span class="op" id="2572221">(</span><span class="op" id="2572222">)</span>&nbsp;<span class="op" id="2572224">(</span><span class="ident" id="2572225">gids</span>&nbsp;<span class="op" id="2572230">[</span><span class="op" id="2572231">]</span><span class="builtintype" id="2572232">int</span><span class="op" id="2572235">,</span>&nbsp;<span class="ident" id="2572237">err</span>&nbsp;<span class="builtintype" id="2572241">error</span><span class="op" id="2572246">)</span>&nbsp;<span class="op" id="2572248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572251">n</span><span class="op" id="2572252">,</span>&nbsp;<span class="ident" id="2572254">err</span>&nbsp;<span class="op" id="2572258">:=</span>&nbsp;<span class="ident" id="2572261">getgroups</span><span class="op" id="2572270">(</span><span class="num" id="2572271">0</span><span class="op" id="2572272">,</span>&nbsp;<span class="ident" id="2572274">nil</span><span class="op" id="2572277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572280">if</span>&nbsp;<span class="ident" id="2572283">err</span>&nbsp;<span class="op" id="2572287">!=</span>&nbsp;<span class="ident" id="2572290">nil</span>&nbsp;<span class="op" id="2572294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572298">return</span>&nbsp;<span class="ident" id="2572305">nil</span><span class="op" id="2572308">,</span>&nbsp;<span class="ident" id="2572310">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572315">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572318">if</span>&nbsp;<span class="ident" id="2572321">n</span>&nbsp;<span class="op" id="2572323">==</span>&nbsp;<span class="num" id="2572326">0</span>&nbsp;<span class="op" id="2572328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572332">return</span>&nbsp;<span class="ident" id="2572339">nil</span><span class="op" id="2572342">,</span>&nbsp;<span class="ident" id="2572344">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2572353">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572407">if</span>&nbsp;<span class="ident" id="2572410">n</span>&nbsp;<span class="op" id="2572412">&lt;</span>&nbsp;<span class="num" id="2572414">0</span>&nbsp;<span class="op" id="2572416">||</span>&nbsp;<span class="ident" id="2572419">n</span>&nbsp;<span class="op" id="2572421">&gt;</span>&nbsp;<span class="num" id="2572423">1</span><span class="op" id="2572424">&lt;&lt;</span><span class="num" id="2572426">20</span>&nbsp;<span class="op" id="2572429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572433">return</span>&nbsp;<span class="ident" id="2572440">nil</span><span class="op" id="2572443">,</span>&nbsp;<span class="ident" id="2572445">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572457">a</span>&nbsp;<span class="op" id="2572459">:=</span>&nbsp;<span class="builtinfunc" id="2572462">make</span><span class="op" id="2572466">(</span><span class="op" id="2572467">[</span><span class="op" id="2572468">]</span><span class="ident" id="2572469">_Gid_t</span><span class="op" id="2572475">,</span>&nbsp;<span class="ident" id="2572477">n</span><span class="op" id="2572478">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572481">n</span><span class="op" id="2572482">,</span>&nbsp;<span class="ident" id="2572484">err</span>&nbsp;<span class="op" id="2572488">=</span>&nbsp;<span class="ident" id="2572490">getgroups</span><span class="op" id="2572499">(</span><span class="ident" id="2572500">n</span><span class="op" id="2572501">,</span>&nbsp;<span class="op" id="2572503">&amp;</span><span class="ident" id="2572504">a</span><span class="op" id="2572505">[</span><span class="num" id="2572506">0</span><span class="op" id="2572507">]</span><span class="op" id="2572508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572511">if</span>&nbsp;<span class="ident" id="2572514">err</span>&nbsp;<span class="op" id="2572518">!=</span>&nbsp;<span class="ident" id="2572521">nil</span>&nbsp;<span class="op" id="2572525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572529">return</span>&nbsp;<span class="ident" id="2572536">nil</span><span class="op" id="2572539">,</span>&nbsp;<span class="ident" id="2572541">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572549">gids</span>&nbsp;<span class="op" id="2572554">=</span>&nbsp;<span class="builtinfunc" id="2572556">make</span><span class="op" id="2572560">(</span><span class="op" id="2572561">[</span><span class="op" id="2572562">]</span><span class="builtintype" id="2572563">int</span><span class="op" id="2572566">,</span>&nbsp;<span class="ident" id="2572568">n</span><span class="op" id="2572569">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572572">for</span>&nbsp;<span class="ident" id="2572576">i</span><span class="op" id="2572577">,</span>&nbsp;<span class="ident" id="2572579">v</span>&nbsp;<span class="op" id="2572581">:=</span>&nbsp;<span class="keyword" id="2572584">range</span>&nbsp;<span class="ident" id="2572590">a</span><span class="op" id="2572591">[</span><span class="num" id="2572592">0</span><span class="op" id="2572593">:</span><span class="ident" id="2572594">n</span><span class="op" id="2572595">]</span>&nbsp;<span class="op" id="2572597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572601">gids</span><span class="op" id="2572605">[</span><span class="ident" id="2572606">i</span><span class="op" id="2572607">]</span>&nbsp;<span class="op" id="2572609">=</span>&nbsp;<span class="builtintype" id="2572611">int</span><span class="op" id="2572614">(</span><span class="ident" id="2572615">v</span><span class="op" id="2572616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572622">return</span><br>
<span class="lineno"></span><span class="op" id="2572629">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2572632">func</span>&nbsp;<span class="ident" id="2572637">Setgroups</span><span class="op" id="2572646">(</span><span class="ident" id="2572647">gids</span>&nbsp;<span class="op" id="2572652">[</span><span class="op" id="2572653">]</span><span class="builtintype" id="2572654">int</span><span class="op" id="2572657">)</span>&nbsp;<span class="op" id="2572659">(</span><span class="ident" id="2572660">err</span>&nbsp;<span class="builtintype" id="2572664">error</span><span class="op" id="2572669">)</span>&nbsp;<span class="op" id="2572671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572674">if</span>&nbsp;<span class="builtinfunc" id="2572677">len</span><span class="op" id="2572680">(</span><span class="ident" id="2572681">gids</span><span class="op" id="2572685">)</span>&nbsp;<span class="op" id="2572687">==</span>&nbsp;<span class="num" id="2572690">0</span>&nbsp;<span class="op" id="2572692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572696">return</span>&nbsp;<span class="ident" id="2572703">setgroups</span><span class="op" id="2572712">(</span><span class="num" id="2572713">0</span><span class="op" id="2572714">,</span>&nbsp;<span class="ident" id="2572716">nil</span><span class="op" id="2572719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572722">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572726">a</span>&nbsp;<span class="op" id="2572728">:=</span>&nbsp;<span class="builtinfunc" id="2572731">make</span><span class="op" id="2572735">(</span><span class="op" id="2572736">[</span><span class="op" id="2572737">]</span><span class="ident" id="2572738">_Gid_t</span><span class="op" id="2572744">,</span>&nbsp;<span class="builtinfunc" id="2572746">len</span><span class="op" id="2572749">(</span><span class="ident" id="2572750">gids</span><span class="op" id="2572754">)</span><span class="op" id="2572755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572758">for</span>&nbsp;<span class="ident" id="2572762">i</span><span class="op" id="2572763">,</span>&nbsp;<span class="ident" id="2572765">v</span>&nbsp;<span class="op" id="2572767">:=</span>&nbsp;<span class="keyword" id="2572770">range</span>&nbsp;<span class="ident" id="2572776">gids</span>&nbsp;<span class="op" id="2572781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2572785">a</span><span class="op" id="2572786">[</span><span class="ident" id="2572787">i</span><span class="op" id="2572788">]</span>&nbsp;<span class="op" id="2572790">=</span>&nbsp;<span class="ident" id="2572792">_Gid_t</span><span class="op" id="2572798">(</span><span class="ident" id="2572799">v</span><span class="op" id="2572800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2572803">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2572806">return</span>&nbsp;<span class="ident" id="2572813">setgroups</span><span class="op" id="2572822">(</span><span class="builtinfunc" id="2572823">len</span><span class="op" id="2572826">(</span><span class="ident" id="2572827">a</span><span class="op" id="2572828">)</span><span class="op" id="2572829">,</span>&nbsp;<span class="op" id="2572831">&amp;</span><span class="ident" id="2572832">a</span><span class="op" id="2572833">[</span><span class="num" id="2572834">0</span><span class="op" id="2572835">]</span><span class="op" id="2572836">)</span><br>
<span class="lineno"></span><span class="op" id="2572838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2572841">type</span>&nbsp;<span class="ident" id="2572846">WaitStatus</span>&nbsp;<span class="builtintype" id="2572857">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2572865">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2572920">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2572979">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2573029">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2573083">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2573134">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2573189">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2573244">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573284">const</span>&nbsp;<span class="op" id="2573290">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573293">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2573301">=</span>&nbsp;<span class="num" id="2573303">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573309">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2573317">=</span>&nbsp;<span class="num" id="2573319">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573325">exited</span>&nbsp;&nbsp;<span class="op" id="2573333">=</span>&nbsp;<span class="num" id="2573335">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573341">stopped</span>&nbsp;<span class="op" id="2573349">=</span>&nbsp;<span class="num" id="2573351">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2573357">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2573365">=</span>&nbsp;<span class="num" id="2573367">8</span><br>
<span class="lineno">180</span><span class="op" id="2573369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573372">func</span>&nbsp;<span class="op" id="2573377">(</span><span class="ident" id="2573378">w</span>&nbsp;<span class="ident" id="2573380">WaitStatus</span><span class="op" id="2573390">)</span>&nbsp;<span class="ident" id="2573392">Exited</span><span class="op" id="2573398">(</span><span class="op" id="2573399">)</span>&nbsp;<span class="builtintype" id="2573401">bool</span>&nbsp;<span class="op" id="2573406">{</span>&nbsp;<span class="keyword" id="2573408">return</span>&nbsp;<span class="ident" id="2573415">w</span><span class="op" id="2573416">&amp;</span><span class="ident" id="2573417">mask</span>&nbsp;<span class="op" id="2573422">==</span>&nbsp;<span class="ident" id="2573425">exited</span>&nbsp;<span class="op" id="2573432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573435">func</span>&nbsp;<span class="op" id="2573440">(</span><span class="ident" id="2573441">w</span>&nbsp;<span class="ident" id="2573443">WaitStatus</span><span class="op" id="2573453">)</span>&nbsp;<span class="ident" id="2573455">Signaled</span><span class="op" id="2573463">(</span><span class="op" id="2573464">)</span>&nbsp;<span class="builtintype" id="2573466">bool</span>&nbsp;<span class="op" id="2573471">{</span>&nbsp;<span class="keyword" id="2573473">return</span>&nbsp;<span class="ident" id="2573480">w</span><span class="op" id="2573481">&amp;</span><span class="ident" id="2573482">mask</span>&nbsp;<span class="op" id="2573487">!=</span>&nbsp;<span class="ident" id="2573490">stopped</span>&nbsp;<span class="op" id="2573498">&amp;&amp;</span>&nbsp;<span class="ident" id="2573501">w</span><span class="op" id="2573502">&amp;</span><span class="ident" id="2573503">mask</span>&nbsp;<span class="op" id="2573508">!=</span>&nbsp;<span class="ident" id="2573511">exited</span>&nbsp;<span class="op" id="2573518">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2573521">func</span>&nbsp;<span class="op" id="2573526">(</span><span class="ident" id="2573527">w</span>&nbsp;<span class="ident" id="2573529">WaitStatus</span><span class="op" id="2573539">)</span>&nbsp;<span class="ident" id="2573541">Stopped</span><span class="op" id="2573548">(</span><span class="op" id="2573549">)</span>&nbsp;<span class="builtintype" id="2573551">bool</span>&nbsp;<span class="op" id="2573556">{</span>&nbsp;<span class="keyword" id="2573558">return</span>&nbsp;<span class="ident" id="2573565">w</span><span class="op" id="2573566">&amp;</span><span class="num" id="2573567">0xFF</span>&nbsp;<span class="op" id="2573572">==</span>&nbsp;<span class="ident" id="2573575">stopped</span>&nbsp;<span class="op" id="2573583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573586">func</span>&nbsp;<span class="op" id="2573591">(</span><span class="ident" id="2573592">w</span>&nbsp;<span class="ident" id="2573594">WaitStatus</span><span class="op" id="2573604">)</span>&nbsp;<span class="ident" id="2573606">Continued</span><span class="op" id="2573615">(</span><span class="op" id="2573616">)</span>&nbsp;<span class="builtintype" id="2573618">bool</span>&nbsp;<span class="op" id="2573623">{</span>&nbsp;<span class="keyword" id="2573625">return</span>&nbsp;<span class="ident" id="2573632">w</span>&nbsp;<span class="op" id="2573634">==</span>&nbsp;<span class="num" id="2573637">0xFFFF</span>&nbsp;<span class="op" id="2573644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2573647">func</span>&nbsp;<span class="op" id="2573652">(</span><span class="ident" id="2573653">w</span>&nbsp;<span class="ident" id="2573655">WaitStatus</span><span class="op" id="2573665">)</span>&nbsp;<span class="ident" id="2573667">CoreDump</span><span class="op" id="2573675">(</span><span class="op" id="2573676">)</span>&nbsp;<span class="builtintype" id="2573678">bool</span>&nbsp;<span class="op" id="2573683">{</span>&nbsp;<span class="keyword" id="2573685">return</span>&nbsp;<span class="ident" id="2573692">w</span><span class="op" id="2573693">.</span><span class="ident" id="2573694">Signaled</span><span class="op" id="2573702">(</span><span class="op" id="2573703">)</span>&nbsp;<span class="op" id="2573705">&amp;&amp;</span>&nbsp;<span class="ident" id="2573708">w</span><span class="op" id="2573709">&amp;</span><span class="ident" id="2573710">core</span>&nbsp;<span class="op" id="2573715">!=</span>&nbsp;<span class="num" id="2573718">0</span>&nbsp;<span class="op" id="2573720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573723">func</span>&nbsp;<span class="op" id="2573728">(</span><span class="ident" id="2573729">w</span>&nbsp;<span class="ident" id="2573731">WaitStatus</span><span class="op" id="2573741">)</span>&nbsp;<span class="ident" id="2573743">ExitStatus</span><span class="op" id="2573753">(</span><span class="op" id="2573754">)</span>&nbsp;<span class="builtintype" id="2573756">int</span>&nbsp;<span class="op" id="2573760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573763">if</span>&nbsp;<span class="op" id="2573766">!</span><span class="ident" id="2573767">w</span><span class="op" id="2573768">.</span><span class="ident" id="2573769">Exited</span><span class="op" id="2573775">(</span><span class="op" id="2573776">)</span>&nbsp;<span class="op" id="2573778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573782">return</span>&nbsp;<span class="op" id="2573789">-</span><span class="num" id="2573790">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2573793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573796">return</span>&nbsp;<span class="builtintype" id="2573803">int</span><span class="op" id="2573806">(</span><span class="ident" id="2573807">w</span><span class="op" id="2573808">&gt;&gt;</span><span class="ident" id="2573810">shift</span><span class="op" id="2573815">)</span>&nbsp;<span class="op" id="2573817">&amp;</span>&nbsp;<span class="num" id="2573819">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2573824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2573827">func</span>&nbsp;<span class="op" id="2573832">(</span><span class="ident" id="2573833">w</span>&nbsp;<span class="ident" id="2573835">WaitStatus</span><span class="op" id="2573845">)</span>&nbsp;<span class="ident" id="2573847">Signal</span><span class="op" id="2573853">(</span><span class="op" id="2573854">)</span>&nbsp;<span class="ident" id="2573856">Signal</span>&nbsp;<span class="op" id="2573863">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573866">if</span>&nbsp;<span class="op" id="2573869">!</span><span class="ident" id="2573870">w</span><span class="op" id="2573871">.</span><span class="ident" id="2573872">Signaled</span><span class="op" id="2573880">(</span><span class="op" id="2573881">)</span>&nbsp;<span class="op" id="2573883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573887">return</span>&nbsp;<span class="op" id="2573894">-</span><span class="num" id="2573895">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2573898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573901">return</span>&nbsp;<span class="ident" id="2573908">Signal</span><span class="op" id="2573914">(</span><span class="ident" id="2573915">w</span>&nbsp;<span class="op" id="2573917">&amp;</span>&nbsp;<span class="ident" id="2573919">mask</span><span class="op" id="2573923">)</span><br>
<span class="lineno"></span><span class="op" id="2573925">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2573928">func</span>&nbsp;<span class="op" id="2573933">(</span><span class="ident" id="2573934">w</span>&nbsp;<span class="ident" id="2573936">WaitStatus</span><span class="op" id="2573946">)</span>&nbsp;<span class="ident" id="2573948">StopSignal</span><span class="op" id="2573958">(</span><span class="op" id="2573959">)</span>&nbsp;<span class="ident" id="2573961">Signal</span>&nbsp;<span class="op" id="2573968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573971">if</span>&nbsp;<span class="op" id="2573974">!</span><span class="ident" id="2573975">w</span><span class="op" id="2573976">.</span><span class="ident" id="2573977">Stopped</span><span class="op" id="2573984">(</span><span class="op" id="2573985">)</span>&nbsp;<span class="op" id="2573987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2573991">return</span>&nbsp;<span class="op" id="2573998">-</span><span class="num" id="2573999">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2574002">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574005">return</span>&nbsp;<span class="ident" id="2574012">Signal</span><span class="op" id="2574018">(</span><span class="ident" id="2574019">w</span><span class="op" id="2574020">&gt;&gt;</span><span class="ident" id="2574022">shift</span><span class="op" id="2574027">)</span>&nbsp;<span class="op" id="2574029">&amp;</span>&nbsp;<span class="num" id="2574031">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2574036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2574039">func</span>&nbsp;<span class="op" id="2574044">(</span><span class="ident" id="2574045">w</span>&nbsp;<span class="ident" id="2574047">WaitStatus</span><span class="op" id="2574057">)</span>&nbsp;<span class="ident" id="2574059">TrapCause</span><span class="op" id="2574068">(</span><span class="op" id="2574069">)</span>&nbsp;<span class="builtintype" id="2574071">int</span>&nbsp;<span class="op" id="2574075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574078">if</span>&nbsp;<span class="ident" id="2574081">w</span><span class="op" id="2574082">.</span><span class="ident" id="2574083">StopSignal</span><span class="op" id="2574093">(</span><span class="op" id="2574094">)</span>&nbsp;<span class="op" id="2574096">!=</span>&nbsp;<span class="ident" id="2574099">SIGTRAP</span>&nbsp;<span class="op" id="2574107">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574111">return</span>&nbsp;<span class="op" id="2574118">-</span><span class="num" id="2574119">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2574122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574125">return</span>&nbsp;<span class="builtintype" id="2574132">int</span><span class="op" id="2574135">(</span><span class="ident" id="2574136">w</span><span class="op" id="2574137">&gt;&gt;</span><span class="ident" id="2574139">shift</span><span class="op" id="2574144">)</span>&nbsp;<span class="op" id="2574146">&gt;&gt;</span>&nbsp;<span class="num" id="2574149">8</span><br>
<span class="lineno"></span><span class="op" id="2574151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2574154">//sys&nbsp;&nbsp;&nbsp;&nbsp;wait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2574244">func</span>&nbsp;<span class="ident" id="2574249">Wait4</span><span class="op" id="2574254">(</span><span class="ident" id="2574255">pid</span>&nbsp;<span class="builtintype" id="2574259">int</span><span class="op" id="2574262">,</span>&nbsp;<span class="ident" id="2574264">wstatus</span>&nbsp;<span class="op" id="2574272">*</span><span class="ident" id="2574273">WaitStatus</span><span class="op" id="2574283">,</span>&nbsp;<span class="ident" id="2574285">options</span>&nbsp;<span class="builtintype" id="2574293">int</span><span class="op" id="2574296">,</span>&nbsp;<span class="ident" id="2574298">rusage</span>&nbsp;<span class="op" id="2574305">*</span><span class="ident" id="2574306">Rusage</span><span class="op" id="2574312">)</span>&nbsp;<span class="op" id="2574314">(</span><span class="ident" id="2574315">wpid</span>&nbsp;<span class="builtintype" id="2574320">int</span><span class="op" id="2574323">,</span>&nbsp;<span class="ident" id="2574325">err</span>&nbsp;<span class="builtintype" id="2574329">error</span><span class="op" id="2574334">)</span>&nbsp;<span class="op" id="2574336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574339">var</span>&nbsp;<span class="ident" id="2574343">status</span>&nbsp;<span class="ident" id="2574350">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2574358">wpid</span><span class="op" id="2574362">,</span>&nbsp;<span class="ident" id="2574364">err</span>&nbsp;<span class="op" id="2574368">=</span>&nbsp;<span class="ident" id="2574370">wait4</span><span class="op" id="2574375">(</span><span class="ident" id="2574376">pid</span><span class="op" id="2574379">,</span>&nbsp;<span class="op" id="2574381">&amp;</span><span class="ident" id="2574382">status</span><span class="op" id="2574388">,</span>&nbsp;<span class="ident" id="2574390">options</span><span class="op" id="2574397">,</span>&nbsp;<span class="ident" id="2574399">rusage</span><span class="op" id="2574405">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574408">if</span>&nbsp;<span class="ident" id="2574411">wstatus</span>&nbsp;<span class="op" id="2574419">!=</span>&nbsp;<span class="ident" id="2574422">nil</span>&nbsp;<span class="op" id="2574426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2574430">*</span><span class="ident" id="2574431">wstatus</span>&nbsp;<span class="op" id="2574439">=</span>&nbsp;<span class="ident" id="2574441">WaitStatus</span><span class="op" id="2574451">(</span><span class="ident" id="2574452">status</span><span class="op" id="2574458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2574461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574464">return</span><br>
<span class="lineno"></span><span class="op" id="2574471">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2574474">func</span>&nbsp;<span class="ident" id="2574479">Mkfifo</span><span class="op" id="2574485">(</span><span class="ident" id="2574486">path</span>&nbsp;<span class="builtintype" id="2574491">string</span><span class="op" id="2574497">,</span>&nbsp;<span class="ident" id="2574499">mode</span>&nbsp;<span class="builtintype" id="2574504">uint32</span><span class="op" id="2574510">)</span>&nbsp;<span class="op" id="2574512">(</span><span class="ident" id="2574513">err</span>&nbsp;<span class="builtintype" id="2574517">error</span><span class="op" id="2574522">)</span>&nbsp;<span class="op" id="2574524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574527">return</span>&nbsp;<span class="ident" id="2574534">Mknod</span><span class="op" id="2574539">(</span><span class="ident" id="2574540">path</span><span class="op" id="2574544">,</span>&nbsp;<span class="ident" id="2574546">mode</span><span class="op" id="2574550">|</span><span class="ident" id="2574551">S_IFIFO</span><span class="op" id="2574558">,</span>&nbsp;<span class="num" id="2574560">0</span><span class="op" id="2574561">)</span><br>
<span class="lineno"></span><span class="op" id="2574563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2574566">func</span>&nbsp;<span class="op" id="2574571">(</span><span class="ident" id="2574572">sa</span>&nbsp;<span class="op" id="2574575">*</span><span class="ident" id="2574576">SockaddrInet4</span><span class="op" id="2574589">)</span>&nbsp;<span class="ident" id="2574591">sockaddr</span><span class="op" id="2574599">(</span><span class="op" id="2574600">)</span>&nbsp;<span class="op" id="2574602">(</span><span class="ident" id="2574603">unsafe</span><span class="op" id="2574609">.</span><span class="ident" id="2574610">Pointer</span><span class="op" id="2574617">,</span>&nbsp;<span class="ident" id="2574619">_Socklen</span><span class="op" id="2574627">,</span>&nbsp;<span class="builtintype" id="2574629">error</span><span class="op" id="2574634">)</span>&nbsp;<span class="op" id="2574636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574639">if</span>&nbsp;<span class="ident" id="2574642">sa</span><span class="op" id="2574644">.</span><span class="ident" id="2574645">Port</span>&nbsp;<span class="op" id="2574650">&lt;</span>&nbsp;<span class="num" id="2574652">0</span>&nbsp;<span class="op" id="2574654">||</span>&nbsp;<span class="ident" id="2574657">sa</span><span class="op" id="2574659">.</span><span class="ident" id="2574660">Port</span>&nbsp;<span class="op" id="2574665">&gt;</span>&nbsp;<span class="num" id="2574667">0xFFFF</span>&nbsp;<span class="op" id="2574674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574678">return</span>&nbsp;<span class="ident" id="2574685">nil</span><span class="op" id="2574688">,</span>&nbsp;<span class="num" id="2574690">0</span><span class="op" id="2574691">,</span>&nbsp;<span class="ident" id="2574693">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2574701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2574704">sa</span><span class="op" id="2574706">.</span><span class="ident" id="2574707">raw</span><span class="op" id="2574710">.</span><span class="ident" id="2574711">Family</span>&nbsp;<span class="op" id="2574718">=</span>&nbsp;<span class="ident" id="2574720">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2574729">p</span>&nbsp;<span class="op" id="2574731">:=</span>&nbsp;<span class="op" id="2574734">(</span><span class="op" id="2574735">*</span><span class="op" id="2574736">[</span><span class="num" id="2574737">2</span><span class="op" id="2574738">]</span><span class="builtintype" id="2574739">byte</span><span class="op" id="2574743">)</span><span class="op" id="2574744">(</span><span class="ident" id="2574745">unsafe</span><span class="op" id="2574751">.</span><span class="ident" id="2574752">Pointer</span><span class="op" id="2574759">(</span><span class="op" id="2574760">&amp;</span><span class="ident" id="2574761">sa</span><span class="op" id="2574763">.</span><span class="ident" id="2574764">raw</span><span class="op" id="2574767">.</span><span class="ident" id="2574768">Port</span><span class="op" id="2574772">)</span><span class="op" id="2574773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2574776">p</span><span class="op" id="2574777">[</span><span class="num" id="2574778">0</span><span class="op" id="2574779">]</span>&nbsp;<span class="op" id="2574781">=</span>&nbsp;<span class="builtintype" id="2574783">byte</span><span class="op" id="2574787">(</span><span class="ident" id="2574788">sa</span><span class="op" id="2574790">.</span><span class="ident" id="2574791">Port</span>&nbsp;<span class="op" id="2574796">&gt;&gt;</span>&nbsp;<span class="num" id="2574799">8</span><span class="op" id="2574800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2574803">p</span><span class="op" id="2574804">[</span><span class="num" id="2574805">1</span><span class="op" id="2574806">]</span>&nbsp;<span class="op" id="2574808">=</span>&nbsp;<span class="builtintype" id="2574810">byte</span><span class="op" id="2574814">(</span><span class="ident" id="2574815">sa</span><span class="op" id="2574817">.</span><span class="ident" id="2574818">Port</span><span class="op" id="2574822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574825">for</span>&nbsp;<span class="ident" id="2574829">i</span>&nbsp;<span class="op" id="2574831">:=</span>&nbsp;<span class="num" id="2574834">0</span><span class="op" id="2574835">;</span>&nbsp;<span class="ident" id="2574837">i</span>&nbsp;<span class="op" id="2574839">&lt;</span>&nbsp;<span class="builtinfunc" id="2574841">len</span><span class="op" id="2574844">(</span><span class="ident" id="2574845">sa</span><span class="op" id="2574847">.</span><span class="ident" id="2574848">Addr</span><span class="op" id="2574852">)</span><span class="op" id="2574853">;</span>&nbsp;<span class="ident" id="2574855">i</span><span class="op" id="2574856">++</span>&nbsp;<span class="op" id="2574859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2574863">sa</span><span class="op" id="2574865">.</span><span class="ident" id="2574866">raw</span><span class="op" id="2574869">.</span><span class="ident" id="2574870">Addr</span><span class="op" id="2574874">[</span><span class="ident" id="2574875">i</span><span class="op" id="2574876">]</span>&nbsp;<span class="op" id="2574878">=</span>&nbsp;<span class="ident" id="2574880">sa</span><span class="op" id="2574882">.</span><span class="ident" id="2574883">Addr</span><span class="op" id="2574887">[</span><span class="ident" id="2574888">i</span><span class="op" id="2574889">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2574892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2574895">return</span>&nbsp;<span class="ident" id="2574902">unsafe</span><span class="op" id="2574908">.</span><span class="ident" id="2574909">Pointer</span><span class="op" id="2574916">(</span><span class="op" id="2574917">&amp;</span><span class="ident" id="2574918">sa</span><span class="op" id="2574920">.</span><span class="ident" id="2574921">raw</span><span class="op" id="2574924">)</span><span class="op" id="2574925">,</span>&nbsp;<span class="ident" id="2574927">SizeofSockaddrInet4</span><span class="op" id="2574946">,</span>&nbsp;<span class="ident" id="2574948">nil</span><br>
<span class="lineno"></span><span class="op" id="2574952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2574955">func</span>&nbsp;<span class="op" id="2574960">(</span><span class="ident" id="2574961">sa</span>&nbsp;<span class="op" id="2574964">*</span><span class="ident" id="2574965">SockaddrInet6</span><span class="op" id="2574978">)</span>&nbsp;<span class="ident" id="2574980">sockaddr</span><span class="op" id="2574988">(</span><span class="op" id="2574989">)</span>&nbsp;<span class="op" id="2574991">(</span><span class="ident" id="2574992">unsafe</span><span class="op" id="2574998">.</span><span class="ident" id="2574999">Pointer</span><span class="op" id="2575006">,</span>&nbsp;<span class="ident" id="2575008">_Socklen</span><span class="op" id="2575016">,</span>&nbsp;<span class="builtintype" id="2575018">error</span><span class="op" id="2575023">)</span>&nbsp;<span class="op" id="2575025">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575028">if</span>&nbsp;<span class="ident" id="2575031">sa</span><span class="op" id="2575033">.</span><span class="ident" id="2575034">Port</span>&nbsp;<span class="op" id="2575039">&lt;</span>&nbsp;<span class="num" id="2575041">0</span>&nbsp;<span class="op" id="2575043">||</span>&nbsp;<span class="ident" id="2575046">sa</span><span class="op" id="2575048">.</span><span class="ident" id="2575049">Port</span>&nbsp;<span class="op" id="2575054">&gt;</span>&nbsp;<span class="num" id="2575056">0xFFFF</span>&nbsp;<span class="op" id="2575063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575067">return</span>&nbsp;<span class="ident" id="2575074">nil</span><span class="op" id="2575077">,</span>&nbsp;<span class="num" id="2575079">0</span><span class="op" id="2575080">,</span>&nbsp;<span class="ident" id="2575082">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575093">sa</span><span class="op" id="2575095">.</span><span class="ident" id="2575096">raw</span><span class="op" id="2575099">.</span><span class="ident" id="2575100">Family</span>&nbsp;<span class="op" id="2575107">=</span>&nbsp;<span class="ident" id="2575109">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575119">p</span>&nbsp;<span class="op" id="2575121">:=</span>&nbsp;<span class="op" id="2575124">(</span><span class="op" id="2575125">*</span><span class="op" id="2575126">[</span><span class="num" id="2575127">2</span><span class="op" id="2575128">]</span><span class="builtintype" id="2575129">byte</span><span class="op" id="2575133">)</span><span class="op" id="2575134">(</span><span class="ident" id="2575135">unsafe</span><span class="op" id="2575141">.</span><span class="ident" id="2575142">Pointer</span><span class="op" id="2575149">(</span><span class="op" id="2575150">&amp;</span><span class="ident" id="2575151">sa</span><span class="op" id="2575153">.</span><span class="ident" id="2575154">raw</span><span class="op" id="2575157">.</span><span class="ident" id="2575158">Port</span><span class="op" id="2575162">)</span><span class="op" id="2575163">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575166">p</span><span class="op" id="2575167">[</span><span class="num" id="2575168">0</span><span class="op" id="2575169">]</span>&nbsp;<span class="op" id="2575171">=</span>&nbsp;<span class="builtintype" id="2575173">byte</span><span class="op" id="2575177">(</span><span class="ident" id="2575178">sa</span><span class="op" id="2575180">.</span><span class="ident" id="2575181">Port</span>&nbsp;<span class="op" id="2575186">&gt;&gt;</span>&nbsp;<span class="num" id="2575189">8</span><span class="op" id="2575190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575193">p</span><span class="op" id="2575194">[</span><span class="num" id="2575195">1</span><span class="op" id="2575196">]</span>&nbsp;<span class="op" id="2575198">=</span>&nbsp;<span class="builtintype" id="2575200">byte</span><span class="op" id="2575204">(</span><span class="ident" id="2575205">sa</span><span class="op" id="2575207">.</span><span class="ident" id="2575208">Port</span><span class="op" id="2575212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575215">sa</span><span class="op" id="2575217">.</span><span class="ident" id="2575218">raw</span><span class="op" id="2575221">.</span><span class="ident" id="2575222">Scope_id</span>&nbsp;<span class="op" id="2575231">=</span>&nbsp;<span class="ident" id="2575233">sa</span><span class="op" id="2575235">.</span><span class="ident" id="2575236">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575244">for</span>&nbsp;<span class="ident" id="2575248">i</span>&nbsp;<span class="op" id="2575250">:=</span>&nbsp;<span class="num" id="2575253">0</span><span class="op" id="2575254">;</span>&nbsp;<span class="ident" id="2575256">i</span>&nbsp;<span class="op" id="2575258">&lt;</span>&nbsp;<span class="builtinfunc" id="2575260">len</span><span class="op" id="2575263">(</span><span class="ident" id="2575264">sa</span><span class="op" id="2575266">.</span><span class="ident" id="2575267">Addr</span><span class="op" id="2575271">)</span><span class="op" id="2575272">;</span>&nbsp;<span class="ident" id="2575274">i</span><span class="op" id="2575275">++</span>&nbsp;<span class="op" id="2575278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575282">sa</span><span class="op" id="2575284">.</span><span class="ident" id="2575285">raw</span><span class="op" id="2575288">.</span><span class="ident" id="2575289">Addr</span><span class="op" id="2575293">[</span><span class="ident" id="2575294">i</span><span class="op" id="2575295">]</span>&nbsp;<span class="op" id="2575297">=</span>&nbsp;<span class="ident" id="2575299">sa</span><span class="op" id="2575301">.</span><span class="ident" id="2575302">Addr</span><span class="op" id="2575306">[</span><span class="ident" id="2575307">i</span><span class="op" id="2575308">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575314">return</span>&nbsp;<span class="ident" id="2575321">unsafe</span><span class="op" id="2575327">.</span><span class="ident" id="2575328">Pointer</span><span class="op" id="2575335">(</span><span class="op" id="2575336">&amp;</span><span class="ident" id="2575337">sa</span><span class="op" id="2575339">.</span><span class="ident" id="2575340">raw</span><span class="op" id="2575343">)</span><span class="op" id="2575344">,</span>&nbsp;<span class="ident" id="2575346">SizeofSockaddrInet6</span><span class="op" id="2575365">,</span>&nbsp;<span class="ident" id="2575367">nil</span><br>
<span class="lineno"></span><span class="op" id="2575371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2575374">func</span>&nbsp;<span class="op" id="2575379">(</span><span class="ident" id="2575380">sa</span>&nbsp;<span class="op" id="2575383">*</span><span class="ident" id="2575384">SockaddrUnix</span><span class="op" id="2575396">)</span>&nbsp;<span class="ident" id="2575398">sockaddr</span><span class="op" id="2575406">(</span><span class="op" id="2575407">)</span>&nbsp;<span class="op" id="2575409">(</span><span class="ident" id="2575410">unsafe</span><span class="op" id="2575416">.</span><span class="ident" id="2575417">Pointer</span><span class="op" id="2575424">,</span>&nbsp;<span class="ident" id="2575426">_Socklen</span><span class="op" id="2575434">,</span>&nbsp;<span class="builtintype" id="2575436">error</span><span class="op" id="2575441">)</span>&nbsp;<span class="op" id="2575443">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575446">name</span>&nbsp;<span class="op" id="2575451">:=</span>&nbsp;<span class="ident" id="2575454">sa</span><span class="op" id="2575456">.</span><span class="ident" id="2575457">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575463">n</span>&nbsp;<span class="op" id="2575465">:=</span>&nbsp;<span class="builtinfunc" id="2575468">len</span><span class="op" id="2575471">(</span><span class="ident" id="2575472">name</span><span class="op" id="2575476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575479">if</span>&nbsp;<span class="ident" id="2575482">n</span>&nbsp;<span class="op" id="2575484">&gt;=</span>&nbsp;<span class="builtinfunc" id="2575487">len</span><span class="op" id="2575490">(</span><span class="ident" id="2575491">sa</span><span class="op" id="2575493">.</span><span class="ident" id="2575494">raw</span><span class="op" id="2575497">.</span><span class="ident" id="2575498">Path</span><span class="op" id="2575502">)</span>&nbsp;<span class="op" id="2575504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575508">return</span>&nbsp;<span class="ident" id="2575515">nil</span><span class="op" id="2575518">,</span>&nbsp;<span class="num" id="2575520">0</span><span class="op" id="2575521">,</span>&nbsp;<span class="ident" id="2575523">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575531">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575534">sa</span><span class="op" id="2575536">.</span><span class="ident" id="2575537">raw</span><span class="op" id="2575540">.</span><span class="ident" id="2575541">Family</span>&nbsp;<span class="op" id="2575548">=</span>&nbsp;<span class="ident" id="2575550">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575559">for</span>&nbsp;<span class="ident" id="2575563">i</span>&nbsp;<span class="op" id="2575565">:=</span>&nbsp;<span class="num" id="2575568">0</span><span class="op" id="2575569">;</span>&nbsp;<span class="ident" id="2575571">i</span>&nbsp;<span class="op" id="2575573">&lt;</span>&nbsp;<span class="ident" id="2575575">n</span><span class="op" id="2575576">;</span>&nbsp;<span class="ident" id="2575578">i</span><span class="op" id="2575579">++</span>&nbsp;<span class="op" id="2575582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575586">sa</span><span class="op" id="2575588">.</span><span class="ident" id="2575589">raw</span><span class="op" id="2575592">.</span><span class="ident" id="2575593">Path</span><span class="op" id="2575597">[</span><span class="ident" id="2575598">i</span><span class="op" id="2575599">]</span>&nbsp;<span class="op" id="2575601">=</span>&nbsp;<span class="builtintype" id="2575603">int8</span><span class="op" id="2575607">(</span><span class="ident" id="2575608">name</span><span class="op" id="2575612">[</span><span class="ident" id="2575613">i</span><span class="op" id="2575614">]</span><span class="op" id="2575615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2575621">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575663">sl</span>&nbsp;<span class="op" id="2575666">:=</span>&nbsp;<span class="ident" id="2575669">_Socklen</span><span class="op" id="2575677">(</span><span class="num" id="2575678">2</span><span class="op" id="2575679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575682">if</span>&nbsp;<span class="ident" id="2575685">n</span>&nbsp;<span class="op" id="2575687">&gt;</span>&nbsp;<span class="num" id="2575689">0</span>&nbsp;<span class="op" id="2575691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575695">sl</span>&nbsp;<span class="op" id="2575698">+=</span>&nbsp;<span class="ident" id="2575701">_Socklen</span><span class="op" id="2575709">(</span><span class="ident" id="2575710">n</span><span class="op" id="2575711">)</span>&nbsp;<span class="op" id="2575713">+</span>&nbsp;<span class="num" id="2575715">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575721">if</span>&nbsp;<span class="ident" id="2575724">sa</span><span class="op" id="2575726">.</span><span class="ident" id="2575727">raw</span><span class="op" id="2575730">.</span><span class="ident" id="2575731">Path</span><span class="op" id="2575735">[</span><span class="num" id="2575736">0</span><span class="op" id="2575737">]</span>&nbsp;<span class="op" id="2575739">==</span>&nbsp;<span class="string" id="2575742">&#39;@&#39;</span>&nbsp;<span class="op" id="2575746">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575750">sa</span><span class="op" id="2575752">.</span><span class="ident" id="2575753">raw</span><span class="op" id="2575756">.</span><span class="ident" id="2575757">Path</span><span class="op" id="2575761">[</span><span class="num" id="2575762">0</span><span class="op" id="2575763">]</span>&nbsp;<span class="op" id="2575765">=</span>&nbsp;<span class="num" id="2575767">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2575771">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575823">sl</span><span class="op" id="2575825">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2575833">return</span>&nbsp;<span class="ident" id="2575840">unsafe</span><span class="op" id="2575846">.</span><span class="ident" id="2575847">Pointer</span><span class="op" id="2575854">(</span><span class="op" id="2575855">&amp;</span><span class="ident" id="2575856">sa</span><span class="op" id="2575858">.</span><span class="ident" id="2575859">raw</span><span class="op" id="2575862">)</span><span class="op" id="2575863">,</span>&nbsp;<span class="ident" id="2575865">sl</span><span class="op" id="2575867">,</span>&nbsp;<span class="ident" id="2575869">nil</span><br>
<span class="lineno"></span><span class="op" id="2575873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2575876">type</span>&nbsp;<span class="ident" id="2575881">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2575899">struct</span>&nbsp;<span class="op" id="2575906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575909">Protocol</span>&nbsp;<span class="builtintype" id="2575918">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575926">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2575935">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575940">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2575949">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575957">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2575966">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575973">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2575982">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2575989">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2575998">[</span><span class="num" id="2575999">8</span><span class="op" id="2576000">]</span><span class="builtintype" id="2576001">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576007">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576016">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2576037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2576040">func</span>&nbsp;<span class="op" id="2576045">(</span><span class="ident" id="2576046">sa</span>&nbsp;<span class="op" id="2576049">*</span><span class="ident" id="2576050">SockaddrLinklayer</span><span class="op" id="2576067">)</span>&nbsp;<span class="ident" id="2576069">sockaddr</span><span class="op" id="2576077">(</span><span class="op" id="2576078">)</span>&nbsp;<span class="op" id="2576080">(</span><span class="ident" id="2576081">unsafe</span><span class="op" id="2576087">.</span><span class="ident" id="2576088">Pointer</span><span class="op" id="2576095">,</span>&nbsp;<span class="ident" id="2576097">_Socklen</span><span class="op" id="2576105">,</span>&nbsp;<span class="builtintype" id="2576107">error</span><span class="op" id="2576112">)</span>&nbsp;<span class="op" id="2576114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576117">if</span>&nbsp;<span class="ident" id="2576120">sa</span><span class="op" id="2576122">.</span><span class="ident" id="2576123">Ifindex</span>&nbsp;<span class="op" id="2576131">&lt;</span>&nbsp;<span class="num" id="2576133">0</span>&nbsp;<span class="op" id="2576135">||</span>&nbsp;<span class="ident" id="2576138">sa</span><span class="op" id="2576140">.</span><span class="ident" id="2576141">Ifindex</span>&nbsp;<span class="op" id="2576149">&gt;</span>&nbsp;<span class="num" id="2576151">0x7fffffff</span>&nbsp;<span class="op" id="2576162">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576166">return</span>&nbsp;<span class="ident" id="2576173">nil</span><span class="op" id="2576176">,</span>&nbsp;<span class="num" id="2576178">0</span><span class="op" id="2576179">,</span>&nbsp;<span class="ident" id="2576181">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2576189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576192">sa</span><span class="op" id="2576194">.</span><span class="ident" id="2576195">raw</span><span class="op" id="2576198">.</span><span class="ident" id="2576199">Family</span>&nbsp;<span class="op" id="2576206">=</span>&nbsp;<span class="ident" id="2576208">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576219">sa</span><span class="op" id="2576221">.</span><span class="ident" id="2576222">raw</span><span class="op" id="2576225">.</span><span class="ident" id="2576226">Protocol</span>&nbsp;<span class="op" id="2576235">=</span>&nbsp;<span class="ident" id="2576237">sa</span><span class="op" id="2576239">.</span><span class="ident" id="2576240">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576250">sa</span><span class="op" id="2576252">.</span><span class="ident" id="2576253">raw</span><span class="op" id="2576256">.</span><span class="ident" id="2576257">Ifindex</span>&nbsp;<span class="op" id="2576265">=</span>&nbsp;<span class="builtintype" id="2576267">int32</span><span class="op" id="2576272">(</span><span class="ident" id="2576273">sa</span><span class="op" id="2576275">.</span><span class="ident" id="2576276">Ifindex</span><span class="op" id="2576283">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576286">sa</span><span class="op" id="2576288">.</span><span class="ident" id="2576289">raw</span><span class="op" id="2576292">.</span><span class="ident" id="2576293">Hatype</span>&nbsp;<span class="op" id="2576300">=</span>&nbsp;<span class="ident" id="2576302">sa</span><span class="op" id="2576304">.</span><span class="ident" id="2576305">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576313">sa</span><span class="op" id="2576315">.</span><span class="ident" id="2576316">raw</span><span class="op" id="2576319">.</span><span class="ident" id="2576320">Pkttype</span>&nbsp;<span class="op" id="2576328">=</span>&nbsp;<span class="ident" id="2576330">sa</span><span class="op" id="2576332">.</span><span class="ident" id="2576333">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576342">sa</span><span class="op" id="2576344">.</span><span class="ident" id="2576345">raw</span><span class="op" id="2576348">.</span><span class="ident" id="2576349">Halen</span>&nbsp;<span class="op" id="2576355">=</span>&nbsp;<span class="ident" id="2576357">sa</span><span class="op" id="2576359">.</span><span class="ident" id="2576360">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576367">for</span>&nbsp;<span class="ident" id="2576371">i</span>&nbsp;<span class="op" id="2576373">:=</span>&nbsp;<span class="num" id="2576376">0</span><span class="op" id="2576377">;</span>&nbsp;<span class="ident" id="2576379">i</span>&nbsp;<span class="op" id="2576381">&lt;</span>&nbsp;<span class="builtinfunc" id="2576383">len</span><span class="op" id="2576386">(</span><span class="ident" id="2576387">sa</span><span class="op" id="2576389">.</span><span class="ident" id="2576390">Addr</span><span class="op" id="2576394">)</span><span class="op" id="2576395">;</span>&nbsp;<span class="ident" id="2576397">i</span><span class="op" id="2576398">++</span>&nbsp;<span class="op" id="2576401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576405">sa</span><span class="op" id="2576407">.</span><span class="ident" id="2576408">raw</span><span class="op" id="2576411">.</span><span class="ident" id="2576412">Addr</span><span class="op" id="2576416">[</span><span class="ident" id="2576417">i</span><span class="op" id="2576418">]</span>&nbsp;<span class="op" id="2576420">=</span>&nbsp;<span class="ident" id="2576422">sa</span><span class="op" id="2576424">.</span><span class="ident" id="2576425">Addr</span><span class="op" id="2576429">[</span><span class="ident" id="2576430">i</span><span class="op" id="2576431">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2576434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576437">return</span>&nbsp;<span class="ident" id="2576444">unsafe</span><span class="op" id="2576450">.</span><span class="ident" id="2576451">Pointer</span><span class="op" id="2576458">(</span><span class="op" id="2576459">&amp;</span><span class="ident" id="2576460">sa</span><span class="op" id="2576462">.</span><span class="ident" id="2576463">raw</span><span class="op" id="2576466">)</span><span class="op" id="2576467">,</span>&nbsp;<span class="ident" id="2576469">SizeofSockaddrLinklayer</span><span class="op" id="2576492">,</span>&nbsp;<span class="ident" id="2576494">nil</span><br>
<span class="lineno"></span><span class="op" id="2576498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2576501">type</span>&nbsp;<span class="ident" id="2576506">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2576522">struct</span>&nbsp;<span class="op" id="2576529">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576532">Family</span>&nbsp;<span class="builtintype" id="2576539">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576547">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2576554">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576562">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2576569">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576577">Groups</span>&nbsp;<span class="builtintype" id="2576584">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576592">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576599">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2576618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2576621">func</span>&nbsp;<span class="op" id="2576626">(</span><span class="ident" id="2576627">sa</span>&nbsp;<span class="op" id="2576630">*</span><span class="ident" id="2576631">SockaddrNetlink</span><span class="op" id="2576646">)</span>&nbsp;<span class="ident" id="2576648">sockaddr</span><span class="op" id="2576656">(</span><span class="op" id="2576657">)</span>&nbsp;<span class="op" id="2576659">(</span><span class="ident" id="2576660">unsafe</span><span class="op" id="2576666">.</span><span class="ident" id="2576667">Pointer</span><span class="op" id="2576674">,</span>&nbsp;<span class="ident" id="2576676">_Socklen</span><span class="op" id="2576684">,</span>&nbsp;<span class="builtintype" id="2576686">error</span><span class="op" id="2576691">)</span>&nbsp;<span class="op" id="2576693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576696">sa</span><span class="op" id="2576698">.</span><span class="ident" id="2576699">raw</span><span class="op" id="2576702">.</span><span class="ident" id="2576703">Family</span>&nbsp;<span class="op" id="2576710">=</span>&nbsp;<span class="ident" id="2576712">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576724">sa</span><span class="op" id="2576726">.</span><span class="ident" id="2576727">raw</span><span class="op" id="2576730">.</span><span class="ident" id="2576731">Pad</span>&nbsp;<span class="op" id="2576735">=</span>&nbsp;<span class="ident" id="2576737">sa</span><span class="op" id="2576739">.</span><span class="ident" id="2576740">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576745">sa</span><span class="op" id="2576747">.</span><span class="ident" id="2576748">raw</span><span class="op" id="2576751">.</span><span class="ident" id="2576752">Pid</span>&nbsp;<span class="op" id="2576756">=</span>&nbsp;<span class="ident" id="2576758">sa</span><span class="op" id="2576760">.</span><span class="ident" id="2576761">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576766">sa</span><span class="op" id="2576768">.</span><span class="ident" id="2576769">raw</span><span class="op" id="2576772">.</span><span class="ident" id="2576773">Groups</span>&nbsp;<span class="op" id="2576780">=</span>&nbsp;<span class="ident" id="2576782">sa</span><span class="op" id="2576784">.</span><span class="ident" id="2576785">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576793">return</span>&nbsp;<span class="ident" id="2576800">unsafe</span><span class="op" id="2576806">.</span><span class="ident" id="2576807">Pointer</span><span class="op" id="2576814">(</span><span class="op" id="2576815">&amp;</span><span class="ident" id="2576816">sa</span><span class="op" id="2576818">.</span><span class="ident" id="2576819">raw</span><span class="op" id="2576822">)</span><span class="op" id="2576823">,</span>&nbsp;<span class="ident" id="2576825">SizeofSockaddrNetlink</span><span class="op" id="2576846">,</span>&nbsp;<span class="ident" id="2576848">nil</span><br>
<span class="lineno"></span><span class="op" id="2576852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2576855">func</span>&nbsp;<span class="ident" id="2576860">anyToSockaddr</span><span class="op" id="2576873">(</span><span class="ident" id="2576874">rsa</span>&nbsp;<span class="op" id="2576878">*</span><span class="ident" id="2576879">RawSockaddrAny</span><span class="op" id="2576893">)</span>&nbsp;<span class="op" id="2576895">(</span><span class="ident" id="2576896">Sockaddr</span><span class="op" id="2576904">,</span>&nbsp;<span class="builtintype" id="2576906">error</span><span class="op" id="2576911">)</span>&nbsp;<span class="op" id="2576913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576916">switch</span>&nbsp;<span class="ident" id="2576923">rsa</span><span class="op" id="2576926">.</span><span class="ident" id="2576927">Addr</span><span class="op" id="2576931">.</span><span class="ident" id="2576932">Family</span>&nbsp;<span class="op" id="2576939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2576942">case</span>&nbsp;<span class="ident" id="2576947">AF_NETLINK</span><span class="op" id="2576957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2576961">pp</span>&nbsp;<span class="op" id="2576964">:=</span>&nbsp;<span class="op" id="2576967">(</span><span class="op" id="2576968">*</span><span class="ident" id="2576969">RawSockaddrNetlink</span><span class="op" id="2576987">)</span><span class="op" id="2576988">(</span><span class="ident" id="2576989">unsafe</span><span class="op" id="2576995">.</span><span class="ident" id="2576996">Pointer</span><span class="op" id="2577003">(</span><span class="ident" id="2577004">rsa</span><span class="op" id="2577007">)</span><span class="op" id="2577008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577012">sa</span>&nbsp;<span class="op" id="2577015">:=</span>&nbsp;<span class="builtinfunc" id="2577018">new</span><span class="op" id="2577021">(</span><span class="ident" id="2577022">SockaddrNetlink</span><span class="op" id="2577037">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577041">sa</span><span class="op" id="2577043">.</span><span class="ident" id="2577044">Family</span>&nbsp;<span class="op" id="2577051">=</span>&nbsp;<span class="ident" id="2577053">pp</span><span class="op" id="2577055">.</span><span class="ident" id="2577056">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577065">sa</span><span class="op" id="2577067">.</span><span class="ident" id="2577068">Pad</span>&nbsp;<span class="op" id="2577072">=</span>&nbsp;<span class="ident" id="2577074">pp</span><span class="op" id="2577076">.</span><span class="ident" id="2577077">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577083">sa</span><span class="op" id="2577085">.</span><span class="ident" id="2577086">Pid</span>&nbsp;<span class="op" id="2577090">=</span>&nbsp;<span class="ident" id="2577092">pp</span><span class="op" id="2577094">.</span><span class="ident" id="2577095">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577101">sa</span><span class="op" id="2577103">.</span><span class="ident" id="2577104">Groups</span>&nbsp;<span class="op" id="2577111">=</span>&nbsp;<span class="ident" id="2577113">pp</span><span class="op" id="2577115">.</span><span class="ident" id="2577116">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2577125">return</span>&nbsp;<span class="ident" id="2577132">sa</span><span class="op" id="2577134">,</span>&nbsp;<span class="ident" id="2577136">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2577142">case</span>&nbsp;<span class="ident" id="2577147">AF_PACKET</span><span class="op" id="2577156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577160">pp</span>&nbsp;<span class="op" id="2577163">:=</span>&nbsp;<span class="op" id="2577166">(</span><span class="op" id="2577167">*</span><span class="ident" id="2577168">RawSockaddrLinklayer</span><span class="op" id="2577188">)</span><span class="op" id="2577189">(</span><span class="ident" id="2577190">unsafe</span><span class="op" id="2577196">.</span><span class="ident" id="2577197">Pointer</span><span class="op" id="2577204">(</span><span class="ident" id="2577205">rsa</span><span class="op" id="2577208">)</span><span class="op" id="2577209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577213">sa</span>&nbsp;<span class="op" id="2577216">:=</span>&nbsp;<span class="builtinfunc" id="2577219">new</span><span class="op" id="2577222">(</span><span class="ident" id="2577223">SockaddrLinklayer</span><span class="op" id="2577240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577244">sa</span><span class="op" id="2577246">.</span><span class="ident" id="2577247">Protocol</span>&nbsp;<span class="op" id="2577256">=</span>&nbsp;<span class="ident" id="2577258">pp</span><span class="op" id="2577260">.</span><span class="ident" id="2577261">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577272">sa</span><span class="op" id="2577274">.</span><span class="ident" id="2577275">Ifindex</span>&nbsp;<span class="op" id="2577283">=</span>&nbsp;<span class="builtintype" id="2577285">int</span><span class="op" id="2577288">(</span><span class="ident" id="2577289">pp</span><span class="op" id="2577291">.</span><span class="ident" id="2577292">Ifindex</span><span class="op" id="2577299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577303">sa</span><span class="op" id="2577305">.</span><span class="ident" id="2577306">Hatype</span>&nbsp;<span class="op" id="2577313">=</span>&nbsp;<span class="ident" id="2577315">pp</span><span class="op" id="2577317">.</span><span class="ident" id="2577318">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577327">sa</span><span class="op" id="2577329">.</span><span class="ident" id="2577330">Pkttype</span>&nbsp;<span class="op" id="2577338">=</span>&nbsp;<span class="ident" id="2577340">pp</span><span class="op" id="2577342">.</span><span class="ident" id="2577343">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577353">sa</span><span class="op" id="2577355">.</span><span class="ident" id="2577356">Halen</span>&nbsp;<span class="op" id="2577362">=</span>&nbsp;<span class="ident" id="2577364">pp</span><span class="op" id="2577366">.</span><span class="ident" id="2577367">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2577375">for</span>&nbsp;<span class="ident" id="2577379">i</span>&nbsp;<span class="op" id="2577381">:=</span>&nbsp;<span class="num" id="2577384">0</span><span class="op" id="2577385">;</span>&nbsp;<span class="ident" id="2577387">i</span>&nbsp;<span class="op" id="2577389">&lt;</span>&nbsp;<span class="builtinfunc" id="2577391">len</span><span class="op" id="2577394">(</span><span class="ident" id="2577395">sa</span><span class="op" id="2577397">.</span><span class="ident" id="2577398">Addr</span><span class="op" id="2577402">)</span><span class="op" id="2577403">;</span>&nbsp;<span class="ident" id="2577405">i</span><span class="op" id="2577406">++</span>&nbsp;<span class="op" id="2577409">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577414">sa</span><span class="op" id="2577416">.</span><span class="ident" id="2577417">Addr</span><span class="op" id="2577421">[</span><span class="ident" id="2577422">i</span><span class="op" id="2577423">]</span>&nbsp;<span class="op" id="2577425">=</span>&nbsp;<span class="ident" id="2577427">pp</span><span class="op" id="2577429">.</span><span class="ident" id="2577430">Addr</span><span class="op" id="2577434">[</span><span class="ident" id="2577435">i</span><span class="op" id="2577436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2577440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2577444">return</span>&nbsp;<span class="ident" id="2577451">sa</span><span class="op" id="2577453">,</span>&nbsp;<span class="ident" id="2577455">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2577461">case</span>&nbsp;<span class="ident" id="2577466">AF_UNIX</span><span class="op" id="2577473">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577477">pp</span>&nbsp;<span class="op" id="2577480">:=</span>&nbsp;<span class="op" id="2577483">(</span><span class="op" id="2577484">*</span><span class="ident" id="2577485">RawSockaddrUnix</span><span class="op" id="2577500">)</span><span class="op" id="2577501">(</span><span class="ident" id="2577502">unsafe</span><span class="op" id="2577508">.</span><span class="ident" id="2577509">Pointer</span><span class="op" id="2577516">(</span><span class="ident" id="2577517">rsa</span><span class="op" id="2577520">)</span><span class="op" id="2577521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577525">sa</span>&nbsp;<span class="op" id="2577528">:=</span>&nbsp;<span class="builtinfunc" id="2577531">new</span><span class="op" id="2577534">(</span><span class="ident" id="2577535">SockaddrUnix</span><span class="op" id="2577547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2577551">if</span>&nbsp;<span class="ident" id="2577554">pp</span><span class="op" id="2577556">.</span><span class="ident" id="2577557">Path</span><span class="op" id="2577561">[</span><span class="num" id="2577562">0</span><span class="op" id="2577563">]</span>&nbsp;<span class="op" id="2577565">==</span>&nbsp;<span class="num" id="2577568">0</span>&nbsp;<span class="op" id="2577570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577575">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577612">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577664">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577705">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577747">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2577787">pp</span><span class="op" id="2577789">.</span><span class="ident" id="2577790">Path</span><span class="op" id="2577794">[</span><span class="num" id="2577795">0</span><span class="op" id="2577796">]</span>&nbsp;<span class="op" id="2577798">=</span>&nbsp;<span class="string" id="2577800">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2577806">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577811">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577841">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577894">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2577947">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2578001">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578037">n</span>&nbsp;<span class="op" id="2578039">:=</span>&nbsp;<span class="num" id="2578042">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578046">for</span>&nbsp;<span class="ident" id="2578050">n</span>&nbsp;<span class="op" id="2578052">&lt;</span>&nbsp;<span class="builtinfunc" id="2578054">len</span><span class="op" id="2578057">(</span><span class="ident" id="2578058">pp</span><span class="op" id="2578060">.</span><span class="ident" id="2578061">Path</span><span class="op" id="2578065">)</span>&nbsp;<span class="op" id="2578067">&amp;&amp;</span>&nbsp;<span class="ident" id="2578070">pp</span><span class="op" id="2578072">.</span><span class="ident" id="2578073">Path</span><span class="op" id="2578077">[</span><span class="ident" id="2578078">n</span><span class="op" id="2578079">]</span>&nbsp;<span class="op" id="2578081">!=</span>&nbsp;<span class="num" id="2578084">0</span>&nbsp;<span class="op" id="2578086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578091">n</span><span class="op" id="2578092">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2578097">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578101">bytes</span>&nbsp;<span class="op" id="2578107">:=</span>&nbsp;<span class="op" id="2578110">(</span><span class="op" id="2578111">*</span><span class="op" id="2578112">[</span><span class="num" id="2578113">10000</span><span class="op" id="2578118">]</span><span class="builtintype" id="2578119">byte</span><span class="op" id="2578123">)</span><span class="op" id="2578124">(</span><span class="ident" id="2578125">unsafe</span><span class="op" id="2578131">.</span><span class="ident" id="2578132">Pointer</span><span class="op" id="2578139">(</span><span class="op" id="2578140">&amp;</span><span class="ident" id="2578141">pp</span><span class="op" id="2578143">.</span><span class="ident" id="2578144">Path</span><span class="op" id="2578148">[</span><span class="num" id="2578149">0</span><span class="op" id="2578150">]</span><span class="op" id="2578151">)</span><span class="op" id="2578152">)</span><span class="op" id="2578153">[</span><span class="num" id="2578154">0</span><span class="op" id="2578155">:</span><span class="ident" id="2578156">n</span><span class="op" id="2578157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578161">sa</span><span class="op" id="2578163">.</span><span class="ident" id="2578164">Name</span>&nbsp;<span class="op" id="2578169">=</span>&nbsp;<span class="builtintype" id="2578171">string</span><span class="op" id="2578177">(</span><span class="ident" id="2578178">bytes</span><span class="op" id="2578183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578187">return</span>&nbsp;<span class="ident" id="2578194">sa</span><span class="op" id="2578196">,</span>&nbsp;<span class="ident" id="2578198">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578204">case</span>&nbsp;<span class="ident" id="2578209">AF_INET</span><span class="op" id="2578216">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578220">pp</span>&nbsp;<span class="op" id="2578223">:=</span>&nbsp;<span class="op" id="2578226">(</span><span class="op" id="2578227">*</span><span class="ident" id="2578228">RawSockaddrInet4</span><span class="op" id="2578244">)</span><span class="op" id="2578245">(</span><span class="ident" id="2578246">unsafe</span><span class="op" id="2578252">.</span><span class="ident" id="2578253">Pointer</span><span class="op" id="2578260">(</span><span class="ident" id="2578261">rsa</span><span class="op" id="2578264">)</span><span class="op" id="2578265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578269">sa</span>&nbsp;<span class="op" id="2578272">:=</span>&nbsp;<span class="builtinfunc" id="2578275">new</span><span class="op" id="2578278">(</span><span class="ident" id="2578279">SockaddrInet4</span><span class="op" id="2578292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578296">p</span>&nbsp;<span class="op" id="2578298">:=</span>&nbsp;<span class="op" id="2578301">(</span><span class="op" id="2578302">*</span><span class="op" id="2578303">[</span><span class="num" id="2578304">2</span><span class="op" id="2578305">]</span><span class="builtintype" id="2578306">byte</span><span class="op" id="2578310">)</span><span class="op" id="2578311">(</span><span class="ident" id="2578312">unsafe</span><span class="op" id="2578318">.</span><span class="ident" id="2578319">Pointer</span><span class="op" id="2578326">(</span><span class="op" id="2578327">&amp;</span><span class="ident" id="2578328">pp</span><span class="op" id="2578330">.</span><span class="ident" id="2578331">Port</span><span class="op" id="2578335">)</span><span class="op" id="2578336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578340">sa</span><span class="op" id="2578342">.</span><span class="ident" id="2578343">Port</span>&nbsp;<span class="op" id="2578348">=</span>&nbsp;<span class="builtintype" id="2578350">int</span><span class="op" id="2578353">(</span><span class="ident" id="2578354">p</span><span class="op" id="2578355">[</span><span class="num" id="2578356">0</span><span class="op" id="2578357">]</span><span class="op" id="2578358">)</span><span class="op" id="2578359">&lt;&lt;</span><span class="num" id="2578361">8</span>&nbsp;<span class="op" id="2578363">+</span>&nbsp;<span class="builtintype" id="2578365">int</span><span class="op" id="2578368">(</span><span class="ident" id="2578369">p</span><span class="op" id="2578370">[</span><span class="num" id="2578371">1</span><span class="op" id="2578372">]</span><span class="op" id="2578373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578377">for</span>&nbsp;<span class="ident" id="2578381">i</span>&nbsp;<span class="op" id="2578383">:=</span>&nbsp;<span class="num" id="2578386">0</span><span class="op" id="2578387">;</span>&nbsp;<span class="ident" id="2578389">i</span>&nbsp;<span class="op" id="2578391">&lt;</span>&nbsp;<span class="builtinfunc" id="2578393">len</span><span class="op" id="2578396">(</span><span class="ident" id="2578397">sa</span><span class="op" id="2578399">.</span><span class="ident" id="2578400">Addr</span><span class="op" id="2578404">)</span><span class="op" id="2578405">;</span>&nbsp;<span class="ident" id="2578407">i</span><span class="op" id="2578408">++</span>&nbsp;<span class="op" id="2578411">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578416">sa</span><span class="op" id="2578418">.</span><span class="ident" id="2578419">Addr</span><span class="op" id="2578423">[</span><span class="ident" id="2578424">i</span><span class="op" id="2578425">]</span>&nbsp;<span class="op" id="2578427">=</span>&nbsp;<span class="ident" id="2578429">pp</span><span class="op" id="2578431">.</span><span class="ident" id="2578432">Addr</span><span class="op" id="2578436">[</span><span class="ident" id="2578437">i</span><span class="op" id="2578438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2578442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578446">return</span>&nbsp;<span class="ident" id="2578453">sa</span><span class="op" id="2578455">,</span>&nbsp;<span class="ident" id="2578457">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578463">case</span>&nbsp;<span class="ident" id="2578468">AF_INET6</span><span class="op" id="2578476">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578480">pp</span>&nbsp;<span class="op" id="2578483">:=</span>&nbsp;<span class="op" id="2578486">(</span><span class="op" id="2578487">*</span><span class="ident" id="2578488">RawSockaddrInet6</span><span class="op" id="2578504">)</span><span class="op" id="2578505">(</span><span class="ident" id="2578506">unsafe</span><span class="op" id="2578512">.</span><span class="ident" id="2578513">Pointer</span><span class="op" id="2578520">(</span><span class="ident" id="2578521">rsa</span><span class="op" id="2578524">)</span><span class="op" id="2578525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578529">sa</span>&nbsp;<span class="op" id="2578532">:=</span>&nbsp;<span class="builtinfunc" id="2578535">new</span><span class="op" id="2578538">(</span><span class="ident" id="2578539">SockaddrInet6</span><span class="op" id="2578552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578556">p</span>&nbsp;<span class="op" id="2578558">:=</span>&nbsp;<span class="op" id="2578561">(</span><span class="op" id="2578562">*</span><span class="op" id="2578563">[</span><span class="num" id="2578564">2</span><span class="op" id="2578565">]</span><span class="builtintype" id="2578566">byte</span><span class="op" id="2578570">)</span><span class="op" id="2578571">(</span><span class="ident" id="2578572">unsafe</span><span class="op" id="2578578">.</span><span class="ident" id="2578579">Pointer</span><span class="op" id="2578586">(</span><span class="op" id="2578587">&amp;</span><span class="ident" id="2578588">pp</span><span class="op" id="2578590">.</span><span class="ident" id="2578591">Port</span><span class="op" id="2578595">)</span><span class="op" id="2578596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578600">sa</span><span class="op" id="2578602">.</span><span class="ident" id="2578603">Port</span>&nbsp;<span class="op" id="2578608">=</span>&nbsp;<span class="builtintype" id="2578610">int</span><span class="op" id="2578613">(</span><span class="ident" id="2578614">p</span><span class="op" id="2578615">[</span><span class="num" id="2578616">0</span><span class="op" id="2578617">]</span><span class="op" id="2578618">)</span><span class="op" id="2578619">&lt;&lt;</span><span class="num" id="2578621">8</span>&nbsp;<span class="op" id="2578623">+</span>&nbsp;<span class="builtintype" id="2578625">int</span><span class="op" id="2578628">(</span><span class="ident" id="2578629">p</span><span class="op" id="2578630">[</span><span class="num" id="2578631">1</span><span class="op" id="2578632">]</span><span class="op" id="2578633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578637">sa</span><span class="op" id="2578639">.</span><span class="ident" id="2578640">ZoneId</span>&nbsp;<span class="op" id="2578647">=</span>&nbsp;<span class="ident" id="2578649">pp</span><span class="op" id="2578651">.</span><span class="ident" id="2578652">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578663">for</span>&nbsp;<span class="ident" id="2578667">i</span>&nbsp;<span class="op" id="2578669">:=</span>&nbsp;<span class="num" id="2578672">0</span><span class="op" id="2578673">;</span>&nbsp;<span class="ident" id="2578675">i</span>&nbsp;<span class="op" id="2578677">&lt;</span>&nbsp;<span class="builtinfunc" id="2578679">len</span><span class="op" id="2578682">(</span><span class="ident" id="2578683">sa</span><span class="op" id="2578685">.</span><span class="ident" id="2578686">Addr</span><span class="op" id="2578690">)</span><span class="op" id="2578691">;</span>&nbsp;<span class="ident" id="2578693">i</span><span class="op" id="2578694">++</span>&nbsp;<span class="op" id="2578697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578702">sa</span><span class="op" id="2578704">.</span><span class="ident" id="2578705">Addr</span><span class="op" id="2578709">[</span><span class="ident" id="2578710">i</span><span class="op" id="2578711">]</span>&nbsp;<span class="op" id="2578713">=</span>&nbsp;<span class="ident" id="2578715">pp</span><span class="op" id="2578717">.</span><span class="ident" id="2578718">Addr</span><span class="op" id="2578722">[</span><span class="ident" id="2578723">i</span><span class="op" id="2578724">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2578728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578732">return</span>&nbsp;<span class="ident" id="2578739">sa</span><span class="op" id="2578741">,</span>&nbsp;<span class="ident" id="2578743">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2578748">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578751">return</span>&nbsp;<span class="ident" id="2578758">nil</span><span class="op" id="2578761">,</span>&nbsp;<span class="ident" id="2578763">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2578776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2578779">func</span>&nbsp;<span class="ident" id="2578784">Accept</span><span class="op" id="2578790">(</span><span class="ident" id="2578791">fd</span>&nbsp;<span class="builtintype" id="2578794">int</span><span class="op" id="2578797">)</span>&nbsp;<span class="op" id="2578799">(</span><span class="ident" id="2578800">nfd</span>&nbsp;<span class="builtintype" id="2578804">int</span><span class="op" id="2578807">,</span>&nbsp;<span class="ident" id="2578809">sa</span>&nbsp;<span class="ident" id="2578812">Sockaddr</span><span class="op" id="2578820">,</span>&nbsp;<span class="ident" id="2578822">err</span>&nbsp;<span class="builtintype" id="2578826">error</span><span class="op" id="2578831">)</span>&nbsp;<span class="op" id="2578833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578836">var</span>&nbsp;<span class="ident" id="2578840">rsa</span>&nbsp;<span class="ident" id="2578844">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578860">var</span>&nbsp;<span class="builtinfunc" id="2578864">len</span>&nbsp;<span class="ident" id="2578868">_Socklen</span>&nbsp;<span class="op" id="2578877">=</span>&nbsp;<span class="ident" id="2578879">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578898">nfd</span><span class="op" id="2578901">,</span>&nbsp;<span class="ident" id="2578903">err</span>&nbsp;<span class="op" id="2578907">=</span>&nbsp;<span class="ident" id="2578909">accept</span><span class="op" id="2578915">(</span><span class="ident" id="2578916">fd</span><span class="op" id="2578918">,</span>&nbsp;<span class="op" id="2578920">&amp;</span><span class="ident" id="2578921">rsa</span><span class="op" id="2578924">,</span>&nbsp;<span class="op" id="2578926">&amp;</span><span class="builtinfunc" id="2578927">len</span><span class="op" id="2578930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578933">if</span>&nbsp;<span class="ident" id="2578936">err</span>&nbsp;<span class="op" id="2578940">!=</span>&nbsp;<span class="ident" id="2578943">nil</span>&nbsp;<span class="op" id="2578947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578951">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2578959">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2578962">sa</span><span class="op" id="2578964">,</span>&nbsp;<span class="ident" id="2578966">err</span>&nbsp;<span class="op" id="2578970">=</span>&nbsp;<span class="ident" id="2578972">anyToSockaddr</span><span class="op" id="2578985">(</span><span class="op" id="2578986">&amp;</span><span class="ident" id="2578987">rsa</span><span class="op" id="2578990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2578993">if</span>&nbsp;<span class="ident" id="2578996">err</span>&nbsp;<span class="op" id="2579000">!=</span>&nbsp;<span class="ident" id="2579003">nil</span>&nbsp;<span class="op" id="2579007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579011">Close</span><span class="op" id="2579016">(</span><span class="ident" id="2579017">nfd</span><span class="op" id="2579020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579024">nfd</span>&nbsp;<span class="op" id="2579028">=</span>&nbsp;<span class="num" id="2579030">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2579033">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579036">return</span><br>
<span class="lineno"></span><span class="op" id="2579043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2579046">func</span>&nbsp;<span class="ident" id="2579051">Accept4</span><span class="op" id="2579058">(</span><span class="ident" id="2579059">fd</span>&nbsp;<span class="builtintype" id="2579062">int</span><span class="op" id="2579065">,</span>&nbsp;<span class="ident" id="2579067">flags</span>&nbsp;<span class="builtintype" id="2579073">int</span><span class="op" id="2579076">)</span>&nbsp;<span class="op" id="2579078">(</span><span class="ident" id="2579079">nfd</span>&nbsp;<span class="builtintype" id="2579083">int</span><span class="op" id="2579086">,</span>&nbsp;<span class="ident" id="2579088">sa</span>&nbsp;<span class="ident" id="2579091">Sockaddr</span><span class="op" id="2579099">,</span>&nbsp;<span class="ident" id="2579101">err</span>&nbsp;<span class="builtintype" id="2579105">error</span><span class="op" id="2579110">)</span>&nbsp;<span class="op" id="2579112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579115">var</span>&nbsp;<span class="ident" id="2579119">rsa</span>&nbsp;<span class="ident" id="2579123">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579139">var</span>&nbsp;<span class="builtinfunc" id="2579143">len</span>&nbsp;<span class="ident" id="2579147">_Socklen</span>&nbsp;<span class="op" id="2579156">=</span>&nbsp;<span class="ident" id="2579158">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579177">nfd</span><span class="op" id="2579180">,</span>&nbsp;<span class="ident" id="2579182">err</span>&nbsp;<span class="op" id="2579186">=</span>&nbsp;<span class="ident" id="2579188">accept4</span><span class="op" id="2579195">(</span><span class="ident" id="2579196">fd</span><span class="op" id="2579198">,</span>&nbsp;<span class="op" id="2579200">&amp;</span><span class="ident" id="2579201">rsa</span><span class="op" id="2579204">,</span>&nbsp;<span class="op" id="2579206">&amp;</span><span class="builtinfunc" id="2579207">len</span><span class="op" id="2579210">,</span>&nbsp;<span class="ident" id="2579212">flags</span><span class="op" id="2579217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579220">if</span>&nbsp;<span class="ident" id="2579223">err</span>&nbsp;<span class="op" id="2579227">!=</span>&nbsp;<span class="ident" id="2579230">nil</span>&nbsp;<span class="op" id="2579234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579238">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2579246">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579249">if</span>&nbsp;<span class="builtinfunc" id="2579252">len</span>&nbsp;<span class="op" id="2579256">&gt;</span>&nbsp;<span class="ident" id="2579258">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2579276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2579280">panic</span><span class="op" id="2579285">(</span><span class="string" id="2579286">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2579312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2579315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579318">sa</span><span class="op" id="2579320">,</span>&nbsp;<span class="ident" id="2579322">err</span>&nbsp;<span class="op" id="2579326">=</span>&nbsp;<span class="ident" id="2579328">anyToSockaddr</span><span class="op" id="2579341">(</span><span class="op" id="2579342">&amp;</span><span class="ident" id="2579343">rsa</span><span class="op" id="2579346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579349">if</span>&nbsp;<span class="ident" id="2579352">err</span>&nbsp;<span class="op" id="2579356">!=</span>&nbsp;<span class="ident" id="2579359">nil</span>&nbsp;<span class="op" id="2579363">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579367">Close</span><span class="op" id="2579372">(</span><span class="ident" id="2579373">nfd</span><span class="op" id="2579376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579380">nfd</span>&nbsp;<span class="op" id="2579384">=</span>&nbsp;<span class="num" id="2579386">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2579389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579392">return</span><br>
<span class="lineno"></span><span class="op" id="2579399">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2579402">func</span>&nbsp;<span class="ident" id="2579407">Getsockname</span><span class="op" id="2579418">(</span><span class="ident" id="2579419">fd</span>&nbsp;<span class="builtintype" id="2579422">int</span><span class="op" id="2579425">)</span>&nbsp;<span class="op" id="2579427">(</span><span class="ident" id="2579428">sa</span>&nbsp;<span class="ident" id="2579431">Sockaddr</span><span class="op" id="2579439">,</span>&nbsp;<span class="ident" id="2579441">err</span>&nbsp;<span class="builtintype" id="2579445">error</span><span class="op" id="2579450">)</span>&nbsp;<span class="op" id="2579452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579455">var</span>&nbsp;<span class="ident" id="2579459">rsa</span>&nbsp;<span class="ident" id="2579463">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579479">var</span>&nbsp;<span class="builtinfunc" id="2579483">len</span>&nbsp;<span class="ident" id="2579487">_Socklen</span>&nbsp;<span class="op" id="2579496">=</span>&nbsp;<span class="ident" id="2579498">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579517">if</span>&nbsp;<span class="ident" id="2579520">err</span>&nbsp;<span class="op" id="2579524">=</span>&nbsp;<span class="ident" id="2579526">getsockname</span><span class="op" id="2579537">(</span><span class="ident" id="2579538">fd</span><span class="op" id="2579540">,</span>&nbsp;<span class="op" id="2579542">&amp;</span><span class="ident" id="2579543">rsa</span><span class="op" id="2579546">,</span>&nbsp;<span class="op" id="2579548">&amp;</span><span class="builtinfunc" id="2579549">len</span><span class="op" id="2579552">)</span><span class="op" id="2579553">;</span>&nbsp;<span class="ident" id="2579555">err</span>&nbsp;<span class="op" id="2579559">!=</span>&nbsp;<span class="ident" id="2579562">nil</span>&nbsp;<span class="op" id="2579566">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579570">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2579578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579581">return</span>&nbsp;<span class="ident" id="2579588">anyToSockaddr</span><span class="op" id="2579601">(</span><span class="op" id="2579602">&amp;</span><span class="ident" id="2579603">rsa</span><span class="op" id="2579606">)</span><br>
<span class="lineno"></span><span class="op" id="2579608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2579611">func</span>&nbsp;<span class="ident" id="2579616">GetsockoptInet4Addr</span><span class="op" id="2579635">(</span><span class="ident" id="2579636">fd</span><span class="op" id="2579638">,</span>&nbsp;<span class="ident" id="2579640">level</span><span class="op" id="2579645">,</span>&nbsp;<span class="ident" id="2579647">opt</span>&nbsp;<span class="builtintype" id="2579651">int</span><span class="op" id="2579654">)</span>&nbsp;<span class="op" id="2579656">(</span><span class="ident" id="2579657">value</span>&nbsp;<span class="op" id="2579663">[</span><span class="num" id="2579664">4</span><span class="op" id="2579665">]</span><span class="builtintype" id="2579666">byte</span><span class="op" id="2579670">,</span>&nbsp;<span class="ident" id="2579672">err</span>&nbsp;<span class="builtintype" id="2579676">error</span><span class="op" id="2579681">)</span>&nbsp;<span class="op" id="2579683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579686">vallen</span>&nbsp;<span class="op" id="2579693">:=</span>&nbsp;<span class="ident" id="2579696">_Socklen</span><span class="op" id="2579704">(</span><span class="num" id="2579705">4</span><span class="op" id="2579706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579709">err</span>&nbsp;<span class="op" id="2579713">=</span>&nbsp;<span class="ident" id="2579715">getsockopt</span><span class="op" id="2579725">(</span><span class="ident" id="2579726">fd</span><span class="op" id="2579728">,</span>&nbsp;<span class="ident" id="2579730">level</span><span class="op" id="2579735">,</span>&nbsp;<span class="ident" id="2579737">opt</span><span class="op" id="2579740">,</span>&nbsp;<span class="ident" id="2579742">unsafe</span><span class="op" id="2579748">.</span><span class="ident" id="2579749">Pointer</span><span class="op" id="2579756">(</span><span class="op" id="2579757">&amp;</span><span class="ident" id="2579758">value</span><span class="op" id="2579763">[</span><span class="num" id="2579764">0</span><span class="op" id="2579765">]</span><span class="op" id="2579766">)</span><span class="op" id="2579767">,</span>&nbsp;<span class="op" id="2579769">&amp;</span><span class="ident" id="2579770">vallen</span><span class="op" id="2579776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579779">return</span>&nbsp;<span class="ident" id="2579786">value</span><span class="op" id="2579791">,</span>&nbsp;<span class="ident" id="2579793">err</span><br>
<span class="lineno"></span><span class="op" id="2579797">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2579800">func</span>&nbsp;<span class="ident" id="2579805">GetsockoptIPMreq</span><span class="op" id="2579821">(</span><span class="ident" id="2579822">fd</span><span class="op" id="2579824">,</span>&nbsp;<span class="ident" id="2579826">level</span><span class="op" id="2579831">,</span>&nbsp;<span class="ident" id="2579833">opt</span>&nbsp;<span class="builtintype" id="2579837">int</span><span class="op" id="2579840">)</span>&nbsp;<span class="op" id="2579842">(</span><span class="op" id="2579843">*</span><span class="ident" id="2579844">IPMreq</span><span class="op" id="2579850">,</span>&nbsp;<span class="builtintype" id="2579852">error</span><span class="op" id="2579857">)</span>&nbsp;<span class="op" id="2579859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579862">var</span>&nbsp;<span class="ident" id="2579866">value</span>&nbsp;<span class="ident" id="2579872">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579880">vallen</span>&nbsp;<span class="op" id="2579887">:=</span>&nbsp;<span class="ident" id="2579890">_Socklen</span><span class="op" id="2579898">(</span><span class="ident" id="2579899">SizeofIPMreq</span><span class="op" id="2579911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2579914">err</span>&nbsp;<span class="op" id="2579918">:=</span>&nbsp;<span class="ident" id="2579921">getsockopt</span><span class="op" id="2579931">(</span><span class="ident" id="2579932">fd</span><span class="op" id="2579934">,</span>&nbsp;<span class="ident" id="2579936">level</span><span class="op" id="2579941">,</span>&nbsp;<span class="ident" id="2579943">opt</span><span class="op" id="2579946">,</span>&nbsp;<span class="ident" id="2579948">unsafe</span><span class="op" id="2579954">.</span><span class="ident" id="2579955">Pointer</span><span class="op" id="2579962">(</span><span class="op" id="2579963">&amp;</span><span class="ident" id="2579964">value</span><span class="op" id="2579969">)</span><span class="op" id="2579970">,</span>&nbsp;<span class="op" id="2579972">&amp;</span><span class="ident" id="2579973">vallen</span><span class="op" id="2579979">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2579982">return</span>&nbsp;<span class="op" id="2579989">&amp;</span><span class="ident" id="2579990">value</span><span class="op" id="2579995">,</span>&nbsp;<span class="ident" id="2579997">err</span><br>
<span class="lineno"></span><span class="op" id="2580001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2580004">func</span>&nbsp;<span class="ident" id="2580009">GetsockoptIPMreqn</span><span class="op" id="2580026">(</span><span class="ident" id="2580027">fd</span><span class="op" id="2580029">,</span>&nbsp;<span class="ident" id="2580031">level</span><span class="op" id="2580036">,</span>&nbsp;<span class="ident" id="2580038">opt</span>&nbsp;<span class="builtintype" id="2580042">int</span><span class="op" id="2580045">)</span>&nbsp;<span class="op" id="2580047">(</span><span class="op" id="2580048">*</span><span class="ident" id="2580049">IPMreqn</span><span class="op" id="2580056">,</span>&nbsp;<span class="builtintype" id="2580058">error</span><span class="op" id="2580063">)</span>&nbsp;<span class="op" id="2580065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580068">var</span>&nbsp;<span class="ident" id="2580072">value</span>&nbsp;<span class="ident" id="2580078">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580087">vallen</span>&nbsp;<span class="op" id="2580094">:=</span>&nbsp;<span class="ident" id="2580097">_Socklen</span><span class="op" id="2580105">(</span><span class="ident" id="2580106">SizeofIPMreqn</span><span class="op" id="2580119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580122">err</span>&nbsp;<span class="op" id="2580126">:=</span>&nbsp;<span class="ident" id="2580129">getsockopt</span><span class="op" id="2580139">(</span><span class="ident" id="2580140">fd</span><span class="op" id="2580142">,</span>&nbsp;<span class="ident" id="2580144">level</span><span class="op" id="2580149">,</span>&nbsp;<span class="ident" id="2580151">opt</span><span class="op" id="2580154">,</span>&nbsp;<span class="ident" id="2580156">unsafe</span><span class="op" id="2580162">.</span><span class="ident" id="2580163">Pointer</span><span class="op" id="2580170">(</span><span class="op" id="2580171">&amp;</span><span class="ident" id="2580172">value</span><span class="op" id="2580177">)</span><span class="op" id="2580178">,</span>&nbsp;<span class="op" id="2580180">&amp;</span><span class="ident" id="2580181">vallen</span><span class="op" id="2580187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580190">return</span>&nbsp;<span class="op" id="2580197">&amp;</span><span class="ident" id="2580198">value</span><span class="op" id="2580203">,</span>&nbsp;<span class="ident" id="2580205">err</span><br>
<span class="lineno"></span><span class="op" id="2580209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2580212">func</span>&nbsp;<span class="ident" id="2580217">GetsockoptIPv6Mreq</span><span class="op" id="2580235">(</span><span class="ident" id="2580236">fd</span><span class="op" id="2580238">,</span>&nbsp;<span class="ident" id="2580240">level</span><span class="op" id="2580245">,</span>&nbsp;<span class="ident" id="2580247">opt</span>&nbsp;<span class="builtintype" id="2580251">int</span><span class="op" id="2580254">)</span>&nbsp;<span class="op" id="2580256">(</span><span class="op" id="2580257">*</span><span class="ident" id="2580258">IPv6Mreq</span><span class="op" id="2580266">,</span>&nbsp;<span class="builtintype" id="2580268">error</span><span class="op" id="2580273">)</span>&nbsp;<span class="op" id="2580275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580278">var</span>&nbsp;<span class="ident" id="2580282">value</span>&nbsp;<span class="ident" id="2580288">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580298">vallen</span>&nbsp;<span class="op" id="2580305">:=</span>&nbsp;<span class="ident" id="2580308">_Socklen</span><span class="op" id="2580316">(</span><span class="ident" id="2580317">SizeofIPv6Mreq</span><span class="op" id="2580331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580334">err</span>&nbsp;<span class="op" id="2580338">:=</span>&nbsp;<span class="ident" id="2580341">getsockopt</span><span class="op" id="2580351">(</span><span class="ident" id="2580352">fd</span><span class="op" id="2580354">,</span>&nbsp;<span class="ident" id="2580356">level</span><span class="op" id="2580361">,</span>&nbsp;<span class="ident" id="2580363">opt</span><span class="op" id="2580366">,</span>&nbsp;<span class="ident" id="2580368">unsafe</span><span class="op" id="2580374">.</span><span class="ident" id="2580375">Pointer</span><span class="op" id="2580382">(</span><span class="op" id="2580383">&amp;</span><span class="ident" id="2580384">value</span><span class="op" id="2580389">)</span><span class="op" id="2580390">,</span>&nbsp;<span class="op" id="2580392">&amp;</span><span class="ident" id="2580393">vallen</span><span class="op" id="2580399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580402">return</span>&nbsp;<span class="op" id="2580409">&amp;</span><span class="ident" id="2580410">value</span><span class="op" id="2580415">,</span>&nbsp;<span class="ident" id="2580417">err</span><br>
<span class="lineno">470</span><span class="op" id="2580421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2580424">func</span>&nbsp;<span class="ident" id="2580429">GetsockoptIPv6MTUInfo</span><span class="op" id="2580450">(</span><span class="ident" id="2580451">fd</span><span class="op" id="2580453">,</span>&nbsp;<span class="ident" id="2580455">level</span><span class="op" id="2580460">,</span>&nbsp;<span class="ident" id="2580462">opt</span>&nbsp;<span class="builtintype" id="2580466">int</span><span class="op" id="2580469">)</span>&nbsp;<span class="op" id="2580471">(</span><span class="op" id="2580472">*</span><span class="ident" id="2580473">IPv6MTUInfo</span><span class="op" id="2580484">,</span>&nbsp;<span class="builtintype" id="2580486">error</span><span class="op" id="2580491">)</span>&nbsp;<span class="op" id="2580493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580496">var</span>&nbsp;<span class="ident" id="2580500">value</span>&nbsp;<span class="ident" id="2580506">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580519">vallen</span>&nbsp;<span class="op" id="2580526">:=</span>&nbsp;<span class="ident" id="2580529">_Socklen</span><span class="op" id="2580537">(</span><span class="ident" id="2580538">SizeofIPv6MTUInfo</span><span class="op" id="2580555">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580558">err</span>&nbsp;<span class="op" id="2580562">:=</span>&nbsp;<span class="ident" id="2580565">getsockopt</span><span class="op" id="2580575">(</span><span class="ident" id="2580576">fd</span><span class="op" id="2580578">,</span>&nbsp;<span class="ident" id="2580580">level</span><span class="op" id="2580585">,</span>&nbsp;<span class="ident" id="2580587">opt</span><span class="op" id="2580590">,</span>&nbsp;<span class="ident" id="2580592">unsafe</span><span class="op" id="2580598">.</span><span class="ident" id="2580599">Pointer</span><span class="op" id="2580606">(</span><span class="op" id="2580607">&amp;</span><span class="ident" id="2580608">value</span><span class="op" id="2580613">)</span><span class="op" id="2580614">,</span>&nbsp;<span class="op" id="2580616">&amp;</span><span class="ident" id="2580617">vallen</span><span class="op" id="2580623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580626">return</span>&nbsp;<span class="op" id="2580633">&amp;</span><span class="ident" id="2580634">value</span><span class="op" id="2580639">,</span>&nbsp;<span class="ident" id="2580641">err</span><br>
<span class="lineno"></span><span class="op" id="2580645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2580648">func</span>&nbsp;<span class="ident" id="2580653">GetsockoptICMPv6Filter</span><span class="op" id="2580675">(</span><span class="ident" id="2580676">fd</span><span class="op" id="2580678">,</span>&nbsp;<span class="ident" id="2580680">level</span><span class="op" id="2580685">,</span>&nbsp;<span class="ident" id="2580687">opt</span>&nbsp;<span class="builtintype" id="2580691">int</span><span class="op" id="2580694">)</span>&nbsp;<span class="op" id="2580696">(</span><span class="op" id="2580697">*</span><span class="ident" id="2580698">ICMPv6Filter</span><span class="op" id="2580710">,</span>&nbsp;<span class="builtintype" id="2580712">error</span><span class="op" id="2580717">)</span>&nbsp;<span class="op" id="2580719">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580722">var</span>&nbsp;<span class="ident" id="2580726">value</span>&nbsp;<span class="ident" id="2580732">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580746">vallen</span>&nbsp;<span class="op" id="2580753">:=</span>&nbsp;<span class="ident" id="2580756">_Socklen</span><span class="op" id="2580764">(</span><span class="ident" id="2580765">SizeofICMPv6Filter</span><span class="op" id="2580783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580786">err</span>&nbsp;<span class="op" id="2580790">:=</span>&nbsp;<span class="ident" id="2580793">getsockopt</span><span class="op" id="2580803">(</span><span class="ident" id="2580804">fd</span><span class="op" id="2580806">,</span>&nbsp;<span class="ident" id="2580808">level</span><span class="op" id="2580813">,</span>&nbsp;<span class="ident" id="2580815">opt</span><span class="op" id="2580818">,</span>&nbsp;<span class="ident" id="2580820">unsafe</span><span class="op" id="2580826">.</span><span class="ident" id="2580827">Pointer</span><span class="op" id="2580834">(</span><span class="op" id="2580835">&amp;</span><span class="ident" id="2580836">value</span><span class="op" id="2580841">)</span><span class="op" id="2580842">,</span>&nbsp;<span class="op" id="2580844">&amp;</span><span class="ident" id="2580845">vallen</span><span class="op" id="2580851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580854">return</span>&nbsp;<span class="op" id="2580861">&amp;</span><span class="ident" id="2580862">value</span><span class="op" id="2580867">,</span>&nbsp;<span class="ident" id="2580869">err</span><br>
<span class="lineno"></span><span class="op" id="2580873">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2580876">func</span>&nbsp;<span class="ident" id="2580881">GetsockoptUcred</span><span class="op" id="2580896">(</span><span class="ident" id="2580897">fd</span><span class="op" id="2580899">,</span>&nbsp;<span class="ident" id="2580901">level</span><span class="op" id="2580906">,</span>&nbsp;<span class="ident" id="2580908">opt</span>&nbsp;<span class="builtintype" id="2580912">int</span><span class="op" id="2580915">)</span>&nbsp;<span class="op" id="2580917">(</span><span class="op" id="2580918">*</span><span class="ident" id="2580919">Ucred</span><span class="op" id="2580924">,</span>&nbsp;<span class="builtintype" id="2580926">error</span><span class="op" id="2580931">)</span>&nbsp;<span class="op" id="2580933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2580936">var</span>&nbsp;<span class="ident" id="2580940">value</span>&nbsp;<span class="ident" id="2580946">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580953">vallen</span>&nbsp;<span class="op" id="2580960">:=</span>&nbsp;<span class="ident" id="2580963">_Socklen</span><span class="op" id="2580971">(</span><span class="ident" id="2580972">SizeofUcred</span><span class="op" id="2580983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2580986">err</span>&nbsp;<span class="op" id="2580990">:=</span>&nbsp;<span class="ident" id="2580993">getsockopt</span><span class="op" id="2581003">(</span><span class="ident" id="2581004">fd</span><span class="op" id="2581006">,</span>&nbsp;<span class="ident" id="2581008">level</span><span class="op" id="2581013">,</span>&nbsp;<span class="ident" id="2581015">opt</span><span class="op" id="2581018">,</span>&nbsp;<span class="ident" id="2581020">unsafe</span><span class="op" id="2581026">.</span><span class="ident" id="2581027">Pointer</span><span class="op" id="2581034">(</span><span class="op" id="2581035">&amp;</span><span class="ident" id="2581036">value</span><span class="op" id="2581041">)</span><span class="op" id="2581042">,</span>&nbsp;<span class="op" id="2581044">&amp;</span><span class="ident" id="2581045">vallen</span><span class="op" id="2581051">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581054">return</span>&nbsp;<span class="op" id="2581061">&amp;</span><span class="ident" id="2581062">value</span><span class="op" id="2581067">,</span>&nbsp;<span class="ident" id="2581069">err</span><br>
<span class="lineno"></span><span class="op" id="2581073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2581076">func</span>&nbsp;<span class="ident" id="2581081">SetsockoptIPMreqn</span><span class="op" id="2581098">(</span><span class="ident" id="2581099">fd</span><span class="op" id="2581101">,</span>&nbsp;<span class="ident" id="2581103">level</span><span class="op" id="2581108">,</span>&nbsp;<span class="ident" id="2581110">opt</span>&nbsp;<span class="builtintype" id="2581114">int</span><span class="op" id="2581117">,</span>&nbsp;<span class="ident" id="2581119">mreq</span>&nbsp;<span class="op" id="2581124">*</span><span class="ident" id="2581125">IPMreqn</span><span class="op" id="2581132">)</span>&nbsp;<span class="op" id="2581134">(</span><span class="ident" id="2581135">err</span>&nbsp;<span class="builtintype" id="2581139">error</span><span class="op" id="2581144">)</span>&nbsp;<span class="op" id="2581146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581149">return</span>&nbsp;<span class="ident" id="2581156">setsockopt</span><span class="op" id="2581166">(</span><span class="ident" id="2581167">fd</span><span class="op" id="2581169">,</span>&nbsp;<span class="ident" id="2581171">level</span><span class="op" id="2581176">,</span>&nbsp;<span class="ident" id="2581178">opt</span><span class="op" id="2581181">,</span>&nbsp;<span class="ident" id="2581183">unsafe</span><span class="op" id="2581189">.</span><span class="ident" id="2581190">Pointer</span><span class="op" id="2581197">(</span><span class="ident" id="2581198">mreq</span><span class="op" id="2581202">)</span><span class="op" id="2581203">,</span>&nbsp;<span class="ident" id="2581205">unsafe</span><span class="op" id="2581211">.</span><span class="ident" id="2581212">Sizeof</span><span class="op" id="2581218">(</span><span class="op" id="2581219">*</span><span class="ident" id="2581220">mreq</span><span class="op" id="2581224">)</span><span class="op" id="2581225">)</span><br>
<span class="lineno">495</span><span class="op" id="2581227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2581230">func</span>&nbsp;<span class="ident" id="2581235">Recvmsg</span><span class="op" id="2581242">(</span><span class="ident" id="2581243">fd</span>&nbsp;<span class="builtintype" id="2581246">int</span><span class="op" id="2581249">,</span>&nbsp;<span class="ident" id="2581251">p</span><span class="op" id="2581252">,</span>&nbsp;<span class="ident" id="2581254">oob</span>&nbsp;<span class="op" id="2581258">[</span><span class="op" id="2581259">]</span><span class="builtintype" id="2581260">byte</span><span class="op" id="2581264">,</span>&nbsp;<span class="ident" id="2581266">flags</span>&nbsp;<span class="builtintype" id="2581272">int</span><span class="op" id="2581275">)</span>&nbsp;<span class="op" id="2581277">(</span><span class="ident" id="2581278">n</span><span class="op" id="2581279">,</span>&nbsp;<span class="ident" id="2581281">oobn</span>&nbsp;<span class="builtintype" id="2581286">int</span><span class="op" id="2581289">,</span>&nbsp;<span class="ident" id="2581291">recvflags</span>&nbsp;<span class="builtintype" id="2581301">int</span><span class="op" id="2581304">,</span>&nbsp;<span class="ident" id="2581306">from</span>&nbsp;<span class="ident" id="2581311">Sockaddr</span><span class="op" id="2581319">,</span>&nbsp;<span class="ident" id="2581321">err</span>&nbsp;<span class="builtintype" id="2581325">error</span><span class="op" id="2581330">)</span>&nbsp;<span class="op" id="2581332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581335">var</span>&nbsp;<span class="ident" id="2581339">msg</span>&nbsp;<span class="ident" id="2581343">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581351">var</span>&nbsp;<span class="ident" id="2581355">rsa</span>&nbsp;<span class="ident" id="2581359">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581375">msg</span><span class="op" id="2581378">.</span><span class="ident" id="2581379">Name</span>&nbsp;<span class="op" id="2581384">=</span>&nbsp;<span class="op" id="2581386">(</span><span class="op" id="2581387">*</span><span class="builtintype" id="2581388">byte</span><span class="op" id="2581392">)</span><span class="op" id="2581393">(</span><span class="ident" id="2581394">unsafe</span><span class="op" id="2581400">.</span><span class="ident" id="2581401">Pointer</span><span class="op" id="2581408">(</span><span class="op" id="2581409">&amp;</span><span class="ident" id="2581410">rsa</span><span class="op" id="2581413">)</span><span class="op" id="2581414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581417">msg</span><span class="op" id="2581420">.</span><span class="ident" id="2581421">Namelen</span>&nbsp;<span class="op" id="2581429">=</span>&nbsp;<span class="builtintype" id="2581431">uint32</span><span class="op" id="2581437">(</span><span class="ident" id="2581438">SizeofSockaddrAny</span><span class="op" id="2581455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581458">var</span>&nbsp;<span class="ident" id="2581462">iov</span>&nbsp;<span class="ident" id="2581466">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581473">if</span>&nbsp;<span class="builtinfunc" id="2581476">len</span><span class="op" id="2581479">(</span><span class="ident" id="2581480">p</span><span class="op" id="2581481">)</span>&nbsp;<span class="op" id="2581483">&gt;</span>&nbsp;<span class="num" id="2581485">0</span>&nbsp;<span class="op" id="2581487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581491">iov</span><span class="op" id="2581494">.</span><span class="ident" id="2581495">Base</span>&nbsp;<span class="op" id="2581500">=</span>&nbsp;<span class="op" id="2581502">(</span><span class="op" id="2581503">*</span><span class="builtintype" id="2581504">byte</span><span class="op" id="2581508">)</span><span class="op" id="2581509">(</span><span class="ident" id="2581510">unsafe</span><span class="op" id="2581516">.</span><span class="ident" id="2581517">Pointer</span><span class="op" id="2581524">(</span><span class="op" id="2581525">&amp;</span><span class="ident" id="2581526">p</span><span class="op" id="2581527">[</span><span class="num" id="2581528">0</span><span class="op" id="2581529">]</span><span class="op" id="2581530">)</span><span class="op" id="2581531">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581535">iov</span><span class="op" id="2581538">.</span><span class="ident" id="2581539">SetLen</span><span class="op" id="2581545">(</span><span class="builtinfunc" id="2581546">len</span><span class="op" id="2581549">(</span><span class="ident" id="2581550">p</span><span class="op" id="2581551">)</span><span class="op" id="2581552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2581555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581558">var</span>&nbsp;<span class="ident" id="2581562">dummy</span>&nbsp;<span class="builtintype" id="2581568">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581574">if</span>&nbsp;<span class="builtinfunc" id="2581577">len</span><span class="op" id="2581580">(</span><span class="ident" id="2581581">oob</span><span class="op" id="2581584">)</span>&nbsp;<span class="op" id="2581586">&gt;</span>&nbsp;<span class="num" id="2581588">0</span>&nbsp;<span class="op" id="2581590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2581594">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581632">if</span>&nbsp;<span class="builtinfunc" id="2581635">len</span><span class="op" id="2581638">(</span><span class="ident" id="2581639">p</span><span class="op" id="2581640">)</span>&nbsp;<span class="op" id="2581642">==</span>&nbsp;<span class="num" id="2581645">0</span>&nbsp;<span class="op" id="2581647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581652">iov</span><span class="op" id="2581655">.</span><span class="ident" id="2581656">Base</span>&nbsp;<span class="op" id="2581661">=</span>&nbsp;<span class="op" id="2581663">&amp;</span><span class="ident" id="2581664">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581673">iov</span><span class="op" id="2581676">.</span><span class="ident" id="2581677">SetLen</span><span class="op" id="2581683">(</span><span class="num" id="2581684">1</span><span class="op" id="2581685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2581689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581693">msg</span><span class="op" id="2581696">.</span><span class="ident" id="2581697">Control</span>&nbsp;<span class="op" id="2581705">=</span>&nbsp;<span class="op" id="2581707">(</span><span class="op" id="2581708">*</span><span class="builtintype" id="2581709">byte</span><span class="op" id="2581713">)</span><span class="op" id="2581714">(</span><span class="ident" id="2581715">unsafe</span><span class="op" id="2581721">.</span><span class="ident" id="2581722">Pointer</span><span class="op" id="2581729">(</span><span class="op" id="2581730">&amp;</span><span class="ident" id="2581731">oob</span><span class="op" id="2581734">[</span><span class="num" id="2581735">0</span><span class="op" id="2581736">]</span><span class="op" id="2581737">)</span><span class="op" id="2581738">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581742">msg</span><span class="op" id="2581745">.</span><span class="ident" id="2581746">SetControllen</span><span class="op" id="2581759">(</span><span class="builtinfunc" id="2581760">len</span><span class="op" id="2581763">(</span><span class="ident" id="2581764">oob</span><span class="op" id="2581767">)</span><span class="op" id="2581768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2581771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581774">msg</span><span class="op" id="2581777">.</span><span class="ident" id="2581778">Iov</span>&nbsp;<span class="op" id="2581782">=</span>&nbsp;<span class="op" id="2581784">&amp;</span><span class="ident" id="2581785">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581790">msg</span><span class="op" id="2581793">.</span><span class="ident" id="2581794">Iovlen</span>&nbsp;<span class="op" id="2581801">=</span>&nbsp;<span class="num" id="2581803">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581806">if</span>&nbsp;<span class="ident" id="2581809">n</span><span class="op" id="2581810">,</span>&nbsp;<span class="ident" id="2581812">err</span>&nbsp;<span class="op" id="2581816">=</span>&nbsp;<span class="ident" id="2581818">recvmsg</span><span class="op" id="2581825">(</span><span class="ident" id="2581826">fd</span><span class="op" id="2581828">,</span>&nbsp;<span class="op" id="2581830">&amp;</span><span class="ident" id="2581831">msg</span><span class="op" id="2581834">,</span>&nbsp;<span class="ident" id="2581836">flags</span><span class="op" id="2581841">)</span><span class="op" id="2581842">;</span>&nbsp;<span class="ident" id="2581844">err</span>&nbsp;<span class="op" id="2581848">!=</span>&nbsp;<span class="ident" id="2581851">nil</span>&nbsp;<span class="op" id="2581855">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2581867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581870">oobn</span>&nbsp;<span class="op" id="2581875">=</span>&nbsp;<span class="builtintype" id="2581877">int</span><span class="op" id="2581880">(</span><span class="ident" id="2581881">msg</span><span class="op" id="2581884">.</span><span class="ident" id="2581885">Controllen</span><span class="op" id="2581895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2581898">recvflags</span>&nbsp;<span class="op" id="2581908">=</span>&nbsp;<span class="builtintype" id="2581910">int</span><span class="op" id="2581913">(</span><span class="ident" id="2581914">msg</span><span class="op" id="2581917">.</span><span class="ident" id="2581918">Flags</span><span class="op" id="2581923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2581926">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2581992">if</span>&nbsp;<span class="ident" id="2581995">rsa</span><span class="op" id="2581998">.</span><span class="ident" id="2581999">Addr</span><span class="op" id="2582003">.</span><span class="ident" id="2582004">Family</span>&nbsp;<span class="op" id="2582011">!=</span>&nbsp;<span class="ident" id="2582014">AF_UNSPEC</span>&nbsp;<span class="op" id="2582024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582028">from</span><span class="op" id="2582032">,</span>&nbsp;<span class="ident" id="2582034">err</span>&nbsp;<span class="op" id="2582038">=</span>&nbsp;<span class="ident" id="2582040">anyToSockaddr</span><span class="op" id="2582053">(</span><span class="op" id="2582054">&amp;</span><span class="ident" id="2582055">rsa</span><span class="op" id="2582058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582064">return</span><br>
<span class="lineno"></span><span class="op" id="2582071">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2582074">func</span>&nbsp;<span class="ident" id="2582079">Sendmsg</span><span class="op" id="2582086">(</span><span class="ident" id="2582087">fd</span>&nbsp;<span class="builtintype" id="2582090">int</span><span class="op" id="2582093">,</span>&nbsp;<span class="ident" id="2582095">p</span><span class="op" id="2582096">,</span>&nbsp;<span class="ident" id="2582098">oob</span>&nbsp;<span class="op" id="2582102">[</span><span class="op" id="2582103">]</span><span class="builtintype" id="2582104">byte</span><span class="op" id="2582108">,</span>&nbsp;<span class="ident" id="2582110">to</span>&nbsp;<span class="ident" id="2582113">Sockaddr</span><span class="op" id="2582121">,</span>&nbsp;<span class="ident" id="2582123">flags</span>&nbsp;<span class="builtintype" id="2582129">int</span><span class="op" id="2582132">)</span>&nbsp;<span class="op" id="2582134">(</span><span class="ident" id="2582135">err</span>&nbsp;<span class="builtintype" id="2582139">error</span><span class="op" id="2582144">)</span>&nbsp;<span class="op" id="2582146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582149">_</span><span class="op" id="2582150">,</span>&nbsp;<span class="ident" id="2582152">err</span>&nbsp;<span class="op" id="2582156">=</span>&nbsp;<span class="ident" id="2582158">SendmsgN</span><span class="op" id="2582166">(</span><span class="ident" id="2582167">fd</span><span class="op" id="2582169">,</span>&nbsp;<span class="ident" id="2582171">p</span><span class="op" id="2582172">,</span>&nbsp;<span class="ident" id="2582174">oob</span><span class="op" id="2582177">,</span>&nbsp;<span class="ident" id="2582179">to</span><span class="op" id="2582181">,</span>&nbsp;<span class="ident" id="2582183">flags</span><span class="op" id="2582188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582191">return</span><br>
<span class="lineno"></span><span class="op" id="2582198">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2582201">func</span>&nbsp;<span class="ident" id="2582206">SendmsgN</span><span class="op" id="2582214">(</span><span class="ident" id="2582215">fd</span>&nbsp;<span class="builtintype" id="2582218">int</span><span class="op" id="2582221">,</span>&nbsp;<span class="ident" id="2582223">p</span><span class="op" id="2582224">,</span>&nbsp;<span class="ident" id="2582226">oob</span>&nbsp;<span class="op" id="2582230">[</span><span class="op" id="2582231">]</span><span class="builtintype" id="2582232">byte</span><span class="op" id="2582236">,</span>&nbsp;<span class="ident" id="2582238">to</span>&nbsp;<span class="ident" id="2582241">Sockaddr</span><span class="op" id="2582249">,</span>&nbsp;<span class="ident" id="2582251">flags</span>&nbsp;<span class="builtintype" id="2582257">int</span><span class="op" id="2582260">)</span>&nbsp;<span class="op" id="2582262">(</span><span class="ident" id="2582263">n</span>&nbsp;<span class="builtintype" id="2582265">int</span><span class="op" id="2582268">,</span>&nbsp;<span class="ident" id="2582270">err</span>&nbsp;<span class="builtintype" id="2582274">error</span><span class="op" id="2582279">)</span>&nbsp;<span class="op" id="2582281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582284">var</span>&nbsp;<span class="ident" id="2582288">ptr</span>&nbsp;<span class="ident" id="2582292">unsafe</span><span class="op" id="2582298">.</span><span class="ident" id="2582299">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582308">var</span>&nbsp;<span class="ident" id="2582312">salen</span>&nbsp;<span class="ident" id="2582318">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582328">if</span>&nbsp;<span class="ident" id="2582331">to</span>&nbsp;<span class="op" id="2582334">!=</span>&nbsp;<span class="ident" id="2582337">nil</span>&nbsp;<span class="op" id="2582341">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582345">var</span>&nbsp;<span class="ident" id="2582349">err</span>&nbsp;<span class="builtintype" id="2582353">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582361">ptr</span><span class="op" id="2582364">,</span>&nbsp;<span class="ident" id="2582366">salen</span><span class="op" id="2582371">,</span>&nbsp;<span class="ident" id="2582373">err</span>&nbsp;<span class="op" id="2582377">=</span>&nbsp;<span class="ident" id="2582379">to</span><span class="op" id="2582381">.</span><span class="ident" id="2582382">sockaddr</span><span class="op" id="2582390">(</span><span class="op" id="2582391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582395">if</span>&nbsp;<span class="ident" id="2582398">err</span>&nbsp;<span class="op" id="2582402">!=</span>&nbsp;<span class="ident" id="2582405">nil</span>&nbsp;<span class="op" id="2582409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582414">return</span>&nbsp;<span class="num" id="2582421">0</span><span class="op" id="2582422">,</span>&nbsp;<span class="ident" id="2582424">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582430">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582436">var</span>&nbsp;<span class="ident" id="2582440">msg</span>&nbsp;<span class="ident" id="2582444">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582452">msg</span><span class="op" id="2582455">.</span><span class="ident" id="2582456">Name</span>&nbsp;<span class="op" id="2582461">=</span>&nbsp;<span class="op" id="2582463">(</span><span class="op" id="2582464">*</span><span class="builtintype" id="2582465">byte</span><span class="op" id="2582469">)</span><span class="op" id="2582470">(</span><span class="ident" id="2582471">unsafe</span><span class="op" id="2582477">.</span><span class="ident" id="2582478">Pointer</span><span class="op" id="2582485">(</span><span class="ident" id="2582486">ptr</span><span class="op" id="2582489">)</span><span class="op" id="2582490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582493">msg</span><span class="op" id="2582496">.</span><span class="ident" id="2582497">Namelen</span>&nbsp;<span class="op" id="2582505">=</span>&nbsp;<span class="builtintype" id="2582507">uint32</span><span class="op" id="2582513">(</span><span class="ident" id="2582514">salen</span><span class="op" id="2582519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582522">var</span>&nbsp;<span class="ident" id="2582526">iov</span>&nbsp;<span class="ident" id="2582530">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582537">if</span>&nbsp;<span class="builtinfunc" id="2582540">len</span><span class="op" id="2582543">(</span><span class="ident" id="2582544">p</span><span class="op" id="2582545">)</span>&nbsp;<span class="op" id="2582547">&gt;</span>&nbsp;<span class="num" id="2582549">0</span>&nbsp;<span class="op" id="2582551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582555">iov</span><span class="op" id="2582558">.</span><span class="ident" id="2582559">Base</span>&nbsp;<span class="op" id="2582564">=</span>&nbsp;<span class="op" id="2582566">(</span><span class="op" id="2582567">*</span><span class="builtintype" id="2582568">byte</span><span class="op" id="2582572">)</span><span class="op" id="2582573">(</span><span class="ident" id="2582574">unsafe</span><span class="op" id="2582580">.</span><span class="ident" id="2582581">Pointer</span><span class="op" id="2582588">(</span><span class="op" id="2582589">&amp;</span><span class="ident" id="2582590">p</span><span class="op" id="2582591">[</span><span class="num" id="2582592">0</span><span class="op" id="2582593">]</span><span class="op" id="2582594">)</span><span class="op" id="2582595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582599">iov</span><span class="op" id="2582602">.</span><span class="ident" id="2582603">SetLen</span><span class="op" id="2582609">(</span><span class="builtinfunc" id="2582610">len</span><span class="op" id="2582613">(</span><span class="ident" id="2582614">p</span><span class="op" id="2582615">)</span><span class="op" id="2582616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582622">var</span>&nbsp;<span class="ident" id="2582626">dummy</span>&nbsp;<span class="builtintype" id="2582632">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582638">if</span>&nbsp;<span class="builtinfunc" id="2582641">len</span><span class="op" id="2582644">(</span><span class="ident" id="2582645">oob</span><span class="op" id="2582648">)</span>&nbsp;<span class="op" id="2582650">&gt;</span>&nbsp;<span class="num" id="2582652">0</span>&nbsp;<span class="op" id="2582654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2582658">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582693">if</span>&nbsp;<span class="builtinfunc" id="2582696">len</span><span class="op" id="2582699">(</span><span class="ident" id="2582700">p</span><span class="op" id="2582701">)</span>&nbsp;<span class="op" id="2582703">==</span>&nbsp;<span class="num" id="2582706">0</span>&nbsp;<span class="op" id="2582708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582713">iov</span><span class="op" id="2582716">.</span><span class="ident" id="2582717">Base</span>&nbsp;<span class="op" id="2582722">=</span>&nbsp;<span class="op" id="2582724">&amp;</span><span class="ident" id="2582725">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582734">iov</span><span class="op" id="2582737">.</span><span class="ident" id="2582738">SetLen</span><span class="op" id="2582744">(</span><span class="num" id="2582745">1</span><span class="op" id="2582746">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582754">msg</span><span class="op" id="2582757">.</span><span class="ident" id="2582758">Control</span>&nbsp;<span class="op" id="2582766">=</span>&nbsp;<span class="op" id="2582768">(</span><span class="op" id="2582769">*</span><span class="builtintype" id="2582770">byte</span><span class="op" id="2582774">)</span><span class="op" id="2582775">(</span><span class="ident" id="2582776">unsafe</span><span class="op" id="2582782">.</span><span class="ident" id="2582783">Pointer</span><span class="op" id="2582790">(</span><span class="op" id="2582791">&amp;</span><span class="ident" id="2582792">oob</span><span class="op" id="2582795">[</span><span class="num" id="2582796">0</span><span class="op" id="2582797">]</span><span class="op" id="2582798">)</span><span class="op" id="2582799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582803">msg</span><span class="op" id="2582806">.</span><span class="ident" id="2582807">SetControllen</span><span class="op" id="2582820">(</span><span class="builtinfunc" id="2582821">len</span><span class="op" id="2582824">(</span><span class="ident" id="2582825">oob</span><span class="op" id="2582828">)</span><span class="op" id="2582829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582835">msg</span><span class="op" id="2582838">.</span><span class="ident" id="2582839">Iov</span>&nbsp;<span class="op" id="2582843">=</span>&nbsp;<span class="op" id="2582845">&amp;</span><span class="ident" id="2582846">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582851">msg</span><span class="op" id="2582854">.</span><span class="ident" id="2582855">Iovlen</span>&nbsp;<span class="op" id="2582862">=</span>&nbsp;<span class="num" id="2582864">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582867">if</span>&nbsp;<span class="ident" id="2582870">n</span><span class="op" id="2582871">,</span>&nbsp;<span class="ident" id="2582873">err</span>&nbsp;<span class="op" id="2582877">=</span>&nbsp;<span class="ident" id="2582879">sendmsg</span><span class="op" id="2582886">(</span><span class="ident" id="2582887">fd</span><span class="op" id="2582889">,</span>&nbsp;<span class="op" id="2582891">&amp;</span><span class="ident" id="2582892">msg</span><span class="op" id="2582895">,</span>&nbsp;<span class="ident" id="2582897">flags</span><span class="op" id="2582902">)</span><span class="op" id="2582903">;</span>&nbsp;<span class="ident" id="2582905">err</span>&nbsp;<span class="op" id="2582909">!=</span>&nbsp;<span class="ident" id="2582912">nil</span>&nbsp;<span class="op" id="2582916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582920">return</span>&nbsp;<span class="num" id="2582927">0</span><span class="op" id="2582928">,</span>&nbsp;<span class="ident" id="2582930">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582938">if</span>&nbsp;<span class="builtinfunc" id="2582941">len</span><span class="op" id="2582944">(</span><span class="ident" id="2582945">oob</span><span class="op" id="2582948">)</span>&nbsp;<span class="op" id="2582950">&gt;</span>&nbsp;<span class="num" id="2582952">0</span>&nbsp;<span class="op" id="2582954">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2582957">len</span><span class="op" id="2582960">(</span><span class="ident" id="2582961">p</span><span class="op" id="2582962">)</span>&nbsp;<span class="op" id="2582964">==</span>&nbsp;<span class="num" id="2582967">0</span>&nbsp;<span class="op" id="2582969">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2582973">n</span>&nbsp;<span class="op" id="2582975">=</span>&nbsp;<span class="num" id="2582977">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2582980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2582983">return</span>&nbsp;<span class="ident" id="2582990">n</span><span class="op" id="2582991">,</span>&nbsp;<span class="ident" id="2582993">nil</span><br>
<span class="lineno"></span><span class="op" id="2582997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2583000">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2583063">func</span>&nbsp;<span class="ident" id="2583068">BindToDevice</span><span class="op" id="2583080">(</span><span class="ident" id="2583081">fd</span>&nbsp;<span class="builtintype" id="2583084">int</span><span class="op" id="2583087">,</span>&nbsp;<span class="ident" id="2583089">device</span>&nbsp;<span class="builtintype" id="2583096">string</span><span class="op" id="2583102">)</span>&nbsp;<span class="op" id="2583104">(</span><span class="ident" id="2583105">err</span>&nbsp;<span class="builtintype" id="2583109">error</span><span class="op" id="2583114">)</span>&nbsp;<span class="op" id="2583116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2583119">return</span>&nbsp;<span class="ident" id="2583126">SetsockoptString</span><span class="op" id="2583142">(</span><span class="ident" id="2583143">fd</span><span class="op" id="2583145">,</span>&nbsp;<span class="ident" id="2583147">SOL_SOCKET</span><span class="op" id="2583157">,</span>&nbsp;<span class="ident" id="2583159">SO_BINDTODEVICE</span><span class="op" id="2583174">,</span>&nbsp;<span class="ident" id="2583176">device</span><span class="op" id="2583182">)</span><br>
<span class="lineno"></span><span class="op" id="2583184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2583187">//sys&nbsp;&nbsp;&nbsp;&nbsp;ptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2583263">func</span>&nbsp;<span class="ident" id="2583268">ptracePeek</span><span class="op" id="2583278">(</span><span class="ident" id="2583279">req</span>&nbsp;<span class="builtintype" id="2583283">int</span><span class="op" id="2583286">,</span>&nbsp;<span class="ident" id="2583288">pid</span>&nbsp;<span class="builtintype" id="2583292">int</span><span class="op" id="2583295">,</span>&nbsp;<span class="ident" id="2583297">addr</span>&nbsp;<span class="builtintype" id="2583302">uintptr</span><span class="op" id="2583309">,</span>&nbsp;<span class="ident" id="2583311">out</span>&nbsp;<span class="op" id="2583315">[</span><span class="op" id="2583316">]</span><span class="builtintype" id="2583317">byte</span><span class="op" id="2583321">)</span>&nbsp;<span class="op" id="2583323">(</span><span class="ident" id="2583324">count</span>&nbsp;<span class="builtintype" id="2583330">int</span><span class="op" id="2583333">,</span>&nbsp;<span class="ident" id="2583335">err</span>&nbsp;<span class="builtintype" id="2583339">error</span><span class="op" id="2583344">)</span>&nbsp;<span class="op" id="2583346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583349">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583412">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583452">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583504">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2583567">var</span>&nbsp;<span class="ident" id="2583571">buf</span>&nbsp;<span class="op" id="2583575">[</span><span class="ident" id="2583576">sizeofPtr</span><span class="op" id="2583585">]</span><span class="builtintype" id="2583586">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583593">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583652">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583711">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583767">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2583825">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2583839">n</span>&nbsp;<span class="op" id="2583841">:=</span>&nbsp;<span class="num" id="2583844">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2583847">if</span>&nbsp;<span class="ident" id="2583850">addr</span><span class="op" id="2583854">%</span><span class="ident" id="2583855">sizeofPtr</span>&nbsp;<span class="op" id="2583865">!=</span>&nbsp;<span class="num" id="2583868">0</span>&nbsp;<span class="op" id="2583870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2583874">err</span>&nbsp;<span class="op" id="2583878">=</span>&nbsp;<span class="ident" id="2583880">ptrace</span><span class="op" id="2583886">(</span><span class="ident" id="2583887">req</span><span class="op" id="2583890">,</span>&nbsp;<span class="ident" id="2583892">pid</span><span class="op" id="2583895">,</span>&nbsp;<span class="ident" id="2583897">addr</span><span class="op" id="2583901">-</span><span class="ident" id="2583902">addr</span><span class="op" id="2583906">%</span><span class="ident" id="2583907">sizeofPtr</span><span class="op" id="2583916">,</span>&nbsp;<span class="builtintype" id="2583918">uintptr</span><span class="op" id="2583925">(</span><span class="ident" id="2583926">unsafe</span><span class="op" id="2583932">.</span><span class="ident" id="2583933">Pointer</span><span class="op" id="2583940">(</span><span class="op" id="2583941">&amp;</span><span class="ident" id="2583942">buf</span><span class="op" id="2583945">[</span><span class="num" id="2583946">0</span><span class="op" id="2583947">]</span><span class="op" id="2583948">)</span><span class="op" id="2583949">)</span><span class="op" id="2583950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2583954">if</span>&nbsp;<span class="ident" id="2583957">err</span>&nbsp;<span class="op" id="2583961">!=</span>&nbsp;<span class="ident" id="2583964">nil</span>&nbsp;<span class="op" id="2583968">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2583973">return</span>&nbsp;<span class="num" id="2583980">0</span><span class="op" id="2583981">,</span>&nbsp;<span class="ident" id="2583983">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2583989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2583993">n</span>&nbsp;<span class="op" id="2583995">+=</span>&nbsp;<span class="builtinfunc" id="2583998">copy</span><span class="op" id="2584002">(</span><span class="ident" id="2584003">out</span><span class="op" id="2584006">,</span>&nbsp;<span class="ident" id="2584008">buf</span><span class="op" id="2584011">[</span><span class="ident" id="2584012">addr</span><span class="op" id="2584016">%</span><span class="ident" id="2584017">sizeofPtr</span><span class="op" id="2584026">:</span><span class="op" id="2584027">]</span><span class="op" id="2584028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584032">out</span>&nbsp;<span class="op" id="2584036">=</span>&nbsp;<span class="ident" id="2584038">out</span><span class="op" id="2584041">[</span><span class="ident" id="2584042">n</span><span class="op" id="2584043">:</span><span class="op" id="2584044">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2584047">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2584051">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584066">for</span>&nbsp;<span class="builtinfunc" id="2584070">len</span><span class="op" id="2584073">(</span><span class="ident" id="2584074">out</span><span class="op" id="2584077">)</span>&nbsp;<span class="op" id="2584079">&gt;</span>&nbsp;<span class="num" id="2584081">0</span>&nbsp;<span class="op" id="2584083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2584087">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2584142">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584209">err</span>&nbsp;<span class="op" id="2584213">=</span>&nbsp;<span class="ident" id="2584215">ptrace</span><span class="op" id="2584221">(</span><span class="ident" id="2584222">req</span><span class="op" id="2584225">,</span>&nbsp;<span class="ident" id="2584227">pid</span><span class="op" id="2584230">,</span>&nbsp;<span class="ident" id="2584232">addr</span><span class="op" id="2584236">+</span><span class="builtintype" id="2584237">uintptr</span><span class="op" id="2584244">(</span><span class="ident" id="2584245">n</span><span class="op" id="2584246">)</span><span class="op" id="2584247">,</span>&nbsp;<span class="builtintype" id="2584249">uintptr</span><span class="op" id="2584256">(</span><span class="ident" id="2584257">unsafe</span><span class="op" id="2584263">.</span><span class="ident" id="2584264">Pointer</span><span class="op" id="2584271">(</span><span class="op" id="2584272">&amp;</span><span class="ident" id="2584273">buf</span><span class="op" id="2584276">[</span><span class="num" id="2584277">0</span><span class="op" id="2584278">]</span><span class="op" id="2584279">)</span><span class="op" id="2584280">)</span><span class="op" id="2584281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584285">if</span>&nbsp;<span class="ident" id="2584288">err</span>&nbsp;<span class="op" id="2584292">!=</span>&nbsp;<span class="ident" id="2584295">nil</span>&nbsp;<span class="op" id="2584299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584304">return</span>&nbsp;<span class="ident" id="2584311">n</span><span class="op" id="2584312">,</span>&nbsp;<span class="ident" id="2584314">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2584320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584324">copied</span>&nbsp;<span class="op" id="2584331">:=</span>&nbsp;<span class="builtinfunc" id="2584334">copy</span><span class="op" id="2584338">(</span><span class="ident" id="2584339">out</span><span class="op" id="2584342">,</span>&nbsp;<span class="ident" id="2584344">buf</span><span class="op" id="2584347">[</span><span class="num" id="2584348">0</span><span class="op" id="2584349">:</span><span class="op" id="2584350">]</span><span class="op" id="2584351">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584355">n</span>&nbsp;<span class="op" id="2584357">+=</span>&nbsp;<span class="ident" id="2584360">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584369">out</span>&nbsp;<span class="op" id="2584373">=</span>&nbsp;<span class="ident" id="2584375">out</span><span class="op" id="2584378">[</span><span class="ident" id="2584379">copied</span><span class="op" id="2584385">:</span><span class="op" id="2584386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2584389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584393">return</span>&nbsp;<span class="ident" id="2584400">n</span><span class="op" id="2584401">,</span>&nbsp;<span class="ident" id="2584403">nil</span><br>
<span class="lineno">620</span><span class="op" id="2584407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2584410">func</span>&nbsp;<span class="ident" id="2584415">PtracePeekText</span><span class="op" id="2584429">(</span><span class="ident" id="2584430">pid</span>&nbsp;<span class="builtintype" id="2584434">int</span><span class="op" id="2584437">,</span>&nbsp;<span class="ident" id="2584439">addr</span>&nbsp;<span class="builtintype" id="2584444">uintptr</span><span class="op" id="2584451">,</span>&nbsp;<span class="ident" id="2584453">out</span>&nbsp;<span class="op" id="2584457">[</span><span class="op" id="2584458">]</span><span class="builtintype" id="2584459">byte</span><span class="op" id="2584463">)</span>&nbsp;<span class="op" id="2584465">(</span><span class="ident" id="2584466">count</span>&nbsp;<span class="builtintype" id="2584472">int</span><span class="op" id="2584475">,</span>&nbsp;<span class="ident" id="2584477">err</span>&nbsp;<span class="builtintype" id="2584481">error</span><span class="op" id="2584486">)</span>&nbsp;<span class="op" id="2584488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584491">return</span>&nbsp;<span class="ident" id="2584498">ptracePeek</span><span class="op" id="2584508">(</span><span class="ident" id="2584509">PTRACE_PEEKTEXT</span><span class="op" id="2584524">,</span>&nbsp;<span class="ident" id="2584526">pid</span><span class="op" id="2584529">,</span>&nbsp;<span class="ident" id="2584531">addr</span><span class="op" id="2584535">,</span>&nbsp;<span class="ident" id="2584537">out</span><span class="op" id="2584540">)</span><br>
<span class="lineno"></span><span class="op" id="2584542">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2584545">func</span>&nbsp;<span class="ident" id="2584550">PtracePeekData</span><span class="op" id="2584564">(</span><span class="ident" id="2584565">pid</span>&nbsp;<span class="builtintype" id="2584569">int</span><span class="op" id="2584572">,</span>&nbsp;<span class="ident" id="2584574">addr</span>&nbsp;<span class="builtintype" id="2584579">uintptr</span><span class="op" id="2584586">,</span>&nbsp;<span class="ident" id="2584588">out</span>&nbsp;<span class="op" id="2584592">[</span><span class="op" id="2584593">]</span><span class="builtintype" id="2584594">byte</span><span class="op" id="2584598">)</span>&nbsp;<span class="op" id="2584600">(</span><span class="ident" id="2584601">count</span>&nbsp;<span class="builtintype" id="2584607">int</span><span class="op" id="2584610">,</span>&nbsp;<span class="ident" id="2584612">err</span>&nbsp;<span class="builtintype" id="2584616">error</span><span class="op" id="2584621">)</span>&nbsp;<span class="op" id="2584623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584626">return</span>&nbsp;<span class="ident" id="2584633">ptracePeek</span><span class="op" id="2584643">(</span><span class="ident" id="2584644">PTRACE_PEEKDATA</span><span class="op" id="2584659">,</span>&nbsp;<span class="ident" id="2584661">pid</span><span class="op" id="2584664">,</span>&nbsp;<span class="ident" id="2584666">addr</span><span class="op" id="2584670">,</span>&nbsp;<span class="ident" id="2584672">out</span><span class="op" id="2584675">)</span><br>
<span class="lineno"></span><span class="op" id="2584677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2584680">func</span>&nbsp;<span class="ident" id="2584685">ptracePoke</span><span class="op" id="2584695">(</span><span class="ident" id="2584696">pokeReq</span>&nbsp;<span class="builtintype" id="2584704">int</span><span class="op" id="2584707">,</span>&nbsp;<span class="ident" id="2584709">peekReq</span>&nbsp;<span class="builtintype" id="2584717">int</span><span class="op" id="2584720">,</span>&nbsp;<span class="ident" id="2584722">pid</span>&nbsp;<span class="builtintype" id="2584726">int</span><span class="op" id="2584729">,</span>&nbsp;<span class="ident" id="2584731">addr</span>&nbsp;<span class="builtintype" id="2584736">uintptr</span><span class="op" id="2584743">,</span>&nbsp;<span class="ident" id="2584745">data</span>&nbsp;<span class="op" id="2584750">[</span><span class="op" id="2584751">]</span><span class="builtintype" id="2584752">byte</span><span class="op" id="2584756">)</span>&nbsp;<span class="op" id="2584758">(</span><span class="ident" id="2584759">count</span>&nbsp;<span class="builtintype" id="2584765">int</span><span class="op" id="2584768">,</span>&nbsp;<span class="ident" id="2584770">err</span>&nbsp;<span class="builtintype" id="2584774">error</span><span class="op" id="2584779">)</span>&nbsp;<span class="op" id="2584781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2584784">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2584845">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2584902">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584920">n</span>&nbsp;<span class="op" id="2584922">:=</span>&nbsp;<span class="num" id="2584925">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584928">if</span>&nbsp;<span class="ident" id="2584931">addr</span><span class="op" id="2584935">%</span><span class="ident" id="2584936">sizeofPtr</span>&nbsp;<span class="op" id="2584946">!=</span>&nbsp;<span class="num" id="2584949">0</span>&nbsp;<span class="op" id="2584951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2584955">var</span>&nbsp;<span class="ident" id="2584959">buf</span>&nbsp;<span class="op" id="2584963">[</span><span class="ident" id="2584964">sizeofPtr</span><span class="op" id="2584973">]</span><span class="builtintype" id="2584974">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2584981">err</span>&nbsp;<span class="op" id="2584985">=</span>&nbsp;<span class="ident" id="2584987">ptrace</span><span class="op" id="2584993">(</span><span class="ident" id="2584994">peekReq</span><span class="op" id="2585001">,</span>&nbsp;<span class="ident" id="2585003">pid</span><span class="op" id="2585006">,</span>&nbsp;<span class="ident" id="2585008">addr</span><span class="op" id="2585012">-</span><span class="ident" id="2585013">addr</span><span class="op" id="2585017">%</span><span class="ident" id="2585018">sizeofPtr</span><span class="op" id="2585027">,</span>&nbsp;<span class="builtintype" id="2585029">uintptr</span><span class="op" id="2585036">(</span><span class="ident" id="2585037">unsafe</span><span class="op" id="2585043">.</span><span class="ident" id="2585044">Pointer</span><span class="op" id="2585051">(</span><span class="op" id="2585052">&amp;</span><span class="ident" id="2585053">buf</span><span class="op" id="2585056">[</span><span class="num" id="2585057">0</span><span class="op" id="2585058">]</span><span class="op" id="2585059">)</span><span class="op" id="2585060">)</span><span class="op" id="2585061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585065">if</span>&nbsp;<span class="ident" id="2585068">err</span>&nbsp;<span class="op" id="2585072">!=</span>&nbsp;<span class="ident" id="2585075">nil</span>&nbsp;<span class="op" id="2585079">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585084">return</span>&nbsp;<span class="num" id="2585091">0</span><span class="op" id="2585092">,</span>&nbsp;<span class="ident" id="2585094">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585104">n</span>&nbsp;<span class="op" id="2585106">+=</span>&nbsp;<span class="builtinfunc" id="2585109">copy</span><span class="op" id="2585113">(</span><span class="ident" id="2585114">buf</span><span class="op" id="2585117">[</span><span class="ident" id="2585118">addr</span><span class="op" id="2585122">%</span><span class="ident" id="2585123">sizeofPtr</span><span class="op" id="2585132">:</span><span class="op" id="2585133">]</span><span class="op" id="2585134">,</span>&nbsp;<span class="ident" id="2585136">data</span><span class="op" id="2585140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585144">word</span>&nbsp;<span class="op" id="2585149">:=</span>&nbsp;<span class="op" id="2585152">*</span><span class="op" id="2585153">(</span><span class="op" id="2585154">(</span><span class="op" id="2585155">*</span><span class="builtintype" id="2585156">uintptr</span><span class="op" id="2585163">)</span><span class="op" id="2585164">(</span><span class="ident" id="2585165">unsafe</span><span class="op" id="2585171">.</span><span class="ident" id="2585172">Pointer</span><span class="op" id="2585179">(</span><span class="op" id="2585180">&amp;</span><span class="ident" id="2585181">buf</span><span class="op" id="2585184">[</span><span class="num" id="2585185">0</span><span class="op" id="2585186">]</span><span class="op" id="2585187">)</span><span class="op" id="2585188">)</span><span class="op" id="2585189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585193">err</span>&nbsp;<span class="op" id="2585197">=</span>&nbsp;<span class="ident" id="2585199">ptrace</span><span class="op" id="2585205">(</span><span class="ident" id="2585206">pokeReq</span><span class="op" id="2585213">,</span>&nbsp;<span class="ident" id="2585215">pid</span><span class="op" id="2585218">,</span>&nbsp;<span class="ident" id="2585220">addr</span><span class="op" id="2585224">-</span><span class="ident" id="2585225">addr</span><span class="op" id="2585229">%</span><span class="ident" id="2585230">sizeofPtr</span><span class="op" id="2585239">,</span>&nbsp;<span class="ident" id="2585241">word</span><span class="op" id="2585245">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585249">if</span>&nbsp;<span class="ident" id="2585252">err</span>&nbsp;<span class="op" id="2585256">!=</span>&nbsp;<span class="ident" id="2585259">nil</span>&nbsp;<span class="op" id="2585263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585268">return</span>&nbsp;<span class="num" id="2585275">0</span><span class="op" id="2585276">,</span>&nbsp;<span class="ident" id="2585278">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585288">data</span>&nbsp;<span class="op" id="2585293">=</span>&nbsp;<span class="ident" id="2585295">data</span><span class="op" id="2585299">[</span><span class="ident" id="2585300">n</span><span class="op" id="2585301">:</span><span class="op" id="2585302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585305">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2585309">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585323">for</span>&nbsp;<span class="builtinfunc" id="2585327">len</span><span class="op" id="2585330">(</span><span class="ident" id="2585331">data</span><span class="op" id="2585335">)</span>&nbsp;<span class="op" id="2585337">&gt;</span>&nbsp;<span class="ident" id="2585339">sizeofPtr</span>&nbsp;<span class="op" id="2585349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585353">word</span>&nbsp;<span class="op" id="2585358">:=</span>&nbsp;<span class="op" id="2585361">*</span><span class="op" id="2585362">(</span><span class="op" id="2585363">(</span><span class="op" id="2585364">*</span><span class="builtintype" id="2585365">uintptr</span><span class="op" id="2585372">)</span><span class="op" id="2585373">(</span><span class="ident" id="2585374">unsafe</span><span class="op" id="2585380">.</span><span class="ident" id="2585381">Pointer</span><span class="op" id="2585388">(</span><span class="op" id="2585389">&amp;</span><span class="ident" id="2585390">data</span><span class="op" id="2585394">[</span><span class="num" id="2585395">0</span><span class="op" id="2585396">]</span><span class="op" id="2585397">)</span><span class="op" id="2585398">)</span><span class="op" id="2585399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585403">err</span>&nbsp;<span class="op" id="2585407">=</span>&nbsp;<span class="ident" id="2585409">ptrace</span><span class="op" id="2585415">(</span><span class="ident" id="2585416">pokeReq</span><span class="op" id="2585423">,</span>&nbsp;<span class="ident" id="2585425">pid</span><span class="op" id="2585428">,</span>&nbsp;<span class="ident" id="2585430">addr</span><span class="op" id="2585434">+</span><span class="builtintype" id="2585435">uintptr</span><span class="op" id="2585442">(</span><span class="ident" id="2585443">n</span><span class="op" id="2585444">)</span><span class="op" id="2585445">,</span>&nbsp;<span class="ident" id="2585447">word</span><span class="op" id="2585451">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585455">if</span>&nbsp;<span class="ident" id="2585458">err</span>&nbsp;<span class="op" id="2585462">!=</span>&nbsp;<span class="ident" id="2585465">nil</span>&nbsp;<span class="op" id="2585469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585474">return</span>&nbsp;<span class="ident" id="2585481">n</span><span class="op" id="2585482">,</span>&nbsp;<span class="ident" id="2585484">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585494">n</span>&nbsp;<span class="op" id="2585496">+=</span>&nbsp;<span class="ident" id="2585499">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585511">data</span>&nbsp;<span class="op" id="2585516">=</span>&nbsp;<span class="ident" id="2585518">data</span><span class="op" id="2585522">[</span><span class="ident" id="2585523">sizeofPtr</span><span class="op" id="2585532">:</span><span class="op" id="2585533">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2585540">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585559">if</span>&nbsp;<span class="builtinfunc" id="2585562">len</span><span class="op" id="2585565">(</span><span class="ident" id="2585566">data</span><span class="op" id="2585570">)</span>&nbsp;<span class="op" id="2585572">&gt;</span>&nbsp;<span class="num" id="2585574">0</span>&nbsp;<span class="op" id="2585576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585580">var</span>&nbsp;<span class="ident" id="2585584">buf</span>&nbsp;<span class="op" id="2585588">[</span><span class="ident" id="2585589">sizeofPtr</span><span class="op" id="2585598">]</span><span class="builtintype" id="2585599">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585606">err</span>&nbsp;<span class="op" id="2585610">=</span>&nbsp;<span class="ident" id="2585612">ptrace</span><span class="op" id="2585618">(</span><span class="ident" id="2585619">peekReq</span><span class="op" id="2585626">,</span>&nbsp;<span class="ident" id="2585628">pid</span><span class="op" id="2585631">,</span>&nbsp;<span class="ident" id="2585633">addr</span><span class="op" id="2585637">+</span><span class="builtintype" id="2585638">uintptr</span><span class="op" id="2585645">(</span><span class="ident" id="2585646">n</span><span class="op" id="2585647">)</span><span class="op" id="2585648">,</span>&nbsp;<span class="builtintype" id="2585650">uintptr</span><span class="op" id="2585657">(</span><span class="ident" id="2585658">unsafe</span><span class="op" id="2585664">.</span><span class="ident" id="2585665">Pointer</span><span class="op" id="2585672">(</span><span class="op" id="2585673">&amp;</span><span class="ident" id="2585674">buf</span><span class="op" id="2585677">[</span><span class="num" id="2585678">0</span><span class="op" id="2585679">]</span><span class="op" id="2585680">)</span><span class="op" id="2585681">)</span><span class="op" id="2585682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585686">if</span>&nbsp;<span class="ident" id="2585689">err</span>&nbsp;<span class="op" id="2585693">!=</span>&nbsp;<span class="ident" id="2585696">nil</span>&nbsp;<span class="op" id="2585700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585705">return</span>&nbsp;<span class="ident" id="2585712">n</span><span class="op" id="2585713">,</span>&nbsp;<span class="ident" id="2585715">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2585725">copy</span><span class="op" id="2585729">(</span><span class="ident" id="2585730">buf</span><span class="op" id="2585733">[</span><span class="num" id="2585734">0</span><span class="op" id="2585735">:</span><span class="op" id="2585736">]</span><span class="op" id="2585737">,</span>&nbsp;<span class="ident" id="2585739">data</span><span class="op" id="2585743">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585747">word</span>&nbsp;<span class="op" id="2585752">:=</span>&nbsp;<span class="op" id="2585755">*</span><span class="op" id="2585756">(</span><span class="op" id="2585757">(</span><span class="op" id="2585758">*</span><span class="builtintype" id="2585759">uintptr</span><span class="op" id="2585766">)</span><span class="op" id="2585767">(</span><span class="ident" id="2585768">unsafe</span><span class="op" id="2585774">.</span><span class="ident" id="2585775">Pointer</span><span class="op" id="2585782">(</span><span class="op" id="2585783">&amp;</span><span class="ident" id="2585784">buf</span><span class="op" id="2585787">[</span><span class="num" id="2585788">0</span><span class="op" id="2585789">]</span><span class="op" id="2585790">)</span><span class="op" id="2585791">)</span><span class="op" id="2585792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585796">err</span>&nbsp;<span class="op" id="2585800">=</span>&nbsp;<span class="ident" id="2585802">ptrace</span><span class="op" id="2585808">(</span><span class="ident" id="2585809">pokeReq</span><span class="op" id="2585816">,</span>&nbsp;<span class="ident" id="2585818">pid</span><span class="op" id="2585821">,</span>&nbsp;<span class="ident" id="2585823">addr</span><span class="op" id="2585827">+</span><span class="builtintype" id="2585828">uintptr</span><span class="op" id="2585835">(</span><span class="ident" id="2585836">n</span><span class="op" id="2585837">)</span><span class="op" id="2585838">,</span>&nbsp;<span class="ident" id="2585840">word</span><span class="op" id="2585844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585848">if</span>&nbsp;<span class="ident" id="2585851">err</span>&nbsp;<span class="op" id="2585855">!=</span>&nbsp;<span class="ident" id="2585858">nil</span>&nbsp;<span class="op" id="2585862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585867">return</span>&nbsp;<span class="ident" id="2585874">n</span><span class="op" id="2585875">,</span>&nbsp;<span class="ident" id="2585877">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585883">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2585887">n</span>&nbsp;<span class="op" id="2585889">+=</span>&nbsp;<span class="builtinfunc" id="2585892">len</span><span class="op" id="2585895">(</span><span class="ident" id="2585896">data</span><span class="op" id="2585900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2585903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2585907">return</span>&nbsp;<span class="ident" id="2585914">n</span><span class="op" id="2585915">,</span>&nbsp;<span class="ident" id="2585917">nil</span><br>
<span class="lineno"></span><span class="op" id="2585921">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2585924">func</span>&nbsp;<span class="ident" id="2585929">PtracePokeText</span><span class="op" id="2585943">(</span><span class="ident" id="2585944">pid</span>&nbsp;<span class="builtintype" id="2585948">int</span><span class="op" id="2585951">,</span>&nbsp;<span class="ident" id="2585953">addr</span>&nbsp;<span class="builtintype" id="2585958">uintptr</span><span class="op" id="2585965">,</span>&nbsp;<span class="ident" id="2585967">data</span>&nbsp;<span class="op" id="2585972">[</span><span class="op" id="2585973">]</span><span class="builtintype" id="2585974">byte</span><span class="op" id="2585978">)</span>&nbsp;<span class="op" id="2585980">(</span><span class="ident" id="2585981">count</span>&nbsp;<span class="builtintype" id="2585987">int</span><span class="op" id="2585990">,</span>&nbsp;<span class="ident" id="2585992">err</span>&nbsp;<span class="builtintype" id="2585996">error</span><span class="op" id="2586001">)</span>&nbsp;<span class="op" id="2586003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586006">return</span>&nbsp;<span class="ident" id="2586013">ptracePoke</span><span class="op" id="2586023">(</span><span class="ident" id="2586024">PTRACE_POKETEXT</span><span class="op" id="2586039">,</span>&nbsp;<span class="ident" id="2586041">PTRACE_PEEKTEXT</span><span class="op" id="2586056">,</span>&nbsp;<span class="ident" id="2586058">pid</span><span class="op" id="2586061">,</span>&nbsp;<span class="ident" id="2586063">addr</span><span class="op" id="2586067">,</span>&nbsp;<span class="ident" id="2586069">data</span><span class="op" id="2586073">)</span><br>
<span class="lineno"></span><span class="op" id="2586075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2586078">func</span>&nbsp;<span class="ident" id="2586083">PtracePokeData</span><span class="op" id="2586097">(</span><span class="ident" id="2586098">pid</span>&nbsp;<span class="builtintype" id="2586102">int</span><span class="op" id="2586105">,</span>&nbsp;<span class="ident" id="2586107">addr</span>&nbsp;<span class="builtintype" id="2586112">uintptr</span><span class="op" id="2586119">,</span>&nbsp;<span class="ident" id="2586121">data</span>&nbsp;<span class="op" id="2586126">[</span><span class="op" id="2586127">]</span><span class="builtintype" id="2586128">byte</span><span class="op" id="2586132">)</span>&nbsp;<span class="op" id="2586134">(</span><span class="ident" id="2586135">count</span>&nbsp;<span class="builtintype" id="2586141">int</span><span class="op" id="2586144">,</span>&nbsp;<span class="ident" id="2586146">err</span>&nbsp;<span class="builtintype" id="2586150">error</span><span class="op" id="2586155">)</span>&nbsp;<span class="op" id="2586157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586160">return</span>&nbsp;<span class="ident" id="2586167">ptracePoke</span><span class="op" id="2586177">(</span><span class="ident" id="2586178">PTRACE_POKEDATA</span><span class="op" id="2586193">,</span>&nbsp;<span class="ident" id="2586195">PTRACE_PEEKDATA</span><span class="op" id="2586210">,</span>&nbsp;<span class="ident" id="2586212">pid</span><span class="op" id="2586215">,</span>&nbsp;<span class="ident" id="2586217">addr</span><span class="op" id="2586221">,</span>&nbsp;<span class="ident" id="2586223">data</span><span class="op" id="2586227">)</span><br>
<span class="lineno"></span><span class="op" id="2586229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2586232">func</span>&nbsp;<span class="ident" id="2586237">PtraceGetRegs</span><span class="op" id="2586250">(</span><span class="ident" id="2586251">pid</span>&nbsp;<span class="builtintype" id="2586255">int</span><span class="op" id="2586258">,</span>&nbsp;<span class="ident" id="2586260">regsout</span>&nbsp;<span class="op" id="2586268">*</span><span class="ident" id="2586269">PtraceRegs</span><span class="op" id="2586279">)</span>&nbsp;<span class="op" id="2586281">(</span><span class="ident" id="2586282">err</span>&nbsp;<span class="builtintype" id="2586286">error</span><span class="op" id="2586291">)</span>&nbsp;<span class="op" id="2586293">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586296">return</span>&nbsp;<span class="ident" id="2586303">ptrace</span><span class="op" id="2586309">(</span><span class="ident" id="2586310">PTRACE_GETREGS</span><span class="op" id="2586324">,</span>&nbsp;<span class="ident" id="2586326">pid</span><span class="op" id="2586329">,</span>&nbsp;<span class="num" id="2586331">0</span><span class="op" id="2586332">,</span>&nbsp;<span class="builtintype" id="2586334">uintptr</span><span class="op" id="2586341">(</span><span class="ident" id="2586342">unsafe</span><span class="op" id="2586348">.</span><span class="ident" id="2586349">Pointer</span><span class="op" id="2586356">(</span><span class="ident" id="2586357">regsout</span><span class="op" id="2586364">)</span><span class="op" id="2586365">)</span><span class="op" id="2586366">)</span><br>
<span class="lineno"></span><span class="op" id="2586368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2586371">func</span>&nbsp;<span class="ident" id="2586376">PtraceSetRegs</span><span class="op" id="2586389">(</span><span class="ident" id="2586390">pid</span>&nbsp;<span class="builtintype" id="2586394">int</span><span class="op" id="2586397">,</span>&nbsp;<span class="ident" id="2586399">regs</span>&nbsp;<span class="op" id="2586404">*</span><span class="ident" id="2586405">PtraceRegs</span><span class="op" id="2586415">)</span>&nbsp;<span class="op" id="2586417">(</span><span class="ident" id="2586418">err</span>&nbsp;<span class="builtintype" id="2586422">error</span><span class="op" id="2586427">)</span>&nbsp;<span class="op" id="2586429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586432">return</span>&nbsp;<span class="ident" id="2586439">ptrace</span><span class="op" id="2586445">(</span><span class="ident" id="2586446">PTRACE_SETREGS</span><span class="op" id="2586460">,</span>&nbsp;<span class="ident" id="2586462">pid</span><span class="op" id="2586465">,</span>&nbsp;<span class="num" id="2586467">0</span><span class="op" id="2586468">,</span>&nbsp;<span class="builtintype" id="2586470">uintptr</span><span class="op" id="2586477">(</span><span class="ident" id="2586478">unsafe</span><span class="op" id="2586484">.</span><span class="ident" id="2586485">Pointer</span><span class="op" id="2586492">(</span><span class="ident" id="2586493">regs</span><span class="op" id="2586497">)</span><span class="op" id="2586498">)</span><span class="op" id="2586499">)</span><br>
<span class="lineno">695</span><span class="op" id="2586501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2586504">func</span>&nbsp;<span class="ident" id="2586509">PtraceSetOptions</span><span class="op" id="2586525">(</span><span class="ident" id="2586526">pid</span>&nbsp;<span class="builtintype" id="2586530">int</span><span class="op" id="2586533">,</span>&nbsp;<span class="ident" id="2586535">options</span>&nbsp;<span class="builtintype" id="2586543">int</span><span class="op" id="2586546">)</span>&nbsp;<span class="op" id="2586548">(</span><span class="ident" id="2586549">err</span>&nbsp;<span class="builtintype" id="2586553">error</span><span class="op" id="2586558">)</span>&nbsp;<span class="op" id="2586560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586563">return</span>&nbsp;<span class="ident" id="2586570">ptrace</span><span class="op" id="2586576">(</span><span class="ident" id="2586577">PTRACE_SETOPTIONS</span><span class="op" id="2586594">,</span>&nbsp;<span class="ident" id="2586596">pid</span><span class="op" id="2586599">,</span>&nbsp;<span class="num" id="2586601">0</span><span class="op" id="2586602">,</span>&nbsp;<span class="builtintype" id="2586604">uintptr</span><span class="op" id="2586611">(</span><span class="ident" id="2586612">options</span><span class="op" id="2586619">)</span><span class="op" id="2586620">)</span><br>
<span class="lineno"></span><span class="op" id="2586622">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2586625">func</span>&nbsp;<span class="ident" id="2586630">PtraceGetEventMsg</span><span class="op" id="2586647">(</span><span class="ident" id="2586648">pid</span>&nbsp;<span class="builtintype" id="2586652">int</span><span class="op" id="2586655">)</span>&nbsp;<span class="op" id="2586657">(</span><span class="ident" id="2586658">msg</span>&nbsp;<span class="builtintype" id="2586662">uint</span><span class="op" id="2586666">,</span>&nbsp;<span class="ident" id="2586668">err</span>&nbsp;<span class="builtintype" id="2586672">error</span><span class="op" id="2586677">)</span>&nbsp;<span class="op" id="2586679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586682">var</span>&nbsp;<span class="ident" id="2586686">data</span>&nbsp;<span class="ident" id="2586691">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2586700">err</span>&nbsp;<span class="op" id="2586704">=</span>&nbsp;<span class="ident" id="2586706">ptrace</span><span class="op" id="2586712">(</span><span class="ident" id="2586713">PTRACE_GETEVENTMSG</span><span class="op" id="2586731">,</span>&nbsp;<span class="ident" id="2586733">pid</span><span class="op" id="2586736">,</span>&nbsp;<span class="num" id="2586738">0</span><span class="op" id="2586739">,</span>&nbsp;<span class="builtintype" id="2586741">uintptr</span><span class="op" id="2586748">(</span><span class="ident" id="2586749">unsafe</span><span class="op" id="2586755">.</span><span class="ident" id="2586756">Pointer</span><span class="op" id="2586763">(</span><span class="op" id="2586764">&amp;</span><span class="ident" id="2586765">data</span><span class="op" id="2586769">)</span><span class="op" id="2586770">)</span><span class="op" id="2586771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2586774">msg</span>&nbsp;<span class="op" id="2586778">=</span>&nbsp;<span class="builtintype" id="2586780">uint</span><span class="op" id="2586784">(</span><span class="ident" id="2586785">data</span><span class="op" id="2586789">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586792">return</span><br>
<span class="lineno"></span><span class="op" id="2586799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2586802">func</span>&nbsp;<span class="ident" id="2586807">PtraceCont</span><span class="op" id="2586817">(</span><span class="ident" id="2586818">pid</span>&nbsp;<span class="builtintype" id="2586822">int</span><span class="op" id="2586825">,</span>&nbsp;<span class="ident" id="2586827">signal</span>&nbsp;<span class="builtintype" id="2586834">int</span><span class="op" id="2586837">)</span>&nbsp;<span class="op" id="2586839">(</span><span class="ident" id="2586840">err</span>&nbsp;<span class="builtintype" id="2586844">error</span><span class="op" id="2586849">)</span>&nbsp;<span class="op" id="2586851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586854">return</span>&nbsp;<span class="ident" id="2586861">ptrace</span><span class="op" id="2586867">(</span><span class="ident" id="2586868">PTRACE_CONT</span><span class="op" id="2586879">,</span>&nbsp;<span class="ident" id="2586881">pid</span><span class="op" id="2586884">,</span>&nbsp;<span class="num" id="2586886">0</span><span class="op" id="2586887">,</span>&nbsp;<span class="builtintype" id="2586889">uintptr</span><span class="op" id="2586896">(</span><span class="ident" id="2586897">signal</span><span class="op" id="2586903">)</span><span class="op" id="2586904">)</span><br>
<span class="lineno">710</span><span class="op" id="2586906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2586909">func</span>&nbsp;<span class="ident" id="2586914">PtraceSyscall</span><span class="op" id="2586927">(</span><span class="ident" id="2586928">pid</span>&nbsp;<span class="builtintype" id="2586932">int</span><span class="op" id="2586935">,</span>&nbsp;<span class="ident" id="2586937">signal</span>&nbsp;<span class="builtintype" id="2586944">int</span><span class="op" id="2586947">)</span>&nbsp;<span class="op" id="2586949">(</span><span class="ident" id="2586950">err</span>&nbsp;<span class="builtintype" id="2586954">error</span><span class="op" id="2586959">)</span>&nbsp;<span class="op" id="2586961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2586964">return</span>&nbsp;<span class="ident" id="2586971">ptrace</span><span class="op" id="2586977">(</span><span class="ident" id="2586978">PTRACE_SYSCALL</span><span class="op" id="2586992">,</span>&nbsp;<span class="ident" id="2586994">pid</span><span class="op" id="2586997">,</span>&nbsp;<span class="num" id="2586999">0</span><span class="op" id="2587000">,</span>&nbsp;<span class="builtintype" id="2587002">uintptr</span><span class="op" id="2587009">(</span><span class="ident" id="2587010">signal</span><span class="op" id="2587016">)</span><span class="op" id="2587017">)</span><br>
<span class="lineno"></span><span class="op" id="2587019">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2587022">func</span>&nbsp;<span class="ident" id="2587027">PtraceSingleStep</span><span class="op" id="2587043">(</span><span class="ident" id="2587044">pid</span>&nbsp;<span class="builtintype" id="2587048">int</span><span class="op" id="2587051">)</span>&nbsp;<span class="op" id="2587053">(</span><span class="ident" id="2587054">err</span>&nbsp;<span class="builtintype" id="2587058">error</span><span class="op" id="2587063">)</span>&nbsp;<span class="op" id="2587065">{</span>&nbsp;<span class="keyword" id="2587067">return</span>&nbsp;<span class="ident" id="2587074">ptrace</span><span class="op" id="2587080">(</span><span class="ident" id="2587081">PTRACE_SINGLESTEP</span><span class="op" id="2587098">,</span>&nbsp;<span class="ident" id="2587100">pid</span><span class="op" id="2587103">,</span>&nbsp;<span class="num" id="2587105">0</span><span class="op" id="2587106">,</span>&nbsp;<span class="num" id="2587108">0</span><span class="op" id="2587109">)</span>&nbsp;<span class="op" id="2587111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2587114">func</span>&nbsp;<span class="ident" id="2587119">PtraceAttach</span><span class="op" id="2587131">(</span><span class="ident" id="2587132">pid</span>&nbsp;<span class="builtintype" id="2587136">int</span><span class="op" id="2587139">)</span>&nbsp;<span class="op" id="2587141">(</span><span class="ident" id="2587142">err</span>&nbsp;<span class="builtintype" id="2587146">error</span><span class="op" id="2587151">)</span>&nbsp;<span class="op" id="2587153">{</span>&nbsp;<span class="keyword" id="2587155">return</span>&nbsp;<span class="ident" id="2587162">ptrace</span><span class="op" id="2587168">(</span><span class="ident" id="2587169">PTRACE_ATTACH</span><span class="op" id="2587182">,</span>&nbsp;<span class="ident" id="2587184">pid</span><span class="op" id="2587187">,</span>&nbsp;<span class="num" id="2587189">0</span><span class="op" id="2587190">,</span>&nbsp;<span class="num" id="2587192">0</span><span class="op" id="2587193">)</span>&nbsp;<span class="op" id="2587195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2587198">func</span>&nbsp;<span class="ident" id="2587203">PtraceDetach</span><span class="op" id="2587215">(</span><span class="ident" id="2587216">pid</span>&nbsp;<span class="builtintype" id="2587220">int</span><span class="op" id="2587223">)</span>&nbsp;<span class="op" id="2587225">(</span><span class="ident" id="2587226">err</span>&nbsp;<span class="builtintype" id="2587230">error</span><span class="op" id="2587235">)</span>&nbsp;<span class="op" id="2587237">{</span>&nbsp;<span class="keyword" id="2587239">return</span>&nbsp;<span class="ident" id="2587246">ptrace</span><span class="op" id="2587252">(</span><span class="ident" id="2587253">PTRACE_DETACH</span><span class="op" id="2587266">,</span>&nbsp;<span class="ident" id="2587268">pid</span><span class="op" id="2587271">,</span>&nbsp;<span class="num" id="2587273">0</span><span class="op" id="2587274">,</span>&nbsp;<span class="num" id="2587276">0</span><span class="op" id="2587277">)</span>&nbsp;<span class="op" id="2587279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2587282">//sys&nbsp;&nbsp;&nbsp;&nbsp;reboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2587355">func</span>&nbsp;<span class="ident" id="2587360">Reboot</span><span class="op" id="2587366">(</span><span class="ident" id="2587367">cmd</span>&nbsp;<span class="builtintype" id="2587371">int</span><span class="op" id="2587374">)</span>&nbsp;<span class="op" id="2587376">(</span><span class="ident" id="2587377">err</span>&nbsp;<span class="builtintype" id="2587381">error</span><span class="op" id="2587386">)</span>&nbsp;<span class="op" id="2587388">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587391">return</span>&nbsp;<span class="ident" id="2587398">reboot</span><span class="op" id="2587404">(</span><span class="ident" id="2587405">LINUX_REBOOT_MAGIC1</span><span class="op" id="2587424">,</span>&nbsp;<span class="ident" id="2587426">LINUX_REBOOT_MAGIC2</span><span class="op" id="2587445">,</span>&nbsp;<span class="ident" id="2587447">cmd</span><span class="op" id="2587450">,</span>&nbsp;<span class="string" id="2587452">&#34;&#34;</span><span class="op" id="2587454">)</span><br>
<span class="lineno"></span><span class="op" id="2587456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2587459">func</span>&nbsp;<span class="ident" id="2587464">clen</span><span class="op" id="2587468">(</span><span class="ident" id="2587469">n</span>&nbsp;<span class="op" id="2587471">[</span><span class="op" id="2587472">]</span><span class="builtintype" id="2587473">byte</span><span class="op" id="2587477">)</span>&nbsp;<span class="builtintype" id="2587479">int</span>&nbsp;<span class="op" id="2587483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587486">for</span>&nbsp;<span class="ident" id="2587490">i</span>&nbsp;<span class="op" id="2587492">:=</span>&nbsp;<span class="num" id="2587495">0</span><span class="op" id="2587496">;</span>&nbsp;<span class="ident" id="2587498">i</span>&nbsp;<span class="op" id="2587500">&lt;</span>&nbsp;<span class="builtinfunc" id="2587502">len</span><span class="op" id="2587505">(</span><span class="ident" id="2587506">n</span><span class="op" id="2587507">)</span><span class="op" id="2587508">;</span>&nbsp;<span class="ident" id="2587510">i</span><span class="op" id="2587511">++</span>&nbsp;<span class="op" id="2587514">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587518">if</span>&nbsp;<span class="ident" id="2587521">n</span><span class="op" id="2587522">[</span><span class="ident" id="2587523">i</span><span class="op" id="2587524">]</span>&nbsp;<span class="op" id="2587526">==</span>&nbsp;<span class="num" id="2587529">0</span>&nbsp;<span class="op" id="2587531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587536">return</span>&nbsp;<span class="ident" id="2587543">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2587547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2587550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587553">return</span>&nbsp;<span class="builtinfunc" id="2587560">len</span><span class="op" id="2587563">(</span><span class="ident" id="2587564">n</span><span class="op" id="2587565">)</span><br>
<span class="lineno">735</span><span class="op" id="2587567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2587570">func</span>&nbsp;<span class="ident" id="2587575">ReadDirent</span><span class="op" id="2587585">(</span><span class="ident" id="2587586">fd</span>&nbsp;<span class="builtintype" id="2587589">int</span><span class="op" id="2587592">,</span>&nbsp;<span class="ident" id="2587594">buf</span>&nbsp;<span class="op" id="2587598">[</span><span class="op" id="2587599">]</span><span class="builtintype" id="2587600">byte</span><span class="op" id="2587604">)</span>&nbsp;<span class="op" id="2587606">(</span><span class="ident" id="2587607">n</span>&nbsp;<span class="builtintype" id="2587609">int</span><span class="op" id="2587612">,</span>&nbsp;<span class="ident" id="2587614">err</span>&nbsp;<span class="builtintype" id="2587618">error</span><span class="op" id="2587623">)</span>&nbsp;<span class="op" id="2587625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587628">return</span>&nbsp;<span class="ident" id="2587635">Getdents</span><span class="op" id="2587643">(</span><span class="ident" id="2587644">fd</span><span class="op" id="2587646">,</span>&nbsp;<span class="ident" id="2587648">buf</span><span class="op" id="2587651">)</span><br>
<span class="lineno"></span><span class="op" id="2587653">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2587656">func</span>&nbsp;<span class="ident" id="2587661">ParseDirent</span><span class="op" id="2587672">(</span><span class="ident" id="2587673">buf</span>&nbsp;<span class="op" id="2587677">[</span><span class="op" id="2587678">]</span><span class="builtintype" id="2587679">byte</span><span class="op" id="2587683">,</span>&nbsp;<span class="ident" id="2587685">max</span>&nbsp;<span class="builtintype" id="2587689">int</span><span class="op" id="2587692">,</span>&nbsp;<span class="ident" id="2587694">names</span>&nbsp;<span class="op" id="2587700">[</span><span class="op" id="2587701">]</span><span class="builtintype" id="2587702">string</span><span class="op" id="2587708">)</span>&nbsp;<span class="op" id="2587710">(</span><span class="ident" id="2587711">consumed</span>&nbsp;<span class="builtintype" id="2587720">int</span><span class="op" id="2587723">,</span>&nbsp;<span class="ident" id="2587725">count</span>&nbsp;<span class="builtintype" id="2587731">int</span><span class="op" id="2587734">,</span>&nbsp;<span class="ident" id="2587736">newnames</span>&nbsp;<span class="op" id="2587745">[</span><span class="op" id="2587746">]</span><span class="builtintype" id="2587747">string</span><span class="op" id="2587753">)</span>&nbsp;<span class="op" id="2587755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2587758">origlen</span>&nbsp;<span class="op" id="2587766">:=</span>&nbsp;<span class="builtinfunc" id="2587769">len</span><span class="op" id="2587772">(</span><span class="ident" id="2587773">buf</span><span class="op" id="2587776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2587779">count</span>&nbsp;<span class="op" id="2587785">=</span>&nbsp;<span class="num" id="2587787">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587790">for</span>&nbsp;<span class="ident" id="2587794">max</span>&nbsp;<span class="op" id="2587798">!=</span>&nbsp;<span class="num" id="2587801">0</span>&nbsp;<span class="op" id="2587803">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2587806">len</span><span class="op" id="2587809">(</span><span class="ident" id="2587810">buf</span><span class="op" id="2587813">)</span>&nbsp;<span class="op" id="2587815">&gt;</span>&nbsp;<span class="num" id="2587817">0</span>&nbsp;<span class="op" id="2587819">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2587823">dirent</span>&nbsp;<span class="op" id="2587830">:=</span>&nbsp;<span class="op" id="2587833">(</span><span class="op" id="2587834">*</span><span class="ident" id="2587835">Dirent</span><span class="op" id="2587841">)</span><span class="op" id="2587842">(</span><span class="ident" id="2587843">unsafe</span><span class="op" id="2587849">.</span><span class="ident" id="2587850">Pointer</span><span class="op" id="2587857">(</span><span class="op" id="2587858">&amp;</span><span class="ident" id="2587859">buf</span><span class="op" id="2587862">[</span><span class="num" id="2587863">0</span><span class="op" id="2587864">]</span><span class="op" id="2587865">)</span><span class="op" id="2587866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2587870">buf</span>&nbsp;<span class="op" id="2587874">=</span>&nbsp;<span class="ident" id="2587876">buf</span><span class="op" id="2587879">[</span><span class="ident" id="2587880">dirent</span><span class="op" id="2587886">.</span><span class="ident" id="2587887">Reclen</span><span class="op" id="2587893">:</span><span class="op" id="2587894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587898">if</span>&nbsp;<span class="ident" id="2587901">dirent</span><span class="op" id="2587907">.</span><span class="ident" id="2587908">Ino</span>&nbsp;<span class="op" id="2587912">==</span>&nbsp;<span class="num" id="2587915">0</span>&nbsp;<span class="op" id="2587917">{</span>&nbsp;<span class="comment" id="2587919">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2587951">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2587962">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2587966">bytes</span>&nbsp;<span class="op" id="2587972">:=</span>&nbsp;<span class="op" id="2587975">(</span><span class="op" id="2587976">*</span><span class="op" id="2587977">[</span><span class="num" id="2587978">10000</span><span class="op" id="2587983">]</span><span class="builtintype" id="2587984">byte</span><span class="op" id="2587988">)</span><span class="op" id="2587989">(</span><span class="ident" id="2587990">unsafe</span><span class="op" id="2587996">.</span><span class="ident" id="2587997">Pointer</span><span class="op" id="2588004">(</span><span class="op" id="2588005">&amp;</span><span class="ident" id="2588006">dirent</span><span class="op" id="2588012">.</span><span class="ident" id="2588013">Name</span><span class="op" id="2588017">[</span><span class="num" id="2588018">0</span><span class="op" id="2588019">]</span><span class="op" id="2588020">)</span><span class="op" id="2588021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588025">var</span>&nbsp;<span class="ident" id="2588029">name</span>&nbsp;<span class="op" id="2588034">=</span>&nbsp;<span class="builtintype" id="2588036">string</span><span class="op" id="2588042">(</span><span class="ident" id="2588043">bytes</span><span class="op" id="2588048">[</span><span class="num" id="2588049">0</span><span class="op" id="2588050">:</span><span class="ident" id="2588051">clen</span><span class="op" id="2588055">(</span><span class="ident" id="2588056">bytes</span><span class="op" id="2588061">[</span><span class="op" id="2588062">:</span><span class="op" id="2588063">]</span><span class="op" id="2588064">)</span><span class="op" id="2588065">]</span><span class="op" id="2588066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588070">if</span>&nbsp;<span class="ident" id="2588073">name</span>&nbsp;<span class="op" id="2588078">==</span>&nbsp;<span class="string" id="2588081">&#34;.&#34;</span>&nbsp;<span class="op" id="2588085">||</span>&nbsp;<span class="ident" id="2588088">name</span>&nbsp;<span class="op" id="2588093">==</span>&nbsp;<span class="string" id="2588096">&#34;..&#34;</span>&nbsp;<span class="op" id="2588101">{</span>&nbsp;<span class="comment" id="2588103">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588123">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2588134">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2588138">max</span><span class="op" id="2588141">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2588146">count</span><span class="op" id="2588151">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2588156">names</span>&nbsp;<span class="op" id="2588162">=</span>&nbsp;<span class="builtinfunc" id="2588164">append</span><span class="op" id="2588170">(</span><span class="ident" id="2588171">names</span><span class="op" id="2588176">,</span>&nbsp;<span class="ident" id="2588178">name</span><span class="op" id="2588182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2588185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588188">return</span>&nbsp;<span class="ident" id="2588195">origlen</span>&nbsp;<span class="op" id="2588203">-</span>&nbsp;<span class="builtinfunc" id="2588205">len</span><span class="op" id="2588208">(</span><span class="ident" id="2588209">buf</span><span class="op" id="2588212">)</span><span class="op" id="2588213">,</span>&nbsp;<span class="ident" id="2588215">count</span><span class="op" id="2588220">,</span>&nbsp;<span class="ident" id="2588222">names</span><br>
<span class="lineno">760</span><span class="op" id="2588228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2588231">//sys&nbsp;&nbsp;&nbsp;&nbsp;mount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2588328">func</span>&nbsp;<span class="ident" id="2588333">Mount</span><span class="op" id="2588338">(</span><span class="ident" id="2588339">source</span>&nbsp;<span class="builtintype" id="2588346">string</span><span class="op" id="2588352">,</span>&nbsp;<span class="ident" id="2588354">target</span>&nbsp;<span class="builtintype" id="2588361">string</span><span class="op" id="2588367">,</span>&nbsp;<span class="ident" id="2588369">fstype</span>&nbsp;<span class="builtintype" id="2588376">string</span><span class="op" id="2588382">,</span>&nbsp;<span class="ident" id="2588384">flags</span>&nbsp;<span class="builtintype" id="2588390">uintptr</span><span class="op" id="2588397">,</span>&nbsp;<span class="ident" id="2588399">data</span>&nbsp;<span class="builtintype" id="2588404">string</span><span class="op" id="2588410">)</span>&nbsp;<span class="op" id="2588412">(</span><span class="ident" id="2588413">err</span>&nbsp;<span class="builtintype" id="2588417">error</span><span class="op" id="2588422">)</span>&nbsp;<span class="op" id="2588424">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2588427">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2588492">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588544">if</span>&nbsp;<span class="ident" id="2588547">data</span>&nbsp;<span class="op" id="2588552">==</span>&nbsp;<span class="string" id="2588555">&#34;&#34;</span>&nbsp;<span class="op" id="2588558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588562">return</span>&nbsp;<span class="ident" id="2588569">mount</span><span class="op" id="2588574">(</span><span class="ident" id="2588575">source</span><span class="op" id="2588581">,</span>&nbsp;<span class="ident" id="2588583">target</span><span class="op" id="2588589">,</span>&nbsp;<span class="ident" id="2588591">fstype</span><span class="op" id="2588597">,</span>&nbsp;<span class="ident" id="2588599">flags</span><span class="op" id="2588604">,</span>&nbsp;<span class="ident" id="2588606">nil</span><span class="op" id="2588609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2588612">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2588615">datap</span><span class="op" id="2588620">,</span>&nbsp;<span class="ident" id="2588622">err</span>&nbsp;<span class="op" id="2588626">:=</span>&nbsp;<span class="ident" id="2588629">BytePtrFromString</span><span class="op" id="2588646">(</span><span class="ident" id="2588647">data</span><span class="op" id="2588651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588654">if</span>&nbsp;<span class="ident" id="2588657">err</span>&nbsp;<span class="op" id="2588661">!=</span>&nbsp;<span class="ident" id="2588664">nil</span>&nbsp;<span class="op" id="2588668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588672">return</span>&nbsp;<span class="ident" id="2588679">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2588684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2588687">err</span>&nbsp;<span class="op" id="2588691">=</span>&nbsp;<span class="ident" id="2588693">mount</span><span class="op" id="2588698">(</span><span class="ident" id="2588699">source</span><span class="op" id="2588705">,</span>&nbsp;<span class="ident" id="2588707">target</span><span class="op" id="2588713">,</span>&nbsp;<span class="ident" id="2588715">fstype</span><span class="op" id="2588721">,</span>&nbsp;<span class="ident" id="2588723">flags</span><span class="op" id="2588728">,</span>&nbsp;<span class="ident" id="2588730">datap</span><span class="op" id="2588735">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2588738">use</span><span class="op" id="2588741">(</span><span class="ident" id="2588742">unsafe</span><span class="op" id="2588748">.</span><span class="ident" id="2588749">Pointer</span><span class="op" id="2588756">(</span><span class="ident" id="2588757">datap</span><span class="op" id="2588762">)</span><span class="op" id="2588763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2588766">return</span>&nbsp;<span class="ident" id="2588773">err</span><br>
<span class="lineno"></span><span class="op" id="2588777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2588780">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2588790">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2588802">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2588817">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2588841">//sys&nbsp;&nbsp;&nbsp;&nbsp;Access(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2588892">//sys&nbsp;&nbsp;&nbsp;&nbsp;Acct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2588928">//sys&nbsp;&nbsp;&nbsp;&nbsp;Adjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2588978">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2589015">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589065">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589103">//sys&nbsp;&nbsp;&nbsp;&nbsp;Close(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589135">//sys&nbsp;&nbsp;&nbsp;&nbsp;Creat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589193">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2589236">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589283">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589341">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589391">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589442">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2589516">//sys&nbsp;&nbsp;&nbsp;&nbsp;EpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589592">//sys&nbsp;&nbsp;&nbsp;&nbsp;Exit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2589630">//sys&nbsp;&nbsp;&nbsp;&nbsp;Faccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589706">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589777">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2589810">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589856">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2589931">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590011">//sys&nbsp;&nbsp;&nbsp;&nbsp;fcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590070">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2590106">//sys&nbsp;&nbsp;&nbsp;&nbsp;Flock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590147">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590179">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2590250">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590297">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2590325">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2590352">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2590381">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590441">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590496">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Gettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2590523">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590597">//sys&nbsp;&nbsp;&nbsp;&nbsp;InotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590684">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590726">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590778">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2590852">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Kill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2590898">//sys&nbsp;&nbsp;&nbsp;&nbsp;Klogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2590965">//sys&nbsp;&nbsp;&nbsp;&nbsp;Link(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591020">//sys&nbsp;&nbsp;&nbsp;&nbsp;Listxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591082">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2591132">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591195">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591254">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591326">//sys&nbsp;&nbsp;&nbsp;&nbsp;Nanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591390">//sys&nbsp;&nbsp;&nbsp;&nbsp;Pause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2591416">//sys&nbsp;&nbsp;&nbsp;&nbsp;PivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2591492">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2591590">//sys&nbsp;&nbsp;&nbsp;&nbsp;read(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591638">//sys&nbsp;&nbsp;&nbsp;&nbsp;Readlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591697">//sys&nbsp;&nbsp;&nbsp;&nbsp;Removexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2591753">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591810">//sys&nbsp;&nbsp;&nbsp;&nbsp;Renameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591897">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591934">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2591976">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2592016">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592063">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592101">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Settimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2592148">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2592163">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2592243">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2592318">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2592389">func</span>&nbsp;<span class="ident" id="2592394">Setuid</span><span class="op" id="2592400">(</span><span class="ident" id="2592401">uid</span>&nbsp;<span class="builtintype" id="2592405">int</span><span class="op" id="2592408">)</span>&nbsp;<span class="op" id="2592410">(</span><span class="ident" id="2592411">err</span>&nbsp;<span class="builtintype" id="2592415">error</span><span class="op" id="2592420">)</span>&nbsp;<span class="op" id="2592422">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2592425">return</span>&nbsp;<span class="ident" id="2592432">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2592443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2592446">func</span>&nbsp;<span class="ident" id="2592451">Setgid</span><span class="op" id="2592457">(</span><span class="ident" id="2592458">uid</span>&nbsp;<span class="builtintype" id="2592462">int</span><span class="op" id="2592465">)</span>&nbsp;<span class="op" id="2592467">(</span><span class="ident" id="2592468">err</span>&nbsp;<span class="builtintype" id="2592472">error</span><span class="op" id="2592477">)</span>&nbsp;<span class="op" id="2592479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2592482">return</span>&nbsp;<span class="ident" id="2592489">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2592500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2592503">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592563">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592640">//sys&nbsp;&nbsp;&nbsp;&nbsp;Symlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2592698">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sync()</span><br>
<span class="lineno"></span><span class="comment" id="2592711">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Sysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592756">//sys&nbsp;&nbsp;&nbsp;&nbsp;Tee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592825">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Tgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2592883">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Times(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2592934">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Umask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2592972">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Uname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593012">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593050">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593101">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2593167">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593204">//sys&nbsp;&nbsp;&nbsp;&nbsp;Ustat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593252">//sys&nbsp;&nbsp;&nbsp;&nbsp;Utime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593303">//sys&nbsp;&nbsp;&nbsp;&nbsp;write(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2593352">//sys&nbsp;&nbsp;&nbsp;&nbsp;exitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2593402">//sys&nbsp;&nbsp;&nbsp;&nbsp;readlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2593471">//sys&nbsp;&nbsp;&nbsp;&nbsp;writelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2593543">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2593599">//sys&nbsp;&nbsp;&nbsp;&nbsp;munmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2593655">var</span>&nbsp;<span class="ident" id="2593659">mapper</span>&nbsp;<span class="op" id="2593666">=</span>&nbsp;<span class="op" id="2593668">&amp;</span><span class="ident" id="2593669">mmapper</span><span class="op" id="2593676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2593679">active</span><span class="op" id="2593685">:</span>&nbsp;<span class="builtinfunc" id="2593687">make</span><span class="op" id="2593691">(</span><span class="keyword" id="2593692">map</span><span class="op" id="2593695">[</span><span class="op" id="2593696">*</span><span class="builtintype" id="2593697">byte</span><span class="op" id="2593701">]</span><span class="op" id="2593702">[</span><span class="op" id="2593703">]</span><span class="builtintype" id="2593704">byte</span><span class="op" id="2593708">)</span><span class="op" id="2593709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2593712">mmap</span><span class="op" id="2593716">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2593720">mmap</span><span class="op" id="2593724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2593727">munmap</span><span class="op" id="2593733">:</span>&nbsp;<span class="ident" id="2593735">munmap</span><span class="op" id="2593741">,</span><br>
<span class="lineno">890</span><span class="op" id="2593743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2593746">func</span>&nbsp;<span class="ident" id="2593751">Mmap</span><span class="op" id="2593755">(</span><span class="ident" id="2593756">fd</span>&nbsp;<span class="builtintype" id="2593759">int</span><span class="op" id="2593762">,</span>&nbsp;<span class="ident" id="2593764">offset</span>&nbsp;<span class="ident" id="2593771">int64</span><span class="op" id="2593776">,</span>&nbsp;<span class="ident" id="2593778">length</span>&nbsp;<span class="builtintype" id="2593785">int</span><span class="op" id="2593788">,</span>&nbsp;<span class="ident" id="2593790">prot</span>&nbsp;<span class="builtintype" id="2593795">int</span><span class="op" id="2593798">,</span>&nbsp;<span class="ident" id="2593800">flags</span>&nbsp;<span class="builtintype" id="2593806">int</span><span class="op" id="2593809">)</span>&nbsp;<span class="op" id="2593811">(</span><span class="ident" id="2593812">data</span>&nbsp;<span class="op" id="2593817">[</span><span class="op" id="2593818">]</span><span class="builtintype" id="2593819">byte</span><span class="op" id="2593823">,</span>&nbsp;<span class="ident" id="2593825">err</span>&nbsp;<span class="builtintype" id="2593829">error</span><span class="op" id="2593834">)</span>&nbsp;<span class="op" id="2593836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2593839">return</span>&nbsp;<span class="ident" id="2593846">mapper</span><span class="op" id="2593852">.</span><span class="ident" id="2593853">Mmap</span><span class="op" id="2593857">(</span><span class="ident" id="2593858">fd</span><span class="op" id="2593860">,</span>&nbsp;<span class="ident" id="2593862">offset</span><span class="op" id="2593868">,</span>&nbsp;<span class="ident" id="2593870">length</span><span class="op" id="2593876">,</span>&nbsp;<span class="ident" id="2593878">prot</span><span class="op" id="2593882">,</span>&nbsp;<span class="ident" id="2593884">flags</span><span class="op" id="2593889">)</span><br>
<span class="lineno"></span><span class="op" id="2593891">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2593894">func</span>&nbsp;<span class="ident" id="2593899">Munmap</span><span class="op" id="2593905">(</span><span class="ident" id="2593906">b</span>&nbsp;<span class="op" id="2593908">[</span><span class="op" id="2593909">]</span><span class="builtintype" id="2593910">byte</span><span class="op" id="2593914">)</span>&nbsp;<span class="op" id="2593916">(</span><span class="ident" id="2593917">err</span>&nbsp;<span class="builtintype" id="2593921">error</span><span class="op" id="2593926">)</span>&nbsp;<span class="op" id="2593928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2593931">return</span>&nbsp;<span class="ident" id="2593938">mapper</span><span class="op" id="2593944">.</span><span class="ident" id="2593945">Munmap</span><span class="op" id="2593951">(</span><span class="ident" id="2593952">b</span><span class="op" id="2593953">)</span><br>
<span class="lineno"></span><span class="op" id="2593955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2593958">//sys&nbsp;&nbsp;&nbsp;&nbsp;Madvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2594006">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2594053">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2594087">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2594123">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2594161">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2594193">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2594217">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2594227">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2594241">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2594250">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2594263">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2594270">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2594280">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2594290">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2594305">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2594321">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2594339">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2594355">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2594364">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2594380">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2594396">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2594411">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2594425">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2594441">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2594452">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2594462">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2594475">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2594488">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2594502">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2594510">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2594526">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2594539">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2594548">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2594565">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2594581">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2594598">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2594615">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2594628">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2594639">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2594651">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2594664">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2594679">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2594690">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2594702">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2594711">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2594724">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2594737">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2594750">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2594760">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2594773">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2594787">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2594804">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2594820">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2594833">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2594842">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2594858">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2594869">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2594882">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2594891">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2594904">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2594916">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2594932">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2594944">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2594954">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2594972">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2594987">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2594999">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2595009">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2595019">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2595029">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2595039">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2595049">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2595058">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2595072">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2595086">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2595101">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2595109">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2595118">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2595127">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2595139">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2595149">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2595160">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2595175">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2595187">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2595200">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2595209">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2595227">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2595241">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2595259">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2595274">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2595290">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2595307">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2595325">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2595340">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2595356">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2595374">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2595397">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2595420">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2595440">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2595457">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2595478">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2595500">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2595520">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2595537">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2595551">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2595563">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2595573">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2595583">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2595592">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2595606">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2595622">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2595639">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2595656">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2595673">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2595682">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2595692">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2595701">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2595711">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2595726">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2595738">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2595749">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2595759">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2595768">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2595783">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2595798">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2595817">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2595833">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2595849">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2595860">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2595880">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2595891">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2595902">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2595912">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2595925">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2595934">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2595945">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2595957">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2595968">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2595978">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
