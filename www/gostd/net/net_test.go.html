<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html" class="current">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7585458">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7585513">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7585567">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7585618">package</span>&nbsp;<span class="ident" id="7585626">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7585631">import</span>&nbsp;<span class="op" id="7585638">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7585641">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7585647">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7585660">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7585666">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7585677">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7585688">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7585695">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7585698">func</span>&nbsp;<span class="ident" id="7585703">TestShutdown</span><span class="op" id="7585715">(</span><span class="ident" id="7585716">t</span>&nbsp;<span class="op" id="7585718">*</span><span class="ident" id="7585719">testing</span><span class="op" id="7585726">.</span><span class="ident" id="7585727">T</span><span class="op" id="7585728">)</span>&nbsp;<span class="op" id="7585730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585733">if</span>&nbsp;<span class="ident" id="7585736">runtime</span><span class="op" id="7585743">.</span><span class="ident" id="7585744">GOOS</span>&nbsp;<span class="op" id="7585749">==</span>&nbsp;<span class="string" id="7585752">&#34;plan9&#34;</span>&nbsp;<span class="op" id="7585760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7585764">t</span><span class="op" id="7585765">.</span><span class="ident" id="7585766">Skipf</span><span class="op" id="7585771">(</span><span class="string" id="7585772">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7585793">,</span>&nbsp;<span class="ident" id="7585795">runtime</span><span class="op" id="7585802">.</span><span class="ident" id="7585803">GOOS</span><span class="op" id="7585807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585810">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7585813">ln</span><span class="op" id="7585815">,</span>&nbsp;<span class="ident" id="7585817">err</span>&nbsp;<span class="op" id="7585821">:=</span>&nbsp;<span class="ident" id="7585824">Listen</span><span class="op" id="7585830">(</span><span class="string" id="7585831">&#34;tcp&#34;</span><span class="op" id="7585836">,</span>&nbsp;<span class="string" id="7585838">&#34;127.0.0.1:0&#34;</span><span class="op" id="7585851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585854">if</span>&nbsp;<span class="ident" id="7585857">err</span>&nbsp;<span class="op" id="7585861">!=</span>&nbsp;<span class="ident" id="7585864">nil</span>&nbsp;<span class="op" id="7585868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585872">if</span>&nbsp;<span class="ident" id="7585875">ln</span><span class="op" id="7585877">,</span>&nbsp;<span class="ident" id="7585879">err</span>&nbsp;<span class="op" id="7585883">=</span>&nbsp;<span class="ident" id="7585885">Listen</span><span class="op" id="7585891">(</span><span class="string" id="7585892">&#34;tcp6&#34;</span><span class="op" id="7585898">,</span>&nbsp;<span class="string" id="7585900">&#34;[::1]:0&#34;</span><span class="op" id="7585909">)</span><span class="op" id="7585910">;</span>&nbsp;<span class="ident" id="7585912">err</span>&nbsp;<span class="op" id="7585916">!=</span>&nbsp;<span class="ident" id="7585919">nil</span>&nbsp;<span class="op" id="7585923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7585928">t</span><span class="op" id="7585929">.</span><span class="ident" id="7585930">Fatalf</span><span class="op" id="7585936">(</span><span class="string" id="7585937">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7585958">,</span>&nbsp;<span class="ident" id="7585960">err</span><span class="op" id="7585963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585967">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585974">go</span>&nbsp;<span class="keyword" id="7585977">func</span><span class="op" id="7585981">(</span><span class="op" id="7585982">)</span>&nbsp;<span class="op" id="7585984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585988">defer</span>&nbsp;<span class="ident" id="7585994">ln</span><span class="op" id="7585996">.</span><span class="ident" id="7585997">Close</span><span class="op" id="7586002">(</span><span class="op" id="7586003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586007">c</span><span class="op" id="7586008">,</span>&nbsp;<span class="ident" id="7586010">err</span>&nbsp;<span class="op" id="7586014">:=</span>&nbsp;<span class="ident" id="7586017">ln</span><span class="op" id="7586019">.</span><span class="ident" id="7586020">Accept</span><span class="op" id="7586026">(</span><span class="op" id="7586027">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586031">if</span>&nbsp;<span class="ident" id="7586034">err</span>&nbsp;<span class="op" id="7586038">!=</span>&nbsp;<span class="ident" id="7586041">nil</span>&nbsp;<span class="op" id="7586045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586050">t</span><span class="op" id="7586051">.</span><span class="ident" id="7586052">Errorf</span><span class="op" id="7586058">(</span><span class="string" id="7586059">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7586071">,</span>&nbsp;<span class="ident" id="7586073">err</span><span class="op" id="7586076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586081">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586094">var</span>&nbsp;<span class="ident" id="7586098">buf</span>&nbsp;<span class="op" id="7586102">[</span><span class="num" id="7586103">10</span><span class="op" id="7586105">]</span><span class="builtintype" id="7586106">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586113">n</span><span class="op" id="7586114">,</span>&nbsp;<span class="ident" id="7586116">err</span>&nbsp;<span class="op" id="7586120">:=</span>&nbsp;<span class="ident" id="7586123">c</span><span class="op" id="7586124">.</span><span class="ident" id="7586125">Read</span><span class="op" id="7586129">(</span><span class="ident" id="7586130">buf</span><span class="op" id="7586133">[</span><span class="op" id="7586134">:</span><span class="op" id="7586135">]</span><span class="op" id="7586136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586140">if</span>&nbsp;<span class="ident" id="7586143">n</span>&nbsp;<span class="op" id="7586145">!=</span>&nbsp;<span class="num" id="7586148">0</span>&nbsp;<span class="op" id="7586150">||</span>&nbsp;<span class="ident" id="7586153">err</span>&nbsp;<span class="op" id="7586157">!=</span>&nbsp;<span class="ident" id="7586160">io</span><span class="op" id="7586162">.</span><span class="ident" id="7586163">EOF</span>&nbsp;<span class="op" id="7586167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586172">t</span><span class="op" id="7586173">.</span><span class="ident" id="7586174">Errorf</span><span class="op" id="7586180">(</span><span class="string" id="7586181">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="7586219">,</span>&nbsp;<span class="ident" id="7586221">n</span><span class="op" id="7586222">,</span>&nbsp;<span class="ident" id="7586224">err</span><span class="op" id="7586227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586232">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586241">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586245">c</span><span class="op" id="7586246">.</span><span class="ident" id="7586247">Write</span><span class="op" id="7586252">(</span><span class="op" id="7586253">[</span><span class="op" id="7586254">]</span><span class="builtintype" id="7586255">byte</span><span class="op" id="7586259">(</span><span class="string" id="7586260">&#34;response&#34;</span><span class="op" id="7586270">)</span><span class="op" id="7586271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586275">c</span><span class="op" id="7586276">.</span><span class="ident" id="7586277">Close</span><span class="op" id="7586282">(</span><span class="op" id="7586283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586286">}</span><span class="op" id="7586287">(</span><span class="op" id="7586288">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586292">c</span><span class="op" id="7586293">,</span>&nbsp;<span class="ident" id="7586295">err</span>&nbsp;<span class="op" id="7586299">:=</span>&nbsp;<span class="ident" id="7586302">Dial</span><span class="op" id="7586306">(</span><span class="string" id="7586307">&#34;tcp&#34;</span><span class="op" id="7586312">,</span>&nbsp;<span class="ident" id="7586314">ln</span><span class="op" id="7586316">.</span><span class="ident" id="7586317">Addr</span><span class="op" id="7586321">(</span><span class="op" id="7586322">)</span><span class="op" id="7586323">.</span><span class="ident" id="7586324">String</span><span class="op" id="7586330">(</span><span class="op" id="7586331">)</span><span class="op" id="7586332">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586335">if</span>&nbsp;<span class="ident" id="7586338">err</span>&nbsp;<span class="op" id="7586342">!=</span>&nbsp;<span class="ident" id="7586345">nil</span>&nbsp;<span class="op" id="7586349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586353">t</span><span class="op" id="7586354">.</span><span class="ident" id="7586355">Fatalf</span><span class="op" id="7586361">(</span><span class="string" id="7586362">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7586372">,</span>&nbsp;<span class="ident" id="7586374">err</span><span class="op" id="7586377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586383">defer</span>&nbsp;<span class="ident" id="7586389">c</span><span class="op" id="7586390">.</span><span class="ident" id="7586391">Close</span><span class="op" id="7586396">(</span><span class="op" id="7586397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586401">err</span>&nbsp;<span class="op" id="7586405">=</span>&nbsp;<span class="ident" id="7586407">c</span><span class="op" id="7586408">.</span><span class="op" id="7586409">(</span><span class="op" id="7586410">*</span><span class="ident" id="7586411">TCPConn</span><span class="op" id="7586418">)</span><span class="op" id="7586419">.</span><span class="ident" id="7586420">CloseWrite</span><span class="op" id="7586430">(</span><span class="op" id="7586431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586434">if</span>&nbsp;<span class="ident" id="7586437">err</span>&nbsp;<span class="op" id="7586441">!=</span>&nbsp;<span class="ident" id="7586444">nil</span>&nbsp;<span class="op" id="7586448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586452">t</span><span class="op" id="7586453">.</span><span class="ident" id="7586454">Fatalf</span><span class="op" id="7586460">(</span><span class="string" id="7586461">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="7586477">,</span>&nbsp;<span class="ident" id="7586479">err</span><span class="op" id="7586482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586488">var</span>&nbsp;<span class="ident" id="7586492">buf</span>&nbsp;<span class="op" id="7586496">[</span><span class="num" id="7586497">10</span><span class="op" id="7586499">]</span><span class="builtintype" id="7586500">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586506">n</span><span class="op" id="7586507">,</span>&nbsp;<span class="ident" id="7586509">err</span>&nbsp;<span class="op" id="7586513">:=</span>&nbsp;<span class="ident" id="7586516">c</span><span class="op" id="7586517">.</span><span class="ident" id="7586518">Read</span><span class="op" id="7586522">(</span><span class="ident" id="7586523">buf</span><span class="op" id="7586526">[</span><span class="op" id="7586527">:</span><span class="op" id="7586528">]</span><span class="op" id="7586529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586532">if</span>&nbsp;<span class="ident" id="7586535">err</span>&nbsp;<span class="op" id="7586539">!=</span>&nbsp;<span class="ident" id="7586542">nil</span>&nbsp;<span class="op" id="7586546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586550">t</span><span class="op" id="7586551">.</span><span class="ident" id="7586552">Fatalf</span><span class="op" id="7586558">(</span><span class="string" id="7586559">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7586580">,</span>&nbsp;<span class="ident" id="7586582">n</span><span class="op" id="7586583">,</span>&nbsp;<span class="ident" id="7586585">err</span><span class="op" id="7586588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586594">got</span>&nbsp;<span class="op" id="7586598">:=</span>&nbsp;<span class="builtintype" id="7586601">string</span><span class="op" id="7586607">(</span><span class="ident" id="7586608">buf</span><span class="op" id="7586611">[</span><span class="op" id="7586612">:</span><span class="ident" id="7586613">n</span><span class="op" id="7586614">]</span><span class="op" id="7586615">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586618">if</span>&nbsp;<span class="ident" id="7586621">got</span>&nbsp;<span class="op" id="7586625">!=</span>&nbsp;<span class="string" id="7586628">&#34;response&#34;</span>&nbsp;<span class="op" id="7586639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586643">t</span><span class="op" id="7586644">.</span><span class="ident" id="7586645">Errorf</span><span class="op" id="7586651">(</span><span class="string" id="7586652">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="7586682">,</span>&nbsp;<span class="ident" id="7586684">got</span><span class="op" id="7586687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586690">}</span><br>
<span class="lineno"></span><span class="op" id="7586692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7586695">func</span>&nbsp;<span class="ident" id="7586700">TestShutdownUnix</span><span class="op" id="7586716">(</span><span class="ident" id="7586717">t</span>&nbsp;<span class="op" id="7586719">*</span><span class="ident" id="7586720">testing</span><span class="op" id="7586727">.</span><span class="ident" id="7586728">T</span><span class="op" id="7586729">)</span>&nbsp;<span class="op" id="7586731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586734">switch</span>&nbsp;<span class="ident" id="7586741">runtime</span><span class="op" id="7586748">.</span><span class="ident" id="7586749">GOOS</span>&nbsp;<span class="op" id="7586754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586757">case</span>&nbsp;<span class="string" id="7586762">&#34;nacl&#34;</span><span class="op" id="7586768">,</span>&nbsp;<span class="string" id="7586770">&#34;plan9&#34;</span><span class="op" id="7586777">,</span>&nbsp;<span class="string" id="7586779">&#34;windows&#34;</span><span class="op" id="7586788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586792">t</span><span class="op" id="7586793">.</span><span class="ident" id="7586794">Skipf</span><span class="op" id="7586799">(</span><span class="string" id="7586800">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7586821">,</span>&nbsp;<span class="ident" id="7586823">runtime</span><span class="op" id="7586830">.</span><span class="ident" id="7586831">GOOS</span><span class="op" id="7586835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586838">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586841">f</span><span class="op" id="7586842">,</span>&nbsp;<span class="ident" id="7586844">err</span>&nbsp;<span class="op" id="7586848">:=</span>&nbsp;<span class="ident" id="7586851">ioutil</span><span class="op" id="7586857">.</span><span class="ident" id="7586858">TempFile</span><span class="op" id="7586866">(</span><span class="string" id="7586867">&#34;&#34;</span><span class="op" id="7586869">,</span>&nbsp;<span class="string" id="7586871">&#34;go_net_unixtest&#34;</span><span class="op" id="7586888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586891">if</span>&nbsp;<span class="ident" id="7586894">err</span>&nbsp;<span class="op" id="7586898">!=</span>&nbsp;<span class="ident" id="7586901">nil</span>&nbsp;<span class="op" id="7586905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586909">t</span><span class="op" id="7586910">.</span><span class="ident" id="7586911">Fatalf</span><span class="op" id="7586917">(</span><span class="string" id="7586918">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="7586932">,</span>&nbsp;<span class="ident" id="7586934">err</span><span class="op" id="7586937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586943">f</span><span class="op" id="7586944">.</span><span class="ident" id="7586945">Close</span><span class="op" id="7586950">(</span><span class="op" id="7586951">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586954">tmpname</span>&nbsp;<span class="op" id="7586962">:=</span>&nbsp;<span class="ident" id="7586965">f</span><span class="op" id="7586966">.</span><span class="ident" id="7586967">Name</span><span class="op" id="7586971">(</span><span class="op" id="7586972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586975">os</span><span class="op" id="7586977">.</span><span class="ident" id="7586978">Remove</span><span class="op" id="7586984">(</span><span class="ident" id="7586985">tmpname</span><span class="op" id="7586992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586995">ln</span><span class="op" id="7586997">,</span>&nbsp;<span class="ident" id="7586999">err</span>&nbsp;<span class="op" id="7587003">:=</span>&nbsp;<span class="ident" id="7587006">Listen</span><span class="op" id="7587012">(</span><span class="string" id="7587013">&#34;unix&#34;</span><span class="op" id="7587019">,</span>&nbsp;<span class="ident" id="7587021">tmpname</span><span class="op" id="7587028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587031">if</span>&nbsp;<span class="ident" id="7587034">err</span>&nbsp;<span class="op" id="7587038">!=</span>&nbsp;<span class="ident" id="7587041">nil</span>&nbsp;<span class="op" id="7587045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587049">t</span><span class="op" id="7587050">.</span><span class="ident" id="7587051">Fatalf</span><span class="op" id="7587057">(</span><span class="string" id="7587058">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="7587080">,</span>&nbsp;<span class="ident" id="7587082">tmpname</span><span class="op" id="7587089">,</span>&nbsp;<span class="ident" id="7587091">err</span><span class="op" id="7587094">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587100">defer</span>&nbsp;<span class="keyword" id="7587106">func</span><span class="op" id="7587110">(</span><span class="op" id="7587111">)</span>&nbsp;<span class="op" id="7587113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587117">ln</span><span class="op" id="7587119">.</span><span class="ident" id="7587120">Close</span><span class="op" id="7587125">(</span><span class="op" id="7587126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587130">os</span><span class="op" id="7587132">.</span><span class="ident" id="7587133">Remove</span><span class="op" id="7587139">(</span><span class="ident" id="7587140">tmpname</span><span class="op" id="7587147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587150">}</span><span class="op" id="7587151">(</span><span class="op" id="7587152">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587156">go</span>&nbsp;<span class="keyword" id="7587159">func</span><span class="op" id="7587163">(</span><span class="op" id="7587164">)</span>&nbsp;<span class="op" id="7587166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587170">c</span><span class="op" id="7587171">,</span>&nbsp;<span class="ident" id="7587173">err</span>&nbsp;<span class="op" id="7587177">:=</span>&nbsp;<span class="ident" id="7587180">ln</span><span class="op" id="7587182">.</span><span class="ident" id="7587183">Accept</span><span class="op" id="7587189">(</span><span class="op" id="7587190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587194">if</span>&nbsp;<span class="ident" id="7587197">err</span>&nbsp;<span class="op" id="7587201">!=</span>&nbsp;<span class="ident" id="7587204">nil</span>&nbsp;<span class="op" id="7587208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587213">t</span><span class="op" id="7587214">.</span><span class="ident" id="7587215">Errorf</span><span class="op" id="7587221">(</span><span class="string" id="7587222">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7587234">,</span>&nbsp;<span class="ident" id="7587236">err</span><span class="op" id="7587239">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587244">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587257">var</span>&nbsp;<span class="ident" id="7587261">buf</span>&nbsp;<span class="op" id="7587265">[</span><span class="num" id="7587266">10</span><span class="op" id="7587268">]</span><span class="builtintype" id="7587269">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587276">n</span><span class="op" id="7587277">,</span>&nbsp;<span class="ident" id="7587279">err</span>&nbsp;<span class="op" id="7587283">:=</span>&nbsp;<span class="ident" id="7587286">c</span><span class="op" id="7587287">.</span><span class="ident" id="7587288">Read</span><span class="op" id="7587292">(</span><span class="ident" id="7587293">buf</span><span class="op" id="7587296">[</span><span class="op" id="7587297">:</span><span class="op" id="7587298">]</span><span class="op" id="7587299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587303">if</span>&nbsp;<span class="ident" id="7587306">n</span>&nbsp;<span class="op" id="7587308">!=</span>&nbsp;<span class="num" id="7587311">0</span>&nbsp;<span class="op" id="7587313">||</span>&nbsp;<span class="ident" id="7587316">err</span>&nbsp;<span class="op" id="7587320">!=</span>&nbsp;<span class="ident" id="7587323">io</span><span class="op" id="7587325">.</span><span class="ident" id="7587326">EOF</span>&nbsp;<span class="op" id="7587330">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587335">t</span><span class="op" id="7587336">.</span><span class="ident" id="7587337">Errorf</span><span class="op" id="7587343">(</span><span class="string" id="7587344">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="7587382">,</span>&nbsp;<span class="ident" id="7587384">n</span><span class="op" id="7587385">,</span>&nbsp;<span class="ident" id="7587387">err</span><span class="op" id="7587390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587395">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587408">c</span><span class="op" id="7587409">.</span><span class="ident" id="7587410">Write</span><span class="op" id="7587415">(</span><span class="op" id="7587416">[</span><span class="op" id="7587417">]</span><span class="builtintype" id="7587418">byte</span><span class="op" id="7587422">(</span><span class="string" id="7587423">&#34;response&#34;</span><span class="op" id="7587433">)</span><span class="op" id="7587434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587438">c</span><span class="op" id="7587439">.</span><span class="ident" id="7587440">Close</span><span class="op" id="7587445">(</span><span class="op" id="7587446">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587449">}</span><span class="op" id="7587450">(</span><span class="op" id="7587451">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587455">c</span><span class="op" id="7587456">,</span>&nbsp;<span class="ident" id="7587458">err</span>&nbsp;<span class="op" id="7587462">:=</span>&nbsp;<span class="ident" id="7587465">Dial</span><span class="op" id="7587469">(</span><span class="string" id="7587470">&#34;unix&#34;</span><span class="op" id="7587476">,</span>&nbsp;<span class="ident" id="7587478">tmpname</span><span class="op" id="7587485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587488">if</span>&nbsp;<span class="ident" id="7587491">err</span>&nbsp;<span class="op" id="7587495">!=</span>&nbsp;<span class="ident" id="7587498">nil</span>&nbsp;<span class="op" id="7587502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587506">t</span><span class="op" id="7587507">.</span><span class="ident" id="7587508">Fatalf</span><span class="op" id="7587514">(</span><span class="string" id="7587515">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7587525">,</span>&nbsp;<span class="ident" id="7587527">err</span><span class="op" id="7587530">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587536">defer</span>&nbsp;<span class="ident" id="7587542">c</span><span class="op" id="7587543">.</span><span class="ident" id="7587544">Close</span><span class="op" id="7587549">(</span><span class="op" id="7587550">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587554">err</span>&nbsp;<span class="op" id="7587558">=</span>&nbsp;<span class="ident" id="7587560">c</span><span class="op" id="7587561">.</span><span class="op" id="7587562">(</span><span class="op" id="7587563">*</span><span class="ident" id="7587564">UnixConn</span><span class="op" id="7587572">)</span><span class="op" id="7587573">.</span><span class="ident" id="7587574">CloseWrite</span><span class="op" id="7587584">(</span><span class="op" id="7587585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587588">if</span>&nbsp;<span class="ident" id="7587591">err</span>&nbsp;<span class="op" id="7587595">!=</span>&nbsp;<span class="ident" id="7587598">nil</span>&nbsp;<span class="op" id="7587602">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587606">t</span><span class="op" id="7587607">.</span><span class="ident" id="7587608">Fatalf</span><span class="op" id="7587614">(</span><span class="string" id="7587615">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="7587631">,</span>&nbsp;<span class="ident" id="7587633">err</span><span class="op" id="7587636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587642">var</span>&nbsp;<span class="ident" id="7587646">buf</span>&nbsp;<span class="op" id="7587650">[</span><span class="num" id="7587651">10</span><span class="op" id="7587653">]</span><span class="builtintype" id="7587654">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587660">n</span><span class="op" id="7587661">,</span>&nbsp;<span class="ident" id="7587663">err</span>&nbsp;<span class="op" id="7587667">:=</span>&nbsp;<span class="ident" id="7587670">c</span><span class="op" id="7587671">.</span><span class="ident" id="7587672">Read</span><span class="op" id="7587676">(</span><span class="ident" id="7587677">buf</span><span class="op" id="7587680">[</span><span class="op" id="7587681">:</span><span class="op" id="7587682">]</span><span class="op" id="7587683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587686">if</span>&nbsp;<span class="ident" id="7587689">err</span>&nbsp;<span class="op" id="7587693">!=</span>&nbsp;<span class="ident" id="7587696">nil</span>&nbsp;<span class="op" id="7587700">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587704">t</span><span class="op" id="7587705">.</span><span class="ident" id="7587706">Fatalf</span><span class="op" id="7587712">(</span><span class="string" id="7587713">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7587734">,</span>&nbsp;<span class="ident" id="7587736">n</span><span class="op" id="7587737">,</span>&nbsp;<span class="ident" id="7587739">err</span><span class="op" id="7587742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587748">got</span>&nbsp;<span class="op" id="7587752">:=</span>&nbsp;<span class="builtintype" id="7587755">string</span><span class="op" id="7587761">(</span><span class="ident" id="7587762">buf</span><span class="op" id="7587765">[</span><span class="op" id="7587766">:</span><span class="ident" id="7587767">n</span><span class="op" id="7587768">]</span><span class="op" id="7587769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587772">if</span>&nbsp;<span class="ident" id="7587775">got</span>&nbsp;<span class="op" id="7587779">!=</span>&nbsp;<span class="string" id="7587782">&#34;response&#34;</span>&nbsp;<span class="op" id="7587793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587797">t</span><span class="op" id="7587798">.</span><span class="ident" id="7587799">Errorf</span><span class="op" id="7587805">(</span><span class="string" id="7587806">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="7587836">,</span>&nbsp;<span class="ident" id="7587838">got</span><span class="op" id="7587841">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587844">}</span><br>
<span class="lineno"></span><span class="op" id="7587846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7587849">func</span>&nbsp;<span class="ident" id="7587854">TestTCPListenClose</span><span class="op" id="7587872">(</span><span class="ident" id="7587873">t</span>&nbsp;<span class="op" id="7587875">*</span><span class="ident" id="7587876">testing</span><span class="op" id="7587883">.</span><span class="ident" id="7587884">T</span><span class="op" id="7587885">)</span>&nbsp;<span class="op" id="7587887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587890">ln</span><span class="op" id="7587892">,</span>&nbsp;<span class="ident" id="7587894">err</span>&nbsp;<span class="op" id="7587898">:=</span>&nbsp;<span class="ident" id="7587901">Listen</span><span class="op" id="7587907">(</span><span class="string" id="7587908">&#34;tcp&#34;</span><span class="op" id="7587913">,</span>&nbsp;<span class="string" id="7587915">&#34;127.0.0.1:0&#34;</span><span class="op" id="7587928">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587931">if</span>&nbsp;<span class="ident" id="7587934">err</span>&nbsp;<span class="op" id="7587938">!=</span>&nbsp;<span class="ident" id="7587941">nil</span>&nbsp;<span class="op" id="7587945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587949">t</span><span class="op" id="7587950">.</span><span class="ident" id="7587951">Fatalf</span><span class="op" id="7587957">(</span><span class="string" id="7587958">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7587977">,</span>&nbsp;<span class="ident" id="7587979">err</span><span class="op" id="7587982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587989">done</span>&nbsp;<span class="op" id="7587994">:=</span>&nbsp;<span class="builtinfunc" id="7587997">make</span><span class="op" id="7588001">(</span><span class="keyword" id="7588002">chan</span>&nbsp;<span class="builtintype" id="7588007">bool</span><span class="op" id="7588011">,</span>&nbsp;<span class="num" id="7588013">1</span><span class="op" id="7588014">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588017">go</span>&nbsp;<span class="keyword" id="7588020">func</span><span class="op" id="7588024">(</span><span class="op" id="7588025">)</span>&nbsp;<span class="op" id="7588027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588031">time</span><span class="op" id="7588035">.</span><span class="ident" id="7588036">Sleep</span><span class="op" id="7588041">(</span><span class="num" id="7588042">100</span>&nbsp;<span class="op" id="7588046">*</span>&nbsp;<span class="ident" id="7588048">time</span><span class="op" id="7588052">.</span><span class="ident" id="7588053">Millisecond</span><span class="op" id="7588064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588068">ln</span><span class="op" id="7588070">.</span><span class="ident" id="7588071">Close</span><span class="op" id="7588076">(</span><span class="op" id="7588077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588080">}</span><span class="op" id="7588081">(</span><span class="op" id="7588082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588085">go</span>&nbsp;<span class="keyword" id="7588088">func</span><span class="op" id="7588092">(</span><span class="op" id="7588093">)</span>&nbsp;<span class="op" id="7588095">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588099">c</span><span class="op" id="7588100">,</span>&nbsp;<span class="ident" id="7588102">err</span>&nbsp;<span class="op" id="7588106">:=</span>&nbsp;<span class="ident" id="7588109">ln</span><span class="op" id="7588111">.</span><span class="ident" id="7588112">Accept</span><span class="op" id="7588118">(</span><span class="op" id="7588119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588123">if</span>&nbsp;<span class="ident" id="7588126">err</span>&nbsp;<span class="op" id="7588130">==</span>&nbsp;<span class="ident" id="7588133">nil</span>&nbsp;<span class="op" id="7588137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588142">c</span><span class="op" id="7588143">.</span><span class="ident" id="7588144">Close</span><span class="op" id="7588149">(</span><span class="op" id="7588150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588155">t</span><span class="op" id="7588156">.</span><span class="ident" id="7588157">Error</span><span class="op" id="7588162">(</span><span class="string" id="7588163">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="7588181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588185">}</span>&nbsp;<span class="keyword" id="7588187">else</span>&nbsp;<span class="op" id="7588192">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588197">t</span><span class="op" id="7588198">.</span><span class="ident" id="7588199">Logf</span><span class="op" id="7588203">(</span><span class="string" id="7588204">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="7588250">,</span>&nbsp;<span class="ident" id="7588252">err</span><span class="op" id="7588255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588263">done</span>&nbsp;<span class="op" id="7588268">&lt;-</span>&nbsp;<span class="builtintype" id="7588271">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588277">}</span><span class="op" id="7588278">(</span><span class="op" id="7588279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588282">select</span>&nbsp;<span class="op" id="7588289">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588292">case</span>&nbsp;<span class="op" id="7588297">&lt;-</span><span class="ident" id="7588299">done</span><span class="op" id="7588303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588306">case</span>&nbsp;<span class="op" id="7588311">&lt;-</span><span class="ident" id="7588313">time</span><span class="op" id="7588317">.</span><span class="ident" id="7588318">After</span><span class="op" id="7588323">(</span><span class="num" id="7588324">2</span>&nbsp;<span class="op" id="7588326">*</span>&nbsp;<span class="ident" id="7588328">time</span><span class="op" id="7588332">.</span><span class="ident" id="7588333">Second</span><span class="op" id="7588339">)</span><span class="op" id="7588340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588344">t</span><span class="op" id="7588345">.</span><span class="ident" id="7588346">Fatal</span><span class="op" id="7588351">(</span><span class="string" id="7588352">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="7588383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588386">}</span><br>
<span class="lineno"></span><span class="op" id="7588388">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="7588391">func</span>&nbsp;<span class="ident" id="7588396">TestUDPListenClose</span><span class="op" id="7588414">(</span><span class="ident" id="7588415">t</span>&nbsp;<span class="op" id="7588417">*</span><span class="ident" id="7588418">testing</span><span class="op" id="7588425">.</span><span class="ident" id="7588426">T</span><span class="op" id="7588427">)</span>&nbsp;<span class="op" id="7588429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588432">switch</span>&nbsp;<span class="ident" id="7588439">runtime</span><span class="op" id="7588446">.</span><span class="ident" id="7588447">GOOS</span>&nbsp;<span class="op" id="7588452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588455">case</span>&nbsp;<span class="string" id="7588460">&#34;plan9&#34;</span><span class="op" id="7588467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588471">t</span><span class="op" id="7588472">.</span><span class="ident" id="7588473">Skipf</span><span class="op" id="7588478">(</span><span class="string" id="7588479">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7588500">,</span>&nbsp;<span class="ident" id="7588502">runtime</span><span class="op" id="7588509">.</span><span class="ident" id="7588510">GOOS</span><span class="op" id="7588514">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588520">ln</span><span class="op" id="7588522">,</span>&nbsp;<span class="ident" id="7588524">err</span>&nbsp;<span class="op" id="7588528">:=</span>&nbsp;<span class="ident" id="7588531">ListenPacket</span><span class="op" id="7588543">(</span><span class="string" id="7588544">&#34;udp&#34;</span><span class="op" id="7588549">,</span>&nbsp;<span class="string" id="7588551">&#34;127.0.0.1:0&#34;</span><span class="op" id="7588564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588567">if</span>&nbsp;<span class="ident" id="7588570">err</span>&nbsp;<span class="op" id="7588574">!=</span>&nbsp;<span class="ident" id="7588577">nil</span>&nbsp;<span class="op" id="7588581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588585">t</span><span class="op" id="7588586">.</span><span class="ident" id="7588587">Fatalf</span><span class="op" id="7588593">(</span><span class="string" id="7588594">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7588613">,</span>&nbsp;<span class="ident" id="7588615">err</span><span class="op" id="7588618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588621">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588625">buf</span>&nbsp;<span class="op" id="7588629">:=</span>&nbsp;<span class="builtinfunc" id="7588632">make</span><span class="op" id="7588636">(</span><span class="op" id="7588637">[</span><span class="op" id="7588638">]</span><span class="builtintype" id="7588639">byte</span><span class="op" id="7588643">,</span>&nbsp;<span class="num" id="7588645">1000</span><span class="op" id="7588649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588652">done</span>&nbsp;<span class="op" id="7588657">:=</span>&nbsp;<span class="builtinfunc" id="7588660">make</span><span class="op" id="7588664">(</span><span class="keyword" id="7588665">chan</span>&nbsp;<span class="builtintype" id="7588670">bool</span><span class="op" id="7588674">,</span>&nbsp;<span class="num" id="7588676">1</span><span class="op" id="7588677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588680">go</span>&nbsp;<span class="keyword" id="7588683">func</span><span class="op" id="7588687">(</span><span class="op" id="7588688">)</span>&nbsp;<span class="op" id="7588690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588694">time</span><span class="op" id="7588698">.</span><span class="ident" id="7588699">Sleep</span><span class="op" id="7588704">(</span><span class="num" id="7588705">100</span>&nbsp;<span class="op" id="7588709">*</span>&nbsp;<span class="ident" id="7588711">time</span><span class="op" id="7588715">.</span><span class="ident" id="7588716">Millisecond</span><span class="op" id="7588727">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588731">ln</span><span class="op" id="7588733">.</span><span class="ident" id="7588734">Close</span><span class="op" id="7588739">(</span><span class="op" id="7588740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588743">}</span><span class="op" id="7588744">(</span><span class="op" id="7588745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588748">go</span>&nbsp;<span class="keyword" id="7588751">func</span><span class="op" id="7588755">(</span><span class="op" id="7588756">)</span>&nbsp;<span class="op" id="7588758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588762">_</span><span class="op" id="7588763">,</span>&nbsp;<span class="ident" id="7588765">_</span><span class="op" id="7588766">,</span>&nbsp;<span class="ident" id="7588768">err</span>&nbsp;<span class="op" id="7588772">=</span>&nbsp;<span class="ident" id="7588774">ln</span><span class="op" id="7588776">.</span><span class="ident" id="7588777">ReadFrom</span><span class="op" id="7588785">(</span><span class="ident" id="7588786">buf</span><span class="op" id="7588789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588793">if</span>&nbsp;<span class="ident" id="7588796">err</span>&nbsp;<span class="op" id="7588800">==</span>&nbsp;<span class="ident" id="7588803">nil</span>&nbsp;<span class="op" id="7588807">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588812">t</span><span class="op" id="7588813">.</span><span class="ident" id="7588814">Error</span><span class="op" id="7588819">(</span><span class="string" id="7588820">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="7588840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588844">}</span>&nbsp;<span class="keyword" id="7588846">else</span>&nbsp;<span class="op" id="7588851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588856">t</span><span class="op" id="7588857">.</span><span class="ident" id="7588858">Logf</span><span class="op" id="7588862">(</span><span class="string" id="7588863">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="7588911">,</span>&nbsp;<span class="ident" id="7588913">err</span><span class="op" id="7588916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588924">done</span>&nbsp;<span class="op" id="7588929">&lt;-</span>&nbsp;<span class="builtintype" id="7588932">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588938">}</span><span class="op" id="7588939">(</span><span class="op" id="7588940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588943">select</span>&nbsp;<span class="op" id="7588950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588953">case</span>&nbsp;<span class="op" id="7588958">&lt;-</span><span class="ident" id="7588960">done</span><span class="op" id="7588964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588967">case</span>&nbsp;<span class="op" id="7588972">&lt;-</span><span class="ident" id="7588974">time</span><span class="op" id="7588978">.</span><span class="ident" id="7588979">After</span><span class="op" id="7588984">(</span><span class="num" id="7588985">2</span>&nbsp;<span class="op" id="7588987">*</span>&nbsp;<span class="ident" id="7588989">time</span><span class="op" id="7588993">.</span><span class="ident" id="7588994">Second</span><span class="op" id="7589000">)</span><span class="op" id="7589001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589005">t</span><span class="op" id="7589006">.</span><span class="ident" id="7589007">Fatal</span><span class="op" id="7589012">(</span><span class="string" id="7589013">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="7589044">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589047">}</span><br>
<span class="lineno"></span><span class="op" id="7589049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7589052">func</span>&nbsp;<span class="ident" id="7589057">TestTCPClose</span><span class="op" id="7589069">(</span><span class="ident" id="7589070">t</span>&nbsp;<span class="op" id="7589072">*</span><span class="ident" id="7589073">testing</span><span class="op" id="7589080">.</span><span class="ident" id="7589081">T</span><span class="op" id="7589082">)</span>&nbsp;<span class="op" id="7589084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589087">switch</span>&nbsp;<span class="ident" id="7589094">runtime</span><span class="op" id="7589101">.</span><span class="ident" id="7589102">GOOS</span>&nbsp;<span class="op" id="7589107">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589110">case</span>&nbsp;<span class="string" id="7589115">&#34;plan9&#34;</span><span class="op" id="7589122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589126">t</span><span class="op" id="7589127">.</span><span class="ident" id="7589128">Skipf</span><span class="op" id="7589133">(</span><span class="string" id="7589134">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7589155">,</span>&nbsp;<span class="ident" id="7589157">runtime</span><span class="op" id="7589164">.</span><span class="ident" id="7589165">GOOS</span><span class="op" id="7589169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589175">l</span><span class="op" id="7589176">,</span>&nbsp;<span class="ident" id="7589178">err</span>&nbsp;<span class="op" id="7589182">:=</span>&nbsp;<span class="ident" id="7589185">Listen</span><span class="op" id="7589191">(</span><span class="string" id="7589192">&#34;tcp&#34;</span><span class="op" id="7589197">,</span>&nbsp;<span class="string" id="7589199">&#34;127.0.0.1:0&#34;</span><span class="op" id="7589212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589215">if</span>&nbsp;<span class="ident" id="7589218">err</span>&nbsp;<span class="op" id="7589222">!=</span>&nbsp;<span class="ident" id="7589225">nil</span>&nbsp;<span class="op" id="7589229">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589233">t</span><span class="op" id="7589234">.</span><span class="ident" id="7589235">Fatal</span><span class="op" id="7589240">(</span><span class="ident" id="7589241">err</span><span class="op" id="7589244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589250">defer</span>&nbsp;<span class="ident" id="7589256">l</span><span class="op" id="7589257">.</span><span class="ident" id="7589258">Close</span><span class="op" id="7589263">(</span><span class="op" id="7589264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589268">read</span>&nbsp;<span class="op" id="7589273">:=</span>&nbsp;<span class="keyword" id="7589276">func</span><span class="op" id="7589280">(</span><span class="ident" id="7589281">r</span>&nbsp;<span class="ident" id="7589283">io</span><span class="op" id="7589285">.</span><span class="ident" id="7589286">Reader</span><span class="op" id="7589292">)</span>&nbsp;<span class="builtintype" id="7589294">error</span>&nbsp;<span class="op" id="7589300">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589304">var</span>&nbsp;<span class="ident" id="7589308">m</span>&nbsp;<span class="op" id="7589310">[</span><span class="num" id="7589311">1</span><span class="op" id="7589312">]</span><span class="builtintype" id="7589313">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589320">_</span><span class="op" id="7589321">,</span>&nbsp;<span class="ident" id="7589323">err</span>&nbsp;<span class="op" id="7589327">:=</span>&nbsp;<span class="ident" id="7589330">r</span><span class="op" id="7589331">.</span><span class="ident" id="7589332">Read</span><span class="op" id="7589336">(</span><span class="ident" id="7589337">m</span><span class="op" id="7589338">[</span><span class="op" id="7589339">:</span><span class="op" id="7589340">]</span><span class="op" id="7589341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589345">return</span>&nbsp;<span class="ident" id="7589352">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589361">go</span>&nbsp;<span class="keyword" id="7589364">func</span><span class="op" id="7589368">(</span><span class="op" id="7589369">)</span>&nbsp;<span class="op" id="7589371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589375">c</span><span class="op" id="7589376">,</span>&nbsp;<span class="ident" id="7589378">err</span>&nbsp;<span class="op" id="7589382">:=</span>&nbsp;<span class="ident" id="7589385">Dial</span><span class="op" id="7589389">(</span><span class="string" id="7589390">&#34;tcp&#34;</span><span class="op" id="7589395">,</span>&nbsp;<span class="ident" id="7589397">l</span><span class="op" id="7589398">.</span><span class="ident" id="7589399">Addr</span><span class="op" id="7589403">(</span><span class="op" id="7589404">)</span><span class="op" id="7589405">.</span><span class="ident" id="7589406">String</span><span class="op" id="7589412">(</span><span class="op" id="7589413">)</span><span class="op" id="7589414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589418">if</span>&nbsp;<span class="ident" id="7589421">err</span>&nbsp;<span class="op" id="7589425">!=</span>&nbsp;<span class="ident" id="7589428">nil</span>&nbsp;<span class="op" id="7589432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589437">t</span><span class="op" id="7589438">.</span><span class="ident" id="7589439">Errorf</span><span class="op" id="7589445">(</span><span class="string" id="7589446">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7589456">,</span>&nbsp;<span class="ident" id="7589458">err</span><span class="op" id="7589461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589466">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589480">go</span>&nbsp;<span class="ident" id="7589483">read</span><span class="op" id="7589487">(</span><span class="ident" id="7589488">c</span><span class="op" id="7589489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589494">time</span><span class="op" id="7589498">.</span><span class="ident" id="7589499">Sleep</span><span class="op" id="7589504">(</span><span class="num" id="7589505">10</span>&nbsp;<span class="op" id="7589508">*</span>&nbsp;<span class="ident" id="7589510">time</span><span class="op" id="7589514">.</span><span class="ident" id="7589515">Millisecond</span><span class="op" id="7589526">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589530">c</span><span class="op" id="7589531">.</span><span class="ident" id="7589532">Close</span><span class="op" id="7589537">(</span><span class="op" id="7589538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589541">}</span><span class="op" id="7589542">(</span><span class="op" id="7589543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589547">c</span><span class="op" id="7589548">,</span>&nbsp;<span class="ident" id="7589550">err</span>&nbsp;<span class="op" id="7589554">:=</span>&nbsp;<span class="ident" id="7589557">l</span><span class="op" id="7589558">.</span><span class="ident" id="7589559">Accept</span><span class="op" id="7589565">(</span><span class="op" id="7589566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589569">if</span>&nbsp;<span class="ident" id="7589572">err</span>&nbsp;<span class="op" id="7589576">!=</span>&nbsp;<span class="ident" id="7589579">nil</span>&nbsp;<span class="op" id="7589583">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589587">t</span><span class="op" id="7589588">.</span><span class="ident" id="7589589">Fatal</span><span class="op" id="7589594">(</span><span class="ident" id="7589595">err</span><span class="op" id="7589598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589604">defer</span>&nbsp;<span class="ident" id="7589610">c</span><span class="op" id="7589611">.</span><span class="ident" id="7589612">Close</span><span class="op" id="7589617">(</span><span class="op" id="7589618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589622">for</span>&nbsp;<span class="ident" id="7589626">err</span>&nbsp;<span class="op" id="7589630">==</span>&nbsp;<span class="ident" id="7589633">nil</span>&nbsp;<span class="op" id="7589637">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589641">err</span>&nbsp;<span class="op" id="7589645">=</span>&nbsp;<span class="ident" id="7589647">read</span><span class="op" id="7589651">(</span><span class="ident" id="7589652">c</span><span class="op" id="7589653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589659">if</span>&nbsp;<span class="ident" id="7589662">err</span>&nbsp;<span class="op" id="7589666">!=</span>&nbsp;<span class="ident" id="7589669">nil</span>&nbsp;<span class="op" id="7589673">&amp;&amp;</span>&nbsp;<span class="ident" id="7589676">err</span>&nbsp;<span class="op" id="7589680">!=</span>&nbsp;<span class="ident" id="7589683">io</span><span class="op" id="7589685">.</span><span class="ident" id="7589686">EOF</span>&nbsp;<span class="op" id="7589690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589694">t</span><span class="op" id="7589695">.</span><span class="ident" id="7589696">Fatal</span><span class="op" id="7589701">(</span><span class="ident" id="7589702">err</span><span class="op" id="7589705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589708">}</span><br>
<span class="lineno">225</span><span class="op" id="7589710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7589713">func</span>&nbsp;<span class="ident" id="7589718">TestErrorNil</span><span class="op" id="7589730">(</span><span class="ident" id="7589731">t</span>&nbsp;<span class="op" id="7589733">*</span><span class="ident" id="7589734">testing</span><span class="op" id="7589741">.</span><span class="ident" id="7589742">T</span><span class="op" id="7589743">)</span>&nbsp;<span class="op" id="7589745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589748">c</span><span class="op" id="7589749">,</span>&nbsp;<span class="ident" id="7589751">err</span>&nbsp;<span class="op" id="7589755">:=</span>&nbsp;<span class="ident" id="7589758">Dial</span><span class="op" id="7589762">(</span><span class="string" id="7589763">&#34;tcp&#34;</span><span class="op" id="7589768">,</span>&nbsp;<span class="string" id="7589770">&#34;127.0.0.1:65535&#34;</span><span class="op" id="7589787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589790">if</span>&nbsp;<span class="ident" id="7589793">err</span>&nbsp;<span class="op" id="7589797">==</span>&nbsp;<span class="ident" id="7589800">nil</span>&nbsp;<span class="op" id="7589804">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589808">t</span><span class="op" id="7589809">.</span><span class="ident" id="7589810">Fatal</span><span class="op" id="7589815">(</span><span class="string" id="7589816">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="7589848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589854">if</span>&nbsp;<span class="ident" id="7589857">c</span>&nbsp;<span class="op" id="7589859">!=</span>&nbsp;<span class="ident" id="7589862">nil</span>&nbsp;<span class="op" id="7589866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589870">t</span><span class="op" id="7589871">.</span><span class="ident" id="7589872">Fatalf</span><span class="op" id="7589878">(</span><span class="string" id="7589879">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7589935">,</span>&nbsp;<span class="ident" id="7589937">c</span><span class="op" id="7589938">,</span>&nbsp;<span class="ident" id="7589940">c</span><span class="op" id="7589941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589944">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7589948">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590005">l</span><span class="op" id="7590006">,</span>&nbsp;<span class="ident" id="7590008">err</span>&nbsp;<span class="op" id="7590012">:=</span>&nbsp;<span class="ident" id="7590015">Listen</span><span class="op" id="7590021">(</span><span class="string" id="7590022">&#34;tcp&#34;</span><span class="op" id="7590027">,</span>&nbsp;<span class="string" id="7590029">&#34;127.0.0.1:0&#34;</span><span class="op" id="7590042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590045">if</span>&nbsp;<span class="ident" id="7590048">err</span>&nbsp;<span class="op" id="7590052">!=</span>&nbsp;<span class="ident" id="7590055">nil</span>&nbsp;<span class="op" id="7590059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590063">t</span><span class="op" id="7590064">.</span><span class="ident" id="7590065">Fatalf</span><span class="op" id="7590071">(</span><span class="string" id="7590072">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="7590096">,</span>&nbsp;<span class="ident" id="7590098">err</span><span class="op" id="7590101">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590107">defer</span>&nbsp;<span class="ident" id="7590113">l</span><span class="op" id="7590114">.</span><span class="ident" id="7590115">Close</span><span class="op" id="7590120">(</span><span class="op" id="7590121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590124">l1</span><span class="op" id="7590126">,</span>&nbsp;<span class="ident" id="7590128">err</span>&nbsp;<span class="op" id="7590132">:=</span>&nbsp;<span class="ident" id="7590135">Listen</span><span class="op" id="7590141">(</span><span class="string" id="7590142">&#34;tcp&#34;</span><span class="op" id="7590147">,</span>&nbsp;<span class="ident" id="7590149">l</span><span class="op" id="7590150">.</span><span class="ident" id="7590151">Addr</span><span class="op" id="7590155">(</span><span class="op" id="7590156">)</span><span class="op" id="7590157">.</span><span class="ident" id="7590158">String</span><span class="op" id="7590164">(</span><span class="op" id="7590165">)</span><span class="op" id="7590166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590169">if</span>&nbsp;<span class="ident" id="7590172">err</span>&nbsp;<span class="op" id="7590176">==</span>&nbsp;<span class="ident" id="7590179">nil</span>&nbsp;<span class="op" id="7590183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590187">t</span><span class="op" id="7590188">.</span><span class="ident" id="7590189">Fatalf</span><span class="op" id="7590195">(</span><span class="string" id="7590196">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="7590218">,</span>&nbsp;<span class="ident" id="7590220">l</span><span class="op" id="7590221">.</span><span class="ident" id="7590222">Addr</span><span class="op" id="7590226">(</span><span class="op" id="7590227">)</span><span class="op" id="7590228">,</span>&nbsp;<span class="ident" id="7590230">err</span><span class="op" id="7590233">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590239">if</span>&nbsp;<span class="ident" id="7590242">l1</span>&nbsp;<span class="op" id="7590245">!=</span>&nbsp;<span class="ident" id="7590248">nil</span>&nbsp;<span class="op" id="7590252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590256">t</span><span class="op" id="7590257">.</span><span class="ident" id="7590258">Fatalf</span><span class="op" id="7590264">(</span><span class="string" id="7590265">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7590323">,</span>&nbsp;<span class="ident" id="7590325">l1</span><span class="op" id="7590327">,</span>&nbsp;<span class="ident" id="7590329">l1</span><span class="op" id="7590331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7590338">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590401">lp</span><span class="op" id="7590403">,</span>&nbsp;<span class="ident" id="7590405">err</span>&nbsp;<span class="op" id="7590409">:=</span>&nbsp;<span class="ident" id="7590412">ListenPacket</span><span class="op" id="7590424">(</span><span class="string" id="7590425">&#34;udp&#34;</span><span class="op" id="7590430">,</span>&nbsp;<span class="string" id="7590432">&#34;127.0.0.1:0&#34;</span><span class="op" id="7590445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590448">if</span>&nbsp;<span class="ident" id="7590451">err</span>&nbsp;<span class="op" id="7590455">!=</span>&nbsp;<span class="ident" id="7590458">nil</span>&nbsp;<span class="op" id="7590462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590466">t</span><span class="op" id="7590467">.</span><span class="ident" id="7590468">Fatalf</span><span class="op" id="7590474">(</span><span class="string" id="7590475">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="7590499">,</span>&nbsp;<span class="ident" id="7590501">err</span><span class="op" id="7590504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590507">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590510">defer</span>&nbsp;<span class="ident" id="7590516">lp</span><span class="op" id="7590518">.</span><span class="ident" id="7590519">Close</span><span class="op" id="7590524">(</span><span class="op" id="7590525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590528">lp1</span><span class="op" id="7590531">,</span>&nbsp;<span class="ident" id="7590533">err</span>&nbsp;<span class="op" id="7590537">:=</span>&nbsp;<span class="ident" id="7590540">ListenPacket</span><span class="op" id="7590552">(</span><span class="string" id="7590553">&#34;udp&#34;</span><span class="op" id="7590558">,</span>&nbsp;<span class="ident" id="7590560">lp</span><span class="op" id="7590562">.</span><span class="ident" id="7590563">LocalAddr</span><span class="op" id="7590572">(</span><span class="op" id="7590573">)</span><span class="op" id="7590574">.</span><span class="ident" id="7590575">String</span><span class="op" id="7590581">(</span><span class="op" id="7590582">)</span><span class="op" id="7590583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590586">if</span>&nbsp;<span class="ident" id="7590589">err</span>&nbsp;<span class="op" id="7590593">==</span>&nbsp;<span class="ident" id="7590596">nil</span>&nbsp;<span class="op" id="7590600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590604">t</span><span class="op" id="7590605">.</span><span class="ident" id="7590606">Fatalf</span><span class="op" id="7590612">(</span><span class="string" id="7590613">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="7590635">,</span>&nbsp;<span class="ident" id="7590637">lp</span><span class="op" id="7590639">.</span><span class="ident" id="7590640">LocalAddr</span><span class="op" id="7590649">(</span><span class="op" id="7590650">)</span><span class="op" id="7590651">,</span>&nbsp;<span class="ident" id="7590653">err</span><span class="op" id="7590656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590659">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590662">if</span>&nbsp;<span class="ident" id="7590665">lp1</span>&nbsp;<span class="op" id="7590669">!=</span>&nbsp;<span class="ident" id="7590672">nil</span>&nbsp;<span class="op" id="7590676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590680">t</span><span class="op" id="7590681">.</span><span class="ident" id="7590682">Fatalf</span><span class="op" id="7590688">(</span><span class="string" id="7590689">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7590753">,</span>&nbsp;<span class="ident" id="7590755">lp1</span><span class="op" id="7590758">,</span>&nbsp;<span class="ident" id="7590760">lp1</span><span class="op" id="7590763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590766">}</span><br>
<span class="lineno"></span><span class="op" id="7590768">}</span>
</div>
</body>
</html>
