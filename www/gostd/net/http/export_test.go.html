<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7299807">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7299863">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7299917">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7299968">//&nbsp;Bridge&nbsp;package&nbsp;to&nbsp;expose&nbsp;http&nbsp;internals&nbsp;to&nbsp;tests&nbsp;in&nbsp;the&nbsp;http_test</span><br>
<span class="lineno"></span><span class="comment" id="7300037">//&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7300050">package</span>&nbsp;<span class="ident" id="7300058">http</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7300064">import</span>&nbsp;<span class="op" id="7300071">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300074">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300081">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7300092">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7300099">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7300102">func</span>&nbsp;<span class="ident" id="7300107">NewLoggingConn</span><span class="op" id="7300121">(</span><span class="ident" id="7300122">baseName</span>&nbsp;<span class="builtintype" id="7300131">string</span><span class="op" id="7300137">,</span>&nbsp;<span class="ident" id="7300139">c</span>&nbsp;<span class="ident" id="7300141">net</span><span class="op" id="7300144">.</span><span class="ident" id="7300145">Conn</span><span class="op" id="7300149">)</span>&nbsp;<span class="ident" id="7300151">net</span><span class="op" id="7300154">.</span><span class="ident" id="7300155">Conn</span>&nbsp;<span class="op" id="7300160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300163">return</span>&nbsp;<span class="ident" id="7300170">newLoggingConn</span><span class="op" id="7300184">(</span><span class="ident" id="7300185">baseName</span><span class="op" id="7300193">,</span>&nbsp;<span class="ident" id="7300195">c</span><span class="op" id="7300196">)</span><br>
<span class="lineno"></span><span class="op" id="7300198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7300201">var</span>&nbsp;<span class="ident" id="7300205">ExportAppendTime</span>&nbsp;<span class="op" id="7300222">=</span>&nbsp;<span class="ident" id="7300224">appendTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7300236">func</span>&nbsp;<span class="op" id="7300241">(</span><span class="ident" id="7300242">t</span>&nbsp;<span class="op" id="7300244">*</span><span class="ident" id="7300245">Transport</span><span class="op" id="7300254">)</span>&nbsp;<span class="ident" id="7300256">NumPendingRequestsForTesting</span><span class="op" id="7300284">(</span><span class="op" id="7300285">)</span>&nbsp;<span class="builtintype" id="7300287">int</span>&nbsp;<span class="op" id="7300291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300294">t</span><span class="op" id="7300295">.</span><span class="ident" id="7300296">reqMu</span><span class="op" id="7300301">.</span><span class="ident" id="7300302">Lock</span><span class="op" id="7300306">(</span><span class="op" id="7300307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300310">defer</span>&nbsp;<span class="ident" id="7300316">t</span><span class="op" id="7300317">.</span><span class="ident" id="7300318">reqMu</span><span class="op" id="7300323">.</span><span class="ident" id="7300324">Unlock</span><span class="op" id="7300330">(</span><span class="op" id="7300331">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300334">return</span>&nbsp;<span class="builtinfunc" id="7300341">len</span><span class="op" id="7300344">(</span><span class="ident" id="7300345">t</span><span class="op" id="7300346">.</span><span class="ident" id="7300347">reqCanceler</span><span class="op" id="7300358">)</span><br>
<span class="lineno"></span><span class="op" id="7300360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7300363">func</span>&nbsp;<span class="op" id="7300368">(</span><span class="ident" id="7300369">t</span>&nbsp;<span class="op" id="7300371">*</span><span class="ident" id="7300372">Transport</span><span class="op" id="7300381">)</span>&nbsp;<span class="ident" id="7300383">IdleConnKeysForTesting</span><span class="op" id="7300405">(</span><span class="op" id="7300406">)</span>&nbsp;<span class="op" id="7300408">(</span><span class="ident" id="7300409">keys</span>&nbsp;<span class="op" id="7300414">[</span><span class="op" id="7300415">]</span><span class="builtintype" id="7300416">string</span><span class="op" id="7300422">)</span>&nbsp;<span class="op" id="7300424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300427">keys</span>&nbsp;<span class="op" id="7300432">=</span>&nbsp;<span class="builtinfunc" id="7300434">make</span><span class="op" id="7300438">(</span><span class="op" id="7300439">[</span><span class="op" id="7300440">]</span><span class="builtintype" id="7300441">string</span><span class="op" id="7300447">,</span>&nbsp;<span class="num" id="7300449">0</span><span class="op" id="7300450">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300453">t</span><span class="op" id="7300454">.</span><span class="ident" id="7300455">idleMu</span><span class="op" id="7300461">.</span><span class="ident" id="7300462">Lock</span><span class="op" id="7300466">(</span><span class="op" id="7300467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300470">defer</span>&nbsp;<span class="ident" id="7300476">t</span><span class="op" id="7300477">.</span><span class="ident" id="7300478">idleMu</span><span class="op" id="7300484">.</span><span class="ident" id="7300485">Unlock</span><span class="op" id="7300491">(</span><span class="op" id="7300492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300495">if</span>&nbsp;<span class="ident" id="7300498">t</span><span class="op" id="7300499">.</span><span class="ident" id="7300500">idleConn</span>&nbsp;<span class="op" id="7300509">==</span>&nbsp;<span class="ident" id="7300512">nil</span>&nbsp;<span class="op" id="7300516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300520">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300528">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300531">for</span>&nbsp;<span class="ident" id="7300535">key</span>&nbsp;<span class="op" id="7300539">:=</span>&nbsp;<span class="keyword" id="7300542">range</span>&nbsp;<span class="ident" id="7300548">t</span><span class="op" id="7300549">.</span><span class="ident" id="7300550">idleConn</span>&nbsp;<span class="op" id="7300559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300563">keys</span>&nbsp;<span class="op" id="7300568">=</span>&nbsp;<span class="builtinfunc" id="7300570">append</span><span class="op" id="7300576">(</span><span class="ident" id="7300577">keys</span><span class="op" id="7300581">,</span>&nbsp;<span class="ident" id="7300583">key</span><span class="op" id="7300586">.</span><span class="ident" id="7300587">String</span><span class="op" id="7300593">(</span><span class="op" id="7300594">)</span><span class="op" id="7300595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300601">return</span><br>
<span class="lineno"></span><span class="op" id="7300608">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7300611">func</span>&nbsp;<span class="op" id="7300616">(</span><span class="ident" id="7300617">t</span>&nbsp;<span class="op" id="7300619">*</span><span class="ident" id="7300620">Transport</span><span class="op" id="7300629">)</span>&nbsp;<span class="ident" id="7300631">IdleConnCountForTesting</span><span class="op" id="7300654">(</span><span class="ident" id="7300655">cacheKey</span>&nbsp;<span class="builtintype" id="7300664">string</span><span class="op" id="7300670">)</span>&nbsp;<span class="builtintype" id="7300672">int</span>&nbsp;<span class="op" id="7300676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300679">t</span><span class="op" id="7300680">.</span><span class="ident" id="7300681">idleMu</span><span class="op" id="7300687">.</span><span class="ident" id="7300688">Lock</span><span class="op" id="7300692">(</span><span class="op" id="7300693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300696">defer</span>&nbsp;<span class="ident" id="7300702">t</span><span class="op" id="7300703">.</span><span class="ident" id="7300704">idleMu</span><span class="op" id="7300710">.</span><span class="ident" id="7300711">Unlock</span><span class="op" id="7300717">(</span><span class="op" id="7300718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300721">if</span>&nbsp;<span class="ident" id="7300724">t</span><span class="op" id="7300725">.</span><span class="ident" id="7300726">idleConn</span>&nbsp;<span class="op" id="7300735">==</span>&nbsp;<span class="ident" id="7300738">nil</span>&nbsp;<span class="op" id="7300742">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300746">return</span>&nbsp;<span class="num" id="7300753">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300759">for</span>&nbsp;<span class="ident" id="7300763">k</span><span class="op" id="7300764">,</span>&nbsp;<span class="ident" id="7300766">conns</span>&nbsp;<span class="op" id="7300772">:=</span>&nbsp;<span class="keyword" id="7300775">range</span>&nbsp;<span class="ident" id="7300781">t</span><span class="op" id="7300782">.</span><span class="ident" id="7300783">idleConn</span>&nbsp;<span class="op" id="7300792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300796">if</span>&nbsp;<span class="ident" id="7300799">k</span><span class="op" id="7300800">.</span><span class="ident" id="7300801">String</span><span class="op" id="7300807">(</span><span class="op" id="7300808">)</span>&nbsp;<span class="op" id="7300810">==</span>&nbsp;<span class="ident" id="7300813">cacheKey</span>&nbsp;<span class="op" id="7300822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300827">return</span>&nbsp;<span class="builtinfunc" id="7300834">len</span><span class="op" id="7300837">(</span><span class="ident" id="7300838">conns</span><span class="op" id="7300843">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300853">return</span>&nbsp;<span class="num" id="7300860">0</span><br>
<span class="lineno"></span><span class="op" id="7300862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7300865">func</span>&nbsp;<span class="op" id="7300870">(</span><span class="ident" id="7300871">t</span>&nbsp;<span class="op" id="7300873">*</span><span class="ident" id="7300874">Transport</span><span class="op" id="7300883">)</span>&nbsp;<span class="ident" id="7300885">IdleConnChMapSizeForTesting</span><span class="op" id="7300912">(</span><span class="op" id="7300913">)</span>&nbsp;<span class="builtintype" id="7300915">int</span>&nbsp;<span class="op" id="7300919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300922">t</span><span class="op" id="7300923">.</span><span class="ident" id="7300924">idleMu</span><span class="op" id="7300930">.</span><span class="ident" id="7300931">Lock</span><span class="op" id="7300935">(</span><span class="op" id="7300936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300939">defer</span>&nbsp;<span class="ident" id="7300945">t</span><span class="op" id="7300946">.</span><span class="ident" id="7300947">idleMu</span><span class="op" id="7300953">.</span><span class="ident" id="7300954">Unlock</span><span class="op" id="7300960">(</span><span class="op" id="7300961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300964">return</span>&nbsp;<span class="builtinfunc" id="7300971">len</span><span class="op" id="7300974">(</span><span class="ident" id="7300975">t</span><span class="op" id="7300976">.</span><span class="ident" id="7300977">idleConnCh</span><span class="op" id="7300987">)</span><br>
<span class="lineno"></span><span class="op" id="7300989">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7300992">func</span>&nbsp;<span class="op" id="7300997">(</span><span class="ident" id="7300998">t</span>&nbsp;<span class="op" id="7301000">*</span><span class="ident" id="7301001">Transport</span><span class="op" id="7301010">)</span>&nbsp;<span class="ident" id="7301012">IsIdleForTesting</span><span class="op" id="7301028">(</span><span class="op" id="7301029">)</span>&nbsp;<span class="builtintype" id="7301031">bool</span>&nbsp;<span class="op" id="7301036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301039">t</span><span class="op" id="7301040">.</span><span class="ident" id="7301041">idleMu</span><span class="op" id="7301047">.</span><span class="ident" id="7301048">Lock</span><span class="op" id="7301052">(</span><span class="op" id="7301053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301056">defer</span>&nbsp;<span class="ident" id="7301062">t</span><span class="op" id="7301063">.</span><span class="ident" id="7301064">idleMu</span><span class="op" id="7301070">.</span><span class="ident" id="7301071">Unlock</span><span class="op" id="7301077">(</span><span class="op" id="7301078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301081">return</span>&nbsp;<span class="ident" id="7301088">t</span><span class="op" id="7301089">.</span><span class="ident" id="7301090">wantIdle</span><br>
<span class="lineno">65</span><span class="op" id="7301099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7301102">func</span>&nbsp;<span class="op" id="7301107">(</span><span class="ident" id="7301108">t</span>&nbsp;<span class="op" id="7301110">*</span><span class="ident" id="7301111">Transport</span><span class="op" id="7301120">)</span>&nbsp;<span class="ident" id="7301122">RequestIdleConnChForTesting</span><span class="op" id="7301149">(</span><span class="op" id="7301150">)</span>&nbsp;<span class="op" id="7301152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301155">t</span><span class="op" id="7301156">.</span><span class="ident" id="7301157">getIdleConnCh</span><span class="op" id="7301170">(</span><span class="ident" id="7301171">connectMethod</span><span class="op" id="7301184">{</span><span class="ident" id="7301185">nil</span><span class="op" id="7301188">,</span>&nbsp;<span class="string" id="7301190">&#34;http&#34;</span><span class="op" id="7301196">,</span>&nbsp;<span class="string" id="7301198">&#34;example.com&#34;</span><span class="op" id="7301211">}</span><span class="op" id="7301212">)</span><br>
<span class="lineno"></span><span class="op" id="7301214">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7301217">func</span>&nbsp;<span class="op" id="7301222">(</span><span class="ident" id="7301223">t</span>&nbsp;<span class="op" id="7301225">*</span><span class="ident" id="7301226">Transport</span><span class="op" id="7301235">)</span>&nbsp;<span class="ident" id="7301237">PutIdleTestConn</span><span class="op" id="7301252">(</span><span class="op" id="7301253">)</span>&nbsp;<span class="builtintype" id="7301255">bool</span>&nbsp;<span class="op" id="7301260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301263">c</span><span class="op" id="7301264">,</span>&nbsp;<span class="ident" id="7301266">_</span>&nbsp;<span class="op" id="7301268">:=</span>&nbsp;<span class="ident" id="7301271">net</span><span class="op" id="7301274">.</span><span class="ident" id="7301275">Pipe</span><span class="op" id="7301279">(</span><span class="op" id="7301280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301283">return</span>&nbsp;<span class="ident" id="7301290">t</span><span class="op" id="7301291">.</span><span class="ident" id="7301292">putIdleConn</span><span class="op" id="7301303">(</span><span class="op" id="7301304">&amp;</span><span class="ident" id="7301305">persistConn</span><span class="op" id="7301316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301320">t</span><span class="op" id="7301321">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7301330">t</span><span class="op" id="7301331">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301335">conn</span><span class="op" id="7301339">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7301345">c</span><span class="op" id="7301346">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7301366">//&nbsp;dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301377">closech</span><span class="op" id="7301384">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="7301387">make</span><span class="op" id="7301391">(</span><span class="keyword" id="7301392">chan</span>&nbsp;<span class="keyword" id="7301397">struct</span><span class="op" id="7301403">{</span><span class="op" id="7301404">}</span><span class="op" id="7301405">)</span><span class="op" id="7301406">,</span>&nbsp;<span class="comment" id="7301408">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;closed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301433">cacheKey</span><span class="op" id="7301441">:</span>&nbsp;<span class="ident" id="7301443">connectMethodKey</span><span class="op" id="7301459">{</span><span class="string" id="7301460">&#34;&#34;</span><span class="op" id="7301462">,</span>&nbsp;<span class="string" id="7301464">&#34;http&#34;</span><span class="op" id="7301470">,</span>&nbsp;<span class="string" id="7301472">&#34;example.com&#34;</span><span class="op" id="7301485">}</span><span class="op" id="7301486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301489">}</span><span class="op" id="7301490">)</span><br>
<span class="lineno"></span><span class="op" id="7301492">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7301495">func</span>&nbsp;<span class="ident" id="7301500">NewTestTimeoutHandler</span><span class="op" id="7301521">(</span><span class="ident" id="7301522">handler</span>&nbsp;<span class="ident" id="7301530">Handler</span><span class="op" id="7301537">,</span>&nbsp;<span class="ident" id="7301539">ch</span>&nbsp;<span class="op" id="7301542">&lt;-</span><span class="keyword" id="7301544">chan</span>&nbsp;<span class="ident" id="7301549">time</span><span class="op" id="7301553">.</span><span class="ident" id="7301554">Time</span><span class="op" id="7301558">)</span>&nbsp;<span class="ident" id="7301560">Handler</span>&nbsp;<span class="op" id="7301568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301571">f</span>&nbsp;<span class="op" id="7301573">:=</span>&nbsp;<span class="keyword" id="7301576">func</span><span class="op" id="7301580">(</span><span class="op" id="7301581">)</span>&nbsp;<span class="op" id="7301583">&lt;-</span><span class="keyword" id="7301585">chan</span>&nbsp;<span class="ident" id="7301590">time</span><span class="op" id="7301594">.</span><span class="ident" id="7301595">Time</span>&nbsp;<span class="op" id="7301600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301604">return</span>&nbsp;<span class="ident" id="7301611">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301615">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301618">return</span>&nbsp;<span class="op" id="7301625">&amp;</span><span class="ident" id="7301626">timeoutHandler</span><span class="op" id="7301640">{</span><span class="ident" id="7301641">handler</span><span class="op" id="7301648">,</span>&nbsp;<span class="ident" id="7301650">f</span><span class="op" id="7301651">,</span>&nbsp;<span class="string" id="7301653">&#34;&#34;</span><span class="op" id="7301655">}</span><br>
<span class="lineno"></span><span class="op" id="7301657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7301660">func</span>&nbsp;<span class="ident" id="7301665">ResetCachedEnvironment</span><span class="op" id="7301687">(</span><span class="op" id="7301688">)</span>&nbsp;<span class="op" id="7301690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301693">httpProxyEnv</span><span class="op" id="7301705">.</span><span class="ident" id="7301706">reset</span><span class="op" id="7301711">(</span><span class="op" id="7301712">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301715">httpsProxyEnv</span><span class="op" id="7301728">.</span><span class="ident" id="7301729">reset</span><span class="op" id="7301734">(</span><span class="op" id="7301735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301738">noProxyEnv</span><span class="op" id="7301748">.</span><span class="ident" id="7301749">reset</span><span class="op" id="7301754">(</span><span class="op" id="7301755">)</span><br>
<span class="lineno"></span><span class="op" id="7301757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7301760">var</span>&nbsp;<span class="ident" id="7301764">DefaultUserAgent</span>&nbsp;<span class="op" id="7301781">=</span>&nbsp;<span class="ident" id="7301783">defaultUserAgent</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7301801">func</span>&nbsp;<span class="ident" id="7301806">ExportRefererForURL</span><span class="op" id="7301825">(</span><span class="ident" id="7301826">lastReq</span><span class="op" id="7301833">,</span>&nbsp;<span class="ident" id="7301835">newReq</span>&nbsp;<span class="op" id="7301842">*</span><span class="ident" id="7301843">url</span><span class="op" id="7301846">.</span><span class="ident" id="7301847">URL</span><span class="op" id="7301850">)</span>&nbsp;<span class="builtintype" id="7301852">string</span>&nbsp;<span class="op" id="7301859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301862">return</span>&nbsp;<span class="ident" id="7301869">refererForURL</span><span class="op" id="7301882">(</span><span class="ident" id="7301883">lastReq</span><span class="op" id="7301890">,</span>&nbsp;<span class="ident" id="7301892">newReq</span><span class="op" id="7301898">)</span><br>
<span class="lineno"></span><span class="op" id="7301900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="7301903">//&nbsp;SetPendingDialHooks&nbsp;sets&nbsp;the&nbsp;hooks&nbsp;that&nbsp;run&nbsp;before&nbsp;and&nbsp;after&nbsp;handling</span><br>
<span class="lineno"></span><span class="comment" id="7301976">//&nbsp;pending&nbsp;dials.</span><br>
<span class="lineno"></span><span class="keyword" id="7301994">func</span>&nbsp;<span class="ident" id="7301999">SetPendingDialHooks</span><span class="op" id="7302018">(</span><span class="ident" id="7302019">before</span><span class="op" id="7302025">,</span>&nbsp;<span class="ident" id="7302027">after</span>&nbsp;<span class="keyword" id="7302033">func</span><span class="op" id="7302037">(</span><span class="op" id="7302038">)</span><span class="op" id="7302039">)</span>&nbsp;<span class="op" id="7302041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7302044">prePendingDial</span><span class="op" id="7302058">,</span>&nbsp;<span class="ident" id="7302060">postPendingDial</span>&nbsp;<span class="op" id="7302076">=</span>&nbsp;<span class="ident" id="7302078">before</span><span class="op" id="7302084">,</span>&nbsp;<span class="ident" id="7302086">after</span><br>
<span class="lineno"></span><span class="op" id="7302092">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7302095">var</span>&nbsp;<span class="ident" id="7302099">ExportServerNewConn</span>&nbsp;<span class="op" id="7302119">=</span>&nbsp;<span class="op" id="7302121">(</span><span class="op" id="7302122">*</span><span class="ident" id="7302123">Server</span><span class="op" id="7302129">)</span><span class="op" id="7302130">.</span><span class="ident" id="7302131">newConn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7302140">var</span>&nbsp;<span class="ident" id="7302144">ExportCloseWriteAndWait</span>&nbsp;<span class="op" id="7302168">=</span>&nbsp;<span class="op" id="7302170">(</span><span class="op" id="7302171">*</span><span class="ident" id="7302172">conn</span><span class="op" id="7302176">)</span><span class="op" id="7302177">.</span><span class="ident" id="7302178">closeWriteAndWait</span>
</div>
</body>
</html>
