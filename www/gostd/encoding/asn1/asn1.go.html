<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4840037">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4840092">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4840146">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4840197">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4840270">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4840304">//</span><br>
<span class="lineno"></span><span class="comment" id="4840307">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4840376">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4840428">package</span>&nbsp;<span class="ident" id="4840436">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4840442">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4840522">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4840598">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4840674">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4840753">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4840828">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4840900">//</span><br>
<span class="lineno"></span><span class="comment" id="4840903">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4840974">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4841003">import</span>&nbsp;<span class="op" id="4841010">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4841013">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4841020">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4841032">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4841043">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4841054">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4841061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4841064">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4841140">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4841180">type</span>&nbsp;<span class="ident" id="4841185">StructuralError</span>&nbsp;<span class="keyword" id="4841201">struct</span>&nbsp;<span class="op" id="4841208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841211">Msg</span>&nbsp;<span class="builtintype" id="4841215">string</span><br>
<span class="lineno"></span><span class="op" id="4841222">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4841225">func</span>&nbsp;<span class="op" id="4841230">(</span><span class="ident" id="4841231">e</span>&nbsp;<span class="ident" id="4841233">StructuralError</span><span class="op" id="4841248">)</span>&nbsp;<span class="ident" id="4841250">Error</span><span class="op" id="4841255">(</span><span class="op" id="4841256">)</span>&nbsp;<span class="builtintype" id="4841258">string</span>&nbsp;<span class="op" id="4841265">{</span>&nbsp;<span class="keyword" id="4841267">return</span>&nbsp;<span class="string" id="4841274">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4841300">+</span>&nbsp;<span class="ident" id="4841302">e</span><span class="op" id="4841303">.</span><span class="ident" id="4841304">Msg</span>&nbsp;<span class="op" id="4841308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841311">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4841369">type</span>&nbsp;<span class="ident" id="4841374">SyntaxError</span>&nbsp;<span class="keyword" id="4841386">struct</span>&nbsp;<span class="op" id="4841393">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841396">Msg</span>&nbsp;<span class="builtintype" id="4841400">string</span><br>
<span class="lineno"></span><span class="op" id="4841407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4841410">func</span>&nbsp;<span class="op" id="4841415">(</span><span class="ident" id="4841416">e</span>&nbsp;<span class="ident" id="4841418">SyntaxError</span><span class="op" id="4841429">)</span>&nbsp;<span class="ident" id="4841431">Error</span><span class="op" id="4841436">(</span><span class="op" id="4841437">)</span>&nbsp;<span class="builtintype" id="4841439">string</span>&nbsp;<span class="op" id="4841446">{</span>&nbsp;<span class="keyword" id="4841448">return</span>&nbsp;<span class="string" id="4841455">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4841478">+</span>&nbsp;<span class="ident" id="4841480">e</span><span class="op" id="4841481">.</span><span class="ident" id="4841482">Msg</span>&nbsp;<span class="op" id="4841486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4841489">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841555">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4841567">func</span>&nbsp;<span class="ident" id="4841572">parseBool</span><span class="op" id="4841581">(</span><span class="ident" id="4841582">bytes</span>&nbsp;<span class="op" id="4841588">[</span><span class="op" id="4841589">]</span><span class="builtintype" id="4841590">byte</span><span class="op" id="4841594">)</span>&nbsp;<span class="op" id="4841596">(</span><span class="ident" id="4841597">ret</span>&nbsp;<span class="builtintype" id="4841601">bool</span><span class="op" id="4841605">,</span>&nbsp;<span class="ident" id="4841607">err</span>&nbsp;<span class="builtintype" id="4841611">error</span><span class="op" id="4841616">)</span>&nbsp;<span class="op" id="4841618">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841621">if</span>&nbsp;<span class="builtinfunc" id="4841624">len</span><span class="op" id="4841627">(</span><span class="ident" id="4841628">bytes</span><span class="op" id="4841633">)</span>&nbsp;<span class="op" id="4841635">!=</span>&nbsp;<span class="num" id="4841638">1</span>&nbsp;<span class="op" id="4841640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841644">err</span>&nbsp;<span class="op" id="4841648">=</span>&nbsp;<span class="ident" id="4841650">SyntaxError</span><span class="op" id="4841661">{</span><span class="string" id="4841662">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4841679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841683">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4841691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841695">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841768">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841837">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841887">switch</span>&nbsp;<span class="ident" id="4841894">bytes</span><span class="op" id="4841899">[</span><span class="num" id="4841900">0</span><span class="op" id="4841901">]</span>&nbsp;<span class="op" id="4841903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841906">case</span>&nbsp;<span class="num" id="4841911">0</span><span class="op" id="4841912">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841916">ret</span>&nbsp;<span class="op" id="4841920">=</span>&nbsp;<span class="builtintype" id="4841922">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841929">case</span>&nbsp;<span class="num" id="4841934">0xff</span><span class="op" id="4841938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841942">ret</span>&nbsp;<span class="op" id="4841946">=</span>&nbsp;<span class="builtintype" id="4841948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4841954">default</span><span class="op" id="4841961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841965">err</span>&nbsp;<span class="op" id="4841969">=</span>&nbsp;<span class="ident" id="4841971">SyntaxError</span><span class="op" id="4841982">{</span><span class="string" id="4841983">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4842000">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842007">return</span><br>
<span class="lineno"></span><span class="op" id="4842014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4842017">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4842029">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4842102">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4842125">func</span>&nbsp;<span class="ident" id="4842130">parseInt64</span><span class="op" id="4842140">(</span><span class="ident" id="4842141">bytes</span>&nbsp;<span class="op" id="4842147">[</span><span class="op" id="4842148">]</span><span class="builtintype" id="4842149">byte</span><span class="op" id="4842153">)</span>&nbsp;<span class="op" id="4842155">(</span><span class="ident" id="4842156">ret</span>&nbsp;<span class="ident" id="4842160">int64</span><span class="op" id="4842165">,</span>&nbsp;<span class="ident" id="4842167">err</span>&nbsp;<span class="builtintype" id="4842171">error</span><span class="op" id="4842176">)</span>&nbsp;<span class="op" id="4842178">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842181">if</span>&nbsp;<span class="builtinfunc" id="4842184">len</span><span class="op" id="4842187">(</span><span class="ident" id="4842188">bytes</span><span class="op" id="4842193">)</span>&nbsp;<span class="op" id="4842195">&gt;</span>&nbsp;<span class="num" id="4842197">8</span>&nbsp;<span class="op" id="4842199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842203">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842246">err</span>&nbsp;<span class="op" id="4842250">=</span>&nbsp;<span class="ident" id="4842252">StructuralError</span><span class="op" id="4842267">{</span><span class="string" id="4842268">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4842287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842291">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842299">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842302">for</span>&nbsp;<span class="ident" id="4842306">bytesRead</span>&nbsp;<span class="op" id="4842316">:=</span>&nbsp;<span class="num" id="4842319">0</span><span class="op" id="4842320">;</span>&nbsp;<span class="ident" id="4842322">bytesRead</span>&nbsp;<span class="op" id="4842332">&lt;</span>&nbsp;<span class="builtinfunc" id="4842334">len</span><span class="op" id="4842337">(</span><span class="ident" id="4842338">bytes</span><span class="op" id="4842343">)</span><span class="op" id="4842344">;</span>&nbsp;<span class="ident" id="4842346">bytesRead</span><span class="op" id="4842355">++</span>&nbsp;<span class="op" id="4842358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842362">ret</span>&nbsp;<span class="op" id="4842366">&lt;&lt;=</span>&nbsp;<span class="num" id="4842370">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842374">ret</span>&nbsp;<span class="op" id="4842378">|=</span>&nbsp;<span class="ident" id="4842381">int64</span><span class="op" id="4842386">(</span><span class="ident" id="4842387">bytes</span><span class="op" id="4842392">[</span><span class="ident" id="4842393">bytesRead</span><span class="op" id="4842402">]</span><span class="op" id="4842403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4842410">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842468">ret</span>&nbsp;<span class="op" id="4842472">&lt;&lt;=</span>&nbsp;<span class="num" id="4842476">64</span>&nbsp;<span class="op" id="4842479">-</span>&nbsp;<span class="builtintype" id="4842481">uint8</span><span class="op" id="4842486">(</span><span class="builtinfunc" id="4842487">len</span><span class="op" id="4842490">(</span><span class="ident" id="4842491">bytes</span><span class="op" id="4842496">)</span><span class="op" id="4842497">)</span><span class="op" id="4842498">*</span><span class="num" id="4842499">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842502">ret</span>&nbsp;<span class="op" id="4842506">&gt;&gt;=</span>&nbsp;<span class="num" id="4842510">64</span>&nbsp;<span class="op" id="4842513">-</span>&nbsp;<span class="builtintype" id="4842515">uint8</span><span class="op" id="4842520">(</span><span class="builtinfunc" id="4842521">len</span><span class="op" id="4842524">(</span><span class="ident" id="4842525">bytes</span><span class="op" id="4842530">)</span><span class="op" id="4842531">)</span><span class="op" id="4842532">*</span><span class="num" id="4842533">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842536">return</span><br>
<span class="lineno"></span><span class="op" id="4842543">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4842546">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4842625">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4842640">func</span>&nbsp;<span class="ident" id="4842645">parseInt32</span><span class="op" id="4842655">(</span><span class="ident" id="4842656">bytes</span>&nbsp;<span class="op" id="4842662">[</span><span class="op" id="4842663">]</span><span class="builtintype" id="4842664">byte</span><span class="op" id="4842668">)</span>&nbsp;<span class="op" id="4842670">(</span><span class="builtintype" id="4842671">int32</span><span class="op" id="4842676">,</span>&nbsp;<span class="builtintype" id="4842678">error</span><span class="op" id="4842683">)</span>&nbsp;<span class="op" id="4842685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842688">ret64</span><span class="op" id="4842693">,</span>&nbsp;<span class="ident" id="4842695">err</span>&nbsp;<span class="op" id="4842699">:=</span>&nbsp;<span class="ident" id="4842702">parseInt64</span><span class="op" id="4842712">(</span><span class="ident" id="4842713">bytes</span><span class="op" id="4842718">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842721">if</span>&nbsp;<span class="ident" id="4842724">err</span>&nbsp;<span class="op" id="4842728">!=</span>&nbsp;<span class="ident" id="4842731">nil</span>&nbsp;<span class="op" id="4842735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842739">return</span>&nbsp;<span class="num" id="4842746">0</span><span class="op" id="4842747">,</span>&nbsp;<span class="ident" id="4842749">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842757">if</span>&nbsp;<span class="ident" id="4842760">ret64</span>&nbsp;<span class="op" id="4842766">!=</span>&nbsp;<span class="ident" id="4842769">int64</span><span class="op" id="4842774">(</span><span class="builtintype" id="4842775">int32</span><span class="op" id="4842780">(</span><span class="ident" id="4842781">ret64</span><span class="op" id="4842786">)</span><span class="op" id="4842787">)</span>&nbsp;<span class="op" id="4842789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842793">return</span>&nbsp;<span class="num" id="4842800">0</span><span class="op" id="4842801">,</span>&nbsp;<span class="ident" id="4842803">StructuralError</span><span class="op" id="4842818">{</span><span class="string" id="4842819">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4842838">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842844">return</span>&nbsp;<span class="builtintype" id="4842851">int32</span><span class="op" id="4842856">(</span><span class="ident" id="4842857">ret64</span><span class="op" id="4842862">)</span><span class="op" id="4842863">,</span>&nbsp;<span class="ident" id="4842865">nil</span><br>
<span class="lineno"></span><span class="op" id="4842869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842872">var</span>&nbsp;<span class="ident" id="4842876">bigOne</span>&nbsp;<span class="op" id="4842883">=</span>&nbsp;<span class="ident" id="4842885">big</span><span class="op" id="4842888">.</span><span class="ident" id="4842889">NewInt</span><span class="op" id="4842895">(</span><span class="num" id="4842896">1</span><span class="op" id="4842897">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4842900">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4842982">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4842997">func</span>&nbsp;<span class="ident" id="4843002">parseBigInt</span><span class="op" id="4843013">(</span><span class="ident" id="4843014">bytes</span>&nbsp;<span class="op" id="4843020">[</span><span class="op" id="4843021">]</span><span class="builtintype" id="4843022">byte</span><span class="op" id="4843026">)</span>&nbsp;<span class="op" id="4843028">*</span><span class="ident" id="4843029">big</span><span class="op" id="4843032">.</span><span class="ident" id="4843033">Int</span>&nbsp;<span class="op" id="4843037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843040">ret</span>&nbsp;<span class="op" id="4843044">:=</span>&nbsp;<span class="builtinfunc" id="4843047">new</span><span class="op" id="4843050">(</span><span class="ident" id="4843051">big</span><span class="op" id="4843054">.</span><span class="ident" id="4843055">Int</span><span class="op" id="4843058">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843061">if</span>&nbsp;<span class="builtinfunc" id="4843064">len</span><span class="op" id="4843067">(</span><span class="ident" id="4843068">bytes</span><span class="op" id="4843073">)</span>&nbsp;<span class="op" id="4843075">&gt;</span>&nbsp;<span class="num" id="4843077">0</span>&nbsp;<span class="op" id="4843079">&amp;&amp;</span>&nbsp;<span class="ident" id="4843082">bytes</span><span class="op" id="4843087">[</span><span class="num" id="4843088">0</span><span class="op" id="4843089">]</span><span class="op" id="4843090">&amp;</span><span class="num" id="4843091">0x80</span>&nbsp;<span class="op" id="4843096">==</span>&nbsp;<span class="num" id="4843099">0x80</span>&nbsp;<span class="op" id="4843104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4843108">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843140">notBytes</span>&nbsp;<span class="op" id="4843149">:=</span>&nbsp;<span class="builtinfunc" id="4843152">make</span><span class="op" id="4843156">(</span><span class="op" id="4843157">[</span><span class="op" id="4843158">]</span><span class="builtintype" id="4843159">byte</span><span class="op" id="4843163">,</span>&nbsp;<span class="builtinfunc" id="4843165">len</span><span class="op" id="4843168">(</span><span class="ident" id="4843169">bytes</span><span class="op" id="4843174">)</span><span class="op" id="4843175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843179">for</span>&nbsp;<span class="ident" id="4843183">i</span>&nbsp;<span class="op" id="4843185">:=</span>&nbsp;<span class="keyword" id="4843188">range</span>&nbsp;<span class="ident" id="4843194">notBytes</span>&nbsp;<span class="op" id="4843203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843208">notBytes</span><span class="op" id="4843216">[</span><span class="ident" id="4843217">i</span><span class="op" id="4843218">]</span>&nbsp;<span class="op" id="4843220">=</span>&nbsp;<span class="op" id="4843222">^</span><span class="ident" id="4843223">bytes</span><span class="op" id="4843228">[</span><span class="ident" id="4843229">i</span><span class="op" id="4843230">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843238">ret</span><span class="op" id="4843241">.</span><span class="ident" id="4843242">SetBytes</span><span class="op" id="4843250">(</span><span class="ident" id="4843251">notBytes</span><span class="op" id="4843259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843263">ret</span><span class="op" id="4843266">.</span><span class="ident" id="4843267">Add</span><span class="op" id="4843270">(</span><span class="ident" id="4843271">ret</span><span class="op" id="4843274">,</span>&nbsp;<span class="ident" id="4843276">bigOne</span><span class="op" id="4843282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843286">ret</span><span class="op" id="4843289">.</span><span class="ident" id="4843290">Neg</span><span class="op" id="4843293">(</span><span class="ident" id="4843294">ret</span><span class="op" id="4843297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843301">return</span>&nbsp;<span class="ident" id="4843308">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843316">ret</span><span class="op" id="4843319">.</span><span class="ident" id="4843320">SetBytes</span><span class="op" id="4843328">(</span><span class="ident" id="4843329">bytes</span><span class="op" id="4843334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843337">return</span>&nbsp;<span class="ident" id="4843344">ret</span><br>
<span class="lineno"></span><span class="op" id="4843348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4843351">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4843366">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4843445">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4843520">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4843574">type</span>&nbsp;<span class="ident" id="4843579">BitString</span>&nbsp;<span class="keyword" id="4843589">struct</span>&nbsp;<span class="op" id="4843596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843599">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843609">[</span><span class="op" id="4843610">]</span><span class="builtintype" id="4843611">byte</span>&nbsp;<span class="comment" id="4843616">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843644">BitLength</span>&nbsp;<span class="builtintype" id="4843654">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4843661">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4843680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4843683">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4843757">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4843775">func</span>&nbsp;<span class="op" id="4843780">(</span><span class="ident" id="4843781">b</span>&nbsp;<span class="ident" id="4843783">BitString</span><span class="op" id="4843792">)</span>&nbsp;<span class="ident" id="4843794">At</span><span class="op" id="4843796">(</span><span class="ident" id="4843797">i</span>&nbsp;<span class="builtintype" id="4843799">int</span><span class="op" id="4843802">)</span>&nbsp;<span class="builtintype" id="4843804">int</span>&nbsp;<span class="op" id="4843808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843811">if</span>&nbsp;<span class="ident" id="4843814">i</span>&nbsp;<span class="op" id="4843816">&lt;</span>&nbsp;<span class="num" id="4843818">0</span>&nbsp;<span class="op" id="4843820">||</span>&nbsp;<span class="ident" id="4843823">i</span>&nbsp;<span class="op" id="4843825">&gt;=</span>&nbsp;<span class="ident" id="4843828">b</span><span class="op" id="4843829">.</span><span class="ident" id="4843830">BitLength</span>&nbsp;<span class="op" id="4843840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843844">return</span>&nbsp;<span class="num" id="4843851">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843857">x</span>&nbsp;<span class="op" id="4843859">:=</span>&nbsp;<span class="ident" id="4843862">i</span>&nbsp;<span class="op" id="4843864">/</span>&nbsp;<span class="num" id="4843866">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843869">y</span>&nbsp;<span class="op" id="4843871">:=</span>&nbsp;<span class="num" id="4843874">7</span>&nbsp;<span class="op" id="4843876">-</span>&nbsp;<span class="builtintype" id="4843878">uint</span><span class="op" id="4843882">(</span><span class="ident" id="4843883">i</span><span class="op" id="4843884">%</span><span class="num" id="4843885">8</span><span class="op" id="4843886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843889">return</span>&nbsp;<span class="builtintype" id="4843896">int</span><span class="op" id="4843899">(</span><span class="ident" id="4843900">b</span><span class="op" id="4843901">.</span><span class="ident" id="4843902">Bytes</span><span class="op" id="4843907">[</span><span class="ident" id="4843908">x</span><span class="op" id="4843909">]</span><span class="op" id="4843910">&gt;&gt;</span><span class="ident" id="4843912">y</span><span class="op" id="4843913">)</span>&nbsp;<span class="op" id="4843915">&amp;</span>&nbsp;<span class="num" id="4843917">1</span><br>
<span class="lineno"></span><span class="op" id="4843919">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4843922">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4844001">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4844047">func</span>&nbsp;<span class="op" id="4844052">(</span><span class="ident" id="4844053">b</span>&nbsp;<span class="ident" id="4844055">BitString</span><span class="op" id="4844064">)</span>&nbsp;<span class="ident" id="4844066">RightAlign</span><span class="op" id="4844076">(</span><span class="op" id="4844077">)</span>&nbsp;<span class="op" id="4844079">[</span><span class="op" id="4844080">]</span><span class="builtintype" id="4844081">byte</span>&nbsp;<span class="op" id="4844086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844089">shift</span>&nbsp;<span class="op" id="4844095">:=</span>&nbsp;<span class="builtintype" id="4844098">uint</span><span class="op" id="4844102">(</span><span class="num" id="4844103">8</span>&nbsp;<span class="op" id="4844105">-</span>&nbsp;<span class="op" id="4844107">(</span><span class="ident" id="4844108">b</span><span class="op" id="4844109">.</span><span class="ident" id="4844110">BitLength</span>&nbsp;<span class="op" id="4844120">%</span>&nbsp;<span class="num" id="4844122">8</span><span class="op" id="4844123">)</span><span class="op" id="4844124">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844127">if</span>&nbsp;<span class="ident" id="4844130">shift</span>&nbsp;<span class="op" id="4844136">==</span>&nbsp;<span class="num" id="4844139">8</span>&nbsp;<span class="op" id="4844141">||</span>&nbsp;<span class="builtinfunc" id="4844144">len</span><span class="op" id="4844147">(</span><span class="ident" id="4844148">b</span><span class="op" id="4844149">.</span><span class="ident" id="4844150">Bytes</span><span class="op" id="4844155">)</span>&nbsp;<span class="op" id="4844157">==</span>&nbsp;<span class="num" id="4844160">0</span>&nbsp;<span class="op" id="4844162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844166">return</span>&nbsp;<span class="ident" id="4844173">b</span><span class="op" id="4844174">.</span><span class="ident" id="4844175">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844186">a</span>&nbsp;<span class="op" id="4844188">:=</span>&nbsp;<span class="builtinfunc" id="4844191">make</span><span class="op" id="4844195">(</span><span class="op" id="4844196">[</span><span class="op" id="4844197">]</span><span class="builtintype" id="4844198">byte</span><span class="op" id="4844202">,</span>&nbsp;<span class="builtinfunc" id="4844204">len</span><span class="op" id="4844207">(</span><span class="ident" id="4844208">b</span><span class="op" id="4844209">.</span><span class="ident" id="4844210">Bytes</span><span class="op" id="4844215">)</span><span class="op" id="4844216">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844219">a</span><span class="op" id="4844220">[</span><span class="num" id="4844221">0</span><span class="op" id="4844222">]</span>&nbsp;<span class="op" id="4844224">=</span>&nbsp;<span class="ident" id="4844226">b</span><span class="op" id="4844227">.</span><span class="ident" id="4844228">Bytes</span><span class="op" id="4844233">[</span><span class="num" id="4844234">0</span><span class="op" id="4844235">]</span>&nbsp;<span class="op" id="4844237">&gt;&gt;</span>&nbsp;<span class="ident" id="4844240">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844247">for</span>&nbsp;<span class="ident" id="4844251">i</span>&nbsp;<span class="op" id="4844253">:=</span>&nbsp;<span class="num" id="4844256">1</span><span class="op" id="4844257">;</span>&nbsp;<span class="ident" id="4844259">i</span>&nbsp;<span class="op" id="4844261">&lt;</span>&nbsp;<span class="builtinfunc" id="4844263">len</span><span class="op" id="4844266">(</span><span class="ident" id="4844267">b</span><span class="op" id="4844268">.</span><span class="ident" id="4844269">Bytes</span><span class="op" id="4844274">)</span><span class="op" id="4844275">;</span>&nbsp;<span class="ident" id="4844277">i</span><span class="op" id="4844278">++</span>&nbsp;<span class="op" id="4844281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844285">a</span><span class="op" id="4844286">[</span><span class="ident" id="4844287">i</span><span class="op" id="4844288">]</span>&nbsp;<span class="op" id="4844290">=</span>&nbsp;<span class="ident" id="4844292">b</span><span class="op" id="4844293">.</span><span class="ident" id="4844294">Bytes</span><span class="op" id="4844299">[</span><span class="ident" id="4844300">i</span><span class="op" id="4844301">-</span><span class="num" id="4844302">1</span><span class="op" id="4844303">]</span>&nbsp;<span class="op" id="4844305">&lt;&lt;</span>&nbsp;<span class="op" id="4844308">(</span><span class="num" id="4844309">8</span>&nbsp;<span class="op" id="4844311">-</span>&nbsp;<span class="ident" id="4844313">shift</span><span class="op" id="4844318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844322">a</span><span class="op" id="4844323">[</span><span class="ident" id="4844324">i</span><span class="op" id="4844325">]</span>&nbsp;<span class="op" id="4844327">|=</span>&nbsp;<span class="ident" id="4844330">b</span><span class="op" id="4844331">.</span><span class="ident" id="4844332">Bytes</span><span class="op" id="4844337">[</span><span class="ident" id="4844338">i</span><span class="op" id="4844339">]</span>&nbsp;<span class="op" id="4844341">&gt;&gt;</span>&nbsp;<span class="ident" id="4844344">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844351">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844355">return</span>&nbsp;<span class="ident" id="4844362">a</span><br>
<span class="lineno"></span><span class="op" id="4844364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4844367">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4844454">func</span>&nbsp;<span class="ident" id="4844459">parseBitString</span><span class="op" id="4844473">(</span><span class="ident" id="4844474">bytes</span>&nbsp;<span class="op" id="4844480">[</span><span class="op" id="4844481">]</span><span class="builtintype" id="4844482">byte</span><span class="op" id="4844486">)</span>&nbsp;<span class="op" id="4844488">(</span><span class="ident" id="4844489">ret</span>&nbsp;<span class="ident" id="4844493">BitString</span><span class="op" id="4844502">,</span>&nbsp;<span class="ident" id="4844504">err</span>&nbsp;<span class="builtintype" id="4844508">error</span><span class="op" id="4844513">)</span>&nbsp;<span class="op" id="4844515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844518">if</span>&nbsp;<span class="builtinfunc" id="4844521">len</span><span class="op" id="4844524">(</span><span class="ident" id="4844525">bytes</span><span class="op" id="4844530">)</span>&nbsp;<span class="op" id="4844532">==</span>&nbsp;<span class="num" id="4844535">0</span>&nbsp;<span class="op" id="4844537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844541">err</span>&nbsp;<span class="op" id="4844545">=</span>&nbsp;<span class="ident" id="4844547">SyntaxError</span><span class="op" id="4844558">{</span><span class="string" id="4844559">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4844583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844587">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844595">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844598">paddingBits</span>&nbsp;<span class="op" id="4844610">:=</span>&nbsp;<span class="builtintype" id="4844613">int</span><span class="op" id="4844616">(</span><span class="ident" id="4844617">bytes</span><span class="op" id="4844622">[</span><span class="num" id="4844623">0</span><span class="op" id="4844624">]</span><span class="op" id="4844625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844628">if</span>&nbsp;<span class="ident" id="4844631">paddingBits</span>&nbsp;<span class="op" id="4844643">&gt;</span>&nbsp;<span class="num" id="4844645">7</span>&nbsp;<span class="op" id="4844647">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4844652">len</span><span class="op" id="4844655">(</span><span class="ident" id="4844656">bytes</span><span class="op" id="4844661">)</span>&nbsp;<span class="op" id="4844663">==</span>&nbsp;<span class="num" id="4844666">1</span>&nbsp;<span class="op" id="4844668">&amp;&amp;</span>&nbsp;<span class="ident" id="4844671">paddingBits</span>&nbsp;<span class="op" id="4844683">&gt;</span>&nbsp;<span class="num" id="4844685">0</span>&nbsp;<span class="op" id="4844687">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844692">bytes</span><span class="op" id="4844697">[</span><span class="builtinfunc" id="4844698">len</span><span class="op" id="4844701">(</span><span class="ident" id="4844702">bytes</span><span class="op" id="4844707">)</span><span class="op" id="4844708">-</span><span class="num" id="4844709">1</span><span class="op" id="4844710">]</span><span class="op" id="4844711">&amp;</span><span class="op" id="4844712">(</span><span class="op" id="4844713">(</span><span class="num" id="4844714">1</span><span class="op" id="4844715">&lt;&lt;</span><span class="ident" id="4844717">bytes</span><span class="op" id="4844722">[</span><span class="num" id="4844723">0</span><span class="op" id="4844724">]</span><span class="op" id="4844725">)</span><span class="op" id="4844726">-</span><span class="num" id="4844727">1</span><span class="op" id="4844728">)</span>&nbsp;<span class="op" id="4844730">!=</span>&nbsp;<span class="num" id="4844733">0</span>&nbsp;<span class="op" id="4844735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844739">err</span>&nbsp;<span class="op" id="4844743">=</span>&nbsp;<span class="ident" id="4844745">SyntaxError</span><span class="op" id="4844756">{</span><span class="string" id="4844757">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4844793">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844808">ret</span><span class="op" id="4844811">.</span><span class="ident" id="4844812">BitLength</span>&nbsp;<span class="op" id="4844822">=</span>&nbsp;<span class="op" id="4844824">(</span><span class="builtinfunc" id="4844825">len</span><span class="op" id="4844828">(</span><span class="ident" id="4844829">bytes</span><span class="op" id="4844834">)</span><span class="op" id="4844835">-</span><span class="num" id="4844836">1</span><span class="op" id="4844837">)</span><span class="op" id="4844838">*</span><span class="num" id="4844839">8</span>&nbsp;<span class="op" id="4844841">-</span>&nbsp;<span class="ident" id="4844843">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844856">ret</span><span class="op" id="4844859">.</span><span class="ident" id="4844860">Bytes</span>&nbsp;<span class="op" id="4844866">=</span>&nbsp;<span class="ident" id="4844868">bytes</span><span class="op" id="4844873">[</span><span class="num" id="4844874">1</span><span class="op" id="4844875">:</span><span class="op" id="4844876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844879">return</span><br>
<span class="lineno">180</span><span class="op" id="4844886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4844889">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4844911">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4844973">type</span>&nbsp;<span class="ident" id="4844978">ObjectIdentifier</span>&nbsp;<span class="op" id="4844995">[</span><span class="op" id="4844996">]</span><span class="builtintype" id="4844997">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4845002">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4845071">func</span>&nbsp;<span class="op" id="4845076">(</span><span class="ident" id="4845077">oi</span>&nbsp;<span class="ident" id="4845080">ObjectIdentifier</span><span class="op" id="4845096">)</span>&nbsp;<span class="ident" id="4845098">Equal</span><span class="op" id="4845103">(</span><span class="ident" id="4845104">other</span>&nbsp;<span class="ident" id="4845110">ObjectIdentifier</span><span class="op" id="4845126">)</span>&nbsp;<span class="builtintype" id="4845128">bool</span>&nbsp;<span class="op" id="4845133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845136">if</span>&nbsp;<span class="builtinfunc" id="4845139">len</span><span class="op" id="4845142">(</span><span class="ident" id="4845143">oi</span><span class="op" id="4845145">)</span>&nbsp;<span class="op" id="4845147">!=</span>&nbsp;<span class="builtinfunc" id="4845150">len</span><span class="op" id="4845153">(</span><span class="ident" id="4845154">other</span><span class="op" id="4845159">)</span>&nbsp;<span class="op" id="4845161">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845165">return</span>&nbsp;<span class="builtintype" id="4845172">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845182">for</span>&nbsp;<span class="ident" id="4845186">i</span>&nbsp;<span class="op" id="4845188">:=</span>&nbsp;<span class="num" id="4845191">0</span><span class="op" id="4845192">;</span>&nbsp;<span class="ident" id="4845194">i</span>&nbsp;<span class="op" id="4845196">&lt;</span>&nbsp;<span class="builtinfunc" id="4845198">len</span><span class="op" id="4845201">(</span><span class="ident" id="4845202">oi</span><span class="op" id="4845204">)</span><span class="op" id="4845205">;</span>&nbsp;<span class="ident" id="4845207">i</span><span class="op" id="4845208">++</span>&nbsp;<span class="op" id="4845211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845215">if</span>&nbsp;<span class="ident" id="4845218">oi</span><span class="op" id="4845220">[</span><span class="ident" id="4845221">i</span><span class="op" id="4845222">]</span>&nbsp;<span class="op" id="4845224">!=</span>&nbsp;<span class="ident" id="4845227">other</span><span class="op" id="4845232">[</span><span class="ident" id="4845233">i</span><span class="op" id="4845234">]</span>&nbsp;<span class="op" id="4845236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845241">return</span>&nbsp;<span class="builtintype" id="4845248">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845263">return</span>&nbsp;<span class="builtintype" id="4845270">true</span><br>
<span class="lineno"></span><span class="op" id="4845275">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4845278">func</span>&nbsp;<span class="op" id="4845283">(</span><span class="ident" id="4845284">oi</span>&nbsp;<span class="ident" id="4845287">ObjectIdentifier</span><span class="op" id="4845303">)</span>&nbsp;<span class="ident" id="4845305">String</span><span class="op" id="4845311">(</span><span class="op" id="4845312">)</span>&nbsp;<span class="builtintype" id="4845314">string</span>&nbsp;<span class="op" id="4845321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845324">var</span>&nbsp;<span class="ident" id="4845328">s</span>&nbsp;<span class="builtintype" id="4845330">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845339">for</span>&nbsp;<span class="ident" id="4845343">i</span><span class="op" id="4845344">,</span>&nbsp;<span class="ident" id="4845346">v</span>&nbsp;<span class="op" id="4845348">:=</span>&nbsp;<span class="keyword" id="4845351">range</span>&nbsp;<span class="ident" id="4845357">oi</span>&nbsp;<span class="op" id="4845360">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845364">if</span>&nbsp;<span class="ident" id="4845367">i</span>&nbsp;<span class="op" id="4845369">&gt;</span>&nbsp;<span class="num" id="4845371">0</span>&nbsp;<span class="op" id="4845373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845378">s</span>&nbsp;<span class="op" id="4845380">+=</span>&nbsp;<span class="string" id="4845383">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845393">s</span>&nbsp;<span class="op" id="4845395">+=</span>&nbsp;<span class="ident" id="4845398">strconv</span><span class="op" id="4845405">.</span><span class="ident" id="4845406">Itoa</span><span class="op" id="4845410">(</span><span class="ident" id="4845411">v</span><span class="op" id="4845412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845415">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845419">return</span>&nbsp;<span class="ident" id="4845426">s</span><br>
<span class="lineno"></span><span class="op" id="4845428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4845431">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4845509">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4845587">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4845624">func</span>&nbsp;<span class="ident" id="4845629">parseObjectIdentifier</span><span class="op" id="4845650">(</span><span class="ident" id="4845651">bytes</span>&nbsp;<span class="op" id="4845657">[</span><span class="op" id="4845658">]</span><span class="builtintype" id="4845659">byte</span><span class="op" id="4845663">)</span>&nbsp;<span class="op" id="4845665">(</span><span class="ident" id="4845666">s</span>&nbsp;<span class="op" id="4845668">[</span><span class="op" id="4845669">]</span><span class="builtintype" id="4845670">int</span><span class="op" id="4845673">,</span>&nbsp;<span class="ident" id="4845675">err</span>&nbsp;<span class="builtintype" id="4845679">error</span><span class="op" id="4845684">)</span>&nbsp;<span class="op" id="4845686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845689">if</span>&nbsp;<span class="builtinfunc" id="4845692">len</span><span class="op" id="4845695">(</span><span class="ident" id="4845696">bytes</span><span class="op" id="4845701">)</span>&nbsp;<span class="op" id="4845703">==</span>&nbsp;<span class="num" id="4845706">0</span>&nbsp;<span class="op" id="4845708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845712">err</span>&nbsp;<span class="op" id="4845716">=</span>&nbsp;<span class="ident" id="4845718">SyntaxError</span><span class="op" id="4845729">{</span><span class="string" id="4845730">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4845761">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845765">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845777">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845850">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845920">s</span>&nbsp;<span class="op" id="4845922">=</span>&nbsp;<span class="builtinfunc" id="4845924">make</span><span class="op" id="4845928">(</span><span class="op" id="4845929">[</span><span class="op" id="4845930">]</span><span class="builtintype" id="4845931">int</span><span class="op" id="4845934">,</span>&nbsp;<span class="builtinfunc" id="4845936">len</span><span class="op" id="4845939">(</span><span class="ident" id="4845940">bytes</span><span class="op" id="4845945">)</span><span class="op" id="4845946">+</span><span class="num" id="4845947">1</span><span class="op" id="4845948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845952">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845996">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4846071">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4846145">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846191">v</span><span class="op" id="4846192">,</span>&nbsp;<span class="ident" id="4846194">offset</span><span class="op" id="4846200">,</span>&nbsp;<span class="ident" id="4846202">err</span>&nbsp;<span class="op" id="4846206">:=</span>&nbsp;<span class="ident" id="4846209">parseBase128Int</span><span class="op" id="4846224">(</span><span class="ident" id="4846225">bytes</span><span class="op" id="4846230">,</span>&nbsp;<span class="num" id="4846232">0</span><span class="op" id="4846233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846236">if</span>&nbsp;<span class="ident" id="4846239">err</span>&nbsp;<span class="op" id="4846243">!=</span>&nbsp;<span class="ident" id="4846246">nil</span>&nbsp;<span class="op" id="4846250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846254">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846262">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846265">if</span>&nbsp;<span class="ident" id="4846268">v</span>&nbsp;<span class="op" id="4846270">&lt;</span>&nbsp;<span class="num" id="4846272">80</span>&nbsp;<span class="op" id="4846275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846279">s</span><span class="op" id="4846280">[</span><span class="num" id="4846281">0</span><span class="op" id="4846282">]</span>&nbsp;<span class="op" id="4846284">=</span>&nbsp;<span class="ident" id="4846286">v</span>&nbsp;<span class="op" id="4846288">/</span>&nbsp;<span class="num" id="4846290">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846295">s</span><span class="op" id="4846296">[</span><span class="num" id="4846297">1</span><span class="op" id="4846298">]</span>&nbsp;<span class="op" id="4846300">=</span>&nbsp;<span class="ident" id="4846302">v</span>&nbsp;<span class="op" id="4846304">%</span>&nbsp;<span class="num" id="4846306">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846310">}</span>&nbsp;<span class="keyword" id="4846312">else</span>&nbsp;<span class="op" id="4846317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846321">s</span><span class="op" id="4846322">[</span><span class="num" id="4846323">0</span><span class="op" id="4846324">]</span>&nbsp;<span class="op" id="4846326">=</span>&nbsp;<span class="num" id="4846328">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846332">s</span><span class="op" id="4846333">[</span><span class="num" id="4846334">1</span><span class="op" id="4846335">]</span>&nbsp;<span class="op" id="4846337">=</span>&nbsp;<span class="ident" id="4846339">v</span>&nbsp;<span class="op" id="4846341">-</span>&nbsp;<span class="num" id="4846343">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846351">i</span>&nbsp;<span class="op" id="4846353">:=</span>&nbsp;<span class="num" id="4846356">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846359">for</span>&nbsp;<span class="op" id="4846363">;</span>&nbsp;<span class="ident" id="4846365">offset</span>&nbsp;<span class="op" id="4846372">&lt;</span>&nbsp;<span class="builtinfunc" id="4846374">len</span><span class="op" id="4846377">(</span><span class="ident" id="4846378">bytes</span><span class="op" id="4846383">)</span><span class="op" id="4846384">;</span>&nbsp;<span class="ident" id="4846386">i</span><span class="op" id="4846387">++</span>&nbsp;<span class="op" id="4846390">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846394">v</span><span class="op" id="4846395">,</span>&nbsp;<span class="ident" id="4846397">offset</span><span class="op" id="4846403">,</span>&nbsp;<span class="ident" id="4846405">err</span>&nbsp;<span class="op" id="4846409">=</span>&nbsp;<span class="ident" id="4846411">parseBase128Int</span><span class="op" id="4846426">(</span><span class="ident" id="4846427">bytes</span><span class="op" id="4846432">,</span>&nbsp;<span class="ident" id="4846434">offset</span><span class="op" id="4846440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846444">if</span>&nbsp;<span class="ident" id="4846447">err</span>&nbsp;<span class="op" id="4846451">!=</span>&nbsp;<span class="ident" id="4846454">nil</span>&nbsp;<span class="op" id="4846458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846463">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846476">s</span><span class="op" id="4846477">[</span><span class="ident" id="4846478">i</span><span class="op" id="4846479">]</span>&nbsp;<span class="op" id="4846481">=</span>&nbsp;<span class="ident" id="4846483">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846489">s</span>&nbsp;<span class="op" id="4846491">=</span>&nbsp;<span class="ident" id="4846493">s</span><span class="op" id="4846494">[</span><span class="num" id="4846495">0</span><span class="op" id="4846496">:</span><span class="ident" id="4846497">i</span><span class="op" id="4846498">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846501">return</span><br>
<span class="lineno"></span><span class="op" id="4846508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4846511">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4846526">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4846574">type</span>&nbsp;<span class="ident" id="4846579">Enumerated</span>&nbsp;<span class="builtintype" id="4846590">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4846595">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4846604">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4846662">type</span>&nbsp;<span class="ident" id="4846667">Flag</span>&nbsp;<span class="builtintype" id="4846672">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4846678">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4846756">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4846818">func</span>&nbsp;<span class="ident" id="4846823">parseBase128Int</span><span class="op" id="4846838">(</span><span class="ident" id="4846839">bytes</span>&nbsp;<span class="op" id="4846845">[</span><span class="op" id="4846846">]</span><span class="builtintype" id="4846847">byte</span><span class="op" id="4846851">,</span>&nbsp;<span class="ident" id="4846853">initOffset</span>&nbsp;<span class="builtintype" id="4846864">int</span><span class="op" id="4846867">)</span>&nbsp;<span class="op" id="4846869">(</span><span class="ident" id="4846870">ret</span><span class="op" id="4846873">,</span>&nbsp;<span class="ident" id="4846875">offset</span>&nbsp;<span class="builtintype" id="4846882">int</span><span class="op" id="4846885">,</span>&nbsp;<span class="ident" id="4846887">err</span>&nbsp;<span class="builtintype" id="4846891">error</span><span class="op" id="4846896">)</span>&nbsp;<span class="op" id="4846898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846901">offset</span>&nbsp;<span class="op" id="4846908">=</span>&nbsp;<span class="ident" id="4846910">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846922">for</span>&nbsp;<span class="ident" id="4846926">shifted</span>&nbsp;<span class="op" id="4846934">:=</span>&nbsp;<span class="num" id="4846937">0</span><span class="op" id="4846938">;</span>&nbsp;<span class="ident" id="4846940">offset</span>&nbsp;<span class="op" id="4846947">&lt;</span>&nbsp;<span class="builtinfunc" id="4846949">len</span><span class="op" id="4846952">(</span><span class="ident" id="4846953">bytes</span><span class="op" id="4846958">)</span><span class="op" id="4846959">;</span>&nbsp;<span class="ident" id="4846961">shifted</span><span class="op" id="4846968">++</span>&nbsp;<span class="op" id="4846971">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846975">if</span>&nbsp;<span class="ident" id="4846978">shifted</span>&nbsp;<span class="op" id="4846986">&gt;</span>&nbsp;<span class="num" id="4846988">4</span>&nbsp;<span class="op" id="4846990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846995">err</span>&nbsp;<span class="op" id="4846999">=</span>&nbsp;<span class="ident" id="4847001">StructuralError</span><span class="op" id="4847016">{</span><span class="string" id="4847017">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4847045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847050">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847063">ret</span>&nbsp;<span class="op" id="4847067">&lt;&lt;=</span>&nbsp;<span class="num" id="4847071">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847075">b</span>&nbsp;<span class="op" id="4847077">:=</span>&nbsp;<span class="ident" id="4847080">bytes</span><span class="op" id="4847085">[</span><span class="ident" id="4847086">offset</span><span class="op" id="4847092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847096">ret</span>&nbsp;<span class="op" id="4847100">|=</span>&nbsp;<span class="builtintype" id="4847103">int</span><span class="op" id="4847106">(</span><span class="ident" id="4847107">b</span>&nbsp;<span class="op" id="4847109">&amp;</span>&nbsp;<span class="num" id="4847111">0x7f</span><span class="op" id="4847115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847119">offset</span><span class="op" id="4847125">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847130">if</span>&nbsp;<span class="ident" id="4847133">b</span><span class="op" id="4847134">&amp;</span><span class="num" id="4847135">0x80</span>&nbsp;<span class="op" id="4847140">==</span>&nbsp;<span class="num" id="4847143">0</span>&nbsp;<span class="op" id="4847145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847150">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847165">err</span>&nbsp;<span class="op" id="4847169">=</span>&nbsp;<span class="ident" id="4847171">SyntaxError</span><span class="op" id="4847182">{</span><span class="string" id="4847183">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4847211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847214">return</span><br>
<span class="lineno"></span><span class="op" id="4847221">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4847224">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4847236">func</span>&nbsp;<span class="ident" id="4847241">parseUTCTime</span><span class="op" id="4847253">(</span><span class="ident" id="4847254">bytes</span>&nbsp;<span class="op" id="4847260">[</span><span class="op" id="4847261">]</span><span class="builtintype" id="4847262">byte</span><span class="op" id="4847266">)</span>&nbsp;<span class="op" id="4847268">(</span><span class="ident" id="4847269">ret</span>&nbsp;<span class="ident" id="4847273">time</span><span class="op" id="4847277">.</span><span class="ident" id="4847278">Time</span><span class="op" id="4847282">,</span>&nbsp;<span class="ident" id="4847284">err</span>&nbsp;<span class="builtintype" id="4847288">error</span><span class="op" id="4847293">)</span>&nbsp;<span class="op" id="4847295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847298">s</span>&nbsp;<span class="op" id="4847300">:=</span>&nbsp;<span class="builtintype" id="4847303">string</span><span class="op" id="4847309">(</span><span class="ident" id="4847310">bytes</span><span class="op" id="4847315">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847318">ret</span><span class="op" id="4847321">,</span>&nbsp;<span class="ident" id="4847323">err</span>&nbsp;<span class="op" id="4847327">=</span>&nbsp;<span class="ident" id="4847329">time</span><span class="op" id="4847333">.</span><span class="ident" id="4847334">Parse</span><span class="op" id="4847339">(</span><span class="string" id="4847340">&#34;0601021504Z0700&#34;</span><span class="op" id="4847357">,</span>&nbsp;<span class="ident" id="4847359">s</span><span class="op" id="4847360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847363">if</span>&nbsp;<span class="ident" id="4847366">err</span>&nbsp;<span class="op" id="4847370">!=</span>&nbsp;<span class="ident" id="4847373">nil</span>&nbsp;<span class="op" id="4847377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847381">ret</span><span class="op" id="4847384">,</span>&nbsp;<span class="ident" id="4847386">err</span>&nbsp;<span class="op" id="4847390">=</span>&nbsp;<span class="ident" id="4847392">time</span><span class="op" id="4847396">.</span><span class="ident" id="4847397">Parse</span><span class="op" id="4847402">(</span><span class="string" id="4847403">&#34;060102150405Z0700&#34;</span><span class="op" id="4847422">,</span>&nbsp;<span class="ident" id="4847424">s</span><span class="op" id="4847425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847431">if</span>&nbsp;<span class="ident" id="4847434">err</span>&nbsp;<span class="op" id="4847438">==</span>&nbsp;<span class="ident" id="4847441">nil</span>&nbsp;<span class="op" id="4847445">&amp;&amp;</span>&nbsp;<span class="ident" id="4847448">ret</span><span class="op" id="4847451">.</span><span class="ident" id="4847452">Year</span><span class="op" id="4847456">(</span><span class="op" id="4847457">)</span>&nbsp;<span class="op" id="4847459">&gt;=</span>&nbsp;<span class="num" id="4847462">2050</span>&nbsp;<span class="op" id="4847467">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4847471">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847576">ret</span>&nbsp;<span class="op" id="4847580">=</span>&nbsp;<span class="ident" id="4847582">ret</span><span class="op" id="4847585">.</span><span class="ident" id="4847586">AddDate</span><span class="op" id="4847593">(</span><span class="op" id="4847594">-</span><span class="num" id="4847595">100</span><span class="op" id="4847598">,</span>&nbsp;<span class="num" id="4847600">0</span><span class="op" id="4847601">,</span>&nbsp;<span class="num" id="4847603">0</span><span class="op" id="4847604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847611">return</span><br>
<span class="lineno">300</span><span class="op" id="4847618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4847621">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4847698">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4847733">func</span>&nbsp;<span class="ident" id="4847738">parseGeneralizedTime</span><span class="op" id="4847758">(</span><span class="ident" id="4847759">bytes</span>&nbsp;<span class="op" id="4847765">[</span><span class="op" id="4847766">]</span><span class="builtintype" id="4847767">byte</span><span class="op" id="4847771">)</span>&nbsp;<span class="op" id="4847773">(</span><span class="ident" id="4847774">ret</span>&nbsp;<span class="ident" id="4847778">time</span><span class="op" id="4847782">.</span><span class="ident" id="4847783">Time</span><span class="op" id="4847787">,</span>&nbsp;<span class="ident" id="4847789">err</span>&nbsp;<span class="builtintype" id="4847793">error</span><span class="op" id="4847798">)</span>&nbsp;<span class="op" id="4847800">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847803">return</span>&nbsp;<span class="ident" id="4847810">time</span><span class="op" id="4847814">.</span><span class="ident" id="4847815">Parse</span><span class="op" id="4847820">(</span><span class="string" id="4847821">&#34;20060102150405Z0700&#34;</span><span class="op" id="4847842">,</span>&nbsp;<span class="builtintype" id="4847844">string</span><span class="op" id="4847850">(</span><span class="ident" id="4847851">bytes</span><span class="op" id="4847856">)</span><span class="op" id="4847857">)</span><br>
<span class="lineno"></span><span class="op" id="4847859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4847862">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4847882">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4847957">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4847982">func</span>&nbsp;<span class="ident" id="4847987">parsePrintableString</span><span class="op" id="4848007">(</span><span class="ident" id="4848008">bytes</span>&nbsp;<span class="op" id="4848014">[</span><span class="op" id="4848015">]</span><span class="builtintype" id="4848016">byte</span><span class="op" id="4848020">)</span>&nbsp;<span class="op" id="4848022">(</span><span class="ident" id="4848023">ret</span>&nbsp;<span class="builtintype" id="4848027">string</span><span class="op" id="4848033">,</span>&nbsp;<span class="ident" id="4848035">err</span>&nbsp;<span class="builtintype" id="4848039">error</span><span class="op" id="4848044">)</span>&nbsp;<span class="op" id="4848046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848049">for</span>&nbsp;<span class="ident" id="4848053">_</span><span class="op" id="4848054">,</span>&nbsp;<span class="ident" id="4848056">b</span>&nbsp;<span class="op" id="4848058">:=</span>&nbsp;<span class="keyword" id="4848061">range</span>&nbsp;<span class="ident" id="4848067">bytes</span>&nbsp;<span class="op" id="4848073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848077">if</span>&nbsp;<span class="op" id="4848080">!</span><span class="ident" id="4848081">isPrintable</span><span class="op" id="4848092">(</span><span class="ident" id="4848093">b</span><span class="op" id="4848094">)</span>&nbsp;<span class="op" id="4848096">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848101">err</span>&nbsp;<span class="op" id="4848105">=</span>&nbsp;<span class="ident" id="4848107">SyntaxError</span><span class="op" id="4848118">{</span><span class="string" id="4848119">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4848163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848168">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848183">ret</span>&nbsp;<span class="op" id="4848187">=</span>&nbsp;<span class="builtintype" id="4848189">string</span><span class="op" id="4848195">(</span><span class="ident" id="4848196">bytes</span><span class="op" id="4848201">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848204">return</span><br>
<span class="lineno"></span><span class="op" id="4848211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4848214">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4848295">func</span>&nbsp;<span class="ident" id="4848300">isPrintable</span><span class="op" id="4848311">(</span><span class="ident" id="4848312">b</span>&nbsp;<span class="builtintype" id="4848314">byte</span><span class="op" id="4848318">)</span>&nbsp;<span class="builtintype" id="4848320">bool</span>&nbsp;<span class="op" id="4848325">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848328">return</span>&nbsp;<span class="string" id="4848335">&#39;a&#39;</span>&nbsp;<span class="op" id="4848339">&lt;=</span>&nbsp;<span class="ident" id="4848342">b</span>&nbsp;<span class="op" id="4848344">&amp;&amp;</span>&nbsp;<span class="ident" id="4848347">b</span>&nbsp;<span class="op" id="4848349">&lt;=</span>&nbsp;<span class="string" id="4848352">&#39;z&#39;</span>&nbsp;<span class="op" id="4848356">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848361">&#39;A&#39;</span>&nbsp;<span class="op" id="4848365">&lt;=</span>&nbsp;<span class="ident" id="4848368">b</span>&nbsp;<span class="op" id="4848370">&amp;&amp;</span>&nbsp;<span class="ident" id="4848373">b</span>&nbsp;<span class="op" id="4848375">&lt;=</span>&nbsp;<span class="string" id="4848378">&#39;Z&#39;</span>&nbsp;<span class="op" id="4848382">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848387">&#39;0&#39;</span>&nbsp;<span class="op" id="4848391">&lt;=</span>&nbsp;<span class="ident" id="4848394">b</span>&nbsp;<span class="op" id="4848396">&amp;&amp;</span>&nbsp;<span class="ident" id="4848399">b</span>&nbsp;<span class="op" id="4848401">&lt;=</span>&nbsp;<span class="string" id="4848404">&#39;9&#39;</span>&nbsp;<span class="op" id="4848408">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848413">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4848418">&lt;=</span>&nbsp;<span class="ident" id="4848421">b</span>&nbsp;<span class="op" id="4848423">&amp;&amp;</span>&nbsp;<span class="ident" id="4848426">b</span>&nbsp;<span class="op" id="4848428">&lt;=</span>&nbsp;<span class="string" id="4848431">&#39;)&#39;</span>&nbsp;<span class="op" id="4848435">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4848440">&#39;+&#39;</span>&nbsp;<span class="op" id="4848444">&lt;=</span>&nbsp;<span class="ident" id="4848447">b</span>&nbsp;<span class="op" id="4848449">&amp;&amp;</span>&nbsp;<span class="ident" id="4848452">b</span>&nbsp;<span class="op" id="4848454">&lt;=</span>&nbsp;<span class="string" id="4848457">&#39;/&#39;</span>&nbsp;<span class="op" id="4848461">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848466">b</span>&nbsp;<span class="op" id="4848468">==</span>&nbsp;<span class="string" id="4848471">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4848475">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848480">b</span>&nbsp;<span class="op" id="4848482">==</span>&nbsp;<span class="string" id="4848485">&#39;:&#39;</span>&nbsp;<span class="op" id="4848489">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848494">b</span>&nbsp;<span class="op" id="4848496">==</span>&nbsp;<span class="string" id="4848499">&#39;=&#39;</span>&nbsp;<span class="op" id="4848503">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848508">b</span>&nbsp;<span class="op" id="4848510">==</span>&nbsp;<span class="string" id="4848513">&#39;?&#39;</span>&nbsp;<span class="op" id="4848517">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4848522">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4848581">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4848641">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848698">b</span>&nbsp;<span class="op" id="4848700">==</span>&nbsp;<span class="string" id="4848703">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4848707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4848710">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4848724">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4848797">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4848827">func</span>&nbsp;<span class="ident" id="4848832">parseIA5String</span><span class="op" id="4848846">(</span><span class="ident" id="4848847">bytes</span>&nbsp;<span class="op" id="4848853">[</span><span class="op" id="4848854">]</span><span class="builtintype" id="4848855">byte</span><span class="op" id="4848859">)</span>&nbsp;<span class="op" id="4848861">(</span><span class="ident" id="4848862">ret</span>&nbsp;<span class="builtintype" id="4848866">string</span><span class="op" id="4848872">,</span>&nbsp;<span class="ident" id="4848874">err</span>&nbsp;<span class="builtintype" id="4848878">error</span><span class="op" id="4848883">)</span>&nbsp;<span class="op" id="4848885">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848888">for</span>&nbsp;<span class="ident" id="4848892">_</span><span class="op" id="4848893">,</span>&nbsp;<span class="ident" id="4848895">b</span>&nbsp;<span class="op" id="4848897">:=</span>&nbsp;<span class="keyword" id="4848900">range</span>&nbsp;<span class="ident" id="4848906">bytes</span>&nbsp;<span class="op" id="4848912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848916">if</span>&nbsp;<span class="ident" id="4848919">b</span>&nbsp;<span class="op" id="4848921">&gt;=</span>&nbsp;<span class="num" id="4848924">0x80</span>&nbsp;<span class="op" id="4848929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848934">err</span>&nbsp;<span class="op" id="4848938">=</span>&nbsp;<span class="ident" id="4848940">SyntaxError</span><span class="op" id="4848951">{</span><span class="string" id="4848952">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4848990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848995">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849004">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849010">ret</span>&nbsp;<span class="op" id="4849014">=</span>&nbsp;<span class="builtintype" id="4849016">string</span><span class="op" id="4849022">(</span><span class="ident" id="4849023">bytes</span><span class="op" id="4849028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849031">return</span><br>
<span class="lineno"></span><span class="op" id="4849038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4849041">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849055">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4849134">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4849164">func</span>&nbsp;<span class="ident" id="4849169">parseT61String</span><span class="op" id="4849183">(</span><span class="ident" id="4849184">bytes</span>&nbsp;<span class="op" id="4849190">[</span><span class="op" id="4849191">]</span><span class="builtintype" id="4849192">byte</span><span class="op" id="4849196">)</span>&nbsp;<span class="op" id="4849198">(</span><span class="ident" id="4849199">ret</span>&nbsp;<span class="builtintype" id="4849203">string</span><span class="op" id="4849209">,</span>&nbsp;<span class="ident" id="4849211">err</span>&nbsp;<span class="builtintype" id="4849215">error</span><span class="op" id="4849220">)</span>&nbsp;<span class="op" id="4849222">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849225">return</span>&nbsp;<span class="builtintype" id="4849232">string</span><span class="op" id="4849238">(</span><span class="ident" id="4849239">bytes</span><span class="op" id="4849244">)</span><span class="op" id="4849245">,</span>&nbsp;<span class="ident" id="4849247">nil</span><br>
<span class="lineno"></span><span class="op" id="4849251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849254">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4849269">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4849346">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4849371">func</span>&nbsp;<span class="ident" id="4849376">parseUTF8String</span><span class="op" id="4849391">(</span><span class="ident" id="4849392">bytes</span>&nbsp;<span class="op" id="4849398">[</span><span class="op" id="4849399">]</span><span class="builtintype" id="4849400">byte</span><span class="op" id="4849404">)</span>&nbsp;<span class="op" id="4849406">(</span><span class="ident" id="4849407">ret</span>&nbsp;<span class="builtintype" id="4849411">string</span><span class="op" id="4849417">,</span>&nbsp;<span class="ident" id="4849419">err</span>&nbsp;<span class="builtintype" id="4849423">error</span><span class="op" id="4849428">)</span>&nbsp;<span class="op" id="4849430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849433">return</span>&nbsp;<span class="builtintype" id="4849440">string</span><span class="op" id="4849446">(</span><span class="ident" id="4849447">bytes</span><span class="op" id="4849452">)</span><span class="op" id="4849453">,</span>&nbsp;<span class="ident" id="4849455">nil</span><br>
<span class="lineno"></span><span class="op" id="4849459">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4849462">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4849514">type</span>&nbsp;<span class="ident" id="4849519">RawValue</span>&nbsp;<span class="keyword" id="4849528">struct</span>&nbsp;<span class="op" id="4849535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849538">Class</span><span class="op" id="4849543">,</span>&nbsp;<span class="ident" id="4849545">Tag</span>&nbsp;<span class="builtintype" id="4849549">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849554">IsCompound</span>&nbsp;<span class="builtintype" id="4849565">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849571">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4849582">[</span><span class="op" id="4849583">]</span><span class="builtintype" id="4849584">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849590">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4849601">[</span><span class="op" id="4849602">]</span><span class="builtintype" id="4849603">byte</span>&nbsp;<span class="comment" id="4849608">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4849639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849642">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4849715">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4849793">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4849868">type</span>&nbsp;<span class="ident" id="4849873">RawContent</span>&nbsp;<span class="op" id="4849884">[</span><span class="op" id="4849885">]</span><span class="builtintype" id="4849886">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849892">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4849904">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4849983">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4850060">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4850136">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4850209">func</span>&nbsp;<span class="ident" id="4850214">parseTagAndLength</span><span class="op" id="4850231">(</span><span class="ident" id="4850232">bytes</span>&nbsp;<span class="op" id="4850238">[</span><span class="op" id="4850239">]</span><span class="builtintype" id="4850240">byte</span><span class="op" id="4850244">,</span>&nbsp;<span class="ident" id="4850246">initOffset</span>&nbsp;<span class="builtintype" id="4850257">int</span><span class="op" id="4850260">)</span>&nbsp;<span class="op" id="4850262">(</span><span class="ident" id="4850263">ret</span>&nbsp;<span class="ident" id="4850267">tagAndLength</span><span class="op" id="4850279">,</span>&nbsp;<span class="ident" id="4850281">offset</span>&nbsp;<span class="builtintype" id="4850288">int</span><span class="op" id="4850291">,</span>&nbsp;<span class="ident" id="4850293">err</span>&nbsp;<span class="builtintype" id="4850297">error</span><span class="op" id="4850302">)</span>&nbsp;<span class="op" id="4850304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850307">offset</span>&nbsp;<span class="op" id="4850314">=</span>&nbsp;<span class="ident" id="4850316">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850328">b</span>&nbsp;<span class="op" id="4850330">:=</span>&nbsp;<span class="ident" id="4850333">bytes</span><span class="op" id="4850338">[</span><span class="ident" id="4850339">offset</span><span class="op" id="4850345">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850348">offset</span><span class="op" id="4850354">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850358">ret</span><span class="op" id="4850361">.</span><span class="ident" id="4850362">class</span>&nbsp;<span class="op" id="4850368">=</span>&nbsp;<span class="builtintype" id="4850370">int</span><span class="op" id="4850373">(</span><span class="ident" id="4850374">b</span>&nbsp;<span class="op" id="4850376">&gt;&gt;</span>&nbsp;<span class="num" id="4850379">6</span><span class="op" id="4850380">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850383">ret</span><span class="op" id="4850386">.</span><span class="ident" id="4850387">isCompound</span>&nbsp;<span class="op" id="4850398">=</span>&nbsp;<span class="ident" id="4850400">b</span><span class="op" id="4850401">&amp;</span><span class="num" id="4850402">0x20</span>&nbsp;<span class="op" id="4850407">==</span>&nbsp;<span class="num" id="4850410">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850416">ret</span><span class="op" id="4850419">.</span><span class="ident" id="4850420">tag</span>&nbsp;<span class="op" id="4850424">=</span>&nbsp;<span class="builtintype" id="4850426">int</span><span class="op" id="4850429">(</span><span class="ident" id="4850430">b</span>&nbsp;<span class="op" id="4850432">&amp;</span>&nbsp;<span class="num" id="4850434">0x1f</span><span class="op" id="4850438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4850442">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4850520">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850543">if</span>&nbsp;<span class="ident" id="4850546">ret</span><span class="op" id="4850549">.</span><span class="ident" id="4850550">tag</span>&nbsp;<span class="op" id="4850554">==</span>&nbsp;<span class="num" id="4850557">0x1f</span>&nbsp;<span class="op" id="4850562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850566">ret</span><span class="op" id="4850569">.</span><span class="ident" id="4850570">tag</span><span class="op" id="4850573">,</span>&nbsp;<span class="ident" id="4850575">offset</span><span class="op" id="4850581">,</span>&nbsp;<span class="ident" id="4850583">err</span>&nbsp;<span class="op" id="4850587">=</span>&nbsp;<span class="ident" id="4850589">parseBase128Int</span><span class="op" id="4850604">(</span><span class="ident" id="4850605">bytes</span><span class="op" id="4850610">,</span>&nbsp;<span class="ident" id="4850612">offset</span><span class="op" id="4850618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850622">if</span>&nbsp;<span class="ident" id="4850625">err</span>&nbsp;<span class="op" id="4850629">!=</span>&nbsp;<span class="ident" id="4850632">nil</span>&nbsp;<span class="op" id="4850636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850641">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850650">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850656">if</span>&nbsp;<span class="ident" id="4850659">offset</span>&nbsp;<span class="op" id="4850666">&gt;=</span>&nbsp;<span class="builtinfunc" id="4850669">len</span><span class="op" id="4850672">(</span><span class="ident" id="4850673">bytes</span><span class="op" id="4850678">)</span>&nbsp;<span class="op" id="4850680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850684">err</span>&nbsp;<span class="op" id="4850688">=</span>&nbsp;<span class="ident" id="4850690">SyntaxError</span><span class="op" id="4850701">{</span><span class="string" id="4850702">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4850727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850731">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850739">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850742">b</span>&nbsp;<span class="op" id="4850744">=</span>&nbsp;<span class="ident" id="4850746">bytes</span><span class="op" id="4850751">[</span><span class="ident" id="4850752">offset</span><span class="op" id="4850758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850761">offset</span><span class="op" id="4850767">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850771">if</span>&nbsp;<span class="ident" id="4850774">b</span><span class="op" id="4850775">&amp;</span><span class="num" id="4850776">0x80</span>&nbsp;<span class="op" id="4850781">==</span>&nbsp;<span class="num" id="4850784">0</span>&nbsp;<span class="op" id="4850786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4850790">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850839">ret</span><span class="op" id="4850842">.</span><span class="ident" id="4850843">length</span>&nbsp;<span class="op" id="4850850">=</span>&nbsp;<span class="builtintype" id="4850852">int</span><span class="op" id="4850855">(</span><span class="ident" id="4850856">b</span>&nbsp;<span class="op" id="4850858">&amp;</span>&nbsp;<span class="num" id="4850860">0x7f</span><span class="op" id="4850864">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850867">}</span>&nbsp;<span class="keyword" id="4850869">else</span>&nbsp;<span class="op" id="4850874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4850878">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850940">numBytes</span>&nbsp;<span class="op" id="4850949">:=</span>&nbsp;<span class="builtintype" id="4850952">int</span><span class="op" id="4850955">(</span><span class="ident" id="4850956">b</span>&nbsp;<span class="op" id="4850958">&amp;</span>&nbsp;<span class="num" id="4850960">0x7f</span><span class="op" id="4850964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850968">if</span>&nbsp;<span class="ident" id="4850971">numBytes</span>&nbsp;<span class="op" id="4850980">==</span>&nbsp;<span class="num" id="4850983">0</span>&nbsp;<span class="op" id="4850985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850990">err</span>&nbsp;<span class="op" id="4850994">=</span>&nbsp;<span class="ident" id="4850996">SyntaxError</span><span class="op" id="4851007">{</span><span class="string" id="4851008">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4851043">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851048">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851061">ret</span><span class="op" id="4851064">.</span><span class="ident" id="4851065">length</span>&nbsp;<span class="op" id="4851072">=</span>&nbsp;<span class="num" id="4851074">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851078">for</span>&nbsp;<span class="ident" id="4851082">i</span>&nbsp;<span class="op" id="4851084">:=</span>&nbsp;<span class="num" id="4851087">0</span><span class="op" id="4851088">;</span>&nbsp;<span class="ident" id="4851090">i</span>&nbsp;<span class="op" id="4851092">&lt;</span>&nbsp;<span class="ident" id="4851094">numBytes</span><span class="op" id="4851102">;</span>&nbsp;<span class="ident" id="4851104">i</span><span class="op" id="4851105">++</span>&nbsp;<span class="op" id="4851108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851113">if</span>&nbsp;<span class="ident" id="4851116">offset</span>&nbsp;<span class="op" id="4851123">&gt;=</span>&nbsp;<span class="builtinfunc" id="4851126">len</span><span class="op" id="4851129">(</span><span class="ident" id="4851130">bytes</span><span class="op" id="4851135">)</span>&nbsp;<span class="op" id="4851137">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851143">err</span>&nbsp;<span class="op" id="4851147">=</span>&nbsp;<span class="ident" id="4851149">SyntaxError</span><span class="op" id="4851160">{</span><span class="string" id="4851161">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4851186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851192">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851207">b</span>&nbsp;<span class="op" id="4851209">=</span>&nbsp;<span class="ident" id="4851211">bytes</span><span class="op" id="4851216">[</span><span class="ident" id="4851217">offset</span><span class="op" id="4851223">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851228">offset</span><span class="op" id="4851234">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851240">if</span>&nbsp;<span class="ident" id="4851243">ret</span><span class="op" id="4851246">.</span><span class="ident" id="4851247">length</span>&nbsp;<span class="op" id="4851254">&gt;=</span>&nbsp;<span class="num" id="4851257">1</span><span class="op" id="4851258">&lt;&lt;</span><span class="num" id="4851260">23</span>&nbsp;<span class="op" id="4851263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851269">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851313">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851333">err</span>&nbsp;<span class="op" id="4851337">=</span>&nbsp;<span class="ident" id="4851339">StructuralError</span><span class="op" id="4851354">{</span><span class="string" id="4851355">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4851373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851379">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851394">ret</span><span class="op" id="4851397">.</span><span class="ident" id="4851398">length</span>&nbsp;<span class="op" id="4851405">&lt;&lt;=</span>&nbsp;<span class="num" id="4851409">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851414">ret</span><span class="op" id="4851417">.</span><span class="ident" id="4851418">length</span>&nbsp;<span class="op" id="4851425">|=</span>&nbsp;<span class="builtintype" id="4851428">int</span><span class="op" id="4851431">(</span><span class="ident" id="4851432">b</span><span class="op" id="4851433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851438">if</span>&nbsp;<span class="ident" id="4851441">ret</span><span class="op" id="4851444">.</span><span class="ident" id="4851445">length</span>&nbsp;<span class="op" id="4851452">==</span>&nbsp;<span class="num" id="4851455">0</span>&nbsp;<span class="op" id="4851457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4851463">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851508">err</span>&nbsp;<span class="op" id="4851512">=</span>&nbsp;<span class="ident" id="4851514">StructuralError</span><span class="op" id="4851529">{</span><span class="string" id="4851530">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4851567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851573">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851590">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851594">return</span><br>
<span class="lineno"></span><span class="op" id="4851601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4851604">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4851684">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4851760">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4851801">func</span>&nbsp;<span class="ident" id="4851806">parseSequenceOf</span><span class="op" id="4851821">(</span><span class="ident" id="4851822">bytes</span>&nbsp;<span class="op" id="4851828">[</span><span class="op" id="4851829">]</span><span class="builtintype" id="4851830">byte</span><span class="op" id="4851834">,</span>&nbsp;<span class="ident" id="4851836">sliceType</span>&nbsp;<span class="ident" id="4851846">reflect</span><span class="op" id="4851853">.</span><span class="ident" id="4851854">Type</span><span class="op" id="4851858">,</span>&nbsp;<span class="ident" id="4851860">elemType</span>&nbsp;<span class="ident" id="4851869">reflect</span><span class="op" id="4851876">.</span><span class="ident" id="4851877">Type</span><span class="op" id="4851881">)</span>&nbsp;<span class="op" id="4851883">(</span><span class="ident" id="4851884">ret</span>&nbsp;<span class="ident" id="4851888">reflect</span><span class="op" id="4851895">.</span><span class="ident" id="4851896">Value</span><span class="op" id="4851901">,</span>&nbsp;<span class="ident" id="4851903">err</span>&nbsp;<span class="builtintype" id="4851907">error</span><span class="op" id="4851912">)</span>&nbsp;<span class="op" id="4851914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851917">expectedTag</span><span class="op" id="4851928">,</span>&nbsp;<span class="ident" id="4851930">compoundType</span><span class="op" id="4851942">,</span>&nbsp;<span class="ident" id="4851944">ok</span>&nbsp;<span class="op" id="4851947">:=</span>&nbsp;<span class="ident" id="4851950">getUniversalType</span><span class="op" id="4851966">(</span><span class="ident" id="4851967">elemType</span><span class="op" id="4851975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851978">if</span>&nbsp;<span class="op" id="4851981">!</span><span class="ident" id="4851982">ok</span>&nbsp;<span class="op" id="4851985">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851989">err</span>&nbsp;<span class="op" id="4851993">=</span>&nbsp;<span class="ident" id="4851995">StructuralError</span><span class="op" id="4852010">{</span><span class="string" id="4852011">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4852038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852042">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4852054">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4852124">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852178">numElements</span>&nbsp;<span class="op" id="4852190">:=</span>&nbsp;<span class="num" id="4852193">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852196">for</span>&nbsp;<span class="ident" id="4852200">offset</span>&nbsp;<span class="op" id="4852207">:=</span>&nbsp;<span class="num" id="4852210">0</span><span class="op" id="4852211">;</span>&nbsp;<span class="ident" id="4852213">offset</span>&nbsp;<span class="op" id="4852220">&lt;</span>&nbsp;<span class="builtinfunc" id="4852222">len</span><span class="op" id="4852225">(</span><span class="ident" id="4852226">bytes</span><span class="op" id="4852231">)</span><span class="op" id="4852232">;</span>&nbsp;<span class="op" id="4852234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852238">var</span>&nbsp;<span class="ident" id="4852242">t</span>&nbsp;<span class="ident" id="4852244">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852259">t</span><span class="op" id="4852260">,</span>&nbsp;<span class="ident" id="4852262">offset</span><span class="op" id="4852268">,</span>&nbsp;<span class="ident" id="4852270">err</span>&nbsp;<span class="op" id="4852274">=</span>&nbsp;<span class="ident" id="4852276">parseTagAndLength</span><span class="op" id="4852293">(</span><span class="ident" id="4852294">bytes</span><span class="op" id="4852299">,</span>&nbsp;<span class="ident" id="4852301">offset</span><span class="op" id="4852307">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852311">if</span>&nbsp;<span class="ident" id="4852314">err</span>&nbsp;<span class="op" id="4852318">!=</span>&nbsp;<span class="ident" id="4852321">nil</span>&nbsp;<span class="op" id="4852325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852330">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852343">switch</span>&nbsp;<span class="ident" id="4852350">t</span><span class="op" id="4852351">.</span><span class="ident" id="4852352">tag</span>&nbsp;<span class="op" id="4852356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852360">case</span>&nbsp;<span class="ident" id="4852365">tagIA5String</span><span class="op" id="4852377">,</span>&nbsp;<span class="ident" id="4852379">tagGeneralString</span><span class="op" id="4852395">,</span>&nbsp;<span class="ident" id="4852397">tagT61String</span><span class="op" id="4852409">,</span>&nbsp;<span class="ident" id="4852411">tagUTF8String</span><span class="op" id="4852424">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4852429">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4852482">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4852540">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852570">t</span><span class="op" id="4852571">.</span><span class="ident" id="4852572">tag</span>&nbsp;<span class="op" id="4852576">=</span>&nbsp;<span class="ident" id="4852578">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852599">case</span>&nbsp;<span class="ident" id="4852604">tagGeneralizedTime</span><span class="op" id="4852622">,</span>&nbsp;<span class="ident" id="4852624">tagUTCTime</span><span class="op" id="4852634">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4852639">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852693">t</span><span class="op" id="4852694">.</span><span class="ident" id="4852695">tag</span>&nbsp;<span class="op" id="4852699">=</span>&nbsp;<span class="ident" id="4852701">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852719">if</span>&nbsp;<span class="ident" id="4852722">t</span><span class="op" id="4852723">.</span><span class="ident" id="4852724">class</span>&nbsp;<span class="op" id="4852730">!=</span>&nbsp;<span class="ident" id="4852733">classUniversal</span>&nbsp;<span class="op" id="4852748">||</span>&nbsp;<span class="ident" id="4852751">t</span><span class="op" id="4852752">.</span><span class="ident" id="4852753">isCompound</span>&nbsp;<span class="op" id="4852764">!=</span>&nbsp;<span class="ident" id="4852767">compoundType</span>&nbsp;<span class="op" id="4852780">||</span>&nbsp;<span class="ident" id="4852783">t</span><span class="op" id="4852784">.</span><span class="ident" id="4852785">tag</span>&nbsp;<span class="op" id="4852789">!=</span>&nbsp;<span class="ident" id="4852792">expectedTag</span>&nbsp;<span class="op" id="4852804">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852809">err</span>&nbsp;<span class="op" id="4852813">=</span>&nbsp;<span class="ident" id="4852815">StructuralError</span><span class="op" id="4852830">{</span><span class="string" id="4852831">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4852854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852872">if</span>&nbsp;<span class="ident" id="4852875">invalidLength</span><span class="op" id="4852888">(</span><span class="ident" id="4852889">offset</span><span class="op" id="4852895">,</span>&nbsp;<span class="ident" id="4852897">t</span><span class="op" id="4852898">.</span><span class="ident" id="4852899">length</span><span class="op" id="4852905">,</span>&nbsp;<span class="builtinfunc" id="4852907">len</span><span class="op" id="4852910">(</span><span class="ident" id="4852911">bytes</span><span class="op" id="4852916">)</span><span class="op" id="4852917">)</span>&nbsp;<span class="op" id="4852919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852924">err</span>&nbsp;<span class="op" id="4852928">=</span>&nbsp;<span class="ident" id="4852930">SyntaxError</span><span class="op" id="4852941">{</span><span class="string" id="4852942">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4852962">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4852967">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4852976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4852980">offset</span>&nbsp;<span class="op" id="4852987">+=</span>&nbsp;<span class="ident" id="4852990">t</span><span class="op" id="4852991">.</span><span class="ident" id="4852992">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853001">numElements</span><span class="op" id="4853012">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4853016">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853019">ret</span>&nbsp;<span class="op" id="4853023">=</span>&nbsp;<span class="ident" id="4853025">reflect</span><span class="op" id="4853032">.</span><span class="ident" id="4853033">MakeSlice</span><span class="op" id="4853042">(</span><span class="ident" id="4853043">sliceType</span><span class="op" id="4853052">,</span>&nbsp;<span class="ident" id="4853054">numElements</span><span class="op" id="4853065">,</span>&nbsp;<span class="ident" id="4853067">numElements</span><span class="op" id="4853078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853081">params</span>&nbsp;<span class="op" id="4853088">:=</span>&nbsp;<span class="ident" id="4853091">fieldParameters</span><span class="op" id="4853106">{</span><span class="op" id="4853107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853110">offset</span>&nbsp;<span class="op" id="4853117">:=</span>&nbsp;<span class="num" id="4853120">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853123">for</span>&nbsp;<span class="ident" id="4853127">i</span>&nbsp;<span class="op" id="4853129">:=</span>&nbsp;<span class="num" id="4853132">0</span><span class="op" id="4853133">;</span>&nbsp;<span class="ident" id="4853135">i</span>&nbsp;<span class="op" id="4853137">&lt;</span>&nbsp;<span class="ident" id="4853139">numElements</span><span class="op" id="4853150">;</span>&nbsp;<span class="ident" id="4853152">i</span><span class="op" id="4853153">++</span>&nbsp;<span class="op" id="4853156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853160">offset</span><span class="op" id="4853166">,</span>&nbsp;<span class="ident" id="4853168">err</span>&nbsp;<span class="op" id="4853172">=</span>&nbsp;<span class="ident" id="4853174">parseField</span><span class="op" id="4853184">(</span><span class="ident" id="4853185">ret</span><span class="op" id="4853188">.</span><span class="ident" id="4853189">Index</span><span class="op" id="4853194">(</span><span class="ident" id="4853195">i</span><span class="op" id="4853196">)</span><span class="op" id="4853197">,</span>&nbsp;<span class="ident" id="4853199">bytes</span><span class="op" id="4853204">,</span>&nbsp;<span class="ident" id="4853206">offset</span><span class="op" id="4853212">,</span>&nbsp;<span class="ident" id="4853214">params</span><span class="op" id="4853220">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853224">if</span>&nbsp;<span class="ident" id="4853227">err</span>&nbsp;<span class="op" id="4853231">!=</span>&nbsp;<span class="ident" id="4853234">nil</span>&nbsp;<span class="op" id="4853238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4853252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4853255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853258">return</span><br>
<span class="lineno">500</span><span class="op" id="4853265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4853268">var</span>&nbsp;<span class="op" id="4853272">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853275">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853296">=</span>&nbsp;<span class="ident" id="4853298">reflect</span><span class="op" id="4853305">.</span><span class="ident" id="4853306">TypeOf</span><span class="op" id="4853312">(</span><span class="ident" id="4853313">BitString</span><span class="op" id="4853322">{</span><span class="op" id="4853323">}</span><span class="op" id="4853324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853327">objectIdentifierType</span>&nbsp;<span class="op" id="4853348">=</span>&nbsp;<span class="ident" id="4853350">reflect</span><span class="op" id="4853357">.</span><span class="ident" id="4853358">TypeOf</span><span class="op" id="4853364">(</span><span class="ident" id="4853365">ObjectIdentifier</span><span class="op" id="4853381">{</span><span class="op" id="4853382">}</span><span class="op" id="4853383">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853386">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853407">=</span>&nbsp;<span class="ident" id="4853409">reflect</span><span class="op" id="4853416">.</span><span class="ident" id="4853417">TypeOf</span><span class="op" id="4853423">(</span><span class="ident" id="4853424">Enumerated</span><span class="op" id="4853434">(</span><span class="num" id="4853435">0</span><span class="op" id="4853436">)</span><span class="op" id="4853437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853440">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853461">=</span>&nbsp;<span class="ident" id="4853463">reflect</span><span class="op" id="4853470">.</span><span class="ident" id="4853471">TypeOf</span><span class="op" id="4853477">(</span><span class="ident" id="4853478">Flag</span><span class="op" id="4853482">(</span><span class="builtintype" id="4853483">false</span><span class="op" id="4853488">)</span><span class="op" id="4853489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853492">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853513">=</span>&nbsp;<span class="ident" id="4853515">reflect</span><span class="op" id="4853522">.</span><span class="ident" id="4853523">TypeOf</span><span class="op" id="4853529">(</span><span class="ident" id="4853530">time</span><span class="op" id="4853534">.</span><span class="ident" id="4853535">Time</span><span class="op" id="4853539">{</span><span class="op" id="4853540">}</span><span class="op" id="4853541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853544">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853565">=</span>&nbsp;<span class="ident" id="4853567">reflect</span><span class="op" id="4853574">.</span><span class="ident" id="4853575">TypeOf</span><span class="op" id="4853581">(</span><span class="ident" id="4853582">RawValue</span><span class="op" id="4853590">{</span><span class="op" id="4853591">}</span><span class="op" id="4853592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853595">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853616">=</span>&nbsp;<span class="ident" id="4853618">reflect</span><span class="op" id="4853625">.</span><span class="ident" id="4853626">TypeOf</span><span class="op" id="4853632">(</span><span class="ident" id="4853633">RawContent</span><span class="op" id="4853643">(</span><span class="ident" id="4853644">nil</span><span class="op" id="4853647">)</span><span class="op" id="4853648">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4853651">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853672">=</span>&nbsp;<span class="ident" id="4853674">reflect</span><span class="op" id="4853681">.</span><span class="ident" id="4853682">TypeOf</span><span class="op" id="4853688">(</span><span class="builtinfunc" id="4853689">new</span><span class="op" id="4853692">(</span><span class="ident" id="4853693">big</span><span class="op" id="4853696">.</span><span class="ident" id="4853697">Int</span><span class="op" id="4853700">)</span><span class="op" id="4853701">)</span><br>
<span class="lineno"></span><span class="op" id="4853703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4853706">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4853781">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4853809">func</span>&nbsp;<span class="ident" id="4853814">invalidLength</span><span class="op" id="4853827">(</span><span class="ident" id="4853828">offset</span><span class="op" id="4853834">,</span>&nbsp;<span class="ident" id="4853836">length</span><span class="op" id="4853842">,</span>&nbsp;<span class="ident" id="4853844">sliceLength</span>&nbsp;<span class="builtintype" id="4853856">int</span><span class="op" id="4853859">)</span>&nbsp;<span class="builtintype" id="4853861">bool</span>&nbsp;<span class="op" id="4853866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4853869">return</span>&nbsp;<span class="ident" id="4853876">offset</span><span class="op" id="4853882">+</span><span class="ident" id="4853883">length</span>&nbsp;<span class="op" id="4853890">&lt;</span>&nbsp;<span class="ident" id="4853892">offset</span>&nbsp;<span class="op" id="4853899">||</span>&nbsp;<span class="ident" id="4853902">offset</span><span class="op" id="4853908">+</span><span class="ident" id="4853909">length</span>&nbsp;<span class="op" id="4853916">&gt;</span>&nbsp;<span class="ident" id="4853918">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4853930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4853933">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4854010">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4854090">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4854113">func</span>&nbsp;<span class="ident" id="4854118">parseField</span><span class="op" id="4854128">(</span><span class="ident" id="4854129">v</span>&nbsp;<span class="ident" id="4854131">reflect</span><span class="op" id="4854138">.</span><span class="ident" id="4854139">Value</span><span class="op" id="4854144">,</span>&nbsp;<span class="ident" id="4854146">bytes</span>&nbsp;<span class="op" id="4854152">[</span><span class="op" id="4854153">]</span><span class="builtintype" id="4854154">byte</span><span class="op" id="4854158">,</span>&nbsp;<span class="ident" id="4854160">initOffset</span>&nbsp;<span class="builtintype" id="4854171">int</span><span class="op" id="4854174">,</span>&nbsp;<span class="ident" id="4854176">params</span>&nbsp;<span class="ident" id="4854183">fieldParameters</span><span class="op" id="4854198">)</span>&nbsp;<span class="op" id="4854200">(</span><span class="ident" id="4854201">offset</span>&nbsp;<span class="builtintype" id="4854208">int</span><span class="op" id="4854211">,</span>&nbsp;<span class="ident" id="4854213">err</span>&nbsp;<span class="builtintype" id="4854217">error</span><span class="op" id="4854222">)</span>&nbsp;<span class="op" id="4854224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854227">offset</span>&nbsp;<span class="op" id="4854234">=</span>&nbsp;<span class="ident" id="4854236">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854248">fieldType</span>&nbsp;<span class="op" id="4854258">:=</span>&nbsp;<span class="ident" id="4854261">v</span><span class="op" id="4854262">.</span><span class="ident" id="4854263">Type</span><span class="op" id="4854267">(</span><span class="op" id="4854268">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4854272">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854359">if</span>&nbsp;<span class="ident" id="4854362">offset</span>&nbsp;<span class="op" id="4854369">==</span>&nbsp;<span class="builtinfunc" id="4854372">len</span><span class="op" id="4854375">(</span><span class="ident" id="4854376">bytes</span><span class="op" id="4854381">)</span>&nbsp;<span class="op" id="4854383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854387">if</span>&nbsp;<span class="op" id="4854390">!</span><span class="ident" id="4854391">setDefaultValue</span><span class="op" id="4854406">(</span><span class="ident" id="4854407">v</span><span class="op" id="4854408">,</span>&nbsp;<span class="ident" id="4854410">params</span><span class="op" id="4854416">)</span>&nbsp;<span class="op" id="4854418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854423">err</span>&nbsp;<span class="op" id="4854427">=</span>&nbsp;<span class="ident" id="4854429">SyntaxError</span><span class="op" id="4854440">{</span><span class="string" id="4854441">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4854461">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854469">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4854481">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854507">if</span>&nbsp;<span class="ident" id="4854510">fieldType</span>&nbsp;<span class="op" id="4854520">==</span>&nbsp;<span class="ident" id="4854523">rawValueType</span>&nbsp;<span class="op" id="4854536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854540">var</span>&nbsp;<span class="ident" id="4854544">t</span>&nbsp;<span class="ident" id="4854546">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854561">t</span><span class="op" id="4854562">,</span>&nbsp;<span class="ident" id="4854564">offset</span><span class="op" id="4854570">,</span>&nbsp;<span class="ident" id="4854572">err</span>&nbsp;<span class="op" id="4854576">=</span>&nbsp;<span class="ident" id="4854578">parseTagAndLength</span><span class="op" id="4854595">(</span><span class="ident" id="4854596">bytes</span><span class="op" id="4854601">,</span>&nbsp;<span class="ident" id="4854603">offset</span><span class="op" id="4854609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854613">if</span>&nbsp;<span class="ident" id="4854616">err</span>&nbsp;<span class="op" id="4854620">!=</span>&nbsp;<span class="ident" id="4854623">nil</span>&nbsp;<span class="op" id="4854627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854632">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854645">if</span>&nbsp;<span class="ident" id="4854648">invalidLength</span><span class="op" id="4854661">(</span><span class="ident" id="4854662">offset</span><span class="op" id="4854668">,</span>&nbsp;<span class="ident" id="4854670">t</span><span class="op" id="4854671">.</span><span class="ident" id="4854672">length</span><span class="op" id="4854678">,</span>&nbsp;<span class="builtinfunc" id="4854680">len</span><span class="op" id="4854683">(</span><span class="ident" id="4854684">bytes</span><span class="op" id="4854689">)</span><span class="op" id="4854690">)</span>&nbsp;<span class="op" id="4854692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854697">err</span>&nbsp;<span class="op" id="4854701">=</span>&nbsp;<span class="ident" id="4854703">SyntaxError</span><span class="op" id="4854714">{</span><span class="string" id="4854715">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4854731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854745">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854749">result</span>&nbsp;<span class="op" id="4854756">:=</span>&nbsp;<span class="ident" id="4854759">RawValue</span><span class="op" id="4854767">{</span><span class="ident" id="4854768">t</span><span class="op" id="4854769">.</span><span class="ident" id="4854770">class</span><span class="op" id="4854775">,</span>&nbsp;<span class="ident" id="4854777">t</span><span class="op" id="4854778">.</span><span class="ident" id="4854779">tag</span><span class="op" id="4854782">,</span>&nbsp;<span class="ident" id="4854784">t</span><span class="op" id="4854785">.</span><span class="ident" id="4854786">isCompound</span><span class="op" id="4854796">,</span>&nbsp;<span class="ident" id="4854798">bytes</span><span class="op" id="4854803">[</span><span class="ident" id="4854804">offset</span>&nbsp;<span class="op" id="4854811">:</span>&nbsp;<span class="ident" id="4854813">offset</span><span class="op" id="4854819">+</span><span class="ident" id="4854820">t</span><span class="op" id="4854821">.</span><span class="ident" id="4854822">length</span><span class="op" id="4854828">]</span><span class="op" id="4854829">,</span>&nbsp;<span class="ident" id="4854831">bytes</span><span class="op" id="4854836">[</span><span class="ident" id="4854837">initOffset</span>&nbsp;<span class="op" id="4854848">:</span>&nbsp;<span class="ident" id="4854850">offset</span><span class="op" id="4854856">+</span><span class="ident" id="4854857">t</span><span class="op" id="4854858">.</span><span class="ident" id="4854859">length</span><span class="op" id="4854865">]</span><span class="op" id="4854866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854870">offset</span>&nbsp;<span class="op" id="4854877">+=</span>&nbsp;<span class="ident" id="4854880">t</span><span class="op" id="4854881">.</span><span class="ident" id="4854882">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4854891">v</span><span class="op" id="4854892">.</span><span class="ident" id="4854893">Set</span><span class="op" id="4854896">(</span><span class="ident" id="4854897">reflect</span><span class="op" id="4854904">.</span><span class="ident" id="4854905">ValueOf</span><span class="op" id="4854912">(</span><span class="ident" id="4854913">result</span><span class="op" id="4854919">)</span><span class="op" id="4854920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854924">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4854932">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4854936">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4854964">if</span>&nbsp;<span class="ident" id="4854967">ifaceType</span>&nbsp;<span class="op" id="4854977">:=</span>&nbsp;<span class="ident" id="4854980">fieldType</span><span class="op" id="4854989">;</span>&nbsp;<span class="ident" id="4854991">ifaceType</span><span class="op" id="4855000">.</span><span class="ident" id="4855001">Kind</span><span class="op" id="4855005">(</span><span class="op" id="4855006">)</span>&nbsp;<span class="op" id="4855008">==</span>&nbsp;<span class="ident" id="4855011">reflect</span><span class="op" id="4855018">.</span><span class="ident" id="4855019">Interface</span>&nbsp;<span class="op" id="4855029">&amp;&amp;</span>&nbsp;<span class="ident" id="4855032">ifaceType</span><span class="op" id="4855041">.</span><span class="ident" id="4855042">NumMethod</span><span class="op" id="4855051">(</span><span class="op" id="4855052">)</span>&nbsp;<span class="op" id="4855054">==</span>&nbsp;<span class="num" id="4855057">0</span>&nbsp;<span class="op" id="4855059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855063">var</span>&nbsp;<span class="ident" id="4855067">t</span>&nbsp;<span class="ident" id="4855069">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855084">t</span><span class="op" id="4855085">,</span>&nbsp;<span class="ident" id="4855087">offset</span><span class="op" id="4855093">,</span>&nbsp;<span class="ident" id="4855095">err</span>&nbsp;<span class="op" id="4855099">=</span>&nbsp;<span class="ident" id="4855101">parseTagAndLength</span><span class="op" id="4855118">(</span><span class="ident" id="4855119">bytes</span><span class="op" id="4855124">,</span>&nbsp;<span class="ident" id="4855126">offset</span><span class="op" id="4855132">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855136">if</span>&nbsp;<span class="ident" id="4855139">err</span>&nbsp;<span class="op" id="4855143">!=</span>&nbsp;<span class="ident" id="4855146">nil</span>&nbsp;<span class="op" id="4855150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855155">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4855164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855168">if</span>&nbsp;<span class="ident" id="4855171">invalidLength</span><span class="op" id="4855184">(</span><span class="ident" id="4855185">offset</span><span class="op" id="4855191">,</span>&nbsp;<span class="ident" id="4855193">t</span><span class="op" id="4855194">.</span><span class="ident" id="4855195">length</span><span class="op" id="4855201">,</span>&nbsp;<span class="builtinfunc" id="4855203">len</span><span class="op" id="4855206">(</span><span class="ident" id="4855207">bytes</span><span class="op" id="4855212">)</span><span class="op" id="4855213">)</span>&nbsp;<span class="op" id="4855215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855220">err</span>&nbsp;<span class="op" id="4855224">=</span>&nbsp;<span class="ident" id="4855226">SyntaxError</span><span class="op" id="4855237">{</span><span class="string" id="4855238">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4855254">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855259">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4855268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855272">var</span>&nbsp;<span class="ident" id="4855276">result</span>&nbsp;<span class="keyword" id="4855283">interface</span><span class="op" id="4855292">{</span><span class="op" id="4855293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855297">if</span>&nbsp;<span class="op" id="4855300">!</span><span class="ident" id="4855301">t</span><span class="op" id="4855302">.</span><span class="ident" id="4855303">isCompound</span>&nbsp;<span class="op" id="4855314">&amp;&amp;</span>&nbsp;<span class="ident" id="4855317">t</span><span class="op" id="4855318">.</span><span class="ident" id="4855319">class</span>&nbsp;<span class="op" id="4855325">==</span>&nbsp;<span class="ident" id="4855328">classUniversal</span>&nbsp;<span class="op" id="4855343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855348">innerBytes</span>&nbsp;<span class="op" id="4855359">:=</span>&nbsp;<span class="ident" id="4855362">bytes</span><span class="op" id="4855367">[</span><span class="ident" id="4855368">offset</span>&nbsp;<span class="op" id="4855375">:</span>&nbsp;<span class="ident" id="4855377">offset</span><span class="op" id="4855383">+</span><span class="ident" id="4855384">t</span><span class="op" id="4855385">.</span><span class="ident" id="4855386">length</span><span class="op" id="4855392">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855397">switch</span>&nbsp;<span class="ident" id="4855404">t</span><span class="op" id="4855405">.</span><span class="ident" id="4855406">tag</span>&nbsp;<span class="op" id="4855410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855415">case</span>&nbsp;<span class="ident" id="4855420">tagPrintableString</span><span class="op" id="4855438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855444">result</span><span class="op" id="4855450">,</span>&nbsp;<span class="ident" id="4855452">err</span>&nbsp;<span class="op" id="4855456">=</span>&nbsp;<span class="ident" id="4855458">parsePrintableString</span><span class="op" id="4855478">(</span><span class="ident" id="4855479">innerBytes</span><span class="op" id="4855489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855494">case</span>&nbsp;<span class="ident" id="4855499">tagIA5String</span><span class="op" id="4855511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855517">result</span><span class="op" id="4855523">,</span>&nbsp;<span class="ident" id="4855525">err</span>&nbsp;<span class="op" id="4855529">=</span>&nbsp;<span class="ident" id="4855531">parseIA5String</span><span class="op" id="4855545">(</span><span class="ident" id="4855546">innerBytes</span><span class="op" id="4855556">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855561">case</span>&nbsp;<span class="ident" id="4855566">tagT61String</span><span class="op" id="4855578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855584">result</span><span class="op" id="4855590">,</span>&nbsp;<span class="ident" id="4855592">err</span>&nbsp;<span class="op" id="4855596">=</span>&nbsp;<span class="ident" id="4855598">parseT61String</span><span class="op" id="4855612">(</span><span class="ident" id="4855613">innerBytes</span><span class="op" id="4855623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855628">case</span>&nbsp;<span class="ident" id="4855633">tagUTF8String</span><span class="op" id="4855646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855652">result</span><span class="op" id="4855658">,</span>&nbsp;<span class="ident" id="4855660">err</span>&nbsp;<span class="op" id="4855664">=</span>&nbsp;<span class="ident" id="4855666">parseUTF8String</span><span class="op" id="4855681">(</span><span class="ident" id="4855682">innerBytes</span><span class="op" id="4855692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855697">case</span>&nbsp;<span class="ident" id="4855702">tagInteger</span><span class="op" id="4855712">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855718">result</span><span class="op" id="4855724">,</span>&nbsp;<span class="ident" id="4855726">err</span>&nbsp;<span class="op" id="4855730">=</span>&nbsp;<span class="ident" id="4855732">parseInt64</span><span class="op" id="4855742">(</span><span class="ident" id="4855743">innerBytes</span><span class="op" id="4855753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855758">case</span>&nbsp;<span class="ident" id="4855763">tagBitString</span><span class="op" id="4855775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855781">result</span><span class="op" id="4855787">,</span>&nbsp;<span class="ident" id="4855789">err</span>&nbsp;<span class="op" id="4855793">=</span>&nbsp;<span class="ident" id="4855795">parseBitString</span><span class="op" id="4855809">(</span><span class="ident" id="4855810">innerBytes</span><span class="op" id="4855820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855825">case</span>&nbsp;<span class="ident" id="4855830">tagOID</span><span class="op" id="4855836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855842">result</span><span class="op" id="4855848">,</span>&nbsp;<span class="ident" id="4855850">err</span>&nbsp;<span class="op" id="4855854">=</span>&nbsp;<span class="ident" id="4855856">parseObjectIdentifier</span><span class="op" id="4855877">(</span><span class="ident" id="4855878">innerBytes</span><span class="op" id="4855888">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855893">case</span>&nbsp;<span class="ident" id="4855898">tagUTCTime</span><span class="op" id="4855908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855914">result</span><span class="op" id="4855920">,</span>&nbsp;<span class="ident" id="4855922">err</span>&nbsp;<span class="op" id="4855926">=</span>&nbsp;<span class="ident" id="4855928">parseUTCTime</span><span class="op" id="4855940">(</span><span class="ident" id="4855941">innerBytes</span><span class="op" id="4855951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855956">case</span>&nbsp;<span class="ident" id="4855961">tagOctetString</span><span class="op" id="4855975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855981">result</span>&nbsp;<span class="op" id="4855988">=</span>&nbsp;<span class="ident" id="4855990">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856004">default</span><span class="op" id="4856011">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4856017">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856100">offset</span>&nbsp;<span class="op" id="4856107">+=</span>&nbsp;<span class="ident" id="4856110">t</span><span class="op" id="4856111">.</span><span class="ident" id="4856112">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856121">if</span>&nbsp;<span class="ident" id="4856124">err</span>&nbsp;<span class="op" id="4856128">!=</span>&nbsp;<span class="ident" id="4856131">nil</span>&nbsp;<span class="op" id="4856135">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856140">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856153">if</span>&nbsp;<span class="ident" id="4856156">result</span>&nbsp;<span class="op" id="4856163">!=</span>&nbsp;<span class="ident" id="4856166">nil</span>&nbsp;<span class="op" id="4856170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856175">v</span><span class="op" id="4856176">.</span><span class="ident" id="4856177">Set</span><span class="op" id="4856180">(</span><span class="ident" id="4856181">reflect</span><span class="op" id="4856188">.</span><span class="ident" id="4856189">ValueOf</span><span class="op" id="4856196">(</span><span class="ident" id="4856197">result</span><span class="op" id="4856203">)</span><span class="op" id="4856204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856208">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856212">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856223">universalTag</span><span class="op" id="4856235">,</span>&nbsp;<span class="ident" id="4856237">compoundType</span><span class="op" id="4856249">,</span>&nbsp;<span class="ident" id="4856251">ok1</span>&nbsp;<span class="op" id="4856255">:=</span>&nbsp;<span class="ident" id="4856258">getUniversalType</span><span class="op" id="4856274">(</span><span class="ident" id="4856275">fieldType</span><span class="op" id="4856284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856287">if</span>&nbsp;<span class="op" id="4856290">!</span><span class="ident" id="4856291">ok1</span>&nbsp;<span class="op" id="4856295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856299">err</span>&nbsp;<span class="op" id="4856303">=</span>&nbsp;<span class="ident" id="4856305">StructuralError</span><span class="op" id="4856320">{</span><span class="ident" id="4856321">fmt</span><span class="op" id="4856324">.</span><span class="ident" id="4856325">Sprintf</span><span class="op" id="4856332">(</span><span class="string" id="4856333">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4856354">,</span>&nbsp;<span class="ident" id="4856356">fieldType</span><span class="op" id="4856365">)</span><span class="op" id="4856366">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856370">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856382">t</span><span class="op" id="4856383">,</span>&nbsp;<span class="ident" id="4856385">offset</span><span class="op" id="4856391">,</span>&nbsp;<span class="ident" id="4856393">err</span>&nbsp;<span class="op" id="4856397">:=</span>&nbsp;<span class="ident" id="4856400">parseTagAndLength</span><span class="op" id="4856417">(</span><span class="ident" id="4856418">bytes</span><span class="op" id="4856423">,</span>&nbsp;<span class="ident" id="4856425">offset</span><span class="op" id="4856431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856434">if</span>&nbsp;<span class="ident" id="4856437">err</span>&nbsp;<span class="op" id="4856441">!=</span>&nbsp;<span class="ident" id="4856444">nil</span>&nbsp;<span class="op" id="4856448">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856452">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856463">if</span>&nbsp;<span class="ident" id="4856466">params</span><span class="op" id="4856472">.</span><span class="ident" id="4856473">explicit</span>&nbsp;<span class="op" id="4856482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856486">expectedClass</span>&nbsp;<span class="op" id="4856500">:=</span>&nbsp;<span class="ident" id="4856503">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856526">if</span>&nbsp;<span class="ident" id="4856529">params</span><span class="op" id="4856535">.</span><span class="ident" id="4856536">application</span>&nbsp;<span class="op" id="4856548">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856553">expectedClass</span>&nbsp;<span class="op" id="4856567">=</span>&nbsp;<span class="ident" id="4856569">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856592">if</span>&nbsp;<span class="ident" id="4856595">t</span><span class="op" id="4856596">.</span><span class="ident" id="4856597">class</span>&nbsp;<span class="op" id="4856603">==</span>&nbsp;<span class="ident" id="4856606">expectedClass</span>&nbsp;<span class="op" id="4856620">&amp;&amp;</span>&nbsp;<span class="ident" id="4856623">t</span><span class="op" id="4856624">.</span><span class="ident" id="4856625">tag</span>&nbsp;<span class="op" id="4856629">==</span>&nbsp;<span class="op" id="4856632">*</span><span class="ident" id="4856633">params</span><span class="op" id="4856639">.</span><span class="ident" id="4856640">tag</span>&nbsp;<span class="op" id="4856644">&amp;&amp;</span>&nbsp;<span class="op" id="4856647">(</span><span class="ident" id="4856648">t</span><span class="op" id="4856649">.</span><span class="ident" id="4856650">length</span>&nbsp;<span class="op" id="4856657">==</span>&nbsp;<span class="num" id="4856660">0</span>&nbsp;<span class="op" id="4856662">||</span>&nbsp;<span class="ident" id="4856665">t</span><span class="op" id="4856666">.</span><span class="ident" id="4856667">isCompound</span><span class="op" id="4856677">)</span>&nbsp;<span class="op" id="4856679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856684">if</span>&nbsp;<span class="ident" id="4856687">t</span><span class="op" id="4856688">.</span><span class="ident" id="4856689">length</span>&nbsp;<span class="op" id="4856696">&gt;</span>&nbsp;<span class="num" id="4856698">0</span>&nbsp;<span class="op" id="4856700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856706">t</span><span class="op" id="4856707">,</span>&nbsp;<span class="ident" id="4856709">offset</span><span class="op" id="4856715">,</span>&nbsp;<span class="ident" id="4856717">err</span>&nbsp;<span class="op" id="4856721">=</span>&nbsp;<span class="ident" id="4856723">parseTagAndLength</span><span class="op" id="4856740">(</span><span class="ident" id="4856741">bytes</span><span class="op" id="4856746">,</span>&nbsp;<span class="ident" id="4856748">offset</span><span class="op" id="4856754">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856760">if</span>&nbsp;<span class="ident" id="4856763">err</span>&nbsp;<span class="op" id="4856767">!=</span>&nbsp;<span class="ident" id="4856770">nil</span>&nbsp;<span class="op" id="4856774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856781">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856797">}</span>&nbsp;<span class="keyword" id="4856799">else</span>&nbsp;<span class="op" id="4856804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856810">if</span>&nbsp;<span class="ident" id="4856813">fieldType</span>&nbsp;<span class="op" id="4856823">!=</span>&nbsp;<span class="ident" id="4856826">flagType</span>&nbsp;<span class="op" id="4856835">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856842">err</span>&nbsp;<span class="op" id="4856846">=</span>&nbsp;<span class="ident" id="4856848">StructuralError</span><span class="op" id="4856863">{</span><span class="string" id="4856864">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4856911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856918">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4856935">v</span><span class="op" id="4856936">.</span><span class="ident" id="4856937">SetBool</span><span class="op" id="4856944">(</span><span class="builtintype" id="4856945">true</span><span class="op" id="4856949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856955">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4856969">}</span>&nbsp;<span class="keyword" id="4856971">else</span>&nbsp;<span class="op" id="4856976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4856981">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857043">ok</span>&nbsp;<span class="op" id="4857046">:=</span>&nbsp;<span class="ident" id="4857049">setDefaultValue</span><span class="op" id="4857064">(</span><span class="ident" id="4857065">v</span><span class="op" id="4857066">,</span>&nbsp;<span class="ident" id="4857068">params</span><span class="op" id="4857074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857079">if</span>&nbsp;<span class="ident" id="4857082">ok</span>&nbsp;<span class="op" id="4857085">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857091">offset</span>&nbsp;<span class="op" id="4857098">=</span>&nbsp;<span class="ident" id="4857100">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857114">}</span>&nbsp;<span class="keyword" id="4857116">else</span>&nbsp;<span class="op" id="4857121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857127">err</span>&nbsp;<span class="op" id="4857131">=</span>&nbsp;<span class="ident" id="4857133">StructuralError</span><span class="op" id="4857148">{</span><span class="string" id="4857149">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4857188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857198">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4857214">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4857285">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4857355">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4857426">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857475">if</span>&nbsp;<span class="ident" id="4857478">universalTag</span>&nbsp;<span class="op" id="4857491">==</span>&nbsp;<span class="ident" id="4857494">tagPrintableString</span>&nbsp;<span class="op" id="4857513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857517">if</span>&nbsp;<span class="ident" id="4857520">t</span><span class="op" id="4857521">.</span><span class="ident" id="4857522">class</span>&nbsp;<span class="op" id="4857528">==</span>&nbsp;<span class="ident" id="4857531">classUniversal</span>&nbsp;<span class="op" id="4857546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857551">switch</span>&nbsp;<span class="ident" id="4857558">t</span><span class="op" id="4857559">.</span><span class="ident" id="4857560">tag</span>&nbsp;<span class="op" id="4857564">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857569">case</span>&nbsp;<span class="ident" id="4857574">tagIA5String</span><span class="op" id="4857586">,</span>&nbsp;<span class="ident" id="4857588">tagGeneralString</span><span class="op" id="4857604">,</span>&nbsp;<span class="ident" id="4857606">tagT61String</span><span class="op" id="4857618">,</span>&nbsp;<span class="ident" id="4857620">tagUTF8String</span><span class="op" id="4857633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857639">universalTag</span>&nbsp;<span class="op" id="4857652">=</span>&nbsp;<span class="ident" id="4857654">t</span><span class="op" id="4857655">.</span><span class="ident" id="4857656">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857667">}</span>&nbsp;<span class="keyword" id="4857669">else</span>&nbsp;<span class="keyword" id="4857674">if</span>&nbsp;<span class="ident" id="4857677">params</span><span class="op" id="4857683">.</span><span class="ident" id="4857684">stringType</span>&nbsp;<span class="op" id="4857695">!=</span>&nbsp;<span class="num" id="4857698">0</span>&nbsp;<span class="op" id="4857700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857705">universalTag</span>&nbsp;<span class="op" id="4857718">=</span>&nbsp;<span class="ident" id="4857720">params</span><span class="op" id="4857726">.</span><span class="ident" id="4857727">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4857747">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4857818">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857841">if</span>&nbsp;<span class="ident" id="4857844">universalTag</span>&nbsp;<span class="op" id="4857857">==</span>&nbsp;<span class="ident" id="4857860">tagUTCTime</span>&nbsp;<span class="op" id="4857871">&amp;&amp;</span>&nbsp;<span class="ident" id="4857874">t</span><span class="op" id="4857875">.</span><span class="ident" id="4857876">tag</span>&nbsp;<span class="op" id="4857880">==</span>&nbsp;<span class="ident" id="4857883">tagGeneralizedTime</span>&nbsp;<span class="op" id="4857902">&amp;&amp;</span>&nbsp;<span class="ident" id="4857905">t</span><span class="op" id="4857906">.</span><span class="ident" id="4857907">class</span>&nbsp;<span class="op" id="4857913">==</span>&nbsp;<span class="ident" id="4857916">classUniversal</span>&nbsp;<span class="op" id="4857931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857935">universalTag</span>&nbsp;<span class="op" id="4857948">=</span>&nbsp;<span class="ident" id="4857950">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4857970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4857974">if</span>&nbsp;<span class="ident" id="4857977">params</span><span class="op" id="4857983">.</span><span class="ident" id="4857984">set</span>&nbsp;<span class="op" id="4857988">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4857992">universalTag</span>&nbsp;<span class="op" id="4858005">=</span>&nbsp;<span class="ident" id="4858007">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858019">expectedClass</span>&nbsp;<span class="op" id="4858033">:=</span>&nbsp;<span class="ident" id="4858036">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858052">expectedTag</span>&nbsp;<span class="op" id="4858064">:=</span>&nbsp;<span class="ident" id="4858067">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858082">if</span>&nbsp;<span class="op" id="4858085">!</span><span class="ident" id="4858086">params</span><span class="op" id="4858092">.</span><span class="ident" id="4858093">explicit</span>&nbsp;<span class="op" id="4858102">&amp;&amp;</span>&nbsp;<span class="ident" id="4858105">params</span><span class="op" id="4858111">.</span><span class="ident" id="4858112">tag</span>&nbsp;<span class="op" id="4858116">!=</span>&nbsp;<span class="ident" id="4858119">nil</span>&nbsp;<span class="op" id="4858123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858127">expectedClass</span>&nbsp;<span class="op" id="4858141">=</span>&nbsp;<span class="ident" id="4858143">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858166">expectedTag</span>&nbsp;<span class="op" id="4858178">=</span>&nbsp;<span class="op" id="4858180">*</span><span class="ident" id="4858181">params</span><span class="op" id="4858187">.</span><span class="ident" id="4858188">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858193">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858197">if</span>&nbsp;<span class="op" id="4858200">!</span><span class="ident" id="4858201">params</span><span class="op" id="4858207">.</span><span class="ident" id="4858208">explicit</span>&nbsp;<span class="op" id="4858217">&amp;&amp;</span>&nbsp;<span class="ident" id="4858220">params</span><span class="op" id="4858226">.</span><span class="ident" id="4858227">application</span>&nbsp;<span class="op" id="4858239">&amp;&amp;</span>&nbsp;<span class="ident" id="4858242">params</span><span class="op" id="4858248">.</span><span class="ident" id="4858249">tag</span>&nbsp;<span class="op" id="4858253">!=</span>&nbsp;<span class="ident" id="4858256">nil</span>&nbsp;<span class="op" id="4858260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858264">expectedClass</span>&nbsp;<span class="op" id="4858278">=</span>&nbsp;<span class="ident" id="4858280">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858299">expectedTag</span>&nbsp;<span class="op" id="4858311">=</span>&nbsp;<span class="op" id="4858313">*</span><span class="ident" id="4858314">params</span><span class="op" id="4858320">.</span><span class="ident" id="4858321">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858326">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4858330">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858388">if</span>&nbsp;<span class="ident" id="4858391">t</span><span class="op" id="4858392">.</span><span class="ident" id="4858393">class</span>&nbsp;<span class="op" id="4858399">!=</span>&nbsp;<span class="ident" id="4858402">expectedClass</span>&nbsp;<span class="op" id="4858416">||</span>&nbsp;<span class="ident" id="4858419">t</span><span class="op" id="4858420">.</span><span class="ident" id="4858421">tag</span>&nbsp;<span class="op" id="4858425">!=</span>&nbsp;<span class="ident" id="4858428">expectedTag</span>&nbsp;<span class="op" id="4858440">||</span>&nbsp;<span class="ident" id="4858443">t</span><span class="op" id="4858444">.</span><span class="ident" id="4858445">isCompound</span>&nbsp;<span class="op" id="4858456">!=</span>&nbsp;<span class="ident" id="4858459">compoundType</span>&nbsp;<span class="op" id="4858472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4858476">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858539">ok</span>&nbsp;<span class="op" id="4858542">:=</span>&nbsp;<span class="ident" id="4858545">setDefaultValue</span><span class="op" id="4858560">(</span><span class="ident" id="4858561">v</span><span class="op" id="4858562">,</span>&nbsp;<span class="ident" id="4858564">params</span><span class="op" id="4858570">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858574">if</span>&nbsp;<span class="ident" id="4858577">ok</span>&nbsp;<span class="op" id="4858580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858585">offset</span>&nbsp;<span class="op" id="4858592">=</span>&nbsp;<span class="ident" id="4858594">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858607">}</span>&nbsp;<span class="keyword" id="4858609">else</span>&nbsp;<span class="op" id="4858614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858619">err</span>&nbsp;<span class="op" id="4858623">=</span>&nbsp;<span class="ident" id="4858625">StructuralError</span><span class="op" id="4858640">{</span><span class="ident" id="4858641">fmt</span><span class="op" id="4858644">.</span><span class="ident" id="4858645">Sprintf</span><span class="op" id="4858652">(</span><span class="string" id="4858653">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4858694">,</span>&nbsp;<span class="ident" id="4858696">expectedTag</span><span class="op" id="4858707">,</span>&nbsp;<span class="ident" id="4858709">t</span><span class="op" id="4858710">,</span>&nbsp;<span class="ident" id="4858712">params</span><span class="op" id="4858718">,</span>&nbsp;<span class="ident" id="4858720">fieldType</span><span class="op" id="4858729">.</span><span class="ident" id="4858730">Name</span><span class="op" id="4858734">(</span><span class="op" id="4858735">)</span><span class="op" id="4858736">,</span>&nbsp;<span class="ident" id="4858738">offset</span><span class="op" id="4858744">)</span><span class="op" id="4858745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858749">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858753">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858764">if</span>&nbsp;<span class="ident" id="4858767">invalidLength</span><span class="op" id="4858780">(</span><span class="ident" id="4858781">offset</span><span class="op" id="4858787">,</span>&nbsp;<span class="ident" id="4858789">t</span><span class="op" id="4858790">.</span><span class="ident" id="4858791">length</span><span class="op" id="4858797">,</span>&nbsp;<span class="builtinfunc" id="4858799">len</span><span class="op" id="4858802">(</span><span class="ident" id="4858803">bytes</span><span class="op" id="4858808">)</span><span class="op" id="4858809">)</span>&nbsp;<span class="op" id="4858811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858815">err</span>&nbsp;<span class="op" id="4858819">=</span>&nbsp;<span class="ident" id="4858821">SyntaxError</span><span class="op" id="4858832">{</span><span class="string" id="4858833">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4858849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858853">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4858861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858864">innerBytes</span>&nbsp;<span class="op" id="4858875">:=</span>&nbsp;<span class="ident" id="4858878">bytes</span><span class="op" id="4858883">[</span><span class="ident" id="4858884">offset</span>&nbsp;<span class="op" id="4858891">:</span>&nbsp;<span class="ident" id="4858893">offset</span><span class="op" id="4858899">+</span><span class="ident" id="4858900">t</span><span class="op" id="4858901">.</span><span class="ident" id="4858902">length</span><span class="op" id="4858908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4858911">offset</span>&nbsp;<span class="op" id="4858918">+=</span>&nbsp;<span class="ident" id="4858921">t</span><span class="op" id="4858922">.</span><span class="ident" id="4858923">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4858932">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4858995">switch</span>&nbsp;<span class="ident" id="4859002">fieldType</span>&nbsp;<span class="op" id="4859012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859015">case</span>&nbsp;<span class="ident" id="4859020">objectIdentifierType</span><span class="op" id="4859040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859044">newSlice</span><span class="op" id="4859052">,</span>&nbsp;<span class="ident" id="4859054">err1</span>&nbsp;<span class="op" id="4859059">:=</span>&nbsp;<span class="ident" id="4859062">parseObjectIdentifier</span><span class="op" id="4859083">(</span><span class="ident" id="4859084">innerBytes</span><span class="op" id="4859094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859098">v</span><span class="op" id="4859099">.</span><span class="ident" id="4859100">Set</span><span class="op" id="4859103">(</span><span class="ident" id="4859104">reflect</span><span class="op" id="4859111">.</span><span class="ident" id="4859112">MakeSlice</span><span class="op" id="4859121">(</span><span class="ident" id="4859122">v</span><span class="op" id="4859123">.</span><span class="ident" id="4859124">Type</span><span class="op" id="4859128">(</span><span class="op" id="4859129">)</span><span class="op" id="4859130">,</span>&nbsp;<span class="builtinfunc" id="4859132">len</span><span class="op" id="4859135">(</span><span class="ident" id="4859136">newSlice</span><span class="op" id="4859144">)</span><span class="op" id="4859145">,</span>&nbsp;<span class="builtinfunc" id="4859147">len</span><span class="op" id="4859150">(</span><span class="ident" id="4859151">newSlice</span><span class="op" id="4859159">)</span><span class="op" id="4859160">)</span><span class="op" id="4859161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859165">if</span>&nbsp;<span class="ident" id="4859168">err1</span>&nbsp;<span class="op" id="4859173">==</span>&nbsp;<span class="ident" id="4859176">nil</span>&nbsp;<span class="op" id="4859180">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859185">reflect</span><span class="op" id="4859192">.</span><span class="ident" id="4859193">Copy</span><span class="op" id="4859197">(</span><span class="ident" id="4859198">v</span><span class="op" id="4859199">,</span>&nbsp;<span class="ident" id="4859201">reflect</span><span class="op" id="4859208">.</span><span class="ident" id="4859209">ValueOf</span><span class="op" id="4859216">(</span><span class="ident" id="4859217">newSlice</span><span class="op" id="4859225">)</span><span class="op" id="4859226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859234">err</span>&nbsp;<span class="op" id="4859238">=</span>&nbsp;<span class="ident" id="4859240">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859247">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859255">case</span>&nbsp;<span class="ident" id="4859260">bitStringType</span><span class="op" id="4859273">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859277">bs</span><span class="op" id="4859279">,</span>&nbsp;<span class="ident" id="4859281">err1</span>&nbsp;<span class="op" id="4859286">:=</span>&nbsp;<span class="ident" id="4859289">parseBitString</span><span class="op" id="4859303">(</span><span class="ident" id="4859304">innerBytes</span><span class="op" id="4859314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859318">if</span>&nbsp;<span class="ident" id="4859321">err1</span>&nbsp;<span class="op" id="4859326">==</span>&nbsp;<span class="ident" id="4859329">nil</span>&nbsp;<span class="op" id="4859333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859338">v</span><span class="op" id="4859339">.</span><span class="ident" id="4859340">Set</span><span class="op" id="4859343">(</span><span class="ident" id="4859344">reflect</span><span class="op" id="4859351">.</span><span class="ident" id="4859352">ValueOf</span><span class="op" id="4859359">(</span><span class="ident" id="4859360">bs</span><span class="op" id="4859362">)</span><span class="op" id="4859363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859371">err</span>&nbsp;<span class="op" id="4859375">=</span>&nbsp;<span class="ident" id="4859377">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859384">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859392">case</span>&nbsp;<span class="ident" id="4859397">timeType</span><span class="op" id="4859405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859409">var</span>&nbsp;<span class="ident" id="4859413">time</span>&nbsp;<span class="ident" id="4859418">time</span><span class="op" id="4859422">.</span><span class="ident" id="4859423">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859430">var</span>&nbsp;<span class="ident" id="4859434">err1</span>&nbsp;<span class="builtintype" id="4859439">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859447">if</span>&nbsp;<span class="ident" id="4859450">universalTag</span>&nbsp;<span class="op" id="4859463">==</span>&nbsp;<span class="ident" id="4859466">tagUTCTime</span>&nbsp;<span class="op" id="4859477">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859482">time</span><span class="op" id="4859486">,</span>&nbsp;<span class="ident" id="4859488">err1</span>&nbsp;<span class="op" id="4859493">=</span>&nbsp;<span class="ident" id="4859495">parseUTCTime</span><span class="op" id="4859507">(</span><span class="ident" id="4859508">innerBytes</span><span class="op" id="4859518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859522">}</span>&nbsp;<span class="keyword" id="4859524">else</span>&nbsp;<span class="op" id="4859529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859534">time</span><span class="op" id="4859538">,</span>&nbsp;<span class="ident" id="4859540">err1</span>&nbsp;<span class="op" id="4859545">=</span>&nbsp;<span class="ident" id="4859547">parseGeneralizedTime</span><span class="op" id="4859567">(</span><span class="ident" id="4859568">innerBytes</span><span class="op" id="4859578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859586">if</span>&nbsp;<span class="ident" id="4859589">err1</span>&nbsp;<span class="op" id="4859594">==</span>&nbsp;<span class="ident" id="4859597">nil</span>&nbsp;<span class="op" id="4859601">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859606">v</span><span class="op" id="4859607">.</span><span class="ident" id="4859608">Set</span><span class="op" id="4859611">(</span><span class="ident" id="4859612">reflect</span><span class="op" id="4859619">.</span><span class="ident" id="4859620">ValueOf</span><span class="op" id="4859627">(</span><span class="ident" id="4859628">time</span><span class="op" id="4859632">)</span><span class="op" id="4859633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859641">err</span>&nbsp;<span class="op" id="4859645">=</span>&nbsp;<span class="ident" id="4859647">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859662">case</span>&nbsp;<span class="ident" id="4859667">enumeratedType</span><span class="op" id="4859681">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859685">parsedInt</span><span class="op" id="4859694">,</span>&nbsp;<span class="ident" id="4859696">err1</span>&nbsp;<span class="op" id="4859701">:=</span>&nbsp;<span class="ident" id="4859704">parseInt32</span><span class="op" id="4859714">(</span><span class="ident" id="4859715">innerBytes</span><span class="op" id="4859725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859729">if</span>&nbsp;<span class="ident" id="4859732">err1</span>&nbsp;<span class="op" id="4859737">==</span>&nbsp;<span class="ident" id="4859740">nil</span>&nbsp;<span class="op" id="4859744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859749">v</span><span class="op" id="4859750">.</span><span class="ident" id="4859751">SetInt</span><span class="op" id="4859757">(</span><span class="ident" id="4859758">int64</span><span class="op" id="4859763">(</span><span class="ident" id="4859764">parsedInt</span><span class="op" id="4859773">)</span><span class="op" id="4859774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859782">err</span>&nbsp;<span class="op" id="4859786">=</span>&nbsp;<span class="ident" id="4859788">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859795">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859803">case</span>&nbsp;<span class="ident" id="4859808">flagType</span><span class="op" id="4859816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859820">v</span><span class="op" id="4859821">.</span><span class="ident" id="4859822">SetBool</span><span class="op" id="4859829">(</span><span class="builtintype" id="4859830">true</span><span class="op" id="4859834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859838">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859846">case</span>&nbsp;<span class="ident" id="4859851">bigIntType</span><span class="op" id="4859861">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859865">parsedInt</span>&nbsp;<span class="op" id="4859875">:=</span>&nbsp;<span class="ident" id="4859878">parseBigInt</span><span class="op" id="4859889">(</span><span class="ident" id="4859890">innerBytes</span><span class="op" id="4859900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4859904">v</span><span class="op" id="4859905">.</span><span class="ident" id="4859906">Set</span><span class="op" id="4859909">(</span><span class="ident" id="4859910">reflect</span><span class="op" id="4859917">.</span><span class="ident" id="4859918">ValueOf</span><span class="op" id="4859925">(</span><span class="ident" id="4859926">parsedInt</span><span class="op" id="4859935">)</span><span class="op" id="4859936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859940">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4859948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859951">switch</span>&nbsp;<span class="ident" id="4859958">val</span>&nbsp;<span class="op" id="4859962">:=</span>&nbsp;<span class="ident" id="4859965">v</span><span class="op" id="4859966">;</span>&nbsp;<span class="ident" id="4859968">val</span><span class="op" id="4859971">.</span><span class="ident" id="4859972">Kind</span><span class="op" id="4859976">(</span><span class="op" id="4859977">)</span>&nbsp;<span class="op" id="4859979">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4859982">case</span>&nbsp;<span class="ident" id="4859987">reflect</span><span class="op" id="4859994">.</span><span class="ident" id="4859995">Bool</span><span class="op" id="4859999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860003">parsedBool</span><span class="op" id="4860013">,</span>&nbsp;<span class="ident" id="4860015">err1</span>&nbsp;<span class="op" id="4860020">:=</span>&nbsp;<span class="ident" id="4860023">parseBool</span><span class="op" id="4860032">(</span><span class="ident" id="4860033">innerBytes</span><span class="op" id="4860043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860047">if</span>&nbsp;<span class="ident" id="4860050">err1</span>&nbsp;<span class="op" id="4860055">==</span>&nbsp;<span class="ident" id="4860058">nil</span>&nbsp;<span class="op" id="4860062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860067">val</span><span class="op" id="4860070">.</span><span class="ident" id="4860071">SetBool</span><span class="op" id="4860078">(</span><span class="ident" id="4860079">parsedBool</span><span class="op" id="4860089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860093">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860097">err</span>&nbsp;<span class="op" id="4860101">=</span>&nbsp;<span class="ident" id="4860103">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860110">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860118">case</span>&nbsp;<span class="ident" id="4860123">reflect</span><span class="op" id="4860130">.</span><span class="ident" id="4860131">Int</span><span class="op" id="4860134">,</span>&nbsp;<span class="ident" id="4860136">reflect</span><span class="op" id="4860143">.</span><span class="ident" id="4860144">Int32</span><span class="op" id="4860149">,</span>&nbsp;<span class="ident" id="4860151">reflect</span><span class="op" id="4860158">.</span><span class="ident" id="4860159">Int64</span><span class="op" id="4860164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860168">if</span>&nbsp;<span class="ident" id="4860171">val</span><span class="op" id="4860174">.</span><span class="ident" id="4860175">Type</span><span class="op" id="4860179">(</span><span class="op" id="4860180">)</span><span class="op" id="4860181">.</span><span class="ident" id="4860182">Size</span><span class="op" id="4860186">(</span><span class="op" id="4860187">)</span>&nbsp;<span class="op" id="4860189">==</span>&nbsp;<span class="num" id="4860192">4</span>&nbsp;<span class="op" id="4860194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860199">parsedInt</span><span class="op" id="4860208">,</span>&nbsp;<span class="ident" id="4860210">err1</span>&nbsp;<span class="op" id="4860215">:=</span>&nbsp;<span class="ident" id="4860218">parseInt32</span><span class="op" id="4860228">(</span><span class="ident" id="4860229">innerBytes</span><span class="op" id="4860239">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860244">if</span>&nbsp;<span class="ident" id="4860247">err1</span>&nbsp;<span class="op" id="4860252">==</span>&nbsp;<span class="ident" id="4860255">nil</span>&nbsp;<span class="op" id="4860259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860265">val</span><span class="op" id="4860268">.</span><span class="ident" id="4860269">SetInt</span><span class="op" id="4860275">(</span><span class="ident" id="4860276">int64</span><span class="op" id="4860281">(</span><span class="ident" id="4860282">parsedInt</span><span class="op" id="4860291">)</span><span class="op" id="4860292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860302">err</span>&nbsp;<span class="op" id="4860306">=</span>&nbsp;<span class="ident" id="4860308">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860315">}</span>&nbsp;<span class="keyword" id="4860317">else</span>&nbsp;<span class="op" id="4860322">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860327">parsedInt</span><span class="op" id="4860336">,</span>&nbsp;<span class="ident" id="4860338">err1</span>&nbsp;<span class="op" id="4860343">:=</span>&nbsp;<span class="ident" id="4860346">parseInt64</span><span class="op" id="4860356">(</span><span class="ident" id="4860357">innerBytes</span><span class="op" id="4860367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860372">if</span>&nbsp;<span class="ident" id="4860375">err1</span>&nbsp;<span class="op" id="4860380">==</span>&nbsp;<span class="ident" id="4860383">nil</span>&nbsp;<span class="op" id="4860387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860393">val</span><span class="op" id="4860396">.</span><span class="ident" id="4860397">SetInt</span><span class="op" id="4860403">(</span><span class="ident" id="4860404">parsedInt</span><span class="op" id="4860413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860423">err</span>&nbsp;<span class="op" id="4860427">=</span>&nbsp;<span class="ident" id="4860429">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860440">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4860448">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860506">case</span>&nbsp;<span class="ident" id="4860511">reflect</span><span class="op" id="4860518">.</span><span class="ident" id="4860519">Struct</span><span class="op" id="4860525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860529">structType</span>&nbsp;<span class="op" id="4860540">:=</span>&nbsp;<span class="ident" id="4860543">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860556">if</span>&nbsp;<span class="ident" id="4860559">structType</span><span class="op" id="4860569">.</span><span class="ident" id="4860570">NumField</span><span class="op" id="4860578">(</span><span class="op" id="4860579">)</span>&nbsp;<span class="op" id="4860581">&gt;</span>&nbsp;<span class="num" id="4860583">0</span>&nbsp;<span class="op" id="4860585">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860591">structType</span><span class="op" id="4860601">.</span><span class="ident" id="4860602">Field</span><span class="op" id="4860607">(</span><span class="num" id="4860608">0</span><span class="op" id="4860609">)</span><span class="op" id="4860610">.</span><span class="ident" id="4860611">Type</span>&nbsp;<span class="op" id="4860616">==</span>&nbsp;<span class="ident" id="4860619">rawContentsType</span>&nbsp;<span class="op" id="4860635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860640">bytes</span>&nbsp;<span class="op" id="4860646">:=</span>&nbsp;<span class="ident" id="4860649">bytes</span><span class="op" id="4860654">[</span><span class="ident" id="4860655">initOffset</span><span class="op" id="4860665">:</span><span class="ident" id="4860666">offset</span><span class="op" id="4860672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860677">val</span><span class="op" id="4860680">.</span><span class="ident" id="4860681">Field</span><span class="op" id="4860686">(</span><span class="num" id="4860687">0</span><span class="op" id="4860688">)</span><span class="op" id="4860689">.</span><span class="ident" id="4860690">Set</span><span class="op" id="4860693">(</span><span class="ident" id="4860694">reflect</span><span class="op" id="4860701">.</span><span class="ident" id="4860702">ValueOf</span><span class="op" id="4860709">(</span><span class="ident" id="4860710">RawContent</span><span class="op" id="4860720">(</span><span class="ident" id="4860721">bytes</span><span class="op" id="4860726">)</span><span class="op" id="4860727">)</span><span class="op" id="4860728">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860737">innerOffset</span>&nbsp;<span class="op" id="4860749">:=</span>&nbsp;<span class="num" id="4860752">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860756">for</span>&nbsp;<span class="ident" id="4860760">i</span>&nbsp;<span class="op" id="4860762">:=</span>&nbsp;<span class="num" id="4860765">0</span><span class="op" id="4860766">;</span>&nbsp;<span class="ident" id="4860768">i</span>&nbsp;<span class="op" id="4860770">&lt;</span>&nbsp;<span class="ident" id="4860772">structType</span><span class="op" id="4860782">.</span><span class="ident" id="4860783">NumField</span><span class="op" id="4860791">(</span><span class="op" id="4860792">)</span><span class="op" id="4860793">;</span>&nbsp;<span class="ident" id="4860795">i</span><span class="op" id="4860796">++</span>&nbsp;<span class="op" id="4860799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860804">field</span>&nbsp;<span class="op" id="4860810">:=</span>&nbsp;<span class="ident" id="4860813">structType</span><span class="op" id="4860823">.</span><span class="ident" id="4860824">Field</span><span class="op" id="4860829">(</span><span class="ident" id="4860830">i</span><span class="op" id="4860831">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860836">if</span>&nbsp;<span class="ident" id="4860839">i</span>&nbsp;<span class="op" id="4860841">==</span>&nbsp;<span class="num" id="4860844">0</span>&nbsp;<span class="op" id="4860846">&amp;&amp;</span>&nbsp;<span class="ident" id="4860849">field</span><span class="op" id="4860854">.</span><span class="ident" id="4860855">Type</span>&nbsp;<span class="op" id="4860860">==</span>&nbsp;<span class="ident" id="4860863">rawContentsType</span>&nbsp;<span class="op" id="4860879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4860885">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4860897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4860902">innerOffset</span><span class="op" id="4860913">,</span>&nbsp;<span class="ident" id="4860915">err</span>&nbsp;<span class="op" id="4860919">=</span>&nbsp;<span class="ident" id="4860921">parseField</span><span class="op" id="4860931">(</span><span class="ident" id="4860932">val</span><span class="op" id="4860935">.</span><span class="ident" id="4860936">Field</span><span class="op" id="4860941">(</span><span class="ident" id="4860942">i</span><span class="op" id="4860943">)</span><span class="op" id="4860944">,</span>&nbsp;<span class="ident" id="4860946">innerBytes</span><span class="op" id="4860956">,</span>&nbsp;<span class="ident" id="4860958">innerOffset</span><span class="op" id="4860969">,</span>&nbsp;<span class="ident" id="4860971">parseFieldParameters</span><span class="op" id="4860991">(</span><span class="ident" id="4860992">field</span><span class="op" id="4860997">.</span><span class="ident" id="4860998">Tag</span><span class="op" id="4861001">.</span><span class="ident" id="4861002">Get</span><span class="op" id="4861005">(</span><span class="string" id="4861006">&#34;asn1&#34;</span><span class="op" id="4861012">)</span><span class="op" id="4861013">)</span><span class="op" id="4861014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861019">if</span>&nbsp;<span class="ident" id="4861022">err</span>&nbsp;<span class="op" id="4861026">!=</span>&nbsp;<span class="ident" id="4861029">nil</span>&nbsp;<span class="op" id="4861033">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861039">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4861049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4861053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4861057">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4861118">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4861180">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861217">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861225">case</span>&nbsp;<span class="ident" id="4861230">reflect</span><span class="op" id="4861237">.</span><span class="ident" id="4861238">Slice</span><span class="op" id="4861243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861247">sliceType</span>&nbsp;<span class="op" id="4861257">:=</span>&nbsp;<span class="ident" id="4861260">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861272">if</span>&nbsp;<span class="ident" id="4861275">sliceType</span><span class="op" id="4861284">.</span><span class="ident" id="4861285">Elem</span><span class="op" id="4861289">(</span><span class="op" id="4861290">)</span><span class="op" id="4861291">.</span><span class="ident" id="4861292">Kind</span><span class="op" id="4861296">(</span><span class="op" id="4861297">)</span>&nbsp;<span class="op" id="4861299">==</span>&nbsp;<span class="ident" id="4861302">reflect</span><span class="op" id="4861309">.</span><span class="ident" id="4861310">Uint8</span>&nbsp;<span class="op" id="4861316">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861321">val</span><span class="op" id="4861324">.</span><span class="ident" id="4861325">Set</span><span class="op" id="4861328">(</span><span class="ident" id="4861329">reflect</span><span class="op" id="4861336">.</span><span class="ident" id="4861337">MakeSlice</span><span class="op" id="4861346">(</span><span class="ident" id="4861347">sliceType</span><span class="op" id="4861356">,</span>&nbsp;<span class="builtinfunc" id="4861358">len</span><span class="op" id="4861361">(</span><span class="ident" id="4861362">innerBytes</span><span class="op" id="4861372">)</span><span class="op" id="4861373">,</span>&nbsp;<span class="builtinfunc" id="4861375">len</span><span class="op" id="4861378">(</span><span class="ident" id="4861379">innerBytes</span><span class="op" id="4861389">)</span><span class="op" id="4861390">)</span><span class="op" id="4861391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861396">reflect</span><span class="op" id="4861403">.</span><span class="ident" id="4861404">Copy</span><span class="op" id="4861408">(</span><span class="ident" id="4861409">val</span><span class="op" id="4861412">,</span>&nbsp;<span class="ident" id="4861414">reflect</span><span class="op" id="4861421">.</span><span class="ident" id="4861422">ValueOf</span><span class="op" id="4861429">(</span><span class="ident" id="4861430">innerBytes</span><span class="op" id="4861440">)</span><span class="op" id="4861441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861446">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4861455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861459">newSlice</span><span class="op" id="4861467">,</span>&nbsp;<span class="ident" id="4861469">err1</span>&nbsp;<span class="op" id="4861474">:=</span>&nbsp;<span class="ident" id="4861477">parseSequenceOf</span><span class="op" id="4861492">(</span><span class="ident" id="4861493">innerBytes</span><span class="op" id="4861503">,</span>&nbsp;<span class="ident" id="4861505">sliceType</span><span class="op" id="4861514">,</span>&nbsp;<span class="ident" id="4861516">sliceType</span><span class="op" id="4861525">.</span><span class="ident" id="4861526">Elem</span><span class="op" id="4861530">(</span><span class="op" id="4861531">)</span><span class="op" id="4861532">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861536">if</span>&nbsp;<span class="ident" id="4861539">err1</span>&nbsp;<span class="op" id="4861544">==</span>&nbsp;<span class="ident" id="4861547">nil</span>&nbsp;<span class="op" id="4861551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861556">val</span><span class="op" id="4861559">.</span><span class="ident" id="4861560">Set</span><span class="op" id="4861563">(</span><span class="ident" id="4861564">newSlice</span><span class="op" id="4861572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4861576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861580">err</span>&nbsp;<span class="op" id="4861584">=</span>&nbsp;<span class="ident" id="4861586">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861593">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861601">case</span>&nbsp;<span class="ident" id="4861606">reflect</span><span class="op" id="4861613">.</span><span class="ident" id="4861614">String</span><span class="op" id="4861620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861624">var</span>&nbsp;<span class="ident" id="4861628">v</span>&nbsp;<span class="builtintype" id="4861630">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861639">switch</span>&nbsp;<span class="ident" id="4861646">universalTag</span>&nbsp;<span class="op" id="4861659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861663">case</span>&nbsp;<span class="ident" id="4861668">tagPrintableString</span><span class="op" id="4861686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861691">v</span><span class="op" id="4861692">,</span>&nbsp;<span class="ident" id="4861694">err</span>&nbsp;<span class="op" id="4861698">=</span>&nbsp;<span class="ident" id="4861700">parsePrintableString</span><span class="op" id="4861720">(</span><span class="ident" id="4861721">innerBytes</span><span class="op" id="4861731">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861735">case</span>&nbsp;<span class="ident" id="4861740">tagIA5String</span><span class="op" id="4861752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861757">v</span><span class="op" id="4861758">,</span>&nbsp;<span class="ident" id="4861760">err</span>&nbsp;<span class="op" id="4861764">=</span>&nbsp;<span class="ident" id="4861766">parseIA5String</span><span class="op" id="4861780">(</span><span class="ident" id="4861781">innerBytes</span><span class="op" id="4861791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861795">case</span>&nbsp;<span class="ident" id="4861800">tagT61String</span><span class="op" id="4861812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861817">v</span><span class="op" id="4861818">,</span>&nbsp;<span class="ident" id="4861820">err</span>&nbsp;<span class="op" id="4861824">=</span>&nbsp;<span class="ident" id="4861826">parseT61String</span><span class="op" id="4861840">(</span><span class="ident" id="4861841">innerBytes</span><span class="op" id="4861851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861855">case</span>&nbsp;<span class="ident" id="4861860">tagUTF8String</span><span class="op" id="4861873">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4861878">v</span><span class="op" id="4861879">,</span>&nbsp;<span class="ident" id="4861881">err</span>&nbsp;<span class="op" id="4861885">=</span>&nbsp;<span class="ident" id="4861887">parseUTF8String</span><span class="op" id="4861902">(</span><span class="ident" id="4861903">innerBytes</span><span class="op" id="4861913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4861917">case</span>&nbsp;<span class="ident" id="4861922">tagGeneralString</span><span class="op" id="4861938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4861943">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4861997">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4862055">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4862109">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4862164">v</span><span class="op" id="4862165">,</span>&nbsp;<span class="ident" id="4862167">err</span>&nbsp;<span class="op" id="4862171">=</span>&nbsp;<span class="ident" id="4862173">parseT61String</span><span class="op" id="4862187">(</span><span class="ident" id="4862188">innerBytes</span><span class="op" id="4862198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862202">default</span><span class="op" id="4862209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4862214">err</span>&nbsp;<span class="op" id="4862218">=</span>&nbsp;<span class="ident" id="4862220">SyntaxError</span><span class="op" id="4862231">{</span><span class="ident" id="4862232">fmt</span><span class="op" id="4862235">.</span><span class="ident" id="4862236">Sprintf</span><span class="op" id="4862243">(</span><span class="string" id="4862244">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4862284">,</span>&nbsp;<span class="ident" id="4862286">universalTag</span><span class="op" id="4862298">)</span><span class="op" id="4862299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4862303">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862307">if</span>&nbsp;<span class="ident" id="4862310">err</span>&nbsp;<span class="op" id="4862314">==</span>&nbsp;<span class="ident" id="4862317">nil</span>&nbsp;<span class="op" id="4862321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4862326">val</span><span class="op" id="4862329">.</span><span class="ident" id="4862330">SetString</span><span class="op" id="4862339">(</span><span class="ident" id="4862340">v</span><span class="op" id="4862341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4862345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862349">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4862357">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4862360">err</span>&nbsp;<span class="op" id="4862364">=</span>&nbsp;<span class="ident" id="4862366">StructuralError</span><span class="op" id="4862381">{</span><span class="string" id="4862382">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4862398">+</span>&nbsp;<span class="ident" id="4862400">v</span><span class="op" id="4862401">.</span><span class="ident" id="4862402">Type</span><span class="op" id="4862406">(</span><span class="op" id="4862407">)</span><span class="op" id="4862408">.</span><span class="ident" id="4862409">String</span><span class="op" id="4862415">(</span><span class="op" id="4862416">)</span><span class="op" id="4862417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862420">return</span><br>
<span class="lineno"></span><span class="op" id="4862427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4862430">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4862508">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4862555">func</span>&nbsp;<span class="ident" id="4862560">canHaveDefaultValue</span><span class="op" id="4862579">(</span><span class="ident" id="4862580">k</span>&nbsp;<span class="ident" id="4862582">reflect</span><span class="op" id="4862589">.</span><span class="ident" id="4862590">Kind</span><span class="op" id="4862594">)</span>&nbsp;<span class="builtintype" id="4862596">bool</span>&nbsp;<span class="op" id="4862601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862604">switch</span>&nbsp;<span class="ident" id="4862611">k</span>&nbsp;<span class="op" id="4862613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862616">case</span>&nbsp;<span class="ident" id="4862621">reflect</span><span class="op" id="4862628">.</span><span class="ident" id="4862629">Int</span><span class="op" id="4862632">,</span>&nbsp;<span class="ident" id="4862634">reflect</span><span class="op" id="4862641">.</span><span class="ident" id="4862642">Int8</span><span class="op" id="4862646">,</span>&nbsp;<span class="ident" id="4862648">reflect</span><span class="op" id="4862655">.</span><span class="ident" id="4862656">Int16</span><span class="op" id="4862661">,</span>&nbsp;<span class="ident" id="4862663">reflect</span><span class="op" id="4862670">.</span><span class="ident" id="4862671">Int32</span><span class="op" id="4862676">,</span>&nbsp;<span class="ident" id="4862678">reflect</span><span class="op" id="4862685">.</span><span class="ident" id="4862686">Int64</span><span class="op" id="4862691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862695">return</span>&nbsp;<span class="builtintype" id="4862702">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4862708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4862712">return</span>&nbsp;<span class="builtintype" id="4862719">false</span><br>
<span class="lineno"></span><span class="op" id="4862725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4862728">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4862807">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4862887">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4862949">func</span>&nbsp;<span class="ident" id="4862954">setDefaultValue</span><span class="op" id="4862969">(</span><span class="ident" id="4862970">v</span>&nbsp;<span class="ident" id="4862972">reflect</span><span class="op" id="4862979">.</span><span class="ident" id="4862980">Value</span><span class="op" id="4862985">,</span>&nbsp;<span class="ident" id="4862987">params</span>&nbsp;<span class="ident" id="4862994">fieldParameters</span><span class="op" id="4863009">)</span>&nbsp;<span class="op" id="4863011">(</span><span class="ident" id="4863012">ok</span>&nbsp;<span class="builtintype" id="4863015">bool</span><span class="op" id="4863019">)</span>&nbsp;<span class="op" id="4863021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4863024">if</span>&nbsp;<span class="op" id="4863027">!</span><span class="ident" id="4863028">params</span><span class="op" id="4863034">.</span><span class="ident" id="4863035">optional</span>&nbsp;<span class="op" id="4863044">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4863048">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4863056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4863059">ok</span>&nbsp;<span class="op" id="4863062">=</span>&nbsp;<span class="builtintype" id="4863064">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4863070">if</span>&nbsp;<span class="ident" id="4863073">params</span><span class="op" id="4863079">.</span><span class="ident" id="4863080">defaultValue</span>&nbsp;<span class="op" id="4863093">==</span>&nbsp;<span class="ident" id="4863096">nil</span>&nbsp;<span class="op" id="4863100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4863104">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4863112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4863115">if</span>&nbsp;<span class="ident" id="4863118">canHaveDefaultValue</span><span class="op" id="4863137">(</span><span class="ident" id="4863138">v</span><span class="op" id="4863139">.</span><span class="ident" id="4863140">Kind</span><span class="op" id="4863144">(</span><span class="op" id="4863145">)</span><span class="op" id="4863146">)</span>&nbsp;<span class="op" id="4863148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4863152">v</span><span class="op" id="4863153">.</span><span class="ident" id="4863154">SetInt</span><span class="op" id="4863160">(</span><span class="op" id="4863161">*</span><span class="ident" id="4863162">params</span><span class="op" id="4863168">.</span><span class="ident" id="4863169">defaultValue</span><span class="op" id="4863181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4863184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4863187">return</span><br>
<span class="lineno">855</span><span class="op" id="4863194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4863197">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4863256">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4863337">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4863396">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4863449">//</span><br>
<span class="lineno"></span><span class="comment" id="4863452">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4863512">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4863556">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4863609">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4863645">//</span><br>
<span class="lineno"></span><span class="comment" id="4863648">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4863702">//</span><br>
<span class="lineno"></span><span class="comment" id="4863705">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4863758">//</span><br>
<span class="lineno"></span><span class="comment" id="4863761">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4863812">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4863833">//</span><br>
<span class="lineno"></span><span class="comment" id="4863836">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4863892">//</span><br>
<span class="lineno"></span><span class="comment" id="4863895">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4863965">//</span><br>
<span class="lineno"></span><span class="comment" id="4863968">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4864037">//</span><br>
<span class="lineno">880</span><span class="comment" id="4864040">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4864107">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4864175">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4864212">//</span><br>
<span class="lineno"></span><span class="comment" id="4864215">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4864268">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4864334">//</span><br>
<span class="lineno"></span><span class="comment" id="4864337">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4864392">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4864442">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4864497">//</span><br>
<span class="lineno"></span><span class="comment" id="4864500">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4864574">//</span><br>
<span class="lineno"></span><span class="comment" id="4864577">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4864633">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4864697">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4864775">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4864821">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4864886">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4864959">//</span><br>
<span class="lineno">900</span><span class="comment" id="4864962">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4865038">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4865091">//</span><br>
<span class="lineno"></span><span class="comment" id="4865094">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4865173">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4865249">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4865280">//</span><br>
<span class="lineno"></span><span class="comment" id="4865283">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4865346">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4865382">func</span>&nbsp;<span class="ident" id="4865387">Unmarshal</span><span class="op" id="4865396">(</span><span class="ident" id="4865397">b</span>&nbsp;<span class="op" id="4865399">[</span><span class="op" id="4865400">]</span><span class="builtintype" id="4865401">byte</span><span class="op" id="4865405">,</span>&nbsp;<span class="ident" id="4865407">val</span>&nbsp;<span class="keyword" id="4865411">interface</span><span class="op" id="4865420">{</span><span class="op" id="4865421">}</span><span class="op" id="4865422">)</span>&nbsp;<span class="op" id="4865424">(</span><span class="ident" id="4865425">rest</span>&nbsp;<span class="op" id="4865430">[</span><span class="op" id="4865431">]</span><span class="builtintype" id="4865432">byte</span><span class="op" id="4865436">,</span>&nbsp;<span class="ident" id="4865438">err</span>&nbsp;<span class="builtintype" id="4865442">error</span><span class="op" id="4865447">)</span>&nbsp;<span class="op" id="4865449">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4865452">return</span>&nbsp;<span class="ident" id="4865459">UnmarshalWithParams</span><span class="op" id="4865478">(</span><span class="ident" id="4865479">b</span><span class="op" id="4865480">,</span>&nbsp;<span class="ident" id="4865482">val</span><span class="op" id="4865485">,</span>&nbsp;<span class="string" id="4865487">&#34;&#34;</span><span class="op" id="4865489">)</span><br>
<span class="lineno"></span><span class="op" id="4865491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4865494">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4865565">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4865641">func</span>&nbsp;<span class="ident" id="4865646">UnmarshalWithParams</span><span class="op" id="4865665">(</span><span class="ident" id="4865666">b</span>&nbsp;<span class="op" id="4865668">[</span><span class="op" id="4865669">]</span><span class="builtintype" id="4865670">byte</span><span class="op" id="4865674">,</span>&nbsp;<span class="ident" id="4865676">val</span>&nbsp;<span class="keyword" id="4865680">interface</span><span class="op" id="4865689">{</span><span class="op" id="4865690">}</span><span class="op" id="4865691">,</span>&nbsp;<span class="ident" id="4865693">params</span>&nbsp;<span class="builtintype" id="4865700">string</span><span class="op" id="4865706">)</span>&nbsp;<span class="op" id="4865708">(</span><span class="ident" id="4865709">rest</span>&nbsp;<span class="op" id="4865714">[</span><span class="op" id="4865715">]</span><span class="builtintype" id="4865716">byte</span><span class="op" id="4865720">,</span>&nbsp;<span class="ident" id="4865722">err</span>&nbsp;<span class="builtintype" id="4865726">error</span><span class="op" id="4865731">)</span>&nbsp;<span class="op" id="4865733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4865736">v</span>&nbsp;<span class="op" id="4865738">:=</span>&nbsp;<span class="ident" id="4865741">reflect</span><span class="op" id="4865748">.</span><span class="ident" id="4865749">ValueOf</span><span class="op" id="4865756">(</span><span class="ident" id="4865757">val</span><span class="op" id="4865760">)</span><span class="op" id="4865761">.</span><span class="ident" id="4865762">Elem</span><span class="op" id="4865766">(</span><span class="op" id="4865767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4865770">offset</span><span class="op" id="4865776">,</span>&nbsp;<span class="ident" id="4865778">err</span>&nbsp;<span class="op" id="4865782">:=</span>&nbsp;<span class="ident" id="4865785">parseField</span><span class="op" id="4865795">(</span><span class="ident" id="4865796">v</span><span class="op" id="4865797">,</span>&nbsp;<span class="ident" id="4865799">b</span><span class="op" id="4865800">,</span>&nbsp;<span class="num" id="4865802">0</span><span class="op" id="4865803">,</span>&nbsp;<span class="ident" id="4865805">parseFieldParameters</span><span class="op" id="4865825">(</span><span class="ident" id="4865826">params</span><span class="op" id="4865832">)</span><span class="op" id="4865833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4865836">if</span>&nbsp;<span class="ident" id="4865839">err</span>&nbsp;<span class="op" id="4865843">!=</span>&nbsp;<span class="ident" id="4865846">nil</span>&nbsp;<span class="op" id="4865850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4865854">return</span>&nbsp;<span class="ident" id="4865861">nil</span><span class="op" id="4865864">,</span>&nbsp;<span class="ident" id="4865866">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4865871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4865874">return</span>&nbsp;<span class="ident" id="4865881">b</span><span class="op" id="4865882">[</span><span class="ident" id="4865883">offset</span><span class="op" id="4865889">:</span><span class="op" id="4865890">]</span><span class="op" id="4865891">,</span>&nbsp;<span class="ident" id="4865893">nil</span><br>
<span class="lineno"></span><span class="op" id="4865897">}</span>
</div>
</body>
</html>
