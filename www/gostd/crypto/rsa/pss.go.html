<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html" class="current">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4733967">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4734022">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4734076">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4734127">package</span>&nbsp;<span class="ident" id="4734135">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4734140">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;the&nbsp;PSS&nbsp;signature&nbsp;scheme&nbsp;[1].</span><br>
<span class="lineno"></span><span class="comment" id="4734194">//</span><br>
<span class="lineno"></span><span class="comment" id="4734197">//&nbsp;[1]&nbsp;http://www.rsa.com/rsalabs/pkcs/files/h11300-wp-pkcs-1v2-2-rsa-cryptography-standard.pdf</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4734294">import</span>&nbsp;<span class="op" id="4734301">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734304">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734313">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734323">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734333">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734341">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4734347">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4734358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="4734361">func</span>&nbsp;<span class="ident" id="4734366">emsaPSSEncode</span><span class="op" id="4734379">(</span><span class="ident" id="4734380">mHash</span>&nbsp;<span class="op" id="4734386">[</span><span class="op" id="4734387">]</span><span class="builtintype" id="4734388">byte</span><span class="op" id="4734392">,</span>&nbsp;<span class="ident" id="4734394">emBits</span>&nbsp;<span class="builtintype" id="4734401">int</span><span class="op" id="4734404">,</span>&nbsp;<span class="ident" id="4734406">salt</span>&nbsp;<span class="op" id="4734411">[</span><span class="op" id="4734412">]</span><span class="builtintype" id="4734413">byte</span><span class="op" id="4734417">,</span>&nbsp;<span class="ident" id="4734419">hash</span>&nbsp;<span class="ident" id="4734424"><a href="/gostd/crypto/rsa/pss.go.html#4734333">hash</a></span><span class="op" id="4734428">.</span><span class="ident" id="4734429"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4734433">)</span>&nbsp;<span class="op" id="4734435">(</span><span class="op" id="4734436">[</span><span class="op" id="4734437">]</span><span class="builtintype" id="4734438">byte</span><span class="op" id="4734442">,</span>&nbsp;<span class="builtintype" id="4734444">error</span><span class="op" id="4734449">)</span>&nbsp;<span class="op" id="4734451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734454">//&nbsp;See&nbsp;[1],&nbsp;section&nbsp;9.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4734481">hLen</span>&nbsp;<span class="op" id="4734486">:=</span>&nbsp;<span class="ident" id="4734489"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4734493">.</span><span class="ident" id="4734494"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4734498">(</span><span class="op" id="4734499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4734502">sLen</span>&nbsp;<span class="op" id="4734507">:=</span>&nbsp;<span class="builtinfunc" id="4734510">len</span><span class="op" id="4734513">(</span><span class="ident" id="4734514"><a href="/gostd/crypto/rsa/pss.go.html#4734406">salt</a></span><span class="op" id="4734518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4734521">emLen</span>&nbsp;<span class="op" id="4734527">:=</span>&nbsp;<span class="op" id="4734530">(</span><span class="ident" id="4734531"><a href="/gostd/crypto/rsa/pss.go.html#4734394">emBits</a></span>&nbsp;<span class="op" id="4734538">+</span>&nbsp;<span class="num" id="4734540">7</span><span class="op" id="4734541">)</span>&nbsp;<span class="op" id="4734543">/</span>&nbsp;<span class="num" id="4734545">8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734549">//&nbsp;1.&nbsp;&nbsp;If&nbsp;the&nbsp;length&nbsp;of&nbsp;M&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;input&nbsp;limitation&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734621">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;function&nbsp;(2^61&nbsp;-&nbsp;1&nbsp;octets&nbsp;for&nbsp;SHA-1),&nbsp;output&nbsp;&#34;message&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734692">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734716">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734720">//&nbsp;2.&nbsp;&nbsp;Let&nbsp;mHash&nbsp;=&nbsp;Hash(M),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4734782">if</span>&nbsp;<span class="builtinfunc" id="4734785">len</span><span class="op" id="4734788">(</span><span class="ident" id="4734789"><a href="/gostd/crypto/rsa/pss.go.html#4734380">mHash</a></span><span class="op" id="4734794">)</span>&nbsp;<span class="op" id="4734796">!=</span>&nbsp;<span class="ident" id="4734799"><a href="/gostd/crypto/rsa/pss.go.html#4734481">hLen</a></span>&nbsp;<span class="op" id="4734804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4734808">return</span>&nbsp;<span class="builtintype" id="4734815">nil</span><span class="op" id="4734818">,</span>&nbsp;<span class="ident" id="4734820"><a href="/gostd/crypto/rsa/pss.go.html#4734323">errors</a></span><span class="op" id="4734826">.</span><span class="ident" id="4734827"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4734830">(</span><span class="string" id="4734831">&#34;crypto/rsa:&nbsp;input&nbsp;must&nbsp;be&nbsp;hashed&nbsp;message&#34;</span><span class="op" id="4734873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4734876">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4734880">//&nbsp;3.&nbsp;&nbsp;If&nbsp;emLen&nbsp;&lt;&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;+&nbsp;2,&nbsp;output&nbsp;&#34;encoding&nbsp;error&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4734951">if</span>&nbsp;<span class="ident" id="4734954"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span>&nbsp;<span class="op" id="4734960">&lt;</span>&nbsp;<span class="ident" id="4734962"><a href="/gostd/crypto/rsa/pss.go.html#4734481">hLen</a></span><span class="op" id="4734966">+</span><span class="ident" id="4734967"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span><span class="op" id="4734971">+</span><span class="num" id="4734972">2</span>&nbsp;<span class="op" id="4734974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4734978">return</span>&nbsp;<span class="builtintype" id="4734985">nil</span><span class="op" id="4734988">,</span>&nbsp;<span class="ident" id="4734990"><a href="/gostd/crypto/rsa/pss.go.html#4734323">errors</a></span><span class="op" id="4734996">.</span><span class="ident" id="4734997"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4735000">(</span><span class="string" id="4735001">&#34;crypto/rsa:&nbsp;encoding&nbsp;error&#34;</span><span class="op" id="4735029">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4735032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735036">em</span>&nbsp;<span class="op" id="4735039">:=</span>&nbsp;<span class="builtinfunc" id="4735042">make</span><span class="op" id="4735046">(</span><span class="op" id="4735047">[</span><span class="op" id="4735048">]</span><span class="builtintype" id="4735049">byte</span><span class="op" id="4735053">,</span>&nbsp;<span class="ident" id="4735055"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4735060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735063">db</span>&nbsp;<span class="op" id="4735066">:=</span>&nbsp;<span class="ident" id="4735069"><a href="/gostd/crypto/rsa/pss.go.html#4735036">em</a></span><span class="op" id="4735071">[</span><span class="op" id="4735072">:</span><span class="ident" id="4735073"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4735078">-</span><span class="ident" id="4735079"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span><span class="op" id="4735083">-</span><span class="ident" id="4735084"><a href="/gostd/crypto/rsa/pss.go.html#4734481">hLen</a></span><span class="op" id="4735088">-</span><span class="num" id="4735089">2</span><span class="op" id="4735090">+</span><span class="num" id="4735091">1</span><span class="op" id="4735092">+</span><span class="ident" id="4735093"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span><span class="op" id="4735097">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735100">h</span>&nbsp;<span class="op" id="4735102">:=</span>&nbsp;<span class="ident" id="4735105"><a href="/gostd/crypto/rsa/pss.go.html#4735036">em</a></span><span class="op" id="4735107">[</span><span class="ident" id="4735108"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4735113">-</span><span class="ident" id="4735114"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span><span class="op" id="4735118">-</span><span class="ident" id="4735119"><a href="/gostd/crypto/rsa/pss.go.html#4734481">hLen</a></span><span class="op" id="4735123">-</span><span class="num" id="4735124">2</span><span class="op" id="4735125">+</span><span class="num" id="4735126">1</span><span class="op" id="4735127">+</span><span class="ident" id="4735128"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span>&nbsp;<span class="op" id="4735133">:</span>&nbsp;<span class="ident" id="4735135"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4735140">-</span><span class="num" id="4735141">1</span><span class="op" id="4735142">]</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735146">//&nbsp;4.&nbsp;&nbsp;Generate&nbsp;a&nbsp;random&nbsp;octet&nbsp;string&nbsp;salt&nbsp;of&nbsp;length&nbsp;sLen;&nbsp;if&nbsp;sLen&nbsp;=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735219">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;salt&nbsp;is&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735258">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735262">//&nbsp;5.&nbsp;&nbsp;Let</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735274">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;=&nbsp;(0x)00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;||&nbsp;mHash&nbsp;||&nbsp;salt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735335">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;8&nbsp;+&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;with&nbsp;eight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735406">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;zero&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735435">//</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735439">//&nbsp;6.&nbsp;&nbsp;Let&nbsp;H&nbsp;=&nbsp;Hash(M&#39;),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4735498">var</span>&nbsp;<span class="ident" id="4735502">prefix</span>&nbsp;<span class="op" id="4735509">[</span><span class="num" id="4735510">8</span><span class="op" id="4735511">]</span><span class="builtintype" id="4735512">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735519"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4735523">.</span><span class="ident" id="4735524"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4735529">(</span><span class="ident" id="4735530"><a href="/gostd/crypto/rsa/pss.go.html#4735502">prefix</a></span><span class="op" id="4735536">[</span><span class="op" id="4735537">:</span><span class="op" id="4735538">]</span><span class="op" id="4735539">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735542"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4735546">.</span><span class="ident" id="4735547"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4735552">(</span><span class="ident" id="4735553"><a href="/gostd/crypto/rsa/pss.go.html#4734380">mHash</a></span><span class="op" id="4735558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735561"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4735565">.</span><span class="ident" id="4735566"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4735571">(</span><span class="ident" id="4735572"><a href="/gostd/crypto/rsa/pss.go.html#4734406">salt</a></span><span class="op" id="4735576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735580"><a href="/gostd/crypto/rsa/pss.go.html#4735100">h</a></span>&nbsp;<span class="op" id="4735582">=</span>&nbsp;<span class="ident" id="4735584"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4735588">.</span><span class="ident" id="4735589"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4735592">(</span><span class="ident" id="4735593"><a href="/gostd/crypto/rsa/pss.go.html#4735100">h</a></span><span class="op" id="4735594">[</span><span class="op" id="4735595">:</span><span class="num" id="4735596">0</span><span class="op" id="4735597">]</span><span class="op" id="4735598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735601"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4735605">.</span><span class="ident" id="4735606"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4735611">(</span><span class="op" id="4735612">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735616">//&nbsp;7.&nbsp;&nbsp;Generate&nbsp;an&nbsp;octet&nbsp;string&nbsp;PS&nbsp;consisting&nbsp;of&nbsp;emLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;octets.&nbsp;&nbsp;The&nbsp;length&nbsp;of&nbsp;PS&nbsp;may&nbsp;be&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735739">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735743">//&nbsp;8.&nbsp;&nbsp;Let&nbsp;DB&nbsp;=&nbsp;PS&nbsp;||&nbsp;0x01&nbsp;||&nbsp;salt;&nbsp;DB&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735812">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735839"><a href="/gostd/crypto/rsa/pss.go.html#4735063">db</a></span><span class="op" id="4735841">[</span><span class="ident" id="4735842"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4735847">-</span><span class="ident" id="4735848"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span><span class="op" id="4735852">-</span><span class="ident" id="4735853"><a href="/gostd/crypto/rsa/pss.go.html#4734481">hLen</a></span><span class="op" id="4735857">-</span><span class="num" id="4735858">2</span><span class="op" id="4735859">]</span>&nbsp;<span class="op" id="4735861">=</span>&nbsp;<span class="num" id="4735863">0x01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4735869">copy</span><span class="op" id="4735873">(</span><span class="ident" id="4735874"><a href="/gostd/crypto/rsa/pss.go.html#4735063">db</a></span><span class="op" id="4735876">[</span><span class="ident" id="4735877"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4735882">-</span><span class="ident" id="4735883"><a href="/gostd/crypto/rsa/pss.go.html#4734502">sLen</a></span><span class="op" id="4735887">-</span><span class="ident" id="4735888"><a href="/gostd/crypto/rsa/pss.go.html#4734481">hLen</a></span><span class="op" id="4735892">-</span><span class="num" id="4735893">1</span><span class="op" id="4735894">:</span><span class="op" id="4735895">]</span><span class="op" id="4735896">,</span>&nbsp;<span class="ident" id="4735898"><a href="/gostd/crypto/rsa/pss.go.html#4734406">salt</a></span><span class="op" id="4735902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735906">//&nbsp;9.&nbsp;&nbsp;Let&nbsp;dbMask&nbsp;=&nbsp;MGF(H,&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735953">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4735957">//&nbsp;10.&nbsp;Let&nbsp;maskedDB&nbsp;=&nbsp;DB&nbsp;\xor&nbsp;dbMask.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4735997"><a href="/gostd/crypto/rsa/rsa.go.html#4750085">mgf1XOR</a></span><span class="op" id="4736004">(</span><span class="ident" id="4736005"><a href="/gostd/crypto/rsa/pss.go.html#4735063">db</a></span><span class="op" id="4736007">,</span>&nbsp;<span class="ident" id="4736009"><a href="/gostd/crypto/rsa/pss.go.html#4734419">hash</a></span><span class="op" id="4736013">,</span>&nbsp;<span class="ident" id="4736015"><a href="/gostd/crypto/rsa/pss.go.html#4735100">h</a></span><span class="op" id="4736016">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736020">//&nbsp;11.&nbsp;Set&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736094">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskedDB&nbsp;to&nbsp;zero.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4736121"><a href="/gostd/crypto/rsa/pss.go.html#4735063">db</a></span><span class="op" id="4736123">[</span><span class="num" id="4736124">0</span><span class="op" id="4736125">]</span>&nbsp;<span class="op" id="4736127">&amp;=</span>&nbsp;<span class="op" id="4736130">(</span><span class="num" id="4736131">0xFF</span>&nbsp;<span class="op" id="4736136">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4736139">uint</span><span class="op" id="4736143">(</span><span class="num" id="4736144">8</span><span class="op" id="4736145">*</span><span class="ident" id="4736146"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4736151">-</span><span class="ident" id="4736152"><a href="/gostd/crypto/rsa/pss.go.html#4734394">emBits</a></span><span class="op" id="4736158">)</span><span class="op" id="4736159">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736163">//&nbsp;12.&nbsp;Let&nbsp;EM&nbsp;=&nbsp;maskedDB&nbsp;||&nbsp;H&nbsp;||&nbsp;0xbc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4736203"><a href="/gostd/crypto/rsa/pss.go.html#4735036">em</a></span><span class="op" id="4736205">[</span><span class="ident" id="4736206"><a href="/gostd/crypto/rsa/pss.go.html#4734521">emLen</a></span><span class="op" id="4736211">-</span><span class="num" id="4736212">1</span><span class="op" id="4736213">]</span>&nbsp;<span class="op" id="4736215">=</span>&nbsp;<span class="num" id="4736217">0xBC</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736224">//&nbsp;13.&nbsp;Output&nbsp;EM.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736243">return</span>&nbsp;<span class="ident" id="4736250"><a href="/gostd/crypto/rsa/pss.go.html#4735036">em</a></span><span class="op" id="4736252">,</span>&nbsp;<span class="builtintype" id="4736254">nil</span><br>
<span class="lineno"></span><span class="op" id="4736258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4736261">func</span>&nbsp;<span class="ident" id="4736266">emsaPSSVerify</span><span class="op" id="4736279">(</span><span class="ident" id="4736280">mHash</span><span class="op" id="4736285">,</span>&nbsp;<span class="ident" id="4736287">em</span>&nbsp;<span class="op" id="4736290">[</span><span class="op" id="4736291">]</span><span class="builtintype" id="4736292">byte</span><span class="op" id="4736296">,</span>&nbsp;<span class="ident" id="4736298">emBits</span><span class="op" id="4736304">,</span>&nbsp;<span class="ident" id="4736306">sLen</span>&nbsp;<span class="builtintype" id="4736311">int</span><span class="op" id="4736314">,</span>&nbsp;<span class="ident" id="4736316">hash</span>&nbsp;<span class="ident" id="4736321"><a href="/gostd/crypto/rsa/pss.go.html#4734333">hash</a></span><span class="op" id="4736325">.</span><span class="ident" id="4736326"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4736330">)</span>&nbsp;<span class="builtintype" id="4736332">error</span>&nbsp;<span class="op" id="4736338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736341">//&nbsp;1.&nbsp;&nbsp;If&nbsp;the&nbsp;length&nbsp;of&nbsp;M&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;input&nbsp;limitation&nbsp;for&nbsp;the</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736413">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;function&nbsp;(2^61&nbsp;-&nbsp;1&nbsp;octets&nbsp;for&nbsp;SHA-1),&nbsp;output&nbsp;&#34;inconsistent&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736486">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736504">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736508">//&nbsp;2.&nbsp;&nbsp;Let&nbsp;mHash&nbsp;=&nbsp;Hash(M),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4736569">hLen</span>&nbsp;<span class="op" id="4736574">:=</span>&nbsp;<span class="ident" id="4736577"><a href="/gostd/crypto/rsa/pss.go.html#4736316">hash</a></span><span class="op" id="4736581">.</span><span class="ident" id="4736582"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4736586">(</span><span class="op" id="4736587">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736590">if</span>&nbsp;<span class="ident" id="4736593"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span>&nbsp;<span class="op" id="4736598">!=</span>&nbsp;<span class="builtinfunc" id="4736601">len</span><span class="op" id="4736604">(</span><span class="ident" id="4736605"><a href="/gostd/crypto/rsa/pss.go.html#4736280">mHash</a></span><span class="op" id="4736610">)</span>&nbsp;<span class="op" id="4736612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736616">return</span>&nbsp;<span class="ident" id="4736623"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4736640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736644">//&nbsp;3.&nbsp;&nbsp;If&nbsp;emLen&nbsp;&lt;&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;+&nbsp;2,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4736712">emLen</span>&nbsp;<span class="op" id="4736718">:=</span>&nbsp;<span class="op" id="4736721">(</span><span class="ident" id="4736722"><a href="/gostd/crypto/rsa/pss.go.html#4736298">emBits</a></span>&nbsp;<span class="op" id="4736729">+</span>&nbsp;<span class="num" id="4736731">7</span><span class="op" id="4736732">)</span>&nbsp;<span class="op" id="4736734">/</span>&nbsp;<span class="num" id="4736736">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736739">if</span>&nbsp;<span class="ident" id="4736742"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span>&nbsp;<span class="op" id="4736748">&lt;</span>&nbsp;<span class="ident" id="4736750"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span><span class="op" id="4736754">+</span><span class="ident" id="4736755"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span><span class="op" id="4736759">+</span><span class="num" id="4736760">2</span>&nbsp;<span class="op" id="4736762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736766">return</span>&nbsp;<span class="ident" id="4736773"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4736790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736794">//&nbsp;4.&nbsp;&nbsp;If&nbsp;the&nbsp;rightmost&nbsp;octet&nbsp;of&nbsp;EM&nbsp;does&nbsp;not&nbsp;have&nbsp;hexadecimal&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736863">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbc,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736909">if</span>&nbsp;<span class="ident" id="4736912"><a href="/gostd/crypto/rsa/pss.go.html#4736287">em</a></span><span class="op" id="4736914">[</span><span class="builtinfunc" id="4736915">len</span><span class="op" id="4736918">(</span><span class="ident" id="4736919"><a href="/gostd/crypto/rsa/pss.go.html#4736287">em</a></span><span class="op" id="4736921">)</span><span class="op" id="4736922">-</span><span class="num" id="4736923">1</span><span class="op" id="4736924">]</span>&nbsp;<span class="op" id="4736926">!=</span>&nbsp;<span class="num" id="4736929">0xBC</span>&nbsp;<span class="op" id="4736934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4736938">return</span>&nbsp;<span class="ident" id="4736945"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4736962">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4736966">//&nbsp;5.&nbsp;&nbsp;Let&nbsp;maskedDB&nbsp;be&nbsp;the&nbsp;leftmost&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1&nbsp;octets&nbsp;of&nbsp;EM,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737038">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;H&nbsp;be&nbsp;the&nbsp;next&nbsp;hLen&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4737077">db</span>&nbsp;<span class="op" id="4737080">:=</span>&nbsp;<span class="ident" id="4737083"><a href="/gostd/crypto/rsa/pss.go.html#4736287">em</a></span><span class="op" id="4737085">[</span><span class="op" id="4737086">:</span><span class="ident" id="4737087"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4737092">-</span><span class="ident" id="4737093"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span><span class="op" id="4737097">-</span><span class="num" id="4737098">1</span><span class="op" id="4737099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4737102">h</span>&nbsp;<span class="op" id="4737104">:=</span>&nbsp;<span class="ident" id="4737107"><a href="/gostd/crypto/rsa/pss.go.html#4736287">em</a></span><span class="op" id="4737109">[</span><span class="ident" id="4737110"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4737115">-</span><span class="ident" id="4737116"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span><span class="op" id="4737120">-</span><span class="num" id="4737121">1</span>&nbsp;<span class="op" id="4737123">:</span>&nbsp;<span class="builtinfunc" id="4737125">len</span><span class="op" id="4737128">(</span><span class="ident" id="4737129"><a href="/gostd/crypto/rsa/pss.go.html#4736287">em</a></span><span class="op" id="4737131">)</span><span class="op" id="4737132">-</span><span class="num" id="4737133">1</span><span class="op" id="4737134">]</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737138">//&nbsp;6.&nbsp;&nbsp;If&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737211">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskedDB&nbsp;are&nbsp;not&nbsp;all&nbsp;equal&nbsp;to&nbsp;zero,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737295">if</span>&nbsp;<span class="ident" id="4737298"><a href="/gostd/crypto/rsa/pss.go.html#4736287">em</a></span><span class="op" id="4737300">[</span><span class="num" id="4737301">0</span><span class="op" id="4737302">]</span><span class="op" id="4737303">&amp;</span><span class="op" id="4737304">(</span><span class="num" id="4737305">0xFF</span><span class="op" id="4737309">&lt;&lt;</span><span class="builtintype" id="4737311">uint</span><span class="op" id="4737315">(</span><span class="num" id="4737316">8</span><span class="op" id="4737317">-</span><span class="op" id="4737318">(</span><span class="num" id="4737319">8</span><span class="op" id="4737320">*</span><span class="ident" id="4737321"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4737326">-</span><span class="ident" id="4737327"><a href="/gostd/crypto/rsa/pss.go.html#4736298">emBits</a></span><span class="op" id="4737333">)</span><span class="op" id="4737334">)</span><span class="op" id="4737335">)</span>&nbsp;<span class="op" id="4737337">!=</span>&nbsp;<span class="num" id="4737340">0</span>&nbsp;<span class="op" id="4737342">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737346">return</span>&nbsp;<span class="ident" id="4737353"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4737370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737374">//&nbsp;7.&nbsp;&nbsp;Let&nbsp;dbMask&nbsp;=&nbsp;MGF(H,&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737421">//</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737425">//&nbsp;8.&nbsp;&nbsp;Let&nbsp;DB&nbsp;=&nbsp;maskedDB&nbsp;\xor&nbsp;dbMask.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4737464"><a href="/gostd/crypto/rsa/rsa.go.html#4750085">mgf1XOR</a></span><span class="op" id="4737471">(</span><span class="ident" id="4737472"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4737474">,</span>&nbsp;<span class="ident" id="4737476"><a href="/gostd/crypto/rsa/pss.go.html#4736316">hash</a></span><span class="op" id="4737480">,</span>&nbsp;<span class="ident" id="4737482"><a href="/gostd/crypto/rsa/pss.go.html#4737102">h</a></span><span class="op" id="4737483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737487">//&nbsp;9.&nbsp;&nbsp;Set&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in&nbsp;DB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737564">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;zero.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4737581"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4737583">[</span><span class="num" id="4737584">0</span><span class="op" id="4737585">]</span>&nbsp;<span class="op" id="4737587">&amp;=</span>&nbsp;<span class="op" id="4737590">(</span><span class="num" id="4737591">0xFF</span>&nbsp;<span class="op" id="4737596">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4737599">uint</span><span class="op" id="4737603">(</span><span class="num" id="4737604">8</span><span class="op" id="4737605">*</span><span class="ident" id="4737606"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4737611">-</span><span class="ident" id="4737612"><a href="/gostd/crypto/rsa/pss.go.html#4736298">emBits</a></span><span class="op" id="4737618">)</span><span class="op" id="4737619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737623">if</span>&nbsp;<span class="ident" id="4737626"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span>&nbsp;<span class="op" id="4737631">==</span>&nbsp;<span class="ident" id="4737634"><a href="/gostd/crypto/rsa/pss.go.html#4739755">PSSSaltLengthAuto</a></span>&nbsp;<span class="op" id="4737652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4737655">FindSaltLength</span><span class="op" id="4737669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737673">for</span>&nbsp;<span class="ident" id="4737677"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span>&nbsp;<span class="op" id="4737682">=</span>&nbsp;<span class="ident" id="4737684"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span>&nbsp;<span class="op" id="4737690">-</span>&nbsp;<span class="op" id="4737692">(</span><span class="ident" id="4737693"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span>&nbsp;<span class="op" id="4737698">+</span>&nbsp;<span class="num" id="4737700">2</span><span class="op" id="4737701">)</span><span class="op" id="4737702">;</span>&nbsp;<span class="ident" id="4737704"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span>&nbsp;<span class="op" id="4737709">&gt;=</span>&nbsp;<span class="num" id="4737712">0</span><span class="op" id="4737713">;</span>&nbsp;<span class="ident" id="4737715"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span><span class="op" id="4737719">--</span>&nbsp;<span class="op" id="4737722">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737727">switch</span>&nbsp;<span class="ident" id="4737734"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4737736">[</span><span class="ident" id="4737737"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4737742">-</span><span class="ident" id="4737743"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span><span class="op" id="4737747">-</span><span class="ident" id="4737748"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span><span class="op" id="4737752">-</span><span class="num" id="4737753">2</span><span class="op" id="4737754">]</span>&nbsp;<span class="op" id="4737756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737761">case</span>&nbsp;<span class="num" id="4737766">1</span><span class="op" id="4737767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737773">break</span>&nbsp;<span class="ident" id="4737779"><a href="/gostd/crypto/rsa/pss.go.html#4737655">FindSaltLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737797">case</span>&nbsp;<span class="num" id="4737802">0</span><span class="op" id="4737803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737809">continue</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737821">default</span><span class="op" id="4737828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737834">return</span>&nbsp;<span class="ident" id="4737841"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4737860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4737864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737868">if</span>&nbsp;<span class="ident" id="4737871"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span>&nbsp;<span class="op" id="4737876">&lt;</span>&nbsp;<span class="num" id="4737878">0</span>&nbsp;<span class="op" id="4737880">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4737885">return</span>&nbsp;<span class="ident" id="4737892"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4737910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4737913">}</span>&nbsp;<span class="keyword" id="4737915">else</span>&nbsp;<span class="op" id="4737920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737924">//&nbsp;10.&nbsp;If&nbsp;the&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;2&nbsp;leftmost&nbsp;octets&nbsp;of&nbsp;DB&nbsp;are&nbsp;not&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4737999">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;if&nbsp;the&nbsp;octet&nbsp;at&nbsp;position&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;1&nbsp;(the&nbsp;leftmost</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738074">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;is&nbsp;&#34;position&nbsp;1&#34;)&nbsp;does&nbsp;not&nbsp;have&nbsp;hexadecimal&nbsp;value&nbsp;0x01,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738147">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738188">for</span>&nbsp;<span class="ident" id="4738192">_</span><span class="op" id="4738193">,</span>&nbsp;<span class="ident" id="4738195">e</span>&nbsp;<span class="op" id="4738197">:=</span>&nbsp;<span class="keyword" id="4738200">range</span>&nbsp;<span class="ident" id="4738206"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4738208">[</span><span class="op" id="4738209">:</span><span class="ident" id="4738210"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4738215">-</span><span class="ident" id="4738216"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span><span class="op" id="4738220">-</span><span class="ident" id="4738221"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span><span class="op" id="4738225">-</span><span class="num" id="4738226">2</span><span class="op" id="4738227">]</span>&nbsp;<span class="op" id="4738229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738234">if</span>&nbsp;<span class="ident" id="4738237"><a href="/gostd/crypto/rsa/pss.go.html#4738195">e</a></span>&nbsp;<span class="op" id="4738239">!=</span>&nbsp;<span class="num" id="4738242">0x00</span>&nbsp;<span class="op" id="4738247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738253">return</span>&nbsp;<span class="ident" id="4738260"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4738279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4738283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738287">if</span>&nbsp;<span class="ident" id="4738290"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4738292">[</span><span class="ident" id="4738293"><a href="/gostd/crypto/rsa/pss.go.html#4736712">emLen</a></span><span class="op" id="4738298">-</span><span class="ident" id="4738299"><a href="/gostd/crypto/rsa/pss.go.html#4736569">hLen</a></span><span class="op" id="4738303">-</span><span class="ident" id="4738304"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span><span class="op" id="4738308">-</span><span class="num" id="4738309">2</span><span class="op" id="4738310">]</span>&nbsp;<span class="op" id="4738312">!=</span>&nbsp;<span class="num" id="4738315">0x01</span>&nbsp;<span class="op" id="4738320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738325">return</span>&nbsp;<span class="ident" id="4738332"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4738350">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4738353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738357">//&nbsp;11.&nbsp;&nbsp;Let&nbsp;salt&nbsp;be&nbsp;the&nbsp;last&nbsp;sLen&nbsp;octets&nbsp;of&nbsp;DB.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4738406">salt</span>&nbsp;<span class="op" id="4738411">:=</span>&nbsp;<span class="ident" id="4738414"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4738416">[</span><span class="builtinfunc" id="4738417">len</span><span class="op" id="4738420">(</span><span class="ident" id="4738421"><a href="/gostd/crypto/rsa/pss.go.html#4737077">db</a></span><span class="op" id="4738423">)</span><span class="op" id="4738424">-</span><span class="ident" id="4738425"><a href="/gostd/crypto/rsa/pss.go.html#4736306">sLen</a></span><span class="op" id="4738429">:</span><span class="op" id="4738430">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738434">//&nbsp;12.&nbsp;&nbsp;Let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;=&nbsp;(0x)00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;||&nbsp;mHash&nbsp;||&nbsp;salt&nbsp;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738512">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;8&nbsp;+&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;with&nbsp;eight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738579">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;zero&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738608">//</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738612">//&nbsp;13.&nbsp;Let&nbsp;H&#39;&nbsp;=&nbsp;Hash(M&#39;),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738671">var</span>&nbsp;<span class="ident" id="4738675">prefix</span>&nbsp;<span class="op" id="4738682">[</span><span class="num" id="4738683">8</span><span class="op" id="4738684">]</span><span class="builtintype" id="4738685">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4738691"><a href="/gostd/crypto/rsa/pss.go.html#4736316">hash</a></span><span class="op" id="4738695">.</span><span class="ident" id="4738696"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4738701">(</span><span class="ident" id="4738702"><a href="/gostd/crypto/rsa/pss.go.html#4738675">prefix</a></span><span class="op" id="4738708">[</span><span class="op" id="4738709">:</span><span class="op" id="4738710">]</span><span class="op" id="4738711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4738714"><a href="/gostd/crypto/rsa/pss.go.html#4736316">hash</a></span><span class="op" id="4738718">.</span><span class="ident" id="4738719"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4738724">(</span><span class="ident" id="4738725"><a href="/gostd/crypto/rsa/pss.go.html#4736280">mHash</a></span><span class="op" id="4738730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4738733"><a href="/gostd/crypto/rsa/pss.go.html#4736316">hash</a></span><span class="op" id="4738737">.</span><span class="ident" id="4738738"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4738743">(</span><span class="ident" id="4738744"><a href="/gostd/crypto/rsa/pss.go.html#4738406">salt</a></span><span class="op" id="4738748">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4738752">h0</span>&nbsp;<span class="op" id="4738755">:=</span>&nbsp;<span class="ident" id="4738758"><a href="/gostd/crypto/rsa/pss.go.html#4736316">hash</a></span><span class="op" id="4738762">.</span><span class="ident" id="4738763"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4738766">(</span><span class="builtintype" id="4738767">nil</span><span class="op" id="4738770">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4738774">//&nbsp;14.&nbsp;If&nbsp;H&nbsp;=&nbsp;H&#39;,&nbsp;output&nbsp;&#34;consistent.&#34;&nbsp;Otherwise,&nbsp;output&nbsp;&#34;inconsistent.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738848">if</span>&nbsp;<span class="op" id="4738851">!</span><span class="ident" id="4738852"><a href="/gostd/crypto/rsa/pss.go.html#4734304">bytes</a></span><span class="op" id="4738857">.</span><span class="ident" id="4738858"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4738863">(</span><span class="ident" id="4738864"><a href="/gostd/crypto/rsa/pss.go.html#4738752">h0</a></span><span class="op" id="4738866">,</span>&nbsp;<span class="ident" id="4738868"><a href="/gostd/crypto/rsa/pss.go.html#4737102">h</a></span><span class="op" id="4738869">)</span>&nbsp;<span class="op" id="4738871">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738875">return</span>&nbsp;<span class="ident" id="4738882"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4738899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4738902">return</span>&nbsp;<span class="builtintype" id="4738909">nil</span><br>
<span class="lineno"></span><span class="op" id="4738913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4738916">//&nbsp;signPSSWithSalt&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;PSS&nbsp;[1]&nbsp;with&nbsp;specified&nbsp;salt.</span><br>
<span class="lineno"></span><span class="comment" id="4739005">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4739083">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;salt&nbsp;is&nbsp;a&nbsp;random&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;whose&nbsp;length&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4739163">//&nbsp;later&nbsp;used&nbsp;to&nbsp;verify&nbsp;the&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4739202">func</span>&nbsp;<span class="ident" id="4739207">signPSSWithSalt</span><span class="op" id="4739222">(</span><span class="ident" id="4739223">rand</span>&nbsp;<span class="ident" id="4739228"><a href="/gostd/crypto/rsa/pss.go.html#4734341">io</a></span><span class="op" id="4739230">.</span><span class="ident" id="4739231"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4739237">,</span>&nbsp;<span class="ident" id="4739239">priv</span>&nbsp;<span class="op" id="4739244">*</span><span class="ident" id="4739245"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4739255">,</span>&nbsp;<span class="ident" id="4739257">hash</span>&nbsp;<span class="ident" id="4739262"><a href="/gostd/crypto/rsa/pss.go.html#4734313">crypto</a></span><span class="op" id="4739268">.</span><span class="ident" id="4739269"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4739273">,</span>&nbsp;<span class="ident" id="4739275">hashed</span><span class="op" id="4739281">,</span>&nbsp;<span class="ident" id="4739283">salt</span>&nbsp;<span class="op" id="4739288">[</span><span class="op" id="4739289">]</span><span class="builtintype" id="4739290">byte</span><span class="op" id="4739294">)</span>&nbsp;<span class="op" id="4739296">(</span><span class="ident" id="4739297">s</span>&nbsp;<span class="op" id="4739299">[</span><span class="op" id="4739300">]</span><span class="builtintype" id="4739301">byte</span><span class="op" id="4739305">,</span>&nbsp;<span class="ident" id="4739307">err</span>&nbsp;<span class="builtintype" id="4739311">error</span><span class="op" id="4739316">)</span>&nbsp;<span class="op" id="4739318">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739321">nBits</span>&nbsp;<span class="op" id="4739327">:=</span>&nbsp;<span class="ident" id="4739330"><a href="/gostd/crypto/rsa/pss.go.html#4739239">priv</a></span><span class="op" id="4739334">.</span><span class="ident" id="4739335"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4739336">.</span><span class="ident" id="4739337"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4739343">(</span><span class="op" id="4739344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739347">em</span><span class="op" id="4739349">,</span>&nbsp;<span class="ident" id="4739351"><a href="/gostd/crypto/rsa/pss.go.html#4739307">err</a></span>&nbsp;<span class="op" id="4739355">:=</span>&nbsp;<span class="ident" id="4739358"><a href="/gostd/crypto/rsa/pss.go.html#4734366">emsaPSSEncode</a></span><span class="op" id="4739371">(</span><span class="ident" id="4739372"><a href="/gostd/crypto/rsa/pss.go.html#4739275">hashed</a></span><span class="op" id="4739378">,</span>&nbsp;<span class="ident" id="4739380"><a href="/gostd/crypto/rsa/pss.go.html#4739321">nBits</a></span><span class="op" id="4739385">-</span><span class="num" id="4739386">1</span><span class="op" id="4739387">,</span>&nbsp;<span class="ident" id="4739389"><a href="/gostd/crypto/rsa/pss.go.html#4739283">salt</a></span><span class="op" id="4739393">,</span>&nbsp;<span class="ident" id="4739395"><a href="/gostd/crypto/rsa/pss.go.html#4739257">hash</a></span><span class="op" id="4739399">.</span><span class="ident" id="4739400"><a href="/gostd/crypto/crypto.go.html#3011712">New</a></span><span class="op" id="4739403">(</span><span class="op" id="4739404">)</span><span class="op" id="4739405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4739408">if</span>&nbsp;<span class="ident" id="4739411"><a href="/gostd/crypto/rsa/pss.go.html#4739307">err</a></span>&nbsp;<span class="op" id="4739415">!=</span>&nbsp;<span class="builtintype" id="4739418">nil</span>&nbsp;<span class="op" id="4739422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4739426">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4739434">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739437">m</span>&nbsp;<span class="op" id="4739439">:=</span>&nbsp;<span class="builtinfunc" id="4739442">new</span><span class="op" id="4739445">(</span><span class="ident" id="4739446"><a href="/gostd/crypto/rsa/pss.go.html#4734347">big</a></span><span class="op" id="4739449">.</span><span class="ident" id="4739450"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4739453">)</span><span class="op" id="4739454">.</span><span class="ident" id="4739455"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="4739463">(</span><span class="ident" id="4739464"><a href="/gostd/crypto/rsa/pss.go.html#4739347">em</a></span><span class="op" id="4739466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739469">c</span><span class="op" id="4739470">,</span>&nbsp;<span class="ident" id="4739472"><a href="/gostd/crypto/rsa/pss.go.html#4739307">err</a></span>&nbsp;<span class="op" id="4739476">:=</span>&nbsp;<span class="ident" id="4739479"><a href="/gostd/crypto/rsa/rsa.go.html#4753954">decrypt</a></span><span class="op" id="4739486">(</span><span class="ident" id="4739487"><a href="/gostd/crypto/rsa/pss.go.html#4739223">rand</a></span><span class="op" id="4739491">,</span>&nbsp;<span class="ident" id="4739493"><a href="/gostd/crypto/rsa/pss.go.html#4739239">priv</a></span><span class="op" id="4739497">,</span>&nbsp;<span class="ident" id="4739499"><a href="/gostd/crypto/rsa/pss.go.html#4739437">m</a></span><span class="op" id="4739500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4739503">if</span>&nbsp;<span class="ident" id="4739506"><a href="/gostd/crypto/rsa/pss.go.html#4739307">err</a></span>&nbsp;<span class="op" id="4739510">!=</span>&nbsp;<span class="builtintype" id="4739513">nil</span>&nbsp;<span class="op" id="4739517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4739521">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4739529">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739532"><a href="/gostd/crypto/rsa/pss.go.html#4739297">s</a></span>&nbsp;<span class="op" id="4739534">=</span>&nbsp;<span class="builtinfunc" id="4739536">make</span><span class="op" id="4739540">(</span><span class="op" id="4739541">[</span><span class="op" id="4739542">]</span><span class="builtintype" id="4739543">byte</span><span class="op" id="4739547">,</span>&nbsp;<span class="op" id="4739549">(</span><span class="ident" id="4739550"><a href="/gostd/crypto/rsa/pss.go.html#4739321">nBits</a></span><span class="op" id="4739555">+</span><span class="num" id="4739556">7</span><span class="op" id="4739557">)</span><span class="op" id="4739558">/</span><span class="num" id="4739559">8</span><span class="op" id="4739560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739563"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4733795">copyWithLeftPad</a></span><span class="op" id="4739578">(</span><span class="ident" id="4739579"><a href="/gostd/crypto/rsa/pss.go.html#4739297">s</a></span><span class="op" id="4739580">,</span>&nbsp;<span class="ident" id="4739582"><a href="/gostd/crypto/rsa/pss.go.html#4739469">c</a></span><span class="op" id="4739583">.</span><span class="ident" id="4739584"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="4739589">(</span><span class="op" id="4739590">)</span><span class="op" id="4739591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4739594">return</span><br>
<span class="lineno"></span><span class="op" id="4739601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4739604">const</span>&nbsp;<span class="op" id="4739610">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4739613">//&nbsp;PSSSaltLengthAuto&nbsp;causes&nbsp;the&nbsp;salt&nbsp;in&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;to&nbsp;be&nbsp;as&nbsp;large</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4739685">//&nbsp;as&nbsp;possible&nbsp;when&nbsp;signing,&nbsp;and&nbsp;to&nbsp;be&nbsp;auto-detected&nbsp;when&nbsp;verifying.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739755">PSSSaltLengthAuto</span>&nbsp;<span class="op" id="4739773">=</span>&nbsp;<span class="num" id="4739775">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4739778">//&nbsp;PSSSaltLengthEqualsHash&nbsp;causes&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;equal&nbsp;the&nbsp;length</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4739849">//&nbsp;of&nbsp;the&nbsp;hash&nbsp;used&nbsp;in&nbsp;the&nbsp;signature.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4739888">PSSSaltLengthEqualsHash</span>&nbsp;<span class="op" id="4739912">=</span>&nbsp;<span class="op" id="4739914">-</span><span class="num" id="4739915">1</span><br>
<span class="lineno"></span><span class="op" id="4739917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4739920">//&nbsp;PSSOptions&nbsp;contains&nbsp;options&nbsp;for&nbsp;creating&nbsp;and&nbsp;verifying&nbsp;PSS&nbsp;signatures.</span><br>
<span class="lineno">220</span><span class="keyword" id="4739994">type</span>&nbsp;<span class="ident" id="4739999">PSSOptions</span>&nbsp;<span class="keyword" id="4740010">struct</span>&nbsp;<span class="op" id="4740017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4740020">//&nbsp;SaltLength&nbsp;controls&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;salt&nbsp;used&nbsp;in&nbsp;the&nbsp;PSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4740083">//&nbsp;signature.&nbsp;It&nbsp;can&nbsp;either&nbsp;be&nbsp;a&nbsp;number&nbsp;of&nbsp;bytes,&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4740156">//&nbsp;PSSSaltLength&nbsp;constants.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4740185">SaltLength</span>&nbsp;<span class="builtintype" id="4740196">int</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4740202">//&nbsp;Hash,&nbsp;if&nbsp;not&nbsp;zero,&nbsp;overrides&nbsp;the&nbsp;hash&nbsp;function&nbsp;passed&nbsp;to&nbsp;SignPSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4740272">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;specify&nbsp;the&nbsp;hash&nbsp;function&nbsp;when&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4740341">//&nbsp;crypto.Signer&nbsp;interface.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4740370">Hash</span>&nbsp;<span class="ident" id="4740375"><a href="/gostd/crypto/rsa/pss.go.html#4734313">crypto</a></span><span class="op" id="4740381">.</span><span class="ident" id="4740382"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><br>
<span class="lineno">230</span><span class="op" id="4740387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4740390">//&nbsp;HashFunc&nbsp;returns&nbsp;pssOpts.Hash&nbsp;so&nbsp;that&nbsp;PSSOptions&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="4740453">//&nbsp;crypto.SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4740475">func</span>&nbsp;<span class="op" id="4740480">(</span><span class="ident" id="4740481">pssOpts</span>&nbsp;<span class="op" id="4740489">*</span><span class="ident" id="4740490"><a href="/gostd/crypto/rsa/pss.go.html#4739999">PSSOptions</a></span><span class="op" id="4740500">)</span>&nbsp;<span class="ident" id="4740502">HashFunc</span><span class="op" id="4740510">(</span><span class="op" id="4740511">)</span>&nbsp;<span class="ident" id="4740513"><a href="/gostd/crypto/rsa/pss.go.html#4734313">crypto</a></span><span class="op" id="4740519">.</span><span class="ident" id="4740520"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span>&nbsp;<span class="op" id="4740525">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4740528">return</span>&nbsp;<span class="ident" id="4740535"><a href="/gostd/crypto/rsa/pss.go.html#4740481">pssOpts</a></span><span class="op" id="4740542">.</span><span class="ident" id="4740543"><a href="/gostd/crypto/rsa/pss.go.html#4740370">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="4740548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4740551">func</span>&nbsp;<span class="op" id="4740556">(</span><span class="ident" id="4740557">opts</span>&nbsp;<span class="op" id="4740562">*</span><span class="ident" id="4740563"><a href="/gostd/crypto/rsa/pss.go.html#4739999">PSSOptions</a></span><span class="op" id="4740573">)</span>&nbsp;<span class="ident" id="4740575">saltLength</span><span class="op" id="4740585">(</span><span class="op" id="4740586">)</span>&nbsp;<span class="builtintype" id="4740588">int</span>&nbsp;<span class="op" id="4740592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4740595">if</span>&nbsp;<span class="ident" id="4740598"><a href="/gostd/crypto/rsa/pss.go.html#4740557">opts</a></span>&nbsp;<span class="op" id="4740603">==</span>&nbsp;<span class="builtintype" id="4740606">nil</span>&nbsp;<span class="op" id="4740610">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4740614">return</span>&nbsp;<span class="ident" id="4740621"><a href="/gostd/crypto/rsa/pss.go.html#4739755">PSSSaltLengthAuto</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4740640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4740643">return</span>&nbsp;<span class="ident" id="4740650"><a href="/gostd/crypto/rsa/pss.go.html#4740557">opts</a></span><span class="op" id="4740654">.</span><span class="ident" id="4740655"><a href="/gostd/crypto/rsa/pss.go.html#4740185">SaltLength</a></span><br>
<span class="lineno"></span><span class="op" id="4740666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4740669">//&nbsp;SignPSS&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;RSASSA-PSS&nbsp;[1].</span><br>
<span class="lineno"></span><span class="comment" id="4740737">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4740815">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;The&nbsp;opts&nbsp;argument&nbsp;may&nbsp;be&nbsp;nil,&nbsp;in&nbsp;which&nbsp;case&nbsp;sensible</span><br>
<span class="lineno"></span><span class="comment" id="4740892">//&nbsp;defaults&nbsp;are&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4740914">func</span>&nbsp;<span class="ident" id="4740919">SignPSS</span><span class="op" id="4740926">(</span><span class="ident" id="4740927">rand</span>&nbsp;<span class="ident" id="4740932"><a href="/gostd/crypto/rsa/pss.go.html#4734341">io</a></span><span class="op" id="4740934">.</span><span class="ident" id="4740935"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4740941">,</span>&nbsp;<span class="ident" id="4740943">priv</span>&nbsp;<span class="op" id="4740948">*</span><span class="ident" id="4740949"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4740959">,</span>&nbsp;<span class="ident" id="4740961">hash</span>&nbsp;<span class="ident" id="4740966"><a href="/gostd/crypto/rsa/pss.go.html#4734313">crypto</a></span><span class="op" id="4740972">.</span><span class="ident" id="4740973"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4740977">,</span>&nbsp;<span class="ident" id="4740979">hashed</span>&nbsp;<span class="op" id="4740986">[</span><span class="op" id="4740987">]</span><span class="builtintype" id="4740988">byte</span><span class="op" id="4740992">,</span>&nbsp;<span class="ident" id="4740994">opts</span>&nbsp;<span class="op" id="4740999">*</span><span class="ident" id="4741000"><a href="/gostd/crypto/rsa/pss.go.html#4739999">PSSOptions</a></span><span class="op" id="4741010">)</span>&nbsp;<span class="op" id="4741012">(</span><span class="ident" id="4741013">s</span>&nbsp;<span class="op" id="4741015">[</span><span class="op" id="4741016">]</span><span class="builtintype" id="4741017">byte</span><span class="op" id="4741021">,</span>&nbsp;<span class="ident" id="4741023">err</span>&nbsp;<span class="builtintype" id="4741027">error</span><span class="op" id="4741032">)</span>&nbsp;<span class="op" id="4741034">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741037">saltLength</span>&nbsp;<span class="op" id="4741048">:=</span>&nbsp;<span class="ident" id="4741051"><a href="/gostd/crypto/rsa/pss.go.html#4740994">opts</a></span><span class="op" id="4741055">.</span><span class="ident" id="4741056"><a href="/gostd/crypto/rsa/pss.go.html#4740575">saltLength</a></span><span class="op" id="4741066">(</span><span class="op" id="4741067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741070">switch</span>&nbsp;<span class="ident" id="4741077"><a href="/gostd/crypto/rsa/pss.go.html#4741037">saltLength</a></span>&nbsp;<span class="op" id="4741088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741091">case</span>&nbsp;<span class="ident" id="4741096"><a href="/gostd/crypto/rsa/pss.go.html#4739755">PSSSaltLengthAuto</a></span><span class="op" id="4741113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741117"><a href="/gostd/crypto/rsa/pss.go.html#4741037">saltLength</a></span>&nbsp;<span class="op" id="4741128">=</span>&nbsp;<span class="op" id="4741130">(</span><span class="ident" id="4741131"><a href="/gostd/crypto/rsa/pss.go.html#4740943">priv</a></span><span class="op" id="4741135">.</span><span class="ident" id="4741136"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4741137">.</span><span class="ident" id="4741138"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4741144">(</span><span class="op" id="4741145">)</span><span class="op" id="4741146">+</span><span class="num" id="4741147">7</span><span class="op" id="4741148">)</span><span class="op" id="4741149">/</span><span class="num" id="4741150">8</span>&nbsp;<span class="op" id="4741152">-</span>&nbsp;<span class="num" id="4741154">2</span>&nbsp;<span class="op" id="4741156">-</span>&nbsp;<span class="ident" id="4741158"><a href="/gostd/crypto/rsa/pss.go.html#4740961">hash</a></span><span class="op" id="4741162">.</span><span class="ident" id="4741163"><a href="/gostd/crypto/crypto.go.html#3011393">Size</a></span><span class="op" id="4741167">(</span><span class="op" id="4741168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741171">case</span>&nbsp;<span class="ident" id="4741176"><a href="/gostd/crypto/rsa/pss.go.html#4739888">PSSSaltLengthEqualsHash</a></span><span class="op" id="4741199">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741203"><a href="/gostd/crypto/rsa/pss.go.html#4741037">saltLength</a></span>&nbsp;<span class="op" id="4741214">=</span>&nbsp;<span class="ident" id="4741216"><a href="/gostd/crypto/rsa/pss.go.html#4740961">hash</a></span><span class="op" id="4741220">.</span><span class="ident" id="4741221"><a href="/gostd/crypto/crypto.go.html#3011393">Size</a></span><span class="op" id="4741225">(</span><span class="op" id="4741226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741233">if</span>&nbsp;<span class="ident" id="4741236"><a href="/gostd/crypto/rsa/pss.go.html#4740994">opts</a></span><span class="op" id="4741240">.</span><span class="ident" id="4741241"><a href="/gostd/crypto/rsa/pss.go.html#4740370">Hash</a></span>&nbsp;<span class="op" id="4741246">!=</span>&nbsp;<span class="num" id="4741249">0</span>&nbsp;<span class="op" id="4741251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741255"><a href="/gostd/crypto/rsa/pss.go.html#4740961">hash</a></span>&nbsp;<span class="op" id="4741260">=</span>&nbsp;<span class="ident" id="4741262"><a href="/gostd/crypto/rsa/pss.go.html#4740994">opts</a></span><span class="op" id="4741266">.</span><span class="ident" id="4741267"><a href="/gostd/crypto/rsa/pss.go.html#4740370">Hash</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741277">salt</span>&nbsp;<span class="op" id="4741282">:=</span>&nbsp;<span class="builtinfunc" id="4741285">make</span><span class="op" id="4741289">(</span><span class="op" id="4741290">[</span><span class="op" id="4741291">]</span><span class="builtintype" id="4741292">byte</span><span class="op" id="4741296">,</span>&nbsp;<span class="ident" id="4741298"><a href="/gostd/crypto/rsa/pss.go.html#4741037">saltLength</a></span><span class="op" id="4741308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741311">if</span>&nbsp;<span class="ident" id="4741314">_</span><span class="op" id="4741315">,</span>&nbsp;<span class="ident" id="4741317"><a href="/gostd/crypto/rsa/pss.go.html#4741023">err</a></span>&nbsp;<span class="op" id="4741321">=</span>&nbsp;<span class="ident" id="4741323"><a href="/gostd/crypto/rsa/pss.go.html#4734341">io</a></span><span class="op" id="4741325">.</span><span class="ident" id="4741326"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4741334">(</span><span class="ident" id="4741335"><a href="/gostd/crypto/rsa/pss.go.html#4740927">rand</a></span><span class="op" id="4741339">,</span>&nbsp;<span class="ident" id="4741341"><a href="/gostd/crypto/rsa/pss.go.html#4741277">salt</a></span><span class="op" id="4741345">)</span><span class="op" id="4741346">;</span>&nbsp;<span class="ident" id="4741348"><a href="/gostd/crypto/rsa/pss.go.html#4741023">err</a></span>&nbsp;<span class="op" id="4741352">!=</span>&nbsp;<span class="builtintype" id="4741355">nil</span>&nbsp;<span class="op" id="4741359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741363">return</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741374">return</span>&nbsp;<span class="ident" id="4741381"><a href="/gostd/crypto/rsa/pss.go.html#4739207">signPSSWithSalt</a></span><span class="op" id="4741396">(</span><span class="ident" id="4741397"><a href="/gostd/crypto/rsa/pss.go.html#4740927">rand</a></span><span class="op" id="4741401">,</span>&nbsp;<span class="ident" id="4741403"><a href="/gostd/crypto/rsa/pss.go.html#4740943">priv</a></span><span class="op" id="4741407">,</span>&nbsp;<span class="ident" id="4741409"><a href="/gostd/crypto/rsa/pss.go.html#4740961">hash</a></span><span class="op" id="4741413">,</span>&nbsp;<span class="ident" id="4741415"><a href="/gostd/crypto/rsa/pss.go.html#4740979">hashed</a></span><span class="op" id="4741421">,</span>&nbsp;<span class="ident" id="4741423"><a href="/gostd/crypto/rsa/pss.go.html#4741277">salt</a></span><span class="op" id="4741427">)</span><br>
<span class="lineno"></span><span class="op" id="4741429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4741432">//&nbsp;VerifyPSS&nbsp;verifies&nbsp;a&nbsp;PSS&nbsp;signature.</span><br>
<span class="lineno">270</span><span class="comment" id="4741471">//&nbsp;hashed&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4741545">//&nbsp;function&nbsp;and&nbsp;sig&nbsp;is&nbsp;the&nbsp;signature.&nbsp;A&nbsp;valid&nbsp;signature&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4741617">//&nbsp;returning&nbsp;a&nbsp;nil&nbsp;error.&nbsp;The&nbsp;opts&nbsp;argument&nbsp;may&nbsp;be&nbsp;nil,&nbsp;in&nbsp;which&nbsp;case&nbsp;sensible</span><br>
<span class="lineno"></span><span class="comment" id="4741696">//&nbsp;defaults&nbsp;are&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4741718">func</span>&nbsp;<span class="ident" id="4741723">VerifyPSS</span><span class="op" id="4741732">(</span><span class="ident" id="4741733">pub</span>&nbsp;<span class="op" id="4741737">*</span><span class="ident" id="4741738"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4741747">,</span>&nbsp;<span class="ident" id="4741749">hash</span>&nbsp;<span class="ident" id="4741754"><a href="/gostd/crypto/rsa/pss.go.html#4734313">crypto</a></span><span class="op" id="4741760">.</span><span class="ident" id="4741761"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4741765">,</span>&nbsp;<span class="ident" id="4741767">hashed</span>&nbsp;<span class="op" id="4741774">[</span><span class="op" id="4741775">]</span><span class="builtintype" id="4741776">byte</span><span class="op" id="4741780">,</span>&nbsp;<span class="ident" id="4741782">sig</span>&nbsp;<span class="op" id="4741786">[</span><span class="op" id="4741787">]</span><span class="builtintype" id="4741788">byte</span><span class="op" id="4741792">,</span>&nbsp;<span class="ident" id="4741794">opts</span>&nbsp;<span class="op" id="4741799">*</span><span class="ident" id="4741800"><a href="/gostd/crypto/rsa/pss.go.html#4739999">PSSOptions</a></span><span class="op" id="4741810">)</span>&nbsp;<span class="builtintype" id="4741812">error</span>&nbsp;<span class="op" id="4741818">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741821">return</span>&nbsp;<span class="ident" id="4741828"><a href="/gostd/crypto/rsa/pss.go.html#4741955">verifyPSS</a></span><span class="op" id="4741837">(</span><span class="ident" id="4741838"><a href="/gostd/crypto/rsa/pss.go.html#4741733">pub</a></span><span class="op" id="4741841">,</span>&nbsp;<span class="ident" id="4741843"><a href="/gostd/crypto/rsa/pss.go.html#4741749">hash</a></span><span class="op" id="4741847">,</span>&nbsp;<span class="ident" id="4741849"><a href="/gostd/crypto/rsa/pss.go.html#4741767">hashed</a></span><span class="op" id="4741855">,</span>&nbsp;<span class="ident" id="4741857"><a href="/gostd/crypto/rsa/pss.go.html#4741782">sig</a></span><span class="op" id="4741860">,</span>&nbsp;<span class="ident" id="4741862"><a href="/gostd/crypto/rsa/pss.go.html#4741794">opts</a></span><span class="op" id="4741866">.</span><span class="ident" id="4741867"><a href="/gostd/crypto/rsa/pss.go.html#4740575">saltLength</a></span><span class="op" id="4741877">(</span><span class="op" id="4741878">)</span><span class="op" id="4741879">)</span><br>
<span class="lineno"></span><span class="op" id="4741881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4741884">//&nbsp;verifyPSS&nbsp;verifies&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;with&nbsp;the&nbsp;given&nbsp;salt&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="4741950">func</span>&nbsp;<span class="ident" id="4741955">verifyPSS</span><span class="op" id="4741964">(</span><span class="ident" id="4741965">pub</span>&nbsp;<span class="op" id="4741969">*</span><span class="ident" id="4741970"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4741979">,</span>&nbsp;<span class="ident" id="4741981">hash</span>&nbsp;<span class="ident" id="4741986"><a href="/gostd/crypto/rsa/pss.go.html#4734313">crypto</a></span><span class="op" id="4741992">.</span><span class="ident" id="4741993"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4741997">,</span>&nbsp;<span class="ident" id="4741999">hashed</span>&nbsp;<span class="op" id="4742006">[</span><span class="op" id="4742007">]</span><span class="builtintype" id="4742008">byte</span><span class="op" id="4742012">,</span>&nbsp;<span class="ident" id="4742014">sig</span>&nbsp;<span class="op" id="4742018">[</span><span class="op" id="4742019">]</span><span class="builtintype" id="4742020">byte</span><span class="op" id="4742024">,</span>&nbsp;<span class="ident" id="4742026">saltLen</span>&nbsp;<span class="builtintype" id="4742034">int</span><span class="op" id="4742037">)</span>&nbsp;<span class="builtintype" id="4742039">error</span>&nbsp;<span class="op" id="4742045">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742048">nBits</span>&nbsp;<span class="op" id="4742054">:=</span>&nbsp;<span class="ident" id="4742057"><a href="/gostd/crypto/rsa/pss.go.html#4741965">pub</a></span><span class="op" id="4742060">.</span><span class="ident" id="4742061"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4742062">.</span><span class="ident" id="4742063"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4742069">(</span><span class="op" id="4742070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742073">if</span>&nbsp;<span class="builtinfunc" id="4742076">len</span><span class="op" id="4742079">(</span><span class="ident" id="4742080"><a href="/gostd/crypto/rsa/pss.go.html#4742014">sig</a></span><span class="op" id="4742083">)</span>&nbsp;<span class="op" id="4742085">!=</span>&nbsp;<span class="op" id="4742088">(</span><span class="ident" id="4742089"><a href="/gostd/crypto/rsa/pss.go.html#4742048">nBits</a></span><span class="op" id="4742094">+</span><span class="num" id="4742095">7</span><span class="op" id="4742096">)</span><span class="op" id="4742097">/</span><span class="num" id="4742098">8</span>&nbsp;<span class="op" id="4742100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742104">return</span>&nbsp;<span class="ident" id="4742111"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742131">s</span>&nbsp;<span class="op" id="4742133">:=</span>&nbsp;<span class="builtinfunc" id="4742136">new</span><span class="op" id="4742139">(</span><span class="ident" id="4742140"><a href="/gostd/crypto/rsa/pss.go.html#4734347">big</a></span><span class="op" id="4742143">.</span><span class="ident" id="4742144"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4742147">)</span><span class="op" id="4742148">.</span><span class="ident" id="4742149"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="4742157">(</span><span class="ident" id="4742158"><a href="/gostd/crypto/rsa/pss.go.html#4742014">sig</a></span><span class="op" id="4742161">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742164">m</span>&nbsp;<span class="op" id="4742166">:=</span>&nbsp;<span class="ident" id="4742169"><a href="/gostd/crypto/rsa/rsa.go.html#4750651">encrypt</a></span><span class="op" id="4742176">(</span><span class="builtinfunc" id="4742177">new</span><span class="op" id="4742180">(</span><span class="ident" id="4742181"><a href="/gostd/crypto/rsa/pss.go.html#4734347">big</a></span><span class="op" id="4742184">.</span><span class="ident" id="4742185"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4742188">)</span><span class="op" id="4742189">,</span>&nbsp;<span class="ident" id="4742191"><a href="/gostd/crypto/rsa/pss.go.html#4741965">pub</a></span><span class="op" id="4742194">,</span>&nbsp;<span class="ident" id="4742196"><a href="/gostd/crypto/rsa/pss.go.html#4742131">s</a></span><span class="op" id="4742197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742200">emBits</span>&nbsp;<span class="op" id="4742207">:=</span>&nbsp;<span class="ident" id="4742210"><a href="/gostd/crypto/rsa/pss.go.html#4742048">nBits</a></span>&nbsp;<span class="op" id="4742216">-</span>&nbsp;<span class="num" id="4742218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742221">emLen</span>&nbsp;<span class="op" id="4742227">:=</span>&nbsp;<span class="op" id="4742230">(</span><span class="ident" id="4742231"><a href="/gostd/crypto/rsa/pss.go.html#4742200">emBits</a></span>&nbsp;<span class="op" id="4742238">+</span>&nbsp;<span class="num" id="4742240">7</span><span class="op" id="4742241">)</span>&nbsp;<span class="op" id="4742243">/</span>&nbsp;<span class="num" id="4742245">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742248">if</span>&nbsp;<span class="ident" id="4742251"><a href="/gostd/crypto/rsa/pss.go.html#4742221">emLen</a></span>&nbsp;<span class="op" id="4742257">&lt;</span>&nbsp;<span class="builtinfunc" id="4742259">len</span><span class="op" id="4742262">(</span><span class="ident" id="4742263"><a href="/gostd/crypto/rsa/pss.go.html#4742164">m</a></span><span class="op" id="4742264">.</span><span class="ident" id="4742265"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="4742270">(</span><span class="op" id="4742271">)</span><span class="op" id="4742272">)</span>&nbsp;<span class="op" id="4742274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742278">return</span>&nbsp;<span class="ident" id="4742285"><a href="/gostd/crypto/rsa/rsa.go.html#4752139">ErrVerification</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742305">em</span>&nbsp;<span class="op" id="4742308">:=</span>&nbsp;<span class="builtinfunc" id="4742311">make</span><span class="op" id="4742315">(</span><span class="op" id="4742316">[</span><span class="op" id="4742317">]</span><span class="builtintype" id="4742318">byte</span><span class="op" id="4742322">,</span>&nbsp;<span class="ident" id="4742324"><a href="/gostd/crypto/rsa/pss.go.html#4742221">emLen</a></span><span class="op" id="4742329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742332"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4733795">copyWithLeftPad</a></span><span class="op" id="4742347">(</span><span class="ident" id="4742348"><a href="/gostd/crypto/rsa/pss.go.html#4742305">em</a></span><span class="op" id="4742350">,</span>&nbsp;<span class="ident" id="4742352"><a href="/gostd/crypto/rsa/pss.go.html#4742164">m</a></span><span class="op" id="4742353">.</span><span class="ident" id="4742354"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="4742359">(</span><span class="op" id="4742360">)</span><span class="op" id="4742361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742364">if</span>&nbsp;<span class="ident" id="4742367"><a href="/gostd/crypto/rsa/pss.go.html#4742026">saltLen</a></span>&nbsp;<span class="op" id="4742375">==</span>&nbsp;<span class="ident" id="4742378"><a href="/gostd/crypto/rsa/pss.go.html#4739888">PSSSaltLengthEqualsHash</a></span>&nbsp;<span class="op" id="4742402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742406"><a href="/gostd/crypto/rsa/pss.go.html#4742026">saltLen</a></span>&nbsp;<span class="op" id="4742414">=</span>&nbsp;<span class="ident" id="4742416"><a href="/gostd/crypto/rsa/pss.go.html#4741981">hash</a></span><span class="op" id="4742420">.</span><span class="ident" id="4742421"><a href="/gostd/crypto/crypto.go.html#3011393">Size</a></span><span class="op" id="4742425">(</span><span class="op" id="4742426">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742432">return</span>&nbsp;<span class="ident" id="4742439"><a href="/gostd/crypto/rsa/pss.go.html#4736266">emsaPSSVerify</a></span><span class="op" id="4742452">(</span><span class="ident" id="4742453"><a href="/gostd/crypto/rsa/pss.go.html#4741999">hashed</a></span><span class="op" id="4742459">,</span>&nbsp;<span class="ident" id="4742461"><a href="/gostd/crypto/rsa/pss.go.html#4742305">em</a></span><span class="op" id="4742463">,</span>&nbsp;<span class="ident" id="4742465"><a href="/gostd/crypto/rsa/pss.go.html#4742200">emBits</a></span><span class="op" id="4742471">,</span>&nbsp;<span class="ident" id="4742473"><a href="/gostd/crypto/rsa/pss.go.html#4742026">saltLen</a></span><span class="op" id="4742480">,</span>&nbsp;<span class="ident" id="4742482"><a href="/gostd/crypto/rsa/pss.go.html#4741981">hash</a></span><span class="op" id="4742486">.</span><span class="ident" id="4742487"><a href="/gostd/crypto/crypto.go.html#3011712">New</a></span><span class="op" id="4742490">(</span><span class="op" id="4742491">)</span><span class="op" id="4742492">)</span><br>
<span class="lineno"></span><span class="op" id="4742494">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
