<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html" class="current">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5035213">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5035268">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5035322">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5035373">package</span>&nbsp;<span class="ident" id="5035381">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5035391">import</span>&nbsp;<span class="op" id="5035398">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5035401">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5035410">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5035417">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5035428">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5035443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5035446">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5035510">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="5035559">func</span>&nbsp;<span class="ident" id="5035564">endsWithCSSKeyword</span><span class="op" id="5035582">(</span><span class="ident" id="5035583">b</span>&nbsp;<span class="op" id="5035585">[</span><span class="op" id="5035586">]</span><span class="builtintype" id="5035587">byte</span><span class="op" id="5035591">,</span>&nbsp;<span class="ident" id="5035593">kw</span>&nbsp;<span class="builtintype" id="5035596">string</span><span class="op" id="5035602">)</span>&nbsp;<span class="builtintype" id="5035604">bool</span>&nbsp;<span class="op" id="5035609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035612">i</span>&nbsp;<span class="op" id="5035614">:=</span>&nbsp;<span class="builtinfunc" id="5035617">len</span><span class="op" id="5035620">(</span><span class="ident" id="5035621">b</span><span class="op" id="5035622">)</span>&nbsp;<span class="op" id="5035624">-</span>&nbsp;<span class="builtinfunc" id="5035626">len</span><span class="op" id="5035629">(</span><span class="ident" id="5035630">kw</span><span class="op" id="5035632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035635">if</span>&nbsp;<span class="ident" id="5035638">i</span>&nbsp;<span class="op" id="5035640">&lt;</span>&nbsp;<span class="num" id="5035642">0</span>&nbsp;<span class="op" id="5035644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035648">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035664">return</span>&nbsp;<span class="builtintype" id="5035671">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035681">if</span>&nbsp;<span class="ident" id="5035684">i</span>&nbsp;<span class="op" id="5035686">!=</span>&nbsp;<span class="num" id="5035689">0</span>&nbsp;<span class="op" id="5035691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5035695">r</span><span class="op" id="5035696">,</span>&nbsp;<span class="ident" id="5035698">_</span>&nbsp;<span class="op" id="5035700">:=</span>&nbsp;<span class="ident" id="5035703">utf8</span><span class="op" id="5035707">.</span><span class="ident" id="5035708">DecodeLastRune</span><span class="op" id="5035722">(</span><span class="ident" id="5035723">b</span><span class="op" id="5035724">[</span><span class="op" id="5035725">:</span><span class="ident" id="5035726">i</span><span class="op" id="5035727">]</span><span class="op" id="5035728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035732">if</span>&nbsp;<span class="ident" id="5035735">isCSSNmchar</span><span class="op" id="5035746">(</span><span class="ident" id="5035747">r</span><span class="op" id="5035748">)</span>&nbsp;<span class="op" id="5035750">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035755">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5035771">return</span>&nbsp;<span class="builtintype" id="5035778">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5035789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035792">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035865">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035925">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5035971">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036041">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036092">return</span>&nbsp;<span class="builtintype" id="5036099">string</span><span class="op" id="5036105">(</span><span class="ident" id="5036106">bytes</span><span class="op" id="5036111">.</span><span class="ident" id="5036112">ToLower</span><span class="op" id="5036119">(</span><span class="ident" id="5036120">b</span><span class="op" id="5036121">[</span><span class="ident" id="5036122">i</span><span class="op" id="5036123">:</span><span class="op" id="5036124">]</span><span class="op" id="5036125">)</span><span class="op" id="5036126">)</span>&nbsp;<span class="op" id="5036128">==</span>&nbsp;<span class="ident" id="5036131">kw</span><br>
<span class="lineno">35</span><span class="op" id="5036134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5036137">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="5036214">func</span>&nbsp;<span class="ident" id="5036219">isCSSNmchar</span><span class="op" id="5036230">(</span><span class="ident" id="5036231">r</span>&nbsp;<span class="builtintype" id="5036233">rune</span><span class="op" id="5036237">)</span>&nbsp;<span class="builtintype" id="5036239">bool</span>&nbsp;<span class="op" id="5036244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036247">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036317">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036332">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036384">return</span>&nbsp;<span class="string" id="5036391">&#39;a&#39;</span>&nbsp;<span class="op" id="5036395">&lt;=</span>&nbsp;<span class="ident" id="5036398">r</span>&nbsp;<span class="op" id="5036400">&amp;&amp;</span>&nbsp;<span class="ident" id="5036403">r</span>&nbsp;<span class="op" id="5036405">&lt;=</span>&nbsp;<span class="string" id="5036408">&#39;z&#39;</span>&nbsp;<span class="op" id="5036412">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5036417">&#39;A&#39;</span>&nbsp;<span class="op" id="5036421">&lt;=</span>&nbsp;<span class="ident" id="5036424">r</span>&nbsp;<span class="op" id="5036426">&amp;&amp;</span>&nbsp;<span class="ident" id="5036429">r</span>&nbsp;<span class="op" id="5036431">&lt;=</span>&nbsp;<span class="string" id="5036434">&#39;Z&#39;</span>&nbsp;<span class="op" id="5036438">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5036443">&#39;0&#39;</span>&nbsp;<span class="op" id="5036447">&lt;=</span>&nbsp;<span class="ident" id="5036450">r</span>&nbsp;<span class="op" id="5036452">&amp;&amp;</span>&nbsp;<span class="ident" id="5036455">r</span>&nbsp;<span class="op" id="5036457">&lt;=</span>&nbsp;<span class="string" id="5036460">&#39;9&#39;</span>&nbsp;<span class="op" id="5036464">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036469">r</span>&nbsp;<span class="op" id="5036471">==</span>&nbsp;<span class="string" id="5036474">&#39;-&#39;</span>&nbsp;<span class="op" id="5036478">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036483">r</span>&nbsp;<span class="op" id="5036485">==</span>&nbsp;<span class="string" id="5036488">&#39;_&#39;</span>&nbsp;<span class="op" id="5036492">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036497">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5036525">0x80</span>&nbsp;<span class="op" id="5036530">&lt;=</span>&nbsp;<span class="ident" id="5036533">r</span>&nbsp;<span class="op" id="5036535">&amp;&amp;</span>&nbsp;<span class="ident" id="5036538">r</span>&nbsp;<span class="op" id="5036540">&lt;=</span>&nbsp;<span class="num" id="5036543">0xd7ff</span>&nbsp;<span class="op" id="5036550">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5036555">0xe000</span>&nbsp;<span class="op" id="5036562">&lt;=</span>&nbsp;<span class="ident" id="5036565">r</span>&nbsp;<span class="op" id="5036567">&amp;&amp;</span>&nbsp;<span class="ident" id="5036570">r</span>&nbsp;<span class="op" id="5036572">&lt;=</span>&nbsp;<span class="num" id="5036575">0xfffd</span>&nbsp;<span class="op" id="5036582">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5036587">0x10000</span>&nbsp;<span class="op" id="5036595">&lt;=</span>&nbsp;<span class="ident" id="5036598">r</span>&nbsp;<span class="op" id="5036600">&amp;&amp;</span>&nbsp;<span class="ident" id="5036603">r</span>&nbsp;<span class="op" id="5036605">&lt;=</span>&nbsp;<span class="num" id="5036608">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="5036617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5036620">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="5036687">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="5036764">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="5036790">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="5036865">func</span>&nbsp;<span class="ident" id="5036870">decodeCSS</span><span class="op" id="5036879">(</span><span class="ident" id="5036880">s</span>&nbsp;<span class="op" id="5036882">[</span><span class="op" id="5036883">]</span><span class="builtintype" id="5036884">byte</span><span class="op" id="5036888">)</span>&nbsp;<span class="op" id="5036890">[</span><span class="op" id="5036891">]</span><span class="builtintype" id="5036892">byte</span>&nbsp;<span class="op" id="5036897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5036900">i</span>&nbsp;<span class="op" id="5036902">:=</span>&nbsp;<span class="ident" id="5036905">bytes</span><span class="op" id="5036910">.</span><span class="ident" id="5036911">IndexByte</span><span class="op" id="5036920">(</span><span class="ident" id="5036921">s</span><span class="op" id="5036922">,</span>&nbsp;<span class="string" id="5036924">&#39;\\&#39;</span><span class="op" id="5036928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036931">if</span>&nbsp;<span class="ident" id="5036934">i</span>&nbsp;<span class="op" id="5036936">==</span>&nbsp;<span class="op" id="5036939">-</span><span class="num" id="5036940">1</span>&nbsp;<span class="op" id="5036942">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5036946">return</span>&nbsp;<span class="ident" id="5036953">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5036956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5036959">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037027">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037099">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037137">b</span>&nbsp;<span class="op" id="5037139">:=</span>&nbsp;<span class="builtinfunc" id="5037142">make</span><span class="op" id="5037146">(</span><span class="op" id="5037147">[</span><span class="op" id="5037148">]</span><span class="builtintype" id="5037149">byte</span><span class="op" id="5037153">,</span>&nbsp;<span class="num" id="5037155">0</span><span class="op" id="5037156">,</span>&nbsp;<span class="builtinfunc" id="5037158">len</span><span class="op" id="5037161">(</span><span class="ident" id="5037162">s</span><span class="op" id="5037163">)</span><span class="op" id="5037164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037167">for</span>&nbsp;<span class="builtinfunc" id="5037171">len</span><span class="op" id="5037174">(</span><span class="ident" id="5037175">s</span><span class="op" id="5037176">)</span>&nbsp;<span class="op" id="5037178">!=</span>&nbsp;<span class="num" id="5037181">0</span>&nbsp;<span class="op" id="5037183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037187">i</span>&nbsp;<span class="op" id="5037189">:=</span>&nbsp;<span class="ident" id="5037192">bytes</span><span class="op" id="5037197">.</span><span class="ident" id="5037198">IndexByte</span><span class="op" id="5037207">(</span><span class="ident" id="5037208">s</span><span class="op" id="5037209">,</span>&nbsp;<span class="string" id="5037211">&#39;\\&#39;</span><span class="op" id="5037215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037219">if</span>&nbsp;<span class="ident" id="5037222">i</span>&nbsp;<span class="op" id="5037224">==</span>&nbsp;<span class="op" id="5037227">-</span><span class="num" id="5037228">1</span>&nbsp;<span class="op" id="5037230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037235">i</span>&nbsp;<span class="op" id="5037237">=</span>&nbsp;<span class="builtinfunc" id="5037239">len</span><span class="op" id="5037242">(</span><span class="ident" id="5037243">s</span><span class="op" id="5037244">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037252">b</span><span class="op" id="5037253">,</span>&nbsp;<span class="ident" id="5037255">s</span>&nbsp;<span class="op" id="5037257">=</span>&nbsp;<span class="builtinfunc" id="5037259">append</span><span class="op" id="5037265">(</span><span class="ident" id="5037266">b</span><span class="op" id="5037267">,</span>&nbsp;<span class="ident" id="5037269">s</span><span class="op" id="5037270">[</span><span class="op" id="5037271">:</span><span class="ident" id="5037272">i</span><span class="op" id="5037273">]</span><span class="op" id="5037274">...</span><span class="op" id="5037277">)</span><span class="op" id="5037278">,</span>&nbsp;<span class="ident" id="5037280">s</span><span class="op" id="5037281">[</span><span class="ident" id="5037282">i</span><span class="op" id="5037283">:</span><span class="op" id="5037284">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037288">if</span>&nbsp;<span class="builtinfunc" id="5037291">len</span><span class="op" id="5037294">(</span><span class="ident" id="5037295">s</span><span class="op" id="5037296">)</span>&nbsp;<span class="op" id="5037298">&lt;</span>&nbsp;<span class="num" id="5037300">2</span>&nbsp;<span class="op" id="5037302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037307">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037315">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037319">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037372">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037454">if</span>&nbsp;<span class="ident" id="5037457">isHex</span><span class="op" id="5037462">(</span><span class="ident" id="5037463">s</span><span class="op" id="5037464">[</span><span class="num" id="5037465">1</span><span class="op" id="5037466">]</span><span class="op" id="5037467">)</span>&nbsp;<span class="op" id="5037469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037474">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037529">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037574">j</span>&nbsp;<span class="op" id="5037576">:=</span>&nbsp;<span class="num" id="5037579">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037584">for</span>&nbsp;<span class="ident" id="5037588">j</span>&nbsp;<span class="op" id="5037590">&lt;</span>&nbsp;<span class="builtinfunc" id="5037592">len</span><span class="op" id="5037595">(</span><span class="ident" id="5037596">s</span><span class="op" id="5037597">)</span>&nbsp;<span class="op" id="5037599">&amp;&amp;</span>&nbsp;<span class="ident" id="5037602">j</span>&nbsp;<span class="op" id="5037604">&lt;</span>&nbsp;<span class="num" id="5037606">7</span>&nbsp;<span class="op" id="5037608">&amp;&amp;</span>&nbsp;<span class="ident" id="5037611">isHex</span><span class="op" id="5037616">(</span><span class="ident" id="5037617">s</span><span class="op" id="5037618">[</span><span class="ident" id="5037619">j</span><span class="op" id="5037620">]</span><span class="op" id="5037621">)</span>&nbsp;<span class="op" id="5037623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037629">j</span><span class="op" id="5037630">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037641">r</span>&nbsp;<span class="op" id="5037643">:=</span>&nbsp;<span class="ident" id="5037646">hexDecode</span><span class="op" id="5037655">(</span><span class="ident" id="5037656">s</span><span class="op" id="5037657">[</span><span class="num" id="5037658">1</span><span class="op" id="5037659">:</span><span class="ident" id="5037660">j</span><span class="op" id="5037661">]</span><span class="op" id="5037662">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5037667">if</span>&nbsp;<span class="ident" id="5037670">r</span>&nbsp;<span class="op" id="5037672">&gt;</span>&nbsp;<span class="ident" id="5037674">unicode</span><span class="op" id="5037681">.</span><span class="ident" id="5037682">MaxRune</span>&nbsp;<span class="op" id="5037690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037696">r</span><span class="op" id="5037697">,</span>&nbsp;<span class="ident" id="5037699">j</span>&nbsp;<span class="op" id="5037701">=</span>&nbsp;<span class="ident" id="5037703">r</span><span class="op" id="5037704">/</span><span class="num" id="5037705">16</span><span class="op" id="5037707">,</span>&nbsp;<span class="ident" id="5037709">j</span><span class="op" id="5037710">-</span><span class="num" id="5037711">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037721">n</span>&nbsp;<span class="op" id="5037723">:=</span>&nbsp;<span class="ident" id="5037726">utf8</span><span class="op" id="5037730">.</span><span class="ident" id="5037731">EncodeRune</span><span class="op" id="5037741">(</span><span class="ident" id="5037742">b</span><span class="op" id="5037743">[</span><span class="builtinfunc" id="5037744">len</span><span class="op" id="5037747">(</span><span class="ident" id="5037748">b</span><span class="op" id="5037749">)</span><span class="op" id="5037750">:</span><span class="builtinfunc" id="5037751">cap</span><span class="op" id="5037754">(</span><span class="ident" id="5037755">b</span><span class="op" id="5037756">)</span><span class="op" id="5037757">]</span><span class="op" id="5037758">,</span>&nbsp;<span class="ident" id="5037760">r</span><span class="op" id="5037761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037766">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037815">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037863">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5037912">b</span><span class="op" id="5037913">,</span>&nbsp;<span class="ident" id="5037915">s</span>&nbsp;<span class="op" id="5037917">=</span>&nbsp;<span class="ident" id="5037919">b</span><span class="op" id="5037920">[</span><span class="op" id="5037921">:</span><span class="builtinfunc" id="5037922">len</span><span class="op" id="5037925">(</span><span class="ident" id="5037926">b</span><span class="op" id="5037927">)</span><span class="op" id="5037928">+</span><span class="ident" id="5037929">n</span><span class="op" id="5037930">]</span><span class="op" id="5037931">,</span>&nbsp;<span class="ident" id="5037933">skipCSSSpace</span><span class="op" id="5037945">(</span><span class="ident" id="5037946">s</span><span class="op" id="5037947">[</span><span class="ident" id="5037948">j</span><span class="op" id="5037949">:</span><span class="op" id="5037950">]</span><span class="op" id="5037951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5037955">}</span>&nbsp;<span class="keyword" id="5037957">else</span>&nbsp;<span class="op" id="5037962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5037967">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038010">_</span><span class="op" id="5038011">,</span>&nbsp;<span class="ident" id="5038013">n</span>&nbsp;<span class="op" id="5038015">:=</span>&nbsp;<span class="ident" id="5038018">utf8</span><span class="op" id="5038022">.</span><span class="ident" id="5038023">DecodeRune</span><span class="op" id="5038033">(</span><span class="ident" id="5038034">s</span><span class="op" id="5038035">[</span><span class="num" id="5038036">1</span><span class="op" id="5038037">:</span><span class="op" id="5038038">]</span><span class="op" id="5038039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038044">b</span><span class="op" id="5038045">,</span>&nbsp;<span class="ident" id="5038047">s</span>&nbsp;<span class="op" id="5038049">=</span>&nbsp;<span class="builtinfunc" id="5038051">append</span><span class="op" id="5038057">(</span><span class="ident" id="5038058">b</span><span class="op" id="5038059">,</span>&nbsp;<span class="ident" id="5038061">s</span><span class="op" id="5038062">[</span><span class="num" id="5038063">1</span><span class="op" id="5038064">:</span><span class="num" id="5038065">1</span><span class="op" id="5038066">+</span><span class="ident" id="5038067">n</span><span class="op" id="5038068">]</span><span class="op" id="5038069">...</span><span class="op" id="5038072">)</span><span class="op" id="5038073">,</span>&nbsp;<span class="ident" id="5038075">s</span><span class="op" id="5038076">[</span><span class="num" id="5038077">1</span><span class="op" id="5038078">+</span><span class="ident" id="5038079">n</span><span class="op" id="5038080">:</span><span class="op" id="5038081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038091">return</span>&nbsp;<span class="ident" id="5038098">b</span><br>
<span class="lineno">100</span><span class="op" id="5038100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5038103">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="5038164">func</span>&nbsp;<span class="ident" id="5038169">isHex</span><span class="op" id="5038174">(</span><span class="ident" id="5038175">c</span>&nbsp;<span class="builtintype" id="5038177">byte</span><span class="op" id="5038181">)</span>&nbsp;<span class="builtintype" id="5038183">bool</span>&nbsp;<span class="op" id="5038188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038191">return</span>&nbsp;<span class="string" id="5038198">&#39;0&#39;</span>&nbsp;<span class="op" id="5038202">&lt;=</span>&nbsp;<span class="ident" id="5038205">c</span>&nbsp;<span class="op" id="5038207">&amp;&amp;</span>&nbsp;<span class="ident" id="5038210">c</span>&nbsp;<span class="op" id="5038212">&lt;=</span>&nbsp;<span class="string" id="5038215">&#39;9&#39;</span>&nbsp;<span class="op" id="5038219">||</span>&nbsp;<span class="string" id="5038222">&#39;a&#39;</span>&nbsp;<span class="op" id="5038226">&lt;=</span>&nbsp;<span class="ident" id="5038229">c</span>&nbsp;<span class="op" id="5038231">&amp;&amp;</span>&nbsp;<span class="ident" id="5038234">c</span>&nbsp;<span class="op" id="5038236">&lt;=</span>&nbsp;<span class="string" id="5038239">&#39;f&#39;</span>&nbsp;<span class="op" id="5038243">||</span>&nbsp;<span class="string" id="5038246">&#39;A&#39;</span>&nbsp;<span class="op" id="5038250">&lt;=</span>&nbsp;<span class="ident" id="5038253">c</span>&nbsp;<span class="op" id="5038255">&amp;&amp;</span>&nbsp;<span class="ident" id="5038258">c</span>&nbsp;<span class="op" id="5038260">&lt;=</span>&nbsp;<span class="string" id="5038263">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="5038267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5038270">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5038331">func</span>&nbsp;<span class="ident" id="5038336">hexDecode</span><span class="op" id="5038345">(</span><span class="ident" id="5038346">s</span>&nbsp;<span class="op" id="5038348">[</span><span class="op" id="5038349">]</span><span class="builtintype" id="5038350">byte</span><span class="op" id="5038354">)</span>&nbsp;<span class="builtintype" id="5038356">rune</span>&nbsp;<span class="op" id="5038361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038364">n</span>&nbsp;<span class="op" id="5038366">:=</span>&nbsp;<span class="string" id="5038369">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038377">for</span>&nbsp;<span class="ident" id="5038381">_</span><span class="op" id="5038382">,</span>&nbsp;<span class="ident" id="5038384">c</span>&nbsp;<span class="op" id="5038386">:=</span>&nbsp;<span class="keyword" id="5038389">range</span>&nbsp;<span class="ident" id="5038395">s</span>&nbsp;<span class="op" id="5038397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038401">n</span>&nbsp;<span class="op" id="5038403">&lt;&lt;=</span>&nbsp;<span class="num" id="5038407">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038411">switch</span>&nbsp;<span class="op" id="5038418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038422">case</span>&nbsp;<span class="string" id="5038427">&#39;0&#39;</span>&nbsp;<span class="op" id="5038431">&lt;=</span>&nbsp;<span class="ident" id="5038434">c</span>&nbsp;<span class="op" id="5038436">&amp;&amp;</span>&nbsp;<span class="ident" id="5038439">c</span>&nbsp;<span class="op" id="5038441">&lt;=</span>&nbsp;<span class="string" id="5038444">&#39;9&#39;</span><span class="op" id="5038447">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038452">n</span>&nbsp;<span class="op" id="5038454">|=</span>&nbsp;<span class="builtintype" id="5038457">rune</span><span class="op" id="5038461">(</span><span class="ident" id="5038462">c</span>&nbsp;<span class="op" id="5038464">-</span>&nbsp;<span class="string" id="5038466">&#39;0&#39;</span><span class="op" id="5038469">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038473">case</span>&nbsp;<span class="string" id="5038478">&#39;a&#39;</span>&nbsp;<span class="op" id="5038482">&lt;=</span>&nbsp;<span class="ident" id="5038485">c</span>&nbsp;<span class="op" id="5038487">&amp;&amp;</span>&nbsp;<span class="ident" id="5038490">c</span>&nbsp;<span class="op" id="5038492">&lt;=</span>&nbsp;<span class="string" id="5038495">&#39;f&#39;</span><span class="op" id="5038498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038503">n</span>&nbsp;<span class="op" id="5038505">|=</span>&nbsp;<span class="builtintype" id="5038508">rune</span><span class="op" id="5038512">(</span><span class="ident" id="5038513">c</span><span class="op" id="5038514">-</span><span class="string" id="5038515">&#39;a&#39;</span><span class="op" id="5038518">)</span>&nbsp;<span class="op" id="5038520">+</span>&nbsp;<span class="num" id="5038522">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038527">case</span>&nbsp;<span class="string" id="5038532">&#39;A&#39;</span>&nbsp;<span class="op" id="5038536">&lt;=</span>&nbsp;<span class="ident" id="5038539">c</span>&nbsp;<span class="op" id="5038541">&amp;&amp;</span>&nbsp;<span class="ident" id="5038544">c</span>&nbsp;<span class="op" id="5038546">&lt;=</span>&nbsp;<span class="string" id="5038549">&#39;F&#39;</span><span class="op" id="5038552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5038557">n</span>&nbsp;<span class="op" id="5038559">|=</span>&nbsp;<span class="builtintype" id="5038562">rune</span><span class="op" id="5038566">(</span><span class="ident" id="5038567">c</span><span class="op" id="5038568">-</span><span class="string" id="5038569">&#39;A&#39;</span><span class="op" id="5038572">)</span>&nbsp;<span class="op" id="5038574">+</span>&nbsp;<span class="num" id="5038576">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038581">default</span><span class="op" id="5038588">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5038593">panic</span><span class="op" id="5038598">(</span><span class="ident" id="5038599">fmt</span><span class="op" id="5038602">.</span><span class="ident" id="5038603">Sprintf</span><span class="op" id="5038610">(</span><span class="string" id="5038611">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="5038632">,</span>&nbsp;<span class="ident" id="5038634">s</span><span class="op" id="5038635">)</span><span class="op" id="5038636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038646">return</span>&nbsp;<span class="ident" id="5038653">n</span><br>
<span class="lineno"></span><span class="op" id="5038655">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5038658">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5038727">func</span>&nbsp;<span class="ident" id="5038732">skipCSSSpace</span><span class="op" id="5038744">(</span><span class="ident" id="5038745">c</span>&nbsp;<span class="op" id="5038747">[</span><span class="op" id="5038748">]</span><span class="builtintype" id="5038749">byte</span><span class="op" id="5038753">)</span>&nbsp;<span class="op" id="5038755">[</span><span class="op" id="5038756">]</span><span class="builtintype" id="5038757">byte</span>&nbsp;<span class="op" id="5038762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038765">if</span>&nbsp;<span class="builtinfunc" id="5038768">len</span><span class="op" id="5038771">(</span><span class="ident" id="5038772">c</span><span class="op" id="5038773">)</span>&nbsp;<span class="op" id="5038775">==</span>&nbsp;<span class="num" id="5038778">0</span>&nbsp;<span class="op" id="5038780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038784">return</span>&nbsp;<span class="ident" id="5038791">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5038794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5038797">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038837">switch</span>&nbsp;<span class="ident" id="5038844">c</span><span class="op" id="5038845">[</span><span class="num" id="5038846">0</span><span class="op" id="5038847">]</span>&nbsp;<span class="op" id="5038849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038852">case</span>&nbsp;<span class="string" id="5038857">&#39;\t&#39;</span><span class="op" id="5038861">,</span>&nbsp;<span class="string" id="5038863">&#39;\n&#39;</span><span class="op" id="5038867">,</span>&nbsp;<span class="string" id="5038869">&#39;\f&#39;</span><span class="op" id="5038873">,</span>&nbsp;<span class="string" id="5038875">&#39;&nbsp;&#39;</span><span class="op" id="5038878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038882">return</span>&nbsp;<span class="ident" id="5038889">c</span><span class="op" id="5038890">[</span><span class="num" id="5038891">1</span><span class="op" id="5038892">:</span><span class="op" id="5038893">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5038896">case</span>&nbsp;<span class="string" id="5038901">&#39;\r&#39;</span><span class="op" id="5038905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5038909">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5038975">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039040">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039085">if</span>&nbsp;<span class="builtinfunc" id="5039088">len</span><span class="op" id="5039091">(</span><span class="ident" id="5039092">c</span><span class="op" id="5039093">)</span>&nbsp;<span class="op" id="5039095">&gt;=</span>&nbsp;<span class="num" id="5039098">2</span>&nbsp;<span class="op" id="5039100">&amp;&amp;</span>&nbsp;<span class="ident" id="5039103">c</span><span class="op" id="5039104">[</span><span class="num" id="5039105">1</span><span class="op" id="5039106">]</span>&nbsp;<span class="op" id="5039108">==</span>&nbsp;<span class="string" id="5039111">&#39;\n&#39;</span>&nbsp;<span class="op" id="5039116">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039121">return</span>&nbsp;<span class="ident" id="5039128">c</span><span class="op" id="5039129">[</span><span class="num" id="5039130">2</span><span class="op" id="5039131">:</span><span class="op" id="5039132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039140">return</span>&nbsp;<span class="ident" id="5039147">c</span><span class="op" id="5039148">[</span><span class="num" id="5039149">1</span><span class="op" id="5039150">:</span><span class="op" id="5039151">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039157">return</span>&nbsp;<span class="ident" id="5039164">c</span><br>
<span class="lineno">145</span><span class="op" id="5039166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5039169">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="5039239">func</span>&nbsp;<span class="ident" id="5039244">isCSSSpace</span><span class="op" id="5039254">(</span><span class="ident" id="5039255">b</span>&nbsp;<span class="builtintype" id="5039257">byte</span><span class="op" id="5039261">)</span>&nbsp;<span class="builtintype" id="5039263">bool</span>&nbsp;<span class="op" id="5039268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039271">switch</span>&nbsp;<span class="ident" id="5039278">b</span>&nbsp;<span class="op" id="5039280">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039283">case</span>&nbsp;<span class="string" id="5039288">&#39;\t&#39;</span><span class="op" id="5039292">,</span>&nbsp;<span class="string" id="5039294">&#39;\n&#39;</span><span class="op" id="5039298">,</span>&nbsp;<span class="string" id="5039300">&#39;\f&#39;</span><span class="op" id="5039304">,</span>&nbsp;<span class="string" id="5039306">&#39;\r&#39;</span><span class="op" id="5039310">,</span>&nbsp;<span class="string" id="5039312">&#39;&nbsp;&#39;</span><span class="op" id="5039315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039319">return</span>&nbsp;<span class="builtintype" id="5039326">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5039332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039335">return</span>&nbsp;<span class="builtintype" id="5039342">false</span><br>
<span class="lineno"></span><span class="op" id="5039348">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5039351">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="5039428">func</span>&nbsp;<span class="ident" id="5039433">cssEscaper</span><span class="op" id="5039443">(</span><span class="ident" id="5039444">args</span>&nbsp;<span class="op" id="5039449">...</span><span class="keyword" id="5039452">interface</span><span class="op" id="5039461">{</span><span class="op" id="5039462">}</span><span class="op" id="5039463">)</span>&nbsp;<span class="builtintype" id="5039465">string</span>&nbsp;<span class="op" id="5039472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039475">s</span><span class="op" id="5039476">,</span>&nbsp;<span class="ident" id="5039478">_</span>&nbsp;<span class="op" id="5039480">:=</span>&nbsp;<span class="ident" id="5039483">stringify</span><span class="op" id="5039492">(</span><span class="ident" id="5039493">args</span><span class="op" id="5039497">...</span><span class="op" id="5039500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039503">var</span>&nbsp;<span class="ident" id="5039507">b</span>&nbsp;<span class="ident" id="5039509">bytes</span><span class="op" id="5039514">.</span><span class="ident" id="5039515">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039523">written</span>&nbsp;<span class="op" id="5039531">:=</span>&nbsp;<span class="num" id="5039534">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039537">for</span>&nbsp;<span class="ident" id="5039541">i</span><span class="op" id="5039542">,</span>&nbsp;<span class="ident" id="5039544">r</span>&nbsp;<span class="op" id="5039546">:=</span>&nbsp;<span class="keyword" id="5039549">range</span>&nbsp;<span class="ident" id="5039555">s</span>&nbsp;<span class="op" id="5039557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039561">var</span>&nbsp;<span class="ident" id="5039565">repl</span>&nbsp;<span class="builtintype" id="5039570">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039579">switch</span>&nbsp;<span class="ident" id="5039586">r</span>&nbsp;<span class="op" id="5039588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039592">case</span>&nbsp;<span class="num" id="5039597">0</span><span class="op" id="5039598">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039603">repl</span>&nbsp;<span class="op" id="5039608">=</span>&nbsp;<span class="string" id="5039610">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039617">case</span>&nbsp;<span class="string" id="5039622">&#39;\t&#39;</span><span class="op" id="5039626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039631">repl</span>&nbsp;<span class="op" id="5039636">=</span>&nbsp;<span class="string" id="5039638">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039645">case</span>&nbsp;<span class="string" id="5039650">&#39;\n&#39;</span><span class="op" id="5039654">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039659">repl</span>&nbsp;<span class="op" id="5039664">=</span>&nbsp;<span class="string" id="5039666">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039673">case</span>&nbsp;<span class="string" id="5039678">&#39;\f&#39;</span><span class="op" id="5039682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039687">repl</span>&nbsp;<span class="op" id="5039692">=</span>&nbsp;<span class="string" id="5039694">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039701">case</span>&nbsp;<span class="string" id="5039706">&#39;\r&#39;</span><span class="op" id="5039710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039715">repl</span>&nbsp;<span class="op" id="5039720">=</span>&nbsp;<span class="string" id="5039722">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039729">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5039792">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039842">case</span>&nbsp;<span class="string" id="5039847">&#39;&#34;&#39;</span><span class="op" id="5039850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039855">repl</span>&nbsp;<span class="op" id="5039860">=</span>&nbsp;<span class="string" id="5039862">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039870">case</span>&nbsp;<span class="string" id="5039875">&#39;&amp;&#39;</span><span class="op" id="5039878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039883">repl</span>&nbsp;<span class="op" id="5039888">=</span>&nbsp;<span class="string" id="5039890">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039898">case</span>&nbsp;<span class="string" id="5039903">&#39;\&#39;&#39;</span><span class="op" id="5039907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039912">repl</span>&nbsp;<span class="op" id="5039917">=</span>&nbsp;<span class="string" id="5039919">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039927">case</span>&nbsp;<span class="string" id="5039932">&#39;(&#39;</span><span class="op" id="5039935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039940">repl</span>&nbsp;<span class="op" id="5039945">=</span>&nbsp;<span class="string" id="5039947">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039955">case</span>&nbsp;<span class="string" id="5039960">&#39;)&#39;</span><span class="op" id="5039963">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039968">repl</span>&nbsp;<span class="op" id="5039973">=</span>&nbsp;<span class="string" id="5039975">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5039983">case</span>&nbsp;<span class="string" id="5039988">&#39;+&#39;</span><span class="op" id="5039991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5039996">repl</span>&nbsp;<span class="op" id="5040001">=</span>&nbsp;<span class="string" id="5040003">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040011">case</span>&nbsp;<span class="string" id="5040016">&#39;/&#39;</span><span class="op" id="5040019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040024">repl</span>&nbsp;<span class="op" id="5040029">=</span>&nbsp;<span class="string" id="5040031">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040039">case</span>&nbsp;<span class="string" id="5040044">&#39;:&#39;</span><span class="op" id="5040047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040052">repl</span>&nbsp;<span class="op" id="5040057">=</span>&nbsp;<span class="string" id="5040059">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040067">case</span>&nbsp;<span class="string" id="5040072">&#39;;&#39;</span><span class="op" id="5040075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040080">repl</span>&nbsp;<span class="op" id="5040085">=</span>&nbsp;<span class="string" id="5040087">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040095">case</span>&nbsp;<span class="string" id="5040100">&#39;&lt;&#39;</span><span class="op" id="5040103">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040108">repl</span>&nbsp;<span class="op" id="5040113">=</span>&nbsp;<span class="string" id="5040115">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040123">case</span>&nbsp;<span class="string" id="5040128">&#39;&gt;&#39;</span><span class="op" id="5040131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040136">repl</span>&nbsp;<span class="op" id="5040141">=</span>&nbsp;<span class="string" id="5040143">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040151">case</span>&nbsp;<span class="string" id="5040156">&#39;\\&#39;</span><span class="op" id="5040160">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040165">repl</span>&nbsp;<span class="op" id="5040170">=</span>&nbsp;<span class="string" id="5040172">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040179">case</span>&nbsp;<span class="string" id="5040184">&#39;{&#39;</span><span class="op" id="5040187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040192">repl</span>&nbsp;<span class="op" id="5040197">=</span>&nbsp;<span class="string" id="5040199">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040207">case</span>&nbsp;<span class="string" id="5040212">&#39;}&#39;</span><span class="op" id="5040215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040220">repl</span>&nbsp;<span class="op" id="5040225">=</span>&nbsp;<span class="string" id="5040227">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040235">default</span><span class="op" id="5040242">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040247">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040262">b</span><span class="op" id="5040263">.</span><span class="ident" id="5040264">WriteString</span><span class="op" id="5040275">(</span><span class="ident" id="5040276">s</span><span class="op" id="5040277">[</span><span class="ident" id="5040278">written</span><span class="op" id="5040285">:</span><span class="ident" id="5040286">i</span><span class="op" id="5040287">]</span><span class="op" id="5040288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040292">b</span><span class="op" id="5040293">.</span><span class="ident" id="5040294">WriteString</span><span class="op" id="5040305">(</span><span class="ident" id="5040306">repl</span><span class="op" id="5040310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040314">written</span>&nbsp;<span class="op" id="5040322">=</span>&nbsp;<span class="ident" id="5040324">i</span>&nbsp;<span class="op" id="5040326">+</span>&nbsp;<span class="ident" id="5040328">utf8</span><span class="op" id="5040332">.</span><span class="ident" id="5040333">RuneLen</span><span class="op" id="5040340">(</span><span class="ident" id="5040341">r</span><span class="op" id="5040342">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040346">if</span>&nbsp;<span class="ident" id="5040349">repl</span>&nbsp;<span class="op" id="5040354">!=</span>&nbsp;<span class="string" id="5040357">`\\`</span>&nbsp;<span class="op" id="5040362">&amp;&amp;</span>&nbsp;<span class="op" id="5040365">(</span><span class="ident" id="5040366">written</span>&nbsp;<span class="op" id="5040374">==</span>&nbsp;<span class="builtinfunc" id="5040377">len</span><span class="op" id="5040380">(</span><span class="ident" id="5040381">s</span><span class="op" id="5040382">)</span>&nbsp;<span class="op" id="5040384">||</span>&nbsp;<span class="ident" id="5040387">isHex</span><span class="op" id="5040392">(</span><span class="ident" id="5040393">s</span><span class="op" id="5040394">[</span><span class="ident" id="5040395">written</span><span class="op" id="5040402">]</span><span class="op" id="5040403">)</span>&nbsp;<span class="op" id="5040405">||</span>&nbsp;<span class="ident" id="5040408">isCSSSpace</span><span class="op" id="5040418">(</span><span class="ident" id="5040419">s</span><span class="op" id="5040420">[</span><span class="ident" id="5040421">written</span><span class="op" id="5040428">]</span><span class="op" id="5040429">)</span><span class="op" id="5040430">)</span>&nbsp;<span class="op" id="5040432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040437">b</span><span class="op" id="5040438">.</span><span class="ident" id="5040439">WriteByte</span><span class="op" id="5040448">(</span><span class="string" id="5040449">&#39;&nbsp;&#39;</span><span class="op" id="5040452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040462">if</span>&nbsp;<span class="ident" id="5040465">written</span>&nbsp;<span class="op" id="5040473">==</span>&nbsp;<span class="num" id="5040476">0</span>&nbsp;<span class="op" id="5040478">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040482">return</span>&nbsp;<span class="ident" id="5040489">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5040492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040495">b</span><span class="op" id="5040496">.</span><span class="ident" id="5040497">WriteString</span><span class="op" id="5040508">(</span><span class="ident" id="5040509">s</span><span class="op" id="5040510">[</span><span class="ident" id="5040511">written</span><span class="op" id="5040518">:</span><span class="op" id="5040519">]</span><span class="op" id="5040520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5040523">return</span>&nbsp;<span class="ident" id="5040530">b</span><span class="op" id="5040531">.</span><span class="ident" id="5040532">String</span><span class="op" id="5040538">(</span><span class="op" id="5040539">)</span><br>
<span class="lineno"></span><span class="op" id="5040541">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="5040544">var</span>&nbsp;<span class="ident" id="5040548">expressionBytes</span>&nbsp;<span class="op" id="5040564">=</span>&nbsp;<span class="op" id="5040566">[</span><span class="op" id="5040567">]</span><span class="builtintype" id="5040568">byte</span><span class="op" id="5040572">(</span><span class="string" id="5040573">&#34;expression&#34;</span><span class="op" id="5040585">)</span><br>
<span class="lineno"></span><span class="keyword" id="5040587">var</span>&nbsp;<span class="ident" id="5040591">mozBindingBytes</span>&nbsp;<span class="op" id="5040607">=</span>&nbsp;<span class="op" id="5040609">[</span><span class="op" id="5040610">]</span><span class="builtintype" id="5040611">byte</span><span class="op" id="5040615">(</span><span class="string" id="5040616">&#34;mozbinding&#34;</span><span class="op" id="5040628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5040631">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="5040705">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5040784">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="5040823">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="5040900">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="5040944">func</span>&nbsp;<span class="ident" id="5040949">cssValueFilter</span><span class="op" id="5040963">(</span><span class="ident" id="5040964">args</span>&nbsp;<span class="op" id="5040969">...</span><span class="keyword" id="5040972">interface</span><span class="op" id="5040981">{</span><span class="op" id="5040982">}</span><span class="op" id="5040983">)</span>&nbsp;<span class="builtintype" id="5040985">string</span>&nbsp;<span class="op" id="5040992">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5040995">s</span><span class="op" id="5040996">,</span>&nbsp;<span class="ident" id="5040998">t</span>&nbsp;<span class="op" id="5041000">:=</span>&nbsp;<span class="ident" id="5041003">stringify</span><span class="op" id="5041012">(</span><span class="ident" id="5041013">args</span><span class="op" id="5041017">...</span><span class="op" id="5041020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041023">if</span>&nbsp;<span class="ident" id="5041026">t</span>&nbsp;<span class="op" id="5041028">==</span>&nbsp;<span class="ident" id="5041031">contentTypeCSS</span>&nbsp;<span class="op" id="5041046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041050">return</span>&nbsp;<span class="ident" id="5041057">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5041060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5041063">b</span><span class="op" id="5041064">,</span>&nbsp;<span class="ident" id="5041066">id</span>&nbsp;<span class="op" id="5041069">:=</span>&nbsp;<span class="ident" id="5041072">decodeCSS</span><span class="op" id="5041081">(</span><span class="op" id="5041082">[</span><span class="op" id="5041083">]</span><span class="builtintype" id="5041084">byte</span><span class="op" id="5041088">(</span><span class="ident" id="5041089">s</span><span class="op" id="5041090">)</span><span class="op" id="5041091">)</span><span class="op" id="5041092">,</span>&nbsp;<span class="builtinfunc" id="5041094">make</span><span class="op" id="5041098">(</span><span class="op" id="5041099">[</span><span class="op" id="5041100">]</span><span class="builtintype" id="5041101">byte</span><span class="op" id="5041105">,</span>&nbsp;<span class="num" id="5041107">0</span><span class="op" id="5041108">,</span>&nbsp;<span class="num" id="5041110">64</span><span class="op" id="5041112">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041116">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041187">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041242">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041309">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041381">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041520">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041591">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041629">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041700">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041771">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041827">for</span>&nbsp;<span class="ident" id="5041831">i</span><span class="op" id="5041832">,</span>&nbsp;<span class="ident" id="5041834">c</span>&nbsp;<span class="op" id="5041836">:=</span>&nbsp;<span class="keyword" id="5041839">range</span>&nbsp;<span class="ident" id="5041845">b</span>&nbsp;<span class="op" id="5041847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041851">switch</span>&nbsp;<span class="ident" id="5041858">c</span>&nbsp;<span class="op" id="5041860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041864">case</span>&nbsp;<span class="num" id="5041869">0</span><span class="op" id="5041870">,</span>&nbsp;<span class="string" id="5041872">&#39;&#34;&#39;</span><span class="op" id="5041875">,</span>&nbsp;<span class="string" id="5041877">&#39;\&#39;&#39;</span><span class="op" id="5041881">,</span>&nbsp;<span class="string" id="5041883">&#39;(&#39;</span><span class="op" id="5041886">,</span>&nbsp;<span class="string" id="5041888">&#39;)&#39;</span><span class="op" id="5041891">,</span>&nbsp;<span class="string" id="5041893">&#39;/&#39;</span><span class="op" id="5041896">,</span>&nbsp;<span class="string" id="5041898">&#39;;&#39;</span><span class="op" id="5041901">,</span>&nbsp;<span class="string" id="5041903">&#39;@&#39;</span><span class="op" id="5041906">,</span>&nbsp;<span class="string" id="5041908">&#39;[&#39;</span><span class="op" id="5041911">,</span>&nbsp;<span class="string" id="5041913">&#39;\\&#39;</span><span class="op" id="5041917">,</span>&nbsp;<span class="string" id="5041919">&#39;]&#39;</span><span class="op" id="5041922">,</span>&nbsp;<span class="string" id="5041924">&#39;`&#39;</span><span class="op" id="5041927">,</span>&nbsp;<span class="string" id="5041929">&#39;{&#39;</span><span class="op" id="5041932">,</span>&nbsp;<span class="string" id="5041934">&#39;}&#39;</span><span class="op" id="5041937">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041942">return</span>&nbsp;<span class="ident" id="5041949">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5041966">case</span>&nbsp;<span class="string" id="5041971">&#39;-&#39;</span><span class="op" id="5041974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5041979">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5042007">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042056">if</span>&nbsp;<span class="ident" id="5042059">i</span>&nbsp;<span class="op" id="5042061">!=</span>&nbsp;<span class="num" id="5042064">0</span>&nbsp;<span class="op" id="5042066">&amp;&amp;</span>&nbsp;<span class="ident" id="5042069">b</span><span class="op" id="5042070">[</span><span class="ident" id="5042071">i</span><span class="op" id="5042072">-</span><span class="num" id="5042073">1</span><span class="op" id="5042074">]</span>&nbsp;<span class="op" id="5042076">==</span>&nbsp;<span class="string" id="5042079">&#39;-&#39;</span>&nbsp;<span class="op" id="5042083">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042089">return</span>&nbsp;<span class="ident" id="5042096">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042118">default</span><span class="op" id="5042125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042130">if</span>&nbsp;<span class="ident" id="5042133">c</span>&nbsp;<span class="op" id="5042135">&lt;</span>&nbsp;<span class="num" id="5042137">0x80</span>&nbsp;<span class="op" id="5042142">&amp;&amp;</span>&nbsp;<span class="ident" id="5042145">isCSSNmchar</span><span class="op" id="5042156">(</span><span class="builtintype" id="5042157">rune</span><span class="op" id="5042161">(</span><span class="ident" id="5042162">c</span><span class="op" id="5042163">)</span><span class="op" id="5042164">)</span>&nbsp;<span class="op" id="5042166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042172">id</span>&nbsp;<span class="op" id="5042175">=</span>&nbsp;<span class="builtinfunc" id="5042177">append</span><span class="op" id="5042183">(</span><span class="ident" id="5042184">id</span><span class="op" id="5042186">,</span>&nbsp;<span class="ident" id="5042188">c</span><span class="op" id="5042189">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5042204">id</span>&nbsp;<span class="op" id="5042207">=</span>&nbsp;<span class="ident" id="5042209">bytes</span><span class="op" id="5042214">.</span><span class="ident" id="5042215">ToLower</span><span class="op" id="5042222">(</span><span class="ident" id="5042223">id</span><span class="op" id="5042225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042228">if</span>&nbsp;<span class="ident" id="5042231">bytes</span><span class="op" id="5042236">.</span><span class="ident" id="5042237">Index</span><span class="op" id="5042242">(</span><span class="ident" id="5042243">id</span><span class="op" id="5042245">,</span>&nbsp;<span class="ident" id="5042247">expressionBytes</span><span class="op" id="5042262">)</span>&nbsp;<span class="op" id="5042264">!=</span>&nbsp;<span class="op" id="5042267">-</span><span class="num" id="5042268">1</span>&nbsp;<span class="op" id="5042270">||</span>&nbsp;<span class="ident" id="5042273">bytes</span><span class="op" id="5042278">.</span><span class="ident" id="5042279">Index</span><span class="op" id="5042284">(</span><span class="ident" id="5042285">id</span><span class="op" id="5042287">,</span>&nbsp;<span class="ident" id="5042289">mozBindingBytes</span><span class="op" id="5042304">)</span>&nbsp;<span class="op" id="5042306">!=</span>&nbsp;<span class="op" id="5042309">-</span><span class="num" id="5042310">1</span>&nbsp;<span class="op" id="5042312">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042316">return</span>&nbsp;<span class="ident" id="5042323">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5042339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5042342">return</span>&nbsp;<span class="builtintype" id="5042349">string</span><span class="op" id="5042355">(</span><span class="ident" id="5042356">b</span><span class="op" id="5042357">)</span><br>
<span class="lineno"></span><span class="op" id="5042359">}</span>
</div>
</body>
</html>
