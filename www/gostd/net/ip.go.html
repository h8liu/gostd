<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3029612">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3029667">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3029721">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3029772">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3029800">//</span><br>
<span class="lineno"></span><span class="comment" id="3029803">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3029863">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3029921">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3029971">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3030032">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3030063">package</span>&nbsp;<span class="ident" id="3030071">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3030076">import</span>&nbsp;<span class="string" id="3030083">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030093">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3030124">const</span>&nbsp;<span class="op" id="3030130">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030133">IPv4len</span>&nbsp;<span class="op" id="3030141">=</span>&nbsp;<span class="num" id="3030143">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030146">IPv6len</span>&nbsp;<span class="op" id="3030154">=</span>&nbsp;<span class="num" id="3030156">16</span><br>
<span class="lineno"></span><span class="op" id="3030159">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030162">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3030213">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3030270">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3030308">//</span><br>
<span class="lineno"></span><span class="comment" id="3030311">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3030363">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3030415">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3030470">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3030525">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3030548">type</span>&nbsp;<span class="ident" id="3030553">IP</span>&nbsp;<span class="op" id="3030556">[</span><span class="op" id="3030557">]</span><span class="builtintype" id="3030558">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030564">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3030596">type</span>&nbsp;<span class="ident" id="3030601">IPMask</span>&nbsp;<span class="op" id="3030608">[</span><span class="op" id="3030609">]</span><span class="builtintype" id="3030610">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030616">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3030654">type</span>&nbsp;<span class="ident" id="3030659">IPNet</span>&nbsp;<span class="keyword" id="3030665">struct</span>&nbsp;<span class="op" id="3030672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030675">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3030680">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3030687">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030706">Mask</span>&nbsp;<span class="ident" id="3030711">IPMask</span>&nbsp;<span class="comment" id="3030718">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3030734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030737">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3030793">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3030818">func</span>&nbsp;<span class="ident" id="3030823">IPv4</span><span class="op" id="3030827">(</span><span class="ident" id="3030828">a</span><span class="op" id="3030829">,</span>&nbsp;<span class="ident" id="3030831">b</span><span class="op" id="3030832">,</span>&nbsp;<span class="ident" id="3030834">c</span><span class="op" id="3030835">,</span>&nbsp;<span class="ident" id="3030837">d</span>&nbsp;<span class="builtintype" id="3030839">byte</span><span class="op" id="3030843">)</span>&nbsp;<span class="ident" id="3030845">IP</span>&nbsp;<span class="op" id="3030848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030851">p</span>&nbsp;<span class="op" id="3030853">:=</span>&nbsp;<span class="builtinfunc" id="3030856">make</span><span class="op" id="3030860">(</span><span class="ident" id="3030861">IP</span><span class="op" id="3030863">,</span>&nbsp;<span class="ident" id="3030865">IPv6len</span><span class="op" id="3030872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3030875">copy</span><span class="op" id="3030879">(</span><span class="ident" id="3030880">p</span><span class="op" id="3030881">,</span>&nbsp;<span class="ident" id="3030883">v4InV6Prefix</span><span class="op" id="3030895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030898">p</span><span class="op" id="3030899">[</span><span class="num" id="3030900">12</span><span class="op" id="3030902">]</span>&nbsp;<span class="op" id="3030904">=</span>&nbsp;<span class="ident" id="3030906">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030909">p</span><span class="op" id="3030910">[</span><span class="num" id="3030911">13</span><span class="op" id="3030913">]</span>&nbsp;<span class="op" id="3030915">=</span>&nbsp;<span class="ident" id="3030917">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030920">p</span><span class="op" id="3030921">[</span><span class="num" id="3030922">14</span><span class="op" id="3030924">]</span>&nbsp;<span class="op" id="3030926">=</span>&nbsp;<span class="ident" id="3030928">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030931">p</span><span class="op" id="3030932">[</span><span class="num" id="3030933">15</span><span class="op" id="3030935">]</span>&nbsp;<span class="op" id="3030937">=</span>&nbsp;<span class="ident" id="3030939">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030942">return</span>&nbsp;<span class="ident" id="3030949">p</span><br>
<span class="lineno"></span><span class="op" id="3030951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3030954">var</span>&nbsp;<span class="ident" id="3030958">v4InV6Prefix</span>&nbsp;<span class="op" id="3030971">=</span>&nbsp;<span class="op" id="3030973">[</span><span class="op" id="3030974">]</span><span class="builtintype" id="3030975">byte</span><span class="op" id="3030979">{</span><span class="num" id="3030980">0</span><span class="op" id="3030981">,</span>&nbsp;<span class="num" id="3030983">0</span><span class="op" id="3030984">,</span>&nbsp;<span class="num" id="3030986">0</span><span class="op" id="3030987">,</span>&nbsp;<span class="num" id="3030989">0</span><span class="op" id="3030990">,</span>&nbsp;<span class="num" id="3030992">0</span><span class="op" id="3030993">,</span>&nbsp;<span class="num" id="3030995">0</span><span class="op" id="3030996">,</span>&nbsp;<span class="num" id="3030998">0</span><span class="op" id="3030999">,</span>&nbsp;<span class="num" id="3031001">0</span><span class="op" id="3031002">,</span>&nbsp;<span class="num" id="3031004">0</span><span class="op" id="3031005">,</span>&nbsp;<span class="num" id="3031007">0</span><span class="op" id="3031008">,</span>&nbsp;<span class="num" id="3031010">0xff</span><span class="op" id="3031014">,</span>&nbsp;<span class="num" id="3031016">0xff</span><span class="op" id="3031020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3031023">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3031079">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3031101">func</span>&nbsp;<span class="ident" id="3031106">IPv4Mask</span><span class="op" id="3031114">(</span><span class="ident" id="3031115">a</span><span class="op" id="3031116">,</span>&nbsp;<span class="ident" id="3031118">b</span><span class="op" id="3031119">,</span>&nbsp;<span class="ident" id="3031121">c</span><span class="op" id="3031122">,</span>&nbsp;<span class="ident" id="3031124">d</span>&nbsp;<span class="builtintype" id="3031126">byte</span><span class="op" id="3031130">)</span>&nbsp;<span class="ident" id="3031132">IPMask</span>&nbsp;<span class="op" id="3031139">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031142">p</span>&nbsp;<span class="op" id="3031144">:=</span>&nbsp;<span class="builtinfunc" id="3031147">make</span><span class="op" id="3031151">(</span><span class="ident" id="3031152">IPMask</span><span class="op" id="3031158">,</span>&nbsp;<span class="ident" id="3031160">IPv4len</span><span class="op" id="3031167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031170">p</span><span class="op" id="3031171">[</span><span class="num" id="3031172">0</span><span class="op" id="3031173">]</span>&nbsp;<span class="op" id="3031175">=</span>&nbsp;<span class="ident" id="3031177">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031180">p</span><span class="op" id="3031181">[</span><span class="num" id="3031182">1</span><span class="op" id="3031183">]</span>&nbsp;<span class="op" id="3031185">=</span>&nbsp;<span class="ident" id="3031187">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031190">p</span><span class="op" id="3031191">[</span><span class="num" id="3031192">2</span><span class="op" id="3031193">]</span>&nbsp;<span class="op" id="3031195">=</span>&nbsp;<span class="ident" id="3031197">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031200">p</span><span class="op" id="3031201">[</span><span class="num" id="3031202">3</span><span class="op" id="3031203">]</span>&nbsp;<span class="op" id="3031205">=</span>&nbsp;<span class="ident" id="3031207">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031210">return</span>&nbsp;<span class="ident" id="3031217">p</span><br>
<span class="lineno"></span><span class="op" id="3031219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3031222">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3031280">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3031335">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3031403">func</span>&nbsp;<span class="ident" id="3031408">CIDRMask</span><span class="op" id="3031416">(</span><span class="ident" id="3031417">ones</span><span class="op" id="3031421">,</span>&nbsp;<span class="ident" id="3031423">bits</span>&nbsp;<span class="builtintype" id="3031428">int</span><span class="op" id="3031431">)</span>&nbsp;<span class="ident" id="3031433">IPMask</span>&nbsp;<span class="op" id="3031440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031443">if</span>&nbsp;<span class="ident" id="3031446">bits</span>&nbsp;<span class="op" id="3031451">!=</span>&nbsp;<span class="num" id="3031454">8</span><span class="op" id="3031455">*</span><span class="ident" id="3031456">IPv4len</span>&nbsp;<span class="op" id="3031464">&amp;&amp;</span>&nbsp;<span class="ident" id="3031467">bits</span>&nbsp;<span class="op" id="3031472">!=</span>&nbsp;<span class="num" id="3031475">8</span><span class="op" id="3031476">*</span><span class="ident" id="3031477">IPv6len</span>&nbsp;<span class="op" id="3031485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031489">return</span>&nbsp;<span class="ident" id="3031496">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3031501">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031504">if</span>&nbsp;<span class="ident" id="3031507">ones</span>&nbsp;<span class="op" id="3031512">&lt;</span>&nbsp;<span class="num" id="3031514">0</span>&nbsp;<span class="op" id="3031516">||</span>&nbsp;<span class="ident" id="3031519">ones</span>&nbsp;<span class="op" id="3031524">&gt;</span>&nbsp;<span class="ident" id="3031526">bits</span>&nbsp;<span class="op" id="3031531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031535">return</span>&nbsp;<span class="ident" id="3031542">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3031547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031550">l</span>&nbsp;<span class="op" id="3031552">:=</span>&nbsp;<span class="ident" id="3031555">bits</span>&nbsp;<span class="op" id="3031560">/</span>&nbsp;<span class="num" id="3031562">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031565">m</span>&nbsp;<span class="op" id="3031567">:=</span>&nbsp;<span class="builtinfunc" id="3031570">make</span><span class="op" id="3031574">(</span><span class="ident" id="3031575">IPMask</span><span class="op" id="3031581">,</span>&nbsp;<span class="ident" id="3031583">l</span><span class="op" id="3031584">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031587">n</span>&nbsp;<span class="op" id="3031589">:=</span>&nbsp;<span class="builtintype" id="3031592">uint</span><span class="op" id="3031596">(</span><span class="ident" id="3031597">ones</span><span class="op" id="3031601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031604">for</span>&nbsp;<span class="ident" id="3031608">i</span>&nbsp;<span class="op" id="3031610">:=</span>&nbsp;<span class="num" id="3031613">0</span><span class="op" id="3031614">;</span>&nbsp;<span class="ident" id="3031616">i</span>&nbsp;<span class="op" id="3031618">&lt;</span>&nbsp;<span class="ident" id="3031620">l</span><span class="op" id="3031621">;</span>&nbsp;<span class="ident" id="3031623">i</span><span class="op" id="3031624">++</span>&nbsp;<span class="op" id="3031627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031631">if</span>&nbsp;<span class="ident" id="3031634">n</span>&nbsp;<span class="op" id="3031636">&gt;=</span>&nbsp;<span class="num" id="3031639">8</span>&nbsp;<span class="op" id="3031641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031646">m</span><span class="op" id="3031647">[</span><span class="ident" id="3031648">i</span><span class="op" id="3031649">]</span>&nbsp;<span class="op" id="3031651">=</span>&nbsp;<span class="num" id="3031653">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031661">n</span>&nbsp;<span class="op" id="3031663">-=</span>&nbsp;<span class="num" id="3031666">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031671">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3031682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031686">m</span><span class="op" id="3031687">[</span><span class="ident" id="3031688">i</span><span class="op" id="3031689">]</span>&nbsp;<span class="op" id="3031691">=</span>&nbsp;<span class="op" id="3031693">^</span><span class="builtintype" id="3031694">byte</span><span class="op" id="3031698">(</span><span class="num" id="3031699">0xff</span>&nbsp;<span class="op" id="3031704">&gt;&gt;</span>&nbsp;<span class="ident" id="3031707">n</span><span class="op" id="3031708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031712">n</span>&nbsp;<span class="op" id="3031714">=</span>&nbsp;<span class="num" id="3031716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3031719">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3031722">return</span>&nbsp;<span class="ident" id="3031729">m</span><br>
<span class="lineno"></span><span class="op" id="3031731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3031734">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3031763">var</span>&nbsp;<span class="op" id="3031767">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031770">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3031784">=</span>&nbsp;<span class="ident" id="3031786">IPv4</span><span class="op" id="3031790">(</span><span class="num" id="3031791">255</span><span class="op" id="3031794">,</span>&nbsp;<span class="num" id="3031796">255</span><span class="op" id="3031799">,</span>&nbsp;<span class="num" id="3031801">255</span><span class="op" id="3031804">,</span>&nbsp;<span class="num" id="3031806">255</span><span class="op" id="3031809">)</span>&nbsp;<span class="comment" id="3031811">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031825">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3031839">=</span>&nbsp;<span class="ident" id="3031841">IPv4</span><span class="op" id="3031845">(</span><span class="num" id="3031846">224</span><span class="op" id="3031849">,</span>&nbsp;<span class="num" id="3031851">0</span><span class="op" id="3031852">,</span>&nbsp;<span class="num" id="3031854">0</span><span class="op" id="3031855">,</span>&nbsp;<span class="num" id="3031857">1</span><span class="op" id="3031858">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3031866">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031882">IPv4allrouter</span>&nbsp;<span class="op" id="3031896">=</span>&nbsp;<span class="ident" id="3031898">IPv4</span><span class="op" id="3031902">(</span><span class="num" id="3031903">224</span><span class="op" id="3031906">,</span>&nbsp;<span class="num" id="3031908">0</span><span class="op" id="3031909">,</span>&nbsp;<span class="num" id="3031911">0</span><span class="op" id="3031912">,</span>&nbsp;<span class="num" id="3031914">2</span><span class="op" id="3031915">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3031923">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3031939">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3031953">=</span>&nbsp;<span class="ident" id="3031955">IPv4</span><span class="op" id="3031959">(</span><span class="num" id="3031960">0</span><span class="op" id="3031961">,</span>&nbsp;<span class="num" id="3031963">0</span><span class="op" id="3031964">,</span>&nbsp;<span class="num" id="3031966">0</span><span class="op" id="3031967">,</span>&nbsp;<span class="num" id="3031969">0</span><span class="op" id="3031970">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3031980">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3031993">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3031996">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3032025">var</span>&nbsp;<span class="op" id="3032029">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3032032">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3032059">=</span>&nbsp;<span class="ident" id="3032061">IP</span><span class="op" id="3032063">{</span><span class="num" id="3032064">0</span><span class="op" id="3032065">,</span>&nbsp;<span class="num" id="3032067">0</span><span class="op" id="3032068">,</span>&nbsp;<span class="num" id="3032070">0</span><span class="op" id="3032071">,</span>&nbsp;<span class="num" id="3032073">0</span><span class="op" id="3032074">,</span>&nbsp;<span class="num" id="3032076">0</span><span class="op" id="3032077">,</span>&nbsp;<span class="num" id="3032079">0</span><span class="op" id="3032080">,</span>&nbsp;<span class="num" id="3032082">0</span><span class="op" id="3032083">,</span>&nbsp;<span class="num" id="3032085">0</span><span class="op" id="3032086">,</span>&nbsp;<span class="num" id="3032088">0</span><span class="op" id="3032089">,</span>&nbsp;<span class="num" id="3032091">0</span><span class="op" id="3032092">,</span>&nbsp;<span class="num" id="3032094">0</span><span class="op" id="3032095">,</span>&nbsp;<span class="num" id="3032097">0</span><span class="op" id="3032098">,</span>&nbsp;<span class="num" id="3032100">0</span><span class="op" id="3032101">,</span>&nbsp;<span class="num" id="3032103">0</span><span class="op" id="3032104">,</span>&nbsp;<span class="num" id="3032106">0</span><span class="op" id="3032107">,</span>&nbsp;<span class="num" id="3032109">0</span><span class="op" id="3032110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3032113">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3032140">=</span>&nbsp;<span class="ident" id="3032142">IP</span><span class="op" id="3032144">{</span><span class="num" id="3032145">0</span><span class="op" id="3032146">,</span>&nbsp;<span class="num" id="3032148">0</span><span class="op" id="3032149">,</span>&nbsp;<span class="num" id="3032151">0</span><span class="op" id="3032152">,</span>&nbsp;<span class="num" id="3032154">0</span><span class="op" id="3032155">,</span>&nbsp;<span class="num" id="3032157">0</span><span class="op" id="3032158">,</span>&nbsp;<span class="num" id="3032160">0</span><span class="op" id="3032161">,</span>&nbsp;<span class="num" id="3032163">0</span><span class="op" id="3032164">,</span>&nbsp;<span class="num" id="3032166">0</span><span class="op" id="3032167">,</span>&nbsp;<span class="num" id="3032169">0</span><span class="op" id="3032170">,</span>&nbsp;<span class="num" id="3032172">0</span><span class="op" id="3032173">,</span>&nbsp;<span class="num" id="3032175">0</span><span class="op" id="3032176">,</span>&nbsp;<span class="num" id="3032178">0</span><span class="op" id="3032179">,</span>&nbsp;<span class="num" id="3032181">0</span><span class="op" id="3032182">,</span>&nbsp;<span class="num" id="3032184">0</span><span class="op" id="3032185">,</span>&nbsp;<span class="num" id="3032187">0</span><span class="op" id="3032188">,</span>&nbsp;<span class="num" id="3032190">0</span><span class="op" id="3032191">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3032194">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3032221">=</span>&nbsp;<span class="ident" id="3032223">IP</span><span class="op" id="3032225">{</span><span class="num" id="3032226">0</span><span class="op" id="3032227">,</span>&nbsp;<span class="num" id="3032229">0</span><span class="op" id="3032230">,</span>&nbsp;<span class="num" id="3032232">0</span><span class="op" id="3032233">,</span>&nbsp;<span class="num" id="3032235">0</span><span class="op" id="3032236">,</span>&nbsp;<span class="num" id="3032238">0</span><span class="op" id="3032239">,</span>&nbsp;<span class="num" id="3032241">0</span><span class="op" id="3032242">,</span>&nbsp;<span class="num" id="3032244">0</span><span class="op" id="3032245">,</span>&nbsp;<span class="num" id="3032247">0</span><span class="op" id="3032248">,</span>&nbsp;<span class="num" id="3032250">0</span><span class="op" id="3032251">,</span>&nbsp;<span class="num" id="3032253">0</span><span class="op" id="3032254">,</span>&nbsp;<span class="num" id="3032256">0</span><span class="op" id="3032257">,</span>&nbsp;<span class="num" id="3032259">0</span><span class="op" id="3032260">,</span>&nbsp;<span class="num" id="3032262">0</span><span class="op" id="3032263">,</span>&nbsp;<span class="num" id="3032265">0</span><span class="op" id="3032266">,</span>&nbsp;<span class="num" id="3032268">0</span><span class="op" id="3032269">,</span>&nbsp;<span class="num" id="3032271">1</span><span class="op" id="3032272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3032275">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3032302">=</span>&nbsp;<span class="ident" id="3032304">IP</span><span class="op" id="3032306">{</span><span class="num" id="3032307">0xff</span><span class="op" id="3032311">,</span>&nbsp;<span class="num" id="3032313">0x01</span><span class="op" id="3032317">,</span>&nbsp;<span class="num" id="3032319">0</span><span class="op" id="3032320">,</span>&nbsp;<span class="num" id="3032322">0</span><span class="op" id="3032323">,</span>&nbsp;<span class="num" id="3032325">0</span><span class="op" id="3032326">,</span>&nbsp;<span class="num" id="3032328">0</span><span class="op" id="3032329">,</span>&nbsp;<span class="num" id="3032331">0</span><span class="op" id="3032332">,</span>&nbsp;<span class="num" id="3032334">0</span><span class="op" id="3032335">,</span>&nbsp;<span class="num" id="3032337">0</span><span class="op" id="3032338">,</span>&nbsp;<span class="num" id="3032340">0</span><span class="op" id="3032341">,</span>&nbsp;<span class="num" id="3032343">0</span><span class="op" id="3032344">,</span>&nbsp;<span class="num" id="3032346">0</span><span class="op" id="3032347">,</span>&nbsp;<span class="num" id="3032349">0</span><span class="op" id="3032350">,</span>&nbsp;<span class="num" id="3032352">0</span><span class="op" id="3032353">,</span>&nbsp;<span class="num" id="3032355">0</span><span class="op" id="3032356">,</span>&nbsp;<span class="num" id="3032358">0x01</span><span class="op" id="3032362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3032365">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3032392">=</span>&nbsp;<span class="ident" id="3032394">IP</span><span class="op" id="3032396">{</span><span class="num" id="3032397">0xff</span><span class="op" id="3032401">,</span>&nbsp;<span class="num" id="3032403">0x02</span><span class="op" id="3032407">,</span>&nbsp;<span class="num" id="3032409">0</span><span class="op" id="3032410">,</span>&nbsp;<span class="num" id="3032412">0</span><span class="op" id="3032413">,</span>&nbsp;<span class="num" id="3032415">0</span><span class="op" id="3032416">,</span>&nbsp;<span class="num" id="3032418">0</span><span class="op" id="3032419">,</span>&nbsp;<span class="num" id="3032421">0</span><span class="op" id="3032422">,</span>&nbsp;<span class="num" id="3032424">0</span><span class="op" id="3032425">,</span>&nbsp;<span class="num" id="3032427">0</span><span class="op" id="3032428">,</span>&nbsp;<span class="num" id="3032430">0</span><span class="op" id="3032431">,</span>&nbsp;<span class="num" id="3032433">0</span><span class="op" id="3032434">,</span>&nbsp;<span class="num" id="3032436">0</span><span class="op" id="3032437">,</span>&nbsp;<span class="num" id="3032439">0</span><span class="op" id="3032440">,</span>&nbsp;<span class="num" id="3032442">0</span><span class="op" id="3032443">,</span>&nbsp;<span class="num" id="3032445">0</span><span class="op" id="3032446">,</span>&nbsp;<span class="num" id="3032448">0x01</span><span class="op" id="3032452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3032455">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3032482">=</span>&nbsp;<span class="ident" id="3032484">IP</span><span class="op" id="3032486">{</span><span class="num" id="3032487">0xff</span><span class="op" id="3032491">,</span>&nbsp;<span class="num" id="3032493">0x02</span><span class="op" id="3032497">,</span>&nbsp;<span class="num" id="3032499">0</span><span class="op" id="3032500">,</span>&nbsp;<span class="num" id="3032502">0</span><span class="op" id="3032503">,</span>&nbsp;<span class="num" id="3032505">0</span><span class="op" id="3032506">,</span>&nbsp;<span class="num" id="3032508">0</span><span class="op" id="3032509">,</span>&nbsp;<span class="num" id="3032511">0</span><span class="op" id="3032512">,</span>&nbsp;<span class="num" id="3032514">0</span><span class="op" id="3032515">,</span>&nbsp;<span class="num" id="3032517">0</span><span class="op" id="3032518">,</span>&nbsp;<span class="num" id="3032520">0</span><span class="op" id="3032521">,</span>&nbsp;<span class="num" id="3032523">0</span><span class="op" id="3032524">,</span>&nbsp;<span class="num" id="3032526">0</span><span class="op" id="3032527">,</span>&nbsp;<span class="num" id="3032529">0</span><span class="op" id="3032530">,</span>&nbsp;<span class="num" id="3032532">0</span><span class="op" id="3032533">,</span>&nbsp;<span class="num" id="3032535">0</span><span class="op" id="3032536">,</span>&nbsp;<span class="num" id="3032538">0x02</span><span class="op" id="3032542">}</span><br>
<span class="lineno"></span><span class="op" id="3032544">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3032547">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3032610">func</span>&nbsp;<span class="op" id="3032615">(</span><span class="ident" id="3032616">ip</span>&nbsp;<span class="ident" id="3032619">IP</span><span class="op" id="3032621">)</span>&nbsp;<span class="ident" id="3032623">IsUnspecified</span><span class="op" id="3032636">(</span><span class="op" id="3032637">)</span>&nbsp;<span class="builtintype" id="3032639">bool</span>&nbsp;<span class="op" id="3032644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3032647">if</span>&nbsp;<span class="ident" id="3032650">ip</span><span class="op" id="3032652">.</span><span class="ident" id="3032653">Equal</span><span class="op" id="3032658">(</span><span class="ident" id="3032659">IPv4zero</span><span class="op" id="3032667">)</span>&nbsp;<span class="op" id="3032669">||</span>&nbsp;<span class="ident" id="3032672">ip</span><span class="op" id="3032674">.</span><span class="ident" id="3032675">Equal</span><span class="op" id="3032680">(</span><span class="ident" id="3032681">IPv6unspecified</span><span class="op" id="3032696">)</span>&nbsp;<span class="op" id="3032698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3032702">return</span>&nbsp;<span class="builtintype" id="3032709">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3032715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3032718">return</span>&nbsp;<span class="builtintype" id="3032725">false</span><br>
<span class="lineno"></span><span class="op" id="3032731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3032734">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3032790">func</span>&nbsp;<span class="op" id="3032795">(</span><span class="ident" id="3032796">ip</span>&nbsp;<span class="ident" id="3032799">IP</span><span class="op" id="3032801">)</span>&nbsp;<span class="ident" id="3032803">IsLoopback</span><span class="op" id="3032813">(</span><span class="op" id="3032814">)</span>&nbsp;<span class="builtintype" id="3032816">bool</span>&nbsp;<span class="op" id="3032821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3032824">if</span>&nbsp;<span class="ident" id="3032827">ip4</span>&nbsp;<span class="op" id="3032831">:=</span>&nbsp;<span class="ident" id="3032834">ip</span><span class="op" id="3032836">.</span><span class="ident" id="3032837">To4</span><span class="op" id="3032840">(</span><span class="op" id="3032841">)</span><span class="op" id="3032842">;</span>&nbsp;<span class="ident" id="3032844">ip4</span>&nbsp;<span class="op" id="3032848">!=</span>&nbsp;<span class="ident" id="3032851">nil</span>&nbsp;<span class="op" id="3032855">&amp;&amp;</span>&nbsp;<span class="ident" id="3032858">ip4</span><span class="op" id="3032861">[</span><span class="num" id="3032862">0</span><span class="op" id="3032863">]</span>&nbsp;<span class="op" id="3032865">==</span>&nbsp;<span class="num" id="3032868">127</span>&nbsp;<span class="op" id="3032872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3032876">return</span>&nbsp;<span class="builtintype" id="3032883">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3032889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3032892">return</span>&nbsp;<span class="ident" id="3032899">ip</span><span class="op" id="3032901">.</span><span class="ident" id="3032902">Equal</span><span class="op" id="3032907">(</span><span class="ident" id="3032908">IPv6loopback</span><span class="op" id="3032920">)</span><br>
<span class="lineno">125</span><span class="op" id="3032922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3032925">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3032983">func</span>&nbsp;<span class="op" id="3032988">(</span><span class="ident" id="3032989">ip</span>&nbsp;<span class="ident" id="3032992">IP</span><span class="op" id="3032994">)</span>&nbsp;<span class="ident" id="3032996">IsMulticast</span><span class="op" id="3033007">(</span><span class="op" id="3033008">)</span>&nbsp;<span class="builtintype" id="3033010">bool</span>&nbsp;<span class="op" id="3033015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033018">if</span>&nbsp;<span class="ident" id="3033021">ip4</span>&nbsp;<span class="op" id="3033025">:=</span>&nbsp;<span class="ident" id="3033028">ip</span><span class="op" id="3033030">.</span><span class="ident" id="3033031">To4</span><span class="op" id="3033034">(</span><span class="op" id="3033035">)</span><span class="op" id="3033036">;</span>&nbsp;<span class="ident" id="3033038">ip4</span>&nbsp;<span class="op" id="3033042">!=</span>&nbsp;<span class="ident" id="3033045">nil</span>&nbsp;<span class="op" id="3033049">&amp;&amp;</span>&nbsp;<span class="ident" id="3033052">ip4</span><span class="op" id="3033055">[</span><span class="num" id="3033056">0</span><span class="op" id="3033057">]</span><span class="op" id="3033058">&amp;</span><span class="num" id="3033059">0xf0</span>&nbsp;<span class="op" id="3033064">==</span>&nbsp;<span class="num" id="3033067">0xe0</span>&nbsp;<span class="op" id="3033072">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033076">return</span>&nbsp;<span class="builtintype" id="3033083">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3033089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033092">return</span>&nbsp;<span class="ident" id="3033099">ip</span><span class="op" id="3033101">[</span><span class="num" id="3033102">0</span><span class="op" id="3033103">]</span>&nbsp;<span class="op" id="3033105">==</span>&nbsp;<span class="num" id="3033108">0xff</span><br>
<span class="lineno"></span><span class="op" id="3033113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3033116">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3033171">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3033212">func</span>&nbsp;<span class="op" id="3033217">(</span><span class="ident" id="3033218">ip</span>&nbsp;<span class="ident" id="3033221">IP</span><span class="op" id="3033223">)</span>&nbsp;<span class="ident" id="3033225">IsInterfaceLocalMulticast</span><span class="op" id="3033250">(</span><span class="op" id="3033251">)</span>&nbsp;<span class="builtintype" id="3033253">bool</span>&nbsp;<span class="op" id="3033258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033261">return</span>&nbsp;<span class="builtinfunc" id="3033268">len</span><span class="op" id="3033271">(</span><span class="ident" id="3033272">ip</span><span class="op" id="3033274">)</span>&nbsp;<span class="op" id="3033276">==</span>&nbsp;<span class="ident" id="3033279">IPv6len</span>&nbsp;<span class="op" id="3033287">&amp;&amp;</span>&nbsp;<span class="ident" id="3033290">ip</span><span class="op" id="3033292">[</span><span class="num" id="3033293">0</span><span class="op" id="3033294">]</span>&nbsp;<span class="op" id="3033296">==</span>&nbsp;<span class="num" id="3033299">0xff</span>&nbsp;<span class="op" id="3033304">&amp;&amp;</span>&nbsp;<span class="ident" id="3033307">ip</span><span class="op" id="3033309">[</span><span class="num" id="3033310">1</span><span class="op" id="3033311">]</span><span class="op" id="3033312">&amp;</span><span class="num" id="3033313">0x0f</span>&nbsp;<span class="op" id="3033318">==</span>&nbsp;<span class="num" id="3033321">0x01</span><br>
<span class="lineno"></span><span class="op" id="3033326">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3033329">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3033388">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3033410">func</span>&nbsp;<span class="op" id="3033415">(</span><span class="ident" id="3033416">ip</span>&nbsp;<span class="ident" id="3033419">IP</span><span class="op" id="3033421">)</span>&nbsp;<span class="ident" id="3033423">IsLinkLocalMulticast</span><span class="op" id="3033443">(</span><span class="op" id="3033444">)</span>&nbsp;<span class="builtintype" id="3033446">bool</span>&nbsp;<span class="op" id="3033451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033454">if</span>&nbsp;<span class="ident" id="3033457">ip4</span>&nbsp;<span class="op" id="3033461">:=</span>&nbsp;<span class="ident" id="3033464">ip</span><span class="op" id="3033466">.</span><span class="ident" id="3033467">To4</span><span class="op" id="3033470">(</span><span class="op" id="3033471">)</span><span class="op" id="3033472">;</span>&nbsp;<span class="ident" id="3033474">ip4</span>&nbsp;<span class="op" id="3033478">!=</span>&nbsp;<span class="ident" id="3033481">nil</span>&nbsp;<span class="op" id="3033485">&amp;&amp;</span>&nbsp;<span class="ident" id="3033488">ip4</span><span class="op" id="3033491">[</span><span class="num" id="3033492">0</span><span class="op" id="3033493">]</span>&nbsp;<span class="op" id="3033495">==</span>&nbsp;<span class="num" id="3033498">224</span>&nbsp;<span class="op" id="3033502">&amp;&amp;</span>&nbsp;<span class="ident" id="3033505">ip4</span><span class="op" id="3033508">[</span><span class="num" id="3033509">1</span><span class="op" id="3033510">]</span>&nbsp;<span class="op" id="3033512">==</span>&nbsp;<span class="num" id="3033515">0</span>&nbsp;<span class="op" id="3033517">&amp;&amp;</span>&nbsp;<span class="ident" id="3033520">ip4</span><span class="op" id="3033523">[</span><span class="num" id="3033524">2</span><span class="op" id="3033525">]</span>&nbsp;<span class="op" id="3033527">==</span>&nbsp;<span class="num" id="3033530">0</span>&nbsp;<span class="op" id="3033532">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033536">return</span>&nbsp;<span class="builtintype" id="3033543">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3033549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033552">return</span>&nbsp;<span class="ident" id="3033559">ip</span><span class="op" id="3033561">[</span><span class="num" id="3033562">0</span><span class="op" id="3033563">]</span>&nbsp;<span class="op" id="3033565">==</span>&nbsp;<span class="num" id="3033568">0xff</span>&nbsp;<span class="op" id="3033573">&amp;&amp;</span>&nbsp;<span class="ident" id="3033576">ip</span><span class="op" id="3033578">[</span><span class="num" id="3033579">1</span><span class="op" id="3033580">]</span><span class="op" id="3033581">&amp;</span><span class="num" id="3033582">0x0f</span>&nbsp;<span class="op" id="3033587">==</span>&nbsp;<span class="num" id="3033590">0x02</span><br>
<span class="lineno"></span><span class="op" id="3033595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3033598">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3033655">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3033675">func</span>&nbsp;<span class="op" id="3033680">(</span><span class="ident" id="3033681">ip</span>&nbsp;<span class="ident" id="3033684">IP</span><span class="op" id="3033686">)</span>&nbsp;<span class="ident" id="3033688">IsLinkLocalUnicast</span><span class="op" id="3033706">(</span><span class="op" id="3033707">)</span>&nbsp;<span class="builtintype" id="3033709">bool</span>&nbsp;<span class="op" id="3033714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033717">if</span>&nbsp;<span class="ident" id="3033720">ip4</span>&nbsp;<span class="op" id="3033724">:=</span>&nbsp;<span class="ident" id="3033727">ip</span><span class="op" id="3033729">.</span><span class="ident" id="3033730">To4</span><span class="op" id="3033733">(</span><span class="op" id="3033734">)</span><span class="op" id="3033735">;</span>&nbsp;<span class="ident" id="3033737">ip4</span>&nbsp;<span class="op" id="3033741">!=</span>&nbsp;<span class="ident" id="3033744">nil</span>&nbsp;<span class="op" id="3033748">&amp;&amp;</span>&nbsp;<span class="ident" id="3033751">ip4</span><span class="op" id="3033754">[</span><span class="num" id="3033755">0</span><span class="op" id="3033756">]</span>&nbsp;<span class="op" id="3033758">==</span>&nbsp;<span class="num" id="3033761">169</span>&nbsp;<span class="op" id="3033765">&amp;&amp;</span>&nbsp;<span class="ident" id="3033768">ip4</span><span class="op" id="3033771">[</span><span class="num" id="3033772">1</span><span class="op" id="3033773">]</span>&nbsp;<span class="op" id="3033775">==</span>&nbsp;<span class="num" id="3033778">254</span>&nbsp;<span class="op" id="3033782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033786">return</span>&nbsp;<span class="builtintype" id="3033793">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3033799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033802">return</span>&nbsp;<span class="ident" id="3033809">ip</span><span class="op" id="3033811">[</span><span class="num" id="3033812">0</span><span class="op" id="3033813">]</span>&nbsp;<span class="op" id="3033815">==</span>&nbsp;<span class="num" id="3033818">0xfe</span>&nbsp;<span class="op" id="3033823">&amp;&amp;</span>&nbsp;<span class="ident" id="3033826">ip</span><span class="op" id="3033828">[</span><span class="num" id="3033829">1</span><span class="op" id="3033830">]</span><span class="op" id="3033831">&amp;</span><span class="num" id="3033832">0xc0</span>&nbsp;<span class="op" id="3033837">==</span>&nbsp;<span class="num" id="3033840">0x80</span><br>
<span class="lineno"></span><span class="op" id="3033845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3033848">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3033906">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3033918">func</span>&nbsp;<span class="op" id="3033923">(</span><span class="ident" id="3033924">ip</span>&nbsp;<span class="ident" id="3033927">IP</span><span class="op" id="3033929">)</span>&nbsp;<span class="ident" id="3033931">IsGlobalUnicast</span><span class="op" id="3033946">(</span><span class="op" id="3033947">)</span>&nbsp;<span class="builtintype" id="3033949">bool</span>&nbsp;<span class="op" id="3033954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3033957">return</span>&nbsp;<span class="op" id="3033964">!</span><span class="ident" id="3033965">ip</span><span class="op" id="3033967">.</span><span class="ident" id="3033968">IsUnspecified</span><span class="op" id="3033981">(</span><span class="op" id="3033982">)</span>&nbsp;<span class="op" id="3033984">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3033989">!</span><span class="ident" id="3033990">ip</span><span class="op" id="3033992">.</span><span class="ident" id="3033993">IsLoopback</span><span class="op" id="3034003">(</span><span class="op" id="3034004">)</span>&nbsp;<span class="op" id="3034006">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034011">!</span><span class="ident" id="3034012">ip</span><span class="op" id="3034014">.</span><span class="ident" id="3034015">IsMulticast</span><span class="op" id="3034026">(</span><span class="op" id="3034027">)</span>&nbsp;<span class="op" id="3034029">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034034">!</span><span class="ident" id="3034035">ip</span><span class="op" id="3034037">.</span><span class="ident" id="3034038">IsLinkLocalUnicast</span><span class="op" id="3034056">(</span><span class="op" id="3034057">)</span><br>
<span class="lineno"></span><span class="op" id="3034059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3034062">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3034081">func</span>&nbsp;<span class="ident" id="3034086">isZeros</span><span class="op" id="3034093">(</span><span class="ident" id="3034094">p</span>&nbsp;<span class="ident" id="3034096">IP</span><span class="op" id="3034098">)</span>&nbsp;<span class="builtintype" id="3034100">bool</span>&nbsp;<span class="op" id="3034105">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034108">for</span>&nbsp;<span class="ident" id="3034112">i</span>&nbsp;<span class="op" id="3034114">:=</span>&nbsp;<span class="num" id="3034117">0</span><span class="op" id="3034118">;</span>&nbsp;<span class="ident" id="3034120">i</span>&nbsp;<span class="op" id="3034122">&lt;</span>&nbsp;<span class="builtinfunc" id="3034124">len</span><span class="op" id="3034127">(</span><span class="ident" id="3034128">p</span><span class="op" id="3034129">)</span><span class="op" id="3034130">;</span>&nbsp;<span class="ident" id="3034132">i</span><span class="op" id="3034133">++</span>&nbsp;<span class="op" id="3034136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034140">if</span>&nbsp;<span class="ident" id="3034143">p</span><span class="op" id="3034144">[</span><span class="ident" id="3034145">i</span><span class="op" id="3034146">]</span>&nbsp;<span class="op" id="3034148">!=</span>&nbsp;<span class="num" id="3034151">0</span>&nbsp;<span class="op" id="3034153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034158">return</span>&nbsp;<span class="builtintype" id="3034165">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034176">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034179">return</span>&nbsp;<span class="builtintype" id="3034186">true</span><br>
<span class="lineno"></span><span class="op" id="3034191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3034194">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3034258">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3034308">func</span>&nbsp;<span class="op" id="3034313">(</span><span class="ident" id="3034314">ip</span>&nbsp;<span class="ident" id="3034317">IP</span><span class="op" id="3034319">)</span>&nbsp;<span class="ident" id="3034321">To4</span><span class="op" id="3034324">(</span><span class="op" id="3034325">)</span>&nbsp;<span class="ident" id="3034327">IP</span>&nbsp;<span class="op" id="3034330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034333">if</span>&nbsp;<span class="builtinfunc" id="3034336">len</span><span class="op" id="3034339">(</span><span class="ident" id="3034340">ip</span><span class="op" id="3034342">)</span>&nbsp;<span class="op" id="3034344">==</span>&nbsp;<span class="ident" id="3034347">IPv4len</span>&nbsp;<span class="op" id="3034355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034359">return</span>&nbsp;<span class="ident" id="3034366">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034373">if</span>&nbsp;<span class="builtinfunc" id="3034376">len</span><span class="op" id="3034379">(</span><span class="ident" id="3034380">ip</span><span class="op" id="3034382">)</span>&nbsp;<span class="op" id="3034384">==</span>&nbsp;<span class="ident" id="3034387">IPv6len</span>&nbsp;<span class="op" id="3034395">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3034400">isZeros</span><span class="op" id="3034407">(</span><span class="ident" id="3034408">ip</span><span class="op" id="3034410">[</span><span class="num" id="3034411">0</span><span class="op" id="3034412">:</span><span class="num" id="3034413">10</span><span class="op" id="3034415">]</span><span class="op" id="3034416">)</span>&nbsp;<span class="op" id="3034418">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3034423">ip</span><span class="op" id="3034425">[</span><span class="num" id="3034426">10</span><span class="op" id="3034428">]</span>&nbsp;<span class="op" id="3034430">==</span>&nbsp;<span class="num" id="3034433">0xff</span>&nbsp;<span class="op" id="3034438">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3034443">ip</span><span class="op" id="3034445">[</span><span class="num" id="3034446">11</span><span class="op" id="3034448">]</span>&nbsp;<span class="op" id="3034450">==</span>&nbsp;<span class="num" id="3034453">0xff</span>&nbsp;<span class="op" id="3034458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034462">return</span>&nbsp;<span class="ident" id="3034469">ip</span><span class="op" id="3034471">[</span><span class="num" id="3034472">12</span><span class="op" id="3034474">:</span><span class="num" id="3034475">16</span><span class="op" id="3034477">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034480">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034483">return</span>&nbsp;<span class="ident" id="3034490">nil</span><br>
<span class="lineno"></span><span class="op" id="3034494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3034497">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3034561">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3034635">func</span>&nbsp;<span class="op" id="3034640">(</span><span class="ident" id="3034641">ip</span>&nbsp;<span class="ident" id="3034644">IP</span><span class="op" id="3034646">)</span>&nbsp;<span class="ident" id="3034648">To16</span><span class="op" id="3034652">(</span><span class="op" id="3034653">)</span>&nbsp;<span class="ident" id="3034655">IP</span>&nbsp;<span class="op" id="3034658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034661">if</span>&nbsp;<span class="builtinfunc" id="3034664">len</span><span class="op" id="3034667">(</span><span class="ident" id="3034668">ip</span><span class="op" id="3034670">)</span>&nbsp;<span class="op" id="3034672">==</span>&nbsp;<span class="ident" id="3034675">IPv4len</span>&nbsp;<span class="op" id="3034683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034687">return</span>&nbsp;<span class="ident" id="3034694">IPv4</span><span class="op" id="3034698">(</span><span class="ident" id="3034699">ip</span><span class="op" id="3034701">[</span><span class="num" id="3034702">0</span><span class="op" id="3034703">]</span><span class="op" id="3034704">,</span>&nbsp;<span class="ident" id="3034706">ip</span><span class="op" id="3034708">[</span><span class="num" id="3034709">1</span><span class="op" id="3034710">]</span><span class="op" id="3034711">,</span>&nbsp;<span class="ident" id="3034713">ip</span><span class="op" id="3034715">[</span><span class="num" id="3034716">2</span><span class="op" id="3034717">]</span><span class="op" id="3034718">,</span>&nbsp;<span class="ident" id="3034720">ip</span><span class="op" id="3034722">[</span><span class="num" id="3034723">3</span><span class="op" id="3034724">]</span><span class="op" id="3034725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034731">if</span>&nbsp;<span class="builtinfunc" id="3034734">len</span><span class="op" id="3034737">(</span><span class="ident" id="3034738">ip</span><span class="op" id="3034740">)</span>&nbsp;<span class="op" id="3034742">==</span>&nbsp;<span class="ident" id="3034745">IPv6len</span>&nbsp;<span class="op" id="3034753">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034757">return</span>&nbsp;<span class="ident" id="3034764">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3034768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3034771">return</span>&nbsp;<span class="ident" id="3034778">nil</span><br>
<span class="lineno"></span><span class="op" id="3034782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3034785">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3034818">var</span>&nbsp;<span class="op" id="3034822">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3034825">classAMask</span>&nbsp;<span class="op" id="3034836">=</span>&nbsp;<span class="ident" id="3034838">IPv4Mask</span><span class="op" id="3034846">(</span><span class="num" id="3034847">0xff</span><span class="op" id="3034851">,</span>&nbsp;<span class="num" id="3034853">0</span><span class="op" id="3034854">,</span>&nbsp;<span class="num" id="3034856">0</span><span class="op" id="3034857">,</span>&nbsp;<span class="num" id="3034859">0</span><span class="op" id="3034860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3034863">classBMask</span>&nbsp;<span class="op" id="3034874">=</span>&nbsp;<span class="ident" id="3034876">IPv4Mask</span><span class="op" id="3034884">(</span><span class="num" id="3034885">0xff</span><span class="op" id="3034889">,</span>&nbsp;<span class="num" id="3034891">0xff</span><span class="op" id="3034895">,</span>&nbsp;<span class="num" id="3034897">0</span><span class="op" id="3034898">,</span>&nbsp;<span class="num" id="3034900">0</span><span class="op" id="3034901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3034904">classCMask</span>&nbsp;<span class="op" id="3034915">=</span>&nbsp;<span class="ident" id="3034917">IPv4Mask</span><span class="op" id="3034925">(</span><span class="num" id="3034926">0xff</span><span class="op" id="3034930">,</span>&nbsp;<span class="num" id="3034932">0xff</span><span class="op" id="3034936">,</span>&nbsp;<span class="num" id="3034938">0xff</span><span class="op" id="3034942">,</span>&nbsp;<span class="num" id="3034944">0</span><span class="op" id="3034945">)</span><br>
<span class="lineno">210</span><span class="op" id="3034947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3034950">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3035016">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3035079">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3035121">func</span>&nbsp;<span class="op" id="3035126">(</span><span class="ident" id="3035127">ip</span>&nbsp;<span class="ident" id="3035130">IP</span><span class="op" id="3035132">)</span>&nbsp;<span class="ident" id="3035134">DefaultMask</span><span class="op" id="3035145">(</span><span class="op" id="3035146">)</span>&nbsp;<span class="ident" id="3035148">IPMask</span>&nbsp;<span class="op" id="3035155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035158">if</span>&nbsp;<span class="ident" id="3035161">ip</span>&nbsp;<span class="op" id="3035164">=</span>&nbsp;<span class="ident" id="3035166">ip</span><span class="op" id="3035168">.</span><span class="ident" id="3035169">To4</span><span class="op" id="3035172">(</span><span class="op" id="3035173">)</span><span class="op" id="3035174">;</span>&nbsp;<span class="ident" id="3035176">ip</span>&nbsp;<span class="op" id="3035179">==</span>&nbsp;<span class="ident" id="3035182">nil</span>&nbsp;<span class="op" id="3035186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035190">return</span>&nbsp;<span class="ident" id="3035197">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035205">switch</span>&nbsp;<span class="builtintype" id="3035212">true</span>&nbsp;<span class="op" id="3035217">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035220">case</span>&nbsp;<span class="ident" id="3035225">ip</span><span class="op" id="3035227">[</span><span class="num" id="3035228">0</span><span class="op" id="3035229">]</span>&nbsp;<span class="op" id="3035231">&lt;</span>&nbsp;<span class="num" id="3035233">0x80</span><span class="op" id="3035237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035241">return</span>&nbsp;<span class="ident" id="3035248">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035260">case</span>&nbsp;<span class="ident" id="3035265">ip</span><span class="op" id="3035267">[</span><span class="num" id="3035268">0</span><span class="op" id="3035269">]</span>&nbsp;<span class="op" id="3035271">&lt;</span>&nbsp;<span class="num" id="3035273">0xC0</span><span class="op" id="3035277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035281">return</span>&nbsp;<span class="ident" id="3035288">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035300">default</span><span class="op" id="3035307">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035311">return</span>&nbsp;<span class="ident" id="3035318">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035330">}</span><br>
<span class="lineno"></span><span class="op" id="3035332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3035335">func</span>&nbsp;<span class="ident" id="3035340">allFF</span><span class="op" id="3035345">(</span><span class="ident" id="3035346">b</span>&nbsp;<span class="op" id="3035348">[</span><span class="op" id="3035349">]</span><span class="builtintype" id="3035350">byte</span><span class="op" id="3035354">)</span>&nbsp;<span class="builtintype" id="3035356">bool</span>&nbsp;<span class="op" id="3035361">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035364">for</span>&nbsp;<span class="ident" id="3035368">_</span><span class="op" id="3035369">,</span>&nbsp;<span class="ident" id="3035371">c</span>&nbsp;<span class="op" id="3035373">:=</span>&nbsp;<span class="keyword" id="3035376">range</span>&nbsp;<span class="ident" id="3035382">b</span>&nbsp;<span class="op" id="3035384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035388">if</span>&nbsp;<span class="ident" id="3035391">c</span>&nbsp;<span class="op" id="3035393">!=</span>&nbsp;<span class="num" id="3035396">0xff</span>&nbsp;<span class="op" id="3035401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035406">return</span>&nbsp;<span class="builtintype" id="3035413">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035424">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035427">return</span>&nbsp;<span class="builtintype" id="3035434">true</span><br>
<span class="lineno"></span><span class="op" id="3035439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3035442">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3035509">func</span>&nbsp;<span class="op" id="3035514">(</span><span class="ident" id="3035515">ip</span>&nbsp;<span class="ident" id="3035518">IP</span><span class="op" id="3035520">)</span>&nbsp;<span class="ident" id="3035522">Mask</span><span class="op" id="3035526">(</span><span class="ident" id="3035527">mask</span>&nbsp;<span class="ident" id="3035532">IPMask</span><span class="op" id="3035538">)</span>&nbsp;<span class="ident" id="3035540">IP</span>&nbsp;<span class="op" id="3035543">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035546">if</span>&nbsp;<span class="builtinfunc" id="3035549">len</span><span class="op" id="3035552">(</span><span class="ident" id="3035553">mask</span><span class="op" id="3035557">)</span>&nbsp;<span class="op" id="3035559">==</span>&nbsp;<span class="ident" id="3035562">IPv6len</span>&nbsp;<span class="op" id="3035570">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3035573">len</span><span class="op" id="3035576">(</span><span class="ident" id="3035577">ip</span><span class="op" id="3035579">)</span>&nbsp;<span class="op" id="3035581">==</span>&nbsp;<span class="ident" id="3035584">IPv4len</span>&nbsp;<span class="op" id="3035592">&amp;&amp;</span>&nbsp;<span class="ident" id="3035595">allFF</span><span class="op" id="3035600">(</span><span class="ident" id="3035601">mask</span><span class="op" id="3035605">[</span><span class="op" id="3035606">:</span><span class="num" id="3035607">12</span><span class="op" id="3035609">]</span><span class="op" id="3035610">)</span>&nbsp;<span class="op" id="3035612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3035616">mask</span>&nbsp;<span class="op" id="3035621">=</span>&nbsp;<span class="ident" id="3035623">mask</span><span class="op" id="3035627">[</span><span class="num" id="3035628">12</span><span class="op" id="3035630">:</span><span class="op" id="3035631">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035637">if</span>&nbsp;<span class="builtinfunc" id="3035640">len</span><span class="op" id="3035643">(</span><span class="ident" id="3035644">mask</span><span class="op" id="3035648">)</span>&nbsp;<span class="op" id="3035650">==</span>&nbsp;<span class="ident" id="3035653">IPv4len</span>&nbsp;<span class="op" id="3035661">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3035664">len</span><span class="op" id="3035667">(</span><span class="ident" id="3035668">ip</span><span class="op" id="3035670">)</span>&nbsp;<span class="op" id="3035672">==</span>&nbsp;<span class="ident" id="3035675">IPv6len</span>&nbsp;<span class="op" id="3035683">&amp;&amp;</span>&nbsp;<span class="ident" id="3035686">bytesEqual</span><span class="op" id="3035696">(</span><span class="ident" id="3035697">ip</span><span class="op" id="3035699">[</span><span class="op" id="3035700">:</span><span class="num" id="3035701">12</span><span class="op" id="3035703">]</span><span class="op" id="3035704">,</span>&nbsp;<span class="ident" id="3035706">v4InV6Prefix</span><span class="op" id="3035718">)</span>&nbsp;<span class="op" id="3035720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3035724">ip</span>&nbsp;<span class="op" id="3035727">=</span>&nbsp;<span class="ident" id="3035729">ip</span><span class="op" id="3035731">[</span><span class="num" id="3035732">12</span><span class="op" id="3035734">:</span><span class="op" id="3035735">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3035741">n</span>&nbsp;<span class="op" id="3035743">:=</span>&nbsp;<span class="builtinfunc" id="3035746">len</span><span class="op" id="3035749">(</span><span class="ident" id="3035750">ip</span><span class="op" id="3035752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035755">if</span>&nbsp;<span class="ident" id="3035758">n</span>&nbsp;<span class="op" id="3035760">!=</span>&nbsp;<span class="builtinfunc" id="3035763">len</span><span class="op" id="3035766">(</span><span class="ident" id="3035767">mask</span><span class="op" id="3035771">)</span>&nbsp;<span class="op" id="3035773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035777">return</span>&nbsp;<span class="ident" id="3035784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035789">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3035792">out</span>&nbsp;<span class="op" id="3035796">:=</span>&nbsp;<span class="builtinfunc" id="3035799">make</span><span class="op" id="3035803">(</span><span class="ident" id="3035804">IP</span><span class="op" id="3035806">,</span>&nbsp;<span class="ident" id="3035808">n</span><span class="op" id="3035809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035812">for</span>&nbsp;<span class="ident" id="3035816">i</span>&nbsp;<span class="op" id="3035818">:=</span>&nbsp;<span class="num" id="3035821">0</span><span class="op" id="3035822">;</span>&nbsp;<span class="ident" id="3035824">i</span>&nbsp;<span class="op" id="3035826">&lt;</span>&nbsp;<span class="ident" id="3035828">n</span><span class="op" id="3035829">;</span>&nbsp;<span class="ident" id="3035831">i</span><span class="op" id="3035832">++</span>&nbsp;<span class="op" id="3035835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3035839">out</span><span class="op" id="3035842">[</span><span class="ident" id="3035843">i</span><span class="op" id="3035844">]</span>&nbsp;<span class="op" id="3035846">=</span>&nbsp;<span class="ident" id="3035848">ip</span><span class="op" id="3035850">[</span><span class="ident" id="3035851">i</span><span class="op" id="3035852">]</span>&nbsp;<span class="op" id="3035854">&amp;</span>&nbsp;<span class="ident" id="3035856">mask</span><span class="op" id="3035860">[</span><span class="ident" id="3035861">i</span><span class="op" id="3035862">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3035865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3035868">return</span>&nbsp;<span class="ident" id="3035875">out</span><br>
<span class="lineno">255</span><span class="op" id="3035879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3035882">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3035938">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3036002">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3036071">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3036108">func</span>&nbsp;<span class="op" id="3036113">(</span><span class="ident" id="3036114">ip</span>&nbsp;<span class="ident" id="3036117">IP</span><span class="op" id="3036119">)</span>&nbsp;<span class="ident" id="3036121">String</span><span class="op" id="3036127">(</span><span class="op" id="3036128">)</span>&nbsp;<span class="builtintype" id="3036130">string</span>&nbsp;<span class="op" id="3036137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036140">p</span>&nbsp;<span class="op" id="3036142">:=</span>&nbsp;<span class="ident" id="3036145">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036150">if</span>&nbsp;<span class="builtinfunc" id="3036153">len</span><span class="op" id="3036156">(</span><span class="ident" id="3036157">ip</span><span class="op" id="3036159">)</span>&nbsp;<span class="op" id="3036161">==</span>&nbsp;<span class="num" id="3036164">0</span>&nbsp;<span class="op" id="3036166">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036170">return</span>&nbsp;<span class="string" id="3036177">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3036190">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036224">if</span>&nbsp;<span class="ident" id="3036227">p4</span>&nbsp;<span class="op" id="3036230">:=</span>&nbsp;<span class="ident" id="3036233">p</span><span class="op" id="3036234">.</span><span class="ident" id="3036235">To4</span><span class="op" id="3036238">(</span><span class="op" id="3036239">)</span><span class="op" id="3036240">;</span>&nbsp;<span class="builtinfunc" id="3036242">len</span><span class="op" id="3036245">(</span><span class="ident" id="3036246">p4</span><span class="op" id="3036248">)</span>&nbsp;<span class="op" id="3036250">==</span>&nbsp;<span class="ident" id="3036253">IPv4len</span>&nbsp;<span class="op" id="3036261">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036265">return</span>&nbsp;<span class="ident" id="3036272">itod</span><span class="op" id="3036276">(</span><span class="builtintype" id="3036277">uint</span><span class="op" id="3036281">(</span><span class="ident" id="3036282">p4</span><span class="op" id="3036284">[</span><span class="num" id="3036285">0</span><span class="op" id="3036286">]</span><span class="op" id="3036287">)</span><span class="op" id="3036288">)</span>&nbsp;<span class="op" id="3036290">+</span>&nbsp;<span class="string" id="3036292">&#34;.&#34;</span>&nbsp;<span class="op" id="3036296">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036301">itod</span><span class="op" id="3036305">(</span><span class="builtintype" id="3036306">uint</span><span class="op" id="3036310">(</span><span class="ident" id="3036311">p4</span><span class="op" id="3036313">[</span><span class="num" id="3036314">1</span><span class="op" id="3036315">]</span><span class="op" id="3036316">)</span><span class="op" id="3036317">)</span>&nbsp;<span class="op" id="3036319">+</span>&nbsp;<span class="string" id="3036321">&#34;.&#34;</span>&nbsp;<span class="op" id="3036325">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036330">itod</span><span class="op" id="3036334">(</span><span class="builtintype" id="3036335">uint</span><span class="op" id="3036339">(</span><span class="ident" id="3036340">p4</span><span class="op" id="3036342">[</span><span class="num" id="3036343">2</span><span class="op" id="3036344">]</span><span class="op" id="3036345">)</span><span class="op" id="3036346">)</span>&nbsp;<span class="op" id="3036348">+</span>&nbsp;<span class="string" id="3036350">&#34;.&#34;</span>&nbsp;<span class="op" id="3036354">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036359">itod</span><span class="op" id="3036363">(</span><span class="builtintype" id="3036364">uint</span><span class="op" id="3036368">(</span><span class="ident" id="3036369">p4</span><span class="op" id="3036371">[</span><span class="num" id="3036372">3</span><span class="op" id="3036373">]</span><span class="op" id="3036374">)</span><span class="op" id="3036375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036378">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036381">if</span>&nbsp;<span class="builtinfunc" id="3036384">len</span><span class="op" id="3036387">(</span><span class="ident" id="3036388">p</span><span class="op" id="3036389">)</span>&nbsp;<span class="op" id="3036391">!=</span>&nbsp;<span class="ident" id="3036394">IPv6len</span>&nbsp;<span class="op" id="3036402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036406">return</span>&nbsp;<span class="string" id="3036413">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3036422">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036453">e0</span>&nbsp;<span class="op" id="3036456">:=</span>&nbsp;<span class="op" id="3036459">-</span><span class="num" id="3036460">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036463">e1</span>&nbsp;<span class="op" id="3036466">:=</span>&nbsp;<span class="op" id="3036469">-</span><span class="num" id="3036470">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036473">for</span>&nbsp;<span class="ident" id="3036477">i</span>&nbsp;<span class="op" id="3036479">:=</span>&nbsp;<span class="num" id="3036482">0</span><span class="op" id="3036483">;</span>&nbsp;<span class="ident" id="3036485">i</span>&nbsp;<span class="op" id="3036487">&lt;</span>&nbsp;<span class="ident" id="3036489">IPv6len</span><span class="op" id="3036496">;</span>&nbsp;<span class="ident" id="3036498">i</span>&nbsp;<span class="op" id="3036500">+=</span>&nbsp;<span class="num" id="3036503">2</span>&nbsp;<span class="op" id="3036505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036509">j</span>&nbsp;<span class="op" id="3036511">:=</span>&nbsp;<span class="ident" id="3036514">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036518">for</span>&nbsp;<span class="ident" id="3036522">j</span>&nbsp;<span class="op" id="3036524">&lt;</span>&nbsp;<span class="ident" id="3036526">IPv6len</span>&nbsp;<span class="op" id="3036534">&amp;&amp;</span>&nbsp;<span class="ident" id="3036537">p</span><span class="op" id="3036538">[</span><span class="ident" id="3036539">j</span><span class="op" id="3036540">]</span>&nbsp;<span class="op" id="3036542">==</span>&nbsp;<span class="num" id="3036545">0</span>&nbsp;<span class="op" id="3036547">&amp;&amp;</span>&nbsp;<span class="ident" id="3036550">p</span><span class="op" id="3036551">[</span><span class="ident" id="3036552">j</span><span class="op" id="3036553">+</span><span class="num" id="3036554">1</span><span class="op" id="3036555">]</span>&nbsp;<span class="op" id="3036557">==</span>&nbsp;<span class="num" id="3036560">0</span>&nbsp;<span class="op" id="3036562">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036567">j</span>&nbsp;<span class="op" id="3036569">+=</span>&nbsp;<span class="num" id="3036572">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036580">if</span>&nbsp;<span class="ident" id="3036583">j</span>&nbsp;<span class="op" id="3036585">&gt;</span>&nbsp;<span class="ident" id="3036587">i</span>&nbsp;<span class="op" id="3036589">&amp;&amp;</span>&nbsp;<span class="ident" id="3036592">j</span><span class="op" id="3036593">-</span><span class="ident" id="3036594">i</span>&nbsp;<span class="op" id="3036596">&gt;</span>&nbsp;<span class="ident" id="3036598">e1</span><span class="op" id="3036600">-</span><span class="ident" id="3036601">e0</span>&nbsp;<span class="op" id="3036604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036609">e0</span>&nbsp;<span class="op" id="3036612">=</span>&nbsp;<span class="ident" id="3036614">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036619">e1</span>&nbsp;<span class="op" id="3036622">=</span>&nbsp;<span class="ident" id="3036624">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036629">i</span>&nbsp;<span class="op" id="3036631">=</span>&nbsp;<span class="ident" id="3036633">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3036643">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036716">if</span>&nbsp;<span class="ident" id="3036719">e1</span><span class="op" id="3036721">-</span><span class="ident" id="3036722">e0</span>&nbsp;<span class="op" id="3036725">&lt;=</span>&nbsp;<span class="num" id="3036728">2</span>&nbsp;<span class="op" id="3036730">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036734">e0</span>&nbsp;<span class="op" id="3036737">=</span>&nbsp;<span class="op" id="3036739">-</span><span class="num" id="3036740">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036744">e1</span>&nbsp;<span class="op" id="3036747">=</span>&nbsp;<span class="op" id="3036749">-</span><span class="num" id="3036750">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3036753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036757">const</span>&nbsp;<span class="ident" id="3036763">maxLen</span>&nbsp;<span class="op" id="3036770">=</span>&nbsp;<span class="builtinfunc" id="3036772">len</span><span class="op" id="3036775">(</span><span class="string" id="3036776">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3036817">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036820">b</span>&nbsp;<span class="op" id="3036822">:=</span>&nbsp;<span class="builtinfunc" id="3036825">make</span><span class="op" id="3036829">(</span><span class="op" id="3036830">[</span><span class="op" id="3036831">]</span><span class="builtintype" id="3036832">byte</span><span class="op" id="3036836">,</span>&nbsp;<span class="num" id="3036838">0</span><span class="op" id="3036839">,</span>&nbsp;<span class="ident" id="3036841">maxLen</span><span class="op" id="3036847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3036851">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036903">for</span>&nbsp;<span class="ident" id="3036907">i</span>&nbsp;<span class="op" id="3036909">:=</span>&nbsp;<span class="num" id="3036912">0</span><span class="op" id="3036913">;</span>&nbsp;<span class="ident" id="3036915">i</span>&nbsp;<span class="op" id="3036917">&lt;</span>&nbsp;<span class="ident" id="3036919">IPv6len</span><span class="op" id="3036926">;</span>&nbsp;<span class="ident" id="3036928">i</span>&nbsp;<span class="op" id="3036930">+=</span>&nbsp;<span class="num" id="3036933">2</span>&nbsp;<span class="op" id="3036935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036939">if</span>&nbsp;<span class="ident" id="3036942">i</span>&nbsp;<span class="op" id="3036944">==</span>&nbsp;<span class="ident" id="3036947">e0</span>&nbsp;<span class="op" id="3036950">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036955">b</span>&nbsp;<span class="op" id="3036957">=</span>&nbsp;<span class="builtinfunc" id="3036959">append</span><span class="op" id="3036965">(</span><span class="ident" id="3036966">b</span><span class="op" id="3036967">,</span>&nbsp;<span class="string" id="3036969">&#39;:&#39;</span><span class="op" id="3036972">,</span>&nbsp;<span class="string" id="3036974">&#39;:&#39;</span><span class="op" id="3036977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3036982">i</span>&nbsp;<span class="op" id="3036984">=</span>&nbsp;<span class="ident" id="3036986">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3036992">if</span>&nbsp;<span class="ident" id="3036995">i</span>&nbsp;<span class="op" id="3036997">&gt;=</span>&nbsp;<span class="ident" id="3037000">IPv6len</span>&nbsp;<span class="op" id="3037008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037014">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037023">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037027">}</span>&nbsp;<span class="keyword" id="3037029">else</span>&nbsp;<span class="keyword" id="3037034">if</span>&nbsp;<span class="ident" id="3037037">i</span>&nbsp;<span class="op" id="3037039">&gt;</span>&nbsp;<span class="num" id="3037041">0</span>&nbsp;<span class="op" id="3037043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037048">b</span>&nbsp;<span class="op" id="3037050">=</span>&nbsp;<span class="builtinfunc" id="3037052">append</span><span class="op" id="3037058">(</span><span class="ident" id="3037059">b</span><span class="op" id="3037060">,</span>&nbsp;<span class="string" id="3037062">&#39;:&#39;</span><span class="op" id="3037065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037073">b</span>&nbsp;<span class="op" id="3037075">=</span>&nbsp;<span class="ident" id="3037077">appendHex</span><span class="op" id="3037086">(</span><span class="ident" id="3037087">b</span><span class="op" id="3037088">,</span>&nbsp;<span class="op" id="3037090">(</span><span class="builtintype" id="3037091">uint32</span><span class="op" id="3037097">(</span><span class="ident" id="3037098">p</span><span class="op" id="3037099">[</span><span class="ident" id="3037100">i</span><span class="op" id="3037101">]</span><span class="op" id="3037102">)</span><span class="op" id="3037103">&lt;&lt;</span><span class="num" id="3037105">8</span><span class="op" id="3037106">)</span><span class="op" id="3037107">|</span><span class="builtintype" id="3037108">uint32</span><span class="op" id="3037114">(</span><span class="ident" id="3037115">p</span><span class="op" id="3037116">[</span><span class="ident" id="3037117">i</span><span class="op" id="3037118">+</span><span class="num" id="3037119">1</span><span class="op" id="3037120">]</span><span class="op" id="3037121">)</span><span class="op" id="3037122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037125">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037128">return</span>&nbsp;<span class="builtintype" id="3037135">string</span><span class="op" id="3037141">(</span><span class="ident" id="3037142">b</span><span class="op" id="3037143">)</span><br>
<span class="lineno"></span><span class="op" id="3037145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3037148">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3037206">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3037243">func</span>&nbsp;<span class="ident" id="3037248">ipEmptyString</span><span class="op" id="3037261">(</span><span class="ident" id="3037262">ip</span>&nbsp;<span class="ident" id="3037265">IP</span><span class="op" id="3037267">)</span>&nbsp;<span class="builtintype" id="3037269">string</span>&nbsp;<span class="op" id="3037276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037279">if</span>&nbsp;<span class="builtinfunc" id="3037282">len</span><span class="op" id="3037285">(</span><span class="ident" id="3037286">ip</span><span class="op" id="3037288">)</span>&nbsp;<span class="op" id="3037290">==</span>&nbsp;<span class="num" id="3037293">0</span>&nbsp;<span class="op" id="3037295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037299">return</span>&nbsp;<span class="string" id="3037306">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037313">return</span>&nbsp;<span class="ident" id="3037320">ip</span><span class="op" id="3037322">.</span><span class="ident" id="3037323">String</span><span class="op" id="3037329">(</span><span class="op" id="3037330">)</span><br>
<span class="lineno">325</span><span class="op" id="3037332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3037335">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3037399">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3037450">func</span>&nbsp;<span class="op" id="3037455">(</span><span class="ident" id="3037456">ip</span>&nbsp;<span class="ident" id="3037459">IP</span><span class="op" id="3037461">)</span>&nbsp;<span class="ident" id="3037463">MarshalText</span><span class="op" id="3037474">(</span><span class="op" id="3037475">)</span>&nbsp;<span class="op" id="3037477">(</span><span class="op" id="3037478">[</span><span class="op" id="3037479">]</span><span class="builtintype" id="3037480">byte</span><span class="op" id="3037484">,</span>&nbsp;<span class="builtintype" id="3037486">error</span><span class="op" id="3037491">)</span>&nbsp;<span class="op" id="3037493">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037496">if</span>&nbsp;<span class="builtinfunc" id="3037499">len</span><span class="op" id="3037502">(</span><span class="ident" id="3037503">ip</span><span class="op" id="3037505">)</span>&nbsp;<span class="op" id="3037507">==</span>&nbsp;<span class="num" id="3037510">0</span>&nbsp;<span class="op" id="3037512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037516">return</span>&nbsp;<span class="op" id="3037523">[</span><span class="op" id="3037524">]</span><span class="builtintype" id="3037525">byte</span><span class="op" id="3037529">(</span><span class="string" id="3037530">&#34;&#34;</span><span class="op" id="3037532">)</span><span class="op" id="3037533">,</span>&nbsp;<span class="ident" id="3037535">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037543">if</span>&nbsp;<span class="builtinfunc" id="3037546">len</span><span class="op" id="3037549">(</span><span class="ident" id="3037550">ip</span><span class="op" id="3037552">)</span>&nbsp;<span class="op" id="3037554">!=</span>&nbsp;<span class="ident" id="3037557">IPv4len</span>&nbsp;<span class="op" id="3037565">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3037568">len</span><span class="op" id="3037571">(</span><span class="ident" id="3037572">ip</span><span class="op" id="3037574">)</span>&nbsp;<span class="op" id="3037576">!=</span>&nbsp;<span class="ident" id="3037579">IPv6len</span>&nbsp;<span class="op" id="3037587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037591">return</span>&nbsp;<span class="ident" id="3037598">nil</span><span class="op" id="3037601">,</span>&nbsp;<span class="ident" id="3037603">errors</span><span class="op" id="3037609">.</span><span class="ident" id="3037610">New</span><span class="op" id="3037613">(</span><span class="string" id="3037614">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3037634">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037640">return</span>&nbsp;<span class="op" id="3037647">[</span><span class="op" id="3037648">]</span><span class="builtintype" id="3037649">byte</span><span class="op" id="3037653">(</span><span class="ident" id="3037654">ip</span><span class="op" id="3037656">.</span><span class="ident" id="3037657">String</span><span class="op" id="3037663">(</span><span class="op" id="3037664">)</span><span class="op" id="3037665">)</span><span class="op" id="3037666">,</span>&nbsp;<span class="ident" id="3037668">nil</span><br>
<span class="lineno"></span><span class="op" id="3037672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3037675">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3037743">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3037804">func</span>&nbsp;<span class="op" id="3037809">(</span><span class="ident" id="3037810">ip</span>&nbsp;<span class="op" id="3037813">*</span><span class="ident" id="3037814">IP</span><span class="op" id="3037816">)</span>&nbsp;<span class="ident" id="3037818">UnmarshalText</span><span class="op" id="3037831">(</span><span class="ident" id="3037832">text</span>&nbsp;<span class="op" id="3037837">[</span><span class="op" id="3037838">]</span><span class="builtintype" id="3037839">byte</span><span class="op" id="3037843">)</span>&nbsp;<span class="builtintype" id="3037845">error</span>&nbsp;<span class="op" id="3037851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037854">if</span>&nbsp;<span class="builtinfunc" id="3037857">len</span><span class="op" id="3037860">(</span><span class="ident" id="3037861">text</span><span class="op" id="3037865">)</span>&nbsp;<span class="op" id="3037867">==</span>&nbsp;<span class="num" id="3037870">0</span>&nbsp;<span class="op" id="3037872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037876">*</span><span class="ident" id="3037877">ip</span>&nbsp;<span class="op" id="3037880">=</span>&nbsp;<span class="ident" id="3037882">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037888">return</span>&nbsp;<span class="ident" id="3037895">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037903">s</span>&nbsp;<span class="op" id="3037905">:=</span>&nbsp;<span class="builtintype" id="3037908">string</span><span class="op" id="3037914">(</span><span class="ident" id="3037915">text</span><span class="op" id="3037919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037922">x</span>&nbsp;<span class="op" id="3037924">:=</span>&nbsp;<span class="ident" id="3037927">ParseIP</span><span class="op" id="3037934">(</span><span class="ident" id="3037935">s</span><span class="op" id="3037936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037939">if</span>&nbsp;<span class="ident" id="3037942">x</span>&nbsp;<span class="op" id="3037944">==</span>&nbsp;<span class="ident" id="3037947">nil</span>&nbsp;<span class="op" id="3037951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037955">return</span>&nbsp;<span class="op" id="3037962">&amp;</span><span class="ident" id="3037963">ParseError</span><span class="op" id="3037973">{</span><span class="string" id="3037974">&#34;IP&nbsp;address&#34;</span><span class="op" id="3037986">,</span>&nbsp;<span class="ident" id="3037988">s</span><span class="op" id="3037989">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037995">*</span><span class="ident" id="3037996">ip</span>&nbsp;<span class="op" id="3037999">=</span>&nbsp;<span class="ident" id="3038001">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038004">return</span>&nbsp;<span class="ident" id="3038011">nil</span><br>
<span class="lineno"></span><span class="op" id="3038015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3038018">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3038077">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3038135">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3038162">func</span>&nbsp;<span class="op" id="3038167">(</span><span class="ident" id="3038168">ip</span>&nbsp;<span class="ident" id="3038171">IP</span><span class="op" id="3038173">)</span>&nbsp;<span class="ident" id="3038175">Equal</span><span class="op" id="3038180">(</span><span class="ident" id="3038181">x</span>&nbsp;<span class="ident" id="3038183">IP</span><span class="op" id="3038185">)</span>&nbsp;<span class="builtintype" id="3038187">bool</span>&nbsp;<span class="op" id="3038192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038195">if</span>&nbsp;<span class="builtinfunc" id="3038198">len</span><span class="op" id="3038201">(</span><span class="ident" id="3038202">ip</span><span class="op" id="3038204">)</span>&nbsp;<span class="op" id="3038206">==</span>&nbsp;<span class="builtinfunc" id="3038209">len</span><span class="op" id="3038212">(</span><span class="ident" id="3038213">x</span><span class="op" id="3038214">)</span>&nbsp;<span class="op" id="3038216">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038220">return</span>&nbsp;<span class="ident" id="3038227">bytesEqual</span><span class="op" id="3038237">(</span><span class="ident" id="3038238">ip</span><span class="op" id="3038240">,</span>&nbsp;<span class="ident" id="3038242">x</span><span class="op" id="3038243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038249">if</span>&nbsp;<span class="builtinfunc" id="3038252">len</span><span class="op" id="3038255">(</span><span class="ident" id="3038256">ip</span><span class="op" id="3038258">)</span>&nbsp;<span class="op" id="3038260">==</span>&nbsp;<span class="ident" id="3038263">IPv4len</span>&nbsp;<span class="op" id="3038271">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3038274">len</span><span class="op" id="3038277">(</span><span class="ident" id="3038278">x</span><span class="op" id="3038279">)</span>&nbsp;<span class="op" id="3038281">==</span>&nbsp;<span class="ident" id="3038284">IPv6len</span>&nbsp;<span class="op" id="3038292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038296">return</span>&nbsp;<span class="ident" id="3038303">bytesEqual</span><span class="op" id="3038313">(</span><span class="ident" id="3038314">x</span><span class="op" id="3038315">[</span><span class="num" id="3038316">0</span><span class="op" id="3038317">:</span><span class="num" id="3038318">12</span><span class="op" id="3038320">]</span><span class="op" id="3038321">,</span>&nbsp;<span class="ident" id="3038323">v4InV6Prefix</span><span class="op" id="3038335">)</span>&nbsp;<span class="op" id="3038337">&amp;&amp;</span>&nbsp;<span class="ident" id="3038340">bytesEqual</span><span class="op" id="3038350">(</span><span class="ident" id="3038351">ip</span><span class="op" id="3038353">,</span>&nbsp;<span class="ident" id="3038355">x</span><span class="op" id="3038356">[</span><span class="num" id="3038357">12</span><span class="op" id="3038359">:</span><span class="op" id="3038360">]</span><span class="op" id="3038361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038364">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038367">if</span>&nbsp;<span class="builtinfunc" id="3038370">len</span><span class="op" id="3038373">(</span><span class="ident" id="3038374">ip</span><span class="op" id="3038376">)</span>&nbsp;<span class="op" id="3038378">==</span>&nbsp;<span class="ident" id="3038381">IPv6len</span>&nbsp;<span class="op" id="3038389">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3038392">len</span><span class="op" id="3038395">(</span><span class="ident" id="3038396">x</span><span class="op" id="3038397">)</span>&nbsp;<span class="op" id="3038399">==</span>&nbsp;<span class="ident" id="3038402">IPv4len</span>&nbsp;<span class="op" id="3038410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038414">return</span>&nbsp;<span class="ident" id="3038421">bytesEqual</span><span class="op" id="3038431">(</span><span class="ident" id="3038432">ip</span><span class="op" id="3038434">[</span><span class="num" id="3038435">0</span><span class="op" id="3038436">:</span><span class="num" id="3038437">12</span><span class="op" id="3038439">]</span><span class="op" id="3038440">,</span>&nbsp;<span class="ident" id="3038442">v4InV6Prefix</span><span class="op" id="3038454">)</span>&nbsp;<span class="op" id="3038456">&amp;&amp;</span>&nbsp;<span class="ident" id="3038459">bytesEqual</span><span class="op" id="3038469">(</span><span class="ident" id="3038470">ip</span><span class="op" id="3038472">[</span><span class="num" id="3038473">12</span><span class="op" id="3038475">:</span><span class="op" id="3038476">]</span><span class="op" id="3038477">,</span>&nbsp;<span class="ident" id="3038479">x</span><span class="op" id="3038480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038486">return</span>&nbsp;<span class="builtintype" id="3038493">false</span><br>
<span class="lineno"></span><span class="op" id="3038499">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3038502">func</span>&nbsp;<span class="ident" id="3038507">bytesEqual</span><span class="op" id="3038517">(</span><span class="ident" id="3038518">x</span><span class="op" id="3038519">,</span>&nbsp;<span class="ident" id="3038521">y</span>&nbsp;<span class="op" id="3038523">[</span><span class="op" id="3038524">]</span><span class="builtintype" id="3038525">byte</span><span class="op" id="3038529">)</span>&nbsp;<span class="builtintype" id="3038531">bool</span>&nbsp;<span class="op" id="3038536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038539">if</span>&nbsp;<span class="builtinfunc" id="3038542">len</span><span class="op" id="3038545">(</span><span class="ident" id="3038546">x</span><span class="op" id="3038547">)</span>&nbsp;<span class="op" id="3038549">!=</span>&nbsp;<span class="builtinfunc" id="3038552">len</span><span class="op" id="3038555">(</span><span class="ident" id="3038556">y</span><span class="op" id="3038557">)</span>&nbsp;<span class="op" id="3038559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038563">return</span>&nbsp;<span class="builtintype" id="3038570">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038577">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038580">for</span>&nbsp;<span class="ident" id="3038584">i</span><span class="op" id="3038585">,</span>&nbsp;<span class="ident" id="3038587">b</span>&nbsp;<span class="op" id="3038589">:=</span>&nbsp;<span class="keyword" id="3038592">range</span>&nbsp;<span class="ident" id="3038598">x</span>&nbsp;<span class="op" id="3038600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038604">if</span>&nbsp;<span class="ident" id="3038607">y</span><span class="op" id="3038608">[</span><span class="ident" id="3038609">i</span><span class="op" id="3038610">]</span>&nbsp;<span class="op" id="3038612">!=</span>&nbsp;<span class="ident" id="3038615">b</span>&nbsp;<span class="op" id="3038617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038622">return</span>&nbsp;<span class="builtintype" id="3038629">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038640">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038643">return</span>&nbsp;<span class="builtintype" id="3038650">true</span><br>
<span class="lineno"></span><span class="op" id="3038655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3038658">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3038713">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3038745">func</span>&nbsp;<span class="ident" id="3038750">simpleMaskLength</span><span class="op" id="3038766">(</span><span class="ident" id="3038767">mask</span>&nbsp;<span class="ident" id="3038772">IPMask</span><span class="op" id="3038778">)</span>&nbsp;<span class="builtintype" id="3038780">int</span>&nbsp;<span class="op" id="3038784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038787">var</span>&nbsp;<span class="ident" id="3038791">n</span>&nbsp;<span class="builtintype" id="3038793">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038798">for</span>&nbsp;<span class="ident" id="3038802">i</span><span class="op" id="3038803">,</span>&nbsp;<span class="ident" id="3038805">v</span>&nbsp;<span class="op" id="3038807">:=</span>&nbsp;<span class="keyword" id="3038810">range</span>&nbsp;<span class="ident" id="3038816">mask</span>&nbsp;<span class="op" id="3038821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038825">if</span>&nbsp;<span class="ident" id="3038828">v</span>&nbsp;<span class="op" id="3038830">==</span>&nbsp;<span class="num" id="3038833">0xff</span>&nbsp;<span class="op" id="3038838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038843">n</span>&nbsp;<span class="op" id="3038845">+=</span>&nbsp;<span class="num" id="3038848">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038853">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3038868">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3038891">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038909">for</span>&nbsp;<span class="ident" id="3038913">v</span><span class="op" id="3038914">&amp;</span><span class="num" id="3038915">0x80</span>&nbsp;<span class="op" id="3038920">!=</span>&nbsp;<span class="num" id="3038923">0</span>&nbsp;<span class="op" id="3038925">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038930">n</span><span class="op" id="3038931">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038937">v</span>&nbsp;<span class="op" id="3038939">&lt;&lt;=</span>&nbsp;<span class="num" id="3038943">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3038951">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038976">if</span>&nbsp;<span class="ident" id="3038979">v</span>&nbsp;<span class="op" id="3038981">!=</span>&nbsp;<span class="num" id="3038984">0</span>&nbsp;<span class="op" id="3038986">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038991">return</span>&nbsp;<span class="op" id="3038998">-</span><span class="num" id="3038999">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039007">for</span>&nbsp;<span class="ident" id="3039011">i</span><span class="op" id="3039012">++</span><span class="op" id="3039014">;</span>&nbsp;<span class="ident" id="3039016">i</span>&nbsp;<span class="op" id="3039018">&lt;</span>&nbsp;<span class="builtinfunc" id="3039020">len</span><span class="op" id="3039023">(</span><span class="ident" id="3039024">mask</span><span class="op" id="3039028">)</span><span class="op" id="3039029">;</span>&nbsp;<span class="ident" id="3039031">i</span><span class="op" id="3039032">++</span>&nbsp;<span class="op" id="3039035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039040">if</span>&nbsp;<span class="ident" id="3039043">mask</span><span class="op" id="3039047">[</span><span class="ident" id="3039048">i</span><span class="op" id="3039049">]</span>&nbsp;<span class="op" id="3039051">!=</span>&nbsp;<span class="num" id="3039054">0</span>&nbsp;<span class="op" id="3039056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039062">return</span>&nbsp;<span class="op" id="3039069">-</span><span class="num" id="3039070">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039083">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039093">return</span>&nbsp;<span class="ident" id="3039100">n</span><br>
<span class="lineno">410</span><span class="op" id="3039102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3039105">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3039176">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3039250">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3039272">func</span>&nbsp;<span class="op" id="3039277">(</span><span class="ident" id="3039278">m</span>&nbsp;<span class="ident" id="3039280">IPMask</span><span class="op" id="3039286">)</span>&nbsp;<span class="ident" id="3039288">Size</span><span class="op" id="3039292">(</span><span class="op" id="3039293">)</span>&nbsp;<span class="op" id="3039295">(</span><span class="ident" id="3039296">ones</span><span class="op" id="3039300">,</span>&nbsp;<span class="ident" id="3039302">bits</span>&nbsp;<span class="builtintype" id="3039307">int</span><span class="op" id="3039310">)</span>&nbsp;<span class="op" id="3039312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039315">ones</span><span class="op" id="3039319">,</span>&nbsp;<span class="ident" id="3039321">bits</span>&nbsp;<span class="op" id="3039326">=</span>&nbsp;<span class="ident" id="3039328">simpleMaskLength</span><span class="op" id="3039344">(</span><span class="ident" id="3039345">m</span><span class="op" id="3039346">)</span><span class="op" id="3039347">,</span>&nbsp;<span class="builtinfunc" id="3039349">len</span><span class="op" id="3039352">(</span><span class="ident" id="3039353">m</span><span class="op" id="3039354">)</span><span class="op" id="3039355">*</span><span class="num" id="3039356">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039359">if</span>&nbsp;<span class="ident" id="3039362">ones</span>&nbsp;<span class="op" id="3039367">==</span>&nbsp;<span class="op" id="3039370">-</span><span class="num" id="3039371">1</span>&nbsp;<span class="op" id="3039373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039377">return</span>&nbsp;<span class="num" id="3039384">0</span><span class="op" id="3039385">,</span>&nbsp;<span class="num" id="3039387">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039390">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039393">return</span><br>
<span class="lineno"></span><span class="op" id="3039400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3039403">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3039469">func</span>&nbsp;<span class="op" id="3039474">(</span><span class="ident" id="3039475">m</span>&nbsp;<span class="ident" id="3039477">IPMask</span><span class="op" id="3039483">)</span>&nbsp;<span class="ident" id="3039485">String</span><span class="op" id="3039491">(</span><span class="op" id="3039492">)</span>&nbsp;<span class="builtintype" id="3039494">string</span>&nbsp;<span class="op" id="3039501">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039504">if</span>&nbsp;<span class="builtinfunc" id="3039507">len</span><span class="op" id="3039510">(</span><span class="ident" id="3039511">m</span><span class="op" id="3039512">)</span>&nbsp;<span class="op" id="3039514">==</span>&nbsp;<span class="num" id="3039517">0</span>&nbsp;<span class="op" id="3039519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039523">return</span>&nbsp;<span class="string" id="3039530">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039542">buf</span>&nbsp;<span class="op" id="3039546">:=</span>&nbsp;<span class="builtinfunc" id="3039549">make</span><span class="op" id="3039553">(</span><span class="op" id="3039554">[</span><span class="op" id="3039555">]</span><span class="builtintype" id="3039556">byte</span><span class="op" id="3039560">,</span>&nbsp;<span class="builtinfunc" id="3039562">len</span><span class="op" id="3039565">(</span><span class="ident" id="3039566">m</span><span class="op" id="3039567">)</span><span class="op" id="3039568">*</span><span class="num" id="3039569">2</span><span class="op" id="3039570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039573">for</span>&nbsp;<span class="ident" id="3039577">i</span><span class="op" id="3039578">,</span>&nbsp;<span class="ident" id="3039580">b</span>&nbsp;<span class="op" id="3039582">:=</span>&nbsp;<span class="keyword" id="3039585">range</span>&nbsp;<span class="ident" id="3039591">m</span>&nbsp;<span class="op" id="3039593">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039597">buf</span><span class="op" id="3039600">[</span><span class="ident" id="3039601">i</span><span class="op" id="3039602">*</span><span class="num" id="3039603">2</span><span class="op" id="3039604">]</span><span class="op" id="3039605">,</span>&nbsp;<span class="ident" id="3039607">buf</span><span class="op" id="3039610">[</span><span class="ident" id="3039611">i</span><span class="op" id="3039612">*</span><span class="num" id="3039613">2</span><span class="op" id="3039614">+</span><span class="num" id="3039615">1</span><span class="op" id="3039616">]</span>&nbsp;<span class="op" id="3039618">=</span>&nbsp;<span class="ident" id="3039620">hexDigit</span><span class="op" id="3039628">[</span><span class="ident" id="3039629">b</span><span class="op" id="3039630">&gt;&gt;</span><span class="num" id="3039632">4</span><span class="op" id="3039633">]</span><span class="op" id="3039634">,</span>&nbsp;<span class="ident" id="3039636">hexDigit</span><span class="op" id="3039644">[</span><span class="ident" id="3039645">b</span><span class="op" id="3039646">&amp;</span><span class="num" id="3039647">0xf</span><span class="op" id="3039650">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039656">return</span>&nbsp;<span class="builtintype" id="3039663">string</span><span class="op" id="3039669">(</span><span class="ident" id="3039670">buf</span><span class="op" id="3039673">)</span><br>
<span class="lineno"></span><span class="op" id="3039675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3039678">func</span>&nbsp;<span class="ident" id="3039683">networkNumberAndMask</span><span class="op" id="3039703">(</span><span class="ident" id="3039704">n</span>&nbsp;<span class="op" id="3039706">*</span><span class="ident" id="3039707">IPNet</span><span class="op" id="3039712">)</span>&nbsp;<span class="op" id="3039714">(</span><span class="ident" id="3039715">ip</span>&nbsp;<span class="ident" id="3039718">IP</span><span class="op" id="3039720">,</span>&nbsp;<span class="ident" id="3039722">m</span>&nbsp;<span class="ident" id="3039724">IPMask</span><span class="op" id="3039730">)</span>&nbsp;<span class="op" id="3039732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039735">if</span>&nbsp;<span class="ident" id="3039738">ip</span>&nbsp;<span class="op" id="3039741">=</span>&nbsp;<span class="ident" id="3039743">n</span><span class="op" id="3039744">.</span><span class="ident" id="3039745">IP</span><span class="op" id="3039747">.</span><span class="ident" id="3039748">To4</span><span class="op" id="3039751">(</span><span class="op" id="3039752">)</span><span class="op" id="3039753">;</span>&nbsp;<span class="ident" id="3039755">ip</span>&nbsp;<span class="op" id="3039758">==</span>&nbsp;<span class="ident" id="3039761">nil</span>&nbsp;<span class="op" id="3039765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039769">ip</span>&nbsp;<span class="op" id="3039772">=</span>&nbsp;<span class="ident" id="3039774">n</span><span class="op" id="3039775">.</span><span class="ident" id="3039776">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039781">if</span>&nbsp;<span class="builtinfunc" id="3039784">len</span><span class="op" id="3039787">(</span><span class="ident" id="3039788">ip</span><span class="op" id="3039790">)</span>&nbsp;<span class="op" id="3039792">!=</span>&nbsp;<span class="ident" id="3039795">IPv6len</span>&nbsp;<span class="op" id="3039803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039808">return</span>&nbsp;<span class="ident" id="3039815">nil</span><span class="op" id="3039818">,</span>&nbsp;<span class="ident" id="3039820">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039832">m</span>&nbsp;<span class="op" id="3039834">=</span>&nbsp;<span class="ident" id="3039836">n</span><span class="op" id="3039837">.</span><span class="ident" id="3039838">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039844">switch</span>&nbsp;<span class="builtinfunc" id="3039851">len</span><span class="op" id="3039854">(</span><span class="ident" id="3039855">m</span><span class="op" id="3039856">)</span>&nbsp;<span class="op" id="3039858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039861">case</span>&nbsp;<span class="ident" id="3039866">IPv4len</span><span class="op" id="3039873">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039877">if</span>&nbsp;<span class="builtinfunc" id="3039880">len</span><span class="op" id="3039883">(</span><span class="ident" id="3039884">ip</span><span class="op" id="3039886">)</span>&nbsp;<span class="op" id="3039888">!=</span>&nbsp;<span class="ident" id="3039891">IPv4len</span>&nbsp;<span class="op" id="3039899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039904">return</span>&nbsp;<span class="ident" id="3039911">nil</span><span class="op" id="3039914">,</span>&nbsp;<span class="ident" id="3039916">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039925">case</span>&nbsp;<span class="ident" id="3039930">IPv6len</span><span class="op" id="3039937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039941">if</span>&nbsp;<span class="builtinfunc" id="3039944">len</span><span class="op" id="3039947">(</span><span class="ident" id="3039948">ip</span><span class="op" id="3039950">)</span>&nbsp;<span class="op" id="3039952">==</span>&nbsp;<span class="ident" id="3039955">IPv4len</span>&nbsp;<span class="op" id="3039963">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039968">m</span>&nbsp;<span class="op" id="3039970">=</span>&nbsp;<span class="ident" id="3039972">m</span><span class="op" id="3039973">[</span><span class="num" id="3039974">12</span><span class="op" id="3039976">:</span><span class="op" id="3039977">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039984">default</span><span class="op" id="3039991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039995">return</span>&nbsp;<span class="ident" id="3040002">nil</span><span class="op" id="3040005">,</span>&nbsp;<span class="ident" id="3040007">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040012">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040015">return</span><br>
<span class="lineno"></span><span class="op" id="3040022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3040025">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3040078">func</span>&nbsp;<span class="op" id="3040083">(</span><span class="ident" id="3040084">n</span>&nbsp;<span class="op" id="3040086">*</span><span class="ident" id="3040087">IPNet</span><span class="op" id="3040092">)</span>&nbsp;<span class="ident" id="3040094">Contains</span><span class="op" id="3040102">(</span><span class="ident" id="3040103">ip</span>&nbsp;<span class="ident" id="3040106">IP</span><span class="op" id="3040108">)</span>&nbsp;<span class="builtintype" id="3040110">bool</span>&nbsp;<span class="op" id="3040115">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040118">nn</span><span class="op" id="3040120">,</span>&nbsp;<span class="ident" id="3040122">m</span>&nbsp;<span class="op" id="3040124">:=</span>&nbsp;<span class="ident" id="3040127">networkNumberAndMask</span><span class="op" id="3040147">(</span><span class="ident" id="3040148">n</span><span class="op" id="3040149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040152">if</span>&nbsp;<span class="ident" id="3040155">x</span>&nbsp;<span class="op" id="3040157">:=</span>&nbsp;<span class="ident" id="3040160">ip</span><span class="op" id="3040162">.</span><span class="ident" id="3040163">To4</span><span class="op" id="3040166">(</span><span class="op" id="3040167">)</span><span class="op" id="3040168">;</span>&nbsp;<span class="ident" id="3040170">x</span>&nbsp;<span class="op" id="3040172">!=</span>&nbsp;<span class="ident" id="3040175">nil</span>&nbsp;<span class="op" id="3040179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040183">ip</span>&nbsp;<span class="op" id="3040186">=</span>&nbsp;<span class="ident" id="3040188">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040194">l</span>&nbsp;<span class="op" id="3040196">:=</span>&nbsp;<span class="builtinfunc" id="3040199">len</span><span class="op" id="3040202">(</span><span class="ident" id="3040203">ip</span><span class="op" id="3040205">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040208">if</span>&nbsp;<span class="ident" id="3040211">l</span>&nbsp;<span class="op" id="3040213">!=</span>&nbsp;<span class="builtinfunc" id="3040216">len</span><span class="op" id="3040219">(</span><span class="ident" id="3040220">nn</span><span class="op" id="3040222">)</span>&nbsp;<span class="op" id="3040224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040228">return</span>&nbsp;<span class="builtintype" id="3040235">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040245">for</span>&nbsp;<span class="ident" id="3040249">i</span>&nbsp;<span class="op" id="3040251">:=</span>&nbsp;<span class="num" id="3040254">0</span><span class="op" id="3040255">;</span>&nbsp;<span class="ident" id="3040257">i</span>&nbsp;<span class="op" id="3040259">&lt;</span>&nbsp;<span class="ident" id="3040261">l</span><span class="op" id="3040262">;</span>&nbsp;<span class="ident" id="3040264">i</span><span class="op" id="3040265">++</span>&nbsp;<span class="op" id="3040268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040272">if</span>&nbsp;<span class="ident" id="3040275">nn</span><span class="op" id="3040277">[</span><span class="ident" id="3040278">i</span><span class="op" id="3040279">]</span><span class="op" id="3040280">&amp;</span><span class="ident" id="3040281">m</span><span class="op" id="3040282">[</span><span class="ident" id="3040283">i</span><span class="op" id="3040284">]</span>&nbsp;<span class="op" id="3040286">!=</span>&nbsp;<span class="ident" id="3040289">ip</span><span class="op" id="3040291">[</span><span class="ident" id="3040292">i</span><span class="op" id="3040293">]</span><span class="op" id="3040294">&amp;</span><span class="ident" id="3040295">m</span><span class="op" id="3040296">[</span><span class="ident" id="3040297">i</span><span class="op" id="3040298">]</span>&nbsp;<span class="op" id="3040300">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040305">return</span>&nbsp;<span class="builtintype" id="3040312">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040326">return</span>&nbsp;<span class="builtintype" id="3040333">true</span><br>
<span class="lineno"></span><span class="op" id="3040338">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3040341">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3040398">func</span>&nbsp;<span class="op" id="3040403">(</span><span class="ident" id="3040404">n</span>&nbsp;<span class="op" id="3040406">*</span><span class="ident" id="3040407">IPNet</span><span class="op" id="3040412">)</span>&nbsp;<span class="ident" id="3040414">Network</span><span class="op" id="3040421">(</span><span class="op" id="3040422">)</span>&nbsp;<span class="builtintype" id="3040424">string</span>&nbsp;<span class="op" id="3040431">{</span>&nbsp;<span class="keyword" id="3040433">return</span>&nbsp;<span class="string" id="3040440">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3040449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3040452">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3040517">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3040576">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3040636">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3040699">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3040761">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3040807">func</span>&nbsp;<span class="op" id="3040812">(</span><span class="ident" id="3040813">n</span>&nbsp;<span class="op" id="3040815">*</span><span class="ident" id="3040816">IPNet</span><span class="op" id="3040821">)</span>&nbsp;<span class="ident" id="3040823">String</span><span class="op" id="3040829">(</span><span class="op" id="3040830">)</span>&nbsp;<span class="builtintype" id="3040832">string</span>&nbsp;<span class="op" id="3040839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040842">nn</span><span class="op" id="3040844">,</span>&nbsp;<span class="ident" id="3040846">m</span>&nbsp;<span class="op" id="3040848">:=</span>&nbsp;<span class="ident" id="3040851">networkNumberAndMask</span><span class="op" id="3040871">(</span><span class="ident" id="3040872">n</span><span class="op" id="3040873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040876">if</span>&nbsp;<span class="ident" id="3040879">nn</span>&nbsp;<span class="op" id="3040882">==</span>&nbsp;<span class="ident" id="3040885">nil</span>&nbsp;<span class="op" id="3040889">||</span>&nbsp;<span class="ident" id="3040892">m</span>&nbsp;<span class="op" id="3040894">==</span>&nbsp;<span class="ident" id="3040897">nil</span>&nbsp;<span class="op" id="3040901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040905">return</span>&nbsp;<span class="string" id="3040912">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040921">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040924">l</span>&nbsp;<span class="op" id="3040926">:=</span>&nbsp;<span class="ident" id="3040929">simpleMaskLength</span><span class="op" id="3040945">(</span><span class="ident" id="3040946">m</span><span class="op" id="3040947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040950">if</span>&nbsp;<span class="ident" id="3040953">l</span>&nbsp;<span class="op" id="3040955">==</span>&nbsp;<span class="op" id="3040958">-</span><span class="num" id="3040959">1</span>&nbsp;<span class="op" id="3040961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040965">return</span>&nbsp;<span class="ident" id="3040972">nn</span><span class="op" id="3040974">.</span><span class="ident" id="3040975">String</span><span class="op" id="3040981">(</span><span class="op" id="3040982">)</span>&nbsp;<span class="op" id="3040984">+</span>&nbsp;<span class="string" id="3040986">&#34;/&#34;</span>&nbsp;<span class="op" id="3040990">+</span>&nbsp;<span class="ident" id="3040992">m</span><span class="op" id="3040993">.</span><span class="ident" id="3040994">String</span><span class="op" id="3041000">(</span><span class="op" id="3041001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041007">return</span>&nbsp;<span class="ident" id="3041014">nn</span><span class="op" id="3041016">.</span><span class="ident" id="3041017">String</span><span class="op" id="3041023">(</span><span class="op" id="3041024">)</span>&nbsp;<span class="op" id="3041026">+</span>&nbsp;<span class="string" id="3041028">&#34;/&#34;</span>&nbsp;<span class="op" id="3041032">+</span>&nbsp;<span class="ident" id="3041034">itod</span><span class="op" id="3041038">(</span><span class="builtintype" id="3041039">uint</span><span class="op" id="3041043">(</span><span class="ident" id="3041044">l</span><span class="op" id="3041045">)</span><span class="op" id="3041046">)</span><br>
<span class="lineno">495</span><span class="op" id="3041048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3041051">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3041084">func</span>&nbsp;<span class="ident" id="3041089">parseIPv4</span><span class="op" id="3041098">(</span><span class="ident" id="3041099">s</span>&nbsp;<span class="builtintype" id="3041101">string</span><span class="op" id="3041107">)</span>&nbsp;<span class="ident" id="3041109">IP</span>&nbsp;<span class="op" id="3041112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041115">var</span>&nbsp;<span class="ident" id="3041119">p</span>&nbsp;<span class="op" id="3041121">[</span><span class="ident" id="3041122">IPv4len</span><span class="op" id="3041129">]</span><span class="builtintype" id="3041130">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041136">i</span>&nbsp;<span class="op" id="3041138">:=</span>&nbsp;<span class="num" id="3041141">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041144">for</span>&nbsp;<span class="ident" id="3041148">j</span>&nbsp;<span class="op" id="3041150">:=</span>&nbsp;<span class="num" id="3041153">0</span><span class="op" id="3041154">;</span>&nbsp;<span class="ident" id="3041156">j</span>&nbsp;<span class="op" id="3041158">&lt;</span>&nbsp;<span class="ident" id="3041160">IPv4len</span><span class="op" id="3041167">;</span>&nbsp;<span class="ident" id="3041169">j</span><span class="op" id="3041170">++</span>&nbsp;<span class="op" id="3041173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041177">if</span>&nbsp;<span class="ident" id="3041180">i</span>&nbsp;<span class="op" id="3041182">&gt;=</span>&nbsp;<span class="builtinfunc" id="3041185">len</span><span class="op" id="3041188">(</span><span class="ident" id="3041189">s</span><span class="op" id="3041190">)</span>&nbsp;<span class="op" id="3041192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3041197">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041219">return</span>&nbsp;<span class="ident" id="3041226">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041236">if</span>&nbsp;<span class="ident" id="3041239">j</span>&nbsp;<span class="op" id="3041241">&gt;</span>&nbsp;<span class="num" id="3041243">0</span>&nbsp;<span class="op" id="3041245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041250">if</span>&nbsp;<span class="ident" id="3041253">s</span><span class="op" id="3041254">[</span><span class="ident" id="3041255">i</span><span class="op" id="3041256">]</span>&nbsp;<span class="op" id="3041258">!=</span>&nbsp;<span class="string" id="3041261">&#39;.&#39;</span>&nbsp;<span class="op" id="3041265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041271">return</span>&nbsp;<span class="ident" id="3041278">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041285">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041290">i</span><span class="op" id="3041291">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041300">var</span>&nbsp;<span class="op" id="3041304">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041309">n</span>&nbsp;&nbsp;<span class="builtintype" id="3041312">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041319">ok</span>&nbsp;<span class="builtintype" id="3041322">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041333">n</span><span class="op" id="3041334">,</span>&nbsp;<span class="ident" id="3041336">i</span><span class="op" id="3041337">,</span>&nbsp;<span class="ident" id="3041339">ok</span>&nbsp;<span class="op" id="3041342">=</span>&nbsp;<span class="ident" id="3041344">dtoi</span><span class="op" id="3041348">(</span><span class="ident" id="3041349">s</span><span class="op" id="3041350">,</span>&nbsp;<span class="ident" id="3041352">i</span><span class="op" id="3041353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041357">if</span>&nbsp;<span class="op" id="3041360">!</span><span class="ident" id="3041361">ok</span>&nbsp;<span class="op" id="3041364">||</span>&nbsp;<span class="ident" id="3041367">n</span>&nbsp;<span class="op" id="3041369">&gt;</span>&nbsp;<span class="num" id="3041371">0xFF</span>&nbsp;<span class="op" id="3041376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041381">return</span>&nbsp;<span class="ident" id="3041388">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041394">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041398">p</span><span class="op" id="3041399">[</span><span class="ident" id="3041400">j</span><span class="op" id="3041401">]</span>&nbsp;<span class="op" id="3041403">=</span>&nbsp;<span class="builtintype" id="3041405">byte</span><span class="op" id="3041409">(</span><span class="ident" id="3041410">n</span><span class="op" id="3041411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041417">if</span>&nbsp;<span class="ident" id="3041420">i</span>&nbsp;<span class="op" id="3041422">!=</span>&nbsp;<span class="builtinfunc" id="3041425">len</span><span class="op" id="3041428">(</span><span class="ident" id="3041429">s</span><span class="op" id="3041430">)</span>&nbsp;<span class="op" id="3041432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041436">return</span>&nbsp;<span class="ident" id="3041443">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041448">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041451">return</span>&nbsp;<span class="ident" id="3041458">IPv4</span><span class="op" id="3041462">(</span><span class="ident" id="3041463">p</span><span class="op" id="3041464">[</span><span class="num" id="3041465">0</span><span class="op" id="3041466">]</span><span class="op" id="3041467">,</span>&nbsp;<span class="ident" id="3041469">p</span><span class="op" id="3041470">[</span><span class="num" id="3041471">1</span><span class="op" id="3041472">]</span><span class="op" id="3041473">,</span>&nbsp;<span class="ident" id="3041475">p</span><span class="op" id="3041476">[</span><span class="num" id="3041477">2</span><span class="op" id="3041478">]</span><span class="op" id="3041479">,</span>&nbsp;<span class="ident" id="3041481">p</span><span class="op" id="3041482">[</span><span class="num" id="3041483">3</span><span class="op" id="3041484">]</span><span class="op" id="3041485">)</span><br>
<span class="lineno"></span><span class="op" id="3041487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3041490">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3041560">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3041631">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3041701">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3041710">func</span>&nbsp;<span class="ident" id="3041715">parseIPv6</span><span class="op" id="3041724">(</span><span class="ident" id="3041725">s</span>&nbsp;<span class="builtintype" id="3041727">string</span><span class="op" id="3041733">,</span>&nbsp;<span class="ident" id="3041735">zoneAllowed</span>&nbsp;<span class="builtintype" id="3041747">bool</span><span class="op" id="3041751">)</span>&nbsp;<span class="op" id="3041753">(</span><span class="ident" id="3041754">ip</span>&nbsp;<span class="ident" id="3041757">IP</span><span class="op" id="3041759">,</span>&nbsp;<span class="ident" id="3041761">zone</span>&nbsp;<span class="builtintype" id="3041766">string</span><span class="op" id="3041772">)</span>&nbsp;<span class="op" id="3041774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041777">ip</span>&nbsp;<span class="op" id="3041780">=</span>&nbsp;<span class="builtinfunc" id="3041782">make</span><span class="op" id="3041786">(</span><span class="ident" id="3041787">IP</span><span class="op" id="3041789">,</span>&nbsp;<span class="ident" id="3041791">IPv6len</span><span class="op" id="3041798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041801">ellipsis</span>&nbsp;<span class="op" id="3041810">:=</span>&nbsp;<span class="op" id="3041813">-</span><span class="num" id="3041814">1</span>&nbsp;<span class="comment" id="3041816">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041846">i</span>&nbsp;<span class="op" id="3041848">:=</span>&nbsp;<span class="num" id="3041851">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3041861">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041884">if</span>&nbsp;<span class="ident" id="3041887">zoneAllowed</span>&nbsp;<span class="op" id="3041899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3041903">s</span><span class="op" id="3041904">,</span>&nbsp;<span class="ident" id="3041906">zone</span>&nbsp;<span class="op" id="3041911">=</span>&nbsp;<span class="ident" id="3041913">splitHostZone</span><span class="op" id="3041926">(</span><span class="ident" id="3041927">s</span><span class="op" id="3041928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3041931">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3041935">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3041967">if</span>&nbsp;<span class="builtinfunc" id="3041970">len</span><span class="op" id="3041973">(</span><span class="ident" id="3041974">s</span><span class="op" id="3041975">)</span>&nbsp;<span class="op" id="3041977">&gt;=</span>&nbsp;<span class="num" id="3041980">2</span>&nbsp;<span class="op" id="3041982">&amp;&amp;</span>&nbsp;<span class="ident" id="3041985">s</span><span class="op" id="3041986">[</span><span class="num" id="3041987">0</span><span class="op" id="3041988">]</span>&nbsp;<span class="op" id="3041990">==</span>&nbsp;<span class="string" id="3041993">&#39;:&#39;</span>&nbsp;<span class="op" id="3041997">&amp;&amp;</span>&nbsp;<span class="ident" id="3042000">s</span><span class="op" id="3042001">[</span><span class="num" id="3042002">1</span><span class="op" id="3042003">]</span>&nbsp;<span class="op" id="3042005">==</span>&nbsp;<span class="string" id="3042008">&#39;:&#39;</span>&nbsp;<span class="op" id="3042012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042016">ellipsis</span>&nbsp;<span class="op" id="3042025">=</span>&nbsp;<span class="num" id="3042027">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042031">i</span>&nbsp;<span class="op" id="3042033">=</span>&nbsp;<span class="num" id="3042035">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042039">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042067">if</span>&nbsp;<span class="ident" id="3042070">i</span>&nbsp;<span class="op" id="3042072">==</span>&nbsp;<span class="builtinfunc" id="3042075">len</span><span class="op" id="3042078">(</span><span class="ident" id="3042079">s</span><span class="op" id="3042080">)</span>&nbsp;<span class="op" id="3042082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042087">return</span>&nbsp;<span class="ident" id="3042094">ip</span><span class="op" id="3042096">,</span>&nbsp;<span class="ident" id="3042098">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042108">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042112">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042161">j</span>&nbsp;<span class="op" id="3042163">:=</span>&nbsp;<span class="num" id="3042166">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042169">for</span>&nbsp;<span class="ident" id="3042173">j</span>&nbsp;<span class="op" id="3042175">&lt;</span>&nbsp;<span class="ident" id="3042177">IPv6len</span>&nbsp;<span class="op" id="3042185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042189">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042206">n</span><span class="op" id="3042207">,</span>&nbsp;<span class="ident" id="3042209">i1</span><span class="op" id="3042211">,</span>&nbsp;<span class="ident" id="3042213">ok</span>&nbsp;<span class="op" id="3042216">:=</span>&nbsp;<span class="ident" id="3042219">xtoi</span><span class="op" id="3042223">(</span><span class="ident" id="3042224">s</span><span class="op" id="3042225">,</span>&nbsp;<span class="ident" id="3042227">i</span><span class="op" id="3042228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042232">if</span>&nbsp;<span class="op" id="3042235">!</span><span class="ident" id="3042236">ok</span>&nbsp;<span class="op" id="3042239">||</span>&nbsp;<span class="ident" id="3042242">n</span>&nbsp;<span class="op" id="3042244">&gt;</span>&nbsp;<span class="num" id="3042246">0xFFFF</span>&nbsp;<span class="op" id="3042253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042258">return</span>&nbsp;<span class="ident" id="3042265">nil</span><span class="op" id="3042268">,</span>&nbsp;<span class="ident" id="3042270">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042282">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042334">if</span>&nbsp;<span class="ident" id="3042337">i1</span>&nbsp;<span class="op" id="3042340">&lt;</span>&nbsp;<span class="builtinfunc" id="3042342">len</span><span class="op" id="3042345">(</span><span class="ident" id="3042346">s</span><span class="op" id="3042347">)</span>&nbsp;<span class="op" id="3042349">&amp;&amp;</span>&nbsp;<span class="ident" id="3042352">s</span><span class="op" id="3042353">[</span><span class="ident" id="3042354">i1</span><span class="op" id="3042356">]</span>&nbsp;<span class="op" id="3042358">==</span>&nbsp;<span class="string" id="3042361">&#39;.&#39;</span>&nbsp;<span class="op" id="3042365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042370">if</span>&nbsp;<span class="ident" id="3042373">ellipsis</span>&nbsp;<span class="op" id="3042382">&lt;</span>&nbsp;<span class="num" id="3042384">0</span>&nbsp;<span class="op" id="3042386">&amp;&amp;</span>&nbsp;<span class="ident" id="3042389">j</span>&nbsp;<span class="op" id="3042391">!=</span>&nbsp;<span class="ident" id="3042394">IPv6len</span><span class="op" id="3042401">-</span><span class="ident" id="3042402">IPv4len</span>&nbsp;<span class="op" id="3042410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042416">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042444">return</span>&nbsp;<span class="ident" id="3042451">nil</span><span class="op" id="3042454">,</span>&nbsp;<span class="ident" id="3042456">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042469">if</span>&nbsp;<span class="ident" id="3042472">j</span><span class="op" id="3042473">+</span><span class="ident" id="3042474">IPv4len</span>&nbsp;<span class="op" id="3042482">&gt;</span>&nbsp;<span class="ident" id="3042484">IPv6len</span>&nbsp;<span class="op" id="3042492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042498">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042522">return</span>&nbsp;<span class="ident" id="3042529">nil</span><span class="op" id="3042532">,</span>&nbsp;<span class="ident" id="3042534">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042542">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042547">ip4</span>&nbsp;<span class="op" id="3042551">:=</span>&nbsp;<span class="ident" id="3042554">parseIPv4</span><span class="op" id="3042563">(</span><span class="ident" id="3042564">s</span><span class="op" id="3042565">[</span><span class="ident" id="3042566">i</span><span class="op" id="3042567">:</span><span class="op" id="3042568">]</span><span class="op" id="3042569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042574">if</span>&nbsp;<span class="ident" id="3042577">ip4</span>&nbsp;<span class="op" id="3042581">==</span>&nbsp;<span class="ident" id="3042584">nil</span>&nbsp;<span class="op" id="3042588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042594">return</span>&nbsp;<span class="ident" id="3042601">nil</span><span class="op" id="3042604">,</span>&nbsp;<span class="ident" id="3042606">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042619">ip</span><span class="op" id="3042621">[</span><span class="ident" id="3042622">j</span><span class="op" id="3042623">]</span>&nbsp;<span class="op" id="3042625">=</span>&nbsp;<span class="ident" id="3042627">ip4</span><span class="op" id="3042630">[</span><span class="num" id="3042631">12</span><span class="op" id="3042633">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042638">ip</span><span class="op" id="3042640">[</span><span class="ident" id="3042641">j</span><span class="op" id="3042642">+</span><span class="num" id="3042643">1</span><span class="op" id="3042644">]</span>&nbsp;<span class="op" id="3042646">=</span>&nbsp;<span class="ident" id="3042648">ip4</span><span class="op" id="3042651">[</span><span class="num" id="3042652">13</span><span class="op" id="3042654">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042659">ip</span><span class="op" id="3042661">[</span><span class="ident" id="3042662">j</span><span class="op" id="3042663">+</span><span class="num" id="3042664">2</span><span class="op" id="3042665">]</span>&nbsp;<span class="op" id="3042667">=</span>&nbsp;<span class="ident" id="3042669">ip4</span><span class="op" id="3042672">[</span><span class="num" id="3042673">14</span><span class="op" id="3042675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042680">ip</span><span class="op" id="3042682">[</span><span class="ident" id="3042683">j</span><span class="op" id="3042684">+</span><span class="num" id="3042685">3</span><span class="op" id="3042686">]</span>&nbsp;<span class="op" id="3042688">=</span>&nbsp;<span class="ident" id="3042690">ip4</span><span class="op" id="3042693">[</span><span class="num" id="3042694">15</span><span class="op" id="3042696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042701">i</span>&nbsp;<span class="op" id="3042703">=</span>&nbsp;<span class="builtinfunc" id="3042705">len</span><span class="op" id="3042708">(</span><span class="ident" id="3042709">s</span><span class="op" id="3042710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042715">j</span>&nbsp;<span class="op" id="3042717">+=</span>&nbsp;<span class="ident" id="3042720">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042731">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042744">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042773">ip</span><span class="op" id="3042775">[</span><span class="ident" id="3042776">j</span><span class="op" id="3042777">]</span>&nbsp;<span class="op" id="3042779">=</span>&nbsp;<span class="builtintype" id="3042781">byte</span><span class="op" id="3042785">(</span><span class="ident" id="3042786">n</span>&nbsp;<span class="op" id="3042788">&gt;&gt;</span>&nbsp;<span class="num" id="3042791">8</span><span class="op" id="3042792">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042796">ip</span><span class="op" id="3042798">[</span><span class="ident" id="3042799">j</span><span class="op" id="3042800">+</span><span class="num" id="3042801">1</span><span class="op" id="3042802">]</span>&nbsp;<span class="op" id="3042804">=</span>&nbsp;<span class="builtintype" id="3042806">byte</span><span class="op" id="3042810">(</span><span class="ident" id="3042811">n</span><span class="op" id="3042812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042816">j</span>&nbsp;<span class="op" id="3042818">+=</span>&nbsp;<span class="num" id="3042821">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042826">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3042854">i</span>&nbsp;<span class="op" id="3042856">=</span>&nbsp;<span class="ident" id="3042858">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042863">if</span>&nbsp;<span class="ident" id="3042866">i</span>&nbsp;<span class="op" id="3042868">==</span>&nbsp;<span class="builtinfunc" id="3042871">len</span><span class="op" id="3042874">(</span><span class="ident" id="3042875">s</span><span class="op" id="3042876">)</span>&nbsp;<span class="op" id="3042878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042883">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3042891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3042896">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042947">if</span>&nbsp;<span class="ident" id="3042950">s</span><span class="op" id="3042951">[</span><span class="ident" id="3042952">i</span><span class="op" id="3042953">]</span>&nbsp;<span class="op" id="3042955">!=</span>&nbsp;<span class="string" id="3042958">&#39;:&#39;</span>&nbsp;<span class="op" id="3042962">||</span>&nbsp;<span class="ident" id="3042965">i</span><span class="op" id="3042966">+</span><span class="num" id="3042967">1</span>&nbsp;<span class="op" id="3042969">==</span>&nbsp;<span class="builtinfunc" id="3042972">len</span><span class="op" id="3042975">(</span><span class="ident" id="3042976">s</span><span class="op" id="3042977">)</span>&nbsp;<span class="op" id="3042979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3042984">return</span>&nbsp;<span class="ident" id="3042991">nil</span><span class="op" id="3042994">,</span>&nbsp;<span class="ident" id="3042996">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043007">i</span><span class="op" id="3043008">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3043014">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043038">if</span>&nbsp;<span class="ident" id="3043041">s</span><span class="op" id="3043042">[</span><span class="ident" id="3043043">i</span><span class="op" id="3043044">]</span>&nbsp;<span class="op" id="3043046">==</span>&nbsp;<span class="string" id="3043049">&#39;:&#39;</span>&nbsp;<span class="op" id="3043053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043058">if</span>&nbsp;<span class="ident" id="3043061">ellipsis</span>&nbsp;<span class="op" id="3043070">&gt;=</span>&nbsp;<span class="num" id="3043073">0</span>&nbsp;<span class="op" id="3043075">{</span>&nbsp;<span class="comment" id="3043077">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043101">return</span>&nbsp;<span class="ident" id="3043108">nil</span><span class="op" id="3043111">,</span>&nbsp;<span class="ident" id="3043113">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043121">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043126">ellipsis</span>&nbsp;<span class="op" id="3043135">=</span>&nbsp;<span class="ident" id="3043137">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043142">if</span>&nbsp;<span class="ident" id="3043145">i</span><span class="op" id="3043146">++</span><span class="op" id="3043148">;</span>&nbsp;<span class="ident" id="3043150">i</span>&nbsp;<span class="op" id="3043152">==</span>&nbsp;<span class="builtinfunc" id="3043155">len</span><span class="op" id="3043158">(</span><span class="ident" id="3043159">s</span><span class="op" id="3043160">)</span>&nbsp;<span class="op" id="3043162">{</span>&nbsp;<span class="comment" id="3043164">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043185">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043198">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3043205">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043239">if</span>&nbsp;<span class="ident" id="3043242">i</span>&nbsp;<span class="op" id="3043244">!=</span>&nbsp;<span class="builtinfunc" id="3043247">len</span><span class="op" id="3043250">(</span><span class="ident" id="3043251">s</span><span class="op" id="3043252">)</span>&nbsp;<span class="op" id="3043254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043258">return</span>&nbsp;<span class="ident" id="3043265">nil</span><span class="op" id="3043268">,</span>&nbsp;<span class="ident" id="3043270">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3043280">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043325">if</span>&nbsp;<span class="ident" id="3043328">j</span>&nbsp;<span class="op" id="3043330">&lt;</span>&nbsp;<span class="ident" id="3043332">IPv6len</span>&nbsp;<span class="op" id="3043340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043344">if</span>&nbsp;<span class="ident" id="3043347">ellipsis</span>&nbsp;<span class="op" id="3043356">&lt;</span>&nbsp;<span class="num" id="3043358">0</span>&nbsp;<span class="op" id="3043360">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043365">return</span>&nbsp;<span class="ident" id="3043372">nil</span><span class="op" id="3043375">,</span>&nbsp;<span class="ident" id="3043377">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043388">n</span>&nbsp;<span class="op" id="3043390">:=</span>&nbsp;<span class="ident" id="3043393">IPv6len</span>&nbsp;<span class="op" id="3043401">-</span>&nbsp;<span class="ident" id="3043403">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043407">for</span>&nbsp;<span class="ident" id="3043411">k</span>&nbsp;<span class="op" id="3043413">:=</span>&nbsp;<span class="ident" id="3043416">j</span>&nbsp;<span class="op" id="3043418">-</span>&nbsp;<span class="num" id="3043420">1</span><span class="op" id="3043421">;</span>&nbsp;<span class="ident" id="3043423">k</span>&nbsp;<span class="op" id="3043425">&gt;=</span>&nbsp;<span class="ident" id="3043428">ellipsis</span><span class="op" id="3043436">;</span>&nbsp;<span class="ident" id="3043438">k</span><span class="op" id="3043439">--</span>&nbsp;<span class="op" id="3043442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043447">ip</span><span class="op" id="3043449">[</span><span class="ident" id="3043450">k</span><span class="op" id="3043451">+</span><span class="ident" id="3043452">n</span><span class="op" id="3043453">]</span>&nbsp;<span class="op" id="3043455">=</span>&nbsp;<span class="ident" id="3043457">ip</span><span class="op" id="3043459">[</span><span class="ident" id="3043460">k</span><span class="op" id="3043461">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043469">for</span>&nbsp;<span class="ident" id="3043473">k</span>&nbsp;<span class="op" id="3043475">:=</span>&nbsp;<span class="ident" id="3043478">ellipsis</span>&nbsp;<span class="op" id="3043487">+</span>&nbsp;<span class="ident" id="3043489">n</span>&nbsp;<span class="op" id="3043491">-</span>&nbsp;<span class="num" id="3043493">1</span><span class="op" id="3043494">;</span>&nbsp;<span class="ident" id="3043496">k</span>&nbsp;<span class="op" id="3043498">&gt;=</span>&nbsp;<span class="ident" id="3043501">ellipsis</span><span class="op" id="3043509">;</span>&nbsp;<span class="ident" id="3043511">k</span><span class="op" id="3043512">--</span>&nbsp;<span class="op" id="3043515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043520">ip</span><span class="op" id="3043522">[</span><span class="ident" id="3043523">k</span><span class="op" id="3043524">]</span>&nbsp;<span class="op" id="3043526">=</span>&nbsp;<span class="num" id="3043528">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043535">}</span>&nbsp;<span class="keyword" id="3043537">else</span>&nbsp;<span class="keyword" id="3043542">if</span>&nbsp;<span class="ident" id="3043545">ellipsis</span>&nbsp;<span class="op" id="3043554">&gt;=</span>&nbsp;<span class="num" id="3043557">0</span>&nbsp;<span class="op" id="3043559">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3043563">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043614">return</span>&nbsp;<span class="ident" id="3043621">nil</span><span class="op" id="3043624">,</span>&nbsp;<span class="ident" id="3043626">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3043632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043635">return</span>&nbsp;<span class="ident" id="3043642">ip</span><span class="op" id="3043644">,</span>&nbsp;<span class="ident" id="3043646">zone</span><br>
<span class="lineno"></span><span class="op" id="3043651">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3043654">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3043747">type</span>&nbsp;<span class="ident" id="3043752">ParseError</span>&nbsp;<span class="keyword" id="3043763">struct</span>&nbsp;<span class="op" id="3043770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043773">Type</span>&nbsp;<span class="builtintype" id="3043778">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3043786">Text</span>&nbsp;<span class="builtintype" id="3043791">string</span><br>
<span class="lineno">640</span><span class="op" id="3043798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3043801">func</span>&nbsp;<span class="op" id="3043806">(</span><span class="ident" id="3043807">e</span>&nbsp;<span class="op" id="3043809">*</span><span class="ident" id="3043810">ParseError</span><span class="op" id="3043820">)</span>&nbsp;<span class="ident" id="3043822">Error</span><span class="op" id="3043827">(</span><span class="op" id="3043828">)</span>&nbsp;<span class="builtintype" id="3043830">string</span>&nbsp;<span class="op" id="3043837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3043840">return</span>&nbsp;<span class="string" id="3043847">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3043858">+</span>&nbsp;<span class="ident" id="3043860">e</span><span class="op" id="3043861">.</span><span class="ident" id="3043862">Type</span>&nbsp;<span class="op" id="3043867">+</span>&nbsp;<span class="string" id="3043869">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3043874">+</span>&nbsp;<span class="ident" id="3043876">e</span><span class="op" id="3043877">.</span><span class="ident" id="3043878">Text</span><br>
<span class="lineno"></span><span class="op" id="3043883">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3043886">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3043946">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3044004">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3044046">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3044110">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3044134">func</span>&nbsp;<span class="ident" id="3044139">ParseIP</span><span class="op" id="3044146">(</span><span class="ident" id="3044147">s</span>&nbsp;<span class="builtintype" id="3044149">string</span><span class="op" id="3044155">)</span>&nbsp;<span class="ident" id="3044157">IP</span>&nbsp;<span class="op" id="3044160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044163">for</span>&nbsp;<span class="ident" id="3044167">i</span>&nbsp;<span class="op" id="3044169">:=</span>&nbsp;<span class="num" id="3044172">0</span><span class="op" id="3044173">;</span>&nbsp;<span class="ident" id="3044175">i</span>&nbsp;<span class="op" id="3044177">&lt;</span>&nbsp;<span class="builtinfunc" id="3044179">len</span><span class="op" id="3044182">(</span><span class="ident" id="3044183">s</span><span class="op" id="3044184">)</span><span class="op" id="3044185">;</span>&nbsp;<span class="ident" id="3044187">i</span><span class="op" id="3044188">++</span>&nbsp;<span class="op" id="3044191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044195">switch</span>&nbsp;<span class="ident" id="3044202">s</span><span class="op" id="3044203">[</span><span class="ident" id="3044204">i</span><span class="op" id="3044205">]</span>&nbsp;<span class="op" id="3044207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044211">case</span>&nbsp;<span class="string" id="3044216">&#39;.&#39;</span><span class="op" id="3044219">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044224">return</span>&nbsp;<span class="ident" id="3044231">parseIPv4</span><span class="op" id="3044240">(</span><span class="ident" id="3044241">s</span><span class="op" id="3044242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044246">case</span>&nbsp;<span class="string" id="3044251">&#39;:&#39;</span><span class="op" id="3044254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044259">ip</span><span class="op" id="3044261">,</span>&nbsp;<span class="ident" id="3044263">_</span>&nbsp;<span class="op" id="3044265">:=</span>&nbsp;<span class="ident" id="3044268">parseIPv6</span><span class="op" id="3044277">(</span><span class="ident" id="3044278">s</span><span class="op" id="3044279">,</span>&nbsp;<span class="builtintype" id="3044281">false</span><span class="op" id="3044286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044291">return</span>&nbsp;<span class="ident" id="3044298">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3044303">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3044306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044309">return</span>&nbsp;<span class="ident" id="3044316">nil</span><br>
<span class="lineno"></span><span class="op" id="3044320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3044323">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3044385">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3044446">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3044472">//</span><br>
<span class="lineno"></span><span class="comment" id="3044475">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3044538">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3044603">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3044667">func</span>&nbsp;<span class="ident" id="3044672">ParseCIDR</span><span class="op" id="3044681">(</span><span class="ident" id="3044682">s</span>&nbsp;<span class="builtintype" id="3044684">string</span><span class="op" id="3044690">)</span>&nbsp;<span class="op" id="3044692">(</span><span class="ident" id="3044693">IP</span><span class="op" id="3044695">,</span>&nbsp;<span class="op" id="3044697">*</span><span class="ident" id="3044698">IPNet</span><span class="op" id="3044703">,</span>&nbsp;<span class="builtintype" id="3044705">error</span><span class="op" id="3044710">)</span>&nbsp;<span class="op" id="3044712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044715">i</span>&nbsp;<span class="op" id="3044717">:=</span>&nbsp;<span class="ident" id="3044720">byteIndex</span><span class="op" id="3044729">(</span><span class="ident" id="3044730">s</span><span class="op" id="3044731">,</span>&nbsp;<span class="string" id="3044733">&#39;/&#39;</span><span class="op" id="3044736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044739">if</span>&nbsp;<span class="ident" id="3044742">i</span>&nbsp;<span class="op" id="3044744">&lt;</span>&nbsp;<span class="num" id="3044746">0</span>&nbsp;<span class="op" id="3044748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044752">return</span>&nbsp;<span class="ident" id="3044759">nil</span><span class="op" id="3044762">,</span>&nbsp;<span class="ident" id="3044764">nil</span><span class="op" id="3044767">,</span>&nbsp;<span class="op" id="3044769">&amp;</span><span class="ident" id="3044770">ParseError</span><span class="op" id="3044780">{</span><span class="string" id="3044781">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3044795">,</span>&nbsp;<span class="ident" id="3044797">s</span><span class="op" id="3044798">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3044801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044804">addr</span><span class="op" id="3044808">,</span>&nbsp;<span class="ident" id="3044810">mask</span>&nbsp;<span class="op" id="3044815">:=</span>&nbsp;<span class="ident" id="3044818">s</span><span class="op" id="3044819">[</span><span class="op" id="3044820">:</span><span class="ident" id="3044821">i</span><span class="op" id="3044822">]</span><span class="op" id="3044823">,</span>&nbsp;<span class="ident" id="3044825">s</span><span class="op" id="3044826">[</span><span class="ident" id="3044827">i</span><span class="op" id="3044828">+</span><span class="num" id="3044829">1</span><span class="op" id="3044830">:</span><span class="op" id="3044831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044834">iplen</span>&nbsp;<span class="op" id="3044840">:=</span>&nbsp;<span class="ident" id="3044843">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044852">ip</span>&nbsp;<span class="op" id="3044855">:=</span>&nbsp;<span class="ident" id="3044858">parseIPv4</span><span class="op" id="3044867">(</span><span class="ident" id="3044868">addr</span><span class="op" id="3044872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044875">if</span>&nbsp;<span class="ident" id="3044878">ip</span>&nbsp;<span class="op" id="3044881">==</span>&nbsp;<span class="ident" id="3044884">nil</span>&nbsp;<span class="op" id="3044888">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044892">iplen</span>&nbsp;<span class="op" id="3044898">=</span>&nbsp;<span class="ident" id="3044900">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044910">ip</span><span class="op" id="3044912">,</span>&nbsp;<span class="ident" id="3044914">_</span>&nbsp;<span class="op" id="3044916">=</span>&nbsp;<span class="ident" id="3044918">parseIPv6</span><span class="op" id="3044927">(</span><span class="ident" id="3044928">addr</span><span class="op" id="3044932">,</span>&nbsp;<span class="builtintype" id="3044934">false</span><span class="op" id="3044939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3044942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3044945">n</span><span class="op" id="3044946">,</span>&nbsp;<span class="ident" id="3044948">i</span><span class="op" id="3044949">,</span>&nbsp;<span class="ident" id="3044951">ok</span>&nbsp;<span class="op" id="3044954">:=</span>&nbsp;<span class="ident" id="3044957">dtoi</span><span class="op" id="3044961">(</span><span class="ident" id="3044962">mask</span><span class="op" id="3044966">,</span>&nbsp;<span class="num" id="3044968">0</span><span class="op" id="3044969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3044972">if</span>&nbsp;<span class="ident" id="3044975">ip</span>&nbsp;<span class="op" id="3044978">==</span>&nbsp;<span class="ident" id="3044981">nil</span>&nbsp;<span class="op" id="3044985">||</span>&nbsp;<span class="op" id="3044988">!</span><span class="ident" id="3044989">ok</span>&nbsp;<span class="op" id="3044992">||</span>&nbsp;<span class="ident" id="3044995">i</span>&nbsp;<span class="op" id="3044997">!=</span>&nbsp;<span class="builtinfunc" id="3045000">len</span><span class="op" id="3045003">(</span><span class="ident" id="3045004">mask</span><span class="op" id="3045008">)</span>&nbsp;<span class="op" id="3045010">||</span>&nbsp;<span class="ident" id="3045013">n</span>&nbsp;<span class="op" id="3045015">&lt;</span>&nbsp;<span class="num" id="3045017">0</span>&nbsp;<span class="op" id="3045019">||</span>&nbsp;<span class="ident" id="3045022">n</span>&nbsp;<span class="op" id="3045024">&gt;</span>&nbsp;<span class="num" id="3045026">8</span><span class="op" id="3045027">*</span><span class="ident" id="3045028">iplen</span>&nbsp;<span class="op" id="3045034">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3045038">return</span>&nbsp;<span class="ident" id="3045045">nil</span><span class="op" id="3045048">,</span>&nbsp;<span class="ident" id="3045050">nil</span><span class="op" id="3045053">,</span>&nbsp;<span class="op" id="3045055">&amp;</span><span class="ident" id="3045056">ParseError</span><span class="op" id="3045066">{</span><span class="string" id="3045067">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3045081">,</span>&nbsp;<span class="ident" id="3045083">s</span><span class="op" id="3045084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3045087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3045090">m</span>&nbsp;<span class="op" id="3045092">:=</span>&nbsp;<span class="ident" id="3045095">CIDRMask</span><span class="op" id="3045103">(</span><span class="ident" id="3045104">n</span><span class="op" id="3045105">,</span>&nbsp;<span class="num" id="3045107">8</span><span class="op" id="3045108">*</span><span class="ident" id="3045109">iplen</span><span class="op" id="3045114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3045117">return</span>&nbsp;<span class="ident" id="3045124">ip</span><span class="op" id="3045126">,</span>&nbsp;<span class="op" id="3045128">&amp;</span><span class="ident" id="3045129">IPNet</span><span class="op" id="3045134">{</span><span class="ident" id="3045135">IP</span><span class="op" id="3045137">:</span>&nbsp;<span class="ident" id="3045139">ip</span><span class="op" id="3045141">.</span><span class="ident" id="3045142">Mask</span><span class="op" id="3045146">(</span><span class="ident" id="3045147">m</span><span class="op" id="3045148">)</span><span class="op" id="3045149">,</span>&nbsp;<span class="ident" id="3045151">Mask</span><span class="op" id="3045155">:</span>&nbsp;<span class="ident" id="3045157">m</span><span class="op" id="3045158">}</span><span class="op" id="3045159">,</span>&nbsp;<span class="ident" id="3045161">nil</span><br>
<span class="lineno"></span><span class="op" id="3045165">}</span>
</div>
</body>
</html>
