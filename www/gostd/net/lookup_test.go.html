<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7831393">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7831448">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7831502">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7831553">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="7831617">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831644">package</span>&nbsp;<span class="ident" id="7831652">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7831657">import</span>&nbsp;<span class="op" id="7831664">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7831667">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7831675">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7831686">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7831696">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7831699">var</span>&nbsp;<span class="ident" id="7831703">testExternal</span>&nbsp;<span class="op" id="7831716">=</span>&nbsp;<span class="ident" id="7831718">flag</span><span class="op" id="7831722">.</span><span class="ident" id="7831723">Bool</span><span class="op" id="7831727">(</span><span class="string" id="7831728">&#34;external&#34;</span><span class="op" id="7831738">,</span>&nbsp;<span class="builtintype" id="7831740">true</span><span class="op" id="7831744">,</span>&nbsp;<span class="string" id="7831746">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="7831795">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831798">var</span>&nbsp;<span class="ident" id="7831802">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="7831823">=</span>&nbsp;<span class="op" id="7831825">[</span><span class="op" id="7831826">]</span><span class="keyword" id="7831827">struct</span>&nbsp;<span class="op" id="7831834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831837">service</span><span class="op" id="7831844">,</span>&nbsp;<span class="ident" id="7831846">proto</span><span class="op" id="7831851">,</span>&nbsp;<span class="ident" id="7831853">name</span>&nbsp;<span class="builtintype" id="7831858">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831866">cname</span><span class="op" id="7831871">,</span>&nbsp;<span class="ident" id="7831873">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7831887">string</span><br>
<span class="lineno"></span><span class="op" id="7831894">}</span><span class="op" id="7831895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7831902">&#34;xmpp-server&#34;</span><span class="op" id="7831915">,</span>&nbsp;<span class="string" id="7831917">&#34;tcp&#34;</span><span class="op" id="7831922">,</span>&nbsp;<span class="string" id="7831924">&#34;google.com&#34;</span><span class="op" id="7831936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7831940">&#34;.google.com&#34;</span><span class="op" id="7831953">,</span>&nbsp;<span class="string" id="7831955">&#34;.google.com&#34;</span><span class="op" id="7831968">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831971">}</span><span class="op" id="7831972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7831979">&#34;&#34;</span><span class="op" id="7831981">,</span>&nbsp;<span class="string" id="7831983">&#34;&#34;</span><span class="op" id="7831985">,</span>&nbsp;<span class="string" id="7831987">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="7832017">,</span>&nbsp;<span class="comment" id="7832019">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7832047">&#34;.google.com&#34;</span><span class="op" id="7832060">,</span>&nbsp;<span class="string" id="7832062">&#34;.google.com&#34;</span><span class="op" id="7832075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832078">}</span><span class="op" id="7832079">,</span><br>
<span class="lineno">30</span><span class="op" id="7832081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7832084">func</span>&nbsp;<span class="ident" id="7832089">TestLookupGoogleSRV</span><span class="op" id="7832108">(</span><span class="ident" id="7832109">t</span>&nbsp;<span class="op" id="7832111">*</span><span class="ident" id="7832112">testing</span><span class="op" id="7832119">.</span><span class="ident" id="7832120">T</span><span class="op" id="7832121">)</span>&nbsp;<span class="op" id="7832123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832126">if</span>&nbsp;<span class="ident" id="7832129">testing</span><span class="op" id="7832136">.</span><span class="ident" id="7832137">Short</span><span class="op" id="7832142">(</span><span class="op" id="7832143">)</span>&nbsp;<span class="op" id="7832145">||</span>&nbsp;<span class="op" id="7832148">!</span><span class="op" id="7832149">*</span><span class="ident" id="7832150">testExternal</span>&nbsp;<span class="op" id="7832163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832167">t</span><span class="op" id="7832168">.</span><span class="ident" id="7832169">Skip</span><span class="op" id="7832173">(</span><span class="string" id="7832174">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7832215">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832222">for</span>&nbsp;<span class="ident" id="7832226">_</span><span class="op" id="7832227">,</span>&nbsp;<span class="ident" id="7832229">tt</span>&nbsp;<span class="op" id="7832232">:=</span>&nbsp;<span class="keyword" id="7832235">range</span>&nbsp;<span class="ident" id="7832241">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="7832262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832266">cname</span><span class="op" id="7832271">,</span>&nbsp;<span class="ident" id="7832273">srvs</span><span class="op" id="7832277">,</span>&nbsp;<span class="ident" id="7832279">err</span>&nbsp;<span class="op" id="7832283">:=</span>&nbsp;<span class="ident" id="7832286">LookupSRV</span><span class="op" id="7832295">(</span><span class="ident" id="7832296">tt</span><span class="op" id="7832298">.</span><span class="ident" id="7832299">service</span><span class="op" id="7832306">,</span>&nbsp;<span class="ident" id="7832308">tt</span><span class="op" id="7832310">.</span><span class="ident" id="7832311">proto</span><span class="op" id="7832316">,</span>&nbsp;<span class="ident" id="7832318">tt</span><span class="op" id="7832320">.</span><span class="ident" id="7832321">name</span><span class="op" id="7832325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832329">if</span>&nbsp;<span class="ident" id="7832332">err</span>&nbsp;<span class="op" id="7832336">!=</span>&nbsp;<span class="ident" id="7832339">nil</span>&nbsp;<span class="op" id="7832343">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832348">t</span><span class="op" id="7832349">.</span><span class="ident" id="7832350">Fatal</span><span class="op" id="7832355">(</span><span class="ident" id="7832356">err</span><span class="op" id="7832359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832367">if</span>&nbsp;<span class="builtinfunc" id="7832370">len</span><span class="op" id="7832373">(</span><span class="ident" id="7832374">srvs</span><span class="op" id="7832378">)</span>&nbsp;<span class="op" id="7832380">==</span>&nbsp;<span class="num" id="7832383">0</span>&nbsp;<span class="op" id="7832385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832390">t</span><span class="op" id="7832391">.</span><span class="ident" id="7832392">Error</span><span class="op" id="7832397">(</span><span class="string" id="7832398">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7832413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832417">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832421">if</span>&nbsp;<span class="op" id="7832424">!</span><span class="ident" id="7832425">strings</span><span class="op" id="7832432">.</span><span class="ident" id="7832433">Contains</span><span class="op" id="7832441">(</span><span class="ident" id="7832442">cname</span><span class="op" id="7832447">,</span>&nbsp;<span class="ident" id="7832449">tt</span><span class="op" id="7832451">.</span><span class="ident" id="7832452">cname</span><span class="op" id="7832457">)</span>&nbsp;<span class="op" id="7832459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832464">t</span><span class="op" id="7832465">.</span><span class="ident" id="7832466">Errorf</span><span class="op" id="7832472">(</span><span class="string" id="7832473">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7832490">,</span>&nbsp;<span class="ident" id="7832492">cname</span><span class="op" id="7832497">,</span>&nbsp;<span class="ident" id="7832499">tt</span><span class="op" id="7832501">.</span><span class="ident" id="7832502">cname</span><span class="op" id="7832507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832515">for</span>&nbsp;<span class="ident" id="7832519">_</span><span class="op" id="7832520">,</span>&nbsp;<span class="ident" id="7832522">srv</span>&nbsp;<span class="op" id="7832526">:=</span>&nbsp;<span class="keyword" id="7832529">range</span>&nbsp;<span class="ident" id="7832535">srvs</span>&nbsp;<span class="op" id="7832540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832545">if</span>&nbsp;<span class="op" id="7832548">!</span><span class="ident" id="7832549">strings</span><span class="op" id="7832556">.</span><span class="ident" id="7832557">Contains</span><span class="op" id="7832565">(</span><span class="ident" id="7832566">srv</span><span class="op" id="7832569">.</span><span class="ident" id="7832570">Target</span><span class="op" id="7832576">,</span>&nbsp;<span class="ident" id="7832578">tt</span><span class="op" id="7832580">.</span><span class="ident" id="7832581">target</span><span class="op" id="7832587">)</span>&nbsp;<span class="op" id="7832589">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832595">t</span><span class="op" id="7832596">.</span><span class="ident" id="7832597">Errorf</span><span class="op" id="7832603">(</span><span class="string" id="7832604">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="7832641">,</span>&nbsp;<span class="ident" id="7832643">srv</span><span class="op" id="7832646">,</span>&nbsp;<span class="ident" id="7832648">tt</span><span class="op" id="7832650">.</span><span class="ident" id="7832651">target</span><span class="op" id="7832657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832669">}</span><br>
<span class="lineno"></span><span class="op" id="7832671">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7832674">func</span>&nbsp;<span class="ident" id="7832679">TestLookupGmailMX</span><span class="op" id="7832696">(</span><span class="ident" id="7832697">t</span>&nbsp;<span class="op" id="7832699">*</span><span class="ident" id="7832700">testing</span><span class="op" id="7832707">.</span><span class="ident" id="7832708">T</span><span class="op" id="7832709">)</span>&nbsp;<span class="op" id="7832711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832714">if</span>&nbsp;<span class="ident" id="7832717">testing</span><span class="op" id="7832724">.</span><span class="ident" id="7832725">Short</span><span class="op" id="7832730">(</span><span class="op" id="7832731">)</span>&nbsp;<span class="op" id="7832733">||</span>&nbsp;<span class="op" id="7832736">!</span><span class="op" id="7832737">*</span><span class="ident" id="7832738">testExternal</span>&nbsp;<span class="op" id="7832751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832755">t</span><span class="op" id="7832756">.</span><span class="ident" id="7832757">Skip</span><span class="op" id="7832761">(</span><span class="string" id="7832762">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7832803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832806">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832810">mxs</span><span class="op" id="7832813">,</span>&nbsp;<span class="ident" id="7832815">err</span>&nbsp;<span class="op" id="7832819">:=</span>&nbsp;<span class="ident" id="7832822">LookupMX</span><span class="op" id="7832830">(</span><span class="string" id="7832831">&#34;gmail.com&#34;</span><span class="op" id="7832842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832845">if</span>&nbsp;<span class="ident" id="7832848">err</span>&nbsp;<span class="op" id="7832852">!=</span>&nbsp;<span class="ident" id="7832855">nil</span>&nbsp;<span class="op" id="7832859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832863">t</span><span class="op" id="7832864">.</span><span class="ident" id="7832865">Fatal</span><span class="op" id="7832870">(</span><span class="ident" id="7832871">err</span><span class="op" id="7832874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832877">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832880">if</span>&nbsp;<span class="builtinfunc" id="7832883">len</span><span class="op" id="7832886">(</span><span class="ident" id="7832887">mxs</span><span class="op" id="7832890">)</span>&nbsp;<span class="op" id="7832892">==</span>&nbsp;<span class="num" id="7832895">0</span>&nbsp;<span class="op" id="7832897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832901">t</span><span class="op" id="7832902">.</span><span class="ident" id="7832903">Error</span><span class="op" id="7832908">(</span><span class="string" id="7832909">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7832924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832930">for</span>&nbsp;<span class="ident" id="7832934">_</span><span class="op" id="7832935">,</span>&nbsp;<span class="ident" id="7832937">mx</span>&nbsp;<span class="op" id="7832940">:=</span>&nbsp;<span class="keyword" id="7832943">range</span>&nbsp;<span class="ident" id="7832949">mxs</span>&nbsp;<span class="op" id="7832953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832957">if</span>&nbsp;<span class="op" id="7832960">!</span><span class="ident" id="7832961">strings</span><span class="op" id="7832968">.</span><span class="ident" id="7832969">Contains</span><span class="op" id="7832977">(</span><span class="ident" id="7832978">mx</span><span class="op" id="7832980">.</span><span class="ident" id="7832981">Host</span><span class="op" id="7832985">,</span>&nbsp;<span class="string" id="7832987">&#34;.google.com&#34;</span><span class="op" id="7833000">)</span>&nbsp;<span class="op" id="7833002">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833007">t</span><span class="op" id="7833008">.</span><span class="ident" id="7833009">Errorf</span><span class="op" id="7833015">(</span><span class="string" id="7833016">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="7833063">,</span>&nbsp;<span class="ident" id="7833065">mx</span><span class="op" id="7833067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833074">}</span><br>
<span class="lineno"></span><span class="op" id="7833076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7833079">func</span>&nbsp;<span class="ident" id="7833084">TestLookupGmailNS</span><span class="op" id="7833101">(</span><span class="ident" id="7833102">t</span>&nbsp;<span class="op" id="7833104">*</span><span class="ident" id="7833105">testing</span><span class="op" id="7833112">.</span><span class="ident" id="7833113">T</span><span class="op" id="7833114">)</span>&nbsp;<span class="op" id="7833116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833119">if</span>&nbsp;<span class="ident" id="7833122">testing</span><span class="op" id="7833129">.</span><span class="ident" id="7833130">Short</span><span class="op" id="7833135">(</span><span class="op" id="7833136">)</span>&nbsp;<span class="op" id="7833138">||</span>&nbsp;<span class="op" id="7833141">!</span><span class="op" id="7833142">*</span><span class="ident" id="7833143">testExternal</span>&nbsp;<span class="op" id="7833156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833160">t</span><span class="op" id="7833161">.</span><span class="ident" id="7833162">Skip</span><span class="op" id="7833166">(</span><span class="string" id="7833167">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7833208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833215">nss</span><span class="op" id="7833218">,</span>&nbsp;<span class="ident" id="7833220">err</span>&nbsp;<span class="op" id="7833224">:=</span>&nbsp;<span class="ident" id="7833227">LookupNS</span><span class="op" id="7833235">(</span><span class="string" id="7833236">&#34;gmail.com&#34;</span><span class="op" id="7833247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833250">if</span>&nbsp;<span class="ident" id="7833253">err</span>&nbsp;<span class="op" id="7833257">!=</span>&nbsp;<span class="ident" id="7833260">nil</span>&nbsp;<span class="op" id="7833264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833268">t</span><span class="op" id="7833269">.</span><span class="ident" id="7833270">Fatal</span><span class="op" id="7833275">(</span><span class="ident" id="7833276">err</span><span class="op" id="7833279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833285">if</span>&nbsp;<span class="builtinfunc" id="7833288">len</span><span class="op" id="7833291">(</span><span class="ident" id="7833292">nss</span><span class="op" id="7833295">)</span>&nbsp;<span class="op" id="7833297">==</span>&nbsp;<span class="num" id="7833300">0</span>&nbsp;<span class="op" id="7833302">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833306">t</span><span class="op" id="7833307">.</span><span class="ident" id="7833308">Error</span><span class="op" id="7833313">(</span><span class="string" id="7833314">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7833329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833335">for</span>&nbsp;<span class="ident" id="7833339">_</span><span class="op" id="7833340">,</span>&nbsp;<span class="ident" id="7833342">ns</span>&nbsp;<span class="op" id="7833345">:=</span>&nbsp;<span class="keyword" id="7833348">range</span>&nbsp;<span class="ident" id="7833354">nss</span>&nbsp;<span class="op" id="7833358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833362">if</span>&nbsp;<span class="op" id="7833365">!</span><span class="ident" id="7833366">strings</span><span class="op" id="7833373">.</span><span class="ident" id="7833374">Contains</span><span class="op" id="7833382">(</span><span class="ident" id="7833383">ns</span><span class="op" id="7833385">.</span><span class="ident" id="7833386">Host</span><span class="op" id="7833390">,</span>&nbsp;<span class="string" id="7833392">&#34;.google.com&#34;</span><span class="op" id="7833405">)</span>&nbsp;<span class="op" id="7833407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833412">t</span><span class="op" id="7833413">.</span><span class="ident" id="7833414">Errorf</span><span class="op" id="7833420">(</span><span class="string" id="7833421">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="7833468">,</span>&nbsp;<span class="ident" id="7833470">ns</span><span class="op" id="7833472">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833479">}</span><br>
<span class="lineno"></span><span class="op" id="7833481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7833484">func</span>&nbsp;<span class="ident" id="7833489">TestLookupGmailTXT</span><span class="op" id="7833507">(</span><span class="ident" id="7833508">t</span>&nbsp;<span class="op" id="7833510">*</span><span class="ident" id="7833511">testing</span><span class="op" id="7833518">.</span><span class="ident" id="7833519">T</span><span class="op" id="7833520">)</span>&nbsp;<span class="op" id="7833522">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833525">if</span>&nbsp;<span class="ident" id="7833528">testing</span><span class="op" id="7833535">.</span><span class="ident" id="7833536">Short</span><span class="op" id="7833541">(</span><span class="op" id="7833542">)</span>&nbsp;<span class="op" id="7833544">||</span>&nbsp;<span class="op" id="7833547">!</span><span class="op" id="7833548">*</span><span class="ident" id="7833549">testExternal</span>&nbsp;<span class="op" id="7833562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833566">t</span><span class="op" id="7833567">.</span><span class="ident" id="7833568">Skip</span><span class="op" id="7833572">(</span><span class="string" id="7833573">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7833614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833621">txts</span><span class="op" id="7833625">,</span>&nbsp;<span class="ident" id="7833627">err</span>&nbsp;<span class="op" id="7833631">:=</span>&nbsp;<span class="ident" id="7833634">LookupTXT</span><span class="op" id="7833643">(</span><span class="string" id="7833644">&#34;gmail.com&#34;</span><span class="op" id="7833655">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833658">if</span>&nbsp;<span class="ident" id="7833661">err</span>&nbsp;<span class="op" id="7833665">!=</span>&nbsp;<span class="ident" id="7833668">nil</span>&nbsp;<span class="op" id="7833672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833676">t</span><span class="op" id="7833677">.</span><span class="ident" id="7833678">Fatal</span><span class="op" id="7833683">(</span><span class="ident" id="7833684">err</span><span class="op" id="7833687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833693">if</span>&nbsp;<span class="builtinfunc" id="7833696">len</span><span class="op" id="7833699">(</span><span class="ident" id="7833700">txts</span><span class="op" id="7833704">)</span>&nbsp;<span class="op" id="7833706">==</span>&nbsp;<span class="num" id="7833709">0</span>&nbsp;<span class="op" id="7833711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833715">t</span><span class="op" id="7833716">.</span><span class="ident" id="7833717">Error</span><span class="op" id="7833722">(</span><span class="string" id="7833723">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7833738">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833744">for</span>&nbsp;<span class="ident" id="7833748">_</span><span class="op" id="7833749">,</span>&nbsp;<span class="ident" id="7833751">txt</span>&nbsp;<span class="op" id="7833755">:=</span>&nbsp;<span class="keyword" id="7833758">range</span>&nbsp;<span class="ident" id="7833764">txts</span>&nbsp;<span class="op" id="7833769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833773">if</span>&nbsp;<span class="op" id="7833776">!</span><span class="ident" id="7833777">strings</span><span class="op" id="7833784">.</span><span class="ident" id="7833785">Contains</span><span class="op" id="7833793">(</span><span class="ident" id="7833794">txt</span><span class="op" id="7833797">,</span>&nbsp;<span class="string" id="7833799">&#34;spf&#34;</span><span class="op" id="7833804">)</span>&nbsp;<span class="op" id="7833806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833811">t</span><span class="op" id="7833812">.</span><span class="ident" id="7833813">Errorf</span><span class="op" id="7833819">(</span><span class="string" id="7833820">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="7833847">,</span>&nbsp;<span class="ident" id="7833849">txt</span><span class="op" id="7833852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833856">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833859">}</span><br>
<span class="lineno"></span><span class="op" id="7833861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7833864">var</span>&nbsp;<span class="ident" id="7833868">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="7833895">=</span>&nbsp;<span class="op" id="7833897">[</span><span class="op" id="7833898">]</span><span class="keyword" id="7833899">struct</span>&nbsp;<span class="op" id="7833906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833909">addr</span>&nbsp;<span class="builtintype" id="7833914">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833922">name</span>&nbsp;<span class="builtintype" id="7833927">string</span><br>
<span class="lineno"></span><span class="op" id="7833934">}</span><span class="op" id="7833935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833938">{</span><span class="string" id="7833939">&#34;8.8.8.8&#34;</span><span class="op" id="7833948">,</span>&nbsp;<span class="string" id="7833950">&#34;.google.com.&#34;</span><span class="op" id="7833964">}</span><span class="op" id="7833965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833968">{</span><span class="string" id="7833969">&#34;8.8.4.4&#34;</span><span class="op" id="7833978">,</span>&nbsp;<span class="string" id="7833980">&#34;.google.com.&#34;</span><span class="op" id="7833994">}</span><span class="op" id="7833995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833998">{</span><span class="string" id="7833999">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="7834021">,</span>&nbsp;<span class="string" id="7834023">&#34;.google.com.&#34;</span><span class="op" id="7834037">}</span><span class="op" id="7834038">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834041">{</span><span class="string" id="7834042">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="7834064">,</span>&nbsp;<span class="string" id="7834066">&#34;.google.com.&#34;</span><span class="op" id="7834080">}</span><span class="op" id="7834081">,</span><br>
<span class="lineno"></span><span class="op" id="7834083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7834086">func</span>&nbsp;<span class="ident" id="7834091">TestLookupGooglePublicDNSAddr</span><span class="op" id="7834120">(</span><span class="ident" id="7834121">t</span>&nbsp;<span class="op" id="7834123">*</span><span class="ident" id="7834124">testing</span><span class="op" id="7834131">.</span><span class="ident" id="7834132">T</span><span class="op" id="7834133">)</span>&nbsp;<span class="op" id="7834135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834138">if</span>&nbsp;<span class="ident" id="7834141">testing</span><span class="op" id="7834148">.</span><span class="ident" id="7834149">Short</span><span class="op" id="7834154">(</span><span class="op" id="7834155">)</span>&nbsp;<span class="op" id="7834157">||</span>&nbsp;<span class="op" id="7834160">!</span><span class="op" id="7834161">*</span><span class="ident" id="7834162">testExternal</span>&nbsp;<span class="op" id="7834175">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834179">t</span><span class="op" id="7834180">.</span><span class="ident" id="7834181">Skip</span><span class="op" id="7834185">(</span><span class="string" id="7834186">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7834227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834234">for</span>&nbsp;<span class="ident" id="7834238">_</span><span class="op" id="7834239">,</span>&nbsp;<span class="ident" id="7834241">tt</span>&nbsp;<span class="op" id="7834244">:=</span>&nbsp;<span class="keyword" id="7834247">range</span>&nbsp;<span class="ident" id="7834253">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="7834280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834284">names</span><span class="op" id="7834289">,</span>&nbsp;<span class="ident" id="7834291">err</span>&nbsp;<span class="op" id="7834295">:=</span>&nbsp;<span class="ident" id="7834298">LookupAddr</span><span class="op" id="7834308">(</span><span class="ident" id="7834309">tt</span><span class="op" id="7834311">.</span><span class="ident" id="7834312">addr</span><span class="op" id="7834316">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834320">if</span>&nbsp;<span class="ident" id="7834323">err</span>&nbsp;<span class="op" id="7834327">!=</span>&nbsp;<span class="ident" id="7834330">nil</span>&nbsp;<span class="op" id="7834334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834339">t</span><span class="op" id="7834340">.</span><span class="ident" id="7834341">Fatal</span><span class="op" id="7834346">(</span><span class="ident" id="7834347">err</span><span class="op" id="7834350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834358">if</span>&nbsp;<span class="builtinfunc" id="7834361">len</span><span class="op" id="7834364">(</span><span class="ident" id="7834365">names</span><span class="op" id="7834370">)</span>&nbsp;<span class="op" id="7834372">==</span>&nbsp;<span class="num" id="7834375">0</span>&nbsp;<span class="op" id="7834377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834382">t</span><span class="op" id="7834383">.</span><span class="ident" id="7834384">Error</span><span class="op" id="7834389">(</span><span class="string" id="7834390">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7834405">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834413">for</span>&nbsp;<span class="ident" id="7834417">_</span><span class="op" id="7834418">,</span>&nbsp;<span class="ident" id="7834420">name</span>&nbsp;<span class="op" id="7834425">:=</span>&nbsp;<span class="keyword" id="7834428">range</span>&nbsp;<span class="ident" id="7834434">names</span>&nbsp;<span class="op" id="7834440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834445">if</span>&nbsp;<span class="op" id="7834448">!</span><span class="ident" id="7834449">strings</span><span class="op" id="7834456">.</span><span class="ident" id="7834457">HasSuffix</span><span class="op" id="7834466">(</span><span class="ident" id="7834467">name</span><span class="op" id="7834471">,</span>&nbsp;<span class="ident" id="7834473">tt</span><span class="op" id="7834475">.</span><span class="ident" id="7834476">name</span><span class="op" id="7834480">)</span>&nbsp;<span class="op" id="7834482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834488">t</span><span class="op" id="7834489">.</span><span class="ident" id="7834490">Errorf</span><span class="op" id="7834496">(</span><span class="string" id="7834497">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="7834534">,</span>&nbsp;<span class="ident" id="7834536">name</span><span class="op" id="7834540">,</span>&nbsp;<span class="ident" id="7834542">tt</span><span class="op" id="7834544">.</span><span class="ident" id="7834545">name</span><span class="op" id="7834549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834554">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834561">}</span><br>
<span class="lineno"></span><span class="op" id="7834563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7834566">func</span>&nbsp;<span class="ident" id="7834571">TestLookupIANACNAME</span><span class="op" id="7834590">(</span><span class="ident" id="7834591">t</span>&nbsp;<span class="op" id="7834593">*</span><span class="ident" id="7834594">testing</span><span class="op" id="7834601">.</span><span class="ident" id="7834602">T</span><span class="op" id="7834603">)</span>&nbsp;<span class="op" id="7834605">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834608">if</span>&nbsp;<span class="ident" id="7834611">testing</span><span class="op" id="7834618">.</span><span class="ident" id="7834619">Short</span><span class="op" id="7834624">(</span><span class="op" id="7834625">)</span>&nbsp;<span class="op" id="7834627">||</span>&nbsp;<span class="op" id="7834630">!</span><span class="op" id="7834631">*</span><span class="ident" id="7834632">testExternal</span>&nbsp;<span class="op" id="7834645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834649">t</span><span class="op" id="7834650">.</span><span class="ident" id="7834651">Skip</span><span class="op" id="7834655">(</span><span class="string" id="7834656">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7834697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834704">cname</span><span class="op" id="7834709">,</span>&nbsp;<span class="ident" id="7834711">err</span>&nbsp;<span class="op" id="7834715">:=</span>&nbsp;<span class="ident" id="7834718">LookupCNAME</span><span class="op" id="7834729">(</span><span class="string" id="7834730">&#34;www.iana.org&#34;</span><span class="op" id="7834744">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834747">if</span>&nbsp;<span class="ident" id="7834750">err</span>&nbsp;<span class="op" id="7834754">!=</span>&nbsp;<span class="ident" id="7834757">nil</span>&nbsp;<span class="op" id="7834761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834765">t</span><span class="op" id="7834766">.</span><span class="ident" id="7834767">Fatal</span><span class="op" id="7834772">(</span><span class="ident" id="7834773">err</span><span class="op" id="7834776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834782">if</span>&nbsp;<span class="op" id="7834785">!</span><span class="ident" id="7834786">strings</span><span class="op" id="7834793">.</span><span class="ident" id="7834794">HasSuffix</span><span class="op" id="7834803">(</span><span class="ident" id="7834804">cname</span><span class="op" id="7834809">,</span>&nbsp;<span class="string" id="7834811">&#34;.icann.org.&#34;</span><span class="op" id="7834824">)</span>&nbsp;<span class="op" id="7834826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834830">t</span><span class="op" id="7834831">.</span><span class="ident" id="7834832">Errorf</span><span class="op" id="7834838">(</span><span class="string" id="7834839">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="7834885">,</span>&nbsp;<span class="ident" id="7834887">cname</span><span class="op" id="7834892">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834895">}</span><br>
<span class="lineno"></span><span class="op" id="7834897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7834900">func</span>&nbsp;<span class="ident" id="7834905">TestLookupGoogleHost</span><span class="op" id="7834925">(</span><span class="ident" id="7834926">t</span>&nbsp;<span class="op" id="7834928">*</span><span class="ident" id="7834929">testing</span><span class="op" id="7834936">.</span><span class="ident" id="7834937">T</span><span class="op" id="7834938">)</span>&nbsp;<span class="op" id="7834940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834943">if</span>&nbsp;<span class="ident" id="7834946">testing</span><span class="op" id="7834953">.</span><span class="ident" id="7834954">Short</span><span class="op" id="7834959">(</span><span class="op" id="7834960">)</span>&nbsp;<span class="op" id="7834962">||</span>&nbsp;<span class="op" id="7834965">!</span><span class="op" id="7834966">*</span><span class="ident" id="7834967">testExternal</span>&nbsp;<span class="op" id="7834980">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834984">t</span><span class="op" id="7834985">.</span><span class="ident" id="7834986">Skip</span><span class="op" id="7834990">(</span><span class="string" id="7834991">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7835032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835039">addrs</span><span class="op" id="7835044">,</span>&nbsp;<span class="ident" id="7835046">err</span>&nbsp;<span class="op" id="7835050">:=</span>&nbsp;<span class="ident" id="7835053">LookupHost</span><span class="op" id="7835063">(</span><span class="string" id="7835064">&#34;google.com&#34;</span><span class="op" id="7835076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835079">if</span>&nbsp;<span class="ident" id="7835082">err</span>&nbsp;<span class="op" id="7835086">!=</span>&nbsp;<span class="ident" id="7835089">nil</span>&nbsp;<span class="op" id="7835093">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835097">t</span><span class="op" id="7835098">.</span><span class="ident" id="7835099">Fatal</span><span class="op" id="7835104">(</span><span class="ident" id="7835105">err</span><span class="op" id="7835108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835114">if</span>&nbsp;<span class="builtinfunc" id="7835117">len</span><span class="op" id="7835120">(</span><span class="ident" id="7835121">addrs</span><span class="op" id="7835126">)</span>&nbsp;<span class="op" id="7835128">==</span>&nbsp;<span class="num" id="7835131">0</span>&nbsp;<span class="op" id="7835133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835137">t</span><span class="op" id="7835138">.</span><span class="ident" id="7835139">Error</span><span class="op" id="7835144">(</span><span class="string" id="7835145">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7835160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835163">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835166">for</span>&nbsp;<span class="ident" id="7835170">_</span><span class="op" id="7835171">,</span>&nbsp;<span class="ident" id="7835173">addr</span>&nbsp;<span class="op" id="7835178">:=</span>&nbsp;<span class="keyword" id="7835181">range</span>&nbsp;<span class="ident" id="7835187">addrs</span>&nbsp;<span class="op" id="7835193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835197">if</span>&nbsp;<span class="ident" id="7835200">ParseIP</span><span class="op" id="7835207">(</span><span class="ident" id="7835208">addr</span><span class="op" id="7835212">)</span>&nbsp;<span class="op" id="7835214">==</span>&nbsp;<span class="ident" id="7835217">nil</span>&nbsp;<span class="op" id="7835221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835226">t</span><span class="op" id="7835227">.</span><span class="ident" id="7835228">Errorf</span><span class="op" id="7835234">(</span><span class="string" id="7835235">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="7835270">,</span>&nbsp;<span class="ident" id="7835272">addr</span><span class="op" id="7835276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835283">}</span><br>
<span class="lineno">175</span><span class="op" id="7835285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7835288">func</span>&nbsp;<span class="ident" id="7835293">TestLookupGoogleIP</span><span class="op" id="7835311">(</span><span class="ident" id="7835312">t</span>&nbsp;<span class="op" id="7835314">*</span><span class="ident" id="7835315">testing</span><span class="op" id="7835322">.</span><span class="ident" id="7835323">T</span><span class="op" id="7835324">)</span>&nbsp;<span class="op" id="7835326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835329">if</span>&nbsp;<span class="ident" id="7835332">testing</span><span class="op" id="7835339">.</span><span class="ident" id="7835340">Short</span><span class="op" id="7835345">(</span><span class="op" id="7835346">)</span>&nbsp;<span class="op" id="7835348">||</span>&nbsp;<span class="op" id="7835351">!</span><span class="op" id="7835352">*</span><span class="ident" id="7835353">testExternal</span>&nbsp;<span class="op" id="7835366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835370">t</span><span class="op" id="7835371">.</span><span class="ident" id="7835372">Skip</span><span class="op" id="7835376">(</span><span class="string" id="7835377">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7835418">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835425">ips</span><span class="op" id="7835428">,</span>&nbsp;<span class="ident" id="7835430">err</span>&nbsp;<span class="op" id="7835434">:=</span>&nbsp;<span class="ident" id="7835437">LookupIP</span><span class="op" id="7835445">(</span><span class="string" id="7835446">&#34;google.com&#34;</span><span class="op" id="7835458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835461">if</span>&nbsp;<span class="ident" id="7835464">err</span>&nbsp;<span class="op" id="7835468">!=</span>&nbsp;<span class="ident" id="7835471">nil</span>&nbsp;<span class="op" id="7835475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835479">t</span><span class="op" id="7835480">.</span><span class="ident" id="7835481">Fatal</span><span class="op" id="7835486">(</span><span class="ident" id="7835487">err</span><span class="op" id="7835490">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835496">if</span>&nbsp;<span class="builtinfunc" id="7835499">len</span><span class="op" id="7835502">(</span><span class="ident" id="7835503">ips</span><span class="op" id="7835506">)</span>&nbsp;<span class="op" id="7835508">==</span>&nbsp;<span class="num" id="7835511">0</span>&nbsp;<span class="op" id="7835513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835517">t</span><span class="op" id="7835518">.</span><span class="ident" id="7835519">Error</span><span class="op" id="7835524">(</span><span class="string" id="7835525">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="7835540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835546">for</span>&nbsp;<span class="ident" id="7835550">_</span><span class="op" id="7835551">,</span>&nbsp;<span class="ident" id="7835553">ip</span>&nbsp;<span class="op" id="7835556">:=</span>&nbsp;<span class="keyword" id="7835559">range</span>&nbsp;<span class="ident" id="7835565">ips</span>&nbsp;<span class="op" id="7835569">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7835573">if</span>&nbsp;<span class="ident" id="7835576">ip</span><span class="op" id="7835578">.</span><span class="ident" id="7835579">To4</span><span class="op" id="7835582">(</span><span class="op" id="7835583">)</span>&nbsp;<span class="op" id="7835585">==</span>&nbsp;<span class="ident" id="7835588">nil</span>&nbsp;<span class="op" id="7835592">&amp;&amp;</span>&nbsp;<span class="ident" id="7835595">ip</span><span class="op" id="7835597">.</span><span class="ident" id="7835598">To16</span><span class="op" id="7835602">(</span><span class="op" id="7835603">)</span>&nbsp;<span class="op" id="7835605">==</span>&nbsp;<span class="ident" id="7835608">nil</span>&nbsp;<span class="op" id="7835612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835617">t</span><span class="op" id="7835618">.</span><span class="ident" id="7835619">Errorf</span><span class="op" id="7835625">(</span><span class="string" id="7835626">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="7835654">,</span>&nbsp;<span class="ident" id="7835656">ip</span><span class="op" id="7835658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835665">}</span><br>
<span class="lineno"></span><span class="op" id="7835667">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="7835670">var</span>&nbsp;<span class="ident" id="7835674">revAddrTests</span>&nbsp;<span class="op" id="7835687">=</span>&nbsp;<span class="op" id="7835689">[</span><span class="op" id="7835690">]</span><span class="keyword" id="7835691">struct</span>&nbsp;<span class="op" id="7835698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835701">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7835711">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835719">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7835729">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7835737">ErrPrefix</span>&nbsp;<span class="builtintype" id="7835747">string</span><br>
<span class="lineno">200</span><span class="op" id="7835754">}</span><span class="op" id="7835755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835758">{</span><span class="string" id="7835759">&#34;1.2.3.4&#34;</span><span class="op" id="7835768">,</span>&nbsp;<span class="string" id="7835770">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="7835793">,</span>&nbsp;<span class="string" id="7835795">&#34;&#34;</span><span class="op" id="7835797">}</span><span class="op" id="7835798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835801">{</span><span class="string" id="7835802">&#34;245.110.36.114&#34;</span><span class="op" id="7835818">,</span>&nbsp;<span class="string" id="7835820">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="7835850">,</span>&nbsp;<span class="string" id="7835852">&#34;&#34;</span><span class="op" id="7835854">}</span><span class="op" id="7835855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835858">{</span><span class="string" id="7835859">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="7835879">,</span>&nbsp;<span class="string" id="7835881">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="7835908">,</span>&nbsp;<span class="string" id="7835910">&#34;&#34;</span><span class="op" id="7835912">}</span><span class="op" id="7835913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7835916">{</span><span class="string" id="7835917">&#34;::1&#34;</span><span class="op" id="7835922">,</span>&nbsp;<span class="string" id="7835924">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="7835999">,</span>&nbsp;<span class="string" id="7836001">&#34;&#34;</span><span class="op" id="7836003">}</span><span class="op" id="7836004">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836007">{</span><span class="string" id="7836008">&#34;1::&#34;</span><span class="op" id="7836013">,</span>&nbsp;<span class="string" id="7836015">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="7836090">,</span>&nbsp;<span class="string" id="7836092">&#34;&#34;</span><span class="op" id="7836094">}</span><span class="op" id="7836095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836098">{</span><span class="string" id="7836099">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="7836119">,</span>&nbsp;<span class="string" id="7836121">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="7836196">,</span>&nbsp;<span class="string" id="7836198">&#34;&#34;</span><span class="op" id="7836200">}</span><span class="op" id="7836201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836204">{</span><span class="string" id="7836205">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="7836244">,</span>&nbsp;<span class="string" id="7836246">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="7836321">,</span>&nbsp;<span class="string" id="7836323">&#34;&#34;</span><span class="op" id="7836325">}</span><span class="op" id="7836326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836329">{</span><span class="string" id="7836330">&#34;1.2.3&#34;</span><span class="op" id="7836337">,</span>&nbsp;<span class="string" id="7836339">&#34;&#34;</span><span class="op" id="7836341">,</span>&nbsp;<span class="string" id="7836343">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7836365">}</span><span class="op" id="7836366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836369">{</span><span class="string" id="7836370">&#34;1.2.3.4.5&#34;</span><span class="op" id="7836381">,</span>&nbsp;<span class="string" id="7836383">&#34;&#34;</span><span class="op" id="7836385">,</span>&nbsp;<span class="string" id="7836387">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7836409">}</span><span class="op" id="7836410">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836413">{</span><span class="string" id="7836414">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="7836440">,</span>&nbsp;<span class="string" id="7836442">&#34;&#34;</span><span class="op" id="7836444">,</span>&nbsp;<span class="string" id="7836446">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7836468">}</span><span class="op" id="7836469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836472">{</span><span class="string" id="7836473">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="7836504">,</span>&nbsp;<span class="string" id="7836506">&#34;&#34;</span><span class="op" id="7836508">,</span>&nbsp;<span class="string" id="7836510">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="7836532">}</span><span class="op" id="7836533">,</span><br>
<span class="lineno"></span><span class="op" id="7836535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7836538">func</span>&nbsp;<span class="ident" id="7836543">TestReverseAddress</span><span class="op" id="7836561">(</span><span class="ident" id="7836562">t</span>&nbsp;<span class="op" id="7836564">*</span><span class="ident" id="7836565">testing</span><span class="op" id="7836572">.</span><span class="ident" id="7836573">T</span><span class="op" id="7836574">)</span>&nbsp;<span class="op" id="7836576">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836579">for</span>&nbsp;<span class="ident" id="7836583">i</span><span class="op" id="7836584">,</span>&nbsp;<span class="ident" id="7836586">tt</span>&nbsp;<span class="op" id="7836589">:=</span>&nbsp;<span class="keyword" id="7836592">range</span>&nbsp;<span class="ident" id="7836598">revAddrTests</span>&nbsp;<span class="op" id="7836611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836615">a</span><span class="op" id="7836616">,</span>&nbsp;<span class="ident" id="7836618">err</span>&nbsp;<span class="op" id="7836622">:=</span>&nbsp;<span class="ident" id="7836625">reverseaddr</span><span class="op" id="7836636">(</span><span class="ident" id="7836637">tt</span><span class="op" id="7836639">.</span><span class="ident" id="7836640">Addr</span><span class="op" id="7836644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836648">if</span>&nbsp;<span class="builtinfunc" id="7836651">len</span><span class="op" id="7836654">(</span><span class="ident" id="7836655">tt</span><span class="op" id="7836657">.</span><span class="ident" id="7836658">ErrPrefix</span><span class="op" id="7836667">)</span>&nbsp;<span class="op" id="7836669">&gt;</span>&nbsp;<span class="num" id="7836671">0</span>&nbsp;<span class="op" id="7836673">&amp;&amp;</span>&nbsp;<span class="ident" id="7836676">err</span>&nbsp;<span class="op" id="7836680">==</span>&nbsp;<span class="ident" id="7836683">nil</span>&nbsp;<span class="op" id="7836687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836692">t</span><span class="op" id="7836693">.</span><span class="ident" id="7836694">Errorf</span><span class="op" id="7836700">(</span><span class="string" id="7836701">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="7836738">,</span>&nbsp;<span class="ident" id="7836740">i</span><span class="op" id="7836741">,</span>&nbsp;<span class="ident" id="7836743">tt</span><span class="op" id="7836745">.</span><span class="ident" id="7836746">ErrPrefix</span><span class="op" id="7836755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836760">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836775">if</span>&nbsp;<span class="builtinfunc" id="7836778">len</span><span class="op" id="7836781">(</span><span class="ident" id="7836782">tt</span><span class="op" id="7836784">.</span><span class="ident" id="7836785">ErrPrefix</span><span class="op" id="7836794">)</span>&nbsp;<span class="op" id="7836796">==</span>&nbsp;<span class="num" id="7836799">0</span>&nbsp;<span class="op" id="7836801">&amp;&amp;</span>&nbsp;<span class="ident" id="7836804">err</span>&nbsp;<span class="op" id="7836808">!=</span>&nbsp;<span class="ident" id="7836811">nil</span>&nbsp;<span class="op" id="7836815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836820">t</span><span class="op" id="7836821">.</span><span class="ident" id="7836822">Errorf</span><span class="op" id="7836828">(</span><span class="string" id="7836829">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="7836866">,</span>&nbsp;<span class="ident" id="7836868">i</span><span class="op" id="7836869">,</span>&nbsp;<span class="ident" id="7836871">err</span><span class="op" id="7836874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7836878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7836882">if</span>&nbsp;<span class="ident" id="7836885">err</span>&nbsp;<span class="op" id="7836889">!=</span>&nbsp;<span class="ident" id="7836892">nil</span>&nbsp;<span class="op" id="7836896">&amp;&amp;</span>&nbsp;<span class="ident" id="7836899">err</span><span class="op" id="7836902">.</span><span class="op" id="7836903">(</span><span class="op" id="7836904">*</span><span class="ident" id="7836905">DNSError</span><span class="op" id="7836913">)</span><span class="op" id="7836914">.</span><span class="ident" id="7836915">Err</span>&nbsp;<span class="op" id="7836919">!=</span>&nbsp;<span class="ident" id="7836922">tt</span><span class="op" id="7836924">.</span><span class="ident" id="7836925">ErrPrefix</span>&nbsp;<span class="op" id="7836935">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7836940">t</span><span class="op" id="7836941">.</span><span class="ident" id="7836942">Errorf</span><span class="op" id="7836948">(</span><span class="string" id="7836949">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="7836994">,</span>&nbsp;<span class="ident" id="7836996">i</span><span class="op" id="7836997">,</span>&nbsp;<span class="ident" id="7836999">tt</span><span class="op" id="7837001">.</span><span class="ident" id="7837002">ErrPrefix</span><span class="op" id="7837011">,</span>&nbsp;<span class="ident" id="7837013">err</span><span class="op" id="7837016">.</span><span class="op" id="7837017">(</span><span class="op" id="7837018">*</span><span class="ident" id="7837019">DNSError</span><span class="op" id="7837027">)</span><span class="op" id="7837028">.</span><span class="ident" id="7837029">Err</span><span class="op" id="7837032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7837040">if</span>&nbsp;<span class="ident" id="7837043">a</span>&nbsp;<span class="op" id="7837045">!=</span>&nbsp;<span class="ident" id="7837048">tt</span><span class="op" id="7837050">.</span><span class="ident" id="7837051">Reverse</span>&nbsp;<span class="op" id="7837059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7837064">t</span><span class="op" id="7837065">.</span><span class="ident" id="7837066">Errorf</span><span class="op" id="7837072">(</span><span class="string" id="7837073">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="7837117">,</span>&nbsp;<span class="ident" id="7837119">i</span><span class="op" id="7837120">,</span>&nbsp;<span class="ident" id="7837122">tt</span><span class="op" id="7837124">.</span><span class="ident" id="7837125">Reverse</span><span class="op" id="7837132">,</span>&nbsp;<span class="ident" id="7837134">a</span><span class="op" id="7837135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837139">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7837142">}</span><br>
<span class="lineno"></span><span class="op" id="7837144">}</span>
</div>
</body>
</html>
