<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8448039">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8448094">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8448148">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8448199">package</span>&nbsp;<span class="ident" id="8448207">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448215">import</span>&nbsp;<span class="op" id="8448222">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448225">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448231">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448248">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8448258">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8448268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8448271">func</span>&nbsp;<span class="ident" id="8448276">TestTempFile</span><span class="op" id="8448288">(</span><span class="ident" id="8448289">t</span>&nbsp;<span class="op" id="8448291">*</span><span class="ident" id="8448292">testing</span><span class="op" id="8448299">.</span><span class="ident" id="8448300">T</span><span class="op" id="8448301">)</span>&nbsp;<span class="op" id="8448303">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448306">f</span><span class="op" id="8448307">,</span>&nbsp;<span class="ident" id="8448309">err</span>&nbsp;<span class="op" id="8448313">:=</span>&nbsp;<span class="ident" id="8448316">TempFile</span><span class="op" id="8448324">(</span><span class="string" id="8448325">&#34;/_not_exists_&#34;</span><span class="op" id="8448340">,</span>&nbsp;<span class="string" id="8448342">&#34;foo&#34;</span><span class="op" id="8448347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448350">if</span>&nbsp;<span class="ident" id="8448353">f</span>&nbsp;<span class="op" id="8448355">!=</span>&nbsp;<span class="ident" id="8448358">nil</span>&nbsp;<span class="op" id="8448362">||</span>&nbsp;<span class="ident" id="8448365">err</span>&nbsp;<span class="op" id="8448369">==</span>&nbsp;<span class="ident" id="8448372">nil</span>&nbsp;<span class="op" id="8448376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448380">t</span><span class="op" id="8448381">.</span><span class="ident" id="8448382">Errorf</span><span class="op" id="8448388">(</span><span class="string" id="8448389">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8448432">,</span>&nbsp;<span class="ident" id="8448434">f</span><span class="op" id="8448435">,</span>&nbsp;<span class="ident" id="8448437">err</span><span class="op" id="8448440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448447">dir</span>&nbsp;<span class="op" id="8448451">:=</span>&nbsp;<span class="ident" id="8448454">os</span><span class="op" id="8448456">.</span><span class="ident" id="8448457">TempDir</span><span class="op" id="8448464">(</span><span class="op" id="8448465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448468">f</span><span class="op" id="8448469">,</span>&nbsp;<span class="ident" id="8448471">err</span>&nbsp;<span class="op" id="8448475">=</span>&nbsp;<span class="ident" id="8448477">TempFile</span><span class="op" id="8448485">(</span><span class="ident" id="8448486">dir</span><span class="op" id="8448489">,</span>&nbsp;<span class="string" id="8448491">&#34;ioutil_test&#34;</span><span class="op" id="8448504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448507">if</span>&nbsp;<span class="ident" id="8448510">f</span>&nbsp;<span class="op" id="8448512">==</span>&nbsp;<span class="ident" id="8448515">nil</span>&nbsp;<span class="op" id="8448519">||</span>&nbsp;<span class="ident" id="8448522">err</span>&nbsp;<span class="op" id="8448526">!=</span>&nbsp;<span class="ident" id="8448529">nil</span>&nbsp;<span class="op" id="8448533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448537">t</span><span class="op" id="8448538">.</span><span class="ident" id="8448539">Errorf</span><span class="op" id="8448545">(</span><span class="string" id="8448546">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8448585">,</span>&nbsp;<span class="ident" id="8448587">f</span><span class="op" id="8448588">,</span>&nbsp;<span class="ident" id="8448590">err</span><span class="op" id="8448593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448596">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448599">if</span>&nbsp;<span class="ident" id="8448602">f</span>&nbsp;<span class="op" id="8448604">!=</span>&nbsp;<span class="ident" id="8448607">nil</span>&nbsp;<span class="op" id="8448611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448615">f</span><span class="op" id="8448616">.</span><span class="ident" id="8448617">Close</span><span class="op" id="8448622">(</span><span class="op" id="8448623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448627">os</span><span class="op" id="8448629">.</span><span class="ident" id="8448630">Remove</span><span class="op" id="8448636">(</span><span class="ident" id="8448637">f</span><span class="op" id="8448638">.</span><span class="ident" id="8448639">Name</span><span class="op" id="8448643">(</span><span class="op" id="8448644">)</span><span class="op" id="8448645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448649">re</span>&nbsp;<span class="op" id="8448652">:=</span>&nbsp;<span class="ident" id="8448655">regexp</span><span class="op" id="8448661">.</span><span class="ident" id="8448662">MustCompile</span><span class="op" id="8448673">(</span><span class="string" id="8448674">&#34;^&#34;</span>&nbsp;<span class="op" id="8448678">+</span>&nbsp;<span class="ident" id="8448680">regexp</span><span class="op" id="8448686">.</span><span class="ident" id="8448687">QuoteMeta</span><span class="op" id="8448696">(</span><span class="ident" id="8448697">filepath</span><span class="op" id="8448705">.</span><span class="ident" id="8448706">Join</span><span class="op" id="8448710">(</span><span class="ident" id="8448711">dir</span><span class="op" id="8448714">,</span>&nbsp;<span class="string" id="8448716">&#34;ioutil_test&#34;</span><span class="op" id="8448729">)</span><span class="op" id="8448730">)</span>&nbsp;<span class="op" id="8448732">+</span>&nbsp;<span class="string" id="8448734">&#34;[0-9]+$&#34;</span><span class="op" id="8448743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448747">if</span>&nbsp;<span class="op" id="8448750">!</span><span class="ident" id="8448751">re</span><span class="op" id="8448753">.</span><span class="ident" id="8448754">MatchString</span><span class="op" id="8448765">(</span><span class="ident" id="8448766">f</span><span class="op" id="8448767">.</span><span class="ident" id="8448768">Name</span><span class="op" id="8448772">(</span><span class="op" id="8448773">)</span><span class="op" id="8448774">)</span>&nbsp;<span class="op" id="8448776">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448781">t</span><span class="op" id="8448782">.</span><span class="ident" id="8448783">Errorf</span><span class="op" id="8448789">(</span><span class="string" id="8448790">&#34;TempFile(`&#34;</span><span class="op" id="8448802">+</span><span class="ident" id="8448803">dir</span><span class="op" id="8448806">+</span><span class="string" id="8448807">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="8448846">,</span>&nbsp;<span class="ident" id="8448848">f</span><span class="op" id="8448849">.</span><span class="ident" id="8448850">Name</span><span class="op" id="8448854">(</span><span class="op" id="8448855">)</span><span class="op" id="8448856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8448863">}</span><br>
<span class="lineno"></span><span class="op" id="8448865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8448868">func</span>&nbsp;<span class="ident" id="8448873">TestTempDir</span><span class="op" id="8448884">(</span><span class="ident" id="8448885">t</span>&nbsp;<span class="op" id="8448887">*</span><span class="ident" id="8448888">testing</span><span class="op" id="8448895">.</span><span class="ident" id="8448896">T</span><span class="op" id="8448897">)</span>&nbsp;<span class="op" id="8448899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448902">name</span><span class="op" id="8448906">,</span>&nbsp;<span class="ident" id="8448908">err</span>&nbsp;<span class="op" id="8448912">:=</span>&nbsp;<span class="ident" id="8448915">TempDir</span><span class="op" id="8448922">(</span><span class="string" id="8448923">&#34;/_not_exists_&#34;</span><span class="op" id="8448938">,</span>&nbsp;<span class="string" id="8448940">&#34;foo&#34;</span><span class="op" id="8448945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8448948">if</span>&nbsp;<span class="ident" id="8448951">name</span>&nbsp;<span class="op" id="8448956">!=</span>&nbsp;<span class="string" id="8448959">&#34;&#34;</span>&nbsp;<span class="op" id="8448962">||</span>&nbsp;<span class="ident" id="8448965">err</span>&nbsp;<span class="op" id="8448969">==</span>&nbsp;<span class="ident" id="8448972">nil</span>&nbsp;<span class="op" id="8448976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8448980">t</span><span class="op" id="8448981">.</span><span class="ident" id="8448982">Errorf</span><span class="op" id="8448988">(</span><span class="string" id="8448989">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8449031">,</span>&nbsp;<span class="ident" id="8449033">name</span><span class="op" id="8449037">,</span>&nbsp;<span class="ident" id="8449039">err</span><span class="op" id="8449042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449045">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449049">dir</span>&nbsp;<span class="op" id="8449053">:=</span>&nbsp;<span class="ident" id="8449056">os</span><span class="op" id="8449058">.</span><span class="ident" id="8449059">TempDir</span><span class="op" id="8449066">(</span><span class="op" id="8449067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449070">name</span><span class="op" id="8449074">,</span>&nbsp;<span class="ident" id="8449076">err</span>&nbsp;<span class="op" id="8449080">=</span>&nbsp;<span class="ident" id="8449082">TempDir</span><span class="op" id="8449089">(</span><span class="ident" id="8449090">dir</span><span class="op" id="8449093">,</span>&nbsp;<span class="string" id="8449095">&#34;ioutil_test&#34;</span><span class="op" id="8449108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449111">if</span>&nbsp;<span class="ident" id="8449114">name</span>&nbsp;<span class="op" id="8449119">==</span>&nbsp;<span class="string" id="8449122">&#34;&#34;</span>&nbsp;<span class="op" id="8449125">||</span>&nbsp;<span class="ident" id="8449128">err</span>&nbsp;<span class="op" id="8449132">!=</span>&nbsp;<span class="ident" id="8449135">nil</span>&nbsp;<span class="op" id="8449139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449143">t</span><span class="op" id="8449144">.</span><span class="ident" id="8449145">Errorf</span><span class="op" id="8449151">(</span><span class="string" id="8449152">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8449190">,</span>&nbsp;<span class="ident" id="8449192">name</span><span class="op" id="8449196">,</span>&nbsp;<span class="ident" id="8449198">err</span><span class="op" id="8449201">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449207">if</span>&nbsp;<span class="ident" id="8449210">name</span>&nbsp;<span class="op" id="8449215">!=</span>&nbsp;<span class="string" id="8449218">&#34;&#34;</span>&nbsp;<span class="op" id="8449221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449225">os</span><span class="op" id="8449227">.</span><span class="ident" id="8449228">Remove</span><span class="op" id="8449234">(</span><span class="ident" id="8449235">name</span><span class="op" id="8449239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449243">re</span>&nbsp;<span class="op" id="8449246">:=</span>&nbsp;<span class="ident" id="8449249">regexp</span><span class="op" id="8449255">.</span><span class="ident" id="8449256">MustCompile</span><span class="op" id="8449267">(</span><span class="string" id="8449268">&#34;^&#34;</span>&nbsp;<span class="op" id="8449272">+</span>&nbsp;<span class="ident" id="8449274">regexp</span><span class="op" id="8449280">.</span><span class="ident" id="8449281">QuoteMeta</span><span class="op" id="8449290">(</span><span class="ident" id="8449291">filepath</span><span class="op" id="8449299">.</span><span class="ident" id="8449300">Join</span><span class="op" id="8449304">(</span><span class="ident" id="8449305">dir</span><span class="op" id="8449308">,</span>&nbsp;<span class="string" id="8449310">&#34;ioutil_test&#34;</span><span class="op" id="8449323">)</span><span class="op" id="8449324">)</span>&nbsp;<span class="op" id="8449326">+</span>&nbsp;<span class="string" id="8449328">&#34;[0-9]+$&#34;</span><span class="op" id="8449337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449341">if</span>&nbsp;<span class="op" id="8449344">!</span><span class="ident" id="8449345">re</span><span class="op" id="8449347">.</span><span class="ident" id="8449348">MatchString</span><span class="op" id="8449359">(</span><span class="ident" id="8449360">name</span><span class="op" id="8449364">)</span>&nbsp;<span class="op" id="8449366">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449371">t</span><span class="op" id="8449372">.</span><span class="ident" id="8449373">Errorf</span><span class="op" id="8449379">(</span><span class="string" id="8449380">&#34;TempDir(`&#34;</span><span class="op" id="8449391">+</span><span class="ident" id="8449392">dir</span><span class="op" id="8449395">+</span><span class="string" id="8449396">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="8449435">,</span>&nbsp;<span class="ident" id="8449437">name</span><span class="op" id="8449441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449448">}</span><br>
<span class="lineno"></span><span class="op" id="8449450">}</span>
</div>
</body>
</html>
