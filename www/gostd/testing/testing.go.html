<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html" class="current">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5677985">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5678040">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5678094">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5678145">//&nbsp;Package&nbsp;testing&nbsp;provides&nbsp;support&nbsp;for&nbsp;automated&nbsp;testing&nbsp;of&nbsp;Go&nbsp;packages.</span><br>
<span class="lineno"></span><span class="comment" id="5678219">//&nbsp;It&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;in&nbsp;concert&nbsp;with&nbsp;the&nbsp;``go&nbsp;test&#39;&#39;&nbsp;command,&nbsp;which&nbsp;automates</span><br>
<span class="lineno"></span><span class="comment" id="5678305">//&nbsp;execution&nbsp;of&nbsp;any&nbsp;function&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="5678346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestXxx(*testing.T)</span><br>
<span class="lineno"></span><span class="comment" id="5678378">//&nbsp;where&nbsp;Xxx&nbsp;can&nbsp;be&nbsp;any&nbsp;alphanumeric&nbsp;string&nbsp;(but&nbsp;the&nbsp;first&nbsp;letter&nbsp;must&nbsp;not&nbsp;be&nbsp;in</span><br>
<span class="lineno">10</span><span class="comment" id="5678459">//&nbsp;[a-z])&nbsp;and&nbsp;serves&nbsp;to&nbsp;identify&nbsp;the&nbsp;test&nbsp;routine.</span><br>
<span class="lineno"></span><span class="comment" id="5678510">//</span><br>
<span class="lineno"></span><span class="comment" id="5678513">//&nbsp;Within&nbsp;these&nbsp;functions,&nbsp;use&nbsp;the&nbsp;Error,&nbsp;Fail&nbsp;or&nbsp;related&nbsp;methods&nbsp;to&nbsp;signal&nbsp;failure.</span><br>
<span class="lineno"></span><span class="comment" id="5678598">//</span><br>
<span class="lineno"></span><span class="comment" id="5678601">//&nbsp;To&nbsp;write&nbsp;a&nbsp;new&nbsp;test&nbsp;suite,&nbsp;create&nbsp;a&nbsp;file&nbsp;whose&nbsp;name&nbsp;ends&nbsp;_test.go&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5678675">//&nbsp;contains&nbsp;the&nbsp;TestXxx&nbsp;functions&nbsp;as&nbsp;described&nbsp;here.&nbsp;Put&nbsp;the&nbsp;file&nbsp;in&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="5678753">//&nbsp;package&nbsp;as&nbsp;the&nbsp;one&nbsp;being&nbsp;tested.&nbsp;The&nbsp;file&nbsp;will&nbsp;be&nbsp;excluded&nbsp;from&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="5678828">//&nbsp;package&nbsp;builds&nbsp;but&nbsp;will&nbsp;be&nbsp;included&nbsp;when&nbsp;the&nbsp;``go&nbsp;test&#39;&#39;&nbsp;command&nbsp;is&nbsp;run.</span><br>
<span class="lineno"></span><span class="comment" id="5678904">//&nbsp;For&nbsp;more&nbsp;detail,&nbsp;run&nbsp;``go&nbsp;help&nbsp;test&#39;&#39;&nbsp;and&nbsp;``go&nbsp;help&nbsp;testflag&#39;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="5678971">//</span><br>
<span class="lineno">20</span><span class="comment" id="5678974">//&nbsp;Tests&nbsp;and&nbsp;benchmarks&nbsp;may&nbsp;be&nbsp;skipped&nbsp;if&nbsp;not&nbsp;applicable&nbsp;with&nbsp;a&nbsp;call&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5679046">//&nbsp;the&nbsp;Skip&nbsp;method&nbsp;of&nbsp;*T&nbsp;and&nbsp;*B:</span><br>
<span class="lineno"></span><span class="comment" id="5679079">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestTimeConsuming(t&nbsp;*testing.T)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5679125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;testing.Short()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5679157">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.Skip(&#34;skipping&nbsp;test&nbsp;in&nbsp;short&nbsp;mode.&#34;)</span><br>
<span class="lineno">25</span><span class="comment" id="5679211">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5679224">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="5679239">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5679248">//</span><br>
<span class="lineno"></span><span class="comment" id="5679251">//&nbsp;Benchmarks</span><br>
<span class="lineno">30</span><span class="comment" id="5679265">//</span><br>
<span class="lineno"></span><span class="comment" id="5679268">//&nbsp;Functions&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="5679293">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkXxx(*testing.B)</span><br>
<span class="lineno"></span><span class="comment" id="5679330">//&nbsp;are&nbsp;considered&nbsp;benchmarks,&nbsp;and&nbsp;are&nbsp;executed&nbsp;by&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5679407">//&nbsp;its&nbsp;-bench&nbsp;flag&nbsp;is&nbsp;provided.&nbsp;Benchmarks&nbsp;are&nbsp;run&nbsp;sequentially.</span><br>
<span class="lineno">35</span><span class="comment" id="5679472">//</span><br>
<span class="lineno"></span><span class="comment" id="5679475">//&nbsp;For&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;testing&nbsp;flags,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="5679522">//&nbsp;http://golang.org/cmd/go/#hdr-Description_of_testing_flags.</span><br>
<span class="lineno"></span><span class="comment" id="5679585">//</span><br>
<span class="lineno"></span><span class="comment" id="5679588">//&nbsp;A&nbsp;sample&nbsp;benchmark&nbsp;function&nbsp;looks&nbsp;like&nbsp;this:</span><br>
<span class="lineno">40</span><span class="comment" id="5679636">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkHello(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5679679">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;b.N;&nbsp;i++&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5679717">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Sprintf(&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5679753">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5679766">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">45</span><span class="comment" id="5679775">//</span><br>
<span class="lineno"></span><span class="comment" id="5679778">//&nbsp;The&nbsp;benchmark&nbsp;function&nbsp;must&nbsp;run&nbsp;the&nbsp;target&nbsp;code&nbsp;b.N&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="5679840">//&nbsp;During&nbsp;benchark&nbsp;execution,&nbsp;b.N&nbsp;is&nbsp;adjusted&nbsp;until&nbsp;the&nbsp;benchmark&nbsp;function&nbsp;lasts</span><br>
<span class="lineno"></span><span class="comment" id="5679921">//&nbsp;long&nbsp;enough&nbsp;to&nbsp;be&nbsp;timed&nbsp;reliably.&nbsp;&nbsp;The&nbsp;output</span><br>
<span class="lineno"></span><span class="comment" id="5679970">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BenchmarkHello&nbsp;&nbsp;&nbsp;&nbsp;10000000&nbsp;&nbsp;&nbsp;&nbsp;282&nbsp;ns/op</span><br>
<span class="lineno">50</span><span class="comment" id="5680017">//&nbsp;means&nbsp;that&nbsp;the&nbsp;loop&nbsp;ran&nbsp;10000000&nbsp;times&nbsp;at&nbsp;a&nbsp;speed&nbsp;of&nbsp;282&nbsp;ns&nbsp;per&nbsp;loop.</span><br>
<span class="lineno"></span><span class="comment" id="5680090">//</span><br>
<span class="lineno"></span><span class="comment" id="5680093">//&nbsp;If&nbsp;a&nbsp;benchmark&nbsp;needs&nbsp;some&nbsp;expensive&nbsp;setup&nbsp;before&nbsp;running,&nbsp;the&nbsp;timer</span><br>
<span class="lineno"></span><span class="comment" id="5680164">//&nbsp;may&nbsp;be&nbsp;reset:</span><br>
<span class="lineno"></span><span class="comment" id="5680181">//</span><br>
<span class="lineno">55</span><span class="comment" id="5680184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkBigLen(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5680228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;big&nbsp;:=&nbsp;NewBig()</span><br>
<span class="lineno"></span><span class="comment" id="5680255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.ResetTimer()</span><br>
<span class="lineno"></span><span class="comment" id="5680281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;b.N;&nbsp;i++&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5680319">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;big.Len()</span><br>
<span class="lineno">60</span><span class="comment" id="5680344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5680357">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5680366">//</span><br>
<span class="lineno"></span><span class="comment" id="5680369">//&nbsp;If&nbsp;a&nbsp;benchmark&nbsp;needs&nbsp;to&nbsp;test&nbsp;performance&nbsp;in&nbsp;a&nbsp;parallel&nbsp;setting,&nbsp;it&nbsp;may&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="5680447">//&nbsp;the&nbsp;RunParallel&nbsp;helper&nbsp;function;&nbsp;such&nbsp;benchmarks&nbsp;are&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;with</span><br>
<span class="lineno">65</span><span class="comment" id="5680528">//&nbsp;the&nbsp;go&nbsp;test&nbsp;-cpu&nbsp;flag:</span><br>
<span class="lineno"></span><span class="comment" id="5680554">//</span><br>
<span class="lineno"></span><span class="comment" id="5680557">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkTemplateParallel(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5680611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;templ&nbsp;:=&nbsp;template.Must(template.New(&#34;test&#34;).Parse(&#34;Hello,&nbsp;{{.}}!&#34;))</span><br>
<span class="lineno"></span><span class="comment" id="5680690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.RunParallel(func(pb&nbsp;*testing.PB)&nbsp;{</span><br>
<span class="lineno">70</span><span class="comment" id="5680738">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;buf&nbsp;bytes.Buffer</span><br>
<span class="lineno"></span><span class="comment" id="5680774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pb.Next()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5680805">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf.Reset()</span><br>
<span class="lineno"></span><span class="comment" id="5680836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;templ.Execute(&amp;buf,&nbsp;&#34;World&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5680884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">75</span><span class="comment" id="5680901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><br>
<span class="lineno"></span><span class="comment" id="5680915">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5680924">//</span><br>
<span class="lineno"></span><span class="comment" id="5680927">//&nbsp;Examples</span><br>
<span class="lineno"></span><span class="comment" id="5680939">//</span><br>
<span class="lineno">80</span><span class="comment" id="5680942">//&nbsp;The&nbsp;package&nbsp;also&nbsp;runs&nbsp;and&nbsp;verifies&nbsp;example&nbsp;code.&nbsp;Example&nbsp;functions&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="5681016">//&nbsp;include&nbsp;a&nbsp;concluding&nbsp;line&nbsp;comment&nbsp;that&nbsp;begins&nbsp;with&nbsp;&#34;Output:&#34;&nbsp;and&nbsp;is&nbsp;compared&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5681101">//&nbsp;the&nbsp;standard&nbsp;output&nbsp;of&nbsp;the&nbsp;function&nbsp;when&nbsp;the&nbsp;tests&nbsp;are&nbsp;run.&nbsp;(The&nbsp;comparison</span><br>
<span class="lineno"></span><span class="comment" id="5681180">//&nbsp;ignores&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;space.)&nbsp;These&nbsp;are&nbsp;examples&nbsp;of&nbsp;an&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="5681254">//</span><br>
<span class="lineno">85</span><span class="comment" id="5681257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleHello()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5681286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5681322">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:&nbsp;hello</span><br>
<span class="lineno"></span><span class="comment" id="5681354">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5681363">//</span><br>
<span class="lineno">90</span><span class="comment" id="5681366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleSalutations()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5681401">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;hello,&nbsp;and&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5681442">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;goodbye&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5681480">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:</span><br>
<span class="lineno"></span><span class="comment" id="5681506">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;hello,&nbsp;and</span><br>
<span class="lineno">95</span><span class="comment" id="5681535">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;goodbye</span><br>
<span class="lineno"></span><span class="comment" id="5681561">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5681570">//</span><br>
<span class="lineno"></span><span class="comment" id="5681573">//&nbsp;Example&nbsp;functions&nbsp;without&nbsp;output&nbsp;comments&nbsp;are&nbsp;compiled&nbsp;but&nbsp;not&nbsp;executed.</span><br>
<span class="lineno"></span><span class="comment" id="5681649">//</span><br>
<span class="lineno">100</span><span class="comment" id="5681652">//&nbsp;The&nbsp;naming&nbsp;convention&nbsp;to&nbsp;declare&nbsp;examples&nbsp;for&nbsp;the&nbsp;package,&nbsp;a&nbsp;function&nbsp;F,&nbsp;a&nbsp;type&nbsp;T&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5681741">//&nbsp;method&nbsp;M&nbsp;on&nbsp;type&nbsp;T&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="5681768">//</span><br>
<span class="lineno"></span><span class="comment" id="5681771">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;Example()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5681801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleF()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno">105</span><span class="comment" id="5681832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5681863">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_M()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5681896">//</span><br>
<span class="lineno"></span><span class="comment" id="5681899">//&nbsp;Multiple&nbsp;example&nbsp;functions&nbsp;for&nbsp;a&nbsp;package/type/function/method&nbsp;may&nbsp;be&nbsp;provided&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5681983">//&nbsp;appending&nbsp;a&nbsp;distinct&nbsp;suffix&nbsp;to&nbsp;the&nbsp;name.&nbsp;The&nbsp;suffix&nbsp;must&nbsp;start&nbsp;with&nbsp;a</span><br>
<span class="lineno">110</span><span class="comment" id="5682056">//&nbsp;lower-case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="comment" id="5682078">//</span><br>
<span class="lineno"></span><span class="comment" id="5682081">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;Example_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5682118">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleF_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5682156">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno">115</span><span class="comment" id="5682194">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_M_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5682234">//</span><br>
<span class="lineno"></span><span class="comment" id="5682237">//&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;presented&nbsp;as&nbsp;the&nbsp;example&nbsp;when&nbsp;it&nbsp;contains&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="5682315">//&nbsp;example&nbsp;function,&nbsp;at&nbsp;least&nbsp;one&nbsp;other&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant</span><br>
<span class="lineno"></span><span class="comment" id="5682393">//&nbsp;declaration,&nbsp;and&nbsp;no&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions.</span><br>
<span class="lineno">120</span><span class="comment" id="5682445">//</span><br>
<span class="lineno"></span><span class="comment" id="5682448">//&nbsp;Main</span><br>
<span class="lineno"></span><span class="comment" id="5682456">//</span><br>
<span class="lineno"></span><span class="comment" id="5682459">//&nbsp;It&nbsp;is&nbsp;sometimes&nbsp;necessary&nbsp;for&nbsp;a&nbsp;test&nbsp;program&nbsp;to&nbsp;do&nbsp;extra&nbsp;setup&nbsp;or&nbsp;teardown</span><br>
<span class="lineno"></span><span class="comment" id="5682537">//&nbsp;before&nbsp;or&nbsp;after&nbsp;testing.&nbsp;It&nbsp;is&nbsp;also&nbsp;sometimes&nbsp;necessary&nbsp;for&nbsp;a&nbsp;test&nbsp;to&nbsp;control</span><br>
<span class="lineno">125</span><span class="comment" id="5682618">//&nbsp;which&nbsp;code&nbsp;runs&nbsp;on&nbsp;the&nbsp;main&nbsp;thread.&nbsp;To&nbsp;support&nbsp;these&nbsp;and&nbsp;other&nbsp;cases,</span><br>
<span class="lineno"></span><span class="comment" id="5682691">//&nbsp;if&nbsp;a&nbsp;test&nbsp;file&nbsp;contains&nbsp;a&nbsp;function:</span><br>
<span class="lineno"></span><span class="comment" id="5682730">//</span><br>
<span class="lineno"></span><span class="comment" id="5682733">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestMain(m&nbsp;*testing.M)</span><br>
<span class="lineno"></span><span class="comment" id="5682764">//</span><br>
<span class="lineno">130</span><span class="comment" id="5682767">//&nbsp;then&nbsp;the&nbsp;generated&nbsp;test&nbsp;will&nbsp;call&nbsp;TestMain(m)&nbsp;instead&nbsp;of&nbsp;running&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="5682845">//&nbsp;directly.&nbsp;TestMain&nbsp;runs&nbsp;in&nbsp;the&nbsp;main&nbsp;goroutine&nbsp;and&nbsp;can&nbsp;do&nbsp;whatever&nbsp;setup</span><br>
<span class="lineno"></span><span class="comment" id="5682920">//&nbsp;and&nbsp;teardown&nbsp;is&nbsp;necessary&nbsp;around&nbsp;a&nbsp;call&nbsp;to&nbsp;m.Run.&nbsp;It&nbsp;should&nbsp;then&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="5682993">//&nbsp;os.Exit&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;m.Run.</span><br>
<span class="lineno"></span><span class="comment" id="5683030">//</span><br>
<span class="lineno">135</span><span class="comment" id="5683033">//&nbsp;The&nbsp;minimal&nbsp;implementation&nbsp;of&nbsp;TestMain&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="5683079">//</span><br>
<span class="lineno"></span><span class="comment" id="5683082">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestMain(m&nbsp;*testing.M)&nbsp;{&nbsp;os.Exit(m.Run())&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="5683134">//</span><br>
<span class="lineno"></span><span class="comment" id="5683137">//&nbsp;In&nbsp;effect,&nbsp;that&nbsp;is&nbsp;the&nbsp;implementation&nbsp;used&nbsp;when&nbsp;no&nbsp;TestMain&nbsp;is&nbsp;explicitly&nbsp;defined.</span><br>
<span class="lineno">140</span><span class="keyword" id="5683223">package</span>&nbsp;<span class="ident" id="5683231">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5683240">import</span>&nbsp;<span class="op" id="5683247">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683250">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683259">&#34;flag&#34;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683267">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683274">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683280">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683291">&#34;runtime/pprof&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683308">&#34;strconv&#34;</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683319">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683330">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5683338">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5683345">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="5683348">var</span>&nbsp;<span class="op" id="5683352">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683355">//&nbsp;The&nbsp;short&nbsp;flag&nbsp;requests&nbsp;that&nbsp;tests&nbsp;run&nbsp;more&nbsp;quickly,&nbsp;but&nbsp;its&nbsp;functionality</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683434">//&nbsp;is&nbsp;provided&nbsp;by&nbsp;test&nbsp;writers&nbsp;themselves.&nbsp;&nbsp;The&nbsp;testing&nbsp;package&nbsp;is&nbsp;just&nbsp;its</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683511">//&nbsp;home.&nbsp;&nbsp;The&nbsp;all.bash&nbsp;installation&nbsp;script&nbsp;sets&nbsp;it&nbsp;to&nbsp;make&nbsp;installation&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683589">//&nbsp;efficient,&nbsp;but&nbsp;by&nbsp;default&nbsp;the&nbsp;flag&nbsp;is&nbsp;off&nbsp;so&nbsp;a&nbsp;plain&nbsp;&#34;go&nbsp;test&#34;&nbsp;will&nbsp;do&nbsp;a</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683666">//&nbsp;full&nbsp;test&nbsp;of&nbsp;the&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5683696">short</span>&nbsp;<span class="op" id="5683702">=</span>&nbsp;<span class="ident" id="5683704">flag</span><span class="op" id="5683708">.</span><span class="ident" id="5683709">Bool</span><span class="op" id="5683713">(</span><span class="string" id="5683714">&#34;test.short&#34;</span><span class="op" id="5683726">,</span>&nbsp;<span class="builtintype" id="5683728">false</span><span class="op" id="5683733">,</span>&nbsp;<span class="string" id="5683735">&#34;run&nbsp;smaller&nbsp;test&nbsp;suite&nbsp;to&nbsp;save&nbsp;time&#34;</span><span class="op" id="5683772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683776">//&nbsp;The&nbsp;directory&nbsp;in&nbsp;which&nbsp;to&nbsp;create&nbsp;profile&nbsp;files&nbsp;and&nbsp;the&nbsp;like.&nbsp;When&nbsp;run&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683855">//&nbsp;&#34;go&nbsp;test&#34;,&nbsp;the&nbsp;binary&nbsp;always&nbsp;runs&nbsp;in&nbsp;the&nbsp;source&nbsp;directory&nbsp;for&nbsp;the&nbsp;package;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5683934">//&nbsp;this&nbsp;flag&nbsp;lets&nbsp;&#34;go&nbsp;test&#34;&nbsp;tell&nbsp;the&nbsp;binary&nbsp;to&nbsp;write&nbsp;the&nbsp;files&nbsp;in&nbsp;the&nbsp;directory&nbsp;where</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5684021">//&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command&nbsp;is&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684055">outputDir</span>&nbsp;<span class="op" id="5684065">=</span>&nbsp;<span class="ident" id="5684067">flag</span><span class="op" id="5684071">.</span><span class="ident" id="5684072">String</span><span class="op" id="5684078">(</span><span class="string" id="5684079">&#34;test.outputdir&#34;</span><span class="op" id="5684095">,</span>&nbsp;<span class="string" id="5684097">&#34;&#34;</span><span class="op" id="5684099">,</span>&nbsp;<span class="string" id="5684101">&#34;directory&nbsp;in&nbsp;which&nbsp;to&nbsp;write&nbsp;profiles&#34;</span><span class="op" id="5684139">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5684143">//&nbsp;Report&nbsp;as&nbsp;tests&nbsp;are&nbsp;run;&nbsp;default&nbsp;is&nbsp;silent&nbsp;for&nbsp;success.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684203">chatty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684220">=</span>&nbsp;<span class="ident" id="5684222">flag</span><span class="op" id="5684226">.</span><span class="ident" id="5684227">Bool</span><span class="op" id="5684231">(</span><span class="string" id="5684232">&#34;test.v&#34;</span><span class="op" id="5684240">,</span>&nbsp;<span class="builtintype" id="5684242">false</span><span class="op" id="5684247">,</span>&nbsp;<span class="string" id="5684249">&#34;verbose:&nbsp;print&nbsp;additional&nbsp;output&#34;</span><span class="op" id="5684283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684286">coverProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684303">=</span>&nbsp;<span class="ident" id="5684305">flag</span><span class="op" id="5684309">.</span><span class="ident" id="5684310">String</span><span class="op" id="5684316">(</span><span class="string" id="5684317">&#34;test.coverprofile&#34;</span><span class="op" id="5684336">,</span>&nbsp;<span class="string" id="5684338">&#34;&#34;</span><span class="op" id="5684340">,</span>&nbsp;<span class="string" id="5684342">&#34;write&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="5684402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684405">match</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684422">=</span>&nbsp;<span class="ident" id="5684424">flag</span><span class="op" id="5684428">.</span><span class="ident" id="5684429">String</span><span class="op" id="5684435">(</span><span class="string" id="5684436">&#34;test.run&#34;</span><span class="op" id="5684446">,</span>&nbsp;<span class="string" id="5684448">&#34;&#34;</span><span class="op" id="5684450">,</span>&nbsp;<span class="string" id="5684452">&#34;regular&nbsp;expression&nbsp;to&nbsp;select&nbsp;tests&nbsp;and&nbsp;examples&nbsp;to&nbsp;run&#34;</span><span class="op" id="5684508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684511">memProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684528">=</span>&nbsp;<span class="ident" id="5684530">flag</span><span class="op" id="5684534">.</span><span class="ident" id="5684535">String</span><span class="op" id="5684541">(</span><span class="string" id="5684542">&#34;test.memprofile&#34;</span><span class="op" id="5684559">,</span>&nbsp;<span class="string" id="5684561">&#34;&#34;</span><span class="op" id="5684563">,</span>&nbsp;<span class="string" id="5684565">&#34;write&nbsp;a&nbsp;memory&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="5684623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684626">memProfileRate</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5684643">=</span>&nbsp;<span class="ident" id="5684645">flag</span><span class="op" id="5684649">.</span><span class="ident" id="5684650">Int</span><span class="op" id="5684653">(</span><span class="string" id="5684654">&#34;test.memprofilerate&#34;</span><span class="op" id="5684675">,</span>&nbsp;<span class="num" id="5684677">0</span><span class="op" id="5684678">,</span>&nbsp;<span class="string" id="5684680">&#34;if&nbsp;&gt;=0,&nbsp;sets&nbsp;runtime.MemProfileRate&#34;</span><span class="op" id="5684717">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684720">cpuProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684737">=</span>&nbsp;<span class="ident" id="5684739">flag</span><span class="op" id="5684743">.</span><span class="ident" id="5684744">String</span><span class="op" id="5684750">(</span><span class="string" id="5684751">&#34;test.cpuprofile&#34;</span><span class="op" id="5684768">,</span>&nbsp;<span class="string" id="5684770">&#34;&#34;</span><span class="op" id="5684772">,</span>&nbsp;<span class="string" id="5684774">&#34;write&nbsp;a&nbsp;cpu&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;during&nbsp;execution&#34;</span><span class="op" id="5684830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684833">blockProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684850">=</span>&nbsp;<span class="ident" id="5684852">flag</span><span class="op" id="5684856">.</span><span class="ident" id="5684857">String</span><span class="op" id="5684863">(</span><span class="string" id="5684864">&#34;test.blockprofile&#34;</span><span class="op" id="5684883">,</span>&nbsp;<span class="string" id="5684885">&#34;&#34;</span><span class="op" id="5684887">,</span>&nbsp;<span class="string" id="5684889">&#34;write&nbsp;a&nbsp;goroutine&nbsp;blocking&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="5684959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5684962">blockProfileRate</span>&nbsp;<span class="op" id="5684979">=</span>&nbsp;<span class="ident" id="5684981">flag</span><span class="op" id="5684985">.</span><span class="ident" id="5684986">Int</span><span class="op" id="5684989">(</span><span class="string" id="5684990">&#34;test.blockprofilerate&#34;</span><span class="op" id="5685013">,</span>&nbsp;<span class="num" id="5685015">1</span><span class="op" id="5685016">,</span>&nbsp;<span class="string" id="5685018">&#34;if&nbsp;&gt;=&nbsp;0,&nbsp;calls&nbsp;runtime.SetBlockProfileRate()&#34;</span><span class="op" id="5685064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685067">timeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5685084">=</span>&nbsp;<span class="ident" id="5685086">flag</span><span class="op" id="5685090">.</span><span class="ident" id="5685091">Duration</span><span class="op" id="5685099">(</span><span class="string" id="5685100">&#34;test.timeout&#34;</span><span class="op" id="5685114">,</span>&nbsp;<span class="num" id="5685116">0</span><span class="op" id="5685117">,</span>&nbsp;<span class="string" id="5685119">&#34;if&nbsp;positive,&nbsp;sets&nbsp;an&nbsp;aggregate&nbsp;time&nbsp;limit&nbsp;for&nbsp;all&nbsp;tests&#34;</span><span class="op" id="5685176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685179">cpuListStr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5685196">=</span>&nbsp;<span class="ident" id="5685198">flag</span><span class="op" id="5685202">.</span><span class="ident" id="5685203">String</span><span class="op" id="5685209">(</span><span class="string" id="5685210">&#34;test.cpu&#34;</span><span class="op" id="5685220">,</span>&nbsp;<span class="string" id="5685222">&#34;&#34;</span><span class="op" id="5685224">,</span>&nbsp;<span class="string" id="5685226">&#34;comma-separated&nbsp;list&nbsp;of&nbsp;number&nbsp;of&nbsp;CPUs&nbsp;to&nbsp;use&nbsp;for&nbsp;each&nbsp;test&#34;</span><span class="op" id="5685287">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685290">parallel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5685307">=</span>&nbsp;<span class="ident" id="5685309">flag</span><span class="op" id="5685313">.</span><span class="ident" id="5685314">Int</span><span class="op" id="5685317">(</span><span class="string" id="5685318">&#34;test.parallel&#34;</span><span class="op" id="5685333">,</span>&nbsp;<span class="ident" id="5685335">runtime</span><span class="op" id="5685342">.</span><span class="ident" id="5685343">GOMAXPROCS</span><span class="op" id="5685353">(</span><span class="num" id="5685354">0</span><span class="op" id="5685355">)</span><span class="op" id="5685356">,</span>&nbsp;<span class="string" id="5685358">&#34;maximum&nbsp;test&nbsp;parallelism&#34;</span><span class="op" id="5685384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685388">haveExamples</span>&nbsp;<span class="builtintype" id="5685401">bool</span>&nbsp;<span class="comment" id="5685406">//&nbsp;are&nbsp;there&nbsp;examples?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685431">cpuList</span>&nbsp;<span class="op" id="5685439">[</span><span class="op" id="5685440">]</span><span class="builtintype" id="5685441">int</span><br>
<span class="lineno">185</span><span class="op" id="5685445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5685448">//&nbsp;common&nbsp;holds&nbsp;the&nbsp;elements&nbsp;common&nbsp;between&nbsp;T&nbsp;and&nbsp;B&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5685504">//&nbsp;captures&nbsp;common&nbsp;methods&nbsp;such&nbsp;as&nbsp;Errorf.</span><br>
<span class="lineno"></span><span class="keyword" id="5685547">type</span>&nbsp;<span class="ident" id="5685552">common</span>&nbsp;<span class="keyword" id="5685559">struct</span>&nbsp;<span class="op" id="5685566">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685569">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685578">sync</span><span class="op" id="5685582">.</span><span class="ident" id="5685583">RWMutex</span>&nbsp;<span class="comment" id="5685591">//&nbsp;guards&nbsp;output&nbsp;and&nbsp;failed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685620">output</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5685629">[</span><span class="op" id="5685630">]</span><span class="builtintype" id="5685631">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5685642">//&nbsp;Output&nbsp;generated&nbsp;by&nbsp;test&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685685">failed</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5685694">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5685707">//&nbsp;Test&nbsp;or&nbsp;benchmark&nbsp;has&nbsp;failed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685741">skipped</span>&nbsp;&nbsp;<span class="builtintype" id="5685750">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5685763">//&nbsp;Test&nbsp;of&nbsp;benchmark&nbsp;has&nbsp;been&nbsp;skipped.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685803">finished</span>&nbsp;<span class="builtintype" id="5685812">bool</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685819">start</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685828">time</span><span class="op" id="5685832">.</span><span class="ident" id="5685833">Time</span>&nbsp;<span class="comment" id="5685838">//&nbsp;Time&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;started</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685873">duration</span>&nbsp;<span class="ident" id="5685882">time</span><span class="op" id="5685886">.</span><span class="ident" id="5685887">Duration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685897">self</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5685906">interface</span><span class="op" id="5685915">{</span><span class="op" id="5685916">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5685923">//&nbsp;To&nbsp;be&nbsp;sent&nbsp;on&nbsp;signal&nbsp;channel&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5685967">signal</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="5685976">chan</span>&nbsp;<span class="keyword" id="5685981">interface</span><span class="op" id="5685990">{</span><span class="op" id="5685991">}</span>&nbsp;<span class="comment" id="5685993">//&nbsp;Output&nbsp;for&nbsp;serial&nbsp;tests.</span><br>
<span class="lineno">200</span><span class="op" id="5686021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5686024">//&nbsp;Short&nbsp;reports&nbsp;whether&nbsp;the&nbsp;-test.short&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="5686078">func</span>&nbsp;<span class="ident" id="5686083">Short</span><span class="op" id="5686088">(</span><span class="op" id="5686089">)</span>&nbsp;<span class="builtintype" id="5686091">bool</span>&nbsp;<span class="op" id="5686096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5686099">return</span>&nbsp;<span class="op" id="5686106">*</span><span class="ident" id="5686107">short</span><br>
<span class="lineno">205</span><span class="op" id="5686113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5686116">//&nbsp;Verbose&nbsp;reports&nbsp;whether&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="5686168">func</span>&nbsp;<span class="ident" id="5686173">Verbose</span><span class="op" id="5686180">(</span><span class="op" id="5686181">)</span>&nbsp;<span class="builtintype" id="5686183">bool</span>&nbsp;<span class="op" id="5686188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5686191">return</span>&nbsp;<span class="op" id="5686198">*</span><span class="ident" id="5686199">chatty</span><br>
<span class="lineno">210</span><span class="op" id="5686206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5686209">//&nbsp;decorate&nbsp;prefixes&nbsp;the&nbsp;string&nbsp;with&nbsp;the&nbsp;file&nbsp;and&nbsp;line&nbsp;of&nbsp;the&nbsp;call&nbsp;site</span><br>
<span class="lineno"></span><span class="comment" id="5686281">//&nbsp;and&nbsp;inserts&nbsp;the&nbsp;final&nbsp;newline&nbsp;if&nbsp;needed&nbsp;and&nbsp;indentation&nbsp;tabs&nbsp;for&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="keyword" id="5686361">func</span>&nbsp;<span class="ident" id="5686366">decorate</span><span class="op" id="5686374">(</span><span class="ident" id="5686375">s</span>&nbsp;<span class="builtintype" id="5686377">string</span><span class="op" id="5686383">)</span>&nbsp;<span class="builtintype" id="5686385">string</span>&nbsp;<span class="op" id="5686392">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686395">_</span><span class="op" id="5686396">,</span>&nbsp;<span class="ident" id="5686398">file</span><span class="op" id="5686402">,</span>&nbsp;<span class="ident" id="5686404">line</span><span class="op" id="5686408">,</span>&nbsp;<span class="ident" id="5686410">ok</span>&nbsp;<span class="op" id="5686413">:=</span>&nbsp;<span class="ident" id="5686416">runtime</span><span class="op" id="5686423">.</span><span class="ident" id="5686424">Caller</span><span class="op" id="5686430">(</span><span class="num" id="5686431">3</span><span class="op" id="5686432">)</span>&nbsp;<span class="comment" id="5686434">//&nbsp;decorate&nbsp;+&nbsp;log&nbsp;+&nbsp;public&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5686472">if</span>&nbsp;<span class="ident" id="5686475">ok</span>&nbsp;<span class="op" id="5686478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5686482">//&nbsp;Truncate&nbsp;file&nbsp;name&nbsp;at&nbsp;last&nbsp;file&nbsp;name&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5686535">if</span>&nbsp;<span class="ident" id="5686538">index</span>&nbsp;<span class="op" id="5686544">:=</span>&nbsp;<span class="ident" id="5686547">strings</span><span class="op" id="5686554">.</span><span class="ident" id="5686555">LastIndex</span><span class="op" id="5686564">(</span><span class="ident" id="5686565">file</span><span class="op" id="5686569">,</span>&nbsp;<span class="string" id="5686571">&#34;/&#34;</span><span class="op" id="5686574">)</span><span class="op" id="5686575">;</span>&nbsp;<span class="ident" id="5686577">index</span>&nbsp;<span class="op" id="5686583">&gt;=</span>&nbsp;<span class="num" id="5686586">0</span>&nbsp;<span class="op" id="5686588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686593">file</span>&nbsp;<span class="op" id="5686598">=</span>&nbsp;<span class="ident" id="5686600">file</span><span class="op" id="5686604">[</span><span class="ident" id="5686605">index</span><span class="op" id="5686610">+</span><span class="num" id="5686611">1</span><span class="op" id="5686612">:</span><span class="op" id="5686613">]</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5686617">}</span>&nbsp;<span class="keyword" id="5686619">else</span>&nbsp;<span class="keyword" id="5686624">if</span>&nbsp;<span class="ident" id="5686627">index</span>&nbsp;<span class="op" id="5686633">=</span>&nbsp;<span class="ident" id="5686635">strings</span><span class="op" id="5686642">.</span><span class="ident" id="5686643">LastIndex</span><span class="op" id="5686652">(</span><span class="ident" id="5686653">file</span><span class="op" id="5686657">,</span>&nbsp;<span class="string" id="5686659">&#34;\\&#34;</span><span class="op" id="5686663">)</span><span class="op" id="5686664">;</span>&nbsp;<span class="ident" id="5686666">index</span>&nbsp;<span class="op" id="5686672">&gt;=</span>&nbsp;<span class="num" id="5686675">0</span>&nbsp;<span class="op" id="5686677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686682">file</span>&nbsp;<span class="op" id="5686687">=</span>&nbsp;<span class="ident" id="5686689">file</span><span class="op" id="5686693">[</span><span class="ident" id="5686694">index</span><span class="op" id="5686699">+</span><span class="num" id="5686700">1</span><span class="op" id="5686701">:</span><span class="op" id="5686702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5686706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5686709">}</span>&nbsp;<span class="keyword" id="5686711">else</span>&nbsp;<span class="op" id="5686716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686720">file</span>&nbsp;<span class="op" id="5686725">=</span>&nbsp;<span class="string" id="5686727">&#34;???&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686735">line</span>&nbsp;<span class="op" id="5686740">=</span>&nbsp;<span class="num" id="5686742">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5686745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686748">buf</span>&nbsp;<span class="op" id="5686752">:=</span>&nbsp;<span class="builtinfunc" id="5686755">new</span><span class="op" id="5686758">(</span><span class="ident" id="5686759">bytes</span><span class="op" id="5686764">.</span><span class="ident" id="5686765">Buffer</span><span class="op" id="5686771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5686774">//&nbsp;Every&nbsp;line&nbsp;is&nbsp;indented&nbsp;at&nbsp;least&nbsp;one&nbsp;tab.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686819">buf</span><span class="op" id="5686822">.</span><span class="ident" id="5686823">WriteByte</span><span class="op" id="5686832">(</span><span class="string" id="5686833">&#39;\t&#39;</span><span class="op" id="5686837">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686840">fmt</span><span class="op" id="5686843">.</span><span class="ident" id="5686844">Fprintf</span><span class="op" id="5686851">(</span><span class="ident" id="5686852">buf</span><span class="op" id="5686855">,</span>&nbsp;<span class="string" id="5686857">&#34;%s:%d:&nbsp;&#34;</span><span class="op" id="5686866">,</span>&nbsp;<span class="ident" id="5686868">file</span><span class="op" id="5686872">,</span>&nbsp;<span class="ident" id="5686874">line</span><span class="op" id="5686878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686881">lines</span>&nbsp;<span class="op" id="5686887">:=</span>&nbsp;<span class="ident" id="5686890">strings</span><span class="op" id="5686897">.</span><span class="ident" id="5686898">Split</span><span class="op" id="5686903">(</span><span class="ident" id="5686904">s</span><span class="op" id="5686905">,</span>&nbsp;<span class="string" id="5686907">&#34;\n&#34;</span><span class="op" id="5686911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5686914">if</span>&nbsp;<span class="ident" id="5686917">l</span>&nbsp;<span class="op" id="5686919">:=</span>&nbsp;<span class="builtinfunc" id="5686922">len</span><span class="op" id="5686925">(</span><span class="ident" id="5686926">lines</span><span class="op" id="5686931">)</span><span class="op" id="5686932">;</span>&nbsp;<span class="ident" id="5686934">l</span>&nbsp;<span class="op" id="5686936">&gt;</span>&nbsp;<span class="num" id="5686938">1</span>&nbsp;<span class="op" id="5686940">&amp;&amp;</span>&nbsp;<span class="ident" id="5686943">lines</span><span class="op" id="5686948">[</span><span class="ident" id="5686949">l</span><span class="op" id="5686950">-</span><span class="num" id="5686951">1</span><span class="op" id="5686952">]</span>&nbsp;<span class="op" id="5686954">==</span>&nbsp;<span class="string" id="5686957">&#34;&#34;</span>&nbsp;<span class="op" id="5686960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5686964">lines</span>&nbsp;<span class="op" id="5686970">=</span>&nbsp;<span class="ident" id="5686972">lines</span><span class="op" id="5686977">[</span><span class="op" id="5686978">:</span><span class="ident" id="5686979">l</span><span class="op" id="5686980">-</span><span class="num" id="5686981">1</span><span class="op" id="5686982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5686985">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5686988">for</span>&nbsp;<span class="ident" id="5686992">i</span><span class="op" id="5686993">,</span>&nbsp;<span class="ident" id="5686995">line</span>&nbsp;<span class="op" id="5687000">:=</span>&nbsp;<span class="keyword" id="5687003">range</span>&nbsp;<span class="ident" id="5687009">lines</span>&nbsp;<span class="op" id="5687015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5687019">if</span>&nbsp;<span class="ident" id="5687022">i</span>&nbsp;<span class="op" id="5687024">&gt;</span>&nbsp;<span class="num" id="5687026">0</span>&nbsp;<span class="op" id="5687028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5687033">//&nbsp;Second&nbsp;and&nbsp;subsequent&nbsp;lines&nbsp;are&nbsp;indented&nbsp;an&nbsp;extra&nbsp;tab.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687094">buf</span><span class="op" id="5687097">.</span><span class="ident" id="5687098">WriteString</span><span class="op" id="5687109">(</span><span class="string" id="5687110">&#34;\n\t\t&#34;</span><span class="op" id="5687118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5687122">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687126">buf</span><span class="op" id="5687129">.</span><span class="ident" id="5687130">WriteString</span><span class="op" id="5687141">(</span><span class="ident" id="5687142">line</span><span class="op" id="5687146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5687149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687152">buf</span><span class="op" id="5687155">.</span><span class="ident" id="5687156">WriteByte</span><span class="op" id="5687165">(</span><span class="string" id="5687166">&#39;\n&#39;</span><span class="op" id="5687170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5687173">return</span>&nbsp;<span class="ident" id="5687180">buf</span><span class="op" id="5687183">.</span><span class="ident" id="5687184">String</span><span class="op" id="5687190">(</span><span class="op" id="5687191">)</span><br>
<span class="lineno"></span><span class="op" id="5687193">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="5687196">//&nbsp;fmtDuration&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;d&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;87.00s&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5687265">func</span>&nbsp;<span class="ident" id="5687270">fmtDuration</span><span class="op" id="5687281">(</span><span class="ident" id="5687282">d</span>&nbsp;<span class="ident" id="5687284">time</span><span class="op" id="5687288">.</span><span class="ident" id="5687289">Duration</span><span class="op" id="5687297">)</span>&nbsp;<span class="builtintype" id="5687299">string</span>&nbsp;<span class="op" id="5687306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5687309">return</span>&nbsp;<span class="ident" id="5687316">fmt</span><span class="op" id="5687319">.</span><span class="ident" id="5687320">Sprintf</span><span class="op" id="5687327">(</span><span class="string" id="5687328">&#34;%.2fs&#34;</span><span class="op" id="5687335">,</span>&nbsp;<span class="ident" id="5687337">d</span><span class="op" id="5687338">.</span><span class="ident" id="5687339">Seconds</span><span class="op" id="5687346">(</span><span class="op" id="5687347">)</span><span class="op" id="5687348">)</span><br>
<span class="lineno"></span><span class="op" id="5687350">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span><span class="comment" id="5687353">//&nbsp;TB&nbsp;is&nbsp;the&nbsp;interface&nbsp;common&nbsp;to&nbsp;T&nbsp;and&nbsp;B.</span><br>
<span class="lineno"></span><span class="keyword" id="5687395">type</span>&nbsp;<span class="ident" id="5687400">TB</span>&nbsp;<span class="keyword" id="5687403">interface</span>&nbsp;<span class="op" id="5687413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687416">Error</span><span class="op" id="5687421">(</span><span class="ident" id="5687422">args</span>&nbsp;<span class="op" id="5687427">...</span><span class="keyword" id="5687430">interface</span><span class="op" id="5687439">{</span><span class="op" id="5687440">}</span><span class="op" id="5687441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687444">Errorf</span><span class="op" id="5687450">(</span><span class="ident" id="5687451">format</span>&nbsp;<span class="builtintype" id="5687458">string</span><span class="op" id="5687464">,</span>&nbsp;<span class="ident" id="5687466">args</span>&nbsp;<span class="op" id="5687471">...</span><span class="keyword" id="5687474">interface</span><span class="op" id="5687483">{</span><span class="op" id="5687484">}</span><span class="op" id="5687485">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687488">Fail</span><span class="op" id="5687492">(</span><span class="op" id="5687493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687496">FailNow</span><span class="op" id="5687503">(</span><span class="op" id="5687504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687507">Failed</span><span class="op" id="5687513">(</span><span class="op" id="5687514">)</span>&nbsp;<span class="builtintype" id="5687516">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687522">Fatal</span><span class="op" id="5687527">(</span><span class="ident" id="5687528">args</span>&nbsp;<span class="op" id="5687533">...</span><span class="keyword" id="5687536">interface</span><span class="op" id="5687545">{</span><span class="op" id="5687546">}</span><span class="op" id="5687547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687550">Fatalf</span><span class="op" id="5687556">(</span><span class="ident" id="5687557">format</span>&nbsp;<span class="builtintype" id="5687564">string</span><span class="op" id="5687570">,</span>&nbsp;<span class="ident" id="5687572">args</span>&nbsp;<span class="op" id="5687577">...</span><span class="keyword" id="5687580">interface</span><span class="op" id="5687589">{</span><span class="op" id="5687590">}</span><span class="op" id="5687591">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687594">Log</span><span class="op" id="5687597">(</span><span class="ident" id="5687598">args</span>&nbsp;<span class="op" id="5687603">...</span><span class="keyword" id="5687606">interface</span><span class="op" id="5687615">{</span><span class="op" id="5687616">}</span><span class="op" id="5687617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687620">Logf</span><span class="op" id="5687624">(</span><span class="ident" id="5687625">format</span>&nbsp;<span class="builtintype" id="5687632">string</span><span class="op" id="5687638">,</span>&nbsp;<span class="ident" id="5687640">args</span>&nbsp;<span class="op" id="5687645">...</span><span class="keyword" id="5687648">interface</span><span class="op" id="5687657">{</span><span class="op" id="5687658">}</span><span class="op" id="5687659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687662">Skip</span><span class="op" id="5687666">(</span><span class="ident" id="5687667">args</span>&nbsp;<span class="op" id="5687672">...</span><span class="keyword" id="5687675">interface</span><span class="op" id="5687684">{</span><span class="op" id="5687685">}</span><span class="op" id="5687686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687689">SkipNow</span><span class="op" id="5687696">(</span><span class="op" id="5687697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687700">Skipf</span><span class="op" id="5687705">(</span><span class="ident" id="5687706">format</span>&nbsp;<span class="builtintype" id="5687713">string</span><span class="op" id="5687719">,</span>&nbsp;<span class="ident" id="5687721">args</span>&nbsp;<span class="op" id="5687726">...</span><span class="keyword" id="5687729">interface</span><span class="op" id="5687738">{</span><span class="op" id="5687739">}</span><span class="op" id="5687740">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687743">Skipped</span><span class="op" id="5687750">(</span><span class="op" id="5687751">)</span>&nbsp;<span class="builtintype" id="5687753">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5687760">//&nbsp;A&nbsp;private&nbsp;method&nbsp;to&nbsp;prevent&nbsp;users&nbsp;implementing&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5687815">//&nbsp;interface&nbsp;and&nbsp;so&nbsp;future&nbsp;additions&nbsp;to&nbsp;it&nbsp;will&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5687868">//&nbsp;violate&nbsp;Go&nbsp;1&nbsp;compatibility.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5687900">private</span><span class="op" id="5687907">(</span><span class="op" id="5687908">)</span><br>
<span class="lineno"></span><span class="op" id="5687910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5687913">var</span>&nbsp;<span class="ident" id="5687917">_</span>&nbsp;<span class="ident" id="5687919">TB</span>&nbsp;<span class="op" id="5687922">=</span>&nbsp;<span class="op" id="5687924">(</span><span class="op" id="5687925">*</span><span class="ident" id="5687926">T</span><span class="op" id="5687927">)</span><span class="op" id="5687928">(</span><span class="ident" id="5687929">nil</span><span class="op" id="5687932">)</span><br>
<span class="lineno"></span><span class="keyword" id="5687934">var</span>&nbsp;<span class="ident" id="5687938">_</span>&nbsp;<span class="ident" id="5687940">TB</span>&nbsp;<span class="op" id="5687943">=</span>&nbsp;<span class="op" id="5687945">(</span><span class="op" id="5687946">*</span><span class="ident" id="5687947">B</span><span class="op" id="5687948">)</span><span class="op" id="5687949">(</span><span class="ident" id="5687950">nil</span><span class="op" id="5687953">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="5687956">//&nbsp;T&nbsp;is&nbsp;a&nbsp;type&nbsp;passed&nbsp;to&nbsp;Test&nbsp;functions&nbsp;to&nbsp;manage&nbsp;test&nbsp;state&nbsp;and&nbsp;support&nbsp;formatted&nbsp;test&nbsp;logs.</span><br>
<span class="lineno"></span><span class="comment" id="5688050">//&nbsp;Logs&nbsp;are&nbsp;accumulated&nbsp;during&nbsp;execution&nbsp;and&nbsp;dumped&nbsp;to&nbsp;standard&nbsp;error&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="keyword" id="5688131">type</span>&nbsp;<span class="ident" id="5688136">T</span>&nbsp;<span class="keyword" id="5688138">struct</span>&nbsp;<span class="op" id="5688145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688148">common</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688156">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5688170">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5688180">//&nbsp;Name&nbsp;of&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688198">startParallel</span>&nbsp;<span class="keyword" id="5688212">chan</span>&nbsp;<span class="builtintype" id="5688217">bool</span>&nbsp;<span class="comment" id="5688222">//&nbsp;Parallel&nbsp;tests&nbsp;will&nbsp;wait&nbsp;on&nbsp;this.</span><br>
<span class="lineno"></span><span class="op" id="5688259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5688262">func</span>&nbsp;<span class="op" id="5688267">(</span><span class="ident" id="5688268">c</span>&nbsp;<span class="op" id="5688270">*</span><span class="ident" id="5688271">common</span><span class="op" id="5688277">)</span>&nbsp;<span class="ident" id="5688279">private</span><span class="op" id="5688286">(</span><span class="op" id="5688287">)</span>&nbsp;<span class="op" id="5688289">{</span><span class="op" id="5688290">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5688293">//&nbsp;Fail&nbsp;marks&nbsp;the&nbsp;function&nbsp;as&nbsp;having&nbsp;failed&nbsp;but&nbsp;continues&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5688362">func</span>&nbsp;<span class="op" id="5688367">(</span><span class="ident" id="5688368">c</span>&nbsp;<span class="op" id="5688370">*</span><span class="ident" id="5688371">common</span><span class="op" id="5688377">)</span>&nbsp;<span class="ident" id="5688379">Fail</span><span class="op" id="5688383">(</span><span class="op" id="5688384">)</span>&nbsp;<span class="op" id="5688386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688389">c</span><span class="op" id="5688390">.</span><span class="ident" id="5688391">mu</span><span class="op" id="5688393">.</span><span class="ident" id="5688394">Lock</span><span class="op" id="5688398">(</span><span class="op" id="5688399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5688402">defer</span>&nbsp;<span class="ident" id="5688408">c</span><span class="op" id="5688409">.</span><span class="ident" id="5688410">mu</span><span class="op" id="5688412">.</span><span class="ident" id="5688413">Unlock</span><span class="op" id="5688419">(</span><span class="op" id="5688420">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688423">c</span><span class="op" id="5688424">.</span><span class="ident" id="5688425">failed</span>&nbsp;<span class="op" id="5688432">=</span>&nbsp;<span class="builtintype" id="5688434">true</span><br>
<span class="lineno"></span><span class="op" id="5688439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5688442">//&nbsp;Failed&nbsp;reports&nbsp;whether&nbsp;the&nbsp;function&nbsp;has&nbsp;failed.</span><br>
<span class="lineno"></span><span class="keyword" id="5688493">func</span>&nbsp;<span class="op" id="5688498">(</span><span class="ident" id="5688499">c</span>&nbsp;<span class="op" id="5688501">*</span><span class="ident" id="5688502">common</span><span class="op" id="5688508">)</span>&nbsp;<span class="ident" id="5688510">Failed</span><span class="op" id="5688516">(</span><span class="op" id="5688517">)</span>&nbsp;<span class="builtintype" id="5688519">bool</span>&nbsp;<span class="op" id="5688524">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688527">c</span><span class="op" id="5688528">.</span><span class="ident" id="5688529">mu</span><span class="op" id="5688531">.</span><span class="ident" id="5688532">RLock</span><span class="op" id="5688537">(</span><span class="op" id="5688538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5688541">defer</span>&nbsp;<span class="ident" id="5688547">c</span><span class="op" id="5688548">.</span><span class="ident" id="5688549">mu</span><span class="op" id="5688551">.</span><span class="ident" id="5688552">RUnlock</span><span class="op" id="5688559">(</span><span class="op" id="5688560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5688563">return</span>&nbsp;<span class="ident" id="5688570">c</span><span class="op" id="5688571">.</span><span class="ident" id="5688572">failed</span><br>
<span class="lineno"></span><span class="op" id="5688579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="5688582">//&nbsp;FailNow&nbsp;marks&nbsp;the&nbsp;function&nbsp;as&nbsp;having&nbsp;failed&nbsp;and&nbsp;stops&nbsp;its&nbsp;execution.</span><br>
<span class="lineno"></span><span class="comment" id="5688654">//&nbsp;Execution&nbsp;will&nbsp;continue&nbsp;at&nbsp;the&nbsp;next&nbsp;test&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno"></span><span class="comment" id="5688712">//&nbsp;FailNow&nbsp;must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;goroutine&nbsp;running&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5688769">//&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;function,&nbsp;not&nbsp;from&nbsp;other&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="5688826">//&nbsp;created&nbsp;during&nbsp;the&nbsp;test.&nbsp;Calling&nbsp;FailNow&nbsp;does&nbsp;not&nbsp;stop</span><br>
<span class="lineno">305</span><span class="comment" id="5688884">//&nbsp;those&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="5688911">func</span>&nbsp;<span class="op" id="5688916">(</span><span class="ident" id="5688917">c</span>&nbsp;<span class="op" id="5688919">*</span><span class="ident" id="5688920">common</span><span class="op" id="5688926">)</span>&nbsp;<span class="ident" id="5688928">FailNow</span><span class="op" id="5688935">(</span><span class="op" id="5688936">)</span>&nbsp;<span class="op" id="5688938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5688941">c</span><span class="op" id="5688942">.</span><span class="ident" id="5688943">Fail</span><span class="op" id="5688947">(</span><span class="op" id="5688948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5688952">//&nbsp;Calling&nbsp;runtime.Goexit&nbsp;will&nbsp;exit&nbsp;the&nbsp;goroutine,&nbsp;which</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689010">//&nbsp;will&nbsp;run&nbsp;the&nbsp;deferred&nbsp;functions&nbsp;in&nbsp;this&nbsp;goroutine,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689065">//&nbsp;which&nbsp;will&nbsp;eventually&nbsp;run&nbsp;the&nbsp;deferred&nbsp;lines&nbsp;in&nbsp;tRunner,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689126">//&nbsp;which&nbsp;will&nbsp;signal&nbsp;to&nbsp;the&nbsp;test&nbsp;loop&nbsp;that&nbsp;this&nbsp;test&nbsp;is&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689189">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689193">//&nbsp;A&nbsp;previous&nbsp;version&nbsp;of&nbsp;this&nbsp;code&nbsp;said:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689235">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689239">//&nbsp;&nbsp;&nbsp;&nbsp;c.duration&nbsp;=&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689260">//&nbsp;&nbsp;&nbsp;&nbsp;c.signal&nbsp;&lt;-&nbsp;c.self</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689283">//&nbsp;&nbsp;&nbsp;&nbsp;runtime.Goexit()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689304">//</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689308">//&nbsp;This&nbsp;previous&nbsp;version&nbsp;duplicated&nbsp;code&nbsp;(those&nbsp;lines&nbsp;are&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689370">//&nbsp;tRunner&nbsp;no&nbsp;matter&nbsp;what),&nbsp;but&nbsp;worse&nbsp;the&nbsp;goroutine&nbsp;teardown</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689432">//&nbsp;implicit&nbsp;in&nbsp;runtime.Goexit&nbsp;was&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;complete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689494">//&nbsp;before&nbsp;the&nbsp;test&nbsp;exited.&nbsp;&nbsp;If&nbsp;a&nbsp;test&nbsp;deferred&nbsp;an&nbsp;important&nbsp;cleanup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689563">//&nbsp;function&nbsp;(like&nbsp;removing&nbsp;temporary&nbsp;files),&nbsp;there&nbsp;was&nbsp;no&nbsp;guarantee</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689632">//&nbsp;it&nbsp;would&nbsp;run&nbsp;on&nbsp;a&nbsp;test&nbsp;failure.&nbsp;&nbsp;Because&nbsp;we&nbsp;send&nbsp;on&nbsp;c.signal&nbsp;during</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689704">//&nbsp;a&nbsp;top-of-stack&nbsp;deferred&nbsp;function&nbsp;now,&nbsp;we&nbsp;know&nbsp;that&nbsp;the&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5689768">//&nbsp;only&nbsp;happens&nbsp;after&nbsp;any&nbsp;other&nbsp;stacked&nbsp;defers&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5689832">c</span><span class="op" id="5689833">.</span><span class="ident" id="5689834">finished</span>&nbsp;<span class="op" id="5689843">=</span>&nbsp;<span class="builtintype" id="5689845">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5689851">runtime</span><span class="op" id="5689858">.</span><span class="ident" id="5689859">Goexit</span><span class="op" id="5689865">(</span><span class="op" id="5689866">)</span><br>
<span class="lineno">330</span><span class="op" id="5689868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5689871">//&nbsp;log&nbsp;generates&nbsp;the&nbsp;output.&nbsp;It&#39;s&nbsp;always&nbsp;at&nbsp;the&nbsp;same&nbsp;stack&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="5689937">func</span>&nbsp;<span class="op" id="5689942">(</span><span class="ident" id="5689943">c</span>&nbsp;<span class="op" id="5689945">*</span><span class="ident" id="5689946">common</span><span class="op" id="5689952">)</span>&nbsp;<span class="ident" id="5689954">log</span><span class="op" id="5689957">(</span><span class="ident" id="5689958">s</span>&nbsp;<span class="builtintype" id="5689960">string</span><span class="op" id="5689966">)</span>&nbsp;<span class="op" id="5689968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5689971">c</span><span class="op" id="5689972">.</span><span class="ident" id="5689973">mu</span><span class="op" id="5689975">.</span><span class="ident" id="5689976">Lock</span><span class="op" id="5689980">(</span><span class="op" id="5689981">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5689984">defer</span>&nbsp;<span class="ident" id="5689990">c</span><span class="op" id="5689991">.</span><span class="ident" id="5689992">mu</span><span class="op" id="5689994">.</span><span class="ident" id="5689995">Unlock</span><span class="op" id="5690001">(</span><span class="op" id="5690002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5690005">c</span><span class="op" id="5690006">.</span><span class="ident" id="5690007">output</span>&nbsp;<span class="op" id="5690014">=</span>&nbsp;<span class="builtinfunc" id="5690016">append</span><span class="op" id="5690022">(</span><span class="ident" id="5690023">c</span><span class="op" id="5690024">.</span><span class="ident" id="5690025">output</span><span class="op" id="5690031">,</span>&nbsp;<span class="ident" id="5690033">decorate</span><span class="op" id="5690041">(</span><span class="ident" id="5690042">s</span><span class="op" id="5690043">)</span><span class="op" id="5690044">...</span><span class="op" id="5690047">)</span><br>
<span class="lineno"></span><span class="op" id="5690049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5690052">//&nbsp;Log&nbsp;formats&nbsp;its&nbsp;arguments&nbsp;using&nbsp;default&nbsp;formatting,&nbsp;analogous&nbsp;to&nbsp;Println,</span><br>
<span class="lineno">340</span><span class="comment" id="5690129">//&nbsp;and&nbsp;records&nbsp;the&nbsp;text&nbsp;in&nbsp;the&nbsp;error&nbsp;log.&nbsp;The&nbsp;text&nbsp;will&nbsp;be&nbsp;printed&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5690204">//&nbsp;the&nbsp;test&nbsp;fails&nbsp;or&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="5690250">func</span>&nbsp;<span class="op" id="5690255">(</span><span class="ident" id="5690256">c</span>&nbsp;<span class="op" id="5690258">*</span><span class="ident" id="5690259">common</span><span class="op" id="5690265">)</span>&nbsp;<span class="ident" id="5690267">Log</span><span class="op" id="5690270">(</span><span class="ident" id="5690271">args</span>&nbsp;<span class="op" id="5690276">...</span><span class="keyword" id="5690279">interface</span><span class="op" id="5690288">{</span><span class="op" id="5690289">}</span><span class="op" id="5690290">)</span>&nbsp;<span class="op" id="5690292">{</span>&nbsp;<span class="ident" id="5690294">c</span><span class="op" id="5690295">.</span><span class="ident" id="5690296">log</span><span class="op" id="5690299">(</span><span class="ident" id="5690300">fmt</span><span class="op" id="5690303">.</span><span class="ident" id="5690304">Sprintln</span><span class="op" id="5690312">(</span><span class="ident" id="5690313">args</span><span class="op" id="5690317">...</span><span class="op" id="5690320">)</span><span class="op" id="5690321">)</span>&nbsp;<span class="op" id="5690323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5690326">//&nbsp;Logf&nbsp;formats&nbsp;its&nbsp;arguments&nbsp;according&nbsp;to&nbsp;the&nbsp;format,&nbsp;analogous&nbsp;to&nbsp;Printf,</span><br>
<span class="lineno">345</span><span class="comment" id="5690402">//&nbsp;and&nbsp;records&nbsp;the&nbsp;text&nbsp;in&nbsp;the&nbsp;error&nbsp;log.&nbsp;The&nbsp;text&nbsp;will&nbsp;be&nbsp;printed&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5690477">//&nbsp;the&nbsp;test&nbsp;fails&nbsp;or&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="5690523">func</span>&nbsp;<span class="op" id="5690528">(</span><span class="ident" id="5690529">c</span>&nbsp;<span class="op" id="5690531">*</span><span class="ident" id="5690532">common</span><span class="op" id="5690538">)</span>&nbsp;<span class="ident" id="5690540">Logf</span><span class="op" id="5690544">(</span><span class="ident" id="5690545">format</span>&nbsp;<span class="builtintype" id="5690552">string</span><span class="op" id="5690558">,</span>&nbsp;<span class="ident" id="5690560">args</span>&nbsp;<span class="op" id="5690565">...</span><span class="keyword" id="5690568">interface</span><span class="op" id="5690577">{</span><span class="op" id="5690578">}</span><span class="op" id="5690579">)</span>&nbsp;<span class="op" id="5690581">{</span>&nbsp;<span class="ident" id="5690583">c</span><span class="op" id="5690584">.</span><span class="ident" id="5690585">log</span><span class="op" id="5690588">(</span><span class="ident" id="5690589">fmt</span><span class="op" id="5690592">.</span><span class="ident" id="5690593">Sprintf</span><span class="op" id="5690600">(</span><span class="ident" id="5690601">format</span><span class="op" id="5690607">,</span>&nbsp;<span class="ident" id="5690609">args</span><span class="op" id="5690613">...</span><span class="op" id="5690616">)</span><span class="op" id="5690617">)</span>&nbsp;<span class="op" id="5690619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5690622">//&nbsp;Error&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;Fail.</span><br>
<span class="lineno">350</span><span class="keyword" id="5690670">func</span>&nbsp;<span class="op" id="5690675">(</span><span class="ident" id="5690676">c</span>&nbsp;<span class="op" id="5690678">*</span><span class="ident" id="5690679">common</span><span class="op" id="5690685">)</span>&nbsp;<span class="ident" id="5690687">Error</span><span class="op" id="5690692">(</span><span class="ident" id="5690693">args</span>&nbsp;<span class="op" id="5690698">...</span><span class="keyword" id="5690701">interface</span><span class="op" id="5690710">{</span><span class="op" id="5690711">}</span><span class="op" id="5690712">)</span>&nbsp;<span class="op" id="5690714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5690717">c</span><span class="op" id="5690718">.</span><span class="ident" id="5690719">log</span><span class="op" id="5690722">(</span><span class="ident" id="5690723">fmt</span><span class="op" id="5690726">.</span><span class="ident" id="5690727">Sprintln</span><span class="op" id="5690735">(</span><span class="ident" id="5690736">args</span><span class="op" id="5690740">...</span><span class="op" id="5690743">)</span><span class="op" id="5690744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5690747">c</span><span class="op" id="5690748">.</span><span class="ident" id="5690749">Fail</span><span class="op" id="5690753">(</span><span class="op" id="5690754">)</span><br>
<span class="lineno"></span><span class="op" id="5690756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="5690759">//&nbsp;Errorf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;Fail.</span><br>
<span class="lineno"></span><span class="keyword" id="5690809">func</span>&nbsp;<span class="op" id="5690814">(</span><span class="ident" id="5690815">c</span>&nbsp;<span class="op" id="5690817">*</span><span class="ident" id="5690818">common</span><span class="op" id="5690824">)</span>&nbsp;<span class="ident" id="5690826">Errorf</span><span class="op" id="5690832">(</span><span class="ident" id="5690833">format</span>&nbsp;<span class="builtintype" id="5690840">string</span><span class="op" id="5690846">,</span>&nbsp;<span class="ident" id="5690848">args</span>&nbsp;<span class="op" id="5690853">...</span><span class="keyword" id="5690856">interface</span><span class="op" id="5690865">{</span><span class="op" id="5690866">}</span><span class="op" id="5690867">)</span>&nbsp;<span class="op" id="5690869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5690872">c</span><span class="op" id="5690873">.</span><span class="ident" id="5690874">log</span><span class="op" id="5690877">(</span><span class="ident" id="5690878">fmt</span><span class="op" id="5690881">.</span><span class="ident" id="5690882">Sprintf</span><span class="op" id="5690889">(</span><span class="ident" id="5690890">format</span><span class="op" id="5690896">,</span>&nbsp;<span class="ident" id="5690898">args</span><span class="op" id="5690902">...</span><span class="op" id="5690905">)</span><span class="op" id="5690906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5690909">c</span><span class="op" id="5690910">.</span><span class="ident" id="5690911">Fail</span><span class="op" id="5690915">(</span><span class="op" id="5690916">)</span><br>
<span class="lineno"></span><span class="op" id="5690918">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5690921">//&nbsp;Fatal&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="keyword" id="5690972">func</span>&nbsp;<span class="op" id="5690977">(</span><span class="ident" id="5690978">c</span>&nbsp;<span class="op" id="5690980">*</span><span class="ident" id="5690981">common</span><span class="op" id="5690987">)</span>&nbsp;<span class="ident" id="5690989">Fatal</span><span class="op" id="5690994">(</span><span class="ident" id="5690995">args</span>&nbsp;<span class="op" id="5691000">...</span><span class="keyword" id="5691003">interface</span><span class="op" id="5691012">{</span><span class="op" id="5691013">}</span><span class="op" id="5691014">)</span>&nbsp;<span class="op" id="5691016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691019">c</span><span class="op" id="5691020">.</span><span class="ident" id="5691021">log</span><span class="op" id="5691024">(</span><span class="ident" id="5691025">fmt</span><span class="op" id="5691028">.</span><span class="ident" id="5691029">Sprintln</span><span class="op" id="5691037">(</span><span class="ident" id="5691038">args</span><span class="op" id="5691042">...</span><span class="op" id="5691045">)</span><span class="op" id="5691046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691049">c</span><span class="op" id="5691050">.</span><span class="ident" id="5691051">FailNow</span><span class="op" id="5691058">(</span><span class="op" id="5691059">)</span><br>
<span class="lineno">365</span><span class="op" id="5691061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5691064">//&nbsp;Fatalf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="keyword" id="5691117">func</span>&nbsp;<span class="op" id="5691122">(</span><span class="ident" id="5691123">c</span>&nbsp;<span class="op" id="5691125">*</span><span class="ident" id="5691126">common</span><span class="op" id="5691132">)</span>&nbsp;<span class="ident" id="5691134">Fatalf</span><span class="op" id="5691140">(</span><span class="ident" id="5691141">format</span>&nbsp;<span class="builtintype" id="5691148">string</span><span class="op" id="5691154">,</span>&nbsp;<span class="ident" id="5691156">args</span>&nbsp;<span class="op" id="5691161">...</span><span class="keyword" id="5691164">interface</span><span class="op" id="5691173">{</span><span class="op" id="5691174">}</span><span class="op" id="5691175">)</span>&nbsp;<span class="op" id="5691177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691180">c</span><span class="op" id="5691181">.</span><span class="ident" id="5691182">log</span><span class="op" id="5691185">(</span><span class="ident" id="5691186">fmt</span><span class="op" id="5691189">.</span><span class="ident" id="5691190">Sprintf</span><span class="op" id="5691197">(</span><span class="ident" id="5691198">format</span><span class="op" id="5691204">,</span>&nbsp;<span class="ident" id="5691206">args</span><span class="op" id="5691210">...</span><span class="op" id="5691213">)</span><span class="op" id="5691214">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691217">c</span><span class="op" id="5691218">.</span><span class="ident" id="5691219">FailNow</span><span class="op" id="5691226">(</span><span class="op" id="5691227">)</span><br>
<span class="lineno"></span><span class="op" id="5691229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5691232">//&nbsp;Skip&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;SkipNow.</span><br>
<span class="lineno"></span><span class="keyword" id="5691282">func</span>&nbsp;<span class="op" id="5691287">(</span><span class="ident" id="5691288">c</span>&nbsp;<span class="op" id="5691290">*</span><span class="ident" id="5691291">common</span><span class="op" id="5691297">)</span>&nbsp;<span class="ident" id="5691299">Skip</span><span class="op" id="5691303">(</span><span class="ident" id="5691304">args</span>&nbsp;<span class="op" id="5691309">...</span><span class="keyword" id="5691312">interface</span><span class="op" id="5691321">{</span><span class="op" id="5691322">}</span><span class="op" id="5691323">)</span>&nbsp;<span class="op" id="5691325">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691328">c</span><span class="op" id="5691329">.</span><span class="ident" id="5691330">log</span><span class="op" id="5691333">(</span><span class="ident" id="5691334">fmt</span><span class="op" id="5691337">.</span><span class="ident" id="5691338">Sprintln</span><span class="op" id="5691346">(</span><span class="ident" id="5691347">args</span><span class="op" id="5691351">...</span><span class="op" id="5691354">)</span><span class="op" id="5691355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691358">c</span><span class="op" id="5691359">.</span><span class="ident" id="5691360">SkipNow</span><span class="op" id="5691367">(</span><span class="op" id="5691368">)</span><br>
<span class="lineno"></span><span class="op" id="5691370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5691373">//&nbsp;Skipf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;SkipNow.</span><br>
<span class="lineno">380</span><span class="keyword" id="5691425">func</span>&nbsp;<span class="op" id="5691430">(</span><span class="ident" id="5691431">c</span>&nbsp;<span class="op" id="5691433">*</span><span class="ident" id="5691434">common</span><span class="op" id="5691440">)</span>&nbsp;<span class="ident" id="5691442">Skipf</span><span class="op" id="5691447">(</span><span class="ident" id="5691448">format</span>&nbsp;<span class="builtintype" id="5691455">string</span><span class="op" id="5691461">,</span>&nbsp;<span class="ident" id="5691463">args</span>&nbsp;<span class="op" id="5691468">...</span><span class="keyword" id="5691471">interface</span><span class="op" id="5691480">{</span><span class="op" id="5691481">}</span><span class="op" id="5691482">)</span>&nbsp;<span class="op" id="5691484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691487">c</span><span class="op" id="5691488">.</span><span class="ident" id="5691489">log</span><span class="op" id="5691492">(</span><span class="ident" id="5691493">fmt</span><span class="op" id="5691496">.</span><span class="ident" id="5691497">Sprintf</span><span class="op" id="5691504">(</span><span class="ident" id="5691505">format</span><span class="op" id="5691511">,</span>&nbsp;<span class="ident" id="5691513">args</span><span class="op" id="5691517">...</span><span class="op" id="5691520">)</span><span class="op" id="5691521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691524">c</span><span class="op" id="5691525">.</span><span class="ident" id="5691526">SkipNow</span><span class="op" id="5691533">(</span><span class="op" id="5691534">)</span><br>
<span class="lineno"></span><span class="op" id="5691536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5691539">//&nbsp;SkipNow&nbsp;marks&nbsp;the&nbsp;test&nbsp;as&nbsp;having&nbsp;been&nbsp;skipped&nbsp;and&nbsp;stops&nbsp;its&nbsp;execution.</span><br>
<span class="lineno"></span><span class="comment" id="5691613">//&nbsp;Execution&nbsp;will&nbsp;continue&nbsp;at&nbsp;the&nbsp;next&nbsp;test&nbsp;or&nbsp;benchmark.&nbsp;See&nbsp;also&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="comment" id="5691689">//&nbsp;SkipNow&nbsp;must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;goroutine&nbsp;running&nbsp;the&nbsp;test,&nbsp;not&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5691761">//&nbsp;other&nbsp;goroutines&nbsp;created&nbsp;during&nbsp;the&nbsp;test.&nbsp;Calling&nbsp;SkipNow&nbsp;does&nbsp;not&nbsp;stop</span><br>
<span class="lineno"></span><span class="comment" id="5691836">//&nbsp;those&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno">390</span><span class="keyword" id="5691863">func</span>&nbsp;<span class="op" id="5691868">(</span><span class="ident" id="5691869">c</span>&nbsp;<span class="op" id="5691871">*</span><span class="ident" id="5691872">common</span><span class="op" id="5691878">)</span>&nbsp;<span class="ident" id="5691880">SkipNow</span><span class="op" id="5691887">(</span><span class="op" id="5691888">)</span>&nbsp;<span class="op" id="5691890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691893">c</span><span class="op" id="5691894">.</span><span class="ident" id="5691895">skip</span><span class="op" id="5691899">(</span><span class="op" id="5691900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691903">c</span><span class="op" id="5691904">.</span><span class="ident" id="5691905">finished</span>&nbsp;<span class="op" id="5691914">=</span>&nbsp;<span class="builtintype" id="5691916">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691922">runtime</span><span class="op" id="5691929">.</span><span class="ident" id="5691930">Goexit</span><span class="op" id="5691936">(</span><span class="op" id="5691937">)</span><br>
<span class="lineno"></span><span class="op" id="5691939">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="5691942">func</span>&nbsp;<span class="op" id="5691947">(</span><span class="ident" id="5691948">c</span>&nbsp;<span class="op" id="5691950">*</span><span class="ident" id="5691951">common</span><span class="op" id="5691957">)</span>&nbsp;<span class="ident" id="5691959">skip</span><span class="op" id="5691963">(</span><span class="op" id="5691964">)</span>&nbsp;<span class="op" id="5691966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5691969">c</span><span class="op" id="5691970">.</span><span class="ident" id="5691971">mu</span><span class="op" id="5691973">.</span><span class="ident" id="5691974">Lock</span><span class="op" id="5691978">(</span><span class="op" id="5691979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5691982">defer</span>&nbsp;<span class="ident" id="5691988">c</span><span class="op" id="5691989">.</span><span class="ident" id="5691990">mu</span><span class="op" id="5691992">.</span><span class="ident" id="5691993">Unlock</span><span class="op" id="5691999">(</span><span class="op" id="5692000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5692003">c</span><span class="op" id="5692004">.</span><span class="ident" id="5692005">skipped</span>&nbsp;<span class="op" id="5692013">=</span>&nbsp;<span class="builtintype" id="5692015">true</span><br>
<span class="lineno">400</span><span class="op" id="5692020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5692023">//&nbsp;Skipped&nbsp;reports&nbsp;whether&nbsp;the&nbsp;test&nbsp;was&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="keyword" id="5692072">func</span>&nbsp;<span class="op" id="5692077">(</span><span class="ident" id="5692078">c</span>&nbsp;<span class="op" id="5692080">*</span><span class="ident" id="5692081">common</span><span class="op" id="5692087">)</span>&nbsp;<span class="ident" id="5692089">Skipped</span><span class="op" id="5692096">(</span><span class="op" id="5692097">)</span>&nbsp;<span class="builtintype" id="5692099">bool</span>&nbsp;<span class="op" id="5692104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5692107">c</span><span class="op" id="5692108">.</span><span class="ident" id="5692109">mu</span><span class="op" id="5692111">.</span><span class="ident" id="5692112">RLock</span><span class="op" id="5692117">(</span><span class="op" id="5692118">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5692121">defer</span>&nbsp;<span class="ident" id="5692127">c</span><span class="op" id="5692128">.</span><span class="ident" id="5692129">mu</span><span class="op" id="5692131">.</span><span class="ident" id="5692132">RUnlock</span><span class="op" id="5692139">(</span><span class="op" id="5692140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5692143">return</span>&nbsp;<span class="ident" id="5692150">c</span><span class="op" id="5692151">.</span><span class="ident" id="5692152">skipped</span><br>
<span class="lineno"></span><span class="op" id="5692160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5692163">//&nbsp;Parallel&nbsp;signals&nbsp;that&nbsp;this&nbsp;test&nbsp;is&nbsp;to&nbsp;be&nbsp;run&nbsp;in&nbsp;parallel&nbsp;with&nbsp;(and&nbsp;only&nbsp;with)</span><br>
<span class="lineno">410</span><span class="comment" id="5692244">//&nbsp;other&nbsp;parallel&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="5692269">func</span>&nbsp;<span class="op" id="5692274">(</span><span class="ident" id="5692275">t</span>&nbsp;<span class="op" id="5692277">*</span><span class="ident" id="5692278">T</span><span class="op" id="5692279">)</span>&nbsp;<span class="ident" id="5692281">Parallel</span><span class="op" id="5692289">(</span><span class="op" id="5692290">)</span>&nbsp;<span class="op" id="5692292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5692295">t</span><span class="op" id="5692296">.</span><span class="ident" id="5692297">signal</span>&nbsp;<span class="op" id="5692304">&lt;-</span>&nbsp;<span class="op" id="5692307">(</span><span class="op" id="5692308">*</span><span class="ident" id="5692309">T</span><span class="op" id="5692310">)</span><span class="op" id="5692311">(</span><span class="ident" id="5692312">nil</span><span class="op" id="5692315">)</span>&nbsp;<span class="comment" id="5692317">//&nbsp;Release&nbsp;main&nbsp;testing&nbsp;loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5692347">&lt;-</span><span class="ident" id="5692349">t</span><span class="op" id="5692350">.</span><span class="ident" id="5692351">startParallel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692369">//&nbsp;Wait&nbsp;for&nbsp;serial&nbsp;tests&nbsp;to&nbsp;finish</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692405">//&nbsp;Assuming&nbsp;Parallel&nbsp;is&nbsp;the&nbsp;first&nbsp;thing&nbsp;a&nbsp;test&nbsp;does,&nbsp;which&nbsp;is&nbsp;reasonable,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692480">//&nbsp;reinitialize&nbsp;the&nbsp;test&#39;s&nbsp;start&nbsp;time&nbsp;because&nbsp;it&#39;s&nbsp;actually&nbsp;starting&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5692555">t</span><span class="op" id="5692556">.</span><span class="ident" id="5692557">start</span>&nbsp;<span class="op" id="5692563">=</span>&nbsp;<span class="ident" id="5692565">time</span><span class="op" id="5692569">.</span><span class="ident" id="5692570">Now</span><span class="op" id="5692573">(</span><span class="op" id="5692574">)</span><br>
<span class="lineno"></span><span class="op" id="5692576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5692579">//&nbsp;An&nbsp;internal&nbsp;type&nbsp;but&nbsp;exported&nbsp;because&nbsp;it&nbsp;is&nbsp;cross-package;&nbsp;part&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno">420</span><span class="comment" id="5692668">//&nbsp;of&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5692697">type</span>&nbsp;<span class="ident" id="5692702">InternalTest</span>&nbsp;<span class="keyword" id="5692715">struct</span>&nbsp;<span class="op" id="5692722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5692725">Name</span>&nbsp;<span class="builtintype" id="5692730">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5692738">F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5692743">func</span><span class="op" id="5692747">(</span><span class="op" id="5692748">*</span><span class="ident" id="5692749">T</span><span class="op" id="5692750">)</span><br>
<span class="lineno"></span><span class="op" id="5692752">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="5692755">func</span>&nbsp;<span class="ident" id="5692760">tRunner</span><span class="op" id="5692767">(</span><span class="ident" id="5692768">t</span>&nbsp;<span class="op" id="5692770">*</span><span class="ident" id="5692771">T</span><span class="op" id="5692772">,</span>&nbsp;<span class="ident" id="5692774">test</span>&nbsp;<span class="op" id="5692779">*</span><span class="ident" id="5692780">InternalTest</span><span class="op" id="5692792">)</span>&nbsp;<span class="op" id="5692794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692797">//&nbsp;When&nbsp;this&nbsp;goroutine&nbsp;is&nbsp;done,&nbsp;either&nbsp;because&nbsp;test.F(t)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692855">//&nbsp;returned&nbsp;normally&nbsp;or&nbsp;because&nbsp;a&nbsp;test&nbsp;failure&nbsp;triggered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692913">//&nbsp;a&nbsp;call&nbsp;to&nbsp;runtime.Goexit,&nbsp;record&nbsp;the&nbsp;duration&nbsp;and&nbsp;send</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5692972">//&nbsp;a&nbsp;signal&nbsp;saying&nbsp;that&nbsp;the&nbsp;test&nbsp;is&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5693015">defer</span>&nbsp;<span class="keyword" id="5693021">func</span><span class="op" id="5693025">(</span><span class="op" id="5693026">)</span>&nbsp;<span class="op" id="5693028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693032">t</span><span class="op" id="5693033">.</span><span class="ident" id="5693034">duration</span>&nbsp;<span class="op" id="5693043">=</span>&nbsp;<span class="ident" id="5693045">time</span><span class="op" id="5693049">.</span><span class="ident" id="5693050">Now</span><span class="op" id="5693053">(</span><span class="op" id="5693054">)</span><span class="op" id="5693055">.</span><span class="ident" id="5693056">Sub</span><span class="op" id="5693059">(</span><span class="ident" id="5693060">t</span><span class="op" id="5693061">.</span><span class="ident" id="5693062">start</span><span class="op" id="5693067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5693071">//&nbsp;If&nbsp;the&nbsp;test&nbsp;panicked,&nbsp;print&nbsp;any&nbsp;test&nbsp;output&nbsp;before&nbsp;dying.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693134">err</span>&nbsp;<span class="op" id="5693138">:=</span>&nbsp;<span class="builtinfunc" id="5693141">recover</span><span class="op" id="5693148">(</span><span class="op" id="5693149">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5693153">if</span>&nbsp;<span class="op" id="5693156">!</span><span class="ident" id="5693157">t</span><span class="op" id="5693158">.</span><span class="ident" id="5693159">finished</span>&nbsp;<span class="op" id="5693168">&amp;&amp;</span>&nbsp;<span class="ident" id="5693171">err</span>&nbsp;<span class="op" id="5693175">==</span>&nbsp;<span class="ident" id="5693178">nil</span>&nbsp;<span class="op" id="5693182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693187">err</span>&nbsp;<span class="op" id="5693191">=</span>&nbsp;<span class="ident" id="5693193">fmt</span><span class="op" id="5693196">.</span><span class="ident" id="5693197">Errorf</span><span class="op" id="5693203">(</span><span class="string" id="5693204">&#34;test&nbsp;executed&nbsp;panic(nil)&nbsp;or&nbsp;runtime.Goexit&#34;</span><span class="op" id="5693248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5693256">if</span>&nbsp;<span class="ident" id="5693259">err</span>&nbsp;<span class="op" id="5693263">!=</span>&nbsp;<span class="ident" id="5693266">nil</span>&nbsp;<span class="op" id="5693270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693275">t</span><span class="op" id="5693276">.</span><span class="ident" id="5693277">Fail</span><span class="op" id="5693281">(</span><span class="op" id="5693282">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693287">t</span><span class="op" id="5693288">.</span><span class="ident" id="5693289">report</span><span class="op" id="5693295">(</span><span class="op" id="5693296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5693301">panic</span><span class="op" id="5693306">(</span><span class="ident" id="5693307">err</span><span class="op" id="5693310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693318">t</span><span class="op" id="5693319">.</span><span class="ident" id="5693320">signal</span>&nbsp;<span class="op" id="5693327">&lt;-</span>&nbsp;<span class="ident" id="5693330">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693333">}</span><span class="op" id="5693334">(</span><span class="op" id="5693335">)</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693339">t</span><span class="op" id="5693340">.</span><span class="ident" id="5693341">start</span>&nbsp;<span class="op" id="5693347">=</span>&nbsp;<span class="ident" id="5693349">time</span><span class="op" id="5693353">.</span><span class="ident" id="5693354">Now</span><span class="op" id="5693357">(</span><span class="op" id="5693358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693361">test</span><span class="op" id="5693365">.</span><span class="ident" id="5693366">F</span><span class="op" id="5693367">(</span><span class="ident" id="5693368">t</span><span class="op" id="5693369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693372">t</span><span class="op" id="5693373">.</span><span class="ident" id="5693374">finished</span>&nbsp;<span class="op" id="5693383">=</span>&nbsp;<span class="builtintype" id="5693385">true</span><br>
<span class="lineno"></span><span class="op" id="5693390">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="5693393">//&nbsp;An&nbsp;internal&nbsp;function&nbsp;but&nbsp;exported&nbsp;because&nbsp;it&nbsp;is&nbsp;cross-package;&nbsp;part&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="5693486">//&nbsp;of&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5693515">func</span>&nbsp;<span class="ident" id="5693520">Main</span><span class="op" id="5693524">(</span><span class="ident" id="5693525">matchString</span>&nbsp;<span class="keyword" id="5693537">func</span><span class="op" id="5693541">(</span><span class="ident" id="5693542">pat</span><span class="op" id="5693545">,</span>&nbsp;<span class="ident" id="5693547">str</span>&nbsp;<span class="builtintype" id="5693551">string</span><span class="op" id="5693557">)</span>&nbsp;<span class="op" id="5693559">(</span><span class="builtintype" id="5693560">bool</span><span class="op" id="5693564">,</span>&nbsp;<span class="builtintype" id="5693566">error</span><span class="op" id="5693571">)</span><span class="op" id="5693572">,</span>&nbsp;<span class="ident" id="5693574">tests</span>&nbsp;<span class="op" id="5693580">[</span><span class="op" id="5693581">]</span><span class="ident" id="5693582">InternalTest</span><span class="op" id="5693594">,</span>&nbsp;<span class="ident" id="5693596">benchmarks</span>&nbsp;<span class="op" id="5693607">[</span><span class="op" id="5693608">]</span><span class="ident" id="5693609">InternalBenchmark</span><span class="op" id="5693626">,</span>&nbsp;<span class="ident" id="5693628">examples</span>&nbsp;<span class="op" id="5693637">[</span><span class="op" id="5693638">]</span><span class="ident" id="5693639">InternalExample</span><span class="op" id="5693654">)</span>&nbsp;<span class="op" id="5693656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693659">os</span><span class="op" id="5693661">.</span><span class="ident" id="5693662">Exit</span><span class="op" id="5693666">(</span><span class="ident" id="5693667">MainStart</span><span class="op" id="5693676">(</span><span class="ident" id="5693677">matchString</span><span class="op" id="5693688">,</span>&nbsp;<span class="ident" id="5693690">tests</span><span class="op" id="5693695">,</span>&nbsp;<span class="ident" id="5693697">benchmarks</span><span class="op" id="5693707">,</span>&nbsp;<span class="ident" id="5693709">examples</span><span class="op" id="5693717">)</span><span class="op" id="5693718">.</span><span class="ident" id="5693719">Run</span><span class="op" id="5693722">(</span><span class="op" id="5693723">)</span><span class="op" id="5693724">)</span><br>
<span class="lineno">455</span><span class="op" id="5693726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5693729">//&nbsp;M&nbsp;is&nbsp;a&nbsp;type&nbsp;passed&nbsp;to&nbsp;a&nbsp;TestMain&nbsp;function&nbsp;to&nbsp;run&nbsp;the&nbsp;actual&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="5693799">type</span>&nbsp;<span class="ident" id="5693804">M</span>&nbsp;<span class="keyword" id="5693806">struct</span>&nbsp;<span class="op" id="5693813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693816">matchString</span>&nbsp;<span class="keyword" id="5693828">func</span><span class="op" id="5693832">(</span><span class="ident" id="5693833">pat</span><span class="op" id="5693836">,</span>&nbsp;<span class="ident" id="5693838">str</span>&nbsp;<span class="builtintype" id="5693842">string</span><span class="op" id="5693848">)</span>&nbsp;<span class="op" id="5693850">(</span><span class="builtintype" id="5693851">bool</span><span class="op" id="5693855">,</span>&nbsp;<span class="builtintype" id="5693857">error</span><span class="op" id="5693862">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693865">tests</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693877">[</span><span class="op" id="5693878">]</span><span class="ident" id="5693879">InternalTest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693893">benchmarks</span>&nbsp;&nbsp;<span class="op" id="5693905">[</span><span class="op" id="5693906">]</span><span class="ident" id="5693907">InternalBenchmark</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5693926">examples</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5693938">[</span><span class="op" id="5693939">]</span><span class="ident" id="5693940">InternalExample</span><br>
<span class="lineno"></span><span class="op" id="5693956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="5693959">//&nbsp;MainStart&nbsp;is&nbsp;meant&nbsp;for&nbsp;use&nbsp;by&nbsp;tests&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="5694022">//&nbsp;It&nbsp;is&nbsp;not&nbsp;meant&nbsp;to&nbsp;be&nbsp;called&nbsp;directly&nbsp;and&nbsp;is&nbsp;not&nbsp;subject&nbsp;to&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;document.</span><br>
<span class="lineno"></span><span class="comment" id="5694118">//&nbsp;It&nbsp;may&nbsp;change&nbsp;signature&nbsp;from&nbsp;release&nbsp;to&nbsp;release.</span><br>
<span class="lineno"></span><span class="keyword" id="5694170">func</span>&nbsp;<span class="ident" id="5694175">MainStart</span><span class="op" id="5694184">(</span><span class="ident" id="5694185">matchString</span>&nbsp;<span class="keyword" id="5694197">func</span><span class="op" id="5694201">(</span><span class="ident" id="5694202">pat</span><span class="op" id="5694205">,</span>&nbsp;<span class="ident" id="5694207">str</span>&nbsp;<span class="builtintype" id="5694211">string</span><span class="op" id="5694217">)</span>&nbsp;<span class="op" id="5694219">(</span><span class="builtintype" id="5694220">bool</span><span class="op" id="5694224">,</span>&nbsp;<span class="builtintype" id="5694226">error</span><span class="op" id="5694231">)</span><span class="op" id="5694232">,</span>&nbsp;<span class="ident" id="5694234">tests</span>&nbsp;<span class="op" id="5694240">[</span><span class="op" id="5694241">]</span><span class="ident" id="5694242">InternalTest</span><span class="op" id="5694254">,</span>&nbsp;<span class="ident" id="5694256">benchmarks</span>&nbsp;<span class="op" id="5694267">[</span><span class="op" id="5694268">]</span><span class="ident" id="5694269">InternalBenchmark</span><span class="op" id="5694286">,</span>&nbsp;<span class="ident" id="5694288">examples</span>&nbsp;<span class="op" id="5694297">[</span><span class="op" id="5694298">]</span><span class="ident" id="5694299">InternalExample</span><span class="op" id="5694314">)</span>&nbsp;<span class="op" id="5694316">*</span><span class="ident" id="5694317">M</span>&nbsp;<span class="op" id="5694319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694322">return</span>&nbsp;<span class="op" id="5694329">&amp;</span><span class="ident" id="5694330">M</span><span class="op" id="5694331">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694335">matchString</span><span class="op" id="5694346">:</span>&nbsp;<span class="ident" id="5694348">matchString</span><span class="op" id="5694359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694363">tests</span><span class="op" id="5694368">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694376">tests</span><span class="op" id="5694381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694385">benchmarks</span><span class="op" id="5694395">:</span>&nbsp;&nbsp;<span class="ident" id="5694398">benchmarks</span><span class="op" id="5694408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694412">examples</span><span class="op" id="5694420">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694425">examples</span><span class="op" id="5694433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5694436">}</span><br>
<span class="lineno">475</span><span class="op" id="5694438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5694441">//&nbsp;Run&nbsp;runs&nbsp;the&nbsp;tests.&nbsp;It&nbsp;returns&nbsp;an&nbsp;exit&nbsp;code&nbsp;to&nbsp;pass&nbsp;to&nbsp;os.Exit.</span><br>
<span class="lineno"></span><span class="keyword" id="5694508">func</span>&nbsp;<span class="op" id="5694513">(</span><span class="ident" id="5694514">m</span>&nbsp;<span class="op" id="5694516">*</span><span class="ident" id="5694517">M</span><span class="op" id="5694518">)</span>&nbsp;<span class="ident" id="5694520">Run</span><span class="op" id="5694523">(</span><span class="op" id="5694524">)</span>&nbsp;<span class="builtintype" id="5694526">int</span>&nbsp;<span class="op" id="5694530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694533">flag</span><span class="op" id="5694537">.</span><span class="ident" id="5694538">Parse</span><span class="op" id="5694543">(</span><span class="op" id="5694544">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694547">parseCpuList</span><span class="op" id="5694559">(</span><span class="op" id="5694560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694564">before</span><span class="op" id="5694570">(</span><span class="op" id="5694571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694574">startAlarm</span><span class="op" id="5694584">(</span><span class="op" id="5694585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694588">haveExamples</span>&nbsp;<span class="op" id="5694601">=</span>&nbsp;<span class="builtinfunc" id="5694603">len</span><span class="op" id="5694606">(</span><span class="ident" id="5694607">m</span><span class="op" id="5694608">.</span><span class="ident" id="5694609">examples</span><span class="op" id="5694617">)</span>&nbsp;<span class="op" id="5694619">&gt;</span>&nbsp;<span class="num" id="5694621">0</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694624">testOk</span>&nbsp;<span class="op" id="5694631">:=</span>&nbsp;<span class="ident" id="5694634">RunTests</span><span class="op" id="5694642">(</span><span class="ident" id="5694643">m</span><span class="op" id="5694644">.</span><span class="ident" id="5694645">matchString</span><span class="op" id="5694656">,</span>&nbsp;<span class="ident" id="5694658">m</span><span class="op" id="5694659">.</span><span class="ident" id="5694660">tests</span><span class="op" id="5694665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694668">exampleOk</span>&nbsp;<span class="op" id="5694678">:=</span>&nbsp;<span class="ident" id="5694681">RunExamples</span><span class="op" id="5694692">(</span><span class="ident" id="5694693">m</span><span class="op" id="5694694">.</span><span class="ident" id="5694695">matchString</span><span class="op" id="5694706">,</span>&nbsp;<span class="ident" id="5694708">m</span><span class="op" id="5694709">.</span><span class="ident" id="5694710">examples</span><span class="op" id="5694718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694721">stopAlarm</span><span class="op" id="5694730">(</span><span class="op" id="5694731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694734">if</span>&nbsp;<span class="op" id="5694737">!</span><span class="ident" id="5694738">testOk</span>&nbsp;<span class="op" id="5694745">||</span>&nbsp;<span class="op" id="5694748">!</span><span class="ident" id="5694749">exampleOk</span>&nbsp;<span class="op" id="5694759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694763">fmt</span><span class="op" id="5694766">.</span><span class="ident" id="5694767">Println</span><span class="op" id="5694774">(</span><span class="string" id="5694775">&#34;FAIL&#34;</span><span class="op" id="5694781">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694785">after</span><span class="op" id="5694790">(</span><span class="op" id="5694791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694795">return</span>&nbsp;<span class="num" id="5694802">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5694805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694808">fmt</span><span class="op" id="5694811">.</span><span class="ident" id="5694812">Println</span><span class="op" id="5694819">(</span><span class="string" id="5694820">&#34;PASS&#34;</span><span class="op" id="5694826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694829">RunBenchmarks</span><span class="op" id="5694842">(</span><span class="ident" id="5694843">m</span><span class="op" id="5694844">.</span><span class="ident" id="5694845">matchString</span><span class="op" id="5694856">,</span>&nbsp;<span class="ident" id="5694858">m</span><span class="op" id="5694859">.</span><span class="ident" id="5694860">benchmarks</span><span class="op" id="5694870">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694873">after</span><span class="op" id="5694878">(</span><span class="op" id="5694879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694882">return</span>&nbsp;<span class="num" id="5694889">0</span><br>
<span class="lineno"></span><span class="op" id="5694891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694894">func</span>&nbsp;<span class="op" id="5694899">(</span><span class="ident" id="5694900">t</span>&nbsp;<span class="op" id="5694902">*</span><span class="ident" id="5694903">T</span><span class="op" id="5694904">)</span>&nbsp;<span class="ident" id="5694906">report</span><span class="op" id="5694912">(</span><span class="op" id="5694913">)</span>&nbsp;<span class="op" id="5694915">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694918">dstr</span>&nbsp;<span class="op" id="5694923">:=</span>&nbsp;<span class="ident" id="5694926">fmtDuration</span><span class="op" id="5694937">(</span><span class="ident" id="5694938">t</span><span class="op" id="5694939">.</span><span class="ident" id="5694940">duration</span><span class="op" id="5694948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5694951">format</span>&nbsp;<span class="op" id="5694958">:=</span>&nbsp;<span class="string" id="5694961">&#34;---&nbsp;%s:&nbsp;%s&nbsp;(%s)\n%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5694984">if</span>&nbsp;<span class="ident" id="5694987">t</span><span class="op" id="5694988">.</span><span class="ident" id="5694989">Failed</span><span class="op" id="5694995">(</span><span class="op" id="5694996">)</span>&nbsp;<span class="op" id="5694998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695002">fmt</span><span class="op" id="5695005">.</span><span class="ident" id="5695006">Printf</span><span class="op" id="5695012">(</span><span class="ident" id="5695013">format</span><span class="op" id="5695019">,</span>&nbsp;<span class="string" id="5695021">&#34;FAIL&#34;</span><span class="op" id="5695027">,</span>&nbsp;<span class="ident" id="5695029">t</span><span class="op" id="5695030">.</span><span class="ident" id="5695031">name</span><span class="op" id="5695035">,</span>&nbsp;<span class="ident" id="5695037">dstr</span><span class="op" id="5695041">,</span>&nbsp;<span class="ident" id="5695043">t</span><span class="op" id="5695044">.</span><span class="ident" id="5695045">output</span><span class="op" id="5695051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695054">}</span>&nbsp;<span class="keyword" id="5695056">else</span>&nbsp;<span class="keyword" id="5695061">if</span>&nbsp;<span class="op" id="5695064">*</span><span class="ident" id="5695065">chatty</span>&nbsp;<span class="op" id="5695072">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695076">if</span>&nbsp;<span class="ident" id="5695079">t</span><span class="op" id="5695080">.</span><span class="ident" id="5695081">Skipped</span><span class="op" id="5695088">(</span><span class="op" id="5695089">)</span>&nbsp;<span class="op" id="5695091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695096">fmt</span><span class="op" id="5695099">.</span><span class="ident" id="5695100">Printf</span><span class="op" id="5695106">(</span><span class="ident" id="5695107">format</span><span class="op" id="5695113">,</span>&nbsp;<span class="string" id="5695115">&#34;SKIP&#34;</span><span class="op" id="5695121">,</span>&nbsp;<span class="ident" id="5695123">t</span><span class="op" id="5695124">.</span><span class="ident" id="5695125">name</span><span class="op" id="5695129">,</span>&nbsp;<span class="ident" id="5695131">dstr</span><span class="op" id="5695135">,</span>&nbsp;<span class="ident" id="5695137">t</span><span class="op" id="5695138">.</span><span class="ident" id="5695139">output</span><span class="op" id="5695145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695149">}</span>&nbsp;<span class="keyword" id="5695151">else</span>&nbsp;<span class="op" id="5695156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695161">fmt</span><span class="op" id="5695164">.</span><span class="ident" id="5695165">Printf</span><span class="op" id="5695171">(</span><span class="ident" id="5695172">format</span><span class="op" id="5695178">,</span>&nbsp;<span class="string" id="5695180">&#34;PASS&#34;</span><span class="op" id="5695186">,</span>&nbsp;<span class="ident" id="5695188">t</span><span class="op" id="5695189">.</span><span class="ident" id="5695190">name</span><span class="op" id="5695194">,</span>&nbsp;<span class="ident" id="5695196">dstr</span><span class="op" id="5695200">,</span>&nbsp;<span class="ident" id="5695202">t</span><span class="op" id="5695203">.</span><span class="ident" id="5695204">output</span><span class="op" id="5695210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695214">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695217">}</span><br>
<span class="lineno"></span><span class="op" id="5695219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695222">func</span>&nbsp;<span class="ident" id="5695227">RunTests</span><span class="op" id="5695235">(</span><span class="ident" id="5695236">matchString</span>&nbsp;<span class="keyword" id="5695248">func</span><span class="op" id="5695252">(</span><span class="ident" id="5695253">pat</span><span class="op" id="5695256">,</span>&nbsp;<span class="ident" id="5695258">str</span>&nbsp;<span class="builtintype" id="5695262">string</span><span class="op" id="5695268">)</span>&nbsp;<span class="op" id="5695270">(</span><span class="builtintype" id="5695271">bool</span><span class="op" id="5695275">,</span>&nbsp;<span class="builtintype" id="5695277">error</span><span class="op" id="5695282">)</span><span class="op" id="5695283">,</span>&nbsp;<span class="ident" id="5695285">tests</span>&nbsp;<span class="op" id="5695291">[</span><span class="op" id="5695292">]</span><span class="ident" id="5695293">InternalTest</span><span class="op" id="5695305">)</span>&nbsp;<span class="op" id="5695307">(</span><span class="ident" id="5695308">ok</span>&nbsp;<span class="builtintype" id="5695311">bool</span><span class="op" id="5695315">)</span>&nbsp;<span class="op" id="5695317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695320">ok</span>&nbsp;<span class="op" id="5695323">=</span>&nbsp;<span class="builtintype" id="5695325">true</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695331">if</span>&nbsp;<span class="builtinfunc" id="5695334">len</span><span class="op" id="5695337">(</span><span class="ident" id="5695338">tests</span><span class="op" id="5695343">)</span>&nbsp;<span class="op" id="5695345">==</span>&nbsp;<span class="num" id="5695348">0</span>&nbsp;<span class="op" id="5695350">&amp;&amp;</span>&nbsp;<span class="op" id="5695353">!</span><span class="ident" id="5695354">haveExamples</span>&nbsp;<span class="op" id="5695367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695371">fmt</span><span class="op" id="5695374">.</span><span class="ident" id="5695375">Fprintln</span><span class="op" id="5695383">(</span><span class="ident" id="5695384">os</span><span class="op" id="5695386">.</span><span class="ident" id="5695387">Stderr</span><span class="op" id="5695393">,</span>&nbsp;<span class="string" id="5695395">&#34;testing:&nbsp;warning:&nbsp;no&nbsp;tests&nbsp;to&nbsp;run&#34;</span><span class="op" id="5695430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695434">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695445">for</span>&nbsp;<span class="ident" id="5695449">_</span><span class="op" id="5695450">,</span>&nbsp;<span class="ident" id="5695452">procs</span>&nbsp;<span class="op" id="5695458">:=</span>&nbsp;<span class="keyword" id="5695461">range</span>&nbsp;<span class="ident" id="5695467">cpuList</span>&nbsp;<span class="op" id="5695475">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695479">runtime</span><span class="op" id="5695486">.</span><span class="ident" id="5695487">GOMAXPROCS</span><span class="op" id="5695497">(</span><span class="ident" id="5695498">procs</span><span class="op" id="5695503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5695507">//&nbsp;We&nbsp;build&nbsp;a&nbsp;new&nbsp;channel&nbsp;tree&nbsp;for&nbsp;each&nbsp;run&nbsp;of&nbsp;the&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5695566">//&nbsp;collector&nbsp;merges&nbsp;in&nbsp;one&nbsp;channel&nbsp;all&nbsp;the&nbsp;upstream&nbsp;signals&nbsp;from&nbsp;parallel&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5695649">//&nbsp;If&nbsp;all&nbsp;tests&nbsp;pump&nbsp;to&nbsp;the&nbsp;same&nbsp;channel,&nbsp;a&nbsp;bug&nbsp;can&nbsp;occur&nbsp;where&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5695722">//&nbsp;kicks&nbsp;off&nbsp;a&nbsp;goroutine&nbsp;that&nbsp;Fails,&nbsp;yet&nbsp;the&nbsp;test&nbsp;still&nbsp;delivers&nbsp;a&nbsp;completion&nbsp;signal,</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5695810">//&nbsp;which&nbsp;skews&nbsp;the&nbsp;counting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695841">var</span>&nbsp;<span class="ident" id="5695845">collector</span>&nbsp;<span class="op" id="5695855">=</span>&nbsp;<span class="builtinfunc" id="5695857">make</span><span class="op" id="5695861">(</span><span class="keyword" id="5695862">chan</span>&nbsp;<span class="keyword" id="5695867">interface</span><span class="op" id="5695876">{</span><span class="op" id="5695877">}</span><span class="op" id="5695878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695883">numParallel</span>&nbsp;<span class="op" id="5695895">:=</span>&nbsp;<span class="num" id="5695898">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695902">startParallel</span>&nbsp;<span class="op" id="5695916">:=</span>&nbsp;<span class="builtinfunc" id="5695919">make</span><span class="op" id="5695923">(</span><span class="keyword" id="5695924">chan</span>&nbsp;<span class="builtintype" id="5695929">bool</span><span class="op" id="5695933">)</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695938">for</span>&nbsp;<span class="ident" id="5695942">i</span>&nbsp;<span class="op" id="5695944">:=</span>&nbsp;<span class="num" id="5695947">0</span><span class="op" id="5695948">;</span>&nbsp;<span class="ident" id="5695950">i</span>&nbsp;<span class="op" id="5695952">&lt;</span>&nbsp;<span class="builtinfunc" id="5695954">len</span><span class="op" id="5695957">(</span><span class="ident" id="5695958">tests</span><span class="op" id="5695963">)</span><span class="op" id="5695964">;</span>&nbsp;<span class="ident" id="5695966">i</span><span class="op" id="5695967">++</span>&nbsp;<span class="op" id="5695970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695975">matched</span><span class="op" id="5695982">,</span>&nbsp;<span class="ident" id="5695984">err</span>&nbsp;<span class="op" id="5695988">:=</span>&nbsp;<span class="ident" id="5695991">matchString</span><span class="op" id="5696002">(</span><span class="op" id="5696003">*</span><span class="ident" id="5696004">match</span><span class="op" id="5696009">,</span>&nbsp;<span class="ident" id="5696011">tests</span><span class="op" id="5696016">[</span><span class="ident" id="5696017">i</span><span class="op" id="5696018">]</span><span class="op" id="5696019">.</span><span class="ident" id="5696020">Name</span><span class="op" id="5696024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696029">if</span>&nbsp;<span class="ident" id="5696032">err</span>&nbsp;<span class="op" id="5696036">!=</span>&nbsp;<span class="ident" id="5696039">nil</span>&nbsp;<span class="op" id="5696043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696049">fmt</span><span class="op" id="5696052">.</span><span class="ident" id="5696053">Fprintf</span><span class="op" id="5696060">(</span><span class="ident" id="5696061">os</span><span class="op" id="5696063">.</span><span class="ident" id="5696064">Stderr</span><span class="op" id="5696070">,</span>&nbsp;<span class="string" id="5696072">&#34;testing:&nbsp;invalid&nbsp;regexp&nbsp;for&nbsp;-test.run:&nbsp;%s\n&#34;</span><span class="op" id="5696117">,</span>&nbsp;<span class="ident" id="5696119">err</span><span class="op" id="5696122">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696128">os</span><span class="op" id="5696130">.</span><span class="ident" id="5696131">Exit</span><span class="op" id="5696135">(</span><span class="num" id="5696136">1</span><span class="op" id="5696137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696147">if</span>&nbsp;<span class="op" id="5696150">!</span><span class="ident" id="5696151">matched</span>&nbsp;<span class="op" id="5696159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696165">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696177">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696182">testName</span>&nbsp;<span class="op" id="5696191">:=</span>&nbsp;<span class="ident" id="5696194">tests</span><span class="op" id="5696199">[</span><span class="ident" id="5696200">i</span><span class="op" id="5696201">]</span><span class="op" id="5696202">.</span><span class="ident" id="5696203">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696211">if</span>&nbsp;<span class="ident" id="5696214">procs</span>&nbsp;<span class="op" id="5696220">!=</span>&nbsp;<span class="num" id="5696223">1</span>&nbsp;<span class="op" id="5696225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696231">testName</span>&nbsp;<span class="op" id="5696240">=</span>&nbsp;<span class="ident" id="5696242">fmt</span><span class="op" id="5696245">.</span><span class="ident" id="5696246">Sprintf</span><span class="op" id="5696253">(</span><span class="string" id="5696254">&#34;%s-%d&#34;</span><span class="op" id="5696261">,</span>&nbsp;<span class="ident" id="5696263">tests</span><span class="op" id="5696268">[</span><span class="ident" id="5696269">i</span><span class="op" id="5696270">]</span><span class="op" id="5696271">.</span><span class="ident" id="5696272">Name</span><span class="op" id="5696276">,</span>&nbsp;<span class="ident" id="5696278">procs</span><span class="op" id="5696283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696293">t</span>&nbsp;<span class="op" id="5696295">:=</span>&nbsp;<span class="op" id="5696298">&amp;</span><span class="ident" id="5696299">T</span><span class="op" id="5696300">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696306">common</span><span class="op" id="5696312">:</span>&nbsp;<span class="ident" id="5696314">common</span><span class="op" id="5696320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696327">signal</span><span class="op" id="5696333">:</span>&nbsp;<span class="builtinfunc" id="5696335">make</span><span class="op" id="5696339">(</span><span class="keyword" id="5696340">chan</span>&nbsp;<span class="keyword" id="5696345">interface</span><span class="op" id="5696354">{</span><span class="op" id="5696355">}</span><span class="op" id="5696356">)</span><span class="op" id="5696357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696363">}</span><span class="op" id="5696364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696370">name</span><span class="op" id="5696374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696385">testName</span><span class="op" id="5696393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696399">startParallel</span><span class="op" id="5696412">:</span>&nbsp;<span class="ident" id="5696414">startParallel</span><span class="op" id="5696427">,</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696437">t</span><span class="op" id="5696438">.</span><span class="ident" id="5696439">self</span>&nbsp;<span class="op" id="5696444">=</span>&nbsp;<span class="ident" id="5696446">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696451">if</span>&nbsp;<span class="op" id="5696454">*</span><span class="ident" id="5696455">chatty</span>&nbsp;<span class="op" id="5696462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696468">fmt</span><span class="op" id="5696471">.</span><span class="ident" id="5696472">Printf</span><span class="op" id="5696478">(</span><span class="string" id="5696479">&#34;===&nbsp;RUN&nbsp;%s\n&#34;</span><span class="op" id="5696493">,</span>&nbsp;<span class="ident" id="5696495">t</span><span class="op" id="5696496">.</span><span class="ident" id="5696497">name</span><span class="op" id="5696501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696506">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696511">go</span>&nbsp;<span class="ident" id="5696514">tRunner</span><span class="op" id="5696521">(</span><span class="ident" id="5696522">t</span><span class="op" id="5696523">,</span>&nbsp;<span class="op" id="5696525">&amp;</span><span class="ident" id="5696526">tests</span><span class="op" id="5696531">[</span><span class="ident" id="5696532">i</span><span class="op" id="5696533">]</span><span class="op" id="5696534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696539">out</span>&nbsp;<span class="op" id="5696543">:=</span>&nbsp;<span class="op" id="5696546">(</span><span class="op" id="5696547">&lt;-</span><span class="ident" id="5696549">t</span><span class="op" id="5696550">.</span><span class="ident" id="5696551">signal</span><span class="op" id="5696557">)</span><span class="op" id="5696558">.</span><span class="op" id="5696559">(</span><span class="op" id="5696560">*</span><span class="ident" id="5696561">T</span><span class="op" id="5696562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696567">if</span>&nbsp;<span class="ident" id="5696570">out</span>&nbsp;<span class="op" id="5696574">==</span>&nbsp;<span class="ident" id="5696577">nil</span>&nbsp;<span class="op" id="5696581">{</span>&nbsp;<span class="comment" id="5696583">//&nbsp;Parallel&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696604">go</span>&nbsp;<span class="keyword" id="5696607">func</span><span class="op" id="5696611">(</span><span class="op" id="5696612">)</span>&nbsp;<span class="op" id="5696614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696621">collector</span>&nbsp;<span class="op" id="5696631">&lt;-</span>&nbsp;<span class="op" id="5696634">&lt;-</span><span class="ident" id="5696636">t</span><span class="op" id="5696637">.</span><span class="ident" id="5696638">signal</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696649">}</span><span class="op" id="5696650">(</span><span class="op" id="5696651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696657">numParallel</span><span class="op" id="5696668">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696675">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696692">t</span><span class="op" id="5696693">.</span><span class="ident" id="5696694">report</span><span class="op" id="5696700">(</span><span class="op" id="5696701">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696706">ok</span>&nbsp;<span class="op" id="5696709">=</span>&nbsp;<span class="ident" id="5696711">ok</span>&nbsp;<span class="op" id="5696714">&amp;&amp;</span>&nbsp;<span class="op" id="5696717">!</span><span class="ident" id="5696718">out</span><span class="op" id="5696721">.</span><span class="ident" id="5696722">Failed</span><span class="op" id="5696728">(</span><span class="op" id="5696729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696738">running</span>&nbsp;<span class="op" id="5696746">:=</span>&nbsp;<span class="num" id="5696749">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696753">for</span>&nbsp;<span class="ident" id="5696757">numParallel</span><span class="op" id="5696768">+</span><span class="ident" id="5696769">running</span>&nbsp;<span class="op" id="5696777">&gt;</span>&nbsp;<span class="num" id="5696779">0</span>&nbsp;<span class="op" id="5696781">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696786">if</span>&nbsp;<span class="ident" id="5696789">running</span>&nbsp;<span class="op" id="5696797">&lt;</span>&nbsp;<span class="op" id="5696799">*</span><span class="ident" id="5696800">parallel</span>&nbsp;<span class="op" id="5696809">&amp;&amp;</span>&nbsp;<span class="ident" id="5696812">numParallel</span>&nbsp;<span class="op" id="5696824">&gt;</span>&nbsp;<span class="num" id="5696826">0</span>&nbsp;<span class="op" id="5696828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696834">startParallel</span>&nbsp;<span class="op" id="5696848">&lt;-</span>&nbsp;<span class="builtintype" id="5696851">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696860">running</span><span class="op" id="5696867">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696874">numParallel</span><span class="op" id="5696885">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696892">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696909">t</span>&nbsp;<span class="op" id="5696911">:=</span>&nbsp;<span class="op" id="5696914">(</span><span class="op" id="5696915">&lt;-</span><span class="ident" id="5696917">collector</span><span class="op" id="5696926">)</span><span class="op" id="5696927">.</span><span class="op" id="5696928">(</span><span class="op" id="5696929">*</span><span class="ident" id="5696930">T</span><span class="op" id="5696931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696936">t</span><span class="op" id="5696937">.</span><span class="ident" id="5696938">report</span><span class="op" id="5696944">(</span><span class="op" id="5696945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696950">ok</span>&nbsp;<span class="op" id="5696953">=</span>&nbsp;<span class="ident" id="5696955">ok</span>&nbsp;<span class="op" id="5696958">&amp;&amp;</span>&nbsp;<span class="op" id="5696961">!</span><span class="ident" id="5696962">t</span><span class="op" id="5696963">.</span><span class="ident" id="5696964">Failed</span><span class="op" id="5696970">(</span><span class="op" id="5696971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696976">running</span><span class="op" id="5696983">--</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5696994">return</span><br>
<span class="lineno"></span><span class="op" id="5697001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="5697004">//&nbsp;before&nbsp;runs&nbsp;before&nbsp;all&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5697039">func</span>&nbsp;<span class="ident" id="5697044">before</span><span class="op" id="5697050">(</span><span class="op" id="5697051">)</span>&nbsp;<span class="op" id="5697053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697056">if</span>&nbsp;<span class="op" id="5697059">*</span><span class="ident" id="5697060">memProfileRate</span>&nbsp;<span class="op" id="5697075">&gt;</span>&nbsp;<span class="num" id="5697077">0</span>&nbsp;<span class="op" id="5697079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697083">runtime</span><span class="op" id="5697090">.</span><span class="ident" id="5697091">MemProfileRate</span>&nbsp;<span class="op" id="5697106">=</span>&nbsp;<span class="op" id="5697108">*</span><span class="ident" id="5697109">memProfileRate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697125">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697128">if</span>&nbsp;<span class="op" id="5697131">*</span><span class="ident" id="5697132">cpuProfile</span>&nbsp;<span class="op" id="5697143">!=</span>&nbsp;<span class="string" id="5697146">&#34;&#34;</span>&nbsp;<span class="op" id="5697149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697153">f</span><span class="op" id="5697154">,</span>&nbsp;<span class="ident" id="5697156">err</span>&nbsp;<span class="op" id="5697160">:=</span>&nbsp;<span class="ident" id="5697163">os</span><span class="op" id="5697165">.</span><span class="ident" id="5697166">Create</span><span class="op" id="5697172">(</span><span class="ident" id="5697173">toOutputDir</span><span class="op" id="5697184">(</span><span class="op" id="5697185">*</span><span class="ident" id="5697186">cpuProfile</span><span class="op" id="5697196">)</span><span class="op" id="5697197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697201">if</span>&nbsp;<span class="ident" id="5697204">err</span>&nbsp;<span class="op" id="5697208">!=</span>&nbsp;<span class="ident" id="5697211">nil</span>&nbsp;<span class="op" id="5697215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697220">fmt</span><span class="op" id="5697223">.</span><span class="ident" id="5697224">Fprintf</span><span class="op" id="5697231">(</span><span class="ident" id="5697232">os</span><span class="op" id="5697234">.</span><span class="ident" id="5697235">Stderr</span><span class="op" id="5697241">,</span>&nbsp;<span class="string" id="5697243">&#34;testing:&nbsp;%s&#34;</span><span class="op" id="5697256">,</span>&nbsp;<span class="ident" id="5697258">err</span><span class="op" id="5697261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697266">return</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697279">if</span>&nbsp;<span class="ident" id="5697282">err</span>&nbsp;<span class="op" id="5697286">:=</span>&nbsp;<span class="ident" id="5697289">pprof</span><span class="op" id="5697294">.</span><span class="ident" id="5697295">StartCPUProfile</span><span class="op" id="5697310">(</span><span class="ident" id="5697311">f</span><span class="op" id="5697312">)</span><span class="op" id="5697313">;</span>&nbsp;<span class="ident" id="5697315">err</span>&nbsp;<span class="op" id="5697319">!=</span>&nbsp;<span class="ident" id="5697322">nil</span>&nbsp;<span class="op" id="5697326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697331">fmt</span><span class="op" id="5697334">.</span><span class="ident" id="5697335">Fprintf</span><span class="op" id="5697342">(</span><span class="ident" id="5697343">os</span><span class="op" id="5697345">.</span><span class="ident" id="5697346">Stderr</span><span class="op" id="5697352">,</span>&nbsp;<span class="string" id="5697354">&#34;testing:&nbsp;can&#39;t&nbsp;start&nbsp;cpu&nbsp;profile:&nbsp;%s&#34;</span><span class="op" id="5697392">,</span>&nbsp;<span class="ident" id="5697394">err</span><span class="op" id="5697397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697402">f</span><span class="op" id="5697403">.</span><span class="ident" id="5697404">Close</span><span class="op" id="5697409">(</span><span class="op" id="5697410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697415">return</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5697428">//&nbsp;Could&nbsp;save&nbsp;f&nbsp;so&nbsp;after&nbsp;can&nbsp;call&nbsp;f.Close;&nbsp;not&nbsp;worth&nbsp;the&nbsp;effort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697497">if</span>&nbsp;<span class="op" id="5697500">*</span><span class="ident" id="5697501">blockProfile</span>&nbsp;<span class="op" id="5697514">!=</span>&nbsp;<span class="string" id="5697517">&#34;&#34;</span>&nbsp;<span class="op" id="5697520">&amp;&amp;</span>&nbsp;<span class="op" id="5697523">*</span><span class="ident" id="5697524">blockProfileRate</span>&nbsp;<span class="op" id="5697541">&gt;=</span>&nbsp;<span class="num" id="5697544">0</span>&nbsp;<span class="op" id="5697546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697550">runtime</span><span class="op" id="5697557">.</span><span class="ident" id="5697558">SetBlockProfileRate</span><span class="op" id="5697577">(</span><span class="op" id="5697578">*</span><span class="ident" id="5697579">blockProfileRate</span><span class="op" id="5697595">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697601">if</span>&nbsp;<span class="op" id="5697604">*</span><span class="ident" id="5697605">coverProfile</span>&nbsp;<span class="op" id="5697618">!=</span>&nbsp;<span class="string" id="5697621">&#34;&#34;</span>&nbsp;<span class="op" id="5697624">&amp;&amp;</span>&nbsp;<span class="ident" id="5697627">cover</span><span class="op" id="5697632">.</span><span class="ident" id="5697633">Mode</span>&nbsp;<span class="op" id="5697638">==</span>&nbsp;<span class="string" id="5697641">&#34;&#34;</span>&nbsp;<span class="op" id="5697644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697648">fmt</span><span class="op" id="5697651">.</span><span class="ident" id="5697652">Fprintf</span><span class="op" id="5697659">(</span><span class="ident" id="5697660">os</span><span class="op" id="5697662">.</span><span class="ident" id="5697663">Stderr</span><span class="op" id="5697669">,</span>&nbsp;<span class="string" id="5697671">&#34;testing:&nbsp;cannot&nbsp;use&nbsp;-test.coverprofile&nbsp;because&nbsp;test&nbsp;binary&nbsp;was&nbsp;not&nbsp;built&nbsp;with&nbsp;coverage&nbsp;enabled\n&#34;</span><span class="op" id="5697769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697773">os</span><span class="op" id="5697775">.</span><span class="ident" id="5697776">Exit</span><span class="op" id="5697780">(</span><span class="num" id="5697781">2</span><span class="op" id="5697782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697785">}</span><br>
<span class="lineno">610</span><span class="op" id="5697787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5697790">//&nbsp;after&nbsp;runs&nbsp;after&nbsp;all&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5697823">func</span>&nbsp;<span class="ident" id="5697828">after</span><span class="op" id="5697833">(</span><span class="op" id="5697834">)</span>&nbsp;<span class="op" id="5697836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697839">if</span>&nbsp;<span class="op" id="5697842">*</span><span class="ident" id="5697843">cpuProfile</span>&nbsp;<span class="op" id="5697854">!=</span>&nbsp;<span class="string" id="5697857">&#34;&#34;</span>&nbsp;<span class="op" id="5697860">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697864">pprof</span><span class="op" id="5697869">.</span><span class="ident" id="5697870">StopCPUProfile</span><span class="op" id="5697884">(</span><span class="op" id="5697885">)</span>&nbsp;<span class="comment" id="5697887">//&nbsp;flushes&nbsp;profile&nbsp;to&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697918">if</span>&nbsp;<span class="op" id="5697921">*</span><span class="ident" id="5697922">memProfile</span>&nbsp;<span class="op" id="5697933">!=</span>&nbsp;<span class="string" id="5697936">&#34;&#34;</span>&nbsp;<span class="op" id="5697939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697943">f</span><span class="op" id="5697944">,</span>&nbsp;<span class="ident" id="5697946">err</span>&nbsp;<span class="op" id="5697950">:=</span>&nbsp;<span class="ident" id="5697953">os</span><span class="op" id="5697955">.</span><span class="ident" id="5697956">Create</span><span class="op" id="5697962">(</span><span class="ident" id="5697963">toOutputDir</span><span class="op" id="5697974">(</span><span class="op" id="5697975">*</span><span class="ident" id="5697976">memProfile</span><span class="op" id="5697986">)</span><span class="op" id="5697987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697991">if</span>&nbsp;<span class="ident" id="5697994">err</span>&nbsp;<span class="op" id="5697998">!=</span>&nbsp;<span class="ident" id="5698001">nil</span>&nbsp;<span class="op" id="5698005">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698010">fmt</span><span class="op" id="5698013">.</span><span class="ident" id="5698014">Fprintf</span><span class="op" id="5698021">(</span><span class="ident" id="5698022">os</span><span class="op" id="5698024">.</span><span class="ident" id="5698025">Stderr</span><span class="op" id="5698031">,</span>&nbsp;<span class="string" id="5698033">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="5698048">,</span>&nbsp;<span class="ident" id="5698050">err</span><span class="op" id="5698053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698058">os</span><span class="op" id="5698060">.</span><span class="ident" id="5698061">Exit</span><span class="op" id="5698065">(</span><span class="num" id="5698066">2</span><span class="op" id="5698067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698075">runtime</span><span class="op" id="5698082">.</span><span class="ident" id="5698083">GC</span><span class="op" id="5698085">(</span><span class="op" id="5698086">)</span>&nbsp;<span class="comment" id="5698088">//&nbsp;materialize&nbsp;all&nbsp;statistics</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698120">if</span>&nbsp;<span class="ident" id="5698123">err</span>&nbsp;<span class="op" id="5698127">=</span>&nbsp;<span class="ident" id="5698129">pprof</span><span class="op" id="5698134">.</span><span class="ident" id="5698135">WriteHeapProfile</span><span class="op" id="5698151">(</span><span class="ident" id="5698152">f</span><span class="op" id="5698153">)</span><span class="op" id="5698154">;</span>&nbsp;<span class="ident" id="5698156">err</span>&nbsp;<span class="op" id="5698160">!=</span>&nbsp;<span class="ident" id="5698163">nil</span>&nbsp;<span class="op" id="5698167">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698172">fmt</span><span class="op" id="5698175">.</span><span class="ident" id="5698176">Fprintf</span><span class="op" id="5698183">(</span><span class="ident" id="5698184">os</span><span class="op" id="5698186">.</span><span class="ident" id="5698187">Stderr</span><span class="op" id="5698193">,</span>&nbsp;<span class="string" id="5698195">&#34;testing:&nbsp;can&#39;t&nbsp;write&nbsp;%s:&nbsp;%s\n&#34;</span><span class="op" id="5698226">,</span>&nbsp;<span class="op" id="5698228">*</span><span class="ident" id="5698229">memProfile</span><span class="op" id="5698239">,</span>&nbsp;<span class="ident" id="5698241">err</span><span class="op" id="5698244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698249">os</span><span class="op" id="5698251">.</span><span class="ident" id="5698252">Exit</span><span class="op" id="5698256">(</span><span class="num" id="5698257">2</span><span class="op" id="5698258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698266">f</span><span class="op" id="5698267">.</span><span class="ident" id="5698268">Close</span><span class="op" id="5698273">(</span><span class="op" id="5698274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698277">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698280">if</span>&nbsp;<span class="op" id="5698283">*</span><span class="ident" id="5698284">blockProfile</span>&nbsp;<span class="op" id="5698297">!=</span>&nbsp;<span class="string" id="5698300">&#34;&#34;</span>&nbsp;<span class="op" id="5698303">&amp;&amp;</span>&nbsp;<span class="op" id="5698306">*</span><span class="ident" id="5698307">blockProfileRate</span>&nbsp;<span class="op" id="5698324">&gt;=</span>&nbsp;<span class="num" id="5698327">0</span>&nbsp;<span class="op" id="5698329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698333">f</span><span class="op" id="5698334">,</span>&nbsp;<span class="ident" id="5698336">err</span>&nbsp;<span class="op" id="5698340">:=</span>&nbsp;<span class="ident" id="5698343">os</span><span class="op" id="5698345">.</span><span class="ident" id="5698346">Create</span><span class="op" id="5698352">(</span><span class="ident" id="5698353">toOutputDir</span><span class="op" id="5698364">(</span><span class="op" id="5698365">*</span><span class="ident" id="5698366">blockProfile</span><span class="op" id="5698378">)</span><span class="op" id="5698379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698383">if</span>&nbsp;<span class="ident" id="5698386">err</span>&nbsp;<span class="op" id="5698390">!=</span>&nbsp;<span class="ident" id="5698393">nil</span>&nbsp;<span class="op" id="5698397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698402">fmt</span><span class="op" id="5698405">.</span><span class="ident" id="5698406">Fprintf</span><span class="op" id="5698413">(</span><span class="ident" id="5698414">os</span><span class="op" id="5698416">.</span><span class="ident" id="5698417">Stderr</span><span class="op" id="5698423">,</span>&nbsp;<span class="string" id="5698425">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="5698440">,</span>&nbsp;<span class="ident" id="5698442">err</span><span class="op" id="5698445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698450">os</span><span class="op" id="5698452">.</span><span class="ident" id="5698453">Exit</span><span class="op" id="5698457">(</span><span class="num" id="5698458">2</span><span class="op" id="5698459">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698467">if</span>&nbsp;<span class="ident" id="5698470">err</span>&nbsp;<span class="op" id="5698474">=</span>&nbsp;<span class="ident" id="5698476">pprof</span><span class="op" id="5698481">.</span><span class="ident" id="5698482">Lookup</span><span class="op" id="5698488">(</span><span class="string" id="5698489">&#34;block&#34;</span><span class="op" id="5698496">)</span><span class="op" id="5698497">.</span><span class="ident" id="5698498">WriteTo</span><span class="op" id="5698505">(</span><span class="ident" id="5698506">f</span><span class="op" id="5698507">,</span>&nbsp;<span class="num" id="5698509">0</span><span class="op" id="5698510">)</span><span class="op" id="5698511">;</span>&nbsp;<span class="ident" id="5698513">err</span>&nbsp;<span class="op" id="5698517">!=</span>&nbsp;<span class="ident" id="5698520">nil</span>&nbsp;<span class="op" id="5698524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698529">fmt</span><span class="op" id="5698532">.</span><span class="ident" id="5698533">Fprintf</span><span class="op" id="5698540">(</span><span class="ident" id="5698541">os</span><span class="op" id="5698543">.</span><span class="ident" id="5698544">Stderr</span><span class="op" id="5698550">,</span>&nbsp;<span class="string" id="5698552">&#34;testing:&nbsp;can&#39;t&nbsp;write&nbsp;%s:&nbsp;%s\n&#34;</span><span class="op" id="5698583">,</span>&nbsp;<span class="op" id="5698585">*</span><span class="ident" id="5698586">blockProfile</span><span class="op" id="5698598">,</span>&nbsp;<span class="ident" id="5698600">err</span><span class="op" id="5698603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698608">os</span><span class="op" id="5698610">.</span><span class="ident" id="5698611">Exit</span><span class="op" id="5698615">(</span><span class="num" id="5698616">2</span><span class="op" id="5698617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698621">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698625">f</span><span class="op" id="5698626">.</span><span class="ident" id="5698627">Close</span><span class="op" id="5698632">(</span><span class="op" id="5698633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698639">if</span>&nbsp;<span class="ident" id="5698642">cover</span><span class="op" id="5698647">.</span><span class="ident" id="5698648">Mode</span>&nbsp;<span class="op" id="5698653">!=</span>&nbsp;<span class="string" id="5698656">&#34;&#34;</span>&nbsp;<span class="op" id="5698659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698663">coverReport</span><span class="op" id="5698674">(</span><span class="op" id="5698675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698678">}</span><br>
<span class="lineno">645</span><span class="op" id="5698680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5698683">//&nbsp;toOutputDir&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;relocated,&nbsp;if&nbsp;required,&nbsp;to&nbsp;outputDir.</span><br>
<span class="lineno"></span><span class="comment" id="5698758">//&nbsp;Simple&nbsp;implementation&nbsp;to&nbsp;avoid&nbsp;pulling&nbsp;in&nbsp;path/filepath.</span><br>
<span class="lineno"></span><span class="keyword" id="5698818">func</span>&nbsp;<span class="ident" id="5698823">toOutputDir</span><span class="op" id="5698834">(</span><span class="ident" id="5698835">path</span>&nbsp;<span class="builtintype" id="5698840">string</span><span class="op" id="5698846">)</span>&nbsp;<span class="builtintype" id="5698848">string</span>&nbsp;<span class="op" id="5698855">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698858">if</span>&nbsp;<span class="op" id="5698861">*</span><span class="ident" id="5698862">outputDir</span>&nbsp;<span class="op" id="5698872">==</span>&nbsp;<span class="string" id="5698875">&#34;&#34;</span>&nbsp;<span class="op" id="5698878">||</span>&nbsp;<span class="ident" id="5698881">path</span>&nbsp;<span class="op" id="5698886">==</span>&nbsp;<span class="string" id="5698889">&#34;&#34;</span>&nbsp;<span class="op" id="5698892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698896">return</span>&nbsp;<span class="ident" id="5698903">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698912">if</span>&nbsp;<span class="ident" id="5698915">runtime</span><span class="op" id="5698922">.</span><span class="ident" id="5698923">GOOS</span>&nbsp;<span class="op" id="5698928">==</span>&nbsp;<span class="string" id="5698931">&#34;windows&#34;</span>&nbsp;<span class="op" id="5698941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698945">//&nbsp;On&nbsp;Windows,&nbsp;it&#39;s&nbsp;clumsy,&nbsp;but&nbsp;we&nbsp;can&nbsp;be&nbsp;almost&nbsp;always&nbsp;correct</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699011">//&nbsp;by&nbsp;just&nbsp;looking&nbsp;for&nbsp;a&nbsp;drive&nbsp;letter&nbsp;and&nbsp;a&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699064">//&nbsp;Absolute&nbsp;paths&nbsp;always&nbsp;have&nbsp;a&nbsp;drive&nbsp;letter&nbsp;(ignoring&nbsp;UNC).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699127">//&nbsp;Problem:&nbsp;if&nbsp;path&nbsp;==&nbsp;&#34;C:A&#34;&nbsp;and&nbsp;outputdir&nbsp;==&nbsp;&#34;C:\Go&#34;&nbsp;it&#39;s&nbsp;unclear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699196">//&nbsp;what&nbsp;to&nbsp;do,&nbsp;but&nbsp;even&nbsp;then&nbsp;path/filepath&nbsp;doesn&#39;t&nbsp;help.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699255">//&nbsp;TODO:&nbsp;Worth&nbsp;doing&nbsp;better?&nbsp;Probably&nbsp;not,&nbsp;because&nbsp;we&#39;re&nbsp;here&nbsp;only</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699324">//&nbsp;under&nbsp;the&nbsp;management&nbsp;of&nbsp;go&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699362">if</span>&nbsp;<span class="builtinfunc" id="5699365">len</span><span class="op" id="5699368">(</span><span class="ident" id="5699369">path</span><span class="op" id="5699373">)</span>&nbsp;<span class="op" id="5699375">&gt;=</span>&nbsp;<span class="num" id="5699378">2</span>&nbsp;<span class="op" id="5699380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699385">letter</span><span class="op" id="5699391">,</span>&nbsp;<span class="ident" id="5699393">colon</span>&nbsp;<span class="op" id="5699399">:=</span>&nbsp;<span class="ident" id="5699402">path</span><span class="op" id="5699406">[</span><span class="num" id="5699407">0</span><span class="op" id="5699408">]</span><span class="op" id="5699409">,</span>&nbsp;<span class="ident" id="5699411">path</span><span class="op" id="5699415">[</span><span class="num" id="5699416">1</span><span class="op" id="5699417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699422">if</span>&nbsp;<span class="op" id="5699425">(</span><span class="string" id="5699426">&#39;a&#39;</span>&nbsp;<span class="op" id="5699430">&lt;=</span>&nbsp;<span class="ident" id="5699433">letter</span>&nbsp;<span class="op" id="5699440">&amp;&amp;</span>&nbsp;<span class="ident" id="5699443">letter</span>&nbsp;<span class="op" id="5699450">&lt;=</span>&nbsp;<span class="string" id="5699453">&#39;z&#39;</span>&nbsp;<span class="op" id="5699457">||</span>&nbsp;<span class="string" id="5699460">&#39;A&#39;</span>&nbsp;<span class="op" id="5699464">&lt;=</span>&nbsp;<span class="ident" id="5699467">letter</span>&nbsp;<span class="op" id="5699474">&amp;&amp;</span>&nbsp;<span class="ident" id="5699477">letter</span>&nbsp;<span class="op" id="5699484">&lt;=</span>&nbsp;<span class="string" id="5699487">&#39;Z&#39;</span><span class="op" id="5699490">)</span>&nbsp;<span class="op" id="5699492">&amp;&amp;</span>&nbsp;<span class="ident" id="5699495">colon</span>&nbsp;<span class="op" id="5699501">==</span>&nbsp;<span class="string" id="5699504">&#39;:&#39;</span>&nbsp;<span class="op" id="5699508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699514">//&nbsp;If&nbsp;path&nbsp;starts&nbsp;with&nbsp;a&nbsp;drive&nbsp;letter&nbsp;we&#39;re&nbsp;stuck&nbsp;with&nbsp;it&nbsp;regardless.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699588">return</span>&nbsp;<span class="ident" id="5699595">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699613">if</span>&nbsp;<span class="ident" id="5699616">os</span><span class="op" id="5699618">.</span><span class="ident" id="5699619">IsPathSeparator</span><span class="op" id="5699634">(</span><span class="ident" id="5699635">path</span><span class="op" id="5699639">[</span><span class="num" id="5699640">0</span><span class="op" id="5699641">]</span><span class="op" id="5699642">)</span>&nbsp;<span class="op" id="5699644">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699648">return</span>&nbsp;<span class="ident" id="5699655">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699664">return</span>&nbsp;<span class="ident" id="5699671">fmt</span><span class="op" id="5699674">.</span><span class="ident" id="5699675">Sprintf</span><span class="op" id="5699682">(</span><span class="string" id="5699683">&#34;%s%c%s&#34;</span><span class="op" id="5699691">,</span>&nbsp;<span class="op" id="5699693">*</span><span class="ident" id="5699694">outputDir</span><span class="op" id="5699703">,</span>&nbsp;<span class="ident" id="5699705">os</span><span class="op" id="5699707">.</span><span class="ident" id="5699708">PathSeparator</span><span class="op" id="5699721">,</span>&nbsp;<span class="ident" id="5699723">path</span><span class="op" id="5699727">)</span><br>
<span class="lineno"></span><span class="op" id="5699729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5699732">var</span>&nbsp;<span class="ident" id="5699736">timer</span>&nbsp;<span class="op" id="5699742">*</span><span class="ident" id="5699743">time</span><span class="op" id="5699747">.</span><span class="ident" id="5699748">Timer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5699755">//&nbsp;startAlarm&nbsp;starts&nbsp;an&nbsp;alarm&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="5699799">func</span>&nbsp;<span class="ident" id="5699804">startAlarm</span><span class="op" id="5699814">(</span><span class="op" id="5699815">)</span>&nbsp;<span class="op" id="5699817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699820">if</span>&nbsp;<span class="op" id="5699823">*</span><span class="ident" id="5699824">timeout</span>&nbsp;<span class="op" id="5699832">&gt;</span>&nbsp;<span class="num" id="5699834">0</span>&nbsp;<span class="op" id="5699836">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699840">timer</span>&nbsp;<span class="op" id="5699846">=</span>&nbsp;<span class="ident" id="5699848">time</span><span class="op" id="5699852">.</span><span class="ident" id="5699853">AfterFunc</span><span class="op" id="5699862">(</span><span class="op" id="5699863">*</span><span class="ident" id="5699864">timeout</span><span class="op" id="5699871">,</span>&nbsp;<span class="keyword" id="5699873">func</span><span class="op" id="5699877">(</span><span class="op" id="5699878">)</span>&nbsp;<span class="op" id="5699880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5699885">panic</span><span class="op" id="5699890">(</span><span class="ident" id="5699891">fmt</span><span class="op" id="5699894">.</span><span class="ident" id="5699895">Sprintf</span><span class="op" id="5699902">(</span><span class="string" id="5699903">&#34;test&nbsp;timed&nbsp;out&nbsp;after&nbsp;%v&#34;</span><span class="op" id="5699928">,</span>&nbsp;<span class="op" id="5699930">*</span><span class="ident" id="5699931">timeout</span><span class="op" id="5699938">)</span><span class="op" id="5699939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699943">}</span><span class="op" id="5699944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699947">}</span><br>
<span class="lineno"></span><span class="op" id="5699949">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="comment" id="5699952">//&nbsp;stopAlarm&nbsp;turns&nbsp;off&nbsp;the&nbsp;alarm.</span><br>
<span class="lineno"></span><span class="keyword" id="5699986">func</span>&nbsp;<span class="ident" id="5699991">stopAlarm</span><span class="op" id="5700000">(</span><span class="op" id="5700001">)</span>&nbsp;<span class="op" id="5700003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700006">if</span>&nbsp;<span class="op" id="5700009">*</span><span class="ident" id="5700010">timeout</span>&nbsp;<span class="op" id="5700018">&gt;</span>&nbsp;<span class="num" id="5700020">0</span>&nbsp;<span class="op" id="5700022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700026">timer</span><span class="op" id="5700031">.</span><span class="ident" id="5700032">Stop</span><span class="op" id="5700036">(</span><span class="op" id="5700037">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700040">}</span><br>
<span class="lineno"></span><span class="op" id="5700042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5700045">func</span>&nbsp;<span class="ident" id="5700050">parseCpuList</span><span class="op" id="5700062">(</span><span class="op" id="5700063">)</span>&nbsp;<span class="op" id="5700065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700068">for</span>&nbsp;<span class="ident" id="5700072">_</span><span class="op" id="5700073">,</span>&nbsp;<span class="ident" id="5700075">val</span>&nbsp;<span class="op" id="5700079">:=</span>&nbsp;<span class="keyword" id="5700082">range</span>&nbsp;<span class="ident" id="5700088">strings</span><span class="op" id="5700095">.</span><span class="ident" id="5700096">Split</span><span class="op" id="5700101">(</span><span class="op" id="5700102">*</span><span class="ident" id="5700103">cpuListStr</span><span class="op" id="5700113">,</span>&nbsp;<span class="string" id="5700115">&#34;,&#34;</span><span class="op" id="5700118">)</span>&nbsp;<span class="op" id="5700120">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700124">val</span>&nbsp;<span class="op" id="5700128">=</span>&nbsp;<span class="ident" id="5700130">strings</span><span class="op" id="5700137">.</span><span class="ident" id="5700138">TrimSpace</span><span class="op" id="5700147">(</span><span class="ident" id="5700148">val</span><span class="op" id="5700151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700155">if</span>&nbsp;<span class="ident" id="5700158">val</span>&nbsp;<span class="op" id="5700162">==</span>&nbsp;<span class="string" id="5700165">&#34;&#34;</span>&nbsp;<span class="op" id="5700168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700173">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700188">cpu</span><span class="op" id="5700191">,</span>&nbsp;<span class="ident" id="5700193">err</span>&nbsp;<span class="op" id="5700197">:=</span>&nbsp;<span class="ident" id="5700200">strconv</span><span class="op" id="5700207">.</span><span class="ident" id="5700208">Atoi</span><span class="op" id="5700212">(</span><span class="ident" id="5700213">val</span><span class="op" id="5700216">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700220">if</span>&nbsp;<span class="ident" id="5700223">err</span>&nbsp;<span class="op" id="5700227">!=</span>&nbsp;<span class="ident" id="5700230">nil</span>&nbsp;<span class="op" id="5700234">||</span>&nbsp;<span class="ident" id="5700237">cpu</span>&nbsp;<span class="op" id="5700241">&lt;=</span>&nbsp;<span class="num" id="5700244">0</span>&nbsp;<span class="op" id="5700246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700251">fmt</span><span class="op" id="5700254">.</span><span class="ident" id="5700255">Fprintf</span><span class="op" id="5700262">(</span><span class="ident" id="5700263">os</span><span class="op" id="5700265">.</span><span class="ident" id="5700266">Stderr</span><span class="op" id="5700272">,</span>&nbsp;<span class="string" id="5700274">&#34;testing:&nbsp;invalid&nbsp;value&nbsp;%q&nbsp;for&nbsp;-test.cpu\n&#34;</span><span class="op" id="5700317">,</span>&nbsp;<span class="ident" id="5700319">val</span><span class="op" id="5700322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700327">os</span><span class="op" id="5700329">.</span><span class="ident" id="5700330">Exit</span><span class="op" id="5700334">(</span><span class="num" id="5700335">1</span><span class="op" id="5700336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700344">cpuList</span>&nbsp;<span class="op" id="5700352">=</span>&nbsp;<span class="builtinfunc" id="5700354">append</span><span class="op" id="5700360">(</span><span class="ident" id="5700361">cpuList</span><span class="op" id="5700368">,</span>&nbsp;<span class="ident" id="5700370">cpu</span><span class="op" id="5700373">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700379">if</span>&nbsp;<span class="ident" id="5700382">cpuList</span>&nbsp;<span class="op" id="5700390">==</span>&nbsp;<span class="ident" id="5700393">nil</span>&nbsp;<span class="op" id="5700397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700401">cpuList</span>&nbsp;<span class="op" id="5700409">=</span>&nbsp;<span class="builtinfunc" id="5700411">append</span><span class="op" id="5700417">(</span><span class="ident" id="5700418">cpuList</span><span class="op" id="5700425">,</span>&nbsp;<span class="ident" id="5700427">runtime</span><span class="op" id="5700434">.</span><span class="ident" id="5700435">GOMAXPROCS</span><span class="op" id="5700445">(</span><span class="op" id="5700446">-</span><span class="num" id="5700447">1</span><span class="op" id="5700448">)</span><span class="op" id="5700449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700452">}</span><br>
<span class="lineno"></span><span class="op" id="5700454">}</span>
</div>
</body>
</html>
