<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html" class="current">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4091265">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4091320">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4091374">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4091425">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4091502">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4091560">package</span>&nbsp;<span class="ident" id="4091568">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4091574">import</span>&nbsp;<span class="op" id="4091581">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4091584">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4091601">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4091613">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4091620">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4091623">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4091703">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4091729">type</span>&nbsp;<span class="ident" id="4091734">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4091754">struct</span>&nbsp;<span class="op" id="4091761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091764">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4091775">asn1</span><span class="op" id="4091779">.</span><span class="ident" id="4091780">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091798">Parameters</span>&nbsp;<span class="ident" id="4091809">asn1</span><span class="op" id="4091813">.</span><span class="ident" id="4091814">RawValue</span>&nbsp;<span class="string" id="4091823">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4091841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4091844">type</span>&nbsp;<span class="ident" id="4091849">RDNSequence</span>&nbsp;<span class="op" id="4091861">[</span><span class="op" id="4091862">]</span><span class="ident" id="4091863">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4091893">type</span>&nbsp;<span class="ident" id="4091898">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4091927">[</span><span class="op" id="4091928">]</span><span class="ident" id="4091929">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4091952">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4092025">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4092079">type</span>&nbsp;<span class="ident" id="4092084">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4092106">struct</span>&nbsp;<span class="op" id="4092113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092116">Type</span>&nbsp;&nbsp;<span class="ident" id="4092122">asn1</span><span class="op" id="4092126">.</span><span class="ident" id="4092127">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092145">Value</span>&nbsp;<span class="keyword" id="4092151">interface</span><span class="op" id="4092160">{</span><span class="op" id="4092161">}</span><br>
<span class="lineno"></span><span class="op" id="4092163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092166">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4092233">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4092294">type</span>&nbsp;<span class="ident" id="4092299">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4092324">struct</span>&nbsp;<span class="op" id="4092331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092334">Type</span>&nbsp;&nbsp;<span class="ident" id="4092340">asn1</span><span class="op" id="4092344">.</span><span class="ident" id="4092345">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092363">Value</span>&nbsp;<span class="op" id="4092369">[</span><span class="op" id="4092370">]</span><span class="op" id="4092371">[</span><span class="op" id="4092372">]</span><span class="ident" id="4092373">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4092395">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4092408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4092411">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4092481">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4092503">type</span>&nbsp;<span class="ident" id="4092508">Extension</span>&nbsp;<span class="keyword" id="4092518">struct</span>&nbsp;<span class="op" id="4092525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092528">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092537">asn1</span><span class="op" id="4092541">.</span><span class="ident" id="4092542">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092560">Critical</span>&nbsp;<span class="builtintype" id="4092569">bool</span>&nbsp;<span class="string" id="4092574">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092593">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092602">[</span><span class="op" id="4092603">]</span><span class="builtintype" id="4092604">byte</span><br>
<span class="lineno"></span><span class="op" id="4092609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092612">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4092690">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4092757">type</span>&nbsp;<span class="ident" id="4092762">Name</span>&nbsp;<span class="keyword" id="4092767">struct</span>&nbsp;<span class="op" id="4092774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092777">Country</span><span class="op" id="4092784">,</span>&nbsp;<span class="ident" id="4092786">Organization</span><span class="op" id="4092798">,</span>&nbsp;<span class="ident" id="4092800">OrganizationalUnit</span>&nbsp;<span class="op" id="4092819">[</span><span class="op" id="4092820">]</span><span class="builtintype" id="4092821">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092829">Locality</span><span class="op" id="4092837">,</span>&nbsp;<span class="ident" id="4092839">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092871">[</span><span class="op" id="4092872">]</span><span class="builtintype" id="4092873">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092881">StreetAddress</span><span class="op" id="4092894">,</span>&nbsp;<span class="ident" id="4092896">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092923">[</span><span class="op" id="4092924">]</span><span class="builtintype" id="4092925">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092933">SerialNumber</span><span class="op" id="4092945">,</span>&nbsp;<span class="ident" id="4092947">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4092975">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092984">Names</span>&nbsp;<span class="op" id="4092990">[</span><span class="op" id="4092991">]</span><span class="ident" id="4092992">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4093014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093017">func</span>&nbsp;<span class="op" id="4093022">(</span><span class="ident" id="4093023">n</span>&nbsp;<span class="op" id="4093025">*</span><span class="ident" id="4093026">Name</span><span class="op" id="4093030">)</span>&nbsp;<span class="ident" id="4093032">FillFromRDNSequence</span><span class="op" id="4093051">(</span><span class="ident" id="4093052">rdns</span>&nbsp;<span class="op" id="4093057">*</span><span class="ident" id="4093058">RDNSequence</span><span class="op" id="4093069">)</span>&nbsp;<span class="op" id="4093071">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093074">for</span>&nbsp;<span class="ident" id="4093078">_</span><span class="op" id="4093079">,</span>&nbsp;<span class="ident" id="4093081">rdn</span>&nbsp;<span class="op" id="4093085">:=</span>&nbsp;<span class="keyword" id="4093088">range</span>&nbsp;<span class="op" id="4093094">*</span><span class="ident" id="4093095">rdns</span>&nbsp;<span class="op" id="4093100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093104">if</span>&nbsp;<span class="builtinfunc" id="4093107">len</span><span class="op" id="4093110">(</span><span class="ident" id="4093111">rdn</span><span class="op" id="4093114">)</span>&nbsp;<span class="op" id="4093116">==</span>&nbsp;<span class="num" id="4093119">0</span>&nbsp;<span class="op" id="4093121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093126">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093141">atv</span>&nbsp;<span class="op" id="4093145">:=</span>&nbsp;<span class="ident" id="4093148">rdn</span><span class="op" id="4093151">[</span><span class="num" id="4093152">0</span><span class="op" id="4093153">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093157">n</span><span class="op" id="4093158">.</span><span class="ident" id="4093159">Names</span>&nbsp;<span class="op" id="4093165">=</span>&nbsp;<span class="builtinfunc" id="4093167">append</span><span class="op" id="4093173">(</span><span class="ident" id="4093174">n</span><span class="op" id="4093175">.</span><span class="ident" id="4093176">Names</span><span class="op" id="4093181">,</span>&nbsp;<span class="ident" id="4093183">atv</span><span class="op" id="4093186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093190">value</span><span class="op" id="4093195">,</span>&nbsp;<span class="ident" id="4093197">ok</span>&nbsp;<span class="op" id="4093200">:=</span>&nbsp;<span class="ident" id="4093203">atv</span><span class="op" id="4093206">.</span><span class="ident" id="4093207">Value</span><span class="op" id="4093212">.</span><span class="op" id="4093213">(</span><span class="builtintype" id="4093214">string</span><span class="op" id="4093220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093224">if</span>&nbsp;<span class="op" id="4093227">!</span><span class="ident" id="4093228">ok</span>&nbsp;<span class="op" id="4093231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093236">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093247">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093252">t</span>&nbsp;<span class="op" id="4093254">:=</span>&nbsp;<span class="ident" id="4093257">atv</span><span class="op" id="4093260">.</span><span class="ident" id="4093261">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093268">if</span>&nbsp;<span class="builtinfunc" id="4093271">len</span><span class="op" id="4093274">(</span><span class="ident" id="4093275">t</span><span class="op" id="4093276">)</span>&nbsp;<span class="op" id="4093278">==</span>&nbsp;<span class="num" id="4093281">4</span>&nbsp;<span class="op" id="4093283">&amp;&amp;</span>&nbsp;<span class="ident" id="4093286">t</span><span class="op" id="4093287">[</span><span class="num" id="4093288">0</span><span class="op" id="4093289">]</span>&nbsp;<span class="op" id="4093291">==</span>&nbsp;<span class="num" id="4093294">2</span>&nbsp;<span class="op" id="4093296">&amp;&amp;</span>&nbsp;<span class="ident" id="4093299">t</span><span class="op" id="4093300">[</span><span class="num" id="4093301">1</span><span class="op" id="4093302">]</span>&nbsp;<span class="op" id="4093304">==</span>&nbsp;<span class="num" id="4093307">5</span>&nbsp;<span class="op" id="4093309">&amp;&amp;</span>&nbsp;<span class="ident" id="4093312">t</span><span class="op" id="4093313">[</span><span class="num" id="4093314">2</span><span class="op" id="4093315">]</span>&nbsp;<span class="op" id="4093317">==</span>&nbsp;<span class="num" id="4093320">4</span>&nbsp;<span class="op" id="4093322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093327">switch</span>&nbsp;<span class="ident" id="4093334">t</span><span class="op" id="4093335">[</span><span class="num" id="4093336">3</span><span class="op" id="4093337">]</span>&nbsp;<span class="op" id="4093339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093344">case</span>&nbsp;<span class="num" id="4093349">3</span><span class="op" id="4093350">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093356">n</span><span class="op" id="4093357">.</span><span class="ident" id="4093358">CommonName</span>&nbsp;<span class="op" id="4093369">=</span>&nbsp;<span class="ident" id="4093371">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093380">case</span>&nbsp;<span class="num" id="4093385">5</span><span class="op" id="4093386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093392">n</span><span class="op" id="4093393">.</span><span class="ident" id="4093394">SerialNumber</span>&nbsp;<span class="op" id="4093407">=</span>&nbsp;<span class="ident" id="4093409">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093418">case</span>&nbsp;<span class="num" id="4093423">6</span><span class="op" id="4093424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093430">n</span><span class="op" id="4093431">.</span><span class="ident" id="4093432">Country</span>&nbsp;<span class="op" id="4093440">=</span>&nbsp;<span class="builtinfunc" id="4093442">append</span><span class="op" id="4093448">(</span><span class="ident" id="4093449">n</span><span class="op" id="4093450">.</span><span class="ident" id="4093451">Country</span><span class="op" id="4093458">,</span>&nbsp;<span class="ident" id="4093460">value</span><span class="op" id="4093465">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093470">case</span>&nbsp;<span class="num" id="4093475">7</span><span class="op" id="4093476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093482">n</span><span class="op" id="4093483">.</span><span class="ident" id="4093484">Locality</span>&nbsp;<span class="op" id="4093493">=</span>&nbsp;<span class="builtinfunc" id="4093495">append</span><span class="op" id="4093501">(</span><span class="ident" id="4093502">n</span><span class="op" id="4093503">.</span><span class="ident" id="4093504">Locality</span><span class="op" id="4093512">,</span>&nbsp;<span class="ident" id="4093514">value</span><span class="op" id="4093519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093524">case</span>&nbsp;<span class="num" id="4093529">8</span><span class="op" id="4093530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093536">n</span><span class="op" id="4093537">.</span><span class="ident" id="4093538">Province</span>&nbsp;<span class="op" id="4093547">=</span>&nbsp;<span class="builtinfunc" id="4093549">append</span><span class="op" id="4093555">(</span><span class="ident" id="4093556">n</span><span class="op" id="4093557">.</span><span class="ident" id="4093558">Province</span><span class="op" id="4093566">,</span>&nbsp;<span class="ident" id="4093568">value</span><span class="op" id="4093573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093578">case</span>&nbsp;<span class="num" id="4093583">9</span><span class="op" id="4093584">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093590">n</span><span class="op" id="4093591">.</span><span class="ident" id="4093592">StreetAddress</span>&nbsp;<span class="op" id="4093606">=</span>&nbsp;<span class="builtinfunc" id="4093608">append</span><span class="op" id="4093614">(</span><span class="ident" id="4093615">n</span><span class="op" id="4093616">.</span><span class="ident" id="4093617">StreetAddress</span><span class="op" id="4093630">,</span>&nbsp;<span class="ident" id="4093632">value</span><span class="op" id="4093637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093642">case</span>&nbsp;<span class="num" id="4093647">10</span><span class="op" id="4093649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093655">n</span><span class="op" id="4093656">.</span><span class="ident" id="4093657">Organization</span>&nbsp;<span class="op" id="4093670">=</span>&nbsp;<span class="builtinfunc" id="4093672">append</span><span class="op" id="4093678">(</span><span class="ident" id="4093679">n</span><span class="op" id="4093680">.</span><span class="ident" id="4093681">Organization</span><span class="op" id="4093693">,</span>&nbsp;<span class="ident" id="4093695">value</span><span class="op" id="4093700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093705">case</span>&nbsp;<span class="num" id="4093710">11</span><span class="op" id="4093712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093718">n</span><span class="op" id="4093719">.</span><span class="ident" id="4093720">OrganizationalUnit</span>&nbsp;<span class="op" id="4093739">=</span>&nbsp;<span class="builtinfunc" id="4093741">append</span><span class="op" id="4093747">(</span><span class="ident" id="4093748">n</span><span class="op" id="4093749">.</span><span class="ident" id="4093750">OrganizationalUnit</span><span class="op" id="4093768">,</span>&nbsp;<span class="ident" id="4093770">value</span><span class="op" id="4093775">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093780">case</span>&nbsp;<span class="num" id="4093785">17</span><span class="op" id="4093787">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093793">n</span><span class="op" id="4093794">.</span><span class="ident" id="4093795">PostalCode</span>&nbsp;<span class="op" id="4093806">=</span>&nbsp;<span class="builtinfunc" id="4093808">append</span><span class="op" id="4093814">(</span><span class="ident" id="4093815">n</span><span class="op" id="4093816">.</span><span class="ident" id="4093817">PostalCode</span><span class="op" id="4093827">,</span>&nbsp;<span class="ident" id="4093829">value</span><span class="op" id="4093834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093846">}</span><br>
<span class="lineno">95</span><span class="op" id="4093848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093851">var</span>&nbsp;<span class="op" id="4093855">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093858">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093880">=</span>&nbsp;<span class="op" id="4093882">[</span><span class="op" id="4093883">]</span><span class="builtintype" id="4093884">int</span><span class="op" id="4093887">{</span><span class="num" id="4093888">2</span><span class="op" id="4093889">,</span>&nbsp;<span class="num" id="4093891">5</span><span class="op" id="4093892">,</span>&nbsp;<span class="num" id="4093894">4</span><span class="op" id="4093895">,</span>&nbsp;<span class="num" id="4093897">6</span><span class="op" id="4093898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093901">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093923">=</span>&nbsp;<span class="op" id="4093925">[</span><span class="op" id="4093926">]</span><span class="builtintype" id="4093927">int</span><span class="op" id="4093930">{</span><span class="num" id="4093931">2</span><span class="op" id="4093932">,</span>&nbsp;<span class="num" id="4093934">5</span><span class="op" id="4093935">,</span>&nbsp;<span class="num" id="4093937">4</span><span class="op" id="4093938">,</span>&nbsp;<span class="num" id="4093940">10</span><span class="op" id="4093942">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093945">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4093967">=</span>&nbsp;<span class="op" id="4093969">[</span><span class="op" id="4093970">]</span><span class="builtintype" id="4093971">int</span><span class="op" id="4093974">{</span><span class="num" id="4093975">2</span><span class="op" id="4093976">,</span>&nbsp;<span class="num" id="4093978">5</span><span class="op" id="4093979">,</span>&nbsp;<span class="num" id="4093981">4</span><span class="op" id="4093982">,</span>&nbsp;<span class="num" id="4093984">11</span><span class="op" id="4093986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093989">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094011">=</span>&nbsp;<span class="op" id="4094013">[</span><span class="op" id="4094014">]</span><span class="builtintype" id="4094015">int</span><span class="op" id="4094018">{</span><span class="num" id="4094019">2</span><span class="op" id="4094020">,</span>&nbsp;<span class="num" id="4094022">5</span><span class="op" id="4094023">,</span>&nbsp;<span class="num" id="4094025">4</span><span class="op" id="4094026">,</span>&nbsp;<span class="num" id="4094028">3</span><span class="op" id="4094029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094032">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094054">=</span>&nbsp;<span class="op" id="4094056">[</span><span class="op" id="4094057">]</span><span class="builtintype" id="4094058">int</span><span class="op" id="4094061">{</span><span class="num" id="4094062">2</span><span class="op" id="4094063">,</span>&nbsp;<span class="num" id="4094065">5</span><span class="op" id="4094066">,</span>&nbsp;<span class="num" id="4094068">4</span><span class="op" id="4094069">,</span>&nbsp;<span class="num" id="4094071">5</span><span class="op" id="4094072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094075">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094097">=</span>&nbsp;<span class="op" id="4094099">[</span><span class="op" id="4094100">]</span><span class="builtintype" id="4094101">int</span><span class="op" id="4094104">{</span><span class="num" id="4094105">2</span><span class="op" id="4094106">,</span>&nbsp;<span class="num" id="4094108">5</span><span class="op" id="4094109">,</span>&nbsp;<span class="num" id="4094111">4</span><span class="op" id="4094112">,</span>&nbsp;<span class="num" id="4094114">7</span><span class="op" id="4094115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094118">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094140">=</span>&nbsp;<span class="op" id="4094142">[</span><span class="op" id="4094143">]</span><span class="builtintype" id="4094144">int</span><span class="op" id="4094147">{</span><span class="num" id="4094148">2</span><span class="op" id="4094149">,</span>&nbsp;<span class="num" id="4094151">5</span><span class="op" id="4094152">,</span>&nbsp;<span class="num" id="4094154">4</span><span class="op" id="4094155">,</span>&nbsp;<span class="num" id="4094157">8</span><span class="op" id="4094158">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094161">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094183">=</span>&nbsp;<span class="op" id="4094185">[</span><span class="op" id="4094186">]</span><span class="builtintype" id="4094187">int</span><span class="op" id="4094190">{</span><span class="num" id="4094191">2</span><span class="op" id="4094192">,</span>&nbsp;<span class="num" id="4094194">5</span><span class="op" id="4094195">,</span>&nbsp;<span class="num" id="4094197">4</span><span class="op" id="4094198">,</span>&nbsp;<span class="num" id="4094200">9</span><span class="op" id="4094201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094204">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094226">=</span>&nbsp;<span class="op" id="4094228">[</span><span class="op" id="4094229">]</span><span class="builtintype" id="4094230">int</span><span class="op" id="4094233">{</span><span class="num" id="4094234">2</span><span class="op" id="4094235">,</span>&nbsp;<span class="num" id="4094237">5</span><span class="op" id="4094238">,</span>&nbsp;<span class="num" id="4094240">4</span><span class="op" id="4094241">,</span>&nbsp;<span class="num" id="4094243">17</span><span class="op" id="4094245">}</span><br>
<span class="lineno"></span><span class="op" id="4094247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094250">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4094328">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4094403">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4094481">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4094518">func</span>&nbsp;<span class="ident" id="4094523">appendRDNs</span><span class="op" id="4094533">(</span><span class="ident" id="4094534">in</span>&nbsp;<span class="ident" id="4094537">RDNSequence</span><span class="op" id="4094548">,</span>&nbsp;<span class="ident" id="4094550">values</span>&nbsp;<span class="op" id="4094557">[</span><span class="op" id="4094558">]</span><span class="builtintype" id="4094559">string</span><span class="op" id="4094565">,</span>&nbsp;<span class="ident" id="4094567">oid</span>&nbsp;<span class="ident" id="4094571">asn1</span><span class="op" id="4094575">.</span><span class="ident" id="4094576">ObjectIdentifier</span><span class="op" id="4094592">)</span>&nbsp;<span class="ident" id="4094594">RDNSequence</span>&nbsp;<span class="op" id="4094606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094609">if</span>&nbsp;<span class="builtinfunc" id="4094612">len</span><span class="op" id="4094615">(</span><span class="ident" id="4094616">values</span><span class="op" id="4094622">)</span>&nbsp;<span class="op" id="4094624">==</span>&nbsp;<span class="num" id="4094627">0</span>&nbsp;<span class="op" id="4094629">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094633">return</span>&nbsp;<span class="ident" id="4094640">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094648">s</span>&nbsp;<span class="op" id="4094650">:=</span>&nbsp;<span class="builtinfunc" id="4094653">make</span><span class="op" id="4094657">(</span><span class="op" id="4094658">[</span><span class="op" id="4094659">]</span><span class="ident" id="4094660">AttributeTypeAndValue</span><span class="op" id="4094681">,</span>&nbsp;<span class="builtinfunc" id="4094683">len</span><span class="op" id="4094686">(</span><span class="ident" id="4094687">values</span><span class="op" id="4094693">)</span><span class="op" id="4094694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094697">for</span>&nbsp;<span class="ident" id="4094701">i</span><span class="op" id="4094702">,</span>&nbsp;<span class="ident" id="4094704">value</span>&nbsp;<span class="op" id="4094710">:=</span>&nbsp;<span class="keyword" id="4094713">range</span>&nbsp;<span class="ident" id="4094719">values</span>&nbsp;<span class="op" id="4094726">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094730">s</span><span class="op" id="4094731">[</span><span class="ident" id="4094732">i</span><span class="op" id="4094733">]</span><span class="op" id="4094734">.</span><span class="ident" id="4094735">Type</span>&nbsp;<span class="op" id="4094740">=</span>&nbsp;<span class="ident" id="4094742">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094748">s</span><span class="op" id="4094749">[</span><span class="ident" id="4094750">i</span><span class="op" id="4094751">]</span><span class="op" id="4094752">.</span><span class="ident" id="4094753">Value</span>&nbsp;<span class="op" id="4094759">=</span>&nbsp;<span class="ident" id="4094761">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4094768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094772">return</span>&nbsp;<span class="builtinfunc" id="4094779">append</span><span class="op" id="4094785">(</span><span class="ident" id="4094786">in</span><span class="op" id="4094788">,</span>&nbsp;<span class="ident" id="4094790">s</span><span class="op" id="4094791">)</span><br>
<span class="lineno">125</span><span class="op" id="4094793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094796">func</span>&nbsp;<span class="op" id="4094801">(</span><span class="ident" id="4094802">n</span>&nbsp;<span class="ident" id="4094804">Name</span><span class="op" id="4094808">)</span>&nbsp;<span class="ident" id="4094810">ToRDNSequence</span><span class="op" id="4094823">(</span><span class="op" id="4094824">)</span>&nbsp;<span class="op" id="4094826">(</span><span class="ident" id="4094827">ret</span>&nbsp;<span class="ident" id="4094831">RDNSequence</span><span class="op" id="4094842">)</span>&nbsp;<span class="op" id="4094844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094847">ret</span>&nbsp;<span class="op" id="4094851">=</span>&nbsp;<span class="ident" id="4094853">appendRDNs</span><span class="op" id="4094863">(</span><span class="ident" id="4094864">ret</span><span class="op" id="4094867">,</span>&nbsp;<span class="ident" id="4094869">n</span><span class="op" id="4094870">.</span><span class="ident" id="4094871">Country</span><span class="op" id="4094878">,</span>&nbsp;<span class="ident" id="4094880">oidCountry</span><span class="op" id="4094890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094893">ret</span>&nbsp;<span class="op" id="4094897">=</span>&nbsp;<span class="ident" id="4094899">appendRDNs</span><span class="op" id="4094909">(</span><span class="ident" id="4094910">ret</span><span class="op" id="4094913">,</span>&nbsp;<span class="ident" id="4094915">n</span><span class="op" id="4094916">.</span><span class="ident" id="4094917">Organization</span><span class="op" id="4094929">,</span>&nbsp;<span class="ident" id="4094931">oidOrganization</span><span class="op" id="4094946">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094949">ret</span>&nbsp;<span class="op" id="4094953">=</span>&nbsp;<span class="ident" id="4094955">appendRDNs</span><span class="op" id="4094965">(</span><span class="ident" id="4094966">ret</span><span class="op" id="4094969">,</span>&nbsp;<span class="ident" id="4094971">n</span><span class="op" id="4094972">.</span><span class="ident" id="4094973">OrganizationalUnit</span><span class="op" id="4094991">,</span>&nbsp;<span class="ident" id="4094993">oidOrganizationalUnit</span><span class="op" id="4095014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095017">ret</span>&nbsp;<span class="op" id="4095021">=</span>&nbsp;<span class="ident" id="4095023">appendRDNs</span><span class="op" id="4095033">(</span><span class="ident" id="4095034">ret</span><span class="op" id="4095037">,</span>&nbsp;<span class="ident" id="4095039">n</span><span class="op" id="4095040">.</span><span class="ident" id="4095041">Locality</span><span class="op" id="4095049">,</span>&nbsp;<span class="ident" id="4095051">oidLocality</span><span class="op" id="4095062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095065">ret</span>&nbsp;<span class="op" id="4095069">=</span>&nbsp;<span class="ident" id="4095071">appendRDNs</span><span class="op" id="4095081">(</span><span class="ident" id="4095082">ret</span><span class="op" id="4095085">,</span>&nbsp;<span class="ident" id="4095087">n</span><span class="op" id="4095088">.</span><span class="ident" id="4095089">Province</span><span class="op" id="4095097">,</span>&nbsp;<span class="ident" id="4095099">oidProvince</span><span class="op" id="4095110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095113">ret</span>&nbsp;<span class="op" id="4095117">=</span>&nbsp;<span class="ident" id="4095119">appendRDNs</span><span class="op" id="4095129">(</span><span class="ident" id="4095130">ret</span><span class="op" id="4095133">,</span>&nbsp;<span class="ident" id="4095135">n</span><span class="op" id="4095136">.</span><span class="ident" id="4095137">StreetAddress</span><span class="op" id="4095150">,</span>&nbsp;<span class="ident" id="4095152">oidStreetAddress</span><span class="op" id="4095168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095171">ret</span>&nbsp;<span class="op" id="4095175">=</span>&nbsp;<span class="ident" id="4095177">appendRDNs</span><span class="op" id="4095187">(</span><span class="ident" id="4095188">ret</span><span class="op" id="4095191">,</span>&nbsp;<span class="ident" id="4095193">n</span><span class="op" id="4095194">.</span><span class="ident" id="4095195">PostalCode</span><span class="op" id="4095205">,</span>&nbsp;<span class="ident" id="4095207">oidPostalCode</span><span class="op" id="4095220">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095223">if</span>&nbsp;<span class="builtinfunc" id="4095226">len</span><span class="op" id="4095229">(</span><span class="ident" id="4095230">n</span><span class="op" id="4095231">.</span><span class="ident" id="4095232">CommonName</span><span class="op" id="4095242">)</span>&nbsp;<span class="op" id="4095244">&gt;</span>&nbsp;<span class="num" id="4095246">0</span>&nbsp;<span class="op" id="4095248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095252">ret</span>&nbsp;<span class="op" id="4095256">=</span>&nbsp;<span class="ident" id="4095258">appendRDNs</span><span class="op" id="4095268">(</span><span class="ident" id="4095269">ret</span><span class="op" id="4095272">,</span>&nbsp;<span class="op" id="4095274">[</span><span class="op" id="4095275">]</span><span class="builtintype" id="4095276">string</span><span class="op" id="4095282">{</span><span class="ident" id="4095283">n</span><span class="op" id="4095284">.</span><span class="ident" id="4095285">CommonName</span><span class="op" id="4095295">}</span><span class="op" id="4095296">,</span>&nbsp;<span class="ident" id="4095298">oidCommonName</span><span class="op" id="4095311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095317">if</span>&nbsp;<span class="builtinfunc" id="4095320">len</span><span class="op" id="4095323">(</span><span class="ident" id="4095324">n</span><span class="op" id="4095325">.</span><span class="ident" id="4095326">SerialNumber</span><span class="op" id="4095338">)</span>&nbsp;<span class="op" id="4095340">&gt;</span>&nbsp;<span class="num" id="4095342">0</span>&nbsp;<span class="op" id="4095344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095348">ret</span>&nbsp;<span class="op" id="4095352">=</span>&nbsp;<span class="ident" id="4095354">appendRDNs</span><span class="op" id="4095364">(</span><span class="ident" id="4095365">ret</span><span class="op" id="4095368">,</span>&nbsp;<span class="op" id="4095370">[</span><span class="op" id="4095371">]</span><span class="builtintype" id="4095372">string</span><span class="op" id="4095378">{</span><span class="ident" id="4095379">n</span><span class="op" id="4095380">.</span><span class="ident" id="4095381">SerialNumber</span><span class="op" id="4095393">}</span><span class="op" id="4095394">,</span>&nbsp;<span class="ident" id="4095396">oidSerialNumber</span><span class="op" id="4095411">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095418">return</span>&nbsp;<span class="ident" id="4095425">ret</span><br>
<span class="lineno"></span><span class="op" id="4095429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4095432">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4095508">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4095578">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4095592">type</span>&nbsp;<span class="ident" id="4095597">CertificateList</span>&nbsp;<span class="keyword" id="4095613">struct</span>&nbsp;<span class="op" id="4095620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095623">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095642">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095662">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4095681">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095702">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095721">asn1</span><span class="op" id="4095725">.</span><span class="ident" id="4095726">BitString</span><br>
<span class="lineno"></span><span class="op" id="4095736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095739">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4095810">func</span>&nbsp;<span class="op" id="4095815">(</span><span class="ident" id="4095816">certList</span>&nbsp;<span class="op" id="4095825">*</span><span class="ident" id="4095826">CertificateList</span><span class="op" id="4095841">)</span>&nbsp;<span class="ident" id="4095843">HasExpired</span><span class="op" id="4095853">(</span><span class="ident" id="4095854">now</span>&nbsp;<span class="ident" id="4095858">time</span><span class="op" id="4095862">.</span><span class="ident" id="4095863">Time</span><span class="op" id="4095867">)</span>&nbsp;<span class="builtintype" id="4095869">bool</span>&nbsp;<span class="op" id="4095874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095877">return</span>&nbsp;<span class="ident" id="4095884">now</span><span class="op" id="4095887">.</span><span class="ident" id="4095888">After</span><span class="op" id="4095893">(</span><span class="ident" id="4095894">certList</span><span class="op" id="4095902">.</span><span class="ident" id="4095903">TBSCertList</span><span class="op" id="4095914">.</span><span class="ident" id="4095915">NextUpdate</span><span class="op" id="4095925">)</span><br>
<span class="lineno"></span><span class="op" id="4095927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095930">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4096009">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4096031">type</span>&nbsp;<span class="ident" id="4096036">TBSCertificateList</span>&nbsp;<span class="keyword" id="4096055">struct</span>&nbsp;<span class="op" id="4096062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096065">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096085">asn1</span><span class="op" id="4096089">.</span><span class="ident" id="4096090">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096102">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096122">int</span>&nbsp;<span class="string" id="4096126">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096155">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096175">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096196">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096216">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096229">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096249">time</span><span class="op" id="4096253">.</span><span class="ident" id="4096254">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096260">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096280">time</span><span class="op" id="4096284">.</span><span class="ident" id="4096285">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4096301">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096320">RevokedCertificates</span>&nbsp;<span class="op" id="4096340">[</span><span class="op" id="4096341">]</span><span class="ident" id="4096342">RevokedCertificate</span>&nbsp;<span class="string" id="4096361">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096380">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096400">[</span><span class="op" id="4096401">]</span><span class="ident" id="4096402">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4096421">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4096454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4096457">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4096536">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4096558">type</span>&nbsp;<span class="ident" id="4096563">RevokedCertificate</span>&nbsp;<span class="keyword" id="4096582">struct</span>&nbsp;<span class="op" id="4096589">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096592">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4096607">*</span><span class="ident" id="4096608">big</span><span class="op" id="4096611">.</span><span class="ident" id="4096612">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096617">RevocationTime</span>&nbsp;<span class="ident" id="4096632">time</span><span class="op" id="4096636">.</span><span class="ident" id="4096637">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096643">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096658">[</span><span class="op" id="4096659">]</span><span class="ident" id="4096660">Extension</span>&nbsp;<span class="string" id="4096670">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4096688">}</span>
</div>
</body>
</html>
