<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html" class="current">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2026991">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2027047">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2027101">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2027152">package</span>&nbsp;<span class="ident" id="2027160">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2027166">import</span>&nbsp;<span class="string" id="2027173">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2027182">//&nbsp;Compact&nbsp;appends&nbsp;to&nbsp;dst&nbsp;the&nbsp;JSON-encoded&nbsp;src&nbsp;with</span><br>
<span class="lineno">10</span><span class="comment" id="2027234">//&nbsp;insignificant&nbsp;space&nbsp;characters&nbsp;elided.</span><br>
<span class="lineno"></span><span class="keyword" id="2027276">func</span>&nbsp;<span class="ident" id="2027281">Compact</span><span class="op" id="2027288">(</span><span class="ident" id="2027289">dst</span>&nbsp;<span class="op" id="2027293">*</span><span class="ident" id="2027294">bytes</span><span class="op" id="2027299">.</span><span class="ident" id="2027300">Buffer</span><span class="op" id="2027306">,</span>&nbsp;<span class="ident" id="2027308">src</span>&nbsp;<span class="op" id="2027312">[</span><span class="op" id="2027313">]</span><span class="builtintype" id="2027314">byte</span><span class="op" id="2027318">)</span>&nbsp;<span class="builtintype" id="2027320">error</span>&nbsp;<span class="op" id="2027326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027329">return</span>&nbsp;<span class="ident" id="2027336">compact</span><span class="op" id="2027343">(</span><span class="ident" id="2027344">dst</span><span class="op" id="2027347">,</span>&nbsp;<span class="ident" id="2027349">src</span><span class="op" id="2027352">,</span>&nbsp;<span class="builtintype" id="2027354">false</span><span class="op" id="2027359">)</span><br>
<span class="lineno"></span><span class="op" id="2027361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2027364">func</span>&nbsp;<span class="ident" id="2027369">compact</span><span class="op" id="2027376">(</span><span class="ident" id="2027377">dst</span>&nbsp;<span class="op" id="2027381">*</span><span class="ident" id="2027382">bytes</span><span class="op" id="2027387">.</span><span class="ident" id="2027388">Buffer</span><span class="op" id="2027394">,</span>&nbsp;<span class="ident" id="2027396">src</span>&nbsp;<span class="op" id="2027400">[</span><span class="op" id="2027401">]</span><span class="builtintype" id="2027402">byte</span><span class="op" id="2027406">,</span>&nbsp;<span class="ident" id="2027408">escape</span>&nbsp;<span class="builtintype" id="2027415">bool</span><span class="op" id="2027419">)</span>&nbsp;<span class="builtintype" id="2027421">error</span>&nbsp;<span class="op" id="2027427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027430">origLen</span>&nbsp;<span class="op" id="2027438">:=</span>&nbsp;<span class="ident" id="2027441">dst</span><span class="op" id="2027444">.</span><span class="ident" id="2027445">Len</span><span class="op" id="2027448">(</span><span class="op" id="2027449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027452">var</span>&nbsp;<span class="ident" id="2027456">scan</span>&nbsp;<span class="ident" id="2027461">scanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027470">scan</span><span class="op" id="2027474">.</span><span class="ident" id="2027475">reset</span><span class="op" id="2027480">(</span><span class="op" id="2027481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027484">start</span>&nbsp;<span class="op" id="2027490">:=</span>&nbsp;<span class="num" id="2027493">0</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027496">for</span>&nbsp;<span class="ident" id="2027500">i</span><span class="op" id="2027501">,</span>&nbsp;<span class="ident" id="2027503">c</span>&nbsp;<span class="op" id="2027505">:=</span>&nbsp;<span class="keyword" id="2027508">range</span>&nbsp;<span class="ident" id="2027514">src</span>&nbsp;<span class="op" id="2027518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027522">if</span>&nbsp;<span class="ident" id="2027525">escape</span>&nbsp;<span class="op" id="2027532">&amp;&amp;</span>&nbsp;<span class="op" id="2027535">(</span><span class="ident" id="2027536">c</span>&nbsp;<span class="op" id="2027538">==</span>&nbsp;<span class="string" id="2027541">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="2027545">||</span>&nbsp;<span class="ident" id="2027548">c</span>&nbsp;<span class="op" id="2027550">==</span>&nbsp;<span class="string" id="2027553">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="2027557">||</span>&nbsp;<span class="ident" id="2027560">c</span>&nbsp;<span class="op" id="2027562">==</span>&nbsp;<span class="string" id="2027565">&#39;&amp;&#39;</span><span class="op" id="2027568">)</span>&nbsp;<span class="op" id="2027570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027575">if</span>&nbsp;<span class="ident" id="2027578">start</span>&nbsp;<span class="op" id="2027584">&lt;</span>&nbsp;<span class="ident" id="2027586">i</span>&nbsp;<span class="op" id="2027588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027594">dst</span><span class="op" id="2027597">.</span><span class="ident" id="2027598">Write</span><span class="op" id="2027603">(</span><span class="ident" id="2027604">src</span><span class="op" id="2027607">[</span><span class="ident" id="2027608">start</span><span class="op" id="2027613">:</span><span class="ident" id="2027614">i</span><span class="op" id="2027615">]</span><span class="op" id="2027616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027621">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027626">dst</span><span class="op" id="2027629">.</span><span class="ident" id="2027630">WriteString</span><span class="op" id="2027641">(</span><span class="string" id="2027642">`\u00`</span><span class="op" id="2027648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027653">dst</span><span class="op" id="2027656">.</span><span class="ident" id="2027657">WriteByte</span><span class="op" id="2027666">(</span><span class="ident" id="2027667">hex</span><span class="op" id="2027670">[</span><span class="ident" id="2027671">c</span><span class="op" id="2027672">&gt;&gt;</span><span class="num" id="2027674">4</span><span class="op" id="2027675">]</span><span class="op" id="2027676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027681">dst</span><span class="op" id="2027684">.</span><span class="ident" id="2027685">WriteByte</span><span class="op" id="2027694">(</span><span class="ident" id="2027695">hex</span><span class="op" id="2027698">[</span><span class="ident" id="2027699">c</span><span class="op" id="2027700">&amp;</span><span class="num" id="2027701">0xF</span><span class="op" id="2027704">]</span><span class="op" id="2027705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027710">start</span>&nbsp;<span class="op" id="2027716">=</span>&nbsp;<span class="ident" id="2027718">i</span>&nbsp;<span class="op" id="2027720">+</span>&nbsp;<span class="num" id="2027722">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027726">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2027730">//&nbsp;Convert&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;(E2&nbsp;80&nbsp;A8&nbsp;and&nbsp;E2&nbsp;80&nbsp;A9).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027786">if</span>&nbsp;<span class="ident" id="2027789">c</span>&nbsp;<span class="op" id="2027791">==</span>&nbsp;<span class="num" id="2027794">0xE2</span>&nbsp;<span class="op" id="2027799">&amp;&amp;</span>&nbsp;<span class="ident" id="2027802">i</span><span class="op" id="2027803">+</span><span class="num" id="2027804">2</span>&nbsp;<span class="op" id="2027806">&lt;</span>&nbsp;<span class="builtinfunc" id="2027808">len</span><span class="op" id="2027811">(</span><span class="ident" id="2027812">src</span><span class="op" id="2027815">)</span>&nbsp;<span class="op" id="2027817">&amp;&amp;</span>&nbsp;<span class="ident" id="2027820">src</span><span class="op" id="2027823">[</span><span class="ident" id="2027824">i</span><span class="op" id="2027825">+</span><span class="num" id="2027826">1</span><span class="op" id="2027827">]</span>&nbsp;<span class="op" id="2027829">==</span>&nbsp;<span class="num" id="2027832">0x80</span>&nbsp;<span class="op" id="2027837">&amp;&amp;</span>&nbsp;<span class="ident" id="2027840">src</span><span class="op" id="2027843">[</span><span class="ident" id="2027844">i</span><span class="op" id="2027845">+</span><span class="num" id="2027846">2</span><span class="op" id="2027847">]</span><span class="op" id="2027848">&amp;^</span><span class="num" id="2027850">1</span>&nbsp;<span class="op" id="2027852">==</span>&nbsp;<span class="num" id="2027855">0xA8</span>&nbsp;<span class="op" id="2027860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027865">if</span>&nbsp;<span class="ident" id="2027868">start</span>&nbsp;<span class="op" id="2027874">&lt;</span>&nbsp;<span class="ident" id="2027876">i</span>&nbsp;<span class="op" id="2027878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027884">dst</span><span class="op" id="2027887">.</span><span class="ident" id="2027888">Write</span><span class="op" id="2027893">(</span><span class="ident" id="2027894">src</span><span class="op" id="2027897">[</span><span class="ident" id="2027898">start</span><span class="op" id="2027903">:</span><span class="ident" id="2027904">i</span><span class="op" id="2027905">]</span><span class="op" id="2027906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027911">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027916">dst</span><span class="op" id="2027919">.</span><span class="ident" id="2027920">WriteString</span><span class="op" id="2027931">(</span><span class="string" id="2027932">`\u202`</span><span class="op" id="2027939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027944">dst</span><span class="op" id="2027947">.</span><span class="ident" id="2027948">WriteByte</span><span class="op" id="2027957">(</span><span class="ident" id="2027958">hex</span><span class="op" id="2027961">[</span><span class="ident" id="2027962">src</span><span class="op" id="2027965">[</span><span class="ident" id="2027966">i</span><span class="op" id="2027967">+</span><span class="num" id="2027968">2</span><span class="op" id="2027969">]</span><span class="op" id="2027970">&amp;</span><span class="num" id="2027971">0xF</span><span class="op" id="2027974">]</span><span class="op" id="2027975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027980">start</span>&nbsp;<span class="op" id="2027986">=</span>&nbsp;<span class="ident" id="2027988">i</span>&nbsp;<span class="op" id="2027990">+</span>&nbsp;<span class="num" id="2027992">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028000">v</span>&nbsp;<span class="op" id="2028002">:=</span>&nbsp;<span class="ident" id="2028005">scan</span><span class="op" id="2028009">.</span><span class="ident" id="2028010">step</span><span class="op" id="2028014">(</span><span class="op" id="2028015">&amp;</span><span class="ident" id="2028016">scan</span><span class="op" id="2028020">,</span>&nbsp;<span class="builtintype" id="2028022">int</span><span class="op" id="2028025">(</span><span class="ident" id="2028026">c</span><span class="op" id="2028027">)</span><span class="op" id="2028028">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028032">if</span>&nbsp;<span class="ident" id="2028035">v</span>&nbsp;<span class="op" id="2028037">&gt;=</span>&nbsp;<span class="ident" id="2028040">scanSkipSpace</span>&nbsp;<span class="op" id="2028054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028059">if</span>&nbsp;<span class="ident" id="2028062">v</span>&nbsp;<span class="op" id="2028064">==</span>&nbsp;<span class="ident" id="2028067">scanError</span>&nbsp;<span class="op" id="2028077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028083">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028097">if</span>&nbsp;<span class="ident" id="2028100">start</span>&nbsp;<span class="op" id="2028106">&lt;</span>&nbsp;<span class="ident" id="2028108">i</span>&nbsp;<span class="op" id="2028110">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028116">dst</span><span class="op" id="2028119">.</span><span class="ident" id="2028120">Write</span><span class="op" id="2028125">(</span><span class="ident" id="2028126">src</span><span class="op" id="2028129">[</span><span class="ident" id="2028130">start</span><span class="op" id="2028135">:</span><span class="ident" id="2028136">i</span><span class="op" id="2028137">]</span><span class="op" id="2028138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028148">start</span>&nbsp;<span class="op" id="2028154">=</span>&nbsp;<span class="ident" id="2028156">i</span>&nbsp;<span class="op" id="2028158">+</span>&nbsp;<span class="num" id="2028160">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028167">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028170">if</span>&nbsp;<span class="ident" id="2028173">scan</span><span class="op" id="2028177">.</span><span class="ident" id="2028178">eof</span><span class="op" id="2028181">(</span><span class="op" id="2028182">)</span>&nbsp;<span class="op" id="2028184">==</span>&nbsp;<span class="ident" id="2028187">scanError</span>&nbsp;<span class="op" id="2028197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028201">dst</span><span class="op" id="2028204">.</span><span class="ident" id="2028205">Truncate</span><span class="op" id="2028213">(</span><span class="ident" id="2028214">origLen</span><span class="op" id="2028221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028225">return</span>&nbsp;<span class="ident" id="2028232">scan</span><span class="op" id="2028236">.</span><span class="ident" id="2028237">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028245">if</span>&nbsp;<span class="ident" id="2028248">start</span>&nbsp;<span class="op" id="2028254">&lt;</span>&nbsp;<span class="builtinfunc" id="2028256">len</span><span class="op" id="2028259">(</span><span class="ident" id="2028260">src</span><span class="op" id="2028263">)</span>&nbsp;<span class="op" id="2028265">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028269">dst</span><span class="op" id="2028272">.</span><span class="ident" id="2028273">Write</span><span class="op" id="2028278">(</span><span class="ident" id="2028279">src</span><span class="op" id="2028282">[</span><span class="ident" id="2028283">start</span><span class="op" id="2028288">:</span><span class="op" id="2028289">]</span><span class="op" id="2028290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028296">return</span>&nbsp;<span class="builtintype" id="2028303">nil</span><br>
<span class="lineno"></span><span class="op" id="2028307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2028310">func</span>&nbsp;<span class="ident" id="2028315">newline</span><span class="op" id="2028322">(</span><span class="ident" id="2028323">dst</span>&nbsp;<span class="op" id="2028327">*</span><span class="ident" id="2028328">bytes</span><span class="op" id="2028333">.</span><span class="ident" id="2028334">Buffer</span><span class="op" id="2028340">,</span>&nbsp;<span class="ident" id="2028342">prefix</span><span class="op" id="2028348">,</span>&nbsp;<span class="ident" id="2028350">indent</span>&nbsp;<span class="builtintype" id="2028357">string</span><span class="op" id="2028363">,</span>&nbsp;<span class="ident" id="2028365">depth</span>&nbsp;<span class="builtintype" id="2028371">int</span><span class="op" id="2028374">)</span>&nbsp;<span class="op" id="2028376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028379">dst</span><span class="op" id="2028382">.</span><span class="ident" id="2028383">WriteByte</span><span class="op" id="2028392">(</span><span class="string" id="2028393">&#39;\n&#39;</span><span class="op" id="2028397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028400">dst</span><span class="op" id="2028403">.</span><span class="ident" id="2028404">WriteString</span><span class="op" id="2028415">(</span><span class="ident" id="2028416">prefix</span><span class="op" id="2028422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028425">for</span>&nbsp;<span class="ident" id="2028429">i</span>&nbsp;<span class="op" id="2028431">:=</span>&nbsp;<span class="num" id="2028434">0</span><span class="op" id="2028435">;</span>&nbsp;<span class="ident" id="2028437">i</span>&nbsp;<span class="op" id="2028439">&lt;</span>&nbsp;<span class="ident" id="2028441">depth</span><span class="op" id="2028446">;</span>&nbsp;<span class="ident" id="2028448">i</span><span class="op" id="2028449">++</span>&nbsp;<span class="op" id="2028452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028456">dst</span><span class="op" id="2028459">.</span><span class="ident" id="2028460">WriteString</span><span class="op" id="2028471">(</span><span class="ident" id="2028472">indent</span><span class="op" id="2028478">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028481">}</span><br>
<span class="lineno"></span><span class="op" id="2028483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2028486">//&nbsp;Indent&nbsp;appends&nbsp;to&nbsp;dst&nbsp;an&nbsp;indented&nbsp;form&nbsp;of&nbsp;the&nbsp;JSON-encoded&nbsp;src.</span><br>
<span class="lineno"></span><span class="comment" id="2028553">//&nbsp;Each&nbsp;element&nbsp;in&nbsp;a&nbsp;JSON&nbsp;object&nbsp;or&nbsp;array&nbsp;begins&nbsp;on&nbsp;a&nbsp;new,</span><br>
<span class="lineno">70</span><span class="comment" id="2028612">//&nbsp;indented&nbsp;line&nbsp;beginning&nbsp;with&nbsp;prefix&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2028675">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;indentation&nbsp;nesting.</span><br>
<span class="lineno"></span><span class="comment" id="2028733">//&nbsp;The&nbsp;data&nbsp;appended&nbsp;to&nbsp;dst&nbsp;does&nbsp;not&nbsp;begin&nbsp;with&nbsp;the&nbsp;prefix&nbsp;nor</span><br>
<span class="lineno"></span><span class="comment" id="2028796">//&nbsp;any&nbsp;indentation,&nbsp;and&nbsp;has&nbsp;no&nbsp;trailing&nbsp;newline,&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2028856">//&nbsp;easier&nbsp;to&nbsp;embed&nbsp;inside&nbsp;other&nbsp;formatted&nbsp;JSON&nbsp;data.</span><br>
<span class="lineno">75</span><span class="keyword" id="2028909">func</span>&nbsp;<span class="ident" id="2028914">Indent</span><span class="op" id="2028920">(</span><span class="ident" id="2028921">dst</span>&nbsp;<span class="op" id="2028925">*</span><span class="ident" id="2028926">bytes</span><span class="op" id="2028931">.</span><span class="ident" id="2028932">Buffer</span><span class="op" id="2028938">,</span>&nbsp;<span class="ident" id="2028940">src</span>&nbsp;<span class="op" id="2028944">[</span><span class="op" id="2028945">]</span><span class="builtintype" id="2028946">byte</span><span class="op" id="2028950">,</span>&nbsp;<span class="ident" id="2028952">prefix</span><span class="op" id="2028958">,</span>&nbsp;<span class="ident" id="2028960">indent</span>&nbsp;<span class="builtintype" id="2028967">string</span><span class="op" id="2028973">)</span>&nbsp;<span class="builtintype" id="2028975">error</span>&nbsp;<span class="op" id="2028981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028984">origLen</span>&nbsp;<span class="op" id="2028992">:=</span>&nbsp;<span class="ident" id="2028995">dst</span><span class="op" id="2028998">.</span><span class="ident" id="2028999">Len</span><span class="op" id="2029002">(</span><span class="op" id="2029003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029006">var</span>&nbsp;<span class="ident" id="2029010">scan</span>&nbsp;<span class="ident" id="2029015">scanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029024">scan</span><span class="op" id="2029028">.</span><span class="ident" id="2029029">reset</span><span class="op" id="2029034">(</span><span class="op" id="2029035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029038">needIndent</span>&nbsp;<span class="op" id="2029049">:=</span>&nbsp;<span class="builtintype" id="2029052">false</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029059">depth</span>&nbsp;<span class="op" id="2029065">:=</span>&nbsp;<span class="num" id="2029068">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029071">for</span>&nbsp;<span class="ident" id="2029075">_</span><span class="op" id="2029076">,</span>&nbsp;<span class="ident" id="2029078">c</span>&nbsp;<span class="op" id="2029080">:=</span>&nbsp;<span class="keyword" id="2029083">range</span>&nbsp;<span class="ident" id="2029089">src</span>&nbsp;<span class="op" id="2029093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029097">scan</span><span class="op" id="2029101">.</span><span class="ident" id="2029102">bytes</span><span class="op" id="2029107">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029112">v</span>&nbsp;<span class="op" id="2029114">:=</span>&nbsp;<span class="ident" id="2029117">scan</span><span class="op" id="2029121">.</span><span class="ident" id="2029122">step</span><span class="op" id="2029126">(</span><span class="op" id="2029127">&amp;</span><span class="ident" id="2029128">scan</span><span class="op" id="2029132">,</span>&nbsp;<span class="builtintype" id="2029134">int</span><span class="op" id="2029137">(</span><span class="ident" id="2029138">c</span><span class="op" id="2029139">)</span><span class="op" id="2029140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029144">if</span>&nbsp;<span class="ident" id="2029147">v</span>&nbsp;<span class="op" id="2029149">==</span>&nbsp;<span class="ident" id="2029152">scanSkipSpace</span>&nbsp;<span class="op" id="2029166">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029171">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029186">if</span>&nbsp;<span class="ident" id="2029189">v</span>&nbsp;<span class="op" id="2029191">==</span>&nbsp;<span class="ident" id="2029194">scanError</span>&nbsp;<span class="op" id="2029204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029209">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029217">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029221">if</span>&nbsp;<span class="ident" id="2029224">needIndent</span>&nbsp;<span class="op" id="2029235">&amp;&amp;</span>&nbsp;<span class="ident" id="2029238">v</span>&nbsp;<span class="op" id="2029240">!=</span>&nbsp;<span class="ident" id="2029243">scanEndObject</span>&nbsp;<span class="op" id="2029257">&amp;&amp;</span>&nbsp;<span class="ident" id="2029260">v</span>&nbsp;<span class="op" id="2029262">!=</span>&nbsp;<span class="ident" id="2029265">scanEndArray</span>&nbsp;<span class="op" id="2029278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029283">needIndent</span>&nbsp;<span class="op" id="2029294">=</span>&nbsp;<span class="builtintype" id="2029296">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029305">depth</span><span class="op" id="2029310">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029316">newline</span><span class="op" id="2029323">(</span><span class="ident" id="2029324">dst</span><span class="op" id="2029327">,</span>&nbsp;<span class="ident" id="2029329">prefix</span><span class="op" id="2029335">,</span>&nbsp;<span class="ident" id="2029337">indent</span><span class="op" id="2029343">,</span>&nbsp;<span class="ident" id="2029345">depth</span><span class="op" id="2029350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029354">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2029359">//&nbsp;Emit&nbsp;semantically&nbsp;uninteresting&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2029402">//&nbsp;(in&nbsp;particular,&nbsp;punctuation&nbsp;in&nbsp;strings)&nbsp;unmodified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029459">if</span>&nbsp;<span class="ident" id="2029462">v</span>&nbsp;<span class="op" id="2029464">==</span>&nbsp;<span class="ident" id="2029467">scanContinue</span>&nbsp;<span class="op" id="2029480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029485">dst</span><span class="op" id="2029488">.</span><span class="ident" id="2029489">WriteByte</span><span class="op" id="2029498">(</span><span class="ident" id="2029499">c</span><span class="op" id="2029500">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029505">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2029521">//&nbsp;Add&nbsp;spacing&nbsp;around&nbsp;real&nbsp;punctuation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029563">switch</span>&nbsp;<span class="ident" id="2029570">c</span>&nbsp;<span class="op" id="2029572">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029576">case</span>&nbsp;<span class="string" id="2029581">&#39;{&#39;</span><span class="op" id="2029584">,</span>&nbsp;<span class="string" id="2029586">&#39;[&#39;</span><span class="op" id="2029589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2029594">//&nbsp;delay&nbsp;indent&nbsp;so&nbsp;that&nbsp;empty&nbsp;object&nbsp;and&nbsp;array&nbsp;are&nbsp;formatted&nbsp;as&nbsp;{}&nbsp;and&nbsp;[].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029672">needIndent</span>&nbsp;<span class="op" id="2029683">=</span>&nbsp;<span class="builtintype" id="2029685">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029693">dst</span><span class="op" id="2029696">.</span><span class="ident" id="2029697">WriteByte</span><span class="op" id="2029706">(</span><span class="ident" id="2029707">c</span><span class="op" id="2029708">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029713">case</span>&nbsp;<span class="string" id="2029718">&#39;,&#39;</span><span class="op" id="2029721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029726">dst</span><span class="op" id="2029729">.</span><span class="ident" id="2029730">WriteByte</span><span class="op" id="2029739">(</span><span class="ident" id="2029740">c</span><span class="op" id="2029741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029746">newline</span><span class="op" id="2029753">(</span><span class="ident" id="2029754">dst</span><span class="op" id="2029757">,</span>&nbsp;<span class="ident" id="2029759">prefix</span><span class="op" id="2029765">,</span>&nbsp;<span class="ident" id="2029767">indent</span><span class="op" id="2029773">,</span>&nbsp;<span class="ident" id="2029775">depth</span><span class="op" id="2029780">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029785">case</span>&nbsp;<span class="string" id="2029790">&#39;:&#39;</span><span class="op" id="2029793">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029798">dst</span><span class="op" id="2029801">.</span><span class="ident" id="2029802">WriteByte</span><span class="op" id="2029811">(</span><span class="ident" id="2029812">c</span><span class="op" id="2029813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029818">dst</span><span class="op" id="2029821">.</span><span class="ident" id="2029822">WriteByte</span><span class="op" id="2029831">(</span><span class="string" id="2029832">&#39;&nbsp;&#39;</span><span class="op" id="2029835">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029840">case</span>&nbsp;<span class="string" id="2029845">&#39;}&#39;</span><span class="op" id="2029848">,</span>&nbsp;<span class="string" id="2029850">&#39;]&#39;</span><span class="op" id="2029853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029858">if</span>&nbsp;<span class="ident" id="2029861">needIndent</span>&nbsp;<span class="op" id="2029872">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2029878">//&nbsp;suppress&nbsp;indent&nbsp;in&nbsp;empty&nbsp;object/array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029923">needIndent</span>&nbsp;<span class="op" id="2029934">=</span>&nbsp;<span class="builtintype" id="2029936">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029945">}</span>&nbsp;<span class="keyword" id="2029947">else</span>&nbsp;<span class="op" id="2029952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029958">depth</span><span class="op" id="2029963">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029970">newline</span><span class="op" id="2029977">(</span><span class="ident" id="2029978">dst</span><span class="op" id="2029981">,</span>&nbsp;<span class="ident" id="2029983">prefix</span><span class="op" id="2029989">,</span>&nbsp;<span class="ident" id="2029991">indent</span><span class="op" id="2029997">,</span>&nbsp;<span class="ident" id="2029999">depth</span><span class="op" id="2030004">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030014">dst</span><span class="op" id="2030017">.</span><span class="ident" id="2030018">WriteByte</span><span class="op" id="2030027">(</span><span class="ident" id="2030028">c</span><span class="op" id="2030029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030034">default</span><span class="op" id="2030041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030046">dst</span><span class="op" id="2030049">.</span><span class="ident" id="2030050">WriteByte</span><span class="op" id="2030059">(</span><span class="ident" id="2030060">c</span><span class="op" id="2030061">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030071">if</span>&nbsp;<span class="ident" id="2030074">scan</span><span class="op" id="2030078">.</span><span class="ident" id="2030079">eof</span><span class="op" id="2030082">(</span><span class="op" id="2030083">)</span>&nbsp;<span class="op" id="2030085">==</span>&nbsp;<span class="ident" id="2030088">scanError</span>&nbsp;<span class="op" id="2030098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030102">dst</span><span class="op" id="2030105">.</span><span class="ident" id="2030106">Truncate</span><span class="op" id="2030114">(</span><span class="ident" id="2030115">origLen</span><span class="op" id="2030122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030126">return</span>&nbsp;<span class="ident" id="2030133">scan</span><span class="op" id="2030137">.</span><span class="ident" id="2030138">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030146">return</span>&nbsp;<span class="builtintype" id="2030153">nil</span><br>
<span class="lineno"></span><span class="op" id="2030157">}</span>
</div>
</body>
</html>
