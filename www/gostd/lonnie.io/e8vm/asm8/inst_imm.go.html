<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4866266">package</span>&nbsp;<span class="ident" id="4866274">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4866280">import</span>&nbsp;<span class="op" id="4866287">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866290">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866302">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4866324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4866327">var</span>&nbsp;<span class="op" id="4866331">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4866334">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(signed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866361">opImsMap</span>&nbsp;<span class="op" id="4866370">=</span>&nbsp;<span class="keyword" id="4866372">map</span><span class="op" id="4866375">[</span><span class="builtintype" id="4866376">string</span><span class="op" id="4866382">]</span><span class="builtintype" id="4866383">uint32</span><span class="op" id="4866389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866393">&#34;addi&#34;</span><span class="op" id="4866399">:</span>&nbsp;<span class="num" id="4866401">1</span><span class="op" id="4866402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866406">&#34;slti&#34;</span><span class="op" id="4866412">:</span>&nbsp;<span class="num" id="4866414">2</span><span class="op" id="4866415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4866418">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866422">opMemMap</span>&nbsp;<span class="op" id="4866431">=</span>&nbsp;<span class="keyword" id="4866433">map</span><span class="op" id="4866436">[</span><span class="builtintype" id="4866437">string</span><span class="op" id="4866443">]</span><span class="builtintype" id="4866444">uint32</span><span class="op" id="4866450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866454">&#34;lw&#34;</span><span class="op" id="4866458">:</span>&nbsp;&nbsp;<span class="num" id="4866461">6</span><span class="op" id="4866462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866466">&#34;lb&#34;</span><span class="op" id="4866470">:</span>&nbsp;&nbsp;<span class="num" id="4866473">7</span><span class="op" id="4866474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866478">&#34;lbu&#34;</span><span class="op" id="4866483">:</span>&nbsp;<span class="num" id="4866485">8</span><span class="op" id="4866486">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866490">&#34;sw&#34;</span><span class="op" id="4866494">:</span>&nbsp;&nbsp;<span class="num" id="4866497">9</span><span class="op" id="4866498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866502">&#34;sb&#34;</span><span class="op" id="4866506">:</span>&nbsp;&nbsp;<span class="num" id="4866509">10</span><span class="op" id="4866511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4866514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4866518">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(unsigned)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866547">opImuMap</span>&nbsp;<span class="op" id="4866556">=</span>&nbsp;<span class="keyword" id="4866558">map</span><span class="op" id="4866561">[</span><span class="builtintype" id="4866562">string</span><span class="op" id="4866568">]</span><span class="builtintype" id="4866569">uint32</span><span class="op" id="4866575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866579">&#34;andi&#34;</span><span class="op" id="4866585">:</span>&nbsp;<span class="num" id="4866587">3</span><span class="op" id="4866588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866592">&#34;ori&#34;</span><span class="op" id="4866597">:</span>&nbsp;&nbsp;<span class="num" id="4866600">4</span><span class="op" id="4866601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4866604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4866608">//&nbsp;op&nbsp;reg&nbsp;imm(signed&nbsp;or&nbsp;unsigned)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866643">opImmMap</span>&nbsp;<span class="op" id="4866652">=</span>&nbsp;<span class="keyword" id="4866654">map</span><span class="op" id="4866657">[</span><span class="builtintype" id="4866658">string</span><span class="op" id="4866664">]</span><span class="builtintype" id="4866665">uint32</span><span class="op" id="4866671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4866675">&#34;lui&#34;</span><span class="op" id="4866680">:</span>&nbsp;<span class="num" id="4866682">5</span><span class="op" id="4866683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4866686">}</span><br>
<span class="lineno"></span><span class="op" id="4866688">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4866691">//&nbsp;parseImu&nbsp;parses&nbsp;an&nbsp;unsigned&nbsp;16-bit&nbsp;immediate</span><br>
<span class="lineno"></span><span class="keyword" id="4866739">func</span>&nbsp;<span class="ident" id="4866744">parseImu</span><span class="op" id="4866752">(</span><span class="ident" id="4866753">p</span>&nbsp;<span class="op" id="4866755">*</span><span class="ident" id="4866756">parser</span><span class="op" id="4866762">,</span>&nbsp;<span class="ident" id="4866764">op</span>&nbsp;<span class="op" id="4866767">*</span><span class="ident" id="4866768">lex8</span><span class="op" id="4866772">.</span><span class="ident" id="4866773">Token</span><span class="op" id="4866778">)</span>&nbsp;<span class="builtintype" id="4866780">uint32</span>&nbsp;<span class="op" id="4866787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866790">ret</span><span class="op" id="4866793">,</span>&nbsp;<span class="ident" id="4866795">e</span>&nbsp;<span class="op" id="4866797">:=</span>&nbsp;<span class="ident" id="4866800">strconv</span><span class="op" id="4866807">.</span><span class="ident" id="4866808">ParseUint</span><span class="op" id="4866817">(</span><span class="ident" id="4866818">op</span><span class="op" id="4866820">.</span><span class="ident" id="4866821">Lit</span><span class="op" id="4866824">,</span>&nbsp;<span class="num" id="4866826">0</span><span class="op" id="4866827">,</span>&nbsp;<span class="num" id="4866829">32</span><span class="op" id="4866831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866834">if</span>&nbsp;<span class="ident" id="4866837">e</span>&nbsp;<span class="op" id="4866839">!=</span>&nbsp;<span class="ident" id="4866842">nil</span>&nbsp;<span class="op" id="4866846">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866850">p</span><span class="op" id="4866851">.</span><span class="ident" id="4866852">err</span><span class="op" id="4866855">(</span><span class="ident" id="4866856">op</span><span class="op" id="4866858">.</span><span class="ident" id="4866859">Pos</span><span class="op" id="4866862">,</span>&nbsp;<span class="string" id="4866864">&#34;invalid&nbsp;unsigned&nbsp;immediate&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="4866899">,</span>&nbsp;<span class="ident" id="4866901">op</span><span class="op" id="4866903">.</span><span class="ident" id="4866904">Lit</span><span class="op" id="4866907">,</span>&nbsp;<span class="ident" id="4866909">e</span><span class="op" id="4866910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866914">return</span>&nbsp;<span class="num" id="4866921">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4866924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4866928">if</span>&nbsp;<span class="op" id="4866931">(</span><span class="ident" id="4866932">ret</span>&nbsp;<span class="op" id="4866936">&amp;</span>&nbsp;<span class="num" id="4866938">0xffff</span><span class="op" id="4866944">)</span>&nbsp;<span class="op" id="4866946">!=</span>&nbsp;<span class="ident" id="4866949">ret</span>&nbsp;<span class="op" id="4866953">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4866957">p</span><span class="op" id="4866958">.</span><span class="ident" id="4866959">err</span><span class="op" id="4866962">(</span><span class="ident" id="4866963">op</span><span class="op" id="4866965">.</span><span class="ident" id="4866966">Pos</span><span class="op" id="4866969">,</span>&nbsp;<span class="string" id="4866971">&#34;immediate&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="4866996">,</span>&nbsp;<span class="ident" id="4866998">op</span><span class="op" id="4867000">.</span><span class="ident" id="4867001">Lit</span><span class="op" id="4867004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867008">return</span>&nbsp;<span class="num" id="4867015">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867022">return</span>&nbsp;<span class="builtintype" id="4867029">uint32</span><span class="op" id="4867035">(</span><span class="ident" id="4867036">ret</span><span class="op" id="4867039">)</span><br>
<span class="lineno">50</span><span class="op" id="4867041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4867044">//&nbsp;parseIms&nbsp;parses&nbsp;an&nbsp;unsigned&nbsp;16-bit&nbsp;immediate</span><br>
<span class="lineno"></span><span class="keyword" id="4867092">func</span>&nbsp;<span class="ident" id="4867097">parseIms</span><span class="op" id="4867105">(</span><span class="ident" id="4867106">p</span>&nbsp;<span class="op" id="4867108">*</span><span class="ident" id="4867109">parser</span><span class="op" id="4867115">,</span>&nbsp;<span class="ident" id="4867117">op</span>&nbsp;<span class="op" id="4867120">*</span><span class="ident" id="4867121">lex8</span><span class="op" id="4867125">.</span><span class="ident" id="4867126">Token</span><span class="op" id="4867131">)</span>&nbsp;<span class="builtintype" id="4867133">uint32</span>&nbsp;<span class="op" id="4867140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867143">ret</span><span class="op" id="4867146">,</span>&nbsp;<span class="ident" id="4867148">e</span>&nbsp;<span class="op" id="4867150">:=</span>&nbsp;<span class="ident" id="4867153">strconv</span><span class="op" id="4867160">.</span><span class="ident" id="4867161">ParseInt</span><span class="op" id="4867169">(</span><span class="ident" id="4867170">op</span><span class="op" id="4867172">.</span><span class="ident" id="4867173">Lit</span><span class="op" id="4867176">,</span>&nbsp;<span class="num" id="4867178">0</span><span class="op" id="4867179">,</span>&nbsp;<span class="num" id="4867181">32</span><span class="op" id="4867183">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867186">if</span>&nbsp;<span class="ident" id="4867189">e</span>&nbsp;<span class="op" id="4867191">!=</span>&nbsp;<span class="ident" id="4867194">nil</span>&nbsp;<span class="op" id="4867198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867202">p</span><span class="op" id="4867203">.</span><span class="ident" id="4867204">err</span><span class="op" id="4867207">(</span><span class="ident" id="4867208">op</span><span class="op" id="4867210">.</span><span class="ident" id="4867211">Pos</span><span class="op" id="4867214">,</span>&nbsp;<span class="string" id="4867216">&#34;invalid&nbsp;signed&nbsp;immediate&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="4867249">,</span>&nbsp;<span class="ident" id="4867251">op</span><span class="op" id="4867253">.</span><span class="ident" id="4867254">Lit</span><span class="op" id="4867257">,</span>&nbsp;<span class="ident" id="4867259">e</span><span class="op" id="4867260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867264">return</span>&nbsp;<span class="num" id="4867271">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867278">if</span>&nbsp;<span class="ident" id="4867281">ret</span>&nbsp;<span class="op" id="4867285">&gt;</span>&nbsp;<span class="num" id="4867287">0x7fff</span>&nbsp;<span class="op" id="4867294">||</span>&nbsp;<span class="ident" id="4867297">ret</span>&nbsp;<span class="op" id="4867301">&lt;</span>&nbsp;<span class="op" id="4867303">-</span><span class="num" id="4867304">0x8000</span>&nbsp;<span class="op" id="4867311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867315">p</span><span class="op" id="4867316">.</span><span class="ident" id="4867317">err</span><span class="op" id="4867320">(</span><span class="ident" id="4867321">op</span><span class="op" id="4867323">.</span><span class="ident" id="4867324">Pos</span><span class="op" id="4867327">,</span>&nbsp;<span class="string" id="4867329">&#34;immediate&nbsp;out&nbsp;of&nbsp;16-bit&nbsp;range:&nbsp;%s&#34;</span><span class="op" id="4867364">,</span>&nbsp;<span class="ident" id="4867366">op</span><span class="op" id="4867368">.</span><span class="ident" id="4867369">Lit</span><span class="op" id="4867372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867376">return</span>&nbsp;<span class="num" id="4867383">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867390">return</span>&nbsp;<span class="builtintype" id="4867397">uint32</span><span class="op" id="4867403">(</span><span class="ident" id="4867404">ret</span><span class="op" id="4867407">)</span>&nbsp;<span class="op" id="4867409">&amp;</span>&nbsp;<span class="num" id="4867411">0xffff</span><br>
<span class="lineno"></span><span class="op" id="4867418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4867421">//&nbsp;parseImm&nbsp;parses&nbsp;an&nbsp;unsigned&nbsp;16-bit&nbsp;immediate</span><br>
<span class="lineno"></span><span class="keyword" id="4867469">func</span>&nbsp;<span class="ident" id="4867474">parseImm</span><span class="op" id="4867482">(</span><span class="ident" id="4867483">p</span>&nbsp;<span class="op" id="4867485">*</span><span class="ident" id="4867486">parser</span><span class="op" id="4867492">,</span>&nbsp;<span class="ident" id="4867494">op</span>&nbsp;<span class="op" id="4867497">*</span><span class="ident" id="4867498">lex8</span><span class="op" id="4867502">.</span><span class="ident" id="4867503">Token</span><span class="op" id="4867508">)</span>&nbsp;<span class="builtintype" id="4867510">uint32</span>&nbsp;<span class="op" id="4867517">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867520">ret</span><span class="op" id="4867523">,</span>&nbsp;<span class="ident" id="4867525">e</span>&nbsp;<span class="op" id="4867527">:=</span>&nbsp;<span class="ident" id="4867530">strconv</span><span class="op" id="4867537">.</span><span class="ident" id="4867538">ParseInt</span><span class="op" id="4867546">(</span><span class="ident" id="4867547">op</span><span class="op" id="4867549">.</span><span class="ident" id="4867550">Lit</span><span class="op" id="4867553">,</span>&nbsp;<span class="num" id="4867555">0</span><span class="op" id="4867556">,</span>&nbsp;<span class="num" id="4867558">32</span><span class="op" id="4867560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867563">if</span>&nbsp;<span class="ident" id="4867566">e</span>&nbsp;<span class="op" id="4867568">!=</span>&nbsp;<span class="ident" id="4867571">nil</span>&nbsp;<span class="op" id="4867575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867579">p</span><span class="op" id="4867580">.</span><span class="ident" id="4867581">err</span><span class="op" id="4867584">(</span><span class="ident" id="4867585">op</span><span class="op" id="4867587">.</span><span class="ident" id="4867588">Pos</span><span class="op" id="4867591">,</span>&nbsp;<span class="string" id="4867593">&#34;invalid&nbsp;signed&nbsp;immediate&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="4867626">,</span>&nbsp;<span class="ident" id="4867628">op</span><span class="op" id="4867630">.</span><span class="ident" id="4867631">Lit</span><span class="op" id="4867634">,</span>&nbsp;<span class="ident" id="4867636">e</span><span class="op" id="4867637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867641">return</span>&nbsp;<span class="num" id="4867648">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867651">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867655">if</span>&nbsp;<span class="ident" id="4867658">ret</span>&nbsp;<span class="op" id="4867662">&gt;</span>&nbsp;<span class="num" id="4867664">0xffff</span>&nbsp;<span class="op" id="4867671">||</span>&nbsp;<span class="ident" id="4867674">ret</span>&nbsp;<span class="op" id="4867678">&lt;</span>&nbsp;<span class="op" id="4867680">-</span><span class="num" id="4867681">0x8000</span>&nbsp;<span class="op" id="4867688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867692">p</span><span class="op" id="4867693">.</span><span class="ident" id="4867694">err</span><span class="op" id="4867697">(</span><span class="ident" id="4867698">op</span><span class="op" id="4867700">.</span><span class="ident" id="4867701">Pos</span><span class="op" id="4867704">,</span>&nbsp;<span class="string" id="4867706">&#34;immediate&nbsp;out&nbsp;of&nbsp;16-bit&nbsp;range:&nbsp;%s&#34;</span><span class="op" id="4867741">,</span>&nbsp;<span class="ident" id="4867743">op</span><span class="op" id="4867745">.</span><span class="ident" id="4867746">Lit</span><span class="op" id="4867749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867753">return</span>&nbsp;<span class="num" id="4867760">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4867763">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867767">return</span>&nbsp;<span class="builtintype" id="4867774">uint32</span><span class="op" id="4867780">(</span><span class="ident" id="4867781">ret</span><span class="op" id="4867784">)</span>&nbsp;<span class="op" id="4867786">&amp;</span>&nbsp;<span class="num" id="4867788">0xffff</span><br>
<span class="lineno"></span><span class="op" id="4867795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4867798">func</span>&nbsp;<span class="ident" id="4867803">makeInstImm</span><span class="op" id="4867814">(</span><span class="ident" id="4867815">op</span><span class="op" id="4867817">,</span>&nbsp;<span class="ident" id="4867819">d</span><span class="op" id="4867820">,</span>&nbsp;<span class="ident" id="4867822">s</span><span class="op" id="4867823">,</span>&nbsp;<span class="ident" id="4867825">im</span>&nbsp;<span class="builtintype" id="4867828">uint32</span><span class="op" id="4867834">)</span>&nbsp;<span class="op" id="4867836">*</span><span class="ident" id="4867837">inst</span>&nbsp;<span class="op" id="4867842">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867845">ret</span>&nbsp;<span class="op" id="4867849">:=</span>&nbsp;<span class="builtintype" id="4867852">uint32</span><span class="op" id="4867858">(</span><span class="num" id="4867859">0</span><span class="op" id="4867860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867863">ret</span>&nbsp;<span class="op" id="4867867">|=</span>&nbsp;<span class="op" id="4867870">(</span><span class="ident" id="4867871">op</span>&nbsp;<span class="op" id="4867874">&amp;</span>&nbsp;<span class="num" id="4867876">0xff</span><span class="op" id="4867880">)</span>&nbsp;<span class="op" id="4867882">&lt;&lt;</span>&nbsp;<span class="num" id="4867885">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867889">ret</span>&nbsp;<span class="op" id="4867893">|=</span>&nbsp;<span class="op" id="4867896">(</span><span class="ident" id="4867897">d</span>&nbsp;<span class="op" id="4867899">&amp;</span>&nbsp;<span class="num" id="4867901">0x7</span><span class="op" id="4867904">)</span>&nbsp;<span class="op" id="4867906">&lt;&lt;</span>&nbsp;<span class="num" id="4867909">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867913">ret</span>&nbsp;<span class="op" id="4867917">|=</span>&nbsp;<span class="op" id="4867920">(</span><span class="ident" id="4867921">s</span>&nbsp;<span class="op" id="4867923">&amp;</span>&nbsp;<span class="num" id="4867925">0x7</span><span class="op" id="4867928">)</span>&nbsp;<span class="op" id="4867930">&lt;&lt;</span>&nbsp;<span class="num" id="4867933">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4867937">ret</span>&nbsp;<span class="op" id="4867941">|=</span>&nbsp;<span class="op" id="4867944">(</span><span class="ident" id="4867945">im</span>&nbsp;<span class="op" id="4867948">&amp;</span>&nbsp;<span class="num" id="4867950">0xffff</span><span class="op" id="4867956">)</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4867960">return</span>&nbsp;<span class="op" id="4867967">&amp;</span><span class="ident" id="4867968">inst</span><span class="op" id="4867972">{</span><span class="ident" id="4867973">inst</span><span class="op" id="4867977">:</span>&nbsp;<span class="ident" id="4867979">ret</span><span class="op" id="4867982">}</span><br>
<span class="lineno"></span><span class="op" id="4867984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4867987">func</span>&nbsp;<span class="ident" id="4867992">parseInstImm</span><span class="op" id="4868004">(</span><span class="ident" id="4868005">p</span>&nbsp;<span class="op" id="4868007">*</span><span class="ident" id="4868008">parser</span><span class="op" id="4868014">,</span>&nbsp;<span class="ident" id="4868016">ops</span>&nbsp;<span class="op" id="4868020">[</span><span class="op" id="4868021">]</span><span class="op" id="4868022">*</span><span class="ident" id="4868023">lex8</span><span class="op" id="4868027">.</span><span class="ident" id="4868028">Token</span><span class="op" id="4868033">)</span>&nbsp;<span class="op" id="4868035">(</span><span class="op" id="4868036">*</span><span class="ident" id="4868037">inst</span><span class="op" id="4868041">,</span>&nbsp;<span class="builtintype" id="4868043">bool</span><span class="op" id="4868047">)</span>&nbsp;<span class="op" id="4868049">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868052">op0</span>&nbsp;<span class="op" id="4868056">:=</span>&nbsp;<span class="ident" id="4868059">ops</span><span class="op" id="4868062">[</span><span class="num" id="4868063">0</span><span class="op" id="4868064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868067">opName</span>&nbsp;<span class="op" id="4868074">:=</span>&nbsp;<span class="ident" id="4868077">op0</span><span class="op" id="4868080">.</span><span class="ident" id="4868081">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868086">args</span>&nbsp;<span class="op" id="4868091">:=</span>&nbsp;<span class="ident" id="4868094">ops</span><span class="op" id="4868097">[</span><span class="num" id="4868098">1</span><span class="op" id="4868099">:</span><span class="op" id="4868100">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868104">var</span>&nbsp;<span class="op" id="4868108">(</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868112">op</span><span class="op" id="4868114">,</span>&nbsp;<span class="ident" id="4868116">d</span><span class="op" id="4868117">,</span>&nbsp;<span class="ident" id="4868119">s</span><span class="op" id="4868120">,</span>&nbsp;<span class="ident" id="4868122">im</span>&nbsp;<span class="builtintype" id="4868125">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868134">pack</span><span class="op" id="4868138">,</span>&nbsp;<span class="ident" id="4868140">sym</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4868147">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868156">fill</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4868169">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868175">symTok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868188">*</span><span class="ident" id="4868189">lex8</span><span class="op" id="4868193">.</span><span class="ident" id="4868194">Token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868201">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868205">argCount</span>&nbsp;<span class="op" id="4868214">:=</span>&nbsp;<span class="keyword" id="4868217">func</span><span class="op" id="4868221">(</span><span class="ident" id="4868222">n</span>&nbsp;<span class="builtintype" id="4868224">int</span><span class="op" id="4868227">)</span>&nbsp;<span class="builtintype" id="4868229">bool</span>&nbsp;<span class="op" id="4868234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868238">if</span>&nbsp;<span class="op" id="4868241">!</span><span class="ident" id="4868242">argCount</span><span class="op" id="4868250">(</span><span class="ident" id="4868251">p</span><span class="op" id="4868252">,</span>&nbsp;<span class="ident" id="4868254">ops</span><span class="op" id="4868257">,</span>&nbsp;<span class="ident" id="4868259">n</span><span class="op" id="4868260">)</span>&nbsp;<span class="op" id="4868262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868267">return</span>&nbsp;<span class="builtintype" id="4868274">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868282">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868286">if</span>&nbsp;<span class="ident" id="4868289">n</span>&nbsp;<span class="op" id="4868291">&gt;=</span>&nbsp;<span class="num" id="4868294">1</span>&nbsp;<span class="op" id="4868296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868301">d</span>&nbsp;<span class="op" id="4868303">=</span>&nbsp;<span class="ident" id="4868305">parseReg</span><span class="op" id="4868313">(</span><span class="ident" id="4868314">p</span><span class="op" id="4868315">,</span>&nbsp;<span class="ident" id="4868317">args</span><span class="op" id="4868321">[</span><span class="num" id="4868322">0</span><span class="op" id="4868323">]</span><span class="op" id="4868324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868332">return</span>&nbsp;<span class="builtintype" id="4868339">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868345">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868349">parseSym</span>&nbsp;<span class="op" id="4868358">:=</span>&nbsp;<span class="keyword" id="4868361">func</span><span class="op" id="4868365">(</span><span class="ident" id="4868366">t</span>&nbsp;<span class="op" id="4868368">*</span><span class="ident" id="4868369">lex8</span><span class="op" id="4868373">.</span><span class="ident" id="4868374">Token</span><span class="op" id="4868379">,</span>&nbsp;<span class="ident" id="4868381">f</span>&nbsp;<span class="keyword" id="4868383">func</span><span class="op" id="4868387">(</span><span class="op" id="4868388">*</span><span class="ident" id="4868389">parser</span><span class="op" id="4868395">,</span>&nbsp;<span class="op" id="4868397">*</span><span class="ident" id="4868398">lex8</span><span class="op" id="4868402">.</span><span class="ident" id="4868403">Token</span><span class="op" id="4868408">)</span>&nbsp;<span class="builtintype" id="4868410">uint32</span><span class="op" id="4868416">)</span>&nbsp;<span class="op" id="4868418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868422">if</span>&nbsp;<span class="ident" id="4868425">isSymbol</span><span class="op" id="4868433">(</span><span class="ident" id="4868434">t</span><span class="op" id="4868435">.</span><span class="ident" id="4868436">Lit</span><span class="op" id="4868439">)</span>&nbsp;<span class="op" id="4868441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868446">pack</span><span class="op" id="4868450">,</span>&nbsp;<span class="ident" id="4868452">sym</span>&nbsp;<span class="op" id="4868456">=</span>&nbsp;<span class="ident" id="4868458">parseSym</span><span class="op" id="4868466">(</span><span class="ident" id="4868467">p</span><span class="op" id="4868468">,</span>&nbsp;<span class="ident" id="4868470">t</span><span class="op" id="4868471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868476">fill</span>&nbsp;<span class="op" id="4868481">=</span>&nbsp;<span class="ident" id="4868483">fillLow</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868494">symTok</span>&nbsp;<span class="op" id="4868501">=</span>&nbsp;<span class="ident" id="4868503">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868507">}</span>&nbsp;<span class="keyword" id="4868509">else</span>&nbsp;<span class="op" id="4868514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868519">im</span>&nbsp;<span class="op" id="4868522">=</span>&nbsp;<span class="ident" id="4868524">f</span><span class="op" id="4868525">(</span><span class="ident" id="4868526">p</span><span class="op" id="4868527">,</span>&nbsp;<span class="ident" id="4868529">t</span><span class="op" id="4868530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868537">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868541">var</span>&nbsp;<span class="ident" id="4868545">found</span>&nbsp;<span class="builtintype" id="4868551">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868557">if</span>&nbsp;<span class="ident" id="4868560">op</span><span class="op" id="4868562">,</span>&nbsp;<span class="ident" id="4868564">found</span>&nbsp;<span class="op" id="4868570">=</span>&nbsp;<span class="ident" id="4868572">opImsMap</span><span class="op" id="4868580">[</span><span class="ident" id="4868581">opName</span><span class="op" id="4868587">]</span><span class="op" id="4868588">;</span>&nbsp;<span class="ident" id="4868590">found</span>&nbsp;<span class="op" id="4868596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4868600">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(signed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868628">if</span>&nbsp;<span class="ident" id="4868631">argCount</span><span class="op" id="4868639">(</span><span class="num" id="4868640">3</span><span class="op" id="4868641">)</span>&nbsp;<span class="op" id="4868643">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868648">s</span>&nbsp;<span class="op" id="4868650">=</span>&nbsp;<span class="ident" id="4868652">parseReg</span><span class="op" id="4868660">(</span><span class="ident" id="4868661">p</span><span class="op" id="4868662">,</span>&nbsp;<span class="ident" id="4868664">args</span><span class="op" id="4868668">[</span><span class="num" id="4868669">1</span><span class="op" id="4868670">]</span><span class="op" id="4868671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868676">parseSym</span><span class="op" id="4868684">(</span><span class="ident" id="4868685">args</span><span class="op" id="4868689">[</span><span class="num" id="4868690">2</span><span class="op" id="4868691">]</span><span class="op" id="4868692">,</span>&nbsp;<span class="ident" id="4868694">parseIms</span><span class="op" id="4868702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868709">}</span>&nbsp;<span class="keyword" id="4868711">else</span>&nbsp;<span class="keyword" id="4868716">if</span>&nbsp;<span class="ident" id="4868719">op</span><span class="op" id="4868721">,</span>&nbsp;<span class="ident" id="4868723">found</span>&nbsp;<span class="op" id="4868729">=</span>&nbsp;<span class="ident" id="4868731">opMemMap</span><span class="op" id="4868739">[</span><span class="ident" id="4868740">opName</span><span class="op" id="4868746">]</span><span class="op" id="4868747">;</span>&nbsp;<span class="ident" id="4868749">found</span>&nbsp;<span class="op" id="4868755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4868759">if</span>&nbsp;<span class="builtinfunc" id="4868762">len</span><span class="op" id="4868765">(</span><span class="ident" id="4868766">args</span><span class="op" id="4868770">)</span>&nbsp;<span class="op" id="4868772">==</span>&nbsp;<span class="num" id="4868775">2</span>&nbsp;<span class="op" id="4868777">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4868782">//&nbsp;mem&nbsp;op&nbsp;can&nbsp;omit&nbsp;the&nbsp;offset&nbsp;if&nbsp;it&nbsp;is&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868826">d</span>&nbsp;<span class="op" id="4868828">=</span>&nbsp;<span class="ident" id="4868830">parseReg</span><span class="op" id="4868838">(</span><span class="ident" id="4868839">p</span><span class="op" id="4868840">,</span>&nbsp;<span class="ident" id="4868842">args</span><span class="op" id="4868846">[</span><span class="num" id="4868847">0</span><span class="op" id="4868848">]</span><span class="op" id="4868849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868854">s</span>&nbsp;<span class="op" id="4868856">=</span>&nbsp;<span class="ident" id="4868858">parseReg</span><span class="op" id="4868866">(</span><span class="ident" id="4868867">p</span><span class="op" id="4868868">,</span>&nbsp;<span class="ident" id="4868870">args</span><span class="op" id="4868874">[</span><span class="num" id="4868875">1</span><span class="op" id="4868876">]</span><span class="op" id="4868877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868881">}</span>&nbsp;<span class="keyword" id="4868883">else</span>&nbsp;<span class="keyword" id="4868888">if</span>&nbsp;<span class="ident" id="4868891">argCount</span><span class="op" id="4868899">(</span><span class="num" id="4868900">3</span><span class="op" id="4868901">)</span>&nbsp;<span class="op" id="4868903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868908">s</span>&nbsp;<span class="op" id="4868910">=</span>&nbsp;<span class="ident" id="4868912">parseReg</span><span class="op" id="4868920">(</span><span class="ident" id="4868921">p</span><span class="op" id="4868922">,</span>&nbsp;<span class="ident" id="4868924">args</span><span class="op" id="4868928">[</span><span class="num" id="4868929">1</span><span class="op" id="4868930">]</span><span class="op" id="4868931">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4868936">parseSym</span><span class="op" id="4868944">(</span><span class="ident" id="4868945">args</span><span class="op" id="4868949">[</span><span class="num" id="4868950">2</span><span class="op" id="4868951">]</span><span class="op" id="4868952">,</span>&nbsp;<span class="ident" id="4868954">parseIms</span><span class="op" id="4868962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4868969">}</span>&nbsp;<span class="keyword" id="4868971">else</span>&nbsp;<span class="keyword" id="4868976">if</span>&nbsp;<span class="ident" id="4868979">op</span><span class="op" id="4868981">,</span>&nbsp;<span class="ident" id="4868983">found</span>&nbsp;<span class="op" id="4868989">=</span>&nbsp;<span class="ident" id="4868991">opImuMap</span><span class="op" id="4868999">[</span><span class="ident" id="4869000">opName</span><span class="op" id="4869006">]</span><span class="op" id="4869007">;</span>&nbsp;<span class="ident" id="4869009">found</span>&nbsp;<span class="op" id="4869015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4869019">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;imm(unsigned)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869049">if</span>&nbsp;<span class="ident" id="4869052">argCount</span><span class="op" id="4869060">(</span><span class="num" id="4869061">3</span><span class="op" id="4869062">)</span>&nbsp;<span class="op" id="4869064">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869069">s</span>&nbsp;<span class="op" id="4869071">=</span>&nbsp;<span class="ident" id="4869073">parseReg</span><span class="op" id="4869081">(</span><span class="ident" id="4869082">p</span><span class="op" id="4869083">,</span>&nbsp;<span class="ident" id="4869085">args</span><span class="op" id="4869089">[</span><span class="num" id="4869090">1</span><span class="op" id="4869091">]</span><span class="op" id="4869092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869097">parseSym</span><span class="op" id="4869105">(</span><span class="ident" id="4869106">args</span><span class="op" id="4869110">[</span><span class="num" id="4869111">2</span><span class="op" id="4869112">]</span><span class="op" id="4869113">,</span>&nbsp;<span class="ident" id="4869115">parseImu</span><span class="op" id="4869123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869130">}</span>&nbsp;<span class="keyword" id="4869132">else</span>&nbsp;<span class="keyword" id="4869137">if</span>&nbsp;<span class="ident" id="4869140">op</span><span class="op" id="4869142">,</span>&nbsp;<span class="ident" id="4869144">found</span>&nbsp;<span class="op" id="4869150">=</span>&nbsp;<span class="ident" id="4869152">opImmMap</span><span class="op" id="4869160">[</span><span class="ident" id="4869161">opName</span><span class="op" id="4869167">]</span><span class="op" id="4869168">;</span>&nbsp;<span class="ident" id="4869170">found</span>&nbsp;<span class="op" id="4869176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4869180">//&nbsp;op&nbsp;reg&nbsp;imm(signed&nbsp;or&nbsp;unsigned)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869216">if</span>&nbsp;<span class="ident" id="4869219">argCount</span><span class="op" id="4869227">(</span><span class="num" id="4869228">2</span><span class="op" id="4869229">)</span>&nbsp;<span class="op" id="4869231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869236">parseSym</span><span class="op" id="4869244">(</span><span class="ident" id="4869245">args</span><span class="op" id="4869249">[</span><span class="num" id="4869250">1</span><span class="op" id="4869251">]</span><span class="op" id="4869252">,</span>&nbsp;<span class="ident" id="4869254">parseImm</span><span class="op" id="4869262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869270">if</span>&nbsp;<span class="ident" id="4869273">opName</span>&nbsp;<span class="op" id="4869280">==</span>&nbsp;<span class="string" id="4869283">&#34;lui&#34;</span>&nbsp;<span class="op" id="4869289">&amp;&amp;</span>&nbsp;<span class="ident" id="4869292">fill</span>&nbsp;<span class="op" id="4869297">==</span>&nbsp;<span class="ident" id="4869300">fillLow</span>&nbsp;<span class="op" id="4869308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869313">fill</span>&nbsp;<span class="op" id="4869318">=</span>&nbsp;<span class="ident" id="4869320">fillHigh</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869334">}</span>&nbsp;<span class="keyword" id="4869336">else</span>&nbsp;<span class="op" id="4869341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869345">return</span>&nbsp;<span class="ident" id="4869352">nil</span><span class="op" id="4869355">,</span>&nbsp;<span class="builtintype" id="4869357">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4869364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869368">ret</span>&nbsp;<span class="op" id="4869372">:=</span>&nbsp;<span class="ident" id="4869375">makeInstImm</span><span class="op" id="4869386">(</span><span class="ident" id="4869387">op</span><span class="op" id="4869389">,</span>&nbsp;<span class="ident" id="4869391">d</span><span class="op" id="4869392">,</span>&nbsp;<span class="ident" id="4869394">s</span><span class="op" id="4869395">,</span>&nbsp;<span class="ident" id="4869397">im</span><span class="op" id="4869399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869402">ret</span><span class="op" id="4869405">.</span><span class="ident" id="4869406">pack</span>&nbsp;<span class="op" id="4869411">=</span>&nbsp;<span class="ident" id="4869413">pack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869419">ret</span><span class="op" id="4869422">.</span><span class="ident" id="4869423">symbol</span>&nbsp;<span class="op" id="4869430">=</span>&nbsp;<span class="ident" id="4869432">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869437">ret</span><span class="op" id="4869440">.</span><span class="ident" id="4869441">fill</span>&nbsp;<span class="op" id="4869446">=</span>&nbsp;<span class="ident" id="4869448">fill</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4869454">ret</span><span class="op" id="4869457">.</span><span class="ident" id="4869458">symTok</span>&nbsp;<span class="op" id="4869465">=</span>&nbsp;<span class="ident" id="4869467">symTok</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4869476">return</span>&nbsp;<span class="ident" id="4869483">ret</span><span class="op" id="4869486">,</span>&nbsp;<span class="builtintype" id="4869488">true</span><br>
<span class="lineno"></span><span class="op" id="4869493">}</span>
</div>
</body>
</html>
