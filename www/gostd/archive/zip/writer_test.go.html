<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7013082">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7013137">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7013191">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7013242">package</span>&nbsp;<span class="ident" id="7013250">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7013255">import</span>&nbsp;<span class="op" id="7013262">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013265">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013274">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013280">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013293">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013306">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013312">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7013322">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7013325">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7013372">type</span>&nbsp;<span class="ident" id="7013377">WriteTest</span>&nbsp;<span class="keyword" id="7013387">struct</span>&nbsp;<span class="op" id="7013394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013397">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7013404">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013412">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7013419">[</span><span class="op" id="7013420">]</span><span class="builtintype" id="7013421">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013427">Method</span>&nbsp;<span class="builtintype" id="7013434">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013442">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7013449">os</span><span class="op" id="7013451">.</span><span class="ident" id="7013452">FileMode</span><br>
<span class="lineno"></span><span class="op" id="7013461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7013464">var</span>&nbsp;<span class="ident" id="7013468">writeTests</span>&nbsp;<span class="op" id="7013479">=</span>&nbsp;<span class="op" id="7013481">[</span><span class="op" id="7013482">]</span><span class="ident" id="7013483">WriteTest</span><span class="op" id="7013492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013499">Name</span><span class="op" id="7013503">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7013507">&#34;foo&#34;</span><span class="op" id="7013512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013516">Data</span><span class="op" id="7013520">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7013524">[</span><span class="op" id="7013525">]</span><span class="builtintype" id="7013526">byte</span><span class="op" id="7013530">(</span><span class="string" id="7013531">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="7013591">)</span><span class="op" id="7013592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013596">Method</span><span class="op" id="7013602">:</span>&nbsp;<span class="ident" id="7013604">Store</span><span class="op" id="7013609">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013613">Mode</span><span class="op" id="7013617">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7013621">0666</span><span class="op" id="7013625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013628">}</span><span class="op" id="7013629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013636">Name</span><span class="op" id="7013640">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7013644">&#34;bar&#34;</span><span class="op" id="7013649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013653">Data</span><span class="op" id="7013657">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7013661">nil</span><span class="op" id="7013664">,</span>&nbsp;<span class="comment" id="7013666">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013698">Method</span><span class="op" id="7013704">:</span>&nbsp;<span class="ident" id="7013706">Deflate</span><span class="op" id="7013713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013717">Mode</span><span class="op" id="7013721">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7013725">0644</span><span class="op" id="7013729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013732">}</span><span class="op" id="7013733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013740">Name</span><span class="op" id="7013744">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7013748">&#34;setuid&#34;</span><span class="op" id="7013756">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013760">Data</span><span class="op" id="7013764">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7013768">[</span><span class="op" id="7013769">]</span><span class="builtintype" id="7013770">byte</span><span class="op" id="7013774">(</span><span class="string" id="7013775">&#34;setuid&nbsp;file&#34;</span><span class="op" id="7013788">)</span><span class="op" id="7013789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013793">Method</span><span class="op" id="7013799">:</span>&nbsp;<span class="ident" id="7013801">Deflate</span><span class="op" id="7013808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013812">Mode</span><span class="op" id="7013816">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7013820">0755</span>&nbsp;<span class="op" id="7013825">|</span>&nbsp;<span class="ident" id="7013827">os</span><span class="op" id="7013829">.</span><span class="ident" id="7013830">ModeSetuid</span><span class="op" id="7013840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013843">}</span><span class="op" id="7013844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013847">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013851">Name</span><span class="op" id="7013855">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7013859">&#34;setgid&#34;</span><span class="op" id="7013867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013871">Data</span><span class="op" id="7013875">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7013879">[</span><span class="op" id="7013880">]</span><span class="builtintype" id="7013881">byte</span><span class="op" id="7013885">(</span><span class="string" id="7013886">&#34;setgid&nbsp;file&#34;</span><span class="op" id="7013899">)</span><span class="op" id="7013900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013904">Method</span><span class="op" id="7013910">:</span>&nbsp;<span class="ident" id="7013912">Deflate</span><span class="op" id="7013919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013923">Mode</span><span class="op" id="7013927">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7013931">0755</span>&nbsp;<span class="op" id="7013936">|</span>&nbsp;<span class="ident" id="7013938">os</span><span class="op" id="7013940">.</span><span class="ident" id="7013941">ModeSetgid</span><span class="op" id="7013951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013954">}</span><span class="op" id="7013955">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013962">Name</span><span class="op" id="7013966">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7013970">&#34;symlink&#34;</span><span class="op" id="7013979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013983">Data</span><span class="op" id="7013987">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7013991">[</span><span class="op" id="7013992">]</span><span class="builtintype" id="7013993">byte</span><span class="op" id="7013997">(</span><span class="string" id="7013998">&#34;../link/target&#34;</span><span class="op" id="7014014">)</span><span class="op" id="7014015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014019">Method</span><span class="op" id="7014025">:</span>&nbsp;<span class="ident" id="7014027">Deflate</span><span class="op" id="7014034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014038">Mode</span><span class="op" id="7014042">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7014046">0755</span>&nbsp;<span class="op" id="7014051">|</span>&nbsp;<span class="ident" id="7014053">os</span><span class="op" id="7014055">.</span><span class="ident" id="7014056">ModeSymlink</span><span class="op" id="7014067">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014070">}</span><span class="op" id="7014071">,</span><br>
<span class="lineno"></span><span class="op" id="7014073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7014076">func</span>&nbsp;<span class="ident" id="7014081">TestWriter</span><span class="op" id="7014091">(</span><span class="ident" id="7014092">t</span>&nbsp;<span class="op" id="7014094">*</span><span class="ident" id="7014095">testing</span><span class="op" id="7014102">.</span><span class="ident" id="7014103">T</span><span class="op" id="7014104">)</span>&nbsp;<span class="op" id="7014106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014109">largeData</span>&nbsp;<span class="op" id="7014119">:=</span>&nbsp;<span class="builtinfunc" id="7014122">make</span><span class="op" id="7014126">(</span><span class="op" id="7014127">[</span><span class="op" id="7014128">]</span><span class="builtintype" id="7014129">byte</span><span class="op" id="7014133">,</span>&nbsp;<span class="num" id="7014135">1</span><span class="op" id="7014136">&lt;&lt;</span><span class="num" id="7014138">17</span><span class="op" id="7014140">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014143">for</span>&nbsp;<span class="ident" id="7014147">i</span>&nbsp;<span class="op" id="7014149">:=</span>&nbsp;<span class="keyword" id="7014152">range</span>&nbsp;<span class="ident" id="7014158">largeData</span>&nbsp;<span class="op" id="7014168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014172">largeData</span><span class="op" id="7014181">[</span><span class="ident" id="7014182">i</span><span class="op" id="7014183">]</span>&nbsp;<span class="op" id="7014185">=</span>&nbsp;<span class="builtintype" id="7014187">byte</span><span class="op" id="7014191">(</span><span class="ident" id="7014192">rand</span><span class="op" id="7014196">.</span><span class="ident" id="7014197">Int</span><span class="op" id="7014200">(</span><span class="op" id="7014201">)</span><span class="op" id="7014202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014208">writeTests</span><span class="op" id="7014218">[</span><span class="num" id="7014219">1</span><span class="op" id="7014220">]</span><span class="op" id="7014221">.</span><span class="ident" id="7014222">Data</span>&nbsp;<span class="op" id="7014227">=</span>&nbsp;<span class="ident" id="7014229">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014240">defer</span>&nbsp;<span class="keyword" id="7014246">func</span><span class="op" id="7014250">(</span><span class="op" id="7014251">)</span>&nbsp;<span class="op" id="7014253">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014257">writeTests</span><span class="op" id="7014267">[</span><span class="num" id="7014268">1</span><span class="op" id="7014269">]</span><span class="op" id="7014270">.</span><span class="ident" id="7014271">Data</span>&nbsp;<span class="op" id="7014276">=</span>&nbsp;<span class="ident" id="7014278">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014283">}</span><span class="op" id="7014284">(</span><span class="op" id="7014285">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7014289">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014310">buf</span>&nbsp;<span class="op" id="7014314">:=</span>&nbsp;<span class="builtinfunc" id="7014317">new</span><span class="op" id="7014320">(</span><span class="ident" id="7014321">bytes</span><span class="op" id="7014326">.</span><span class="ident" id="7014327">Buffer</span><span class="op" id="7014333">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014336">w</span>&nbsp;<span class="op" id="7014338">:=</span>&nbsp;<span class="ident" id="7014341">NewWriter</span><span class="op" id="7014350">(</span><span class="ident" id="7014351">buf</span><span class="op" id="7014354">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014358">for</span>&nbsp;<span class="ident" id="7014362">_</span><span class="op" id="7014363">,</span>&nbsp;<span class="ident" id="7014365">wt</span>&nbsp;<span class="op" id="7014368">:=</span>&nbsp;<span class="keyword" id="7014371">range</span>&nbsp;<span class="ident" id="7014377">writeTests</span>&nbsp;<span class="op" id="7014388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014392">testCreate</span><span class="op" id="7014402">(</span><span class="ident" id="7014403">t</span><span class="op" id="7014404">,</span>&nbsp;<span class="ident" id="7014406">w</span><span class="op" id="7014407">,</span>&nbsp;<span class="op" id="7014409">&amp;</span><span class="ident" id="7014410">wt</span><span class="op" id="7014412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014415">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014419">if</span>&nbsp;<span class="ident" id="7014422">err</span>&nbsp;<span class="op" id="7014426">:=</span>&nbsp;<span class="ident" id="7014429">w</span><span class="op" id="7014430">.</span><span class="ident" id="7014431">Close</span><span class="op" id="7014436">(</span><span class="op" id="7014437">)</span><span class="op" id="7014438">;</span>&nbsp;<span class="ident" id="7014440">err</span>&nbsp;<span class="op" id="7014444">!=</span>&nbsp;<span class="ident" id="7014447">nil</span>&nbsp;<span class="op" id="7014451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014455">t</span><span class="op" id="7014456">.</span><span class="ident" id="7014457">Fatal</span><span class="op" id="7014462">(</span><span class="ident" id="7014463">err</span><span class="op" id="7014466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7014473">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014490">r</span><span class="op" id="7014491">,</span>&nbsp;<span class="ident" id="7014493">err</span>&nbsp;<span class="op" id="7014497">:=</span>&nbsp;<span class="ident" id="7014500">NewReader</span><span class="op" id="7014509">(</span><span class="ident" id="7014510">bytes</span><span class="op" id="7014515">.</span><span class="ident" id="7014516">NewReader</span><span class="op" id="7014525">(</span><span class="ident" id="7014526">buf</span><span class="op" id="7014529">.</span><span class="ident" id="7014530">Bytes</span><span class="op" id="7014535">(</span><span class="op" id="7014536">)</span><span class="op" id="7014537">)</span><span class="op" id="7014538">,</span>&nbsp;<span class="ident" id="7014540">int64</span><span class="op" id="7014545">(</span><span class="ident" id="7014546">buf</span><span class="op" id="7014549">.</span><span class="ident" id="7014550">Len</span><span class="op" id="7014553">(</span><span class="op" id="7014554">)</span><span class="op" id="7014555">)</span><span class="op" id="7014556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014559">if</span>&nbsp;<span class="ident" id="7014562">err</span>&nbsp;<span class="op" id="7014566">!=</span>&nbsp;<span class="ident" id="7014569">nil</span>&nbsp;<span class="op" id="7014573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014577">t</span><span class="op" id="7014578">.</span><span class="ident" id="7014579">Fatal</span><span class="op" id="7014584">(</span><span class="ident" id="7014585">err</span><span class="op" id="7014588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014591">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014594">for</span>&nbsp;<span class="ident" id="7014598">i</span><span class="op" id="7014599">,</span>&nbsp;<span class="ident" id="7014601">wt</span>&nbsp;<span class="op" id="7014604">:=</span>&nbsp;<span class="keyword" id="7014607">range</span>&nbsp;<span class="ident" id="7014613">writeTests</span>&nbsp;<span class="op" id="7014624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014628">testReadFile</span><span class="op" id="7014640">(</span><span class="ident" id="7014641">t</span><span class="op" id="7014642">,</span>&nbsp;<span class="ident" id="7014644">r</span><span class="op" id="7014645">.</span><span class="ident" id="7014646">File</span><span class="op" id="7014650">[</span><span class="ident" id="7014651">i</span><span class="op" id="7014652">]</span><span class="op" id="7014653">,</span>&nbsp;<span class="op" id="7014655">&amp;</span><span class="ident" id="7014656">wt</span><span class="op" id="7014658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014661">}</span><br>
<span class="lineno"></span><span class="op" id="7014663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7014666">func</span>&nbsp;<span class="ident" id="7014671">TestWriterFlush</span><span class="op" id="7014686">(</span><span class="ident" id="7014687">t</span>&nbsp;<span class="op" id="7014689">*</span><span class="ident" id="7014690">testing</span><span class="op" id="7014697">.</span><span class="ident" id="7014698">T</span><span class="op" id="7014699">)</span>&nbsp;<span class="op" id="7014701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014704">var</span>&nbsp;<span class="ident" id="7014708">buf</span>&nbsp;<span class="ident" id="7014712">bytes</span><span class="op" id="7014717">.</span><span class="ident" id="7014718">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014726">w</span>&nbsp;<span class="op" id="7014728">:=</span>&nbsp;<span class="ident" id="7014731">NewWriter</span><span class="op" id="7014740">(</span><span class="keyword" id="7014741">struct</span><span class="op" id="7014747">{</span>&nbsp;<span class="ident" id="7014749">io</span><span class="op" id="7014751">.</span><span class="ident" id="7014752">Writer</span>&nbsp;<span class="op" id="7014759">}</span><span class="op" id="7014760">{</span><span class="op" id="7014761">&amp;</span><span class="ident" id="7014762">buf</span><span class="op" id="7014765">}</span><span class="op" id="7014766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014769">_</span><span class="op" id="7014770">,</span>&nbsp;<span class="ident" id="7014772">err</span>&nbsp;<span class="op" id="7014776">:=</span>&nbsp;<span class="ident" id="7014779">w</span><span class="op" id="7014780">.</span><span class="ident" id="7014781">Create</span><span class="op" id="7014787">(</span><span class="string" id="7014788">&#34;foo&#34;</span><span class="op" id="7014793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014796">if</span>&nbsp;<span class="ident" id="7014799">err</span>&nbsp;<span class="op" id="7014803">!=</span>&nbsp;<span class="ident" id="7014806">nil</span>&nbsp;<span class="op" id="7014810">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014814">t</span><span class="op" id="7014815">.</span><span class="ident" id="7014816">Fatal</span><span class="op" id="7014821">(</span><span class="ident" id="7014822">err</span><span class="op" id="7014825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014831">if</span>&nbsp;<span class="ident" id="7014834">buf</span><span class="op" id="7014837">.</span><span class="ident" id="7014838">Len</span><span class="op" id="7014841">(</span><span class="op" id="7014842">)</span>&nbsp;<span class="op" id="7014844">&gt;</span>&nbsp;<span class="num" id="7014846">0</span>&nbsp;<span class="op" id="7014848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014852">t</span><span class="op" id="7014853">.</span><span class="ident" id="7014854">Fatalf</span><span class="op" id="7014860">(</span><span class="string" id="7014861">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="7014900">,</span>&nbsp;<span class="ident" id="7014902">buf</span><span class="op" id="7014905">.</span><span class="ident" id="7014906">Len</span><span class="op" id="7014909">(</span><span class="op" id="7014910">)</span><span class="op" id="7014911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014914">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014917">if</span>&nbsp;<span class="ident" id="7014920">err</span>&nbsp;<span class="op" id="7014924">:=</span>&nbsp;<span class="ident" id="7014927">w</span><span class="op" id="7014928">.</span><span class="ident" id="7014929">Flush</span><span class="op" id="7014934">(</span><span class="op" id="7014935">)</span><span class="op" id="7014936">;</span>&nbsp;<span class="ident" id="7014938">err</span>&nbsp;<span class="op" id="7014942">!=</span>&nbsp;<span class="ident" id="7014945">nil</span>&nbsp;<span class="op" id="7014949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014953">t</span><span class="op" id="7014954">.</span><span class="ident" id="7014955">Fatal</span><span class="op" id="7014960">(</span><span class="ident" id="7014961">err</span><span class="op" id="7014964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014970">if</span>&nbsp;<span class="ident" id="7014973">buf</span><span class="op" id="7014976">.</span><span class="ident" id="7014977">Len</span><span class="op" id="7014980">(</span><span class="op" id="7014981">)</span>&nbsp;<span class="op" id="7014983">==</span>&nbsp;<span class="num" id="7014986">0</span>&nbsp;<span class="op" id="7014988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014992">t</span><span class="op" id="7014993">.</span><span class="ident" id="7014994">Fatal</span><span class="op" id="7014999">(</span><span class="string" id="7015000">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="7015030">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015033">}</span><br>
<span class="lineno"></span><span class="op" id="7015035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7015038">func</span>&nbsp;<span class="ident" id="7015043">testCreate</span><span class="op" id="7015053">(</span><span class="ident" id="7015054">t</span>&nbsp;<span class="op" id="7015056">*</span><span class="ident" id="7015057">testing</span><span class="op" id="7015064">.</span><span class="ident" id="7015065">T</span><span class="op" id="7015066">,</span>&nbsp;<span class="ident" id="7015068">w</span>&nbsp;<span class="op" id="7015070">*</span><span class="ident" id="7015071">Writer</span><span class="op" id="7015077">,</span>&nbsp;<span class="ident" id="7015079">wt</span>&nbsp;<span class="op" id="7015082">*</span><span class="ident" id="7015083">WriteTest</span><span class="op" id="7015092">)</span>&nbsp;<span class="op" id="7015094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015097">header</span>&nbsp;<span class="op" id="7015104">:=</span>&nbsp;<span class="op" id="7015107">&amp;</span><span class="ident" id="7015108">FileHeader</span><span class="op" id="7015118">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015122">Name</span><span class="op" id="7015126">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7015130">wt</span><span class="op" id="7015132">.</span><span class="ident" id="7015133">Name</span><span class="op" id="7015137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015141">Method</span><span class="op" id="7015147">:</span>&nbsp;<span class="ident" id="7015149">wt</span><span class="op" id="7015151">.</span><span class="ident" id="7015152">Method</span><span class="op" id="7015158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015164">if</span>&nbsp;<span class="ident" id="7015167">wt</span><span class="op" id="7015169">.</span><span class="ident" id="7015170">Mode</span>&nbsp;<span class="op" id="7015175">!=</span>&nbsp;<span class="num" id="7015178">0</span>&nbsp;<span class="op" id="7015180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015184">header</span><span class="op" id="7015190">.</span><span class="ident" id="7015191">SetMode</span><span class="op" id="7015198">(</span><span class="ident" id="7015199">wt</span><span class="op" id="7015201">.</span><span class="ident" id="7015202">Mode</span><span class="op" id="7015206">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015212">f</span><span class="op" id="7015213">,</span>&nbsp;<span class="ident" id="7015215">err</span>&nbsp;<span class="op" id="7015219">:=</span>&nbsp;<span class="ident" id="7015222">w</span><span class="op" id="7015223">.</span><span class="ident" id="7015224">CreateHeader</span><span class="op" id="7015236">(</span><span class="ident" id="7015237">header</span><span class="op" id="7015243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015246">if</span>&nbsp;<span class="ident" id="7015249">err</span>&nbsp;<span class="op" id="7015253">!=</span>&nbsp;<span class="ident" id="7015256">nil</span>&nbsp;<span class="op" id="7015260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015264">t</span><span class="op" id="7015265">.</span><span class="ident" id="7015266">Fatal</span><span class="op" id="7015271">(</span><span class="ident" id="7015272">err</span><span class="op" id="7015275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015278">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015281">_</span><span class="op" id="7015282">,</span>&nbsp;<span class="ident" id="7015284">err</span>&nbsp;<span class="op" id="7015288">=</span>&nbsp;<span class="ident" id="7015290">f</span><span class="op" id="7015291">.</span><span class="ident" id="7015292">Write</span><span class="op" id="7015297">(</span><span class="ident" id="7015298">wt</span><span class="op" id="7015300">.</span><span class="ident" id="7015301">Data</span><span class="op" id="7015305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015308">if</span>&nbsp;<span class="ident" id="7015311">err</span>&nbsp;<span class="op" id="7015315">!=</span>&nbsp;<span class="ident" id="7015318">nil</span>&nbsp;<span class="op" id="7015322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015326">t</span><span class="op" id="7015327">.</span><span class="ident" id="7015328">Fatal</span><span class="op" id="7015333">(</span><span class="ident" id="7015334">err</span><span class="op" id="7015337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015340">}</span><br>
<span class="lineno"></span><span class="op" id="7015342">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7015345">func</span>&nbsp;<span class="ident" id="7015350">testReadFile</span><span class="op" id="7015362">(</span><span class="ident" id="7015363">t</span>&nbsp;<span class="op" id="7015365">*</span><span class="ident" id="7015366">testing</span><span class="op" id="7015373">.</span><span class="ident" id="7015374">T</span><span class="op" id="7015375">,</span>&nbsp;<span class="ident" id="7015377">f</span>&nbsp;<span class="op" id="7015379">*</span><span class="ident" id="7015380">File</span><span class="op" id="7015384">,</span>&nbsp;<span class="ident" id="7015386">wt</span>&nbsp;<span class="op" id="7015389">*</span><span class="ident" id="7015390">WriteTest</span><span class="op" id="7015399">)</span>&nbsp;<span class="op" id="7015401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015404">if</span>&nbsp;<span class="ident" id="7015407">f</span><span class="op" id="7015408">.</span><span class="ident" id="7015409">Name</span>&nbsp;<span class="op" id="7015414">!=</span>&nbsp;<span class="ident" id="7015417">wt</span><span class="op" id="7015419">.</span><span class="ident" id="7015420">Name</span>&nbsp;<span class="op" id="7015425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015429">t</span><span class="op" id="7015430">.</span><span class="ident" id="7015431">Fatalf</span><span class="op" id="7015437">(</span><span class="string" id="7015438">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7015466">,</span>&nbsp;<span class="ident" id="7015468">f</span><span class="op" id="7015469">.</span><span class="ident" id="7015470">Name</span><span class="op" id="7015474">,</span>&nbsp;<span class="ident" id="7015476">wt</span><span class="op" id="7015478">.</span><span class="ident" id="7015479">Name</span><span class="op" id="7015483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015486">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015489">testFileMode</span><span class="op" id="7015501">(</span><span class="ident" id="7015502">t</span><span class="op" id="7015503">,</span>&nbsp;<span class="ident" id="7015505">wt</span><span class="op" id="7015507">.</span><span class="ident" id="7015508">Name</span><span class="op" id="7015512">,</span>&nbsp;<span class="ident" id="7015514">f</span><span class="op" id="7015515">,</span>&nbsp;<span class="ident" id="7015517">wt</span><span class="op" id="7015519">.</span><span class="ident" id="7015520">Mode</span><span class="op" id="7015524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015527">rc</span><span class="op" id="7015529">,</span>&nbsp;<span class="ident" id="7015531">err</span>&nbsp;<span class="op" id="7015535">:=</span>&nbsp;<span class="ident" id="7015538">f</span><span class="op" id="7015539">.</span><span class="ident" id="7015540">Open</span><span class="op" id="7015544">(</span><span class="op" id="7015545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015548">if</span>&nbsp;<span class="ident" id="7015551">err</span>&nbsp;<span class="op" id="7015555">!=</span>&nbsp;<span class="ident" id="7015558">nil</span>&nbsp;<span class="op" id="7015562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015566">t</span><span class="op" id="7015567">.</span><span class="ident" id="7015568">Fatal</span><span class="op" id="7015573">(</span><span class="string" id="7015574">&#34;opening:&#34;</span><span class="op" id="7015584">,</span>&nbsp;<span class="ident" id="7015586">err</span><span class="op" id="7015589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015592">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015595">b</span><span class="op" id="7015596">,</span>&nbsp;<span class="ident" id="7015598">err</span>&nbsp;<span class="op" id="7015602">:=</span>&nbsp;<span class="ident" id="7015605">ioutil</span><span class="op" id="7015611">.</span><span class="ident" id="7015612">ReadAll</span><span class="op" id="7015619">(</span><span class="ident" id="7015620">rc</span><span class="op" id="7015622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015625">if</span>&nbsp;<span class="ident" id="7015628">err</span>&nbsp;<span class="op" id="7015632">!=</span>&nbsp;<span class="ident" id="7015635">nil</span>&nbsp;<span class="op" id="7015639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015643">t</span><span class="op" id="7015644">.</span><span class="ident" id="7015645">Fatal</span><span class="op" id="7015650">(</span><span class="string" id="7015651">&#34;reading:&#34;</span><span class="op" id="7015661">,</span>&nbsp;<span class="ident" id="7015663">err</span><span class="op" id="7015666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015672">err</span>&nbsp;<span class="op" id="7015676">=</span>&nbsp;<span class="ident" id="7015678">rc</span><span class="op" id="7015680">.</span><span class="ident" id="7015681">Close</span><span class="op" id="7015686">(</span><span class="op" id="7015687">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015690">if</span>&nbsp;<span class="ident" id="7015693">err</span>&nbsp;<span class="op" id="7015697">!=</span>&nbsp;<span class="ident" id="7015700">nil</span>&nbsp;<span class="op" id="7015704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015708">t</span><span class="op" id="7015709">.</span><span class="ident" id="7015710">Fatal</span><span class="op" id="7015715">(</span><span class="string" id="7015716">&#34;closing:&#34;</span><span class="op" id="7015726">,</span>&nbsp;<span class="ident" id="7015728">err</span><span class="op" id="7015731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015737">if</span>&nbsp;<span class="op" id="7015740">!</span><span class="ident" id="7015741">bytes</span><span class="op" id="7015746">.</span><span class="ident" id="7015747">Equal</span><span class="op" id="7015752">(</span><span class="ident" id="7015753">b</span><span class="op" id="7015754">,</span>&nbsp;<span class="ident" id="7015756">wt</span><span class="op" id="7015758">.</span><span class="ident" id="7015759">Data</span><span class="op" id="7015763">)</span>&nbsp;<span class="op" id="7015765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015769">t</span><span class="op" id="7015770">.</span><span class="ident" id="7015771">Errorf</span><span class="op" id="7015777">(</span><span class="string" id="7015778">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7015805">,</span>&nbsp;<span class="ident" id="7015807">b</span><span class="op" id="7015808">,</span>&nbsp;<span class="ident" id="7015810">wt</span><span class="op" id="7015812">.</span><span class="ident" id="7015813">Data</span><span class="op" id="7015817">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015820">}</span><br>
<span class="lineno"></span><span class="op" id="7015822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7015825">func</span>&nbsp;<span class="ident" id="7015830">BenchmarkCompressedZipGarbage</span><span class="op" id="7015859">(</span><span class="ident" id="7015860">b</span>&nbsp;<span class="op" id="7015862">*</span><span class="ident" id="7015863">testing</span><span class="op" id="7015870">.</span><span class="ident" id="7015871">B</span><span class="op" id="7015872">)</span>&nbsp;<span class="op" id="7015874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015877">b</span><span class="op" id="7015878">.</span><span class="ident" id="7015879">ReportAllocs</span><span class="op" id="7015891">(</span><span class="op" id="7015892">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015895">var</span>&nbsp;<span class="ident" id="7015899">buf</span>&nbsp;<span class="ident" id="7015903">bytes</span><span class="op" id="7015908">.</span><span class="ident" id="7015909">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015917">bigBuf</span>&nbsp;<span class="op" id="7015924">:=</span>&nbsp;<span class="ident" id="7015927">bytes</span><span class="op" id="7015932">.</span><span class="ident" id="7015933">Repeat</span><span class="op" id="7015939">(</span><span class="op" id="7015940">[</span><span class="op" id="7015941">]</span><span class="builtintype" id="7015942">byte</span><span class="op" id="7015946">(</span><span class="string" id="7015947">&#34;a&#34;</span><span class="op" id="7015950">)</span><span class="op" id="7015951">,</span>&nbsp;<span class="num" id="7015953">1</span><span class="op" id="7015954">&lt;&lt;</span><span class="num" id="7015956">20</span><span class="op" id="7015958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015961">for</span>&nbsp;<span class="ident" id="7015965">i</span>&nbsp;<span class="op" id="7015967">:=</span>&nbsp;<span class="num" id="7015970">0</span><span class="op" id="7015971">;</span>&nbsp;<span class="ident" id="7015973">i</span>&nbsp;<span class="op" id="7015975">&lt;</span>&nbsp;<span class="ident" id="7015977">b</span><span class="op" id="7015978">.</span><span class="ident" id="7015979">N</span><span class="op" id="7015980">;</span>&nbsp;<span class="ident" id="7015982">i</span><span class="op" id="7015983">++</span>&nbsp;<span class="op" id="7015986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015990">buf</span><span class="op" id="7015993">.</span><span class="ident" id="7015994">Reset</span><span class="op" id="7015999">(</span><span class="op" id="7016000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016004">zw</span>&nbsp;<span class="op" id="7016007">:=</span>&nbsp;<span class="ident" id="7016010">NewWriter</span><span class="op" id="7016019">(</span><span class="op" id="7016020">&amp;</span><span class="ident" id="7016021">buf</span><span class="op" id="7016024">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016028">for</span>&nbsp;<span class="ident" id="7016032">j</span>&nbsp;<span class="op" id="7016034">:=</span>&nbsp;<span class="num" id="7016037">0</span><span class="op" id="7016038">;</span>&nbsp;<span class="ident" id="7016040">j</span>&nbsp;<span class="op" id="7016042">&lt;</span>&nbsp;<span class="num" id="7016044">3</span><span class="op" id="7016045">;</span>&nbsp;<span class="ident" id="7016047">j</span><span class="op" id="7016048">++</span>&nbsp;<span class="op" id="7016051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016056">w</span><span class="op" id="7016057">,</span>&nbsp;<span class="ident" id="7016059">_</span>&nbsp;<span class="op" id="7016061">:=</span>&nbsp;<span class="ident" id="7016064">zw</span><span class="op" id="7016066">.</span><span class="ident" id="7016067">CreateHeader</span><span class="op" id="7016079">(</span><span class="op" id="7016080">&amp;</span><span class="ident" id="7016081">FileHeader</span><span class="op" id="7016091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016097">Name</span><span class="op" id="7016101">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7016105">&#34;foo&#34;</span><span class="op" id="7016110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016116">Method</span><span class="op" id="7016122">:</span>&nbsp;<span class="ident" id="7016124">Deflate</span><span class="op" id="7016131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016136">}</span><span class="op" id="7016137">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016142">w</span><span class="op" id="7016143">.</span><span class="ident" id="7016144">Write</span><span class="op" id="7016149">(</span><span class="ident" id="7016150">bigBuf</span><span class="op" id="7016156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016164">zw</span><span class="op" id="7016166">.</span><span class="ident" id="7016167">Close</span><span class="op" id="7016172">(</span><span class="op" id="7016173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016176">}</span><br>
<span class="lineno"></span><span class="op" id="7016178">}</span>
</div>
</body>
</html>
