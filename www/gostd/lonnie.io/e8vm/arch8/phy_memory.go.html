<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5069956">package</span>&nbsp;<span class="ident" id="5069964">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5069971">//&nbsp;PhyMemory&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;contiguous&nbsp;pages.</span><br>
<span class="lineno"></span><span class="keyword" id="5070021">type</span>&nbsp;<span class="ident" id="5070026">phyMemory</span>&nbsp;<span class="keyword" id="5070036">struct</span>&nbsp;<span class="op" id="5070043">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070046">npage</span>&nbsp;<span class="builtintype" id="5070052">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070060">pages</span>&nbsp;<span class="keyword" id="5070066">map</span><span class="op" id="5070069">[</span><span class="builtintype" id="5070070">uint32</span><span class="op" id="5070076">]</span><span class="op" id="5070077">*</span><span class="ident" id="5070078">page</span><br>
<span class="lineno"></span><span class="op" id="5070083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5070086">const</span>&nbsp;<span class="op" id="5070092">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070095">pageVoid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5070109">=</span>&nbsp;<span class="num" id="5070111">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070114">pageInterrupt</span>&nbsp;<span class="op" id="5070128">=</span>&nbsp;<span class="num" id="5070130">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070133">pageBasicIO</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5070147">=</span>&nbsp;<span class="num" id="5070149">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070153">pageBootImage</span>&nbsp;<span class="op" id="5070167">=</span>&nbsp;<span class="num" id="5070169">8</span><br>
<span class="lineno">15</span><span class="op" id="5070171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5070174">//&nbsp;NewPhyMemory&nbsp;creates&nbsp;a&nbsp;physical&nbsp;memory&nbsp;of&nbsp;size&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5070231">func</span>&nbsp;<span class="ident" id="5070236">newPhyMemory</span><span class="op" id="5070248">(</span><span class="ident" id="5070249">size</span>&nbsp;<span class="builtintype" id="5070254">uint32</span><span class="op" id="5070260">)</span>&nbsp;<span class="op" id="5070262">*</span><span class="ident" id="5070263">phyMemory</span>&nbsp;<span class="op" id="5070273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070276">if</span>&nbsp;<span class="ident" id="5070279">size</span><span class="op" id="5070283">%</span><span class="ident" id="5070284">PageSize</span>&nbsp;<span class="op" id="5070293">!=</span>&nbsp;<span class="num" id="5070296">0</span>&nbsp;<span class="op" id="5070298">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5070302">panic</span><span class="op" id="5070307">(</span><span class="string" id="5070308">&#34;size&nbsp;misaligned&#34;</span><span class="op" id="5070325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5070328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070332">ret</span>&nbsp;<span class="op" id="5070336">:=</span>&nbsp;<span class="builtinfunc" id="5070339">new</span><span class="op" id="5070342">(</span><span class="ident" id="5070343">phyMemory</span><span class="op" id="5070352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070355">ret</span><span class="op" id="5070358">.</span><span class="ident" id="5070359">pages</span>&nbsp;<span class="op" id="5070365">=</span>&nbsp;<span class="builtinfunc" id="5070367">make</span><span class="op" id="5070371">(</span><span class="keyword" id="5070372">map</span><span class="op" id="5070375">[</span><span class="builtintype" id="5070376">uint32</span><span class="op" id="5070382">]</span><span class="op" id="5070383">*</span><span class="ident" id="5070384">page</span><span class="op" id="5070388">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070391">ret</span><span class="op" id="5070394">.</span><span class="ident" id="5070395">npage</span>&nbsp;<span class="op" id="5070401">=</span>&nbsp;<span class="ident" id="5070403">size</span>&nbsp;<span class="op" id="5070408">/</span>&nbsp;<span class="ident" id="5070410">PageSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070421">return</span>&nbsp;<span class="ident" id="5070428">ret</span><br>
<span class="lineno"></span><span class="op" id="5070432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="5070435">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="keyword" id="5070484">func</span>&nbsp;<span class="op" id="5070489">(</span><span class="ident" id="5070490">pm</span>&nbsp;<span class="op" id="5070493">*</span><span class="ident" id="5070494">phyMemory</span><span class="op" id="5070503">)</span>&nbsp;<span class="ident" id="5070505">Size</span><span class="op" id="5070509">(</span><span class="op" id="5070510">)</span>&nbsp;<span class="builtintype" id="5070512">uint32</span>&nbsp;<span class="op" id="5070519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070522">return</span>&nbsp;<span class="ident" id="5070529">pm</span><span class="op" id="5070531">.</span><span class="ident" id="5070532">npage</span>&nbsp;<span class="op" id="5070538">*</span>&nbsp;<span class="ident" id="5070540">PageSize</span><br>
<span class="lineno"></span><span class="op" id="5070549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5070552">//&nbsp;Page&nbsp;returns&nbsp;the&nbsp;page&nbsp;for&nbsp;the&nbsp;particular&nbsp;page&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5070608">//&nbsp;Returns&nbsp;nil&nbsp;when&nbsp;the&nbsp;page&nbsp;number&nbsp;is&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span><span class="keyword" id="5070660">func</span>&nbsp;<span class="op" id="5070665">(</span><span class="ident" id="5070666">pm</span>&nbsp;<span class="op" id="5070669">*</span><span class="ident" id="5070670">phyMemory</span><span class="op" id="5070679">)</span>&nbsp;<span class="ident" id="5070681">Page</span><span class="op" id="5070685">(</span><span class="ident" id="5070686">pn</span>&nbsp;<span class="builtintype" id="5070689">uint32</span><span class="op" id="5070695">)</span>&nbsp;<span class="op" id="5070697">*</span><span class="ident" id="5070698">page</span>&nbsp;<span class="op" id="5070703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070706">if</span>&nbsp;<span class="ident" id="5070709">pn</span>&nbsp;<span class="op" id="5070712">&gt;=</span>&nbsp;<span class="ident" id="5070715">pm</span><span class="op" id="5070717">.</span><span class="ident" id="5070718">npage</span>&nbsp;<span class="op" id="5070724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070728">return</span>&nbsp;<span class="ident" id="5070735">nil</span>&nbsp;<span class="comment" id="5070739">//&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5070756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070760">ret</span><span class="op" id="5070763">,</span>&nbsp;<span class="ident" id="5070765">found</span>&nbsp;<span class="op" id="5070771">:=</span>&nbsp;<span class="ident" id="5070774">pm</span><span class="op" id="5070776">.</span><span class="ident" id="5070777">pages</span><span class="op" id="5070782">[</span><span class="ident" id="5070783">pn</span><span class="op" id="5070785">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070788">if</span>&nbsp;<span class="op" id="5070791">!</span><span class="ident" id="5070792">found</span>&nbsp;<span class="op" id="5070798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5070802">//&nbsp;create&nbsp;an&nbsp;empty&nbsp;page&nbsp;on&nbsp;demand</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070838">ret</span>&nbsp;<span class="op" id="5070842">=</span>&nbsp;<span class="ident" id="5070844">newPage</span><span class="op" id="5070851">(</span><span class="op" id="5070852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070856">pm</span><span class="op" id="5070858">.</span><span class="ident" id="5070859">pages</span><span class="op" id="5070864">[</span><span class="ident" id="5070865">pn</span><span class="op" id="5070867">]</span>&nbsp;<span class="op" id="5070869">=</span>&nbsp;<span class="ident" id="5070871">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5070876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070880">return</span>&nbsp;<span class="ident" id="5070887">ret</span><br>
<span class="lineno">50</span><span class="op" id="5070891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5070894">func</span>&nbsp;<span class="op" id="5070899">(</span><span class="ident" id="5070900">pm</span>&nbsp;<span class="op" id="5070903">*</span><span class="ident" id="5070904">phyMemory</span><span class="op" id="5070913">)</span>&nbsp;<span class="ident" id="5070915">pageForByte</span><span class="op" id="5070926">(</span><span class="ident" id="5070927">addr</span>&nbsp;<span class="builtintype" id="5070932">uint32</span><span class="op" id="5070938">)</span>&nbsp;<span class="op" id="5070940">(</span><span class="op" id="5070941">*</span><span class="ident" id="5070942">page</span><span class="op" id="5070946">,</span>&nbsp;<span class="op" id="5070948">*</span><span class="ident" id="5070949">Excep</span><span class="op" id="5070954">)</span>&nbsp;<span class="op" id="5070956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5070959">p</span>&nbsp;<span class="op" id="5070961">:=</span>&nbsp;<span class="ident" id="5070964">pm</span><span class="op" id="5070966">.</span><span class="ident" id="5070967">Page</span><span class="op" id="5070971">(</span><span class="ident" id="5070972">addr</span>&nbsp;<span class="op" id="5070977">/</span>&nbsp;<span class="ident" id="5070979">PageSize</span><span class="op" id="5070987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5070990">if</span>&nbsp;<span class="ident" id="5070993">p</span>&nbsp;<span class="op" id="5070995">==</span>&nbsp;<span class="ident" id="5070998">nil</span>&nbsp;<span class="op" id="5071002">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071006">return</span>&nbsp;<span class="ident" id="5071013">nil</span><span class="op" id="5071016">,</span>&nbsp;<span class="ident" id="5071018">errOutOfRange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5071033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071036">return</span>&nbsp;<span class="ident" id="5071043">p</span><span class="op" id="5071044">,</span>&nbsp;<span class="ident" id="5071046">nil</span><br>
<span class="lineno"></span><span class="op" id="5071050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="5071053">func</span>&nbsp;<span class="op" id="5071058">(</span><span class="ident" id="5071059">pm</span>&nbsp;<span class="op" id="5071062">*</span><span class="ident" id="5071063">phyMemory</span><span class="op" id="5071072">)</span>&nbsp;<span class="ident" id="5071074">pageForWord</span><span class="op" id="5071085">(</span><span class="ident" id="5071086">addr</span>&nbsp;<span class="builtintype" id="5071091">uint32</span><span class="op" id="5071097">)</span>&nbsp;<span class="op" id="5071099">(</span><span class="op" id="5071100">*</span><span class="ident" id="5071101">page</span><span class="op" id="5071105">,</span>&nbsp;<span class="op" id="5071107">*</span><span class="ident" id="5071108">Excep</span><span class="op" id="5071113">)</span>&nbsp;<span class="op" id="5071115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071118">if</span>&nbsp;<span class="ident" id="5071121">addr</span><span class="op" id="5071125">%</span><span class="num" id="5071126">4</span>&nbsp;<span class="op" id="5071128">!=</span>&nbsp;<span class="num" id="5071131">0</span>&nbsp;<span class="op" id="5071133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071137">return</span>&nbsp;<span class="ident" id="5071144">nil</span><span class="op" id="5071147">,</span>&nbsp;<span class="ident" id="5071149">errMisalign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5071162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071165">return</span>&nbsp;<span class="ident" id="5071172">pm</span><span class="op" id="5071174">.</span><span class="ident" id="5071175">pageForByte</span><span class="op" id="5071186">(</span><span class="ident" id="5071187">addr</span><span class="op" id="5071191">)</span><br>
<span class="lineno">65</span><span class="op" id="5071193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5071196">//&nbsp;ReadByte&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5071245">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5071301">func</span>&nbsp;<span class="op" id="5071306">(</span><span class="ident" id="5071307">pm</span>&nbsp;<span class="op" id="5071310">*</span><span class="ident" id="5071311">phyMemory</span><span class="op" id="5071320">)</span>&nbsp;<span class="ident" id="5071322">ReadByte</span><span class="op" id="5071330">(</span><span class="ident" id="5071331">addr</span>&nbsp;<span class="builtintype" id="5071336">uint32</span><span class="op" id="5071342">)</span>&nbsp;<span class="op" id="5071344">(</span><span class="builtintype" id="5071345">byte</span><span class="op" id="5071349">,</span>&nbsp;<span class="op" id="5071351">*</span><span class="ident" id="5071352">Excep</span><span class="op" id="5071357">)</span>&nbsp;<span class="op" id="5071359">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5071362">p</span><span class="op" id="5071363">,</span>&nbsp;<span class="ident" id="5071365">e</span>&nbsp;<span class="op" id="5071367">:=</span>&nbsp;<span class="ident" id="5071370">pm</span><span class="op" id="5071372">.</span><span class="ident" id="5071373">pageForByte</span><span class="op" id="5071384">(</span><span class="ident" id="5071385">addr</span><span class="op" id="5071389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071392">if</span>&nbsp;<span class="ident" id="5071395">e</span>&nbsp;<span class="op" id="5071397">!=</span>&nbsp;<span class="ident" id="5071400">nil</span>&nbsp;<span class="op" id="5071404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071408">return</span>&nbsp;<span class="num" id="5071415">0</span><span class="op" id="5071416">,</span>&nbsp;<span class="ident" id="5071418">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5071421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071424">return</span>&nbsp;<span class="ident" id="5071431">p</span><span class="op" id="5071432">.</span><span class="ident" id="5071433">ReadByte</span><span class="op" id="5071441">(</span><span class="ident" id="5071442">addr</span><span class="op" id="5071446">)</span><span class="op" id="5071447">,</span>&nbsp;<span class="ident" id="5071449">nil</span><br>
<span class="lineno">75</span><span class="op" id="5071453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5071456">//&nbsp;WriteByte&nbsp;writes&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5071507">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5071563">func</span>&nbsp;<span class="op" id="5071568">(</span><span class="ident" id="5071569">pm</span>&nbsp;<span class="op" id="5071572">*</span><span class="ident" id="5071573">phyMemory</span><span class="op" id="5071582">)</span>&nbsp;<span class="ident" id="5071584">WriteByte</span><span class="op" id="5071593">(</span><span class="ident" id="5071594">addr</span>&nbsp;<span class="builtintype" id="5071599">uint32</span><span class="op" id="5071605">,</span>&nbsp;<span class="ident" id="5071607">v</span>&nbsp;<span class="builtintype" id="5071609">byte</span><span class="op" id="5071613">)</span>&nbsp;<span class="op" id="5071615">*</span><span class="ident" id="5071616">Excep</span>&nbsp;<span class="op" id="5071622">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5071625">p</span><span class="op" id="5071626">,</span>&nbsp;<span class="ident" id="5071628">e</span>&nbsp;<span class="op" id="5071630">:=</span>&nbsp;<span class="ident" id="5071633">pm</span><span class="op" id="5071635">.</span><span class="ident" id="5071636">pageForByte</span><span class="op" id="5071647">(</span><span class="ident" id="5071648">addr</span><span class="op" id="5071652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071655">if</span>&nbsp;<span class="ident" id="5071658">e</span>&nbsp;<span class="op" id="5071660">!=</span>&nbsp;<span class="ident" id="5071663">nil</span>&nbsp;<span class="op" id="5071667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071671">return</span>&nbsp;<span class="ident" id="5071678">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5071681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5071684">p</span><span class="op" id="5071685">.</span><span class="ident" id="5071686">WriteByte</span><span class="op" id="5071695">(</span><span class="ident" id="5071696">addr</span><span class="op" id="5071700">,</span>&nbsp;<span class="ident" id="5071702">v</span><span class="op" id="5071703">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071706">return</span>&nbsp;<span class="ident" id="5071713">e</span><br>
<span class="lineno"></span><span class="op" id="5071715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5071718">//&nbsp;ReadWord&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5071767">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;not&nbsp;4-byte&nbsp;aligned,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">90</span><span class="keyword" id="5071845">func</span>&nbsp;<span class="op" id="5071850">(</span><span class="ident" id="5071851">pm</span>&nbsp;<span class="op" id="5071854">*</span><span class="ident" id="5071855">phyMemory</span><span class="op" id="5071864">)</span>&nbsp;<span class="ident" id="5071866">ReadWord</span><span class="op" id="5071874">(</span><span class="ident" id="5071875">addr</span>&nbsp;<span class="builtintype" id="5071880">uint32</span><span class="op" id="5071886">)</span>&nbsp;<span class="op" id="5071888">(</span><span class="builtintype" id="5071889">uint32</span><span class="op" id="5071895">,</span>&nbsp;<span class="op" id="5071897">*</span><span class="ident" id="5071898">Excep</span><span class="op" id="5071903">)</span>&nbsp;<span class="op" id="5071905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5071908">p</span><span class="op" id="5071909">,</span>&nbsp;<span class="ident" id="5071911">e</span>&nbsp;<span class="op" id="5071913">:=</span>&nbsp;<span class="ident" id="5071916">pm</span><span class="op" id="5071918">.</span><span class="ident" id="5071919">pageForWord</span><span class="op" id="5071930">(</span><span class="ident" id="5071931">addr</span><span class="op" id="5071935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071938">if</span>&nbsp;<span class="ident" id="5071941">e</span>&nbsp;<span class="op" id="5071943">!=</span>&nbsp;<span class="ident" id="5071946">nil</span>&nbsp;<span class="op" id="5071950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071954">return</span>&nbsp;<span class="num" id="5071961">0</span><span class="op" id="5071962">,</span>&nbsp;<span class="ident" id="5071964">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5071967">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5071970">return</span>&nbsp;<span class="ident" id="5071977">p</span><span class="op" id="5071978">.</span><span class="ident" id="5071979">ReadWord</span><span class="op" id="5071987">(</span><span class="ident" id="5071988">addr</span><span class="op" id="5071992">)</span><span class="op" id="5071993">,</span>&nbsp;<span class="ident" id="5071995">nil</span><br>
<span class="lineno"></span><span class="op" id="5071999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5072002">//&nbsp;WriteWord&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5072052">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;not&nbsp;4-byte&nbsp;aligned,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">100</span><span class="keyword" id="5072130">func</span>&nbsp;<span class="op" id="5072135">(</span><span class="ident" id="5072136">pm</span>&nbsp;<span class="op" id="5072139">*</span><span class="ident" id="5072140">phyMemory</span><span class="op" id="5072149">)</span>&nbsp;<span class="ident" id="5072151">WriteWord</span><span class="op" id="5072160">(</span><span class="ident" id="5072161">addr</span>&nbsp;<span class="builtintype" id="5072166">uint32</span><span class="op" id="5072172">,</span>&nbsp;<span class="ident" id="5072174">v</span>&nbsp;<span class="builtintype" id="5072176">uint32</span><span class="op" id="5072182">)</span>&nbsp;<span class="op" id="5072184">*</span><span class="ident" id="5072185">Excep</span>&nbsp;<span class="op" id="5072191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5072194">p</span><span class="op" id="5072195">,</span>&nbsp;<span class="ident" id="5072197">e</span>&nbsp;<span class="op" id="5072199">:=</span>&nbsp;<span class="ident" id="5072202">pm</span><span class="op" id="5072204">.</span><span class="ident" id="5072205">pageForWord</span><span class="op" id="5072216">(</span><span class="ident" id="5072217">addr</span><span class="op" id="5072221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5072224">if</span>&nbsp;<span class="ident" id="5072227">e</span>&nbsp;<span class="op" id="5072229">!=</span>&nbsp;<span class="ident" id="5072232">nil</span>&nbsp;<span class="op" id="5072236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5072240">return</span>&nbsp;<span class="ident" id="5072247">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5072250">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5072253">p</span><span class="op" id="5072254">.</span><span class="ident" id="5072255">WriteWord</span><span class="op" id="5072264">(</span><span class="ident" id="5072265">addr</span><span class="op" id="5072269">,</span>&nbsp;<span class="ident" id="5072271">v</span><span class="op" id="5072272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5072275">return</span>&nbsp;<span class="ident" id="5072282">nil</span><br>
<span class="lineno"></span><span class="op" id="5072286">}</span>
</div>
</body>
</html>
