<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html" class="current">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7882854">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7882909">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7882963">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7883014">package</span>&nbsp;<span class="ident" id="7883022">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7883033">import</span>&nbsp;<span class="op" id="7883040">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883043">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883052">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883061">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883071">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883079">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883086">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883092">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883103">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883113">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883121">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883132">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7883143">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7883150">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7883153">func</span>&nbsp;<span class="ident" id="7883158">TestQuotedPrintable</span><span class="op" id="7883177">(</span><span class="ident" id="7883178">t</span>&nbsp;<span class="op" id="7883180">*</span><span class="ident" id="7883181">testing</span><span class="op" id="7883188">.</span><span class="ident" id="7883189">T</span><span class="op" id="7883190">)</span>&nbsp;<span class="op" id="7883192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7883195">tests</span>&nbsp;<span class="op" id="7883201">:=</span>&nbsp;<span class="op" id="7883204">[</span><span class="op" id="7883205">]</span><span class="keyword" id="7883206">struct</span>&nbsp;<span class="op" id="7883213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7883217">in</span><span class="op" id="7883219">,</span>&nbsp;<span class="ident" id="7883221">want</span>&nbsp;<span class="builtintype" id="7883226">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7883235">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7883244">interface</span><span class="op" id="7883253">{</span><span class="op" id="7883254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883257">}</span><span class="op" id="7883258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883262">{</span><span class="ident" id="7883263">in</span><span class="op" id="7883265">:</span>&nbsp;<span class="string" id="7883267">&#34;&#34;</span><span class="op" id="7883269">,</span>&nbsp;<span class="ident" id="7883271">want</span><span class="op" id="7883275">:</span>&nbsp;<span class="string" id="7883277">&#34;&#34;</span><span class="op" id="7883279">}</span><span class="op" id="7883280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883284">{</span><span class="ident" id="7883285">in</span><span class="op" id="7883287">:</span>&nbsp;<span class="string" id="7883289">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7883298">,</span>&nbsp;<span class="ident" id="7883300">want</span><span class="op" id="7883304">:</span>&nbsp;<span class="string" id="7883306">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7883315">}</span><span class="op" id="7883316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883320">{</span><span class="ident" id="7883321">in</span><span class="op" id="7883323">:</span>&nbsp;<span class="string" id="7883325">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="7883337">,</span>&nbsp;<span class="ident" id="7883339">want</span><span class="op" id="7883343">:</span>&nbsp;<span class="string" id="7883345">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="7883355">}</span><span class="op" id="7883356">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883360">{</span><span class="ident" id="7883361">in</span><span class="op" id="7883363">:</span>&nbsp;<span class="string" id="7883365">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="7883377">,</span>&nbsp;<span class="ident" id="7883379">want</span><span class="op" id="7883383">:</span>&nbsp;<span class="string" id="7883385">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7883394">}</span><span class="op" id="7883395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883399">{</span><span class="ident" id="7883400">in</span><span class="op" id="7883402">:</span>&nbsp;<span class="string" id="7883404">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7883415">,</span>&nbsp;<span class="ident" id="7883417">want</span><span class="op" id="7883421">:</span>&nbsp;<span class="string" id="7883423">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7883434">}</span><span class="op" id="7883435">,</span>&nbsp;<span class="comment" id="7883437">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883456">{</span><span class="ident" id="7883457">in</span><span class="op" id="7883459">:</span>&nbsp;<span class="string" id="7883461">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="7883472">,</span>&nbsp;<span class="ident" id="7883474">want</span><span class="op" id="7883478">:</span>&nbsp;<span class="string" id="7883480">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7883489">,</span>&nbsp;<span class="ident" id="7883491">err</span><span class="op" id="7883494">:</span>&nbsp;<span class="ident" id="7883496">io</span><span class="op" id="7883498">.</span><span class="ident" id="7883499">ErrUnexpectedEOF</span><span class="op" id="7883515">}</span><span class="op" id="7883516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883520">{</span><span class="ident" id="7883521">in</span><span class="op" id="7883523">:</span>&nbsp;<span class="string" id="7883525">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="7883537">,</span>&nbsp;<span class="ident" id="7883539">want</span><span class="op" id="7883543">:</span>&nbsp;<span class="string" id="7883545">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7883554">,</span>&nbsp;<span class="ident" id="7883556">err</span><span class="op" id="7883559">:</span>&nbsp;<span class="string" id="7883561">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="7883612">}</span><span class="op" id="7883613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883617">{</span><span class="ident" id="7883618">in</span><span class="op" id="7883620">:</span>&nbsp;<span class="string" id="7883622">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="7883637">,</span>&nbsp;<span class="ident" id="7883639">want</span><span class="op" id="7883643">:</span>&nbsp;<span class="string" id="7883645">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="7883658">}</span><span class="op" id="7883659">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883663">{</span><span class="ident" id="7883664">in</span><span class="op" id="7883666">:</span>&nbsp;<span class="string" id="7883668">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7883689">,</span>&nbsp;<span class="ident" id="7883691">want</span><span class="op" id="7883695">:</span>&nbsp;<span class="string" id="7883697">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="7883709">}</span><span class="op" id="7883710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883714">{</span><span class="ident" id="7883715">in</span><span class="op" id="7883717">:</span>&nbsp;<span class="string" id="7883719">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7883734">,</span>&nbsp;<span class="ident" id="7883736">want</span><span class="op" id="7883740">:</span>&nbsp;<span class="string" id="7883742">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7883751">}</span><span class="op" id="7883752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883756">{</span><span class="ident" id="7883757">in</span><span class="op" id="7883759">:</span>&nbsp;<span class="string" id="7883761">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7883774">,</span>&nbsp;<span class="ident" id="7883776">want</span><span class="op" id="7883780">:</span>&nbsp;<span class="string" id="7883782">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7883791">}</span><span class="op" id="7883792">,</span>&nbsp;<span class="comment" id="7883794">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883824">{</span><span class="ident" id="7883825">in</span><span class="op" id="7883827">:</span>&nbsp;<span class="string" id="7883829">&#34;foo=\nbar&#34;</span><span class="op" id="7883840">,</span>&nbsp;<span class="ident" id="7883842">want</span><span class="op" id="7883846">:</span>&nbsp;<span class="string" id="7883848">&#34;foobar&#34;</span><span class="op" id="7883856">}</span><span class="op" id="7883857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883861">{</span><span class="ident" id="7883862">in</span><span class="op" id="7883864">:</span>&nbsp;<span class="string" id="7883866">&#34;foo\x00bar&#34;</span><span class="op" id="7883878">,</span>&nbsp;<span class="ident" id="7883880">want</span><span class="op" id="7883884">:</span>&nbsp;<span class="string" id="7883886">&#34;foo&#34;</span><span class="op" id="7883891">,</span>&nbsp;<span class="ident" id="7883893">err</span><span class="op" id="7883896">:</span>&nbsp;<span class="string" id="7883898">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7883963">}</span><span class="op" id="7883964">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883968">{</span><span class="ident" id="7883969">in</span><span class="op" id="7883971">:</span>&nbsp;<span class="string" id="7883973">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="7883986">,</span>&nbsp;<span class="ident" id="7883988">want</span><span class="op" id="7883992">:</span>&nbsp;<span class="string" id="7883994">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7884003">,</span>&nbsp;<span class="ident" id="7884005">err</span><span class="op" id="7884008">:</span>&nbsp;<span class="string" id="7884010">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7884075">}</span><span class="op" id="7884076">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884081">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884098">{</span><span class="ident" id="7884099">in</span><span class="op" id="7884101">:</span>&nbsp;<span class="string" id="7884103">&#34;=3D30\n&#34;</span><span class="op" id="7884112">,</span>&nbsp;<span class="ident" id="7884114">want</span><span class="op" id="7884118">:</span>&nbsp;<span class="string" id="7884120">&#34;=30\n&#34;</span><span class="op" id="7884127">}</span><span class="op" id="7884128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884132">{</span><span class="ident" id="7884133">in</span><span class="op" id="7884135">:</span>&nbsp;<span class="string" id="7884137">&#34;=00=FF0=\n&#34;</span><span class="op" id="7884149">,</span>&nbsp;<span class="ident" id="7884151">want</span><span class="op" id="7884155">:</span>&nbsp;<span class="string" id="7884157">&#34;\x00\xff0&#34;</span><span class="op" id="7884168">}</span><span class="op" id="7884169">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884174">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884199">{</span><span class="ident" id="7884200">in</span><span class="op" id="7884202">:</span>&nbsp;<span class="string" id="7884204">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="7884213">,</span>&nbsp;<span class="ident" id="7884215">want</span><span class="op" id="7884219">:</span>&nbsp;<span class="string" id="7884221">&#34;foo\n&#34;</span><span class="op" id="7884228">}</span><span class="op" id="7884229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884233">{</span><span class="ident" id="7884234">in</span><span class="op" id="7884236">:</span>&nbsp;<span class="string" id="7884238">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="7884268">,</span>&nbsp;<span class="ident" id="7884270">want</span><span class="op" id="7884274">:</span>&nbsp;<span class="string" id="7884276">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="7884299">}</span><span class="op" id="7884300">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884305">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884380">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884445">{</span><span class="ident" id="7884446">in</span><span class="op" id="7884448">:</span>&nbsp;<span class="string" id="7884450">&#34;foo\nbar&#34;</span><span class="op" id="7884460">,</span>&nbsp;<span class="ident" id="7884462">want</span><span class="op" id="7884466">:</span>&nbsp;<span class="string" id="7884468">&#34;foo\nbar&#34;</span><span class="op" id="7884478">}</span><span class="op" id="7884479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884483">{</span><span class="ident" id="7884484">in</span><span class="op" id="7884486">:</span>&nbsp;<span class="string" id="7884488">&#34;foo\rbar&#34;</span><span class="op" id="7884498">,</span>&nbsp;<span class="ident" id="7884500">want</span><span class="op" id="7884504">:</span>&nbsp;<span class="string" id="7884506">&#34;foo\rbar&#34;</span><span class="op" id="7884516">}</span><span class="op" id="7884517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884521">{</span><span class="ident" id="7884522">in</span><span class="op" id="7884524">:</span>&nbsp;<span class="string" id="7884526">&#34;foo\r\nbar&#34;</span><span class="op" id="7884538">,</span>&nbsp;<span class="ident" id="7884540">want</span><span class="op" id="7884544">:</span>&nbsp;<span class="string" id="7884546">&#34;foo\r\nbar&#34;</span><span class="op" id="7884558">}</span><span class="op" id="7884559">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884564">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884606">{</span><span class="ident" id="7884607">in</span><span class="op" id="7884609">:</span>&nbsp;<span class="string" id="7884611">&#34;foo=\r\nbar&#34;</span><span class="op" id="7884624">,</span>&nbsp;<span class="ident" id="7884626">want</span><span class="op" id="7884630">:</span>&nbsp;<span class="string" id="7884632">&#34;foobar&#34;</span><span class="op" id="7884640">}</span><span class="op" id="7884641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884645">{</span><span class="ident" id="7884646">in</span><span class="op" id="7884648">:</span>&nbsp;<span class="string" id="7884650">&#34;foo=\nbar&#34;</span><span class="op" id="7884661">,</span>&nbsp;<span class="ident" id="7884663">want</span><span class="op" id="7884667">:</span>&nbsp;<span class="string" id="7884669">&#34;foobar&#34;</span><span class="op" id="7884677">}</span><span class="op" id="7884678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884682">{</span><span class="ident" id="7884683">in</span><span class="op" id="7884685">:</span>&nbsp;<span class="string" id="7884687">&#34;foo=\rbar&#34;</span><span class="op" id="7884698">,</span>&nbsp;<span class="ident" id="7884700">want</span><span class="op" id="7884704">:</span>&nbsp;<span class="string" id="7884706">&#34;foo&#34;</span><span class="op" id="7884711">,</span>&nbsp;<span class="ident" id="7884713">err</span><span class="op" id="7884716">:</span>&nbsp;<span class="string" id="7884718">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="7884769">}</span><span class="op" id="7884770">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884774">{</span><span class="ident" id="7884775">in</span><span class="op" id="7884777">:</span>&nbsp;<span class="string" id="7884779">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="7884797">,</span>&nbsp;<span class="ident" id="7884799">want</span><span class="op" id="7884803">:</span>&nbsp;<span class="string" id="7884805">&#34;foo&#34;</span><span class="op" id="7884810">,</span>&nbsp;<span class="ident" id="7884812">err</span><span class="op" id="7884815">:</span>&nbsp;<span class="string" id="7884817">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="7884864">}</span><span class="op" id="7884865">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884870">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884898">{</span><span class="ident" id="7884899">in</span><span class="op" id="7884901">:</span>&nbsp;<span class="string" id="7884903">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="7884924">+</span>&nbsp;<span class="string" id="7884926">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="7884952">+</span>&nbsp;<span class="string" id="7884954">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7884985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884990">want</span><span class="op" id="7884994">:</span>&nbsp;<span class="string" id="7884996">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7885062">}</span><span class="op" id="7885063">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885069">for</span>&nbsp;<span class="ident" id="7885073">_</span><span class="op" id="7885074">,</span>&nbsp;<span class="ident" id="7885076">tt</span>&nbsp;<span class="op" id="7885079">:=</span>&nbsp;<span class="keyword" id="7885082">range</span>&nbsp;<span class="ident" id="7885088">tests</span>&nbsp;<span class="op" id="7885094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885098">var</span>&nbsp;<span class="ident" id="7885102">buf</span>&nbsp;<span class="ident" id="7885106">bytes</span><span class="op" id="7885111">.</span><span class="ident" id="7885112">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885121">_</span><span class="op" id="7885122">,</span>&nbsp;<span class="ident" id="7885124">err</span>&nbsp;<span class="op" id="7885128">:=</span>&nbsp;<span class="ident" id="7885131">io</span><span class="op" id="7885133">.</span><span class="ident" id="7885134">Copy</span><span class="op" id="7885138">(</span><span class="op" id="7885139">&amp;</span><span class="ident" id="7885140">buf</span><span class="op" id="7885143">,</span>&nbsp;<span class="ident" id="7885145">newQuotedPrintableReader</span><span class="op" id="7885169">(</span><span class="ident" id="7885170">strings</span><span class="op" id="7885177">.</span><span class="ident" id="7885178">NewReader</span><span class="op" id="7885187">(</span><span class="ident" id="7885188">tt</span><span class="op" id="7885190">.</span><span class="ident" id="7885191">in</span><span class="op" id="7885193">)</span><span class="op" id="7885194">)</span><span class="op" id="7885195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885199">if</span>&nbsp;<span class="ident" id="7885202">got</span>&nbsp;<span class="op" id="7885206">:=</span>&nbsp;<span class="ident" id="7885209">buf</span><span class="op" id="7885212">.</span><span class="ident" id="7885213">String</span><span class="op" id="7885219">(</span><span class="op" id="7885220">)</span><span class="op" id="7885221">;</span>&nbsp;<span class="ident" id="7885223">got</span>&nbsp;<span class="op" id="7885227">!=</span>&nbsp;<span class="ident" id="7885230">tt</span><span class="op" id="7885232">.</span><span class="ident" id="7885233">want</span>&nbsp;<span class="op" id="7885238">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885243">t</span><span class="op" id="7885244">.</span><span class="ident" id="7885245">Errorf</span><span class="op" id="7885251">(</span><span class="string" id="7885252">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7885277">,</span>&nbsp;<span class="ident" id="7885279">tt</span><span class="op" id="7885281">.</span><span class="ident" id="7885282">in</span><span class="op" id="7885284">,</span>&nbsp;<span class="ident" id="7885286">got</span><span class="op" id="7885289">,</span>&nbsp;<span class="ident" id="7885291">tt</span><span class="op" id="7885293">.</span><span class="ident" id="7885294">want</span><span class="op" id="7885298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885306">switch</span>&nbsp;<span class="ident" id="7885313">verr</span>&nbsp;<span class="op" id="7885318">:=</span>&nbsp;<span class="ident" id="7885321">tt</span><span class="op" id="7885323">.</span><span class="ident" id="7885324">err</span><span class="op" id="7885327">.</span><span class="op" id="7885328">(</span><span class="keyword" id="7885329">type</span><span class="op" id="7885333">)</span>&nbsp;<span class="op" id="7885335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885339">case</span>&nbsp;<span class="ident" id="7885344">nil</span><span class="op" id="7885347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885352">if</span>&nbsp;<span class="ident" id="7885355">err</span>&nbsp;<span class="op" id="7885359">!=</span>&nbsp;<span class="ident" id="7885362">nil</span>&nbsp;<span class="op" id="7885366">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885372">t</span><span class="op" id="7885373">.</span><span class="ident" id="7885374">Errorf</span><span class="op" id="7885380">(</span><span class="string" id="7885381">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7885415">,</span>&nbsp;<span class="ident" id="7885417">tt</span><span class="op" id="7885419">.</span><span class="ident" id="7885420">in</span><span class="op" id="7885422">,</span>&nbsp;<span class="ident" id="7885424">err</span><span class="op" id="7885427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885436">case</span>&nbsp;<span class="builtintype" id="7885441">string</span><span class="op" id="7885447">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885452">if</span>&nbsp;<span class="ident" id="7885455">got</span>&nbsp;<span class="op" id="7885459">:=</span>&nbsp;<span class="ident" id="7885462">fmt</span><span class="op" id="7885465">.</span><span class="ident" id="7885466">Sprint</span><span class="op" id="7885472">(</span><span class="ident" id="7885473">err</span><span class="op" id="7885476">)</span><span class="op" id="7885477">;</span>&nbsp;<span class="ident" id="7885479">got</span>&nbsp;<span class="op" id="7885483">!=</span>&nbsp;<span class="ident" id="7885486">verr</span>&nbsp;<span class="op" id="7885491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885497">t</span><span class="op" id="7885498">.</span><span class="ident" id="7885499">Errorf</span><span class="op" id="7885505">(</span><span class="string" id="7885506">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7885537">,</span>&nbsp;<span class="ident" id="7885539">tt</span><span class="op" id="7885541">.</span><span class="ident" id="7885542">in</span><span class="op" id="7885544">,</span>&nbsp;<span class="ident" id="7885546">got</span><span class="op" id="7885549">,</span>&nbsp;<span class="ident" id="7885551">verr</span><span class="op" id="7885555">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885564">case</span>&nbsp;<span class="builtintype" id="7885569">error</span><span class="op" id="7885574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885579">if</span>&nbsp;<span class="ident" id="7885582">err</span>&nbsp;<span class="op" id="7885586">!=</span>&nbsp;<span class="ident" id="7885589">verr</span>&nbsp;<span class="op" id="7885594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885600">t</span><span class="op" id="7885601">.</span><span class="ident" id="7885602">Errorf</span><span class="op" id="7885608">(</span><span class="string" id="7885609">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7885640">,</span>&nbsp;<span class="ident" id="7885642">tt</span><span class="op" id="7885644">.</span><span class="ident" id="7885645">in</span><span class="op" id="7885647">,</span>&nbsp;<span class="ident" id="7885649">err</span><span class="op" id="7885652">,</span>&nbsp;<span class="ident" id="7885654">verr</span><span class="op" id="7885658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885663">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="7885673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7885676">func</span>&nbsp;<span class="ident" id="7885681">everySequence</span><span class="op" id="7885694">(</span><span class="ident" id="7885695">base</span><span class="op" id="7885699">,</span>&nbsp;<span class="ident" id="7885701">alpha</span>&nbsp;<span class="builtintype" id="7885707">string</span><span class="op" id="7885713">,</span>&nbsp;<span class="ident" id="7885715">length</span>&nbsp;<span class="builtintype" id="7885722">int</span><span class="op" id="7885725">,</span>&nbsp;<span class="ident" id="7885727">fn</span>&nbsp;<span class="keyword" id="7885730">func</span><span class="op" id="7885734">(</span><span class="builtintype" id="7885735">string</span><span class="op" id="7885741">)</span><span class="op" id="7885742">)</span>&nbsp;<span class="op" id="7885744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885747">if</span>&nbsp;<span class="builtinfunc" id="7885750">len</span><span class="op" id="7885753">(</span><span class="ident" id="7885754">base</span><span class="op" id="7885758">)</span>&nbsp;<span class="op" id="7885760">==</span>&nbsp;<span class="ident" id="7885763">length</span>&nbsp;<span class="op" id="7885770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885774">fn</span><span class="op" id="7885776">(</span><span class="ident" id="7885777">base</span><span class="op" id="7885781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885785">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885793">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885796">for</span>&nbsp;<span class="ident" id="7885800">i</span>&nbsp;<span class="op" id="7885802">:=</span>&nbsp;<span class="num" id="7885805">0</span><span class="op" id="7885806">;</span>&nbsp;<span class="ident" id="7885808">i</span>&nbsp;<span class="op" id="7885810">&lt;</span>&nbsp;<span class="builtinfunc" id="7885812">len</span><span class="op" id="7885815">(</span><span class="ident" id="7885816">alpha</span><span class="op" id="7885821">)</span><span class="op" id="7885822">;</span>&nbsp;<span class="ident" id="7885824">i</span><span class="op" id="7885825">++</span>&nbsp;<span class="op" id="7885828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885832">everySequence</span><span class="op" id="7885845">(</span><span class="ident" id="7885846">base</span><span class="op" id="7885850">+</span><span class="ident" id="7885851">alpha</span><span class="op" id="7885856">[</span><span class="ident" id="7885857">i</span><span class="op" id="7885858">:</span><span class="ident" id="7885859">i</span><span class="op" id="7885860">+</span><span class="num" id="7885861">1</span><span class="op" id="7885862">]</span><span class="op" id="7885863">,</span>&nbsp;<span class="ident" id="7885865">alpha</span><span class="op" id="7885870">,</span>&nbsp;<span class="ident" id="7885872">length</span><span class="op" id="7885878">,</span>&nbsp;<span class="ident" id="7885880">fn</span><span class="op" id="7885882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885885">}</span><br>
<span class="lineno"></span><span class="op" id="7885887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7885890">var</span>&nbsp;<span class="ident" id="7885894">useQprint</span>&nbsp;<span class="op" id="7885904">=</span>&nbsp;<span class="ident" id="7885906">flag</span><span class="op" id="7885910">.</span><span class="ident" id="7885911">Bool</span><span class="op" id="7885915">(</span><span class="string" id="7885916">&#34;qprint&#34;</span><span class="op" id="7885924">,</span>&nbsp;<span class="builtintype" id="7885926">false</span><span class="op" id="7885931">,</span>&nbsp;<span class="string" id="7885933">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="7885972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7885975">var</span>&nbsp;<span class="ident" id="7885979">badSoftRx</span>&nbsp;<span class="op" id="7885989">=</span>&nbsp;<span class="ident" id="7885991">regexp</span><span class="op" id="7885997">.</span><span class="ident" id="7885998">MustCompile</span><span class="op" id="7886009">(</span><span class="string" id="7886010">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="7886065">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7886068">func</span>&nbsp;<span class="ident" id="7886073">TestQPExhaustive</span><span class="op" id="7886089">(</span><span class="ident" id="7886090">t</span>&nbsp;<span class="op" id="7886092">*</span><span class="ident" id="7886093">testing</span><span class="op" id="7886100">.</span><span class="ident" id="7886101">T</span><span class="op" id="7886102">)</span>&nbsp;<span class="op" id="7886104">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886107">if</span>&nbsp;<span class="op" id="7886110">*</span><span class="ident" id="7886111">useQprint</span>&nbsp;<span class="op" id="7886121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886125">_</span><span class="op" id="7886126">,</span>&nbsp;<span class="ident" id="7886128">err</span>&nbsp;<span class="op" id="7886132">:=</span>&nbsp;<span class="ident" id="7886135">exec</span><span class="op" id="7886139">.</span><span class="ident" id="7886140">LookPath</span><span class="op" id="7886148">(</span><span class="string" id="7886149">&#34;qprint&#34;</span><span class="op" id="7886157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886161">if</span>&nbsp;<span class="ident" id="7886164">err</span>&nbsp;<span class="op" id="7886168">!=</span>&nbsp;<span class="ident" id="7886171">nil</span>&nbsp;<span class="op" id="7886175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886180">t</span><span class="op" id="7886181">.</span><span class="ident" id="7886182">Fatalf</span><span class="op" id="7886188">(</span><span class="string" id="7886189">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="7886219">,</span>&nbsp;<span class="ident" id="7886221">err</span><span class="op" id="7886224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886228">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886235">var</span>&nbsp;<span class="ident" id="7886239">buf</span>&nbsp;<span class="ident" id="7886243">bytes</span><span class="op" id="7886248">.</span><span class="ident" id="7886249">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886257">res</span>&nbsp;<span class="op" id="7886261">:=</span>&nbsp;<span class="builtinfunc" id="7886264">make</span><span class="op" id="7886268">(</span><span class="keyword" id="7886269">map</span><span class="op" id="7886272">[</span><span class="builtintype" id="7886273">string</span><span class="op" id="7886279">]</span><span class="builtintype" id="7886280">int</span><span class="op" id="7886283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886286">everySequence</span><span class="op" id="7886299">(</span><span class="string" id="7886300">&#34;&#34;</span><span class="op" id="7886302">,</span>&nbsp;<span class="string" id="7886304">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="7886314">,</span>&nbsp;<span class="num" id="7886316">6</span><span class="op" id="7886317">,</span>&nbsp;<span class="keyword" id="7886319">func</span><span class="op" id="7886323">(</span><span class="ident" id="7886324">s</span>&nbsp;<span class="builtintype" id="7886326">string</span><span class="op" id="7886332">)</span>&nbsp;<span class="op" id="7886334">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886338">if</span>&nbsp;<span class="ident" id="7886341">strings</span><span class="op" id="7886348">.</span><span class="ident" id="7886349">HasSuffix</span><span class="op" id="7886358">(</span><span class="ident" id="7886359">s</span><span class="op" id="7886360">,</span>&nbsp;<span class="string" id="7886362">&#34;=&#34;</span><span class="op" id="7886365">)</span>&nbsp;<span class="op" id="7886367">||</span>&nbsp;<span class="ident" id="7886370">strings</span><span class="op" id="7886377">.</span><span class="ident" id="7886378">Contains</span><span class="op" id="7886386">(</span><span class="ident" id="7886387">s</span><span class="op" id="7886388">,</span>&nbsp;<span class="string" id="7886390">&#34;==&#34;</span><span class="op" id="7886394">)</span>&nbsp;<span class="op" id="7886396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886401">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886414">buf</span><span class="op" id="7886417">.</span><span class="ident" id="7886418">Reset</span><span class="op" id="7886423">(</span><span class="op" id="7886424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886428">_</span><span class="op" id="7886429">,</span>&nbsp;<span class="ident" id="7886431">err</span>&nbsp;<span class="op" id="7886435">:=</span>&nbsp;<span class="ident" id="7886438">io</span><span class="op" id="7886440">.</span><span class="ident" id="7886441">Copy</span><span class="op" id="7886445">(</span><span class="op" id="7886446">&amp;</span><span class="ident" id="7886447">buf</span><span class="op" id="7886450">,</span>&nbsp;<span class="ident" id="7886452">newQuotedPrintableReader</span><span class="op" id="7886476">(</span><span class="ident" id="7886477">strings</span><span class="op" id="7886484">.</span><span class="ident" id="7886485">NewReader</span><span class="op" id="7886494">(</span><span class="ident" id="7886495">s</span><span class="op" id="7886496">)</span><span class="op" id="7886497">)</span><span class="op" id="7886498">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886502">if</span>&nbsp;<span class="ident" id="7886505">err</span>&nbsp;<span class="op" id="7886509">!=</span>&nbsp;<span class="ident" id="7886512">nil</span>&nbsp;<span class="op" id="7886516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886521">errStr</span>&nbsp;<span class="op" id="7886528">:=</span>&nbsp;<span class="ident" id="7886531">err</span><span class="op" id="7886534">.</span><span class="ident" id="7886535">Error</span><span class="op" id="7886540">(</span><span class="op" id="7886541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886546">if</span>&nbsp;<span class="ident" id="7886549">strings</span><span class="op" id="7886556">.</span><span class="ident" id="7886557">Contains</span><span class="op" id="7886565">(</span><span class="ident" id="7886566">errStr</span><span class="op" id="7886572">,</span>&nbsp;<span class="string" id="7886574">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="7886598">)</span>&nbsp;<span class="op" id="7886600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886606">errStr</span>&nbsp;<span class="op" id="7886613">=</span>&nbsp;<span class="string" id="7886615">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886642">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7886647">res</span><span class="op" id="7886650">[</span><span class="ident" id="7886651">errStr</span><span class="op" id="7886657">]</span><span class="op" id="7886658">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886664">if</span>&nbsp;<span class="ident" id="7886667">strings</span><span class="op" id="7886674">.</span><span class="ident" id="7886675">Contains</span><span class="op" id="7886683">(</span><span class="ident" id="7886684">errStr</span><span class="op" id="7886690">,</span>&nbsp;<span class="string" id="7886692">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="7886728">)</span>&nbsp;<span class="op" id="7886730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886736">if</span>&nbsp;<span class="ident" id="7886739">strings</span><span class="op" id="7886746">.</span><span class="ident" id="7886747">HasSuffix</span><span class="op" id="7886756">(</span><span class="ident" id="7886757">errStr</span><span class="op" id="7886763">,</span>&nbsp;<span class="string" id="7886765">&#34;0x20&#34;</span><span class="op" id="7886771">)</span>&nbsp;<span class="op" id="7886773">&amp;&amp;</span>&nbsp;<span class="op" id="7886776">(</span><span class="ident" id="7886777">strings</span><span class="op" id="7886784">.</span><span class="ident" id="7886785">Contains</span><span class="op" id="7886793">(</span><span class="ident" id="7886794">s</span><span class="op" id="7886795">,</span>&nbsp;<span class="string" id="7886797">&#34;=0&nbsp;&#34;</span><span class="op" id="7886802">)</span>&nbsp;<span class="op" id="7886804">||</span>&nbsp;<span class="ident" id="7886807">strings</span><span class="op" id="7886814">.</span><span class="ident" id="7886815">Contains</span><span class="op" id="7886823">(</span><span class="ident" id="7886824">s</span><span class="op" id="7886825">,</span>&nbsp;<span class="string" id="7886827">&#34;=A&nbsp;&#34;</span><span class="op" id="7886832">)</span>&nbsp;<span class="op" id="7886834">||</span>&nbsp;<span class="ident" id="7886837">strings</span><span class="op" id="7886844">.</span><span class="ident" id="7886845">Contains</span><span class="op" id="7886853">(</span><span class="ident" id="7886854">s</span><span class="op" id="7886855">,</span>&nbsp;<span class="string" id="7886857">&#34;=&nbsp;&#34;</span><span class="op" id="7886861">)</span><span class="op" id="7886862">)</span>&nbsp;<span class="op" id="7886864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886871">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7886882">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886888">if</span>&nbsp;<span class="ident" id="7886891">strings</span><span class="op" id="7886898">.</span><span class="ident" id="7886899">HasSuffix</span><span class="op" id="7886908">(</span><span class="ident" id="7886909">errStr</span><span class="op" id="7886915">,</span>&nbsp;<span class="string" id="7886917">&#34;0x3d&#34;</span><span class="op" id="7886923">)</span>&nbsp;<span class="op" id="7886925">&amp;&amp;</span>&nbsp;<span class="op" id="7886928">(</span><span class="ident" id="7886929">strings</span><span class="op" id="7886936">.</span><span class="ident" id="7886937">Contains</span><span class="op" id="7886945">(</span><span class="ident" id="7886946">s</span><span class="op" id="7886947">,</span>&nbsp;<span class="string" id="7886949">&#34;=0=&#34;</span><span class="op" id="7886954">)</span>&nbsp;<span class="op" id="7886956">||</span>&nbsp;<span class="ident" id="7886959">strings</span><span class="op" id="7886966">.</span><span class="ident" id="7886967">Contains</span><span class="op" id="7886975">(</span><span class="ident" id="7886976">s</span><span class="op" id="7886977">,</span>&nbsp;<span class="string" id="7886979">&#34;=A=&#34;</span><span class="op" id="7886984">)</span><span class="op" id="7886985">)</span>&nbsp;<span class="op" id="7886987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7886994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887011">if</span>&nbsp;<span class="ident" id="7887014">strings</span><span class="op" id="7887021">.</span><span class="ident" id="7887022">HasSuffix</span><span class="op" id="7887031">(</span><span class="ident" id="7887032">errStr</span><span class="op" id="7887038">,</span>&nbsp;<span class="string" id="7887040">&#34;0x0a&#34;</span><span class="op" id="7887046">)</span>&nbsp;<span class="op" id="7887048">||</span>&nbsp;<span class="ident" id="7887051">strings</span><span class="op" id="7887058">.</span><span class="ident" id="7887059">HasSuffix</span><span class="op" id="7887068">(</span><span class="ident" id="7887069">errStr</span><span class="op" id="7887075">,</span>&nbsp;<span class="string" id="7887077">&#34;0x0d&#34;</span><span class="op" id="7887083">)</span>&nbsp;<span class="op" id="7887085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7887092">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887197">if</span>&nbsp;<span class="ident" id="7887200">strings</span><span class="op" id="7887207">.</span><span class="ident" id="7887208">Contains</span><span class="op" id="7887216">(</span><span class="ident" id="7887217">errStr</span><span class="op" id="7887223">,</span>&nbsp;<span class="string" id="7887225">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="7887241">)</span>&nbsp;<span class="op" id="7887243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887249">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887264">if</span>&nbsp;<span class="ident" id="7887267">errStr</span>&nbsp;<span class="op" id="7887274">==</span>&nbsp;<span class="string" id="7887277">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="7887301">&amp;&amp;</span>&nbsp;<span class="ident" id="7887304">badSoftRx</span><span class="op" id="7887313">.</span><span class="ident" id="7887314">MatchString</span><span class="op" id="7887325">(</span><span class="ident" id="7887326">s</span><span class="op" id="7887327">)</span>&nbsp;<span class="op" id="7887329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887335">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887350">t</span><span class="op" id="7887351">.</span><span class="ident" id="7887352">Errorf</span><span class="op" id="7887358">(</span><span class="string" id="7887359">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7887376">,</span>&nbsp;<span class="ident" id="7887378">s</span><span class="op" id="7887379">,</span>&nbsp;<span class="ident" id="7887381">err</span><span class="op" id="7887384">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887389">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887402">if</span>&nbsp;<span class="op" id="7887405">*</span><span class="ident" id="7887406">useQprint</span>&nbsp;<span class="op" id="7887416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887421">cmd</span>&nbsp;<span class="op" id="7887425">:=</span>&nbsp;<span class="ident" id="7887428">exec</span><span class="op" id="7887432">.</span><span class="ident" id="7887433">Command</span><span class="op" id="7887440">(</span><span class="string" id="7887441">&#34;qprint&#34;</span><span class="op" id="7887449">,</span>&nbsp;<span class="string" id="7887451">&#34;-d&#34;</span><span class="op" id="7887455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887460">cmd</span><span class="op" id="7887463">.</span><span class="ident" id="7887464">Stdin</span>&nbsp;<span class="op" id="7887470">=</span>&nbsp;<span class="ident" id="7887472">strings</span><span class="op" id="7887479">.</span><span class="ident" id="7887480">NewReader</span><span class="op" id="7887489">(</span><span class="ident" id="7887490">s</span><span class="op" id="7887491">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887496">stderr</span><span class="op" id="7887502">,</span>&nbsp;<span class="ident" id="7887504">err</span>&nbsp;<span class="op" id="7887508">:=</span>&nbsp;<span class="ident" id="7887511">cmd</span><span class="op" id="7887514">.</span><span class="ident" id="7887515">StderrPipe</span><span class="op" id="7887525">(</span><span class="op" id="7887526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887531">if</span>&nbsp;<span class="ident" id="7887534">err</span>&nbsp;<span class="op" id="7887538">!=</span>&nbsp;<span class="ident" id="7887541">nil</span>&nbsp;<span class="op" id="7887545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7887551">panic</span><span class="op" id="7887556">(</span><span class="ident" id="7887557">err</span><span class="op" id="7887560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887570">qpres</span>&nbsp;<span class="op" id="7887576">:=</span>&nbsp;<span class="builtinfunc" id="7887579">make</span><span class="op" id="7887583">(</span><span class="keyword" id="7887584">chan</span>&nbsp;<span class="keyword" id="7887589">interface</span><span class="op" id="7887598">{</span><span class="op" id="7887599">}</span><span class="op" id="7887600">,</span>&nbsp;<span class="num" id="7887602">2</span><span class="op" id="7887603">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887608">go</span>&nbsp;<span class="keyword" id="7887611">func</span><span class="op" id="7887615">(</span><span class="op" id="7887616">)</span>&nbsp;<span class="op" id="7887618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887624">br</span>&nbsp;<span class="op" id="7887627">:=</span>&nbsp;<span class="ident" id="7887630">bufio</span><span class="op" id="7887635">.</span><span class="ident" id="7887636">NewReader</span><span class="op" id="7887645">(</span><span class="ident" id="7887646">stderr</span><span class="op" id="7887652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887658">s</span><span class="op" id="7887659">,</span>&nbsp;<span class="ident" id="7887661">_</span>&nbsp;<span class="op" id="7887663">:=</span>&nbsp;<span class="ident" id="7887666">br</span><span class="op" id="7887668">.</span><span class="ident" id="7887669">ReadString</span><span class="op" id="7887679">(</span><span class="string" id="7887680">&#39;\n&#39;</span><span class="op" id="7887684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887690">if</span>&nbsp;<span class="ident" id="7887693">s</span>&nbsp;<span class="op" id="7887695">!=</span>&nbsp;<span class="string" id="7887698">&#34;&#34;</span>&nbsp;<span class="op" id="7887701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887708">qpres</span>&nbsp;<span class="op" id="7887714">&lt;-</span>&nbsp;<span class="ident" id="7887717">errors</span><span class="op" id="7887723">.</span><span class="ident" id="7887724">New</span><span class="op" id="7887727">(</span><span class="ident" id="7887728">s</span><span class="op" id="7887729">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887736">if</span>&nbsp;<span class="ident" id="7887739">cmd</span><span class="op" id="7887742">.</span><span class="ident" id="7887743">Process</span>&nbsp;<span class="op" id="7887751">!=</span>&nbsp;<span class="ident" id="7887754">nil</span>&nbsp;<span class="op" id="7887758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7887766">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7887816">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887854">cmd</span><span class="op" id="7887857">.</span><span class="ident" id="7887858">Process</span><span class="op" id="7887865">.</span><span class="ident" id="7887866">Kill</span><span class="op" id="7887870">(</span><span class="op" id="7887871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887878">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887889">}</span><span class="op" id="7887890">(</span><span class="op" id="7887891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887896">go</span>&nbsp;<span class="keyword" id="7887899">func</span><span class="op" id="7887903">(</span><span class="op" id="7887904">)</span>&nbsp;<span class="op" id="7887906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887912">want</span><span class="op" id="7887916">,</span>&nbsp;<span class="ident" id="7887918">err</span>&nbsp;<span class="op" id="7887922">:=</span>&nbsp;<span class="ident" id="7887925">cmd</span><span class="op" id="7887928">.</span><span class="ident" id="7887929">Output</span><span class="op" id="7887935">(</span><span class="op" id="7887936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887942">if</span>&nbsp;<span class="ident" id="7887945">err</span>&nbsp;<span class="op" id="7887949">==</span>&nbsp;<span class="ident" id="7887952">nil</span>&nbsp;<span class="op" id="7887956">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7887963">qpres</span>&nbsp;<span class="op" id="7887969">&lt;-</span>&nbsp;<span class="ident" id="7887972">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7887986">}</span><span class="op" id="7887987">(</span><span class="op" id="7887988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7887993">select</span>&nbsp;<span class="op" id="7888000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888005">case</span>&nbsp;<span class="ident" id="7888010">got</span>&nbsp;<span class="op" id="7888014">:=</span>&nbsp;<span class="op" id="7888017">&lt;-</span><span class="ident" id="7888019">qpres</span><span class="op" id="7888024">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888030">if</span>&nbsp;<span class="ident" id="7888033">want</span><span class="op" id="7888037">,</span>&nbsp;<span class="ident" id="7888039">ok</span>&nbsp;<span class="op" id="7888042">:=</span>&nbsp;<span class="ident" id="7888045">got</span><span class="op" id="7888048">.</span><span class="op" id="7888049">(</span><span class="op" id="7888050">[</span><span class="op" id="7888051">]</span><span class="builtintype" id="7888052">byte</span><span class="op" id="7888056">)</span><span class="op" id="7888057">;</span>&nbsp;<span class="ident" id="7888059">ok</span>&nbsp;<span class="op" id="7888062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888069">if</span>&nbsp;<span class="builtintype" id="7888072">string</span><span class="op" id="7888078">(</span><span class="ident" id="7888079">want</span><span class="op" id="7888083">)</span>&nbsp;<span class="op" id="7888085">!=</span>&nbsp;<span class="ident" id="7888088">buf</span><span class="op" id="7888091">.</span><span class="ident" id="7888092">String</span><span class="op" id="7888098">(</span><span class="op" id="7888099">)</span>&nbsp;<span class="op" id="7888101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888109">t</span><span class="op" id="7888110">.</span><span class="ident" id="7888111">Errorf</span><span class="op" id="7888117">(</span><span class="string" id="7888118">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="7888151">,</span>&nbsp;<span class="ident" id="7888153">s</span><span class="op" id="7888154">,</span>&nbsp;<span class="ident" id="7888156">want</span><span class="op" id="7888160">,</span>&nbsp;<span class="ident" id="7888162">buf</span><span class="op" id="7888165">.</span><span class="ident" id="7888166">String</span><span class="op" id="7888172">(</span><span class="op" id="7888173">)</span><span class="op" id="7888174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888187">}</span>&nbsp;<span class="keyword" id="7888189">else</span>&nbsp;<span class="op" id="7888194">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888201">t</span><span class="op" id="7888202">.</span><span class="ident" id="7888203">Logf</span><span class="op" id="7888207">(</span><span class="string" id="7888208">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7888228">,</span>&nbsp;<span class="ident" id="7888230">s</span><span class="op" id="7888231">,</span>&nbsp;<span class="ident" id="7888233">got</span><span class="op" id="7888236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888247">case</span>&nbsp;<span class="op" id="7888252">&lt;-</span><span class="ident" id="7888254">time</span><span class="op" id="7888258">.</span><span class="ident" id="7888259">After</span><span class="op" id="7888264">(</span><span class="num" id="7888265">5</span>&nbsp;<span class="op" id="7888267">*</span>&nbsp;<span class="ident" id="7888269">time</span><span class="op" id="7888273">.</span><span class="ident" id="7888274">Second</span><span class="op" id="7888280">)</span><span class="op" id="7888281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888287">t</span><span class="op" id="7888288">.</span><span class="ident" id="7888289">Logf</span><span class="op" id="7888293">(</span><span class="string" id="7888294">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7888316">,</span>&nbsp;<span class="ident" id="7888318">s</span><span class="op" id="7888319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888324">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888332">res</span><span class="op" id="7888335">[</span><span class="string" id="7888336">&#34;OK&#34;</span><span class="op" id="7888340">]</span><span class="op" id="7888341">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888345">}</span><span class="op" id="7888346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888349">var</span>&nbsp;<span class="ident" id="7888353">outcomes</span>&nbsp;<span class="op" id="7888362">[</span><span class="op" id="7888363">]</span><span class="builtintype" id="7888364">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888372">for</span>&nbsp;<span class="ident" id="7888376">k</span><span class="op" id="7888377">,</span>&nbsp;<span class="ident" id="7888379">v</span>&nbsp;<span class="op" id="7888381">:=</span>&nbsp;<span class="keyword" id="7888384">range</span>&nbsp;<span class="ident" id="7888390">res</span>&nbsp;<span class="op" id="7888394">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888398">outcomes</span>&nbsp;<span class="op" id="7888407">=</span>&nbsp;<span class="builtinfunc" id="7888409">append</span><span class="op" id="7888415">(</span><span class="ident" id="7888416">outcomes</span><span class="op" id="7888424">,</span>&nbsp;<span class="ident" id="7888426">fmt</span><span class="op" id="7888429">.</span><span class="ident" id="7888430">Sprintf</span><span class="op" id="7888437">(</span><span class="string" id="7888438">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="7888446">,</span>&nbsp;<span class="ident" id="7888448">k</span><span class="op" id="7888449">,</span>&nbsp;<span class="ident" id="7888451">v</span><span class="op" id="7888452">)</span><span class="op" id="7888453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888459">sort</span><span class="op" id="7888463">.</span><span class="ident" id="7888464">Strings</span><span class="op" id="7888471">(</span><span class="ident" id="7888472">outcomes</span><span class="op" id="7888480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888483">got</span>&nbsp;<span class="op" id="7888487">:=</span>&nbsp;<span class="ident" id="7888490">strings</span><span class="op" id="7888497">.</span><span class="ident" id="7888498">Join</span><span class="op" id="7888502">(</span><span class="ident" id="7888503">outcomes</span><span class="op" id="7888511">,</span>&nbsp;<span class="string" id="7888513">&#34;\n&#34;</span><span class="op" id="7888517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888520">want</span>&nbsp;<span class="op" id="7888525">:=</span>&nbsp;<span class="string" id="7888528">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7888813">if</span>&nbsp;<span class="ident" id="7888816">got</span>&nbsp;<span class="op" id="7888820">!=</span>&nbsp;<span class="ident" id="7888823">want</span>&nbsp;<span class="op" id="7888828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7888832">t</span><span class="op" id="7888833">.</span><span class="ident" id="7888834">Errorf</span><span class="op" id="7888840">(</span><span class="string" id="7888841">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="7888862">,</span>&nbsp;<span class="ident" id="7888864">got</span><span class="op" id="7888867">,</span>&nbsp;<span class="ident" id="7888869">want</span><span class="op" id="7888873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7888876">}</span><br>
<span class="lineno"></span><span class="op" id="7888878">}</span>
</div>
</body>
</html>
