<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5835082">package</span>&nbsp;<span class="ident" id="5835090">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5835096">//&nbsp;SymScope&nbsp;is&nbsp;a&nbsp;stack&nbsp;of&nbsp;symbol&nbsp;tables.</span><br>
<span class="lineno"></span><span class="keyword" id="5835137">type</span>&nbsp;<span class="ident" id="5835142">symScope</span>&nbsp;<span class="keyword" id="5835151">struct</span>&nbsp;<span class="op" id="5835158">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835161">stack</span>&nbsp;<span class="op" id="5835167">[</span><span class="op" id="5835168">]</span><span class="op" id="5835169">*</span><span class="ident" id="5835170">symTabel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835180">top</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5835186">*</span><span class="ident" id="5835187">symTabel</span>&nbsp;<span class="comment" id="5835196">//&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="op" id="5835207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5835210">//&nbsp;NewSymScope&nbsp;creates&nbsp;a&nbsp;new&nbsp;symbole&nbsp;scope&nbsp;with&nbsp;one&nbsp;symbol&nbsp;table&nbsp;at&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="5835282">//&nbsp;bottom.</span><br>
<span class="lineno"></span><span class="keyword" id="5835293">func</span>&nbsp;<span class="ident" id="5835298">newSymScope</span><span class="op" id="5835309">(</span><span class="op" id="5835310">)</span>&nbsp;<span class="op" id="5835312">*</span><span class="ident" id="5835313">symScope</span>&nbsp;<span class="op" id="5835322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835325">ret</span>&nbsp;<span class="op" id="5835329">:=</span>&nbsp;<span class="builtinfunc" id="5835332">new</span><span class="op" id="5835335">(</span><span class="ident" id="5835336">symScope</span><span class="op" id="5835344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835347">ret</span><span class="op" id="5835350">.</span><span class="ident" id="5835351">Push</span><span class="op" id="5835355">(</span><span class="op" id="5835356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5835360">return</span>&nbsp;<span class="ident" id="5835367">ret</span><br>
<span class="lineno"></span><span class="op" id="5835371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5835374">//&nbsp;Push&nbsp;adds&nbsp;a&nbsp;new&nbsp;symbol&nbsp;table&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5835431">func</span>&nbsp;<span class="op" id="5835436">(</span><span class="ident" id="5835437">s</span>&nbsp;<span class="op" id="5835439">*</span><span class="ident" id="5835440">symScope</span><span class="op" id="5835448">)</span>&nbsp;<span class="ident" id="5835450">Push</span><span class="op" id="5835454">(</span><span class="op" id="5835455">)</span>&nbsp;<span class="op" id="5835457">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835460">tab</span>&nbsp;<span class="op" id="5835464">:=</span>&nbsp;<span class="ident" id="5835467">newSymTable</span><span class="op" id="5835478">(</span><span class="op" id="5835479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835482">s</span><span class="op" id="5835483">.</span><span class="ident" id="5835484">top</span>&nbsp;<span class="op" id="5835488">=</span>&nbsp;<span class="ident" id="5835490">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835495">s</span><span class="op" id="5835496">.</span><span class="ident" id="5835497">stack</span>&nbsp;<span class="op" id="5835503">=</span>&nbsp;<span class="builtinfunc" id="5835505">append</span><span class="op" id="5835511">(</span><span class="ident" id="5835512">s</span><span class="op" id="5835513">.</span><span class="ident" id="5835514">stack</span><span class="op" id="5835519">,</span>&nbsp;<span class="ident" id="5835521">tab</span><span class="op" id="5835524">)</span><br>
<span class="lineno"></span><span class="op" id="5835526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5835529">//&nbsp;Pop&nbsp;removes&nbsp;a&nbsp;symbol&nbsp;table&nbsp;from&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5835586">//&nbsp;It&nbsp;panics&nbsp;when&nbsp;the&nbsp;stack&nbsp;is&nbsp;empty&nbsp;after&nbsp;the&nbsp;pop.</span><br>
<span class="lineno"></span><span class="keyword" id="5835638">func</span>&nbsp;<span class="op" id="5835643">(</span><span class="ident" id="5835644">s</span>&nbsp;<span class="op" id="5835646">*</span><span class="ident" id="5835647">symScope</span><span class="op" id="5835655">)</span>&nbsp;<span class="ident" id="5835657">Pop</span><span class="op" id="5835660">(</span><span class="op" id="5835661">)</span>&nbsp;<span class="op" id="5835663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835666">n</span>&nbsp;<span class="op" id="5835668">:=</span>&nbsp;<span class="builtinfunc" id="5835671">len</span><span class="op" id="5835674">(</span><span class="ident" id="5835675">s</span><span class="op" id="5835676">.</span><span class="ident" id="5835677">stack</span><span class="op" id="5835682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5835685">if</span>&nbsp;<span class="ident" id="5835688">n</span>&nbsp;<span class="op" id="5835690">&lt;</span>&nbsp;<span class="num" id="5835692">2</span>&nbsp;<span class="op" id="5835694">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5835698">panic</span><span class="op" id="5835703">(</span><span class="string" id="5835704">&#34;stack&nbsp;empty&nbsp;after&nbsp;pop&#34;</span><span class="op" id="5835727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5835730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835734">s</span><span class="op" id="5835735">.</span><span class="ident" id="5835736">stack</span>&nbsp;<span class="op" id="5835742">=</span>&nbsp;<span class="ident" id="5835744">s</span><span class="op" id="5835745">.</span><span class="ident" id="5835746">stack</span><span class="op" id="5835751">[</span><span class="op" id="5835752">:</span><span class="ident" id="5835753">n</span><span class="op" id="5835754">-</span><span class="num" id="5835755">1</span><span class="op" id="5835756">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5835759">s</span><span class="op" id="5835760">.</span><span class="ident" id="5835761">top</span>&nbsp;<span class="op" id="5835765">=</span>&nbsp;<span class="ident" id="5835767">s</span><span class="op" id="5835768">.</span><span class="ident" id="5835769">stack</span><span class="op" id="5835774">[</span><span class="ident" id="5835775">n</span><span class="op" id="5835776">-</span><span class="num" id="5835777">2</span><span class="op" id="5835778">]</span><br>
<span class="lineno">35</span><span class="op" id="5835780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5835783">//&nbsp;Depth&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;scopes&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5835835">func</span>&nbsp;<span class="op" id="5835840">(</span><span class="ident" id="5835841">s</span>&nbsp;<span class="op" id="5835843">*</span><span class="ident" id="5835844">symScope</span><span class="op" id="5835852">)</span>&nbsp;<span class="ident" id="5835854">Depth</span><span class="op" id="5835859">(</span><span class="op" id="5835860">)</span>&nbsp;<span class="builtintype" id="5835862">int</span>&nbsp;<span class="op" id="5835866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5835869">return</span>&nbsp;<span class="builtinfunc" id="5835876">len</span><span class="op" id="5835879">(</span><span class="ident" id="5835880">s</span><span class="op" id="5835881">.</span><span class="ident" id="5835882">stack</span><span class="op" id="5835887">)</span><br>
<span class="lineno">40</span><span class="op" id="5835889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5835892">//&nbsp;Query&nbsp;searches&nbsp;for&nbsp;the&nbsp;top&nbsp;visible&nbsp;symbol&nbsp;with&nbsp;a&nbsp;particular&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5835961">func</span>&nbsp;<span class="op" id="5835966">(</span><span class="ident" id="5835967">s</span>&nbsp;<span class="op" id="5835969">*</span><span class="ident" id="5835970">symScope</span><span class="op" id="5835978">)</span>&nbsp;<span class="ident" id="5835980">Query</span><span class="op" id="5835985">(</span><span class="ident" id="5835986">n</span>&nbsp;<span class="builtintype" id="5835988">string</span><span class="op" id="5835994">)</span>&nbsp;<span class="op" id="5835996">*</span><span class="ident" id="5835997">symbol</span>&nbsp;<span class="op" id="5836004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5836007">d</span>&nbsp;<span class="op" id="5836009">:=</span>&nbsp;<span class="builtinfunc" id="5836012">len</span><span class="op" id="5836015">(</span><span class="ident" id="5836016">s</span><span class="op" id="5836017">.</span><span class="ident" id="5836018">stack</span><span class="op" id="5836023">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5836027">for</span>&nbsp;<span class="ident" id="5836031">i</span>&nbsp;<span class="op" id="5836033">:=</span>&nbsp;<span class="ident" id="5836036">d</span>&nbsp;<span class="op" id="5836038">-</span>&nbsp;<span class="num" id="5836040">1</span><span class="op" id="5836041">;</span>&nbsp;<span class="ident" id="5836043">i</span>&nbsp;<span class="op" id="5836045">&gt;=</span>&nbsp;<span class="num" id="5836048">0</span><span class="op" id="5836049">;</span>&nbsp;<span class="ident" id="5836051">i</span><span class="op" id="5836052">--</span>&nbsp;<span class="op" id="5836055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5836059">tab</span>&nbsp;<span class="op" id="5836063">:=</span>&nbsp;<span class="ident" id="5836066">s</span><span class="op" id="5836067">.</span><span class="ident" id="5836068">stack</span><span class="op" id="5836073">[</span><span class="ident" id="5836074">i</span><span class="op" id="5836075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5836079">ret</span>&nbsp;<span class="op" id="5836083">:=</span>&nbsp;<span class="ident" id="5836086">tab</span><span class="op" id="5836089">.</span><span class="ident" id="5836090">Query</span><span class="op" id="5836095">(</span><span class="ident" id="5836096">n</span><span class="op" id="5836097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5836101">if</span>&nbsp;<span class="ident" id="5836104">ret</span>&nbsp;<span class="op" id="5836108">!=</span>&nbsp;<span class="ident" id="5836111">nil</span>&nbsp;<span class="op" id="5836115">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5836120">return</span>&nbsp;<span class="ident" id="5836127">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5836133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5836136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5836140">return</span>&nbsp;<span class="ident" id="5836147">nil</span><br>
<span class="lineno">55</span><span class="op" id="5836151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5836154">//&nbsp;Declare&nbsp;declares&nbsp;a&nbsp;symbole&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5836222">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;on&nbsp;successful,&nbsp;and&nbsp;returns&nbsp;the&nbsp;conflict&nbsp;symbol&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5836292">//&nbsp;it&nbsp;is&nbsp;already&nbsp;declared.</span><br>
<span class="lineno">60</span><span class="keyword" id="5836319">func</span>&nbsp;<span class="op" id="5836324">(</span><span class="ident" id="5836325">s</span>&nbsp;<span class="op" id="5836327">*</span><span class="ident" id="5836328">symScope</span><span class="op" id="5836336">)</span>&nbsp;<span class="ident" id="5836338">Declare</span><span class="op" id="5836345">(</span><span class="ident" id="5836346">sym</span>&nbsp;<span class="op" id="5836350">*</span><span class="ident" id="5836351">symbol</span><span class="op" id="5836357">)</span>&nbsp;<span class="op" id="5836359">*</span><span class="ident" id="5836360">symbol</span>&nbsp;<span class="op" id="5836367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5836370">return</span>&nbsp;<span class="ident" id="5836377">s</span><span class="op" id="5836378">.</span><span class="ident" id="5836379">top</span><span class="op" id="5836382">.</span><span class="ident" id="5836383">Declare</span><span class="op" id="5836390">(</span><span class="ident" id="5836391">sym</span><span class="op" id="5836394">)</span><br>
<span class="lineno"></span><span class="op" id="5836396">}</span>
</div>
</body>
</html>
