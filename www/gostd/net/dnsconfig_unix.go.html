<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html" class="current">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3108493">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3108548">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3108602">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3108653">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3108718">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3108767">package</span>&nbsp;<span class="ident" id="3108775">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3108780">type</span>&nbsp;<span class="ident" id="3108785">dnsConfig</span>&nbsp;<span class="keyword" id="3108795">struct</span>&nbsp;<span class="op" id="3108802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3108805">servers</span>&nbsp;&nbsp;<span class="op" id="3108814">[</span><span class="op" id="3108815">]</span><span class="builtintype" id="3108816">string</span>&nbsp;<span class="comment" id="3108823">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3108842">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3108851">[</span><span class="op" id="3108852">]</span><span class="builtintype" id="3108853">string</span>&nbsp;<span class="comment" id="3108860">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3108897">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3108906">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108915">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3108969">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="3108978">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108987">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109026">attempts</span>&nbsp;<span class="builtintype" id="3109035">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3109044">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109088">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3109097">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3109106">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="3109135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3109138">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3109180">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3109242">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="3109296">func</span>&nbsp;<span class="ident" id="3109301">dnsReadConfig</span><span class="op" id="3109314">(</span><span class="ident" id="3109315">filename</span>&nbsp;<span class="builtintype" id="3109324">string</span><span class="op" id="3109330">)</span>&nbsp;<span class="op" id="3109332">(</span><span class="op" id="3109333">*</span><span class="ident" id="3109334">dnsConfig</span><span class="op" id="3109343">,</span>&nbsp;<span class="builtintype" id="3109345">error</span><span class="op" id="3109350">)</span>&nbsp;<span class="op" id="3109352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109355">file</span><span class="op" id="3109359">,</span>&nbsp;<span class="ident" id="3109361">err</span>&nbsp;<span class="op" id="3109365">:=</span>&nbsp;<span class="ident" id="3109368">open</span><span class="op" id="3109372">(</span><span class="ident" id="3109373">filename</span><span class="op" id="3109381">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109384">if</span>&nbsp;<span class="ident" id="3109387">err</span>&nbsp;<span class="op" id="3109391">!=</span>&nbsp;<span class="ident" id="3109394">nil</span>&nbsp;<span class="op" id="3109398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109402">return</span>&nbsp;<span class="ident" id="3109409">nil</span><span class="op" id="3109412">,</span>&nbsp;<span class="op" id="3109414">&amp;</span><span class="ident" id="3109415">DNSConfigError</span><span class="op" id="3109429">{</span><span class="ident" id="3109430">err</span><span class="op" id="3109433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3109436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109439">defer</span>&nbsp;<span class="ident" id="3109445">file</span><span class="op" id="3109449">.</span><span class="builtinfunc" id="3109450">close</span><span class="op" id="3109455">(</span><span class="op" id="3109456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109459">conf</span>&nbsp;<span class="op" id="3109464">:=</span>&nbsp;<span class="op" id="3109467">&amp;</span><span class="ident" id="3109468">dnsConfig</span><span class="op" id="3109477">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109481">ndots</span><span class="op" id="3109486">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3109491">1</span><span class="op" id="3109492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109496">timeout</span><span class="op" id="3109503">:</span>&nbsp;&nbsp;<span class="num" id="3109506">5</span><span class="op" id="3109507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109511">attempts</span><span class="op" id="3109519">:</span>&nbsp;<span class="num" id="3109521">2</span><span class="op" id="3109522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3109525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109528">for</span>&nbsp;<span class="ident" id="3109532">line</span><span class="op" id="3109536">,</span>&nbsp;<span class="ident" id="3109538">ok</span>&nbsp;<span class="op" id="3109541">:=</span>&nbsp;<span class="ident" id="3109544">file</span><span class="op" id="3109548">.</span><span class="ident" id="3109549">readLine</span><span class="op" id="3109557">(</span><span class="op" id="3109558">)</span><span class="op" id="3109559">;</span>&nbsp;<span class="ident" id="3109561">ok</span><span class="op" id="3109563">;</span>&nbsp;<span class="ident" id="3109565">line</span><span class="op" id="3109569">,</span>&nbsp;<span class="ident" id="3109571">ok</span>&nbsp;<span class="op" id="3109574">=</span>&nbsp;<span class="ident" id="3109576">file</span><span class="op" id="3109580">.</span><span class="ident" id="3109581">readLine</span><span class="op" id="3109589">(</span><span class="op" id="3109590">)</span>&nbsp;<span class="op" id="3109592">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109596">f</span>&nbsp;<span class="op" id="3109598">:=</span>&nbsp;<span class="ident" id="3109601">getFields</span><span class="op" id="3109610">(</span><span class="ident" id="3109611">line</span><span class="op" id="3109615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109619">if</span>&nbsp;<span class="builtinfunc" id="3109622">len</span><span class="op" id="3109625">(</span><span class="ident" id="3109626">f</span><span class="op" id="3109627">)</span>&nbsp;<span class="op" id="3109629">&lt;</span>&nbsp;<span class="num" id="3109631">1</span>&nbsp;<span class="op" id="3109633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109638">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3109649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109653">switch</span>&nbsp;<span class="ident" id="3109660">f</span><span class="op" id="3109661">[</span><span class="num" id="3109662">0</span><span class="op" id="3109663">]</span>&nbsp;<span class="op" id="3109665">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109669">case</span>&nbsp;<span class="string" id="3109674">&#34;nameserver&#34;</span><span class="op" id="3109686">:</span>&nbsp;<span class="comment" id="3109688">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109714">if</span>&nbsp;<span class="builtinfunc" id="3109717">len</span><span class="op" id="3109720">(</span><span class="ident" id="3109721">f</span><span class="op" id="3109722">)</span>&nbsp;<span class="op" id="3109724">&gt;</span>&nbsp;<span class="num" id="3109726">1</span>&nbsp;<span class="op" id="3109728">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3109731">len</span><span class="op" id="3109734">(</span><span class="ident" id="3109735">conf</span><span class="op" id="3109739">.</span><span class="ident" id="3109740">servers</span><span class="op" id="3109747">)</span>&nbsp;<span class="op" id="3109749">&lt;</span>&nbsp;<span class="num" id="3109751">3</span>&nbsp;<span class="op" id="3109753">{</span>&nbsp;<span class="comment" id="3109755">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3109792">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3109840">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3109890">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3109912">if</span>&nbsp;<span class="ident" id="3109915">parseIPv4</span><span class="op" id="3109924">(</span><span class="ident" id="3109925">f</span><span class="op" id="3109926">[</span><span class="num" id="3109927">1</span><span class="op" id="3109928">]</span><span class="op" id="3109929">)</span>&nbsp;<span class="op" id="3109931">!=</span>&nbsp;<span class="ident" id="3109934">nil</span>&nbsp;<span class="op" id="3109938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3109945">conf</span><span class="op" id="3109949">.</span><span class="ident" id="3109950">servers</span>&nbsp;<span class="op" id="3109958">=</span>&nbsp;<span class="builtinfunc" id="3109960">append</span><span class="op" id="3109966">(</span><span class="ident" id="3109967">conf</span><span class="op" id="3109971">.</span><span class="ident" id="3109972">servers</span><span class="op" id="3109979">,</span>&nbsp;<span class="ident" id="3109981">f</span><span class="op" id="3109982">[</span><span class="num" id="3109983">1</span><span class="op" id="3109984">]</span><span class="op" id="3109985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3109991">}</span>&nbsp;<span class="keyword" id="3109993">else</span>&nbsp;<span class="keyword" id="3109998">if</span>&nbsp;<span class="ident" id="3110001">ip</span><span class="op" id="3110003">,</span>&nbsp;<span class="ident" id="3110005">_</span>&nbsp;<span class="op" id="3110007">:=</span>&nbsp;<span class="ident" id="3110010">parseIPv6</span><span class="op" id="3110019">(</span><span class="ident" id="3110020">f</span><span class="op" id="3110021">[</span><span class="num" id="3110022">1</span><span class="op" id="3110023">]</span><span class="op" id="3110024">,</span>&nbsp;<span class="builtintype" id="3110026">true</span><span class="op" id="3110030">)</span><span class="op" id="3110031">;</span>&nbsp;<span class="ident" id="3110033">ip</span>&nbsp;<span class="op" id="3110036">!=</span>&nbsp;<span class="ident" id="3110039">nil</span>&nbsp;<span class="op" id="3110043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110050">conf</span><span class="op" id="3110054">.</span><span class="ident" id="3110055">servers</span>&nbsp;<span class="op" id="3110063">=</span>&nbsp;<span class="builtinfunc" id="3110065">append</span><span class="op" id="3110071">(</span><span class="ident" id="3110072">conf</span><span class="op" id="3110076">.</span><span class="ident" id="3110077">servers</span><span class="op" id="3110084">,</span>&nbsp;<span class="ident" id="3110086">f</span><span class="op" id="3110087">[</span><span class="num" id="3110088">1</span><span class="op" id="3110089">]</span><span class="op" id="3110090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110096">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110106">case</span>&nbsp;<span class="string" id="3110111">&#34;domain&#34;</span><span class="op" id="3110119">:</span>&nbsp;<span class="comment" id="3110121">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110163">if</span>&nbsp;<span class="builtinfunc" id="3110166">len</span><span class="op" id="3110169">(</span><span class="ident" id="3110170">f</span><span class="op" id="3110171">)</span>&nbsp;<span class="op" id="3110173">&gt;</span>&nbsp;<span class="num" id="3110175">1</span>&nbsp;<span class="op" id="3110177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110183">conf</span><span class="op" id="3110187">.</span><span class="ident" id="3110188">search</span>&nbsp;<span class="op" id="3110195">=</span>&nbsp;<span class="op" id="3110197">[</span><span class="op" id="3110198">]</span><span class="builtintype" id="3110199">string</span><span class="op" id="3110205">{</span><span class="ident" id="3110206">f</span><span class="op" id="3110207">[</span><span class="num" id="3110208">1</span><span class="op" id="3110209">]</span><span class="op" id="3110210">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110220">case</span>&nbsp;<span class="string" id="3110225">&#34;search&#34;</span><span class="op" id="3110233">:</span>&nbsp;<span class="comment" id="3110235">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110274">conf</span><span class="op" id="3110278">.</span><span class="ident" id="3110279">search</span>&nbsp;<span class="op" id="3110286">=</span>&nbsp;<span class="builtinfunc" id="3110288">make</span><span class="op" id="3110292">(</span><span class="op" id="3110293">[</span><span class="op" id="3110294">]</span><span class="builtintype" id="3110295">string</span><span class="op" id="3110301">,</span>&nbsp;<span class="builtinfunc" id="3110303">len</span><span class="op" id="3110306">(</span><span class="ident" id="3110307">f</span><span class="op" id="3110308">)</span><span class="op" id="3110309">-</span><span class="num" id="3110310">1</span><span class="op" id="3110311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110316">for</span>&nbsp;<span class="ident" id="3110320">i</span>&nbsp;<span class="op" id="3110322">:=</span>&nbsp;<span class="num" id="3110325">0</span><span class="op" id="3110326">;</span>&nbsp;<span class="ident" id="3110328">i</span>&nbsp;<span class="op" id="3110330">&lt;</span>&nbsp;<span class="builtinfunc" id="3110332">len</span><span class="op" id="3110335">(</span><span class="ident" id="3110336">conf</span><span class="op" id="3110340">.</span><span class="ident" id="3110341">search</span><span class="op" id="3110347">)</span><span class="op" id="3110348">;</span>&nbsp;<span class="ident" id="3110350">i</span><span class="op" id="3110351">++</span>&nbsp;<span class="op" id="3110354">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110360">conf</span><span class="op" id="3110364">.</span><span class="ident" id="3110365">search</span><span class="op" id="3110371">[</span><span class="ident" id="3110372">i</span><span class="op" id="3110373">]</span>&nbsp;<span class="op" id="3110375">=</span>&nbsp;<span class="ident" id="3110377">f</span><span class="op" id="3110378">[</span><span class="ident" id="3110379">i</span><span class="op" id="3110380">+</span><span class="num" id="3110381">1</span><span class="op" id="3110382">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110392">case</span>&nbsp;<span class="string" id="3110397">&#34;options&#34;</span><span class="op" id="3110406">:</span>&nbsp;<span class="comment" id="3110408">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110428">for</span>&nbsp;<span class="ident" id="3110432">i</span>&nbsp;<span class="op" id="3110434">:=</span>&nbsp;<span class="num" id="3110437">1</span><span class="op" id="3110438">;</span>&nbsp;<span class="ident" id="3110440">i</span>&nbsp;<span class="op" id="3110442">&lt;</span>&nbsp;<span class="builtinfunc" id="3110444">len</span><span class="op" id="3110447">(</span><span class="ident" id="3110448">f</span><span class="op" id="3110449">)</span><span class="op" id="3110450">;</span>&nbsp;<span class="ident" id="3110452">i</span><span class="op" id="3110453">++</span>&nbsp;<span class="op" id="3110456">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110462">s</span>&nbsp;<span class="op" id="3110464">:=</span>&nbsp;<span class="ident" id="3110467">f</span><span class="op" id="3110468">[</span><span class="ident" id="3110469">i</span><span class="op" id="3110470">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110476">switch</span>&nbsp;<span class="op" id="3110483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110489">case</span>&nbsp;<span class="ident" id="3110494">hasPrefix</span><span class="op" id="3110503">(</span><span class="ident" id="3110504">s</span><span class="op" id="3110505">,</span>&nbsp;<span class="string" id="3110507">&#34;ndots:&#34;</span><span class="op" id="3110515">)</span><span class="op" id="3110516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110523">n</span><span class="op" id="3110524">,</span>&nbsp;<span class="ident" id="3110526">_</span><span class="op" id="3110527">,</span>&nbsp;<span class="ident" id="3110529">_</span>&nbsp;<span class="op" id="3110531">:=</span>&nbsp;<span class="ident" id="3110534">dtoi</span><span class="op" id="3110538">(</span><span class="ident" id="3110539">s</span><span class="op" id="3110540">,</span>&nbsp;<span class="num" id="3110542">6</span><span class="op" id="3110543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110550">if</span>&nbsp;<span class="ident" id="3110553">n</span>&nbsp;<span class="op" id="3110555">&lt;</span>&nbsp;<span class="num" id="3110557">1</span>&nbsp;<span class="op" id="3110559">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110567">n</span>&nbsp;<span class="op" id="3110569">=</span>&nbsp;<span class="num" id="3110571">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110585">conf</span><span class="op" id="3110589">.</span><span class="ident" id="3110590">ndots</span>&nbsp;<span class="op" id="3110596">=</span>&nbsp;<span class="ident" id="3110598">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110604">case</span>&nbsp;<span class="ident" id="3110609">hasPrefix</span><span class="op" id="3110618">(</span><span class="ident" id="3110619">s</span><span class="op" id="3110620">,</span>&nbsp;<span class="string" id="3110622">&#34;timeout:&#34;</span><span class="op" id="3110632">)</span><span class="op" id="3110633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110640">n</span><span class="op" id="3110641">,</span>&nbsp;<span class="ident" id="3110643">_</span><span class="op" id="3110644">,</span>&nbsp;<span class="ident" id="3110646">_</span>&nbsp;<span class="op" id="3110648">:=</span>&nbsp;<span class="ident" id="3110651">dtoi</span><span class="op" id="3110655">(</span><span class="ident" id="3110656">s</span><span class="op" id="3110657">,</span>&nbsp;<span class="num" id="3110659">8</span><span class="op" id="3110660">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110667">if</span>&nbsp;<span class="ident" id="3110670">n</span>&nbsp;<span class="op" id="3110672">&lt;</span>&nbsp;<span class="num" id="3110674">1</span>&nbsp;<span class="op" id="3110676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110684">n</span>&nbsp;<span class="op" id="3110686">=</span>&nbsp;<span class="num" id="3110688">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110702">conf</span><span class="op" id="3110706">.</span><span class="ident" id="3110707">timeout</span>&nbsp;<span class="op" id="3110715">=</span>&nbsp;<span class="ident" id="3110717">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110723">case</span>&nbsp;<span class="ident" id="3110728">hasPrefix</span><span class="op" id="3110737">(</span><span class="ident" id="3110738">s</span><span class="op" id="3110739">,</span>&nbsp;<span class="string" id="3110741">&#34;attempts:&#34;</span><span class="op" id="3110752">)</span><span class="op" id="3110753">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110760">n</span><span class="op" id="3110761">,</span>&nbsp;<span class="ident" id="3110763">_</span><span class="op" id="3110764">,</span>&nbsp;<span class="ident" id="3110766">_</span>&nbsp;<span class="op" id="3110768">:=</span>&nbsp;<span class="ident" id="3110771">dtoi</span><span class="op" id="3110775">(</span><span class="ident" id="3110776">s</span><span class="op" id="3110777">,</span>&nbsp;<span class="num" id="3110779">9</span><span class="op" id="3110780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110787">if</span>&nbsp;<span class="ident" id="3110790">n</span>&nbsp;<span class="op" id="3110792">&lt;</span>&nbsp;<span class="num" id="3110794">1</span>&nbsp;<span class="op" id="3110796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110804">n</span>&nbsp;<span class="op" id="3110806">=</span>&nbsp;<span class="num" id="3110808">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110822">conf</span><span class="op" id="3110826">.</span><span class="ident" id="3110827">attempts</span>&nbsp;<span class="op" id="3110836">=</span>&nbsp;<span class="ident" id="3110838">n</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110844">case</span>&nbsp;<span class="ident" id="3110849">s</span>&nbsp;<span class="op" id="3110851">==</span>&nbsp;<span class="string" id="3110854">&#34;rotate&#34;</span><span class="op" id="3110862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3110869">conf</span><span class="op" id="3110873">.</span><span class="ident" id="3110874">rotate</span>&nbsp;<span class="op" id="3110881">=</span>&nbsp;<span class="builtintype" id="3110883">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110901">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3110904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110907">return</span>&nbsp;<span class="ident" id="3110914">conf</span><span class="op" id="3110918">,</span>&nbsp;<span class="ident" id="3110920">nil</span><br>
<span class="lineno"></span><span class="op" id="3110924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3110927">func</span>&nbsp;<span class="ident" id="3110932">hasPrefix</span><span class="op" id="3110941">(</span><span class="ident" id="3110942">s</span><span class="op" id="3110943">,</span>&nbsp;<span class="ident" id="3110945">prefix</span>&nbsp;<span class="builtintype" id="3110952">string</span><span class="op" id="3110958">)</span>&nbsp;<span class="builtintype" id="3110960">bool</span>&nbsp;<span class="op" id="3110965">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3110968">return</span>&nbsp;<span class="builtinfunc" id="3110975">len</span><span class="op" id="3110978">(</span><span class="ident" id="3110979">s</span><span class="op" id="3110980">)</span>&nbsp;<span class="op" id="3110982">&gt;=</span>&nbsp;<span class="builtinfunc" id="3110985">len</span><span class="op" id="3110988">(</span><span class="ident" id="3110989">prefix</span><span class="op" id="3110995">)</span>&nbsp;<span class="op" id="3110997">&amp;&amp;</span>&nbsp;<span class="ident" id="3111000">s</span><span class="op" id="3111001">[</span><span class="op" id="3111002">:</span><span class="builtinfunc" id="3111003">len</span><span class="op" id="3111006">(</span><span class="ident" id="3111007">prefix</span><span class="op" id="3111013">)</span><span class="op" id="3111014">]</span>&nbsp;<span class="op" id="3111016">==</span>&nbsp;<span class="ident" id="3111019">prefix</span><br>
<span class="lineno"></span><span class="op" id="3111026">}</span>
</div>
</body>
</html>
