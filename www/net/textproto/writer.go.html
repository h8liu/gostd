<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3650034">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3650090">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3650144">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3650195">package</span>&nbsp;<span class="ident" id="3650203">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3650214">import</span>&nbsp;<span class="op" id="3650221">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3650224">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3650233">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3650240">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3650245">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650248">//&nbsp;A&nbsp;Writer&nbsp;implements&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;writing</span><br>
<span class="lineno"></span><span class="comment" id="3650303">//&nbsp;requests&nbsp;or&nbsp;responses&nbsp;to&nbsp;a&nbsp;text&nbsp;protocol&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">15</span><span class="keyword" id="3650367">type</span>&nbsp;<span class="ident" id="3650372">Writer</span>&nbsp;<span class="keyword" id="3650379">struct</span>&nbsp;<span class="op" id="3650386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650389">W</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3650393">*</span><span class="ident" id="3650394"><a href="/net/textproto/writer.go.html#3650224">bufio</a></span><span class="op" id="3650399">.</span><span class="ident" id="3650400">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650408">dot</span>&nbsp;<span class="op" id="3650412">*</span><span class="ident" id="3650413"><a href="/net/textproto/writer.go.html#3651443">dotWriter</a></span><br>
<span class="lineno"></span><span class="op" id="3650423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3650426">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="3650474">func</span>&nbsp;<span class="ident" id="3650479">NewWriter</span><span class="op" id="3650488">(</span><span class="ident" id="3650489">w</span>&nbsp;<span class="op" id="3650491">*</span><span class="ident" id="3650492"><a href="/net/textproto/writer.go.html#3650224">bufio</a></span><span class="op" id="3650497">.</span><span class="ident" id="3650498">Writer</span><span class="op" id="3650504">)</span>&nbsp;<span class="op" id="3650506">*</span><span class="ident" id="3650507"><a href="/net/textproto/writer.go.html#3650372">Writer</a></span>&nbsp;<span class="op" id="3650514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650517">return</span>&nbsp;<span class="op" id="3650524">&amp;</span><span class="ident" id="3650525"><a href="/net/textproto/writer.go.html#3650372">Writer</a></span><span class="op" id="3650531">{</span><span class="ident" id="3650532">W</span><span class="op" id="3650533">:</span>&nbsp;<span class="ident" id="3650535"><a href="/net/textproto/writer.go.html#3650489">w</a></span><span class="op" id="3650536">}</span><br>
<span class="lineno"></span><span class="op" id="3650538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3650541">var</span>&nbsp;<span class="ident" id="3650545">crnl</span>&nbsp;<span class="op" id="3650550">=</span>&nbsp;<span class="op" id="3650552">[</span><span class="op" id="3650553">]</span><span class="builtintype" id="3650554">byte</span><span class="op" id="3650558">{</span><span class="string" id="3650559">&#39;\r&#39;</span><span class="op" id="3650563">,</span>&nbsp;<span class="string" id="3650565">&#39;\n&#39;</span><span class="op" id="3650569">}</span><br>
<span class="lineno"></span><span class="keyword" id="3650571">var</span>&nbsp;<span class="ident" id="3650575">dotcrnl</span>&nbsp;<span class="op" id="3650583">=</span>&nbsp;<span class="op" id="3650585">[</span><span class="op" id="3650586">]</span><span class="builtintype" id="3650587">byte</span><span class="op" id="3650591">{</span><span class="string" id="3650592">&#39;.&#39;</span><span class="op" id="3650595">,</span>&nbsp;<span class="string" id="3650597">&#39;\r&#39;</span><span class="op" id="3650601">,</span>&nbsp;<span class="string" id="3650603">&#39;\n&#39;</span><span class="op" id="3650607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650610">//&nbsp;PrintfLine&nbsp;writes&nbsp;the&nbsp;formatted&nbsp;output&nbsp;followed&nbsp;by&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="keyword" id="3650670">func</span>&nbsp;<span class="op" id="3650675">(</span><span class="ident" id="3650676">w</span>&nbsp;<span class="op" id="3650678">*</span><span class="ident" id="3650679"><a href="/net/textproto/writer.go.html#3650372">Writer</a></span><span class="op" id="3650685">)</span>&nbsp;<span class="ident" id="3650687">PrintfLine</span><span class="op" id="3650697">(</span><span class="ident" id="3650698">format</span>&nbsp;<span class="builtintype" id="3650705">string</span><span class="op" id="3650711">,</span>&nbsp;<span class="ident" id="3650713">args</span>&nbsp;<span class="op" id="3650718">...</span><span class="keyword" id="3650721">interface</span><span class="op" id="3650730">{</span><span class="op" id="3650731">}</span><span class="op" id="3650732">)</span>&nbsp;<span class="builtintype" id="3650734">error</span>&nbsp;<span class="op" id="3650740">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650743"><a href="/net/textproto/writer.go.html#3650676">w</a></span><span class="op" id="3650744">.</span><span class="ident" id="3650745">closeDot</span><span class="op" id="3650753">(</span><span class="op" id="3650754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650757"><a href="/net/textproto/writer.go.html#3650233">fmt</a></span><span class="op" id="3650760">.</span><span class="ident" id="3650761">Fprintf</span><span class="op" id="3650768">(</span><span class="ident" id="3650769"><a href="/net/textproto/writer.go.html#3650676">w</a></span><span class="op" id="3650770">.</span><span class="ident" id="3650771">W</span><span class="op" id="3650772">,</span>&nbsp;<span class="ident" id="3650774"><a href="/net/textproto/writer.go.html#3650698">format</a></span><span class="op" id="3650780">,</span>&nbsp;<span class="ident" id="3650782"><a href="/net/textproto/writer.go.html#3650713">args</a></span><span class="op" id="3650786">...</span><span class="op" id="3650789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3650792"><a href="/net/textproto/writer.go.html#3650676">w</a></span><span class="op" id="3650793">.</span><span class="ident" id="3650794">W</span><span class="op" id="3650795">.</span><span class="ident" id="3650796">Write</span><span class="op" id="3650801">(</span><span class="ident" id="3650802"><a href="/net/textproto/writer.go.html#3650545">crnl</a></span><span class="op" id="3650806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3650809">return</span>&nbsp;<span class="ident" id="3650816"><a href="/net/textproto/writer.go.html#3650676">w</a></span><span class="op" id="3650817">.</span><span class="ident" id="3650818">W</span><span class="op" id="3650819">.</span><span class="ident" id="3650820">Flush</span><span class="op" id="3650825">(</span><span class="op" id="3650826">)</span><br>
<span class="lineno"></span><span class="op" id="3650828">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3650831">//&nbsp;DotWriter&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;a&nbsp;dot-encoding&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3650908">//&nbsp;It&nbsp;takes&nbsp;care&nbsp;of&nbsp;inserting&nbsp;leading&nbsp;dots&nbsp;when&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3650967">//&nbsp;translating&nbsp;line-ending&nbsp;\n&nbsp;into&nbsp;\r\n,&nbsp;and&nbsp;adding&nbsp;the&nbsp;final&nbsp;.\r\n&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="3651040">//&nbsp;when&nbsp;the&nbsp;DotWriter&nbsp;is&nbsp;closed.&nbsp;&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="3651102">//&nbsp;DotWriter&nbsp;before&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;a&nbsp;method&nbsp;on&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3651154">//</span><br>
<span class="lineno"></span><span class="comment" id="3651157">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Reader&#39;s&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="3651244">func</span>&nbsp;<span class="op" id="3651249">(</span><span class="ident" id="3651250">w</span>&nbsp;<span class="op" id="3651252">*</span><span class="ident" id="3651253"><a href="/net/textproto/writer.go.html#3650372">Writer</a></span><span class="op" id="3651259">)</span>&nbsp;<span class="ident" id="3651261">DotWriter</span><span class="op" id="3651270">(</span><span class="op" id="3651271">)</span>&nbsp;<span class="ident" id="3651273"><a href="/net/textproto/writer.go.html#3650240">io</a></span><span class="op" id="3651275">.</span><span class="ident" id="3651276">WriteCloser</span>&nbsp;<span class="op" id="3651288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651291"><a href="/net/textproto/writer.go.html#3651250">w</a></span><span class="op" id="3651292">.</span><span class="ident" id="3651293">closeDot</span><span class="op" id="3651301">(</span><span class="op" id="3651302">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651305"><a href="/net/textproto/writer.go.html#3651250">w</a></span><span class="op" id="3651306">.</span><span class="ident" id="3651307">dot</span>&nbsp;<span class="op" id="3651311">=</span>&nbsp;<span class="op" id="3651313">&amp;</span><span class="ident" id="3651314"><a href="/net/textproto/writer.go.html#3651443">dotWriter</a></span><span class="op" id="3651323">{</span><span class="ident" id="3651324">w</span><span class="op" id="3651325">:</span>&nbsp;<span class="ident" id="3651327"><a href="/net/textproto/writer.go.html#3651250">w</a></span><span class="op" id="3651328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651331">return</span>&nbsp;<span class="ident" id="3651338"><a href="/net/textproto/writer.go.html#3651250">w</a></span><span class="op" id="3651339">.</span><span class="ident" id="3651340">dot</span><br>
<span class="lineno"></span><span class="op" id="3651344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3651347">func</span>&nbsp;<span class="op" id="3651352">(</span><span class="ident" id="3651353">w</span>&nbsp;<span class="op" id="3651355">*</span><span class="ident" id="3651356"><a href="/net/textproto/writer.go.html#3650372">Writer</a></span><span class="op" id="3651362">)</span>&nbsp;<span class="ident" id="3651364">closeDot</span><span class="op" id="3651372">(</span><span class="op" id="3651373">)</span>&nbsp;<span class="op" id="3651375">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651378">if</span>&nbsp;<span class="ident" id="3651381"><a href="/net/textproto/writer.go.html#3651353">w</a></span><span class="op" id="3651382">.</span><span class="ident" id="3651383">dot</span>&nbsp;<span class="op" id="3651387">!=</span>&nbsp;<span class="ident" id="3651390">nil</span>&nbsp;<span class="op" id="3651394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651398"><a href="/net/textproto/writer.go.html#3651353">w</a></span><span class="op" id="3651399">.</span><span class="ident" id="3651400">dot</span><span class="op" id="3651403">.</span><span class="ident" id="3651404">Close</span><span class="op" id="3651409">(</span><span class="op" id="3651410">)</span>&nbsp;<span class="comment" id="3651412">//&nbsp;sets&nbsp;w.dot&nbsp;=&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651433">}</span><br>
<span class="lineno"></span><span class="op" id="3651435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3651438">type</span>&nbsp;<span class="ident" id="3651443">dotWriter</span>&nbsp;<span class="keyword" id="3651453">struct</span>&nbsp;<span class="op" id="3651460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651463">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651469">*</span><span class="ident" id="3651470"><a href="/net/textproto/writer.go.html#3650372">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651478">state</span>&nbsp;<span class="builtintype" id="3651484">int</span><br>
<span class="lineno"></span><span class="op" id="3651488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3651491">const</span>&nbsp;<span class="op" id="3651497">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651500">wstateBeginLine</span>&nbsp;<span class="op" id="3651516">=</span>&nbsp;<span class="ident" id="3651518">iota</span>&nbsp;<span class="comment" id="3651523">//&nbsp;beginning&nbsp;of&nbsp;line;&nbsp;initial&nbsp;state;&nbsp;must&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651574">wstateCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651597">//&nbsp;wrote&nbsp;\r&nbsp;(possibly&nbsp;at&nbsp;end&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651636">wstateData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651659">//&nbsp;writing&nbsp;data&nbsp;in&nbsp;middle&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span><span class="op" id="3651693">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3651696">func</span>&nbsp;<span class="op" id="3651701">(</span><span class="ident" id="3651702">d</span>&nbsp;<span class="op" id="3651704">*</span><span class="ident" id="3651705"><a href="/net/textproto/writer.go.html#3651443">dotWriter</a></span><span class="op" id="3651714">)</span>&nbsp;<span class="ident" id="3651716">Write</span><span class="op" id="3651721">(</span><span class="ident" id="3651722">b</span>&nbsp;<span class="op" id="3651724">[</span><span class="op" id="3651725">]</span><span class="builtintype" id="3651726">byte</span><span class="op" id="3651730">)</span>&nbsp;<span class="op" id="3651732">(</span><span class="ident" id="3651733">n</span>&nbsp;<span class="builtintype" id="3651735">int</span><span class="op" id="3651738">,</span>&nbsp;<span class="ident" id="3651740">err</span>&nbsp;<span class="builtintype" id="3651744">error</span><span class="op" id="3651749">)</span>&nbsp;<span class="op" id="3651751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651754">bw</span>&nbsp;<span class="op" id="3651757">:=</span>&nbsp;<span class="ident" id="3651760"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3651761">.</span><span class="ident" id="3651762">w</span><span class="op" id="3651763">.</span><span class="ident" id="3651764">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651767">for</span>&nbsp;<span class="ident" id="3651771"><a href="/net/textproto/writer.go.html#3651733">n</a></span>&nbsp;<span class="op" id="3651773">&lt;</span>&nbsp;<span class="builtinfunc" id="3651775">len</span><span class="op" id="3651778">(</span><span class="ident" id="3651779"><a href="/net/textproto/writer.go.html#3651722">b</a></span><span class="op" id="3651780">)</span>&nbsp;<span class="op" id="3651782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651786">c</span>&nbsp;<span class="op" id="3651788">:=</span>&nbsp;<span class="ident" id="3651791"><a href="/net/textproto/writer.go.html#3651722">b</a></span><span class="op" id="3651792">[</span><span class="ident" id="3651793"><a href="/net/textproto/writer.go.html#3651733">n</a></span><span class="op" id="3651794">]</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651798">switch</span>&nbsp;<span class="ident" id="3651805"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3651806">.</span><span class="ident" id="3651807">state</span>&nbsp;<span class="op" id="3651813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651817">case</span>&nbsp;<span class="ident" id="3651822"><a href="/net/textproto/writer.go.html#3651500">wstateBeginLine</a></span><span class="op" id="3651837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651842"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3651843">.</span><span class="ident" id="3651844">state</span>&nbsp;<span class="op" id="3651850">=</span>&nbsp;<span class="ident" id="3651852"><a href="/net/textproto/writer.go.html#3651636">wstateData</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651866">if</span>&nbsp;<span class="ident" id="3651869"><a href="/net/textproto/writer.go.html#3651786">c</a></span>&nbsp;<span class="op" id="3651871">==</span>&nbsp;<span class="string" id="3651874">&#39;.&#39;</span>&nbsp;<span class="op" id="3651878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3651884">//&nbsp;escape&nbsp;leading&nbsp;dot</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651910"><a href="/net/textproto/writer.go.html#3651754">bw</a></span><span class="op" id="3651912">.</span><span class="ident" id="3651913">WriteByte</span><span class="op" id="3651922">(</span><span class="string" id="3651923">&#39;.&#39;</span><span class="op" id="3651926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3651931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651936">fallthrough</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651951">case</span>&nbsp;<span class="ident" id="3651956"><a href="/net/textproto/writer.go.html#3651636">wstateData</a></span><span class="op" id="3651966">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3651971">if</span>&nbsp;<span class="ident" id="3651974"><a href="/net/textproto/writer.go.html#3651786">c</a></span>&nbsp;<span class="op" id="3651976">==</span>&nbsp;<span class="string" id="3651979">&#39;\r&#39;</span>&nbsp;<span class="op" id="3651984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3651990"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3651991">.</span><span class="ident" id="3651992">state</span>&nbsp;<span class="op" id="3651998">=</span>&nbsp;<span class="ident" id="3652000"><a href="/net/textproto/writer.go.html#3651574">wstateCR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652017">if</span>&nbsp;<span class="ident" id="3652020"><a href="/net/textproto/writer.go.html#3651786">c</a></span>&nbsp;<span class="op" id="3652022">==</span>&nbsp;<span class="string" id="3652025">&#39;\n&#39;</span>&nbsp;<span class="op" id="3652030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652036"><a href="/net/textproto/writer.go.html#3651754">bw</a></span><span class="op" id="3652038">.</span><span class="ident" id="3652039">WriteByte</span><span class="op" id="3652048">(</span><span class="string" id="3652049">&#39;\r&#39;</span><span class="op" id="3652053">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652059"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3652060">.</span><span class="ident" id="3652061">state</span>&nbsp;<span class="op" id="3652067">=</span>&nbsp;<span class="ident" id="3652069"><a href="/net/textproto/writer.go.html#3651500">wstateBeginLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652093">case</span>&nbsp;<span class="ident" id="3652098"><a href="/net/textproto/writer.go.html#3651574">wstateCR</a></span><span class="op" id="3652106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652111"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3652112">.</span><span class="ident" id="3652113">state</span>&nbsp;<span class="op" id="3652119">=</span>&nbsp;<span class="ident" id="3652121"><a href="/net/textproto/writer.go.html#3651636">wstateData</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652135">if</span>&nbsp;<span class="ident" id="3652138"><a href="/net/textproto/writer.go.html#3651786">c</a></span>&nbsp;<span class="op" id="3652140">==</span>&nbsp;<span class="string" id="3652143">&#39;\n&#39;</span>&nbsp;<span class="op" id="3652148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652154"><a href="/net/textproto/writer.go.html#3651702">d</a></span><span class="op" id="3652155">.</span><span class="ident" id="3652156">state</span>&nbsp;<span class="op" id="3652162">=</span>&nbsp;<span class="ident" id="3652164"><a href="/net/textproto/writer.go.html#3651500">wstateBeginLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652191">if</span>&nbsp;<span class="ident" id="3652194"><a href="/net/textproto/writer.go.html#3651740">err</a></span>&nbsp;<span class="op" id="3652198">=</span>&nbsp;<span class="ident" id="3652200"><a href="/net/textproto/writer.go.html#3651754">bw</a></span><span class="op" id="3652202">.</span><span class="ident" id="3652203">WriteByte</span><span class="op" id="3652212">(</span><span class="ident" id="3652213"><a href="/net/textproto/writer.go.html#3651786">c</a></span><span class="op" id="3652214">)</span><span class="op" id="3652215">;</span>&nbsp;<span class="ident" id="3652217"><a href="/net/textproto/writer.go.html#3651740">err</a></span>&nbsp;<span class="op" id="3652221">!=</span>&nbsp;<span class="ident" id="3652224">nil</span>&nbsp;<span class="op" id="3652228">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652233">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652245"><a href="/net/textproto/writer.go.html#3651733">n</a></span><span class="op" id="3652246">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652253">return</span><br>
<span class="lineno">100</span><span class="op" id="3652260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3652263">func</span>&nbsp;<span class="op" id="3652268">(</span><span class="ident" id="3652269">d</span>&nbsp;<span class="op" id="3652271">*</span><span class="ident" id="3652272"><a href="/net/textproto/writer.go.html#3651443">dotWriter</a></span><span class="op" id="3652281">)</span>&nbsp;<span class="ident" id="3652283">Close</span><span class="op" id="3652288">(</span><span class="op" id="3652289">)</span>&nbsp;<span class="builtintype" id="3652291">error</span>&nbsp;<span class="op" id="3652297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652300">if</span>&nbsp;<span class="ident" id="3652303"><a href="/net/textproto/writer.go.html#3652269">d</a></span><span class="op" id="3652304">.</span><span class="ident" id="3652305">w</span><span class="op" id="3652306">.</span><span class="ident" id="3652307">dot</span>&nbsp;<span class="op" id="3652311">==</span>&nbsp;<span class="ident" id="3652314"><a href="/net/textproto/writer.go.html#3652269">d</a></span>&nbsp;<span class="op" id="3652316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652320"><a href="/net/textproto/writer.go.html#3652269">d</a></span><span class="op" id="3652321">.</span><span class="ident" id="3652322">w</span><span class="op" id="3652323">.</span><span class="ident" id="3652324">dot</span>&nbsp;<span class="op" id="3652328">=</span>&nbsp;<span class="ident" id="3652330">nil</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652338">bw</span>&nbsp;<span class="op" id="3652341">:=</span>&nbsp;<span class="ident" id="3652344"><a href="/net/textproto/writer.go.html#3652269">d</a></span><span class="op" id="3652345">.</span><span class="ident" id="3652346">w</span><span class="op" id="3652347">.</span><span class="ident" id="3652348">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652351">switch</span>&nbsp;<span class="ident" id="3652358"><a href="/net/textproto/writer.go.html#3652269">d</a></span><span class="op" id="3652359">.</span><span class="ident" id="3652360">state</span>&nbsp;<span class="op" id="3652366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652369">default</span><span class="op" id="3652376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652380"><a href="/net/textproto/writer.go.html#3652338">bw</a></span><span class="op" id="3652382">.</span><span class="ident" id="3652383">WriteByte</span><span class="op" id="3652392">(</span><span class="string" id="3652393">&#39;\r&#39;</span><span class="op" id="3652397">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652401">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652414">case</span>&nbsp;<span class="ident" id="3652419"><a href="/net/textproto/writer.go.html#3651574">wstateCR</a></span><span class="op" id="3652427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652431"><a href="/net/textproto/writer.go.html#3652338">bw</a></span><span class="op" id="3652433">.</span><span class="ident" id="3652434">WriteByte</span><span class="op" id="3652443">(</span><span class="string" id="3652444">&#39;\n&#39;</span><span class="op" id="3652448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652452">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652465">case</span>&nbsp;<span class="ident" id="3652470"><a href="/net/textproto/writer.go.html#3651500">wstateBeginLine</a></span><span class="op" id="3652485">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3652489"><a href="/net/textproto/writer.go.html#3652338">bw</a></span><span class="op" id="3652491">.</span><span class="ident" id="3652492">Write</span><span class="op" id="3652497">(</span><span class="ident" id="3652498"><a href="/net/textproto/writer.go.html#3650575">dotcrnl</a></span><span class="op" id="3652505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3652508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3652511">return</span>&nbsp;<span class="ident" id="3652518"><a href="/net/textproto/writer.go.html#3652338">bw</a></span><span class="op" id="3652520">.</span><span class="ident" id="3652521">Flush</span><span class="op" id="3652526">(</span><span class="op" id="3652527">)</span><br>
<span class="lineno"></span><span class="op" id="3652529">}</span>
</div>
</body>
</html>
