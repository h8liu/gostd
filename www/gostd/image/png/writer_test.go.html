<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6554466">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6554521">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6554575">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6554626">package</span>&nbsp;<span class="ident" id="6554634">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6554639">import</span>&nbsp;<span class="op" id="6554646">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554649">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554658">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554665">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554674">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554689">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554702">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6554712">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6554715">func</span>&nbsp;<span class="ident" id="6554720">diff</span><span class="op" id="6554724">(</span><span class="ident" id="6554725">m0</span><span class="op" id="6554727">,</span>&nbsp;<span class="ident" id="6554729">m1</span>&nbsp;<span class="ident" id="6554732">image</span><span class="op" id="6554737">.</span><span class="ident" id="6554738">Image</span><span class="op" id="6554743">)</span>&nbsp;<span class="builtintype" id="6554745">error</span>&nbsp;<span class="op" id="6554751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554754">b0</span><span class="op" id="6554756">,</span>&nbsp;<span class="ident" id="6554758">b1</span>&nbsp;<span class="op" id="6554761">:=</span>&nbsp;<span class="ident" id="6554764">m0</span><span class="op" id="6554766">.</span><span class="ident" id="6554767">Bounds</span><span class="op" id="6554773">(</span><span class="op" id="6554774">)</span><span class="op" id="6554775">,</span>&nbsp;<span class="ident" id="6554777">m1</span><span class="op" id="6554779">.</span><span class="ident" id="6554780">Bounds</span><span class="op" id="6554786">(</span><span class="op" id="6554787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554790">if</span>&nbsp;<span class="op" id="6554793">!</span><span class="ident" id="6554794">b0</span><span class="op" id="6554796">.</span><span class="ident" id="6554797">Size</span><span class="op" id="6554801">(</span><span class="op" id="6554802">)</span><span class="op" id="6554803">.</span><span class="ident" id="6554804">Eq</span><span class="op" id="6554806">(</span><span class="ident" id="6554807">b1</span><span class="op" id="6554809">.</span><span class="ident" id="6554810">Size</span><span class="op" id="6554814">(</span><span class="op" id="6554815">)</span><span class="op" id="6554816">)</span>&nbsp;<span class="op" id="6554818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554822">return</span>&nbsp;<span class="ident" id="6554829">fmt</span><span class="op" id="6554832">.</span><span class="ident" id="6554833">Errorf</span><span class="op" id="6554839">(</span><span class="string" id="6554840">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="6554869">,</span>&nbsp;<span class="ident" id="6554871">b0</span><span class="op" id="6554873">,</span>&nbsp;<span class="ident" id="6554875">b1</span><span class="op" id="6554877">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554883">dx</span>&nbsp;<span class="op" id="6554886">:=</span>&nbsp;<span class="ident" id="6554889">b1</span><span class="op" id="6554891">.</span><span class="ident" id="6554892">Min</span><span class="op" id="6554895">.</span><span class="ident" id="6554896">X</span>&nbsp;<span class="op" id="6554898">-</span>&nbsp;<span class="ident" id="6554900">b0</span><span class="op" id="6554902">.</span><span class="ident" id="6554903">Min</span><span class="op" id="6554906">.</span><span class="ident" id="6554907">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554910">dy</span>&nbsp;<span class="op" id="6554913">:=</span>&nbsp;<span class="ident" id="6554916">b1</span><span class="op" id="6554918">.</span><span class="ident" id="6554919">Min</span><span class="op" id="6554922">.</span><span class="ident" id="6554923">Y</span>&nbsp;<span class="op" id="6554925">-</span>&nbsp;<span class="ident" id="6554927">b0</span><span class="op" id="6554929">.</span><span class="ident" id="6554930">Min</span><span class="op" id="6554933">.</span><span class="ident" id="6554934">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554937">for</span>&nbsp;<span class="ident" id="6554941">y</span>&nbsp;<span class="op" id="6554943">:=</span>&nbsp;<span class="ident" id="6554946">b0</span><span class="op" id="6554948">.</span><span class="ident" id="6554949">Min</span><span class="op" id="6554952">.</span><span class="ident" id="6554953">Y</span><span class="op" id="6554954">;</span>&nbsp;<span class="ident" id="6554956">y</span>&nbsp;<span class="op" id="6554958">&lt;</span>&nbsp;<span class="ident" id="6554960">b0</span><span class="op" id="6554962">.</span><span class="ident" id="6554963">Max</span><span class="op" id="6554966">.</span><span class="ident" id="6554967">Y</span><span class="op" id="6554968">;</span>&nbsp;<span class="ident" id="6554970">y</span><span class="op" id="6554971">++</span>&nbsp;<span class="op" id="6554974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554978">for</span>&nbsp;<span class="ident" id="6554982">x</span>&nbsp;<span class="op" id="6554984">:=</span>&nbsp;<span class="ident" id="6554987">b0</span><span class="op" id="6554989">.</span><span class="ident" id="6554990">Min</span><span class="op" id="6554993">.</span><span class="ident" id="6554994">X</span><span class="op" id="6554995">;</span>&nbsp;<span class="ident" id="6554997">x</span>&nbsp;<span class="op" id="6554999">&lt;</span>&nbsp;<span class="ident" id="6555001">b0</span><span class="op" id="6555003">.</span><span class="ident" id="6555004">Max</span><span class="op" id="6555007">.</span><span class="ident" id="6555008">X</span><span class="op" id="6555009">;</span>&nbsp;<span class="ident" id="6555011">x</span><span class="op" id="6555012">++</span>&nbsp;<span class="op" id="6555015">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555020">c0</span>&nbsp;<span class="op" id="6555023">:=</span>&nbsp;<span class="ident" id="6555026">m0</span><span class="op" id="6555028">.</span><span class="ident" id="6555029">At</span><span class="op" id="6555031">(</span><span class="ident" id="6555032">x</span><span class="op" id="6555033">,</span>&nbsp;<span class="ident" id="6555035">y</span><span class="op" id="6555036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555041">c1</span>&nbsp;<span class="op" id="6555044">:=</span>&nbsp;<span class="ident" id="6555047">m1</span><span class="op" id="6555049">.</span><span class="ident" id="6555050">At</span><span class="op" id="6555052">(</span><span class="ident" id="6555053">x</span><span class="op" id="6555054">+</span><span class="ident" id="6555055">dx</span><span class="op" id="6555057">,</span>&nbsp;<span class="ident" id="6555059">y</span><span class="op" id="6555060">+</span><span class="ident" id="6555061">dy</span><span class="op" id="6555063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555068">r0</span><span class="op" id="6555070">,</span>&nbsp;<span class="ident" id="6555072">g0</span><span class="op" id="6555074">,</span>&nbsp;<span class="ident" id="6555076">b0</span><span class="op" id="6555078">,</span>&nbsp;<span class="ident" id="6555080">a0</span>&nbsp;<span class="op" id="6555083">:=</span>&nbsp;<span class="ident" id="6555086">c0</span><span class="op" id="6555088">.</span><span class="ident" id="6555089">RGBA</span><span class="op" id="6555093">(</span><span class="op" id="6555094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555099">r1</span><span class="op" id="6555101">,</span>&nbsp;<span class="ident" id="6555103">g1</span><span class="op" id="6555105">,</span>&nbsp;<span class="ident" id="6555107">b1</span><span class="op" id="6555109">,</span>&nbsp;<span class="ident" id="6555111">a1</span>&nbsp;<span class="op" id="6555114">:=</span>&nbsp;<span class="ident" id="6555117">c1</span><span class="op" id="6555119">.</span><span class="ident" id="6555120">RGBA</span><span class="op" id="6555124">(</span><span class="op" id="6555125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555130">if</span>&nbsp;<span class="ident" id="6555133">r0</span>&nbsp;<span class="op" id="6555136">!=</span>&nbsp;<span class="ident" id="6555139">r1</span>&nbsp;<span class="op" id="6555142">||</span>&nbsp;<span class="ident" id="6555145">g0</span>&nbsp;<span class="op" id="6555148">!=</span>&nbsp;<span class="ident" id="6555151">g1</span>&nbsp;<span class="op" id="6555154">||</span>&nbsp;<span class="ident" id="6555157">b0</span>&nbsp;<span class="op" id="6555160">!=</span>&nbsp;<span class="ident" id="6555163">b1</span>&nbsp;<span class="op" id="6555166">||</span>&nbsp;<span class="ident" id="6555169">a0</span>&nbsp;<span class="op" id="6555172">!=</span>&nbsp;<span class="ident" id="6555175">a1</span>&nbsp;<span class="op" id="6555178">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555184">return</span>&nbsp;<span class="ident" id="6555191">fmt</span><span class="op" id="6555194">.</span><span class="ident" id="6555195">Errorf</span><span class="op" id="6555201">(</span><span class="string" id="6555202">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="6555239">,</span>&nbsp;<span class="ident" id="6555241">x</span><span class="op" id="6555242">,</span>&nbsp;<span class="ident" id="6555244">y</span><span class="op" id="6555245">,</span>&nbsp;<span class="ident" id="6555247">c0</span><span class="op" id="6555249">,</span>&nbsp;<span class="ident" id="6555251">c1</span><span class="op" id="6555253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555268">return</span>&nbsp;<span class="ident" id="6555275">nil</span><br>
<span class="lineno">35</span><span class="op" id="6555279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555282">func</span>&nbsp;<span class="ident" id="6555287">encodeDecode</span><span class="op" id="6555299">(</span><span class="ident" id="6555300">m</span>&nbsp;<span class="ident" id="6555302">image</span><span class="op" id="6555307">.</span><span class="ident" id="6555308">Image</span><span class="op" id="6555313">)</span>&nbsp;<span class="op" id="6555315">(</span><span class="ident" id="6555316">image</span><span class="op" id="6555321">.</span><span class="ident" id="6555322">Image</span><span class="op" id="6555327">,</span>&nbsp;<span class="builtintype" id="6555329">error</span><span class="op" id="6555334">)</span>&nbsp;<span class="op" id="6555336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555339">var</span>&nbsp;<span class="ident" id="6555343">b</span>&nbsp;<span class="ident" id="6555345">bytes</span><span class="op" id="6555350">.</span><span class="ident" id="6555351">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555359">err</span>&nbsp;<span class="op" id="6555363">:=</span>&nbsp;<span class="ident" id="6555366">Encode</span><span class="op" id="6555372">(</span><span class="op" id="6555373">&amp;</span><span class="ident" id="6555374">b</span><span class="op" id="6555375">,</span>&nbsp;<span class="ident" id="6555377">m</span><span class="op" id="6555378">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555381">if</span>&nbsp;<span class="ident" id="6555384">err</span>&nbsp;<span class="op" id="6555388">!=</span>&nbsp;<span class="ident" id="6555391">nil</span>&nbsp;<span class="op" id="6555395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555399">return</span>&nbsp;<span class="ident" id="6555406">nil</span><span class="op" id="6555409">,</span>&nbsp;<span class="ident" id="6555411">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555419">return</span>&nbsp;<span class="ident" id="6555426">Decode</span><span class="op" id="6555432">(</span><span class="op" id="6555433">&amp;</span><span class="ident" id="6555434">b</span><span class="op" id="6555435">)</span><br>
<span class="lineno"></span><span class="op" id="6555437">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6555440">func</span>&nbsp;<span class="ident" id="6555445">TestWriter</span><span class="op" id="6555455">(</span><span class="ident" id="6555456">t</span>&nbsp;<span class="op" id="6555458">*</span><span class="ident" id="6555459">testing</span><span class="op" id="6555466">.</span><span class="ident" id="6555467">T</span><span class="op" id="6555468">)</span>&nbsp;<span class="op" id="6555470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6555473">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555531">names</span>&nbsp;<span class="op" id="6555537">:=</span>&nbsp;<span class="ident" id="6555540">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555551">if</span>&nbsp;<span class="ident" id="6555554">testing</span><span class="op" id="6555561">.</span><span class="ident" id="6555562">Short</span><span class="op" id="6555567">(</span><span class="op" id="6555568">)</span>&nbsp;<span class="op" id="6555570">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555574">names</span>&nbsp;<span class="op" id="6555580">=</span>&nbsp;<span class="ident" id="6555582">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555601">for</span>&nbsp;<span class="ident" id="6555605">_</span><span class="op" id="6555606">,</span>&nbsp;<span class="ident" id="6555608">fn</span>&nbsp;<span class="op" id="6555611">:=</span>&nbsp;<span class="keyword" id="6555614">range</span>&nbsp;<span class="ident" id="6555620">names</span>&nbsp;<span class="op" id="6555626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555630">qfn</span>&nbsp;<span class="op" id="6555634">:=</span>&nbsp;<span class="string" id="6555637">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="6555658">+</span>&nbsp;<span class="ident" id="6555660">fn</span>&nbsp;<span class="op" id="6555663">+</span>&nbsp;<span class="string" id="6555665">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6555674">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555695">m0</span><span class="op" id="6555697">,</span>&nbsp;<span class="ident" id="6555699">err</span>&nbsp;<span class="op" id="6555703">:=</span>&nbsp;<span class="ident" id="6555706">readPNG</span><span class="op" id="6555713">(</span><span class="ident" id="6555714">qfn</span><span class="op" id="6555717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555721">if</span>&nbsp;<span class="ident" id="6555724">err</span>&nbsp;<span class="op" id="6555728">!=</span>&nbsp;<span class="ident" id="6555731">nil</span>&nbsp;<span class="op" id="6555735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555740">t</span><span class="op" id="6555741">.</span><span class="ident" id="6555742">Error</span><span class="op" id="6555747">(</span><span class="ident" id="6555748">fn</span><span class="op" id="6555750">,</span>&nbsp;<span class="ident" id="6555752">err</span><span class="op" id="6555755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555760">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555771">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6555775">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555828">m1</span><span class="op" id="6555830">,</span>&nbsp;<span class="ident" id="6555832">err</span>&nbsp;<span class="op" id="6555836">:=</span>&nbsp;<span class="ident" id="6555839">readPNG</span><span class="op" id="6555846">(</span><span class="ident" id="6555847">qfn</span><span class="op" id="6555850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555854">if</span>&nbsp;<span class="ident" id="6555857">err</span>&nbsp;<span class="op" id="6555861">!=</span>&nbsp;<span class="ident" id="6555864">nil</span>&nbsp;<span class="op" id="6555868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555873">t</span><span class="op" id="6555874">.</span><span class="ident" id="6555875">Error</span><span class="op" id="6555880">(</span><span class="ident" id="6555881">fn</span><span class="op" id="6555883">,</span>&nbsp;<span class="ident" id="6555885">err</span><span class="op" id="6555888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555893">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555906">m2</span><span class="op" id="6555908">,</span>&nbsp;<span class="ident" id="6555910">err</span>&nbsp;<span class="op" id="6555914">:=</span>&nbsp;<span class="ident" id="6555917">encodeDecode</span><span class="op" id="6555929">(</span><span class="ident" id="6555930">m1</span><span class="op" id="6555932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555936">if</span>&nbsp;<span class="ident" id="6555939">err</span>&nbsp;<span class="op" id="6555943">!=</span>&nbsp;<span class="ident" id="6555946">nil</span>&nbsp;<span class="op" id="6555950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555955">t</span><span class="op" id="6555956">.</span><span class="ident" id="6555957">Error</span><span class="op" id="6555962">(</span><span class="ident" id="6555963">fn</span><span class="op" id="6555965">,</span>&nbsp;<span class="ident" id="6555967">err</span><span class="op" id="6555970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555975">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6555988">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556010">err</span>&nbsp;<span class="op" id="6556014">=</span>&nbsp;<span class="ident" id="6556016">diff</span><span class="op" id="6556020">(</span><span class="ident" id="6556021">m0</span><span class="op" id="6556023">,</span>&nbsp;<span class="ident" id="6556025">m2</span><span class="op" id="6556027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556031">if</span>&nbsp;<span class="ident" id="6556034">err</span>&nbsp;<span class="op" id="6556038">!=</span>&nbsp;<span class="ident" id="6556041">nil</span>&nbsp;<span class="op" id="6556045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556050">t</span><span class="op" id="6556051">.</span><span class="ident" id="6556052">Error</span><span class="op" id="6556057">(</span><span class="ident" id="6556058">fn</span><span class="op" id="6556060">,</span>&nbsp;<span class="ident" id="6556062">err</span><span class="op" id="6556065">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556070">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556084">}</span><br>
<span class="lineno"></span><span class="op" id="6556086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6556089">func</span>&nbsp;<span class="ident" id="6556094">TestWriterLevels</span><span class="op" id="6556110">(</span><span class="ident" id="6556111">t</span>&nbsp;<span class="op" id="6556113">*</span><span class="ident" id="6556114">testing</span><span class="op" id="6556121">.</span><span class="ident" id="6556122">T</span><span class="op" id="6556123">)</span>&nbsp;<span class="op" id="6556125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556128">m</span>&nbsp;<span class="op" id="6556130">:=</span>&nbsp;<span class="ident" id="6556133">image</span><span class="op" id="6556138">.</span><span class="ident" id="6556139">NewNRGBA</span><span class="op" id="6556147">(</span><span class="ident" id="6556148">image</span><span class="op" id="6556153">.</span><span class="ident" id="6556154">Rect</span><span class="op" id="6556158">(</span><span class="num" id="6556159">0</span><span class="op" id="6556160">,</span>&nbsp;<span class="num" id="6556162">0</span><span class="op" id="6556163">,</span>&nbsp;<span class="num" id="6556165">100</span><span class="op" id="6556168">,</span>&nbsp;<span class="num" id="6556170">100</span><span class="op" id="6556173">)</span><span class="op" id="6556174">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556178">var</span>&nbsp;<span class="ident" id="6556182">b1</span><span class="op" id="6556184">,</span>&nbsp;<span class="ident" id="6556186">b2</span>&nbsp;<span class="ident" id="6556189">bytes</span><span class="op" id="6556194">.</span><span class="ident" id="6556195">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556203">if</span>&nbsp;<span class="ident" id="6556206">err</span>&nbsp;<span class="op" id="6556210">:=</span>&nbsp;<span class="op" id="6556213">(</span><span class="op" id="6556214">&amp;</span><span class="ident" id="6556215">Encoder</span><span class="op" id="6556222">{</span><span class="op" id="6556223">}</span><span class="op" id="6556224">)</span><span class="op" id="6556225">.</span><span class="ident" id="6556226">Encode</span><span class="op" id="6556232">(</span><span class="op" id="6556233">&amp;</span><span class="ident" id="6556234">b1</span><span class="op" id="6556236">,</span>&nbsp;<span class="ident" id="6556238">m</span><span class="op" id="6556239">)</span><span class="op" id="6556240">;</span>&nbsp;<span class="ident" id="6556242">err</span>&nbsp;<span class="op" id="6556246">!=</span>&nbsp;<span class="ident" id="6556249">nil</span>&nbsp;<span class="op" id="6556253">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556257">t</span><span class="op" id="6556258">.</span><span class="ident" id="6556259">Fatal</span><span class="op" id="6556264">(</span><span class="ident" id="6556265">err</span><span class="op" id="6556268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556274">noenc</span>&nbsp;<span class="op" id="6556280">:=</span>&nbsp;<span class="op" id="6556283">&amp;</span><span class="ident" id="6556284">Encoder</span><span class="op" id="6556291">{</span><span class="ident" id="6556292">CompressionLevel</span><span class="op" id="6556308">:</span>&nbsp;<span class="ident" id="6556310">NoCompression</span><span class="op" id="6556323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556326">if</span>&nbsp;<span class="ident" id="6556329">err</span>&nbsp;<span class="op" id="6556333">:=</span>&nbsp;<span class="ident" id="6556336">noenc</span><span class="op" id="6556341">.</span><span class="ident" id="6556342">Encode</span><span class="op" id="6556348">(</span><span class="op" id="6556349">&amp;</span><span class="ident" id="6556350">b2</span><span class="op" id="6556352">,</span>&nbsp;<span class="ident" id="6556354">m</span><span class="op" id="6556355">)</span><span class="op" id="6556356">;</span>&nbsp;<span class="ident" id="6556358">err</span>&nbsp;<span class="op" id="6556362">!=</span>&nbsp;<span class="ident" id="6556365">nil</span>&nbsp;<span class="op" id="6556369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556373">t</span><span class="op" id="6556374">.</span><span class="ident" id="6556375">Fatal</span><span class="op" id="6556380">(</span><span class="ident" id="6556381">err</span><span class="op" id="6556384">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556391">if</span>&nbsp;<span class="ident" id="6556394">b2</span><span class="op" id="6556396">.</span><span class="ident" id="6556397">Len</span><span class="op" id="6556400">(</span><span class="op" id="6556401">)</span>&nbsp;<span class="op" id="6556403">&lt;=</span>&nbsp;<span class="ident" id="6556406">b1</span><span class="op" id="6556408">.</span><span class="ident" id="6556409">Len</span><span class="op" id="6556412">(</span><span class="op" id="6556413">)</span>&nbsp;<span class="op" id="6556415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556419">t</span><span class="op" id="6556420">.</span><span class="ident" id="6556421">Error</span><span class="op" id="6556426">(</span><span class="string" id="6556427">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="6556495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556498">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556501">if</span>&nbsp;<span class="ident" id="6556504">_</span><span class="op" id="6556505">,</span>&nbsp;<span class="ident" id="6556507">err</span>&nbsp;<span class="op" id="6556511">:=</span>&nbsp;<span class="ident" id="6556514">Decode</span><span class="op" id="6556520">(</span><span class="op" id="6556521">&amp;</span><span class="ident" id="6556522">b1</span><span class="op" id="6556524">)</span><span class="op" id="6556525">;</span>&nbsp;<span class="ident" id="6556527">err</span>&nbsp;<span class="op" id="6556531">!=</span>&nbsp;<span class="ident" id="6556534">nil</span>&nbsp;<span class="op" id="6556538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556542">t</span><span class="op" id="6556543">.</span><span class="ident" id="6556544">Error</span><span class="op" id="6556549">(</span><span class="string" id="6556550">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="6556584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556590">if</span>&nbsp;<span class="ident" id="6556593">_</span><span class="op" id="6556594">,</span>&nbsp;<span class="ident" id="6556596">err</span>&nbsp;<span class="op" id="6556600">:=</span>&nbsp;<span class="ident" id="6556603">Decode</span><span class="op" id="6556609">(</span><span class="op" id="6556610">&amp;</span><span class="ident" id="6556611">b2</span><span class="op" id="6556613">)</span><span class="op" id="6556614">;</span>&nbsp;<span class="ident" id="6556616">err</span>&nbsp;<span class="op" id="6556620">!=</span>&nbsp;<span class="ident" id="6556623">nil</span>&nbsp;<span class="op" id="6556627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556631">t</span><span class="op" id="6556632">.</span><span class="ident" id="6556633">Error</span><span class="op" id="6556638">(</span><span class="string" id="6556639">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="6556668">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556671">}</span><br>
<span class="lineno"></span><span class="op" id="6556673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6556676">func</span>&nbsp;<span class="ident" id="6556681">TestSubImage</span><span class="op" id="6556693">(</span><span class="ident" id="6556694">t</span>&nbsp;<span class="op" id="6556696">*</span><span class="ident" id="6556697">testing</span><span class="op" id="6556704">.</span><span class="ident" id="6556705">T</span><span class="op" id="6556706">)</span>&nbsp;<span class="op" id="6556708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556711">m0</span>&nbsp;<span class="op" id="6556714">:=</span>&nbsp;<span class="ident" id="6556717">image</span><span class="op" id="6556722">.</span><span class="ident" id="6556723">NewRGBA</span><span class="op" id="6556730">(</span><span class="ident" id="6556731">image</span><span class="op" id="6556736">.</span><span class="ident" id="6556737">Rect</span><span class="op" id="6556741">(</span><span class="num" id="6556742">0</span><span class="op" id="6556743">,</span>&nbsp;<span class="num" id="6556745">0</span><span class="op" id="6556746">,</span>&nbsp;<span class="num" id="6556748">256</span><span class="op" id="6556751">,</span>&nbsp;<span class="num" id="6556753">256</span><span class="op" id="6556756">)</span><span class="op" id="6556757">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556760">for</span>&nbsp;<span class="ident" id="6556764">y</span>&nbsp;<span class="op" id="6556766">:=</span>&nbsp;<span class="num" id="6556769">0</span><span class="op" id="6556770">;</span>&nbsp;<span class="ident" id="6556772">y</span>&nbsp;<span class="op" id="6556774">&lt;</span>&nbsp;<span class="num" id="6556776">256</span><span class="op" id="6556779">;</span>&nbsp;<span class="ident" id="6556781">y</span><span class="op" id="6556782">++</span>&nbsp;<span class="op" id="6556785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556789">for</span>&nbsp;<span class="ident" id="6556793">x</span>&nbsp;<span class="op" id="6556795">:=</span>&nbsp;<span class="num" id="6556798">0</span><span class="op" id="6556799">;</span>&nbsp;<span class="ident" id="6556801">x</span>&nbsp;<span class="op" id="6556803">&lt;</span>&nbsp;<span class="num" id="6556805">256</span><span class="op" id="6556808">;</span>&nbsp;<span class="ident" id="6556810">x</span><span class="op" id="6556811">++</span>&nbsp;<span class="op" id="6556814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556819">m0</span><span class="op" id="6556821">.</span><span class="ident" id="6556822">Set</span><span class="op" id="6556825">(</span><span class="ident" id="6556826">x</span><span class="op" id="6556827">,</span>&nbsp;<span class="ident" id="6556829">y</span><span class="op" id="6556830">,</span>&nbsp;<span class="ident" id="6556832">color</span><span class="op" id="6556837">.</span><span class="ident" id="6556838">RGBA</span><span class="op" id="6556842">{</span><span class="builtintype" id="6556843">uint8</span><span class="op" id="6556848">(</span><span class="ident" id="6556849">x</span><span class="op" id="6556850">)</span><span class="op" id="6556851">,</span>&nbsp;<span class="builtintype" id="6556853">uint8</span><span class="op" id="6556858">(</span><span class="ident" id="6556859">y</span><span class="op" id="6556860">)</span><span class="op" id="6556861">,</span>&nbsp;<span class="num" id="6556863">0</span><span class="op" id="6556864">,</span>&nbsp;<span class="num" id="6556866">255</span><span class="op" id="6556869">}</span><span class="op" id="6556870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556877">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556880">m0</span>&nbsp;<span class="op" id="6556883">=</span>&nbsp;<span class="ident" id="6556885">m0</span><span class="op" id="6556887">.</span><span class="ident" id="6556888">SubImage</span><span class="op" id="6556896">(</span><span class="ident" id="6556897">image</span><span class="op" id="6556902">.</span><span class="ident" id="6556903">Rect</span><span class="op" id="6556907">(</span><span class="num" id="6556908">50</span><span class="op" id="6556910">,</span>&nbsp;<span class="num" id="6556912">30</span><span class="op" id="6556914">,</span>&nbsp;<span class="num" id="6556916">250</span><span class="op" id="6556919">,</span>&nbsp;<span class="num" id="6556921">130</span><span class="op" id="6556924">)</span><span class="op" id="6556925">)</span><span class="op" id="6556926">.</span><span class="op" id="6556927">(</span><span class="op" id="6556928">*</span><span class="ident" id="6556929">image</span><span class="op" id="6556934">.</span><span class="ident" id="6556935">RGBA</span><span class="op" id="6556939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556942">m1</span><span class="op" id="6556944">,</span>&nbsp;<span class="ident" id="6556946">err</span>&nbsp;<span class="op" id="6556950">:=</span>&nbsp;<span class="ident" id="6556953">encodeDecode</span><span class="op" id="6556965">(</span><span class="ident" id="6556966">m0</span><span class="op" id="6556968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556971">if</span>&nbsp;<span class="ident" id="6556974">err</span>&nbsp;<span class="op" id="6556978">!=</span>&nbsp;<span class="ident" id="6556981">nil</span>&nbsp;<span class="op" id="6556985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556989">t</span><span class="op" id="6556990">.</span><span class="ident" id="6556991">Error</span><span class="op" id="6556996">(</span><span class="ident" id="6556997">err</span><span class="op" id="6557000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557004">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557015">err</span>&nbsp;<span class="op" id="6557019">=</span>&nbsp;<span class="ident" id="6557021">diff</span><span class="op" id="6557025">(</span><span class="ident" id="6557026">m0</span><span class="op" id="6557028">,</span>&nbsp;<span class="ident" id="6557030">m1</span><span class="op" id="6557032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557035">if</span>&nbsp;<span class="ident" id="6557038">err</span>&nbsp;<span class="op" id="6557042">!=</span>&nbsp;<span class="ident" id="6557045">nil</span>&nbsp;<span class="op" id="6557049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557053">t</span><span class="op" id="6557054">.</span><span class="ident" id="6557055">Error</span><span class="op" id="6557060">(</span><span class="ident" id="6557061">err</span><span class="op" id="6557064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557068">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557076">}</span><br>
<span class="lineno"></span><span class="op" id="6557078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6557081">func</span>&nbsp;<span class="ident" id="6557086">BenchmarkEncodeGray</span><span class="op" id="6557105">(</span><span class="ident" id="6557106">b</span>&nbsp;<span class="op" id="6557108">*</span><span class="ident" id="6557109">testing</span><span class="op" id="6557116">.</span><span class="ident" id="6557117">B</span><span class="op" id="6557118">)</span>&nbsp;<span class="op" id="6557120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557123">b</span><span class="op" id="6557124">.</span><span class="ident" id="6557125">StopTimer</span><span class="op" id="6557134">(</span><span class="op" id="6557135">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557138">img</span>&nbsp;<span class="op" id="6557142">:=</span>&nbsp;<span class="ident" id="6557145">image</span><span class="op" id="6557150">.</span><span class="ident" id="6557151">NewGray</span><span class="op" id="6557158">(</span><span class="ident" id="6557159">image</span><span class="op" id="6557164">.</span><span class="ident" id="6557165">Rect</span><span class="op" id="6557169">(</span><span class="num" id="6557170">0</span><span class="op" id="6557171">,</span>&nbsp;<span class="num" id="6557173">0</span><span class="op" id="6557174">,</span>&nbsp;<span class="num" id="6557176">640</span><span class="op" id="6557179">,</span>&nbsp;<span class="num" id="6557181">480</span><span class="op" id="6557184">)</span><span class="op" id="6557185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557188">b</span><span class="op" id="6557189">.</span><span class="ident" id="6557190">SetBytes</span><span class="op" id="6557198">(</span><span class="num" id="6557199">640</span>&nbsp;<span class="op" id="6557203">*</span>&nbsp;<span class="num" id="6557205">480</span>&nbsp;<span class="op" id="6557209">*</span>&nbsp;<span class="num" id="6557211">1</span><span class="op" id="6557212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557215">b</span><span class="op" id="6557216">.</span><span class="ident" id="6557217">StartTimer</span><span class="op" id="6557227">(</span><span class="op" id="6557228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557231">for</span>&nbsp;<span class="ident" id="6557235">i</span>&nbsp;<span class="op" id="6557237">:=</span>&nbsp;<span class="num" id="6557240">0</span><span class="op" id="6557241">;</span>&nbsp;<span class="ident" id="6557243">i</span>&nbsp;<span class="op" id="6557245">&lt;</span>&nbsp;<span class="ident" id="6557247">b</span><span class="op" id="6557248">.</span><span class="ident" id="6557249">N</span><span class="op" id="6557250">;</span>&nbsp;<span class="ident" id="6557252">i</span><span class="op" id="6557253">++</span>&nbsp;<span class="op" id="6557256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557260">Encode</span><span class="op" id="6557266">(</span><span class="ident" id="6557267">ioutil</span><span class="op" id="6557273">.</span><span class="ident" id="6557274">Discard</span><span class="op" id="6557281">,</span>&nbsp;<span class="ident" id="6557283">img</span><span class="op" id="6557286">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557289">}</span><br>
<span class="lineno"></span><span class="op" id="6557291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6557294">func</span>&nbsp;<span class="ident" id="6557299">BenchmarkEncodeNRGBOpaque</span><span class="op" id="6557324">(</span><span class="ident" id="6557325">b</span>&nbsp;<span class="op" id="6557327">*</span><span class="ident" id="6557328">testing</span><span class="op" id="6557335">.</span><span class="ident" id="6557336">B</span><span class="op" id="6557337">)</span>&nbsp;<span class="op" id="6557339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557342">b</span><span class="op" id="6557343">.</span><span class="ident" id="6557344">StopTimer</span><span class="op" id="6557353">(</span><span class="op" id="6557354">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557357">img</span>&nbsp;<span class="op" id="6557361">:=</span>&nbsp;<span class="ident" id="6557364">image</span><span class="op" id="6557369">.</span><span class="ident" id="6557370">NewNRGBA</span><span class="op" id="6557378">(</span><span class="ident" id="6557379">image</span><span class="op" id="6557384">.</span><span class="ident" id="6557385">Rect</span><span class="op" id="6557389">(</span><span class="num" id="6557390">0</span><span class="op" id="6557391">,</span>&nbsp;<span class="num" id="6557393">0</span><span class="op" id="6557394">,</span>&nbsp;<span class="num" id="6557396">640</span><span class="op" id="6557399">,</span>&nbsp;<span class="num" id="6557401">480</span><span class="op" id="6557404">)</span><span class="op" id="6557405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6557408">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557463">bo</span>&nbsp;<span class="op" id="6557466">:=</span>&nbsp;<span class="ident" id="6557469">img</span><span class="op" id="6557472">.</span><span class="ident" id="6557473">Bounds</span><span class="op" id="6557479">(</span><span class="op" id="6557480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557483">for</span>&nbsp;<span class="ident" id="6557487">y</span>&nbsp;<span class="op" id="6557489">:=</span>&nbsp;<span class="ident" id="6557492">bo</span><span class="op" id="6557494">.</span><span class="ident" id="6557495">Min</span><span class="op" id="6557498">.</span><span class="ident" id="6557499">Y</span><span class="op" id="6557500">;</span>&nbsp;<span class="ident" id="6557502">y</span>&nbsp;<span class="op" id="6557504">&lt;</span>&nbsp;<span class="ident" id="6557506">bo</span><span class="op" id="6557508">.</span><span class="ident" id="6557509">Max</span><span class="op" id="6557512">.</span><span class="ident" id="6557513">Y</span><span class="op" id="6557514">;</span>&nbsp;<span class="ident" id="6557516">y</span><span class="op" id="6557517">++</span>&nbsp;<span class="op" id="6557520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557524">for</span>&nbsp;<span class="ident" id="6557528">x</span>&nbsp;<span class="op" id="6557530">:=</span>&nbsp;<span class="ident" id="6557533">bo</span><span class="op" id="6557535">.</span><span class="ident" id="6557536">Min</span><span class="op" id="6557539">.</span><span class="ident" id="6557540">X</span><span class="op" id="6557541">;</span>&nbsp;<span class="ident" id="6557543">x</span>&nbsp;<span class="op" id="6557545">&lt;</span>&nbsp;<span class="ident" id="6557547">bo</span><span class="op" id="6557549">.</span><span class="ident" id="6557550">Max</span><span class="op" id="6557553">.</span><span class="ident" id="6557554">X</span><span class="op" id="6557555">;</span>&nbsp;<span class="ident" id="6557557">x</span><span class="op" id="6557558">++</span>&nbsp;<span class="op" id="6557561">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557566">img</span><span class="op" id="6557569">.</span><span class="ident" id="6557570">Set</span><span class="op" id="6557573">(</span><span class="ident" id="6557574">x</span><span class="op" id="6557575">,</span>&nbsp;<span class="ident" id="6557577">y</span><span class="op" id="6557578">,</span>&nbsp;<span class="ident" id="6557580">color</span><span class="op" id="6557585">.</span><span class="ident" id="6557586">NRGBA</span><span class="op" id="6557591">{</span><span class="num" id="6557592">0</span><span class="op" id="6557593">,</span>&nbsp;<span class="num" id="6557595">0</span><span class="op" id="6557596">,</span>&nbsp;<span class="num" id="6557598">0</span><span class="op" id="6557599">,</span>&nbsp;<span class="num" id="6557601">255</span><span class="op" id="6557604">}</span><span class="op" id="6557605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557615">if</span>&nbsp;<span class="op" id="6557618">!</span><span class="ident" id="6557619">img</span><span class="op" id="6557622">.</span><span class="ident" id="6557623">Opaque</span><span class="op" id="6557629">(</span><span class="op" id="6557630">)</span>&nbsp;<span class="op" id="6557632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557636">b</span><span class="op" id="6557637">.</span><span class="ident" id="6557638">Fatal</span><span class="op" id="6557643">(</span><span class="string" id="6557644">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6557673">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557679">b</span><span class="op" id="6557680">.</span><span class="ident" id="6557681">SetBytes</span><span class="op" id="6557689">(</span><span class="num" id="6557690">640</span>&nbsp;<span class="op" id="6557694">*</span>&nbsp;<span class="num" id="6557696">480</span>&nbsp;<span class="op" id="6557700">*</span>&nbsp;<span class="num" id="6557702">4</span><span class="op" id="6557703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557706">b</span><span class="op" id="6557707">.</span><span class="ident" id="6557708">StartTimer</span><span class="op" id="6557718">(</span><span class="op" id="6557719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557722">for</span>&nbsp;<span class="ident" id="6557726">i</span>&nbsp;<span class="op" id="6557728">:=</span>&nbsp;<span class="num" id="6557731">0</span><span class="op" id="6557732">;</span>&nbsp;<span class="ident" id="6557734">i</span>&nbsp;<span class="op" id="6557736">&lt;</span>&nbsp;<span class="ident" id="6557738">b</span><span class="op" id="6557739">.</span><span class="ident" id="6557740">N</span><span class="op" id="6557741">;</span>&nbsp;<span class="ident" id="6557743">i</span><span class="op" id="6557744">++</span>&nbsp;<span class="op" id="6557747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557751">Encode</span><span class="op" id="6557757">(</span><span class="ident" id="6557758">ioutil</span><span class="op" id="6557764">.</span><span class="ident" id="6557765">Discard</span><span class="op" id="6557772">,</span>&nbsp;<span class="ident" id="6557774">img</span><span class="op" id="6557777">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557780">}</span><br>
<span class="lineno"></span><span class="op" id="6557782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6557785">func</span>&nbsp;<span class="ident" id="6557790">BenchmarkEncodeNRGBA</span><span class="op" id="6557810">(</span><span class="ident" id="6557811">b</span>&nbsp;<span class="op" id="6557813">*</span><span class="ident" id="6557814">testing</span><span class="op" id="6557821">.</span><span class="ident" id="6557822">B</span><span class="op" id="6557823">)</span>&nbsp;<span class="op" id="6557825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557828">b</span><span class="op" id="6557829">.</span><span class="ident" id="6557830">StopTimer</span><span class="op" id="6557839">(</span><span class="op" id="6557840">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557843">img</span>&nbsp;<span class="op" id="6557847">:=</span>&nbsp;<span class="ident" id="6557850">image</span><span class="op" id="6557855">.</span><span class="ident" id="6557856">NewNRGBA</span><span class="op" id="6557864">(</span><span class="ident" id="6557865">image</span><span class="op" id="6557870">.</span><span class="ident" id="6557871">Rect</span><span class="op" id="6557875">(</span><span class="num" id="6557876">0</span><span class="op" id="6557877">,</span>&nbsp;<span class="num" id="6557879">0</span><span class="op" id="6557880">,</span>&nbsp;<span class="num" id="6557882">640</span><span class="op" id="6557885">,</span>&nbsp;<span class="num" id="6557887">480</span><span class="op" id="6557890">)</span><span class="op" id="6557891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6557894">if</span>&nbsp;<span class="ident" id="6557897">img</span><span class="op" id="6557900">.</span><span class="ident" id="6557901">Opaque</span><span class="op" id="6557907">(</span><span class="op" id="6557908">)</span>&nbsp;<span class="op" id="6557910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557914">b</span><span class="op" id="6557915">.</span><span class="ident" id="6557916">Fatal</span><span class="op" id="6557921">(</span><span class="string" id="6557922">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6557955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557961">b</span><span class="op" id="6557962">.</span><span class="ident" id="6557963">SetBytes</span><span class="op" id="6557971">(</span><span class="num" id="6557972">640</span>&nbsp;<span class="op" id="6557976">*</span>&nbsp;<span class="num" id="6557978">480</span>&nbsp;<span class="op" id="6557982">*</span>&nbsp;<span class="num" id="6557984">4</span><span class="op" id="6557985">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6557988">b</span><span class="op" id="6557989">.</span><span class="ident" id="6557990">StartTimer</span><span class="op" id="6558000">(</span><span class="op" id="6558001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558004">for</span>&nbsp;<span class="ident" id="6558008">i</span>&nbsp;<span class="op" id="6558010">:=</span>&nbsp;<span class="num" id="6558013">0</span><span class="op" id="6558014">;</span>&nbsp;<span class="ident" id="6558016">i</span>&nbsp;<span class="op" id="6558018">&lt;</span>&nbsp;<span class="ident" id="6558020">b</span><span class="op" id="6558021">.</span><span class="ident" id="6558022">N</span><span class="op" id="6558023">;</span>&nbsp;<span class="ident" id="6558025">i</span><span class="op" id="6558026">++</span>&nbsp;<span class="op" id="6558029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558033">Encode</span><span class="op" id="6558039">(</span><span class="ident" id="6558040">ioutil</span><span class="op" id="6558046">.</span><span class="ident" id="6558047">Discard</span><span class="op" id="6558054">,</span>&nbsp;<span class="ident" id="6558056">img</span><span class="op" id="6558059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558062">}</span><br>
<span class="lineno"></span><span class="op" id="6558064">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6558067">func</span>&nbsp;<span class="ident" id="6558072">BenchmarkEncodePaletted</span><span class="op" id="6558095">(</span><span class="ident" id="6558096">b</span>&nbsp;<span class="op" id="6558098">*</span><span class="ident" id="6558099">testing</span><span class="op" id="6558106">.</span><span class="ident" id="6558107">B</span><span class="op" id="6558108">)</span>&nbsp;<span class="op" id="6558110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558113">b</span><span class="op" id="6558114">.</span><span class="ident" id="6558115">StopTimer</span><span class="op" id="6558124">(</span><span class="op" id="6558125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558128">img</span>&nbsp;<span class="op" id="6558132">:=</span>&nbsp;<span class="ident" id="6558135">image</span><span class="op" id="6558140">.</span><span class="ident" id="6558141">NewPaletted</span><span class="op" id="6558152">(</span><span class="ident" id="6558153">image</span><span class="op" id="6558158">.</span><span class="ident" id="6558159">Rect</span><span class="op" id="6558163">(</span><span class="num" id="6558164">0</span><span class="op" id="6558165">,</span>&nbsp;<span class="num" id="6558167">0</span><span class="op" id="6558168">,</span>&nbsp;<span class="num" id="6558170">640</span><span class="op" id="6558173">,</span>&nbsp;<span class="num" id="6558175">480</span><span class="op" id="6558178">)</span><span class="op" id="6558179">,</span>&nbsp;<span class="ident" id="6558181">color</span><span class="op" id="6558186">.</span><span class="ident" id="6558187">Palette</span><span class="op" id="6558194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558198">color</span><span class="op" id="6558203">.</span><span class="ident" id="6558204">RGBA</span><span class="op" id="6558208">{</span><span class="num" id="6558209">0</span><span class="op" id="6558210">,</span>&nbsp;<span class="num" id="6558212">0</span><span class="op" id="6558213">,</span>&nbsp;<span class="num" id="6558215">0</span><span class="op" id="6558216">,</span>&nbsp;<span class="num" id="6558218">255</span><span class="op" id="6558221">}</span><span class="op" id="6558222">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558226">color</span><span class="op" id="6558231">.</span><span class="ident" id="6558232">RGBA</span><span class="op" id="6558236">{</span><span class="num" id="6558237">255</span><span class="op" id="6558240">,</span>&nbsp;<span class="num" id="6558242">255</span><span class="op" id="6558245">,</span>&nbsp;<span class="num" id="6558247">255</span><span class="op" id="6558250">,</span>&nbsp;<span class="num" id="6558252">255</span><span class="op" id="6558255">}</span><span class="op" id="6558256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558259">}</span><span class="op" id="6558260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558263">b</span><span class="op" id="6558264">.</span><span class="ident" id="6558265">SetBytes</span><span class="op" id="6558273">(</span><span class="num" id="6558274">640</span>&nbsp;<span class="op" id="6558278">*</span>&nbsp;<span class="num" id="6558280">480</span>&nbsp;<span class="op" id="6558284">*</span>&nbsp;<span class="num" id="6558286">1</span><span class="op" id="6558287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558290">b</span><span class="op" id="6558291">.</span><span class="ident" id="6558292">StartTimer</span><span class="op" id="6558302">(</span><span class="op" id="6558303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558306">for</span>&nbsp;<span class="ident" id="6558310">i</span>&nbsp;<span class="op" id="6558312">:=</span>&nbsp;<span class="num" id="6558315">0</span><span class="op" id="6558316">;</span>&nbsp;<span class="ident" id="6558318">i</span>&nbsp;<span class="op" id="6558320">&lt;</span>&nbsp;<span class="ident" id="6558322">b</span><span class="op" id="6558323">.</span><span class="ident" id="6558324">N</span><span class="op" id="6558325">;</span>&nbsp;<span class="ident" id="6558327">i</span><span class="op" id="6558328">++</span>&nbsp;<span class="op" id="6558331">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558335">Encode</span><span class="op" id="6558341">(</span><span class="ident" id="6558342">ioutil</span><span class="op" id="6558348">.</span><span class="ident" id="6558349">Discard</span><span class="op" id="6558356">,</span>&nbsp;<span class="ident" id="6558358">img</span><span class="op" id="6558361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558364">}</span><br>
<span class="lineno"></span><span class="op" id="6558366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6558369">func</span>&nbsp;<span class="ident" id="6558374">BenchmarkEncodeRGBOpaque</span><span class="op" id="6558398">(</span><span class="ident" id="6558399">b</span>&nbsp;<span class="op" id="6558401">*</span><span class="ident" id="6558402">testing</span><span class="op" id="6558409">.</span><span class="ident" id="6558410">B</span><span class="op" id="6558411">)</span>&nbsp;<span class="op" id="6558413">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558416">b</span><span class="op" id="6558417">.</span><span class="ident" id="6558418">StopTimer</span><span class="op" id="6558427">(</span><span class="op" id="6558428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558431">img</span>&nbsp;<span class="op" id="6558435">:=</span>&nbsp;<span class="ident" id="6558438">image</span><span class="op" id="6558443">.</span><span class="ident" id="6558444">NewRGBA</span><span class="op" id="6558451">(</span><span class="ident" id="6558452">image</span><span class="op" id="6558457">.</span><span class="ident" id="6558458">Rect</span><span class="op" id="6558462">(</span><span class="num" id="6558463">0</span><span class="op" id="6558464">,</span>&nbsp;<span class="num" id="6558466">0</span><span class="op" id="6558467">,</span>&nbsp;<span class="num" id="6558469">640</span><span class="op" id="6558472">,</span>&nbsp;<span class="num" id="6558474">480</span><span class="op" id="6558477">)</span><span class="op" id="6558478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558481">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558536">bo</span>&nbsp;<span class="op" id="6558539">:=</span>&nbsp;<span class="ident" id="6558542">img</span><span class="op" id="6558545">.</span><span class="ident" id="6558546">Bounds</span><span class="op" id="6558552">(</span><span class="op" id="6558553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558556">for</span>&nbsp;<span class="ident" id="6558560">y</span>&nbsp;<span class="op" id="6558562">:=</span>&nbsp;<span class="ident" id="6558565">bo</span><span class="op" id="6558567">.</span><span class="ident" id="6558568">Min</span><span class="op" id="6558571">.</span><span class="ident" id="6558572">Y</span><span class="op" id="6558573">;</span>&nbsp;<span class="ident" id="6558575">y</span>&nbsp;<span class="op" id="6558577">&lt;</span>&nbsp;<span class="ident" id="6558579">bo</span><span class="op" id="6558581">.</span><span class="ident" id="6558582">Max</span><span class="op" id="6558585">.</span><span class="ident" id="6558586">Y</span><span class="op" id="6558587">;</span>&nbsp;<span class="ident" id="6558589">y</span><span class="op" id="6558590">++</span>&nbsp;<span class="op" id="6558593">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558597">for</span>&nbsp;<span class="ident" id="6558601">x</span>&nbsp;<span class="op" id="6558603">:=</span>&nbsp;<span class="ident" id="6558606">bo</span><span class="op" id="6558608">.</span><span class="ident" id="6558609">Min</span><span class="op" id="6558612">.</span><span class="ident" id="6558613">X</span><span class="op" id="6558614">;</span>&nbsp;<span class="ident" id="6558616">x</span>&nbsp;<span class="op" id="6558618">&lt;</span>&nbsp;<span class="ident" id="6558620">bo</span><span class="op" id="6558622">.</span><span class="ident" id="6558623">Max</span><span class="op" id="6558626">.</span><span class="ident" id="6558627">X</span><span class="op" id="6558628">;</span>&nbsp;<span class="ident" id="6558630">x</span><span class="op" id="6558631">++</span>&nbsp;<span class="op" id="6558634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558639">img</span><span class="op" id="6558642">.</span><span class="ident" id="6558643">Set</span><span class="op" id="6558646">(</span><span class="ident" id="6558647">x</span><span class="op" id="6558648">,</span>&nbsp;<span class="ident" id="6558650">y</span><span class="op" id="6558651">,</span>&nbsp;<span class="ident" id="6558653">color</span><span class="op" id="6558658">.</span><span class="ident" id="6558659">RGBA</span><span class="op" id="6558663">{</span><span class="num" id="6558664">0</span><span class="op" id="6558665">,</span>&nbsp;<span class="num" id="6558667">0</span><span class="op" id="6558668">,</span>&nbsp;<span class="num" id="6558670">0</span><span class="op" id="6558671">,</span>&nbsp;<span class="num" id="6558673">255</span><span class="op" id="6558676">}</span><span class="op" id="6558677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558687">if</span>&nbsp;<span class="op" id="6558690">!</span><span class="ident" id="6558691">img</span><span class="op" id="6558694">.</span><span class="ident" id="6558695">Opaque</span><span class="op" id="6558701">(</span><span class="op" id="6558702">)</span>&nbsp;<span class="op" id="6558704">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558708">b</span><span class="op" id="6558709">.</span><span class="ident" id="6558710">Fatal</span><span class="op" id="6558715">(</span><span class="string" id="6558716">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6558745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558751">b</span><span class="op" id="6558752">.</span><span class="ident" id="6558753">SetBytes</span><span class="op" id="6558761">(</span><span class="num" id="6558762">640</span>&nbsp;<span class="op" id="6558766">*</span>&nbsp;<span class="num" id="6558768">480</span>&nbsp;<span class="op" id="6558772">*</span>&nbsp;<span class="num" id="6558774">4</span><span class="op" id="6558775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558778">b</span><span class="op" id="6558779">.</span><span class="ident" id="6558780">StartTimer</span><span class="op" id="6558790">(</span><span class="op" id="6558791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558794">for</span>&nbsp;<span class="ident" id="6558798">i</span>&nbsp;<span class="op" id="6558800">:=</span>&nbsp;<span class="num" id="6558803">0</span><span class="op" id="6558804">;</span>&nbsp;<span class="ident" id="6558806">i</span>&nbsp;<span class="op" id="6558808">&lt;</span>&nbsp;<span class="ident" id="6558810">b</span><span class="op" id="6558811">.</span><span class="ident" id="6558812">N</span><span class="op" id="6558813">;</span>&nbsp;<span class="ident" id="6558815">i</span><span class="op" id="6558816">++</span>&nbsp;<span class="op" id="6558819">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558823">Encode</span><span class="op" id="6558829">(</span><span class="ident" id="6558830">ioutil</span><span class="op" id="6558836">.</span><span class="ident" id="6558837">Discard</span><span class="op" id="6558844">,</span>&nbsp;<span class="ident" id="6558846">img</span><span class="op" id="6558849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558852">}</span><br>
<span class="lineno"></span><span class="op" id="6558854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6558857">func</span>&nbsp;<span class="ident" id="6558862">BenchmarkEncodeRGBA</span><span class="op" id="6558881">(</span><span class="ident" id="6558882">b</span>&nbsp;<span class="op" id="6558884">*</span><span class="ident" id="6558885">testing</span><span class="op" id="6558892">.</span><span class="ident" id="6558893">B</span><span class="op" id="6558894">)</span>&nbsp;<span class="op" id="6558896">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558899">b</span><span class="op" id="6558900">.</span><span class="ident" id="6558901">StopTimer</span><span class="op" id="6558910">(</span><span class="op" id="6558911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558914">img</span>&nbsp;<span class="op" id="6558918">:=</span>&nbsp;<span class="ident" id="6558921">image</span><span class="op" id="6558926">.</span><span class="ident" id="6558927">NewRGBA</span><span class="op" id="6558934">(</span><span class="ident" id="6558935">image</span><span class="op" id="6558940">.</span><span class="ident" id="6558941">Rect</span><span class="op" id="6558945">(</span><span class="num" id="6558946">0</span><span class="op" id="6558947">,</span>&nbsp;<span class="num" id="6558949">0</span><span class="op" id="6558950">,</span>&nbsp;<span class="num" id="6558952">640</span><span class="op" id="6558955">,</span>&nbsp;<span class="num" id="6558957">480</span><span class="op" id="6558960">)</span><span class="op" id="6558961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6558964">if</span>&nbsp;<span class="ident" id="6558967">img</span><span class="op" id="6558970">.</span><span class="ident" id="6558971">Opaque</span><span class="op" id="6558977">(</span><span class="op" id="6558978">)</span>&nbsp;<span class="op" id="6558980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6558984">b</span><span class="op" id="6558985">.</span><span class="ident" id="6558986">Fatal</span><span class="op" id="6558991">(</span><span class="string" id="6558992">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6559025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559028">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559031">b</span><span class="op" id="6559032">.</span><span class="ident" id="6559033">SetBytes</span><span class="op" id="6559041">(</span><span class="num" id="6559042">640</span>&nbsp;<span class="op" id="6559046">*</span>&nbsp;<span class="num" id="6559048">480</span>&nbsp;<span class="op" id="6559052">*</span>&nbsp;<span class="num" id="6559054">4</span><span class="op" id="6559055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559058">b</span><span class="op" id="6559059">.</span><span class="ident" id="6559060">StartTimer</span><span class="op" id="6559070">(</span><span class="op" id="6559071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6559074">for</span>&nbsp;<span class="ident" id="6559078">i</span>&nbsp;<span class="op" id="6559080">:=</span>&nbsp;<span class="num" id="6559083">0</span><span class="op" id="6559084">;</span>&nbsp;<span class="ident" id="6559086">i</span>&nbsp;<span class="op" id="6559088">&lt;</span>&nbsp;<span class="ident" id="6559090">b</span><span class="op" id="6559091">.</span><span class="ident" id="6559092">N</span><span class="op" id="6559093">;</span>&nbsp;<span class="ident" id="6559095">i</span><span class="op" id="6559096">++</span>&nbsp;<span class="op" id="6559099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6559103">Encode</span><span class="op" id="6559109">(</span><span class="ident" id="6559110">ioutil</span><span class="op" id="6559116">.</span><span class="ident" id="6559117">Discard</span><span class="op" id="6559124">,</span>&nbsp;<span class="ident" id="6559126">img</span><span class="op" id="6559129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559132">}</span><br>
<span class="lineno">210</span><span class="op" id="6559134">}</span>
</div>
</body>
</html>
