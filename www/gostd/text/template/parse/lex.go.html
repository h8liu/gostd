<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html" class="current">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3262181">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3262236">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3262290">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3262341">package</span>&nbsp;<span class="ident" id="3262349">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3262356">import</span>&nbsp;<span class="op" id="3262363">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3262366">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3262373">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3262384">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3262395">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3262410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3262413">//&nbsp;item&nbsp;represents&nbsp;a&nbsp;token&nbsp;or&nbsp;text&nbsp;string&nbsp;returned&nbsp;from&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">15</span><span class="keyword" id="3262482">type</span>&nbsp;<span class="ident" id="3262487">item</span>&nbsp;<span class="keyword" id="3262492">struct</span>&nbsp;<span class="op" id="3262499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262502">typ</span>&nbsp;<span class="ident" id="3262506">itemType</span>&nbsp;<span class="comment" id="3262515">//&nbsp;The&nbsp;type&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262542">pos</span>&nbsp;<span class="ident" id="3262546">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3262555">//&nbsp;The&nbsp;starting&nbsp;position,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;this&nbsp;item&nbsp;in&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3262626">val</span>&nbsp;<span class="builtintype" id="3262630">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3262639">//&nbsp;The&nbsp;value&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span><span class="op" id="3262666">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3262669">func</span>&nbsp;<span class="op" id="3262674">(</span><span class="ident" id="3262675">i</span>&nbsp;<span class="ident" id="3262677">item</span><span class="op" id="3262681">)</span>&nbsp;<span class="ident" id="3262683">String</span><span class="op" id="3262689">(</span><span class="op" id="3262690">)</span>&nbsp;<span class="builtintype" id="3262692">string</span>&nbsp;<span class="op" id="3262699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262702">switch</span>&nbsp;<span class="op" id="3262709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262712">case</span>&nbsp;<span class="ident" id="3262717">i</span><span class="op" id="3262718">.</span><span class="ident" id="3262719">typ</span>&nbsp;<span class="op" id="3262723">==</span>&nbsp;<span class="ident" id="3262726">itemEOF</span><span class="op" id="3262733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262737">return</span>&nbsp;<span class="string" id="3262744">&#34;EOF&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262751">case</span>&nbsp;<span class="ident" id="3262756">i</span><span class="op" id="3262757">.</span><span class="ident" id="3262758">typ</span>&nbsp;<span class="op" id="3262762">==</span>&nbsp;<span class="ident" id="3262765">itemError</span><span class="op" id="3262774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262778">return</span>&nbsp;<span class="ident" id="3262785">i</span><span class="op" id="3262786">.</span><span class="ident" id="3262787">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262792">case</span>&nbsp;<span class="ident" id="3262797">i</span><span class="op" id="3262798">.</span><span class="ident" id="3262799">typ</span>&nbsp;<span class="op" id="3262803">&gt;</span>&nbsp;<span class="ident" id="3262805">itemKeyword</span><span class="op" id="3262816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262820">return</span>&nbsp;<span class="ident" id="3262827">fmt</span><span class="op" id="3262830">.</span><span class="ident" id="3262831">Sprintf</span><span class="op" id="3262838">(</span><span class="string" id="3262839">&#34;&lt;%s&gt;&#34;</span><span class="op" id="3262845">,</span>&nbsp;<span class="ident" id="3262847">i</span><span class="op" id="3262848">.</span><span class="ident" id="3262849">val</span><span class="op" id="3262852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262855">case</span>&nbsp;<span class="builtinfunc" id="3262860">len</span><span class="op" id="3262863">(</span><span class="ident" id="3262864">i</span><span class="op" id="3262865">.</span><span class="ident" id="3262866">val</span><span class="op" id="3262869">)</span>&nbsp;<span class="op" id="3262871">&gt;</span>&nbsp;<span class="num" id="3262873">10</span><span class="op" id="3262875">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262879">return</span>&nbsp;<span class="ident" id="3262886">fmt</span><span class="op" id="3262889">.</span><span class="ident" id="3262890">Sprintf</span><span class="op" id="3262897">(</span><span class="string" id="3262898">&#34;%.10q...&#34;</span><span class="op" id="3262908">,</span>&nbsp;<span class="ident" id="3262910">i</span><span class="op" id="3262911">.</span><span class="ident" id="3262912">val</span><span class="op" id="3262915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3262918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3262921">return</span>&nbsp;<span class="ident" id="3262928">fmt</span><span class="op" id="3262931">.</span><span class="ident" id="3262932">Sprintf</span><span class="op" id="3262939">(</span><span class="string" id="3262940">&#34;%q&#34;</span><span class="op" id="3262944">,</span>&nbsp;<span class="ident" id="3262946">i</span><span class="op" id="3262947">.</span><span class="ident" id="3262948">val</span><span class="op" id="3262951">)</span><br>
<span class="lineno"></span><span class="op" id="3262953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3262956">//&nbsp;itemType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;lex&nbsp;items.</span><br>
<span class="lineno"></span><span class="keyword" id="3263002">type</span>&nbsp;<span class="ident" id="3263007">itemType</span>&nbsp;<span class="builtintype" id="3263016">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3263021">const</span>&nbsp;<span class="op" id="3263027">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263030">itemError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3263047">itemType</span>&nbsp;<span class="op" id="3263056">=</span>&nbsp;<span class="ident" id="3263058">iota</span>&nbsp;<span class="comment" id="3263063">//&nbsp;error&nbsp;occurred;&nbsp;value&nbsp;is&nbsp;text&nbsp;of&nbsp;error</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263106">itemBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263139">//&nbsp;boolean&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263160">itemChar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263193">//&nbsp;printable&nbsp;ASCII&nbsp;character;&nbsp;grab&nbsp;bag&nbsp;for&nbsp;comma&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263248">itemCharConstant</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263281">//&nbsp;character&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263304">itemComplex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263337">//&nbsp;complex&nbsp;constant&nbsp;(1+2i);&nbsp;imaginary&nbsp;is&nbsp;just&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263393">itemColonEquals</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263426">//&nbsp;colon-equals&nbsp;(&#39;:=&#39;)&nbsp;introducing&nbsp;a&nbsp;declaration</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263476">itemEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263485">itemField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263500">//&nbsp;alphanumeric&nbsp;identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263546">itemIdentifier</span>&nbsp;<span class="comment" id="3263561">//&nbsp;alphanumeric&nbsp;identifier&nbsp;not&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263611">itemLeftDelim</span>&nbsp;&nbsp;<span class="comment" id="3263626">//&nbsp;left&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263652">itemLeftParen</span>&nbsp;&nbsp;<span class="comment" id="3263667">//&nbsp;&#39;(&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263689">itemNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263704">//&nbsp;simple&nbsp;number,&nbsp;including&nbsp;imaginary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263743">itemPipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263758">//&nbsp;pipe&nbsp;symbol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263774">itemRawString</span>&nbsp;&nbsp;<span class="comment" id="3263789">//&nbsp;raw&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263829">itemRightDelim</span>&nbsp;<span class="comment" id="3263844">//&nbsp;right&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263871">itemRightParen</span>&nbsp;<span class="comment" id="3263886">//&nbsp;&#39;)&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263908">itemSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263923">//&nbsp;run&nbsp;of&nbsp;spaces&nbsp;separating&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3263962">itemString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3263977">//&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264013">itemText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264028">//&nbsp;plain&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264043">itemVariable</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3264058">//&nbsp;variable&nbsp;starting&nbsp;with&nbsp;&#39;$&#39;,&nbsp;such&nbsp;as&nbsp;&#39;$&#39;&nbsp;or&nbsp;&nbsp;&#39;$1&#39;&nbsp;or&nbsp;&#39;$hello&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3264123">//&nbsp;Keywords&nbsp;appear&nbsp;after&nbsp;all&nbsp;the&nbsp;rest.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264163">itemKeyword</span>&nbsp;&nbsp;<span class="comment" id="3264176">//&nbsp;used&nbsp;only&nbsp;to&nbsp;delimit&nbsp;the&nbsp;keywords</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264214">itemDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264227">//&nbsp;the&nbsp;cursor,&nbsp;spelled&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264255">itemDefine</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3264268">//&nbsp;define&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264287">itemElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264300">//&nbsp;else&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264317">itemEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264330">//&nbsp;end&nbsp;keyword</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264346">itemIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264359">//&nbsp;if&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264374">itemNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264387">//&nbsp;the&nbsp;untyped&nbsp;nil&nbsp;constant,&nbsp;easiest&nbsp;to&nbsp;treat&nbsp;as&nbsp;a&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264447">itemRange</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264460">//&nbsp;range&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264478">itemTemplate</span>&nbsp;<span class="comment" id="3264491">//&nbsp;template&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264512">itemWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3264525">//&nbsp;with&nbsp;keyword</span><br>
<span class="lineno">70</span><span class="op" id="3264541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3264544">var</span>&nbsp;<span class="ident" id="3264548">key</span>&nbsp;<span class="op" id="3264552">=</span>&nbsp;<span class="keyword" id="3264554">map</span><span class="op" id="3264557">[</span><span class="builtintype" id="3264558">string</span><span class="op" id="3264564">]</span><span class="ident" id="3264565">itemType</span><span class="op" id="3264573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264576">&#34;.&#34;</span><span class="op" id="3264579">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264588">itemDot</span><span class="op" id="3264595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264598">&#34;define&#34;</span><span class="op" id="3264606">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3264610">itemDefine</span><span class="op" id="3264620">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264623">&#34;else&#34;</span><span class="op" id="3264629">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264635">itemElse</span><span class="op" id="3264643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264646">&#34;end&#34;</span><span class="op" id="3264651">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264658">itemEnd</span><span class="op" id="3264665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264668">&#34;if&#34;</span><span class="op" id="3264672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264680">itemIf</span><span class="op" id="3264686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264689">&#34;range&#34;</span><span class="op" id="3264696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264701">itemRange</span><span class="op" id="3264710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264713">&#34;nil&#34;</span><span class="op" id="3264718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264725">itemNil</span><span class="op" id="3264732">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264735">&#34;template&#34;</span><span class="op" id="3264745">:</span>&nbsp;<span class="ident" id="3264747">itemTemplate</span><span class="op" id="3264759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3264762">&#34;with&#34;</span><span class="op" id="3264768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3264774">itemWith</span><span class="op" id="3264782">,</span><br>
<span class="lineno"></span><span class="op" id="3264784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3264787">const</span>&nbsp;<span class="ident" id="3264793">eof</span>&nbsp;<span class="op" id="3264797">=</span>&nbsp;<span class="op" id="3264799">-</span><span class="num" id="3264800">1</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3264803">//&nbsp;stateFn&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner&nbsp;as&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;the&nbsp;next&nbsp;state.</span><br>
<span class="lineno"></span><span class="keyword" id="3264893">type</span>&nbsp;<span class="ident" id="3264898">stateFn</span>&nbsp;<span class="keyword" id="3264906">func</span><span class="op" id="3264910">(</span><span class="op" id="3264911">*</span><span class="ident" id="3264912">lexer</span><span class="op" id="3264917">)</span>&nbsp;<span class="ident" id="3264919">stateFn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3264928">//&nbsp;lexer&nbsp;holds&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">90</span><span class="keyword" id="3264969">type</span>&nbsp;<span class="ident" id="3264974">lexer</span>&nbsp;<span class="keyword" id="3264980">struct</span>&nbsp;<span class="op" id="3264987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3264990">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3265001">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265011">//&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;input;&nbsp;used&nbsp;only&nbsp;for&nbsp;error&nbsp;reports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265066">input</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3265077">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265087">//&nbsp;the&nbsp;string&nbsp;being&nbsp;scanned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265116">leftDelim</span>&nbsp;&nbsp;<span class="builtintype" id="3265127">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265137">//&nbsp;start&nbsp;of&nbsp;action</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265157">rightDelim</span>&nbsp;<span class="builtintype" id="3265168">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265178">//&nbsp;end&nbsp;of&nbsp;action</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265196">state</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265207">stateFn</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3265217">//&nbsp;the&nbsp;next&nbsp;lexing&nbsp;function&nbsp;to&nbsp;enter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265255">pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265266">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265276">//&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265310">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265321">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265331">//&nbsp;start&nbsp;position&nbsp;of&nbsp;this&nbsp;item</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265363">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265374">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265384">//&nbsp;width&nbsp;of&nbsp;last&nbsp;rune&nbsp;read&nbsp;from&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265423">lastPos</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3265434">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265444">//&nbsp;position&nbsp;of&nbsp;most&nbsp;recent&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265498">items</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3265509">chan</span>&nbsp;<span class="ident" id="3265514">item</span>&nbsp;<span class="comment" id="3265519">//&nbsp;channel&nbsp;of&nbsp;scanned&nbsp;items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265548">parenDepth</span>&nbsp;<span class="builtintype" id="3265559">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3265569">//&nbsp;nesting&nbsp;depth&nbsp;of&nbsp;(&nbsp;)&nbsp;exprs</span><br>
<span class="lineno"></span><span class="op" id="3265599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3265602">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">105</span><span class="keyword" id="3265646">func</span>&nbsp;<span class="op" id="3265651">(</span><span class="ident" id="3265652">l</span>&nbsp;<span class="op" id="3265654">*</span><span class="ident" id="3265655">lexer</span><span class="op" id="3265660">)</span>&nbsp;<span class="ident" id="3265662">next</span><span class="op" id="3265666">(</span><span class="op" id="3265667">)</span>&nbsp;<span class="builtintype" id="3265669">rune</span>&nbsp;<span class="op" id="3265674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265677">if</span>&nbsp;<span class="builtintype" id="3265680">int</span><span class="op" id="3265683">(</span><span class="ident" id="3265684">l</span><span class="op" id="3265685">.</span><span class="ident" id="3265686">pos</span><span class="op" id="3265689">)</span>&nbsp;<span class="op" id="3265691">&gt;=</span>&nbsp;<span class="builtinfunc" id="3265694">len</span><span class="op" id="3265697">(</span><span class="ident" id="3265698">l</span><span class="op" id="3265699">.</span><span class="ident" id="3265700">input</span><span class="op" id="3265705">)</span>&nbsp;<span class="op" id="3265707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265711">l</span><span class="op" id="3265712">.</span><span class="ident" id="3265713">width</span>&nbsp;<span class="op" id="3265719">=</span>&nbsp;<span class="num" id="3265721">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265725">return</span>&nbsp;<span class="ident" id="3265732">eof</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3265737">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265740">r</span><span class="op" id="3265741">,</span>&nbsp;<span class="ident" id="3265743">w</span>&nbsp;<span class="op" id="3265745">:=</span>&nbsp;<span class="ident" id="3265748">utf8</span><span class="op" id="3265752">.</span><span class="ident" id="3265753">DecodeRuneInString</span><span class="op" id="3265771">(</span><span class="ident" id="3265772">l</span><span class="op" id="3265773">.</span><span class="ident" id="3265774">input</span><span class="op" id="3265779">[</span><span class="ident" id="3265780">l</span><span class="op" id="3265781">.</span><span class="ident" id="3265782">pos</span><span class="op" id="3265785">:</span><span class="op" id="3265786">]</span><span class="op" id="3265787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265790">l</span><span class="op" id="3265791">.</span><span class="ident" id="3265792">width</span>&nbsp;<span class="op" id="3265798">=</span>&nbsp;<span class="ident" id="3265800">Pos</span><span class="op" id="3265803">(</span><span class="ident" id="3265804">w</span><span class="op" id="3265805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265808">l</span><span class="op" id="3265809">.</span><span class="ident" id="3265810">pos</span>&nbsp;<span class="op" id="3265814">+=</span>&nbsp;<span class="ident" id="3265817">l</span><span class="op" id="3265818">.</span><span class="ident" id="3265819">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265826">return</span>&nbsp;<span class="ident" id="3265833">r</span><br>
<span class="lineno"></span><span class="op" id="3265835">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3265838">//&nbsp;peek&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="3265903">func</span>&nbsp;<span class="op" id="3265908">(</span><span class="ident" id="3265909">l</span>&nbsp;<span class="op" id="3265911">*</span><span class="ident" id="3265912">lexer</span><span class="op" id="3265917">)</span>&nbsp;<span class="ident" id="3265919">peek</span><span class="op" id="3265923">(</span><span class="op" id="3265924">)</span>&nbsp;<span class="builtintype" id="3265926">rune</span>&nbsp;<span class="op" id="3265931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265934">r</span>&nbsp;<span class="op" id="3265936">:=</span>&nbsp;<span class="ident" id="3265939">l</span><span class="op" id="3265940">.</span><span class="ident" id="3265941">next</span><span class="op" id="3265945">(</span><span class="op" id="3265946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3265949">l</span><span class="op" id="3265950">.</span><span class="ident" id="3265951">backup</span><span class="op" id="3265957">(</span><span class="op" id="3265958">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3265961">return</span>&nbsp;<span class="ident" id="3265968">r</span><br>
<span class="lineno"></span><span class="op" id="3265970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3265973">//&nbsp;backup&nbsp;steps&nbsp;back&nbsp;one&nbsp;rune.&nbsp;Can&nbsp;only&nbsp;be&nbsp;called&nbsp;once&nbsp;per&nbsp;call&nbsp;of&nbsp;next.</span><br>
<span class="lineno"></span><span class="keyword" id="3266046">func</span>&nbsp;<span class="op" id="3266051">(</span><span class="ident" id="3266052">l</span>&nbsp;<span class="op" id="3266054">*</span><span class="ident" id="3266055">lexer</span><span class="op" id="3266060">)</span>&nbsp;<span class="ident" id="3266062">backup</span><span class="op" id="3266068">(</span><span class="op" id="3266069">)</span>&nbsp;<span class="op" id="3266071">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266074">l</span><span class="op" id="3266075">.</span><span class="ident" id="3266076">pos</span>&nbsp;<span class="op" id="3266080">-=</span>&nbsp;<span class="ident" id="3266083">l</span><span class="op" id="3266084">.</span><span class="ident" id="3266085">width</span><br>
<span class="lineno"></span><span class="op" id="3266091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3266094">//&nbsp;emit&nbsp;passes&nbsp;an&nbsp;item&nbsp;back&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="keyword" id="3266137">func</span>&nbsp;<span class="op" id="3266142">(</span><span class="ident" id="3266143">l</span>&nbsp;<span class="op" id="3266145">*</span><span class="ident" id="3266146">lexer</span><span class="op" id="3266151">)</span>&nbsp;<span class="ident" id="3266153">emit</span><span class="op" id="3266157">(</span><span class="ident" id="3266158">t</span>&nbsp;<span class="ident" id="3266160">itemType</span><span class="op" id="3266168">)</span>&nbsp;<span class="op" id="3266170">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266173">l</span><span class="op" id="3266174">.</span><span class="ident" id="3266175">items</span>&nbsp;<span class="op" id="3266181">&lt;-</span>&nbsp;<span class="ident" id="3266184">item</span><span class="op" id="3266188">{</span><span class="ident" id="3266189">t</span><span class="op" id="3266190">,</span>&nbsp;<span class="ident" id="3266192">l</span><span class="op" id="3266193">.</span><span class="ident" id="3266194">start</span><span class="op" id="3266199">,</span>&nbsp;<span class="ident" id="3266201">l</span><span class="op" id="3266202">.</span><span class="ident" id="3266203">input</span><span class="op" id="3266208">[</span><span class="ident" id="3266209">l</span><span class="op" id="3266210">.</span><span class="ident" id="3266211">start</span><span class="op" id="3266216">:</span><span class="ident" id="3266217">l</span><span class="op" id="3266218">.</span><span class="ident" id="3266219">pos</span><span class="op" id="3266222">]</span><span class="op" id="3266223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266226">l</span><span class="op" id="3266227">.</span><span class="ident" id="3266228">start</span>&nbsp;<span class="op" id="3266234">=</span>&nbsp;<span class="ident" id="3266236">l</span><span class="op" id="3266237">.</span><span class="ident" id="3266238">pos</span><br>
<span class="lineno"></span><span class="op" id="3266242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3266245">//&nbsp;ignore&nbsp;skips&nbsp;over&nbsp;the&nbsp;pending&nbsp;input&nbsp;before&nbsp;this&nbsp;point.</span><br>
<span class="lineno">135</span><span class="keyword" id="3266303">func</span>&nbsp;<span class="op" id="3266308">(</span><span class="ident" id="3266309">l</span>&nbsp;<span class="op" id="3266311">*</span><span class="ident" id="3266312">lexer</span><span class="op" id="3266317">)</span>&nbsp;<span class="ident" id="3266319">ignore</span><span class="op" id="3266325">(</span><span class="op" id="3266326">)</span>&nbsp;<span class="op" id="3266328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266331">l</span><span class="op" id="3266332">.</span><span class="ident" id="3266333">start</span>&nbsp;<span class="op" id="3266339">=</span>&nbsp;<span class="ident" id="3266341">l</span><span class="op" id="3266342">.</span><span class="ident" id="3266343">pos</span><br>
<span class="lineno"></span><span class="op" id="3266347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3266350">//&nbsp;accept&nbsp;consumes&nbsp;the&nbsp;next&nbsp;rune&nbsp;if&nbsp;it&#39;s&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno">140</span><span class="keyword" id="3266411">func</span>&nbsp;<span class="op" id="3266416">(</span><span class="ident" id="3266417">l</span>&nbsp;<span class="op" id="3266419">*</span><span class="ident" id="3266420">lexer</span><span class="op" id="3266425">)</span>&nbsp;<span class="ident" id="3266427">accept</span><span class="op" id="3266433">(</span><span class="ident" id="3266434">valid</span>&nbsp;<span class="builtintype" id="3266440">string</span><span class="op" id="3266446">)</span>&nbsp;<span class="builtintype" id="3266448">bool</span>&nbsp;<span class="op" id="3266453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266456">if</span>&nbsp;<span class="ident" id="3266459">strings</span><span class="op" id="3266466">.</span><span class="ident" id="3266467">IndexRune</span><span class="op" id="3266476">(</span><span class="ident" id="3266477">valid</span><span class="op" id="3266482">,</span>&nbsp;<span class="ident" id="3266484">l</span><span class="op" id="3266485">.</span><span class="ident" id="3266486">next</span><span class="op" id="3266490">(</span><span class="op" id="3266491">)</span><span class="op" id="3266492">)</span>&nbsp;<span class="op" id="3266494">&gt;=</span>&nbsp;<span class="num" id="3266497">0</span>&nbsp;<span class="op" id="3266499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266503">return</span>&nbsp;<span class="builtintype" id="3266510">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266519">l</span><span class="op" id="3266520">.</span><span class="ident" id="3266521">backup</span><span class="op" id="3266527">(</span><span class="op" id="3266528">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266531">return</span>&nbsp;<span class="builtintype" id="3266538">false</span><br>
<span class="lineno"></span><span class="op" id="3266544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3266547">//&nbsp;acceptRun&nbsp;consumes&nbsp;a&nbsp;run&nbsp;of&nbsp;runes&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="3266604">func</span>&nbsp;<span class="op" id="3266609">(</span><span class="ident" id="3266610">l</span>&nbsp;<span class="op" id="3266612">*</span><span class="ident" id="3266613">lexer</span><span class="op" id="3266618">)</span>&nbsp;<span class="ident" id="3266620">acceptRun</span><span class="op" id="3266629">(</span><span class="ident" id="3266630">valid</span>&nbsp;<span class="builtintype" id="3266636">string</span><span class="op" id="3266642">)</span>&nbsp;<span class="op" id="3266644">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266647">for</span>&nbsp;<span class="ident" id="3266651">strings</span><span class="op" id="3266658">.</span><span class="ident" id="3266659">IndexRune</span><span class="op" id="3266668">(</span><span class="ident" id="3266669">valid</span><span class="op" id="3266674">,</span>&nbsp;<span class="ident" id="3266676">l</span><span class="op" id="3266677">.</span><span class="ident" id="3266678">next</span><span class="op" id="3266682">(</span><span class="op" id="3266683">)</span><span class="op" id="3266684">)</span>&nbsp;<span class="op" id="3266686">&gt;=</span>&nbsp;<span class="num" id="3266689">0</span>&nbsp;<span class="op" id="3266691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3266694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3266697">l</span><span class="op" id="3266698">.</span><span class="ident" id="3266699">backup</span><span class="op" id="3266705">(</span><span class="op" id="3266706">)</span><br>
<span class="lineno"></span><span class="op" id="3266708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3266711">//&nbsp;lineNumber&nbsp;reports&nbsp;which&nbsp;line&nbsp;we&#39;re&nbsp;on,&nbsp;based&nbsp;on&nbsp;the&nbsp;position&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3266779">//&nbsp;the&nbsp;previous&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem.&nbsp;Doing&nbsp;it&nbsp;this&nbsp;way</span><br>
<span class="lineno"></span><span class="comment" id="3266840">//&nbsp;means&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;peek&nbsp;double&nbsp;counting.</span><br>
<span class="lineno"></span><span class="keyword" id="3266900">func</span>&nbsp;<span class="op" id="3266905">(</span><span class="ident" id="3266906">l</span>&nbsp;<span class="op" id="3266908">*</span><span class="ident" id="3266909">lexer</span><span class="op" id="3266914">)</span>&nbsp;<span class="ident" id="3266916">lineNumber</span><span class="op" id="3266926">(</span><span class="op" id="3266927">)</span>&nbsp;<span class="builtintype" id="3266929">int</span>&nbsp;<span class="op" id="3266933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3266936">return</span>&nbsp;<span class="num" id="3266943">1</span>&nbsp;<span class="op" id="3266945">+</span>&nbsp;<span class="ident" id="3266947">strings</span><span class="op" id="3266954">.</span><span class="ident" id="3266955">Count</span><span class="op" id="3266960">(</span><span class="ident" id="3266961">l</span><span class="op" id="3266962">.</span><span class="ident" id="3266963">input</span><span class="op" id="3266968">[</span><span class="op" id="3266969">:</span><span class="ident" id="3266970">l</span><span class="op" id="3266971">.</span><span class="ident" id="3266972">lastPos</span><span class="op" id="3266979">]</span><span class="op" id="3266980">,</span>&nbsp;<span class="string" id="3266982">&#34;\n&#34;</span><span class="op" id="3266986">)</span><br>
<span class="lineno">160</span><span class="op" id="3266988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3266991">//&nbsp;errorf&nbsp;returns&nbsp;an&nbsp;error&nbsp;token&nbsp;and&nbsp;terminates&nbsp;the&nbsp;scan&nbsp;by&nbsp;passing</span><br>
<span class="lineno"></span><span class="comment" id="3267059">//&nbsp;back&nbsp;a&nbsp;nil&nbsp;pointer&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;next&nbsp;state,&nbsp;terminating&nbsp;l.nextItem.</span><br>
<span class="lineno"></span><span class="keyword" id="3267134">func</span>&nbsp;<span class="op" id="3267139">(</span><span class="ident" id="3267140">l</span>&nbsp;<span class="op" id="3267142">*</span><span class="ident" id="3267143">lexer</span><span class="op" id="3267148">)</span>&nbsp;<span class="ident" id="3267150">errorf</span><span class="op" id="3267156">(</span><span class="ident" id="3267157">format</span>&nbsp;<span class="builtintype" id="3267164">string</span><span class="op" id="3267170">,</span>&nbsp;<span class="ident" id="3267172">args</span>&nbsp;<span class="op" id="3267177">...</span><span class="keyword" id="3267180">interface</span><span class="op" id="3267189">{</span><span class="op" id="3267190">}</span><span class="op" id="3267191">)</span>&nbsp;<span class="ident" id="3267193">stateFn</span>&nbsp;<span class="op" id="3267201">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267204">l</span><span class="op" id="3267205">.</span><span class="ident" id="3267206">items</span>&nbsp;<span class="op" id="3267212">&lt;-</span>&nbsp;<span class="ident" id="3267215">item</span><span class="op" id="3267219">{</span><span class="ident" id="3267220">itemError</span><span class="op" id="3267229">,</span>&nbsp;<span class="ident" id="3267231">l</span><span class="op" id="3267232">.</span><span class="ident" id="3267233">start</span><span class="op" id="3267238">,</span>&nbsp;<span class="ident" id="3267240">fmt</span><span class="op" id="3267243">.</span><span class="ident" id="3267244">Sprintf</span><span class="op" id="3267251">(</span><span class="ident" id="3267252">format</span><span class="op" id="3267258">,</span>&nbsp;<span class="ident" id="3267260">args</span><span class="op" id="3267264">...</span><span class="op" id="3267267">)</span><span class="op" id="3267268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267271">return</span>&nbsp;<span class="ident" id="3267278">nil</span><br>
<span class="lineno"></span><span class="op" id="3267282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3267285">//&nbsp;nextItem&nbsp;returns&nbsp;the&nbsp;next&nbsp;item&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">170</span><span class="keyword" id="3267335">func</span>&nbsp;<span class="op" id="3267340">(</span><span class="ident" id="3267341">l</span>&nbsp;<span class="op" id="3267343">*</span><span class="ident" id="3267344">lexer</span><span class="op" id="3267349">)</span>&nbsp;<span class="ident" id="3267351">nextItem</span><span class="op" id="3267359">(</span><span class="op" id="3267360">)</span>&nbsp;<span class="ident" id="3267362">item</span>&nbsp;<span class="op" id="3267367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267370">item</span>&nbsp;<span class="op" id="3267375">:=</span>&nbsp;<span class="op" id="3267378">&lt;-</span><span class="ident" id="3267380">l</span><span class="op" id="3267381">.</span><span class="ident" id="3267382">items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267389">l</span><span class="op" id="3267390">.</span><span class="ident" id="3267391">lastPos</span>&nbsp;<span class="op" id="3267399">=</span>&nbsp;<span class="ident" id="3267401">item</span><span class="op" id="3267405">.</span><span class="ident" id="3267406">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267411">return</span>&nbsp;<span class="ident" id="3267418">item</span><br>
<span class="lineno"></span><span class="op" id="3267423">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="3267426">//&nbsp;lex&nbsp;creates&nbsp;a&nbsp;new&nbsp;scanner&nbsp;for&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3267477">func</span>&nbsp;<span class="ident" id="3267482">lex</span><span class="op" id="3267485">(</span><span class="ident" id="3267486">name</span><span class="op" id="3267490">,</span>&nbsp;<span class="ident" id="3267492">input</span><span class="op" id="3267497">,</span>&nbsp;<span class="ident" id="3267499">left</span><span class="op" id="3267503">,</span>&nbsp;<span class="ident" id="3267505">right</span>&nbsp;<span class="builtintype" id="3267511">string</span><span class="op" id="3267517">)</span>&nbsp;<span class="op" id="3267519">*</span><span class="ident" id="3267520">lexer</span>&nbsp;<span class="op" id="3267526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267529">if</span>&nbsp;<span class="ident" id="3267532">left</span>&nbsp;<span class="op" id="3267537">==</span>&nbsp;<span class="string" id="3267540">&#34;&#34;</span>&nbsp;<span class="op" id="3267543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267547">left</span>&nbsp;<span class="op" id="3267552">=</span>&nbsp;<span class="ident" id="3267554">leftDelim</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267568">if</span>&nbsp;<span class="ident" id="3267571">right</span>&nbsp;<span class="op" id="3267577">==</span>&nbsp;<span class="string" id="3267580">&#34;&#34;</span>&nbsp;<span class="op" id="3267583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267587">right</span>&nbsp;<span class="op" id="3267593">=</span>&nbsp;<span class="ident" id="3267595">rightDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267610">l</span>&nbsp;<span class="op" id="3267612">:=</span>&nbsp;<span class="op" id="3267615">&amp;</span><span class="ident" id="3267616">lexer</span><span class="op" id="3267621">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267625">name</span><span class="op" id="3267629">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267637">name</span><span class="op" id="3267641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267645">input</span><span class="op" id="3267650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3267657">input</span><span class="op" id="3267662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267666">leftDelim</span><span class="op" id="3267675">:</span>&nbsp;&nbsp;<span class="ident" id="3267678">left</span><span class="op" id="3267682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267686">rightDelim</span><span class="op" id="3267696">:</span>&nbsp;<span class="ident" id="3267698">right</span><span class="op" id="3267703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267707">items</span><span class="op" id="3267712">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3267719">make</span><span class="op" id="3267723">(</span><span class="keyword" id="3267724">chan</span>&nbsp;<span class="ident" id="3267729">item</span><span class="op" id="3267733">)</span><span class="op" id="3267734">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267740">go</span>&nbsp;<span class="ident" id="3267743">l</span><span class="op" id="3267744">.</span><span class="ident" id="3267745">run</span><span class="op" id="3267748">(</span><span class="op" id="3267749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267752">return</span>&nbsp;<span class="ident" id="3267759">l</span><br>
<span class="lineno"></span><span class="op" id="3267761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3267764">//&nbsp;run&nbsp;runs&nbsp;the&nbsp;state&nbsp;machine&nbsp;for&nbsp;the&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="3267809">func</span>&nbsp;<span class="op" id="3267814">(</span><span class="ident" id="3267815">l</span>&nbsp;<span class="op" id="3267817">*</span><span class="ident" id="3267818">lexer</span><span class="op" id="3267823">)</span>&nbsp;<span class="ident" id="3267825">run</span><span class="op" id="3267828">(</span><span class="op" id="3267829">)</span>&nbsp;<span class="op" id="3267831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3267834">for</span>&nbsp;<span class="ident" id="3267838">l</span><span class="op" id="3267839">.</span><span class="ident" id="3267840">state</span>&nbsp;<span class="op" id="3267846">=</span>&nbsp;<span class="ident" id="3267848">lexText</span><span class="op" id="3267855">;</span>&nbsp;<span class="ident" id="3267857">l</span><span class="op" id="3267858">.</span><span class="ident" id="3267859">state</span>&nbsp;<span class="op" id="3267865">!=</span>&nbsp;<span class="ident" id="3267868">nil</span><span class="op" id="3267871">;</span>&nbsp;<span class="op" id="3267873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267877">l</span><span class="op" id="3267878">.</span><span class="ident" id="3267879">state</span>&nbsp;<span class="op" id="3267885">=</span>&nbsp;<span class="ident" id="3267887">l</span><span class="op" id="3267888">.</span><span class="ident" id="3267889">state</span><span class="op" id="3267894">(</span><span class="ident" id="3267895">l</span><span class="op" id="3267896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3267899">}</span><br>
<span class="lineno">200</span><span class="op" id="3267901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3267904">//&nbsp;state&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3267924">const</span>&nbsp;<span class="op" id="3267930">(</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267933">leftDelim</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3267946">=</span>&nbsp;<span class="string" id="3267948">&#34;{{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267954">rightDelim</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3267967">=</span>&nbsp;<span class="string" id="3267969">&#34;}}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267975">leftComment</span>&nbsp;&nbsp;<span class="op" id="3267988">=</span>&nbsp;<span class="string" id="3267990">&#34;/*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3267996">rightComment</span>&nbsp;<span class="op" id="3268009">=</span>&nbsp;<span class="string" id="3268011">&#34;*/&#34;</span><br>
<span class="lineno"></span><span class="op" id="3268016">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="3268019">//&nbsp;lexText&nbsp;scans&nbsp;until&nbsp;an&nbsp;opening&nbsp;action&nbsp;delimiter,&nbsp;&#34;{{&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3268077">func</span>&nbsp;<span class="ident" id="3268082">lexText</span><span class="op" id="3268089">(</span><span class="ident" id="3268090">l</span>&nbsp;<span class="op" id="3268092">*</span><span class="ident" id="3268093">lexer</span><span class="op" id="3268098">)</span>&nbsp;<span class="ident" id="3268100">stateFn</span>&nbsp;<span class="op" id="3268108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268111">for</span>&nbsp;<span class="op" id="3268115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268119">if</span>&nbsp;<span class="ident" id="3268122">strings</span><span class="op" id="3268129">.</span><span class="ident" id="3268130">HasPrefix</span><span class="op" id="3268139">(</span><span class="ident" id="3268140">l</span><span class="op" id="3268141">.</span><span class="ident" id="3268142">input</span><span class="op" id="3268147">[</span><span class="ident" id="3268148">l</span><span class="op" id="3268149">.</span><span class="ident" id="3268150">pos</span><span class="op" id="3268153">:</span><span class="op" id="3268154">]</span><span class="op" id="3268155">,</span>&nbsp;<span class="ident" id="3268157">l</span><span class="op" id="3268158">.</span><span class="ident" id="3268159">leftDelim</span><span class="op" id="3268168">)</span>&nbsp;<span class="op" id="3268170">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268175">if</span>&nbsp;<span class="ident" id="3268178">l</span><span class="op" id="3268179">.</span><span class="ident" id="3268180">pos</span>&nbsp;<span class="op" id="3268184">&gt;</span>&nbsp;<span class="ident" id="3268186">l</span><span class="op" id="3268187">.</span><span class="ident" id="3268188">start</span>&nbsp;<span class="op" id="3268194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268200">l</span><span class="op" id="3268201">.</span><span class="ident" id="3268202">emit</span><span class="op" id="3268206">(</span><span class="ident" id="3268207">itemText</span><span class="op" id="3268215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268225">return</span>&nbsp;<span class="ident" id="3268232">lexLeftDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268247">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268251">if</span>&nbsp;<span class="ident" id="3268254">l</span><span class="op" id="3268255">.</span><span class="ident" id="3268256">next</span><span class="op" id="3268260">(</span><span class="op" id="3268261">)</span>&nbsp;<span class="op" id="3268263">==</span>&nbsp;<span class="ident" id="3268266">eof</span>&nbsp;<span class="op" id="3268270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268275">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3268289">//&nbsp;Correctly&nbsp;reached&nbsp;EOF.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268316">if</span>&nbsp;<span class="ident" id="3268319">l</span><span class="op" id="3268320">.</span><span class="ident" id="3268321">pos</span>&nbsp;<span class="op" id="3268325">&gt;</span>&nbsp;<span class="ident" id="3268327">l</span><span class="op" id="3268328">.</span><span class="ident" id="3268329">start</span>&nbsp;<span class="op" id="3268335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268339">l</span><span class="op" id="3268340">.</span><span class="ident" id="3268341">emit</span><span class="op" id="3268345">(</span><span class="ident" id="3268346">itemText</span><span class="op" id="3268354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268360">l</span><span class="op" id="3268361">.</span><span class="ident" id="3268362">emit</span><span class="op" id="3268366">(</span><span class="ident" id="3268367">itemEOF</span><span class="op" id="3268374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268377">return</span>&nbsp;<span class="ident" id="3268384">nil</span><br>
<span class="lineno">230</span><span class="op" id="3268388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3268391">//&nbsp;lexLeftDelim&nbsp;scans&nbsp;the&nbsp;left&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3268463">func</span>&nbsp;<span class="ident" id="3268468">lexLeftDelim</span><span class="op" id="3268480">(</span><span class="ident" id="3268481">l</span>&nbsp;<span class="op" id="3268483">*</span><span class="ident" id="3268484">lexer</span><span class="op" id="3268489">)</span>&nbsp;<span class="ident" id="3268491">stateFn</span>&nbsp;<span class="op" id="3268499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268502">l</span><span class="op" id="3268503">.</span><span class="ident" id="3268504">pos</span>&nbsp;<span class="op" id="3268508">+=</span>&nbsp;<span class="ident" id="3268511">Pos</span><span class="op" id="3268514">(</span><span class="builtinfunc" id="3268515">len</span><span class="op" id="3268518">(</span><span class="ident" id="3268519">l</span><span class="op" id="3268520">.</span><span class="ident" id="3268521">leftDelim</span><span class="op" id="3268530">)</span><span class="op" id="3268531">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268534">if</span>&nbsp;<span class="ident" id="3268537">strings</span><span class="op" id="3268544">.</span><span class="ident" id="3268545">HasPrefix</span><span class="op" id="3268554">(</span><span class="ident" id="3268555">l</span><span class="op" id="3268556">.</span><span class="ident" id="3268557">input</span><span class="op" id="3268562">[</span><span class="ident" id="3268563">l</span><span class="op" id="3268564">.</span><span class="ident" id="3268565">pos</span><span class="op" id="3268568">:</span><span class="op" id="3268569">]</span><span class="op" id="3268570">,</span>&nbsp;<span class="ident" id="3268572">leftComment</span><span class="op" id="3268583">)</span>&nbsp;<span class="op" id="3268585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268589">return</span>&nbsp;<span class="ident" id="3268596">lexComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268611">l</span><span class="op" id="3268612">.</span><span class="ident" id="3268613">emit</span><span class="op" id="3268617">(</span><span class="ident" id="3268618">itemLeftDelim</span><span class="op" id="3268631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268634">l</span><span class="op" id="3268635">.</span><span class="ident" id="3268636">parenDepth</span>&nbsp;<span class="op" id="3268647">=</span>&nbsp;<span class="num" id="3268649">0</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268652">return</span>&nbsp;<span class="ident" id="3268659">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3268675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3268678">//&nbsp;lexComment&nbsp;scans&nbsp;a&nbsp;comment.&nbsp;The&nbsp;left&nbsp;comment&nbsp;marker&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3268757">func</span>&nbsp;<span class="ident" id="3268762">lexComment</span><span class="op" id="3268772">(</span><span class="ident" id="3268773">l</span>&nbsp;<span class="op" id="3268775">*</span><span class="ident" id="3268776">lexer</span><span class="op" id="3268781">)</span>&nbsp;<span class="ident" id="3268783">stateFn</span>&nbsp;<span class="op" id="3268791">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268794">l</span><span class="op" id="3268795">.</span><span class="ident" id="3268796">pos</span>&nbsp;<span class="op" id="3268800">+=</span>&nbsp;<span class="ident" id="3268803">Pos</span><span class="op" id="3268806">(</span><span class="builtinfunc" id="3268807">len</span><span class="op" id="3268810">(</span><span class="ident" id="3268811">leftComment</span><span class="op" id="3268822">)</span><span class="op" id="3268823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268826">i</span>&nbsp;<span class="op" id="3268828">:=</span>&nbsp;<span class="ident" id="3268831">strings</span><span class="op" id="3268838">.</span><span class="ident" id="3268839">Index</span><span class="op" id="3268844">(</span><span class="ident" id="3268845">l</span><span class="op" id="3268846">.</span><span class="ident" id="3268847">input</span><span class="op" id="3268852">[</span><span class="ident" id="3268853">l</span><span class="op" id="3268854">.</span><span class="ident" id="3268855">pos</span><span class="op" id="3268858">:</span><span class="op" id="3268859">]</span><span class="op" id="3268860">,</span>&nbsp;<span class="ident" id="3268862">rightComment</span><span class="op" id="3268874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268877">if</span>&nbsp;<span class="ident" id="3268880">i</span>&nbsp;<span class="op" id="3268882">&lt;</span>&nbsp;<span class="num" id="3268884">0</span>&nbsp;<span class="op" id="3268886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268890">return</span>&nbsp;<span class="ident" id="3268897">l</span><span class="op" id="3268898">.</span><span class="ident" id="3268899">errorf</span><span class="op" id="3268905">(</span><span class="string" id="3268906">&#34;unclosed&nbsp;comment&#34;</span><span class="op" id="3268924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3268927">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3268930">l</span><span class="op" id="3268931">.</span><span class="ident" id="3268932">pos</span>&nbsp;<span class="op" id="3268936">+=</span>&nbsp;<span class="ident" id="3268939">Pos</span><span class="op" id="3268942">(</span><span class="ident" id="3268943">i</span>&nbsp;<span class="op" id="3268945">+</span>&nbsp;<span class="builtinfunc" id="3268947">len</span><span class="op" id="3268950">(</span><span class="ident" id="3268951">rightComment</span><span class="op" id="3268963">)</span><span class="op" id="3268964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3268967">if</span>&nbsp;<span class="op" id="3268970">!</span><span class="ident" id="3268971">strings</span><span class="op" id="3268978">.</span><span class="ident" id="3268979">HasPrefix</span><span class="op" id="3268988">(</span><span class="ident" id="3268989">l</span><span class="op" id="3268990">.</span><span class="ident" id="3268991">input</span><span class="op" id="3268996">[</span><span class="ident" id="3268997">l</span><span class="op" id="3268998">.</span><span class="ident" id="3268999">pos</span><span class="op" id="3269002">:</span><span class="op" id="3269003">]</span><span class="op" id="3269004">,</span>&nbsp;<span class="ident" id="3269006">l</span><span class="op" id="3269007">.</span><span class="ident" id="3269008">rightDelim</span><span class="op" id="3269018">)</span>&nbsp;<span class="op" id="3269020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269024">return</span>&nbsp;<span class="ident" id="3269031">l</span><span class="op" id="3269032">.</span><span class="ident" id="3269033">errorf</span><span class="op" id="3269039">(</span><span class="string" id="3269040">&#34;comment&nbsp;ends&nbsp;before&nbsp;closing&nbsp;delimiter&#34;</span><span class="op" id="3269079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269083">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269086">l</span><span class="op" id="3269087">.</span><span class="ident" id="3269088">pos</span>&nbsp;<span class="op" id="3269092">+=</span>&nbsp;<span class="ident" id="3269095">Pos</span><span class="op" id="3269098">(</span><span class="builtinfunc" id="3269099">len</span><span class="op" id="3269102">(</span><span class="ident" id="3269103">l</span><span class="op" id="3269104">.</span><span class="ident" id="3269105">rightDelim</span><span class="op" id="3269115">)</span><span class="op" id="3269116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269119">l</span><span class="op" id="3269120">.</span><span class="ident" id="3269121">ignore</span><span class="op" id="3269127">(</span><span class="op" id="3269128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269131">return</span>&nbsp;<span class="ident" id="3269138">lexText</span><br>
<span class="lineno"></span><span class="op" id="3269146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3269149">//&nbsp;lexRightDelim&nbsp;scans&nbsp;the&nbsp;right&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3269223">func</span>&nbsp;<span class="ident" id="3269228">lexRightDelim</span><span class="op" id="3269241">(</span><span class="ident" id="3269242">l</span>&nbsp;<span class="op" id="3269244">*</span><span class="ident" id="3269245">lexer</span><span class="op" id="3269250">)</span>&nbsp;<span class="ident" id="3269252">stateFn</span>&nbsp;<span class="op" id="3269260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269263">l</span><span class="op" id="3269264">.</span><span class="ident" id="3269265">pos</span>&nbsp;<span class="op" id="3269269">+=</span>&nbsp;<span class="ident" id="3269272">Pos</span><span class="op" id="3269275">(</span><span class="builtinfunc" id="3269276">len</span><span class="op" id="3269279">(</span><span class="ident" id="3269280">l</span><span class="op" id="3269281">.</span><span class="ident" id="3269282">rightDelim</span><span class="op" id="3269292">)</span><span class="op" id="3269293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269296">l</span><span class="op" id="3269297">.</span><span class="ident" id="3269298">emit</span><span class="op" id="3269302">(</span><span class="ident" id="3269303">itemRightDelim</span><span class="op" id="3269317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269320">return</span>&nbsp;<span class="ident" id="3269327">lexText</span><br>
<span class="lineno">265</span><span class="op" id="3269335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269338">//&nbsp;lexInsideAction&nbsp;scans&nbsp;the&nbsp;elements&nbsp;inside&nbsp;action&nbsp;delimiters.</span><br>
<span class="lineno"></span><span class="keyword" id="3269402">func</span>&nbsp;<span class="ident" id="3269407">lexInsideAction</span><span class="op" id="3269422">(</span><span class="ident" id="3269423">l</span>&nbsp;<span class="op" id="3269425">*</span><span class="ident" id="3269426">lexer</span><span class="op" id="3269431">)</span>&nbsp;<span class="ident" id="3269433">stateFn</span>&nbsp;<span class="op" id="3269441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269444">//&nbsp;Either&nbsp;number,&nbsp;quoted&nbsp;string,&nbsp;or&nbsp;identifier.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269493">//&nbsp;Spaces&nbsp;separate&nbsp;arguments;&nbsp;runs&nbsp;of&nbsp;spaces&nbsp;turn&nbsp;into&nbsp;itemSpace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3269560">//&nbsp;Pipe&nbsp;symbols&nbsp;separate&nbsp;and&nbsp;are&nbsp;emitted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269603">if</span>&nbsp;<span class="ident" id="3269606">strings</span><span class="op" id="3269613">.</span><span class="ident" id="3269614">HasPrefix</span><span class="op" id="3269623">(</span><span class="ident" id="3269624">l</span><span class="op" id="3269625">.</span><span class="ident" id="3269626">input</span><span class="op" id="3269631">[</span><span class="ident" id="3269632">l</span><span class="op" id="3269633">.</span><span class="ident" id="3269634">pos</span><span class="op" id="3269637">:</span><span class="op" id="3269638">]</span><span class="op" id="3269639">,</span>&nbsp;<span class="ident" id="3269641">l</span><span class="op" id="3269642">.</span><span class="ident" id="3269643">rightDelim</span><span class="op" id="3269653">)</span>&nbsp;<span class="op" id="3269655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269659">if</span>&nbsp;<span class="ident" id="3269662">l</span><span class="op" id="3269663">.</span><span class="ident" id="3269664">parenDepth</span>&nbsp;<span class="op" id="3269675">==</span>&nbsp;<span class="num" id="3269678">0</span>&nbsp;<span class="op" id="3269680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269685">return</span>&nbsp;<span class="ident" id="3269692">lexRightDelim</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269712">return</span>&nbsp;<span class="ident" id="3269719">l</span><span class="op" id="3269720">.</span><span class="ident" id="3269721">errorf</span><span class="op" id="3269727">(</span><span class="string" id="3269728">&#34;unclosed&nbsp;left&nbsp;paren&#34;</span><span class="op" id="3269749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269755">switch</span>&nbsp;<span class="ident" id="3269762">r</span>&nbsp;<span class="op" id="3269764">:=</span>&nbsp;<span class="ident" id="3269767">l</span><span class="op" id="3269768">.</span><span class="ident" id="3269769">next</span><span class="op" id="3269773">(</span><span class="op" id="3269774">)</span><span class="op" id="3269775">;</span>&nbsp;<span class="op" id="3269777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269780">case</span>&nbsp;<span class="ident" id="3269785">r</span>&nbsp;<span class="op" id="3269787">==</span>&nbsp;<span class="ident" id="3269790">eof</span>&nbsp;<span class="op" id="3269794">||</span>&nbsp;<span class="ident" id="3269797">isEndOfLine</span><span class="op" id="3269808">(</span><span class="ident" id="3269809">r</span><span class="op" id="3269810">)</span><span class="op" id="3269811">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269815">return</span>&nbsp;<span class="ident" id="3269822">l</span><span class="op" id="3269823">.</span><span class="ident" id="3269824">errorf</span><span class="op" id="3269830">(</span><span class="string" id="3269831">&#34;unclosed&nbsp;action&#34;</span><span class="op" id="3269848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269851">case</span>&nbsp;<span class="ident" id="3269856">isSpace</span><span class="op" id="3269863">(</span><span class="ident" id="3269864">r</span><span class="op" id="3269865">)</span><span class="op" id="3269866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269870">return</span>&nbsp;<span class="ident" id="3269877">lexSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269887">case</span>&nbsp;<span class="ident" id="3269892">r</span>&nbsp;<span class="op" id="3269894">==</span>&nbsp;<span class="string" id="3269897">&#39;:&#39;</span><span class="op" id="3269900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269904">if</span>&nbsp;<span class="ident" id="3269907">l</span><span class="op" id="3269908">.</span><span class="ident" id="3269909">next</span><span class="op" id="3269913">(</span><span class="op" id="3269914">)</span>&nbsp;<span class="op" id="3269916">!=</span>&nbsp;<span class="string" id="3269919">&#39;=&#39;</span>&nbsp;<span class="op" id="3269923">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269928">return</span>&nbsp;<span class="ident" id="3269935">l</span><span class="op" id="3269936">.</span><span class="ident" id="3269937">errorf</span><span class="op" id="3269943">(</span><span class="string" id="3269944">&#34;expected&nbsp;:=&#34;</span><span class="op" id="3269957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3269961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3269965">l</span><span class="op" id="3269966">.</span><span class="ident" id="3269967">emit</span><span class="op" id="3269971">(</span><span class="ident" id="3269972">itemColonEquals</span><span class="op" id="3269987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3269990">case</span>&nbsp;<span class="ident" id="3269995">r</span>&nbsp;<span class="op" id="3269997">==</span>&nbsp;<span class="string" id="3270000">&#39;|&#39;</span><span class="op" id="3270003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270007">l</span><span class="op" id="3270008">.</span><span class="ident" id="3270009">emit</span><span class="op" id="3270013">(</span><span class="ident" id="3270014">itemPipe</span><span class="op" id="3270022">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270025">case</span>&nbsp;<span class="ident" id="3270030">r</span>&nbsp;<span class="op" id="3270032">==</span>&nbsp;<span class="string" id="3270035">&#39;&#34;&#39;</span><span class="op" id="3270038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270042">return</span>&nbsp;<span class="ident" id="3270049">lexQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270059">case</span>&nbsp;<span class="ident" id="3270064">r</span>&nbsp;<span class="op" id="3270066">==</span>&nbsp;<span class="string" id="3270069">&#39;`&#39;</span><span class="op" id="3270072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270076">return</span>&nbsp;<span class="ident" id="3270083">lexRawQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270096">case</span>&nbsp;<span class="ident" id="3270101">r</span>&nbsp;<span class="op" id="3270103">==</span>&nbsp;<span class="string" id="3270106">&#39;$&#39;</span><span class="op" id="3270109">:</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270113">return</span>&nbsp;<span class="ident" id="3270120">lexVariable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270133">case</span>&nbsp;<span class="ident" id="3270138">r</span>&nbsp;<span class="op" id="3270140">==</span>&nbsp;<span class="string" id="3270143">&#39;\&#39;&#39;</span><span class="op" id="3270147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270151">return</span>&nbsp;<span class="ident" id="3270158">lexChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270167">case</span>&nbsp;<span class="ident" id="3270172">r</span>&nbsp;<span class="op" id="3270174">==</span>&nbsp;<span class="string" id="3270177">&#39;.&#39;</span><span class="op" id="3270180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3270184">//&nbsp;special&nbsp;look-ahead&nbsp;for&nbsp;&#34;.field&#34;&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;break&nbsp;l.backup().</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270251">if</span>&nbsp;<span class="ident" id="3270254">l</span><span class="op" id="3270255">.</span><span class="ident" id="3270256">pos</span>&nbsp;<span class="op" id="3270260">&lt;</span>&nbsp;<span class="ident" id="3270262">Pos</span><span class="op" id="3270265">(</span><span class="builtinfunc" id="3270266">len</span><span class="op" id="3270269">(</span><span class="ident" id="3270270">l</span><span class="op" id="3270271">.</span><span class="ident" id="3270272">input</span><span class="op" id="3270277">)</span><span class="op" id="3270278">)</span>&nbsp;<span class="op" id="3270280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270285">r</span>&nbsp;<span class="op" id="3270287">:=</span>&nbsp;<span class="ident" id="3270290">l</span><span class="op" id="3270291">.</span><span class="ident" id="3270292">input</span><span class="op" id="3270297">[</span><span class="ident" id="3270298">l</span><span class="op" id="3270299">.</span><span class="ident" id="3270300">pos</span><span class="op" id="3270303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270308">if</span>&nbsp;<span class="ident" id="3270311">r</span>&nbsp;<span class="op" id="3270313">&lt;</span>&nbsp;<span class="string" id="3270315">&#39;0&#39;</span>&nbsp;<span class="op" id="3270319">||</span>&nbsp;<span class="string" id="3270322">&#39;9&#39;</span>&nbsp;<span class="op" id="3270326">&lt;</span>&nbsp;<span class="ident" id="3270328">r</span>&nbsp;<span class="op" id="3270330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270336">return</span>&nbsp;<span class="ident" id="3270343">lexField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270355">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270363">fallthrough</span>&nbsp;<span class="comment" id="3270375">//&nbsp;&#39;.&#39;&nbsp;can&nbsp;start&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270403">case</span>&nbsp;<span class="ident" id="3270408">r</span>&nbsp;<span class="op" id="3270410">==</span>&nbsp;<span class="string" id="3270413">&#39;+&#39;</span>&nbsp;<span class="op" id="3270417">||</span>&nbsp;<span class="ident" id="3270420">r</span>&nbsp;<span class="op" id="3270422">==</span>&nbsp;<span class="string" id="3270425">&#39;-&#39;</span>&nbsp;<span class="op" id="3270429">||</span>&nbsp;<span class="op" id="3270432">(</span><span class="string" id="3270433">&#39;0&#39;</span>&nbsp;<span class="op" id="3270437">&lt;=</span>&nbsp;<span class="ident" id="3270440">r</span>&nbsp;<span class="op" id="3270442">&amp;&amp;</span>&nbsp;<span class="ident" id="3270445">r</span>&nbsp;<span class="op" id="3270447">&lt;=</span>&nbsp;<span class="string" id="3270450">&#39;9&#39;</span><span class="op" id="3270453">)</span><span class="op" id="3270454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270458">l</span><span class="op" id="3270459">.</span><span class="ident" id="3270460">backup</span><span class="op" id="3270466">(</span><span class="op" id="3270467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270471">return</span>&nbsp;<span class="ident" id="3270478">lexNumber</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270489">case</span>&nbsp;<span class="ident" id="3270494">isAlphaNumeric</span><span class="op" id="3270508">(</span><span class="ident" id="3270509">r</span><span class="op" id="3270510">)</span><span class="op" id="3270511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270515">l</span><span class="op" id="3270516">.</span><span class="ident" id="3270517">backup</span><span class="op" id="3270523">(</span><span class="op" id="3270524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270528">return</span>&nbsp;<span class="ident" id="3270535">lexIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270550">case</span>&nbsp;<span class="ident" id="3270555">r</span>&nbsp;<span class="op" id="3270557">==</span>&nbsp;<span class="string" id="3270560">&#39;(&#39;</span><span class="op" id="3270563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270567">l</span><span class="op" id="3270568">.</span><span class="ident" id="3270569">emit</span><span class="op" id="3270573">(</span><span class="ident" id="3270574">itemLeftParen</span><span class="op" id="3270587">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270591">l</span><span class="op" id="3270592">.</span><span class="ident" id="3270593">parenDepth</span><span class="op" id="3270603">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270608">return</span>&nbsp;<span class="ident" id="3270615">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270632">case</span>&nbsp;<span class="ident" id="3270637">r</span>&nbsp;<span class="op" id="3270639">==</span>&nbsp;<span class="string" id="3270642">&#39;)&#39;</span><span class="op" id="3270645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270649">l</span><span class="op" id="3270650">.</span><span class="ident" id="3270651">emit</span><span class="op" id="3270655">(</span><span class="ident" id="3270656">itemRightParen</span><span class="op" id="3270670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270674">l</span><span class="op" id="3270675">.</span><span class="ident" id="3270676">parenDepth</span><span class="op" id="3270686">--</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270691">if</span>&nbsp;<span class="ident" id="3270694">l</span><span class="op" id="3270695">.</span><span class="ident" id="3270696">parenDepth</span>&nbsp;<span class="op" id="3270707">&lt;</span>&nbsp;<span class="num" id="3270709">0</span>&nbsp;<span class="op" id="3270711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270716">return</span>&nbsp;<span class="ident" id="3270723">l</span><span class="op" id="3270724">.</span><span class="ident" id="3270725">errorf</span><span class="op" id="3270731">(</span><span class="string" id="3270732">&#34;unexpected&nbsp;right&nbsp;paren&nbsp;%#U&#34;</span><span class="op" id="3270760">,</span>&nbsp;<span class="ident" id="3270762">r</span><span class="op" id="3270763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270771">return</span>&nbsp;<span class="ident" id="3270778">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270795">case</span>&nbsp;<span class="ident" id="3270800">r</span>&nbsp;<span class="op" id="3270802">&lt;=</span>&nbsp;<span class="ident" id="3270805">unicode</span><span class="op" id="3270812">.</span><span class="ident" id="3270813">MaxASCII</span>&nbsp;<span class="op" id="3270822">&amp;&amp;</span>&nbsp;<span class="ident" id="3270825">unicode</span><span class="op" id="3270832">.</span><span class="ident" id="3270833">IsPrint</span><span class="op" id="3270840">(</span><span class="ident" id="3270841">r</span><span class="op" id="3270842">)</span><span class="op" id="3270843">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270847">l</span><span class="op" id="3270848">.</span><span class="ident" id="3270849">emit</span><span class="op" id="3270853">(</span><span class="ident" id="3270854">itemChar</span><span class="op" id="3270862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270866">return</span>&nbsp;<span class="ident" id="3270873">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270890">default</span><span class="op" id="3270897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270901">return</span>&nbsp;<span class="ident" id="3270908">l</span><span class="op" id="3270909">.</span><span class="ident" id="3270910">errorf</span><span class="op" id="3270916">(</span><span class="string" id="3270917">&#34;unrecognized&nbsp;character&nbsp;in&nbsp;action:&nbsp;%#U&#34;</span><span class="op" id="3270956">,</span>&nbsp;<span class="ident" id="3270958">r</span><span class="op" id="3270959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270962">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270965">return</span>&nbsp;<span class="ident" id="3270972">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3270988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3270991">//&nbsp;lexSpace&nbsp;scans&nbsp;a&nbsp;run&nbsp;of&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="3271036">//&nbsp;One&nbsp;space&nbsp;has&nbsp;already&nbsp;been&nbsp;seen.</span><br>
<span class="lineno">335</span><span class="keyword" id="3271072">func</span>&nbsp;<span class="ident" id="3271077">lexSpace</span><span class="op" id="3271085">(</span><span class="ident" id="3271086">l</span>&nbsp;<span class="op" id="3271088">*</span><span class="ident" id="3271089">lexer</span><span class="op" id="3271094">)</span>&nbsp;<span class="ident" id="3271096">stateFn</span>&nbsp;<span class="op" id="3271104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271107">for</span>&nbsp;<span class="ident" id="3271111">isSpace</span><span class="op" id="3271118">(</span><span class="ident" id="3271119">l</span><span class="op" id="3271120">.</span><span class="ident" id="3271121">peek</span><span class="op" id="3271125">(</span><span class="op" id="3271126">)</span><span class="op" id="3271127">)</span>&nbsp;<span class="op" id="3271129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271133">l</span><span class="op" id="3271134">.</span><span class="ident" id="3271135">next</span><span class="op" id="3271139">(</span><span class="op" id="3271140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271146">l</span><span class="op" id="3271147">.</span><span class="ident" id="3271148">emit</span><span class="op" id="3271152">(</span><span class="ident" id="3271153">itemSpace</span><span class="op" id="3271162">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271165">return</span>&nbsp;<span class="ident" id="3271172">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3271188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3271191">//&nbsp;lexIdentifier&nbsp;scans&nbsp;an&nbsp;alphanumeric.</span><br>
<span class="lineno"></span><span class="keyword" id="3271231">func</span>&nbsp;<span class="ident" id="3271236">lexIdentifier</span><span class="op" id="3271249">(</span><span class="ident" id="3271250">l</span>&nbsp;<span class="op" id="3271252">*</span><span class="ident" id="3271253">lexer</span><span class="op" id="3271258">)</span>&nbsp;<span class="ident" id="3271260">stateFn</span>&nbsp;<span class="op" id="3271268">{</span><br>
<span class="lineno">345</span><span class="ident" id="3271270">Loop</span><span class="op" id="3271274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271277">for</span>&nbsp;<span class="op" id="3271281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271285">switch</span>&nbsp;<span class="ident" id="3271292">r</span>&nbsp;<span class="op" id="3271294">:=</span>&nbsp;<span class="ident" id="3271297">l</span><span class="op" id="3271298">.</span><span class="ident" id="3271299">next</span><span class="op" id="3271303">(</span><span class="op" id="3271304">)</span><span class="op" id="3271305">;</span>&nbsp;<span class="op" id="3271307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271311">case</span>&nbsp;<span class="ident" id="3271316">isAlphaNumeric</span><span class="op" id="3271330">(</span><span class="ident" id="3271331">r</span><span class="op" id="3271332">)</span><span class="op" id="3271333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3271338">//&nbsp;absorb.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271351">default</span><span class="op" id="3271358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271363">l</span><span class="op" id="3271364">.</span><span class="ident" id="3271365">backup</span><span class="op" id="3271371">(</span><span class="op" id="3271372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271377">word</span>&nbsp;<span class="op" id="3271382">:=</span>&nbsp;<span class="ident" id="3271385">l</span><span class="op" id="3271386">.</span><span class="ident" id="3271387">input</span><span class="op" id="3271392">[</span><span class="ident" id="3271393">l</span><span class="op" id="3271394">.</span><span class="ident" id="3271395">start</span><span class="op" id="3271400">:</span><span class="ident" id="3271401">l</span><span class="op" id="3271402">.</span><span class="ident" id="3271403">pos</span><span class="op" id="3271406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271411">if</span>&nbsp;<span class="op" id="3271414">!</span><span class="ident" id="3271415">l</span><span class="op" id="3271416">.</span><span class="ident" id="3271417">atTerminator</span><span class="op" id="3271429">(</span><span class="op" id="3271430">)</span>&nbsp;<span class="op" id="3271432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271438">return</span>&nbsp;<span class="ident" id="3271445">l</span><span class="op" id="3271446">.</span><span class="ident" id="3271447">errorf</span><span class="op" id="3271453">(</span><span class="string" id="3271454">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3271473">,</span>&nbsp;<span class="ident" id="3271475">r</span><span class="op" id="3271476">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271486">switch</span>&nbsp;<span class="op" id="3271493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271498">case</span>&nbsp;<span class="ident" id="3271503">key</span><span class="op" id="3271506">[</span><span class="ident" id="3271507">word</span><span class="op" id="3271511">]</span>&nbsp;<span class="op" id="3271513">&gt;</span>&nbsp;<span class="ident" id="3271515">itemKeyword</span><span class="op" id="3271526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271532">l</span><span class="op" id="3271533">.</span><span class="ident" id="3271534">emit</span><span class="op" id="3271538">(</span><span class="ident" id="3271539">key</span><span class="op" id="3271542">[</span><span class="ident" id="3271543">word</span><span class="op" id="3271547">]</span><span class="op" id="3271548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271553">case</span>&nbsp;<span class="ident" id="3271558">word</span><span class="op" id="3271562">[</span><span class="num" id="3271563">0</span><span class="op" id="3271564">]</span>&nbsp;<span class="op" id="3271566">==</span>&nbsp;<span class="string" id="3271569">&#39;.&#39;</span><span class="op" id="3271572">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271578">l</span><span class="op" id="3271579">.</span><span class="ident" id="3271580">emit</span><span class="op" id="3271584">(</span><span class="ident" id="3271585">itemField</span><span class="op" id="3271594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271599">case</span>&nbsp;<span class="ident" id="3271604">word</span>&nbsp;<span class="op" id="3271609">==</span>&nbsp;<span class="string" id="3271612">&#34;true&#34;</span><span class="op" id="3271618">,</span>&nbsp;<span class="ident" id="3271620">word</span>&nbsp;<span class="op" id="3271625">==</span>&nbsp;<span class="string" id="3271628">&#34;false&#34;</span><span class="op" id="3271635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271641">l</span><span class="op" id="3271642">.</span><span class="ident" id="3271643">emit</span><span class="op" id="3271647">(</span><span class="ident" id="3271648">itemBool</span><span class="op" id="3271656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271661">default</span><span class="op" id="3271668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271674">l</span><span class="op" id="3271675">.</span><span class="ident" id="3271676">emit</span><span class="op" id="3271680">(</span><span class="ident" id="3271681">itemIdentifier</span><span class="op" id="3271695">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271705">break</span>&nbsp;<span class="ident" id="3271711">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271724">return</span>&nbsp;<span class="ident" id="3271731">lexInsideAction</span><br>
<span class="lineno">370</span><span class="op" id="3271747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3271750">//&nbsp;lexField&nbsp;scans&nbsp;a&nbsp;field:&nbsp;.Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3271792">//&nbsp;The&nbsp;.&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="3271819">func</span>&nbsp;<span class="ident" id="3271824">lexField</span><span class="op" id="3271832">(</span><span class="ident" id="3271833">l</span>&nbsp;<span class="op" id="3271835">*</span><span class="ident" id="3271836">lexer</span><span class="op" id="3271841">)</span>&nbsp;<span class="ident" id="3271843">stateFn</span>&nbsp;<span class="op" id="3271851">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271854">return</span>&nbsp;<span class="ident" id="3271861">lexFieldOrVariable</span><span class="op" id="3271879">(</span><span class="ident" id="3271880">l</span><span class="op" id="3271881">,</span>&nbsp;<span class="ident" id="3271883">itemField</span><span class="op" id="3271892">)</span><br>
<span class="lineno"></span><span class="op" id="3271894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3271897">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;Variable:&nbsp;$Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3271945">//&nbsp;The&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">380</span><span class="keyword" id="3271972">func</span>&nbsp;<span class="ident" id="3271977">lexVariable</span><span class="op" id="3271988">(</span><span class="ident" id="3271989">l</span>&nbsp;<span class="op" id="3271991">*</span><span class="ident" id="3271992">lexer</span><span class="op" id="3271997">)</span>&nbsp;<span class="ident" id="3271999">stateFn</span>&nbsp;<span class="op" id="3272007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272010">if</span>&nbsp;<span class="ident" id="3272013">l</span><span class="op" id="3272014">.</span><span class="ident" id="3272015">atTerminator</span><span class="op" id="3272027">(</span><span class="op" id="3272028">)</span>&nbsp;<span class="op" id="3272030">{</span>&nbsp;<span class="comment" id="3272032">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272073">l</span><span class="op" id="3272074">.</span><span class="ident" id="3272075">emit</span><span class="op" id="3272079">(</span><span class="ident" id="3272080">itemVariable</span><span class="op" id="3272092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272096">return</span>&nbsp;<span class="ident" id="3272103">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272120">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272123">return</span>&nbsp;<span class="ident" id="3272130">lexFieldOrVariable</span><span class="op" id="3272148">(</span><span class="ident" id="3272149">l</span><span class="op" id="3272150">,</span>&nbsp;<span class="ident" id="3272152">itemVariable</span><span class="op" id="3272164">)</span><br>
<span class="lineno"></span><span class="op" id="3272166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3272169">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;field&nbsp;or&nbsp;variable:&nbsp;[.$]Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3272229">//&nbsp;The&nbsp;.&nbsp;or&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">390</span><span class="keyword" id="3272261">func</span>&nbsp;<span class="ident" id="3272266">lexFieldOrVariable</span><span class="op" id="3272284">(</span><span class="ident" id="3272285">l</span>&nbsp;<span class="op" id="3272287">*</span><span class="ident" id="3272288">lexer</span><span class="op" id="3272293">,</span>&nbsp;<span class="ident" id="3272295">typ</span>&nbsp;<span class="ident" id="3272299">itemType</span><span class="op" id="3272307">)</span>&nbsp;<span class="ident" id="3272309">stateFn</span>&nbsp;<span class="op" id="3272317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272320">if</span>&nbsp;<span class="ident" id="3272323">l</span><span class="op" id="3272324">.</span><span class="ident" id="3272325">atTerminator</span><span class="op" id="3272337">(</span><span class="op" id="3272338">)</span>&nbsp;<span class="op" id="3272340">{</span>&nbsp;<span class="comment" id="3272342">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;.&#34;&nbsp;or&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272390">if</span>&nbsp;<span class="ident" id="3272393">typ</span>&nbsp;<span class="op" id="3272397">==</span>&nbsp;<span class="ident" id="3272400">itemVariable</span>&nbsp;<span class="op" id="3272413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272418">l</span><span class="op" id="3272419">.</span><span class="ident" id="3272420">emit</span><span class="op" id="3272424">(</span><span class="ident" id="3272425">itemVariable</span><span class="op" id="3272437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272441">}</span>&nbsp;<span class="keyword" id="3272443">else</span>&nbsp;<span class="op" id="3272448">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272453">l</span><span class="op" id="3272454">.</span><span class="ident" id="3272455">emit</span><span class="op" id="3272459">(</span><span class="ident" id="3272460">itemDot</span><span class="op" id="3272467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272475">return</span>&nbsp;<span class="ident" id="3272482">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272502">var</span>&nbsp;<span class="ident" id="3272506">r</span>&nbsp;<span class="builtintype" id="3272508">rune</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272514">for</span>&nbsp;<span class="op" id="3272518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272522">r</span>&nbsp;<span class="op" id="3272524">=</span>&nbsp;<span class="ident" id="3272526">l</span><span class="op" id="3272527">.</span><span class="ident" id="3272528">next</span><span class="op" id="3272532">(</span><span class="op" id="3272533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272537">if</span>&nbsp;<span class="op" id="3272540">!</span><span class="ident" id="3272541">isAlphaNumeric</span><span class="op" id="3272555">(</span><span class="ident" id="3272556">r</span><span class="op" id="3272557">)</span>&nbsp;<span class="op" id="3272559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272564">l</span><span class="op" id="3272565">.</span><span class="ident" id="3272566">backup</span><span class="op" id="3272572">(</span><span class="op" id="3272573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272578">break</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272592">if</span>&nbsp;<span class="op" id="3272595">!</span><span class="ident" id="3272596">l</span><span class="op" id="3272597">.</span><span class="ident" id="3272598">atTerminator</span><span class="op" id="3272610">(</span><span class="op" id="3272611">)</span>&nbsp;<span class="op" id="3272613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272617">return</span>&nbsp;<span class="ident" id="3272624">l</span><span class="op" id="3272625">.</span><span class="ident" id="3272626">errorf</span><span class="op" id="3272632">(</span><span class="string" id="3272633">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3272652">,</span>&nbsp;<span class="ident" id="3272654">r</span><span class="op" id="3272655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3272658">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3272661">l</span><span class="op" id="3272662">.</span><span class="ident" id="3272663">emit</span><span class="op" id="3272667">(</span><span class="ident" id="3272668">typ</span><span class="op" id="3272671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3272674">return</span>&nbsp;<span class="ident" id="3272681">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3272697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3272700">//&nbsp;atTerminator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;valid&nbsp;termination&nbsp;character&nbsp;to</span><br>
<span class="lineno">415</span><span class="comment" id="3272779">//&nbsp;appear&nbsp;after&nbsp;an&nbsp;identifier.&nbsp;Breaks&nbsp;.X.Y&nbsp;into&nbsp;two&nbsp;pieces.&nbsp;Also&nbsp;catches&nbsp;cases</span><br>
<span class="lineno"></span><span class="comment" id="3272858">//&nbsp;like&nbsp;&#34;$x+2&#34;&nbsp;not&nbsp;being&nbsp;acceptable&nbsp;without&nbsp;a&nbsp;space,&nbsp;in&nbsp;case&nbsp;we&nbsp;decide&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3272933">//&nbsp;day&nbsp;to&nbsp;implement&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="keyword" id="3272965">func</span>&nbsp;<span class="op" id="3272970">(</span><span class="ident" id="3272971">l</span>&nbsp;<span class="op" id="3272973">*</span><span class="ident" id="3272974">lexer</span><span class="op" id="3272979">)</span>&nbsp;<span class="ident" id="3272981">atTerminator</span><span class="op" id="3272993">(</span><span class="op" id="3272994">)</span>&nbsp;<span class="builtintype" id="3272996">bool</span>&nbsp;<span class="op" id="3273001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273004">r</span>&nbsp;<span class="op" id="3273006">:=</span>&nbsp;<span class="ident" id="3273009">l</span><span class="op" id="3273010">.</span><span class="ident" id="3273011">peek</span><span class="op" id="3273015">(</span><span class="op" id="3273016">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273019">if</span>&nbsp;<span class="ident" id="3273022">isSpace</span><span class="op" id="3273029">(</span><span class="ident" id="3273030">r</span><span class="op" id="3273031">)</span>&nbsp;<span class="op" id="3273033">||</span>&nbsp;<span class="ident" id="3273036">isEndOfLine</span><span class="op" id="3273047">(</span><span class="ident" id="3273048">r</span><span class="op" id="3273049">)</span>&nbsp;<span class="op" id="3273051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273055">return</span>&nbsp;<span class="builtintype" id="3273062">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273071">switch</span>&nbsp;<span class="ident" id="3273078">r</span>&nbsp;<span class="op" id="3273080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273083">case</span>&nbsp;<span class="ident" id="3273088">eof</span><span class="op" id="3273091">,</span>&nbsp;<span class="string" id="3273093">&#39;.&#39;</span><span class="op" id="3273096">,</span>&nbsp;<span class="string" id="3273098">&#39;,&#39;</span><span class="op" id="3273101">,</span>&nbsp;<span class="string" id="3273103">&#39;|&#39;</span><span class="op" id="3273106">,</span>&nbsp;<span class="string" id="3273108">&#39;:&#39;</span><span class="op" id="3273111">,</span>&nbsp;<span class="string" id="3273113">&#39;)&#39;</span><span class="op" id="3273116">,</span>&nbsp;<span class="string" id="3273118">&#39;(&#39;</span><span class="op" id="3273121">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273125">return</span>&nbsp;<span class="builtintype" id="3273132">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273141">//&nbsp;Does&nbsp;r&nbsp;start&nbsp;the&nbsp;delimiter?&nbsp;This&nbsp;can&nbsp;be&nbsp;ambiguous&nbsp;(with&nbsp;delim==&#34;//&#34;,&nbsp;$x/2&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273224">//&nbsp;succeed&nbsp;but&nbsp;should&nbsp;fail)&nbsp;but&nbsp;only&nbsp;in&nbsp;extremely&nbsp;rare&nbsp;cases&nbsp;caused&nbsp;by&nbsp;willfully</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3273306">//&nbsp;bad&nbsp;choice&nbsp;of&nbsp;delimiter.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273335">if</span>&nbsp;<span class="ident" id="3273338">rd</span><span class="op" id="3273340">,</span>&nbsp;<span class="ident" id="3273342">_</span>&nbsp;<span class="op" id="3273344">:=</span>&nbsp;<span class="ident" id="3273347">utf8</span><span class="op" id="3273351">.</span><span class="ident" id="3273352">DecodeRuneInString</span><span class="op" id="3273370">(</span><span class="ident" id="3273371">l</span><span class="op" id="3273372">.</span><span class="ident" id="3273373">rightDelim</span><span class="op" id="3273383">)</span><span class="op" id="3273384">;</span>&nbsp;<span class="ident" id="3273386">rd</span>&nbsp;<span class="op" id="3273389">==</span>&nbsp;<span class="ident" id="3273392">r</span>&nbsp;<span class="op" id="3273394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273398">return</span>&nbsp;<span class="builtintype" id="3273405">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273414">return</span>&nbsp;<span class="builtintype" id="3273421">false</span><br>
<span class="lineno"></span><span class="op" id="3273427">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="3273430">//&nbsp;lexChar&nbsp;scans&nbsp;a&nbsp;character&nbsp;constant.&nbsp;The&nbsp;initial&nbsp;quote&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="3273498">//&nbsp;scanned.&nbsp;Syntax&nbsp;checking&nbsp;is&nbsp;done&nbsp;by&nbsp;the&nbsp;parser.</span><br>
<span class="lineno"></span><span class="keyword" id="3273549">func</span>&nbsp;<span class="ident" id="3273554">lexChar</span><span class="op" id="3273561">(</span><span class="ident" id="3273562">l</span>&nbsp;<span class="op" id="3273564">*</span><span class="ident" id="3273565">lexer</span><span class="op" id="3273570">)</span>&nbsp;<span class="ident" id="3273572">stateFn</span>&nbsp;<span class="op" id="3273580">{</span><br>
<span class="lineno"></span><span class="ident" id="3273582">Loop</span><span class="op" id="3273586">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273589">for</span>&nbsp;<span class="op" id="3273593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273597">switch</span>&nbsp;<span class="ident" id="3273604">l</span><span class="op" id="3273605">.</span><span class="ident" id="3273606">next</span><span class="op" id="3273610">(</span><span class="op" id="3273611">)</span>&nbsp;<span class="op" id="3273613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273617">case</span>&nbsp;<span class="string" id="3273622">&#39;\\&#39;</span><span class="op" id="3273626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273631">if</span>&nbsp;<span class="ident" id="3273634">r</span>&nbsp;<span class="op" id="3273636">:=</span>&nbsp;<span class="ident" id="3273639">l</span><span class="op" id="3273640">.</span><span class="ident" id="3273641">next</span><span class="op" id="3273645">(</span><span class="op" id="3273646">)</span><span class="op" id="3273647">;</span>&nbsp;<span class="ident" id="3273649">r</span>&nbsp;<span class="op" id="3273651">!=</span>&nbsp;<span class="ident" id="3273654">eof</span>&nbsp;<span class="op" id="3273658">&amp;&amp;</span>&nbsp;<span class="ident" id="3273661">r</span>&nbsp;<span class="op" id="3273663">!=</span>&nbsp;<span class="string" id="3273666">&#39;\n&#39;</span>&nbsp;<span class="op" id="3273671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273677">break</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273691">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273705">case</span>&nbsp;<span class="ident" id="3273710">eof</span><span class="op" id="3273713">,</span>&nbsp;<span class="string" id="3273715">&#39;\n&#39;</span><span class="op" id="3273719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273724">return</span>&nbsp;<span class="ident" id="3273731">l</span><span class="op" id="3273732">.</span><span class="ident" id="3273733">errorf</span><span class="op" id="3273739">(</span><span class="string" id="3273740">&#34;unterminated&nbsp;character&nbsp;constant&#34;</span><span class="op" id="3273773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273777">case</span>&nbsp;<span class="string" id="3273782">&#39;\&#39;&#39;</span><span class="op" id="3273786">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273791">break</span>&nbsp;<span class="ident" id="3273797">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3273807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3273810">l</span><span class="op" id="3273811">.</span><span class="ident" id="3273812">emit</span><span class="op" id="3273816">(</span><span class="ident" id="3273817">itemCharConstant</span><span class="op" id="3273833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3273836">return</span>&nbsp;<span class="ident" id="3273843">lexInsideAction</span><br>
<span class="lineno">455</span><span class="op" id="3273859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3273862">//&nbsp;lexNumber&nbsp;scans&nbsp;a&nbsp;number:&nbsp;decimal,&nbsp;octal,&nbsp;hex,&nbsp;float,&nbsp;or&nbsp;imaginary.&nbsp;This</span><br>
<span class="lineno"></span><span class="comment" id="3273938">//&nbsp;isn&#39;t&nbsp;a&nbsp;perfect&nbsp;number&nbsp;scanner&nbsp;-&nbsp;for&nbsp;instance&nbsp;it&nbsp;accepts&nbsp;&#34;.&#34;&nbsp;and&nbsp;&#34;0x0.2&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3274014">//&nbsp;and&nbsp;&#34;089&#34;&nbsp;-&nbsp;but&nbsp;when&nbsp;it&#39;s&nbsp;wrong&nbsp;the&nbsp;input&nbsp;is&nbsp;invalid&nbsp;and&nbsp;the&nbsp;parser&nbsp;(via</span><br>
<span class="lineno">460</span><span class="comment" id="3274090">//&nbsp;strconv)&nbsp;will&nbsp;notice.</span><br>
<span class="lineno"></span><span class="keyword" id="3274115">func</span>&nbsp;<span class="ident" id="3274120">lexNumber</span><span class="op" id="3274129">(</span><span class="ident" id="3274130">l</span>&nbsp;<span class="op" id="3274132">*</span><span class="ident" id="3274133">lexer</span><span class="op" id="3274138">)</span>&nbsp;<span class="ident" id="3274140">stateFn</span>&nbsp;<span class="op" id="3274148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274151">if</span>&nbsp;<span class="op" id="3274154">!</span><span class="ident" id="3274155">l</span><span class="op" id="3274156">.</span><span class="ident" id="3274157">scanNumber</span><span class="op" id="3274167">(</span><span class="op" id="3274168">)</span>&nbsp;<span class="op" id="3274170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274174">return</span>&nbsp;<span class="ident" id="3274181">l</span><span class="op" id="3274182">.</span><span class="ident" id="3274183">errorf</span><span class="op" id="3274189">(</span><span class="string" id="3274190">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3274213">,</span>&nbsp;<span class="ident" id="3274215">l</span><span class="op" id="3274216">.</span><span class="ident" id="3274217">input</span><span class="op" id="3274222">[</span><span class="ident" id="3274223">l</span><span class="op" id="3274224">.</span><span class="ident" id="3274225">start</span><span class="op" id="3274230">:</span><span class="ident" id="3274231">l</span><span class="op" id="3274232">.</span><span class="ident" id="3274233">pos</span><span class="op" id="3274236">]</span><span class="op" id="3274237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274240">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274243">if</span>&nbsp;<span class="ident" id="3274246">sign</span>&nbsp;<span class="op" id="3274251">:=</span>&nbsp;<span class="ident" id="3274254">l</span><span class="op" id="3274255">.</span><span class="ident" id="3274256">peek</span><span class="op" id="3274260">(</span><span class="op" id="3274261">)</span><span class="op" id="3274262">;</span>&nbsp;<span class="ident" id="3274264">sign</span>&nbsp;<span class="op" id="3274269">==</span>&nbsp;<span class="string" id="3274272">&#39;+&#39;</span>&nbsp;<span class="op" id="3274276">||</span>&nbsp;<span class="ident" id="3274279">sign</span>&nbsp;<span class="op" id="3274284">==</span>&nbsp;<span class="string" id="3274287">&#39;-&#39;</span>&nbsp;<span class="op" id="3274291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3274295">//&nbsp;Complex:&nbsp;1+2i.&nbsp;No&nbsp;spaces,&nbsp;must&nbsp;end&nbsp;in&nbsp;&#39;i&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274343">if</span>&nbsp;<span class="op" id="3274346">!</span><span class="ident" id="3274347">l</span><span class="op" id="3274348">.</span><span class="ident" id="3274349">scanNumber</span><span class="op" id="3274359">(</span><span class="op" id="3274360">)</span>&nbsp;<span class="op" id="3274362">||</span>&nbsp;<span class="ident" id="3274365">l</span><span class="op" id="3274366">.</span><span class="ident" id="3274367">input</span><span class="op" id="3274372">[</span><span class="ident" id="3274373">l</span><span class="op" id="3274374">.</span><span class="ident" id="3274375">pos</span><span class="op" id="3274378">-</span><span class="num" id="3274379">1</span><span class="op" id="3274380">]</span>&nbsp;<span class="op" id="3274382">!=</span>&nbsp;<span class="string" id="3274385">&#39;i&#39;</span>&nbsp;<span class="op" id="3274389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274394">return</span>&nbsp;<span class="ident" id="3274401">l</span><span class="op" id="3274402">.</span><span class="ident" id="3274403">errorf</span><span class="op" id="3274409">(</span><span class="string" id="3274410">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3274433">,</span>&nbsp;<span class="ident" id="3274435">l</span><span class="op" id="3274436">.</span><span class="ident" id="3274437">input</span><span class="op" id="3274442">[</span><span class="ident" id="3274443">l</span><span class="op" id="3274444">.</span><span class="ident" id="3274445">start</span><span class="op" id="3274450">:</span><span class="ident" id="3274451">l</span><span class="op" id="3274452">.</span><span class="ident" id="3274453">pos</span><span class="op" id="3274456">]</span><span class="op" id="3274457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274461">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274465">l</span><span class="op" id="3274466">.</span><span class="ident" id="3274467">emit</span><span class="op" id="3274471">(</span><span class="ident" id="3274472">itemComplex</span><span class="op" id="3274483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274486">}</span>&nbsp;<span class="keyword" id="3274488">else</span>&nbsp;<span class="op" id="3274493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274497">l</span><span class="op" id="3274498">.</span><span class="ident" id="3274499">emit</span><span class="op" id="3274503">(</span><span class="ident" id="3274504">itemNumber</span><span class="op" id="3274514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274520">return</span>&nbsp;<span class="ident" id="3274527">lexInsideAction</span><br>
<span class="lineno">475</span><span class="op" id="3274543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3274546">func</span>&nbsp;<span class="op" id="3274551">(</span><span class="ident" id="3274552">l</span>&nbsp;<span class="op" id="3274554">*</span><span class="ident" id="3274555">lexer</span><span class="op" id="3274560">)</span>&nbsp;<span class="ident" id="3274562">scanNumber</span><span class="op" id="3274572">(</span><span class="op" id="3274573">)</span>&nbsp;<span class="builtintype" id="3274575">bool</span>&nbsp;<span class="op" id="3274580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3274583">//&nbsp;Optional&nbsp;leading&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274610">l</span><span class="op" id="3274611">.</span><span class="ident" id="3274612">accept</span><span class="op" id="3274618">(</span><span class="string" id="3274619">&#34;+-&#34;</span><span class="op" id="3274623">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3274626">//&nbsp;Is&nbsp;it&nbsp;hex?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274641">digits</span>&nbsp;<span class="op" id="3274648">:=</span>&nbsp;<span class="string" id="3274651">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274665">if</span>&nbsp;<span class="ident" id="3274668">l</span><span class="op" id="3274669">.</span><span class="ident" id="3274670">accept</span><span class="op" id="3274676">(</span><span class="string" id="3274677">&#34;0&#34;</span><span class="op" id="3274680">)</span>&nbsp;<span class="op" id="3274682">&amp;&amp;</span>&nbsp;<span class="ident" id="3274685">l</span><span class="op" id="3274686">.</span><span class="ident" id="3274687">accept</span><span class="op" id="3274693">(</span><span class="string" id="3274694">&#34;xX&#34;</span><span class="op" id="3274698">)</span>&nbsp;<span class="op" id="3274700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274704">digits</span>&nbsp;<span class="op" id="3274711">=</span>&nbsp;<span class="string" id="3274713">&#34;0123456789abcdefABCDEF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274739">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274742">l</span><span class="op" id="3274743">.</span><span class="ident" id="3274744">acceptRun</span><span class="op" id="3274753">(</span><span class="ident" id="3274754">digits</span><span class="op" id="3274760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274763">if</span>&nbsp;<span class="ident" id="3274766">l</span><span class="op" id="3274767">.</span><span class="ident" id="3274768">accept</span><span class="op" id="3274774">(</span><span class="string" id="3274775">&#34;.&#34;</span><span class="op" id="3274778">)</span>&nbsp;<span class="op" id="3274780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274784">l</span><span class="op" id="3274785">.</span><span class="ident" id="3274786">acceptRun</span><span class="op" id="3274795">(</span><span class="ident" id="3274796">digits</span><span class="op" id="3274802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274808">if</span>&nbsp;<span class="ident" id="3274811">l</span><span class="op" id="3274812">.</span><span class="ident" id="3274813">accept</span><span class="op" id="3274819">(</span><span class="string" id="3274820">&#34;eE&#34;</span><span class="op" id="3274824">)</span>&nbsp;<span class="op" id="3274826">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274830">l</span><span class="op" id="3274831">.</span><span class="ident" id="3274832">accept</span><span class="op" id="3274838">(</span><span class="string" id="3274839">&#34;+-&#34;</span><span class="op" id="3274843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274847">l</span><span class="op" id="3274848">.</span><span class="ident" id="3274849">acceptRun</span><span class="op" id="3274858">(</span><span class="string" id="3274859">&#34;0123456789&#34;</span><span class="op" id="3274871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3274874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3274877">//&nbsp;Is&nbsp;it&nbsp;imaginary?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274898">l</span><span class="op" id="3274899">.</span><span class="ident" id="3274900">accept</span><span class="op" id="3274906">(</span><span class="string" id="3274907">&#34;i&#34;</span><span class="op" id="3274910">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3274913">//&nbsp;Next&nbsp;thing&nbsp;mustn&#39;t&nbsp;be&nbsp;alphanumeric.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274953">if</span>&nbsp;<span class="ident" id="3274956">isAlphaNumeric</span><span class="op" id="3274970">(</span><span class="ident" id="3274971">l</span><span class="op" id="3274972">.</span><span class="ident" id="3274973">peek</span><span class="op" id="3274977">(</span><span class="op" id="3274978">)</span><span class="op" id="3274979">)</span>&nbsp;<span class="op" id="3274981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3274985">l</span><span class="op" id="3274986">.</span><span class="ident" id="3274987">next</span><span class="op" id="3274991">(</span><span class="op" id="3274992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3274996">return</span>&nbsp;<span class="builtintype" id="3275003">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275010">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275013">return</span>&nbsp;<span class="builtintype" id="3275020">true</span><br>
<span class="lineno"></span><span class="op" id="3275025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275028">//&nbsp;lexQuote&nbsp;scans&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3275063">func</span>&nbsp;<span class="ident" id="3275068">lexQuote</span><span class="op" id="3275076">(</span><span class="ident" id="3275077">l</span>&nbsp;<span class="op" id="3275079">*</span><span class="ident" id="3275080">lexer</span><span class="op" id="3275085">)</span>&nbsp;<span class="ident" id="3275087">stateFn</span>&nbsp;<span class="op" id="3275095">{</span><br>
<span class="lineno">505</span><span class="ident" id="3275097">Loop</span><span class="op" id="3275101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275104">for</span>&nbsp;<span class="op" id="3275108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275112">switch</span>&nbsp;<span class="ident" id="3275119">l</span><span class="op" id="3275120">.</span><span class="ident" id="3275121">next</span><span class="op" id="3275125">(</span><span class="op" id="3275126">)</span>&nbsp;<span class="op" id="3275128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275132">case</span>&nbsp;<span class="string" id="3275137">&#39;\\&#39;</span><span class="op" id="3275141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275146">if</span>&nbsp;<span class="ident" id="3275149">r</span>&nbsp;<span class="op" id="3275151">:=</span>&nbsp;<span class="ident" id="3275154">l</span><span class="op" id="3275155">.</span><span class="ident" id="3275156">next</span><span class="op" id="3275160">(</span><span class="op" id="3275161">)</span><span class="op" id="3275162">;</span>&nbsp;<span class="ident" id="3275164">r</span>&nbsp;<span class="op" id="3275166">!=</span>&nbsp;<span class="ident" id="3275169">eof</span>&nbsp;<span class="op" id="3275173">&amp;&amp;</span>&nbsp;<span class="ident" id="3275176">r</span>&nbsp;<span class="op" id="3275178">!=</span>&nbsp;<span class="string" id="3275181">&#39;\n&#39;</span>&nbsp;<span class="op" id="3275186">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275192">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275206">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275220">case</span>&nbsp;<span class="ident" id="3275225">eof</span><span class="op" id="3275228">,</span>&nbsp;<span class="string" id="3275230">&#39;\n&#39;</span><span class="op" id="3275234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275239">return</span>&nbsp;<span class="ident" id="3275246">l</span><span class="op" id="3275247">.</span><span class="ident" id="3275248">errorf</span><span class="op" id="3275254">(</span><span class="string" id="3275255">&#34;unterminated&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="3275283">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275287">case</span>&nbsp;<span class="string" id="3275292">&#39;&#34;&#39;</span><span class="op" id="3275295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275300">break</span>&nbsp;<span class="ident" id="3275306">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275319">l</span><span class="op" id="3275320">.</span><span class="ident" id="3275321">emit</span><span class="op" id="3275325">(</span><span class="ident" id="3275326">itemString</span><span class="op" id="3275336">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275339">return</span>&nbsp;<span class="ident" id="3275346">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3275362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275365">//&nbsp;lexRawQuote&nbsp;scans&nbsp;a&nbsp;raw&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3275407">func</span>&nbsp;<span class="ident" id="3275412">lexRawQuote</span><span class="op" id="3275423">(</span><span class="ident" id="3275424">l</span>&nbsp;<span class="op" id="3275426">*</span><span class="ident" id="3275427">lexer</span><span class="op" id="3275432">)</span>&nbsp;<span class="ident" id="3275434">stateFn</span>&nbsp;<span class="op" id="3275442">{</span><br>
<span class="lineno">525</span><span class="ident" id="3275444">Loop</span><span class="op" id="3275448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275451">for</span>&nbsp;<span class="op" id="3275455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275459">switch</span>&nbsp;<span class="ident" id="3275466">l</span><span class="op" id="3275467">.</span><span class="ident" id="3275468">next</span><span class="op" id="3275472">(</span><span class="op" id="3275473">)</span>&nbsp;<span class="op" id="3275475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275479">case</span>&nbsp;<span class="ident" id="3275484">eof</span><span class="op" id="3275487">,</span>&nbsp;<span class="string" id="3275489">&#39;\n&#39;</span><span class="op" id="3275493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275498">return</span>&nbsp;<span class="ident" id="3275505">l</span><span class="op" id="3275506">.</span><span class="ident" id="3275507">errorf</span><span class="op" id="3275513">(</span><span class="string" id="3275514">&#34;unterminated&nbsp;raw&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="3275546">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275550">case</span>&nbsp;<span class="string" id="3275555">&#39;`&#39;</span><span class="op" id="3275558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275563">break</span>&nbsp;<span class="ident" id="3275569">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3275579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3275582">l</span><span class="op" id="3275583">.</span><span class="ident" id="3275584">emit</span><span class="op" id="3275588">(</span><span class="ident" id="3275589">itemRawString</span><span class="op" id="3275602">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275605">return</span>&nbsp;<span class="ident" id="3275612">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3275628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275631">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;a&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3275682">func</span>&nbsp;<span class="ident" id="3275687">isSpace</span><span class="op" id="3275694">(</span><span class="ident" id="3275695">r</span>&nbsp;<span class="builtintype" id="3275697">rune</span><span class="op" id="3275701">)</span>&nbsp;<span class="builtintype" id="3275703">bool</span>&nbsp;<span class="op" id="3275708">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275711">return</span>&nbsp;<span class="ident" id="3275718">r</span>&nbsp;<span class="op" id="3275720">==</span>&nbsp;<span class="string" id="3275723">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3275727">||</span>&nbsp;<span class="ident" id="3275730">r</span>&nbsp;<span class="op" id="3275732">==</span>&nbsp;<span class="string" id="3275735">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="3275740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275743">//&nbsp;isEndOfLine&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;end-of-line&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3275805">func</span>&nbsp;<span class="ident" id="3275810">isEndOfLine</span><span class="op" id="3275821">(</span><span class="ident" id="3275822">r</span>&nbsp;<span class="builtintype" id="3275824">rune</span><span class="op" id="3275828">)</span>&nbsp;<span class="builtintype" id="3275830">bool</span>&nbsp;<span class="op" id="3275835">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275838">return</span>&nbsp;<span class="ident" id="3275845">r</span>&nbsp;<span class="op" id="3275847">==</span>&nbsp;<span class="string" id="3275850">&#39;\r&#39;</span>&nbsp;<span class="op" id="3275855">||</span>&nbsp;<span class="ident" id="3275858">r</span>&nbsp;<span class="op" id="3275860">==</span>&nbsp;<span class="string" id="3275863">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="3275868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3275871">//&nbsp;isAlphaNumeric&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;alphabetic,&nbsp;digit,&nbsp;or&nbsp;underscore.</span><br>
<span class="lineno"></span><span class="keyword" id="3275947">func</span>&nbsp;<span class="ident" id="3275952">isAlphaNumeric</span><span class="op" id="3275966">(</span><span class="ident" id="3275967">r</span>&nbsp;<span class="builtintype" id="3275969">rune</span><span class="op" id="3275973">)</span>&nbsp;<span class="builtintype" id="3275975">bool</span>&nbsp;<span class="op" id="3275980">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3275983">return</span>&nbsp;<span class="ident" id="3275990">r</span>&nbsp;<span class="op" id="3275992">==</span>&nbsp;<span class="string" id="3275995">&#39;_&#39;</span>&nbsp;<span class="op" id="3275999">||</span>&nbsp;<span class="ident" id="3276002">unicode</span><span class="op" id="3276009">.</span><span class="ident" id="3276010">IsLetter</span><span class="op" id="3276018">(</span><span class="ident" id="3276019">r</span><span class="op" id="3276020">)</span>&nbsp;<span class="op" id="3276022">||</span>&nbsp;<span class="ident" id="3276025">unicode</span><span class="op" id="3276032">.</span><span class="ident" id="3276033">IsDigit</span><span class="op" id="3276040">(</span><span class="ident" id="3276041">r</span><span class="op" id="3276042">)</span><br>
<span class="lineno"></span><span class="op" id="3276044">}</span>
</div>
</body>
</html>
