<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5385281">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5385336">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5385390">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5385441">package</span>&nbsp;<span class="ident" id="5385449">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5385456">import</span>&nbsp;<span class="op" id="5385463">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5385466">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5385475">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5385485">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5385490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5385493">//&nbsp;ErrFormat&nbsp;indicates&nbsp;that&nbsp;decoding&nbsp;encountered&nbsp;an&nbsp;unknown&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="5385561">var</span>&nbsp;<span class="ident" id="5385565">ErrFormat</span>&nbsp;<span class="op" id="5385575">=</span>&nbsp;<span class="ident" id="5385577">errors</span><span class="op" id="5385583">.</span><span class="ident" id="5385584">New</span><span class="op" id="5385587">(</span><span class="string" id="5385588">&#34;image:&nbsp;unknown&nbsp;format&#34;</span><span class="op" id="5385611">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5385614">//&nbsp;A&nbsp;format&nbsp;holds&nbsp;an&nbsp;image&nbsp;format&#39;s&nbsp;name,&nbsp;magic&nbsp;header&nbsp;and&nbsp;how&nbsp;to&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="5385691">type</span>&nbsp;<span class="ident" id="5385696">format</span>&nbsp;<span class="keyword" id="5385703">struct</span>&nbsp;<span class="op" id="5385710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385713">name</span><span class="op" id="5385717">,</span>&nbsp;<span class="ident" id="5385719">magic</span>&nbsp;&nbsp;<span class="builtintype" id="5385726">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385734">decode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5385747">func</span><span class="op" id="5385751">(</span><span class="ident" id="5385752">io</span><span class="op" id="5385754">.</span><span class="ident" id="5385755">Reader</span><span class="op" id="5385761">)</span>&nbsp;<span class="op" id="5385763">(</span><span class="ident" id="5385764">Image</span><span class="op" id="5385769">,</span>&nbsp;<span class="builtintype" id="5385771">error</span><span class="op" id="5385776">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5385779">decodeConfig</span>&nbsp;<span class="keyword" id="5385792">func</span><span class="op" id="5385796">(</span><span class="ident" id="5385797">io</span><span class="op" id="5385799">.</span><span class="ident" id="5385800">Reader</span><span class="op" id="5385806">)</span>&nbsp;<span class="op" id="5385808">(</span><span class="ident" id="5385809">Config</span><span class="op" id="5385815">,</span>&nbsp;<span class="builtintype" id="5385817">error</span><span class="op" id="5385822">)</span><br>
<span class="lineno"></span><span class="op" id="5385824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5385827">//&nbsp;Formats&nbsp;is&nbsp;the&nbsp;list&nbsp;of&nbsp;registered&nbsp;formats.</span><br>
<span class="lineno"></span><span class="keyword" id="5385873">var</span>&nbsp;<span class="ident" id="5385877">formats</span>&nbsp;<span class="op" id="5385885">[</span><span class="op" id="5385886">]</span><span class="ident" id="5385887">format</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5385895">//&nbsp;RegisterFormat&nbsp;registers&nbsp;an&nbsp;image&nbsp;format&nbsp;for&nbsp;use&nbsp;by&nbsp;Decode.</span><br>
<span class="lineno"></span><span class="comment" id="5385958">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;format,&nbsp;like&nbsp;&#34;jpeg&#34;&nbsp;or&nbsp;&#34;png&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5386015">//&nbsp;Magic&nbsp;is&nbsp;the&nbsp;magic&nbsp;prefix&nbsp;that&nbsp;identifies&nbsp;the&nbsp;format&#39;s&nbsp;encoding.&nbsp;The&nbsp;magic</span><br>
<span class="lineno"></span><span class="comment" id="5386093">//&nbsp;string&nbsp;can&nbsp;contain&nbsp;&#34;?&#34;&nbsp;wildcards&nbsp;that&nbsp;each&nbsp;match&nbsp;any&nbsp;one&nbsp;byte.</span><br>
<span class="lineno">30</span><span class="comment" id="5386159">//&nbsp;Decode&nbsp;is&nbsp;the&nbsp;function&nbsp;that&nbsp;decodes&nbsp;the&nbsp;encoded&nbsp;image.</span><br>
<span class="lineno"></span><span class="comment" id="5386217">//&nbsp;DecodeConfig&nbsp;is&nbsp;the&nbsp;function&nbsp;that&nbsp;decodes&nbsp;just&nbsp;its&nbsp;configuration.</span><br>
<span class="lineno"></span><span class="keyword" id="5386286">func</span>&nbsp;<span class="ident" id="5386291">RegisterFormat</span><span class="op" id="5386305">(</span><span class="ident" id="5386306">name</span><span class="op" id="5386310">,</span>&nbsp;<span class="ident" id="5386312">magic</span>&nbsp;<span class="builtintype" id="5386318">string</span><span class="op" id="5386324">,</span>&nbsp;<span class="ident" id="5386326">decode</span>&nbsp;<span class="keyword" id="5386333">func</span><span class="op" id="5386337">(</span><span class="ident" id="5386338">io</span><span class="op" id="5386340">.</span><span class="ident" id="5386341">Reader</span><span class="op" id="5386347">)</span>&nbsp;<span class="op" id="5386349">(</span><span class="ident" id="5386350">Image</span><span class="op" id="5386355">,</span>&nbsp;<span class="builtintype" id="5386357">error</span><span class="op" id="5386362">)</span><span class="op" id="5386363">,</span>&nbsp;<span class="ident" id="5386365">decodeConfig</span>&nbsp;<span class="keyword" id="5386378">func</span><span class="op" id="5386382">(</span><span class="ident" id="5386383">io</span><span class="op" id="5386385">.</span><span class="ident" id="5386386">Reader</span><span class="op" id="5386392">)</span>&nbsp;<span class="op" id="5386394">(</span><span class="ident" id="5386395">Config</span><span class="op" id="5386401">,</span>&nbsp;<span class="builtintype" id="5386403">error</span><span class="op" id="5386408">)</span><span class="op" id="5386409">)</span>&nbsp;<span class="op" id="5386411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386414">formats</span>&nbsp;<span class="op" id="5386422">=</span>&nbsp;<span class="builtinfunc" id="5386424">append</span><span class="op" id="5386430">(</span><span class="ident" id="5386431">formats</span><span class="op" id="5386438">,</span>&nbsp;<span class="ident" id="5386440">format</span><span class="op" id="5386446">{</span><span class="ident" id="5386447">name</span><span class="op" id="5386451">,</span>&nbsp;<span class="ident" id="5386453">magic</span><span class="op" id="5386458">,</span>&nbsp;<span class="ident" id="5386460">decode</span><span class="op" id="5386466">,</span>&nbsp;<span class="ident" id="5386468">decodeConfig</span><span class="op" id="5386480">}</span><span class="op" id="5386481">)</span><br>
<span class="lineno"></span><span class="op" id="5386483">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="5386486">//&nbsp;A&nbsp;reader&nbsp;is&nbsp;an&nbsp;io.Reader&nbsp;that&nbsp;can&nbsp;also&nbsp;peek&nbsp;ahead.</span><br>
<span class="lineno"></span><span class="keyword" id="5386540">type</span>&nbsp;<span class="ident" id="5386545">reader</span>&nbsp;<span class="keyword" id="5386552">interface</span>&nbsp;<span class="op" id="5386562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386565">io</span><span class="op" id="5386567">.</span><span class="ident" id="5386568">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5386576">Peek</span><span class="op" id="5386580">(</span><span class="builtintype" id="5386581">int</span><span class="op" id="5386584">)</span>&nbsp;<span class="op" id="5386586">(</span><span class="op" id="5386587">[</span><span class="op" id="5386588">]</span><span class="builtintype" id="5386589">byte</span><span class="op" id="5386593">,</span>&nbsp;<span class="builtintype" id="5386595">error</span><span class="op" id="5386600">)</span><br>
<span class="lineno">40</span><span class="op" id="5386602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5386605">//&nbsp;asReader&nbsp;converts&nbsp;an&nbsp;io.Reader&nbsp;to&nbsp;a&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5386652">func</span>&nbsp;<span class="ident" id="5386657">asReader</span><span class="op" id="5386665">(</span><span class="ident" id="5386666">r</span>&nbsp;<span class="ident" id="5386668">io</span><span class="op" id="5386670">.</span><span class="ident" id="5386671">Reader</span><span class="op" id="5386677">)</span>&nbsp;<span class="ident" id="5386679">reader</span>&nbsp;<span class="op" id="5386686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386689">if</span>&nbsp;<span class="ident" id="5386692">rr</span><span class="op" id="5386694">,</span>&nbsp;<span class="ident" id="5386696">ok</span>&nbsp;<span class="op" id="5386699">:=</span>&nbsp;<span class="ident" id="5386702">r</span><span class="op" id="5386703">.</span><span class="op" id="5386704">(</span><span class="ident" id="5386705">reader</span><span class="op" id="5386711">)</span><span class="op" id="5386712">;</span>&nbsp;<span class="ident" id="5386714">ok</span>&nbsp;<span class="op" id="5386717">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386721">return</span>&nbsp;<span class="ident" id="5386728">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386735">return</span>&nbsp;<span class="ident" id="5386742">bufio</span><span class="op" id="5386747">.</span><span class="ident" id="5386748">NewReader</span><span class="op" id="5386757">(</span><span class="ident" id="5386758">r</span><span class="op" id="5386759">)</span><br>
<span class="lineno"></span><span class="op" id="5386761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="5386764">//&nbsp;Match&nbsp;reports&nbsp;whether&nbsp;magic&nbsp;matches&nbsp;b.&nbsp;Magic&nbsp;may&nbsp;contain&nbsp;&#34;?&#34;&nbsp;wildcards.</span><br>
<span class="lineno"></span><span class="keyword" id="5386839">func</span>&nbsp;<span class="ident" id="5386844">match</span><span class="op" id="5386849">(</span><span class="ident" id="5386850">magic</span>&nbsp;<span class="builtintype" id="5386856">string</span><span class="op" id="5386862">,</span>&nbsp;<span class="ident" id="5386864">b</span>&nbsp;<span class="op" id="5386866">[</span><span class="op" id="5386867">]</span><span class="builtintype" id="5386868">byte</span><span class="op" id="5386872">)</span>&nbsp;<span class="builtintype" id="5386874">bool</span>&nbsp;<span class="op" id="5386879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386882">if</span>&nbsp;<span class="builtinfunc" id="5386885">len</span><span class="op" id="5386888">(</span><span class="ident" id="5386889">magic</span><span class="op" id="5386894">)</span>&nbsp;<span class="op" id="5386896">!=</span>&nbsp;<span class="builtinfunc" id="5386899">len</span><span class="op" id="5386902">(</span><span class="ident" id="5386903">b</span><span class="op" id="5386904">)</span>&nbsp;<span class="op" id="5386906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386910">return</span>&nbsp;<span class="builtintype" id="5386917">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5386924">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386927">for</span>&nbsp;<span class="ident" id="5386931">i</span><span class="op" id="5386932">,</span>&nbsp;<span class="ident" id="5386934">c</span>&nbsp;<span class="op" id="5386936">:=</span>&nbsp;<span class="keyword" id="5386939">range</span>&nbsp;<span class="ident" id="5386945">b</span>&nbsp;<span class="op" id="5386947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386951">if</span>&nbsp;<span class="ident" id="5386954">magic</span><span class="op" id="5386959">[</span><span class="ident" id="5386960">i</span><span class="op" id="5386961">]</span>&nbsp;<span class="op" id="5386963">!=</span>&nbsp;<span class="ident" id="5386966">c</span>&nbsp;<span class="op" id="5386968">&amp;&amp;</span>&nbsp;<span class="ident" id="5386971">magic</span><span class="op" id="5386976">[</span><span class="ident" id="5386977">i</span><span class="op" id="5386978">]</span>&nbsp;<span class="op" id="5386980">!=</span>&nbsp;<span class="string" id="5386983">&#39;?&#39;</span>&nbsp;<span class="op" id="5386987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5386992">return</span>&nbsp;<span class="builtintype" id="5386999">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387010">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387013">return</span>&nbsp;<span class="builtintype" id="5387020">true</span><br>
<span class="lineno"></span><span class="op" id="5387025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5387028">//&nbsp;Sniff&nbsp;determines&nbsp;the&nbsp;format&nbsp;of&nbsp;r&#39;s&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5387072">func</span>&nbsp;<span class="ident" id="5387077">sniff</span><span class="op" id="5387082">(</span><span class="ident" id="5387083">r</span>&nbsp;<span class="ident" id="5387085">reader</span><span class="op" id="5387091">)</span>&nbsp;<span class="ident" id="5387093">format</span>&nbsp;<span class="op" id="5387100">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387103">for</span>&nbsp;<span class="ident" id="5387107">_</span><span class="op" id="5387108">,</span>&nbsp;<span class="ident" id="5387110">f</span>&nbsp;<span class="op" id="5387112">:=</span>&nbsp;<span class="keyword" id="5387115">range</span>&nbsp;<span class="ident" id="5387121">formats</span>&nbsp;<span class="op" id="5387129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387133">b</span><span class="op" id="5387134">,</span>&nbsp;<span class="ident" id="5387136">err</span>&nbsp;<span class="op" id="5387140">:=</span>&nbsp;<span class="ident" id="5387143">r</span><span class="op" id="5387144">.</span><span class="ident" id="5387145">Peek</span><span class="op" id="5387149">(</span><span class="builtinfunc" id="5387150">len</span><span class="op" id="5387153">(</span><span class="ident" id="5387154">f</span><span class="op" id="5387155">.</span><span class="ident" id="5387156">magic</span><span class="op" id="5387161">)</span><span class="op" id="5387162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387166">if</span>&nbsp;<span class="ident" id="5387169">err</span>&nbsp;<span class="op" id="5387173">==</span>&nbsp;<span class="ident" id="5387176">nil</span>&nbsp;<span class="op" id="5387180">&amp;&amp;</span>&nbsp;<span class="ident" id="5387183">match</span><span class="op" id="5387188">(</span><span class="ident" id="5387189">f</span><span class="op" id="5387190">.</span><span class="ident" id="5387191">magic</span><span class="op" id="5387196">,</span>&nbsp;<span class="ident" id="5387198">b</span><span class="op" id="5387199">)</span>&nbsp;<span class="op" id="5387201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387206">return</span>&nbsp;<span class="ident" id="5387213">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387217">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387223">return</span>&nbsp;<span class="ident" id="5387230">format</span><span class="op" id="5387236">{</span><span class="op" id="5387237">}</span><br>
<span class="lineno"></span><span class="op" id="5387239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5387242">//&nbsp;Decode&nbsp;decodes&nbsp;an&nbsp;image&nbsp;that&nbsp;has&nbsp;been&nbsp;encoded&nbsp;in&nbsp;a&nbsp;registered&nbsp;format.</span><br>
<span class="lineno">75</span><span class="comment" id="5387315">//&nbsp;The&nbsp;string&nbsp;returned&nbsp;is&nbsp;the&nbsp;format&nbsp;name&nbsp;used&nbsp;during&nbsp;format&nbsp;registration.</span><br>
<span class="lineno"></span><span class="comment" id="5387390">//&nbsp;Format&nbsp;registration&nbsp;is&nbsp;typically&nbsp;done&nbsp;by&nbsp;an&nbsp;init&nbsp;function&nbsp;in&nbsp;the&nbsp;codec-</span><br>
<span class="lineno"></span><span class="comment" id="5387465">//&nbsp;specific&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5387486">func</span>&nbsp;<span class="ident" id="5387491">Decode</span><span class="op" id="5387497">(</span><span class="ident" id="5387498">r</span>&nbsp;<span class="ident" id="5387500">io</span><span class="op" id="5387502">.</span><span class="ident" id="5387503">Reader</span><span class="op" id="5387509">)</span>&nbsp;<span class="op" id="5387511">(</span><span class="ident" id="5387512">Image</span><span class="op" id="5387517">,</span>&nbsp;<span class="builtintype" id="5387519">string</span><span class="op" id="5387525">,</span>&nbsp;<span class="builtintype" id="5387527">error</span><span class="op" id="5387532">)</span>&nbsp;<span class="op" id="5387534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387537">rr</span>&nbsp;<span class="op" id="5387540">:=</span>&nbsp;<span class="ident" id="5387543">asReader</span><span class="op" id="5387551">(</span><span class="ident" id="5387552">r</span><span class="op" id="5387553">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387556">f</span>&nbsp;<span class="op" id="5387558">:=</span>&nbsp;<span class="ident" id="5387561">sniff</span><span class="op" id="5387566">(</span><span class="ident" id="5387567">rr</span><span class="op" id="5387569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387572">if</span>&nbsp;<span class="ident" id="5387575">f</span><span class="op" id="5387576">.</span><span class="ident" id="5387577">decode</span>&nbsp;<span class="op" id="5387584">==</span>&nbsp;<span class="ident" id="5387587">nil</span>&nbsp;<span class="op" id="5387591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387595">return</span>&nbsp;<span class="ident" id="5387602">nil</span><span class="op" id="5387605">,</span>&nbsp;<span class="string" id="5387607">&#34;&#34;</span><span class="op" id="5387609">,</span>&nbsp;<span class="ident" id="5387611">ErrFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387625">m</span><span class="op" id="5387626">,</span>&nbsp;<span class="ident" id="5387628">err</span>&nbsp;<span class="op" id="5387632">:=</span>&nbsp;<span class="ident" id="5387635">f</span><span class="op" id="5387636">.</span><span class="ident" id="5387637">decode</span><span class="op" id="5387643">(</span><span class="ident" id="5387644">rr</span><span class="op" id="5387646">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387649">return</span>&nbsp;<span class="ident" id="5387656">m</span><span class="op" id="5387657">,</span>&nbsp;<span class="ident" id="5387659">f</span><span class="op" id="5387660">.</span><span class="ident" id="5387661">name</span><span class="op" id="5387665">,</span>&nbsp;<span class="ident" id="5387667">err</span><br>
<span class="lineno"></span><span class="op" id="5387671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5387674">//&nbsp;DecodeConfig&nbsp;decodes&nbsp;the&nbsp;color&nbsp;model&nbsp;and&nbsp;dimensions&nbsp;of&nbsp;an&nbsp;image&nbsp;that&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="5387750">//&nbsp;been&nbsp;encoded&nbsp;in&nbsp;a&nbsp;registered&nbsp;format.&nbsp;The&nbsp;string&nbsp;returned&nbsp;is&nbsp;the&nbsp;format&nbsp;name</span><br>
<span class="lineno">90</span><span class="comment" id="5387829">//&nbsp;used&nbsp;during&nbsp;format&nbsp;registration.&nbsp;Format&nbsp;registration&nbsp;is&nbsp;typically&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5387906">//&nbsp;an&nbsp;init&nbsp;function&nbsp;in&nbsp;the&nbsp;codec-specific&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5387957">func</span>&nbsp;<span class="ident" id="5387962">DecodeConfig</span><span class="op" id="5387974">(</span><span class="ident" id="5387975">r</span>&nbsp;<span class="ident" id="5387977">io</span><span class="op" id="5387979">.</span><span class="ident" id="5387980">Reader</span><span class="op" id="5387986">)</span>&nbsp;<span class="op" id="5387988">(</span><span class="ident" id="5387989">Config</span><span class="op" id="5387995">,</span>&nbsp;<span class="builtintype" id="5387997">string</span><span class="op" id="5388003">,</span>&nbsp;<span class="builtintype" id="5388005">error</span><span class="op" id="5388010">)</span>&nbsp;<span class="op" id="5388012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388015">rr</span>&nbsp;<span class="op" id="5388018">:=</span>&nbsp;<span class="ident" id="5388021">asReader</span><span class="op" id="5388029">(</span><span class="ident" id="5388030">r</span><span class="op" id="5388031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388034">f</span>&nbsp;<span class="op" id="5388036">:=</span>&nbsp;<span class="ident" id="5388039">sniff</span><span class="op" id="5388044">(</span><span class="ident" id="5388045">rr</span><span class="op" id="5388047">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388050">if</span>&nbsp;<span class="ident" id="5388053">f</span><span class="op" id="5388054">.</span><span class="ident" id="5388055">decodeConfig</span>&nbsp;<span class="op" id="5388068">==</span>&nbsp;<span class="ident" id="5388071">nil</span>&nbsp;<span class="op" id="5388075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388079">return</span>&nbsp;<span class="ident" id="5388086">Config</span><span class="op" id="5388092">{</span><span class="op" id="5388093">}</span><span class="op" id="5388094">,</span>&nbsp;<span class="string" id="5388096">&#34;&#34;</span><span class="op" id="5388098">,</span>&nbsp;<span class="ident" id="5388100">ErrFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5388111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388114">c</span><span class="op" id="5388115">,</span>&nbsp;<span class="ident" id="5388117">err</span>&nbsp;<span class="op" id="5388121">:=</span>&nbsp;<span class="ident" id="5388124">f</span><span class="op" id="5388125">.</span><span class="ident" id="5388126">decodeConfig</span><span class="op" id="5388138">(</span><span class="ident" id="5388139">rr</span><span class="op" id="5388141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5388144">return</span>&nbsp;<span class="ident" id="5388151">c</span><span class="op" id="5388152">,</span>&nbsp;<span class="ident" id="5388154">f</span><span class="op" id="5388155">.</span><span class="ident" id="5388156">name</span><span class="op" id="5388160">,</span>&nbsp;<span class="ident" id="5388162">err</span><br>
<span class="lineno">100</span><span class="op" id="5388166">}</span>
</div>
</body>
</html>
