<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3326044">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3326099">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3326153">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3326204">package</span>&nbsp;<span class="ident" id="3326212">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3326218">import</span>&nbsp;<span class="op" id="3326225">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326228">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326237">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326244">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326251">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326258">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326269">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3326280">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3326287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3326290">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="3326344">//</span><br>
<span class="lineno"></span><span class="comment" id="3326347">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3326389">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3326466">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3326524">type</span>&nbsp;<span class="ident" id="3326529">Cookie</span>&nbsp;<span class="keyword" id="3326536">struct</span>&nbsp;<span class="op" id="3326543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326546">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326557">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326565">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326576">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326584">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326595">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326603">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326614">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326622">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326633"><a href="/net/http/cookie.go.html#3326280">time</a></span><span class="op" id="3326637">.</span><span class="ident" id="3326638">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326644">RawExpires</span>&nbsp;<span class="builtintype" id="3326655">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326664">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326717">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326781">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326847">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326856">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326861">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326870">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326876">HttpOnly</span>&nbsp;<span class="builtintype" id="3326885">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326891">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3326900">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326908">Unparsed</span>&nbsp;<span class="op" id="3326917">[</span><span class="op" id="3326918">]</span><span class="builtintype" id="3326919">string</span>&nbsp;<span class="comment" id="3326926">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="3326972">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3326975">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3327029">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="3327090">func</span>&nbsp;<span class="ident" id="3327095">readSetCookies</span><span class="op" id="3327109">(</span><span class="ident" id="3327110">h</span>&nbsp;<span class="ident" id="3327112"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3327118">)</span>&nbsp;<span class="op" id="3327120">[</span><span class="op" id="3327121">]</span><span class="op" id="3327122">*</span><span class="ident" id="3327123"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span>&nbsp;<span class="op" id="3327130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327133">cookies</span>&nbsp;<span class="op" id="3327141">:=</span>&nbsp;<span class="op" id="3327144">[</span><span class="op" id="3327145">]</span><span class="op" id="3327146">*</span><span class="ident" id="3327147"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3327153">{</span><span class="op" id="3327154">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327157">for</span>&nbsp;<span class="ident" id="3327161">_</span><span class="op" id="3327162">,</span>&nbsp;<span class="ident" id="3327164">line</span>&nbsp;<span class="op" id="3327169">:=</span>&nbsp;<span class="keyword" id="3327172">range</span>&nbsp;<span class="ident" id="3327178"><a href="/net/http/cookie.go.html#3327110">h</a></span><span class="op" id="3327179">[</span><span class="string" id="3327180">&#34;Set-Cookie&#34;</span><span class="op" id="3327192">]</span>&nbsp;<span class="op" id="3327194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327198">parts</span>&nbsp;<span class="op" id="3327204">:=</span>&nbsp;<span class="ident" id="3327207"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327214">.</span><span class="ident" id="3327215">Split</span><span class="op" id="3327220">(</span><span class="ident" id="3327221"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327228">.</span><span class="ident" id="3327229">TrimSpace</span><span class="op" id="3327238">(</span><span class="ident" id="3327239"><a href="/net/http/cookie.go.html#3327164">line</a></span><span class="op" id="3327243">)</span><span class="op" id="3327244">,</span>&nbsp;<span class="string" id="3327246">&#34;;&#34;</span><span class="op" id="3327249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327253">if</span>&nbsp;<span class="builtinfunc" id="3327256">len</span><span class="op" id="3327259">(</span><span class="ident" id="3327260"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327265">)</span>&nbsp;<span class="op" id="3327267">==</span>&nbsp;<span class="num" id="3327270">1</span>&nbsp;<span class="op" id="3327272">&amp;&amp;</span>&nbsp;<span class="ident" id="3327275"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327280">[</span><span class="num" id="3327281">0</span><span class="op" id="3327282">]</span>&nbsp;<span class="op" id="3327284">==</span>&nbsp;<span class="string" id="3327287">&#34;&#34;</span>&nbsp;<span class="op" id="3327290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327295">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327306">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327310"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327315">[</span><span class="num" id="3327316">0</span><span class="op" id="3327317">]</span>&nbsp;<span class="op" id="3327319">=</span>&nbsp;<span class="ident" id="3327321"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327328">.</span><span class="ident" id="3327329">TrimSpace</span><span class="op" id="3327338">(</span><span class="ident" id="3327339"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327344">[</span><span class="num" id="3327345">0</span><span class="op" id="3327346">]</span><span class="op" id="3327347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327351">j</span>&nbsp;<span class="op" id="3327353">:=</span>&nbsp;<span class="ident" id="3327356"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327363">.</span><span class="ident" id="3327364">Index</span><span class="op" id="3327369">(</span><span class="ident" id="3327370"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327375">[</span><span class="num" id="3327376">0</span><span class="op" id="3327377">]</span><span class="op" id="3327378">,</span>&nbsp;<span class="string" id="3327380">&#34;=&#34;</span><span class="op" id="3327383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327387">if</span>&nbsp;<span class="ident" id="3327390"><a href="/net/http/cookie.go.html#3327351">j</a></span>&nbsp;<span class="op" id="3327392">&lt;</span>&nbsp;<span class="num" id="3327394">0</span>&nbsp;<span class="op" id="3327396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327401">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327412">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327416">name</span><span class="op" id="3327420">,</span>&nbsp;<span class="ident" id="3327422">value</span>&nbsp;<span class="op" id="3327428">:=</span>&nbsp;<span class="ident" id="3327431"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327436">[</span><span class="num" id="3327437">0</span><span class="op" id="3327438">]</span><span class="op" id="3327439">[</span><span class="op" id="3327440">:</span><span class="ident" id="3327441"><a href="/net/http/cookie.go.html#3327351">j</a></span><span class="op" id="3327442">]</span><span class="op" id="3327443">,</span>&nbsp;<span class="ident" id="3327445"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327450">[</span><span class="num" id="3327451">0</span><span class="op" id="3327452">]</span><span class="op" id="3327453">[</span><span class="ident" id="3327454"><a href="/net/http/cookie.go.html#3327351">j</a></span><span class="op" id="3327455">+</span><span class="num" id="3327456">1</span><span class="op" id="3327457">:</span><span class="op" id="3327458">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327462">if</span>&nbsp;<span class="op" id="3327465">!</span><span class="ident" id="3327466"><a href="/net/http/cookie.go.html#3334816">isCookieNameValid</a></span><span class="op" id="3327483">(</span><span class="ident" id="3327484"><a href="/net/http/cookie.go.html#3327416">name</a></span><span class="op" id="3327488">)</span>&nbsp;<span class="op" id="3327490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327495">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327510"><a href="/net/http/cookie.go.html#3327422">value</a></span><span class="op" id="3327515">,</span>&nbsp;<span class="ident" id="3327517">success</span>&nbsp;<span class="op" id="3327525">:=</span>&nbsp;<span class="ident" id="3327528"><a href="/net/http/cookie.go.html#3334477">parseCookieValue</a></span><span class="op" id="3327544">(</span><span class="ident" id="3327545"><a href="/net/http/cookie.go.html#3327422">value</a></span><span class="op" id="3327550">,</span>&nbsp;<span class="builtintype" id="3327552">true</span><span class="op" id="3327556">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327560">if</span>&nbsp;<span class="op" id="3327563">!</span><span class="ident" id="3327564"><a href="/net/http/cookie.go.html#3327517">success</a></span>&nbsp;<span class="op" id="3327572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327577">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327592">c</span>&nbsp;<span class="op" id="3327594">:=</span>&nbsp;<span class="op" id="3327597">&amp;</span><span class="ident" id="3327598"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3327604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327609">Name</span><span class="op" id="3327613">:</span>&nbsp;&nbsp;<span class="ident" id="3327616"><a href="/net/http/cookie.go.html#3327416">name</a></span><span class="op" id="3327620">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327625">Value</span><span class="op" id="3327630">:</span>&nbsp;<span class="ident" id="3327632"><a href="/net/http/cookie.go.html#3327422">value</a></span><span class="op" id="3327637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327642">Raw</span><span class="op" id="3327645">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3327649"><a href="/net/http/cookie.go.html#3327164">line</a></span><span class="op" id="3327653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327661">for</span>&nbsp;<span class="ident" id="3327665">i</span>&nbsp;<span class="op" id="3327667">:=</span>&nbsp;<span class="num" id="3327670">1</span><span class="op" id="3327671">;</span>&nbsp;<span class="ident" id="3327673"><a href="/net/http/cookie.go.html#3327665">i</a></span>&nbsp;<span class="op" id="3327675">&lt;</span>&nbsp;<span class="builtinfunc" id="3327677">len</span><span class="op" id="3327680">(</span><span class="ident" id="3327681"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327686">)</span><span class="op" id="3327687">;</span>&nbsp;<span class="ident" id="3327689"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3327690">++</span>&nbsp;<span class="op" id="3327693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327698"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327703">[</span><span class="ident" id="3327704"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3327705">]</span>&nbsp;<span class="op" id="3327707">=</span>&nbsp;<span class="ident" id="3327709"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327716">.</span><span class="ident" id="3327717">TrimSpace</span><span class="op" id="3327726">(</span><span class="ident" id="3327727"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327732">[</span><span class="ident" id="3327733"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3327734">]</span><span class="op" id="3327735">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327740">if</span>&nbsp;<span class="builtinfunc" id="3327743">len</span><span class="op" id="3327746">(</span><span class="ident" id="3327747"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327752">[</span><span class="ident" id="3327753"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3327754">]</span><span class="op" id="3327755">)</span>&nbsp;<span class="op" id="3327757">==</span>&nbsp;<span class="num" id="3327760">0</span>&nbsp;<span class="op" id="3327762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327768">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327786">attr</span><span class="op" id="3327790">,</span>&nbsp;<span class="ident" id="3327792">val</span>&nbsp;<span class="op" id="3327796">:=</span>&nbsp;<span class="ident" id="3327799"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3327804">[</span><span class="ident" id="3327805"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3327806">]</span><span class="op" id="3327807">,</span>&nbsp;<span class="string" id="3327809">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327815">if</span>&nbsp;<span class="ident" id="3327818">j</span>&nbsp;<span class="op" id="3327820">:=</span>&nbsp;<span class="ident" id="3327823"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327830">.</span><span class="ident" id="3327831">Index</span><span class="op" id="3327836">(</span><span class="ident" id="3327837"><a href="/net/http/cookie.go.html#3327786">attr</a></span><span class="op" id="3327841">,</span>&nbsp;<span class="string" id="3327843">&#34;=&#34;</span><span class="op" id="3327846">)</span><span class="op" id="3327847">;</span>&nbsp;<span class="ident" id="3327849"><a href="/net/http/cookie.go.html#3327818">j</a></span>&nbsp;<span class="op" id="3327851">&gt;=</span>&nbsp;<span class="num" id="3327854">0</span>&nbsp;<span class="op" id="3327856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327862"><a href="/net/http/cookie.go.html#3327786">attr</a></span><span class="op" id="3327866">,</span>&nbsp;<span class="ident" id="3327868"><a href="/net/http/cookie.go.html#3327792">val</a></span>&nbsp;<span class="op" id="3327872">=</span>&nbsp;<span class="ident" id="3327874"><a href="/net/http/cookie.go.html#3327786">attr</a></span><span class="op" id="3327878">[</span><span class="op" id="3327879">:</span><span class="ident" id="3327880"><a href="/net/http/cookie.go.html#3327818">j</a></span><span class="op" id="3327881">]</span><span class="op" id="3327882">,</span>&nbsp;<span class="ident" id="3327884"><a href="/net/http/cookie.go.html#3327786">attr</a></span><span class="op" id="3327888">[</span><span class="ident" id="3327889"><a href="/net/http/cookie.go.html#3327818">j</a></span><span class="op" id="3327890">+</span><span class="num" id="3327891">1</span><span class="op" id="3327892">:</span><span class="op" id="3327893">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327903">lowerAttr</span>&nbsp;<span class="op" id="3327913">:=</span>&nbsp;<span class="ident" id="3327916"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3327923">.</span><span class="ident" id="3327924">ToLower</span><span class="op" id="3327931">(</span><span class="ident" id="3327932"><a href="/net/http/cookie.go.html#3327786">attr</a></span><span class="op" id="3327936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3327941"><a href="/net/http/cookie.go.html#3327792">val</a></span><span class="op" id="3327944">,</span>&nbsp;<span class="ident" id="3327946"><a href="/net/http/cookie.go.html#3327517">success</a></span>&nbsp;<span class="op" id="3327954">=</span>&nbsp;<span class="ident" id="3327956"><a href="/net/http/cookie.go.html#3334477">parseCookieValue</a></span><span class="op" id="3327972">(</span><span class="ident" id="3327973"><a href="/net/http/cookie.go.html#3327792">val</a></span><span class="op" id="3327976">,</span>&nbsp;<span class="builtintype" id="3327978">false</span><span class="op" id="3327983">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3327988">if</span>&nbsp;<span class="op" id="3327991">!</span><span class="ident" id="3327992"><a href="/net/http/cookie.go.html#3327517">success</a></span>&nbsp;<span class="op" id="3328000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328006"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328007">.</span><span class="ident" id="3328008">Unparsed</span>&nbsp;<span class="op" id="3328017">=</span>&nbsp;<span class="builtinfunc" id="3328019">append</span><span class="op" id="3328025">(</span><span class="ident" id="3328026"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328027">.</span><span class="ident" id="3328028">Unparsed</span><span class="op" id="3328036">,</span>&nbsp;<span class="ident" id="3328038"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3328043">[</span><span class="ident" id="3328044"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3328045">]</span><span class="op" id="3328046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328052">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328069">switch</span>&nbsp;<span class="ident" id="3328076"><a href="/net/http/cookie.go.html#3327903">lowerAttr</a></span>&nbsp;<span class="op" id="3328086">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328091">case</span>&nbsp;<span class="string" id="3328096">&#34;secure&#34;</span><span class="op" id="3328104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328110"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328111">.</span><span class="ident" id="3328112">Secure</span>&nbsp;<span class="op" id="3328119">=</span>&nbsp;<span class="builtintype" id="3328121">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328130">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328142">case</span>&nbsp;<span class="string" id="3328147">&#34;httponly&#34;</span><span class="op" id="3328157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328163"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328164">.</span><span class="ident" id="3328165">HttpOnly</span>&nbsp;<span class="op" id="3328174">=</span>&nbsp;<span class="builtintype" id="3328176">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328185">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328197">case</span>&nbsp;<span class="string" id="3328202">&#34;domain&#34;</span><span class="op" id="3328210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328216"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328217">.</span><span class="ident" id="3328218">Domain</span>&nbsp;<span class="op" id="3328225">=</span>&nbsp;<span class="ident" id="3328227"><a href="/net/http/cookie.go.html#3327792">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328235">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328247">case</span>&nbsp;<span class="string" id="3328252">&#34;max-age&#34;</span><span class="op" id="3328261">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328267">secs</span><span class="op" id="3328271">,</span>&nbsp;<span class="ident" id="3328273">err</span>&nbsp;<span class="op" id="3328277">:=</span>&nbsp;<span class="ident" id="3328280"><a href="/net/http/cookie.go.html#3326258">strconv</a></span><span class="op" id="3328287">.</span><span class="ident" id="3328288">Atoi</span><span class="op" id="3328292">(</span><span class="ident" id="3328293"><a href="/net/http/cookie.go.html#3327792">val</a></span><span class="op" id="3328296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328302">if</span>&nbsp;<span class="ident" id="3328305"><a href="/net/http/cookie.go.html#3328273">err</a></span>&nbsp;<span class="op" id="3328309">!=</span>&nbsp;<span class="ident" id="3328312">nil</span>&nbsp;<span class="op" id="3328316">||</span>&nbsp;<span class="ident" id="3328319"><a href="/net/http/cookie.go.html#3328267">secs</a></span>&nbsp;<span class="op" id="3328324">!=</span>&nbsp;<span class="num" id="3328327">0</span>&nbsp;<span class="op" id="3328329">&amp;&amp;</span>&nbsp;<span class="ident" id="3328332"><a href="/net/http/cookie.go.html#3327792">val</a></span><span class="op" id="3328335">[</span><span class="num" id="3328336">0</span><span class="op" id="3328337">]</span>&nbsp;<span class="op" id="3328339">==</span>&nbsp;<span class="string" id="3328342">&#39;0&#39;</span>&nbsp;<span class="op" id="3328346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328353">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328369">if</span>&nbsp;<span class="ident" id="3328372"><a href="/net/http/cookie.go.html#3328267">secs</a></span>&nbsp;<span class="op" id="3328377">&lt;=</span>&nbsp;<span class="num" id="3328380">0</span>&nbsp;<span class="op" id="3328382">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328389"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328390">.</span><span class="ident" id="3328391">MaxAge</span>&nbsp;<span class="op" id="3328398">=</span>&nbsp;<span class="op" id="3328400">-</span><span class="num" id="3328401">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328407">}</span>&nbsp;<span class="keyword" id="3328409">else</span>&nbsp;<span class="op" id="3328414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328421"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328422">.</span><span class="ident" id="3328423">MaxAge</span>&nbsp;<span class="op" id="3328430">=</span>&nbsp;<span class="ident" id="3328432"><a href="/net/http/cookie.go.html#3328267">secs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328447">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328459">case</span>&nbsp;<span class="string" id="3328464">&#34;expires&#34;</span><span class="op" id="3328473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328479"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328480">.</span><span class="ident" id="3328481">RawExpires</span>&nbsp;<span class="op" id="3328492">=</span>&nbsp;<span class="ident" id="3328494"><a href="/net/http/cookie.go.html#3327792">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328502">exptime</span><span class="op" id="3328509">,</span>&nbsp;<span class="ident" id="3328511">err</span>&nbsp;<span class="op" id="3328515">:=</span>&nbsp;<span class="ident" id="3328518"><a href="/net/http/cookie.go.html#3326280">time</a></span><span class="op" id="3328522">.</span><span class="ident" id="3328523">Parse</span><span class="op" id="3328528">(</span><span class="ident" id="3328529"><a href="/net/http/cookie.go.html#3326280">time</a></span><span class="op" id="3328533">.</span><span class="ident" id="3328534">RFC1123</span><span class="op" id="3328541">,</span>&nbsp;<span class="ident" id="3328543"><a href="/net/http/cookie.go.html#3327792">val</a></span><span class="op" id="3328546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328552">if</span>&nbsp;<span class="ident" id="3328555"><a href="/net/http/cookie.go.html#3328511">err</a></span>&nbsp;<span class="op" id="3328559">!=</span>&nbsp;<span class="ident" id="3328562">nil</span>&nbsp;<span class="op" id="3328566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328573"><a href="/net/http/cookie.go.html#3328502">exptime</a></span><span class="op" id="3328580">,</span>&nbsp;<span class="ident" id="3328582"><a href="/net/http/cookie.go.html#3328511">err</a></span>&nbsp;<span class="op" id="3328586">=</span>&nbsp;<span class="ident" id="3328588"><a href="/net/http/cookie.go.html#3326280">time</a></span><span class="op" id="3328592">.</span><span class="ident" id="3328593">Parse</span><span class="op" id="3328598">(</span><span class="string" id="3328599">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="3328630">,</span>&nbsp;<span class="ident" id="3328632"><a href="/net/http/cookie.go.html#3327792">val</a></span><span class="op" id="3328635">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328642">if</span>&nbsp;<span class="ident" id="3328645"><a href="/net/http/cookie.go.html#3328511">err</a></span>&nbsp;<span class="op" id="3328649">!=</span>&nbsp;<span class="ident" id="3328652">nil</span>&nbsp;<span class="op" id="3328656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328664"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328665">.</span><span class="ident" id="3328666">Expires</span>&nbsp;<span class="op" id="3328674">=</span>&nbsp;<span class="ident" id="3328676"><a href="/net/http/cookie.go.html#3326280">time</a></span><span class="op" id="3328680">.</span><span class="ident" id="3328681">Time</span><span class="op" id="3328685">{</span><span class="op" id="3328686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328694">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328711">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328717"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328718">.</span><span class="ident" id="3328719">Expires</span>&nbsp;<span class="op" id="3328727">=</span>&nbsp;<span class="ident" id="3328729"><a href="/net/http/cookie.go.html#3328502">exptime</a></span><span class="op" id="3328736">.</span><span class="ident" id="3328737">UTC</span><span class="op" id="3328740">(</span><span class="op" id="3328741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328747">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328759">case</span>&nbsp;<span class="string" id="3328764">&#34;path&#34;</span><span class="op" id="3328770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328776"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328777">.</span><span class="ident" id="3328778">Path</span>&nbsp;<span class="op" id="3328783">=</span>&nbsp;<span class="ident" id="3328785"><a href="/net/http/cookie.go.html#3327792">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328793">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328810"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328811">.</span><span class="ident" id="3328812">Unparsed</span>&nbsp;<span class="op" id="3328821">=</span>&nbsp;<span class="builtinfunc" id="3328823">append</span><span class="op" id="3328829">(</span><span class="ident" id="3328830"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328831">.</span><span class="ident" id="3328832">Unparsed</span><span class="op" id="3328840">,</span>&nbsp;<span class="ident" id="3328842"><a href="/net/http/cookie.go.html#3327198">parts</a></span><span class="op" id="3328847">[</span><span class="ident" id="3328848"><a href="/net/http/cookie.go.html#3327665">i</a></span><span class="op" id="3328849">]</span><span class="op" id="3328850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328858"><a href="/net/http/cookie.go.html#3327133">cookies</a></span>&nbsp;<span class="op" id="3328866">=</span>&nbsp;<span class="builtinfunc" id="3328868">append</span><span class="op" id="3328874">(</span><span class="ident" id="3328875"><a href="/net/http/cookie.go.html#3327133">cookies</a></span><span class="op" id="3328882">,</span>&nbsp;<span class="ident" id="3328884"><a href="/net/http/cookie.go.html#3327592">c</a></span><span class="op" id="3328885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328888">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328891">return</span>&nbsp;<span class="ident" id="3328898"><a href="/net/http/cookie.go.html#3327133">cookies</a></span><br>
<span class="lineno"></span><span class="op" id="3328906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3328909">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="3328989">func</span>&nbsp;<span class="ident" id="3328994">SetCookie</span><span class="op" id="3329003">(</span><span class="ident" id="3329004">w</span>&nbsp;<span class="ident" id="3329006"><a href="/net/http/server.go.html#3401101">ResponseWriter</a></span><span class="op" id="3329020">,</span>&nbsp;<span class="ident" id="3329022">cookie</span>&nbsp;<span class="op" id="3329029">*</span><span class="ident" id="3329030"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3329036">)</span>&nbsp;<span class="op" id="3329038">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329041"><a href="/net/http/cookie.go.html#3329004">w</a></span><span class="op" id="3329042">.</span><span class="ident" id="3329043">Header</span><span class="op" id="3329049">(</span><span class="op" id="3329050">)</span><span class="op" id="3329051">.</span><span class="ident" id="3329052">Add</span><span class="op" id="3329055">(</span><span class="string" id="3329056">&#34;Set-Cookie&#34;</span><span class="op" id="3329068">,</span>&nbsp;<span class="ident" id="3329070"><a href="/net/http/cookie.go.html#3329022">cookie</a></span><span class="op" id="3329076">.</span><span class="ident" id="3329077">String</span><span class="op" id="3329083">(</span><span class="op" id="3329084">)</span><span class="op" id="3329085">)</span><br>
<span class="lineno"></span><span class="op" id="3329087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3329090">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="3329160">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="3329228">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="3329265">func</span>&nbsp;<span class="op" id="3329270">(</span><span class="ident" id="3329271">c</span>&nbsp;<span class="op" id="3329273">*</span><span class="ident" id="3329274"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3329280">)</span>&nbsp;<span class="ident" id="3329282">String</span><span class="op" id="3329288">(</span><span class="op" id="3329289">)</span>&nbsp;<span class="builtintype" id="3329291">string</span>&nbsp;<span class="op" id="3329298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329301">var</span>&nbsp;<span class="ident" id="3329305">b</span>&nbsp;<span class="ident" id="3329307"><a href="/net/http/cookie.go.html#3326228">bytes</a></span><span class="op" id="3329312">.</span><span class="ident" id="3329313">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329321"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3329324">.</span><span class="ident" id="3329325">Fprintf</span><span class="op" id="3329332">(</span><span class="op" id="3329333">&amp;</span><span class="ident" id="3329334"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3329335">,</span>&nbsp;<span class="string" id="3329337">&#34;%s=%s&#34;</span><span class="op" id="3329344">,</span>&nbsp;<span class="ident" id="3329346"><a href="/net/http/cookie.go.html#3332761">sanitizeCookieName</a></span><span class="op" id="3329364">(</span><span class="ident" id="3329365"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329366">.</span><span class="ident" id="3329367">Name</span><span class="op" id="3329371">)</span><span class="op" id="3329372">,</span>&nbsp;<span class="ident" id="3329374"><a href="/net/http/cookie.go.html#3333387">sanitizeCookieValue</a></span><span class="op" id="3329393">(</span><span class="ident" id="3329394"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329395">.</span><span class="ident" id="3329396">Value</span><span class="op" id="3329401">)</span><span class="op" id="3329402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329405">if</span>&nbsp;<span class="builtinfunc" id="3329408">len</span><span class="op" id="3329411">(</span><span class="ident" id="3329412"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329413">.</span><span class="ident" id="3329414">Path</span><span class="op" id="3329418">)</span>&nbsp;<span class="op" id="3329420">&gt;</span>&nbsp;<span class="num" id="3329422">0</span>&nbsp;<span class="op" id="3329424">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329428"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3329431">.</span><span class="ident" id="3329432">Fprintf</span><span class="op" id="3329439">(</span><span class="op" id="3329440">&amp;</span><span class="ident" id="3329441"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3329442">,</span>&nbsp;<span class="string" id="3329444">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="3329455">,</span>&nbsp;<span class="ident" id="3329457"><a href="/net/http/cookie.go.html#3333846">sanitizeCookiePath</a></span><span class="op" id="3329475">(</span><span class="ident" id="3329476"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329477">.</span><span class="ident" id="3329478">Path</span><span class="op" id="3329482">)</span><span class="op" id="3329483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329489">if</span>&nbsp;<span class="builtinfunc" id="3329492">len</span><span class="op" id="3329495">(</span><span class="ident" id="3329496"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329497">.</span><span class="ident" id="3329498">Domain</span><span class="op" id="3329504">)</span>&nbsp;<span class="op" id="3329506">&gt;</span>&nbsp;<span class="num" id="3329508">0</span>&nbsp;<span class="op" id="3329510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329514">if</span>&nbsp;<span class="ident" id="3329517"><a href="/net/http/cookie.go.html#3331397">validCookieDomain</a></span><span class="op" id="3329534">(</span><span class="ident" id="3329535"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329536">.</span><span class="ident" id="3329537">Domain</span><span class="op" id="3329543">)</span>&nbsp;<span class="op" id="3329545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329550">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329604">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329662">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329715">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329740">d</span>&nbsp;<span class="op" id="3329742">:=</span>&nbsp;<span class="ident" id="3329745"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329746">.</span><span class="ident" id="3329747">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329757">if</span>&nbsp;<span class="ident" id="3329760"><a href="/net/http/cookie.go.html#3329740">d</a></span><span class="op" id="3329761">[</span><span class="num" id="3329762">0</span><span class="op" id="3329763">]</span>&nbsp;<span class="op" id="3329765">==</span>&nbsp;<span class="string" id="3329768">&#39;.&#39;</span>&nbsp;<span class="op" id="3329772">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329778"><a href="/net/http/cookie.go.html#3329740">d</a></span>&nbsp;<span class="op" id="3329780">=</span>&nbsp;<span class="ident" id="3329782"><a href="/net/http/cookie.go.html#3329740">d</a></span><span class="op" id="3329783">[</span><span class="num" id="3329784">1</span><span class="op" id="3329785">:</span><span class="op" id="3329786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329796"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3329799">.</span><span class="ident" id="3329800">Fprintf</span><span class="op" id="3329807">(</span><span class="op" id="3329808">&amp;</span><span class="ident" id="3329809"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3329810">,</span>&nbsp;<span class="string" id="3329812">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="3329825">,</span>&nbsp;<span class="ident" id="3329827"><a href="/net/http/cookie.go.html#3329740">d</a></span><span class="op" id="3329828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329832">}</span>&nbsp;<span class="keyword" id="3329834">else</span>&nbsp;<span class="op" id="3329839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329844"><a href="/net/http/cookie.go.html#3326244">log</a></span><span class="op" id="3329847">.</span><span class="ident" id="3329848">Printf</span><span class="op" id="3329854">(</span><span class="string" id="3329855">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3329918">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329924"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329925">.</span><span class="ident" id="3329926">Domain</span><span class="op" id="3329932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329942">if</span>&nbsp;<span class="ident" id="3329945"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3329946">.</span><span class="ident" id="3329947">Expires</span><span class="op" id="3329954">.</span><span class="ident" id="3329955">Unix</span><span class="op" id="3329959">(</span><span class="op" id="3329960">)</span>&nbsp;<span class="op" id="3329962">&gt;</span>&nbsp;<span class="num" id="3329964">0</span>&nbsp;<span class="op" id="3329966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329970"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3329973">.</span><span class="ident" id="3329974">Fprintf</span><span class="op" id="3329981">(</span><span class="op" id="3329982">&amp;</span><span class="ident" id="3329983"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3329984">,</span>&nbsp;<span class="string" id="3329986">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="3330000">,</span>&nbsp;<span class="ident" id="3330002"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3330003">.</span><span class="ident" id="3330004">Expires</span><span class="op" id="3330011">.</span><span class="ident" id="3330012">UTC</span><span class="op" id="3330015">(</span><span class="op" id="3330016">)</span><span class="op" id="3330017">.</span><span class="ident" id="3330018">Format</span><span class="op" id="3330024">(</span><span class="ident" id="3330025"><a href="/net/http/cookie.go.html#3326280">time</a></span><span class="op" id="3330029">.</span><span class="ident" id="3330030">RFC1123</span><span class="op" id="3330037">)</span><span class="op" id="3330038">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330044">if</span>&nbsp;<span class="ident" id="3330047"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3330048">.</span><span class="ident" id="3330049">MaxAge</span>&nbsp;<span class="op" id="3330056">&gt;</span>&nbsp;<span class="num" id="3330058">0</span>&nbsp;<span class="op" id="3330060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330064"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3330067">.</span><span class="ident" id="3330068">Fprintf</span><span class="op" id="3330075">(</span><span class="op" id="3330076">&amp;</span><span class="ident" id="3330077"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3330078">,</span>&nbsp;<span class="string" id="3330080">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="3330094">,</span>&nbsp;<span class="ident" id="3330096"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3330097">.</span><span class="ident" id="3330098">MaxAge</span><span class="op" id="3330104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330107">}</span>&nbsp;<span class="keyword" id="3330109">else</span>&nbsp;<span class="keyword" id="3330114">if</span>&nbsp;<span class="ident" id="3330117"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3330118">.</span><span class="ident" id="3330119">MaxAge</span>&nbsp;<span class="op" id="3330126">&lt;</span>&nbsp;<span class="num" id="3330128">0</span>&nbsp;<span class="op" id="3330130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330134"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3330137">.</span><span class="ident" id="3330138">Fprintf</span><span class="op" id="3330145">(</span><span class="op" id="3330146">&amp;</span><span class="ident" id="3330147"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3330148">,</span>&nbsp;<span class="string" id="3330150">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="3330163">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330169">if</span>&nbsp;<span class="ident" id="3330172"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3330173">.</span><span class="ident" id="3330174">HttpOnly</span>&nbsp;<span class="op" id="3330183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330187"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3330190">.</span><span class="ident" id="3330191">Fprintf</span><span class="op" id="3330198">(</span><span class="op" id="3330199">&amp;</span><span class="ident" id="3330200"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3330201">,</span>&nbsp;<span class="string" id="3330203">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="3330215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330221">if</span>&nbsp;<span class="ident" id="3330224"><a href="/net/http/cookie.go.html#3329271">c</a></span><span class="op" id="3330225">.</span><span class="ident" id="3330226">Secure</span>&nbsp;<span class="op" id="3330233">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330237"><a href="/net/http/cookie.go.html#3326237">fmt</a></span><span class="op" id="3330240">.</span><span class="ident" id="3330241">Fprintf</span><span class="op" id="3330248">(</span><span class="op" id="3330249">&amp;</span><span class="ident" id="3330250"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3330251">,</span>&nbsp;<span class="string" id="3330253">&#34;;&nbsp;Secure&#34;</span><span class="op" id="3330263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330269">return</span>&nbsp;<span class="ident" id="3330276"><a href="/net/http/cookie.go.html#3329305">b</a></span><span class="op" id="3330277">.</span><span class="ident" id="3330278">String</span><span class="op" id="3330284">(</span><span class="op" id="3330285">)</span><br>
<span class="lineno"></span><span class="op" id="3330287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3330290">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3330354">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="3330398">//</span><br>
<span class="lineno"></span><span class="comment" id="3330401">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="3330466">func</span>&nbsp;<span class="ident" id="3330471">readCookies</span><span class="op" id="3330482">(</span><span class="ident" id="3330483">h</span>&nbsp;<span class="ident" id="3330485"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3330491">,</span>&nbsp;<span class="ident" id="3330493">filter</span>&nbsp;<span class="builtintype" id="3330500">string</span><span class="op" id="3330506">)</span>&nbsp;<span class="op" id="3330508">[</span><span class="op" id="3330509">]</span><span class="op" id="3330510">*</span><span class="ident" id="3330511"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span>&nbsp;<span class="op" id="3330518">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330521">cookies</span>&nbsp;<span class="op" id="3330529">:=</span>&nbsp;<span class="op" id="3330532">[</span><span class="op" id="3330533">]</span><span class="op" id="3330534">*</span><span class="ident" id="3330535"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3330541">{</span><span class="op" id="3330542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330545">lines</span><span class="op" id="3330550">,</span>&nbsp;<span class="ident" id="3330552">ok</span>&nbsp;<span class="op" id="3330555">:=</span>&nbsp;<span class="ident" id="3330558"><a href="/net/http/cookie.go.html#3330483">h</a></span><span class="op" id="3330559">[</span><span class="string" id="3330560">&#34;Cookie&#34;</span><span class="op" id="3330568">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330571">if</span>&nbsp;<span class="op" id="3330574">!</span><span class="ident" id="3330575"><a href="/net/http/cookie.go.html#3330552">ok</a></span>&nbsp;<span class="op" id="3330578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330582">return</span>&nbsp;<span class="ident" id="3330589"><a href="/net/http/cookie.go.html#3330521">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330598">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330602">for</span>&nbsp;<span class="ident" id="3330606">_</span><span class="op" id="3330607">,</span>&nbsp;<span class="ident" id="3330609">line</span>&nbsp;<span class="op" id="3330614">:=</span>&nbsp;<span class="keyword" id="3330617">range</span>&nbsp;<span class="ident" id="3330623"><a href="/net/http/cookie.go.html#3330545">lines</a></span>&nbsp;<span class="op" id="3330629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330633">parts</span>&nbsp;<span class="op" id="3330639">:=</span>&nbsp;<span class="ident" id="3330642"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3330649">.</span><span class="ident" id="3330650">Split</span><span class="op" id="3330655">(</span><span class="ident" id="3330656"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3330663">.</span><span class="ident" id="3330664">TrimSpace</span><span class="op" id="3330673">(</span><span class="ident" id="3330674"><a href="/net/http/cookie.go.html#3330609">line</a></span><span class="op" id="3330678">)</span><span class="op" id="3330679">,</span>&nbsp;<span class="string" id="3330681">&#34;;&#34;</span><span class="op" id="3330684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330688">if</span>&nbsp;<span class="builtinfunc" id="3330691">len</span><span class="op" id="3330694">(</span><span class="ident" id="3330695"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330700">)</span>&nbsp;<span class="op" id="3330702">==</span>&nbsp;<span class="num" id="3330705">1</span>&nbsp;<span class="op" id="3330707">&amp;&amp;</span>&nbsp;<span class="ident" id="3330710"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330715">[</span><span class="num" id="3330716">0</span><span class="op" id="3330717">]</span>&nbsp;<span class="op" id="3330719">==</span>&nbsp;<span class="string" id="3330722">&#34;&#34;</span>&nbsp;<span class="op" id="3330725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330730">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3330745">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330770">parsedPairs</span>&nbsp;<span class="op" id="3330782">:=</span>&nbsp;<span class="num" id="3330785">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330789">for</span>&nbsp;<span class="ident" id="3330793">i</span>&nbsp;<span class="op" id="3330795">:=</span>&nbsp;<span class="num" id="3330798">0</span><span class="op" id="3330799">;</span>&nbsp;<span class="ident" id="3330801"><a href="/net/http/cookie.go.html#3330793">i</a></span>&nbsp;<span class="op" id="3330803">&lt;</span>&nbsp;<span class="builtinfunc" id="3330805">len</span><span class="op" id="3330808">(</span><span class="ident" id="3330809"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330814">)</span><span class="op" id="3330815">;</span>&nbsp;<span class="ident" id="3330817"><a href="/net/http/cookie.go.html#3330793">i</a></span><span class="op" id="3330818">++</span>&nbsp;<span class="op" id="3330821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330826"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330831">[</span><span class="ident" id="3330832"><a href="/net/http/cookie.go.html#3330793">i</a></span><span class="op" id="3330833">]</span>&nbsp;<span class="op" id="3330835">=</span>&nbsp;<span class="ident" id="3330837"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3330844">.</span><span class="ident" id="3330845">TrimSpace</span><span class="op" id="3330854">(</span><span class="ident" id="3330855"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330860">[</span><span class="ident" id="3330861"><a href="/net/http/cookie.go.html#3330793">i</a></span><span class="op" id="3330862">]</span><span class="op" id="3330863">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330868">if</span>&nbsp;<span class="builtinfunc" id="3330871">len</span><span class="op" id="3330874">(</span><span class="ident" id="3330875"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330880">[</span><span class="ident" id="3330881"><a href="/net/http/cookie.go.html#3330793">i</a></span><span class="op" id="3330882">]</span><span class="op" id="3330883">)</span>&nbsp;<span class="op" id="3330885">==</span>&nbsp;<span class="num" id="3330888">0</span>&nbsp;<span class="op" id="3330890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330896">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3330908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330913">name</span><span class="op" id="3330917">,</span>&nbsp;<span class="ident" id="3330919">val</span>&nbsp;<span class="op" id="3330923">:=</span>&nbsp;<span class="ident" id="3330926"><a href="/net/http/cookie.go.html#3330633">parts</a></span><span class="op" id="3330931">[</span><span class="ident" id="3330932"><a href="/net/http/cookie.go.html#3330793">i</a></span><span class="op" id="3330933">]</span><span class="op" id="3330934">,</span>&nbsp;<span class="string" id="3330936">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330942">if</span>&nbsp;<span class="ident" id="3330945">j</span>&nbsp;<span class="op" id="3330947">:=</span>&nbsp;<span class="ident" id="3330950"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3330957">.</span><span class="ident" id="3330958">Index</span><span class="op" id="3330963">(</span><span class="ident" id="3330964"><a href="/net/http/cookie.go.html#3330913">name</a></span><span class="op" id="3330968">,</span>&nbsp;<span class="string" id="3330970">&#34;=&#34;</span><span class="op" id="3330973">)</span><span class="op" id="3330974">;</span>&nbsp;<span class="ident" id="3330976"><a href="/net/http/cookie.go.html#3330945">j</a></span>&nbsp;<span class="op" id="3330978">&gt;=</span>&nbsp;<span class="num" id="3330981">0</span>&nbsp;<span class="op" id="3330983">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330989"><a href="/net/http/cookie.go.html#3330913">name</a></span><span class="op" id="3330993">,</span>&nbsp;<span class="ident" id="3330995"><a href="/net/http/cookie.go.html#3330919">val</a></span>&nbsp;<span class="op" id="3330999">=</span>&nbsp;<span class="ident" id="3331001"><a href="/net/http/cookie.go.html#3330913">name</a></span><span class="op" id="3331005">[</span><span class="op" id="3331006">:</span><span class="ident" id="3331007"><a href="/net/http/cookie.go.html#3330945">j</a></span><span class="op" id="3331008">]</span><span class="op" id="3331009">,</span>&nbsp;<span class="ident" id="3331011"><a href="/net/http/cookie.go.html#3330913">name</a></span><span class="op" id="3331015">[</span><span class="ident" id="3331016"><a href="/net/http/cookie.go.html#3330945">j</a></span><span class="op" id="3331017">+</span><span class="num" id="3331018">1</span><span class="op" id="3331019">:</span><span class="op" id="3331020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331030">if</span>&nbsp;<span class="op" id="3331033">!</span><span class="ident" id="3331034"><a href="/net/http/cookie.go.html#3334816">isCookieNameValid</a></span><span class="op" id="3331051">(</span><span class="ident" id="3331052"><a href="/net/http/cookie.go.html#3330913">name</a></span><span class="op" id="3331056">)</span>&nbsp;<span class="op" id="3331058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331064">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331076">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331081">if</span>&nbsp;<span class="ident" id="3331084"><a href="/net/http/cookie.go.html#3330493">filter</a></span>&nbsp;<span class="op" id="3331091">!=</span>&nbsp;<span class="string" id="3331094">&#34;&#34;</span>&nbsp;<span class="op" id="3331097">&amp;&amp;</span>&nbsp;<span class="ident" id="3331100"><a href="/net/http/cookie.go.html#3330493">filter</a></span>&nbsp;<span class="op" id="3331107">!=</span>&nbsp;<span class="ident" id="3331110"><a href="/net/http/cookie.go.html#3330913">name</a></span>&nbsp;<span class="op" id="3331115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331121">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331138"><a href="/net/http/cookie.go.html#3330919">val</a></span><span class="op" id="3331141">,</span>&nbsp;<span class="ident" id="3331143">success</span>&nbsp;<span class="op" id="3331151">:=</span>&nbsp;<span class="ident" id="3331154"><a href="/net/http/cookie.go.html#3334477">parseCookieValue</a></span><span class="op" id="3331170">(</span><span class="ident" id="3331171"><a href="/net/http/cookie.go.html#3330919">val</a></span><span class="op" id="3331174">,</span>&nbsp;<span class="builtintype" id="3331176">true</span><span class="op" id="3331180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331185">if</span>&nbsp;<span class="op" id="3331188">!</span><span class="ident" id="3331189"><a href="/net/http/cookie.go.html#3331143">success</a></span>&nbsp;<span class="op" id="3331197">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331203">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331220"><a href="/net/http/cookie.go.html#3330521">cookies</a></span>&nbsp;<span class="op" id="3331228">=</span>&nbsp;<span class="builtinfunc" id="3331230">append</span><span class="op" id="3331236">(</span><span class="ident" id="3331237"><a href="/net/http/cookie.go.html#3330521">cookies</a></span><span class="op" id="3331244">,</span>&nbsp;<span class="op" id="3331246">&amp;</span><span class="ident" id="3331247"><a href="/net/http/cookie.go.html#3326529">Cookie</a></span><span class="op" id="3331253">{</span><span class="ident" id="3331254">Name</span><span class="op" id="3331258">:</span>&nbsp;<span class="ident" id="3331260"><a href="/net/http/cookie.go.html#3330913">name</a></span><span class="op" id="3331264">,</span>&nbsp;<span class="ident" id="3331266">Value</span><span class="op" id="3331271">:</span>&nbsp;<span class="ident" id="3331273"><a href="/net/http/cookie.go.html#3330919">val</a></span><span class="op" id="3331276">}</span><span class="op" id="3331277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331282"><a href="/net/http/cookie.go.html#3330770">parsedPairs</a></span><span class="op" id="3331293">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331298">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331304">return</span>&nbsp;<span class="ident" id="3331311"><a href="/net/http/cookie.go.html#3330521">cookies</a></span><br>
<span class="lineno"></span><span class="op" id="3331319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3331322">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="3331392">func</span>&nbsp;<span class="ident" id="3331397">validCookieDomain</span><span class="op" id="3331414">(</span><span class="ident" id="3331415">v</span>&nbsp;<span class="builtintype" id="3331417">string</span><span class="op" id="3331423">)</span>&nbsp;<span class="builtintype" id="3331425">bool</span>&nbsp;<span class="op" id="3331430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331433">if</span>&nbsp;<span class="ident" id="3331436"><a href="/net/http/cookie.go.html#3331748">isCookieDomainName</a></span><span class="op" id="3331454">(</span><span class="ident" id="3331455"><a href="/net/http/cookie.go.html#3331415">v</a></span><span class="op" id="3331456">)</span>&nbsp;<span class="op" id="3331458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331462">return</span>&nbsp;<span class="builtintype" id="3331469">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331478">if</span>&nbsp;<span class="ident" id="3331481"><a href="/net/http/cookie.go.html#3326251">net</a></span><span class="op" id="3331484">.</span><span class="ident" id="3331485">ParseIP</span><span class="op" id="3331492">(</span><span class="ident" id="3331493"><a href="/net/http/cookie.go.html#3331415">v</a></span><span class="op" id="3331494">)</span>&nbsp;<span class="op" id="3331496">!=</span>&nbsp;<span class="ident" id="3331499">nil</span>&nbsp;<span class="op" id="3331503">&amp;&amp;</span>&nbsp;<span class="op" id="3331506">!</span><span class="ident" id="3331507"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3331514">.</span><span class="ident" id="3331515">Contains</span><span class="op" id="3331523">(</span><span class="ident" id="3331524"><a href="/net/http/cookie.go.html#3331415">v</a></span><span class="op" id="3331525">,</span>&nbsp;<span class="string" id="3331527">&#34;:&#34;</span><span class="op" id="3331530">)</span>&nbsp;<span class="op" id="3331532">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331536">return</span>&nbsp;<span class="builtintype" id="3331543">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331552">return</span>&nbsp;<span class="builtintype" id="3331559">false</span><br>
<span class="lineno"></span><span class="op" id="3331565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="3331568">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="3331642">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3331712">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="3331743">func</span>&nbsp;<span class="ident" id="3331748">isCookieDomainName</span><span class="op" id="3331766">(</span><span class="ident" id="3331767">s</span>&nbsp;<span class="builtintype" id="3331769">string</span><span class="op" id="3331775">)</span>&nbsp;<span class="builtintype" id="3331777">bool</span>&nbsp;<span class="op" id="3331782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331785">if</span>&nbsp;<span class="builtinfunc" id="3331788">len</span><span class="op" id="3331791">(</span><span class="ident" id="3331792"><a href="/net/http/cookie.go.html#3331767">s</a></span><span class="op" id="3331793">)</span>&nbsp;<span class="op" id="3331795">==</span>&nbsp;<span class="num" id="3331798">0</span>&nbsp;<span class="op" id="3331800">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331804">return</span>&nbsp;<span class="builtintype" id="3331811">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331821">if</span>&nbsp;<span class="builtinfunc" id="3331824">len</span><span class="op" id="3331827">(</span><span class="ident" id="3331828"><a href="/net/http/cookie.go.html#3331767">s</a></span><span class="op" id="3331829">)</span>&nbsp;<span class="op" id="3331831">&gt;</span>&nbsp;<span class="num" id="3331833">255</span>&nbsp;<span class="op" id="3331837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331841">return</span>&nbsp;<span class="builtintype" id="3331848">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331855">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331859">if</span>&nbsp;<span class="ident" id="3331862"><a href="/net/http/cookie.go.html#3331767">s</a></span><span class="op" id="3331863">[</span><span class="num" id="3331864">0</span><span class="op" id="3331865">]</span>&nbsp;<span class="op" id="3331867">==</span>&nbsp;<span class="string" id="3331870">&#39;.&#39;</span>&nbsp;<span class="op" id="3331874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3331878">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331941"><a href="/net/http/cookie.go.html#3331767">s</a></span>&nbsp;<span class="op" id="3331943">=</span>&nbsp;<span class="ident" id="3331945"><a href="/net/http/cookie.go.html#3331767">s</a></span><span class="op" id="3331946">[</span><span class="num" id="3331947">1</span><span class="op" id="3331948">:</span><span class="op" id="3331949">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331952">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331955">last</span>&nbsp;<span class="op" id="3331960">:=</span>&nbsp;<span class="builtintype" id="3331963">byte</span><span class="op" id="3331967">(</span><span class="string" id="3331968">&#39;.&#39;</span><span class="op" id="3331971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331974">ok</span>&nbsp;<span class="op" id="3331977">:=</span>&nbsp;<span class="builtintype" id="3331980">false</span>&nbsp;<span class="comment" id="3331986">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332019">partlen</span>&nbsp;<span class="op" id="3332027">:=</span>&nbsp;<span class="num" id="3332030">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332033">for</span>&nbsp;<span class="ident" id="3332037">i</span>&nbsp;<span class="op" id="3332039">:=</span>&nbsp;<span class="num" id="3332042">0</span><span class="op" id="3332043">;</span>&nbsp;<span class="ident" id="3332045"><a href="/net/http/cookie.go.html#3332037">i</a></span>&nbsp;<span class="op" id="3332047">&lt;</span>&nbsp;<span class="builtinfunc" id="3332049">len</span><span class="op" id="3332052">(</span><span class="ident" id="3332053"><a href="/net/http/cookie.go.html#3331767">s</a></span><span class="op" id="3332054">)</span><span class="op" id="3332055">;</span>&nbsp;<span class="ident" id="3332057"><a href="/net/http/cookie.go.html#3332037">i</a></span><span class="op" id="3332058">++</span>&nbsp;<span class="op" id="3332061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332065">c</span>&nbsp;<span class="op" id="3332067">:=</span>&nbsp;<span class="ident" id="3332070"><a href="/net/http/cookie.go.html#3331767">s</a></span><span class="op" id="3332071">[</span><span class="ident" id="3332072"><a href="/net/http/cookie.go.html#3332037">i</a></span><span class="op" id="3332073">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332077">switch</span>&nbsp;<span class="op" id="3332084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332088">default</span><span class="op" id="3332095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332100">return</span>&nbsp;<span class="builtintype" id="3332107">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332115">case</span>&nbsp;<span class="string" id="3332120">&#39;a&#39;</span>&nbsp;<span class="op" id="3332124">&lt;=</span>&nbsp;<span class="ident" id="3332127"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332129">&amp;&amp;</span>&nbsp;<span class="ident" id="3332132"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332134">&lt;=</span>&nbsp;<span class="string" id="3332137">&#39;z&#39;</span>&nbsp;<span class="op" id="3332141">||</span>&nbsp;<span class="string" id="3332144">&#39;A&#39;</span>&nbsp;<span class="op" id="3332148">&lt;=</span>&nbsp;<span class="ident" id="3332151"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332153">&amp;&amp;</span>&nbsp;<span class="ident" id="3332156"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332158">&lt;=</span>&nbsp;<span class="string" id="3332161">&#39;Z&#39;</span><span class="op" id="3332164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3332169">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332225"><a href="/net/http/cookie.go.html#3331974">ok</a></span>&nbsp;<span class="op" id="3332228">=</span>&nbsp;<span class="builtintype" id="3332230">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332238"><a href="/net/http/cookie.go.html#3332019">partlen</a></span><span class="op" id="3332245">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332250">case</span>&nbsp;<span class="string" id="3332255">&#39;0&#39;</span>&nbsp;<span class="op" id="3332259">&lt;=</span>&nbsp;<span class="ident" id="3332262"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332264">&amp;&amp;</span>&nbsp;<span class="ident" id="3332267"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332269">&lt;=</span>&nbsp;<span class="string" id="3332272">&#39;9&#39;</span><span class="op" id="3332275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3332280">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332291"><a href="/net/http/cookie.go.html#3332019">partlen</a></span><span class="op" id="3332298">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332303">case</span>&nbsp;<span class="ident" id="3332308"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332310">==</span>&nbsp;<span class="string" id="3332313">&#39;-&#39;</span><span class="op" id="3332316">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3332321">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332359">if</span>&nbsp;<span class="ident" id="3332362"><a href="/net/http/cookie.go.html#3331955">last</a></span>&nbsp;<span class="op" id="3332367">==</span>&nbsp;<span class="string" id="3332370">&#39;.&#39;</span>&nbsp;<span class="op" id="3332374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332380">return</span>&nbsp;<span class="builtintype" id="3332387">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332396">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332401"><a href="/net/http/cookie.go.html#3332019">partlen</a></span><span class="op" id="3332408">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332413">case</span>&nbsp;<span class="ident" id="3332418"><a href="/net/http/cookie.go.html#3332065">c</a></span>&nbsp;<span class="op" id="3332420">==</span>&nbsp;<span class="string" id="3332423">&#39;.&#39;</span><span class="op" id="3332426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3332431">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332474">if</span>&nbsp;<span class="ident" id="3332477"><a href="/net/http/cookie.go.html#3331955">last</a></span>&nbsp;<span class="op" id="3332482">==</span>&nbsp;<span class="string" id="3332485">&#39;.&#39;</span>&nbsp;<span class="op" id="3332489">||</span>&nbsp;<span class="ident" id="3332492"><a href="/net/http/cookie.go.html#3331955">last</a></span>&nbsp;<span class="op" id="3332497">==</span>&nbsp;<span class="string" id="3332500">&#39;-&#39;</span>&nbsp;<span class="op" id="3332504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332510">return</span>&nbsp;<span class="builtintype" id="3332517">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332531">if</span>&nbsp;<span class="ident" id="3332534"><a href="/net/http/cookie.go.html#3332019">partlen</a></span>&nbsp;<span class="op" id="3332542">&gt;</span>&nbsp;<span class="num" id="3332544">63</span>&nbsp;<span class="op" id="3332547">||</span>&nbsp;<span class="ident" id="3332550"><a href="/net/http/cookie.go.html#3332019">partlen</a></span>&nbsp;<span class="op" id="3332558">==</span>&nbsp;<span class="num" id="3332561">0</span>&nbsp;<span class="op" id="3332563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332569">return</span>&nbsp;<span class="builtintype" id="3332576">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332590"><a href="/net/http/cookie.go.html#3332019">partlen</a></span>&nbsp;<span class="op" id="3332598">=</span>&nbsp;<span class="num" id="3332600">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332608"><a href="/net/http/cookie.go.html#3331955">last</a></span>&nbsp;<span class="op" id="3332613">=</span>&nbsp;<span class="ident" id="3332615"><a href="/net/http/cookie.go.html#3332065">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332621">if</span>&nbsp;<span class="ident" id="3332624"><a href="/net/http/cookie.go.html#3331955">last</a></span>&nbsp;<span class="op" id="3332629">==</span>&nbsp;<span class="string" id="3332632">&#39;-&#39;</span>&nbsp;<span class="op" id="3332636">||</span>&nbsp;<span class="ident" id="3332639"><a href="/net/http/cookie.go.html#3332019">partlen</a></span>&nbsp;<span class="op" id="3332647">&gt;</span>&nbsp;<span class="num" id="3332649">63</span>&nbsp;<span class="op" id="3332652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332656">return</span>&nbsp;<span class="builtintype" id="3332663">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332674">return</span>&nbsp;<span class="ident" id="3332681"><a href="/net/http/cookie.go.html#3331974">ok</a></span><br>
<span class="lineno"></span><span class="op" id="3332684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3332687">var</span>&nbsp;<span class="ident" id="3332691">cookieNameSanitizer</span>&nbsp;<span class="op" id="3332711">=</span>&nbsp;<span class="ident" id="3332713"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3332720">.</span><span class="ident" id="3332721">NewReplacer</span><span class="op" id="3332732">(</span><span class="string" id="3332733">&#34;\n&#34;</span><span class="op" id="3332737">,</span>&nbsp;<span class="string" id="3332739">&#34;-&#34;</span><span class="op" id="3332742">,</span>&nbsp;<span class="string" id="3332744">&#34;\r&#34;</span><span class="op" id="3332748">,</span>&nbsp;<span class="string" id="3332750">&#34;-&#34;</span><span class="op" id="3332753">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3332756">func</span>&nbsp;<span class="ident" id="3332761">sanitizeCookieName</span><span class="op" id="3332779">(</span><span class="ident" id="3332780">n</span>&nbsp;<span class="builtintype" id="3332782">string</span><span class="op" id="3332788">)</span>&nbsp;<span class="builtintype" id="3332790">string</span>&nbsp;<span class="op" id="3332797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332800">return</span>&nbsp;<span class="ident" id="3332807"><a href="/net/http/cookie.go.html#3332691">cookieNameSanitizer</a></span><span class="op" id="3332826">.</span><span class="ident" id="3332827">Replace</span><span class="op" id="3332834">(</span><span class="ident" id="3332835"><a href="/net/http/cookie.go.html#3332780">n</a></span><span class="op" id="3332836">)</span><br>
<span class="lineno"></span><span class="op" id="3332838">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3332841">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="3332893">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="3332964">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="3333032">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="3333083">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="3333135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="3333164">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3333231">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="3333300">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="3333326">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="3333382">func</span>&nbsp;<span class="ident" id="3333387">sanitizeCookieValue</span><span class="op" id="3333406">(</span><span class="ident" id="3333407">v</span>&nbsp;<span class="builtintype" id="3333409">string</span><span class="op" id="3333415">)</span>&nbsp;<span class="builtintype" id="3333417">string</span>&nbsp;<span class="op" id="3333424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333427"><a href="/net/http/cookie.go.html#3333407">v</a></span>&nbsp;<span class="op" id="3333429">=</span>&nbsp;<span class="ident" id="3333431"><a href="/net/http/cookie.go.html#3334039">sanitizeOrWarn</a></span><span class="op" id="3333445">(</span><span class="string" id="3333446">&#34;Cookie.Value&#34;</span><span class="op" id="3333460">,</span>&nbsp;<span class="ident" id="3333462"><a href="/net/http/cookie.go.html#3333640">validCookieValueByte</a></span><span class="op" id="3333482">,</span>&nbsp;<span class="ident" id="3333484"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333488">if</span>&nbsp;<span class="builtinfunc" id="3333491">len</span><span class="op" id="3333494">(</span><span class="ident" id="3333495"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333496">)</span>&nbsp;<span class="op" id="3333498">==</span>&nbsp;<span class="num" id="3333501">0</span>&nbsp;<span class="op" id="3333503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333507">return</span>&nbsp;<span class="ident" id="3333514"><a href="/net/http/cookie.go.html#3333407">v</a></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3333517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333520">if</span>&nbsp;<span class="ident" id="3333523"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333524">[</span><span class="num" id="3333525">0</span><span class="op" id="3333526">]</span>&nbsp;<span class="op" id="3333528">==</span>&nbsp;<span class="string" id="3333531">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3333535">||</span>&nbsp;<span class="ident" id="3333538"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333539">[</span><span class="num" id="3333540">0</span><span class="op" id="3333541">]</span>&nbsp;<span class="op" id="3333543">==</span>&nbsp;<span class="string" id="3333546">&#39;,&#39;</span>&nbsp;<span class="op" id="3333550">||</span>&nbsp;<span class="ident" id="3333553"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333554">[</span><span class="builtinfunc" id="3333555">len</span><span class="op" id="3333558">(</span><span class="ident" id="3333559"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333560">)</span><span class="op" id="3333561">-</span><span class="num" id="3333562">1</span><span class="op" id="3333563">]</span>&nbsp;<span class="op" id="3333565">==</span>&nbsp;<span class="string" id="3333568">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3333572">||</span>&nbsp;<span class="ident" id="3333575"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333576">[</span><span class="builtinfunc" id="3333577">len</span><span class="op" id="3333580">(</span><span class="ident" id="3333581"><a href="/net/http/cookie.go.html#3333407">v</a></span><span class="op" id="3333582">)</span><span class="op" id="3333583">-</span><span class="num" id="3333584">1</span><span class="op" id="3333585">]</span>&nbsp;<span class="op" id="3333587">==</span>&nbsp;<span class="string" id="3333590">&#39;,&#39;</span>&nbsp;<span class="op" id="3333594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333598">return</span>&nbsp;<span class="string" id="3333605">`&#34;`</span>&nbsp;<span class="op" id="3333609">+</span>&nbsp;<span class="ident" id="3333611"><a href="/net/http/cookie.go.html#3333407">v</a></span>&nbsp;<span class="op" id="3333613">+</span>&nbsp;<span class="string" id="3333615">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3333620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333623">return</span>&nbsp;<span class="ident" id="3333630"><a href="/net/http/cookie.go.html#3333407">v</a></span><br>
<span class="lineno">310</span><span class="op" id="3333632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3333635">func</span>&nbsp;<span class="ident" id="3333640">validCookieValueByte</span><span class="op" id="3333660">(</span><span class="ident" id="3333661">b</span>&nbsp;<span class="builtintype" id="3333663">byte</span><span class="op" id="3333667">)</span>&nbsp;<span class="builtintype" id="3333669">bool</span>&nbsp;<span class="op" id="3333674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333677">return</span>&nbsp;<span class="num" id="3333684">0x20</span>&nbsp;<span class="op" id="3333689">&lt;=</span>&nbsp;<span class="ident" id="3333692"><a href="/net/http/cookie.go.html#3333661">b</a></span>&nbsp;<span class="op" id="3333694">&amp;&amp;</span>&nbsp;<span class="ident" id="3333697"><a href="/net/http/cookie.go.html#3333661">b</a></span>&nbsp;<span class="op" id="3333699">&lt;</span>&nbsp;<span class="num" id="3333701">0x7f</span>&nbsp;<span class="op" id="3333706">&amp;&amp;</span>&nbsp;<span class="ident" id="3333709"><a href="/net/http/cookie.go.html#3333661">b</a></span>&nbsp;<span class="op" id="3333711">!=</span>&nbsp;<span class="string" id="3333714">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3333718">&amp;&amp;</span>&nbsp;<span class="ident" id="3333721"><a href="/net/http/cookie.go.html#3333661">b</a></span>&nbsp;<span class="op" id="3333723">!=</span>&nbsp;<span class="string" id="3333726">&#39;;&#39;</span>&nbsp;<span class="op" id="3333730">&amp;&amp;</span>&nbsp;<span class="ident" id="3333733"><a href="/net/http/cookie.go.html#3333661">b</a></span>&nbsp;<span class="op" id="3333735">!=</span>&nbsp;<span class="string" id="3333738">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="3333743">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3333746">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="3333788">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="3333841">func</span>&nbsp;<span class="ident" id="3333846">sanitizeCookiePath</span><span class="op" id="3333864">(</span><span class="ident" id="3333865">v</span>&nbsp;<span class="builtintype" id="3333867">string</span><span class="op" id="3333873">)</span>&nbsp;<span class="builtintype" id="3333875">string</span>&nbsp;<span class="op" id="3333882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333885">return</span>&nbsp;<span class="ident" id="3333892"><a href="/net/http/cookie.go.html#3334039">sanitizeOrWarn</a></span><span class="op" id="3333906">(</span><span class="string" id="3333907">&#34;Cookie.Path&#34;</span><span class="op" id="3333920">,</span>&nbsp;<span class="ident" id="3333922"><a href="/net/http/cookie.go.html#3333954">validCookiePathByte</a></span><span class="op" id="3333941">,</span>&nbsp;<span class="ident" id="3333943"><a href="/net/http/cookie.go.html#3333865">v</a></span><span class="op" id="3333944">)</span><br>
<span class="lineno">320</span><span class="op" id="3333946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3333949">func</span>&nbsp;<span class="ident" id="3333954">validCookiePathByte</span><span class="op" id="3333973">(</span><span class="ident" id="3333974">b</span>&nbsp;<span class="builtintype" id="3333976">byte</span><span class="op" id="3333980">)</span>&nbsp;<span class="builtintype" id="3333982">bool</span>&nbsp;<span class="op" id="3333987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333990">return</span>&nbsp;<span class="num" id="3333997">0x20</span>&nbsp;<span class="op" id="3334002">&lt;=</span>&nbsp;<span class="ident" id="3334005"><a href="/net/http/cookie.go.html#3333974">b</a></span>&nbsp;<span class="op" id="3334007">&amp;&amp;</span>&nbsp;<span class="ident" id="3334010"><a href="/net/http/cookie.go.html#3333974">b</a></span>&nbsp;<span class="op" id="3334012">&lt;</span>&nbsp;<span class="num" id="3334014">0x7f</span>&nbsp;<span class="op" id="3334019">&amp;&amp;</span>&nbsp;<span class="ident" id="3334022"><a href="/net/http/cookie.go.html#3333974">b</a></span>&nbsp;<span class="op" id="3334024">!=</span>&nbsp;<span class="string" id="3334027">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="3334031">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3334034">func</span>&nbsp;<span class="ident" id="3334039">sanitizeOrWarn</span><span class="op" id="3334053">(</span><span class="ident" id="3334054">fieldName</span>&nbsp;<span class="builtintype" id="3334064">string</span><span class="op" id="3334070">,</span>&nbsp;<span class="ident" id="3334072">valid</span>&nbsp;<span class="keyword" id="3334078">func</span><span class="op" id="3334082">(</span><span class="builtintype" id="3334083">byte</span><span class="op" id="3334087">)</span>&nbsp;<span class="builtintype" id="3334089">bool</span><span class="op" id="3334093">,</span>&nbsp;<span class="ident" id="3334095">v</span>&nbsp;<span class="builtintype" id="3334097">string</span><span class="op" id="3334103">)</span>&nbsp;<span class="builtintype" id="3334105">string</span>&nbsp;<span class="op" id="3334112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334115">ok</span>&nbsp;<span class="op" id="3334118">:=</span>&nbsp;<span class="builtintype" id="3334121">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334127">for</span>&nbsp;<span class="ident" id="3334131">i</span>&nbsp;<span class="op" id="3334133">:=</span>&nbsp;<span class="num" id="3334136">0</span><span class="op" id="3334137">;</span>&nbsp;<span class="ident" id="3334139"><a href="/net/http/cookie.go.html#3334131">i</a></span>&nbsp;<span class="op" id="3334141">&lt;</span>&nbsp;<span class="builtinfunc" id="3334143">len</span><span class="op" id="3334146">(</span><span class="ident" id="3334147"><a href="/net/http/cookie.go.html#3334095">v</a></span><span class="op" id="3334148">)</span><span class="op" id="3334149">;</span>&nbsp;<span class="ident" id="3334151"><a href="/net/http/cookie.go.html#3334131">i</a></span><span class="op" id="3334152">++</span>&nbsp;<span class="op" id="3334155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334159">if</span>&nbsp;<span class="ident" id="3334162"><a href="/net/http/cookie.go.html#3334072">valid</a></span><span class="op" id="3334167">(</span><span class="ident" id="3334168"><a href="/net/http/cookie.go.html#3334095">v</a></span><span class="op" id="3334169">[</span><span class="ident" id="3334170"><a href="/net/http/cookie.go.html#3334131">i</a></span><span class="op" id="3334171">]</span><span class="op" id="3334172">)</span>&nbsp;<span class="op" id="3334174">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334179">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334194"><a href="/net/http/cookie.go.html#3326244">log</a></span><span class="op" id="3334197">.</span><span class="ident" id="3334198">Printf</span><span class="op" id="3334204">(</span><span class="string" id="3334205">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="3334262">,</span>&nbsp;<span class="ident" id="3334264"><a href="/net/http/cookie.go.html#3334095">v</a></span><span class="op" id="3334265">[</span><span class="ident" id="3334266"><a href="/net/http/cookie.go.html#3334131">i</a></span><span class="op" id="3334267">]</span><span class="op" id="3334268">,</span>&nbsp;<span class="ident" id="3334270"><a href="/net/http/cookie.go.html#3334054">fieldName</a></span><span class="op" id="3334279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334283"><a href="/net/http/cookie.go.html#3334115">ok</a></span>&nbsp;<span class="op" id="3334286">=</span>&nbsp;<span class="builtintype" id="3334288">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334296">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334306">if</span>&nbsp;<span class="ident" id="3334309"><a href="/net/http/cookie.go.html#3334115">ok</a></span>&nbsp;<span class="op" id="3334312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334316">return</span>&nbsp;<span class="ident" id="3334323"><a href="/net/http/cookie.go.html#3334095">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334329">buf</span>&nbsp;<span class="op" id="3334333">:=</span>&nbsp;<span class="builtinfunc" id="3334336">make</span><span class="op" id="3334340">(</span><span class="op" id="3334341">[</span><span class="op" id="3334342">]</span><span class="builtintype" id="3334343">byte</span><span class="op" id="3334347">,</span>&nbsp;<span class="num" id="3334349">0</span><span class="op" id="3334350">,</span>&nbsp;<span class="builtinfunc" id="3334352">len</span><span class="op" id="3334355">(</span><span class="ident" id="3334356"><a href="/net/http/cookie.go.html#3334095">v</a></span><span class="op" id="3334357">)</span><span class="op" id="3334358">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334361">for</span>&nbsp;<span class="ident" id="3334365">i</span>&nbsp;<span class="op" id="3334367">:=</span>&nbsp;<span class="num" id="3334370">0</span><span class="op" id="3334371">;</span>&nbsp;<span class="ident" id="3334373"><a href="/net/http/cookie.go.html#3334365">i</a></span>&nbsp;<span class="op" id="3334375">&lt;</span>&nbsp;<span class="builtinfunc" id="3334377">len</span><span class="op" id="3334380">(</span><span class="ident" id="3334381"><a href="/net/http/cookie.go.html#3334095">v</a></span><span class="op" id="3334382">)</span><span class="op" id="3334383">;</span>&nbsp;<span class="ident" id="3334385"><a href="/net/http/cookie.go.html#3334365">i</a></span><span class="op" id="3334386">++</span>&nbsp;<span class="op" id="3334389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334393">if</span>&nbsp;<span class="ident" id="3334396">b</span>&nbsp;<span class="op" id="3334398">:=</span>&nbsp;<span class="ident" id="3334401"><a href="/net/http/cookie.go.html#3334095">v</a></span><span class="op" id="3334402">[</span><span class="ident" id="3334403"><a href="/net/http/cookie.go.html#3334365">i</a></span><span class="op" id="3334404">]</span><span class="op" id="3334405">;</span>&nbsp;<span class="ident" id="3334407"><a href="/net/http/cookie.go.html#3334072">valid</a></span><span class="op" id="3334412">(</span><span class="ident" id="3334413"><a href="/net/http/cookie.go.html#3334396">b</a></span><span class="op" id="3334414">)</span>&nbsp;<span class="op" id="3334416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334421"><a href="/net/http/cookie.go.html#3334329">buf</a></span>&nbsp;<span class="op" id="3334425">=</span>&nbsp;<span class="builtinfunc" id="3334427">append</span><span class="op" id="3334433">(</span><span class="ident" id="3334434"><a href="/net/http/cookie.go.html#3334329">buf</a></span><span class="op" id="3334437">,</span>&nbsp;<span class="ident" id="3334439"><a href="/net/http/cookie.go.html#3334396">b</a></span><span class="op" id="3334440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334447">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334450">return</span>&nbsp;<span class="builtintype" id="3334457">string</span><span class="op" id="3334463">(</span><span class="ident" id="3334464"><a href="/net/http/cookie.go.html#3334329">buf</a></span><span class="op" id="3334467">)</span><br>
<span class="lineno"></span><span class="op" id="3334469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3334472">func</span>&nbsp;<span class="ident" id="3334477">parseCookieValue</span><span class="op" id="3334493">(</span><span class="ident" id="3334494">raw</span>&nbsp;<span class="builtintype" id="3334498">string</span><span class="op" id="3334504">,</span>&nbsp;<span class="ident" id="3334506">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="3334523">bool</span><span class="op" id="3334527">)</span>&nbsp;<span class="op" id="3334529">(</span><span class="builtintype" id="3334530">string</span><span class="op" id="3334536">,</span>&nbsp;<span class="builtintype" id="3334538">bool</span><span class="op" id="3334542">)</span>&nbsp;<span class="op" id="3334544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3334547">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334581">if</span>&nbsp;<span class="ident" id="3334584"><a href="/net/http/cookie.go.html#3334506">allowDoubleQuote</a></span>&nbsp;<span class="op" id="3334601">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3334604">len</span><span class="op" id="3334607">(</span><span class="ident" id="3334608"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334611">)</span>&nbsp;<span class="op" id="3334613">&gt;</span>&nbsp;<span class="num" id="3334615">1</span>&nbsp;<span class="op" id="3334617">&amp;&amp;</span>&nbsp;<span class="ident" id="3334620"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334623">[</span><span class="num" id="3334624">0</span><span class="op" id="3334625">]</span>&nbsp;<span class="op" id="3334627">==</span>&nbsp;<span class="string" id="3334630">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3334634">&amp;&amp;</span>&nbsp;<span class="ident" id="3334637"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334640">[</span><span class="builtinfunc" id="3334641">len</span><span class="op" id="3334644">(</span><span class="ident" id="3334645"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334648">)</span><span class="op" id="3334649">-</span><span class="num" id="3334650">1</span><span class="op" id="3334651">]</span>&nbsp;<span class="op" id="3334653">==</span>&nbsp;<span class="string" id="3334656">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3334660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334664"><a href="/net/http/cookie.go.html#3334494">raw</a></span>&nbsp;<span class="op" id="3334668">=</span>&nbsp;<span class="ident" id="3334670"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334673">[</span><span class="num" id="3334674">1</span>&nbsp;<span class="op" id="3334676">:</span>&nbsp;<span class="builtinfunc" id="3334678">len</span><span class="op" id="3334681">(</span><span class="ident" id="3334682"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334685">)</span><span class="op" id="3334686">-</span><span class="num" id="3334687">1</span><span class="op" id="3334688">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334694">for</span>&nbsp;<span class="ident" id="3334698">i</span>&nbsp;<span class="op" id="3334700">:=</span>&nbsp;<span class="num" id="3334703">0</span><span class="op" id="3334704">;</span>&nbsp;<span class="ident" id="3334706"><a href="/net/http/cookie.go.html#3334698">i</a></span>&nbsp;<span class="op" id="3334708">&lt;</span>&nbsp;<span class="builtinfunc" id="3334710">len</span><span class="op" id="3334713">(</span><span class="ident" id="3334714"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334717">)</span><span class="op" id="3334718">;</span>&nbsp;<span class="ident" id="3334720"><a href="/net/http/cookie.go.html#3334698">i</a></span><span class="op" id="3334721">++</span>&nbsp;<span class="op" id="3334724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334728">if</span>&nbsp;<span class="op" id="3334731">!</span><span class="ident" id="3334732"><a href="/net/http/cookie.go.html#3333640">validCookieValueByte</a></span><span class="op" id="3334752">(</span><span class="ident" id="3334753"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334756">[</span><span class="ident" id="3334757"><a href="/net/http/cookie.go.html#3334698">i</a></span><span class="op" id="3334758">]</span><span class="op" id="3334759">)</span>&nbsp;<span class="op" id="3334761">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334766">return</span>&nbsp;<span class="string" id="3334773">&#34;&#34;</span><span class="op" id="3334775">,</span>&nbsp;<span class="builtintype" id="3334777">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334791">return</span>&nbsp;<span class="ident" id="3334798"><a href="/net/http/cookie.go.html#3334494">raw</a></span><span class="op" id="3334801">,</span>&nbsp;<span class="builtintype" id="3334803">true</span><br>
<span class="lineno"></span><span class="op" id="3334808">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="3334811">func</span>&nbsp;<span class="ident" id="3334816">isCookieNameValid</span><span class="op" id="3334833">(</span><span class="ident" id="3334834">raw</span>&nbsp;<span class="builtintype" id="3334838">string</span><span class="op" id="3334844">)</span>&nbsp;<span class="builtintype" id="3334846">bool</span>&nbsp;<span class="op" id="3334851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334854">return</span>&nbsp;<span class="ident" id="3334861"><a href="/net/http/cookie.go.html#3326269">strings</a></span><span class="op" id="3334868">.</span><span class="ident" id="3334869">IndexFunc</span><span class="op" id="3334878">(</span><span class="ident" id="3334879"><a href="/net/http/cookie.go.html#3334834">raw</a></span><span class="op" id="3334882">,</span>&nbsp;<span class="ident" id="3334884"><a href="/net/http/lex.go.html#3364281">isNotToken</a></span><span class="op" id="3334894">)</span>&nbsp;<span class="op" id="3334896">&lt;</span>&nbsp;<span class="num" id="3334898">0</span><br>
<span class="lineno"></span><span class="op" id="3334900">}</span>
</div>
</body>
</html>
