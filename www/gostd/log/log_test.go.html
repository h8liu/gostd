<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8129432">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8129487">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8129541">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8129592">package</span>&nbsp;<span class="ident" id="8129600">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8129605">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8129637">import</span>&nbsp;<span class="op" id="8129644">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129647">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129656">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129662">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8129672">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8129682">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8129685">const</span>&nbsp;<span class="op" id="8129691">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129694">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129708">=</span>&nbsp;<span class="string" id="8129710">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129756">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129770">=</span>&nbsp;<span class="string" id="8129772">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129808">Rmicroseconds</span>&nbsp;<span class="op" id="8129822">=</span>&nbsp;<span class="string" id="8129824">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129860">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129874">=</span>&nbsp;<span class="string" id="8129876">`(54|56):`</span>&nbsp;<span class="comment" id="8129887">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8129949">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8129963">=</span>&nbsp;<span class="string" id="8129965">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="8129991">+</span>&nbsp;<span class="ident" id="8129993">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130000">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8130014">=</span>&nbsp;<span class="string" id="8130016">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="8130039">+</span>&nbsp;<span class="ident" id="8130041">Rline</span><br>
<span class="lineno"></span><span class="op" id="8130047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8130050">type</span>&nbsp;<span class="ident" id="8130055">tester</span>&nbsp;<span class="keyword" id="8130062">struct</span>&nbsp;<span class="op" id="8130069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130072">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8130080">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130085">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="8130093">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8130101">pattern</span>&nbsp;<span class="builtintype" id="8130109">string</span>&nbsp;<span class="comment" id="8130116">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="8130189">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="8130192">var</span>&nbsp;<span class="ident" id="8130196">tests</span>&nbsp;<span class="op" id="8130202">=</span>&nbsp;<span class="op" id="8130204">[</span><span class="op" id="8130205">]</span><span class="ident" id="8130206">tester</span><span class="op" id="8130212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130215">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130238">{</span><span class="num" id="8130239">0</span><span class="op" id="8130240">,</span>&nbsp;<span class="string" id="8130242">&#34;&#34;</span><span class="op" id="8130244">,</span>&nbsp;<span class="string" id="8130246">&#34;&#34;</span><span class="op" id="8130248">}</span><span class="op" id="8130249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130252">{</span><span class="num" id="8130253">0</span><span class="op" id="8130254">,</span>&nbsp;<span class="string" id="8130256">&#34;XXX&#34;</span><span class="op" id="8130261">,</span>&nbsp;<span class="string" id="8130263">&#34;XXX&#34;</span><span class="op" id="8130268">}</span><span class="op" id="8130269">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130272">{</span><span class="ident" id="8130273">Ldate</span><span class="op" id="8130278">,</span>&nbsp;<span class="string" id="8130280">&#34;&#34;</span><span class="op" id="8130282">,</span>&nbsp;<span class="ident" id="8130284">Rdate</span>&nbsp;<span class="op" id="8130290">+</span>&nbsp;<span class="string" id="8130292">&#34;&nbsp;&#34;</span><span class="op" id="8130295">}</span><span class="op" id="8130296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130299">{</span><span class="ident" id="8130300">Ltime</span><span class="op" id="8130305">,</span>&nbsp;<span class="string" id="8130307">&#34;&#34;</span><span class="op" id="8130309">,</span>&nbsp;<span class="ident" id="8130311">Rtime</span>&nbsp;<span class="op" id="8130317">+</span>&nbsp;<span class="string" id="8130319">&#34;&nbsp;&#34;</span><span class="op" id="8130322">}</span><span class="op" id="8130323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130326">{</span><span class="ident" id="8130327">Ltime</span>&nbsp;<span class="op" id="8130333">|</span>&nbsp;<span class="ident" id="8130335">Lmicroseconds</span><span class="op" id="8130348">,</span>&nbsp;<span class="string" id="8130350">&#34;&#34;</span><span class="op" id="8130352">,</span>&nbsp;<span class="ident" id="8130354">Rtime</span>&nbsp;<span class="op" id="8130360">+</span>&nbsp;<span class="ident" id="8130362">Rmicroseconds</span>&nbsp;<span class="op" id="8130376">+</span>&nbsp;<span class="string" id="8130378">&#34;&nbsp;&#34;</span><span class="op" id="8130381">}</span><span class="op" id="8130382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130385">{</span><span class="ident" id="8130386">Lmicroseconds</span><span class="op" id="8130399">,</span>&nbsp;<span class="string" id="8130401">&#34;&#34;</span><span class="op" id="8130403">,</span>&nbsp;<span class="ident" id="8130405">Rtime</span>&nbsp;<span class="op" id="8130411">+</span>&nbsp;<span class="ident" id="8130413">Rmicroseconds</span>&nbsp;<span class="op" id="8130427">+</span>&nbsp;<span class="string" id="8130429">&#34;&nbsp;&#34;</span><span class="op" id="8130432">}</span><span class="op" id="8130433">,</span>&nbsp;<span class="comment" id="8130435">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130461">{</span><span class="ident" id="8130462">Llongfile</span><span class="op" id="8130471">,</span>&nbsp;<span class="string" id="8130473">&#34;&#34;</span><span class="op" id="8130475">,</span>&nbsp;<span class="ident" id="8130477">Rlongfile</span>&nbsp;<span class="op" id="8130487">+</span>&nbsp;<span class="string" id="8130489">&#34;&nbsp;&#34;</span><span class="op" id="8130492">}</span><span class="op" id="8130493">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130496">{</span><span class="ident" id="8130497">Lshortfile</span><span class="op" id="8130507">,</span>&nbsp;<span class="string" id="8130509">&#34;&#34;</span><span class="op" id="8130511">,</span>&nbsp;<span class="ident" id="8130513">Rshortfile</span>&nbsp;<span class="op" id="8130524">+</span>&nbsp;<span class="string" id="8130526">&#34;&nbsp;&#34;</span><span class="op" id="8130529">}</span><span class="op" id="8130530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130533">{</span><span class="ident" id="8130534">Llongfile</span>&nbsp;<span class="op" id="8130544">|</span>&nbsp;<span class="ident" id="8130546">Lshortfile</span><span class="op" id="8130556">,</span>&nbsp;<span class="string" id="8130558">&#34;&#34;</span><span class="op" id="8130560">,</span>&nbsp;<span class="ident" id="8130562">Rshortfile</span>&nbsp;<span class="op" id="8130573">+</span>&nbsp;<span class="string" id="8130575">&#34;&nbsp;&#34;</span><span class="op" id="8130578">}</span><span class="op" id="8130579">,</span>&nbsp;<span class="comment" id="8130581">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8130614">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130638">{</span><span class="ident" id="8130639">Ldate</span>&nbsp;<span class="op" id="8130645">|</span>&nbsp;<span class="ident" id="8130647">Ltime</span>&nbsp;<span class="op" id="8130653">|</span>&nbsp;<span class="ident" id="8130655">Lmicroseconds</span>&nbsp;<span class="op" id="8130669">|</span>&nbsp;<span class="ident" id="8130671">Llongfile</span><span class="op" id="8130680">,</span>&nbsp;<span class="string" id="8130682">&#34;XXX&#34;</span><span class="op" id="8130687">,</span>&nbsp;<span class="string" id="8130689">&#34;XXX&#34;</span>&nbsp;<span class="op" id="8130695">+</span>&nbsp;<span class="ident" id="8130697">Rdate</span>&nbsp;<span class="op" id="8130703">+</span>&nbsp;<span class="string" id="8130705">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="8130709">+</span>&nbsp;<span class="ident" id="8130711">Rtime</span>&nbsp;<span class="op" id="8130717">+</span>&nbsp;<span class="ident" id="8130719">Rmicroseconds</span>&nbsp;<span class="op" id="8130733">+</span>&nbsp;<span class="string" id="8130735">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="8130739">+</span>&nbsp;<span class="ident" id="8130741">Rlongfile</span>&nbsp;<span class="op" id="8130751">+</span>&nbsp;<span class="string" id="8130753">&#34;&nbsp;&#34;</span><span class="op" id="8130756">}</span><span class="op" id="8130757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8130760">{</span><span class="ident" id="8130761">Ldate</span>&nbsp;<span class="op" id="8130767">|</span>&nbsp;<span class="ident" id="8130769">Ltime</span>&nbsp;<span class="op" id="8130775">|</span>&nbsp;<span class="ident" id="8130777">Lmicroseconds</span>&nbsp;<span class="op" id="8130791">|</span>&nbsp;<span class="ident" id="8130793">Lshortfile</span><span class="op" id="8130803">,</span>&nbsp;<span class="string" id="8130805">&#34;XXX&#34;</span><span class="op" id="8130810">,</span>&nbsp;<span class="string" id="8130812">&#34;XXX&#34;</span>&nbsp;<span class="op" id="8130818">+</span>&nbsp;<span class="ident" id="8130820">Rdate</span>&nbsp;<span class="op" id="8130826">+</span>&nbsp;<span class="string" id="8130828">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="8130832">+</span>&nbsp;<span class="ident" id="8130834">Rtime</span>&nbsp;<span class="op" id="8130840">+</span>&nbsp;<span class="ident" id="8130842">Rmicroseconds</span>&nbsp;<span class="op" id="8130856">+</span>&nbsp;<span class="string" id="8130858">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="8130862">+</span>&nbsp;<span class="ident" id="8130864">Rshortfile</span>&nbsp;<span class="op" id="8130875">+</span>&nbsp;<span class="string" id="8130877">&#34;&nbsp;&#34;</span><span class="op" id="8130880">}</span><span class="op" id="8130881">,</span><br>
<span class="lineno">45</span><span class="op" id="8130883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8130886">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="8130968">func</span>&nbsp;<span class="ident" id="8130973">testPrint</span><span class="op" id="8130982">(</span><span class="ident" id="8130983">t</span>&nbsp;<span class="op" id="8130985">*</span><span class="ident" id="8130986">testing</span><span class="op" id="8130993">.</span><span class="ident" id="8130994">T</span><span class="op" id="8130995">,</span>&nbsp;<span class="ident" id="8130997">flag</span>&nbsp;<span class="builtintype" id="8131002">int</span><span class="op" id="8131005">,</span>&nbsp;<span class="ident" id="8131007">prefix</span>&nbsp;<span class="builtintype" id="8131014">string</span><span class="op" id="8131020">,</span>&nbsp;<span class="ident" id="8131022">pattern</span>&nbsp;<span class="builtintype" id="8131030">string</span><span class="op" id="8131036">,</span>&nbsp;<span class="ident" id="8131038">useFormat</span>&nbsp;<span class="builtintype" id="8131048">bool</span><span class="op" id="8131052">)</span>&nbsp;<span class="op" id="8131054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131057">buf</span>&nbsp;<span class="op" id="8131061">:=</span>&nbsp;<span class="builtinfunc" id="8131064">new</span><span class="op" id="8131067">(</span><span class="ident" id="8131068">bytes</span><span class="op" id="8131073">.</span><span class="ident" id="8131074">Buffer</span><span class="op" id="8131080">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131083">SetOutput</span><span class="op" id="8131092">(</span><span class="ident" id="8131093">buf</span><span class="op" id="8131096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131099">SetFlags</span><span class="op" id="8131107">(</span><span class="ident" id="8131108">flag</span><span class="op" id="8131112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131115">SetPrefix</span><span class="op" id="8131124">(</span><span class="ident" id="8131125">prefix</span><span class="op" id="8131131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131134">if</span>&nbsp;<span class="ident" id="8131137">useFormat</span>&nbsp;<span class="op" id="8131147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131151">Printf</span><span class="op" id="8131157">(</span><span class="string" id="8131158">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="8131174">,</span>&nbsp;<span class="num" id="8131176">23</span><span class="op" id="8131178">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131181">}</span>&nbsp;<span class="keyword" id="8131183">else</span>&nbsp;<span class="op" id="8131188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131192">Println</span><span class="op" id="8131199">(</span><span class="string" id="8131200">&#34;hello&#34;</span><span class="op" id="8131207">,</span>&nbsp;<span class="num" id="8131209">23</span><span class="op" id="8131211">,</span>&nbsp;<span class="string" id="8131213">&#34;world&#34;</span><span class="op" id="8131220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131226">line</span>&nbsp;<span class="op" id="8131231">:=</span>&nbsp;<span class="ident" id="8131234">buf</span><span class="op" id="8131237">.</span><span class="ident" id="8131238">String</span><span class="op" id="8131244">(</span><span class="op" id="8131245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131248">line</span>&nbsp;<span class="op" id="8131253">=</span>&nbsp;<span class="ident" id="8131255">line</span><span class="op" id="8131259">[</span><span class="num" id="8131260">0</span>&nbsp;<span class="op" id="8131262">:</span>&nbsp;<span class="builtinfunc" id="8131264">len</span><span class="op" id="8131267">(</span><span class="ident" id="8131268">line</span><span class="op" id="8131272">)</span><span class="op" id="8131273">-</span><span class="num" id="8131274">1</span><span class="op" id="8131275">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131278">pattern</span>&nbsp;<span class="op" id="8131286">=</span>&nbsp;<span class="string" id="8131288">&#34;^&#34;</span>&nbsp;<span class="op" id="8131292">+</span>&nbsp;<span class="ident" id="8131294">pattern</span>&nbsp;<span class="op" id="8131302">+</span>&nbsp;<span class="string" id="8131304">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131323">matched</span><span class="op" id="8131330">,</span>&nbsp;<span class="ident" id="8131332">err4</span>&nbsp;<span class="op" id="8131337">:=</span>&nbsp;<span class="ident" id="8131340">regexp</span><span class="op" id="8131346">.</span><span class="ident" id="8131347">MatchString</span><span class="op" id="8131358">(</span><span class="ident" id="8131359">pattern</span><span class="op" id="8131366">,</span>&nbsp;<span class="ident" id="8131368">line</span><span class="op" id="8131372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131375">if</span>&nbsp;<span class="ident" id="8131378">err4</span>&nbsp;<span class="op" id="8131383">!=</span>&nbsp;<span class="ident" id="8131386">nil</span>&nbsp;<span class="op" id="8131390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131394">t</span><span class="op" id="8131395">.</span><span class="ident" id="8131396">Fatal</span><span class="op" id="8131401">(</span><span class="string" id="8131402">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="8131428">,</span>&nbsp;<span class="ident" id="8131430">err4</span><span class="op" id="8131434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131437">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131440">if</span>&nbsp;<span class="op" id="8131443">!</span><span class="ident" id="8131444">matched</span>&nbsp;<span class="op" id="8131452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131456">t</span><span class="op" id="8131457">.</span><span class="ident" id="8131458">Errorf</span><span class="op" id="8131464">(</span><span class="string" id="8131465">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="8131499">,</span>&nbsp;<span class="ident" id="8131501">pattern</span><span class="op" id="8131508">,</span>&nbsp;<span class="ident" id="8131510">line</span><span class="op" id="8131514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131520">SetOutput</span><span class="op" id="8131529">(</span><span class="ident" id="8131530">os</span><span class="op" id="8131532">.</span><span class="ident" id="8131533">Stderr</span><span class="op" id="8131539">)</span><br>
<span class="lineno"></span><span class="op" id="8131541">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="8131544">func</span>&nbsp;<span class="ident" id="8131549">TestAll</span><span class="op" id="8131556">(</span><span class="ident" id="8131557">t</span>&nbsp;<span class="op" id="8131559">*</span><span class="ident" id="8131560">testing</span><span class="op" id="8131567">.</span><span class="ident" id="8131568">T</span><span class="op" id="8131569">)</span>&nbsp;<span class="op" id="8131571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131574">for</span>&nbsp;<span class="ident" id="8131578">_</span><span class="op" id="8131579">,</span>&nbsp;<span class="ident" id="8131581">testcase</span>&nbsp;<span class="op" id="8131590">:=</span>&nbsp;<span class="keyword" id="8131593">range</span>&nbsp;<span class="ident" id="8131599">tests</span>&nbsp;<span class="op" id="8131605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131609">testPrint</span><span class="op" id="8131618">(</span><span class="ident" id="8131619">t</span><span class="op" id="8131620">,</span>&nbsp;<span class="ident" id="8131622">testcase</span><span class="op" id="8131630">.</span><span class="ident" id="8131631">flag</span><span class="op" id="8131635">,</span>&nbsp;<span class="ident" id="8131637">testcase</span><span class="op" id="8131645">.</span><span class="ident" id="8131646">prefix</span><span class="op" id="8131652">,</span>&nbsp;<span class="ident" id="8131654">testcase</span><span class="op" id="8131662">.</span><span class="ident" id="8131663">pattern</span><span class="op" id="8131670">,</span>&nbsp;<span class="builtintype" id="8131672">false</span><span class="op" id="8131677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131681">testPrint</span><span class="op" id="8131690">(</span><span class="ident" id="8131691">t</span><span class="op" id="8131692">,</span>&nbsp;<span class="ident" id="8131694">testcase</span><span class="op" id="8131702">.</span><span class="ident" id="8131703">flag</span><span class="op" id="8131707">,</span>&nbsp;<span class="ident" id="8131709">testcase</span><span class="op" id="8131717">.</span><span class="ident" id="8131718">prefix</span><span class="op" id="8131724">,</span>&nbsp;<span class="ident" id="8131726">testcase</span><span class="op" id="8131734">.</span><span class="ident" id="8131735">pattern</span><span class="op" id="8131742">,</span>&nbsp;<span class="builtintype" id="8131744">true</span><span class="op" id="8131748">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8131751">}</span><br>
<span class="lineno"></span><span class="op" id="8131753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8131756">func</span>&nbsp;<span class="ident" id="8131761">TestOutput</span><span class="op" id="8131771">(</span><span class="ident" id="8131772">t</span>&nbsp;<span class="op" id="8131774">*</span><span class="ident" id="8131775">testing</span><span class="op" id="8131782">.</span><span class="ident" id="8131783">T</span><span class="op" id="8131784">)</span>&nbsp;<span class="op" id="8131786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131789">const</span>&nbsp;<span class="ident" id="8131795">testString</span>&nbsp;<span class="op" id="8131806">=</span>&nbsp;<span class="string" id="8131808">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131816">var</span>&nbsp;<span class="ident" id="8131820">b</span>&nbsp;<span class="ident" id="8131822">bytes</span><span class="op" id="8131827">.</span><span class="ident" id="8131828">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131836">l</span>&nbsp;<span class="op" id="8131838">:=</span>&nbsp;<span class="ident" id="8131841">New</span><span class="op" id="8131844">(</span><span class="op" id="8131845">&amp;</span><span class="ident" id="8131846">b</span><span class="op" id="8131847">,</span>&nbsp;<span class="string" id="8131849">&#34;&#34;</span><span class="op" id="8131851">,</span>&nbsp;<span class="num" id="8131853">0</span><span class="op" id="8131854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131857">l</span><span class="op" id="8131858">.</span><span class="ident" id="8131859">Println</span><span class="op" id="8131866">(</span><span class="ident" id="8131867">testString</span><span class="op" id="8131877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8131880">if</span>&nbsp;<span class="ident" id="8131883">expect</span>&nbsp;<span class="op" id="8131890">:=</span>&nbsp;<span class="ident" id="8131893">testString</span>&nbsp;<span class="op" id="8131904">+</span>&nbsp;<span class="string" id="8131906">&#34;\n&#34;</span><span class="op" id="8131910">;</span>&nbsp;<span class="ident" id="8131912">b</span><span class="op" id="8131913">.</span><span class="ident" id="8131914">String</span><span class="op" id="8131920">(</span><span class="op" id="8131921">)</span>&nbsp;<span class="op" id="8131923">!=</span>&nbsp;<span class="ident" id="8131926">expect</span>&nbsp;<span class="op" id="8131933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8131937">t</span><span class="op" id="8131938">.</span><span class="ident" id="8131939">Errorf</span><span class="op" id="8131945">(</span><span class="string" id="8131946">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="8131980">,</span>&nbsp;<span class="ident" id="8131982">expect</span><span class="op" id="8131988">,</span>&nbsp;<span class="ident" id="8131990">b</span><span class="op" id="8131991">.</span><span class="ident" id="8131992">String</span><span class="op" id="8131998">(</span><span class="op" id="8131999">)</span><span class="op" id="8132000">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132003">}</span><br>
<span class="lineno"></span><span class="op" id="8132005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8132008">func</span>&nbsp;<span class="ident" id="8132013">TestFlagAndPrefixSetting</span><span class="op" id="8132037">(</span><span class="ident" id="8132038">t</span>&nbsp;<span class="op" id="8132040">*</span><span class="ident" id="8132041">testing</span><span class="op" id="8132048">.</span><span class="ident" id="8132049">T</span><span class="op" id="8132050">)</span>&nbsp;<span class="op" id="8132052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132055">var</span>&nbsp;<span class="ident" id="8132059">b</span>&nbsp;<span class="ident" id="8132061">bytes</span><span class="op" id="8132066">.</span><span class="ident" id="8132067">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132075">l</span>&nbsp;<span class="op" id="8132077">:=</span>&nbsp;<span class="ident" id="8132080">New</span><span class="op" id="8132083">(</span><span class="op" id="8132084">&amp;</span><span class="ident" id="8132085">b</span><span class="op" id="8132086">,</span>&nbsp;<span class="string" id="8132088">&#34;Test:&#34;</span><span class="op" id="8132095">,</span>&nbsp;<span class="ident" id="8132097">LstdFlags</span><span class="op" id="8132106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132109">f</span>&nbsp;<span class="op" id="8132111">:=</span>&nbsp;<span class="ident" id="8132114">l</span><span class="op" id="8132115">.</span><span class="ident" id="8132116">Flags</span><span class="op" id="8132121">(</span><span class="op" id="8132122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132125">if</span>&nbsp;<span class="ident" id="8132128">f</span>&nbsp;<span class="op" id="8132130">!=</span>&nbsp;<span class="ident" id="8132133">LstdFlags</span>&nbsp;<span class="op" id="8132143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132147">t</span><span class="op" id="8132148">.</span><span class="ident" id="8132149">Errorf</span><span class="op" id="8132155">(</span><span class="string" id="8132156">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="8132185">,</span>&nbsp;<span class="ident" id="8132187">LstdFlags</span><span class="op" id="8132196">,</span>&nbsp;<span class="ident" id="8132198">f</span><span class="op" id="8132199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132202">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132205">l</span><span class="op" id="8132206">.</span><span class="ident" id="8132207">SetFlags</span><span class="op" id="8132215">(</span><span class="ident" id="8132216">f</span>&nbsp;<span class="op" id="8132218">|</span>&nbsp;<span class="ident" id="8132220">Lmicroseconds</span><span class="op" id="8132233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132236">f</span>&nbsp;<span class="op" id="8132238">=</span>&nbsp;<span class="ident" id="8132240">l</span><span class="op" id="8132241">.</span><span class="ident" id="8132242">Flags</span><span class="op" id="8132247">(</span><span class="op" id="8132248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132251">if</span>&nbsp;<span class="ident" id="8132254">f</span>&nbsp;<span class="op" id="8132256">!=</span>&nbsp;<span class="ident" id="8132259">LstdFlags</span><span class="op" id="8132268">|</span><span class="ident" id="8132269">Lmicroseconds</span>&nbsp;<span class="op" id="8132283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132287">t</span><span class="op" id="8132288">.</span><span class="ident" id="8132289">Errorf</span><span class="op" id="8132295">(</span><span class="string" id="8132296">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="8132325">,</span>&nbsp;<span class="ident" id="8132327">LstdFlags</span><span class="op" id="8132336">|</span><span class="ident" id="8132337">Lmicroseconds</span><span class="op" id="8132350">,</span>&nbsp;<span class="ident" id="8132352">f</span><span class="op" id="8132353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132356">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132359">p</span>&nbsp;<span class="op" id="8132361">:=</span>&nbsp;<span class="ident" id="8132364">l</span><span class="op" id="8132365">.</span><span class="ident" id="8132366">Prefix</span><span class="op" id="8132372">(</span><span class="op" id="8132373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132376">if</span>&nbsp;<span class="ident" id="8132379">p</span>&nbsp;<span class="op" id="8132381">!=</span>&nbsp;<span class="string" id="8132384">&#34;Test:&#34;</span>&nbsp;<span class="op" id="8132392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132396">t</span><span class="op" id="8132397">.</span><span class="ident" id="8132398">Errorf</span><span class="op" id="8132404">(</span><span class="string" id="8132405">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="8132438">,</span>&nbsp;<span class="ident" id="8132440">p</span><span class="op" id="8132441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132447">l</span><span class="op" id="8132448">.</span><span class="ident" id="8132449">SetPrefix</span><span class="op" id="8132458">(</span><span class="string" id="8132459">&#34;Reality:&#34;</span><span class="op" id="8132469">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132472">p</span>&nbsp;<span class="op" id="8132474">=</span>&nbsp;<span class="ident" id="8132476">l</span><span class="op" id="8132477">.</span><span class="ident" id="8132478">Prefix</span><span class="op" id="8132484">(</span><span class="op" id="8132485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132488">if</span>&nbsp;<span class="ident" id="8132491">p</span>&nbsp;<span class="op" id="8132493">!=</span>&nbsp;<span class="string" id="8132496">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="8132507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132511">t</span><span class="op" id="8132512">.</span><span class="ident" id="8132513">Errorf</span><span class="op" id="8132519">(</span><span class="string" id="8132520">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="8132556">,</span>&nbsp;<span class="ident" id="8132558">p</span><span class="op" id="8132559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8132565">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132645">l</span><span class="op" id="8132646">.</span><span class="ident" id="8132647">Print</span><span class="op" id="8132652">(</span><span class="string" id="8132653">&#34;hello&#34;</span><span class="op" id="8132660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132663">pattern</span>&nbsp;<span class="op" id="8132671">:=</span>&nbsp;<span class="string" id="8132674">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="8132686">+</span>&nbsp;<span class="ident" id="8132688">Rdate</span>&nbsp;<span class="op" id="8132694">+</span>&nbsp;<span class="string" id="8132696">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="8132700">+</span>&nbsp;<span class="ident" id="8132702">Rtime</span>&nbsp;<span class="op" id="8132708">+</span>&nbsp;<span class="ident" id="8132710">Rmicroseconds</span>&nbsp;<span class="op" id="8132724">+</span>&nbsp;<span class="string" id="8132726">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132738">matched</span><span class="op" id="8132745">,</span>&nbsp;<span class="ident" id="8132747">err</span>&nbsp;<span class="op" id="8132751">:=</span>&nbsp;<span class="ident" id="8132754">regexp</span><span class="op" id="8132760">.</span><span class="ident" id="8132761">Match</span><span class="op" id="8132766">(</span><span class="ident" id="8132767">pattern</span><span class="op" id="8132774">,</span>&nbsp;<span class="ident" id="8132776">b</span><span class="op" id="8132777">.</span><span class="ident" id="8132778">Bytes</span><span class="op" id="8132783">(</span><span class="op" id="8132784">)</span><span class="op" id="8132785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132788">if</span>&nbsp;<span class="ident" id="8132791">err</span>&nbsp;<span class="op" id="8132795">!=</span>&nbsp;<span class="ident" id="8132798">nil</span>&nbsp;<span class="op" id="8132802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132806">t</span><span class="op" id="8132807">.</span><span class="ident" id="8132808">Fatalf</span><span class="op" id="8132814">(</span><span class="string" id="8132815">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="8132847">,</span>&nbsp;<span class="ident" id="8132849">pattern</span><span class="op" id="8132856">,</span>&nbsp;<span class="ident" id="8132858">err</span><span class="op" id="8132861">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8132867">if</span>&nbsp;<span class="op" id="8132870">!</span><span class="ident" id="8132871">matched</span>&nbsp;<span class="op" id="8132879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8132883">t</span><span class="op" id="8132884">.</span><span class="ident" id="8132885">Error</span><span class="op" id="8132890">(</span><span class="string" id="8132891">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="8132922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8132925">}</span><br>
<span class="lineno"></span><span class="op" id="8132927">}</span>
</div>
</body>
</html>
