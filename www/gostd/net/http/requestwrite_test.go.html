<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html" class="current">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7717394">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7717450">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7717504">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7717555">package</span>&nbsp;<span class="ident" id="7717563">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7717569">import</span>&nbsp;<span class="op" id="7717576">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717579">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717588">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717598">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717605">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717611">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717624">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717635">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7717646">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7717656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7717659">type</span>&nbsp;<span class="ident" id="7717664">reqWriteTest</span>&nbsp;<span class="keyword" id="7717677">struct</span>&nbsp;<span class="op" id="7717684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7717687">Req</span>&nbsp;&nbsp;<span class="ident" id="7717692">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7717701">Body</span>&nbsp;<span class="keyword" id="7717706">interface</span><span class="op" id="7717715">{</span><span class="op" id="7717716">}</span>&nbsp;<span class="comment" id="7717718">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7717784">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7717839">WantWrite</span>&nbsp;<span class="builtintype" id="7717849">string</span>&nbsp;<span class="comment" id="7717856">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7717874">WantProxy</span>&nbsp;<span class="builtintype" id="7717884">string</span>&nbsp;<span class="comment" id="7717891">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7717915">WantError</span>&nbsp;<span class="builtintype" id="7717925">error</span>&nbsp;<span class="comment" id="7717931">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="7717966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7717969">var</span>&nbsp;<span class="ident" id="7717973">reqWriteTests</span>&nbsp;<span class="op" id="7717987">=</span>&nbsp;<span class="op" id="7717989">[</span><span class="op" id="7717990">]</span><span class="ident" id="7717991">reqWriteTest</span><span class="op" id="7718003">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7718006">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718062">Req</span><span class="op" id="7718065">:</span>&nbsp;<span class="ident" id="7718067">Request</span><span class="op" id="7718074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718079">Method</span><span class="op" id="7718085">:</span>&nbsp;<span class="string" id="7718087">&#34;GET&#34;</span><span class="op" id="7718092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718097">URL</span><span class="op" id="7718100">:</span>&nbsp;<span class="op" id="7718102">&amp;</span><span class="ident" id="7718103">url</span><span class="op" id="7718106">.</span><span class="ident" id="7718107">URL</span><span class="op" id="7718110">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718116">Scheme</span><span class="op" id="7718122">:</span>&nbsp;<span class="string" id="7718124">&#34;http&#34;</span><span class="op" id="7718130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718136">Host</span><span class="op" id="7718140">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7718144">&#34;www.techcrunch.com&#34;</span><span class="op" id="7718164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718170">Path</span><span class="op" id="7718174">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7718178">&#34;/&#34;</span><span class="op" id="7718181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718186">}</span><span class="op" id="7718187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718192">Proto</span><span class="op" id="7718197">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718204">&#34;HTTP/1.1&#34;</span><span class="op" id="7718214">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718219">ProtoMajor</span><span class="op" id="7718229">:</span>&nbsp;<span class="num" id="7718231">1</span><span class="op" id="7718232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718237">ProtoMinor</span><span class="op" id="7718247">:</span>&nbsp;<span class="num" id="7718249">1</span><span class="op" id="7718250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718255">Header</span><span class="op" id="7718261">:</span>&nbsp;<span class="ident" id="7718263">Header</span><span class="op" id="7718269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718275">&#34;Accept&#34;</span><span class="op" id="7718283">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718295">{</span><span class="string" id="7718296">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="7718361">}</span><span class="op" id="7718362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718368">&#34;Accept-Charset&#34;</span><span class="op" id="7718384">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7718388">{</span><span class="string" id="7718389">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="7718421">}</span><span class="op" id="7718422">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718428">&#34;Accept-Encoding&#34;</span><span class="op" id="7718445">:</span>&nbsp;&nbsp;<span class="op" id="7718448">{</span><span class="string" id="7718449">&#34;gzip,deflate&#34;</span><span class="op" id="7718463">}</span><span class="op" id="7718464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718470">&#34;Accept-Language&#34;</span><span class="op" id="7718487">:</span>&nbsp;&nbsp;<span class="op" id="7718490">{</span><span class="string" id="7718491">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="7718507">}</span><span class="op" id="7718508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718514">&#34;Keep-Alive&#34;</span><span class="op" id="7718526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718534">{</span><span class="string" id="7718535">&#34;300&#34;</span><span class="op" id="7718540">}</span><span class="op" id="7718541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718547">&#34;Proxy-Connection&#34;</span><span class="op" id="7718565">:</span>&nbsp;<span class="op" id="7718567">{</span><span class="string" id="7718568">&#34;keep-alive&#34;</span><span class="op" id="7718580">}</span><span class="op" id="7718581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718587">&#34;User-Agent&#34;</span><span class="op" id="7718599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718607">{</span><span class="string" id="7718608">&#34;Fake&#34;</span><span class="op" id="7718614">}</span><span class="op" id="7718615">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718620">}</span><span class="op" id="7718621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718626">Body</span><span class="op" id="7718630">:</span>&nbsp;&nbsp;<span class="builtintype" id="7718633">nil</span><span class="op" id="7718636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718641">Close</span><span class="op" id="7718646">:</span>&nbsp;<span class="builtintype" id="7718648">false</span><span class="op" id="7718653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718658">Host</span><span class="op" id="7718662">:</span>&nbsp;&nbsp;<span class="string" id="7718665">&#34;www.techcrunch.com&#34;</span><span class="op" id="7718685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718690">Form</span><span class="op" id="7718694">:</span>&nbsp;&nbsp;<span class="keyword" id="7718697">map</span><span class="op" id="7718700">[</span><span class="builtintype" id="7718701">string</span><span class="op" id="7718707">]</span><span class="op" id="7718708">[</span><span class="op" id="7718709">]</span><span class="builtintype" id="7718710">string</span><span class="op" id="7718716">{</span><span class="op" id="7718717">}</span><span class="op" id="7718718">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7718722">}</span><span class="op" id="7718723">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7718728">WantWrite</span><span class="op" id="7718737">:</span>&nbsp;<span class="string" id="7718739">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7718760">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718765">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7718796">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718801">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7718824">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718829">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7718907">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718912">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7718965">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7718970">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7719006">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719011">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7719049">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719054">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7719076">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719081">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7719119">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719124">WantProxy</span><span class="op" id="7719133">:</span>&nbsp;<span class="string" id="7719135">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7719181">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719186">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7719217">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719222">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7719245">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719250">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7719328">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719333">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7719386">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719391">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7719427">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719432">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7719470">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719475">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7719497">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719502">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7719540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7719543">}</span><span class="op" id="7719544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7719547">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7719599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719603">Req</span><span class="op" id="7719606">:</span>&nbsp;<span class="ident" id="7719608">Request</span><span class="op" id="7719615">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719620">Method</span><span class="op" id="7719626">:</span>&nbsp;<span class="string" id="7719628">&#34;GET&#34;</span><span class="op" id="7719633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719638">URL</span><span class="op" id="7719641">:</span>&nbsp;<span class="op" id="7719643">&amp;</span><span class="ident" id="7719644">url</span><span class="op" id="7719647">.</span><span class="ident" id="7719648">URL</span><span class="op" id="7719651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719657">Scheme</span><span class="op" id="7719663">:</span>&nbsp;<span class="string" id="7719665">&#34;http&#34;</span><span class="op" id="7719671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719677">Host</span><span class="op" id="7719681">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7719685">&#34;www.google.com&#34;</span><span class="op" id="7719701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719707">Path</span><span class="op" id="7719711">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7719715">&#34;/search&#34;</span><span class="op" id="7719724">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7719729">}</span><span class="op" id="7719730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719735">ProtoMajor</span><span class="op" id="7719745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7719753">1</span><span class="op" id="7719754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719759">ProtoMinor</span><span class="op" id="7719769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7719777">1</span><span class="op" id="7719778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719783">Header</span><span class="op" id="7719789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719801">Header</span><span class="op" id="7719807">{</span><span class="op" id="7719808">}</span><span class="op" id="7719809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719814">TransferEncoding</span><span class="op" id="7719830">:</span>&nbsp;<span class="op" id="7719832">[</span><span class="op" id="7719833">]</span><span class="builtintype" id="7719834">string</span><span class="op" id="7719840">{</span><span class="string" id="7719841">&#34;chunked&#34;</span><span class="op" id="7719850">}</span><span class="op" id="7719851">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7719855">}</span><span class="op" id="7719856">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719861">Body</span><span class="op" id="7719865">:</span>&nbsp;<span class="op" id="7719867">[</span><span class="op" id="7719868">]</span><span class="builtintype" id="7719869">byte</span><span class="op" id="7719873">(</span><span class="string" id="7719874">&#34;abcdef&#34;</span><span class="op" id="7719882">)</span><span class="op" id="7719883">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7719888">WantWrite</span><span class="op" id="7719897">:</span>&nbsp;<span class="string" id="7719899">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7719926">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719931">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7719958">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7719963">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7720001">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720006">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7720043">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720048">chunk</span><span class="op" id="7720053">(</span><span class="string" id="7720054">&#34;abcdef&#34;</span><span class="op" id="7720062">)</span>&nbsp;<span class="op" id="7720064">+</span>&nbsp;<span class="ident" id="7720066">chunk</span><span class="op" id="7720071">(</span><span class="string" id="7720072">&#34;&#34;</span><span class="op" id="7720074">)</span><span class="op" id="7720075">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720080">WantProxy</span><span class="op" id="7720089">:</span>&nbsp;<span class="string" id="7720091">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7720139">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720144">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7720171">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720176">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7720214">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720219">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7720256">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720261">chunk</span><span class="op" id="7720266">(</span><span class="string" id="7720267">&#34;abcdef&#34;</span><span class="op" id="7720275">)</span>&nbsp;<span class="op" id="7720277">+</span>&nbsp;<span class="ident" id="7720279">chunk</span><span class="op" id="7720284">(</span><span class="string" id="7720285">&#34;&#34;</span><span class="op" id="7720287">)</span><span class="op" id="7720288">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7720291">}</span><span class="op" id="7720292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7720295">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7720352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720356">Req</span><span class="op" id="7720359">:</span>&nbsp;<span class="ident" id="7720361">Request</span><span class="op" id="7720368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720373">Method</span><span class="op" id="7720379">:</span>&nbsp;<span class="string" id="7720381">&#34;POST&#34;</span><span class="op" id="7720387">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720392">URL</span><span class="op" id="7720395">:</span>&nbsp;<span class="op" id="7720397">&amp;</span><span class="ident" id="7720398">url</span><span class="op" id="7720401">.</span><span class="ident" id="7720402">URL</span><span class="op" id="7720405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720411">Scheme</span><span class="op" id="7720417">:</span>&nbsp;<span class="string" id="7720419">&#34;http&#34;</span><span class="op" id="7720425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720431">Host</span><span class="op" id="7720435">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7720439">&#34;www.google.com&#34;</span><span class="op" id="7720455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720461">Path</span><span class="op" id="7720465">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7720469">&#34;/search&#34;</span><span class="op" id="7720478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7720483">}</span><span class="op" id="7720484">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720489">ProtoMajor</span><span class="op" id="7720499">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7720507">1</span><span class="op" id="7720508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720513">ProtoMinor</span><span class="op" id="7720523">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7720531">1</span><span class="op" id="7720532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720537">Header</span><span class="op" id="7720543">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720555">Header</span><span class="op" id="7720561">{</span><span class="op" id="7720562">}</span><span class="op" id="7720563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720568">Close</span><span class="op" id="7720573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7720586">true</span><span class="op" id="7720590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720595">TransferEncoding</span><span class="op" id="7720611">:</span>&nbsp;<span class="op" id="7720613">[</span><span class="op" id="7720614">]</span><span class="builtintype" id="7720615">string</span><span class="op" id="7720621">{</span><span class="string" id="7720622">&#34;chunked&#34;</span><span class="op" id="7720631">}</span><span class="op" id="7720632">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7720636">}</span><span class="op" id="7720637">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720642">Body</span><span class="op" id="7720646">:</span>&nbsp;<span class="op" id="7720648">[</span><span class="op" id="7720649">]</span><span class="builtintype" id="7720650">byte</span><span class="op" id="7720654">(</span><span class="string" id="7720655">&#34;abcdef&#34;</span><span class="op" id="7720663">)</span><span class="op" id="7720664">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720669">WantWrite</span><span class="op" id="7720678">:</span>&nbsp;<span class="string" id="7720680">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7720708">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720713">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7720740">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720745">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7720783">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720788">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7720812">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720817">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7720854">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720859">chunk</span><span class="op" id="7720864">(</span><span class="string" id="7720865">&#34;abcdef&#34;</span><span class="op" id="7720873">)</span>&nbsp;<span class="op" id="7720875">+</span>&nbsp;<span class="ident" id="7720877">chunk</span><span class="op" id="7720882">(</span><span class="string" id="7720883">&#34;&#34;</span><span class="op" id="7720885">)</span><span class="op" id="7720886">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7720891">WantProxy</span><span class="op" id="7720900">:</span>&nbsp;<span class="string" id="7720902">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7720951">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720956">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7720983">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7720988">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7721026">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721031">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7721055">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721060">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7721097">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721102">chunk</span><span class="op" id="7721107">(</span><span class="string" id="7721108">&#34;abcdef&#34;</span><span class="op" id="7721116">)</span>&nbsp;<span class="op" id="7721118">+</span>&nbsp;<span class="ident" id="7721120">chunk</span><span class="op" id="7721125">(</span><span class="string" id="7721126">&#34;&#34;</span><span class="op" id="7721128">)</span><span class="op" id="7721129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7721132">}</span><span class="op" id="7721133">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7721137">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7721188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721192">Req</span><span class="op" id="7721195">:</span>&nbsp;<span class="ident" id="7721197">Request</span><span class="op" id="7721204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721209">Method</span><span class="op" id="7721215">:</span>&nbsp;<span class="string" id="7721217">&#34;POST&#34;</span><span class="op" id="7721223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721228">URL</span><span class="op" id="7721231">:</span>&nbsp;<span class="op" id="7721233">&amp;</span><span class="ident" id="7721234">url</span><span class="op" id="7721237">.</span><span class="ident" id="7721238">URL</span><span class="op" id="7721241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721247">Scheme</span><span class="op" id="7721253">:</span>&nbsp;<span class="string" id="7721255">&#34;http&#34;</span><span class="op" id="7721261">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721267">Host</span><span class="op" id="7721271">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7721275">&#34;www.google.com&#34;</span><span class="op" id="7721291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721297">Path</span><span class="op" id="7721301">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7721305">&#34;/search&#34;</span><span class="op" id="7721314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7721319">}</span><span class="op" id="7721320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721325">ProtoMajor</span><span class="op" id="7721335">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7721340">1</span><span class="op" id="7721341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721346">ProtoMinor</span><span class="op" id="7721356">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7721361">1</span><span class="op" id="7721362">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721367">Header</span><span class="op" id="7721373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721382">Header</span><span class="op" id="7721388">{</span><span class="op" id="7721389">}</span><span class="op" id="7721390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721395">Close</span><span class="op" id="7721400">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7721410">true</span><span class="op" id="7721414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721419">ContentLength</span><span class="op" id="7721432">:</span>&nbsp;<span class="num" id="7721434">6</span><span class="op" id="7721435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7721439">}</span><span class="op" id="7721440">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721445">Body</span><span class="op" id="7721449">:</span>&nbsp;<span class="op" id="7721451">[</span><span class="op" id="7721452">]</span><span class="builtintype" id="7721453">byte</span><span class="op" id="7721457">(</span><span class="string" id="7721458">&#34;abcdef&#34;</span><span class="op" id="7721466">)</span><span class="op" id="7721467">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721472">WantWrite</span><span class="op" id="7721481">:</span>&nbsp;<span class="string" id="7721483">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7721511">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721516">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7721543">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721548">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7721586">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721591">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7721615">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721620">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7721644">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721649">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7721656">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721661">&#34;abcdef&#34;</span><span class="op" id="7721669">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721674">WantProxy</span><span class="op" id="7721683">:</span>&nbsp;<span class="string" id="7721685">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7721734">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721739">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7721766">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721771">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7721809">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721814">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7721838">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721843">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7721867">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721872">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7721879">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7721884">&#34;abcdef&#34;</span><span class="op" id="7721892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7721895">}</span><span class="op" id="7721896">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7721900">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7721949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721953">Req</span><span class="op" id="7721956">:</span>&nbsp;<span class="ident" id="7721958">Request</span><span class="op" id="7721965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721970">Method</span><span class="op" id="7721976">:</span>&nbsp;<span class="string" id="7721978">&#34;POST&#34;</span><span class="op" id="7721984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721989">URL</span><span class="op" id="7721992">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7721997">mustParseURL</span><span class="op" id="7722009">(</span><span class="string" id="7722010">&#34;http://example.com/&#34;</span><span class="op" id="7722031">)</span><span class="op" id="7722032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722037">Host</span><span class="op" id="7722041">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7722045">&#34;example.com&#34;</span><span class="op" id="7722058">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722063">Header</span><span class="op" id="7722069">:</span>&nbsp;<span class="ident" id="7722071">Header</span><span class="op" id="7722077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722083">&#34;Content-Length&#34;</span><span class="op" id="7722099">:</span>&nbsp;<span class="op" id="7722101">[</span><span class="op" id="7722102">]</span><span class="builtintype" id="7722103">string</span><span class="op" id="7722109">{</span><span class="string" id="7722110">&#34;10&#34;</span><span class="op" id="7722114">}</span><span class="op" id="7722115">,</span>&nbsp;<span class="comment" id="7722117">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722131">}</span><span class="op" id="7722132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722137">ContentLength</span><span class="op" id="7722150">:</span>&nbsp;<span class="num" id="7722152">6</span><span class="op" id="7722153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722157">}</span><span class="op" id="7722158">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722163">Body</span><span class="op" id="7722167">:</span>&nbsp;<span class="op" id="7722169">[</span><span class="op" id="7722170">]</span><span class="builtintype" id="7722171">byte</span><span class="op" id="7722175">(</span><span class="string" id="7722176">&#34;abcdef&#34;</span><span class="op" id="7722184">)</span><span class="op" id="7722185">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722190">WantWrite</span><span class="op" id="7722199">:</span>&nbsp;<span class="string" id="7722201">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7722223">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722228">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7722252">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722257">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7722295">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722300">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7722324">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722329">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7722336">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722341">&#34;abcdef&#34;</span><span class="op" id="7722349">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722354">WantProxy</span><span class="op" id="7722363">:</span>&nbsp;<span class="string" id="7722365">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7722405">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722410">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7722434">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722439">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7722477">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722482">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7722506">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722511">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7722518">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722523">&#34;abcdef&#34;</span><span class="op" id="7722531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722534">}</span><span class="op" id="7722535">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7722539">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722563">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722567">Req</span><span class="op" id="7722570">:</span>&nbsp;<span class="ident" id="7722572">Request</span><span class="op" id="7722579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722584">Method</span><span class="op" id="7722590">:</span>&nbsp;<span class="string" id="7722592">&#34;GET&#34;</span><span class="op" id="7722597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722602">URL</span><span class="op" id="7722605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722610">mustParseURL</span><span class="op" id="7722622">(</span><span class="string" id="7722623">&#34;/search&#34;</span><span class="op" id="7722632">)</span><span class="op" id="7722633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722638">Host</span><span class="op" id="7722642">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7722646">&#34;www.google.com&#34;</span><span class="op" id="7722662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722666">}</span><span class="op" id="7722667">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722672">WantWrite</span><span class="op" id="7722681">:</span>&nbsp;<span class="string" id="7722683">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7722710">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722715">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7722742">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722747">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7722785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722790">&#34;\r\n&#34;</span><span class="op" id="7722796">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722799">}</span><span class="op" id="7722800">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7722804">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7722858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722862">Req</span><span class="op" id="7722865">:</span>&nbsp;<span class="ident" id="7722867">Request</span><span class="op" id="7722874">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722879">Method</span><span class="op" id="7722885">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722894">&#34;POST&#34;</span><span class="op" id="7722900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722905">URL</span><span class="op" id="7722908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722920">mustParseURL</span><span class="op" id="7722932">(</span><span class="string" id="7722933">&#34;/&#34;</span><span class="op" id="7722936">)</span><span class="op" id="7722937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722942">Host</span><span class="op" id="7722946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7722957">&#34;example.com&#34;</span><span class="op" id="7722970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722975">ProtoMajor</span><span class="op" id="7722985">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7722990">1</span><span class="op" id="7722991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7722996">ProtoMinor</span><span class="op" id="7723006">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7723011">1</span><span class="op" id="7723012">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723017">ContentLength</span><span class="op" id="7723030">:</span>&nbsp;<span class="num" id="7723032">0</span><span class="op" id="7723033">,</span>&nbsp;<span class="comment" id="7723035">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7723060">}</span><span class="op" id="7723061">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723066">Body</span><span class="op" id="7723070">:</span>&nbsp;<span class="keyword" id="7723072">func</span><span class="op" id="7723076">(</span><span class="op" id="7723077">)</span>&nbsp;<span class="ident" id="7723079">io</span><span class="op" id="7723081">.</span><span class="ident" id="7723082">ReadCloser</span>&nbsp;<span class="op" id="7723093">{</span>&nbsp;<span class="keyword" id="7723095">return</span>&nbsp;<span class="ident" id="7723102">ioutil</span><span class="op" id="7723108">.</span><span class="ident" id="7723109">NopCloser</span><span class="op" id="7723118">(</span><span class="ident" id="7723119">io</span><span class="op" id="7723121">.</span><span class="ident" id="7723122">LimitReader</span><span class="op" id="7723133">(</span><span class="ident" id="7723134">strings</span><span class="op" id="7723141">.</span><span class="ident" id="7723142">NewReader</span><span class="op" id="7723151">(</span><span class="string" id="7723152">&#34;xx&#34;</span><span class="op" id="7723156">)</span><span class="op" id="7723157">,</span>&nbsp;<span class="num" id="7723159">0</span><span class="op" id="7723160">)</span><span class="op" id="7723161">)</span>&nbsp;<span class="op" id="7723163">}</span><span class="op" id="7723164">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7723169">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7723237">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7723291">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723337">WantWrite</span><span class="op" id="7723346">:</span>&nbsp;<span class="string" id="7723348">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7723370">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723375">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7723399">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723404">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7723442">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723447">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7723471">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723476">&#34;\r\n&#34;</span><span class="op" id="7723482">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723487">WantProxy</span><span class="op" id="7723496">:</span>&nbsp;<span class="string" id="7723498">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7723520">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723525">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7723549">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723554">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7723592">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723597">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7723621">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723626">&#34;\r\n&#34;</span><span class="op" id="7723632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7723635">}</span><span class="op" id="7723636">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7723640">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7723694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723698">Req</span><span class="op" id="7723701">:</span>&nbsp;<span class="ident" id="7723703">Request</span><span class="op" id="7723710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723715">Method</span><span class="op" id="7723721">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723730">&#34;POST&#34;</span><span class="op" id="7723736">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723741">URL</span><span class="op" id="7723744">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723756">mustParseURL</span><span class="op" id="7723768">(</span><span class="string" id="7723769">&#34;/&#34;</span><span class="op" id="7723772">)</span><span class="op" id="7723773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723778">Host</span><span class="op" id="7723782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7723793">&#34;example.com&#34;</span><span class="op" id="7723806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723811">ProtoMajor</span><span class="op" id="7723821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7723826">1</span><span class="op" id="7723827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723832">ProtoMinor</span><span class="op" id="7723842">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7723847">1</span><span class="op" id="7723848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723853">ContentLength</span><span class="op" id="7723866">:</span>&nbsp;<span class="num" id="7723868">0</span><span class="op" id="7723869">,</span>&nbsp;<span class="comment" id="7723871">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7723896">}</span><span class="op" id="7723897">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7723902">Body</span><span class="op" id="7723906">:</span>&nbsp;<span class="keyword" id="7723908">func</span><span class="op" id="7723912">(</span><span class="op" id="7723913">)</span>&nbsp;<span class="ident" id="7723915">io</span><span class="op" id="7723917">.</span><span class="ident" id="7723918">ReadCloser</span>&nbsp;<span class="op" id="7723929">{</span>&nbsp;<span class="keyword" id="7723931">return</span>&nbsp;<span class="ident" id="7723938">ioutil</span><span class="op" id="7723944">.</span><span class="ident" id="7723945">NopCloser</span><span class="op" id="7723954">(</span><span class="ident" id="7723955">io</span><span class="op" id="7723957">.</span><span class="ident" id="7723958">LimitReader</span><span class="op" id="7723969">(</span><span class="ident" id="7723970">strings</span><span class="op" id="7723977">.</span><span class="ident" id="7723978">NewReader</span><span class="op" id="7723987">(</span><span class="string" id="7723988">&#34;xx&#34;</span><span class="op" id="7723992">)</span><span class="op" id="7723993">,</span>&nbsp;<span class="num" id="7723995">1</span><span class="op" id="7723996">)</span><span class="op" id="7723997">)</span>&nbsp;<span class="op" id="7723999">}</span><span class="op" id="7724000">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724005">WantWrite</span><span class="op" id="7724014">:</span>&nbsp;<span class="string" id="7724016">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7724038">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724043">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7724067">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724072">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7724110">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724115">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7724152">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724157">chunk</span><span class="op" id="7724162">(</span><span class="string" id="7724163">&#34;x&#34;</span><span class="op" id="7724166">)</span>&nbsp;<span class="op" id="7724168">+</span>&nbsp;<span class="ident" id="7724170">chunk</span><span class="op" id="7724175">(</span><span class="string" id="7724176">&#34;&#34;</span><span class="op" id="7724178">)</span><span class="op" id="7724179">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724184">WantProxy</span><span class="op" id="7724193">:</span>&nbsp;<span class="string" id="7724195">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7724217">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724222">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7724246">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724251">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7724289">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724294">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7724331">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724336">chunk</span><span class="op" id="7724341">(</span><span class="string" id="7724342">&#34;x&#34;</span><span class="op" id="7724345">)</span>&nbsp;<span class="op" id="7724347">+</span>&nbsp;<span class="ident" id="7724349">chunk</span><span class="op" id="7724354">(</span><span class="string" id="7724355">&#34;&#34;</span><span class="op" id="7724357">)</span><span class="op" id="7724358">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7724361">}</span><span class="op" id="7724362">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7724366">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7724424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724428">Req</span><span class="op" id="7724431">:</span>&nbsp;<span class="ident" id="7724433">Request</span><span class="op" id="7724440">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724445">Method</span><span class="op" id="7724451">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724460">&#34;POST&#34;</span><span class="op" id="7724466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724471">URL</span><span class="op" id="7724474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724486">mustParseURL</span><span class="op" id="7724498">(</span><span class="string" id="7724499">&#34;/&#34;</span><span class="op" id="7724502">)</span><span class="op" id="7724503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724508">Host</span><span class="op" id="7724512">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724523">&#34;example.com&#34;</span><span class="op" id="7724536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724541">ProtoMajor</span><span class="op" id="7724551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7724556">1</span><span class="op" id="7724557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724562">ProtoMinor</span><span class="op" id="7724572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7724577">1</span><span class="op" id="7724578">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724583">ContentLength</span><span class="op" id="7724596">:</span>&nbsp;<span class="num" id="7724598">10</span><span class="op" id="7724600">,</span>&nbsp;<span class="comment" id="7724602">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7724644">}</span><span class="op" id="7724645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724649">Body</span><span class="op" id="7724653">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7724660">[</span><span class="op" id="7724661">]</span><span class="builtintype" id="7724662">byte</span><span class="op" id="7724666">(</span><span class="string" id="7724667">&#34;12345&#34;</span><span class="op" id="7724674">)</span><span class="op" id="7724675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724679">WantError</span><span class="op" id="7724688">:</span>&nbsp;<span class="ident" id="7724690">errors</span><span class="op" id="7724696">.</span><span class="ident" id="7724697">New</span><span class="op" id="7724700">(</span><span class="string" id="7724701">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="7724744">)</span><span class="op" id="7724745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7724748">}</span><span class="op" id="7724749">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7724753">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7724811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724815">Req</span><span class="op" id="7724818">:</span>&nbsp;<span class="ident" id="7724820">Request</span><span class="op" id="7724827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724832">Method</span><span class="op" id="7724838">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724847">&#34;POST&#34;</span><span class="op" id="7724853">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724858">URL</span><span class="op" id="7724861">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724873">mustParseURL</span><span class="op" id="7724885">(</span><span class="string" id="7724886">&#34;/&#34;</span><span class="op" id="7724889">)</span><span class="op" id="7724890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724895">Host</span><span class="op" id="7724899">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7724910">&#34;example.com&#34;</span><span class="op" id="7724923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724928">ProtoMajor</span><span class="op" id="7724938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7724943">1</span><span class="op" id="7724944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724949">ProtoMinor</span><span class="op" id="7724959">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7724964">1</span><span class="op" id="7724965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7724970">ContentLength</span><span class="op" id="7724983">:</span>&nbsp;<span class="num" id="7724985">4</span><span class="op" id="7724986">,</span>&nbsp;<span class="comment" id="7724988">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725032">}</span><span class="op" id="7725033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725037">Body</span><span class="op" id="7725041">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725048">[</span><span class="op" id="7725049">]</span><span class="builtintype" id="7725050">byte</span><span class="op" id="7725054">(</span><span class="string" id="7725055">&#34;12345678&#34;</span><span class="op" id="7725065">)</span><span class="op" id="7725066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725070">WantError</span><span class="op" id="7725079">:</span>&nbsp;<span class="ident" id="7725081">errors</span><span class="op" id="7725087">.</span><span class="ident" id="7725088">New</span><span class="op" id="7725091">(</span><span class="string" id="7725092">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="7725134">)</span><span class="op" id="7725135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725138">}</span><span class="op" id="7725139">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7725143">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725196">Req</span><span class="op" id="7725199">:</span>&nbsp;<span class="ident" id="7725201">Request</span><span class="op" id="7725208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725213">Method</span><span class="op" id="7725219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7725228">&#34;POST&#34;</span><span class="op" id="7725234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725239">URL</span><span class="op" id="7725242">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725254">mustParseURL</span><span class="op" id="7725266">(</span><span class="string" id="7725267">&#34;/&#34;</span><span class="op" id="7725270">)</span><span class="op" id="7725271">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725276">Host</span><span class="op" id="7725280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7725291">&#34;example.com&#34;</span><span class="op" id="7725304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725309">ProtoMajor</span><span class="op" id="7725319">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7725324">1</span><span class="op" id="7725325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725330">ProtoMinor</span><span class="op" id="7725340">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7725345">1</span><span class="op" id="7725346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725351">ContentLength</span><span class="op" id="7725364">:</span>&nbsp;<span class="num" id="7725366">5</span><span class="op" id="7725367">,</span>&nbsp;<span class="comment" id="7725369">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725398">}</span><span class="op" id="7725399">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725403">WantError</span><span class="op" id="7725412">:</span>&nbsp;<span class="ident" id="7725414">errors</span><span class="op" id="7725420">.</span><span class="ident" id="7725421">New</span><span class="op" id="7725424">(</span><span class="string" id="7725425">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="7725470">)</span><span class="op" id="7725471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725474">}</span><span class="op" id="7725475">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7725479">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725559">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725563">Req</span><span class="op" id="7725566">:</span>&nbsp;<span class="ident" id="7725568">Request</span><span class="op" id="7725575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725580">Method</span><span class="op" id="7725586">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7725595">&#34;POST&#34;</span><span class="op" id="7725601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725606">URL</span><span class="op" id="7725609">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725621">mustParseURL</span><span class="op" id="7725633">(</span><span class="string" id="7725634">&#34;/&#34;</span><span class="op" id="7725637">)</span><span class="op" id="7725638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725643">Host</span><span class="op" id="7725647">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7725658">&#34;example.com&#34;</span><span class="op" id="7725671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725676">ProtoMajor</span><span class="op" id="7725686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7725691">1</span><span class="op" id="7725692">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725697">ProtoMinor</span><span class="op" id="7725707">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7725712">1</span><span class="op" id="7725713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725718">ContentLength</span><span class="op" id="7725731">:</span>&nbsp;<span class="num" id="7725733">0</span><span class="op" id="7725734">,</span>&nbsp;<span class="comment" id="7725736">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725761">}</span><span class="op" id="7725762">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725767">Body</span><span class="op" id="7725771">:</span>&nbsp;<span class="keyword" id="7725773">func</span><span class="op" id="7725777">(</span><span class="op" id="7725778">)</span>&nbsp;<span class="ident" id="7725780">io</span><span class="op" id="7725782">.</span><span class="ident" id="7725783">ReadCloser</span>&nbsp;<span class="op" id="7725794">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725799">err</span>&nbsp;<span class="op" id="7725803">:=</span>&nbsp;<span class="ident" id="7725806">errors</span><span class="op" id="7725812">.</span><span class="ident" id="7725813">New</span><span class="op" id="7725816">(</span><span class="string" id="7725817">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7725838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725843">errReader</span>&nbsp;<span class="op" id="7725853">:=</span>&nbsp;<span class="op" id="7725856">&amp;</span><span class="ident" id="7725857">errorReader</span><span class="op" id="7725868">{</span><span class="ident" id="7725869">err</span><span class="op" id="7725872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7725877">return</span>&nbsp;<span class="ident" id="7725884">ioutil</span><span class="op" id="7725890">.</span><span class="ident" id="7725891">NopCloser</span><span class="op" id="7725900">(</span><span class="ident" id="7725901">io</span><span class="op" id="7725903">.</span><span class="ident" id="7725904">MultiReader</span><span class="op" id="7725915">(</span><span class="ident" id="7725916">strings</span><span class="op" id="7725923">.</span><span class="ident" id="7725924">NewReader</span><span class="op" id="7725933">(</span><span class="string" id="7725934">&#34;x&#34;</span><span class="op" id="7725937">)</span><span class="op" id="7725938">,</span>&nbsp;<span class="ident" id="7725940">errReader</span><span class="op" id="7725949">)</span><span class="op" id="7725950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7725954">}</span><span class="op" id="7725955">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7725960">WantError</span><span class="op" id="7725969">:</span>&nbsp;<span class="ident" id="7725971">errors</span><span class="op" id="7725977">.</span><span class="ident" id="7725978">New</span><span class="op" id="7725981">(</span><span class="string" id="7725982">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7726003">)</span><span class="op" id="7726004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726007">}</span><span class="op" id="7726008">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7726012">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726088">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726092">Req</span><span class="op" id="7726095">:</span>&nbsp;<span class="ident" id="7726097">Request</span><span class="op" id="7726104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726109">Method</span><span class="op" id="7726115">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726124">&#34;POST&#34;</span><span class="op" id="7726130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726135">URL</span><span class="op" id="7726138">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726150">mustParseURL</span><span class="op" id="7726162">(</span><span class="string" id="7726163">&#34;/&#34;</span><span class="op" id="7726166">)</span><span class="op" id="7726167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726172">Host</span><span class="op" id="7726176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726187">&#34;example.com&#34;</span><span class="op" id="7726200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726205">ProtoMajor</span><span class="op" id="7726215">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7726220">1</span><span class="op" id="7726221">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726226">ProtoMinor</span><span class="op" id="7726236">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7726241">1</span><span class="op" id="7726242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726247">ContentLength</span><span class="op" id="7726260">:</span>&nbsp;<span class="num" id="7726262">0</span><span class="op" id="7726263">,</span>&nbsp;<span class="comment" id="7726265">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726290">}</span><span class="op" id="7726291">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726296">Body</span><span class="op" id="7726300">:</span>&nbsp;<span class="keyword" id="7726302">func</span><span class="op" id="7726306">(</span><span class="op" id="7726307">)</span>&nbsp;<span class="ident" id="7726309">io</span><span class="op" id="7726311">.</span><span class="ident" id="7726312">ReadCloser</span>&nbsp;<span class="op" id="7726323">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726328">err</span>&nbsp;<span class="op" id="7726332">:=</span>&nbsp;<span class="ident" id="7726335">errors</span><span class="op" id="7726341">.</span><span class="ident" id="7726342">New</span><span class="op" id="7726345">(</span><span class="string" id="7726346">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7726367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726372">errReader</span>&nbsp;<span class="op" id="7726382">:=</span>&nbsp;<span class="op" id="7726385">&amp;</span><span class="ident" id="7726386">errorReader</span><span class="op" id="7726397">{</span><span class="ident" id="7726398">err</span><span class="op" id="7726401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7726406">return</span>&nbsp;<span class="ident" id="7726413">ioutil</span><span class="op" id="7726419">.</span><span class="ident" id="7726420">NopCloser</span><span class="op" id="7726429">(</span><span class="ident" id="7726430">errReader</span><span class="op" id="7726439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726443">}</span><span class="op" id="7726444">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726449">WantError</span><span class="op" id="7726458">:</span>&nbsp;<span class="ident" id="7726460">errors</span><span class="op" id="7726466">.</span><span class="ident" id="7726467">New</span><span class="op" id="7726470">(</span><span class="string" id="7726471">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7726492">)</span><span class="op" id="7726493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726496">}</span><span class="op" id="7726497">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7726501">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7726584">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726622">Req</span><span class="op" id="7726625">:</span>&nbsp;<span class="ident" id="7726627">Request</span><span class="op" id="7726634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726639">Method</span><span class="op" id="7726645">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726651">&#34;GET&#34;</span><span class="op" id="7726656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726661">URL</span><span class="op" id="7726664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726673">mustParseURL</span><span class="op" id="7726685">(</span><span class="string" id="7726686">&#34;/foo&#34;</span><span class="op" id="7726692">)</span><span class="op" id="7726693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726698">ProtoMajor</span><span class="op" id="7726708">:</span>&nbsp;<span class="num" id="7726710">1</span><span class="op" id="7726711">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726716">ProtoMinor</span><span class="op" id="7726726">:</span>&nbsp;<span class="num" id="7726728">0</span><span class="op" id="7726729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726734">Header</span><span class="op" id="7726740">:</span>&nbsp;<span class="ident" id="7726742">Header</span><span class="op" id="7726748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726754">&#34;X-Foo&#34;</span><span class="op" id="7726761">:</span>&nbsp;<span class="op" id="7726763">[</span><span class="op" id="7726764">]</span><span class="builtintype" id="7726765">string</span><span class="op" id="7726771">{</span><span class="string" id="7726772">&#34;X-Bar&#34;</span><span class="op" id="7726779">}</span><span class="op" id="7726780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726785">}</span><span class="op" id="7726786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726790">}</span><span class="op" id="7726791">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7726796">WantWrite</span><span class="op" id="7726805">:</span>&nbsp;<span class="string" id="7726807">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7726831">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726836">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7726849">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726854">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7726892">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7726897">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7726919">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7726922">}</span><span class="op" id="7726923">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7726927">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7726983">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7727023">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7727077">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727118">Req</span><span class="op" id="7727121">:</span>&nbsp;<span class="ident" id="7727123">Request</span><span class="op" id="7727130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727135">Method</span><span class="op" id="7727141">:</span>&nbsp;<span class="string" id="7727143">&#34;GET&#34;</span><span class="op" id="7727148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727153">Host</span><span class="op" id="7727157">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7727161">&#34;&#34;</span><span class="op" id="7727163">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727168">URL</span><span class="op" id="7727171">:</span>&nbsp;<span class="op" id="7727173">&amp;</span><span class="ident" id="7727174">url</span><span class="op" id="7727177">.</span><span class="ident" id="7727178">URL</span><span class="op" id="7727181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727187">Scheme</span><span class="op" id="7727193">:</span>&nbsp;<span class="string" id="7727195">&#34;http&#34;</span><span class="op" id="7727201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727207">Host</span><span class="op" id="7727211">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7727215">&#34;&#34;</span><span class="op" id="7727217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727223">Path</span><span class="op" id="7727227">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7727231">&#34;/search&#34;</span><span class="op" id="7727240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727245">}</span><span class="op" id="7727246">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727251">ProtoMajor</span><span class="op" id="7727261">:</span>&nbsp;<span class="num" id="7727263">1</span><span class="op" id="7727264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727269">ProtoMinor</span><span class="op" id="7727279">:</span>&nbsp;<span class="num" id="7727281">1</span><span class="op" id="7727282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727287">Header</span><span class="op" id="7727293">:</span>&nbsp;<span class="ident" id="7727295">Header</span><span class="op" id="7727301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7727307">&#34;Host&#34;</span><span class="op" id="7727313">:</span>&nbsp;<span class="op" id="7727315">[</span><span class="op" id="7727316">]</span><span class="builtintype" id="7727317">string</span><span class="op" id="7727323">{</span><span class="string" id="7727324">&#34;bad.example.com&#34;</span><span class="op" id="7727341">}</span><span class="op" id="7727342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727347">}</span><span class="op" id="7727348">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727352">}</span><span class="op" id="7727353">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727358">WantWrite</span><span class="op" id="7727367">:</span>&nbsp;<span class="string" id="7727369">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7727396">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7727401">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7727414">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7727419">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7727460">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727463">}</span><span class="op" id="7727464">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7727468">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727518">Req</span><span class="op" id="7727521">:</span>&nbsp;<span class="ident" id="7727523">Request</span><span class="op" id="7727530">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727535">Method</span><span class="op" id="7727541">:</span>&nbsp;<span class="string" id="7727543">&#34;GET&#34;</span><span class="op" id="7727548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727553">URL</span><span class="op" id="7727556">:</span>&nbsp;<span class="op" id="7727558">&amp;</span><span class="ident" id="7727559">url</span><span class="op" id="7727562">.</span><span class="ident" id="7727563">URL</span><span class="op" id="7727566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727572">Scheme</span><span class="op" id="7727578">:</span>&nbsp;<span class="string" id="7727580">&#34;http&#34;</span><span class="op" id="7727586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727592">Host</span><span class="op" id="7727596">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7727600">&#34;www.google.com&#34;</span><span class="op" id="7727616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727622">Opaque</span><span class="op" id="7727628">:</span>&nbsp;<span class="string" id="7727630">&#34;/%2F/%2F/&#34;</span><span class="op" id="7727641">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727646">}</span><span class="op" id="7727647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727652">ProtoMajor</span><span class="op" id="7727662">:</span>&nbsp;<span class="num" id="7727664">1</span><span class="op" id="7727665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727670">ProtoMinor</span><span class="op" id="7727680">:</span>&nbsp;<span class="num" id="7727682">1</span><span class="op" id="7727683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727688">Header</span><span class="op" id="7727694">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727700">Header</span><span class="op" id="7727706">{</span><span class="op" id="7727707">}</span><span class="op" id="7727708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727712">}</span><span class="op" id="7727713">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727718">WantWrite</span><span class="op" id="7727727">:</span>&nbsp;<span class="string" id="7727729">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7727758">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7727763">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7727790">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7727795">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7727836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727839">}</span><span class="op" id="7727840">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7727844">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7727890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727894">Req</span><span class="op" id="7727897">:</span>&nbsp;<span class="ident" id="7727899">Request</span><span class="op" id="7727906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727911">Method</span><span class="op" id="7727917">:</span>&nbsp;<span class="string" id="7727919">&#34;GET&#34;</span><span class="op" id="7727924">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727929">URL</span><span class="op" id="7727932">:</span>&nbsp;<span class="op" id="7727934">&amp;</span><span class="ident" id="7727935">url</span><span class="op" id="7727938">.</span><span class="ident" id="7727939">URL</span><span class="op" id="7727942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727948">Scheme</span><span class="op" id="7727954">:</span>&nbsp;<span class="string" id="7727956">&#34;http&#34;</span><span class="op" id="7727962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727968">Host</span><span class="op" id="7727972">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7727976">&#34;x.google.com&#34;</span><span class="op" id="7727990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7727996">Opaque</span><span class="op" id="7728002">:</span>&nbsp;<span class="string" id="7728004">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="7728029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728034">}</span><span class="op" id="7728035">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728040">ProtoMajor</span><span class="op" id="7728050">:</span>&nbsp;<span class="num" id="7728052">1</span><span class="op" id="7728053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728058">ProtoMinor</span><span class="op" id="7728068">:</span>&nbsp;<span class="num" id="7728070">1</span><span class="op" id="7728071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728076">Header</span><span class="op" id="7728082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728088">Header</span><span class="op" id="7728094">{</span><span class="op" id="7728095">}</span><span class="op" id="7728096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728100">}</span><span class="op" id="7728101">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728106">WantWrite</span><span class="op" id="7728115">:</span>&nbsp;<span class="string" id="7728117">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7728165">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728170">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7728195">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728200">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7728241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728244">}</span><span class="op" id="7728245">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7728249">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728305">Req</span><span class="op" id="7728308">:</span>&nbsp;<span class="ident" id="7728310">Request</span><span class="op" id="7728317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728322">Method</span><span class="op" id="7728328">:</span>&nbsp;<span class="string" id="7728330">&#34;GET&#34;</span><span class="op" id="7728335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728340">URL</span><span class="op" id="7728343">:</span>&nbsp;<span class="op" id="7728345">&amp;</span><span class="ident" id="7728346">url</span><span class="op" id="7728349">.</span><span class="ident" id="7728350">URL</span><span class="op" id="7728353">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728359">Scheme</span><span class="op" id="7728365">:</span>&nbsp;<span class="string" id="7728367">&#34;http&#34;</span><span class="op" id="7728373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728379">Host</span><span class="op" id="7728383">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7728387">&#34;www.google.com&#34;</span><span class="op" id="7728403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728409">Path</span><span class="op" id="7728413">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7728417">&#34;/&#34;</span><span class="op" id="7728420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728425">}</span><span class="op" id="7728426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728431">Proto</span><span class="op" id="7728436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728443">&#34;HTTP/1.1&#34;</span><span class="op" id="7728453">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728458">ProtoMajor</span><span class="op" id="7728468">:</span>&nbsp;<span class="num" id="7728470">1</span><span class="op" id="7728471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728476">ProtoMinor</span><span class="op" id="7728486">:</span>&nbsp;<span class="num" id="7728488">1</span><span class="op" id="7728489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728494">Header</span><span class="op" id="7728500">:</span>&nbsp;<span class="ident" id="7728502">Header</span><span class="op" id="7728508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728514">&#34;ALL-CAPS&#34;</span><span class="op" id="7728524">:</span>&nbsp;<span class="op" id="7728526">{</span><span class="string" id="7728527">&#34;x&#34;</span><span class="op" id="7728530">}</span><span class="op" id="7728531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728536">}</span><span class="op" id="7728537">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728541">}</span><span class="op" id="7728542">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728547">WantWrite</span><span class="op" id="7728556">:</span>&nbsp;<span class="string" id="7728558">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7728579">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728584">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7728611">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728616">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7728654">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728659">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="7728677">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7728682">&#34;\r\n&#34;</span><span class="op" id="7728688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728691">}</span><span class="op" id="7728692">,</span><br>
<span class="lineno"></span><span class="op" id="7728694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="7728697">func</span>&nbsp;<span class="ident" id="7728702">TestRequestWrite</span><span class="op" id="7728718">(</span><span class="ident" id="7728719">t</span>&nbsp;<span class="op" id="7728721">*</span><span class="ident" id="7728722">testing</span><span class="op" id="7728729">.</span><span class="ident" id="7728730">T</span><span class="op" id="7728731">)</span>&nbsp;<span class="op" id="7728733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7728736">for</span>&nbsp;<span class="ident" id="7728740">i</span>&nbsp;<span class="op" id="7728742">:=</span>&nbsp;<span class="keyword" id="7728745">range</span>&nbsp;<span class="ident" id="7728751">reqWriteTests</span>&nbsp;<span class="op" id="7728765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728769">tt</span>&nbsp;<span class="op" id="7728772">:=</span>&nbsp;<span class="op" id="7728775">&amp;</span><span class="ident" id="7728776">reqWriteTests</span><span class="op" id="7728789">[</span><span class="ident" id="7728790">i</span><span class="op" id="7728791">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728796">setBody</span>&nbsp;<span class="op" id="7728804">:=</span>&nbsp;<span class="keyword" id="7728807">func</span><span class="op" id="7728811">(</span><span class="op" id="7728812">)</span>&nbsp;<span class="op" id="7728814">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7728819">if</span>&nbsp;<span class="ident" id="7728822">tt</span><span class="op" id="7728824">.</span><span class="ident" id="7728825">Body</span>&nbsp;<span class="op" id="7728830">==</span>&nbsp;<span class="builtintype" id="7728833">nil</span>&nbsp;<span class="op" id="7728837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7728843">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7728853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7728858">switch</span>&nbsp;<span class="ident" id="7728865">b</span>&nbsp;<span class="op" id="7728867">:=</span>&nbsp;<span class="ident" id="7728870">tt</span><span class="op" id="7728872">.</span><span class="ident" id="7728873">Body</span><span class="op" id="7728877">.</span><span class="op" id="7728878">(</span><span class="keyword" id="7728879">type</span><span class="op" id="7728883">)</span>&nbsp;<span class="op" id="7728885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7728890">case</span>&nbsp;<span class="op" id="7728895">[</span><span class="op" id="7728896">]</span><span class="builtintype" id="7728897">byte</span><span class="op" id="7728901">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728907">tt</span><span class="op" id="7728909">.</span><span class="ident" id="7728910">Req</span><span class="op" id="7728913">.</span><span class="ident" id="7728914">Body</span>&nbsp;<span class="op" id="7728919">=</span>&nbsp;<span class="ident" id="7728921">ioutil</span><span class="op" id="7728927">.</span><span class="ident" id="7728928">NopCloser</span><span class="op" id="7728937">(</span><span class="ident" id="7728938">bytes</span><span class="op" id="7728943">.</span><span class="ident" id="7728944">NewReader</span><span class="op" id="7728953">(</span><span class="ident" id="7728954">b</span><span class="op" id="7728955">)</span><span class="op" id="7728956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7728961">case</span>&nbsp;<span class="keyword" id="7728966">func</span><span class="op" id="7728970">(</span><span class="op" id="7728971">)</span>&nbsp;<span class="ident" id="7728973">io</span><span class="op" id="7728975">.</span><span class="ident" id="7728976">ReadCloser</span><span class="op" id="7728986">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7728992">tt</span><span class="op" id="7728994">.</span><span class="ident" id="7728995">Req</span><span class="op" id="7728998">.</span><span class="ident" id="7728999">Body</span>&nbsp;<span class="op" id="7729004">=</span>&nbsp;<span class="ident" id="7729006">b</span><span class="op" id="7729007">(</span><span class="op" id="7729008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729017">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729021">setBody</span><span class="op" id="7729028">(</span><span class="op" id="7729029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729033">if</span>&nbsp;<span class="ident" id="7729036">tt</span><span class="op" id="7729038">.</span><span class="ident" id="7729039">Req</span><span class="op" id="7729042">.</span><span class="ident" id="7729043">Header</span>&nbsp;<span class="op" id="7729050">==</span>&nbsp;<span class="builtintype" id="7729053">nil</span>&nbsp;<span class="op" id="7729057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729062">tt</span><span class="op" id="7729064">.</span><span class="ident" id="7729065">Req</span><span class="op" id="7729068">.</span><span class="ident" id="7729069">Header</span>&nbsp;<span class="op" id="7729076">=</span>&nbsp;<span class="builtinfunc" id="7729078">make</span><span class="op" id="7729082">(</span><span class="ident" id="7729083">Header</span><span class="op" id="7729089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729098">var</span>&nbsp;<span class="ident" id="7729102">braw</span>&nbsp;<span class="ident" id="7729107">bytes</span><span class="op" id="7729112">.</span><span class="ident" id="7729113">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729122">err</span>&nbsp;<span class="op" id="7729126">:=</span>&nbsp;<span class="ident" id="7729129">tt</span><span class="op" id="7729131">.</span><span class="ident" id="7729132">Req</span><span class="op" id="7729135">.</span><span class="ident" id="7729136">Write</span><span class="op" id="7729141">(</span><span class="op" id="7729142">&amp;</span><span class="ident" id="7729143">braw</span><span class="op" id="7729147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729151">if</span>&nbsp;<span class="ident" id="7729154">g</span><span class="op" id="7729155">,</span>&nbsp;<span class="ident" id="7729157">e</span>&nbsp;<span class="op" id="7729159">:=</span>&nbsp;<span class="ident" id="7729162">fmt</span><span class="op" id="7729165">.</span><span class="ident" id="7729166">Sprintf</span><span class="op" id="7729173">(</span><span class="string" id="7729174">&#34;%v&#34;</span><span class="op" id="7729178">,</span>&nbsp;<span class="ident" id="7729180">err</span><span class="op" id="7729183">)</span><span class="op" id="7729184">,</span>&nbsp;<span class="ident" id="7729186">fmt</span><span class="op" id="7729189">.</span><span class="ident" id="7729190">Sprintf</span><span class="op" id="7729197">(</span><span class="string" id="7729198">&#34;%v&#34;</span><span class="op" id="7729202">,</span>&nbsp;<span class="ident" id="7729204">tt</span><span class="op" id="7729206">.</span><span class="ident" id="7729207">WantError</span><span class="op" id="7729216">)</span><span class="op" id="7729217">;</span>&nbsp;<span class="ident" id="7729219">g</span>&nbsp;<span class="op" id="7729221">!=</span>&nbsp;<span class="ident" id="7729224">e</span>&nbsp;<span class="op" id="7729226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729231">t</span><span class="op" id="7729232">.</span><span class="ident" id="7729233">Errorf</span><span class="op" id="7729239">(</span><span class="string" id="7729240">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7729272">,</span>&nbsp;<span class="ident" id="7729274">i</span><span class="op" id="7729275">,</span>&nbsp;<span class="ident" id="7729277">g</span><span class="op" id="7729278">,</span>&nbsp;<span class="ident" id="7729280">e</span><span class="op" id="7729281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729286">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729301">if</span>&nbsp;<span class="ident" id="7729304">err</span>&nbsp;<span class="op" id="7729308">!=</span>&nbsp;<span class="builtintype" id="7729311">nil</span>&nbsp;<span class="op" id="7729315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729320">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729336">if</span>&nbsp;<span class="ident" id="7729339">tt</span><span class="op" id="7729341">.</span><span class="ident" id="7729342">WantWrite</span>&nbsp;<span class="op" id="7729352">!=</span>&nbsp;<span class="string" id="7729355">&#34;&#34;</span>&nbsp;<span class="op" id="7729358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729363">sraw</span>&nbsp;<span class="op" id="7729368">:=</span>&nbsp;<span class="ident" id="7729371">braw</span><span class="op" id="7729375">.</span><span class="ident" id="7729376">String</span><span class="op" id="7729382">(</span><span class="op" id="7729383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729388">if</span>&nbsp;<span class="ident" id="7729391">sraw</span>&nbsp;<span class="op" id="7729396">!=</span>&nbsp;<span class="ident" id="7729399">tt</span><span class="op" id="7729401">.</span><span class="ident" id="7729402">WantWrite</span>&nbsp;<span class="op" id="7729412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729418">t</span><span class="op" id="7729419">.</span><span class="ident" id="7729420">Errorf</span><span class="op" id="7729426">(</span><span class="string" id="7729427">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7729464">,</span>&nbsp;<span class="ident" id="7729466">i</span><span class="op" id="7729467">,</span>&nbsp;<span class="ident" id="7729469">tt</span><span class="op" id="7729471">.</span><span class="ident" id="7729472">WantWrite</span><span class="op" id="7729481">,</span>&nbsp;<span class="ident" id="7729483">sraw</span><span class="op" id="7729487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729493">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729514">if</span>&nbsp;<span class="ident" id="7729517">tt</span><span class="op" id="7729519">.</span><span class="ident" id="7729520">WantProxy</span>&nbsp;<span class="op" id="7729530">!=</span>&nbsp;<span class="string" id="7729533">&#34;&#34;</span>&nbsp;<span class="op" id="7729536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729541">setBody</span><span class="op" id="7729548">(</span><span class="op" id="7729549">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729554">var</span>&nbsp;<span class="ident" id="7729558">praw</span>&nbsp;<span class="ident" id="7729563">bytes</span><span class="op" id="7729568">.</span><span class="ident" id="7729569">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729579">err</span>&nbsp;<span class="op" id="7729583">=</span>&nbsp;<span class="ident" id="7729585">tt</span><span class="op" id="7729587">.</span><span class="ident" id="7729588">Req</span><span class="op" id="7729591">.</span><span class="ident" id="7729592">WriteProxy</span><span class="op" id="7729602">(</span><span class="op" id="7729603">&amp;</span><span class="ident" id="7729604">praw</span><span class="op" id="7729608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729613">if</span>&nbsp;<span class="ident" id="7729616">err</span>&nbsp;<span class="op" id="7729620">!=</span>&nbsp;<span class="builtintype" id="7729623">nil</span>&nbsp;<span class="op" id="7729627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729633">t</span><span class="op" id="7729634">.</span><span class="ident" id="7729635">Errorf</span><span class="op" id="7729641">(</span><span class="string" id="7729642">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7729662">,</span>&nbsp;<span class="ident" id="7729664">i</span><span class="op" id="7729665">,</span>&nbsp;<span class="ident" id="7729667">err</span><span class="op" id="7729670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729676">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729693">sraw</span>&nbsp;<span class="op" id="7729698">:=</span>&nbsp;<span class="ident" id="7729701">praw</span><span class="op" id="7729705">.</span><span class="ident" id="7729706">String</span><span class="op" id="7729712">(</span><span class="op" id="7729713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729718">if</span>&nbsp;<span class="ident" id="7729721">sraw</span>&nbsp;<span class="op" id="7729726">!=</span>&nbsp;<span class="ident" id="7729729">tt</span><span class="op" id="7729731">.</span><span class="ident" id="7729732">WantProxy</span>&nbsp;<span class="op" id="7729742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729748">t</span><span class="op" id="7729749">.</span><span class="ident" id="7729750">Errorf</span><span class="op" id="7729756">(</span><span class="string" id="7729757">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7729800">,</span>&nbsp;<span class="ident" id="7729802">i</span><span class="op" id="7729803">,</span>&nbsp;<span class="ident" id="7729805">tt</span><span class="op" id="7729807">.</span><span class="ident" id="7729808">WantProxy</span><span class="op" id="7729817">,</span>&nbsp;<span class="ident" id="7729819">sraw</span><span class="op" id="7729823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729829">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7729848">}</span><br>
<span class="lineno"></span><span class="op" id="7729850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7729853">type</span>&nbsp;<span class="ident" id="7729858">closeChecker</span>&nbsp;<span class="keyword" id="7729871">struct</span>&nbsp;<span class="op" id="7729878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729881">io</span><span class="op" id="7729883">.</span><span class="ident" id="7729884">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729892">closed</span>&nbsp;<span class="builtintype" id="7729899">bool</span><br>
<span class="lineno"></span><span class="op" id="7729904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="7729907">func</span>&nbsp;<span class="op" id="7729912">(</span><span class="ident" id="7729913">rc</span>&nbsp;<span class="op" id="7729916">*</span><span class="ident" id="7729917">closeChecker</span><span class="op" id="7729929">)</span>&nbsp;<span class="ident" id="7729931">Close</span><span class="op" id="7729936">(</span><span class="op" id="7729937">)</span>&nbsp;<span class="builtintype" id="7729939">error</span>&nbsp;<span class="op" id="7729945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7729948">rc</span><span class="op" id="7729950">.</span><span class="ident" id="7729951">closed</span>&nbsp;<span class="op" id="7729958">=</span>&nbsp;<span class="builtintype" id="7729960">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7729966">return</span>&nbsp;<span class="builtintype" id="7729973">nil</span><br>
<span class="lineno"></span><span class="op" id="7729977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="7729980">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="7730064">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="7730147">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="7730207">func</span>&nbsp;<span class="ident" id="7730212">TestRequestWriteClosesBody</span><span class="op" id="7730238">(</span><span class="ident" id="7730239">t</span>&nbsp;<span class="op" id="7730241">*</span><span class="ident" id="7730242">testing</span><span class="op" id="7730249">.</span><span class="ident" id="7730250">T</span><span class="op" id="7730251">)</span>&nbsp;<span class="op" id="7730253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730256">rc</span>&nbsp;<span class="op" id="7730259">:=</span>&nbsp;<span class="op" id="7730262">&amp;</span><span class="ident" id="7730263">closeChecker</span><span class="op" id="7730275">{</span><span class="ident" id="7730276">Reader</span><span class="op" id="7730282">:</span>&nbsp;<span class="ident" id="7730284">strings</span><span class="op" id="7730291">.</span><span class="ident" id="7730292">NewReader</span><span class="op" id="7730301">(</span><span class="string" id="7730302">&#34;my&nbsp;body&#34;</span><span class="op" id="7730311">)</span><span class="op" id="7730312">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730315">req</span><span class="op" id="7730318">,</span>&nbsp;<span class="ident" id="7730320">_</span>&nbsp;<span class="op" id="7730322">:=</span>&nbsp;<span class="ident" id="7730325">NewRequest</span><span class="op" id="7730335">(</span><span class="string" id="7730336">&#34;POST&#34;</span><span class="op" id="7730342">,</span>&nbsp;<span class="string" id="7730344">&#34;http://foo.com/&#34;</span><span class="op" id="7730361">,</span>&nbsp;<span class="ident" id="7730363">rc</span><span class="op" id="7730365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7730368">if</span>&nbsp;<span class="ident" id="7730371">req</span><span class="op" id="7730374">.</span><span class="ident" id="7730375">ContentLength</span>&nbsp;<span class="op" id="7730389">!=</span>&nbsp;<span class="num" id="7730392">0</span>&nbsp;<span class="op" id="7730394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730398">t</span><span class="op" id="7730399">.</span><span class="ident" id="7730400">Errorf</span><span class="op" id="7730406">(</span><span class="string" id="7730407">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7730441">,</span>&nbsp;<span class="ident" id="7730443">req</span><span class="op" id="7730446">.</span><span class="ident" id="7730447">ContentLength</span><span class="op" id="7730460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7730463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730466">buf</span>&nbsp;<span class="op" id="7730470">:=</span>&nbsp;<span class="builtinfunc" id="7730473">new</span><span class="op" id="7730476">(</span><span class="ident" id="7730477">bytes</span><span class="op" id="7730482">.</span><span class="ident" id="7730483">Buffer</span><span class="op" id="7730489">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730492">req</span><span class="op" id="7730495">.</span><span class="ident" id="7730496">Write</span><span class="op" id="7730501">(</span><span class="ident" id="7730502">buf</span><span class="op" id="7730505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7730508">if</span>&nbsp;<span class="op" id="7730511">!</span><span class="ident" id="7730512">rc</span><span class="op" id="7730514">.</span><span class="ident" id="7730515">closed</span>&nbsp;<span class="op" id="7730522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730526">t</span><span class="op" id="7730527">.</span><span class="ident" id="7730528">Error</span><span class="op" id="7730533">(</span><span class="string" id="7730534">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="7730563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7730566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730569">expected</span>&nbsp;<span class="op" id="7730578">:=</span>&nbsp;<span class="string" id="7730581">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7730603">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7730607">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="7730627">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7730631">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7730669">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7730673">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7730710">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7730714">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7730780">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7730850">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7730921">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730978">chunk</span><span class="op" id="7730983">(</span><span class="string" id="7730984">&#34;m&#34;</span><span class="op" id="7730987">)</span>&nbsp;<span class="op" id="7730989">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7730993">chunk</span><span class="op" id="7730998">(</span><span class="string" id="7730999">&#34;y&nbsp;body&#34;</span><span class="op" id="7731007">)</span>&nbsp;<span class="op" id="7731009">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731013">chunk</span><span class="op" id="7731018">(</span><span class="string" id="7731019">&#34;&#34;</span><span class="op" id="7731021">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7731024">if</span>&nbsp;<span class="ident" id="7731027">buf</span><span class="op" id="7731030">.</span><span class="ident" id="7731031">String</span><span class="op" id="7731037">(</span><span class="op" id="7731038">)</span>&nbsp;<span class="op" id="7731040">!=</span>&nbsp;<span class="ident" id="7731043">expected</span>&nbsp;<span class="op" id="7731052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731056">t</span><span class="op" id="7731057">.</span><span class="ident" id="7731058">Errorf</span><span class="op" id="7731064">(</span><span class="string" id="7731065">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7731093">,</span>&nbsp;<span class="ident" id="7731095">buf</span><span class="op" id="7731098">.</span><span class="ident" id="7731099">String</span><span class="op" id="7731105">(</span><span class="op" id="7731106">)</span><span class="op" id="7731107">,</span>&nbsp;<span class="ident" id="7731109">expected</span><span class="op" id="7731117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7731120">}</span><br>
<span class="lineno"></span><span class="op" id="7731122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="7731125">func</span>&nbsp;<span class="ident" id="7731130">chunk</span><span class="op" id="7731135">(</span><span class="ident" id="7731136">s</span>&nbsp;<span class="builtintype" id="7731138">string</span><span class="op" id="7731144">)</span>&nbsp;<span class="builtintype" id="7731146">string</span>&nbsp;<span class="op" id="7731153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7731156">return</span>&nbsp;<span class="ident" id="7731163">fmt</span><span class="op" id="7731166">.</span><span class="ident" id="7731167">Sprintf</span><span class="op" id="7731174">(</span><span class="string" id="7731175">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7731189">,</span>&nbsp;<span class="builtinfunc" id="7731191">len</span><span class="op" id="7731194">(</span><span class="ident" id="7731195">s</span><span class="op" id="7731196">)</span><span class="op" id="7731197">,</span>&nbsp;<span class="ident" id="7731199">s</span><span class="op" id="7731200">)</span><br>
<span class="lineno"></span><span class="op" id="7731202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7731205">func</span>&nbsp;<span class="ident" id="7731210">mustParseURL</span><span class="op" id="7731222">(</span><span class="ident" id="7731223">s</span>&nbsp;<span class="builtintype" id="7731225">string</span><span class="op" id="7731231">)</span>&nbsp;<span class="op" id="7731233">*</span><span class="ident" id="7731234">url</span><span class="op" id="7731237">.</span><span class="ident" id="7731238">URL</span>&nbsp;<span class="op" id="7731242">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731245">u</span><span class="op" id="7731246">,</span>&nbsp;<span class="ident" id="7731248">err</span>&nbsp;<span class="op" id="7731252">:=</span>&nbsp;<span class="ident" id="7731255">url</span><span class="op" id="7731258">.</span><span class="ident" id="7731259">Parse</span><span class="op" id="7731264">(</span><span class="ident" id="7731265">s</span><span class="op" id="7731266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7731269">if</span>&nbsp;<span class="ident" id="7731272">err</span>&nbsp;<span class="op" id="7731276">!=</span>&nbsp;<span class="builtintype" id="7731279">nil</span>&nbsp;<span class="op" id="7731283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7731287">panic</span><span class="op" id="7731292">(</span><span class="ident" id="7731293">fmt</span><span class="op" id="7731296">.</span><span class="ident" id="7731297">Sprintf</span><span class="op" id="7731304">(</span><span class="string" id="7731305">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7731331">,</span>&nbsp;<span class="ident" id="7731333">s</span><span class="op" id="7731334">,</span>&nbsp;<span class="ident" id="7731336">err</span><span class="op" id="7731339">)</span><span class="op" id="7731340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7731343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7731346">return</span>&nbsp;<span class="ident" id="7731353">u</span><br>
<span class="lineno">565</span><span class="op" id="7731355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7731358">type</span>&nbsp;<span class="ident" id="7731363">writerFunc</span>&nbsp;<span class="keyword" id="7731374">func</span><span class="op" id="7731378">(</span><span class="op" id="7731379">[</span><span class="op" id="7731380">]</span><span class="builtintype" id="7731381">byte</span><span class="op" id="7731385">)</span>&nbsp;<span class="op" id="7731387">(</span><span class="builtintype" id="7731388">int</span><span class="op" id="7731391">,</span>&nbsp;<span class="builtintype" id="7731393">error</span><span class="op" id="7731398">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7731401">func</span>&nbsp;<span class="op" id="7731406">(</span><span class="ident" id="7731407">f</span>&nbsp;<span class="ident" id="7731409">writerFunc</span><span class="op" id="7731419">)</span>&nbsp;<span class="ident" id="7731421">Write</span><span class="op" id="7731426">(</span><span class="ident" id="7731427">p</span>&nbsp;<span class="op" id="7731429">[</span><span class="op" id="7731430">]</span><span class="builtintype" id="7731431">byte</span><span class="op" id="7731435">)</span>&nbsp;<span class="op" id="7731437">(</span><span class="builtintype" id="7731438">int</span><span class="op" id="7731441">,</span>&nbsp;<span class="builtintype" id="7731443">error</span><span class="op" id="7731448">)</span>&nbsp;<span class="op" id="7731450">{</span>&nbsp;<span class="keyword" id="7731452">return</span>&nbsp;<span class="ident" id="7731459">f</span><span class="op" id="7731460">(</span><span class="ident" id="7731461">p</span><span class="op" id="7731462">)</span>&nbsp;<span class="op" id="7731464">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="7731467">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="7731547">func</span>&nbsp;<span class="ident" id="7731552">TestRequestWriteError</span><span class="op" id="7731573">(</span><span class="ident" id="7731574">t</span>&nbsp;<span class="op" id="7731576">*</span><span class="ident" id="7731577">testing</span><span class="op" id="7731584">.</span><span class="ident" id="7731585">T</span><span class="op" id="7731586">)</span>&nbsp;<span class="op" id="7731588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731591">failAfter</span><span class="op" id="7731600">,</span>&nbsp;<span class="ident" id="7731602">writeCount</span>&nbsp;<span class="op" id="7731613">:=</span>&nbsp;<span class="num" id="7731616">0</span><span class="op" id="7731617">,</span>&nbsp;<span class="num" id="7731619">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731622">errFail</span>&nbsp;<span class="op" id="7731630">:=</span>&nbsp;<span class="ident" id="7731633">errors</span><span class="op" id="7731639">.</span><span class="ident" id="7731640">New</span><span class="op" id="7731643">(</span><span class="string" id="7731644">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7731664">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7731668">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7731729">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7731792">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7731845">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731861">w</span>&nbsp;<span class="op" id="7731863">:=</span>&nbsp;<span class="keyword" id="7731866">struct</span>&nbsp;<span class="op" id="7731873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731877">io</span><span class="op" id="7731879">.</span><span class="ident" id="7731880">ByteWriter</span>&nbsp;<span class="comment" id="7731891">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731937">io</span><span class="op" id="7731939">.</span><span class="ident" id="7731940">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7731948">}</span><span class="op" id="7731949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7731953">nil</span><span class="op" id="7731956">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7731960">writerFunc</span><span class="op" id="7731970">(</span><span class="keyword" id="7731971">func</span><span class="op" id="7731975">(</span><span class="ident" id="7731976">p</span>&nbsp;<span class="op" id="7731978">[</span><span class="op" id="7731979">]</span><span class="builtintype" id="7731980">byte</span><span class="op" id="7731984">)</span>&nbsp;<span class="op" id="7731986">(</span><span class="ident" id="7731987">n</span>&nbsp;<span class="builtintype" id="7731989">int</span><span class="op" id="7731992">,</span>&nbsp;<span class="ident" id="7731994">err</span>&nbsp;<span class="builtintype" id="7731998">error</span><span class="op" id="7732003">)</span>&nbsp;<span class="op" id="7732005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732010">writeCount</span><span class="op" id="7732020">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732026">if</span>&nbsp;<span class="ident" id="7732029">failAfter</span>&nbsp;<span class="op" id="7732039">==</span>&nbsp;<span class="num" id="7732042">0</span>&nbsp;<span class="op" id="7732044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732050">err</span>&nbsp;<span class="op" id="7732054">=</span>&nbsp;<span class="ident" id="7732056">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732067">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732072">failAfter</span><span class="op" id="7732081">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732087">return</span>&nbsp;<span class="builtinfunc" id="7732094">len</span><span class="op" id="7732097">(</span><span class="ident" id="7732098">p</span><span class="op" id="7732099">)</span><span class="op" id="7732100">,</span>&nbsp;<span class="ident" id="7732102">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732108">}</span><span class="op" id="7732109">)</span><span class="op" id="7732110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732117">req</span><span class="op" id="7732120">,</span>&nbsp;<span class="ident" id="7732122">_</span>&nbsp;<span class="op" id="7732124">:=</span>&nbsp;<span class="ident" id="7732127">NewRequest</span><span class="op" id="7732137">(</span><span class="string" id="7732138">&#34;GET&#34;</span><span class="op" id="7732143">,</span>&nbsp;<span class="string" id="7732145">&#34;http://example.com/&#34;</span><span class="op" id="7732166">,</span>&nbsp;<span class="builtintype" id="7732168">nil</span><span class="op" id="7732171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732174">const</span>&nbsp;<span class="ident" id="7732180">writeCalls</span>&nbsp;<span class="op" id="7732191">=</span>&nbsp;<span class="num" id="7732193">4</span>&nbsp;<span class="comment" id="7732195">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732247">sawGood</span>&nbsp;<span class="op" id="7732255">:=</span>&nbsp;<span class="builtintype" id="7732258">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732265">for</span>&nbsp;<span class="ident" id="7732269">n</span>&nbsp;<span class="op" id="7732271">:=</span>&nbsp;<span class="num" id="7732274">0</span><span class="op" id="7732275">;</span>&nbsp;<span class="ident" id="7732277">n</span>&nbsp;<span class="op" id="7732279">&lt;=</span>&nbsp;<span class="ident" id="7732282">writeCalls</span><span class="op" id="7732292">+</span><span class="num" id="7732293">2</span><span class="op" id="7732294">;</span>&nbsp;<span class="ident" id="7732296">n</span><span class="op" id="7732297">++</span>&nbsp;<span class="op" id="7732300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732304">failAfter</span>&nbsp;<span class="op" id="7732314">=</span>&nbsp;<span class="ident" id="7732316">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732320">writeCount</span>&nbsp;<span class="op" id="7732331">=</span>&nbsp;<span class="num" id="7732333">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732337">err</span>&nbsp;<span class="op" id="7732341">:=</span>&nbsp;<span class="ident" id="7732344">req</span><span class="op" id="7732347">.</span><span class="ident" id="7732348">Write</span><span class="op" id="7732353">(</span><span class="ident" id="7732354">w</span><span class="op" id="7732355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732359">var</span>&nbsp;<span class="ident" id="7732363">wantErr</span>&nbsp;<span class="builtintype" id="7732371">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732379">if</span>&nbsp;<span class="ident" id="7732382">n</span>&nbsp;<span class="op" id="7732384">&lt;</span>&nbsp;<span class="ident" id="7732386">writeCalls</span>&nbsp;<span class="op" id="7732397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732402">wantErr</span>&nbsp;<span class="op" id="7732410">=</span>&nbsp;<span class="ident" id="7732412">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732426">if</span>&nbsp;<span class="ident" id="7732429">err</span>&nbsp;<span class="op" id="7732433">!=</span>&nbsp;<span class="ident" id="7732436">wantErr</span>&nbsp;<span class="op" id="7732444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732449">t</span><span class="op" id="7732450">.</span><span class="ident" id="7732451">Errorf</span><span class="op" id="7732457">(</span><span class="string" id="7732458">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7732503">,</span>&nbsp;<span class="ident" id="7732505">n</span><span class="op" id="7732506">,</span>&nbsp;<span class="ident" id="7732508">err</span><span class="op" id="7732511">,</span>&nbsp;<span class="ident" id="7732513">wantErr</span><span class="op" id="7732520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732536">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732540">if</span>&nbsp;<span class="ident" id="7732543">err</span>&nbsp;<span class="op" id="7732547">==</span>&nbsp;<span class="builtintype" id="7732550">nil</span>&nbsp;<span class="op" id="7732554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732559">sawGood</span>&nbsp;<span class="op" id="7732567">=</span>&nbsp;<span class="builtintype" id="7732569">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732577">if</span>&nbsp;<span class="ident" id="7732580">writeCount</span>&nbsp;<span class="op" id="7732591">!=</span>&nbsp;<span class="ident" id="7732594">writeCalls</span>&nbsp;<span class="op" id="7732605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732611">t</span><span class="op" id="7732612">.</span><span class="ident" id="7732613">Fatalf</span><span class="op" id="7732619">(</span><span class="string" id="7732620">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7732661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732666">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732674">if</span>&nbsp;<span class="ident" id="7732677">writeCount</span>&nbsp;<span class="op" id="7732688">&gt;</span>&nbsp;<span class="ident" id="7732690">writeCalls</span>&nbsp;<span class="op" id="7732701">||</span>&nbsp;<span class="ident" id="7732704">writeCount</span>&nbsp;<span class="op" id="7732715">&gt;</span>&nbsp;<span class="ident" id="7732717">n</span><span class="op" id="7732718">+</span><span class="num" id="7732719">1</span>&nbsp;<span class="op" id="7732721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732726">t</span><span class="op" id="7732727">.</span><span class="ident" id="7732728">Errorf</span><span class="op" id="7732734">(</span><span class="string" id="7732735">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="7732794">,</span>&nbsp;<span class="ident" id="7732796">n</span><span class="op" id="7732797">,</span>&nbsp;<span class="ident" id="7732799">writeCount</span><span class="op" id="7732809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732816">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7732819">if</span>&nbsp;<span class="op" id="7732822">!</span><span class="ident" id="7732823">sawGood</span>&nbsp;<span class="op" id="7732831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7732835">t</span><span class="op" id="7732836">.</span><span class="ident" id="7732837">Fatalf</span><span class="op" id="7732843">(</span><span class="string" id="7732844">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7732885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7732888">}</span><br>
<span class="lineno"></span><span class="op" id="7732890">}</span>
</div>
</body>
</html>
