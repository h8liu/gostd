<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5939317">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5939372">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5939426">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5939477">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5939553">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="5939574">package</span>&nbsp;<span class="ident" id="5939582">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5939589">import</span>&nbsp;<span class="op" id="5939596">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5939599">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5939608">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5939615">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5939628">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5939634">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5939644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5939647">var</span>&nbsp;<span class="op" id="5939651">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939654">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5939664">=</span>&nbsp;<span class="op" id="5939666">[</span><span class="op" id="5939667">]</span><span class="builtintype" id="5939668">byte</span><span class="op" id="5939672">(</span><span class="string" id="5939673">&#34;???&#34;</span><span class="op" id="5939678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939681">centerDot</span>&nbsp;<span class="op" id="5939691">=</span>&nbsp;<span class="op" id="5939693">[</span><span class="op" id="5939694">]</span><span class="builtintype" id="5939695">byte</span><span class="op" id="5939699">(</span><span class="string" id="5939700">&#34;·&#34;</span><span class="op" id="5939704">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939707">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5939717">=</span>&nbsp;<span class="op" id="5939719">[</span><span class="op" id="5939720">]</span><span class="builtintype" id="5939721">byte</span><span class="op" id="5939725">(</span><span class="string" id="5939726">&#34;.&#34;</span><span class="op" id="5939729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939732">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5939742">=</span>&nbsp;<span class="op" id="5939744">[</span><span class="op" id="5939745">]</span><span class="builtintype" id="5939746">byte</span><span class="op" id="5939750">(</span><span class="string" id="5939751">&#34;/&#34;</span><span class="op" id="5939754">)</span><br>
<span class="lineno"></span><span class="op" id="5939756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5939759">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="5939833">func</span>&nbsp;<span class="ident" id="5939838">PrintStack</span><span class="op" id="5939848">(</span><span class="op" id="5939849">)</span>&nbsp;<span class="op" id="5939851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5939854">os</span><span class="op" id="5939856">.</span><span class="ident" id="5939857">Stderr</span><span class="op" id="5939863">.</span><span class="ident" id="5939864">Write</span><span class="op" id="5939869">(</span><span class="ident" id="5939870">stack</span><span class="op" id="5939875">(</span><span class="op" id="5939876">)</span><span class="op" id="5939877">)</span><br>
<span class="lineno"></span><span class="op" id="5939879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5939882">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="5939955">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5940030">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5940102">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="5940164">//</span><br>
<span class="lineno"></span><span class="comment" id="5940167">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="5940236">func</span>&nbsp;<span class="ident" id="5940241">Stack</span><span class="op" id="5940246">(</span><span class="op" id="5940247">)</span>&nbsp;<span class="op" id="5940249">[</span><span class="op" id="5940250">]</span><span class="builtintype" id="5940251">byte</span>&nbsp;<span class="op" id="5940256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940259">return</span>&nbsp;<span class="ident" id="5940266">stack</span><span class="op" id="5940271">(</span><span class="op" id="5940272">)</span><br>
<span class="lineno"></span><span class="op" id="5940274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5940277">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="5940322">func</span>&nbsp;<span class="ident" id="5940327">stack</span><span class="op" id="5940332">(</span><span class="op" id="5940333">)</span>&nbsp;<span class="op" id="5940335">[</span><span class="op" id="5940336">]</span><span class="builtintype" id="5940337">byte</span>&nbsp;<span class="op" id="5940342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940345">buf</span>&nbsp;<span class="op" id="5940349">:=</span>&nbsp;<span class="builtinfunc" id="5940352">new</span><span class="op" id="5940355">(</span><span class="ident" id="5940356">bytes</span><span class="op" id="5940361">.</span><span class="ident" id="5940362">Buffer</span><span class="op" id="5940368">)</span>&nbsp;<span class="comment" id="5940370">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940392">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940474">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940491">var</span>&nbsp;<span class="ident" id="5940495">lines</span>&nbsp;<span class="op" id="5940501">[</span><span class="op" id="5940502">]</span><span class="op" id="5940503">[</span><span class="op" id="5940504">]</span><span class="builtintype" id="5940505">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940511">var</span>&nbsp;<span class="ident" id="5940515">lastFile</span>&nbsp;<span class="builtintype" id="5940524">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940532">for</span>&nbsp;<span class="ident" id="5940536">i</span>&nbsp;<span class="op" id="5940538">:=</span>&nbsp;<span class="num" id="5940541">2</span><span class="op" id="5940542">;</span>&nbsp;<span class="op" id="5940544">;</span>&nbsp;<span class="ident" id="5940546">i</span><span class="op" id="5940547">++</span>&nbsp;<span class="op" id="5940550">{</span>&nbsp;<span class="comment" id="5940552">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940603">pc</span><span class="op" id="5940605">,</span>&nbsp;<span class="ident" id="5940607">file</span><span class="op" id="5940611">,</span>&nbsp;<span class="ident" id="5940613">line</span><span class="op" id="5940617">,</span>&nbsp;<span class="ident" id="5940619">ok</span>&nbsp;<span class="op" id="5940622">:=</span>&nbsp;<span class="ident" id="5940625">runtime</span><span class="op" id="5940632">.</span><span class="ident" id="5940633">Caller</span><span class="op" id="5940639">(</span><span class="ident" id="5940640">i</span><span class="op" id="5940641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940645">if</span>&nbsp;<span class="op" id="5940648">!</span><span class="ident" id="5940649">ok</span>&nbsp;<span class="op" id="5940652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940657">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5940669">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940745">fmt</span><span class="op" id="5940748">.</span><span class="ident" id="5940749">Fprintf</span><span class="op" id="5940756">(</span><span class="ident" id="5940757">buf</span><span class="op" id="5940760">,</span>&nbsp;<span class="string" id="5940762">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="5940778">,</span>&nbsp;<span class="ident" id="5940780">file</span><span class="op" id="5940784">,</span>&nbsp;<span class="ident" id="5940786">line</span><span class="op" id="5940790">,</span>&nbsp;<span class="ident" id="5940792">pc</span><span class="op" id="5940794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940798">if</span>&nbsp;<span class="ident" id="5940801">file</span>&nbsp;<span class="op" id="5940806">!=</span>&nbsp;<span class="ident" id="5940809">lastFile</span>&nbsp;<span class="op" id="5940818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940823">data</span><span class="op" id="5940827">,</span>&nbsp;<span class="ident" id="5940829">err</span>&nbsp;<span class="op" id="5940833">:=</span>&nbsp;<span class="ident" id="5940836">ioutil</span><span class="op" id="5940842">.</span><span class="ident" id="5940843">ReadFile</span><span class="op" id="5940851">(</span><span class="ident" id="5940852">file</span><span class="op" id="5940856">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940861">if</span>&nbsp;<span class="ident" id="5940864">err</span>&nbsp;<span class="op" id="5940868">!=</span>&nbsp;<span class="ident" id="5940871">nil</span>&nbsp;<span class="op" id="5940875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5940881">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940898">lines</span>&nbsp;<span class="op" id="5940904">=</span>&nbsp;<span class="ident" id="5940906">bytes</span><span class="op" id="5940911">.</span><span class="ident" id="5940912">Split</span><span class="op" id="5940917">(</span><span class="ident" id="5940918">data</span><span class="op" id="5940922">,</span>&nbsp;<span class="op" id="5940924">[</span><span class="op" id="5940925">]</span><span class="builtintype" id="5940926">byte</span><span class="op" id="5940930">{</span><span class="string" id="5940931">&#39;\n&#39;</span><span class="op" id="5940935">}</span><span class="op" id="5940936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940941">lastFile</span>&nbsp;<span class="op" id="5940950">=</span>&nbsp;<span class="ident" id="5940952">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5940959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5940963">line</span><span class="op" id="5940967">--</span>&nbsp;<span class="comment" id="5940970">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941038">fmt</span><span class="op" id="5941041">.</span><span class="ident" id="5941042">Fprintf</span><span class="op" id="5941049">(</span><span class="ident" id="5941050">buf</span><span class="op" id="5941053">,</span>&nbsp;<span class="string" id="5941055">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="5941067">,</span>&nbsp;<span class="ident" id="5941069">function</span><span class="op" id="5941077">(</span><span class="ident" id="5941078">pc</span><span class="op" id="5941080">)</span><span class="op" id="5941081">,</span>&nbsp;<span class="ident" id="5941083">source</span><span class="op" id="5941089">(</span><span class="ident" id="5941090">lines</span><span class="op" id="5941095">,</span>&nbsp;<span class="ident" id="5941097">line</span><span class="op" id="5941101">)</span><span class="op" id="5941102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941108">return</span>&nbsp;<span class="ident" id="5941115">buf</span><span class="op" id="5941118">.</span><span class="ident" id="5941119">Bytes</span><span class="op" id="5941124">(</span><span class="op" id="5941125">)</span><br>
<span class="lineno">65</span><span class="op" id="5941127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5941130">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="5941188">func</span>&nbsp;<span class="ident" id="5941193">source</span><span class="op" id="5941199">(</span><span class="ident" id="5941200">lines</span>&nbsp;<span class="op" id="5941206">[</span><span class="op" id="5941207">]</span><span class="op" id="5941208">[</span><span class="op" id="5941209">]</span><span class="builtintype" id="5941210">byte</span><span class="op" id="5941214">,</span>&nbsp;<span class="ident" id="5941216">n</span>&nbsp;<span class="builtintype" id="5941218">int</span><span class="op" id="5941221">)</span>&nbsp;<span class="op" id="5941223">[</span><span class="op" id="5941224">]</span><span class="builtintype" id="5941225">byte</span>&nbsp;<span class="op" id="5941230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941233">if</span>&nbsp;<span class="ident" id="5941236">n</span>&nbsp;<span class="op" id="5941238">&lt;</span>&nbsp;<span class="num" id="5941240">0</span>&nbsp;<span class="op" id="5941242">||</span>&nbsp;<span class="ident" id="5941245">n</span>&nbsp;<span class="op" id="5941247">&gt;=</span>&nbsp;<span class="builtinfunc" id="5941250">len</span><span class="op" id="5941253">(</span><span class="ident" id="5941254">lines</span><span class="op" id="5941259">)</span>&nbsp;<span class="op" id="5941261">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941265">return</span>&nbsp;<span class="ident" id="5941272">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941282">return</span>&nbsp;<span class="ident" id="5941289">bytes</span><span class="op" id="5941294">.</span><span class="ident" id="5941295">Trim</span><span class="op" id="5941299">(</span><span class="ident" id="5941300">lines</span><span class="op" id="5941305">[</span><span class="ident" id="5941306">n</span><span class="op" id="5941307">]</span><span class="op" id="5941308">,</span>&nbsp;<span class="string" id="5941310">&#34;&nbsp;\t&#34;</span><span class="op" id="5941315">)</span><br>
<span class="lineno"></span><span class="op" id="5941317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5941320">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="5941398">func</span>&nbsp;<span class="ident" id="5941403">function</span><span class="op" id="5941411">(</span><span class="ident" id="5941412">pc</span>&nbsp;<span class="builtintype" id="5941415">uintptr</span><span class="op" id="5941422">)</span>&nbsp;<span class="op" id="5941424">[</span><span class="op" id="5941425">]</span><span class="builtintype" id="5941426">byte</span>&nbsp;<span class="op" id="5941431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941434">fn</span>&nbsp;<span class="op" id="5941437">:=</span>&nbsp;<span class="ident" id="5941440">runtime</span><span class="op" id="5941447">.</span><span class="ident" id="5941448">FuncForPC</span><span class="op" id="5941457">(</span><span class="ident" id="5941458">pc</span><span class="op" id="5941460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941463">if</span>&nbsp;<span class="ident" id="5941466">fn</span>&nbsp;<span class="op" id="5941469">==</span>&nbsp;<span class="ident" id="5941472">nil</span>&nbsp;<span class="op" id="5941476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941480">return</span>&nbsp;<span class="ident" id="5941487">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941497">name</span>&nbsp;<span class="op" id="5941502">:=</span>&nbsp;<span class="op" id="5941505">[</span><span class="op" id="5941506">]</span><span class="builtintype" id="5941507">byte</span><span class="op" id="5941511">(</span><span class="ident" id="5941512">fn</span><span class="op" id="5941514">.</span><span class="ident" id="5941515">Name</span><span class="op" id="5941519">(</span><span class="op" id="5941520">)</span><span class="op" id="5941521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941524">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941597">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941669">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941689">//&nbsp;&nbsp;&nbsp;&nbspruntime/debug.*T·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941721">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941734">//&nbsp;&nbsp;&nbsp;&nbsp*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941751">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5941826">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941879">if</span>&nbsp;<span class="ident" id="5941882">lastslash</span>&nbsp;<span class="op" id="5941892">:=</span>&nbsp;<span class="ident" id="5941895">bytes</span><span class="op" id="5941900">.</span><span class="ident" id="5941901">LastIndex</span><span class="op" id="5941910">(</span><span class="ident" id="5941911">name</span><span class="op" id="5941915">,</span>&nbsp;<span class="ident" id="5941917">slash</span><span class="op" id="5941922">)</span><span class="op" id="5941923">;</span>&nbsp;<span class="ident" id="5941925">lastslash</span>&nbsp;<span class="op" id="5941935">&gt;=</span>&nbsp;<span class="num" id="5941938">0</span>&nbsp;<span class="op" id="5941940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5941944">name</span>&nbsp;<span class="op" id="5941949">=</span>&nbsp;<span class="ident" id="5941951">name</span><span class="op" id="5941955">[</span><span class="ident" id="5941956">lastslash</span><span class="op" id="5941965">+</span><span class="num" id="5941966">1</span><span class="op" id="5941967">:</span><span class="op" id="5941968">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5941971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5941974">if</span>&nbsp;<span class="ident" id="5941977">period</span>&nbsp;<span class="op" id="5941984">:=</span>&nbsp;<span class="ident" id="5941987">bytes</span><span class="op" id="5941992">.</span><span class="ident" id="5941993">Index</span><span class="op" id="5941998">(</span><span class="ident" id="5941999">name</span><span class="op" id="5942003">,</span>&nbsp;<span class="ident" id="5942005">dot</span><span class="op" id="5942008">)</span><span class="op" id="5942009">;</span>&nbsp;<span class="ident" id="5942011">period</span>&nbsp;<span class="op" id="5942018">&gt;=</span>&nbsp;<span class="num" id="5942021">0</span>&nbsp;<span class="op" id="5942023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942027">name</span>&nbsp;<span class="op" id="5942032">=</span>&nbsp;<span class="ident" id="5942034">name</span><span class="op" id="5942038">[</span><span class="ident" id="5942039">period</span><span class="op" id="5942045">+</span><span class="num" id="5942046">1</span><span class="op" id="5942047">:</span><span class="op" id="5942048">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5942051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5942054">name</span>&nbsp;<span class="op" id="5942059">=</span>&nbsp;<span class="ident" id="5942061">bytes</span><span class="op" id="5942066">.</span><span class="ident" id="5942067">Replace</span><span class="op" id="5942074">(</span><span class="ident" id="5942075">name</span><span class="op" id="5942079">,</span>&nbsp;<span class="ident" id="5942081">centerDot</span><span class="op" id="5942090">,</span>&nbsp;<span class="ident" id="5942092">dot</span><span class="op" id="5942095">,</span>&nbsp;<span class="op" id="5942097">-</span><span class="num" id="5942098">1</span><span class="op" id="5942099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5942102">return</span>&nbsp;<span class="ident" id="5942109">name</span><br>
<span class="lineno"></span><span class="op" id="5942114">}</span>
</div>
</body>
</html>
