<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8296963">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8297019">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8297073">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8297124">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="8297203">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8297212">package</span>&nbsp;<span class="ident" id="8297220">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="8297225">import</span>&nbsp;<span class="op" id="8297232">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8297235">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8297241">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8297252">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8297263">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8297274">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8297281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8297284">func</span>&nbsp;<span class="ident" id="8297289">packetConnTestData</span><span class="op" id="8297307">(</span><span class="ident" id="8297308">t</span>&nbsp;<span class="op" id="8297310">*</span><span class="ident" id="8297311">testing</span><span class="op" id="8297318">.</span><span class="ident" id="8297319">T</span><span class="op" id="8297320">,</span>&nbsp;<span class="ident" id="8297322">net</span>&nbsp;<span class="builtintype" id="8297326">string</span><span class="op" id="8297332">,</span>&nbsp;<span class="ident" id="8297334">i</span>&nbsp;<span class="builtintype" id="8297336">int</span><span class="op" id="8297339">)</span>&nbsp;<span class="op" id="8297341">(</span><span class="op" id="8297342">[</span><span class="op" id="8297343">]</span><span class="builtintype" id="8297344">byte</span><span class="op" id="8297348">,</span>&nbsp;<span class="keyword" id="8297350">func</span><span class="op" id="8297354">(</span><span class="op" id="8297355">)</span><span class="op" id="8297356">)</span>&nbsp;<span class="op" id="8297358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297361">switch</span>&nbsp;<span class="ident" id="8297368">net</span>&nbsp;<span class="op" id="8297372">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297375">case</span>&nbsp;<span class="string" id="8297380">&#34;udp&#34;</span><span class="op" id="8297385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297389">return</span>&nbsp;<span class="op" id="8297396">[</span><span class="op" id="8297397">]</span><span class="builtintype" id="8297398">byte</span><span class="op" id="8297402">(</span><span class="string" id="8297403">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8297424">)</span><span class="op" id="8297425">,</span>&nbsp;<span class="ident" id="8297427">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297432">case</span>&nbsp;<span class="string" id="8297437">&#34;ip&#34;</span><span class="op" id="8297441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297445">if</span>&nbsp;<span class="ident" id="8297448">skip</span><span class="op" id="8297452">,</span>&nbsp;<span class="ident" id="8297454">skipmsg</span>&nbsp;<span class="op" id="8297462">:=</span>&nbsp;<span class="ident" id="8297465">skipRawSocketTest</span><span class="op" id="8297482">(</span><span class="ident" id="8297483">t</span><span class="op" id="8297484">)</span><span class="op" id="8297485">;</span>&nbsp;<span class="ident" id="8297487">skip</span>&nbsp;<span class="op" id="8297492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297497">return</span>&nbsp;<span class="ident" id="8297504">nil</span><span class="op" id="8297507">,</span>&nbsp;<span class="keyword" id="8297509">func</span><span class="op" id="8297513">(</span><span class="op" id="8297514">)</span>&nbsp;<span class="op" id="8297516">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297522">t</span><span class="op" id="8297523">.</span><span class="ident" id="8297524">Logf</span><span class="op" id="8297528">(</span><span class="ident" id="8297529">skipmsg</span><span class="op" id="8297536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8297541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8297545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297549">b</span><span class="op" id="8297550">,</span>&nbsp;<span class="ident" id="8297552">err</span>&nbsp;<span class="op" id="8297556">:=</span>&nbsp;<span class="op" id="8297559">(</span><span class="op" id="8297560">&amp;</span><span class="ident" id="8297561">icmpMessage</span><span class="op" id="8297572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297577">Type</span><span class="op" id="8297581">:</span>&nbsp;<span class="ident" id="8297583">icmpv4EchoRequest</span><span class="op" id="8297600">,</span>&nbsp;<span class="ident" id="8297602">Code</span><span class="op" id="8297606">:</span>&nbsp;<span class="num" id="8297608">0</span><span class="op" id="8297609">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297614">Body</span><span class="op" id="8297618">:</span>&nbsp;<span class="op" id="8297620">&amp;</span><span class="ident" id="8297621">icmpEcho</span><span class="op" id="8297629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297635">ID</span><span class="op" id="8297637">:</span>&nbsp;<span class="ident" id="8297639">os</span><span class="op" id="8297641">.</span><span class="ident" id="8297642">Getpid</span><span class="op" id="8297648">(</span><span class="op" id="8297649">)</span>&nbsp;<span class="op" id="8297651">&amp;</span>&nbsp;<span class="num" id="8297653">0xffff</span><span class="op" id="8297659">,</span>&nbsp;<span class="ident" id="8297661">Seq</span><span class="op" id="8297664">:</span>&nbsp;<span class="ident" id="8297666">i</span>&nbsp;<span class="op" id="8297668">+</span>&nbsp;<span class="num" id="8297670">1</span><span class="op" id="8297671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297677">Data</span><span class="op" id="8297681">:</span>&nbsp;<span class="op" id="8297683">[</span><span class="op" id="8297684">]</span><span class="builtintype" id="8297685">byte</span><span class="op" id="8297689">(</span><span class="string" id="8297690">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8297710">)</span><span class="op" id="8297711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8297716">}</span><span class="op" id="8297717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8297721">}</span><span class="op" id="8297722">)</span><span class="op" id="8297723">.</span><span class="ident" id="8297724">Marshal</span><span class="op" id="8297731">(</span><span class="op" id="8297732">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297736">if</span>&nbsp;<span class="ident" id="8297739">err</span>&nbsp;<span class="op" id="8297743">!=</span>&nbsp;<span class="ident" id="8297746">nil</span>&nbsp;<span class="op" id="8297750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297755">return</span>&nbsp;<span class="ident" id="8297762">nil</span><span class="op" id="8297765">,</span>&nbsp;<span class="keyword" id="8297767">func</span><span class="op" id="8297771">(</span><span class="op" id="8297772">)</span>&nbsp;<span class="op" id="8297774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297780">t</span><span class="op" id="8297781">.</span><span class="ident" id="8297782">Fatalf</span><span class="op" id="8297788">(</span><span class="string" id="8297789">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8297821">,</span>&nbsp;<span class="ident" id="8297823">err</span><span class="op" id="8297826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8297831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8297835">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297839">return</span>&nbsp;<span class="ident" id="8297846">b</span><span class="op" id="8297847">,</span>&nbsp;<span class="ident" id="8297849">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297854">case</span>&nbsp;<span class="string" id="8297859">&#34;unixgram&#34;</span><span class="op" id="8297869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297873">switch</span>&nbsp;<span class="ident" id="8297880">runtime</span><span class="op" id="8297887">.</span><span class="ident" id="8297888">GOOS</span>&nbsp;<span class="op" id="8297893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297897">case</span>&nbsp;<span class="string" id="8297902">&#34;nacl&#34;</span><span class="op" id="8297908">,</span>&nbsp;<span class="string" id="8297910">&#34;plan9&#34;</span><span class="op" id="8297917">,</span>&nbsp;<span class="string" id="8297919">&#34;windows&#34;</span><span class="op" id="8297928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8297933">return</span>&nbsp;<span class="ident" id="8297940">nil</span><span class="op" id="8297943">,</span>&nbsp;<span class="keyword" id="8297945">func</span><span class="op" id="8297949">(</span><span class="op" id="8297950">)</span>&nbsp;<span class="op" id="8297952">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8297958">t</span><span class="op" id="8297959">.</span><span class="ident" id="8297960">Logf</span><span class="op" id="8297964">(</span><span class="string" id="8297965">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8297989">,</span>&nbsp;<span class="ident" id="8297991">net</span><span class="op" id="8297994">,</span>&nbsp;<span class="ident" id="8297996">runtime</span><span class="op" id="8298003">.</span><span class="ident" id="8298004">GOOS</span><span class="op" id="8298008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298017">default</span><span class="op" id="8298024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298029">return</span>&nbsp;<span class="op" id="8298036">[</span><span class="op" id="8298037">]</span><span class="builtintype" id="8298038">byte</span><span class="op" id="8298042">(</span><span class="string" id="8298043">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="8298069">)</span><span class="op" id="8298070">,</span>&nbsp;<span class="ident" id="8298072">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298078">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298081">default</span><span class="op" id="8298088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298092">return</span>&nbsp;<span class="ident" id="8298099">nil</span><span class="op" id="8298102">,</span>&nbsp;<span class="keyword" id="8298104">func</span><span class="op" id="8298108">(</span><span class="op" id="8298109">)</span>&nbsp;<span class="op" id="8298111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298116">t</span><span class="op" id="8298117">.</span><span class="ident" id="8298118">Logf</span><span class="op" id="8298122">(</span><span class="string" id="8298123">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="8298141">,</span>&nbsp;<span class="ident" id="8298143">net</span><span class="op" id="8298146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298153">}</span><br>
<span class="lineno">55</span><span class="op" id="8298155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8298158">var</span>&nbsp;<span class="ident" id="8298162">packetConnTests</span>&nbsp;<span class="op" id="8298178">=</span>&nbsp;<span class="op" id="8298180">[</span><span class="op" id="8298181">]</span><span class="keyword" id="8298182">struct</span>&nbsp;<span class="op" id="8298189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298192">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8298198">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298206">addr1</span>&nbsp;<span class="builtintype" id="8298212">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298220">addr2</span>&nbsp;<span class="builtintype" id="8298226">string</span><br>
<span class="lineno"></span><span class="op" id="8298233">}</span><span class="op" id="8298234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298237">{</span><span class="string" id="8298238">&#34;udp&#34;</span><span class="op" id="8298243">,</span>&nbsp;<span class="string" id="8298245">&#34;127.0.0.1:0&#34;</span><span class="op" id="8298258">,</span>&nbsp;<span class="string" id="8298260">&#34;127.0.0.1:0&#34;</span><span class="op" id="8298273">}</span><span class="op" id="8298274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298277">{</span><span class="string" id="8298278">&#34;ip:icmp&#34;</span><span class="op" id="8298287">,</span>&nbsp;<span class="string" id="8298289">&#34;127.0.0.1&#34;</span><span class="op" id="8298300">,</span>&nbsp;<span class="string" id="8298302">&#34;127.0.0.1&#34;</span><span class="op" id="8298313">}</span><span class="op" id="8298314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298317">{</span><span class="string" id="8298318">&#34;unixgram&#34;</span><span class="op" id="8298328">,</span>&nbsp;<span class="ident" id="8298330">testUnixAddr</span><span class="op" id="8298342">(</span><span class="op" id="8298343">)</span><span class="op" id="8298344">,</span>&nbsp;<span class="ident" id="8298346">testUnixAddr</span><span class="op" id="8298358">(</span><span class="op" id="8298359">)</span><span class="op" id="8298360">}</span><span class="op" id="8298361">,</span><br>
<span class="lineno">65</span><span class="op" id="8298363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8298366">func</span>&nbsp;<span class="ident" id="8298371">TestPacketConn</span><span class="op" id="8298385">(</span><span class="ident" id="8298386">t</span>&nbsp;<span class="op" id="8298388">*</span><span class="ident" id="8298389">testing</span><span class="op" id="8298396">.</span><span class="ident" id="8298397">T</span><span class="op" id="8298398">)</span>&nbsp;<span class="op" id="8298400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298403">closer</span>&nbsp;<span class="op" id="8298410">:=</span>&nbsp;<span class="keyword" id="8298413">func</span><span class="op" id="8298417">(</span><span class="ident" id="8298418">c</span>&nbsp;<span class="ident" id="8298420">PacketConn</span><span class="op" id="8298430">,</span>&nbsp;<span class="ident" id="8298432">net</span><span class="op" id="8298435">,</span>&nbsp;<span class="ident" id="8298437">addr1</span><span class="op" id="8298442">,</span>&nbsp;<span class="ident" id="8298444">addr2</span>&nbsp;<span class="builtintype" id="8298450">string</span><span class="op" id="8298456">)</span>&nbsp;<span class="op" id="8298458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298462">c</span><span class="op" id="8298463">.</span><span class="ident" id="8298464">Close</span><span class="op" id="8298469">(</span><span class="op" id="8298470">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298474">switch</span>&nbsp;<span class="ident" id="8298481">net</span>&nbsp;<span class="op" id="8298485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298489">case</span>&nbsp;<span class="string" id="8298494">&#34;unixgram&#34;</span><span class="op" id="8298504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298509">os</span><span class="op" id="8298511">.</span><span class="ident" id="8298512">Remove</span><span class="op" id="8298518">(</span><span class="ident" id="8298519">addr1</span><span class="op" id="8298524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298529">os</span><span class="op" id="8298531">.</span><span class="ident" id="8298532">Remove</span><span class="op" id="8298538">(</span><span class="ident" id="8298539">addr2</span><span class="op" id="8298544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298548">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298555">for</span>&nbsp;<span class="ident" id="8298559">i</span><span class="op" id="8298560">,</span>&nbsp;<span class="ident" id="8298562">tt</span>&nbsp;<span class="op" id="8298565">:=</span>&nbsp;<span class="keyword" id="8298568">range</span>&nbsp;<span class="ident" id="8298574">packetConnTests</span>&nbsp;<span class="op" id="8298590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298594">netstr</span>&nbsp;<span class="op" id="8298601">:=</span>&nbsp;<span class="ident" id="8298604">strings</span><span class="op" id="8298611">.</span><span class="ident" id="8298612">Split</span><span class="op" id="8298617">(</span><span class="ident" id="8298618">tt</span><span class="op" id="8298620">.</span><span class="ident" id="8298621">net</span><span class="op" id="8298624">,</span>&nbsp;<span class="string" id="8298626">&#34;:&#34;</span><span class="op" id="8298629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298633">wb</span><span class="op" id="8298635">,</span>&nbsp;<span class="ident" id="8298637">skipOrFatalFn</span>&nbsp;<span class="op" id="8298651">:=</span>&nbsp;<span class="ident" id="8298654">packetConnTestData</span><span class="op" id="8298672">(</span><span class="ident" id="8298673">t</span><span class="op" id="8298674">,</span>&nbsp;<span class="ident" id="8298676">netstr</span><span class="op" id="8298682">[</span><span class="num" id="8298683">0</span><span class="op" id="8298684">]</span><span class="op" id="8298685">,</span>&nbsp;<span class="ident" id="8298687">i</span><span class="op" id="8298688">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298692">if</span>&nbsp;<span class="ident" id="8298695">skipOrFatalFn</span>&nbsp;<span class="op" id="8298709">!=</span>&nbsp;<span class="ident" id="8298712">nil</span>&nbsp;<span class="op" id="8298716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298721">skipOrFatalFn</span><span class="op" id="8298734">(</span><span class="op" id="8298735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298740">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298756">c1</span><span class="op" id="8298758">,</span>&nbsp;<span class="ident" id="8298760">err</span>&nbsp;<span class="op" id="8298764">:=</span>&nbsp;<span class="ident" id="8298767">ListenPacket</span><span class="op" id="8298779">(</span><span class="ident" id="8298780">tt</span><span class="op" id="8298782">.</span><span class="ident" id="8298783">net</span><span class="op" id="8298786">,</span>&nbsp;<span class="ident" id="8298788">tt</span><span class="op" id="8298790">.</span><span class="ident" id="8298791">addr1</span><span class="op" id="8298796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298800">if</span>&nbsp;<span class="ident" id="8298803">err</span>&nbsp;<span class="op" id="8298807">!=</span>&nbsp;<span class="ident" id="8298810">nil</span>&nbsp;<span class="op" id="8298814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298819">t</span><span class="op" id="8298820">.</span><span class="ident" id="8298821">Fatalf</span><span class="op" id="8298827">(</span><span class="string" id="8298828">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8298853">,</span>&nbsp;<span class="ident" id="8298855">err</span><span class="op" id="8298858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8298862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8298866">defer</span>&nbsp;<span class="ident" id="8298872">closer</span><span class="op" id="8298878">(</span><span class="ident" id="8298879">c1</span><span class="op" id="8298881">,</span>&nbsp;<span class="ident" id="8298883">netstr</span><span class="op" id="8298889">[</span><span class="num" id="8298890">0</span><span class="op" id="8298891">]</span><span class="op" id="8298892">,</span>&nbsp;<span class="ident" id="8298894">tt</span><span class="op" id="8298896">.</span><span class="ident" id="8298897">addr1</span><span class="op" id="8298902">,</span>&nbsp;<span class="ident" id="8298904">tt</span><span class="op" id="8298906">.</span><span class="ident" id="8298907">addr2</span><span class="op" id="8298912">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298916">c1</span><span class="op" id="8298918">.</span><span class="ident" id="8298919">LocalAddr</span><span class="op" id="8298928">(</span><span class="op" id="8298929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298933">c1</span><span class="op" id="8298935">.</span><span class="ident" id="8298936">SetDeadline</span><span class="op" id="8298947">(</span><span class="ident" id="8298948">time</span><span class="op" id="8298952">.</span><span class="ident" id="8298953">Now</span><span class="op" id="8298956">(</span><span class="op" id="8298957">)</span><span class="op" id="8298958">.</span><span class="ident" id="8298959">Add</span><span class="op" id="8298962">(</span><span class="num" id="8298963">100</span>&nbsp;<span class="op" id="8298967">*</span>&nbsp;<span class="ident" id="8298969">time</span><span class="op" id="8298973">.</span><span class="ident" id="8298974">Millisecond</span><span class="op" id="8298985">)</span><span class="op" id="8298986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8298990">c1</span><span class="op" id="8298992">.</span><span class="ident" id="8298993">SetReadDeadline</span><span class="op" id="8299008">(</span><span class="ident" id="8299009">time</span><span class="op" id="8299013">.</span><span class="ident" id="8299014">Now</span><span class="op" id="8299017">(</span><span class="op" id="8299018">)</span><span class="op" id="8299019">.</span><span class="ident" id="8299020">Add</span><span class="op" id="8299023">(</span><span class="num" id="8299024">100</span>&nbsp;<span class="op" id="8299028">*</span>&nbsp;<span class="ident" id="8299030">time</span><span class="op" id="8299034">.</span><span class="ident" id="8299035">Millisecond</span><span class="op" id="8299046">)</span><span class="op" id="8299047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299051">c1</span><span class="op" id="8299053">.</span><span class="ident" id="8299054">SetWriteDeadline</span><span class="op" id="8299070">(</span><span class="ident" id="8299071">time</span><span class="op" id="8299075">.</span><span class="ident" id="8299076">Now</span><span class="op" id="8299079">(</span><span class="op" id="8299080">)</span><span class="op" id="8299081">.</span><span class="ident" id="8299082">Add</span><span class="op" id="8299085">(</span><span class="num" id="8299086">100</span>&nbsp;<span class="op" id="8299090">*</span>&nbsp;<span class="ident" id="8299092">time</span><span class="op" id="8299096">.</span><span class="ident" id="8299097">Millisecond</span><span class="op" id="8299108">)</span><span class="op" id="8299109">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299114">c2</span><span class="op" id="8299116">,</span>&nbsp;<span class="ident" id="8299118">err</span>&nbsp;<span class="op" id="8299122">:=</span>&nbsp;<span class="ident" id="8299125">ListenPacket</span><span class="op" id="8299137">(</span><span class="ident" id="8299138">tt</span><span class="op" id="8299140">.</span><span class="ident" id="8299141">net</span><span class="op" id="8299144">,</span>&nbsp;<span class="ident" id="8299146">tt</span><span class="op" id="8299148">.</span><span class="ident" id="8299149">addr2</span><span class="op" id="8299154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8299158">if</span>&nbsp;<span class="ident" id="8299161">err</span>&nbsp;<span class="op" id="8299165">!=</span>&nbsp;<span class="ident" id="8299168">nil</span>&nbsp;<span class="op" id="8299172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299177">t</span><span class="op" id="8299178">.</span><span class="ident" id="8299179">Fatalf</span><span class="op" id="8299185">(</span><span class="string" id="8299186">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8299211">,</span>&nbsp;<span class="ident" id="8299213">err</span><span class="op" id="8299216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8299220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8299224">defer</span>&nbsp;<span class="ident" id="8299230">closer</span><span class="op" id="8299236">(</span><span class="ident" id="8299237">c2</span><span class="op" id="8299239">,</span>&nbsp;<span class="ident" id="8299241">netstr</span><span class="op" id="8299247">[</span><span class="num" id="8299248">0</span><span class="op" id="8299249">]</span><span class="op" id="8299250">,</span>&nbsp;<span class="ident" id="8299252">tt</span><span class="op" id="8299254">.</span><span class="ident" id="8299255">addr1</span><span class="op" id="8299260">,</span>&nbsp;<span class="ident" id="8299262">tt</span><span class="op" id="8299264">.</span><span class="ident" id="8299265">addr2</span><span class="op" id="8299270">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299274">c2</span><span class="op" id="8299276">.</span><span class="ident" id="8299277">LocalAddr</span><span class="op" id="8299286">(</span><span class="op" id="8299287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299291">c2</span><span class="op" id="8299293">.</span><span class="ident" id="8299294">SetDeadline</span><span class="op" id="8299305">(</span><span class="ident" id="8299306">time</span><span class="op" id="8299310">.</span><span class="ident" id="8299311">Now</span><span class="op" id="8299314">(</span><span class="op" id="8299315">)</span><span class="op" id="8299316">.</span><span class="ident" id="8299317">Add</span><span class="op" id="8299320">(</span><span class="num" id="8299321">100</span>&nbsp;<span class="op" id="8299325">*</span>&nbsp;<span class="ident" id="8299327">time</span><span class="op" id="8299331">.</span><span class="ident" id="8299332">Millisecond</span><span class="op" id="8299343">)</span><span class="op" id="8299344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299348">c2</span><span class="op" id="8299350">.</span><span class="ident" id="8299351">SetReadDeadline</span><span class="op" id="8299366">(</span><span class="ident" id="8299367">time</span><span class="op" id="8299371">.</span><span class="ident" id="8299372">Now</span><span class="op" id="8299375">(</span><span class="op" id="8299376">)</span><span class="op" id="8299377">.</span><span class="ident" id="8299378">Add</span><span class="op" id="8299381">(</span><span class="num" id="8299382">100</span>&nbsp;<span class="op" id="8299386">*</span>&nbsp;<span class="ident" id="8299388">time</span><span class="op" id="8299392">.</span><span class="ident" id="8299393">Millisecond</span><span class="op" id="8299404">)</span><span class="op" id="8299405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299409">c2</span><span class="op" id="8299411">.</span><span class="ident" id="8299412">SetWriteDeadline</span><span class="op" id="8299428">(</span><span class="ident" id="8299429">time</span><span class="op" id="8299433">.</span><span class="ident" id="8299434">Now</span><span class="op" id="8299437">(</span><span class="op" id="8299438">)</span><span class="op" id="8299439">.</span><span class="ident" id="8299440">Add</span><span class="op" id="8299443">(</span><span class="num" id="8299444">100</span>&nbsp;<span class="op" id="8299448">*</span>&nbsp;<span class="ident" id="8299450">time</span><span class="op" id="8299454">.</span><span class="ident" id="8299455">Millisecond</span><span class="op" id="8299466">)</span><span class="op" id="8299467">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8299472">if</span>&nbsp;<span class="ident" id="8299475">_</span><span class="op" id="8299476">,</span>&nbsp;<span class="ident" id="8299478">err</span>&nbsp;<span class="op" id="8299482">:=</span>&nbsp;<span class="ident" id="8299485">c1</span><span class="op" id="8299487">.</span><span class="ident" id="8299488">WriteTo</span><span class="op" id="8299495">(</span><span class="ident" id="8299496">wb</span><span class="op" id="8299498">,</span>&nbsp;<span class="ident" id="8299500">c2</span><span class="op" id="8299502">.</span><span class="ident" id="8299503">LocalAddr</span><span class="op" id="8299512">(</span><span class="op" id="8299513">)</span><span class="op" id="8299514">)</span><span class="op" id="8299515">;</span>&nbsp;<span class="ident" id="8299517">err</span>&nbsp;<span class="op" id="8299521">!=</span>&nbsp;<span class="ident" id="8299524">nil</span>&nbsp;<span class="op" id="8299528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299533">t</span><span class="op" id="8299534">.</span><span class="ident" id="8299535">Fatalf</span><span class="op" id="8299541">(</span><span class="string" id="8299542">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8299573">,</span>&nbsp;<span class="ident" id="8299575">err</span><span class="op" id="8299578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8299582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299586">rb2</span>&nbsp;<span class="op" id="8299590">:=</span>&nbsp;<span class="builtinfunc" id="8299593">make</span><span class="op" id="8299597">(</span><span class="op" id="8299598">[</span><span class="op" id="8299599">]</span><span class="builtintype" id="8299600">byte</span><span class="op" id="8299604">,</span>&nbsp;<span class="num" id="8299606">128</span><span class="op" id="8299609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8299613">if</span>&nbsp;<span class="ident" id="8299616">_</span><span class="op" id="8299617">,</span>&nbsp;<span class="ident" id="8299619">_</span><span class="op" id="8299620">,</span>&nbsp;<span class="ident" id="8299622">err</span>&nbsp;<span class="op" id="8299626">:=</span>&nbsp;<span class="ident" id="8299629">c2</span><span class="op" id="8299631">.</span><span class="ident" id="8299632">ReadFrom</span><span class="op" id="8299640">(</span><span class="ident" id="8299641">rb2</span><span class="op" id="8299644">)</span><span class="op" id="8299645">;</span>&nbsp;<span class="ident" id="8299647">err</span>&nbsp;<span class="op" id="8299651">!=</span>&nbsp;<span class="ident" id="8299654">nil</span>&nbsp;<span class="op" id="8299658">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299663">t</span><span class="op" id="8299664">.</span><span class="ident" id="8299665">Fatalf</span><span class="op" id="8299671">(</span><span class="string" id="8299672">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8299704">,</span>&nbsp;<span class="ident" id="8299706">err</span><span class="op" id="8299709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8299713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8299717">if</span>&nbsp;<span class="ident" id="8299720">_</span><span class="op" id="8299721">,</span>&nbsp;<span class="ident" id="8299723">err</span>&nbsp;<span class="op" id="8299727">:=</span>&nbsp;<span class="ident" id="8299730">c2</span><span class="op" id="8299732">.</span><span class="ident" id="8299733">WriteTo</span><span class="op" id="8299740">(</span><span class="ident" id="8299741">wb</span><span class="op" id="8299743">,</span>&nbsp;<span class="ident" id="8299745">c1</span><span class="op" id="8299747">.</span><span class="ident" id="8299748">LocalAddr</span><span class="op" id="8299757">(</span><span class="op" id="8299758">)</span><span class="op" id="8299759">)</span><span class="op" id="8299760">;</span>&nbsp;<span class="ident" id="8299762">err</span>&nbsp;<span class="op" id="8299766">!=</span>&nbsp;<span class="ident" id="8299769">nil</span>&nbsp;<span class="op" id="8299773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299778">t</span><span class="op" id="8299779">.</span><span class="ident" id="8299780">Fatalf</span><span class="op" id="8299786">(</span><span class="string" id="8299787">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8299818">,</span>&nbsp;<span class="ident" id="8299820">err</span><span class="op" id="8299823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8299827">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299831">rb1</span>&nbsp;<span class="op" id="8299835">:=</span>&nbsp;<span class="builtinfunc" id="8299838">make</span><span class="op" id="8299842">(</span><span class="op" id="8299843">[</span><span class="op" id="8299844">]</span><span class="builtintype" id="8299845">byte</span><span class="op" id="8299849">,</span>&nbsp;<span class="num" id="8299851">128</span><span class="op" id="8299854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8299858">if</span>&nbsp;<span class="ident" id="8299861">_</span><span class="op" id="8299862">,</span>&nbsp;<span class="ident" id="8299864">_</span><span class="op" id="8299865">,</span>&nbsp;<span class="ident" id="8299867">err</span>&nbsp;<span class="op" id="8299871">:=</span>&nbsp;<span class="ident" id="8299874">c1</span><span class="op" id="8299876">.</span><span class="ident" id="8299877">ReadFrom</span><span class="op" id="8299885">(</span><span class="ident" id="8299886">rb1</span><span class="op" id="8299889">)</span><span class="op" id="8299890">;</span>&nbsp;<span class="ident" id="8299892">err</span>&nbsp;<span class="op" id="8299896">!=</span>&nbsp;<span class="ident" id="8299899">nil</span>&nbsp;<span class="op" id="8299903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8299908">t</span><span class="op" id="8299909">.</span><span class="ident" id="8299910">Fatalf</span><span class="op" id="8299916">(</span><span class="string" id="8299917">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8299949">,</span>&nbsp;<span class="ident" id="8299951">err</span><span class="op" id="8299954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8299958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8299961">}</span><br>
<span class="lineno">120</span><span class="op" id="8299963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8299966">func</span>&nbsp;<span class="ident" id="8299971">TestConnAndPacketConn</span><span class="op" id="8299992">(</span><span class="ident" id="8299993">t</span>&nbsp;<span class="op" id="8299995">*</span><span class="ident" id="8299996">testing</span><span class="op" id="8300003">.</span><span class="ident" id="8300004">T</span><span class="op" id="8300005">)</span>&nbsp;<span class="op" id="8300007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300010">closer</span>&nbsp;<span class="op" id="8300017">:=</span>&nbsp;<span class="keyword" id="8300020">func</span><span class="op" id="8300024">(</span><span class="ident" id="8300025">c</span>&nbsp;<span class="ident" id="8300027">PacketConn</span><span class="op" id="8300037">,</span>&nbsp;<span class="ident" id="8300039">net</span><span class="op" id="8300042">,</span>&nbsp;<span class="ident" id="8300044">addr1</span><span class="op" id="8300049">,</span>&nbsp;<span class="ident" id="8300051">addr2</span>&nbsp;<span class="builtintype" id="8300057">string</span><span class="op" id="8300063">)</span>&nbsp;<span class="op" id="8300065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300069">c</span><span class="op" id="8300070">.</span><span class="ident" id="8300071">Close</span><span class="op" id="8300076">(</span><span class="op" id="8300077">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300081">switch</span>&nbsp;<span class="ident" id="8300088">net</span>&nbsp;<span class="op" id="8300092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300096">case</span>&nbsp;<span class="string" id="8300101">&#34;unixgram&#34;</span><span class="op" id="8300111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300116">os</span><span class="op" id="8300118">.</span><span class="ident" id="8300119">Remove</span><span class="op" id="8300125">(</span><span class="ident" id="8300126">addr1</span><span class="op" id="8300131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300136">os</span><span class="op" id="8300138">.</span><span class="ident" id="8300139">Remove</span><span class="op" id="8300145">(</span><span class="ident" id="8300146">addr2</span><span class="op" id="8300151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8300155">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8300158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300162">for</span>&nbsp;<span class="ident" id="8300166">i</span><span class="op" id="8300167">,</span>&nbsp;<span class="ident" id="8300169">tt</span>&nbsp;<span class="op" id="8300172">:=</span>&nbsp;<span class="keyword" id="8300175">range</span>&nbsp;<span class="ident" id="8300181">packetConnTests</span>&nbsp;<span class="op" id="8300197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300201">var</span>&nbsp;<span class="ident" id="8300205">wb</span>&nbsp;<span class="op" id="8300208">[</span><span class="op" id="8300209">]</span><span class="builtintype" id="8300210">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300217">netstr</span>&nbsp;<span class="op" id="8300224">:=</span>&nbsp;<span class="ident" id="8300227">strings</span><span class="op" id="8300234">.</span><span class="ident" id="8300235">Split</span><span class="op" id="8300240">(</span><span class="ident" id="8300241">tt</span><span class="op" id="8300243">.</span><span class="ident" id="8300244">net</span><span class="op" id="8300247">,</span>&nbsp;<span class="string" id="8300249">&#34;:&#34;</span><span class="op" id="8300252">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300256">wb</span><span class="op" id="8300258">,</span>&nbsp;<span class="ident" id="8300260">skipOrFatalFn</span>&nbsp;<span class="op" id="8300274">:=</span>&nbsp;<span class="ident" id="8300277">packetConnTestData</span><span class="op" id="8300295">(</span><span class="ident" id="8300296">t</span><span class="op" id="8300297">,</span>&nbsp;<span class="ident" id="8300299">netstr</span><span class="op" id="8300305">[</span><span class="num" id="8300306">0</span><span class="op" id="8300307">]</span><span class="op" id="8300308">,</span>&nbsp;<span class="ident" id="8300310">i</span><span class="op" id="8300311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300315">if</span>&nbsp;<span class="ident" id="8300318">skipOrFatalFn</span>&nbsp;<span class="op" id="8300332">!=</span>&nbsp;<span class="ident" id="8300335">nil</span>&nbsp;<span class="op" id="8300339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300344">skipOrFatalFn</span><span class="op" id="8300357">(</span><span class="op" id="8300358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300363">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8300374">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300379">c1</span><span class="op" id="8300381">,</span>&nbsp;<span class="ident" id="8300383">err</span>&nbsp;<span class="op" id="8300387">:=</span>&nbsp;<span class="ident" id="8300390">ListenPacket</span><span class="op" id="8300402">(</span><span class="ident" id="8300403">tt</span><span class="op" id="8300405">.</span><span class="ident" id="8300406">net</span><span class="op" id="8300409">,</span>&nbsp;<span class="ident" id="8300411">tt</span><span class="op" id="8300413">.</span><span class="ident" id="8300414">addr1</span><span class="op" id="8300419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300423">if</span>&nbsp;<span class="ident" id="8300426">err</span>&nbsp;<span class="op" id="8300430">!=</span>&nbsp;<span class="ident" id="8300433">nil</span>&nbsp;<span class="op" id="8300437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300442">t</span><span class="op" id="8300443">.</span><span class="ident" id="8300444">Fatalf</span><span class="op" id="8300450">(</span><span class="string" id="8300451">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8300476">,</span>&nbsp;<span class="ident" id="8300478">err</span><span class="op" id="8300481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8300485">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300489">defer</span>&nbsp;<span class="ident" id="8300495">closer</span><span class="op" id="8300501">(</span><span class="ident" id="8300502">c1</span><span class="op" id="8300504">,</span>&nbsp;<span class="ident" id="8300506">netstr</span><span class="op" id="8300512">[</span><span class="num" id="8300513">0</span><span class="op" id="8300514">]</span><span class="op" id="8300515">,</span>&nbsp;<span class="ident" id="8300517">tt</span><span class="op" id="8300519">.</span><span class="ident" id="8300520">addr1</span><span class="op" id="8300525">,</span>&nbsp;<span class="ident" id="8300527">tt</span><span class="op" id="8300529">.</span><span class="ident" id="8300530">addr2</span><span class="op" id="8300535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300539">c1</span><span class="op" id="8300541">.</span><span class="ident" id="8300542">LocalAddr</span><span class="op" id="8300551">(</span><span class="op" id="8300552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300556">c1</span><span class="op" id="8300558">.</span><span class="ident" id="8300559">SetDeadline</span><span class="op" id="8300570">(</span><span class="ident" id="8300571">time</span><span class="op" id="8300575">.</span><span class="ident" id="8300576">Now</span><span class="op" id="8300579">(</span><span class="op" id="8300580">)</span><span class="op" id="8300581">.</span><span class="ident" id="8300582">Add</span><span class="op" id="8300585">(</span><span class="num" id="8300586">100</span>&nbsp;<span class="op" id="8300590">*</span>&nbsp;<span class="ident" id="8300592">time</span><span class="op" id="8300596">.</span><span class="ident" id="8300597">Millisecond</span><span class="op" id="8300608">)</span><span class="op" id="8300609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300613">c1</span><span class="op" id="8300615">.</span><span class="ident" id="8300616">SetReadDeadline</span><span class="op" id="8300631">(</span><span class="ident" id="8300632">time</span><span class="op" id="8300636">.</span><span class="ident" id="8300637">Now</span><span class="op" id="8300640">(</span><span class="op" id="8300641">)</span><span class="op" id="8300642">.</span><span class="ident" id="8300643">Add</span><span class="op" id="8300646">(</span><span class="num" id="8300647">100</span>&nbsp;<span class="op" id="8300651">*</span>&nbsp;<span class="ident" id="8300653">time</span><span class="op" id="8300657">.</span><span class="ident" id="8300658">Millisecond</span><span class="op" id="8300669">)</span><span class="op" id="8300670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300674">c1</span><span class="op" id="8300676">.</span><span class="ident" id="8300677">SetWriteDeadline</span><span class="op" id="8300693">(</span><span class="ident" id="8300694">time</span><span class="op" id="8300698">.</span><span class="ident" id="8300699">Now</span><span class="op" id="8300702">(</span><span class="op" id="8300703">)</span><span class="op" id="8300704">.</span><span class="ident" id="8300705">Add</span><span class="op" id="8300708">(</span><span class="num" id="8300709">100</span>&nbsp;<span class="op" id="8300713">*</span>&nbsp;<span class="ident" id="8300715">time</span><span class="op" id="8300719">.</span><span class="ident" id="8300720">Millisecond</span><span class="op" id="8300731">)</span><span class="op" id="8300732">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300737">c2</span><span class="op" id="8300739">,</span>&nbsp;<span class="ident" id="8300741">err</span>&nbsp;<span class="op" id="8300745">:=</span>&nbsp;<span class="ident" id="8300748">Dial</span><span class="op" id="8300752">(</span><span class="ident" id="8300753">tt</span><span class="op" id="8300755">.</span><span class="ident" id="8300756">net</span><span class="op" id="8300759">,</span>&nbsp;<span class="ident" id="8300761">c1</span><span class="op" id="8300763">.</span><span class="ident" id="8300764">LocalAddr</span><span class="op" id="8300773">(</span><span class="op" id="8300774">)</span><span class="op" id="8300775">.</span><span class="ident" id="8300776">String</span><span class="op" id="8300782">(</span><span class="op" id="8300783">)</span><span class="op" id="8300784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300788">if</span>&nbsp;<span class="ident" id="8300791">err</span>&nbsp;<span class="op" id="8300795">!=</span>&nbsp;<span class="ident" id="8300798">nil</span>&nbsp;<span class="op" id="8300802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300807">t</span><span class="op" id="8300808">.</span><span class="ident" id="8300809">Fatalf</span><span class="op" id="8300815">(</span><span class="string" id="8300816">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8300833">,</span>&nbsp;<span class="ident" id="8300835">err</span><span class="op" id="8300838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8300842">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8300846">defer</span>&nbsp;<span class="ident" id="8300852">c2</span><span class="op" id="8300854">.</span><span class="ident" id="8300855">Close</span><span class="op" id="8300860">(</span><span class="op" id="8300861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300865">c2</span><span class="op" id="8300867">.</span><span class="ident" id="8300868">LocalAddr</span><span class="op" id="8300877">(</span><span class="op" id="8300878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300882">c2</span><span class="op" id="8300884">.</span><span class="ident" id="8300885">RemoteAddr</span><span class="op" id="8300895">(</span><span class="op" id="8300896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300900">c2</span><span class="op" id="8300902">.</span><span class="ident" id="8300903">SetDeadline</span><span class="op" id="8300914">(</span><span class="ident" id="8300915">time</span><span class="op" id="8300919">.</span><span class="ident" id="8300920">Now</span><span class="op" id="8300923">(</span><span class="op" id="8300924">)</span><span class="op" id="8300925">.</span><span class="ident" id="8300926">Add</span><span class="op" id="8300929">(</span><span class="num" id="8300930">100</span>&nbsp;<span class="op" id="8300934">*</span>&nbsp;<span class="ident" id="8300936">time</span><span class="op" id="8300940">.</span><span class="ident" id="8300941">Millisecond</span><span class="op" id="8300952">)</span><span class="op" id="8300953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8300957">c2</span><span class="op" id="8300959">.</span><span class="ident" id="8300960">SetReadDeadline</span><span class="op" id="8300975">(</span><span class="ident" id="8300976">time</span><span class="op" id="8300980">.</span><span class="ident" id="8300981">Now</span><span class="op" id="8300984">(</span><span class="op" id="8300985">)</span><span class="op" id="8300986">.</span><span class="ident" id="8300987">Add</span><span class="op" id="8300990">(</span><span class="num" id="8300991">100</span>&nbsp;<span class="op" id="8300995">*</span>&nbsp;<span class="ident" id="8300997">time</span><span class="op" id="8301001">.</span><span class="ident" id="8301002">Millisecond</span><span class="op" id="8301013">)</span><span class="op" id="8301014">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301018">c2</span><span class="op" id="8301020">.</span><span class="ident" id="8301021">SetWriteDeadline</span><span class="op" id="8301037">(</span><span class="ident" id="8301038">time</span><span class="op" id="8301042">.</span><span class="ident" id="8301043">Now</span><span class="op" id="8301046">(</span><span class="op" id="8301047">)</span><span class="op" id="8301048">.</span><span class="ident" id="8301049">Add</span><span class="op" id="8301052">(</span><span class="num" id="8301053">100</span>&nbsp;<span class="op" id="8301057">*</span>&nbsp;<span class="ident" id="8301059">time</span><span class="op" id="8301063">.</span><span class="ident" id="8301064">Millisecond</span><span class="op" id="8301075">)</span><span class="op" id="8301076">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301081">if</span>&nbsp;<span class="ident" id="8301084">_</span><span class="op" id="8301085">,</span>&nbsp;<span class="ident" id="8301087">err</span>&nbsp;<span class="op" id="8301091">:=</span>&nbsp;<span class="ident" id="8301094">c2</span><span class="op" id="8301096">.</span><span class="ident" id="8301097">Write</span><span class="op" id="8301102">(</span><span class="ident" id="8301103">wb</span><span class="op" id="8301105">)</span><span class="op" id="8301106">;</span>&nbsp;<span class="ident" id="8301108">err</span>&nbsp;<span class="op" id="8301112">!=</span>&nbsp;<span class="ident" id="8301115">nil</span>&nbsp;<span class="op" id="8301119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301124">t</span><span class="op" id="8301125">.</span><span class="ident" id="8301126">Fatalf</span><span class="op" id="8301132">(</span><span class="string" id="8301133">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8301156">,</span>&nbsp;<span class="ident" id="8301158">err</span><span class="op" id="8301161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8301165">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301169">rb1</span>&nbsp;<span class="op" id="8301173">:=</span>&nbsp;<span class="builtinfunc" id="8301176">make</span><span class="op" id="8301180">(</span><span class="op" id="8301181">[</span><span class="op" id="8301182">]</span><span class="builtintype" id="8301183">byte</span><span class="op" id="8301187">,</span>&nbsp;<span class="num" id="8301189">128</span><span class="op" id="8301192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301196">if</span>&nbsp;<span class="ident" id="8301199">_</span><span class="op" id="8301200">,</span>&nbsp;<span class="ident" id="8301202">_</span><span class="op" id="8301203">,</span>&nbsp;<span class="ident" id="8301205">err</span>&nbsp;<span class="op" id="8301209">:=</span>&nbsp;<span class="ident" id="8301212">c1</span><span class="op" id="8301214">.</span><span class="ident" id="8301215">ReadFrom</span><span class="op" id="8301223">(</span><span class="ident" id="8301224">rb1</span><span class="op" id="8301227">)</span><span class="op" id="8301228">;</span>&nbsp;<span class="ident" id="8301230">err</span>&nbsp;<span class="op" id="8301234">!=</span>&nbsp;<span class="ident" id="8301237">nil</span>&nbsp;<span class="op" id="8301241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301246">t</span><span class="op" id="8301247">.</span><span class="ident" id="8301248">Fatalf</span><span class="op" id="8301254">(</span><span class="string" id="8301255">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8301287">,</span>&nbsp;<span class="ident" id="8301289">err</span><span class="op" id="8301292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8301296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301300">var</span>&nbsp;<span class="ident" id="8301304">dst</span>&nbsp;<span class="ident" id="8301308">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301315">switch</span>&nbsp;<span class="ident" id="8301322">netstr</span><span class="op" id="8301328">[</span><span class="num" id="8301329">0</span><span class="op" id="8301330">]</span>&nbsp;<span class="op" id="8301332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301336">case</span>&nbsp;<span class="string" id="8301341">&#34;ip&#34;</span><span class="op" id="8301345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301350">dst</span>&nbsp;<span class="op" id="8301354">=</span>&nbsp;<span class="op" id="8301356">&amp;</span><span class="ident" id="8301357">IPAddr</span><span class="op" id="8301363">{</span><span class="ident" id="8301364">IP</span><span class="op" id="8301366">:</span>&nbsp;<span class="ident" id="8301368">IPv4</span><span class="op" id="8301372">(</span><span class="num" id="8301373">127</span><span class="op" id="8301376">,</span>&nbsp;<span class="num" id="8301378">0</span><span class="op" id="8301379">,</span>&nbsp;<span class="num" id="8301381">0</span><span class="op" id="8301382">,</span>&nbsp;<span class="num" id="8301384">1</span><span class="op" id="8301385">)</span><span class="op" id="8301386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301390">case</span>&nbsp;<span class="string" id="8301395">&#34;unixgram&#34;</span><span class="op" id="8301405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301410">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301421">default</span><span class="op" id="8301428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301433">dst</span>&nbsp;<span class="op" id="8301437">=</span>&nbsp;<span class="ident" id="8301439">c2</span><span class="op" id="8301441">.</span><span class="ident" id="8301442">LocalAddr</span><span class="op" id="8301451">(</span><span class="op" id="8301452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8301456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301460">if</span>&nbsp;<span class="ident" id="8301463">_</span><span class="op" id="8301464">,</span>&nbsp;<span class="ident" id="8301466">err</span>&nbsp;<span class="op" id="8301470">:=</span>&nbsp;<span class="ident" id="8301473">c1</span><span class="op" id="8301475">.</span><span class="ident" id="8301476">WriteTo</span><span class="op" id="8301483">(</span><span class="ident" id="8301484">wb</span><span class="op" id="8301486">,</span>&nbsp;<span class="ident" id="8301488">dst</span><span class="op" id="8301491">)</span><span class="op" id="8301492">;</span>&nbsp;<span class="ident" id="8301494">err</span>&nbsp;<span class="op" id="8301498">!=</span>&nbsp;<span class="ident" id="8301501">nil</span>&nbsp;<span class="op" id="8301505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301510">t</span><span class="op" id="8301511">.</span><span class="ident" id="8301512">Fatalf</span><span class="op" id="8301518">(</span><span class="string" id="8301519">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8301550">,</span>&nbsp;<span class="ident" id="8301552">err</span><span class="op" id="8301555">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8301559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301563">rb2</span>&nbsp;<span class="op" id="8301567">:=</span>&nbsp;<span class="builtinfunc" id="8301570">make</span><span class="op" id="8301574">(</span><span class="op" id="8301575">[</span><span class="op" id="8301576">]</span><span class="builtintype" id="8301577">byte</span><span class="op" id="8301581">,</span>&nbsp;<span class="num" id="8301583">128</span><span class="op" id="8301586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8301590">if</span>&nbsp;<span class="ident" id="8301593">_</span><span class="op" id="8301594">,</span>&nbsp;<span class="ident" id="8301596">err</span>&nbsp;<span class="op" id="8301600">:=</span>&nbsp;<span class="ident" id="8301603">c2</span><span class="op" id="8301605">.</span><span class="ident" id="8301606">Read</span><span class="op" id="8301610">(</span><span class="ident" id="8301611">rb2</span><span class="op" id="8301614">)</span><span class="op" id="8301615">;</span>&nbsp;<span class="ident" id="8301617">err</span>&nbsp;<span class="op" id="8301621">!=</span>&nbsp;<span class="ident" id="8301624">nil</span>&nbsp;<span class="op" id="8301628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8301633">t</span><span class="op" id="8301634">.</span><span class="ident" id="8301635">Fatalf</span><span class="op" id="8301641">(</span><span class="string" id="8301642">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8301664">,</span>&nbsp;<span class="ident" id="8301666">err</span><span class="op" id="8301669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8301673">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8301676">}</span><br>
<span class="lineno"></span><span class="op" id="8301678">}</span>
</div>
</body>
</html>
