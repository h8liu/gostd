<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3071866">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3071922">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3071976">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3072027">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3072092">package</span>&nbsp;<span class="ident" id="3072100">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3072105">import</span>&nbsp;<span class="op" id="3072112">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3072115">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3072125">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3072132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3072135">var</span>&nbsp;<span class="ident" id="3072139">onceReadProtocols</span>&nbsp;<span class="ident" id="3072157">sync</span><span class="op" id="3072161">.</span><span class="ident" id="3072162">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3072168">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3072237">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3072258">func</span>&nbsp;<span class="ident" id="3072263">readProtocols</span><span class="op" id="3072276">(</span><span class="op" id="3072277">)</span>&nbsp;<span class="op" id="3072279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072282">if</span>&nbsp;<span class="ident" id="3072285">file</span><span class="op" id="3072289">,</span>&nbsp;<span class="ident" id="3072291">err</span>&nbsp;<span class="op" id="3072295">:=</span>&nbsp;<span class="ident" id="3072298">open</span><span class="op" id="3072302">(</span><span class="string" id="3072303">&#34;/etc/protocols&#34;</span><span class="op" id="3072319">)</span><span class="op" id="3072320">;</span>&nbsp;<span class="ident" id="3072322">err</span>&nbsp;<span class="op" id="3072326">==</span>&nbsp;<span class="ident" id="3072329">nil</span>&nbsp;<span class="op" id="3072333">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072337">for</span>&nbsp;<span class="ident" id="3072341">line</span><span class="op" id="3072345">,</span>&nbsp;<span class="ident" id="3072347">ok</span>&nbsp;<span class="op" id="3072350">:=</span>&nbsp;<span class="ident" id="3072353">file</span><span class="op" id="3072357">.</span><span class="ident" id="3072358">readLine</span><span class="op" id="3072366">(</span><span class="op" id="3072367">)</span><span class="op" id="3072368">;</span>&nbsp;<span class="ident" id="3072370">ok</span><span class="op" id="3072372">;</span>&nbsp;<span class="ident" id="3072374">line</span><span class="op" id="3072378">,</span>&nbsp;<span class="ident" id="3072380">ok</span>&nbsp;<span class="op" id="3072383">=</span>&nbsp;<span class="ident" id="3072385">file</span><span class="op" id="3072389">.</span><span class="ident" id="3072390">readLine</span><span class="op" id="3072398">(</span><span class="op" id="3072399">)</span>&nbsp;<span class="op" id="3072401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3072406">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072462">if</span>&nbsp;<span class="ident" id="3072465">i</span>&nbsp;<span class="op" id="3072467">:=</span>&nbsp;<span class="ident" id="3072470">byteIndex</span><span class="op" id="3072479">(</span><span class="ident" id="3072480">line</span><span class="op" id="3072484">,</span>&nbsp;<span class="string" id="3072486">&#39;#&#39;</span><span class="op" id="3072489">)</span><span class="op" id="3072490">;</span>&nbsp;<span class="ident" id="3072492">i</span>&nbsp;<span class="op" id="3072494">&gt;=</span>&nbsp;<span class="num" id="3072497">0</span>&nbsp;<span class="op" id="3072499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3072505">line</span>&nbsp;<span class="op" id="3072510">=</span>&nbsp;<span class="ident" id="3072512">line</span><span class="op" id="3072516">[</span><span class="num" id="3072517">0</span><span class="op" id="3072518">:</span><span class="ident" id="3072519">i</span><span class="op" id="3072520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072525">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3072530">f</span>&nbsp;<span class="op" id="3072532">:=</span>&nbsp;<span class="ident" id="3072535">getFields</span><span class="op" id="3072544">(</span><span class="ident" id="3072545">line</span><span class="op" id="3072549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072554">if</span>&nbsp;<span class="builtinfunc" id="3072557">len</span><span class="op" id="3072560">(</span><span class="ident" id="3072561">f</span><span class="op" id="3072562">)</span>&nbsp;<span class="op" id="3072564">&lt;</span>&nbsp;<span class="num" id="3072566">2</span>&nbsp;<span class="op" id="3072568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072574">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072591">if</span>&nbsp;<span class="ident" id="3072594">proto</span><span class="op" id="3072599">,</span>&nbsp;<span class="ident" id="3072601">_</span><span class="op" id="3072602">,</span>&nbsp;<span class="ident" id="3072604">ok</span>&nbsp;<span class="op" id="3072607">:=</span>&nbsp;<span class="ident" id="3072610">dtoi</span><span class="op" id="3072614">(</span><span class="ident" id="3072615">f</span><span class="op" id="3072616">[</span><span class="num" id="3072617">1</span><span class="op" id="3072618">]</span><span class="op" id="3072619">,</span>&nbsp;<span class="num" id="3072621">0</span><span class="op" id="3072622">)</span><span class="op" id="3072623">;</span>&nbsp;<span class="ident" id="3072625">ok</span>&nbsp;<span class="op" id="3072628">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072634">if</span>&nbsp;<span class="ident" id="3072637">_</span><span class="op" id="3072638">,</span>&nbsp;<span class="ident" id="3072640">ok</span>&nbsp;<span class="op" id="3072643">:=</span>&nbsp;<span class="ident" id="3072646">protocols</span><span class="op" id="3072655">[</span><span class="ident" id="3072656">f</span><span class="op" id="3072657">[</span><span class="num" id="3072658">0</span><span class="op" id="3072659">]</span><span class="op" id="3072660">]</span><span class="op" id="3072661">;</span>&nbsp;<span class="op" id="3072663">!</span><span class="ident" id="3072664">ok</span>&nbsp;<span class="op" id="3072667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3072674">protocols</span><span class="op" id="3072683">[</span><span class="ident" id="3072684">f</span><span class="op" id="3072685">[</span><span class="num" id="3072686">0</span><span class="op" id="3072687">]</span><span class="op" id="3072688">]</span>&nbsp;<span class="op" id="3072690">=</span>&nbsp;<span class="ident" id="3072692">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072708">for</span>&nbsp;<span class="ident" id="3072712">_</span><span class="op" id="3072713">,</span>&nbsp;<span class="ident" id="3072715">alias</span>&nbsp;<span class="op" id="3072721">:=</span>&nbsp;<span class="keyword" id="3072724">range</span>&nbsp;<span class="ident" id="3072730">f</span><span class="op" id="3072731">[</span><span class="num" id="3072732">2</span><span class="op" id="3072733">:</span><span class="op" id="3072734">]</span>&nbsp;<span class="op" id="3072736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3072743">if</span>&nbsp;<span class="ident" id="3072746">_</span><span class="op" id="3072747">,</span>&nbsp;<span class="ident" id="3072749">ok</span>&nbsp;<span class="op" id="3072752">:=</span>&nbsp;<span class="ident" id="3072755">protocols</span><span class="op" id="3072764">[</span><span class="ident" id="3072765">alias</span><span class="op" id="3072770">]</span><span class="op" id="3072771">;</span>&nbsp;<span class="op" id="3072773">!</span><span class="ident" id="3072774">ok</span>&nbsp;<span class="op" id="3072777">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3072785">protocols</span><span class="op" id="3072794">[</span><span class="ident" id="3072795">alias</span><span class="op" id="3072800">]</span>&nbsp;<span class="op" id="3072802">=</span>&nbsp;<span class="ident" id="3072804">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072830">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3072834">file</span><span class="op" id="3072838">.</span><span class="builtinfunc" id="3072839">close</span><span class="op" id="3072844">(</span><span class="op" id="3072845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3072848">}</span><br>
<span class="lineno"></span><span class="op" id="3072850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3072853">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3072919">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3072961">func</span>&nbsp;<span class="ident" id="3072966">lookupProtocol</span><span class="op" id="3072980">(</span><span class="ident" id="3072981">name</span>&nbsp;<span class="builtintype" id="3072986">string</span><span class="op" id="3072992">)</span>&nbsp;<span class="op" id="3072994">(</span><span class="ident" id="3072995">proto</span>&nbsp;<span class="builtintype" id="3073001">int</span><span class="op" id="3073004">,</span>&nbsp;<span class="ident" id="3073006">err</span>&nbsp;<span class="builtintype" id="3073010">error</span><span class="op" id="3073015">)</span>&nbsp;<span class="op" id="3073017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073020">onceReadProtocols</span><span class="op" id="3073037">.</span><span class="ident" id="3073038">Do</span><span class="op" id="3073040">(</span><span class="ident" id="3073041">readProtocols</span><span class="op" id="3073054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073057">proto</span><span class="op" id="3073062">,</span>&nbsp;<span class="ident" id="3073064">found</span>&nbsp;<span class="op" id="3073070">:=</span>&nbsp;<span class="ident" id="3073073">protocols</span><span class="op" id="3073082">[</span><span class="ident" id="3073083">name</span><span class="op" id="3073087">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073090">if</span>&nbsp;<span class="op" id="3073093">!</span><span class="ident" id="3073094">found</span>&nbsp;<span class="op" id="3073100">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073104">return</span>&nbsp;<span class="num" id="3073111">0</span><span class="op" id="3073112">,</span>&nbsp;<span class="ident" id="3073114">errors</span><span class="op" id="3073120">.</span><span class="ident" id="3073121">New</span><span class="op" id="3073124">(</span><span class="string" id="3073125">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3073159">+</span>&nbsp;<span class="ident" id="3073161">name</span><span class="op" id="3073165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3073168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073171">return</span><br>
<span class="lineno"></span><span class="op" id="3073178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3073181">func</span>&nbsp;<span class="ident" id="3073186">lookupHost</span><span class="op" id="3073196">(</span><span class="ident" id="3073197">host</span>&nbsp;<span class="builtintype" id="3073202">string</span><span class="op" id="3073208">)</span>&nbsp;<span class="op" id="3073210">(</span><span class="ident" id="3073211">addrs</span>&nbsp;<span class="op" id="3073217">[</span><span class="op" id="3073218">]</span><span class="builtintype" id="3073219">string</span><span class="op" id="3073225">,</span>&nbsp;<span class="ident" id="3073227">err</span>&nbsp;<span class="builtintype" id="3073231">error</span><span class="op" id="3073236">)</span>&nbsp;<span class="op" id="3073238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073241">addrs</span><span class="op" id="3073246">,</span>&nbsp;<span class="ident" id="3073248">err</span><span class="op" id="3073251">,</span>&nbsp;<span class="ident" id="3073253">ok</span>&nbsp;<span class="op" id="3073256">:=</span>&nbsp;<span class="ident" id="3073259">cgoLookupHost</span><span class="op" id="3073272">(</span><span class="ident" id="3073273">host</span><span class="op" id="3073277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073280">if</span>&nbsp;<span class="op" id="3073283">!</span><span class="ident" id="3073284">ok</span>&nbsp;<span class="op" id="3073287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073291">addrs</span><span class="op" id="3073296">,</span>&nbsp;<span class="ident" id="3073298">err</span>&nbsp;<span class="op" id="3073302">=</span>&nbsp;<span class="ident" id="3073304">goLookupHost</span><span class="op" id="3073316">(</span><span class="ident" id="3073317">host</span><span class="op" id="3073321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3073324">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073327">return</span><br>
<span class="lineno"></span><span class="op" id="3073334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3073337">func</span>&nbsp;<span class="ident" id="3073342">lookupIP</span><span class="op" id="3073350">(</span><span class="ident" id="3073351">host</span>&nbsp;<span class="builtintype" id="3073356">string</span><span class="op" id="3073362">)</span>&nbsp;<span class="op" id="3073364">(</span><span class="ident" id="3073365">addrs</span>&nbsp;<span class="op" id="3073371">[</span><span class="op" id="3073372">]</span><span class="ident" id="3073373">IP</span><span class="op" id="3073375">,</span>&nbsp;<span class="ident" id="3073377">err</span>&nbsp;<span class="builtintype" id="3073381">error</span><span class="op" id="3073386">)</span>&nbsp;<span class="op" id="3073388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073391">addrs</span><span class="op" id="3073396">,</span>&nbsp;<span class="ident" id="3073398">err</span><span class="op" id="3073401">,</span>&nbsp;<span class="ident" id="3073403">ok</span>&nbsp;<span class="op" id="3073406">:=</span>&nbsp;<span class="ident" id="3073409">cgoLookupIP</span><span class="op" id="3073420">(</span><span class="ident" id="3073421">host</span><span class="op" id="3073425">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073428">if</span>&nbsp;<span class="op" id="3073431">!</span><span class="ident" id="3073432">ok</span>&nbsp;<span class="op" id="3073435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073439">addrs</span><span class="op" id="3073444">,</span>&nbsp;<span class="ident" id="3073446">err</span>&nbsp;<span class="op" id="3073450">=</span>&nbsp;<span class="ident" id="3073452">goLookupIP</span><span class="op" id="3073462">(</span><span class="ident" id="3073463">host</span><span class="op" id="3073467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3073470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073473">return</span><br>
<span class="lineno"></span><span class="op" id="3073480">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3073483">func</span>&nbsp;<span class="ident" id="3073488">lookupPort</span><span class="op" id="3073498">(</span><span class="ident" id="3073499">network</span><span class="op" id="3073506">,</span>&nbsp;<span class="ident" id="3073508">service</span>&nbsp;<span class="builtintype" id="3073516">string</span><span class="op" id="3073522">)</span>&nbsp;<span class="op" id="3073524">(</span><span class="ident" id="3073525">port</span>&nbsp;<span class="builtintype" id="3073530">int</span><span class="op" id="3073533">,</span>&nbsp;<span class="ident" id="3073535">err</span>&nbsp;<span class="builtintype" id="3073539">error</span><span class="op" id="3073544">)</span>&nbsp;<span class="op" id="3073546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073549">port</span><span class="op" id="3073553">,</span>&nbsp;<span class="ident" id="3073555">err</span><span class="op" id="3073558">,</span>&nbsp;<span class="ident" id="3073560">ok</span>&nbsp;<span class="op" id="3073563">:=</span>&nbsp;<span class="ident" id="3073566">cgoLookupPort</span><span class="op" id="3073579">(</span><span class="ident" id="3073580">network</span><span class="op" id="3073587">,</span>&nbsp;<span class="ident" id="3073589">service</span><span class="op" id="3073596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073599">if</span>&nbsp;<span class="op" id="3073602">!</span><span class="ident" id="3073603">ok</span>&nbsp;<span class="op" id="3073606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073610">port</span><span class="op" id="3073614">,</span>&nbsp;<span class="ident" id="3073616">err</span>&nbsp;<span class="op" id="3073620">=</span>&nbsp;<span class="ident" id="3073622">goLookupPort</span><span class="op" id="3073634">(</span><span class="ident" id="3073635">network</span><span class="op" id="3073642">,</span>&nbsp;<span class="ident" id="3073644">service</span><span class="op" id="3073651">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3073654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073657">return</span><br>
<span class="lineno"></span><span class="op" id="3073664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3073667">func</span>&nbsp;<span class="ident" id="3073672">lookupCNAME</span><span class="op" id="3073683">(</span><span class="ident" id="3073684">name</span>&nbsp;<span class="builtintype" id="3073689">string</span><span class="op" id="3073695">)</span>&nbsp;<span class="op" id="3073697">(</span><span class="ident" id="3073698">cname</span>&nbsp;<span class="builtintype" id="3073704">string</span><span class="op" id="3073710">,</span>&nbsp;<span class="ident" id="3073712">err</span>&nbsp;<span class="builtintype" id="3073716">error</span><span class="op" id="3073721">)</span>&nbsp;<span class="op" id="3073723">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073726">cname</span><span class="op" id="3073731">,</span>&nbsp;<span class="ident" id="3073733">err</span><span class="op" id="3073736">,</span>&nbsp;<span class="ident" id="3073738">ok</span>&nbsp;<span class="op" id="3073741">:=</span>&nbsp;<span class="ident" id="3073744">cgoLookupCNAME</span><span class="op" id="3073758">(</span><span class="ident" id="3073759">name</span><span class="op" id="3073763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073766">if</span>&nbsp;<span class="op" id="3073769">!</span><span class="ident" id="3073770">ok</span>&nbsp;<span class="op" id="3073773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073777">cname</span><span class="op" id="3073782">,</span>&nbsp;<span class="ident" id="3073784">err</span>&nbsp;<span class="op" id="3073788">=</span>&nbsp;<span class="ident" id="3073790">goLookupCNAME</span><span class="op" id="3073803">(</span><span class="ident" id="3073804">name</span><span class="op" id="3073808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3073811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073814">return</span><br>
<span class="lineno">85</span><span class="op" id="3073821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3073824">func</span>&nbsp;<span class="ident" id="3073829">lookupSRV</span><span class="op" id="3073838">(</span><span class="ident" id="3073839">service</span><span class="op" id="3073846">,</span>&nbsp;<span class="ident" id="3073848">proto</span><span class="op" id="3073853">,</span>&nbsp;<span class="ident" id="3073855">name</span>&nbsp;<span class="builtintype" id="3073860">string</span><span class="op" id="3073866">)</span>&nbsp;<span class="op" id="3073868">(</span><span class="ident" id="3073869">cname</span>&nbsp;<span class="builtintype" id="3073875">string</span><span class="op" id="3073881">,</span>&nbsp;<span class="ident" id="3073883">addrs</span>&nbsp;<span class="op" id="3073889">[</span><span class="op" id="3073890">]</span><span class="op" id="3073891">*</span><span class="ident" id="3073892">SRV</span><span class="op" id="3073895">,</span>&nbsp;<span class="ident" id="3073897">err</span>&nbsp;<span class="builtintype" id="3073901">error</span><span class="op" id="3073906">)</span>&nbsp;<span class="op" id="3073908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073911">var</span>&nbsp;<span class="ident" id="3073915">target</span>&nbsp;<span class="builtintype" id="3073922">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3073930">if</span>&nbsp;<span class="ident" id="3073933">service</span>&nbsp;<span class="op" id="3073941">==</span>&nbsp;<span class="string" id="3073944">&#34;&#34;</span>&nbsp;<span class="op" id="3073947">&amp;&amp;</span>&nbsp;<span class="ident" id="3073950">proto</span>&nbsp;<span class="op" id="3073956">==</span>&nbsp;<span class="string" id="3073959">&#34;&#34;</span>&nbsp;<span class="op" id="3073962">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073966">target</span>&nbsp;<span class="op" id="3073973">=</span>&nbsp;<span class="ident" id="3073975">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3073981">}</span>&nbsp;<span class="keyword" id="3073983">else</span>&nbsp;<span class="op" id="3073988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3073992">target</span>&nbsp;<span class="op" id="3073999">=</span>&nbsp;<span class="string" id="3074001">&#34;_&#34;</span>&nbsp;<span class="op" id="3074005">+</span>&nbsp;<span class="ident" id="3074007">service</span>&nbsp;<span class="op" id="3074015">+</span>&nbsp;<span class="string" id="3074017">&#34;._&#34;</span>&nbsp;<span class="op" id="3074022">+</span>&nbsp;<span class="ident" id="3074024">proto</span>&nbsp;<span class="op" id="3074030">+</span>&nbsp;<span class="string" id="3074032">&#34;.&#34;</span>&nbsp;<span class="op" id="3074036">+</span>&nbsp;<span class="ident" id="3074038">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074047">var</span>&nbsp;<span class="ident" id="3074051">records</span>&nbsp;<span class="op" id="3074059">[</span><span class="op" id="3074060">]</span><span class="ident" id="3074061">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074068">cname</span><span class="op" id="3074073">,</span>&nbsp;<span class="ident" id="3074075">records</span><span class="op" id="3074082">,</span>&nbsp;<span class="ident" id="3074084">err</span>&nbsp;<span class="op" id="3074088">=</span>&nbsp;<span class="ident" id="3074090">lookup</span><span class="op" id="3074096">(</span><span class="ident" id="3074097">target</span><span class="op" id="3074103">,</span>&nbsp;<span class="ident" id="3074105">dnsTypeSRV</span><span class="op" id="3074115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074118">if</span>&nbsp;<span class="ident" id="3074121">err</span>&nbsp;<span class="op" id="3074125">!=</span>&nbsp;<span class="ident" id="3074128">nil</span>&nbsp;<span class="op" id="3074132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074136">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074147">addrs</span>&nbsp;<span class="op" id="3074153">=</span>&nbsp;<span class="builtinfunc" id="3074155">make</span><span class="op" id="3074159">(</span><span class="op" id="3074160">[</span><span class="op" id="3074161">]</span><span class="op" id="3074162">*</span><span class="ident" id="3074163">SRV</span><span class="op" id="3074166">,</span>&nbsp;<span class="builtinfunc" id="3074168">len</span><span class="op" id="3074171">(</span><span class="ident" id="3074172">records</span><span class="op" id="3074179">)</span><span class="op" id="3074180">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074183">for</span>&nbsp;<span class="ident" id="3074187">i</span><span class="op" id="3074188">,</span>&nbsp;<span class="ident" id="3074190">rr</span>&nbsp;<span class="op" id="3074193">:=</span>&nbsp;<span class="keyword" id="3074196">range</span>&nbsp;<span class="ident" id="3074202">records</span>&nbsp;<span class="op" id="3074210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074214">r</span>&nbsp;<span class="op" id="3074216">:=</span>&nbsp;<span class="ident" id="3074219">rr</span><span class="op" id="3074221">.</span><span class="op" id="3074222">(</span><span class="op" id="3074223">*</span><span class="ident" id="3074224">dnsRR_SRV</span><span class="op" id="3074233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074237">addrs</span><span class="op" id="3074242">[</span><span class="ident" id="3074243">i</span><span class="op" id="3074244">]</span>&nbsp;<span class="op" id="3074246">=</span>&nbsp;<span class="op" id="3074248">&amp;</span><span class="ident" id="3074249">SRV</span><span class="op" id="3074252">{</span><span class="ident" id="3074253">r</span><span class="op" id="3074254">.</span><span class="ident" id="3074255">Target</span><span class="op" id="3074261">,</span>&nbsp;<span class="ident" id="3074263">r</span><span class="op" id="3074264">.</span><span class="ident" id="3074265">Port</span><span class="op" id="3074269">,</span>&nbsp;<span class="ident" id="3074271">r</span><span class="op" id="3074272">.</span><span class="ident" id="3074273">Priority</span><span class="op" id="3074281">,</span>&nbsp;<span class="ident" id="3074283">r</span><span class="op" id="3074284">.</span><span class="ident" id="3074285">Weight</span><span class="op" id="3074291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074297">byPriorityWeight</span><span class="op" id="3074313">(</span><span class="ident" id="3074314">addrs</span><span class="op" id="3074319">)</span><span class="op" id="3074320">.</span><span class="ident" id="3074321">sort</span><span class="op" id="3074325">(</span><span class="op" id="3074326">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074329">return</span><br>
<span class="lineno"></span><span class="op" id="3074336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3074339">func</span>&nbsp;<span class="ident" id="3074344">lookupMX</span><span class="op" id="3074352">(</span><span class="ident" id="3074353">name</span>&nbsp;<span class="builtintype" id="3074358">string</span><span class="op" id="3074364">)</span>&nbsp;<span class="op" id="3074366">(</span><span class="ident" id="3074367">mx</span>&nbsp;<span class="op" id="3074370">[</span><span class="op" id="3074371">]</span><span class="op" id="3074372">*</span><span class="ident" id="3074373">MX</span><span class="op" id="3074375">,</span>&nbsp;<span class="ident" id="3074377">err</span>&nbsp;<span class="builtintype" id="3074381">error</span><span class="op" id="3074386">)</span>&nbsp;<span class="op" id="3074388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074391">_</span><span class="op" id="3074392">,</span>&nbsp;<span class="ident" id="3074394">records</span><span class="op" id="3074401">,</span>&nbsp;<span class="ident" id="3074403">err</span>&nbsp;<span class="op" id="3074407">:=</span>&nbsp;<span class="ident" id="3074410">lookup</span><span class="op" id="3074416">(</span><span class="ident" id="3074417">name</span><span class="op" id="3074421">,</span>&nbsp;<span class="ident" id="3074423">dnsTypeMX</span><span class="op" id="3074432">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074435">if</span>&nbsp;<span class="ident" id="3074438">err</span>&nbsp;<span class="op" id="3074442">!=</span>&nbsp;<span class="ident" id="3074445">nil</span>&nbsp;<span class="op" id="3074449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074453">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074464">mx</span>&nbsp;<span class="op" id="3074467">=</span>&nbsp;<span class="builtinfunc" id="3074469">make</span><span class="op" id="3074473">(</span><span class="op" id="3074474">[</span><span class="op" id="3074475">]</span><span class="op" id="3074476">*</span><span class="ident" id="3074477">MX</span><span class="op" id="3074479">,</span>&nbsp;<span class="builtinfunc" id="3074481">len</span><span class="op" id="3074484">(</span><span class="ident" id="3074485">records</span><span class="op" id="3074492">)</span><span class="op" id="3074493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074496">for</span>&nbsp;<span class="ident" id="3074500">i</span><span class="op" id="3074501">,</span>&nbsp;<span class="ident" id="3074503">rr</span>&nbsp;<span class="op" id="3074506">:=</span>&nbsp;<span class="keyword" id="3074509">range</span>&nbsp;<span class="ident" id="3074515">records</span>&nbsp;<span class="op" id="3074523">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074527">r</span>&nbsp;<span class="op" id="3074529">:=</span>&nbsp;<span class="ident" id="3074532">rr</span><span class="op" id="3074534">.</span><span class="op" id="3074535">(</span><span class="op" id="3074536">*</span><span class="ident" id="3074537">dnsRR_MX</span><span class="op" id="3074545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074549">mx</span><span class="op" id="3074551">[</span><span class="ident" id="3074552">i</span><span class="op" id="3074553">]</span>&nbsp;<span class="op" id="3074555">=</span>&nbsp;<span class="op" id="3074557">&amp;</span><span class="ident" id="3074558">MX</span><span class="op" id="3074560">{</span><span class="ident" id="3074561">r</span><span class="op" id="3074562">.</span><span class="ident" id="3074563">Mx</span><span class="op" id="3074565">,</span>&nbsp;<span class="ident" id="3074567">r</span><span class="op" id="3074568">.</span><span class="ident" id="3074569">Pref</span><span class="op" id="3074573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074579">byPref</span><span class="op" id="3074585">(</span><span class="ident" id="3074586">mx</span><span class="op" id="3074588">)</span><span class="op" id="3074589">.</span><span class="ident" id="3074590">sort</span><span class="op" id="3074594">(</span><span class="op" id="3074595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074598">return</span><br>
<span class="lineno">120</span><span class="op" id="3074605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3074608">func</span>&nbsp;<span class="ident" id="3074613">lookupNS</span><span class="op" id="3074621">(</span><span class="ident" id="3074622">name</span>&nbsp;<span class="builtintype" id="3074627">string</span><span class="op" id="3074633">)</span>&nbsp;<span class="op" id="3074635">(</span><span class="ident" id="3074636">ns</span>&nbsp;<span class="op" id="3074639">[</span><span class="op" id="3074640">]</span><span class="op" id="3074641">*</span><span class="ident" id="3074642">NS</span><span class="op" id="3074644">,</span>&nbsp;<span class="ident" id="3074646">err</span>&nbsp;<span class="builtintype" id="3074650">error</span><span class="op" id="3074655">)</span>&nbsp;<span class="op" id="3074657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074660">_</span><span class="op" id="3074661">,</span>&nbsp;<span class="ident" id="3074663">records</span><span class="op" id="3074670">,</span>&nbsp;<span class="ident" id="3074672">err</span>&nbsp;<span class="op" id="3074676">:=</span>&nbsp;<span class="ident" id="3074679">lookup</span><span class="op" id="3074685">(</span><span class="ident" id="3074686">name</span><span class="op" id="3074690">,</span>&nbsp;<span class="ident" id="3074692">dnsTypeNS</span><span class="op" id="3074701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074704">if</span>&nbsp;<span class="ident" id="3074707">err</span>&nbsp;<span class="op" id="3074711">!=</span>&nbsp;<span class="ident" id="3074714">nil</span>&nbsp;<span class="op" id="3074718">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074722">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074733">ns</span>&nbsp;<span class="op" id="3074736">=</span>&nbsp;<span class="builtinfunc" id="3074738">make</span><span class="op" id="3074742">(</span><span class="op" id="3074743">[</span><span class="op" id="3074744">]</span><span class="op" id="3074745">*</span><span class="ident" id="3074746">NS</span><span class="op" id="3074748">,</span>&nbsp;<span class="builtinfunc" id="3074750">len</span><span class="op" id="3074753">(</span><span class="ident" id="3074754">records</span><span class="op" id="3074761">)</span><span class="op" id="3074762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074765">for</span>&nbsp;<span class="ident" id="3074769">i</span><span class="op" id="3074770">,</span>&nbsp;<span class="ident" id="3074772">r</span>&nbsp;<span class="op" id="3074774">:=</span>&nbsp;<span class="keyword" id="3074777">range</span>&nbsp;<span class="ident" id="3074783">records</span>&nbsp;<span class="op" id="3074791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074795">r</span>&nbsp;<span class="op" id="3074797">:=</span>&nbsp;<span class="ident" id="3074800">r</span><span class="op" id="3074801">.</span><span class="op" id="3074802">(</span><span class="op" id="3074803">*</span><span class="ident" id="3074804">dnsRR_NS</span><span class="op" id="3074812">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074816">ns</span><span class="op" id="3074818">[</span><span class="ident" id="3074819">i</span><span class="op" id="3074820">]</span>&nbsp;<span class="op" id="3074822">=</span>&nbsp;<span class="op" id="3074824">&amp;</span><span class="ident" id="3074825">NS</span><span class="op" id="3074827">{</span><span class="ident" id="3074828">r</span><span class="op" id="3074829">.</span><span class="ident" id="3074830">Ns</span><span class="op" id="3074832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074838">return</span><br>
<span class="lineno"></span><span class="op" id="3074845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3074848">func</span>&nbsp;<span class="ident" id="3074853">lookupTXT</span><span class="op" id="3074862">(</span><span class="ident" id="3074863">name</span>&nbsp;<span class="builtintype" id="3074868">string</span><span class="op" id="3074874">)</span>&nbsp;<span class="op" id="3074876">(</span><span class="ident" id="3074877">txt</span>&nbsp;<span class="op" id="3074881">[</span><span class="op" id="3074882">]</span><span class="builtintype" id="3074883">string</span><span class="op" id="3074889">,</span>&nbsp;<span class="ident" id="3074891">err</span>&nbsp;<span class="builtintype" id="3074895">error</span><span class="op" id="3074900">)</span>&nbsp;<span class="op" id="3074902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074905">_</span><span class="op" id="3074906">,</span>&nbsp;<span class="ident" id="3074908">records</span><span class="op" id="3074915">,</span>&nbsp;<span class="ident" id="3074917">err</span>&nbsp;<span class="op" id="3074921">:=</span>&nbsp;<span class="ident" id="3074924">lookup</span><span class="op" id="3074930">(</span><span class="ident" id="3074931">name</span><span class="op" id="3074935">,</span>&nbsp;<span class="ident" id="3074937">dnsTypeTXT</span><span class="op" id="3074947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074950">if</span>&nbsp;<span class="ident" id="3074953">err</span>&nbsp;<span class="op" id="3074957">!=</span>&nbsp;<span class="ident" id="3074960">nil</span>&nbsp;<span class="op" id="3074964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3074968">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3074976">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3074979">txt</span>&nbsp;<span class="op" id="3074983">=</span>&nbsp;<span class="builtinfunc" id="3074985">make</span><span class="op" id="3074989">(</span><span class="op" id="3074990">[</span><span class="op" id="3074991">]</span><span class="builtintype" id="3074992">string</span><span class="op" id="3074998">,</span>&nbsp;<span class="builtinfunc" id="3075000">len</span><span class="op" id="3075003">(</span><span class="ident" id="3075004">records</span><span class="op" id="3075011">)</span><span class="op" id="3075012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075015">for</span>&nbsp;<span class="ident" id="3075019">i</span><span class="op" id="3075020">,</span>&nbsp;<span class="ident" id="3075022">r</span>&nbsp;<span class="op" id="3075024">:=</span>&nbsp;<span class="keyword" id="3075027">range</span>&nbsp;<span class="ident" id="3075033">records</span>&nbsp;<span class="op" id="3075041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075045">txt</span><span class="op" id="3075048">[</span><span class="ident" id="3075049">i</span><span class="op" id="3075050">]</span>&nbsp;<span class="op" id="3075052">=</span>&nbsp;<span class="ident" id="3075054">r</span><span class="op" id="3075055">.</span><span class="op" id="3075056">(</span><span class="op" id="3075057">*</span><span class="ident" id="3075058">dnsRR_TXT</span><span class="op" id="3075067">)</span><span class="op" id="3075068">.</span><span class="ident" id="3075069">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3075074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075077">return</span><br>
<span class="lineno">145</span><span class="op" id="3075084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3075087">func</span>&nbsp;<span class="ident" id="3075092">lookupAddr</span><span class="op" id="3075102">(</span><span class="ident" id="3075103">addr</span>&nbsp;<span class="builtintype" id="3075108">string</span><span class="op" id="3075114">)</span>&nbsp;<span class="op" id="3075116">(</span><span class="ident" id="3075117">name</span>&nbsp;<span class="op" id="3075122">[</span><span class="op" id="3075123">]</span><span class="builtintype" id="3075124">string</span><span class="op" id="3075130">,</span>&nbsp;<span class="ident" id="3075132">err</span>&nbsp;<span class="builtintype" id="3075136">error</span><span class="op" id="3075141">)</span>&nbsp;<span class="op" id="3075143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075146">name</span>&nbsp;<span class="op" id="3075151">=</span>&nbsp;<span class="ident" id="3075153">lookupStaticAddr</span><span class="op" id="3075169">(</span><span class="ident" id="3075170">addr</span><span class="op" id="3075174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075177">if</span>&nbsp;<span class="builtinfunc" id="3075180">len</span><span class="op" id="3075183">(</span><span class="ident" id="3075184">name</span><span class="op" id="3075188">)</span>&nbsp;<span class="op" id="3075190">&gt;</span>&nbsp;<span class="num" id="3075192">0</span>&nbsp;<span class="op" id="3075194">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075198">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3075206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075209">var</span>&nbsp;<span class="ident" id="3075213">arpa</span>&nbsp;<span class="builtintype" id="3075218">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075226">arpa</span><span class="op" id="3075230">,</span>&nbsp;<span class="ident" id="3075232">err</span>&nbsp;<span class="op" id="3075236">=</span>&nbsp;<span class="ident" id="3075238">reverseaddr</span><span class="op" id="3075249">(</span><span class="ident" id="3075250">addr</span><span class="op" id="3075254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075257">if</span>&nbsp;<span class="ident" id="3075260">err</span>&nbsp;<span class="op" id="3075264">!=</span>&nbsp;<span class="ident" id="3075267">nil</span>&nbsp;<span class="op" id="3075271">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075275">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3075283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075286">var</span>&nbsp;<span class="ident" id="3075290">records</span>&nbsp;<span class="op" id="3075298">[</span><span class="op" id="3075299">]</span><span class="ident" id="3075300">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075307">_</span><span class="op" id="3075308">,</span>&nbsp;<span class="ident" id="3075310">records</span><span class="op" id="3075317">,</span>&nbsp;<span class="ident" id="3075319">err</span>&nbsp;<span class="op" id="3075323">=</span>&nbsp;<span class="ident" id="3075325">lookup</span><span class="op" id="3075331">(</span><span class="ident" id="3075332">arpa</span><span class="op" id="3075336">,</span>&nbsp;<span class="ident" id="3075338">dnsTypePTR</span><span class="op" id="3075348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075351">if</span>&nbsp;<span class="ident" id="3075354">err</span>&nbsp;<span class="op" id="3075358">!=</span>&nbsp;<span class="ident" id="3075361">nil</span>&nbsp;<span class="op" id="3075365">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3075377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075380">name</span>&nbsp;<span class="op" id="3075385">=</span>&nbsp;<span class="builtinfunc" id="3075387">make</span><span class="op" id="3075391">(</span><span class="op" id="3075392">[</span><span class="op" id="3075393">]</span><span class="builtintype" id="3075394">string</span><span class="op" id="3075400">,</span>&nbsp;<span class="builtinfunc" id="3075402">len</span><span class="op" id="3075405">(</span><span class="ident" id="3075406">records</span><span class="op" id="3075413">)</span><span class="op" id="3075414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075417">for</span>&nbsp;<span class="ident" id="3075421">i</span>&nbsp;<span class="op" id="3075423">:=</span>&nbsp;<span class="keyword" id="3075426">range</span>&nbsp;<span class="ident" id="3075432">records</span>&nbsp;<span class="op" id="3075440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075444">r</span>&nbsp;<span class="op" id="3075446">:=</span>&nbsp;<span class="ident" id="3075449">records</span><span class="op" id="3075456">[</span><span class="ident" id="3075457">i</span><span class="op" id="3075458">]</span><span class="op" id="3075459">.</span><span class="op" id="3075460">(</span><span class="op" id="3075461">*</span><span class="ident" id="3075462">dnsRR_PTR</span><span class="op" id="3075471">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3075475">name</span><span class="op" id="3075479">[</span><span class="ident" id="3075480">i</span><span class="op" id="3075481">]</span>&nbsp;<span class="op" id="3075483">=</span>&nbsp;<span class="ident" id="3075485">r</span><span class="op" id="3075486">.</span><span class="ident" id="3075487">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3075492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3075495">return</span><br>
<span class="lineno"></span><span class="op" id="3075502">}</span>
</div>
</body>
</html>
