<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/scanner</h2>
<ul>
<li><a href="/gostd/go/scanner/errors.go.html">errors.go</a></li>
<li><a href="/gostd/go/scanner/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/go/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2992601">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2992656">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2992710">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2992761">package</span>&nbsp;<span class="ident" id="2992769">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2992778">import</span>&nbsp;<span class="op" id="2992785">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2992788">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2992795">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2992807">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2992813">&#34;sort&#34;</span><br>
<span class="lineno"></span><span class="op" id="2992820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2992823">//&nbsp;In&nbsp;an&nbsp;ErrorList,&nbsp;an&nbsp;error&nbsp;is&nbsp;represented&nbsp;by&nbsp;an&nbsp;*Error.</span><br>
<span class="lineno">15</span><span class="comment" id="2992881">//&nbsp;The&nbsp;position&nbsp;Pos,&nbsp;if&nbsp;valid,&nbsp;points&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2992939">//&nbsp;the&nbsp;offending&nbsp;token,&nbsp;and&nbsp;the&nbsp;error&nbsp;condition&nbsp;is&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="2993000">//&nbsp;by&nbsp;Msg.</span><br>
<span class="lineno"></span><span class="comment" id="2993011">//</span><br>
<span class="lineno"></span><span class="keyword" id="2993014">type</span>&nbsp;<span class="ident" id="2993019">Error</span>&nbsp;<span class="keyword" id="2993025">struct</span>&nbsp;<span class="op" id="2993032">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993035">Pos</span>&nbsp;<span class="ident" id="2993039">token</span><span class="op" id="2993044">.</span><span class="ident" id="2993045">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993055">Msg</span>&nbsp;<span class="builtintype" id="2993059">string</span><br>
<span class="lineno"></span><span class="op" id="2993066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2993069">//&nbsp;Error&nbsp;implements&nbsp;the&nbsp;error&nbsp;interface.</span><br>
<span class="lineno">25</span><span class="keyword" id="2993110">func</span>&nbsp;<span class="op" id="2993115">(</span><span class="ident" id="2993116">e</span>&nbsp;<span class="ident" id="2993118">Error</span><span class="op" id="2993123">)</span>&nbsp;<span class="ident" id="2993125">Error</span><span class="op" id="2993130">(</span><span class="op" id="2993131">)</span>&nbsp;<span class="builtintype" id="2993133">string</span>&nbsp;<span class="op" id="2993140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993143">if</span>&nbsp;<span class="ident" id="2993146">e</span><span class="op" id="2993147">.</span><span class="ident" id="2993148">Pos</span><span class="op" id="2993151">.</span><span class="ident" id="2993152">Filename</span>&nbsp;<span class="op" id="2993161">!=</span>&nbsp;<span class="string" id="2993164">&#34;&#34;</span>&nbsp;<span class="op" id="2993167">||</span>&nbsp;<span class="ident" id="2993170">e</span><span class="op" id="2993171">.</span><span class="ident" id="2993172">Pos</span><span class="op" id="2993175">.</span><span class="ident" id="2993176">IsValid</span><span class="op" id="2993183">(</span><span class="op" id="2993184">)</span>&nbsp;<span class="op" id="2993186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993190">//&nbsp;don&#39;t&nbsp;print&nbsp;&#34;&lt;unknown&nbsp;position&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993228">//&nbsp;TODO(gri)&nbsp;reconsider&nbsp;the&nbsp;semantics&nbsp;of&nbsp;Position.IsValid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993288">return</span>&nbsp;<span class="ident" id="2993295">e</span><span class="op" id="2993296">.</span><span class="ident" id="2993297">Pos</span><span class="op" id="2993300">.</span><span class="ident" id="2993301">String</span><span class="op" id="2993307">(</span><span class="op" id="2993308">)</span>&nbsp;<span class="op" id="2993310">+</span>&nbsp;<span class="string" id="2993312">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2993317">+</span>&nbsp;<span class="ident" id="2993319">e</span><span class="op" id="2993320">.</span><span class="ident" id="2993321">Msg</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2993329">return</span>&nbsp;<span class="ident" id="2993336">e</span><span class="op" id="2993337">.</span><span class="ident" id="2993338">Msg</span><br>
<span class="lineno"></span><span class="op" id="2993342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2993345">//&nbsp;ErrorList&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;*Errors.</span><br>
<span class="lineno">35</span><span class="comment" id="2993380">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;an&nbsp;ErrorList&nbsp;is&nbsp;an&nbsp;empty&nbsp;ErrorList&nbsp;ready&nbsp;to&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="2993451">//</span><br>
<span class="lineno"></span><span class="keyword" id="2993454">type</span>&nbsp;<span class="ident" id="2993459">ErrorList</span>&nbsp;<span class="op" id="2993469">[</span><span class="op" id="2993470">]</span><span class="op" id="2993471">*</span><span class="ident" id="2993472">Error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2993479">//&nbsp;Add&nbsp;adds&nbsp;an&nbsp;Error&nbsp;with&nbsp;given&nbsp;position&nbsp;and&nbsp;error&nbsp;message&nbsp;to&nbsp;an&nbsp;ErrorList.</span><br>
<span class="lineno">40</span><span class="keyword" id="2993555">func</span>&nbsp;<span class="op" id="2993560">(</span><span class="ident" id="2993561">p</span>&nbsp;<span class="op" id="2993563">*</span><span class="ident" id="2993564">ErrorList</span><span class="op" id="2993573">)</span>&nbsp;<span class="ident" id="2993575">Add</span><span class="op" id="2993578">(</span><span class="ident" id="2993579">pos</span>&nbsp;<span class="ident" id="2993583">token</span><span class="op" id="2993588">.</span><span class="ident" id="2993589">Position</span><span class="op" id="2993597">,</span>&nbsp;<span class="ident" id="2993599">msg</span>&nbsp;<span class="builtintype" id="2993603">string</span><span class="op" id="2993609">)</span>&nbsp;<span class="op" id="2993611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2993614">*</span><span class="ident" id="2993615">p</span>&nbsp;<span class="op" id="2993617">=</span>&nbsp;<span class="builtinfunc" id="2993619">append</span><span class="op" id="2993625">(</span><span class="op" id="2993626">*</span><span class="ident" id="2993627">p</span><span class="op" id="2993628">,</span>&nbsp;<span class="op" id="2993630">&amp;</span><span class="ident" id="2993631">Error</span><span class="op" id="2993636">{</span><span class="ident" id="2993637">pos</span><span class="op" id="2993640">,</span>&nbsp;<span class="ident" id="2993642">msg</span><span class="op" id="2993645">}</span><span class="op" id="2993646">)</span><br>
<span class="lineno"></span><span class="op" id="2993648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2993651">//&nbsp;Reset&nbsp;resets&nbsp;an&nbsp;ErrorList&nbsp;to&nbsp;no&nbsp;errors.</span><br>
<span class="lineno">45</span><span class="keyword" id="2993694">func</span>&nbsp;<span class="op" id="2993699">(</span><span class="ident" id="2993700">p</span>&nbsp;<span class="op" id="2993702">*</span><span class="ident" id="2993703">ErrorList</span><span class="op" id="2993712">)</span>&nbsp;<span class="ident" id="2993714">Reset</span><span class="op" id="2993719">(</span><span class="op" id="2993720">)</span>&nbsp;<span class="op" id="2993722">{</span>&nbsp;<span class="op" id="2993724">*</span><span class="ident" id="2993725">p</span>&nbsp;<span class="op" id="2993727">=</span>&nbsp;<span class="op" id="2993729">(</span><span class="op" id="2993730">*</span><span class="ident" id="2993731">p</span><span class="op" id="2993732">)</span><span class="op" id="2993733">[</span><span class="num" id="2993734">0</span><span class="op" id="2993735">:</span><span class="num" id="2993736">0</span><span class="op" id="2993737">]</span>&nbsp;<span class="op" id="2993739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2993742">//&nbsp;ErrorList&nbsp;implements&nbsp;the&nbsp;sort&nbsp;Interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2993786">func</span>&nbsp;<span class="op" id="2993791">(</span><span class="ident" id="2993792">p</span>&nbsp;<span class="ident" id="2993794">ErrorList</span><span class="op" id="2993803">)</span>&nbsp;<span class="ident" id="2993805">Len</span><span class="op" id="2993808">(</span><span class="op" id="2993809">)</span>&nbsp;<span class="builtintype" id="2993811">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2993820">{</span>&nbsp;<span class="keyword" id="2993822">return</span>&nbsp;<span class="builtinfunc" id="2993829">len</span><span class="op" id="2993832">(</span><span class="ident" id="2993833">p</span><span class="op" id="2993834">)</span>&nbsp;<span class="op" id="2993836">}</span><br>
<span class="lineno"></span><span class="keyword" id="2993838">func</span>&nbsp;<span class="op" id="2993843">(</span><span class="ident" id="2993844">p</span>&nbsp;<span class="ident" id="2993846">ErrorList</span><span class="op" id="2993855">)</span>&nbsp;<span class="ident" id="2993857">Swap</span><span class="op" id="2993861">(</span><span class="ident" id="2993862">i</span><span class="op" id="2993863">,</span>&nbsp;<span class="ident" id="2993865">j</span>&nbsp;<span class="builtintype" id="2993867">int</span><span class="op" id="2993870">)</span>&nbsp;<span class="op" id="2993872">{</span>&nbsp;<span class="ident" id="2993874">p</span><span class="op" id="2993875">[</span><span class="ident" id="2993876">i</span><span class="op" id="2993877">]</span><span class="op" id="2993878">,</span>&nbsp;<span class="ident" id="2993880">p</span><span class="op" id="2993881">[</span><span class="ident" id="2993882">j</span><span class="op" id="2993883">]</span>&nbsp;<span class="op" id="2993885">=</span>&nbsp;<span class="ident" id="2993887">p</span><span class="op" id="2993888">[</span><span class="ident" id="2993889">j</span><span class="op" id="2993890">]</span><span class="op" id="2993891">,</span>&nbsp;<span class="ident" id="2993893">p</span><span class="op" id="2993894">[</span><span class="ident" id="2993895">i</span><span class="op" id="2993896">]</span>&nbsp;<span class="op" id="2993898">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="2993901">func</span>&nbsp;<span class="op" id="2993906">(</span><span class="ident" id="2993907">p</span>&nbsp;<span class="ident" id="2993909">ErrorList</span><span class="op" id="2993918">)</span>&nbsp;<span class="ident" id="2993920">Less</span><span class="op" id="2993924">(</span><span class="ident" id="2993925">i</span><span class="op" id="2993926">,</span>&nbsp;<span class="ident" id="2993928">j</span>&nbsp;<span class="builtintype" id="2993930">int</span><span class="op" id="2993933">)</span>&nbsp;<span class="builtintype" id="2993935">bool</span>&nbsp;<span class="op" id="2993940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993943">e</span>&nbsp;<span class="op" id="2993945">:=</span>&nbsp;<span class="op" id="2993948">&amp;</span><span class="ident" id="2993949">p</span><span class="op" id="2993950">[</span><span class="ident" id="2993951">i</span><span class="op" id="2993952">]</span><span class="op" id="2993953">.</span><span class="ident" id="2993954">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2993959">f</span>&nbsp;<span class="op" id="2993961">:=</span>&nbsp;<span class="op" id="2993964">&amp;</span><span class="ident" id="2993965">p</span><span class="op" id="2993966">[</span><span class="ident" id="2993967">j</span><span class="op" id="2993968">]</span><span class="op" id="2993969">.</span><span class="ident" id="2993970">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2993975">//&nbsp;Note&nbsp;that&nbsp;it&nbsp;is&nbsp;not&nbsp;sufficient&nbsp;to&nbsp;simply&nbsp;compare&nbsp;file&nbsp;offsets&nbsp;because</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2994049">//&nbsp;the&nbsp;offsets&nbsp;do&nbsp;not&nbsp;reflect&nbsp;modified&nbsp;line&nbsp;information&nbsp;(through&nbsp;//line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2994122">//&nbsp;comments).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994137">if</span>&nbsp;<span class="ident" id="2994140">e</span><span class="op" id="2994141">.</span><span class="ident" id="2994142">Filename</span>&nbsp;<span class="op" id="2994151">&lt;</span>&nbsp;<span class="ident" id="2994153">f</span><span class="op" id="2994154">.</span><span class="ident" id="2994155">Filename</span>&nbsp;<span class="op" id="2994164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994168">return</span>&nbsp;<span class="builtintype" id="2994175">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994181">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994184">if</span>&nbsp;<span class="ident" id="2994187">e</span><span class="op" id="2994188">.</span><span class="ident" id="2994189">Filename</span>&nbsp;<span class="op" id="2994198">==</span>&nbsp;<span class="ident" id="2994201">f</span><span class="op" id="2994202">.</span><span class="ident" id="2994203">Filename</span>&nbsp;<span class="op" id="2994212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994216">if</span>&nbsp;<span class="ident" id="2994219">e</span><span class="op" id="2994220">.</span><span class="ident" id="2994221">Line</span>&nbsp;<span class="op" id="2994226">&lt;</span>&nbsp;<span class="ident" id="2994228">f</span><span class="op" id="2994229">.</span><span class="ident" id="2994230">Line</span>&nbsp;<span class="op" id="2994235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994240">return</span>&nbsp;<span class="builtintype" id="2994247">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994258">if</span>&nbsp;<span class="ident" id="2994261">e</span><span class="op" id="2994262">.</span><span class="ident" id="2994263">Line</span>&nbsp;<span class="op" id="2994268">==</span>&nbsp;<span class="ident" id="2994271">f</span><span class="op" id="2994272">.</span><span class="ident" id="2994273">Line</span>&nbsp;<span class="op" id="2994278">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994283">return</span>&nbsp;<span class="ident" id="2994290">e</span><span class="op" id="2994291">.</span><span class="ident" id="2994292">Column</span>&nbsp;<span class="op" id="2994299">&lt;</span>&nbsp;<span class="ident" id="2994301">f</span><span class="op" id="2994302">.</span><span class="ident" id="2994303">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994318">return</span>&nbsp;<span class="builtintype" id="2994325">false</span><br>
<span class="lineno"></span><span class="op" id="2994331">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="2994334">//&nbsp;Sort&nbsp;sorts&nbsp;an&nbsp;ErrorList.&nbsp;*Error&nbsp;entries&nbsp;are&nbsp;sorted&nbsp;by&nbsp;position,</span><br>
<span class="lineno"></span><span class="comment" id="2994401">//&nbsp;other&nbsp;errors&nbsp;are&nbsp;sorted&nbsp;by&nbsp;error&nbsp;message,&nbsp;and&nbsp;before&nbsp;any&nbsp;*Error</span><br>
<span class="lineno"></span><span class="comment" id="2994468">//&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="2994478">//</span><br>
<span class="lineno">75</span><span class="keyword" id="2994481">func</span>&nbsp;<span class="op" id="2994486">(</span><span class="ident" id="2994487">p</span>&nbsp;<span class="ident" id="2994489">ErrorList</span><span class="op" id="2994498">)</span>&nbsp;<span class="ident" id="2994500">Sort</span><span class="op" id="2994504">(</span><span class="op" id="2994505">)</span>&nbsp;<span class="op" id="2994507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994510">sort</span><span class="op" id="2994514">.</span><span class="ident" id="2994515">Sort</span><span class="op" id="2994519">(</span><span class="ident" id="2994520">p</span><span class="op" id="2994521">)</span><br>
<span class="lineno"></span><span class="op" id="2994523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2994526">//&nbsp;RemoveMultiples&nbsp;sorts&nbsp;an&nbsp;ErrorList&nbsp;and&nbsp;removes&nbsp;all&nbsp;but&nbsp;the&nbsp;first&nbsp;error&nbsp;per&nbsp;line.</span><br>
<span class="lineno">80</span><span class="keyword" id="2994610">func</span>&nbsp;<span class="op" id="2994615">(</span><span class="ident" id="2994616">p</span>&nbsp;<span class="op" id="2994618">*</span><span class="ident" id="2994619">ErrorList</span><span class="op" id="2994628">)</span>&nbsp;<span class="ident" id="2994630">RemoveMultiples</span><span class="op" id="2994645">(</span><span class="op" id="2994646">)</span>&nbsp;<span class="op" id="2994648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994651">sort</span><span class="op" id="2994655">.</span><span class="ident" id="2994656">Sort</span><span class="op" id="2994660">(</span><span class="ident" id="2994661">p</span><span class="op" id="2994662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994665">var</span>&nbsp;<span class="ident" id="2994669">last</span>&nbsp;<span class="ident" id="2994674">token</span><span class="op" id="2994679">.</span><span class="ident" id="2994680">Position</span>&nbsp;<span class="comment" id="2994689">//&nbsp;initial&nbsp;last.Line&nbsp;is&nbsp;!=&nbsp;any&nbsp;legal&nbsp;error&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994738">i</span>&nbsp;<span class="op" id="2994740">:=</span>&nbsp;<span class="num" id="2994743">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994746">for</span>&nbsp;<span class="ident" id="2994750">_</span><span class="op" id="2994751">,</span>&nbsp;<span class="ident" id="2994753">e</span>&nbsp;<span class="op" id="2994755">:=</span>&nbsp;<span class="keyword" id="2994758">range</span>&nbsp;<span class="op" id="2994764">*</span><span class="ident" id="2994765">p</span>&nbsp;<span class="op" id="2994767">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994771">if</span>&nbsp;<span class="ident" id="2994774">e</span><span class="op" id="2994775">.</span><span class="ident" id="2994776">Pos</span><span class="op" id="2994779">.</span><span class="ident" id="2994780">Filename</span>&nbsp;<span class="op" id="2994789">!=</span>&nbsp;<span class="ident" id="2994792">last</span><span class="op" id="2994796">.</span><span class="ident" id="2994797">Filename</span>&nbsp;<span class="op" id="2994806">||</span>&nbsp;<span class="ident" id="2994809">e</span><span class="op" id="2994810">.</span><span class="ident" id="2994811">Pos</span><span class="op" id="2994814">.</span><span class="ident" id="2994815">Line</span>&nbsp;<span class="op" id="2994820">!=</span>&nbsp;<span class="ident" id="2994823">last</span><span class="op" id="2994827">.</span><span class="ident" id="2994828">Line</span>&nbsp;<span class="op" id="2994833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994838">last</span>&nbsp;<span class="op" id="2994843">=</span>&nbsp;<span class="ident" id="2994845">e</span><span class="op" id="2994846">.</span><span class="ident" id="2994847">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994854">(</span><span class="op" id="2994855">*</span><span class="ident" id="2994856">p</span><span class="op" id="2994857">)</span><span class="op" id="2994858">[</span><span class="ident" id="2994859">i</span><span class="op" id="2994860">]</span>&nbsp;<span class="op" id="2994862">=</span>&nbsp;<span class="ident" id="2994864">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2994869">i</span><span class="op" id="2994870">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994875">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2994881">(</span><span class="op" id="2994882">*</span><span class="ident" id="2994883">p</span><span class="op" id="2994884">)</span>&nbsp;<span class="op" id="2994886">=</span>&nbsp;<span class="op" id="2994888">(</span><span class="op" id="2994889">*</span><span class="ident" id="2994890">p</span><span class="op" id="2994891">)</span><span class="op" id="2994892">[</span><span class="num" id="2994893">0</span><span class="op" id="2994894">:</span><span class="ident" id="2994895">i</span><span class="op" id="2994896">]</span><br>
<span class="lineno"></span><span class="op" id="2994898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2994901">//&nbsp;An&nbsp;ErrorList&nbsp;implements&nbsp;the&nbsp;error&nbsp;interface.</span><br>
<span class="lineno">95</span><span class="keyword" id="2994949">func</span>&nbsp;<span class="op" id="2994954">(</span><span class="ident" id="2994955">p</span>&nbsp;<span class="ident" id="2994957">ErrorList</span><span class="op" id="2994966">)</span>&nbsp;<span class="ident" id="2994968">Error</span><span class="op" id="2994973">(</span><span class="op" id="2994974">)</span>&nbsp;<span class="builtintype" id="2994976">string</span>&nbsp;<span class="op" id="2994983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2994986">switch</span>&nbsp;<span class="builtinfunc" id="2994993">len</span><span class="op" id="2994996">(</span><span class="ident" id="2994997">p</span><span class="op" id="2994998">)</span>&nbsp;<span class="op" id="2995000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995003">case</span>&nbsp;<span class="num" id="2995008">0</span><span class="op" id="2995009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995013">return</span>&nbsp;<span class="string" id="2995020">&#34;no&nbsp;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995033">case</span>&nbsp;<span class="num" id="2995038">1</span><span class="op" id="2995039">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995043">return</span>&nbsp;<span class="ident" id="2995050">p</span><span class="op" id="2995051">[</span><span class="num" id="2995052">0</span><span class="op" id="2995053">]</span><span class="op" id="2995054">.</span><span class="ident" id="2995055">Error</span><span class="op" id="2995060">(</span><span class="op" id="2995061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995067">return</span>&nbsp;<span class="ident" id="2995074">fmt</span><span class="op" id="2995077">.</span><span class="ident" id="2995078">Sprintf</span><span class="op" id="2995085">(</span><span class="string" id="2995086">&#34;%s&nbsp;(and&nbsp;%d&nbsp;more&nbsp;errors)&#34;</span><span class="op" id="2995111">,</span>&nbsp;<span class="ident" id="2995113">p</span><span class="op" id="2995114">[</span><span class="num" id="2995115">0</span><span class="op" id="2995116">]</span><span class="op" id="2995117">,</span>&nbsp;<span class="builtinfunc" id="2995119">len</span><span class="op" id="2995122">(</span><span class="ident" id="2995123">p</span><span class="op" id="2995124">)</span><span class="op" id="2995125">-</span><span class="num" id="2995126">1</span><span class="op" id="2995127">)</span><br>
<span class="lineno"></span><span class="op" id="2995129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="2995132">//&nbsp;Err&nbsp;returns&nbsp;an&nbsp;error&nbsp;equivalent&nbsp;to&nbsp;this&nbsp;error&nbsp;list.</span><br>
<span class="lineno"></span><span class="comment" id="2995187">//&nbsp;If&nbsp;the&nbsp;list&nbsp;is&nbsp;empty,&nbsp;Err&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2995229">func</span>&nbsp;<span class="op" id="2995234">(</span><span class="ident" id="2995235">p</span>&nbsp;<span class="ident" id="2995237">ErrorList</span><span class="op" id="2995246">)</span>&nbsp;<span class="ident" id="2995248">Err</span><span class="op" id="2995251">(</span><span class="op" id="2995252">)</span>&nbsp;<span class="builtintype" id="2995254">error</span>&nbsp;<span class="op" id="2995260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995263">if</span>&nbsp;<span class="builtinfunc" id="2995266">len</span><span class="op" id="2995269">(</span><span class="ident" id="2995270">p</span><span class="op" id="2995271">)</span>&nbsp;<span class="op" id="2995273">==</span>&nbsp;<span class="num" id="2995276">0</span>&nbsp;<span class="op" id="2995278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995282">return</span>&nbsp;<span class="ident" id="2995289">nil</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995297">return</span>&nbsp;<span class="ident" id="2995304">p</span><br>
<span class="lineno"></span><span class="op" id="2995306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2995309">//&nbsp;PrintError&nbsp;is&nbsp;a&nbsp;utility&nbsp;function&nbsp;that&nbsp;prints&nbsp;a&nbsp;list&nbsp;of&nbsp;errors&nbsp;to&nbsp;w,</span><br>
<span class="lineno">115</span><span class="comment" id="2995380">//&nbsp;one&nbsp;error&nbsp;per&nbsp;line,&nbsp;if&nbsp;the&nbsp;err&nbsp;parameter&nbsp;is&nbsp;an&nbsp;ErrorList.&nbsp;Otherwise</span><br>
<span class="lineno"></span><span class="comment" id="2995451">//&nbsp;it&nbsp;prints&nbsp;the&nbsp;err&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2995480">//</span><br>
<span class="lineno"></span><span class="keyword" id="2995483">func</span>&nbsp;<span class="ident" id="2995488">PrintError</span><span class="op" id="2995498">(</span><span class="ident" id="2995499">w</span>&nbsp;<span class="ident" id="2995501">io</span><span class="op" id="2995503">.</span><span class="ident" id="2995504">Writer</span><span class="op" id="2995510">,</span>&nbsp;<span class="ident" id="2995512">err</span>&nbsp;<span class="builtintype" id="2995516">error</span><span class="op" id="2995521">)</span>&nbsp;<span class="op" id="2995523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995526">if</span>&nbsp;<span class="ident" id="2995529">list</span><span class="op" id="2995533">,</span>&nbsp;<span class="ident" id="2995535">ok</span>&nbsp;<span class="op" id="2995538">:=</span>&nbsp;<span class="ident" id="2995541">err</span><span class="op" id="2995544">.</span><span class="op" id="2995545">(</span><span class="ident" id="2995546">ErrorList</span><span class="op" id="2995555">)</span><span class="op" id="2995556">;</span>&nbsp;<span class="ident" id="2995558">ok</span>&nbsp;<span class="op" id="2995561">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2995565">for</span>&nbsp;<span class="ident" id="2995569">_</span><span class="op" id="2995570">,</span>&nbsp;<span class="ident" id="2995572">e</span>&nbsp;<span class="op" id="2995574">:=</span>&nbsp;<span class="keyword" id="2995577">range</span>&nbsp;<span class="ident" id="2995583">list</span>&nbsp;<span class="op" id="2995588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995593">fmt</span><span class="op" id="2995596">.</span><span class="ident" id="2995597">Fprintf</span><span class="op" id="2995604">(</span><span class="ident" id="2995605">w</span><span class="op" id="2995606">,</span>&nbsp;<span class="string" id="2995608">&#34;%s\n&#34;</span><span class="op" id="2995614">,</span>&nbsp;<span class="ident" id="2995616">e</span><span class="op" id="2995617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995624">}</span>&nbsp;<span class="keyword" id="2995626">else</span>&nbsp;<span class="keyword" id="2995631">if</span>&nbsp;<span class="ident" id="2995634">err</span>&nbsp;<span class="op" id="2995638">!=</span>&nbsp;<span class="ident" id="2995641">nil</span>&nbsp;<span class="op" id="2995645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2995649">fmt</span><span class="op" id="2995652">.</span><span class="ident" id="2995653">Fprintf</span><span class="op" id="2995660">(</span><span class="ident" id="2995661">w</span><span class="op" id="2995662">,</span>&nbsp;<span class="string" id="2995664">&#34;%s\n&#34;</span><span class="op" id="2995670">,</span>&nbsp;<span class="ident" id="2995672">err</span><span class="op" id="2995675">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2995678">}</span><br>
<span class="lineno"></span><span class="op" id="2995680">}</span>
</div>
</body>
</html>
