<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html" class="current">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4264084">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4264139">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4264193">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4264244">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4264314">package</span>&nbsp;<span class="ident" id="4264322">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4264328">import</span>&nbsp;<span class="op" id="4264335">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4264338">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4264347">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4264353">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4264363">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4264366">var</span>&nbsp;<span class="ident" id="4264370">typeFiles</span>&nbsp;<span class="op" id="4264380">=</span>&nbsp;<span class="op" id="4264382">[</span><span class="op" id="4264383">]</span><span class="builtintype" id="4264384">string</span><span class="op" id="4264390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4264393">&#34;/etc/mime.types&#34;</span><span class="op" id="4264410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4264413">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="4264438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4264441">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="4264465">,</span><br>
<span class="lineno"></span><span class="op" id="4264467">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4264470">func</span>&nbsp;<span class="ident" id="4264475">loadMimeFile</span><span class="op" id="4264487">(</span><span class="ident" id="4264488">filename</span>&nbsp;<span class="builtintype" id="4264497">string</span><span class="op" id="4264503">)</span>&nbsp;<span class="op" id="4264505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264508">f</span><span class="op" id="4264509">,</span>&nbsp;<span class="ident" id="4264511">err</span>&nbsp;<span class="op" id="4264515">:=</span>&nbsp;<span class="ident" id="4264518">os</span><span class="op" id="4264520">.</span><span class="ident" id="4264521">Open</span><span class="op" id="4264525">(</span><span class="ident" id="4264526">filename</span><span class="op" id="4264534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264537">if</span>&nbsp;<span class="ident" id="4264540">err</span>&nbsp;<span class="op" id="4264544">!=</span>&nbsp;<span class="ident" id="4264547">nil</span>&nbsp;<span class="op" id="4264551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264555">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264566">defer</span>&nbsp;<span class="ident" id="4264572">f</span><span class="op" id="4264573">.</span><span class="ident" id="4264574">Close</span><span class="op" id="4264579">(</span><span class="op" id="4264580">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264584">scanner</span>&nbsp;<span class="op" id="4264592">:=</span>&nbsp;<span class="ident" id="4264595">bufio</span><span class="op" id="4264600">.</span><span class="ident" id="4264601">NewScanner</span><span class="op" id="4264611">(</span><span class="ident" id="4264612">f</span><span class="op" id="4264613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264616">for</span>&nbsp;<span class="ident" id="4264620">scanner</span><span class="op" id="4264627">.</span><span class="ident" id="4264628">Scan</span><span class="op" id="4264632">(</span><span class="op" id="4264633">)</span>&nbsp;<span class="op" id="4264635">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264639">fields</span>&nbsp;<span class="op" id="4264646">:=</span>&nbsp;<span class="ident" id="4264649">strings</span><span class="op" id="4264656">.</span><span class="ident" id="4264657">Fields</span><span class="op" id="4264663">(</span><span class="ident" id="4264664">scanner</span><span class="op" id="4264671">.</span><span class="ident" id="4264672">Text</span><span class="op" id="4264676">(</span><span class="op" id="4264677">)</span><span class="op" id="4264678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264682">if</span>&nbsp;<span class="builtinfunc" id="4264685">len</span><span class="op" id="4264688">(</span><span class="ident" id="4264689">fields</span><span class="op" id="4264695">)</span>&nbsp;<span class="op" id="4264697">&lt;=</span>&nbsp;<span class="num" id="4264700">1</span>&nbsp;<span class="op" id="4264702">||</span>&nbsp;<span class="ident" id="4264705">fields</span><span class="op" id="4264711">[</span><span class="num" id="4264712">0</span><span class="op" id="4264713">]</span><span class="op" id="4264714">[</span><span class="num" id="4264715">0</span><span class="op" id="4264716">]</span>&nbsp;<span class="op" id="4264718">==</span>&nbsp;<span class="string" id="4264721">&#39;#&#39;</span>&nbsp;<span class="op" id="4264725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264730">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264745">mimeType</span>&nbsp;<span class="op" id="4264754">:=</span>&nbsp;<span class="ident" id="4264757">fields</span><span class="op" id="4264763">[</span><span class="num" id="4264764">0</span><span class="op" id="4264765">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264769">for</span>&nbsp;<span class="ident" id="4264773">_</span><span class="op" id="4264774">,</span>&nbsp;<span class="ident" id="4264776">ext</span>&nbsp;<span class="op" id="4264780">:=</span>&nbsp;<span class="keyword" id="4264783">range</span>&nbsp;<span class="ident" id="4264789">fields</span><span class="op" id="4264795">[</span><span class="num" id="4264796">1</span><span class="op" id="4264797">:</span><span class="op" id="4264798">]</span>&nbsp;<span class="op" id="4264800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264805">if</span>&nbsp;<span class="ident" id="4264808">ext</span><span class="op" id="4264811">[</span><span class="num" id="4264812">0</span><span class="op" id="4264813">]</span>&nbsp;<span class="op" id="4264815">==</span>&nbsp;<span class="string" id="4264818">&#39;#&#39;</span>&nbsp;<span class="op" id="4264822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264828">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264842">setExtensionType</span><span class="op" id="4264858">(</span><span class="string" id="4264859">&#34;.&#34;</span><span class="op" id="4264862">+</span><span class="ident" id="4264863">ext</span><span class="op" id="4264866">,</span>&nbsp;<span class="ident" id="4264868">mimeType</span><span class="op" id="4264876">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264886">if</span>&nbsp;<span class="ident" id="4264889">err</span>&nbsp;<span class="op" id="4264893">:=</span>&nbsp;<span class="ident" id="4264896">scanner</span><span class="op" id="4264903">.</span><span class="ident" id="4264904">Err</span><span class="op" id="4264907">(</span><span class="op" id="4264908">)</span><span class="op" id="4264909">;</span>&nbsp;<span class="ident" id="4264911">err</span>&nbsp;<span class="op" id="4264915">!=</span>&nbsp;<span class="ident" id="4264918">nil</span>&nbsp;<span class="op" id="4264922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4264926">panic</span><span class="op" id="4264931">(</span><span class="ident" id="4264932">err</span><span class="op" id="4264935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264938">}</span><br>
<span class="lineno">45</span><span class="op" id="4264940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4264943">func</span>&nbsp;<span class="ident" id="4264948">initMime</span><span class="op" id="4264956">(</span><span class="op" id="4264957">)</span>&nbsp;<span class="op" id="4264959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264962">for</span>&nbsp;<span class="ident" id="4264966">_</span><span class="op" id="4264967">,</span>&nbsp;<span class="ident" id="4264969">filename</span>&nbsp;<span class="op" id="4264978">:=</span>&nbsp;<span class="keyword" id="4264981">range</span>&nbsp;<span class="ident" id="4264987">typeFiles</span>&nbsp;<span class="op" id="4264997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265001">loadMimeFile</span><span class="op" id="4265013">(</span><span class="ident" id="4265014">filename</span><span class="op" id="4265022">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4265025">}</span><br>
<span class="lineno"></span><span class="op" id="4265027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4265030">func</span>&nbsp;<span class="ident" id="4265035">initMimeForTests</span><span class="op" id="4265051">(</span><span class="op" id="4265052">)</span>&nbsp;<span class="keyword" id="4265054">map</span><span class="op" id="4265057">[</span><span class="builtintype" id="4265058">string</span><span class="op" id="4265064">]</span><span class="builtintype" id="4265065">string</span>&nbsp;<span class="op" id="4265072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265075">typeFiles</span>&nbsp;<span class="op" id="4265085">=</span>&nbsp;<span class="op" id="4265087">[</span><span class="op" id="4265088">]</span><span class="builtintype" id="4265089">string</span><span class="op" id="4265095">{</span><span class="string" id="4265096">&#34;testdata/test.types&#34;</span><span class="op" id="4265117">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265120">return</span>&nbsp;<span class="keyword" id="4265127">map</span><span class="op" id="4265130">[</span><span class="builtintype" id="4265131">string</span><span class="op" id="4265137">]</span><span class="builtintype" id="4265138">string</span><span class="op" id="4265144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4265148">&#34;.T1&#34;</span><span class="op" id="4265153">:</span>&nbsp;&nbsp;<span class="string" id="4265156">&#34;application/test&#34;</span><span class="op" id="4265174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4265178">&#34;.t2&#34;</span><span class="op" id="4265183">:</span>&nbsp;&nbsp;<span class="string" id="4265186">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="4265212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4265216">&#34;.png&#34;</span><span class="op" id="4265222">:</span>&nbsp;<span class="string" id="4265224">&#34;image/png&#34;</span><span class="op" id="4265235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4265238">}</span><br>
<span class="lineno">60</span><span class="op" id="4265240">}</span>
</div>
</body>
</html>
