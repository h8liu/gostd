<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html" class="current">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6146789">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6146844">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6146898">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6146949">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6147020">package</span>&nbsp;<span class="ident" id="6147028">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6147036">import</span>&nbsp;<span class="op" id="6147043">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6147046">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6147055">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6147061">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6147072">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6147082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6147085">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6147106">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6147174">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6147242">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="6147302">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="6147359">type</span>&nbsp;<span class="ident" id="6147364">Encoding</span>&nbsp;<span class="keyword" id="6147373">struct</span>&nbsp;<span class="op" id="6147380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6147383">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6147393">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6147401">decodeMap</span>&nbsp;<span class="op" id="6147411">[</span><span class="num" id="6147412">256</span><span class="op" id="6147415">]</span><span class="builtintype" id="6147416">byte</span><br>
<span class="lineno"></span><span class="op" id="6147421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6147424">const</span>&nbsp;<span class="ident" id="6147430">encodeStd</span>&nbsp;<span class="op" id="6147440">=</span>&nbsp;<span class="string" id="6147442">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6147477">const</span>&nbsp;<span class="ident" id="6147483">encodeHex</span>&nbsp;<span class="op" id="6147493">=</span>&nbsp;<span class="string" id="6147495">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6147531">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="6147600">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="6147635">func</span>&nbsp;<span class="ident" id="6147640">NewEncoding</span><span class="op" id="6147651">(</span><span class="ident" id="6147652">encoder</span>&nbsp;<span class="builtintype" id="6147660">string</span><span class="op" id="6147666">)</span>&nbsp;<span class="op" id="6147668">*</span><span class="ident" id="6147669">Encoding</span>&nbsp;<span class="op" id="6147678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6147681">e</span>&nbsp;<span class="op" id="6147683">:=</span>&nbsp;<span class="builtinfunc" id="6147686">new</span><span class="op" id="6147689">(</span><span class="ident" id="6147690">Encoding</span><span class="op" id="6147698">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6147701">e</span><span class="op" id="6147702">.</span><span class="ident" id="6147703">encode</span>&nbsp;<span class="op" id="6147710">=</span>&nbsp;<span class="ident" id="6147712">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6147721">for</span>&nbsp;<span class="ident" id="6147725">i</span>&nbsp;<span class="op" id="6147727">:=</span>&nbsp;<span class="num" id="6147730">0</span><span class="op" id="6147731">;</span>&nbsp;<span class="ident" id="6147733">i</span>&nbsp;<span class="op" id="6147735">&lt;</span>&nbsp;<span class="builtinfunc" id="6147737">len</span><span class="op" id="6147740">(</span><span class="ident" id="6147741">e</span><span class="op" id="6147742">.</span><span class="ident" id="6147743">decodeMap</span><span class="op" id="6147752">)</span><span class="op" id="6147753">;</span>&nbsp;<span class="ident" id="6147755">i</span><span class="op" id="6147756">++</span>&nbsp;<span class="op" id="6147759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6147763">e</span><span class="op" id="6147764">.</span><span class="ident" id="6147765">decodeMap</span><span class="op" id="6147774">[</span><span class="ident" id="6147775">i</span><span class="op" id="6147776">]</span>&nbsp;<span class="op" id="6147778">=</span>&nbsp;<span class="num" id="6147780">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6147786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6147789">for</span>&nbsp;<span class="ident" id="6147793">i</span>&nbsp;<span class="op" id="6147795">:=</span>&nbsp;<span class="num" id="6147798">0</span><span class="op" id="6147799">;</span>&nbsp;<span class="ident" id="6147801">i</span>&nbsp;<span class="op" id="6147803">&lt;</span>&nbsp;<span class="builtinfunc" id="6147805">len</span><span class="op" id="6147808">(</span><span class="ident" id="6147809">encoder</span><span class="op" id="6147816">)</span><span class="op" id="6147817">;</span>&nbsp;<span class="ident" id="6147819">i</span><span class="op" id="6147820">++</span>&nbsp;<span class="op" id="6147823">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6147827">e</span><span class="op" id="6147828">.</span><span class="ident" id="6147829">decodeMap</span><span class="op" id="6147838">[</span><span class="ident" id="6147839">encoder</span><span class="op" id="6147846">[</span><span class="ident" id="6147847">i</span><span class="op" id="6147848">]</span><span class="op" id="6147849">]</span>&nbsp;<span class="op" id="6147851">=</span>&nbsp;<span class="builtintype" id="6147853">byte</span><span class="op" id="6147857">(</span><span class="ident" id="6147858">i</span><span class="op" id="6147859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6147862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6147865">return</span>&nbsp;<span class="ident" id="6147872">e</span><br>
<span class="lineno"></span><span class="op" id="6147874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6147877">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6147939">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6147952">var</span>&nbsp;<span class="ident" id="6147956">StdEncoding</span>&nbsp;<span class="op" id="6147968">=</span>&nbsp;<span class="ident" id="6147970">NewEncoding</span><span class="op" id="6147981">(</span><span class="ident" id="6147982">encodeStd</span><span class="op" id="6147991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6147994">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="6148063">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="6148095">var</span>&nbsp;<span class="ident" id="6148099">HexEncoding</span>&nbsp;<span class="op" id="6148111">=</span>&nbsp;<span class="ident" id="6148113">NewEncoding</span><span class="op" id="6148124">(</span><span class="ident" id="6148125">encodeHex</span><span class="op" id="6148134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6148137">var</span>&nbsp;<span class="ident" id="6148141">removeNewlinesMapper</span>&nbsp;<span class="op" id="6148162">=</span>&nbsp;<span class="keyword" id="6148164">func</span><span class="op" id="6148168">(</span><span class="ident" id="6148169">r</span>&nbsp;<span class="builtintype" id="6148171">rune</span><span class="op" id="6148175">)</span>&nbsp;<span class="builtintype" id="6148177">rune</span>&nbsp;<span class="op" id="6148182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148185">if</span>&nbsp;<span class="ident" id="6148188">r</span>&nbsp;<span class="op" id="6148190">==</span>&nbsp;<span class="string" id="6148193">&#39;\r&#39;</span>&nbsp;<span class="op" id="6148198">||</span>&nbsp;<span class="ident" id="6148201">r</span>&nbsp;<span class="op" id="6148203">==</span>&nbsp;<span class="string" id="6148206">&#39;\n&#39;</span>&nbsp;<span class="op" id="6148211">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148215">return</span>&nbsp;<span class="op" id="6148222">-</span><span class="num" id="6148223">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6148226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148229">return</span>&nbsp;<span class="ident" id="6148236">r</span><br>
<span class="lineno"></span><span class="op" id="6148238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6148241">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6148260">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="6148314">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="6148352">//</span><br>
<span class="lineno"></span><span class="comment" id="6148355">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="6148413">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="6148474">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="6148528">func</span>&nbsp;<span class="op" id="6148533">(</span><span class="ident" id="6148534">enc</span>&nbsp;<span class="op" id="6148538">*</span><span class="ident" id="6148539">Encoding</span><span class="op" id="6148547">)</span>&nbsp;<span class="ident" id="6148549">Encode</span><span class="op" id="6148555">(</span><span class="ident" id="6148556">dst</span><span class="op" id="6148559">,</span>&nbsp;<span class="ident" id="6148561">src</span>&nbsp;<span class="op" id="6148565">[</span><span class="op" id="6148566">]</span><span class="builtintype" id="6148567">byte</span><span class="op" id="6148571">)</span>&nbsp;<span class="op" id="6148573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148576">if</span>&nbsp;<span class="builtinfunc" id="6148579">len</span><span class="op" id="6148582">(</span><span class="ident" id="6148583">src</span><span class="op" id="6148586">)</span>&nbsp;<span class="op" id="6148588">==</span>&nbsp;<span class="num" id="6148591">0</span>&nbsp;<span class="op" id="6148593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148597">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6148605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148609">for</span>&nbsp;<span class="builtinfunc" id="6148613">len</span><span class="op" id="6148616">(</span><span class="ident" id="6148617">src</span><span class="op" id="6148620">)</span>&nbsp;<span class="op" id="6148622">&gt;</span>&nbsp;<span class="num" id="6148624">0</span>&nbsp;<span class="op" id="6148626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148630">var</span>&nbsp;<span class="ident" id="6148634">b0</span><span class="op" id="6148636">,</span>&nbsp;<span class="ident" id="6148638">b1</span><span class="op" id="6148640">,</span>&nbsp;<span class="ident" id="6148642">b2</span><span class="op" id="6148644">,</span>&nbsp;<span class="ident" id="6148646">b3</span><span class="op" id="6148648">,</span>&nbsp;<span class="ident" id="6148650">b4</span><span class="op" id="6148652">,</span>&nbsp;<span class="ident" id="6148654">b5</span><span class="op" id="6148656">,</span>&nbsp;<span class="ident" id="6148658">b6</span><span class="op" id="6148660">,</span>&nbsp;<span class="ident" id="6148662">b7</span>&nbsp;<span class="builtintype" id="6148665">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6148673">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6148722">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148747">switch</span>&nbsp;<span class="builtinfunc" id="6148754">len</span><span class="op" id="6148757">(</span><span class="ident" id="6148758">src</span><span class="op" id="6148761">)</span>&nbsp;<span class="op" id="6148763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148767">default</span><span class="op" id="6148774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148779">b7</span>&nbsp;<span class="op" id="6148782">=</span>&nbsp;<span class="ident" id="6148784">src</span><span class="op" id="6148787">[</span><span class="num" id="6148788">4</span><span class="op" id="6148789">]</span>&nbsp;<span class="op" id="6148791">&amp;</span>&nbsp;<span class="num" id="6148793">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148801">b6</span>&nbsp;<span class="op" id="6148804">=</span>&nbsp;<span class="ident" id="6148806">src</span><span class="op" id="6148809">[</span><span class="num" id="6148810">4</span><span class="op" id="6148811">]</span>&nbsp;<span class="op" id="6148813">&gt;&gt;</span>&nbsp;<span class="num" id="6148816">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148821">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148835">case</span>&nbsp;<span class="num" id="6148840">4</span><span class="op" id="6148841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148846">b6</span>&nbsp;<span class="op" id="6148849">|=</span>&nbsp;<span class="op" id="6148852">(</span><span class="ident" id="6148853">src</span><span class="op" id="6148856">[</span><span class="num" id="6148857">3</span><span class="op" id="6148858">]</span>&nbsp;<span class="op" id="6148860">&lt;&lt;</span>&nbsp;<span class="num" id="6148863">3</span><span class="op" id="6148864">)</span>&nbsp;<span class="op" id="6148866">&amp;</span>&nbsp;<span class="num" id="6148868">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148876">b5</span>&nbsp;<span class="op" id="6148879">=</span>&nbsp;<span class="op" id="6148881">(</span><span class="ident" id="6148882">src</span><span class="op" id="6148885">[</span><span class="num" id="6148886">3</span><span class="op" id="6148887">]</span>&nbsp;<span class="op" id="6148889">&gt;&gt;</span>&nbsp;<span class="num" id="6148892">2</span><span class="op" id="6148893">)</span>&nbsp;<span class="op" id="6148895">&amp;</span>&nbsp;<span class="num" id="6148897">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148905">b4</span>&nbsp;<span class="op" id="6148908">=</span>&nbsp;<span class="ident" id="6148910">src</span><span class="op" id="6148913">[</span><span class="num" id="6148914">3</span><span class="op" id="6148915">]</span>&nbsp;<span class="op" id="6148917">&gt;&gt;</span>&nbsp;<span class="num" id="6148920">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148925">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6148939">case</span>&nbsp;<span class="num" id="6148944">3</span><span class="op" id="6148945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148950">b4</span>&nbsp;<span class="op" id="6148953">|=</span>&nbsp;<span class="op" id="6148956">(</span><span class="ident" id="6148957">src</span><span class="op" id="6148960">[</span><span class="num" id="6148961">2</span><span class="op" id="6148962">]</span>&nbsp;<span class="op" id="6148964">&lt;&lt;</span>&nbsp;<span class="num" id="6148967">1</span><span class="op" id="6148968">)</span>&nbsp;<span class="op" id="6148970">&amp;</span>&nbsp;<span class="num" id="6148972">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6148980">b3</span>&nbsp;<span class="op" id="6148983">=</span>&nbsp;<span class="op" id="6148985">(</span><span class="ident" id="6148986">src</span><span class="op" id="6148989">[</span><span class="num" id="6148990">2</span><span class="op" id="6148991">]</span>&nbsp;<span class="op" id="6148993">&gt;&gt;</span>&nbsp;<span class="num" id="6148996">4</span><span class="op" id="6148997">)</span>&nbsp;<span class="op" id="6148999">&amp;</span>&nbsp;<span class="num" id="6149001">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149009">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149023">case</span>&nbsp;<span class="num" id="6149028">2</span><span class="op" id="6149029">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149034">b3</span>&nbsp;<span class="op" id="6149037">|=</span>&nbsp;<span class="op" id="6149040">(</span><span class="ident" id="6149041">src</span><span class="op" id="6149044">[</span><span class="num" id="6149045">1</span><span class="op" id="6149046">]</span>&nbsp;<span class="op" id="6149048">&lt;&lt;</span>&nbsp;<span class="num" id="6149051">4</span><span class="op" id="6149052">)</span>&nbsp;<span class="op" id="6149054">&amp;</span>&nbsp;<span class="num" id="6149056">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149064">b2</span>&nbsp;<span class="op" id="6149067">=</span>&nbsp;<span class="op" id="6149069">(</span><span class="ident" id="6149070">src</span><span class="op" id="6149073">[</span><span class="num" id="6149074">1</span><span class="op" id="6149075">]</span>&nbsp;<span class="op" id="6149077">&gt;&gt;</span>&nbsp;<span class="num" id="6149080">1</span><span class="op" id="6149081">)</span>&nbsp;<span class="op" id="6149083">&amp;</span>&nbsp;<span class="num" id="6149085">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149093">b1</span>&nbsp;<span class="op" id="6149096">=</span>&nbsp;<span class="op" id="6149098">(</span><span class="ident" id="6149099">src</span><span class="op" id="6149102">[</span><span class="num" id="6149103">1</span><span class="op" id="6149104">]</span>&nbsp;<span class="op" id="6149106">&gt;&gt;</span>&nbsp;<span class="num" id="6149109">6</span><span class="op" id="6149110">)</span>&nbsp;<span class="op" id="6149112">&amp;</span>&nbsp;<span class="num" id="6149114">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149122">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149136">case</span>&nbsp;<span class="num" id="6149141">1</span><span class="op" id="6149142">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149147">b1</span>&nbsp;<span class="op" id="6149150">|=</span>&nbsp;<span class="op" id="6149153">(</span><span class="ident" id="6149154">src</span><span class="op" id="6149157">[</span><span class="num" id="6149158">0</span><span class="op" id="6149159">]</span>&nbsp;<span class="op" id="6149161">&lt;&lt;</span>&nbsp;<span class="num" id="6149164">2</span><span class="op" id="6149165">)</span>&nbsp;<span class="op" id="6149167">&amp;</span>&nbsp;<span class="num" id="6149169">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149177">b0</span>&nbsp;<span class="op" id="6149180">=</span>&nbsp;<span class="ident" id="6149182">src</span><span class="op" id="6149185">[</span><span class="num" id="6149186">0</span><span class="op" id="6149187">]</span>&nbsp;<span class="op" id="6149189">&gt;&gt;</span>&nbsp;<span class="num" id="6149192">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6149201">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149252">dst</span><span class="op" id="6149255">[</span><span class="num" id="6149256">0</span><span class="op" id="6149257">]</span>&nbsp;<span class="op" id="6149259">=</span>&nbsp;<span class="ident" id="6149261">enc</span><span class="op" id="6149264">.</span><span class="ident" id="6149265">encode</span><span class="op" id="6149271">[</span><span class="ident" id="6149272">b0</span><span class="op" id="6149274">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149278">dst</span><span class="op" id="6149281">[</span><span class="num" id="6149282">1</span><span class="op" id="6149283">]</span>&nbsp;<span class="op" id="6149285">=</span>&nbsp;<span class="ident" id="6149287">enc</span><span class="op" id="6149290">.</span><span class="ident" id="6149291">encode</span><span class="op" id="6149297">[</span><span class="ident" id="6149298">b1</span><span class="op" id="6149300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149304">dst</span><span class="op" id="6149307">[</span><span class="num" id="6149308">2</span><span class="op" id="6149309">]</span>&nbsp;<span class="op" id="6149311">=</span>&nbsp;<span class="ident" id="6149313">enc</span><span class="op" id="6149316">.</span><span class="ident" id="6149317">encode</span><span class="op" id="6149323">[</span><span class="ident" id="6149324">b2</span><span class="op" id="6149326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149330">dst</span><span class="op" id="6149333">[</span><span class="num" id="6149334">3</span><span class="op" id="6149335">]</span>&nbsp;<span class="op" id="6149337">=</span>&nbsp;<span class="ident" id="6149339">enc</span><span class="op" id="6149342">.</span><span class="ident" id="6149343">encode</span><span class="op" id="6149349">[</span><span class="ident" id="6149350">b3</span><span class="op" id="6149352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149356">dst</span><span class="op" id="6149359">[</span><span class="num" id="6149360">4</span><span class="op" id="6149361">]</span>&nbsp;<span class="op" id="6149363">=</span>&nbsp;<span class="ident" id="6149365">enc</span><span class="op" id="6149368">.</span><span class="ident" id="6149369">encode</span><span class="op" id="6149375">[</span><span class="ident" id="6149376">b4</span><span class="op" id="6149378">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149382">dst</span><span class="op" id="6149385">[</span><span class="num" id="6149386">5</span><span class="op" id="6149387">]</span>&nbsp;<span class="op" id="6149389">=</span>&nbsp;<span class="ident" id="6149391">enc</span><span class="op" id="6149394">.</span><span class="ident" id="6149395">encode</span><span class="op" id="6149401">[</span><span class="ident" id="6149402">b5</span><span class="op" id="6149404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149408">dst</span><span class="op" id="6149411">[</span><span class="num" id="6149412">6</span><span class="op" id="6149413">]</span>&nbsp;<span class="op" id="6149415">=</span>&nbsp;<span class="ident" id="6149417">enc</span><span class="op" id="6149420">.</span><span class="ident" id="6149421">encode</span><span class="op" id="6149427">[</span><span class="ident" id="6149428">b6</span><span class="op" id="6149430">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149434">dst</span><span class="op" id="6149437">[</span><span class="num" id="6149438">7</span><span class="op" id="6149439">]</span>&nbsp;<span class="op" id="6149441">=</span>&nbsp;<span class="ident" id="6149443">enc</span><span class="op" id="6149446">.</span><span class="ident" id="6149447">encode</span><span class="op" id="6149453">[</span><span class="ident" id="6149454">b7</span><span class="op" id="6149456">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6149461">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149488">if</span>&nbsp;<span class="builtinfunc" id="6149491">len</span><span class="op" id="6149494">(</span><span class="ident" id="6149495">src</span><span class="op" id="6149498">)</span>&nbsp;<span class="op" id="6149500">&lt;</span>&nbsp;<span class="num" id="6149502">5</span>&nbsp;<span class="op" id="6149504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149509">dst</span><span class="op" id="6149512">[</span><span class="num" id="6149513">7</span><span class="op" id="6149514">]</span>&nbsp;<span class="op" id="6149516">=</span>&nbsp;<span class="string" id="6149518">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149525">if</span>&nbsp;<span class="builtinfunc" id="6149528">len</span><span class="op" id="6149531">(</span><span class="ident" id="6149532">src</span><span class="op" id="6149535">)</span>&nbsp;<span class="op" id="6149537">&lt;</span>&nbsp;<span class="num" id="6149539">4</span>&nbsp;<span class="op" id="6149541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149547">dst</span><span class="op" id="6149550">[</span><span class="num" id="6149551">6</span><span class="op" id="6149552">]</span>&nbsp;<span class="op" id="6149554">=</span>&nbsp;<span class="string" id="6149556">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149564">dst</span><span class="op" id="6149567">[</span><span class="num" id="6149568">5</span><span class="op" id="6149569">]</span>&nbsp;<span class="op" id="6149571">=</span>&nbsp;<span class="string" id="6149573">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149581">if</span>&nbsp;<span class="builtinfunc" id="6149584">len</span><span class="op" id="6149587">(</span><span class="ident" id="6149588">src</span><span class="op" id="6149591">)</span>&nbsp;<span class="op" id="6149593">&lt;</span>&nbsp;<span class="num" id="6149595">3</span>&nbsp;<span class="op" id="6149597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149604">dst</span><span class="op" id="6149607">[</span><span class="num" id="6149608">4</span><span class="op" id="6149609">]</span>&nbsp;<span class="op" id="6149611">=</span>&nbsp;<span class="string" id="6149613">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149622">if</span>&nbsp;<span class="builtinfunc" id="6149625">len</span><span class="op" id="6149628">(</span><span class="ident" id="6149629">src</span><span class="op" id="6149632">)</span>&nbsp;<span class="op" id="6149634">&lt;</span>&nbsp;<span class="num" id="6149636">2</span>&nbsp;<span class="op" id="6149638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149646">dst</span><span class="op" id="6149649">[</span><span class="num" id="6149650">3</span><span class="op" id="6149651">]</span>&nbsp;<span class="op" id="6149653">=</span>&nbsp;<span class="string" id="6149655">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149665">dst</span><span class="op" id="6149668">[</span><span class="num" id="6149669">2</span><span class="op" id="6149670">]</span>&nbsp;<span class="op" id="6149672">=</span>&nbsp;<span class="string" id="6149674">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149699">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149707">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149711">src</span>&nbsp;<span class="op" id="6149715">=</span>&nbsp;<span class="ident" id="6149717">src</span><span class="op" id="6149720">[</span><span class="num" id="6149721">5</span><span class="op" id="6149722">:</span><span class="op" id="6149723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149727">dst</span>&nbsp;<span class="op" id="6149731">=</span>&nbsp;<span class="ident" id="6149733">dst</span><span class="op" id="6149736">[</span><span class="num" id="6149737">8</span><span class="op" id="6149738">:</span><span class="op" id="6149739">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6149742">}</span><br>
<span class="lineno"></span><span class="op" id="6149744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="6149747">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="6149801">func</span>&nbsp;<span class="op" id="6149806">(</span><span class="ident" id="6149807">enc</span>&nbsp;<span class="op" id="6149811">*</span><span class="ident" id="6149812">Encoding</span><span class="op" id="6149820">)</span>&nbsp;<span class="ident" id="6149822">EncodeToString</span><span class="op" id="6149836">(</span><span class="ident" id="6149837">src</span>&nbsp;<span class="op" id="6149841">[</span><span class="op" id="6149842">]</span><span class="builtintype" id="6149843">byte</span><span class="op" id="6149847">)</span>&nbsp;<span class="builtintype" id="6149849">string</span>&nbsp;<span class="op" id="6149856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149859">buf</span>&nbsp;<span class="op" id="6149863">:=</span>&nbsp;<span class="builtinfunc" id="6149866">make</span><span class="op" id="6149870">(</span><span class="op" id="6149871">[</span><span class="op" id="6149872">]</span><span class="builtintype" id="6149873">byte</span><span class="op" id="6149877">,</span>&nbsp;<span class="ident" id="6149879">enc</span><span class="op" id="6149882">.</span><span class="ident" id="6149883">EncodedLen</span><span class="op" id="6149893">(</span><span class="builtinfunc" id="6149894">len</span><span class="op" id="6149897">(</span><span class="ident" id="6149898">src</span><span class="op" id="6149901">)</span><span class="op" id="6149902">)</span><span class="op" id="6149903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149906">enc</span><span class="op" id="6149909">.</span><span class="ident" id="6149910">Encode</span><span class="op" id="6149916">(</span><span class="ident" id="6149917">buf</span><span class="op" id="6149920">,</span>&nbsp;<span class="ident" id="6149922">src</span><span class="op" id="6149925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6149928">return</span>&nbsp;<span class="builtintype" id="6149935">string</span><span class="op" id="6149941">(</span><span class="ident" id="6149942">buf</span><span class="op" id="6149945">)</span><br>
<span class="lineno">140</span><span class="op" id="6149947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6149950">type</span>&nbsp;<span class="ident" id="6149955">encoder</span>&nbsp;<span class="keyword" id="6149963">struct</span>&nbsp;<span class="op" id="6149970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149973">err</span>&nbsp;&nbsp;<span class="builtintype" id="6149978">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6149985">enc</span>&nbsp;&nbsp;<span class="op" id="6149990">*</span><span class="ident" id="6149991">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150001">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150006">io</span><span class="op" id="6150008">.</span><span class="ident" id="6150009">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150017">buf</span>&nbsp;&nbsp;<span class="op" id="6150022">[</span><span class="num" id="6150023">5</span><span class="op" id="6150024">]</span><span class="builtintype" id="6150025">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6150033">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150073">nbuf</span>&nbsp;<span class="builtintype" id="6150078">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6150089">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150116">out</span>&nbsp;&nbsp;<span class="op" id="6150121">[</span><span class="num" id="6150122">1024</span><span class="op" id="6150126">]</span><span class="builtintype" id="6150127">byte</span>&nbsp;<span class="comment" id="6150132">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="6150149">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6150152">func</span>&nbsp;<span class="op" id="6150157">(</span><span class="ident" id="6150158">e</span>&nbsp;<span class="op" id="6150160">*</span><span class="ident" id="6150161">encoder</span><span class="op" id="6150168">)</span>&nbsp;<span class="ident" id="6150170">Write</span><span class="op" id="6150175">(</span><span class="ident" id="6150176">p</span>&nbsp;<span class="op" id="6150178">[</span><span class="op" id="6150179">]</span><span class="builtintype" id="6150180">byte</span><span class="op" id="6150184">)</span>&nbsp;<span class="op" id="6150186">(</span><span class="ident" id="6150187">n</span>&nbsp;<span class="builtintype" id="6150189">int</span><span class="op" id="6150192">,</span>&nbsp;<span class="ident" id="6150194">err</span>&nbsp;<span class="builtintype" id="6150198">error</span><span class="op" id="6150203">)</span>&nbsp;<span class="op" id="6150205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150208">if</span>&nbsp;<span class="ident" id="6150211">e</span><span class="op" id="6150212">.</span><span class="ident" id="6150213">err</span>&nbsp;<span class="op" id="6150217">!=</span>&nbsp;<span class="builtintype" id="6150220">nil</span>&nbsp;<span class="op" id="6150224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150228">return</span>&nbsp;<span class="num" id="6150235">0</span><span class="op" id="6150236">,</span>&nbsp;<span class="ident" id="6150238">e</span><span class="op" id="6150239">.</span><span class="ident" id="6150240">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150245">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6150249">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150269">if</span>&nbsp;<span class="ident" id="6150272">e</span><span class="op" id="6150273">.</span><span class="ident" id="6150274">nbuf</span>&nbsp;<span class="op" id="6150279">&gt;</span>&nbsp;<span class="num" id="6150281">0</span>&nbsp;<span class="op" id="6150283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150287">var</span>&nbsp;<span class="ident" id="6150291">i</span>&nbsp;<span class="builtintype" id="6150293">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150299">for</span>&nbsp;<span class="ident" id="6150303">i</span>&nbsp;<span class="op" id="6150305">=</span>&nbsp;<span class="num" id="6150307">0</span><span class="op" id="6150308">;</span>&nbsp;<span class="ident" id="6150310">i</span>&nbsp;<span class="op" id="6150312">&lt;</span>&nbsp;<span class="builtinfunc" id="6150314">len</span><span class="op" id="6150317">(</span><span class="ident" id="6150318">p</span><span class="op" id="6150319">)</span>&nbsp;<span class="op" id="6150321">&amp;&amp;</span>&nbsp;<span class="ident" id="6150324">e</span><span class="op" id="6150325">.</span><span class="ident" id="6150326">nbuf</span>&nbsp;<span class="op" id="6150331">&lt;</span>&nbsp;<span class="num" id="6150333">5</span><span class="op" id="6150334">;</span>&nbsp;<span class="ident" id="6150336">i</span><span class="op" id="6150337">++</span>&nbsp;<span class="op" id="6150340">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150345">e</span><span class="op" id="6150346">.</span><span class="ident" id="6150347">buf</span><span class="op" id="6150350">[</span><span class="ident" id="6150351">e</span><span class="op" id="6150352">.</span><span class="ident" id="6150353">nbuf</span><span class="op" id="6150357">]</span>&nbsp;<span class="op" id="6150359">=</span>&nbsp;<span class="ident" id="6150361">p</span><span class="op" id="6150362">[</span><span class="ident" id="6150363">i</span><span class="op" id="6150364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150369">e</span><span class="op" id="6150370">.</span><span class="ident" id="6150371">nbuf</span><span class="op" id="6150375">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150384">n</span>&nbsp;<span class="op" id="6150386">+=</span>&nbsp;<span class="ident" id="6150389">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150393">p</span>&nbsp;<span class="op" id="6150395">=</span>&nbsp;<span class="ident" id="6150397">p</span><span class="op" id="6150398">[</span><span class="ident" id="6150399">i</span><span class="op" id="6150400">:</span><span class="op" id="6150401">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150405">if</span>&nbsp;<span class="ident" id="6150408">e</span><span class="op" id="6150409">.</span><span class="ident" id="6150410">nbuf</span>&nbsp;<span class="op" id="6150415">&lt;</span>&nbsp;<span class="num" id="6150417">5</span>&nbsp;<span class="op" id="6150419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150424">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150437">e</span><span class="op" id="6150438">.</span><span class="ident" id="6150439">enc</span><span class="op" id="6150442">.</span><span class="ident" id="6150443">Encode</span><span class="op" id="6150449">(</span><span class="ident" id="6150450">e</span><span class="op" id="6150451">.</span><span class="ident" id="6150452">out</span><span class="op" id="6150455">[</span><span class="num" id="6150456">0</span><span class="op" id="6150457">:</span><span class="op" id="6150458">]</span><span class="op" id="6150459">,</span>&nbsp;<span class="ident" id="6150461">e</span><span class="op" id="6150462">.</span><span class="ident" id="6150463">buf</span><span class="op" id="6150466">[</span><span class="num" id="6150467">0</span><span class="op" id="6150468">:</span><span class="op" id="6150469">]</span><span class="op" id="6150470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150474">if</span>&nbsp;<span class="ident" id="6150477">_</span><span class="op" id="6150478">,</span>&nbsp;<span class="ident" id="6150480">e</span><span class="op" id="6150481">.</span><span class="ident" id="6150482">err</span>&nbsp;<span class="op" id="6150486">=</span>&nbsp;<span class="ident" id="6150488">e</span><span class="op" id="6150489">.</span><span class="ident" id="6150490">w</span><span class="op" id="6150491">.</span><span class="ident" id="6150492">Write</span><span class="op" id="6150497">(</span><span class="ident" id="6150498">e</span><span class="op" id="6150499">.</span><span class="ident" id="6150500">out</span><span class="op" id="6150503">[</span><span class="num" id="6150504">0</span><span class="op" id="6150505">:</span><span class="num" id="6150506">8</span><span class="op" id="6150507">]</span><span class="op" id="6150508">)</span><span class="op" id="6150509">;</span>&nbsp;<span class="ident" id="6150511">e</span><span class="op" id="6150512">.</span><span class="ident" id="6150513">err</span>&nbsp;<span class="op" id="6150517">!=</span>&nbsp;<span class="builtintype" id="6150520">nil</span>&nbsp;<span class="op" id="6150524">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150529">return</span>&nbsp;<span class="ident" id="6150536">n</span><span class="op" id="6150537">,</span>&nbsp;<span class="ident" id="6150539">e</span><span class="op" id="6150540">.</span><span class="ident" id="6150541">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150551">e</span><span class="op" id="6150552">.</span><span class="ident" id="6150553">nbuf</span>&nbsp;<span class="op" id="6150558">=</span>&nbsp;<span class="num" id="6150560">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6150567">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150594">for</span>&nbsp;<span class="builtinfunc" id="6150598">len</span><span class="op" id="6150601">(</span><span class="ident" id="6150602">p</span><span class="op" id="6150603">)</span>&nbsp;<span class="op" id="6150605">&gt;=</span>&nbsp;<span class="num" id="6150608">5</span>&nbsp;<span class="op" id="6150610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150614">nn</span>&nbsp;<span class="op" id="6150617">:=</span>&nbsp;<span class="builtinfunc" id="6150620">len</span><span class="op" id="6150623">(</span><span class="ident" id="6150624">e</span><span class="op" id="6150625">.</span><span class="ident" id="6150626">out</span><span class="op" id="6150629">)</span>&nbsp;<span class="op" id="6150631">/</span>&nbsp;<span class="num" id="6150633">8</span>&nbsp;<span class="op" id="6150635">*</span>&nbsp;<span class="num" id="6150637">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150641">if</span>&nbsp;<span class="ident" id="6150644">nn</span>&nbsp;<span class="op" id="6150647">&gt;</span>&nbsp;<span class="builtinfunc" id="6150649">len</span><span class="op" id="6150652">(</span><span class="ident" id="6150653">p</span><span class="op" id="6150654">)</span>&nbsp;<span class="op" id="6150656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150661">nn</span>&nbsp;<span class="op" id="6150664">=</span>&nbsp;<span class="builtinfunc" id="6150666">len</span><span class="op" id="6150669">(</span><span class="ident" id="6150670">p</span><span class="op" id="6150671">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150676">nn</span>&nbsp;<span class="op" id="6150679">-=</span>&nbsp;<span class="ident" id="6150682">nn</span>&nbsp;<span class="op" id="6150685">%</span>&nbsp;<span class="num" id="6150687">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150695">e</span><span class="op" id="6150696">.</span><span class="ident" id="6150697">enc</span><span class="op" id="6150700">.</span><span class="ident" id="6150701">Encode</span><span class="op" id="6150707">(</span><span class="ident" id="6150708">e</span><span class="op" id="6150709">.</span><span class="ident" id="6150710">out</span><span class="op" id="6150713">[</span><span class="num" id="6150714">0</span><span class="op" id="6150715">:</span><span class="op" id="6150716">]</span><span class="op" id="6150717">,</span>&nbsp;<span class="ident" id="6150719">p</span><span class="op" id="6150720">[</span><span class="num" id="6150721">0</span><span class="op" id="6150722">:</span><span class="ident" id="6150723">nn</span><span class="op" id="6150725">]</span><span class="op" id="6150726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150730">if</span>&nbsp;<span class="ident" id="6150733">_</span><span class="op" id="6150734">,</span>&nbsp;<span class="ident" id="6150736">e</span><span class="op" id="6150737">.</span><span class="ident" id="6150738">err</span>&nbsp;<span class="op" id="6150742">=</span>&nbsp;<span class="ident" id="6150744">e</span><span class="op" id="6150745">.</span><span class="ident" id="6150746">w</span><span class="op" id="6150747">.</span><span class="ident" id="6150748">Write</span><span class="op" id="6150753">(</span><span class="ident" id="6150754">e</span><span class="op" id="6150755">.</span><span class="ident" id="6150756">out</span><span class="op" id="6150759">[</span><span class="num" id="6150760">0</span>&nbsp;<span class="op" id="6150762">:</span>&nbsp;<span class="ident" id="6150764">nn</span><span class="op" id="6150766">/</span><span class="num" id="6150767">5</span><span class="op" id="6150768">*</span><span class="num" id="6150769">8</span><span class="op" id="6150770">]</span><span class="op" id="6150771">)</span><span class="op" id="6150772">;</span>&nbsp;<span class="ident" id="6150774">e</span><span class="op" id="6150775">.</span><span class="ident" id="6150776">err</span>&nbsp;<span class="op" id="6150780">!=</span>&nbsp;<span class="builtintype" id="6150783">nil</span>&nbsp;<span class="op" id="6150787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150792">return</span>&nbsp;<span class="ident" id="6150799">n</span><span class="op" id="6150800">,</span>&nbsp;<span class="ident" id="6150802">e</span><span class="op" id="6150803">.</span><span class="ident" id="6150804">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150814">n</span>&nbsp;<span class="op" id="6150816">+=</span>&nbsp;<span class="ident" id="6150819">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150824">p</span>&nbsp;<span class="op" id="6150826">=</span>&nbsp;<span class="ident" id="6150828">p</span><span class="op" id="6150829">[</span><span class="ident" id="6150830">nn</span><span class="op" id="6150832">:</span><span class="op" id="6150833">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6150840">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150861">for</span>&nbsp;<span class="ident" id="6150865">i</span>&nbsp;<span class="op" id="6150867">:=</span>&nbsp;<span class="num" id="6150870">0</span><span class="op" id="6150871">;</span>&nbsp;<span class="ident" id="6150873">i</span>&nbsp;<span class="op" id="6150875">&lt;</span>&nbsp;<span class="builtinfunc" id="6150877">len</span><span class="op" id="6150880">(</span><span class="ident" id="6150881">p</span><span class="op" id="6150882">)</span><span class="op" id="6150883">;</span>&nbsp;<span class="ident" id="6150885">i</span><span class="op" id="6150886">++</span>&nbsp;<span class="op" id="6150889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150893">e</span><span class="op" id="6150894">.</span><span class="ident" id="6150895">buf</span><span class="op" id="6150898">[</span><span class="ident" id="6150899">i</span><span class="op" id="6150900">]</span>&nbsp;<span class="op" id="6150902">=</span>&nbsp;<span class="ident" id="6150904">p</span><span class="op" id="6150905">[</span><span class="ident" id="6150906">i</span><span class="op" id="6150907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6150910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150913">e</span><span class="op" id="6150914">.</span><span class="ident" id="6150915">nbuf</span>&nbsp;<span class="op" id="6150920">=</span>&nbsp;<span class="builtinfunc" id="6150922">len</span><span class="op" id="6150925">(</span><span class="ident" id="6150926">p</span><span class="op" id="6150927">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6150930">n</span>&nbsp;<span class="op" id="6150932">+=</span>&nbsp;<span class="builtinfunc" id="6150935">len</span><span class="op" id="6150938">(</span><span class="ident" id="6150939">p</span><span class="op" id="6150940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6150943">return</span><br>
<span class="lineno"></span><span class="op" id="6150950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6150953">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="6151007">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="6151060">func</span>&nbsp;<span class="op" id="6151065">(</span><span class="ident" id="6151066">e</span>&nbsp;<span class="op" id="6151068">*</span><span class="ident" id="6151069">encoder</span><span class="op" id="6151076">)</span>&nbsp;<span class="ident" id="6151078">Close</span><span class="op" id="6151083">(</span><span class="op" id="6151084">)</span>&nbsp;<span class="builtintype" id="6151086">error</span>&nbsp;<span class="op" id="6151092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6151095">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6151152">if</span>&nbsp;<span class="ident" id="6151155">e</span><span class="op" id="6151156">.</span><span class="ident" id="6151157">err</span>&nbsp;<span class="op" id="6151161">==</span>&nbsp;<span class="builtintype" id="6151164">nil</span>&nbsp;<span class="op" id="6151168">&amp;&amp;</span>&nbsp;<span class="ident" id="6151171">e</span><span class="op" id="6151172">.</span><span class="ident" id="6151173">nbuf</span>&nbsp;<span class="op" id="6151178">&gt;</span>&nbsp;<span class="num" id="6151180">0</span>&nbsp;<span class="op" id="6151182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6151186">e</span><span class="op" id="6151187">.</span><span class="ident" id="6151188">enc</span><span class="op" id="6151191">.</span><span class="ident" id="6151192">Encode</span><span class="op" id="6151198">(</span><span class="ident" id="6151199">e</span><span class="op" id="6151200">.</span><span class="ident" id="6151201">out</span><span class="op" id="6151204">[</span><span class="num" id="6151205">0</span><span class="op" id="6151206">:</span><span class="op" id="6151207">]</span><span class="op" id="6151208">,</span>&nbsp;<span class="ident" id="6151210">e</span><span class="op" id="6151211">.</span><span class="ident" id="6151212">buf</span><span class="op" id="6151215">[</span><span class="num" id="6151216">0</span><span class="op" id="6151217">:</span><span class="ident" id="6151218">e</span><span class="op" id="6151219">.</span><span class="ident" id="6151220">nbuf</span><span class="op" id="6151224">]</span><span class="op" id="6151225">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6151229">e</span><span class="op" id="6151230">.</span><span class="ident" id="6151231">nbuf</span>&nbsp;<span class="op" id="6151236">=</span>&nbsp;<span class="num" id="6151238">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6151242">_</span><span class="op" id="6151243">,</span>&nbsp;<span class="ident" id="6151245">e</span><span class="op" id="6151246">.</span><span class="ident" id="6151247">err</span>&nbsp;<span class="op" id="6151251">=</span>&nbsp;<span class="ident" id="6151253">e</span><span class="op" id="6151254">.</span><span class="ident" id="6151255">w</span><span class="op" id="6151256">.</span><span class="ident" id="6151257">Write</span><span class="op" id="6151262">(</span><span class="ident" id="6151263">e</span><span class="op" id="6151264">.</span><span class="ident" id="6151265">out</span><span class="op" id="6151268">[</span><span class="num" id="6151269">0</span><span class="op" id="6151270">:</span><span class="num" id="6151271">8</span><span class="op" id="6151272">]</span><span class="op" id="6151273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6151276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6151279">return</span>&nbsp;<span class="ident" id="6151286">e</span><span class="op" id="6151287">.</span><span class="ident" id="6151288">err</span><br>
<span class="lineno"></span><span class="op" id="6151292">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="6151295">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6151363">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="6151435">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="6151495">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="6151563">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="6151592">func</span>&nbsp;<span class="ident" id="6151597">NewEncoder</span><span class="op" id="6151607">(</span><span class="ident" id="6151608">enc</span>&nbsp;<span class="op" id="6151612">*</span><span class="ident" id="6151613">Encoding</span><span class="op" id="6151621">,</span>&nbsp;<span class="ident" id="6151623">w</span>&nbsp;<span class="ident" id="6151625">io</span><span class="op" id="6151627">.</span><span class="ident" id="6151628">Writer</span><span class="op" id="6151634">)</span>&nbsp;<span class="ident" id="6151636">io</span><span class="op" id="6151638">.</span><span class="ident" id="6151639">WriteCloser</span>&nbsp;<span class="op" id="6151651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6151654">return</span>&nbsp;<span class="op" id="6151661">&amp;</span><span class="ident" id="6151662">encoder</span><span class="op" id="6151669">{</span><span class="ident" id="6151670">enc</span><span class="op" id="6151673">:</span>&nbsp;<span class="ident" id="6151675">enc</span><span class="op" id="6151678">,</span>&nbsp;<span class="ident" id="6151680">w</span><span class="op" id="6151681">:</span>&nbsp;<span class="ident" id="6151683">w</span><span class="op" id="6151684">}</span><br>
<span class="lineno"></span><span class="op" id="6151686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="6151689">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6151754">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="6151789">func</span>&nbsp;<span class="op" id="6151794">(</span><span class="ident" id="6151795">enc</span>&nbsp;<span class="op" id="6151799">*</span><span class="ident" id="6151800">Encoding</span><span class="op" id="6151808">)</span>&nbsp;<span class="ident" id="6151810">EncodedLen</span><span class="op" id="6151820">(</span><span class="ident" id="6151821">n</span>&nbsp;<span class="builtintype" id="6151823">int</span><span class="op" id="6151826">)</span>&nbsp;<span class="builtintype" id="6151828">int</span>&nbsp;<span class="op" id="6151832">{</span>&nbsp;<span class="keyword" id="6151834">return</span>&nbsp;<span class="op" id="6151841">(</span><span class="ident" id="6151842">n</span>&nbsp;<span class="op" id="6151844">+</span>&nbsp;<span class="num" id="6151846">4</span><span class="op" id="6151847">)</span>&nbsp;<span class="op" id="6151849">/</span>&nbsp;<span class="num" id="6151851">5</span>&nbsp;<span class="op" id="6151853">*</span>&nbsp;<span class="num" id="6151855">8</span>&nbsp;<span class="op" id="6151857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6151860">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6151879">type</span>&nbsp;<span class="ident" id="6151884">CorruptInputError</span>&nbsp;<span class="builtintype" id="6151902">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6151909">func</span>&nbsp;<span class="op" id="6151914">(</span><span class="ident" id="6151915">e</span>&nbsp;<span class="ident" id="6151917">CorruptInputError</span><span class="op" id="6151934">)</span>&nbsp;<span class="ident" id="6151936">Error</span><span class="op" id="6151941">(</span><span class="op" id="6151942">)</span>&nbsp;<span class="builtintype" id="6151944">string</span>&nbsp;<span class="op" id="6151951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6151954">return</span>&nbsp;<span class="string" id="6151961">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="6151998">+</span>&nbsp;<span class="ident" id="6152000">strconv</span><span class="op" id="6152007">.</span><span class="ident" id="6152008">FormatInt</span><span class="op" id="6152017">(</span><span class="builtintype" id="6152018">int64</span><span class="op" id="6152023">(</span><span class="ident" id="6152024">e</span><span class="op" id="6152025">)</span><span class="op" id="6152026">,</span>&nbsp;<span class="num" id="6152028">10</span><span class="op" id="6152030">)</span><br>
<span class="lineno"></span><span class="op" id="6152032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6152035">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="6152105">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6152173">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="6152243">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="6152300">func</span>&nbsp;<span class="op" id="6152305">(</span><span class="ident" id="6152306">enc</span>&nbsp;<span class="op" id="6152310">*</span><span class="ident" id="6152311">Encoding</span><span class="op" id="6152319">)</span>&nbsp;<span class="ident" id="6152321">decode</span><span class="op" id="6152327">(</span><span class="ident" id="6152328">dst</span><span class="op" id="6152331">,</span>&nbsp;<span class="ident" id="6152333">src</span>&nbsp;<span class="op" id="6152337">[</span><span class="op" id="6152338">]</span><span class="builtintype" id="6152339">byte</span><span class="op" id="6152343">)</span>&nbsp;<span class="op" id="6152345">(</span><span class="ident" id="6152346">n</span>&nbsp;<span class="builtintype" id="6152348">int</span><span class="op" id="6152351">,</span>&nbsp;<span class="ident" id="6152353">end</span>&nbsp;<span class="builtintype" id="6152357">bool</span><span class="op" id="6152361">,</span>&nbsp;<span class="ident" id="6152363">err</span>&nbsp;<span class="builtintype" id="6152367">error</span><span class="op" id="6152372">)</span>&nbsp;<span class="op" id="6152374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152377">olen</span>&nbsp;<span class="op" id="6152382">:=</span>&nbsp;<span class="builtinfunc" id="6152385">len</span><span class="op" id="6152388">(</span><span class="ident" id="6152389">src</span><span class="op" id="6152392">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152395">for</span>&nbsp;<span class="builtinfunc" id="6152399">len</span><span class="op" id="6152402">(</span><span class="ident" id="6152403">src</span><span class="op" id="6152406">)</span>&nbsp;<span class="op" id="6152408">&gt;</span>&nbsp;<span class="num" id="6152410">0</span>&nbsp;<span class="op" id="6152412">&amp;&amp;</span>&nbsp;<span class="op" id="6152415">!</span><span class="ident" id="6152416">end</span>&nbsp;<span class="op" id="6152420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6152424">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152470">var</span>&nbsp;<span class="ident" id="6152474">dbuf</span>&nbsp;<span class="op" id="6152479">[</span><span class="num" id="6152480">8</span><span class="op" id="6152481">]</span><span class="builtintype" id="6152482">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152489">dlen</span>&nbsp;<span class="op" id="6152494">:=</span>&nbsp;<span class="num" id="6152497">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152502">for</span>&nbsp;<span class="ident" id="6152506">j</span>&nbsp;<span class="op" id="6152508">:=</span>&nbsp;<span class="num" id="6152511">0</span><span class="op" id="6152512">;</span>&nbsp;<span class="ident" id="6152514">j</span>&nbsp;<span class="op" id="6152516">&lt;</span>&nbsp;<span class="num" id="6152518">8</span><span class="op" id="6152519">;</span>&nbsp;<span class="op" id="6152521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152526">if</span>&nbsp;<span class="builtinfunc" id="6152529">len</span><span class="op" id="6152532">(</span><span class="ident" id="6152533">src</span><span class="op" id="6152536">)</span>&nbsp;<span class="op" id="6152538">==</span>&nbsp;<span class="num" id="6152541">0</span>&nbsp;<span class="op" id="6152543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152549">return</span>&nbsp;<span class="ident" id="6152556">n</span><span class="op" id="6152557">,</span>&nbsp;<span class="builtintype" id="6152559">false</span><span class="op" id="6152564">,</span>&nbsp;<span class="ident" id="6152566">CorruptInputError</span><span class="op" id="6152583">(</span><span class="ident" id="6152584">olen</span>&nbsp;<span class="op" id="6152589">-</span>&nbsp;<span class="builtinfunc" id="6152591">len</span><span class="op" id="6152594">(</span><span class="ident" id="6152595">src</span><span class="op" id="6152598">)</span>&nbsp;<span class="op" id="6152600">-</span>&nbsp;<span class="ident" id="6152602">j</span><span class="op" id="6152603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6152608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152613">in</span>&nbsp;<span class="op" id="6152616">:=</span>&nbsp;<span class="ident" id="6152619">src</span><span class="op" id="6152622">[</span><span class="num" id="6152623">0</span><span class="op" id="6152624">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152629">src</span>&nbsp;<span class="op" id="6152633">=</span>&nbsp;<span class="ident" id="6152635">src</span><span class="op" id="6152638">[</span><span class="num" id="6152639">1</span><span class="op" id="6152640">:</span><span class="op" id="6152641">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152646">if</span>&nbsp;<span class="ident" id="6152649">in</span>&nbsp;<span class="op" id="6152652">==</span>&nbsp;<span class="string" id="6152655">&#39;=&#39;</span>&nbsp;<span class="op" id="6152659">&amp;&amp;</span>&nbsp;<span class="ident" id="6152662">j</span>&nbsp;<span class="op" id="6152664">&gt;=</span>&nbsp;<span class="num" id="6152667">2</span>&nbsp;<span class="op" id="6152669">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6152672">len</span><span class="op" id="6152675">(</span><span class="ident" id="6152676">src</span><span class="op" id="6152679">)</span>&nbsp;<span class="op" id="6152681">&lt;</span>&nbsp;<span class="num" id="6152683">8</span>&nbsp;<span class="op" id="6152685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6152691">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152740">if</span>&nbsp;<span class="builtinfunc" id="6152743">len</span><span class="op" id="6152746">(</span><span class="ident" id="6152747">src</span><span class="op" id="6152750">)</span><span class="op" id="6152751">+</span><span class="ident" id="6152752">j</span>&nbsp;<span class="op" id="6152754">&lt;</span>&nbsp;<span class="num" id="6152756">8</span><span class="op" id="6152757">-</span><span class="num" id="6152758">1</span>&nbsp;<span class="op" id="6152760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6152767">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152794">return</span>&nbsp;<span class="ident" id="6152801">n</span><span class="op" id="6152802">,</span>&nbsp;<span class="builtintype" id="6152804">false</span><span class="op" id="6152809">,</span>&nbsp;<span class="ident" id="6152811">CorruptInputError</span><span class="op" id="6152828">(</span><span class="ident" id="6152829">olen</span><span class="op" id="6152833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6152839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152845">for</span>&nbsp;<span class="ident" id="6152849">k</span>&nbsp;<span class="op" id="6152851">:=</span>&nbsp;<span class="num" id="6152854">0</span><span class="op" id="6152855">;</span>&nbsp;<span class="ident" id="6152857">k</span>&nbsp;<span class="op" id="6152859">&lt;</span>&nbsp;<span class="num" id="6152861">8</span><span class="op" id="6152862">-</span><span class="num" id="6152863">1</span><span class="op" id="6152864">-</span><span class="ident" id="6152865">j</span><span class="op" id="6152866">;</span>&nbsp;<span class="ident" id="6152868">k</span><span class="op" id="6152869">++</span>&nbsp;<span class="op" id="6152872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152879">if</span>&nbsp;<span class="builtinfunc" id="6152882">len</span><span class="op" id="6152885">(</span><span class="ident" id="6152886">src</span><span class="op" id="6152889">)</span>&nbsp;<span class="op" id="6152891">&gt;</span>&nbsp;<span class="ident" id="6152893">k</span>&nbsp;<span class="op" id="6152895">&amp;&amp;</span>&nbsp;<span class="ident" id="6152898">src</span><span class="op" id="6152901">[</span><span class="ident" id="6152902">k</span><span class="op" id="6152903">]</span>&nbsp;<span class="op" id="6152905">!=</span>&nbsp;<span class="string" id="6152908">&#39;=&#39;</span>&nbsp;<span class="op" id="6152912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6152920">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152947">return</span>&nbsp;<span class="ident" id="6152954">n</span><span class="op" id="6152955">,</span>&nbsp;<span class="builtintype" id="6152957">false</span><span class="op" id="6152962">,</span>&nbsp;<span class="ident" id="6152964">CorruptInputError</span><span class="op" id="6152981">(</span><span class="ident" id="6152982">olen</span>&nbsp;<span class="op" id="6152987">-</span>&nbsp;<span class="builtinfunc" id="6152989">len</span><span class="op" id="6152992">(</span><span class="ident" id="6152993">src</span><span class="op" id="6152996">)</span>&nbsp;<span class="op" id="6152998">+</span>&nbsp;<span class="ident" id="6153000">k</span>&nbsp;<span class="op" id="6153002">-</span>&nbsp;<span class="num" id="6153004">1</span><span class="op" id="6153005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153024">dlen</span><span class="op" id="6153028">,</span>&nbsp;<span class="ident" id="6153030">end</span>&nbsp;<span class="op" id="6153034">=</span>&nbsp;<span class="ident" id="6153036">j</span><span class="op" id="6153037">,</span>&nbsp;<span class="builtintype" id="6153039">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153048">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153123">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153199">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153271">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153344">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153415">if</span>&nbsp;<span class="ident" id="6153418">dlen</span>&nbsp;<span class="op" id="6153423">==</span>&nbsp;<span class="num" id="6153426">1</span>&nbsp;<span class="op" id="6153428">||</span>&nbsp;<span class="ident" id="6153431">dlen</span>&nbsp;<span class="op" id="6153436">==</span>&nbsp;<span class="num" id="6153439">3</span>&nbsp;<span class="op" id="6153441">||</span>&nbsp;<span class="ident" id="6153444">dlen</span>&nbsp;<span class="op" id="6153449">==</span>&nbsp;<span class="num" id="6153452">6</span>&nbsp;<span class="op" id="6153454">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153461">return</span>&nbsp;<span class="ident" id="6153468">n</span><span class="op" id="6153469">,</span>&nbsp;<span class="builtintype" id="6153471">false</span><span class="op" id="6153476">,</span>&nbsp;<span class="ident" id="6153478">CorruptInputError</span><span class="op" id="6153495">(</span><span class="ident" id="6153496">olen</span>&nbsp;<span class="op" id="6153501">-</span>&nbsp;<span class="builtinfunc" id="6153503">len</span><span class="op" id="6153506">(</span><span class="ident" id="6153507">src</span><span class="op" id="6153510">)</span>&nbsp;<span class="op" id="6153512">-</span>&nbsp;<span class="num" id="6153514">1</span><span class="op" id="6153515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153527">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153541">dbuf</span><span class="op" id="6153545">[</span><span class="ident" id="6153546">j</span><span class="op" id="6153547">]</span>&nbsp;<span class="op" id="6153549">=</span>&nbsp;<span class="ident" id="6153551">enc</span><span class="op" id="6153554">.</span><span class="ident" id="6153555">decodeMap</span><span class="op" id="6153564">[</span><span class="ident" id="6153565">in</span><span class="op" id="6153567">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153572">if</span>&nbsp;<span class="ident" id="6153575">dbuf</span><span class="op" id="6153579">[</span><span class="ident" id="6153580">j</span><span class="op" id="6153581">]</span>&nbsp;<span class="op" id="6153583">==</span>&nbsp;<span class="num" id="6153586">0xFF</span>&nbsp;<span class="op" id="6153591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153597">return</span>&nbsp;<span class="ident" id="6153604">n</span><span class="op" id="6153605">,</span>&nbsp;<span class="builtintype" id="6153607">false</span><span class="op" id="6153612">,</span>&nbsp;<span class="ident" id="6153614">CorruptInputError</span><span class="op" id="6153631">(</span><span class="ident" id="6153632">olen</span>&nbsp;<span class="op" id="6153637">-</span>&nbsp;<span class="builtinfunc" id="6153639">len</span><span class="op" id="6153642">(</span><span class="ident" id="6153643">src</span><span class="op" id="6153646">)</span>&nbsp;<span class="op" id="6153648">-</span>&nbsp;<span class="num" id="6153650">1</span><span class="op" id="6153651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153661">j</span><span class="op" id="6153662">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153667">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153672">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153729">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153742">switch</span>&nbsp;<span class="ident" id="6153749">dlen</span>&nbsp;<span class="op" id="6153754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153758">case</span>&nbsp;<span class="num" id="6153763">8</span><span class="op" id="6153764">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153769">dst</span><span class="op" id="6153772">[</span><span class="num" id="6153773">4</span><span class="op" id="6153774">]</span>&nbsp;<span class="op" id="6153776">=</span>&nbsp;<span class="ident" id="6153778">dbuf</span><span class="op" id="6153782">[</span><span class="num" id="6153783">6</span><span class="op" id="6153784">]</span><span class="op" id="6153785">&lt;&lt;</span><span class="num" id="6153787">5</span>&nbsp;<span class="op" id="6153789">|</span>&nbsp;<span class="ident" id="6153791">dbuf</span><span class="op" id="6153795">[</span><span class="num" id="6153796">7</span><span class="op" id="6153797">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153802">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153816">case</span>&nbsp;<span class="num" id="6153821">7</span><span class="op" id="6153822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153827">dst</span><span class="op" id="6153830">[</span><span class="num" id="6153831">3</span><span class="op" id="6153832">]</span>&nbsp;<span class="op" id="6153834">=</span>&nbsp;<span class="ident" id="6153836">dbuf</span><span class="op" id="6153840">[</span><span class="num" id="6153841">4</span><span class="op" id="6153842">]</span><span class="op" id="6153843">&lt;&lt;</span><span class="num" id="6153845">7</span>&nbsp;<span class="op" id="6153847">|</span>&nbsp;<span class="ident" id="6153849">dbuf</span><span class="op" id="6153853">[</span><span class="num" id="6153854">5</span><span class="op" id="6153855">]</span><span class="op" id="6153856">&lt;&lt;</span><span class="num" id="6153858">2</span>&nbsp;<span class="op" id="6153860">|</span>&nbsp;<span class="ident" id="6153862">dbuf</span><span class="op" id="6153866">[</span><span class="num" id="6153867">6</span><span class="op" id="6153868">]</span><span class="op" id="6153869">&gt;&gt;</span><span class="num" id="6153871">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153876">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153890">case</span>&nbsp;<span class="num" id="6153895">5</span><span class="op" id="6153896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153901">dst</span><span class="op" id="6153904">[</span><span class="num" id="6153905">2</span><span class="op" id="6153906">]</span>&nbsp;<span class="op" id="6153908">=</span>&nbsp;<span class="ident" id="6153910">dbuf</span><span class="op" id="6153914">[</span><span class="num" id="6153915">3</span><span class="op" id="6153916">]</span><span class="op" id="6153917">&lt;&lt;</span><span class="num" id="6153919">4</span>&nbsp;<span class="op" id="6153921">|</span>&nbsp;<span class="ident" id="6153923">dbuf</span><span class="op" id="6153927">[</span><span class="num" id="6153928">4</span><span class="op" id="6153929">]</span><span class="op" id="6153930">&gt;&gt;</span><span class="num" id="6153932">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153937">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153951">case</span>&nbsp;<span class="num" id="6153956">4</span><span class="op" id="6153957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153962">dst</span><span class="op" id="6153965">[</span><span class="num" id="6153966">1</span><span class="op" id="6153967">]</span>&nbsp;<span class="op" id="6153969">=</span>&nbsp;<span class="ident" id="6153971">dbuf</span><span class="op" id="6153975">[</span><span class="num" id="6153976">1</span><span class="op" id="6153977">]</span><span class="op" id="6153978">&lt;&lt;</span><span class="num" id="6153980">6</span>&nbsp;<span class="op" id="6153982">|</span>&nbsp;<span class="ident" id="6153984">dbuf</span><span class="op" id="6153988">[</span><span class="num" id="6153989">2</span><span class="op" id="6153990">]</span><span class="op" id="6153991">&lt;&lt;</span><span class="num" id="6153993">1</span>&nbsp;<span class="op" id="6153995">|</span>&nbsp;<span class="ident" id="6153997">dbuf</span><span class="op" id="6154001">[</span><span class="num" id="6154002">3</span><span class="op" id="6154003">]</span><span class="op" id="6154004">&gt;&gt;</span><span class="num" id="6154006">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154011">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154025">case</span>&nbsp;<span class="num" id="6154030">2</span><span class="op" id="6154031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154036">dst</span><span class="op" id="6154039">[</span><span class="num" id="6154040">0</span><span class="op" id="6154041">]</span>&nbsp;<span class="op" id="6154043">=</span>&nbsp;<span class="ident" id="6154045">dbuf</span><span class="op" id="6154049">[</span><span class="num" id="6154050">0</span><span class="op" id="6154051">]</span><span class="op" id="6154052">&lt;&lt;</span><span class="num" id="6154054">3</span>&nbsp;<span class="op" id="6154056">|</span>&nbsp;<span class="ident" id="6154058">dbuf</span><span class="op" id="6154062">[</span><span class="num" id="6154063">1</span><span class="op" id="6154064">]</span><span class="op" id="6154065">&gt;&gt;</span><span class="num" id="6154067">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154075">dst</span>&nbsp;<span class="op" id="6154079">=</span>&nbsp;<span class="ident" id="6154081">dst</span><span class="op" id="6154084">[</span><span class="num" id="6154085">5</span><span class="op" id="6154086">:</span><span class="op" id="6154087">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154091">switch</span>&nbsp;<span class="ident" id="6154098">dlen</span>&nbsp;<span class="op" id="6154103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154107">case</span>&nbsp;<span class="num" id="6154112">2</span><span class="op" id="6154113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154118">n</span>&nbsp;<span class="op" id="6154120">+=</span>&nbsp;<span class="num" id="6154123">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154127">case</span>&nbsp;<span class="num" id="6154132">4</span><span class="op" id="6154133">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154138">n</span>&nbsp;<span class="op" id="6154140">+=</span>&nbsp;<span class="num" id="6154143">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154147">case</span>&nbsp;<span class="num" id="6154152">5</span><span class="op" id="6154153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154158">n</span>&nbsp;<span class="op" id="6154160">+=</span>&nbsp;<span class="num" id="6154163">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154167">case</span>&nbsp;<span class="num" id="6154172">7</span><span class="op" id="6154173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154178">n</span>&nbsp;<span class="op" id="6154180">+=</span>&nbsp;<span class="num" id="6154183">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154187">case</span>&nbsp;<span class="num" id="6154192">8</span><span class="op" id="6154193">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154198">n</span>&nbsp;<span class="op" id="6154200">+=</span>&nbsp;<span class="num" id="6154203">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154213">return</span>&nbsp;<span class="ident" id="6154220">n</span><span class="op" id="6154221">,</span>&nbsp;<span class="ident" id="6154223">end</span><span class="op" id="6154226">,</span>&nbsp;<span class="builtintype" id="6154228">nil</span><br>
<span class="lineno"></span><span class="op" id="6154232">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="6154235">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="6154300">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="6154369">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6154438">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="6154501">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="6154549">func</span>&nbsp;<span class="op" id="6154554">(</span><span class="ident" id="6154555">enc</span>&nbsp;<span class="op" id="6154559">*</span><span class="ident" id="6154560">Encoding</span><span class="op" id="6154568">)</span>&nbsp;<span class="ident" id="6154570">Decode</span><span class="op" id="6154576">(</span><span class="ident" id="6154577">dst</span><span class="op" id="6154580">,</span>&nbsp;<span class="ident" id="6154582">src</span>&nbsp;<span class="op" id="6154586">[</span><span class="op" id="6154587">]</span><span class="builtintype" id="6154588">byte</span><span class="op" id="6154592">)</span>&nbsp;<span class="op" id="6154594">(</span><span class="ident" id="6154595">n</span>&nbsp;<span class="builtintype" id="6154597">int</span><span class="op" id="6154600">,</span>&nbsp;<span class="ident" id="6154602">err</span>&nbsp;<span class="builtintype" id="6154606">error</span><span class="op" id="6154611">)</span>&nbsp;<span class="op" id="6154613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154616">src</span>&nbsp;<span class="op" id="6154620">=</span>&nbsp;<span class="ident" id="6154622">bytes</span><span class="op" id="6154627">.</span><span class="ident" id="6154628">Map</span><span class="op" id="6154631">(</span><span class="ident" id="6154632">removeNewlinesMapper</span><span class="op" id="6154652">,</span>&nbsp;<span class="ident" id="6154654">src</span><span class="op" id="6154657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154660">n</span><span class="op" id="6154661">,</span>&nbsp;<span class="ident" id="6154663">_</span><span class="op" id="6154664">,</span>&nbsp;<span class="ident" id="6154666">err</span>&nbsp;<span class="op" id="6154670">=</span>&nbsp;<span class="ident" id="6154672">enc</span><span class="op" id="6154675">.</span><span class="ident" id="6154676">decode</span><span class="op" id="6154682">(</span><span class="ident" id="6154683">dst</span><span class="op" id="6154686">,</span>&nbsp;<span class="ident" id="6154688">src</span><span class="op" id="6154691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154694">return</span><br>
<span class="lineno">325</span><span class="op" id="6154701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6154704">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6154774">func</span>&nbsp;<span class="op" id="6154779">(</span><span class="ident" id="6154780">enc</span>&nbsp;<span class="op" id="6154784">*</span><span class="ident" id="6154785">Encoding</span><span class="op" id="6154793">)</span>&nbsp;<span class="ident" id="6154795">DecodeString</span><span class="op" id="6154807">(</span><span class="ident" id="6154808">s</span>&nbsp;<span class="builtintype" id="6154810">string</span><span class="op" id="6154816">)</span>&nbsp;<span class="op" id="6154818">(</span><span class="op" id="6154819">[</span><span class="op" id="6154820">]</span><span class="builtintype" id="6154821">byte</span><span class="op" id="6154825">,</span>&nbsp;<span class="builtintype" id="6154827">error</span><span class="op" id="6154832">)</span>&nbsp;<span class="op" id="6154834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154837">s</span>&nbsp;<span class="op" id="6154839">=</span>&nbsp;<span class="ident" id="6154841">strings</span><span class="op" id="6154848">.</span><span class="ident" id="6154849">Map</span><span class="op" id="6154852">(</span><span class="ident" id="6154853">removeNewlinesMapper</span><span class="op" id="6154873">,</span>&nbsp;<span class="ident" id="6154875">s</span><span class="op" id="6154876">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154879">dbuf</span>&nbsp;<span class="op" id="6154884">:=</span>&nbsp;<span class="builtinfunc" id="6154887">make</span><span class="op" id="6154891">(</span><span class="op" id="6154892">[</span><span class="op" id="6154893">]</span><span class="builtintype" id="6154894">byte</span><span class="op" id="6154898">,</span>&nbsp;<span class="ident" id="6154900">enc</span><span class="op" id="6154903">.</span><span class="ident" id="6154904">DecodedLen</span><span class="op" id="6154914">(</span><span class="builtinfunc" id="6154915">len</span><span class="op" id="6154918">(</span><span class="ident" id="6154919">s</span><span class="op" id="6154920">)</span><span class="op" id="6154921">)</span><span class="op" id="6154922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154925">n</span><span class="op" id="6154926">,</span>&nbsp;<span class="ident" id="6154928">_</span><span class="op" id="6154929">,</span>&nbsp;<span class="ident" id="6154931">err</span>&nbsp;<span class="op" id="6154935">:=</span>&nbsp;<span class="ident" id="6154938">enc</span><span class="op" id="6154941">.</span><span class="ident" id="6154942">decode</span><span class="op" id="6154948">(</span><span class="ident" id="6154949">dbuf</span><span class="op" id="6154953">,</span>&nbsp;<span class="op" id="6154955">[</span><span class="op" id="6154956">]</span><span class="builtintype" id="6154957">byte</span><span class="op" id="6154961">(</span><span class="ident" id="6154962">s</span><span class="op" id="6154963">)</span><span class="op" id="6154964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154967">return</span>&nbsp;<span class="ident" id="6154974">dbuf</span><span class="op" id="6154978">[</span><span class="op" id="6154979">:</span><span class="ident" id="6154980">n</span><span class="op" id="6154981">]</span><span class="op" id="6154982">,</span>&nbsp;<span class="ident" id="6154984">err</span><br>
<span class="lineno"></span><span class="op" id="6154988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6154991">type</span>&nbsp;<span class="ident" id="6154996">decoder</span>&nbsp;<span class="keyword" id="6155004">struct</span>&nbsp;<span class="op" id="6155011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155014">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6155021">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155028">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155035">*</span><span class="ident" id="6155036">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155046">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155053">io</span><span class="op" id="6155055">.</span><span class="ident" id="6155056">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155064">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6155071">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6155082">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155105">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155112">[</span><span class="num" id="6155113">1024</span><span class="op" id="6155117">]</span><span class="builtintype" id="6155118">byte</span>&nbsp;<span class="comment" id="6155123">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155142">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6155149">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155154">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155161">[</span><span class="op" id="6155162">]</span><span class="builtintype" id="6155163">byte</span>&nbsp;<span class="comment" id="6155168">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155196">outbuf</span>&nbsp;<span class="op" id="6155203">[</span><span class="num" id="6155204">1024</span>&nbsp;<span class="op" id="6155209">/</span>&nbsp;<span class="num" id="6155211">8</span>&nbsp;<span class="op" id="6155213">*</span>&nbsp;<span class="num" id="6155215">5</span><span class="op" id="6155216">]</span><span class="builtintype" id="6155217">byte</span><br>
<span class="lineno"></span><span class="op" id="6155222">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="6155225">func</span>&nbsp;<span class="op" id="6155230">(</span><span class="ident" id="6155231">d</span>&nbsp;<span class="op" id="6155233">*</span><span class="ident" id="6155234">decoder</span><span class="op" id="6155241">)</span>&nbsp;<span class="ident" id="6155243">Read</span><span class="op" id="6155247">(</span><span class="ident" id="6155248">p</span>&nbsp;<span class="op" id="6155250">[</span><span class="op" id="6155251">]</span><span class="builtintype" id="6155252">byte</span><span class="op" id="6155256">)</span>&nbsp;<span class="op" id="6155258">(</span><span class="ident" id="6155259">n</span>&nbsp;<span class="builtintype" id="6155261">int</span><span class="op" id="6155264">,</span>&nbsp;<span class="ident" id="6155266">err</span>&nbsp;<span class="builtintype" id="6155270">error</span><span class="op" id="6155275">)</span>&nbsp;<span class="op" id="6155277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155280">if</span>&nbsp;<span class="ident" id="6155283">d</span><span class="op" id="6155284">.</span><span class="ident" id="6155285">err</span>&nbsp;<span class="op" id="6155289">!=</span>&nbsp;<span class="builtintype" id="6155292">nil</span>&nbsp;<span class="op" id="6155296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155300">return</span>&nbsp;<span class="num" id="6155307">0</span><span class="op" id="6155308">,</span>&nbsp;<span class="ident" id="6155310">d</span><span class="op" id="6155311">.</span><span class="ident" id="6155312">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155317">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6155321">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155369">if</span>&nbsp;<span class="builtinfunc" id="6155372">len</span><span class="op" id="6155375">(</span><span class="ident" id="6155376">d</span><span class="op" id="6155377">.</span><span class="ident" id="6155378">out</span><span class="op" id="6155381">)</span>&nbsp;<span class="op" id="6155383">&gt;</span>&nbsp;<span class="num" id="6155385">0</span>&nbsp;<span class="op" id="6155387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155391">n</span>&nbsp;<span class="op" id="6155393">=</span>&nbsp;<span class="builtinfunc" id="6155395">copy</span><span class="op" id="6155399">(</span><span class="ident" id="6155400">p</span><span class="op" id="6155401">,</span>&nbsp;<span class="ident" id="6155403">d</span><span class="op" id="6155404">.</span><span class="ident" id="6155405">out</span><span class="op" id="6155408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155412">d</span><span class="op" id="6155413">.</span><span class="ident" id="6155414">out</span>&nbsp;<span class="op" id="6155418">=</span>&nbsp;<span class="ident" id="6155420">d</span><span class="op" id="6155421">.</span><span class="ident" id="6155422">out</span><span class="op" id="6155425">[</span><span class="ident" id="6155426">n</span><span class="op" id="6155427">:</span><span class="op" id="6155428">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155432">return</span>&nbsp;<span class="ident" id="6155439">n</span><span class="op" id="6155440">,</span>&nbsp;<span class="builtintype" id="6155442">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6155451">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155469">nn</span>&nbsp;<span class="op" id="6155472">:=</span>&nbsp;<span class="builtinfunc" id="6155475">len</span><span class="op" id="6155478">(</span><span class="ident" id="6155479">p</span><span class="op" id="6155480">)</span>&nbsp;<span class="op" id="6155482">/</span>&nbsp;<span class="num" id="6155484">5</span>&nbsp;<span class="op" id="6155486">*</span>&nbsp;<span class="num" id="6155488">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155491">if</span>&nbsp;<span class="ident" id="6155494">nn</span>&nbsp;<span class="op" id="6155497">&lt;</span>&nbsp;<span class="num" id="6155499">8</span>&nbsp;<span class="op" id="6155501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155505">nn</span>&nbsp;<span class="op" id="6155508">=</span>&nbsp;<span class="num" id="6155510">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155516">if</span>&nbsp;<span class="ident" id="6155519">nn</span>&nbsp;<span class="op" id="6155522">&gt;</span>&nbsp;<span class="builtinfunc" id="6155524">len</span><span class="op" id="6155527">(</span><span class="ident" id="6155528">d</span><span class="op" id="6155529">.</span><span class="ident" id="6155530">buf</span><span class="op" id="6155533">)</span>&nbsp;<span class="op" id="6155535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155539">nn</span>&nbsp;<span class="op" id="6155542">=</span>&nbsp;<span class="builtinfunc" id="6155544">len</span><span class="op" id="6155547">(</span><span class="ident" id="6155548">d</span><span class="op" id="6155549">.</span><span class="ident" id="6155550">buf</span><span class="op" id="6155553">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155559">nn</span><span class="op" id="6155561">,</span>&nbsp;<span class="ident" id="6155563">d</span><span class="op" id="6155564">.</span><span class="ident" id="6155565">err</span>&nbsp;<span class="op" id="6155569">=</span>&nbsp;<span class="ident" id="6155571">io</span><span class="op" id="6155573">.</span><span class="ident" id="6155574">ReadAtLeast</span><span class="op" id="6155585">(</span><span class="ident" id="6155586">d</span><span class="op" id="6155587">.</span><span class="ident" id="6155588">r</span><span class="op" id="6155589">,</span>&nbsp;<span class="ident" id="6155591">d</span><span class="op" id="6155592">.</span><span class="ident" id="6155593">buf</span><span class="op" id="6155596">[</span><span class="ident" id="6155597">d</span><span class="op" id="6155598">.</span><span class="ident" id="6155599">nbuf</span><span class="op" id="6155603">:</span><span class="ident" id="6155604">nn</span><span class="op" id="6155606">]</span><span class="op" id="6155607">,</span>&nbsp;<span class="num" id="6155609">8</span><span class="op" id="6155610">-</span><span class="ident" id="6155611">d</span><span class="op" id="6155612">.</span><span class="ident" id="6155613">nbuf</span><span class="op" id="6155617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155620">d</span><span class="op" id="6155621">.</span><span class="ident" id="6155622">nbuf</span>&nbsp;<span class="op" id="6155627">+=</span>&nbsp;<span class="ident" id="6155630">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155634">if</span>&nbsp;<span class="ident" id="6155637">d</span><span class="op" id="6155638">.</span><span class="ident" id="6155639">nbuf</span>&nbsp;<span class="op" id="6155644">&lt;</span>&nbsp;<span class="num" id="6155646">8</span>&nbsp;<span class="op" id="6155648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155652">return</span>&nbsp;<span class="num" id="6155659">0</span><span class="op" id="6155660">,</span>&nbsp;<span class="ident" id="6155662">d</span><span class="op" id="6155663">.</span><span class="ident" id="6155664">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6155673">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155737">nr</span>&nbsp;<span class="op" id="6155740">:=</span>&nbsp;<span class="ident" id="6155743">d</span><span class="op" id="6155744">.</span><span class="ident" id="6155745">nbuf</span>&nbsp;<span class="op" id="6155750">/</span>&nbsp;<span class="num" id="6155752">8</span>&nbsp;<span class="op" id="6155754">*</span>&nbsp;<span class="num" id="6155756">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155759">nw</span>&nbsp;<span class="op" id="6155762">:=</span>&nbsp;<span class="ident" id="6155765">d</span><span class="op" id="6155766">.</span><span class="ident" id="6155767">nbuf</span>&nbsp;<span class="op" id="6155772">/</span>&nbsp;<span class="num" id="6155774">8</span>&nbsp;<span class="op" id="6155776">*</span>&nbsp;<span class="num" id="6155778">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6155781">if</span>&nbsp;<span class="ident" id="6155784">nw</span>&nbsp;<span class="op" id="6155787">&gt;</span>&nbsp;<span class="builtinfunc" id="6155789">len</span><span class="op" id="6155792">(</span><span class="ident" id="6155793">p</span><span class="op" id="6155794">)</span>&nbsp;<span class="op" id="6155796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155800">nw</span><span class="op" id="6155802">,</span>&nbsp;<span class="ident" id="6155804">d</span><span class="op" id="6155805">.</span><span class="ident" id="6155806">end</span><span class="op" id="6155809">,</span>&nbsp;<span class="ident" id="6155811">d</span><span class="op" id="6155812">.</span><span class="ident" id="6155813">err</span>&nbsp;<span class="op" id="6155817">=</span>&nbsp;<span class="ident" id="6155819">d</span><span class="op" id="6155820">.</span><span class="ident" id="6155821">enc</span><span class="op" id="6155824">.</span><span class="ident" id="6155825">decode</span><span class="op" id="6155831">(</span><span class="ident" id="6155832">d</span><span class="op" id="6155833">.</span><span class="ident" id="6155834">outbuf</span><span class="op" id="6155840">[</span><span class="num" id="6155841">0</span><span class="op" id="6155842">:</span><span class="op" id="6155843">]</span><span class="op" id="6155844">,</span>&nbsp;<span class="ident" id="6155846">d</span><span class="op" id="6155847">.</span><span class="ident" id="6155848">buf</span><span class="op" id="6155851">[</span><span class="num" id="6155852">0</span><span class="op" id="6155853">:</span><span class="ident" id="6155854">nr</span><span class="op" id="6155856">]</span><span class="op" id="6155857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155861">d</span><span class="op" id="6155862">.</span><span class="ident" id="6155863">out</span>&nbsp;<span class="op" id="6155867">=</span>&nbsp;<span class="ident" id="6155869">d</span><span class="op" id="6155870">.</span><span class="ident" id="6155871">outbuf</span><span class="op" id="6155877">[</span><span class="num" id="6155878">0</span><span class="op" id="6155879">:</span><span class="ident" id="6155880">nw</span><span class="op" id="6155882">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155886">n</span>&nbsp;<span class="op" id="6155888">=</span>&nbsp;<span class="builtinfunc" id="6155890">copy</span><span class="op" id="6155894">(</span><span class="ident" id="6155895">p</span><span class="op" id="6155896">,</span>&nbsp;<span class="ident" id="6155898">d</span><span class="op" id="6155899">.</span><span class="ident" id="6155900">out</span><span class="op" id="6155903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155907">d</span><span class="op" id="6155908">.</span><span class="ident" id="6155909">out</span>&nbsp;<span class="op" id="6155913">=</span>&nbsp;<span class="ident" id="6155915">d</span><span class="op" id="6155916">.</span><span class="ident" id="6155917">out</span><span class="op" id="6155920">[</span><span class="ident" id="6155921">n</span><span class="op" id="6155922">:</span><span class="op" id="6155923">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155926">}</span>&nbsp;<span class="keyword" id="6155928">else</span>&nbsp;<span class="op" id="6155933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155937">n</span><span class="op" id="6155938">,</span>&nbsp;<span class="ident" id="6155940">d</span><span class="op" id="6155941">.</span><span class="ident" id="6155942">end</span><span class="op" id="6155945">,</span>&nbsp;<span class="ident" id="6155947">d</span><span class="op" id="6155948">.</span><span class="ident" id="6155949">err</span>&nbsp;<span class="op" id="6155953">=</span>&nbsp;<span class="ident" id="6155955">d</span><span class="op" id="6155956">.</span><span class="ident" id="6155957">enc</span><span class="op" id="6155960">.</span><span class="ident" id="6155961">decode</span><span class="op" id="6155967">(</span><span class="ident" id="6155968">p</span><span class="op" id="6155969">,</span>&nbsp;<span class="ident" id="6155971">d</span><span class="op" id="6155972">.</span><span class="ident" id="6155973">buf</span><span class="op" id="6155976">[</span><span class="num" id="6155977">0</span><span class="op" id="6155978">:</span><span class="ident" id="6155979">nr</span><span class="op" id="6155981">]</span><span class="op" id="6155982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155988">d</span><span class="op" id="6155989">.</span><span class="ident" id="6155990">nbuf</span>&nbsp;<span class="op" id="6155995">-=</span>&nbsp;<span class="ident" id="6155998">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156002">for</span>&nbsp;<span class="ident" id="6156006">i</span>&nbsp;<span class="op" id="6156008">:=</span>&nbsp;<span class="num" id="6156011">0</span><span class="op" id="6156012">;</span>&nbsp;<span class="ident" id="6156014">i</span>&nbsp;<span class="op" id="6156016">&lt;</span>&nbsp;<span class="ident" id="6156018">d</span><span class="op" id="6156019">.</span><span class="ident" id="6156020">nbuf</span><span class="op" id="6156024">;</span>&nbsp;<span class="ident" id="6156026">i</span><span class="op" id="6156027">++</span>&nbsp;<span class="op" id="6156030">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156034">d</span><span class="op" id="6156035">.</span><span class="ident" id="6156036">buf</span><span class="op" id="6156039">[</span><span class="ident" id="6156040">i</span><span class="op" id="6156041">]</span>&nbsp;<span class="op" id="6156043">=</span>&nbsp;<span class="ident" id="6156045">d</span><span class="op" id="6156046">.</span><span class="ident" id="6156047">buf</span><span class="op" id="6156050">[</span><span class="ident" id="6156051">i</span><span class="op" id="6156052">+</span><span class="ident" id="6156053">nr</span><span class="op" id="6156055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156062">if</span>&nbsp;<span class="ident" id="6156065">d</span><span class="op" id="6156066">.</span><span class="ident" id="6156067">err</span>&nbsp;<span class="op" id="6156071">==</span>&nbsp;<span class="builtintype" id="6156074">nil</span>&nbsp;<span class="op" id="6156078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156082">d</span><span class="op" id="6156083">.</span><span class="ident" id="6156084">err</span>&nbsp;<span class="op" id="6156088">=</span>&nbsp;<span class="ident" id="6156090">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156098">return</span>&nbsp;<span class="ident" id="6156105">n</span><span class="op" id="6156106">,</span>&nbsp;<span class="ident" id="6156108">d</span><span class="op" id="6156109">.</span><span class="ident" id="6156110">err</span><br>
<span class="lineno"></span><span class="op" id="6156114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6156117">type</span>&nbsp;<span class="ident" id="6156122">newlineFilteringReader</span>&nbsp;<span class="keyword" id="6156145">struct</span>&nbsp;<span class="op" id="6156152">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156155">wrapped</span>&nbsp;<span class="ident" id="6156163">io</span><span class="op" id="6156165">.</span><span class="ident" id="6156166">Reader</span><br>
<span class="lineno"></span><span class="op" id="6156173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6156176">func</span>&nbsp;<span class="op" id="6156181">(</span><span class="ident" id="6156182">r</span>&nbsp;<span class="op" id="6156184">*</span><span class="ident" id="6156185">newlineFilteringReader</span><span class="op" id="6156207">)</span>&nbsp;<span class="ident" id="6156209">Read</span><span class="op" id="6156213">(</span><span class="ident" id="6156214">p</span>&nbsp;<span class="op" id="6156216">[</span><span class="op" id="6156217">]</span><span class="builtintype" id="6156218">byte</span><span class="op" id="6156222">)</span>&nbsp;<span class="op" id="6156224">(</span><span class="builtintype" id="6156225">int</span><span class="op" id="6156228">,</span>&nbsp;<span class="builtintype" id="6156230">error</span><span class="op" id="6156235">)</span>&nbsp;<span class="op" id="6156237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156240">n</span><span class="op" id="6156241">,</span>&nbsp;<span class="ident" id="6156243">err</span>&nbsp;<span class="op" id="6156247">:=</span>&nbsp;<span class="ident" id="6156250">r</span><span class="op" id="6156251">.</span><span class="ident" id="6156252">wrapped</span><span class="op" id="6156259">.</span><span class="ident" id="6156260">Read</span><span class="op" id="6156264">(</span><span class="ident" id="6156265">p</span><span class="op" id="6156266">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156269">for</span>&nbsp;<span class="ident" id="6156273">n</span>&nbsp;<span class="op" id="6156275">&gt;</span>&nbsp;<span class="num" id="6156277">0</span>&nbsp;<span class="op" id="6156279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156283">offset</span>&nbsp;<span class="op" id="6156290">:=</span>&nbsp;<span class="num" id="6156293">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156297">for</span>&nbsp;<span class="ident" id="6156301">i</span><span class="op" id="6156302">,</span>&nbsp;<span class="ident" id="6156304">b</span>&nbsp;<span class="op" id="6156306">:=</span>&nbsp;<span class="keyword" id="6156309">range</span>&nbsp;<span class="ident" id="6156315">p</span><span class="op" id="6156316">[</span><span class="num" id="6156317">0</span><span class="op" id="6156318">:</span><span class="ident" id="6156319">n</span><span class="op" id="6156320">]</span>&nbsp;<span class="op" id="6156322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156327">if</span>&nbsp;<span class="ident" id="6156330">b</span>&nbsp;<span class="op" id="6156332">!=</span>&nbsp;<span class="string" id="6156335">&#39;\r&#39;</span>&nbsp;<span class="op" id="6156340">&amp;&amp;</span>&nbsp;<span class="ident" id="6156343">b</span>&nbsp;<span class="op" id="6156345">!=</span>&nbsp;<span class="string" id="6156348">&#39;\n&#39;</span>&nbsp;<span class="op" id="6156353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156359">if</span>&nbsp;<span class="ident" id="6156362">i</span>&nbsp;<span class="op" id="6156364">!=</span>&nbsp;<span class="ident" id="6156367">offset</span>&nbsp;<span class="op" id="6156374">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156381">p</span><span class="op" id="6156382">[</span><span class="ident" id="6156383">offset</span><span class="op" id="6156389">]</span>&nbsp;<span class="op" id="6156391">=</span>&nbsp;<span class="ident" id="6156393">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156405">offset</span><span class="op" id="6156411">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156421">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156425">if</span>&nbsp;<span class="ident" id="6156428">offset</span>&nbsp;<span class="op" id="6156435">&gt;</span>&nbsp;<span class="num" id="6156437">0</span>&nbsp;<span class="op" id="6156439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156444">return</span>&nbsp;<span class="ident" id="6156451">offset</span><span class="op" id="6156457">,</span>&nbsp;<span class="ident" id="6156459">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6156469">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156522">n</span><span class="op" id="6156523">,</span>&nbsp;<span class="ident" id="6156525">err</span>&nbsp;<span class="op" id="6156529">=</span>&nbsp;<span class="ident" id="6156531">r</span><span class="op" id="6156532">.</span><span class="ident" id="6156533">wrapped</span><span class="op" id="6156540">.</span><span class="ident" id="6156541">Read</span><span class="op" id="6156545">(</span><span class="ident" id="6156546">p</span><span class="op" id="6156547">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156553">return</span>&nbsp;<span class="ident" id="6156560">n</span><span class="op" id="6156561">,</span>&nbsp;<span class="ident" id="6156563">err</span><br>
<span class="lineno"></span><span class="op" id="6156567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6156570">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="6156624">func</span>&nbsp;<span class="ident" id="6156629">NewDecoder</span><span class="op" id="6156639">(</span><span class="ident" id="6156640">enc</span>&nbsp;<span class="op" id="6156644">*</span><span class="ident" id="6156645">Encoding</span><span class="op" id="6156653">,</span>&nbsp;<span class="ident" id="6156655">r</span>&nbsp;<span class="ident" id="6156657">io</span><span class="op" id="6156659">.</span><span class="ident" id="6156660">Reader</span><span class="op" id="6156666">)</span>&nbsp;<span class="ident" id="6156668">io</span><span class="op" id="6156670">.</span><span class="ident" id="6156671">Reader</span>&nbsp;<span class="op" id="6156678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156681">return</span>&nbsp;<span class="op" id="6156688">&amp;</span><span class="ident" id="6156689">decoder</span><span class="op" id="6156696">{</span><span class="ident" id="6156697">enc</span><span class="op" id="6156700">:</span>&nbsp;<span class="ident" id="6156702">enc</span><span class="op" id="6156705">,</span>&nbsp;<span class="ident" id="6156707">r</span><span class="op" id="6156708">:</span>&nbsp;<span class="op" id="6156710">&amp;</span><span class="ident" id="6156711">newlineFilteringReader</span><span class="op" id="6156733">{</span><span class="ident" id="6156734">r</span><span class="op" id="6156735">}</span><span class="op" id="6156736">}</span><br>
<span class="lineno"></span><span class="op" id="6156738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6156741">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="6156811">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6156863">func</span>&nbsp;<span class="op" id="6156868">(</span><span class="ident" id="6156869">enc</span>&nbsp;<span class="op" id="6156873">*</span><span class="ident" id="6156874">Encoding</span><span class="op" id="6156882">)</span>&nbsp;<span class="ident" id="6156884">DecodedLen</span><span class="op" id="6156894">(</span><span class="ident" id="6156895">n</span>&nbsp;<span class="builtintype" id="6156897">int</span><span class="op" id="6156900">)</span>&nbsp;<span class="builtintype" id="6156902">int</span>&nbsp;<span class="op" id="6156906">{</span>&nbsp;<span class="keyword" id="6156908">return</span>&nbsp;<span class="ident" id="6156915">n</span>&nbsp;<span class="op" id="6156917">/</span>&nbsp;<span class="num" id="6156919">8</span>&nbsp;<span class="op" id="6156921">*</span>&nbsp;<span class="num" id="6156923">5</span>&nbsp;<span class="op" id="6156925">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
