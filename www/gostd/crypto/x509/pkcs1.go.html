<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html" class="current">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4356506">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4356561">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4356615">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4356666">package</span>&nbsp;<span class="ident" id="4356674">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4356680">import</span>&nbsp;<span class="op" id="4356687">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4356690">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4356704">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4356721">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4356731">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4356742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4356745">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4356834">type</span>&nbsp;<span class="ident" id="4356839">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4356855">struct</span>&nbsp;<span class="op" id="4356862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4356865">Version</span>&nbsp;<span class="builtintype" id="4356873">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4356878">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4356886">*</span><span class="ident" id="4356887">big</span><span class="op" id="4356890">.</span><span class="ident" id="4356891">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4356896">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4356904">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4356909">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4356917">*</span><span class="ident" id="4356918">big</span><span class="op" id="4356921">.</span><span class="ident" id="4356922">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4356927">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4356935">*</span><span class="ident" id="4356936">big</span><span class="op" id="4356939">.</span><span class="ident" id="4356940">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4356945">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4356953">*</span><span class="ident" id="4356954">big</span><span class="op" id="4356957">.</span><span class="ident" id="4356958">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4356963">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357036">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4357041">*</span><span class="ident" id="4357042">big</span><span class="op" id="4357045">.</span><span class="ident" id="4357046">Int</span>&nbsp;<span class="string" id="4357050">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357069">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4357074">*</span><span class="ident" id="4357075">big</span><span class="op" id="4357078">.</span><span class="ident" id="4357079">Int</span>&nbsp;<span class="string" id="4357083">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357102">Qinv</span>&nbsp;<span class="op" id="4357107">*</span><span class="ident" id="4357108">big</span><span class="op" id="4357111">.</span><span class="ident" id="4357112">Int</span>&nbsp;<span class="string" id="4357116">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357136">AdditionalPrimes</span>&nbsp;<span class="op" id="4357153">[</span><span class="op" id="4357154">]</span><span class="ident" id="4357155">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="4357179">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4357207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4357210">type</span>&nbsp;<span class="ident" id="4357215">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4357239">struct</span>&nbsp;<span class="op" id="4357246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357249">Prime</span>&nbsp;<span class="op" id="4357255">*</span><span class="ident" id="4357256">big</span><span class="op" id="4357259">.</span><span class="ident" id="4357260">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4357266">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357326">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4357332">*</span><span class="ident" id="4357333">big</span><span class="op" id="4357336">.</span><span class="ident" id="4357337">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357342">Coeff</span>&nbsp;<span class="op" id="4357348">*</span><span class="ident" id="4357349">big</span><span class="op" id="4357352">.</span><span class="ident" id="4357353">Int</span><br>
<span class="lineno"></span><span class="op" id="4357357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4357360">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4357451">func</span>&nbsp;<span class="ident" id="4357456">ParsePKCS1PrivateKey</span><span class="op" id="4357476">(</span><span class="ident" id="4357477">der</span>&nbsp;<span class="op" id="4357481">[</span><span class="op" id="4357482">]</span><span class="builtintype" id="4357483">byte</span><span class="op" id="4357487">)</span>&nbsp;<span class="op" id="4357489">(</span><span class="ident" id="4357490">key</span>&nbsp;<span class="op" id="4357494">*</span><span class="ident" id="4357495">rsa</span><span class="op" id="4357498">.</span><span class="ident" id="4357499">PrivateKey</span><span class="op" id="4357509">,</span>&nbsp;<span class="ident" id="4357511">err</span>&nbsp;<span class="builtintype" id="4357515">error</span><span class="op" id="4357520">)</span>&nbsp;<span class="op" id="4357522">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357525">var</span>&nbsp;<span class="ident" id="4357529">priv</span>&nbsp;<span class="ident" id="4357534">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357551">rest</span><span class="op" id="4357555">,</span>&nbsp;<span class="ident" id="4357557">err</span>&nbsp;<span class="op" id="4357561">:=</span>&nbsp;<span class="ident" id="4357564">asn1</span><span class="op" id="4357568">.</span><span class="ident" id="4357569">Unmarshal</span><span class="op" id="4357578">(</span><span class="ident" id="4357579">der</span><span class="op" id="4357582">,</span>&nbsp;<span class="op" id="4357584">&amp;</span><span class="ident" id="4357585">priv</span><span class="op" id="4357589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357592">if</span>&nbsp;<span class="builtinfunc" id="4357595">len</span><span class="op" id="4357598">(</span><span class="ident" id="4357599">rest</span><span class="op" id="4357603">)</span>&nbsp;<span class="op" id="4357605">&gt;</span>&nbsp;<span class="num" id="4357607">0</span>&nbsp;<span class="op" id="4357609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357613">err</span>&nbsp;<span class="op" id="4357617">=</span>&nbsp;<span class="ident" id="4357619">asn1</span><span class="op" id="4357623">.</span><span class="ident" id="4357624">SyntaxError</span><span class="op" id="4357635">{</span><span class="ident" id="4357636">Msg</span><span class="op" id="4357639">:</span>&nbsp;<span class="string" id="4357641">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4357656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357660">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357671">if</span>&nbsp;<span class="ident" id="4357674">err</span>&nbsp;<span class="op" id="4357678">!=</span>&nbsp;<span class="builtintype" id="4357681">nil</span>&nbsp;<span class="op" id="4357685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357689">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357701">if</span>&nbsp;<span class="ident" id="4357704">priv</span><span class="op" id="4357708">.</span><span class="ident" id="4357709">Version</span>&nbsp;<span class="op" id="4357717">&gt;</span>&nbsp;<span class="num" id="4357719">1</span>&nbsp;<span class="op" id="4357721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357725">return</span>&nbsp;<span class="builtintype" id="4357732">nil</span><span class="op" id="4357735">,</span>&nbsp;<span class="ident" id="4357737">errors</span><span class="op" id="4357743">.</span><span class="ident" id="4357744">New</span><span class="op" id="4357747">(</span><span class="string" id="4357748">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4357787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357794">if</span>&nbsp;<span class="ident" id="4357797">priv</span><span class="op" id="4357801">.</span><span class="ident" id="4357802">N</span><span class="op" id="4357803">.</span><span class="ident" id="4357804">Sign</span><span class="op" id="4357808">(</span><span class="op" id="4357809">)</span>&nbsp;<span class="op" id="4357811">&lt;=</span>&nbsp;<span class="num" id="4357814">0</span>&nbsp;<span class="op" id="4357816">||</span>&nbsp;<span class="ident" id="4357819">priv</span><span class="op" id="4357823">.</span><span class="ident" id="4357824">D</span><span class="op" id="4357825">.</span><span class="ident" id="4357826">Sign</span><span class="op" id="4357830">(</span><span class="op" id="4357831">)</span>&nbsp;<span class="op" id="4357833">&lt;=</span>&nbsp;<span class="num" id="4357836">0</span>&nbsp;<span class="op" id="4357838">||</span>&nbsp;<span class="ident" id="4357841">priv</span><span class="op" id="4357845">.</span><span class="ident" id="4357846">P</span><span class="op" id="4357847">.</span><span class="ident" id="4357848">Sign</span><span class="op" id="4357852">(</span><span class="op" id="4357853">)</span>&nbsp;<span class="op" id="4357855">&lt;=</span>&nbsp;<span class="num" id="4357858">0</span>&nbsp;<span class="op" id="4357860">||</span>&nbsp;<span class="ident" id="4357863">priv</span><span class="op" id="4357867">.</span><span class="ident" id="4357868">Q</span><span class="op" id="4357869">.</span><span class="ident" id="4357870">Sign</span><span class="op" id="4357874">(</span><span class="op" id="4357875">)</span>&nbsp;<span class="op" id="4357877">&lt;=</span>&nbsp;<span class="num" id="4357880">0</span>&nbsp;<span class="op" id="4357882">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357886">return</span>&nbsp;<span class="builtintype" id="4357893">nil</span><span class="op" id="4357896">,</span>&nbsp;<span class="ident" id="4357898">errors</span><span class="op" id="4357904">.</span><span class="ident" id="4357905">New</span><span class="op" id="4357908">(</span><span class="string" id="4357909">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4357960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357967">key</span>&nbsp;<span class="op" id="4357971">=</span>&nbsp;<span class="builtinfunc" id="4357973">new</span><span class="op" id="4357976">(</span><span class="ident" id="4357977">rsa</span><span class="op" id="4357980">.</span><span class="ident" id="4357981">PrivateKey</span><span class="op" id="4357991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357994">key</span><span class="op" id="4357997">.</span><span class="ident" id="4357998">PublicKey</span>&nbsp;<span class="op" id="4358008">=</span>&nbsp;<span class="ident" id="4358010">rsa</span><span class="op" id="4358013">.</span><span class="ident" id="4358014">PublicKey</span><span class="op" id="4358023">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358027">E</span><span class="op" id="4358028">:</span>&nbsp;<span class="ident" id="4358030">priv</span><span class="op" id="4358034">.</span><span class="ident" id="4358035">E</span><span class="op" id="4358036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358040">N</span><span class="op" id="4358041">:</span>&nbsp;<span class="ident" id="4358043">priv</span><span class="op" id="4358047">.</span><span class="ident" id="4358048">N</span><span class="op" id="4358049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358056">key</span><span class="op" id="4358059">.</span><span class="ident" id="4358060">D</span>&nbsp;<span class="op" id="4358062">=</span>&nbsp;<span class="ident" id="4358064">priv</span><span class="op" id="4358068">.</span><span class="ident" id="4358069">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358072">key</span><span class="op" id="4358075">.</span><span class="ident" id="4358076">Primes</span>&nbsp;<span class="op" id="4358083">=</span>&nbsp;<span class="builtinfunc" id="4358085">make</span><span class="op" id="4358089">(</span><span class="op" id="4358090">[</span><span class="op" id="4358091">]</span><span class="op" id="4358092">*</span><span class="ident" id="4358093">big</span><span class="op" id="4358096">.</span><span class="ident" id="4358097">Int</span><span class="op" id="4358100">,</span>&nbsp;<span class="num" id="4358102">2</span><span class="op" id="4358103">+</span><span class="builtinfunc" id="4358104">len</span><span class="op" id="4358107">(</span><span class="ident" id="4358108">priv</span><span class="op" id="4358112">.</span><span class="ident" id="4358113">AdditionalPrimes</span><span class="op" id="4358129">)</span><span class="op" id="4358130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358133">key</span><span class="op" id="4358136">.</span><span class="ident" id="4358137">Primes</span><span class="op" id="4358143">[</span><span class="num" id="4358144">0</span><span class="op" id="4358145">]</span>&nbsp;<span class="op" id="4358147">=</span>&nbsp;<span class="ident" id="4358149">priv</span><span class="op" id="4358153">.</span><span class="ident" id="4358154">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358157">key</span><span class="op" id="4358160">.</span><span class="ident" id="4358161">Primes</span><span class="op" id="4358167">[</span><span class="num" id="4358168">1</span><span class="op" id="4358169">]</span>&nbsp;<span class="op" id="4358171">=</span>&nbsp;<span class="ident" id="4358173">priv</span><span class="op" id="4358177">.</span><span class="ident" id="4358178">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358181">for</span>&nbsp;<span class="ident" id="4358185">i</span><span class="op" id="4358186">,</span>&nbsp;<span class="ident" id="4358188">a</span>&nbsp;<span class="op" id="4358190">:=</span>&nbsp;<span class="keyword" id="4358193">range</span>&nbsp;<span class="ident" id="4358199">priv</span><span class="op" id="4358203">.</span><span class="ident" id="4358204">AdditionalPrimes</span>&nbsp;<span class="op" id="4358221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358225">if</span>&nbsp;<span class="ident" id="4358228">a</span><span class="op" id="4358229">.</span><span class="ident" id="4358230">Prime</span><span class="op" id="4358235">.</span><span class="ident" id="4358236">Sign</span><span class="op" id="4358240">(</span><span class="op" id="4358241">)</span>&nbsp;<span class="op" id="4358243">&lt;=</span>&nbsp;<span class="num" id="4358246">0</span>&nbsp;<span class="op" id="4358248">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358253">return</span>&nbsp;<span class="builtintype" id="4358260">nil</span><span class="op" id="4358263">,</span>&nbsp;<span class="ident" id="4358265">errors</span><span class="op" id="4358271">.</span><span class="ident" id="4358272">New</span><span class="op" id="4358275">(</span><span class="string" id="4358276">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4358327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358335">key</span><span class="op" id="4358338">.</span><span class="ident" id="4358339">Primes</span><span class="op" id="4358345">[</span><span class="ident" id="4358346">i</span><span class="op" id="4358347">+</span><span class="num" id="4358348">2</span><span class="op" id="4358349">]</span>&nbsp;<span class="op" id="4358351">=</span>&nbsp;<span class="ident" id="4358353">a</span><span class="op" id="4358354">.</span><span class="ident" id="4358355">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4358363">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4358426">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358450">err</span>&nbsp;<span class="op" id="4358454">=</span>&nbsp;<span class="ident" id="4358456">key</span><span class="op" id="4358459">.</span><span class="ident" id="4358460">Validate</span><span class="op" id="4358468">(</span><span class="op" id="4358469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358472">if</span>&nbsp;<span class="ident" id="4358475">err</span>&nbsp;<span class="op" id="4358479">!=</span>&nbsp;<span class="builtintype" id="4358482">nil</span>&nbsp;<span class="op" id="4358486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358490">return</span>&nbsp;<span class="builtintype" id="4358497">nil</span><span class="op" id="4358500">,</span>&nbsp;<span class="ident" id="4358502">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358510">key</span><span class="op" id="4358513">.</span><span class="ident" id="4358514">Precompute</span><span class="op" id="4358524">(</span><span class="op" id="4358525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358529">return</span><br>
<span class="lineno"></span><span class="op" id="4358536">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4358539">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4358615">func</span>&nbsp;<span class="ident" id="4358620">MarshalPKCS1PrivateKey</span><span class="op" id="4358642">(</span><span class="ident" id="4358643">key</span>&nbsp;<span class="op" id="4358647">*</span><span class="ident" id="4358648">rsa</span><span class="op" id="4358651">.</span><span class="ident" id="4358652">PrivateKey</span><span class="op" id="4358662">)</span>&nbsp;<span class="op" id="4358664">[</span><span class="op" id="4358665">]</span><span class="builtintype" id="4358666">byte</span>&nbsp;<span class="op" id="4358671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358674">key</span><span class="op" id="4358677">.</span><span class="ident" id="4358678">Precompute</span><span class="op" id="4358688">(</span><span class="op" id="4358689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358693">version</span>&nbsp;<span class="op" id="4358701">:=</span>&nbsp;<span class="num" id="4358704">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358707">if</span>&nbsp;<span class="builtinfunc" id="4358710">len</span><span class="op" id="4358713">(</span><span class="ident" id="4358714">key</span><span class="op" id="4358717">.</span><span class="ident" id="4358718">Primes</span><span class="op" id="4358724">)</span>&nbsp;<span class="op" id="4358726">&gt;</span>&nbsp;<span class="num" id="4358728">2</span>&nbsp;<span class="op" id="4358730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358734">version</span>&nbsp;<span class="op" id="4358742">=</span>&nbsp;<span class="num" id="4358744">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358751">priv</span>&nbsp;<span class="op" id="4358756">:=</span>&nbsp;<span class="ident" id="4358759">pkcs1PrivateKey</span><span class="op" id="4358774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358778">Version</span><span class="op" id="4358785">:</span>&nbsp;<span class="ident" id="4358787">version</span><span class="op" id="4358794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358798">N</span><span class="op" id="4358799">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358807">key</span><span class="op" id="4358810">.</span><span class="ident" id="4358811">N</span><span class="op" id="4358812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358816">E</span><span class="op" id="4358817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358825">key</span><span class="op" id="4358828">.</span><span class="ident" id="4358829">PublicKey</span><span class="op" id="4358838">.</span><span class="ident" id="4358839">E</span><span class="op" id="4358840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358844">D</span><span class="op" id="4358845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358853">key</span><span class="op" id="4358856">.</span><span class="ident" id="4358857">D</span><span class="op" id="4358858">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358862">P</span><span class="op" id="4358863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358871">key</span><span class="op" id="4358874">.</span><span class="ident" id="4358875">Primes</span><span class="op" id="4358881">[</span><span class="num" id="4358882">0</span><span class="op" id="4358883">]</span><span class="op" id="4358884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358888">Q</span><span class="op" id="4358889">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358897">key</span><span class="op" id="4358900">.</span><span class="ident" id="4358901">Primes</span><span class="op" id="4358907">[</span><span class="num" id="4358908">1</span><span class="op" id="4358909">]</span><span class="op" id="4358910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358914">Dp</span><span class="op" id="4358916">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358923">key</span><span class="op" id="4358926">.</span><span class="ident" id="4358927">Precomputed</span><span class="op" id="4358938">.</span><span class="ident" id="4358939">Dp</span><span class="op" id="4358941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358945">Dq</span><span class="op" id="4358947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358954">key</span><span class="op" id="4358957">.</span><span class="ident" id="4358958">Precomputed</span><span class="op" id="4358969">.</span><span class="ident" id="4358970">Dq</span><span class="op" id="4358972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358976">Qinv</span><span class="op" id="4358980">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358985">key</span><span class="op" id="4358988">.</span><span class="ident" id="4358989">Precomputed</span><span class="op" id="4359000">.</span><span class="ident" id="4359001">Qinv</span><span class="op" id="4359005">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4359008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359012">priv</span><span class="op" id="4359016">.</span><span class="ident" id="4359017">AdditionalPrimes</span>&nbsp;<span class="op" id="4359034">=</span>&nbsp;<span class="builtinfunc" id="4359036">make</span><span class="op" id="4359040">(</span><span class="op" id="4359041">[</span><span class="op" id="4359042">]</span><span class="ident" id="4359043">pkcs1AdditionalRSAPrime</span><span class="op" id="4359066">,</span>&nbsp;<span class="builtinfunc" id="4359068">len</span><span class="op" id="4359071">(</span><span class="ident" id="4359072">key</span><span class="op" id="4359075">.</span><span class="ident" id="4359076">Precomputed</span><span class="op" id="4359087">.</span><span class="ident" id="4359088">CRTValues</span><span class="op" id="4359097">)</span><span class="op" id="4359098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359101">for</span>&nbsp;<span class="ident" id="4359105">i</span><span class="op" id="4359106">,</span>&nbsp;<span class="ident" id="4359108">values</span>&nbsp;<span class="op" id="4359115">:=</span>&nbsp;<span class="keyword" id="4359118">range</span>&nbsp;<span class="ident" id="4359124">key</span><span class="op" id="4359127">.</span><span class="ident" id="4359128">Precomputed</span><span class="op" id="4359139">.</span><span class="ident" id="4359140">CRTValues</span>&nbsp;<span class="op" id="4359150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359154">priv</span><span class="op" id="4359158">.</span><span class="ident" id="4359159">AdditionalPrimes</span><span class="op" id="4359175">[</span><span class="ident" id="4359176">i</span><span class="op" id="4359177">]</span><span class="op" id="4359178">.</span><span class="ident" id="4359179">Prime</span>&nbsp;<span class="op" id="4359185">=</span>&nbsp;<span class="ident" id="4359187">key</span><span class="op" id="4359190">.</span><span class="ident" id="4359191">Primes</span><span class="op" id="4359197">[</span><span class="num" id="4359198">2</span><span class="op" id="4359199">+</span><span class="ident" id="4359200">i</span><span class="op" id="4359201">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359205">priv</span><span class="op" id="4359209">.</span><span class="ident" id="4359210">AdditionalPrimes</span><span class="op" id="4359226">[</span><span class="ident" id="4359227">i</span><span class="op" id="4359228">]</span><span class="op" id="4359229">.</span><span class="ident" id="4359230">Exp</span>&nbsp;<span class="op" id="4359234">=</span>&nbsp;<span class="ident" id="4359236">values</span><span class="op" id="4359242">.</span><span class="ident" id="4359243">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359249">priv</span><span class="op" id="4359253">.</span><span class="ident" id="4359254">AdditionalPrimes</span><span class="op" id="4359270">[</span><span class="ident" id="4359271">i</span><span class="op" id="4359272">]</span><span class="op" id="4359273">.</span><span class="ident" id="4359274">Coeff</span>&nbsp;<span class="op" id="4359280">=</span>&nbsp;<span class="ident" id="4359282">values</span><span class="op" id="4359288">.</span><span class="ident" id="4359289">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4359296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359300">b</span><span class="op" id="4359301">,</span>&nbsp;<span class="ident" id="4359303">_</span>&nbsp;<span class="op" id="4359305">:=</span>&nbsp;<span class="ident" id="4359308">asn1</span><span class="op" id="4359312">.</span><span class="ident" id="4359313">Marshal</span><span class="op" id="4359320">(</span><span class="ident" id="4359321">priv</span><span class="op" id="4359325">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359328">return</span>&nbsp;<span class="ident" id="4359335">b</span><br>
<span class="lineno"></span><span class="op" id="4359337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4359340">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4359409">type</span>&nbsp;<span class="ident" id="4359414">rsaPublicKey</span>&nbsp;<span class="keyword" id="4359427">struct</span>&nbsp;<span class="op" id="4359434">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359437">N</span>&nbsp;<span class="op" id="4359439">*</span><span class="ident" id="4359440">big</span><span class="op" id="4359443">.</span><span class="ident" id="4359444">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359449">E</span>&nbsp;<span class="builtintype" id="4359451">int</span><br>
<span class="lineno"></span><span class="op" id="4359455">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
