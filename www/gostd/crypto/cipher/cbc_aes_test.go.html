<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html" class="current">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="122174">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="122229">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="122283">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="122334">//&nbsp;CBC&nbsp;AES&nbsp;test&nbsp;vectors.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="122360">//&nbsp;See&nbsp;U.S.&nbsp;National&nbsp;Institute&nbsp;of&nbsp;Standards&nbsp;and&nbsp;Technology&nbsp;(NIST)</span><br>
<span class="lineno"></span><span class="comment" id="122426">//&nbsp;Special&nbsp;Publication&nbsp;800-38A,&nbsp;``Recommendation&nbsp;for&nbsp;Block&nbsp;Cipher</span><br>
<span class="lineno"></span><span class="comment" id="122492">//&nbsp;Modes&nbsp;of&nbsp;Operation,&#39;&#39;&nbsp;2001&nbsp;Edition,&nbsp;pp.&nbsp;24-29.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="122543">package</span>&nbsp;<span class="ident" id="122551">cipher_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="122564">import</span>&nbsp;<span class="op" id="122571">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="122574">&#34;bytes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="122583">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="122597">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="122614">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="122624">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="122627">var</span>&nbsp;<span class="ident" id="122631">cbcAESTests</span>&nbsp;<span class="op" id="122643">=</span>&nbsp;<span class="op" id="122645">[</span><span class="op" id="122646">]</span><span class="keyword" id="122647">struct</span>&nbsp;<span class="op" id="122654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122657">name</span>&nbsp;<span class="builtintype" id="122662">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122670">key</span>&nbsp;&nbsp;<span class="op" id="122675">[</span><span class="op" id="122676">]</span><span class="builtintype" id="122677">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122683">iv</span>&nbsp;&nbsp;&nbsp;<span class="op" id="122688">[</span><span class="op" id="122689">]</span><span class="builtintype" id="122690">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122696">in</span>&nbsp;&nbsp;&nbsp;<span class="op" id="122701">[</span><span class="op" id="122702">]</span><span class="builtintype" id="122703">byte</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122709">out</span>&nbsp;&nbsp;<span class="op" id="122714">[</span><span class="op" id="122715">]</span><span class="builtintype" id="122716">byte</span><br>
<span class="lineno"></span><span class="op" id="122721">}</span><span class="op" id="122722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="122725">//&nbsp;NIST&nbsp;SP&nbsp;800-38A&nbsp;pp&nbsp;27-29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="122754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="122758">&#34;CBC-AES128&#34;</span><span class="op" id="122770">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122774">commonKey128</span><span class="op" id="122786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122790">commonIV</span><span class="op" id="122798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122802">commonInput</span><span class="op" id="122813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="122817">[</span><span class="op" id="122818">]</span><span class="builtintype" id="122819">byte</span><span class="op" id="122823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="122828">0x76</span><span class="op" id="122832">,</span>&nbsp;<span class="num" id="122834">0x49</span><span class="op" id="122838">,</span>&nbsp;<span class="num" id="122840">0xab</span><span class="op" id="122844">,</span>&nbsp;<span class="num" id="122846">0xac</span><span class="op" id="122850">,</span>&nbsp;<span class="num" id="122852">0x81</span><span class="op" id="122856">,</span>&nbsp;<span class="num" id="122858">0x19</span><span class="op" id="122862">,</span>&nbsp;<span class="num" id="122864">0xb2</span><span class="op" id="122868">,</span>&nbsp;<span class="num" id="122870">0x46</span><span class="op" id="122874">,</span>&nbsp;<span class="num" id="122876">0xce</span><span class="op" id="122880">,</span>&nbsp;<span class="num" id="122882">0xe9</span><span class="op" id="122886">,</span>&nbsp;<span class="num" id="122888">0x8e</span><span class="op" id="122892">,</span>&nbsp;<span class="num" id="122894">0x9b</span><span class="op" id="122898">,</span>&nbsp;<span class="num" id="122900">0x12</span><span class="op" id="122904">,</span>&nbsp;<span class="num" id="122906">0xe9</span><span class="op" id="122910">,</span>&nbsp;<span class="num" id="122912">0x19</span><span class="op" id="122916">,</span>&nbsp;<span class="num" id="122918">0x7d</span><span class="op" id="122922">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="122927">0x50</span><span class="op" id="122931">,</span>&nbsp;<span class="num" id="122933">0x86</span><span class="op" id="122937">,</span>&nbsp;<span class="num" id="122939">0xcb</span><span class="op" id="122943">,</span>&nbsp;<span class="num" id="122945">0x9b</span><span class="op" id="122949">,</span>&nbsp;<span class="num" id="122951">0x50</span><span class="op" id="122955">,</span>&nbsp;<span class="num" id="122957">0x72</span><span class="op" id="122961">,</span>&nbsp;<span class="num" id="122963">0x19</span><span class="op" id="122967">,</span>&nbsp;<span class="num" id="122969">0xee</span><span class="op" id="122973">,</span>&nbsp;<span class="num" id="122975">0x95</span><span class="op" id="122979">,</span>&nbsp;<span class="num" id="122981">0xdb</span><span class="op" id="122985">,</span>&nbsp;<span class="num" id="122987">0x11</span><span class="op" id="122991">,</span>&nbsp;<span class="num" id="122993">0x3a</span><span class="op" id="122997">,</span>&nbsp;<span class="num" id="122999">0x91</span><span class="op" id="123003">,</span>&nbsp;<span class="num" id="123005">0x76</span><span class="op" id="123009">,</span>&nbsp;<span class="num" id="123011">0x78</span><span class="op" id="123015">,</span>&nbsp;<span class="num" id="123017">0xb2</span><span class="op" id="123021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123026">0x73</span><span class="op" id="123030">,</span>&nbsp;<span class="num" id="123032">0xbe</span><span class="op" id="123036">,</span>&nbsp;<span class="num" id="123038">0xd6</span><span class="op" id="123042">,</span>&nbsp;<span class="num" id="123044">0xb8</span><span class="op" id="123048">,</span>&nbsp;<span class="num" id="123050">0xe3</span><span class="op" id="123054">,</span>&nbsp;<span class="num" id="123056">0xc1</span><span class="op" id="123060">,</span>&nbsp;<span class="num" id="123062">0x74</span><span class="op" id="123066">,</span>&nbsp;<span class="num" id="123068">0x3b</span><span class="op" id="123072">,</span>&nbsp;<span class="num" id="123074">0x71</span><span class="op" id="123078">,</span>&nbsp;<span class="num" id="123080">0x16</span><span class="op" id="123084">,</span>&nbsp;<span class="num" id="123086">0xe6</span><span class="op" id="123090">,</span>&nbsp;<span class="num" id="123092">0x9e</span><span class="op" id="123096">,</span>&nbsp;<span class="num" id="123098">0x22</span><span class="op" id="123102">,</span>&nbsp;<span class="num" id="123104">0x22</span><span class="op" id="123108">,</span>&nbsp;<span class="num" id="123110">0x95</span><span class="op" id="123114">,</span>&nbsp;<span class="num" id="123116">0x16</span><span class="op" id="123120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123125">0x3f</span><span class="op" id="123129">,</span>&nbsp;<span class="num" id="123131">0xf1</span><span class="op" id="123135">,</span>&nbsp;<span class="num" id="123137">0xca</span><span class="op" id="123141">,</span>&nbsp;<span class="num" id="123143">0xa1</span><span class="op" id="123147">,</span>&nbsp;<span class="num" id="123149">0x68</span><span class="op" id="123153">,</span>&nbsp;<span class="num" id="123155">0x1f</span><span class="op" id="123159">,</span>&nbsp;<span class="num" id="123161">0xac</span><span class="op" id="123165">,</span>&nbsp;<span class="num" id="123167">0x09</span><span class="op" id="123171">,</span>&nbsp;<span class="num" id="123173">0x12</span><span class="op" id="123177">,</span>&nbsp;<span class="num" id="123179">0x0e</span><span class="op" id="123183">,</span>&nbsp;<span class="num" id="123185">0xca</span><span class="op" id="123189">,</span>&nbsp;<span class="num" id="123191">0x30</span><span class="op" id="123195">,</span>&nbsp;<span class="num" id="123197">0x75</span><span class="op" id="123201">,</span>&nbsp;<span class="num" id="123203">0x86</span><span class="op" id="123207">,</span>&nbsp;<span class="num" id="123209">0xe1</span><span class="op" id="123213">,</span>&nbsp;<span class="num" id="123215">0xa7</span><span class="op" id="123219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123223">}</span><span class="op" id="123224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123227">}</span><span class="op" id="123228">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="123235">&#34;CBC-AES192&#34;</span><span class="op" id="123247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="123251">commonKey192</span><span class="op" id="123263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="123267">commonIV</span><span class="op" id="123275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="123279">commonInput</span><span class="op" id="123290">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123294">[</span><span class="op" id="123295">]</span><span class="builtintype" id="123296">byte</span><span class="op" id="123300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123305">0x4f</span><span class="op" id="123309">,</span>&nbsp;<span class="num" id="123311">0x02</span><span class="op" id="123315">,</span>&nbsp;<span class="num" id="123317">0x1d</span><span class="op" id="123321">,</span>&nbsp;<span class="num" id="123323">0xb2</span><span class="op" id="123327">,</span>&nbsp;<span class="num" id="123329">0x43</span><span class="op" id="123333">,</span>&nbsp;<span class="num" id="123335">0xbc</span><span class="op" id="123339">,</span>&nbsp;<span class="num" id="123341">0x63</span><span class="op" id="123345">,</span>&nbsp;<span class="num" id="123347">0x3d</span><span class="op" id="123351">,</span>&nbsp;<span class="num" id="123353">0x71</span><span class="op" id="123357">,</span>&nbsp;<span class="num" id="123359">0x78</span><span class="op" id="123363">,</span>&nbsp;<span class="num" id="123365">0x18</span><span class="op" id="123369">,</span>&nbsp;<span class="num" id="123371">0x3a</span><span class="op" id="123375">,</span>&nbsp;<span class="num" id="123377">0x9f</span><span class="op" id="123381">,</span>&nbsp;<span class="num" id="123383">0xa0</span><span class="op" id="123387">,</span>&nbsp;<span class="num" id="123389">0x71</span><span class="op" id="123393">,</span>&nbsp;<span class="num" id="123395">0xe8</span><span class="op" id="123399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123404">0xb4</span><span class="op" id="123408">,</span>&nbsp;<span class="num" id="123410">0xd9</span><span class="op" id="123414">,</span>&nbsp;<span class="num" id="123416">0xad</span><span class="op" id="123420">,</span>&nbsp;<span class="num" id="123422">0xa9</span><span class="op" id="123426">,</span>&nbsp;<span class="num" id="123428">0xad</span><span class="op" id="123432">,</span>&nbsp;<span class="num" id="123434">0x7d</span><span class="op" id="123438">,</span>&nbsp;<span class="num" id="123440">0xed</span><span class="op" id="123444">,</span>&nbsp;<span class="num" id="123446">0xf4</span><span class="op" id="123450">,</span>&nbsp;<span class="num" id="123452">0xe5</span><span class="op" id="123456">,</span>&nbsp;<span class="num" id="123458">0xe7</span><span class="op" id="123462">,</span>&nbsp;<span class="num" id="123464">0x38</span><span class="op" id="123468">,</span>&nbsp;<span class="num" id="123470">0x76</span><span class="op" id="123474">,</span>&nbsp;<span class="num" id="123476">0x3f</span><span class="op" id="123480">,</span>&nbsp;<span class="num" id="123482">0x69</span><span class="op" id="123486">,</span>&nbsp;<span class="num" id="123488">0x14</span><span class="op" id="123492">,</span>&nbsp;<span class="num" id="123494">0x5a</span><span class="op" id="123498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123503">0x57</span><span class="op" id="123507">,</span>&nbsp;<span class="num" id="123509">0x1b</span><span class="op" id="123513">,</span>&nbsp;<span class="num" id="123515">0x24</span><span class="op" id="123519">,</span>&nbsp;<span class="num" id="123521">0x20</span><span class="op" id="123525">,</span>&nbsp;<span class="num" id="123527">0x12</span><span class="op" id="123531">,</span>&nbsp;<span class="num" id="123533">0xfb</span><span class="op" id="123537">,</span>&nbsp;<span class="num" id="123539">0x7a</span><span class="op" id="123543">,</span>&nbsp;<span class="num" id="123545">0xe0</span><span class="op" id="123549">,</span>&nbsp;<span class="num" id="123551">0x7f</span><span class="op" id="123555">,</span>&nbsp;<span class="num" id="123557">0xa9</span><span class="op" id="123561">,</span>&nbsp;<span class="num" id="123563">0xba</span><span class="op" id="123567">,</span>&nbsp;<span class="num" id="123569">0xac</span><span class="op" id="123573">,</span>&nbsp;<span class="num" id="123575">0x3d</span><span class="op" id="123579">,</span>&nbsp;<span class="num" id="123581">0xf1</span><span class="op" id="123585">,</span>&nbsp;<span class="num" id="123587">0x02</span><span class="op" id="123591">,</span>&nbsp;<span class="num" id="123593">0xe0</span><span class="op" id="123597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123602">0x08</span><span class="op" id="123606">,</span>&nbsp;<span class="num" id="123608">0xb0</span><span class="op" id="123612">,</span>&nbsp;<span class="num" id="123614">0xe2</span><span class="op" id="123618">,</span>&nbsp;<span class="num" id="123620">0x79</span><span class="op" id="123624">,</span>&nbsp;<span class="num" id="123626">0x88</span><span class="op" id="123630">,</span>&nbsp;<span class="num" id="123632">0x59</span><span class="op" id="123636">,</span>&nbsp;<span class="num" id="123638">0x88</span><span class="op" id="123642">,</span>&nbsp;<span class="num" id="123644">0x81</span><span class="op" id="123648">,</span>&nbsp;<span class="num" id="123650">0xd9</span><span class="op" id="123654">,</span>&nbsp;<span class="num" id="123656">0x20</span><span class="op" id="123660">,</span>&nbsp;<span class="num" id="123662">0xa9</span><span class="op" id="123666">,</span>&nbsp;<span class="num" id="123668">0xe6</span><span class="op" id="123672">,</span>&nbsp;<span class="num" id="123674">0x4f</span><span class="op" id="123678">,</span>&nbsp;<span class="num" id="123680">0x56</span><span class="op" id="123684">,</span>&nbsp;<span class="num" id="123686">0x15</span><span class="op" id="123690">,</span>&nbsp;<span class="num" id="123692">0xcd</span><span class="op" id="123696">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123700">}</span><span class="op" id="123701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123704">}</span><span class="op" id="123705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="123712">&#34;CBC-AES256&#34;</span><span class="op" id="123724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="123728">commonKey256</span><span class="op" id="123740">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="123744">commonIV</span><span class="op" id="123752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="123756">commonInput</span><span class="op" id="123767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="123771">[</span><span class="op" id="123772">]</span><span class="builtintype" id="123773">byte</span><span class="op" id="123777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123782">0xf5</span><span class="op" id="123786">,</span>&nbsp;<span class="num" id="123788">0x8c</span><span class="op" id="123792">,</span>&nbsp;<span class="num" id="123794">0x4c</span><span class="op" id="123798">,</span>&nbsp;<span class="num" id="123800">0x04</span><span class="op" id="123804">,</span>&nbsp;<span class="num" id="123806">0xd6</span><span class="op" id="123810">,</span>&nbsp;<span class="num" id="123812">0xe5</span><span class="op" id="123816">,</span>&nbsp;<span class="num" id="123818">0xf1</span><span class="op" id="123822">,</span>&nbsp;<span class="num" id="123824">0xba</span><span class="op" id="123828">,</span>&nbsp;<span class="num" id="123830">0x77</span><span class="op" id="123834">,</span>&nbsp;<span class="num" id="123836">0x9e</span><span class="op" id="123840">,</span>&nbsp;<span class="num" id="123842">0xab</span><span class="op" id="123846">,</span>&nbsp;<span class="num" id="123848">0xfb</span><span class="op" id="123852">,</span>&nbsp;<span class="num" id="123854">0x5f</span><span class="op" id="123858">,</span>&nbsp;<span class="num" id="123860">0x7b</span><span class="op" id="123864">,</span>&nbsp;<span class="num" id="123866">0xfb</span><span class="op" id="123870">,</span>&nbsp;<span class="num" id="123872">0xd6</span><span class="op" id="123876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123881">0x9c</span><span class="op" id="123885">,</span>&nbsp;<span class="num" id="123887">0xfc</span><span class="op" id="123891">,</span>&nbsp;<span class="num" id="123893">0x4e</span><span class="op" id="123897">,</span>&nbsp;<span class="num" id="123899">0x96</span><span class="op" id="123903">,</span>&nbsp;<span class="num" id="123905">0x7e</span><span class="op" id="123909">,</span>&nbsp;<span class="num" id="123911">0xdb</span><span class="op" id="123915">,</span>&nbsp;<span class="num" id="123917">0x80</span><span class="op" id="123921">,</span>&nbsp;<span class="num" id="123923">0x8d</span><span class="op" id="123927">,</span>&nbsp;<span class="num" id="123929">0x67</span><span class="op" id="123933">,</span>&nbsp;<span class="num" id="123935">0x9f</span><span class="op" id="123939">,</span>&nbsp;<span class="num" id="123941">0x77</span><span class="op" id="123945">,</span>&nbsp;<span class="num" id="123947">0x7b</span><span class="op" id="123951">,</span>&nbsp;<span class="num" id="123953">0xc6</span><span class="op" id="123957">,</span>&nbsp;<span class="num" id="123959">0x70</span><span class="op" id="123963">,</span>&nbsp;<span class="num" id="123965">0x2c</span><span class="op" id="123969">,</span>&nbsp;<span class="num" id="123971">0x7d</span><span class="op" id="123975">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="123980">0x39</span><span class="op" id="123984">,</span>&nbsp;<span class="num" id="123986">0xf2</span><span class="op" id="123990">,</span>&nbsp;<span class="num" id="123992">0x33</span><span class="op" id="123996">,</span>&nbsp;<span class="num" id="123998">0x69</span><span class="op" id="124002">,</span>&nbsp;<span class="num" id="124004">0xa9</span><span class="op" id="124008">,</span>&nbsp;<span class="num" id="124010">0xd9</span><span class="op" id="124014">,</span>&nbsp;<span class="num" id="124016">0xba</span><span class="op" id="124020">,</span>&nbsp;<span class="num" id="124022">0xcf</span><span class="op" id="124026">,</span>&nbsp;<span class="num" id="124028">0xa5</span><span class="op" id="124032">,</span>&nbsp;<span class="num" id="124034">0x30</span><span class="op" id="124038">,</span>&nbsp;<span class="num" id="124040">0xe2</span><span class="op" id="124044">,</span>&nbsp;<span class="num" id="124046">0x63</span><span class="op" id="124050">,</span>&nbsp;<span class="num" id="124052">0x04</span><span class="op" id="124056">,</span>&nbsp;<span class="num" id="124058">0x23</span><span class="op" id="124062">,</span>&nbsp;<span class="num" id="124064">0x14</span><span class="op" id="124068">,</span>&nbsp;<span class="num" id="124070">0x61</span><span class="op" id="124074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="124079">0xb2</span><span class="op" id="124083">,</span>&nbsp;<span class="num" id="124085">0xeb</span><span class="op" id="124089">,</span>&nbsp;<span class="num" id="124091">0x05</span><span class="op" id="124095">,</span>&nbsp;<span class="num" id="124097">0xe2</span><span class="op" id="124101">,</span>&nbsp;<span class="num" id="124103">0xc3</span><span class="op" id="124107">,</span>&nbsp;<span class="num" id="124109">0x9b</span><span class="op" id="124113">,</span>&nbsp;<span class="num" id="124115">0xe9</span><span class="op" id="124119">,</span>&nbsp;<span class="num" id="124121">0xfc</span><span class="op" id="124125">,</span>&nbsp;<span class="num" id="124127">0xda</span><span class="op" id="124131">,</span>&nbsp;<span class="num" id="124133">0x6c</span><span class="op" id="124137">,</span>&nbsp;<span class="num" id="124139">0x19</span><span class="op" id="124143">,</span>&nbsp;<span class="num" id="124145">0x07</span><span class="op" id="124149">,</span>&nbsp;<span class="num" id="124151">0x8c</span><span class="op" id="124155">,</span>&nbsp;<span class="num" id="124157">0x6a</span><span class="op" id="124161">,</span>&nbsp;<span class="num" id="124163">0x9d</span><span class="op" id="124167">,</span>&nbsp;<span class="num" id="124169">0x1b</span><span class="op" id="124173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="124177">}</span><span class="op" id="124178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="124181">}</span><span class="op" id="124182">,</span><br>
<span class="lineno"></span><span class="op" id="124184">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="124187">func</span>&nbsp;<span class="ident" id="124192">TestCBCEncrypterAES</span><span class="op" id="124211">(</span><span class="ident" id="124212">t</span>&nbsp;<span class="op" id="124214">*</span><span class="ident" id="124215">testing</span><span class="op" id="124222">.</span><span class="ident" id="124223">T</span><span class="op" id="124224">)</span>&nbsp;<span class="op" id="124226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124229">for</span>&nbsp;<span class="ident" id="124233">_</span><span class="op" id="124234">,</span>&nbsp;<span class="ident" id="124236">test</span>&nbsp;<span class="op" id="124241">:=</span>&nbsp;<span class="keyword" id="124244">range</span>&nbsp;<span class="ident" id="124250">cbcAESTests</span>&nbsp;<span class="op" id="124262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124266">c</span><span class="op" id="124267">,</span>&nbsp;<span class="ident" id="124269">err</span>&nbsp;<span class="op" id="124273">:=</span>&nbsp;<span class="ident" id="124276">aes</span><span class="op" id="124279">.</span><span class="ident" id="124280">NewCipher</span><span class="op" id="124289">(</span><span class="ident" id="124290">test</span><span class="op" id="124294">.</span><span class="ident" id="124295">key</span><span class="op" id="124298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124302">if</span>&nbsp;<span class="ident" id="124305">err</span>&nbsp;<span class="op" id="124309">!=</span>&nbsp;<span class="ident" id="124312">nil</span>&nbsp;<span class="op" id="124316">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124321">t</span><span class="op" id="124322">.</span><span class="ident" id="124323">Errorf</span><span class="op" id="124329">(</span><span class="string" id="124330">&#34;%s:&nbsp;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="124360">,</span>&nbsp;<span class="ident" id="124362">test</span><span class="op" id="124366">.</span><span class="ident" id="124367">name</span><span class="op" id="124371">,</span>&nbsp;<span class="builtinfunc" id="124373">len</span><span class="op" id="124376">(</span><span class="ident" id="124377">test</span><span class="op" id="124381">.</span><span class="ident" id="124382">key</span><span class="op" id="124385">)</span><span class="op" id="124386">,</span>&nbsp;<span class="ident" id="124388">err</span><span class="op" id="124391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124396">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="124407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124412">encrypter</span>&nbsp;<span class="op" id="124422">:=</span>&nbsp;<span class="ident" id="124425">cipher</span><span class="op" id="124431">.</span><span class="ident" id="124432">NewCBCEncrypter</span><span class="op" id="124447">(</span><span class="ident" id="124448">c</span><span class="op" id="124449">,</span>&nbsp;<span class="ident" id="124451">test</span><span class="op" id="124455">.</span><span class="ident" id="124456">iv</span><span class="op" id="124458">)</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124463">data</span>&nbsp;<span class="op" id="124468">:=</span>&nbsp;<span class="builtinfunc" id="124471">make</span><span class="op" id="124475">(</span><span class="op" id="124476">[</span><span class="op" id="124477">]</span><span class="builtintype" id="124478">byte</span><span class="op" id="124482">,</span>&nbsp;<span class="builtinfunc" id="124484">len</span><span class="op" id="124487">(</span><span class="ident" id="124488">test</span><span class="op" id="124492">.</span><span class="ident" id="124493">in</span><span class="op" id="124495">)</span><span class="op" id="124496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="124500">copy</span><span class="op" id="124504">(</span><span class="ident" id="124505">data</span><span class="op" id="124509">,</span>&nbsp;<span class="ident" id="124511">test</span><span class="op" id="124515">.</span><span class="ident" id="124516">in</span><span class="op" id="124518">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124523">encrypter</span><span class="op" id="124532">.</span><span class="ident" id="124533">CryptBlocks</span><span class="op" id="124544">(</span><span class="ident" id="124545">data</span><span class="op" id="124549">,</span>&nbsp;<span class="ident" id="124551">data</span><span class="op" id="124555">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124559">if</span>&nbsp;<span class="op" id="124562">!</span><span class="ident" id="124563">bytes</span><span class="op" id="124568">.</span><span class="ident" id="124569">Equal</span><span class="op" id="124574">(</span><span class="ident" id="124575">test</span><span class="op" id="124579">.</span><span class="ident" id="124580">out</span><span class="op" id="124583">,</span>&nbsp;<span class="ident" id="124585">data</span><span class="op" id="124589">)</span>&nbsp;<span class="op" id="124591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124596">t</span><span class="op" id="124597">.</span><span class="ident" id="124598">Errorf</span><span class="op" id="124604">(</span><span class="string" id="124605">&#34;%s:&nbsp;CBCEncrypter\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="124641">,</span>&nbsp;<span class="ident" id="124643">test</span><span class="op" id="124647">.</span><span class="ident" id="124648">name</span><span class="op" id="124652">,</span>&nbsp;<span class="ident" id="124654">data</span><span class="op" id="124658">,</span>&nbsp;<span class="ident" id="124660">test</span><span class="op" id="124664">.</span><span class="ident" id="124665">out</span><span class="op" id="124668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="124672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="124675">}</span><br>
<span class="lineno"></span><span class="op" id="124677">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="124680">func</span>&nbsp;<span class="ident" id="124685">TestCBCDecrypterAES</span><span class="op" id="124704">(</span><span class="ident" id="124705">t</span>&nbsp;<span class="op" id="124707">*</span><span class="ident" id="124708">testing</span><span class="op" id="124715">.</span><span class="ident" id="124716">T</span><span class="op" id="124717">)</span>&nbsp;<span class="op" id="124719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124722">for</span>&nbsp;<span class="ident" id="124726">_</span><span class="op" id="124727">,</span>&nbsp;<span class="ident" id="124729">test</span>&nbsp;<span class="op" id="124734">:=</span>&nbsp;<span class="keyword" id="124737">range</span>&nbsp;<span class="ident" id="124743">cbcAESTests</span>&nbsp;<span class="op" id="124755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124759">c</span><span class="op" id="124760">,</span>&nbsp;<span class="ident" id="124762">err</span>&nbsp;<span class="op" id="124766">:=</span>&nbsp;<span class="ident" id="124769">aes</span><span class="op" id="124772">.</span><span class="ident" id="124773">NewCipher</span><span class="op" id="124782">(</span><span class="ident" id="124783">test</span><span class="op" id="124787">.</span><span class="ident" id="124788">key</span><span class="op" id="124791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124795">if</span>&nbsp;<span class="ident" id="124798">err</span>&nbsp;<span class="op" id="124802">!=</span>&nbsp;<span class="ident" id="124805">nil</span>&nbsp;<span class="op" id="124809">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124814">t</span><span class="op" id="124815">.</span><span class="ident" id="124816">Errorf</span><span class="op" id="124822">(</span><span class="string" id="124823">&#34;%s:&nbsp;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="124853">,</span>&nbsp;<span class="ident" id="124855">test</span><span class="op" id="124859">.</span><span class="ident" id="124860">name</span><span class="op" id="124864">,</span>&nbsp;<span class="builtinfunc" id="124866">len</span><span class="op" id="124869">(</span><span class="ident" id="124870">test</span><span class="op" id="124874">.</span><span class="ident" id="124875">key</span><span class="op" id="124878">)</span><span class="op" id="124879">,</span>&nbsp;<span class="ident" id="124881">err</span><span class="op" id="124884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="124889">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="124900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124905">decrypter</span>&nbsp;<span class="op" id="124915">:=</span>&nbsp;<span class="ident" id="124918">cipher</span><span class="op" id="124924">.</span><span class="ident" id="124925">NewCBCDecrypter</span><span class="op" id="124940">(</span><span class="ident" id="124941">c</span><span class="op" id="124942">,</span>&nbsp;<span class="ident" id="124944">test</span><span class="op" id="124948">.</span><span class="ident" id="124949">iv</span><span class="op" id="124951">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="124956">data</span>&nbsp;<span class="op" id="124961">:=</span>&nbsp;<span class="builtinfunc" id="124964">make</span><span class="op" id="124968">(</span><span class="op" id="124969">[</span><span class="op" id="124970">]</span><span class="builtintype" id="124971">byte</span><span class="op" id="124975">,</span>&nbsp;<span class="builtinfunc" id="124977">len</span><span class="op" id="124980">(</span><span class="ident" id="124981">test</span><span class="op" id="124985">.</span><span class="ident" id="124986">out</span><span class="op" id="124989">)</span><span class="op" id="124990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="124994">copy</span><span class="op" id="124998">(</span><span class="ident" id="124999">data</span><span class="op" id="125003">,</span>&nbsp;<span class="ident" id="125005">test</span><span class="op" id="125009">.</span><span class="ident" id="125010">out</span><span class="op" id="125013">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="125018">decrypter</span><span class="op" id="125027">.</span><span class="ident" id="125028">CryptBlocks</span><span class="op" id="125039">(</span><span class="ident" id="125040">data</span><span class="op" id="125044">,</span>&nbsp;<span class="ident" id="125046">data</span><span class="op" id="125050">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="125054">if</span>&nbsp;<span class="op" id="125057">!</span><span class="ident" id="125058">bytes</span><span class="op" id="125063">.</span><span class="ident" id="125064">Equal</span><span class="op" id="125069">(</span><span class="ident" id="125070">test</span><span class="op" id="125074">.</span><span class="ident" id="125075">in</span><span class="op" id="125077">,</span>&nbsp;<span class="ident" id="125079">data</span><span class="op" id="125083">)</span>&nbsp;<span class="op" id="125085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="125090">t</span><span class="op" id="125091">.</span><span class="ident" id="125092">Errorf</span><span class="op" id="125098">(</span><span class="string" id="125099">&#34;%s:&nbsp;CBCDecrypter\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="125135">,</span>&nbsp;<span class="ident" id="125137">test</span><span class="op" id="125141">.</span><span class="ident" id="125142">name</span><span class="op" id="125146">,</span>&nbsp;<span class="ident" id="125148">data</span><span class="op" id="125152">,</span>&nbsp;<span class="ident" id="125154">test</span><span class="op" id="125158">.</span><span class="ident" id="125159">in</span><span class="op" id="125161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="125165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="125168">}</span><br>
<span class="lineno"></span><span class="op" id="125170">}</span>
</div>
</body>
</html>
