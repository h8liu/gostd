<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3293570">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3293625">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3293679">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3293730">//&nbsp;Package&nbsp;cookiejar&nbsp;implements&nbsp;an&nbsp;in-memory&nbsp;RFC&nbsp;6265-compliant&nbsp;http.CookieJar.</span><br>
<span class="lineno"></span><span class="keyword" id="3293810">package</span>&nbsp;<span class="ident" id="3293818">cookiejar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3293829">import</span>&nbsp;<span class="op" id="3293836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293839">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293849">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293856">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293863">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293875">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293886">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293894">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293905">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3293913">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3293920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3293923">//&nbsp;PublicSuffixList&nbsp;provides&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;a&nbsp;domain.&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="3293996">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;&#34;example.com&#34;&nbsp;is&nbsp;&#34;com&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="3294051">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;&#34;foo1.foo2.foo3.co.uk&#34;&nbsp;is&nbsp;&#34;co.uk&#34;,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3294121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;&#34;bar.pvt.k12.ma.us&#34;&nbsp;is&nbsp;&#34;pvt.k12.ma.us&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3294192">//</span><br>
<span class="lineno">25</span><span class="comment" id="3294195">//&nbsp;Implementations&nbsp;of&nbsp;PublicSuffixList&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3294269">//&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="3294293">//</span><br>
<span class="lineno"></span><span class="comment" id="3294296">//&nbsp;An&nbsp;implementation&nbsp;that&nbsp;always&nbsp;returns&nbsp;&#34;&#34;&nbsp;is&nbsp;valid&nbsp;and&nbsp;may&nbsp;be&nbsp;useful&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3294371">//&nbsp;testing&nbsp;but&nbsp;it&nbsp;is&nbsp;not&nbsp;secure:&nbsp;it&nbsp;means&nbsp;that&nbsp;the&nbsp;HTTP&nbsp;server&nbsp;for&nbsp;foo.com&nbsp;can</span><br>
<span class="lineno">30</span><span class="comment" id="3294450">//&nbsp;set&nbsp;a&nbsp;cookie&nbsp;for&nbsp;bar.com.</span><br>
<span class="lineno"></span><span class="comment" id="3294479">//</span><br>
<span class="lineno"></span><span class="comment" id="3294482">//&nbsp;A&nbsp;public&nbsp;suffix&nbsp;list&nbsp;implementation&nbsp;is&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="3294539">//&nbsp;golang.org/x/net/publicsuffix.</span><br>
<span class="lineno"></span><span class="keyword" id="3294573">type</span>&nbsp;<span class="ident" id="3294578">PublicSuffixList</span>&nbsp;<span class="keyword" id="3294595">interface</span>&nbsp;<span class="op" id="3294605">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294608">//&nbsp;PublicSuffix&nbsp;returns&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;domain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294662">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294666">//&nbsp;TODO:&nbsp;specify&nbsp;which&nbsp;of&nbsp;the&nbsp;caller&nbsp;and&nbsp;callee&nbsp;is&nbsp;responsible&nbsp;for&nbsp;IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294737">//&nbsp;addresses,&nbsp;for&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;dots,&nbsp;for&nbsp;case&nbsp;sensitivity,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294809">//&nbsp;for&nbsp;IDN/Punycode.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294831">PublicSuffix</span><span class="op" id="3294843">(</span><span class="ident" id="3294844">domain</span>&nbsp;<span class="builtintype" id="3294851">string</span><span class="op" id="3294857">)</span>&nbsp;<span class="builtintype" id="3294859">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294868">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;source&nbsp;of&nbsp;this&nbsp;public&nbsp;suffix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294937">//&nbsp;list.&nbsp;The&nbsp;description&nbsp;will&nbsp;typically&nbsp;contain&nbsp;something&nbsp;like&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295008">//&nbsp;stamp&nbsp;or&nbsp;version&nbsp;number.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295037">String</span><span class="op" id="3295043">(</span><span class="op" id="3295044">)</span>&nbsp;<span class="builtintype" id="3295046">string</span><br>
<span class="lineno"></span><span class="op" id="3295053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3295056">//&nbsp;Options&nbsp;are&nbsp;the&nbsp;options&nbsp;for&nbsp;creating&nbsp;a&nbsp;new&nbsp;Jar.</span><br>
<span class="lineno"></span><span class="keyword" id="3295107">type</span>&nbsp;<span class="ident" id="3295112">Options</span>&nbsp;<span class="keyword" id="3295120">struct</span>&nbsp;<span class="op" id="3295127">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295130">//&nbsp;PublicSuffixList&nbsp;is&nbsp;the&nbsp;public&nbsp;suffix&nbsp;list&nbsp;that&nbsp;determines&nbsp;whether</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295201">//&nbsp;an&nbsp;HTTP&nbsp;server&nbsp;can&nbsp;set&nbsp;a&nbsp;cookie&nbsp;for&nbsp;a&nbsp;domain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295251">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295255">//&nbsp;A&nbsp;nil&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;may&nbsp;be&nbsp;useful&nbsp;for&nbsp;testing&nbsp;but&nbsp;it&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295324">//&nbsp;secure:&nbsp;it&nbsp;means&nbsp;that&nbsp;the&nbsp;HTTP&nbsp;server&nbsp;for&nbsp;foo.co.uk&nbsp;can&nbsp;set&nbsp;a&nbsp;cookie</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295397">//&nbsp;for&nbsp;bar.co.uk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295416">PublicSuffixList</span>&nbsp;<span class="ident" id="3295433"><a href="/net/http/cookiejar/jar.go.html#3294578">PublicSuffixList</a></span><br>
<span class="lineno"></span><span class="op" id="3295450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3295453">//&nbsp;Jar&nbsp;implements&nbsp;the&nbsp;http.CookieJar&nbsp;interface&nbsp;from&nbsp;the&nbsp;net/http&nbsp;package.</span><br>
<span class="lineno">60</span><span class="keyword" id="3295527">type</span>&nbsp;<span class="ident" id="3295532">Jar</span>&nbsp;<span class="keyword" id="3295536">struct</span>&nbsp;<span class="op" id="3295543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295546">psList</span>&nbsp;<span class="ident" id="3295553"><a href="/net/http/cookiejar/jar.go.html#3294578">PublicSuffixList</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295572">//&nbsp;mu&nbsp;locks&nbsp;the&nbsp;remaining&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295607">mu</span>&nbsp;<span class="ident" id="3295610"><a href="/net/http/cookiejar/jar.go.html#3293905">sync</a></span><span class="op" id="3295614">.</span><span class="ident" id="3295615">Mutex</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295623">//&nbsp;entries&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;entries,&nbsp;keyed&nbsp;by&nbsp;their&nbsp;eTLD+1&nbsp;and&nbsp;subkeyed&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295694">//&nbsp;their&nbsp;name/domain/path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295722">entries</span>&nbsp;<span class="keyword" id="3295730">map</span><span class="op" id="3295733">[</span><span class="builtintype" id="3295734">string</span><span class="op" id="3295740">]</span><span class="keyword" id="3295741">map</span><span class="op" id="3295744">[</span><span class="builtintype" id="3295745">string</span><span class="op" id="3295751">]</span><span class="ident" id="3295752"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295760">//&nbsp;nextSeqNum&nbsp;is&nbsp;the&nbsp;next&nbsp;sequence&nbsp;number&nbsp;assigned&nbsp;to&nbsp;a&nbsp;new&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295828">//&nbsp;created&nbsp;SetCookies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295852">nextSeqNum</span>&nbsp;<span class="ident" id="3295863">uint64</span><br>
<span class="lineno"></span><span class="op" id="3295870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="3295873">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;cookie&nbsp;jar.&nbsp;A&nbsp;nil&nbsp;*Options&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;a&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment" id="3295945">//&nbsp;Options.</span><br>
<span class="lineno"></span><span class="keyword" id="3295957">func</span>&nbsp;<span class="ident" id="3295962">New</span><span class="op" id="3295965">(</span><span class="ident" id="3295966">o</span>&nbsp;<span class="op" id="3295968">*</span><span class="ident" id="3295969"><a href="/net/http/cookiejar/jar.go.html#3295112">Options</a></span><span class="op" id="3295976">)</span>&nbsp;<span class="op" id="3295978">(</span><span class="op" id="3295979">*</span><span class="ident" id="3295980"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3295983">,</span>&nbsp;<span class="builtintype" id="3295985">error</span><span class="op" id="3295990">)</span>&nbsp;<span class="op" id="3295992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295995">jar</span>&nbsp;<span class="op" id="3295999">:=</span>&nbsp;<span class="op" id="3296002">&amp;</span><span class="ident" id="3296003"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3296006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296010">entries</span><span class="op" id="3296017">:</span>&nbsp;<span class="builtinfunc" id="3296019">make</span><span class="op" id="3296023">(</span><span class="keyword" id="3296024">map</span><span class="op" id="3296027">[</span><span class="builtintype" id="3296028">string</span><span class="op" id="3296034">]</span><span class="keyword" id="3296035">map</span><span class="op" id="3296038">[</span><span class="builtintype" id="3296039">string</span><span class="op" id="3296045">]</span><span class="ident" id="3296046"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3296051">)</span><span class="op" id="3296052">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296058">if</span>&nbsp;<span class="ident" id="3296061"><a href="/net/http/cookiejar/jar.go.html#3295966">o</a></span>&nbsp;<span class="op" id="3296063">!=</span>&nbsp;<span class="ident" id="3296066">nil</span>&nbsp;<span class="op" id="3296070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296074"><a href="/net/http/cookiejar/jar.go.html#3295995">jar</a></span><span class="op" id="3296077">.</span><span class="ident" id="3296078">psList</span>&nbsp;<span class="op" id="3296085">=</span>&nbsp;<span class="ident" id="3296087"><a href="/net/http/cookiejar/jar.go.html#3295966">o</a></span><span class="op" id="3296088">.</span><span class="ident" id="3296089">PublicSuffixList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296110">return</span>&nbsp;<span class="ident" id="3296117"><a href="/net/http/cookiejar/jar.go.html#3295995">jar</a></span><span class="op" id="3296120">,</span>&nbsp;<span class="ident" id="3296122">nil</span><br>
<span class="lineno">85</span><span class="op" id="3296126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3296129">//&nbsp;entry&nbsp;is&nbsp;the&nbsp;internal&nbsp;representation&nbsp;of&nbsp;a&nbsp;cookie.</span><br>
<span class="lineno"></span><span class="comment" id="3296182">//</span><br>
<span class="lineno"></span><span class="comment" id="3296185">//&nbsp;This&nbsp;struct&nbsp;type&nbsp;is&nbsp;not&nbsp;used&nbsp;outside&nbsp;of&nbsp;this&nbsp;package&nbsp;per&nbsp;se,&nbsp;but&nbsp;the&nbsp;exported</span><br>
<span class="lineno">90</span><span class="comment" id="3296266">//&nbsp;fields&nbsp;are&nbsp;those&nbsp;of&nbsp;RFC&nbsp;6265.</span><br>
<span class="lineno"></span><span class="keyword" id="3296299">type</span>&nbsp;<span class="ident" id="3296304">entry</span>&nbsp;<span class="keyword" id="3296310">struct</span>&nbsp;<span class="op" id="3296317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296320">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296331">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296339">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296350">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296358">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296369">string</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296377">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296388">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296396">Secure</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296407">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296413">HttpOnly</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296424">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296430">Persistent</span>&nbsp;<span class="builtintype" id="3296441">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296447">HostOnly</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3296458">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296464">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3296475"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3296479">.</span><span class="ident" id="3296480">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296486">Creation</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3296497"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3296501">.</span><span class="ident" id="3296502">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296508">LastAccess</span>&nbsp;<span class="ident" id="3296519"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3296523">.</span><span class="ident" id="3296524">Time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296531">//&nbsp;seqNum&nbsp;is&nbsp;a&nbsp;sequence&nbsp;number&nbsp;so&nbsp;that&nbsp;Cookies&nbsp;returns&nbsp;cookies&nbsp;in&nbsp;a</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296600">//&nbsp;deterministic&nbsp;order,&nbsp;even&nbsp;for&nbsp;cookies&nbsp;that&nbsp;have&nbsp;equal&nbsp;Path&nbsp;length&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296674">//&nbsp;equal&nbsp;Creation&nbsp;time.&nbsp;This&nbsp;simplifies&nbsp;testing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296724">seqNum</span>&nbsp;<span class="ident" id="3296731">uint64</span><br>
<span class="lineno"></span><span class="op" id="3296738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3296741">//&nbsp;Id&nbsp;returns&nbsp;the&nbsp;domain;path;name&nbsp;triple&nbsp;of&nbsp;e&nbsp;as&nbsp;an&nbsp;id.</span><br>
<span class="lineno"></span><span class="keyword" id="3296798">func</span>&nbsp;<span class="op" id="3296803">(</span><span class="ident" id="3296804">e</span>&nbsp;<span class="op" id="3296806">*</span><span class="ident" id="3296807"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3296812">)</span>&nbsp;<span class="ident" id="3296814">id</span><span class="op" id="3296816">(</span><span class="op" id="3296817">)</span>&nbsp;<span class="builtintype" id="3296819">string</span>&nbsp;<span class="op" id="3296826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296829">return</span>&nbsp;<span class="ident" id="3296836"><a href="/net/http/cookiejar/jar.go.html#3293849">fmt</a></span><span class="op" id="3296839">.</span><span class="ident" id="3296840">Sprintf</span><span class="op" id="3296847">(</span><span class="string" id="3296848">&#34;%s;%s;%s&#34;</span><span class="op" id="3296858">,</span>&nbsp;<span class="ident" id="3296860"><a href="/net/http/cookiejar/jar.go.html#3296804">e</a></span><span class="op" id="3296861">.</span><span class="ident" id="3296862">Domain</span><span class="op" id="3296868">,</span>&nbsp;<span class="ident" id="3296870"><a href="/net/http/cookiejar/jar.go.html#3296804">e</a></span><span class="op" id="3296871">.</span><span class="ident" id="3296872">Path</span><span class="op" id="3296876">,</span>&nbsp;<span class="ident" id="3296878"><a href="/net/http/cookiejar/jar.go.html#3296804">e</a></span><span class="op" id="3296879">.</span><span class="ident" id="3296880">Name</span><span class="op" id="3296884">)</span><br>
<span class="lineno"></span><span class="op" id="3296886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="3296889">//&nbsp;shouldSend&nbsp;determines&nbsp;whether&nbsp;e&#39;s&nbsp;cookie&nbsp;qualifies&nbsp;to&nbsp;be&nbsp;included&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3296963">//&nbsp;request&nbsp;to&nbsp;host/path.&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;check&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3297038">//&nbsp;cookie&nbsp;is&nbsp;expired.</span><br>
<span class="lineno"></span><span class="keyword" id="3297060">func</span>&nbsp;<span class="op" id="3297065">(</span><span class="ident" id="3297066">e</span>&nbsp;<span class="op" id="3297068">*</span><span class="ident" id="3297069"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3297074">)</span>&nbsp;<span class="ident" id="3297076">shouldSend</span><span class="op" id="3297086">(</span><span class="ident" id="3297087">https</span>&nbsp;<span class="builtintype" id="3297093">bool</span><span class="op" id="3297097">,</span>&nbsp;<span class="ident" id="3297099">host</span><span class="op" id="3297103">,</span>&nbsp;<span class="ident" id="3297105">path</span>&nbsp;<span class="builtintype" id="3297110">string</span><span class="op" id="3297116">)</span>&nbsp;<span class="builtintype" id="3297118">bool</span>&nbsp;<span class="op" id="3297123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297126">return</span>&nbsp;<span class="ident" id="3297133"><a href="/net/http/cookiejar/jar.go.html#3297066">e</a></span><span class="op" id="3297134">.</span><span class="ident" id="3297135">domainMatch</span><span class="op" id="3297146">(</span><span class="ident" id="3297147"><a href="/net/http/cookiejar/jar.go.html#3297099">host</a></span><span class="op" id="3297151">)</span>&nbsp;<span class="op" id="3297153">&amp;&amp;</span>&nbsp;<span class="ident" id="3297156"><a href="/net/http/cookiejar/jar.go.html#3297066">e</a></span><span class="op" id="3297157">.</span><span class="ident" id="3297158">pathMatch</span><span class="op" id="3297167">(</span><span class="ident" id="3297168"><a href="/net/http/cookiejar/jar.go.html#3297105">path</a></span><span class="op" id="3297172">)</span>&nbsp;<span class="op" id="3297174">&amp;&amp;</span>&nbsp;<span class="op" id="3297177">(</span><span class="ident" id="3297178"><a href="/net/http/cookiejar/jar.go.html#3297087">https</a></span>&nbsp;<span class="op" id="3297184">||</span>&nbsp;<span class="op" id="3297187">!</span><span class="ident" id="3297188"><a href="/net/http/cookiejar/jar.go.html#3297066">e</a></span><span class="op" id="3297189">.</span><span class="ident" id="3297190">Secure</span><span class="op" id="3297196">)</span><br>
<span class="lineno">120</span><span class="op" id="3297198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3297201">//&nbsp;domainMatch&nbsp;implements&nbsp;&#34;domain-match&#34;&nbsp;of&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.1.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3297269">func</span>&nbsp;<span class="op" id="3297274">(</span><span class="ident" id="3297275">e</span>&nbsp;<span class="op" id="3297277">*</span><span class="ident" id="3297278"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3297283">)</span>&nbsp;<span class="ident" id="3297285">domainMatch</span><span class="op" id="3297296">(</span><span class="ident" id="3297297">host</span>&nbsp;<span class="builtintype" id="3297302">string</span><span class="op" id="3297308">)</span>&nbsp;<span class="builtintype" id="3297310">bool</span>&nbsp;<span class="op" id="3297315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297318">if</span>&nbsp;<span class="ident" id="3297321"><a href="/net/http/cookiejar/jar.go.html#3297275">e</a></span><span class="op" id="3297322">.</span><span class="ident" id="3297323">Domain</span>&nbsp;<span class="op" id="3297330">==</span>&nbsp;<span class="ident" id="3297333"><a href="/net/http/cookiejar/jar.go.html#3297297">host</a></span>&nbsp;<span class="op" id="3297338">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297342">return</span>&nbsp;<span class="builtintype" id="3297349">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297358">return</span>&nbsp;<span class="op" id="3297365">!</span><span class="ident" id="3297366"><a href="/net/http/cookiejar/jar.go.html#3297275">e</a></span><span class="op" id="3297367">.</span><span class="ident" id="3297368">HostOnly</span>&nbsp;<span class="op" id="3297377">&amp;&amp;</span>&nbsp;<span class="ident" id="3297380"><a href="/net/http/cookiejar/jar.go.html#3297905">hasDotSuffix</a></span><span class="op" id="3297392">(</span><span class="ident" id="3297393"><a href="/net/http/cookiejar/jar.go.html#3297297">host</a></span><span class="op" id="3297397">,</span>&nbsp;<span class="ident" id="3297399"><a href="/net/http/cookiejar/jar.go.html#3297275">e</a></span><span class="op" id="3297400">.</span><span class="ident" id="3297401">Domain</span><span class="op" id="3297407">)</span><br>
<span class="lineno"></span><span class="op" id="3297409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="3297412">//&nbsp;pathMatch&nbsp;implements&nbsp;&#34;path-match&#34;&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.1.4.</span><br>
<span class="lineno"></span><span class="keyword" id="3297486">func</span>&nbsp;<span class="op" id="3297491">(</span><span class="ident" id="3297492">e</span>&nbsp;<span class="op" id="3297494">*</span><span class="ident" id="3297495"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3297500">)</span>&nbsp;<span class="ident" id="3297502">pathMatch</span><span class="op" id="3297511">(</span><span class="ident" id="3297512">requestPath</span>&nbsp;<span class="builtintype" id="3297524">string</span><span class="op" id="3297530">)</span>&nbsp;<span class="builtintype" id="3297532">bool</span>&nbsp;<span class="op" id="3297537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297540">if</span>&nbsp;<span class="ident" id="3297543"><a href="/net/http/cookiejar/jar.go.html#3297512">requestPath</a></span>&nbsp;<span class="op" id="3297555">==</span>&nbsp;<span class="ident" id="3297558"><a href="/net/http/cookiejar/jar.go.html#3297492">e</a></span><span class="op" id="3297559">.</span><span class="ident" id="3297560">Path</span>&nbsp;<span class="op" id="3297565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297569">return</span>&nbsp;<span class="builtintype" id="3297576">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297582">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297585">if</span>&nbsp;<span class="ident" id="3297588"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3297595">.</span><span class="ident" id="3297596">HasPrefix</span><span class="op" id="3297605">(</span><span class="ident" id="3297606"><a href="/net/http/cookiejar/jar.go.html#3297512">requestPath</a></span><span class="op" id="3297617">,</span>&nbsp;<span class="ident" id="3297619"><a href="/net/http/cookiejar/jar.go.html#3297492">e</a></span><span class="op" id="3297620">.</span><span class="ident" id="3297621">Path</span><span class="op" id="3297625">)</span>&nbsp;<span class="op" id="3297627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297631">if</span>&nbsp;<span class="ident" id="3297634"><a href="/net/http/cookiejar/jar.go.html#3297492">e</a></span><span class="op" id="3297635">.</span><span class="ident" id="3297636">Path</span><span class="op" id="3297640">[</span><span class="builtinfunc" id="3297641">len</span><span class="op" id="3297644">(</span><span class="ident" id="3297645"><a href="/net/http/cookiejar/jar.go.html#3297492">e</a></span><span class="op" id="3297646">.</span><span class="ident" id="3297647">Path</span><span class="op" id="3297651">)</span><span class="op" id="3297652">-</span><span class="num" id="3297653">1</span><span class="op" id="3297654">]</span>&nbsp;<span class="op" id="3297656">==</span>&nbsp;<span class="string" id="3297659">&#39;/&#39;</span>&nbsp;<span class="op" id="3297663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297668">return</span>&nbsp;<span class="builtintype" id="3297675">true</span>&nbsp;<span class="comment" id="3297680">//&nbsp;The&nbsp;&#34;/any/&#34;&nbsp;matches&nbsp;&#34;/any/path&#34;&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297723">}</span>&nbsp;<span class="keyword" id="3297725">else</span>&nbsp;<span class="keyword" id="3297730">if</span>&nbsp;<span class="ident" id="3297733"><a href="/net/http/cookiejar/jar.go.html#3297512">requestPath</a></span><span class="op" id="3297744">[</span><span class="builtinfunc" id="3297745">len</span><span class="op" id="3297748">(</span><span class="ident" id="3297749"><a href="/net/http/cookiejar/jar.go.html#3297492">e</a></span><span class="op" id="3297750">.</span><span class="ident" id="3297751">Path</span><span class="op" id="3297755">)</span><span class="op" id="3297756">]</span>&nbsp;<span class="op" id="3297758">==</span>&nbsp;<span class="string" id="3297761">&#39;/&#39;</span>&nbsp;<span class="op" id="3297765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297770">return</span>&nbsp;<span class="builtintype" id="3297777">true</span>&nbsp;<span class="comment" id="3297782">//&nbsp;The&nbsp;&#34;/any&#34;&nbsp;matches&nbsp;&#34;/any/path&#34;&nbsp;case.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297830">return</span>&nbsp;<span class="builtintype" id="3297837">false</span><br>
<span class="lineno"></span><span class="op" id="3297843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="3297846">//&nbsp;hasDotSuffix&nbsp;reports&nbsp;whether&nbsp;s&nbsp;ends&nbsp;in&nbsp;&#34;.&#34;+suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="3297900">func</span>&nbsp;<span class="ident" id="3297905">hasDotSuffix</span><span class="op" id="3297917">(</span><span class="ident" id="3297918">s</span><span class="op" id="3297919">,</span>&nbsp;<span class="ident" id="3297921">suffix</span>&nbsp;<span class="builtintype" id="3297928">string</span><span class="op" id="3297934">)</span>&nbsp;<span class="builtintype" id="3297936">bool</span>&nbsp;<span class="op" id="3297941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297944">return</span>&nbsp;<span class="builtinfunc" id="3297951">len</span><span class="op" id="3297954">(</span><span class="ident" id="3297955"><a href="/net/http/cookiejar/jar.go.html#3297918">s</a></span><span class="op" id="3297956">)</span>&nbsp;<span class="op" id="3297958">&gt;</span>&nbsp;<span class="builtinfunc" id="3297960">len</span><span class="op" id="3297963">(</span><span class="ident" id="3297964"><a href="/net/http/cookiejar/jar.go.html#3297921">suffix</a></span><span class="op" id="3297970">)</span>&nbsp;<span class="op" id="3297972">&amp;&amp;</span>&nbsp;<span class="ident" id="3297975"><a href="/net/http/cookiejar/jar.go.html#3297918">s</a></span><span class="op" id="3297976">[</span><span class="builtinfunc" id="3297977">len</span><span class="op" id="3297980">(</span><span class="ident" id="3297981"><a href="/net/http/cookiejar/jar.go.html#3297918">s</a></span><span class="op" id="3297982">)</span><span class="op" id="3297983">-</span><span class="builtinfunc" id="3297984">len</span><span class="op" id="3297987">(</span><span class="ident" id="3297988"><a href="/net/http/cookiejar/jar.go.html#3297921">suffix</a></span><span class="op" id="3297994">)</span><span class="op" id="3297995">-</span><span class="num" id="3297996">1</span><span class="op" id="3297997">]</span>&nbsp;<span class="op" id="3297999">==</span>&nbsp;<span class="string" id="3298002">&#39;.&#39;</span>&nbsp;<span class="op" id="3298006">&amp;&amp;</span>&nbsp;<span class="ident" id="3298009"><a href="/net/http/cookiejar/jar.go.html#3297918">s</a></span><span class="op" id="3298010">[</span><span class="builtinfunc" id="3298011">len</span><span class="op" id="3298014">(</span><span class="ident" id="3298015"><a href="/net/http/cookiejar/jar.go.html#3297918">s</a></span><span class="op" id="3298016">)</span><span class="op" id="3298017">-</span><span class="builtinfunc" id="3298018">len</span><span class="op" id="3298021">(</span><span class="ident" id="3298022"><a href="/net/http/cookiejar/jar.go.html#3297921">suffix</a></span><span class="op" id="3298028">)</span><span class="op" id="3298029">:</span><span class="op" id="3298030">]</span>&nbsp;<span class="op" id="3298032">==</span>&nbsp;<span class="ident" id="3298035"><a href="/net/http/cookiejar/jar.go.html#3297921">suffix</a></span><br>
<span class="lineno"></span><span class="op" id="3298042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3298045">//&nbsp;byPathLength&nbsp;is&nbsp;a&nbsp;[]entry&nbsp;sort.Interface&nbsp;that&nbsp;sorts&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265</span><br>
<span class="lineno"></span><span class="comment" id="3298122">//&nbsp;section&nbsp;5.4&nbsp;point&nbsp;2:&nbsp;by&nbsp;longest&nbsp;path&nbsp;and&nbsp;then&nbsp;by&nbsp;earliest&nbsp;creation&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="3298198">type</span>&nbsp;<span class="ident" id="3298203">byPathLength</span>&nbsp;<span class="op" id="3298216">[</span><span class="op" id="3298217">]</span><span class="ident" id="3298218"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3298225">func</span>&nbsp;<span class="op" id="3298230">(</span><span class="ident" id="3298231">s</span>&nbsp;<span class="ident" id="3298233"><a href="/net/http/cookiejar/jar.go.html#3298203">byPathLength</a></span><span class="op" id="3298245">)</span>&nbsp;<span class="ident" id="3298247">Len</span><span class="op" id="3298250">(</span><span class="op" id="3298251">)</span>&nbsp;<span class="builtintype" id="3298253">int</span>&nbsp;<span class="op" id="3298257">{</span>&nbsp;<span class="keyword" id="3298259">return</span>&nbsp;<span class="builtinfunc" id="3298266">len</span><span class="op" id="3298269">(</span><span class="ident" id="3298270"><a href="/net/http/cookiejar/jar.go.html#3298231">s</a></span><span class="op" id="3298271">)</span>&nbsp;<span class="op" id="3298273">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="3298276">func</span>&nbsp;<span class="op" id="3298281">(</span><span class="ident" id="3298282">s</span>&nbsp;<span class="ident" id="3298284"><a href="/net/http/cookiejar/jar.go.html#3298203">byPathLength</a></span><span class="op" id="3298296">)</span>&nbsp;<span class="ident" id="3298298">Less</span><span class="op" id="3298302">(</span><span class="ident" id="3298303">i</span><span class="op" id="3298304">,</span>&nbsp;<span class="ident" id="3298306">j</span>&nbsp;<span class="builtintype" id="3298308">int</span><span class="op" id="3298311">)</span>&nbsp;<span class="builtintype" id="3298313">bool</span>&nbsp;<span class="op" id="3298318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298321">if</span>&nbsp;<span class="builtinfunc" id="3298324">len</span><span class="op" id="3298327">(</span><span class="ident" id="3298328"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298329">[</span><span class="ident" id="3298330"><a href="/net/http/cookiejar/jar.go.html#3298303">i</a></span><span class="op" id="3298331">]</span><span class="op" id="3298332">.</span><span class="ident" id="3298333">Path</span><span class="op" id="3298337">)</span>&nbsp;<span class="op" id="3298339">!=</span>&nbsp;<span class="builtinfunc" id="3298342">len</span><span class="op" id="3298345">(</span><span class="ident" id="3298346"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298347">[</span><span class="ident" id="3298348"><a href="/net/http/cookiejar/jar.go.html#3298306">j</a></span><span class="op" id="3298349">]</span><span class="op" id="3298350">.</span><span class="ident" id="3298351">Path</span><span class="op" id="3298355">)</span>&nbsp;<span class="op" id="3298357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298361">return</span>&nbsp;<span class="builtinfunc" id="3298368">len</span><span class="op" id="3298371">(</span><span class="ident" id="3298372"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298373">[</span><span class="ident" id="3298374"><a href="/net/http/cookiejar/jar.go.html#3298303">i</a></span><span class="op" id="3298375">]</span><span class="op" id="3298376">.</span><span class="ident" id="3298377">Path</span><span class="op" id="3298381">)</span>&nbsp;<span class="op" id="3298383">&gt;</span>&nbsp;<span class="builtinfunc" id="3298385">len</span><span class="op" id="3298388">(</span><span class="ident" id="3298389"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298390">[</span><span class="ident" id="3298391"><a href="/net/http/cookiejar/jar.go.html#3298306">j</a></span><span class="op" id="3298392">]</span><span class="op" id="3298393">.</span><span class="ident" id="3298394">Path</span><span class="op" id="3298398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298401">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298404">if</span>&nbsp;<span class="op" id="3298407">!</span><span class="ident" id="3298408"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298409">[</span><span class="ident" id="3298410"><a href="/net/http/cookiejar/jar.go.html#3298303">i</a></span><span class="op" id="3298411">]</span><span class="op" id="3298412">.</span><span class="ident" id="3298413">Creation</span><span class="op" id="3298421">.</span><span class="ident" id="3298422">Equal</span><span class="op" id="3298427">(</span><span class="ident" id="3298428"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298429">[</span><span class="ident" id="3298430"><a href="/net/http/cookiejar/jar.go.html#3298306">j</a></span><span class="op" id="3298431">]</span><span class="op" id="3298432">.</span><span class="ident" id="3298433">Creation</span><span class="op" id="3298441">)</span>&nbsp;<span class="op" id="3298443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298447">return</span>&nbsp;<span class="ident" id="3298454"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298455">[</span><span class="ident" id="3298456"><a href="/net/http/cookiejar/jar.go.html#3298303">i</a></span><span class="op" id="3298457">]</span><span class="op" id="3298458">.</span><span class="ident" id="3298459">Creation</span><span class="op" id="3298467">.</span><span class="ident" id="3298468">Before</span><span class="op" id="3298474">(</span><span class="ident" id="3298475"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298476">[</span><span class="ident" id="3298477"><a href="/net/http/cookiejar/jar.go.html#3298306">j</a></span><span class="op" id="3298478">]</span><span class="op" id="3298479">.</span><span class="ident" id="3298480">Creation</span><span class="op" id="3298488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298494">return</span>&nbsp;<span class="ident" id="3298501"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298502">[</span><span class="ident" id="3298503"><a href="/net/http/cookiejar/jar.go.html#3298303">i</a></span><span class="op" id="3298504">]</span><span class="op" id="3298505">.</span><span class="ident" id="3298506">seqNum</span>&nbsp;<span class="op" id="3298513">&lt;</span>&nbsp;<span class="ident" id="3298515"><a href="/net/http/cookiejar/jar.go.html#3298282">s</a></span><span class="op" id="3298516">[</span><span class="ident" id="3298517"><a href="/net/http/cookiejar/jar.go.html#3298306">j</a></span><span class="op" id="3298518">]</span><span class="op" id="3298519">.</span><span class="ident" id="3298520">seqNum</span><br>
<span class="lineno"></span><span class="op" id="3298527">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3298530">func</span>&nbsp;<span class="op" id="3298535">(</span><span class="ident" id="3298536">s</span>&nbsp;<span class="ident" id="3298538"><a href="/net/http/cookiejar/jar.go.html#3298203">byPathLength</a></span><span class="op" id="3298550">)</span>&nbsp;<span class="ident" id="3298552">Swap</span><span class="op" id="3298556">(</span><span class="ident" id="3298557">i</span><span class="op" id="3298558">,</span>&nbsp;<span class="ident" id="3298560">j</span>&nbsp;<span class="builtintype" id="3298562">int</span><span class="op" id="3298565">)</span>&nbsp;<span class="op" id="3298567">{</span>&nbsp;<span class="ident" id="3298569"><a href="/net/http/cookiejar/jar.go.html#3298536">s</a></span><span class="op" id="3298570">[</span><span class="ident" id="3298571"><a href="/net/http/cookiejar/jar.go.html#3298557">i</a></span><span class="op" id="3298572">]</span><span class="op" id="3298573">,</span>&nbsp;<span class="ident" id="3298575"><a href="/net/http/cookiejar/jar.go.html#3298536">s</a></span><span class="op" id="3298576">[</span><span class="ident" id="3298577"><a href="/net/http/cookiejar/jar.go.html#3298560">j</a></span><span class="op" id="3298578">]</span>&nbsp;<span class="op" id="3298580">=</span>&nbsp;<span class="ident" id="3298582"><a href="/net/http/cookiejar/jar.go.html#3298536">s</a></span><span class="op" id="3298583">[</span><span class="ident" id="3298584"><a href="/net/http/cookiejar/jar.go.html#3298560">j</a></span><span class="op" id="3298585">]</span><span class="op" id="3298586">,</span>&nbsp;<span class="ident" id="3298588"><a href="/net/http/cookiejar/jar.go.html#3298536">s</a></span><span class="op" id="3298589">[</span><span class="ident" id="3298590"><a href="/net/http/cookiejar/jar.go.html#3298557">i</a></span><span class="op" id="3298591">]</span>&nbsp;<span class="op" id="3298593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3298596">//&nbsp;Cookies&nbsp;implements&nbsp;the&nbsp;Cookies&nbsp;method&nbsp;of&nbsp;the&nbsp;http.CookieJar&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3298670">//</span><br>
<span class="lineno">170</span><span class="comment" id="3298673">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;if&nbsp;the&nbsp;URL&#39;s&nbsp;scheme&nbsp;is&nbsp;not&nbsp;HTTP&nbsp;or&nbsp;HTTPS.</span><br>
<span class="lineno"></span><span class="keyword" id="3298744">func</span>&nbsp;<span class="op" id="3298749">(</span><span class="ident" id="3298750">j</span>&nbsp;<span class="op" id="3298752">*</span><span class="ident" id="3298753"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3298756">)</span>&nbsp;<span class="ident" id="3298758">Cookies</span><span class="op" id="3298765">(</span><span class="ident" id="3298766">u</span>&nbsp;<span class="op" id="3298768">*</span><span class="ident" id="3298769"><a href="/net/http/cookiejar/jar.go.html#3293875">url</a></span><span class="op" id="3298772">.</span><span class="ident" id="3298773">URL</span><span class="op" id="3298776">)</span>&nbsp;<span class="op" id="3298778">(</span><span class="ident" id="3298779">cookies</span>&nbsp;<span class="op" id="3298787">[</span><span class="op" id="3298788">]</span><span class="op" id="3298789">*</span><span class="ident" id="3298790"><a href="/net/http/cookiejar/jar.go.html#3293863">http</a></span><span class="op" id="3298794">.</span><span class="ident" id="3298795">Cookie</span><span class="op" id="3298801">)</span>&nbsp;<span class="op" id="3298803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298806">return</span>&nbsp;<span class="ident" id="3298813"><a href="/net/http/cookiejar/jar.go.html#3298750">j</a></span><span class="op" id="3298814">.</span><span class="ident" id="3298815">cookies</span><span class="op" id="3298822">(</span><span class="ident" id="3298823"><a href="/net/http/cookiejar/jar.go.html#3298766">u</a></span><span class="op" id="3298824">,</span>&nbsp;<span class="ident" id="3298826"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3298830">.</span><span class="ident" id="3298831">Now</span><span class="op" id="3298834">(</span><span class="op" id="3298835">)</span><span class="op" id="3298836">)</span><br>
<span class="lineno"></span><span class="op" id="3298838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3298841">//&nbsp;cookies&nbsp;is&nbsp;like&nbsp;Cookies&nbsp;but&nbsp;takes&nbsp;the&nbsp;current&nbsp;time&nbsp;as&nbsp;a&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="keyword" id="3298911">func</span>&nbsp;<span class="op" id="3298916">(</span><span class="ident" id="3298917">j</span>&nbsp;<span class="op" id="3298919">*</span><span class="ident" id="3298920"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3298923">)</span>&nbsp;<span class="ident" id="3298925">cookies</span><span class="op" id="3298932">(</span><span class="ident" id="3298933">u</span>&nbsp;<span class="op" id="3298935">*</span><span class="ident" id="3298936"><a href="/net/http/cookiejar/jar.go.html#3293875">url</a></span><span class="op" id="3298939">.</span><span class="ident" id="3298940">URL</span><span class="op" id="3298943">,</span>&nbsp;<span class="ident" id="3298945">now</span>&nbsp;<span class="ident" id="3298949"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3298953">.</span><span class="ident" id="3298954">Time</span><span class="op" id="3298958">)</span>&nbsp;<span class="op" id="3298960">(</span><span class="ident" id="3298961">cookies</span>&nbsp;<span class="op" id="3298969">[</span><span class="op" id="3298970">]</span><span class="op" id="3298971">*</span><span class="ident" id="3298972"><a href="/net/http/cookiejar/jar.go.html#3293863">http</a></span><span class="op" id="3298976">.</span><span class="ident" id="3298977">Cookie</span><span class="op" id="3298983">)</span>&nbsp;<span class="op" id="3298985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298988">if</span>&nbsp;<span class="ident" id="3298991"><a href="/net/http/cookiejar/jar.go.html#3298933">u</a></span><span class="op" id="3298992">.</span><span class="ident" id="3298993">Scheme</span>&nbsp;<span class="op" id="3299000">!=</span>&nbsp;<span class="string" id="3299003">&#34;http&#34;</span>&nbsp;<span class="op" id="3299010">&amp;&amp;</span>&nbsp;<span class="ident" id="3299013"><a href="/net/http/cookiejar/jar.go.html#3298933">u</a></span><span class="op" id="3299014">.</span><span class="ident" id="3299015">Scheme</span>&nbsp;<span class="op" id="3299022">!=</span>&nbsp;<span class="string" id="3299025">&#34;https&#34;</span>&nbsp;<span class="op" id="3299033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299037">return</span>&nbsp;<span class="ident" id="3299044"><a href="/net/http/cookiejar/jar.go.html#3298961">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299053">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299056">host</span><span class="op" id="3299060">,</span>&nbsp;<span class="ident" id="3299062">err</span>&nbsp;<span class="op" id="3299066">:=</span>&nbsp;<span class="ident" id="3299069"><a href="/net/http/cookiejar/jar.go.html#3301422">canonicalHost</a></span><span class="op" id="3299082">(</span><span class="ident" id="3299083"><a href="/net/http/cookiejar/jar.go.html#3298933">u</a></span><span class="op" id="3299084">.</span><span class="ident" id="3299085">Host</span><span class="op" id="3299089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299092">if</span>&nbsp;<span class="ident" id="3299095"><a href="/net/http/cookiejar/jar.go.html#3299062">err</a></span>&nbsp;<span class="op" id="3299099">!=</span>&nbsp;<span class="ident" id="3299102">nil</span>&nbsp;<span class="op" id="3299106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299110">return</span>&nbsp;<span class="ident" id="3299117"><a href="/net/http/cookiejar/jar.go.html#3298961">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299129">key</span>&nbsp;<span class="op" id="3299133">:=</span>&nbsp;<span class="ident" id="3299136"><a href="/net/http/cookiejar/jar.go.html#3302125">jarKey</a></span><span class="op" id="3299142">(</span><span class="ident" id="3299143"><a href="/net/http/cookiejar/jar.go.html#3299056">host</a></span><span class="op" id="3299147">,</span>&nbsp;<span class="ident" id="3299149"><a href="/net/http/cookiejar/jar.go.html#3298917">j</a></span><span class="op" id="3299150">.</span><span class="ident" id="3299151">psList</span><span class="op" id="3299157">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299161"><a href="/net/http/cookiejar/jar.go.html#3298917">j</a></span><span class="op" id="3299162">.</span><span class="ident" id="3299163">mu</span><span class="op" id="3299165">.</span><span class="ident" id="3299166">Lock</span><span class="op" id="3299170">(</span><span class="op" id="3299171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299174">defer</span>&nbsp;<span class="ident" id="3299180"><a href="/net/http/cookiejar/jar.go.html#3298917">j</a></span><span class="op" id="3299181">.</span><span class="ident" id="3299182">mu</span><span class="op" id="3299184">.</span><span class="ident" id="3299185">Unlock</span><span class="op" id="3299191">(</span><span class="op" id="3299192">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299196">submap</span>&nbsp;<span class="op" id="3299203">:=</span>&nbsp;<span class="ident" id="3299206"><a href="/net/http/cookiejar/jar.go.html#3298917">j</a></span><span class="op" id="3299207">.</span><span class="ident" id="3299208">entries</span><span class="op" id="3299215">[</span><span class="ident" id="3299216"><a href="/net/http/cookiejar/jar.go.html#3299129">key</a></span><span class="op" id="3299219">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299222">if</span>&nbsp;<span class="ident" id="3299225"><a href="/net/http/cookiejar/jar.go.html#3299196">submap</a></span>&nbsp;<span class="op" id="3299232">==</span>&nbsp;<span class="ident" id="3299235">nil</span>&nbsp;<span class="op" id="3299239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299243">return</span>&nbsp;<span class="ident" id="3299250"><a href="/net/http/cookiejar/jar.go.html#3298961">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299263">https</span>&nbsp;<span class="op" id="3299269">:=</span>&nbsp;<span class="ident" id="3299272"><a href="/net/http/cookiejar/jar.go.html#3298933">u</a></span><span class="op" id="3299273">.</span><span class="ident" id="3299274">Scheme</span>&nbsp;<span class="op" id="3299281">==</span>&nbsp;<span class="string" id="3299284">&#34;https&#34;</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299293">path</span>&nbsp;<span class="op" id="3299298">:=</span>&nbsp;<span class="ident" id="3299301"><a href="/net/http/cookiejar/jar.go.html#3298933">u</a></span><span class="op" id="3299302">.</span><span class="ident" id="3299303">Path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299309">if</span>&nbsp;<span class="ident" id="3299312"><a href="/net/http/cookiejar/jar.go.html#3299293">path</a></span>&nbsp;<span class="op" id="3299317">==</span>&nbsp;<span class="string" id="3299320">&#34;&#34;</span>&nbsp;<span class="op" id="3299323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299327"><a href="/net/http/cookiejar/jar.go.html#3299293">path</a></span>&nbsp;<span class="op" id="3299332">=</span>&nbsp;<span class="string" id="3299334">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299343">modified</span>&nbsp;<span class="op" id="3299352">:=</span>&nbsp;<span class="builtintype" id="3299355">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299362">var</span>&nbsp;<span class="ident" id="3299366">selected</span>&nbsp;<span class="op" id="3299375">[</span><span class="op" id="3299376">]</span><span class="ident" id="3299377"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299384">for</span>&nbsp;<span class="ident" id="3299388">id</span><span class="op" id="3299390">,</span>&nbsp;<span class="ident" id="3299392">e</span>&nbsp;<span class="op" id="3299394">:=</span>&nbsp;<span class="keyword" id="3299397">range</span>&nbsp;<span class="ident" id="3299403"><a href="/net/http/cookiejar/jar.go.html#3299196">submap</a></span>&nbsp;<span class="op" id="3299410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299414">if</span>&nbsp;<span class="ident" id="3299417"><a href="/net/http/cookiejar/jar.go.html#3299392">e</a></span><span class="op" id="3299418">.</span><span class="ident" id="3299419">Persistent</span>&nbsp;<span class="op" id="3299430">&amp;&amp;</span>&nbsp;<span class="op" id="3299433">!</span><span class="ident" id="3299434"><a href="/net/http/cookiejar/jar.go.html#3299392">e</a></span><span class="op" id="3299435">.</span><span class="ident" id="3299436">Expires</span><span class="op" id="3299443">.</span><span class="ident" id="3299444">After</span><span class="op" id="3299449">(</span><span class="ident" id="3299450"><a href="/net/http/cookiejar/jar.go.html#3298945">now</a></span><span class="op" id="3299453">)</span>&nbsp;<span class="op" id="3299455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3299460">delete</span><span class="op" id="3299466">(</span><span class="ident" id="3299467"><a href="/net/http/cookiejar/jar.go.html#3299196">submap</a></span><span class="op" id="3299473">,</span>&nbsp;<span class="ident" id="3299475"><a href="/net/http/cookiejar/jar.go.html#3299388">id</a></span><span class="op" id="3299477">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299482"><a href="/net/http/cookiejar/jar.go.html#3299343">modified</a></span>&nbsp;<span class="op" id="3299491">=</span>&nbsp;<span class="builtintype" id="3299493">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299501">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299516">if</span>&nbsp;<span class="op" id="3299519">!</span><span class="ident" id="3299520"><a href="/net/http/cookiejar/jar.go.html#3299392">e</a></span><span class="op" id="3299521">.</span><span class="ident" id="3299522">shouldSend</span><span class="op" id="3299532">(</span><span class="ident" id="3299533"><a href="/net/http/cookiejar/jar.go.html#3299263">https</a></span><span class="op" id="3299538">,</span>&nbsp;<span class="ident" id="3299540"><a href="/net/http/cookiejar/jar.go.html#3299056">host</a></span><span class="op" id="3299544">,</span>&nbsp;<span class="ident" id="3299546"><a href="/net/http/cookiejar/jar.go.html#3299293">path</a></span><span class="op" id="3299550">)</span>&nbsp;<span class="op" id="3299552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299557">continue</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299572"><a href="/net/http/cookiejar/jar.go.html#3299392">e</a></span><span class="op" id="3299573">.</span><span class="ident" id="3299574">LastAccess</span>&nbsp;<span class="op" id="3299585">=</span>&nbsp;<span class="ident" id="3299587"><a href="/net/http/cookiejar/jar.go.html#3298945">now</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299593"><a href="/net/http/cookiejar/jar.go.html#3299196">submap</a></span><span class="op" id="3299599">[</span><span class="ident" id="3299600"><a href="/net/http/cookiejar/jar.go.html#3299388">id</a></span><span class="op" id="3299602">]</span>&nbsp;<span class="op" id="3299604">=</span>&nbsp;<span class="ident" id="3299606"><a href="/net/http/cookiejar/jar.go.html#3299392">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299610"><a href="/net/http/cookiejar/jar.go.html#3299366">selected</a></span>&nbsp;<span class="op" id="3299619">=</span>&nbsp;<span class="builtinfunc" id="3299621">append</span><span class="op" id="3299627">(</span><span class="ident" id="3299628"><a href="/net/http/cookiejar/jar.go.html#3299366">selected</a></span><span class="op" id="3299636">,</span>&nbsp;<span class="ident" id="3299638"><a href="/net/http/cookiejar/jar.go.html#3299392">e</a></span><span class="op" id="3299639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299643"><a href="/net/http/cookiejar/jar.go.html#3299343">modified</a></span>&nbsp;<span class="op" id="3299652">=</span>&nbsp;<span class="builtintype" id="3299654">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299663">if</span>&nbsp;<span class="ident" id="3299666"><a href="/net/http/cookiejar/jar.go.html#3299343">modified</a></span>&nbsp;<span class="op" id="3299675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299679">if</span>&nbsp;<span class="builtinfunc" id="3299682">len</span><span class="op" id="3299685">(</span><span class="ident" id="3299686"><a href="/net/http/cookiejar/jar.go.html#3299196">submap</a></span><span class="op" id="3299692">)</span>&nbsp;<span class="op" id="3299694">==</span>&nbsp;<span class="num" id="3299697">0</span>&nbsp;<span class="op" id="3299699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3299704">delete</span><span class="op" id="3299710">(</span><span class="ident" id="3299711"><a href="/net/http/cookiejar/jar.go.html#3298917">j</a></span><span class="op" id="3299712">.</span><span class="ident" id="3299713">entries</span><span class="op" id="3299720">,</span>&nbsp;<span class="ident" id="3299722"><a href="/net/http/cookiejar/jar.go.html#3299129">key</a></span><span class="op" id="3299725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299729">}</span>&nbsp;<span class="keyword" id="3299731">else</span>&nbsp;<span class="op" id="3299736">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299741"><a href="/net/http/cookiejar/jar.go.html#3298917">j</a></span><span class="op" id="3299742">.</span><span class="ident" id="3299743">entries</span><span class="op" id="3299750">[</span><span class="ident" id="3299751"><a href="/net/http/cookiejar/jar.go.html#3299129">key</a></span><span class="op" id="3299754">]</span>&nbsp;<span class="op" id="3299756">=</span>&nbsp;<span class="ident" id="3299758"><a href="/net/http/cookiejar/jar.go.html#3299196">submap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299774"><a href="/net/http/cookiejar/jar.go.html#3293886">sort</a></span><span class="op" id="3299778">.</span><span class="ident" id="3299779">Sort</span><span class="op" id="3299783">(</span><span class="ident" id="3299784"><a href="/net/http/cookiejar/jar.go.html#3298203">byPathLength</a></span><span class="op" id="3299796">(</span><span class="ident" id="3299797"><a href="/net/http/cookiejar/jar.go.html#3299366">selected</a></span><span class="op" id="3299805">)</span><span class="op" id="3299806">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299809">for</span>&nbsp;<span class="ident" id="3299813">_</span><span class="op" id="3299814">,</span>&nbsp;<span class="ident" id="3299816">e</span>&nbsp;<span class="op" id="3299818">:=</span>&nbsp;<span class="keyword" id="3299821">range</span>&nbsp;<span class="ident" id="3299827"><a href="/net/http/cookiejar/jar.go.html#3299366">selected</a></span>&nbsp;<span class="op" id="3299836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299840"><a href="/net/http/cookiejar/jar.go.html#3298961">cookies</a></span>&nbsp;<span class="op" id="3299848">=</span>&nbsp;<span class="builtinfunc" id="3299850">append</span><span class="op" id="3299856">(</span><span class="ident" id="3299857"><a href="/net/http/cookiejar/jar.go.html#3298961">cookies</a></span><span class="op" id="3299864">,</span>&nbsp;<span class="op" id="3299866">&amp;</span><span class="ident" id="3299867"><a href="/net/http/cookiejar/jar.go.html#3293863">http</a></span><span class="op" id="3299871">.</span><span class="ident" id="3299872">Cookie</span><span class="op" id="3299878">{</span><span class="ident" id="3299879">Name</span><span class="op" id="3299883">:</span>&nbsp;<span class="ident" id="3299885"><a href="/net/http/cookiejar/jar.go.html#3299816">e</a></span><span class="op" id="3299886">.</span><span class="ident" id="3299887">Name</span><span class="op" id="3299891">,</span>&nbsp;<span class="ident" id="3299893">Value</span><span class="op" id="3299898">:</span>&nbsp;<span class="ident" id="3299900"><a href="/net/http/cookiejar/jar.go.html#3299816">e</a></span><span class="op" id="3299901">.</span><span class="ident" id="3299902">Value</span><span class="op" id="3299907">}</span><span class="op" id="3299908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299915">return</span>&nbsp;<span class="ident" id="3299922"><a href="/net/http/cookiejar/jar.go.html#3298961">cookies</a></span><br>
<span class="lineno">230</span><span class="op" id="3299930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3299933">//&nbsp;SetCookies&nbsp;implements&nbsp;the&nbsp;SetCookies&nbsp;method&nbsp;of&nbsp;the&nbsp;http.CookieJar&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3300013">//</span><br>
<span class="lineno"></span><span class="comment" id="3300016">//&nbsp;It&nbsp;does&nbsp;nothing&nbsp;if&nbsp;the&nbsp;URL&#39;s&nbsp;scheme&nbsp;is&nbsp;not&nbsp;HTTP&nbsp;or&nbsp;HTTPS.</span><br>
<span class="lineno">235</span><span class="keyword" id="3300077">func</span>&nbsp;<span class="op" id="3300082">(</span><span class="ident" id="3300083">j</span>&nbsp;<span class="op" id="3300085">*</span><span class="ident" id="3300086"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3300089">)</span>&nbsp;<span class="ident" id="3300091">SetCookies</span><span class="op" id="3300101">(</span><span class="ident" id="3300102">u</span>&nbsp;<span class="op" id="3300104">*</span><span class="ident" id="3300105"><a href="/net/http/cookiejar/jar.go.html#3293875">url</a></span><span class="op" id="3300108">.</span><span class="ident" id="3300109">URL</span><span class="op" id="3300112">,</span>&nbsp;<span class="ident" id="3300114">cookies</span>&nbsp;<span class="op" id="3300122">[</span><span class="op" id="3300123">]</span><span class="op" id="3300124">*</span><span class="ident" id="3300125"><a href="/net/http/cookiejar/jar.go.html#3293863">http</a></span><span class="op" id="3300129">.</span><span class="ident" id="3300130">Cookie</span><span class="op" id="3300136">)</span>&nbsp;<span class="op" id="3300138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300141"><a href="/net/http/cookiejar/jar.go.html#3300083">j</a></span><span class="op" id="3300142">.</span><span class="ident" id="3300143">setCookies</span><span class="op" id="3300153">(</span><span class="ident" id="3300154"><a href="/net/http/cookiejar/jar.go.html#3300102">u</a></span><span class="op" id="3300155">,</span>&nbsp;<span class="ident" id="3300157"><a href="/net/http/cookiejar/jar.go.html#3300114">cookies</a></span><span class="op" id="3300164">,</span>&nbsp;<span class="ident" id="3300166"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3300170">.</span><span class="ident" id="3300171">Now</span><span class="op" id="3300174">(</span><span class="op" id="3300175">)</span><span class="op" id="3300176">)</span><br>
<span class="lineno"></span><span class="op" id="3300178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3300181">//&nbsp;setCookies&nbsp;is&nbsp;like&nbsp;SetCookies&nbsp;but&nbsp;takes&nbsp;the&nbsp;current&nbsp;time&nbsp;as&nbsp;parameter.</span><br>
<span class="lineno">240</span><span class="keyword" id="3300255">func</span>&nbsp;<span class="op" id="3300260">(</span><span class="ident" id="3300261">j</span>&nbsp;<span class="op" id="3300263">*</span><span class="ident" id="3300264"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3300267">)</span>&nbsp;<span class="ident" id="3300269">setCookies</span><span class="op" id="3300279">(</span><span class="ident" id="3300280">u</span>&nbsp;<span class="op" id="3300282">*</span><span class="ident" id="3300283"><a href="/net/http/cookiejar/jar.go.html#3293875">url</a></span><span class="op" id="3300286">.</span><span class="ident" id="3300287">URL</span><span class="op" id="3300290">,</span>&nbsp;<span class="ident" id="3300292">cookies</span>&nbsp;<span class="op" id="3300300">[</span><span class="op" id="3300301">]</span><span class="op" id="3300302">*</span><span class="ident" id="3300303"><a href="/net/http/cookiejar/jar.go.html#3293863">http</a></span><span class="op" id="3300307">.</span><span class="ident" id="3300308">Cookie</span><span class="op" id="3300314">,</span>&nbsp;<span class="ident" id="3300316">now</span>&nbsp;<span class="ident" id="3300320"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3300324">.</span><span class="ident" id="3300325">Time</span><span class="op" id="3300329">)</span>&nbsp;<span class="op" id="3300331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300334">if</span>&nbsp;<span class="builtinfunc" id="3300337">len</span><span class="op" id="3300340">(</span><span class="ident" id="3300341"><a href="/net/http/cookiejar/jar.go.html#3300292">cookies</a></span><span class="op" id="3300348">)</span>&nbsp;<span class="op" id="3300350">==</span>&nbsp;<span class="num" id="3300353">0</span>&nbsp;<span class="op" id="3300355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300359">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300370">if</span>&nbsp;<span class="ident" id="3300373"><a href="/net/http/cookiejar/jar.go.html#3300280">u</a></span><span class="op" id="3300374">.</span><span class="ident" id="3300375">Scheme</span>&nbsp;<span class="op" id="3300382">!=</span>&nbsp;<span class="string" id="3300385">&#34;http&#34;</span>&nbsp;<span class="op" id="3300392">&amp;&amp;</span>&nbsp;<span class="ident" id="3300395"><a href="/net/http/cookiejar/jar.go.html#3300280">u</a></span><span class="op" id="3300396">.</span><span class="ident" id="3300397">Scheme</span>&nbsp;<span class="op" id="3300404">!=</span>&nbsp;<span class="string" id="3300407">&#34;https&#34;</span>&nbsp;<span class="op" id="3300415">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300419">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300430">host</span><span class="op" id="3300434">,</span>&nbsp;<span class="ident" id="3300436">err</span>&nbsp;<span class="op" id="3300440">:=</span>&nbsp;<span class="ident" id="3300443"><a href="/net/http/cookiejar/jar.go.html#3301422">canonicalHost</a></span><span class="op" id="3300456">(</span><span class="ident" id="3300457"><a href="/net/http/cookiejar/jar.go.html#3300280">u</a></span><span class="op" id="3300458">.</span><span class="ident" id="3300459">Host</span><span class="op" id="3300463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300466">if</span>&nbsp;<span class="ident" id="3300469"><a href="/net/http/cookiejar/jar.go.html#3300436">err</a></span>&nbsp;<span class="op" id="3300473">!=</span>&nbsp;<span class="ident" id="3300476">nil</span>&nbsp;<span class="op" id="3300480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300484">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300495">key</span>&nbsp;<span class="op" id="3300499">:=</span>&nbsp;<span class="ident" id="3300502"><a href="/net/http/cookiejar/jar.go.html#3302125">jarKey</a></span><span class="op" id="3300508">(</span><span class="ident" id="3300509"><a href="/net/http/cookiejar/jar.go.html#3300430">host</a></span><span class="op" id="3300513">,</span>&nbsp;<span class="ident" id="3300515"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3300516">.</span><span class="ident" id="3300517">psList</span><span class="op" id="3300523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300526">defPath</span>&nbsp;<span class="op" id="3300534">:=</span>&nbsp;<span class="ident" id="3300537"><a href="/net/http/cookiejar/jar.go.html#3302877">defaultPath</a></span><span class="op" id="3300548">(</span><span class="ident" id="3300549"><a href="/net/http/cookiejar/jar.go.html#3300280">u</a></span><span class="op" id="3300550">.</span><span class="ident" id="3300551">Path</span><span class="op" id="3300555">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300559"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3300560">.</span><span class="ident" id="3300561">mu</span><span class="op" id="3300563">.</span><span class="ident" id="3300564">Lock</span><span class="op" id="3300568">(</span><span class="op" id="3300569">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300572">defer</span>&nbsp;<span class="ident" id="3300578"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3300579">.</span><span class="ident" id="3300580">mu</span><span class="op" id="3300582">.</span><span class="ident" id="3300583">Unlock</span><span class="op" id="3300589">(</span><span class="op" id="3300590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300594">submap</span>&nbsp;<span class="op" id="3300601">:=</span>&nbsp;<span class="ident" id="3300604"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3300605">.</span><span class="ident" id="3300606">entries</span><span class="op" id="3300613">[</span><span class="ident" id="3300614"><a href="/net/http/cookiejar/jar.go.html#3300495">key</a></span><span class="op" id="3300617">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300621">modified</span>&nbsp;<span class="op" id="3300630">:=</span>&nbsp;<span class="builtintype" id="3300633">false</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300640">for</span>&nbsp;<span class="ident" id="3300644">_</span><span class="op" id="3300645">,</span>&nbsp;<span class="ident" id="3300647">cookie</span>&nbsp;<span class="op" id="3300654">:=</span>&nbsp;<span class="keyword" id="3300657">range</span>&nbsp;<span class="ident" id="3300663"><a href="/net/http/cookiejar/jar.go.html#3300292">cookies</a></span>&nbsp;<span class="op" id="3300671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300675">e</span><span class="op" id="3300676">,</span>&nbsp;<span class="ident" id="3300678">remove</span><span class="op" id="3300684">,</span>&nbsp;<span class="ident" id="3300686">err</span>&nbsp;<span class="op" id="3300690">:=</span>&nbsp;<span class="ident" id="3300693"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3300694">.</span><span class="ident" id="3300695">newEntry</span><span class="op" id="3300703">(</span><span class="ident" id="3300704"><a href="/net/http/cookiejar/jar.go.html#3300647">cookie</a></span><span class="op" id="3300710">,</span>&nbsp;<span class="ident" id="3300712"><a href="/net/http/cookiejar/jar.go.html#3300316">now</a></span><span class="op" id="3300715">,</span>&nbsp;<span class="ident" id="3300717"><a href="/net/http/cookiejar/jar.go.html#3300526">defPath</a></span><span class="op" id="3300724">,</span>&nbsp;<span class="ident" id="3300726"><a href="/net/http/cookiejar/jar.go.html#3300430">host</a></span><span class="op" id="3300730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300734">if</span>&nbsp;<span class="ident" id="3300737"><a href="/net/http/cookiejar/jar.go.html#3300686">err</a></span>&nbsp;<span class="op" id="3300741">!=</span>&nbsp;<span class="ident" id="3300744">nil</span>&nbsp;<span class="op" id="3300748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300753">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300764">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300768">id</span>&nbsp;<span class="op" id="3300771">:=</span>&nbsp;<span class="ident" id="3300774"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><span class="op" id="3300775">.</span><span class="ident" id="3300776">id</span><span class="op" id="3300778">(</span><span class="op" id="3300779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300783">if</span>&nbsp;<span class="ident" id="3300786"><a href="/net/http/cookiejar/jar.go.html#3300678">remove</a></span>&nbsp;<span class="op" id="3300793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300798">if</span>&nbsp;<span class="ident" id="3300801"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span>&nbsp;<span class="op" id="3300808">!=</span>&nbsp;<span class="ident" id="3300811">nil</span>&nbsp;<span class="op" id="3300815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300821">if</span>&nbsp;<span class="ident" id="3300824">_</span><span class="op" id="3300825">,</span>&nbsp;<span class="ident" id="3300827">ok</span>&nbsp;<span class="op" id="3300830">:=</span>&nbsp;<span class="ident" id="3300833"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span><span class="op" id="3300839">[</span><span class="ident" id="3300840"><a href="/net/http/cookiejar/jar.go.html#3300768">id</a></span><span class="op" id="3300842">]</span><span class="op" id="3300843">;</span>&nbsp;<span class="ident" id="3300845"><a href="/net/http/cookiejar/jar.go.html#3300827">ok</a></span>&nbsp;<span class="op" id="3300848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3300855">delete</span><span class="op" id="3300861">(</span><span class="ident" id="3300862"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span><span class="op" id="3300868">,</span>&nbsp;<span class="ident" id="3300870"><a href="/net/http/cookiejar/jar.go.html#3300768">id</a></span><span class="op" id="3300872">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300879"><a href="/net/http/cookiejar/jar.go.html#3300621">modified</a></span>&nbsp;<span class="op" id="3300888">=</span>&nbsp;<span class="builtintype" id="3300890">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300909">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300920">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300924">if</span>&nbsp;<span class="ident" id="3300927"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span>&nbsp;<span class="op" id="3300934">==</span>&nbsp;<span class="ident" id="3300937">nil</span>&nbsp;<span class="op" id="3300941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300946"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span>&nbsp;<span class="op" id="3300953">=</span>&nbsp;<span class="builtinfunc" id="3300955">make</span><span class="op" id="3300959">(</span><span class="keyword" id="3300960">map</span><span class="op" id="3300963">[</span><span class="builtintype" id="3300964">string</span><span class="op" id="3300970">]</span><span class="ident" id="3300971"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3300976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300985">if</span>&nbsp;<span class="ident" id="3300988">old</span><span class="op" id="3300991">,</span>&nbsp;<span class="ident" id="3300993">ok</span>&nbsp;<span class="op" id="3300996">:=</span>&nbsp;<span class="ident" id="3300999"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span><span class="op" id="3301005">[</span><span class="ident" id="3301006"><a href="/net/http/cookiejar/jar.go.html#3300768">id</a></span><span class="op" id="3301008">]</span><span class="op" id="3301009">;</span>&nbsp;<span class="ident" id="3301011"><a href="/net/http/cookiejar/jar.go.html#3300993">ok</a></span>&nbsp;<span class="op" id="3301014">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301019"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><span class="op" id="3301020">.</span><span class="ident" id="3301021">Creation</span>&nbsp;<span class="op" id="3301030">=</span>&nbsp;<span class="ident" id="3301032"><a href="/net/http/cookiejar/jar.go.html#3300988">old</a></span><span class="op" id="3301035">.</span><span class="ident" id="3301036">Creation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301048"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><span class="op" id="3301049">.</span><span class="ident" id="3301050">seqNum</span>&nbsp;<span class="op" id="3301057">=</span>&nbsp;<span class="ident" id="3301059"><a href="/net/http/cookiejar/jar.go.html#3300988">old</a></span><span class="op" id="3301062">.</span><span class="ident" id="3301063">seqNum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301072">}</span>&nbsp;<span class="keyword" id="3301074">else</span>&nbsp;<span class="op" id="3301079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301084"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><span class="op" id="3301085">.</span><span class="ident" id="3301086">Creation</span>&nbsp;<span class="op" id="3301095">=</span>&nbsp;<span class="ident" id="3301097"><a href="/net/http/cookiejar/jar.go.html#3300316">now</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301104"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><span class="op" id="3301105">.</span><span class="ident" id="3301106">seqNum</span>&nbsp;<span class="op" id="3301113">=</span>&nbsp;<span class="ident" id="3301115"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3301116">.</span><span class="ident" id="3301117">nextSeqNum</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301131"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3301132">.</span><span class="ident" id="3301133">nextSeqNum</span><span class="op" id="3301143">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301152"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><span class="op" id="3301153">.</span><span class="ident" id="3301154">LastAccess</span>&nbsp;<span class="op" id="3301165">=</span>&nbsp;<span class="ident" id="3301167"><a href="/net/http/cookiejar/jar.go.html#3300316">now</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301173"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span><span class="op" id="3301179">[</span><span class="ident" id="3301180"><a href="/net/http/cookiejar/jar.go.html#3300768">id</a></span><span class="op" id="3301182">]</span>&nbsp;<span class="op" id="3301184">=</span>&nbsp;<span class="ident" id="3301186"><a href="/net/http/cookiejar/jar.go.html#3300675">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301190"><a href="/net/http/cookiejar/jar.go.html#3300621">modified</a></span>&nbsp;<span class="op" id="3301199">=</span>&nbsp;<span class="builtintype" id="3301201">true</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301211">if</span>&nbsp;<span class="ident" id="3301214"><a href="/net/http/cookiejar/jar.go.html#3300621">modified</a></span>&nbsp;<span class="op" id="3301223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301227">if</span>&nbsp;<span class="builtinfunc" id="3301230">len</span><span class="op" id="3301233">(</span><span class="ident" id="3301234"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span><span class="op" id="3301240">)</span>&nbsp;<span class="op" id="3301242">==</span>&nbsp;<span class="num" id="3301245">0</span>&nbsp;<span class="op" id="3301247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3301252">delete</span><span class="op" id="3301258">(</span><span class="ident" id="3301259"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3301260">.</span><span class="ident" id="3301261">entries</span><span class="op" id="3301268">,</span>&nbsp;<span class="ident" id="3301270"><a href="/net/http/cookiejar/jar.go.html#3300495">key</a></span><span class="op" id="3301273">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301277">}</span>&nbsp;<span class="keyword" id="3301279">else</span>&nbsp;<span class="op" id="3301284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301289"><a href="/net/http/cookiejar/jar.go.html#3300261">j</a></span><span class="op" id="3301290">.</span><span class="ident" id="3301291">entries</span><span class="op" id="3301298">[</span><span class="ident" id="3301299"><a href="/net/http/cookiejar/jar.go.html#3300495">key</a></span><span class="op" id="3301302">]</span>&nbsp;<span class="op" id="3301304">=</span>&nbsp;<span class="ident" id="3301306"><a href="/net/http/cookiejar/jar.go.html#3300594">submap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301318">}</span><br>
<span class="lineno"></span><span class="op" id="3301320">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="3301323">//&nbsp;canonicalHost&nbsp;strips&nbsp;port&nbsp;from&nbsp;host&nbsp;if&nbsp;present&nbsp;and&nbsp;returns&nbsp;the&nbsp;canonicalized</span><br>
<span class="lineno"></span><span class="comment" id="3301403">//&nbsp;host&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3301417">func</span>&nbsp;<span class="ident" id="3301422">canonicalHost</span><span class="op" id="3301435">(</span><span class="ident" id="3301436">host</span>&nbsp;<span class="builtintype" id="3301441">string</span><span class="op" id="3301447">)</span>&nbsp;<span class="op" id="3301449">(</span><span class="builtintype" id="3301450">string</span><span class="op" id="3301456">,</span>&nbsp;<span class="builtintype" id="3301458">error</span><span class="op" id="3301463">)</span>&nbsp;<span class="op" id="3301465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301468">var</span>&nbsp;<span class="ident" id="3301472">err</span>&nbsp;<span class="builtintype" id="3301476">error</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301483"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span>&nbsp;<span class="op" id="3301488">=</span>&nbsp;<span class="ident" id="3301490"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3301497">.</span><span class="ident" id="3301498">ToLower</span><span class="op" id="3301505">(</span><span class="ident" id="3301506"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301513">if</span>&nbsp;<span class="ident" id="3301516"><a href="/net/http/cookiejar/jar.go.html#3301883">hasPort</a></span><span class="op" id="3301523">(</span><span class="ident" id="3301524"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301528">)</span>&nbsp;<span class="op" id="3301530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301534"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301538">,</span>&nbsp;<span class="ident" id="3301540">_</span><span class="op" id="3301541">,</span>&nbsp;<span class="ident" id="3301543"><a href="/net/http/cookiejar/jar.go.html#3301472">err</a></span>&nbsp;<span class="op" id="3301547">=</span>&nbsp;<span class="ident" id="3301549"><a href="/net/http/cookiejar/jar.go.html#3293856">net</a></span><span class="op" id="3301552">.</span><span class="ident" id="3301553">SplitHostPort</span><span class="op" id="3301566">(</span><span class="ident" id="3301567"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301575">if</span>&nbsp;<span class="ident" id="3301578"><a href="/net/http/cookiejar/jar.go.html#3301472">err</a></span>&nbsp;<span class="op" id="3301582">!=</span>&nbsp;<span class="ident" id="3301585">nil</span>&nbsp;<span class="op" id="3301589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301594">return</span>&nbsp;<span class="string" id="3301601">&#34;&#34;</span><span class="op" id="3301603">,</span>&nbsp;<span class="ident" id="3301605"><a href="/net/http/cookiejar/jar.go.html#3301472">err</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301617">if</span>&nbsp;<span class="ident" id="3301620"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3301627">.</span><span class="ident" id="3301628">HasSuffix</span><span class="op" id="3301637">(</span><span class="ident" id="3301638"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301642">,</span>&nbsp;<span class="string" id="3301644">&#34;.&#34;</span><span class="op" id="3301647">)</span>&nbsp;<span class="op" id="3301649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301653">//&nbsp;Strip&nbsp;trailing&nbsp;dot&nbsp;from&nbsp;fully&nbsp;qualified&nbsp;domain&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301712"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span>&nbsp;<span class="op" id="3301717">=</span>&nbsp;<span class="ident" id="3301719"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301723">[</span><span class="op" id="3301724">:</span><span class="builtinfunc" id="3301725">len</span><span class="op" id="3301728">(</span><span class="ident" id="3301729"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301733">)</span><span class="op" id="3301734">-</span><span class="num" id="3301735">1</span><span class="op" id="3301736">]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301742">return</span>&nbsp;<span class="ident" id="3301749"><a href="/net/http/cookiejar/punycode.go.html#3309997">toASCII</a></span><span class="op" id="3301756">(</span><span class="ident" id="3301757"><a href="/net/http/cookiejar/jar.go.html#3301436">host</a></span><span class="op" id="3301761">)</span><br>
<span class="lineno"></span><span class="op" id="3301763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3301766">//&nbsp;hasPort&nbsp;reports&nbsp;whether&nbsp;host&nbsp;contains&nbsp;a&nbsp;port&nbsp;number.&nbsp;host&nbsp;may&nbsp;be&nbsp;a&nbsp;host</span><br>
<span class="lineno">320</span><span class="comment" id="3301841">//&nbsp;name,&nbsp;an&nbsp;IPv4&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3301878">func</span>&nbsp;<span class="ident" id="3301883">hasPort</span><span class="op" id="3301890">(</span><span class="ident" id="3301891">host</span>&nbsp;<span class="builtintype" id="3301896">string</span><span class="op" id="3301902">)</span>&nbsp;<span class="builtintype" id="3301904">bool</span>&nbsp;<span class="op" id="3301909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301912">colons</span>&nbsp;<span class="op" id="3301919">:=</span>&nbsp;<span class="ident" id="3301922"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3301929">.</span><span class="ident" id="3301930">Count</span><span class="op" id="3301935">(</span><span class="ident" id="3301936"><a href="/net/http/cookiejar/jar.go.html#3301891">host</a></span><span class="op" id="3301940">,</span>&nbsp;<span class="string" id="3301942">&#34;:&#34;</span><span class="op" id="3301945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301948">if</span>&nbsp;<span class="ident" id="3301951"><a href="/net/http/cookiejar/jar.go.html#3301912">colons</a></span>&nbsp;<span class="op" id="3301958">==</span>&nbsp;<span class="num" id="3301961">0</span>&nbsp;<span class="op" id="3301963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301967">return</span>&nbsp;<span class="builtintype" id="3301974">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3301981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3301984">if</span>&nbsp;<span class="ident" id="3301987"><a href="/net/http/cookiejar/jar.go.html#3301912">colons</a></span>&nbsp;<span class="op" id="3301994">==</span>&nbsp;<span class="num" id="3301997">1</span>&nbsp;<span class="op" id="3301999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302003">return</span>&nbsp;<span class="builtintype" id="3302010">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302019">return</span>&nbsp;<span class="ident" id="3302026"><a href="/net/http/cookiejar/jar.go.html#3301891">host</a></span><span class="op" id="3302030">[</span><span class="num" id="3302031">0</span><span class="op" id="3302032">]</span>&nbsp;<span class="op" id="3302034">==</span>&nbsp;<span class="string" id="3302037">&#39;[&#39;</span>&nbsp;<span class="op" id="3302041">&amp;&amp;</span>&nbsp;<span class="ident" id="3302044"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3302051">.</span><span class="ident" id="3302052">Contains</span><span class="op" id="3302060">(</span><span class="ident" id="3302061"><a href="/net/http/cookiejar/jar.go.html#3301891">host</a></span><span class="op" id="3302065">,</span>&nbsp;<span class="string" id="3302067">&#34;]:&#34;</span><span class="op" id="3302071">)</span><br>
<span class="lineno">330</span><span class="op" id="3302073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3302076">//&nbsp;jarKey&nbsp;returns&nbsp;the&nbsp;key&nbsp;to&nbsp;use&nbsp;for&nbsp;a&nbsp;jar.</span><br>
<span class="lineno"></span><span class="keyword" id="3302120">func</span>&nbsp;<span class="ident" id="3302125">jarKey</span><span class="op" id="3302131">(</span><span class="ident" id="3302132">host</span>&nbsp;<span class="builtintype" id="3302137">string</span><span class="op" id="3302143">,</span>&nbsp;<span class="ident" id="3302145">psl</span>&nbsp;<span class="ident" id="3302149"><a href="/net/http/cookiejar/jar.go.html#3294578">PublicSuffixList</a></span><span class="op" id="3302165">)</span>&nbsp;<span class="builtintype" id="3302167">string</span>&nbsp;<span class="op" id="3302174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302177">if</span>&nbsp;<span class="ident" id="3302180"><a href="/net/http/cookiejar/jar.go.html#3302712">isIP</a></span><span class="op" id="3302184">(</span><span class="ident" id="3302185"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302189">)</span>&nbsp;<span class="op" id="3302191">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302195">return</span>&nbsp;<span class="ident" id="3302202"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302212">var</span>&nbsp;<span class="ident" id="3302216">i</span>&nbsp;<span class="builtintype" id="3302218">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302223">if</span>&nbsp;<span class="ident" id="3302226"><a href="/net/http/cookiejar/jar.go.html#3302145">psl</a></span>&nbsp;<span class="op" id="3302230">==</span>&nbsp;<span class="ident" id="3302233">nil</span>&nbsp;<span class="op" id="3302237">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302241"><a href="/net/http/cookiejar/jar.go.html#3302216">i</a></span>&nbsp;<span class="op" id="3302243">=</span>&nbsp;<span class="ident" id="3302245"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3302252">.</span><span class="ident" id="3302253">LastIndex</span><span class="op" id="3302262">(</span><span class="ident" id="3302263"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302267">,</span>&nbsp;<span class="string" id="3302269">&#34;.&#34;</span><span class="op" id="3302272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302276">if</span>&nbsp;<span class="ident" id="3302279"><a href="/net/http/cookiejar/jar.go.html#3302216">i</a></span>&nbsp;<span class="op" id="3302281">==</span>&nbsp;<span class="op" id="3302284">-</span><span class="num" id="3302285">1</span>&nbsp;<span class="op" id="3302287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302292">return</span>&nbsp;<span class="ident" id="3302299"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302309">}</span>&nbsp;<span class="keyword" id="3302311">else</span>&nbsp;<span class="op" id="3302316">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302320">suffix</span>&nbsp;<span class="op" id="3302327">:=</span>&nbsp;<span class="ident" id="3302330"><a href="/net/http/cookiejar/jar.go.html#3302145">psl</a></span><span class="op" id="3302333">.</span><span class="ident" id="3302334">PublicSuffix</span><span class="op" id="3302346">(</span><span class="ident" id="3302347"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302355">if</span>&nbsp;<span class="ident" id="3302358"><a href="/net/http/cookiejar/jar.go.html#3302320">suffix</a></span>&nbsp;<span class="op" id="3302365">==</span>&nbsp;<span class="ident" id="3302368"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span>&nbsp;<span class="op" id="3302373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302378">return</span>&nbsp;<span class="ident" id="3302385"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302396"><a href="/net/http/cookiejar/jar.go.html#3302216">i</a></span>&nbsp;<span class="op" id="3302398">=</span>&nbsp;<span class="builtinfunc" id="3302400">len</span><span class="op" id="3302403">(</span><span class="ident" id="3302404"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302408">)</span>&nbsp;<span class="op" id="3302410">-</span>&nbsp;<span class="builtinfunc" id="3302412">len</span><span class="op" id="3302415">(</span><span class="ident" id="3302416"><a href="/net/http/cookiejar/jar.go.html#3302320">suffix</a></span><span class="op" id="3302422">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302426">if</span>&nbsp;<span class="ident" id="3302429"><a href="/net/http/cookiejar/jar.go.html#3302216">i</a></span>&nbsp;<span class="op" id="3302431">&lt;=</span>&nbsp;<span class="num" id="3302434">0</span>&nbsp;<span class="op" id="3302436">||</span>&nbsp;<span class="ident" id="3302439"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302443">[</span><span class="ident" id="3302444"><a href="/net/http/cookiejar/jar.go.html#3302216">i</a></span><span class="op" id="3302445">-</span><span class="num" id="3302446">1</span><span class="op" id="3302447">]</span>&nbsp;<span class="op" id="3302449">!=</span>&nbsp;<span class="string" id="3302452">&#39;.&#39;</span>&nbsp;<span class="op" id="3302456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302461">//&nbsp;The&nbsp;provided&nbsp;public&nbsp;suffix&nbsp;list&nbsp;psl&nbsp;is&nbsp;broken.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302514">//&nbsp;Storing&nbsp;cookies&nbsp;under&nbsp;host&nbsp;is&nbsp;a&nbsp;safe&nbsp;stopgap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302566">return</span>&nbsp;<span class="ident" id="3302573"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302580">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302586">prevDot</span>&nbsp;<span class="op" id="3302594">:=</span>&nbsp;<span class="ident" id="3302597"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3302604">.</span><span class="ident" id="3302605">LastIndex</span><span class="op" id="3302614">(</span><span class="ident" id="3302615"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302619">[</span><span class="op" id="3302620">:</span><span class="ident" id="3302621"><a href="/net/http/cookiejar/jar.go.html#3302216">i</a></span><span class="op" id="3302622">-</span><span class="num" id="3302623">1</span><span class="op" id="3302624">]</span><span class="op" id="3302625">,</span>&nbsp;<span class="string" id="3302627">&#34;.&#34;</span><span class="op" id="3302630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302633">return</span>&nbsp;<span class="ident" id="3302640"><a href="/net/http/cookiejar/jar.go.html#3302132">host</a></span><span class="op" id="3302644">[</span><span class="ident" id="3302645"><a href="/net/http/cookiejar/jar.go.html#3302586">prevDot</a></span><span class="op" id="3302652">+</span><span class="num" id="3302653">1</span><span class="op" id="3302654">:</span><span class="op" id="3302655">]</span><br>
<span class="lineno"></span><span class="op" id="3302657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="3302660">//&nbsp;isIP&nbsp;reports&nbsp;whether&nbsp;host&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3302707">func</span>&nbsp;<span class="ident" id="3302712">isIP</span><span class="op" id="3302716">(</span><span class="ident" id="3302717">host</span>&nbsp;<span class="builtintype" id="3302722">string</span><span class="op" id="3302728">)</span>&nbsp;<span class="builtintype" id="3302730">bool</span>&nbsp;<span class="op" id="3302735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302738">return</span>&nbsp;<span class="ident" id="3302745"><a href="/net/http/cookiejar/jar.go.html#3293856">net</a></span><span class="op" id="3302748">.</span><span class="ident" id="3302749">ParseIP</span><span class="op" id="3302756">(</span><span class="ident" id="3302757"><a href="/net/http/cookiejar/jar.go.html#3302717">host</a></span><span class="op" id="3302761">)</span>&nbsp;<span class="op" id="3302763">!=</span>&nbsp;<span class="ident" id="3302766">nil</span><br>
<span class="lineno"></span><span class="op" id="3302770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3302773">//&nbsp;defaultPath&nbsp;returns&nbsp;the&nbsp;directory&nbsp;part&nbsp;of&nbsp;an&nbsp;URL&#39;s&nbsp;path&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3302845">//&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.1.4.</span><br>
<span class="lineno"></span><span class="keyword" id="3302872">func</span>&nbsp;<span class="ident" id="3302877">defaultPath</span><span class="op" id="3302888">(</span><span class="ident" id="3302889">path</span>&nbsp;<span class="builtintype" id="3302894">string</span><span class="op" id="3302900">)</span>&nbsp;<span class="builtintype" id="3302902">string</span>&nbsp;<span class="op" id="3302909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302912">if</span>&nbsp;<span class="builtinfunc" id="3302915">len</span><span class="op" id="3302918">(</span><span class="ident" id="3302919"><a href="/net/http/cookiejar/jar.go.html#3302889">path</a></span><span class="op" id="3302923">)</span>&nbsp;<span class="op" id="3302925">==</span>&nbsp;<span class="num" id="3302928">0</span>&nbsp;<span class="op" id="3302930">||</span>&nbsp;<span class="ident" id="3302933"><a href="/net/http/cookiejar/jar.go.html#3302889">path</a></span><span class="op" id="3302937">[</span><span class="num" id="3302938">0</span><span class="op" id="3302939">]</span>&nbsp;<span class="op" id="3302941">!=</span>&nbsp;<span class="string" id="3302944">&#39;/&#39;</span>&nbsp;<span class="op" id="3302948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302952">return</span>&nbsp;<span class="string" id="3302959">&#34;/&#34;</span>&nbsp;<span class="comment" id="3302963">//&nbsp;Path&nbsp;is&nbsp;empty&nbsp;or&nbsp;malformed.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302999">i</span>&nbsp;<span class="op" id="3303001">:=</span>&nbsp;<span class="ident" id="3303004"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3303011">.</span><span class="ident" id="3303012">LastIndex</span><span class="op" id="3303021">(</span><span class="ident" id="3303022"><a href="/net/http/cookiejar/jar.go.html#3302889">path</a></span><span class="op" id="3303026">,</span>&nbsp;<span class="string" id="3303028">&#34;/&#34;</span><span class="op" id="3303031">)</span>&nbsp;<span class="comment" id="3303033">//&nbsp;Path&nbsp;starts&nbsp;with&nbsp;&#34;/&#34;,&nbsp;so&nbsp;i&nbsp;!=&nbsp;-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303071">if</span>&nbsp;<span class="ident" id="3303074"><a href="/net/http/cookiejar/jar.go.html#3302999">i</a></span>&nbsp;<span class="op" id="3303076">==</span>&nbsp;<span class="num" id="3303079">0</span>&nbsp;<span class="op" id="3303081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303085">return</span>&nbsp;<span class="string" id="3303092">&#34;/&#34;</span>&nbsp;<span class="comment" id="3303096">//&nbsp;Path&nbsp;has&nbsp;the&nbsp;form&nbsp;&#34;/abc&#34;.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303129">return</span>&nbsp;<span class="ident" id="3303136"><a href="/net/http/cookiejar/jar.go.html#3302889">path</a></span><span class="op" id="3303140">[</span><span class="op" id="3303141">:</span><span class="ident" id="3303142"><a href="/net/http/cookiejar/jar.go.html#3302999">i</a></span><span class="op" id="3303143">]</span>&nbsp;<span class="comment" id="3303145">//&nbsp;Path&nbsp;is&nbsp;either&nbsp;of&nbsp;form&nbsp;&#34;/abc/xyz&#34;&nbsp;or&nbsp;&#34;/abc/xyz/&#34;.</span><br>
<span class="lineno"></span><span class="op" id="3303198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3303201">//&nbsp;newEntry&nbsp;creates&nbsp;an&nbsp;entry&nbsp;from&nbsp;a&nbsp;http.Cookie&nbsp;c.&nbsp;now&nbsp;is&nbsp;the&nbsp;current&nbsp;time&nbsp;and</span><br>
<span class="lineno">380</span><span class="comment" id="3303280">//&nbsp;is&nbsp;compared&nbsp;to&nbsp;c.Expires&nbsp;to&nbsp;determine&nbsp;deletion&nbsp;of&nbsp;c.&nbsp;defPath&nbsp;and&nbsp;host&nbsp;are&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3303361">//&nbsp;default-path&nbsp;and&nbsp;the&nbsp;canonical&nbsp;host&nbsp;name&nbsp;of&nbsp;the&nbsp;URL&nbsp;c&nbsp;was&nbsp;received&nbsp;from.</span><br>
<span class="lineno"></span><span class="comment" id="3303437">//</span><br>
<span class="lineno"></span><span class="comment" id="3303440">//&nbsp;remove&nbsp;records&nbsp;whether&nbsp;the&nbsp;jar&nbsp;should&nbsp;delete&nbsp;this&nbsp;cookie,&nbsp;as&nbsp;it&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="3303519">//&nbsp;expired&nbsp;with&nbsp;respect&nbsp;to&nbsp;now.&nbsp;In&nbsp;this&nbsp;case,&nbsp;e&nbsp;may&nbsp;be&nbsp;incomplete,&nbsp;but&nbsp;it&nbsp;will</span><br>
<span class="lineno">385</span><span class="comment" id="3303598">//&nbsp;be&nbsp;valid&nbsp;to&nbsp;call&nbsp;e.id&nbsp;(which&nbsp;depends&nbsp;on&nbsp;e&#39;s&nbsp;Name,&nbsp;Domain&nbsp;and&nbsp;Path).</span><br>
<span class="lineno"></span><span class="comment" id="3303669">//</span><br>
<span class="lineno"></span><span class="comment" id="3303672">//&nbsp;A&nbsp;malformed&nbsp;c.Domain&nbsp;will&nbsp;result&nbsp;in&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3303721">func</span>&nbsp;<span class="op" id="3303726">(</span><span class="ident" id="3303727">j</span>&nbsp;<span class="op" id="3303729">*</span><span class="ident" id="3303730"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3303733">)</span>&nbsp;<span class="ident" id="3303735">newEntry</span><span class="op" id="3303743">(</span><span class="ident" id="3303744">c</span>&nbsp;<span class="op" id="3303746">*</span><span class="ident" id="3303747"><a href="/net/http/cookiejar/jar.go.html#3293863">http</a></span><span class="op" id="3303751">.</span><span class="ident" id="3303752">Cookie</span><span class="op" id="3303758">,</span>&nbsp;<span class="ident" id="3303760">now</span>&nbsp;<span class="ident" id="3303764"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3303768">.</span><span class="ident" id="3303769">Time</span><span class="op" id="3303773">,</span>&nbsp;<span class="ident" id="3303775">defPath</span><span class="op" id="3303782">,</span>&nbsp;<span class="ident" id="3303784">host</span>&nbsp;<span class="builtintype" id="3303789">string</span><span class="op" id="3303795">)</span>&nbsp;<span class="op" id="3303797">(</span><span class="ident" id="3303798">e</span>&nbsp;<span class="ident" id="3303800"><a href="/net/http/cookiejar/jar.go.html#3296304">entry</a></span><span class="op" id="3303805">,</span>&nbsp;<span class="ident" id="3303807">remove</span>&nbsp;<span class="builtintype" id="3303814">bool</span><span class="op" id="3303818">,</span>&nbsp;<span class="ident" id="3303820">err</span>&nbsp;<span class="builtintype" id="3303824">error</span><span class="op" id="3303829">)</span>&nbsp;<span class="op" id="3303831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303834"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3303835">.</span><span class="ident" id="3303836">Name</span>&nbsp;<span class="op" id="3303841">=</span>&nbsp;<span class="ident" id="3303843"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3303844">.</span><span class="ident" id="3303845">Name</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303852">if</span>&nbsp;<span class="ident" id="3303855"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3303856">.</span><span class="ident" id="3303857">Path</span>&nbsp;<span class="op" id="3303862">==</span>&nbsp;<span class="string" id="3303865">&#34;&#34;</span>&nbsp;<span class="op" id="3303868">||</span>&nbsp;<span class="ident" id="3303871"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3303872">.</span><span class="ident" id="3303873">Path</span><span class="op" id="3303877">[</span><span class="num" id="3303878">0</span><span class="op" id="3303879">]</span>&nbsp;<span class="op" id="3303881">!=</span>&nbsp;<span class="string" id="3303884">&#39;/&#39;</span>&nbsp;<span class="op" id="3303888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303892"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3303893">.</span><span class="ident" id="3303894">Path</span>&nbsp;<span class="op" id="3303899">=</span>&nbsp;<span class="ident" id="3303901"><a href="/net/http/cookiejar/jar.go.html#3303775">defPath</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303910">}</span>&nbsp;<span class="keyword" id="3303912">else</span>&nbsp;<span class="op" id="3303917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303921"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3303922">.</span><span class="ident" id="3303923">Path</span>&nbsp;<span class="op" id="3303928">=</span>&nbsp;<span class="ident" id="3303930"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3303931">.</span><span class="ident" id="3303932">Path</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303942"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3303943">.</span><span class="ident" id="3303944">Domain</span><span class="op" id="3303950">,</span>&nbsp;<span class="ident" id="3303952"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3303953">.</span><span class="ident" id="3303954">HostOnly</span><span class="op" id="3303962">,</span>&nbsp;<span class="ident" id="3303964"><a href="/net/http/cookiejar/jar.go.html#3303820">err</a></span>&nbsp;<span class="op" id="3303968">=</span>&nbsp;<span class="ident" id="3303970"><a href="/net/http/cookiejar/jar.go.html#3303727">j</a></span><span class="op" id="3303971">.</span><span class="ident" id="3303972">domainAndType</span><span class="op" id="3303985">(</span><span class="ident" id="3303986"><a href="/net/http/cookiejar/jar.go.html#3303784">host</a></span><span class="op" id="3303990">,</span>&nbsp;<span class="ident" id="3303992"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3303993">.</span><span class="ident" id="3303994">Domain</span><span class="op" id="3304000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304003">if</span>&nbsp;<span class="ident" id="3304006"><a href="/net/http/cookiejar/jar.go.html#3303820">err</a></span>&nbsp;<span class="op" id="3304010">!=</span>&nbsp;<span class="ident" id="3304013">nil</span>&nbsp;<span class="op" id="3304017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304021">return</span>&nbsp;<span class="ident" id="3304028"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304029">,</span>&nbsp;<span class="builtintype" id="3304031">false</span><span class="op" id="3304036">,</span>&nbsp;<span class="ident" id="3304038"><a href="/net/http/cookiejar/jar.go.html#3303820">err</a></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304047">//&nbsp;MaxAge&nbsp;takes&nbsp;precedence&nbsp;over&nbsp;Expires.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304089">if</span>&nbsp;<span class="ident" id="3304092"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304093">.</span><span class="ident" id="3304094">MaxAge</span>&nbsp;<span class="op" id="3304101">&lt;</span>&nbsp;<span class="num" id="3304103">0</span>&nbsp;<span class="op" id="3304105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304109">return</span>&nbsp;<span class="ident" id="3304116"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304117">,</span>&nbsp;<span class="builtintype" id="3304119">true</span><span class="op" id="3304123">,</span>&nbsp;<span class="ident" id="3304125">nil</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304130">}</span>&nbsp;<span class="keyword" id="3304132">else</span>&nbsp;<span class="keyword" id="3304137">if</span>&nbsp;<span class="ident" id="3304140"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304141">.</span><span class="ident" id="3304142">MaxAge</span>&nbsp;<span class="op" id="3304149">&gt;</span>&nbsp;<span class="num" id="3304151">0</span>&nbsp;<span class="op" id="3304153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304157"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304158">.</span><span class="ident" id="3304159">Expires</span>&nbsp;<span class="op" id="3304167">=</span>&nbsp;<span class="ident" id="3304169"><a href="/net/http/cookiejar/jar.go.html#3303760">now</a></span><span class="op" id="3304172">.</span><span class="ident" id="3304173">Add</span><span class="op" id="3304176">(</span><span class="ident" id="3304177"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3304181">.</span><span class="ident" id="3304182">Duration</span><span class="op" id="3304190">(</span><span class="ident" id="3304191"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304192">.</span><span class="ident" id="3304193">MaxAge</span><span class="op" id="3304199">)</span>&nbsp;<span class="op" id="3304201">*</span>&nbsp;<span class="ident" id="3304203"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3304207">.</span><span class="ident" id="3304208">Second</span><span class="op" id="3304214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304218"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304219">.</span><span class="ident" id="3304220">Persistent</span>&nbsp;<span class="op" id="3304231">=</span>&nbsp;<span class="builtintype" id="3304233">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304239">}</span>&nbsp;<span class="keyword" id="3304241">else</span>&nbsp;<span class="op" id="3304246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304250">if</span>&nbsp;<span class="ident" id="3304253"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304254">.</span><span class="ident" id="3304255">Expires</span><span class="op" id="3304262">.</span><span class="ident" id="3304263">IsZero</span><span class="op" id="3304269">(</span><span class="op" id="3304270">)</span>&nbsp;<span class="op" id="3304272">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304277"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304278">.</span><span class="ident" id="3304279">Expires</span>&nbsp;<span class="op" id="3304287">=</span>&nbsp;<span class="ident" id="3304289"><a href="/net/http/cookiejar/jar.go.html#3304992">endOfTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304302"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304303">.</span><span class="ident" id="3304304">Persistent</span>&nbsp;<span class="op" id="3304315">=</span>&nbsp;<span class="builtintype" id="3304317">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304325">}</span>&nbsp;<span class="keyword" id="3304327">else</span>&nbsp;<span class="op" id="3304332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304337">if</span>&nbsp;<span class="op" id="3304340">!</span><span class="ident" id="3304341"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304342">.</span><span class="ident" id="3304343">Expires</span><span class="op" id="3304350">.</span><span class="ident" id="3304351">After</span><span class="op" id="3304356">(</span><span class="ident" id="3304357"><a href="/net/http/cookiejar/jar.go.html#3303760">now</a></span><span class="op" id="3304360">)</span>&nbsp;<span class="op" id="3304362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304368">return</span>&nbsp;<span class="ident" id="3304375"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304376">,</span>&nbsp;<span class="builtintype" id="3304378">true</span><span class="op" id="3304382">,</span>&nbsp;<span class="ident" id="3304384">nil</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304396"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304397">.</span><span class="ident" id="3304398">Expires</span>&nbsp;<span class="op" id="3304406">=</span>&nbsp;<span class="ident" id="3304408"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304409">.</span><span class="ident" id="3304410">Expires</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304421"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304422">.</span><span class="ident" id="3304423">Persistent</span>&nbsp;<span class="op" id="3304434">=</span>&nbsp;<span class="builtintype" id="3304436">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304446">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304450"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304451">.</span><span class="ident" id="3304452">Value</span>&nbsp;<span class="op" id="3304458">=</span>&nbsp;<span class="ident" id="3304460"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304461">.</span><span class="ident" id="3304462">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304469"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304470">.</span><span class="ident" id="3304471">Secure</span>&nbsp;<span class="op" id="3304478">=</span>&nbsp;<span class="ident" id="3304480"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304481">.</span><span class="ident" id="3304482">Secure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304490"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304491">.</span><span class="ident" id="3304492">HttpOnly</span>&nbsp;<span class="op" id="3304501">=</span>&nbsp;<span class="ident" id="3304503"><a href="/net/http/cookiejar/jar.go.html#3303744">c</a></span><span class="op" id="3304504">.</span><span class="ident" id="3304505">HttpOnly</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304516">return</span>&nbsp;<span class="ident" id="3304523"><a href="/net/http/cookiejar/jar.go.html#3303798">e</a></span><span class="op" id="3304524">,</span>&nbsp;<span class="builtintype" id="3304526">false</span><span class="op" id="3304531">,</span>&nbsp;<span class="ident" id="3304533">nil</span><br>
<span class="lineno"></span><span class="op" id="3304537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304540">var</span>&nbsp;<span class="op" id="3304544">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304547">errIllegalDomain</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3304566">=</span>&nbsp;<span class="ident" id="3304568"><a href="/net/http/cookiejar/jar.go.html#3293839">errors</a></span><span class="op" id="3304574">.</span><span class="ident" id="3304575">New</span><span class="op" id="3304578">(</span><span class="string" id="3304579">&#34;cookiejar:&nbsp;illegal&nbsp;cookie&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3304623">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304626">errMalformedDomain</span>&nbsp;<span class="op" id="3304645">=</span>&nbsp;<span class="ident" id="3304647"><a href="/net/http/cookiejar/jar.go.html#3293839">errors</a></span><span class="op" id="3304653">.</span><span class="ident" id="3304654">New</span><span class="op" id="3304657">(</span><span class="string" id="3304658">&#34;cookiejar:&nbsp;malformed&nbsp;cookie&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3304704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304707">errNoHostname</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3304726">=</span>&nbsp;<span class="ident" id="3304728"><a href="/net/http/cookiejar/jar.go.html#3293839">errors</a></span><span class="op" id="3304734">.</span><span class="ident" id="3304735">New</span><span class="op" id="3304738">(</span><span class="string" id="3304739">&#34;cookiejar:&nbsp;no&nbsp;host&nbsp;name&nbsp;available&nbsp;(IP&nbsp;only)&#34;</span><span class="op" id="3304784">)</span><br>
<span class="lineno"></span><span class="op" id="3304786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3304789">//&nbsp;endOfTime&nbsp;is&nbsp;the&nbsp;time&nbsp;when&nbsp;session&nbsp;(non-persistent)&nbsp;cookies&nbsp;expire.</span><br>
<span class="lineno">435</span><span class="comment" id="3304860">//&nbsp;This&nbsp;instant&nbsp;is&nbsp;representable&nbsp;in&nbsp;most&nbsp;date/time&nbsp;formats&nbsp;(not&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="3304929">//&nbsp;Go&#39;s&nbsp;time.Time)&nbsp;and&nbsp;should&nbsp;be&nbsp;far&nbsp;enough&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="keyword" id="3304988">var</span>&nbsp;<span class="ident" id="3304992">endOfTime</span>&nbsp;<span class="op" id="3305002">=</span>&nbsp;<span class="ident" id="3305004"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3305008">.</span><span class="ident" id="3305009">Date</span><span class="op" id="3305013">(</span><span class="num" id="3305014">9999</span><span class="op" id="3305018">,</span>&nbsp;<span class="num" id="3305020">12</span><span class="op" id="3305022">,</span>&nbsp;<span class="num" id="3305024">31</span><span class="op" id="3305026">,</span>&nbsp;<span class="num" id="3305028">23</span><span class="op" id="3305030">,</span>&nbsp;<span class="num" id="3305032">59</span><span class="op" id="3305034">,</span>&nbsp;<span class="num" id="3305036">59</span><span class="op" id="3305038">,</span>&nbsp;<span class="num" id="3305040">0</span><span class="op" id="3305041">,</span>&nbsp;<span class="ident" id="3305043"><a href="/net/http/cookiejar/jar.go.html#3293913">time</a></span><span class="op" id="3305047">.</span><span class="ident" id="3305048">UTC</span><span class="op" id="3305051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3305054">//&nbsp;domainAndType&nbsp;determines&nbsp;the&nbsp;cookie&#39;s&nbsp;domain&nbsp;and&nbsp;hostOnly&nbsp;attribute.</span><br>
<span class="lineno">440</span><span class="keyword" id="3305126">func</span>&nbsp;<span class="op" id="3305131">(</span><span class="ident" id="3305132">j</span>&nbsp;<span class="op" id="3305134">*</span><span class="ident" id="3305135"><a href="/net/http/cookiejar/jar.go.html#3295532">Jar</a></span><span class="op" id="3305138">)</span>&nbsp;<span class="ident" id="3305140">domainAndType</span><span class="op" id="3305153">(</span><span class="ident" id="3305154">host</span><span class="op" id="3305158">,</span>&nbsp;<span class="ident" id="3305160">domain</span>&nbsp;<span class="builtintype" id="3305167">string</span><span class="op" id="3305173">)</span>&nbsp;<span class="op" id="3305175">(</span><span class="builtintype" id="3305176">string</span><span class="op" id="3305182">,</span>&nbsp;<span class="builtintype" id="3305184">bool</span><span class="op" id="3305188">,</span>&nbsp;<span class="builtintype" id="3305190">error</span><span class="op" id="3305195">)</span>&nbsp;<span class="op" id="3305197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305200">if</span>&nbsp;<span class="ident" id="3305203"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span>&nbsp;<span class="op" id="3305210">==</span>&nbsp;<span class="string" id="3305213">&#34;&#34;</span>&nbsp;<span class="op" id="3305216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305220">//&nbsp;No&nbsp;domain&nbsp;attribute&nbsp;in&nbsp;the&nbsp;SetCookie&nbsp;header&nbsp;indicates&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305281">//&nbsp;host&nbsp;cookie.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305299">return</span>&nbsp;<span class="ident" id="3305306"><a href="/net/http/cookiejar/jar.go.html#3305154">host</a></span><span class="op" id="3305310">,</span>&nbsp;<span class="builtintype" id="3305312">true</span><span class="op" id="3305316">,</span>&nbsp;<span class="ident" id="3305318">nil</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305327">if</span>&nbsp;<span class="ident" id="3305330"><a href="/net/http/cookiejar/jar.go.html#3302712">isIP</a></span><span class="op" id="3305334">(</span><span class="ident" id="3305335"><a href="/net/http/cookiejar/jar.go.html#3305154">host</a></span><span class="op" id="3305339">)</span>&nbsp;<span class="op" id="3305341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305345">//&nbsp;According&nbsp;to&nbsp;RFC&nbsp;6265&nbsp;domain-matching&nbsp;includes&nbsp;not&nbsp;being</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305407">//&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305427">//&nbsp;TODO:&nbsp;This&nbsp;might&nbsp;be&nbsp;relaxed&nbsp;as&nbsp;in&nbsp;common&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305483">return</span>&nbsp;<span class="string" id="3305490">&#34;&#34;</span><span class="op" id="3305492">,</span>&nbsp;<span class="builtintype" id="3305494">false</span><span class="op" id="3305499">,</span>&nbsp;<span class="ident" id="3305501"><a href="/net/http/cookiejar/jar.go.html#3304707">errNoHostname</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305520">//&nbsp;From&nbsp;here&nbsp;on:&nbsp;If&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid,&nbsp;it&nbsp;is&nbsp;a&nbsp;domain&nbsp;cookie&nbsp;(with</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305590">//&nbsp;the&nbsp;one&nbsp;exception&nbsp;of&nbsp;a&nbsp;public&nbsp;suffix&nbsp;below).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305639">//&nbsp;See&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.2.3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305671">if</span>&nbsp;<span class="ident" id="3305674"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305680">[</span><span class="num" id="3305681">0</span><span class="op" id="3305682">]</span>&nbsp;<span class="op" id="3305684">==</span>&nbsp;<span class="string" id="3305687">&#39;.&#39;</span>&nbsp;<span class="op" id="3305691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305695"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span>&nbsp;<span class="op" id="3305702">=</span>&nbsp;<span class="ident" id="3305704"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305710">[</span><span class="num" id="3305711">1</span><span class="op" id="3305712">:</span><span class="op" id="3305713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305716">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305720">if</span>&nbsp;<span class="builtinfunc" id="3305723">len</span><span class="op" id="3305726">(</span><span class="ident" id="3305727"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305733">)</span>&nbsp;<span class="op" id="3305735">==</span>&nbsp;<span class="num" id="3305738">0</span>&nbsp;<span class="op" id="3305740">||</span>&nbsp;<span class="ident" id="3305743"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305749">[</span><span class="num" id="3305750">0</span><span class="op" id="3305751">]</span>&nbsp;<span class="op" id="3305753">==</span>&nbsp;<span class="string" id="3305756">&#39;.&#39;</span>&nbsp;<span class="op" id="3305760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305764">//&nbsp;Received&nbsp;either&nbsp;&#34;Domain=.&#34;&nbsp;or&nbsp;&#34;Domain=..some.thing&#34;,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305822">//&nbsp;both&nbsp;are&nbsp;illegal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305845">return</span>&nbsp;<span class="string" id="3305852">&#34;&#34;</span><span class="op" id="3305854">,</span>&nbsp;<span class="builtintype" id="3305856">false</span><span class="op" id="3305861">,</span>&nbsp;<span class="ident" id="3305863"><a href="/net/http/cookiejar/jar.go.html#3304626">errMalformedDomain</a></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305886"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span>&nbsp;<span class="op" id="3305893">=</span>&nbsp;<span class="ident" id="3305895"><a href="/net/http/cookiejar/jar.go.html#3293894">strings</a></span><span class="op" id="3305902">.</span><span class="ident" id="3305903">ToLower</span><span class="op" id="3305910">(</span><span class="ident" id="3305911"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305921">if</span>&nbsp;<span class="ident" id="3305924"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305930">[</span><span class="builtinfunc" id="3305931">len</span><span class="op" id="3305934">(</span><span class="ident" id="3305935"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3305941">)</span><span class="op" id="3305942">-</span><span class="num" id="3305943">1</span><span class="op" id="3305944">]</span>&nbsp;<span class="op" id="3305946">==</span>&nbsp;<span class="string" id="3305949">&#39;.&#39;</span>&nbsp;<span class="op" id="3305953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3305957">//&nbsp;We&nbsp;received&nbsp;stuff&nbsp;like&nbsp;&#34;Domain=www.example.com.&#34;.</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306012">//&nbsp;Browsers&nbsp;do&nbsp;handle&nbsp;such&nbsp;stuff&nbsp;(actually&nbsp;differently)&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306074">//&nbsp;RFC&nbsp;6265&nbsp;seems&nbsp;to&nbsp;be&nbsp;clear&nbsp;here&nbsp;(e.g.&nbsp;section&nbsp;4.1.2.3)&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306137">//&nbsp;requiring&nbsp;a&nbsp;reject.&nbsp;&nbsp;4.1.2.3&nbsp;is&nbsp;not&nbsp;normative,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306193">//&nbsp;&#34;Domain&nbsp;Matching&#34;&nbsp;(5.1.3)&nbsp;and&nbsp;&#34;Canonicalized&nbsp;Host&nbsp;Names&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306255">//&nbsp;(5.1.2)&nbsp;are.</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306273">return</span>&nbsp;<span class="string" id="3306280">&#34;&#34;</span><span class="op" id="3306282">,</span>&nbsp;<span class="builtintype" id="3306284">false</span><span class="op" id="3306289">,</span>&nbsp;<span class="ident" id="3306291"><a href="/net/http/cookiejar/jar.go.html#3304626">errMalformedDomain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306315">//&nbsp;See&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.3&nbsp;#5.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306348">if</span>&nbsp;<span class="ident" id="3306351"><a href="/net/http/cookiejar/jar.go.html#3305132">j</a></span><span class="op" id="3306352">.</span><span class="ident" id="3306353">psList</span>&nbsp;<span class="op" id="3306360">!=</span>&nbsp;<span class="ident" id="3306363">nil</span>&nbsp;<span class="op" id="3306367">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306371">if</span>&nbsp;<span class="ident" id="3306374">ps</span>&nbsp;<span class="op" id="3306377">:=</span>&nbsp;<span class="ident" id="3306380"><a href="/net/http/cookiejar/jar.go.html#3305132">j</a></span><span class="op" id="3306381">.</span><span class="ident" id="3306382">psList</span><span class="op" id="3306388">.</span><span class="ident" id="3306389">PublicSuffix</span><span class="op" id="3306401">(</span><span class="ident" id="3306402"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3306408">)</span><span class="op" id="3306409">;</span>&nbsp;<span class="ident" id="3306411"><a href="/net/http/cookiejar/jar.go.html#3306374">ps</a></span>&nbsp;<span class="op" id="3306414">!=</span>&nbsp;<span class="string" id="3306417">&#34;&#34;</span>&nbsp;<span class="op" id="3306420">&amp;&amp;</span>&nbsp;<span class="op" id="3306423">!</span><span class="ident" id="3306424"><a href="/net/http/cookiejar/jar.go.html#3297905">hasDotSuffix</a></span><span class="op" id="3306436">(</span><span class="ident" id="3306437"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3306443">,</span>&nbsp;<span class="ident" id="3306445"><a href="/net/http/cookiejar/jar.go.html#3306374">ps</a></span><span class="op" id="3306447">)</span>&nbsp;<span class="op" id="3306449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306454">if</span>&nbsp;<span class="ident" id="3306457"><a href="/net/http/cookiejar/jar.go.html#3305154">host</a></span>&nbsp;<span class="op" id="3306462">==</span>&nbsp;<span class="ident" id="3306465"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span>&nbsp;<span class="op" id="3306472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306478">//&nbsp;This&nbsp;is&nbsp;the&nbsp;one&nbsp;exception&nbsp;in&nbsp;which&nbsp;a&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306529">//&nbsp;with&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;is&nbsp;a&nbsp;host&nbsp;cookie.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306578">return</span>&nbsp;<span class="ident" id="3306585"><a href="/net/http/cookiejar/jar.go.html#3305154">host</a></span><span class="op" id="3306589">,</span>&nbsp;<span class="builtintype" id="3306591">true</span><span class="op" id="3306595">,</span>&nbsp;<span class="ident" id="3306597">nil</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306609">return</span>&nbsp;<span class="string" id="3306616">&#34;&#34;</span><span class="op" id="3306618">,</span>&nbsp;<span class="builtintype" id="3306620">false</span><span class="op" id="3306625">,</span>&nbsp;<span class="ident" id="3306627"><a href="/net/http/cookiejar/jar.go.html#3304547">errIllegalDomain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306653">//&nbsp;The&nbsp;domain&nbsp;must&nbsp;domain-match&nbsp;host:&nbsp;www.mycompany.com&nbsp;cannot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306717">//&nbsp;set&nbsp;cookies&nbsp;for&nbsp;.ourcompetitors.com.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306758">if</span>&nbsp;<span class="ident" id="3306761"><a href="/net/http/cookiejar/jar.go.html#3305154">host</a></span>&nbsp;<span class="op" id="3306766">!=</span>&nbsp;<span class="ident" id="3306769"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span>&nbsp;<span class="op" id="3306776">&amp;&amp;</span>&nbsp;<span class="op" id="3306779">!</span><span class="ident" id="3306780"><a href="/net/http/cookiejar/jar.go.html#3297905">hasDotSuffix</a></span><span class="op" id="3306792">(</span><span class="ident" id="3306793"><a href="/net/http/cookiejar/jar.go.html#3305154">host</a></span><span class="op" id="3306797">,</span>&nbsp;<span class="ident" id="3306799"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3306805">)</span>&nbsp;<span class="op" id="3306807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306811">return</span>&nbsp;<span class="string" id="3306818">&#34;&#34;</span><span class="op" id="3306820">,</span>&nbsp;<span class="builtintype" id="3306822">false</span><span class="op" id="3306827">,</span>&nbsp;<span class="ident" id="3306829"><a href="/net/http/cookiejar/jar.go.html#3304547">errIllegalDomain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306847">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306851">return</span>&nbsp;<span class="ident" id="3306858"><a href="/net/http/cookiejar/jar.go.html#3305160">domain</a></span><span class="op" id="3306864">,</span>&nbsp;<span class="builtintype" id="3306866">false</span><span class="op" id="3306871">,</span>&nbsp;<span class="ident" id="3306873">nil</span><br>
<span class="lineno"></span><span class="op" id="3306877">}</span>
</div>
</body>
</html>
