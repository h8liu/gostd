<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html" class="current">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2670236">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2670291">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2670345">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2670396">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2670469">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2670549">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2670625">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2670666">//</span><br>
<span class="lineno">10</span><span class="comment" id="2670669">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2670738">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2670805">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2670823">//</span><br>
<span class="lineno"></span><span class="comment" id="2670826">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2670899">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2670957">package</span>&nbsp;<span class="ident" id="2670965">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2670974">import</span>&nbsp;<span class="op" id="2670981">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2670984">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2670995">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2671006">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2671014">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2671023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2671026">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2671070">//</span><br>
<span class="lineno"></span><span class="comment" id="2671073">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2671136">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2671195">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2671254">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2671306">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2671368">type</span>&nbsp;<span class="ident" id="2671373">Type</span>&nbsp;<span class="keyword" id="2671378">interface</span>&nbsp;<span class="op" id="2671388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671391">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671429">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671484">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671524">Align</span><span class="op" id="2671529">(</span><span class="op" id="2671530">)</span>&nbsp;<span class="builtintype" id="2671532">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671538">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671598">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671646">FieldAlign</span><span class="op" id="2671656">(</span><span class="op" id="2671657">)</span>&nbsp;<span class="builtintype" id="2671659">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671665">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671726">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671783">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671787">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671861">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671930">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671934">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672004">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672073">Method</span><span class="op" id="2672079">(</span><span class="builtintype" id="2672080">int</span><span class="op" id="2672083">)</span>&nbsp;<span class="ident" id="2672085">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672094">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672159">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672224">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672228">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672302">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672371">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672375">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672445">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672514">MethodByName</span><span class="op" id="2672526">(</span><span class="builtintype" id="2672527">string</span><span class="op" id="2672533">)</span>&nbsp;<span class="op" id="2672535">(</span><span class="ident" id="2672536">Method</span><span class="op" id="2672542">,</span>&nbsp;<span class="builtintype" id="2672544">bool</span><span class="op" id="2672548">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672552">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672622">NumMethod</span><span class="op" id="2672631">(</span><span class="op" id="2672632">)</span>&nbsp;<span class="builtintype" id="2672634">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672640">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672693">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672743">Name</span><span class="op" id="2672747">(</span><span class="op" id="2672748">)</span>&nbsp;<span class="builtintype" id="2672750">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672759">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672833">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672902">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2672984">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673031">PkgPath</span><span class="op" id="2673038">(</span><span class="op" id="2673039">)</span>&nbsp;<span class="builtintype" id="2673041">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673050">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673103">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673168">Size</span><span class="op" id="2673172">(</span><span class="op" id="2673173">)</span>&nbsp;<span class="builtintype" id="2673175">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673185">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673241">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673303">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673362">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673426">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673458">String</span><span class="op" id="2673464">(</span><span class="op" id="2673465">)</span>&nbsp;<span class="builtintype" id="2673467">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673476">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673525">Kind</span><span class="op" id="2673529">(</span><span class="op" id="2673530">)</span>&nbsp;<span class="ident" id="2673532">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673539">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673612">Implements</span><span class="op" id="2673622">(</span><span class="ident" id="2673623">u</span>&nbsp;<span class="ident" id="2673625">Type</span><span class="op" id="2673629">)</span>&nbsp;<span class="builtintype" id="2673631">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673638">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673716">AssignableTo</span><span class="op" id="2673728">(</span><span class="ident" id="2673729">u</span>&nbsp;<span class="ident" id="2673731">Type</span><span class="op" id="2673735">)</span>&nbsp;<span class="builtintype" id="2673737">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673744">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673824">ConvertibleTo</span><span class="op" id="2673837">(</span><span class="ident" id="2673838">u</span>&nbsp;<span class="ident" id="2673840">Type</span><span class="op" id="2673844">)</span>&nbsp;<span class="builtintype" id="2673846">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673853">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673920">Comparable</span><span class="op" id="2673930">(</span><span class="op" id="2673931">)</span>&nbsp;<span class="builtintype" id="2673933">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673940">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674002">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674045">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674049">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674089">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674110">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674134">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674180">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674199">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674213">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674229">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674302">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674349">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674400">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674457">Bits</span><span class="op" id="2674461">(</span><span class="op" id="2674462">)</span>&nbsp;<span class="builtintype" id="2674464">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674470">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674518">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674564">ChanDir</span><span class="op" id="2674571">(</span><span class="op" id="2674572">)</span>&nbsp;<span class="ident" id="2674574">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674584">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674655">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674733">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674763">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674767">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674838">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674842">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674861">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674903">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674951">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674978">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674982">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675036">IsVariadic</span><span class="op" id="2675046">(</span><span class="op" id="2675047">)</span>&nbsp;<span class="builtintype" id="2675049">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675056">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675096">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675169">Elem</span><span class="op" id="2675173">(</span><span class="op" id="2675174">)</span>&nbsp;<span class="ident" id="2675176">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675183">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675229">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675277">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675333">Field</span><span class="op" id="2675338">(</span><span class="ident" id="2675339">i</span>&nbsp;<span class="builtintype" id="2675341">int</span><span class="op" id="2675344">)</span>&nbsp;<span class="ident" id="2675346">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675360">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675416">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675478">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675513">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675561">FieldByIndex</span><span class="op" id="2675573">(</span><span class="ident" id="2675574">index</span>&nbsp;<span class="op" id="2675580">[</span><span class="op" id="2675581">]</span><span class="builtintype" id="2675582">int</span><span class="op" id="2675585">)</span>&nbsp;<span class="ident" id="2675587">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675601">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675662">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675715">FieldByName</span><span class="op" id="2675726">(</span><span class="ident" id="2675727">name</span>&nbsp;<span class="builtintype" id="2675732">string</span><span class="op" id="2675738">)</span>&nbsp;<span class="op" id="2675740">(</span><span class="ident" id="2675741">StructField</span><span class="op" id="2675752">,</span>&nbsp;<span class="builtintype" id="2675754">bool</span><span class="op" id="2675758">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675762">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675825">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675891">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675916">FieldByNameFunc</span><span class="op" id="2675931">(</span><span class="ident" id="2675932">match</span>&nbsp;<span class="keyword" id="2675938">func</span><span class="op" id="2675942">(</span><span class="builtintype" id="2675943">string</span><span class="op" id="2675949">)</span>&nbsp;<span class="builtintype" id="2675951">bool</span><span class="op" id="2675955">)</span>&nbsp;<span class="op" id="2675957">(</span><span class="ident" id="2675958">StructField</span><span class="op" id="2675969">,</span>&nbsp;<span class="builtintype" id="2675971">bool</span><span class="op" id="2675975">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2675979">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676046">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676092">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676145">In</span><span class="op" id="2676147">(</span><span class="ident" id="2676148">i</span>&nbsp;<span class="builtintype" id="2676150">int</span><span class="op" id="2676153">)</span>&nbsp;<span class="ident" id="2676155">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676162">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676201">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676246">Key</span><span class="op" id="2676249">(</span><span class="op" id="2676250">)</span>&nbsp;<span class="ident" id="2676252">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676259">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676299">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676346">Len</span><span class="op" id="2676349">(</span><span class="op" id="2676350">)</span>&nbsp;<span class="builtintype" id="2676352">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676358">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676408">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676456">NumField</span><span class="op" id="2676464">(</span><span class="op" id="2676465">)</span>&nbsp;<span class="builtintype" id="2676467">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676473">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676532">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676578">NumIn</span><span class="op" id="2676583">(</span><span class="op" id="2676584">)</span>&nbsp;<span class="builtintype" id="2676586">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676592">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676653">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676699">NumOut</span><span class="op" id="2676705">(</span><span class="op" id="2676706">)</span>&nbsp;<span class="builtintype" id="2676708">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676714">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676783">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2676829">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676883">Out</span><span class="op" id="2676886">(</span><span class="ident" id="2676887">i</span>&nbsp;<span class="builtintype" id="2676889">int</span><span class="op" id="2676892">)</span>&nbsp;<span class="ident" id="2676894">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676901">common</span><span class="op" id="2676907">(</span><span class="op" id="2676908">)</span>&nbsp;<span class="op" id="2676910">*</span><span class="ident" id="2676911">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676918">uncommon</span><span class="op" id="2676926">(</span><span class="op" id="2676927">)</span>&nbsp;<span class="op" id="2676929">*</span><span class="ident" id="2676930">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2676943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2676946">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2677033">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2677106">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2677183">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2677255">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2677318">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2677405">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2677453">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2677648">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2677719">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2677757">type</span>&nbsp;<span class="ident" id="2677762">Kind</span>&nbsp;<span class="builtintype" id="2677767">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2677773">const</span>&nbsp;<span class="op" id="2677779">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677782">Invalid</span>&nbsp;<span class="ident" id="2677790">Kind</span>&nbsp;<span class="op" id="2677795">=</span>&nbsp;<span class="ident" id="2677797">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677803">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677809">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677814">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677820">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677827">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677834">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677841">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677847">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677854">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677862">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677870">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677878">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677887">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677896">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677905">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677916">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677928">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677935">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677941">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677947">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677958">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677963">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677968">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677975">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677983">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677991">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2678005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2678008">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2678062">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2678122">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2678185">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2678251">type</span>&nbsp;<span class="ident" id="2678256">rtype</span>&nbsp;<span class="keyword" id="2678262">struct</span>&nbsp;<span class="op" id="2678269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678272">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678286">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678295">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678309">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678327">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678379">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678393">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678411">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678430">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678444">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678462">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678503">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678517">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678535">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678580">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678594">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678612">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678634">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2678648">*</span><span class="ident" id="2678649">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678666">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678714">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2678728">[</span><span class="num" id="2678729">2</span><span class="op" id="2678730">]</span><span class="ident" id="2678731">unsafe</span><span class="op" id="2678737">.</span><span class="ident" id="2678738">Pointer</span>&nbsp;<span class="comment" id="2678746">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2678774">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2678788">*</span><span class="builtintype" id="2678789">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678806">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678857">*</span><span class="ident" id="2678858">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678889">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678922">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2678936">*</span><span class="ident" id="2678937">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678954">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679022">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679036">unsafe</span><span class="op" id="2679042">.</span><span class="ident" id="2679043">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679054">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2679079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679082">type</span>&nbsp;<span class="ident" id="2679087">typeAlg</span>&nbsp;<span class="keyword" id="2679095">struct</span>&nbsp;<span class="op" id="2679102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679105">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679151">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679191">hash</span>&nbsp;<span class="keyword" id="2679196">func</span><span class="op" id="2679200">(</span><span class="ident" id="2679201">unsafe</span><span class="op" id="2679207">.</span><span class="ident" id="2679208">Pointer</span><span class="op" id="2679215">,</span>&nbsp;<span class="builtintype" id="2679217">uintptr</span><span class="op" id="2679224">,</span>&nbsp;<span class="builtintype" id="2679226">uintptr</span><span class="op" id="2679233">)</span>&nbsp;<span class="builtintype" id="2679235">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679244">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2679292">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679344">equal</span>&nbsp;<span class="keyword" id="2679350">func</span><span class="op" id="2679354">(</span><span class="ident" id="2679355">unsafe</span><span class="op" id="2679361">.</span><span class="ident" id="2679362">Pointer</span><span class="op" id="2679369">,</span>&nbsp;<span class="ident" id="2679371">unsafe</span><span class="op" id="2679377">.</span><span class="ident" id="2679378">Pointer</span><span class="op" id="2679385">,</span>&nbsp;<span class="builtintype" id="2679387">uintptr</span><span class="op" id="2679394">)</span>&nbsp;<span class="builtintype" id="2679396">bool</span><br>
<span class="lineno"></span><span class="op" id="2679401">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2679404">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2679436">type</span>&nbsp;<span class="ident" id="2679441">method</span>&nbsp;<span class="keyword" id="2679448">struct</span>&nbsp;<span class="op" id="2679455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679458">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2679466">*</span><span class="builtintype" id="2679467">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679481">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679500">pkgPath</span>&nbsp;<span class="op" id="2679508">*</span><span class="builtintype" id="2679509">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679523">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679573">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2679581">*</span><span class="ident" id="2679582">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679596">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679631">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2679639">*</span><span class="ident" id="2679640">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679654">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679698">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679706">unsafe</span><span class="op" id="2679712">.</span><span class="ident" id="2679713">Pointer</span>&nbsp;<span class="comment" id="2679721">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679771">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679779">unsafe</span><span class="op" id="2679785">.</span><span class="ident" id="2679786">Pointer</span>&nbsp;<span class="comment" id="2679794">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2679828">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2679831">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2679895">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2679967">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2680035">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2680083">type</span>&nbsp;<span class="ident" id="2680088">uncommonType</span>&nbsp;<span class="keyword" id="2680101">struct</span>&nbsp;<span class="op" id="2680108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680111">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2680119">*</span><span class="builtintype" id="2680120">string</span>&nbsp;&nbsp;<span class="comment" id="2680128">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680145">pkgPath</span>&nbsp;<span class="op" id="2680153">*</span><span class="builtintype" id="2680154">string</span>&nbsp;&nbsp;<span class="comment" id="2680162">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680219">methods</span>&nbsp;<span class="op" id="2680227">[</span><span class="op" id="2680228">]</span><span class="ident" id="2680229">method</span>&nbsp;<span class="comment" id="2680236">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2680268">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2680271">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2680321">type</span>&nbsp;<span class="ident" id="2680326">ChanDir</span>&nbsp;<span class="builtintype" id="2680334">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2680339">const</span>&nbsp;<span class="op" id="2680345">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680348">RecvDir</span>&nbsp;<span class="ident" id="2680356">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2680376">=</span>&nbsp;<span class="num" id="2680378">1</span>&nbsp;<span class="op" id="2680380">&lt;&lt;</span>&nbsp;<span class="ident" id="2680383">iota</span>&nbsp;<span class="comment" id="2680388">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680399">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680439">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680450">BothDir</span>&nbsp;<span class="op" id="2680458">=</span>&nbsp;<span class="ident" id="2680460">RecvDir</span>&nbsp;<span class="op" id="2680468">|</span>&nbsp;<span class="ident" id="2680470">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680490">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2680498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2680501">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2680545">type</span>&nbsp;<span class="ident" id="2680550">arrayType</span>&nbsp;<span class="keyword" id="2680560">struct</span>&nbsp;<span class="op" id="2680567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680570">rtype</span>&nbsp;<span class="string" id="2680576">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680595">elem</span>&nbsp;&nbsp;<span class="op" id="2680601">*</span><span class="ident" id="2680602">rtype</span>&nbsp;<span class="comment" id="2680608">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680631">slice</span>&nbsp;<span class="op" id="2680637">*</span><span class="ident" id="2680638">rtype</span>&nbsp;<span class="comment" id="2680644">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2680659">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2680665">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2680673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2680676">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2680715">type</span>&nbsp;<span class="ident" id="2680720">chanType</span>&nbsp;<span class="keyword" id="2680729">struct</span>&nbsp;<span class="op" id="2680736">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680739">rtype</span>&nbsp;<span class="string" id="2680745">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680763">elem</span>&nbsp;&nbsp;<span class="op" id="2680769">*</span><span class="ident" id="2680770">rtype</span>&nbsp;&nbsp;<span class="comment" id="2680777">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680802">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2680808">uintptr</span>&nbsp;<span class="comment" id="2680816">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2680847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2680850">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2680890">type</span>&nbsp;<span class="ident" id="2680895">funcType</span>&nbsp;<span class="keyword" id="2680904">struct</span>&nbsp;<span class="op" id="2680911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680914">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2680924">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680942">dotdotdot</span>&nbsp;<span class="builtintype" id="2680952">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680961">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680993">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681003">[</span><span class="op" id="2681004">]</span><span class="op" id="2681005">*</span><span class="ident" id="2681006">rtype</span>&nbsp;<span class="comment" id="2681012">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681038">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681048">[</span><span class="op" id="2681049">]</span><span class="op" id="2681050">*</span><span class="ident" id="2681051">rtype</span>&nbsp;<span class="comment" id="2681057">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2681083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2681086">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2681138">type</span>&nbsp;<span class="ident" id="2681143">imethod</span>&nbsp;<span class="keyword" id="2681151">struct</span>&nbsp;<span class="op" id="2681158">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681161">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681169">*</span><span class="builtintype" id="2681170">string</span>&nbsp;<span class="comment" id="2681177">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681196">pkgPath</span>&nbsp;<span class="op" id="2681204">*</span><span class="builtintype" id="2681205">string</span>&nbsp;<span class="comment" id="2681212">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681262">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681270">*</span><span class="ident" id="2681271">rtype</span>&nbsp;&nbsp;<span class="comment" id="2681278">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2681305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2681308">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2681355">type</span>&nbsp;<span class="ident" id="2681360">interfaceType</span>&nbsp;<span class="keyword" id="2681374">struct</span>&nbsp;<span class="op" id="2681381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681384">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2681392">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681415">methods</span>&nbsp;<span class="op" id="2681423">[</span><span class="op" id="2681424">]</span><span class="ident" id="2681425">imethod</span>&nbsp;<span class="comment" id="2681433">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2681451">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2681454">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2681488">type</span>&nbsp;<span class="ident" id="2681493">mapType</span>&nbsp;<span class="keyword" id="2681501">struct</span>&nbsp;<span class="op" id="2681508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681511">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2681525">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681542">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681556">*</span><span class="ident" id="2681557">rtype</span>&nbsp;<span class="comment" id="2681563">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681580">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681594">*</span><span class="ident" id="2681595">rtype</span>&nbsp;<span class="comment" id="2681601">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681630">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681644">*</span><span class="ident" id="2681645">rtype</span>&nbsp;<span class="comment" id="2681651">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681681">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2681695">*</span><span class="ident" id="2681696">rtype</span>&nbsp;<span class="comment" id="2681702">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681726">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2681740">uint8</span>&nbsp;&nbsp;<span class="comment" id="2681747">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681768">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2681782">uint8</span>&nbsp;&nbsp;<span class="comment" id="2681789">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681832">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2681846">uint8</span>&nbsp;&nbsp;<span class="comment" id="2681853">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681876">indirectvalue</span>&nbsp;<span class="builtintype" id="2681890">uint8</span>&nbsp;&nbsp;<span class="comment" id="2681897">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681944">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2681958">uint16</span>&nbsp;<span class="comment" id="2681965">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2681983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2681986">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2682024">type</span>&nbsp;<span class="ident" id="2682029">ptrType</span>&nbsp;<span class="keyword" id="2682037">struct</span>&nbsp;<span class="op" id="2682044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682047">rtype</span>&nbsp;<span class="string" id="2682053">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682070">elem</span>&nbsp;&nbsp;<span class="op" id="2682076">*</span><span class="ident" id="2682077">rtype</span>&nbsp;<span class="comment" id="2682083">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2682120">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2682123">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2682161">type</span>&nbsp;<span class="ident" id="2682166">sliceType</span>&nbsp;<span class="keyword" id="2682176">struct</span>&nbsp;<span class="op" id="2682183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682186">rtype</span>&nbsp;<span class="string" id="2682192">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682211">elem</span>&nbsp;&nbsp;<span class="op" id="2682217">*</span><span class="ident" id="2682218">rtype</span>&nbsp;<span class="comment" id="2682224">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2682246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2682249">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2682265">type</span>&nbsp;<span class="ident" id="2682270">structField</span>&nbsp;<span class="keyword" id="2682282">struct</span>&nbsp;<span class="op" id="2682289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682292">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682300">*</span><span class="builtintype" id="2682301">string</span>&nbsp;<span class="comment" id="2682308">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682336">pkgPath</span>&nbsp;<span class="op" id="2682344">*</span><span class="builtintype" id="2682345">string</span>&nbsp;<span class="comment" id="2682352">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682402">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682410">*</span><span class="ident" id="2682411">rtype</span>&nbsp;&nbsp;<span class="comment" id="2682418">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682436">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682444">*</span><span class="builtintype" id="2682445">string</span>&nbsp;<span class="comment" id="2682452">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682470">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2682478">uintptr</span>&nbsp;<span class="comment" id="2682486">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2682524">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2682527">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2682567">type</span>&nbsp;<span class="ident" id="2682572">structType</span>&nbsp;<span class="keyword" id="2682583">struct</span>&nbsp;<span class="op" id="2682590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682593">rtype</span>&nbsp;&nbsp;<span class="string" id="2682600">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682620">fields</span>&nbsp;<span class="op" id="2682627">[</span><span class="op" id="2682628">]</span><span class="ident" id="2682629">structField</span>&nbsp;<span class="comment" id="2682641">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2682661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2682664">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2682820">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2682858">type</span>&nbsp;<span class="ident" id="2682863">Method</span>&nbsp;<span class="keyword" id="2682870">struct</span>&nbsp;<span class="op" id="2682877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2682880">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2682909">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2682982">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683052">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683121">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2683142">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683203">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2683211">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683219">PkgPath</span>&nbsp;<span class="builtintype" id="2683227">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683236">Type</span>&nbsp;&nbsp;<span class="ident" id="2683242">Type</span>&nbsp;&nbsp;<span class="comment" id="2683248">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683264">Func</span>&nbsp;&nbsp;<span class="ident" id="2683270">Value</span>&nbsp;<span class="comment" id="2683276">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683317">Index</span>&nbsp;<span class="builtintype" id="2683323">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2683329">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2683354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683357">const</span>&nbsp;<span class="op" id="2683363">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683366">kindDirectIface</span>&nbsp;<span class="op" id="2683382">=</span>&nbsp;<span class="num" id="2683384">1</span>&nbsp;<span class="op" id="2683386">&lt;&lt;</span>&nbsp;<span class="num" id="2683389">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683392">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683408">=</span>&nbsp;<span class="num" id="2683410">1</span>&nbsp;<span class="op" id="2683412">&lt;&lt;</span>&nbsp;<span class="num" id="2683415">6</span>&nbsp;<span class="comment" id="2683417">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683450">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2683466">=</span>&nbsp;<span class="num" id="2683468">1</span>&nbsp;<span class="op" id="2683470">&lt;&lt;</span>&nbsp;<span class="num" id="2683473">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683476">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683492">=</span>&nbsp;<span class="op" id="2683494">(</span><span class="num" id="2683495">1</span>&nbsp;<span class="op" id="2683497">&lt;&lt;</span>&nbsp;<span class="num" id="2683500">5</span><span class="op" id="2683501">)</span>&nbsp;<span class="op" id="2683503">-</span>&nbsp;<span class="num" id="2683505">1</span><br>
<span class="lineno"></span><span class="op" id="2683507">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2683510">func</span>&nbsp;<span class="op" id="2683515">(</span><span class="ident" id="2683516">k</span>&nbsp;<span class="ident" id="2683518">Kind</span><span class="op" id="2683522">)</span>&nbsp;<span class="ident" id="2683524">String</span><span class="op" id="2683530">(</span><span class="op" id="2683531">)</span>&nbsp;<span class="builtintype" id="2683533">string</span>&nbsp;<span class="op" id="2683540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683543">if</span>&nbsp;<span class="builtintype" id="2683546">int</span><span class="op" id="2683549">(</span><span class="ident" id="2683550">k</span><span class="op" id="2683551">)</span>&nbsp;<span class="op" id="2683553">&lt;</span>&nbsp;<span class="builtinfunc" id="2683555">len</span><span class="op" id="2683558">(</span><span class="ident" id="2683559">kindNames</span><span class="op" id="2683568">)</span>&nbsp;<span class="op" id="2683570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683574">return</span>&nbsp;<span class="ident" id="2683581">kindNames</span><span class="op" id="2683590">[</span><span class="ident" id="2683591">k</span><span class="op" id="2683592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683598">return</span>&nbsp;<span class="string" id="2683605">&#34;kind&#34;</span>&nbsp;<span class="op" id="2683612">+</span>&nbsp;<span class="ident" id="2683614">strconv</span><span class="op" id="2683621">.</span><span class="ident" id="2683622">Itoa</span><span class="op" id="2683626">(</span><span class="builtintype" id="2683627">int</span><span class="op" id="2683630">(</span><span class="ident" id="2683631">k</span><span class="op" id="2683632">)</span><span class="op" id="2683633">)</span><br>
<span class="lineno">410</span><span class="op" id="2683635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683638">var</span>&nbsp;<span class="ident" id="2683642">kindNames</span>&nbsp;<span class="op" id="2683652">=</span>&nbsp;<span class="op" id="2683654">[</span><span class="op" id="2683655">]</span><span class="builtintype" id="2683656">string</span><span class="op" id="2683662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683665">Invalid</span><span class="op" id="2683672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683680">&#34;invalid&#34;</span><span class="op" id="2683689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683692">Bool</span><span class="op" id="2683696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683707">&#34;bool&#34;</span><span class="op" id="2683713">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683716">Int</span><span class="op" id="2683719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683731">&#34;int&#34;</span><span class="op" id="2683736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683739">Int8</span><span class="op" id="2683743">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683754">&#34;int8&#34;</span><span class="op" id="2683760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683763">Int16</span><span class="op" id="2683768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683778">&#34;int16&#34;</span><span class="op" id="2683785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683788">Int32</span><span class="op" id="2683793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683803">&#34;int32&#34;</span><span class="op" id="2683810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683813">Int64</span><span class="op" id="2683818">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683828">&#34;int64&#34;</span><span class="op" id="2683835">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683838">Uint</span><span class="op" id="2683842">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683853">&#34;uint&#34;</span><span class="op" id="2683859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683862">Uint8</span><span class="op" id="2683867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683877">&#34;uint8&#34;</span><span class="op" id="2683884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683887">Uint16</span><span class="op" id="2683893">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683902">&#34;uint16&#34;</span><span class="op" id="2683910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683913">Uint32</span><span class="op" id="2683919">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683928">&#34;uint32&#34;</span><span class="op" id="2683936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683939">Uint64</span><span class="op" id="2683945">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683954">&#34;uint64&#34;</span><span class="op" id="2683962">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683965">Uintptr</span><span class="op" id="2683972">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2683980">&#34;uintptr&#34;</span><span class="op" id="2683989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683992">Float32</span><span class="op" id="2683999">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684007">&#34;float32&#34;</span><span class="op" id="2684016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684019">Float64</span><span class="op" id="2684026">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684034">&#34;float64&#34;</span><span class="op" id="2684043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684046">Complex64</span><span class="op" id="2684055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684061">&#34;complex64&#34;</span><span class="op" id="2684072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684075">Complex128</span><span class="op" id="2684085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684090">&#34;complex128&#34;</span><span class="op" id="2684102">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684105">Array</span><span class="op" id="2684110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684120">&#34;array&#34;</span><span class="op" id="2684127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684130">Chan</span><span class="op" id="2684134">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684145">&#34;chan&#34;</span><span class="op" id="2684151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684154">Func</span><span class="op" id="2684158">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684169">&#34;func&#34;</span><span class="op" id="2684175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684178">Interface</span><span class="op" id="2684187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684193">&#34;interface&#34;</span><span class="op" id="2684204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684207">Map</span><span class="op" id="2684210">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684222">&#34;map&#34;</span><span class="op" id="2684227">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684230">Ptr</span><span class="op" id="2684233">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684245">&#34;ptr&#34;</span><span class="op" id="2684250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684253">Slice</span><span class="op" id="2684258">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684268">&#34;slice&#34;</span><span class="op" id="2684275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684278">String</span><span class="op" id="2684284">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684293">&#34;string&#34;</span><span class="op" id="2684301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684304">Struct</span><span class="op" id="2684310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684319">&#34;struct&#34;</span><span class="op" id="2684327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684330">UnsafePointer</span><span class="op" id="2684343">:</span>&nbsp;<span class="string" id="2684345">&#34;unsafe.Pointer&#34;</span><span class="op" id="2684361">,</span><br>
<span class="lineno">440</span><span class="op" id="2684363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684366">func</span>&nbsp;<span class="op" id="2684371">(</span><span class="ident" id="2684372">t</span>&nbsp;<span class="op" id="2684374">*</span><span class="ident" id="2684375">uncommonType</span><span class="op" id="2684387">)</span>&nbsp;<span class="ident" id="2684389">uncommon</span><span class="op" id="2684397">(</span><span class="op" id="2684398">)</span>&nbsp;<span class="op" id="2684400">*</span><span class="ident" id="2684401">uncommonType</span>&nbsp;<span class="op" id="2684414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684417">return</span>&nbsp;<span class="ident" id="2684424">t</span><br>
<span class="lineno"></span><span class="op" id="2684426">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2684429">func</span>&nbsp;<span class="op" id="2684434">(</span><span class="ident" id="2684435">t</span>&nbsp;<span class="op" id="2684437">*</span><span class="ident" id="2684438">uncommonType</span><span class="op" id="2684450">)</span>&nbsp;<span class="ident" id="2684452">PkgPath</span><span class="op" id="2684459">(</span><span class="op" id="2684460">)</span>&nbsp;<span class="builtintype" id="2684462">string</span>&nbsp;<span class="op" id="2684469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684472">if</span>&nbsp;<span class="ident" id="2684475">t</span>&nbsp;<span class="op" id="2684477">==</span>&nbsp;<span class="ident" id="2684480">nil</span>&nbsp;<span class="op" id="2684484">||</span>&nbsp;<span class="ident" id="2684487">t</span><span class="op" id="2684488">.</span><span class="ident" id="2684489">pkgPath</span>&nbsp;<span class="op" id="2684497">==</span>&nbsp;<span class="ident" id="2684500">nil</span>&nbsp;<span class="op" id="2684504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684508">return</span>&nbsp;<span class="string" id="2684515">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684519">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684522">return</span>&nbsp;<span class="op" id="2684529">*</span><span class="ident" id="2684530">t</span><span class="op" id="2684531">.</span><span class="ident" id="2684532">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2684540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684543">func</span>&nbsp;<span class="op" id="2684548">(</span><span class="ident" id="2684549">t</span>&nbsp;<span class="op" id="2684551">*</span><span class="ident" id="2684552">uncommonType</span><span class="op" id="2684564">)</span>&nbsp;<span class="ident" id="2684566">Name</span><span class="op" id="2684570">(</span><span class="op" id="2684571">)</span>&nbsp;<span class="builtintype" id="2684573">string</span>&nbsp;<span class="op" id="2684580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684583">if</span>&nbsp;<span class="ident" id="2684586">t</span>&nbsp;<span class="op" id="2684588">==</span>&nbsp;<span class="ident" id="2684591">nil</span>&nbsp;<span class="op" id="2684595">||</span>&nbsp;<span class="ident" id="2684598">t</span><span class="op" id="2684599">.</span><span class="ident" id="2684600">name</span>&nbsp;<span class="op" id="2684605">==</span>&nbsp;<span class="ident" id="2684608">nil</span>&nbsp;<span class="op" id="2684612">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684616">return</span>&nbsp;<span class="string" id="2684623">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684630">return</span>&nbsp;<span class="op" id="2684637">*</span><span class="ident" id="2684638">t</span><span class="op" id="2684639">.</span><span class="ident" id="2684640">name</span><br>
<span class="lineno"></span><span class="op" id="2684645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2684648">func</span>&nbsp;<span class="op" id="2684653">(</span><span class="ident" id="2684654">t</span>&nbsp;<span class="op" id="2684656">*</span><span class="ident" id="2684657">rtype</span><span class="op" id="2684662">)</span>&nbsp;<span class="ident" id="2684664">String</span><span class="op" id="2684670">(</span><span class="op" id="2684671">)</span>&nbsp;<span class="builtintype" id="2684673">string</span>&nbsp;<span class="op" id="2684680">{</span>&nbsp;<span class="keyword" id="2684682">return</span>&nbsp;<span class="op" id="2684689">*</span><span class="ident" id="2684690">t</span><span class="op" id="2684691">.</span><span class="builtintype" id="2684692">string</span>&nbsp;<span class="op" id="2684699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684702">func</span>&nbsp;<span class="op" id="2684707">(</span><span class="ident" id="2684708">t</span>&nbsp;<span class="op" id="2684710">*</span><span class="ident" id="2684711">rtype</span><span class="op" id="2684716">)</span>&nbsp;<span class="ident" id="2684718">Size</span><span class="op" id="2684722">(</span><span class="op" id="2684723">)</span>&nbsp;<span class="builtintype" id="2684725">uintptr</span>&nbsp;<span class="op" id="2684733">{</span>&nbsp;<span class="keyword" id="2684735">return</span>&nbsp;<span class="ident" id="2684742">t</span><span class="op" id="2684743">.</span><span class="ident" id="2684744">size</span>&nbsp;<span class="op" id="2684749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684752">func</span>&nbsp;<span class="op" id="2684757">(</span><span class="ident" id="2684758">t</span>&nbsp;<span class="op" id="2684760">*</span><span class="ident" id="2684761">rtype</span><span class="op" id="2684766">)</span>&nbsp;<span class="ident" id="2684768">Bits</span><span class="op" id="2684772">(</span><span class="op" id="2684773">)</span>&nbsp;<span class="builtintype" id="2684775">int</span>&nbsp;<span class="op" id="2684779">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684782">if</span>&nbsp;<span class="ident" id="2684785">t</span>&nbsp;<span class="op" id="2684787">==</span>&nbsp;<span class="ident" id="2684790">nil</span>&nbsp;<span class="op" id="2684794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2684798">panic</span><span class="op" id="2684803">(</span><span class="string" id="2684804">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2684831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684837">k</span>&nbsp;<span class="op" id="2684839">:=</span>&nbsp;<span class="ident" id="2684842">t</span><span class="op" id="2684843">.</span><span class="ident" id="2684844">Kind</span><span class="op" id="2684848">(</span><span class="op" id="2684849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684852">if</span>&nbsp;<span class="ident" id="2684855">k</span>&nbsp;<span class="op" id="2684857">&lt;</span>&nbsp;<span class="ident" id="2684859">Int</span>&nbsp;<span class="op" id="2684863">||</span>&nbsp;<span class="ident" id="2684866">k</span>&nbsp;<span class="op" id="2684868">&gt;</span>&nbsp;<span class="ident" id="2684870">Complex128</span>&nbsp;<span class="op" id="2684881">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2684885">panic</span><span class="op" id="2684890">(</span><span class="string" id="2684891">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2684931">+</span>&nbsp;<span class="ident" id="2684933">t</span><span class="op" id="2684934">.</span><span class="ident" id="2684935">String</span><span class="op" id="2684941">(</span><span class="op" id="2684942">)</span><span class="op" id="2684943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684949">return</span>&nbsp;<span class="builtintype" id="2684956">int</span><span class="op" id="2684959">(</span><span class="ident" id="2684960">t</span><span class="op" id="2684961">.</span><span class="ident" id="2684962">size</span><span class="op" id="2684966">)</span>&nbsp;<span class="op" id="2684968">*</span>&nbsp;<span class="num" id="2684970">8</span><br>
<span class="lineno"></span><span class="op" id="2684972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2684975">func</span>&nbsp;<span class="op" id="2684980">(</span><span class="ident" id="2684981">t</span>&nbsp;<span class="op" id="2684983">*</span><span class="ident" id="2684984">rtype</span><span class="op" id="2684989">)</span>&nbsp;<span class="ident" id="2684991">Align</span><span class="op" id="2684996">(</span><span class="op" id="2684997">)</span>&nbsp;<span class="builtintype" id="2684999">int</span>&nbsp;<span class="op" id="2685003">{</span>&nbsp;<span class="keyword" id="2685005">return</span>&nbsp;<span class="builtintype" id="2685012">int</span><span class="op" id="2685015">(</span><span class="ident" id="2685016">t</span><span class="op" id="2685017">.</span><span class="ident" id="2685018">align</span><span class="op" id="2685023">)</span>&nbsp;<span class="op" id="2685025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2685028">func</span>&nbsp;<span class="op" id="2685033">(</span><span class="ident" id="2685034">t</span>&nbsp;<span class="op" id="2685036">*</span><span class="ident" id="2685037">rtype</span><span class="op" id="2685042">)</span>&nbsp;<span class="ident" id="2685044">FieldAlign</span><span class="op" id="2685054">(</span><span class="op" id="2685055">)</span>&nbsp;<span class="builtintype" id="2685057">int</span>&nbsp;<span class="op" id="2685061">{</span>&nbsp;<span class="keyword" id="2685063">return</span>&nbsp;<span class="builtintype" id="2685070">int</span><span class="op" id="2685073">(</span><span class="ident" id="2685074">t</span><span class="op" id="2685075">.</span><span class="ident" id="2685076">fieldAlign</span><span class="op" id="2685086">)</span>&nbsp;<span class="op" id="2685088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2685091">func</span>&nbsp;<span class="op" id="2685096">(</span><span class="ident" id="2685097">t</span>&nbsp;<span class="op" id="2685099">*</span><span class="ident" id="2685100">rtype</span><span class="op" id="2685105">)</span>&nbsp;<span class="ident" id="2685107">Kind</span><span class="op" id="2685111">(</span><span class="op" id="2685112">)</span>&nbsp;<span class="ident" id="2685114">Kind</span>&nbsp;<span class="op" id="2685119">{</span>&nbsp;<span class="keyword" id="2685121">return</span>&nbsp;<span class="ident" id="2685128">Kind</span><span class="op" id="2685132">(</span><span class="ident" id="2685133">t</span><span class="op" id="2685134">.</span><span class="ident" id="2685135">kind</span>&nbsp;<span class="op" id="2685140">&amp;</span>&nbsp;<span class="ident" id="2685142">kindMask</span><span class="op" id="2685150">)</span>&nbsp;<span class="op" id="2685152">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2685155">func</span>&nbsp;<span class="op" id="2685160">(</span><span class="ident" id="2685161">t</span>&nbsp;<span class="op" id="2685163">*</span><span class="ident" id="2685164">rtype</span><span class="op" id="2685169">)</span>&nbsp;<span class="ident" id="2685171">pointers</span><span class="op" id="2685179">(</span><span class="op" id="2685180">)</span>&nbsp;<span class="builtintype" id="2685182">bool</span>&nbsp;<span class="op" id="2685187">{</span>&nbsp;<span class="keyword" id="2685189">return</span>&nbsp;<span class="ident" id="2685196">t</span><span class="op" id="2685197">.</span><span class="ident" id="2685198">kind</span><span class="op" id="2685202">&amp;</span><span class="ident" id="2685203">kindNoPointers</span>&nbsp;<span class="op" id="2685218">==</span>&nbsp;<span class="num" id="2685221">0</span>&nbsp;<span class="op" id="2685223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2685226">func</span>&nbsp;<span class="op" id="2685231">(</span><span class="ident" id="2685232">t</span>&nbsp;<span class="op" id="2685234">*</span><span class="ident" id="2685235">rtype</span><span class="op" id="2685240">)</span>&nbsp;<span class="ident" id="2685242">common</span><span class="op" id="2685248">(</span><span class="op" id="2685249">)</span>&nbsp;<span class="op" id="2685251">*</span><span class="ident" id="2685252">rtype</span>&nbsp;<span class="op" id="2685258">{</span>&nbsp;<span class="keyword" id="2685260">return</span>&nbsp;<span class="ident" id="2685267">t</span>&nbsp;<span class="op" id="2685269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2685272">func</span>&nbsp;<span class="op" id="2685277">(</span><span class="ident" id="2685278">t</span>&nbsp;<span class="op" id="2685280">*</span><span class="ident" id="2685281">uncommonType</span><span class="op" id="2685293">)</span>&nbsp;<span class="ident" id="2685295">Method</span><span class="op" id="2685301">(</span><span class="ident" id="2685302">i</span>&nbsp;<span class="builtintype" id="2685304">int</span><span class="op" id="2685307">)</span>&nbsp;<span class="op" id="2685309">(</span><span class="ident" id="2685310">m</span>&nbsp;<span class="ident" id="2685312">Method</span><span class="op" id="2685318">)</span>&nbsp;<span class="op" id="2685320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685323">if</span>&nbsp;<span class="ident" id="2685326">t</span>&nbsp;<span class="op" id="2685328">==</span>&nbsp;<span class="ident" id="2685331">nil</span>&nbsp;<span class="op" id="2685335">||</span>&nbsp;<span class="ident" id="2685338">i</span>&nbsp;<span class="op" id="2685340">&lt;</span>&nbsp;<span class="num" id="2685342">0</span>&nbsp;<span class="op" id="2685344">||</span>&nbsp;<span class="ident" id="2685347">i</span>&nbsp;<span class="op" id="2685349">&gt;=</span>&nbsp;<span class="builtinfunc" id="2685352">len</span><span class="op" id="2685355">(</span><span class="ident" id="2685356">t</span><span class="op" id="2685357">.</span><span class="ident" id="2685358">methods</span><span class="op" id="2685365">)</span>&nbsp;<span class="op" id="2685367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2685371">panic</span><span class="op" id="2685376">(</span><span class="string" id="2685377">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2685413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685419">p</span>&nbsp;<span class="op" id="2685421">:=</span>&nbsp;<span class="op" id="2685424">&amp;</span><span class="ident" id="2685425">t</span><span class="op" id="2685426">.</span><span class="ident" id="2685427">methods</span><span class="op" id="2685434">[</span><span class="ident" id="2685435">i</span><span class="op" id="2685436">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685439">if</span>&nbsp;<span class="ident" id="2685442">p</span><span class="op" id="2685443">.</span><span class="ident" id="2685444">name</span>&nbsp;<span class="op" id="2685449">!=</span>&nbsp;<span class="ident" id="2685452">nil</span>&nbsp;<span class="op" id="2685456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685460">m</span><span class="op" id="2685461">.</span><span class="ident" id="2685462">Name</span>&nbsp;<span class="op" id="2685467">=</span>&nbsp;<span class="op" id="2685469">*</span><span class="ident" id="2685470">p</span><span class="op" id="2685471">.</span><span class="ident" id="2685472">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685481">fl</span>&nbsp;<span class="op" id="2685484">:=</span>&nbsp;<span class="ident" id="2685487">flag</span><span class="op" id="2685491">(</span><span class="ident" id="2685492">Func</span><span class="op" id="2685496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685499">if</span>&nbsp;<span class="ident" id="2685502">p</span><span class="op" id="2685503">.</span><span class="ident" id="2685504">pkgPath</span>&nbsp;<span class="op" id="2685512">!=</span>&nbsp;<span class="ident" id="2685515">nil</span>&nbsp;<span class="op" id="2685519">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685523">m</span><span class="op" id="2685524">.</span><span class="ident" id="2685525">PkgPath</span>&nbsp;<span class="op" id="2685533">=</span>&nbsp;<span class="op" id="2685535">*</span><span class="ident" id="2685536">p</span><span class="op" id="2685537">.</span><span class="ident" id="2685538">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685548">fl</span>&nbsp;<span class="op" id="2685551">|=</span>&nbsp;<span class="ident" id="2685554">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685565">mt</span>&nbsp;<span class="op" id="2685568">:=</span>&nbsp;<span class="ident" id="2685571">p</span><span class="op" id="2685572">.</span><span class="ident" id="2685573">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685578">m</span><span class="op" id="2685579">.</span><span class="ident" id="2685580">Type</span>&nbsp;<span class="op" id="2685585">=</span>&nbsp;<span class="ident" id="2685587">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685591">fn</span>&nbsp;<span class="op" id="2685594">:=</span>&nbsp;<span class="ident" id="2685597">unsafe</span><span class="op" id="2685603">.</span><span class="ident" id="2685604">Pointer</span><span class="op" id="2685611">(</span><span class="op" id="2685612">&amp;</span><span class="ident" id="2685613">p</span><span class="op" id="2685614">.</span><span class="ident" id="2685615">tfn</span><span class="op" id="2685618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685621">m</span><span class="op" id="2685622">.</span><span class="ident" id="2685623">Func</span>&nbsp;<span class="op" id="2685628">=</span>&nbsp;<span class="ident" id="2685630">Value</span><span class="op" id="2685635">{</span><span class="ident" id="2685636">mt</span><span class="op" id="2685638">,</span>&nbsp;<span class="ident" id="2685640">fn</span><span class="op" id="2685642">,</span>&nbsp;<span class="ident" id="2685644">fl</span><span class="op" id="2685646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685649">m</span><span class="op" id="2685650">.</span><span class="ident" id="2685651">Index</span>&nbsp;<span class="op" id="2685657">=</span>&nbsp;<span class="ident" id="2685659">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685662">return</span><br>
<span class="lineno"></span><span class="op" id="2685669">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2685672">func</span>&nbsp;<span class="op" id="2685677">(</span><span class="ident" id="2685678">t</span>&nbsp;<span class="op" id="2685680">*</span><span class="ident" id="2685681">uncommonType</span><span class="op" id="2685693">)</span>&nbsp;<span class="ident" id="2685695">NumMethod</span><span class="op" id="2685704">(</span><span class="op" id="2685705">)</span>&nbsp;<span class="builtintype" id="2685707">int</span>&nbsp;<span class="op" id="2685711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685714">if</span>&nbsp;<span class="ident" id="2685717">t</span>&nbsp;<span class="op" id="2685719">==</span>&nbsp;<span class="ident" id="2685722">nil</span>&nbsp;<span class="op" id="2685726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685730">return</span>&nbsp;<span class="num" id="2685737">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685740">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685743">return</span>&nbsp;<span class="builtinfunc" id="2685750">len</span><span class="op" id="2685753">(</span><span class="ident" id="2685754">t</span><span class="op" id="2685755">.</span><span class="ident" id="2685756">methods</span><span class="op" id="2685763">)</span><br>
<span class="lineno"></span><span class="op" id="2685765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2685768">func</span>&nbsp;<span class="op" id="2685773">(</span><span class="ident" id="2685774">t</span>&nbsp;<span class="op" id="2685776">*</span><span class="ident" id="2685777">uncommonType</span><span class="op" id="2685789">)</span>&nbsp;<span class="ident" id="2685791">MethodByName</span><span class="op" id="2685803">(</span><span class="ident" id="2685804">name</span>&nbsp;<span class="builtintype" id="2685809">string</span><span class="op" id="2685815">)</span>&nbsp;<span class="op" id="2685817">(</span><span class="ident" id="2685818">m</span>&nbsp;<span class="ident" id="2685820">Method</span><span class="op" id="2685826">,</span>&nbsp;<span class="ident" id="2685828">ok</span>&nbsp;<span class="builtintype" id="2685831">bool</span><span class="op" id="2685835">)</span>&nbsp;<span class="op" id="2685837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685840">if</span>&nbsp;<span class="ident" id="2685843">t</span>&nbsp;<span class="op" id="2685845">==</span>&nbsp;<span class="ident" id="2685848">nil</span>&nbsp;<span class="op" id="2685852">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685856">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685867">var</span>&nbsp;<span class="ident" id="2685871">p</span>&nbsp;<span class="op" id="2685873">*</span><span class="ident" id="2685874">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685882">for</span>&nbsp;<span class="ident" id="2685886">i</span>&nbsp;<span class="op" id="2685888">:=</span>&nbsp;<span class="keyword" id="2685891">range</span>&nbsp;<span class="ident" id="2685897">t</span><span class="op" id="2685898">.</span><span class="ident" id="2685899">methods</span>&nbsp;<span class="op" id="2685907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685911">p</span>&nbsp;<span class="op" id="2685913">=</span>&nbsp;<span class="op" id="2685915">&amp;</span><span class="ident" id="2685916">t</span><span class="op" id="2685917">.</span><span class="ident" id="2685918">methods</span><span class="op" id="2685925">[</span><span class="ident" id="2685926">i</span><span class="op" id="2685927">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685931">if</span>&nbsp;<span class="ident" id="2685934">p</span><span class="op" id="2685935">.</span><span class="ident" id="2685936">name</span>&nbsp;<span class="op" id="2685941">!=</span>&nbsp;<span class="ident" id="2685944">nil</span>&nbsp;<span class="op" id="2685948">&amp;&amp;</span>&nbsp;<span class="op" id="2685951">*</span><span class="ident" id="2685952">p</span><span class="op" id="2685953">.</span><span class="ident" id="2685954">name</span>&nbsp;<span class="op" id="2685959">==</span>&nbsp;<span class="ident" id="2685962">name</span>&nbsp;<span class="op" id="2685967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685972">return</span>&nbsp;<span class="ident" id="2685979">t</span><span class="op" id="2685980">.</span><span class="ident" id="2685981">Method</span><span class="op" id="2685987">(</span><span class="ident" id="2685988">i</span><span class="op" id="2685989">)</span><span class="op" id="2685990">,</span>&nbsp;<span class="builtintype" id="2685992">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686005">return</span><br>
<span class="lineno">525</span><span class="op" id="2686012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686015">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2686065">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2686120">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2686158">func</span>&nbsp;<span class="op" id="2686163">(</span><span class="ident" id="2686164">t</span>&nbsp;<span class="op" id="2686166">*</span><span class="ident" id="2686167">rtype</span><span class="op" id="2686172">)</span>&nbsp;<span class="ident" id="2686174">NumMethod</span><span class="op" id="2686183">(</span><span class="op" id="2686184">)</span>&nbsp;<span class="builtintype" id="2686186">int</span>&nbsp;<span class="op" id="2686190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686193">if</span>&nbsp;<span class="ident" id="2686196">t</span><span class="op" id="2686197">.</span><span class="ident" id="2686198">Kind</span><span class="op" id="2686202">(</span><span class="op" id="2686203">)</span>&nbsp;<span class="op" id="2686205">==</span>&nbsp;<span class="ident" id="2686208">Interface</span>&nbsp;<span class="op" id="2686218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686222">tt</span>&nbsp;<span class="op" id="2686225">:=</span>&nbsp;<span class="op" id="2686228">(</span><span class="op" id="2686229">*</span><span class="ident" id="2686230">interfaceType</span><span class="op" id="2686243">)</span><span class="op" id="2686244">(</span><span class="ident" id="2686245">unsafe</span><span class="op" id="2686251">.</span><span class="ident" id="2686252">Pointer</span><span class="op" id="2686259">(</span><span class="ident" id="2686260">t</span><span class="op" id="2686261">)</span><span class="op" id="2686262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686266">return</span>&nbsp;<span class="ident" id="2686273">tt</span><span class="op" id="2686275">.</span><span class="ident" id="2686276">NumMethod</span><span class="op" id="2686285">(</span><span class="op" id="2686286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686289">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686292">return</span>&nbsp;<span class="ident" id="2686299">t</span><span class="op" id="2686300">.</span><span class="ident" id="2686301">uncommonType</span><span class="op" id="2686313">.</span><span class="ident" id="2686314">NumMethod</span><span class="op" id="2686323">(</span><span class="op" id="2686324">)</span><br>
<span class="lineno"></span><span class="op" id="2686326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2686329">func</span>&nbsp;<span class="op" id="2686334">(</span><span class="ident" id="2686335">t</span>&nbsp;<span class="op" id="2686337">*</span><span class="ident" id="2686338">rtype</span><span class="op" id="2686343">)</span>&nbsp;<span class="ident" id="2686345">Method</span><span class="op" id="2686351">(</span><span class="ident" id="2686352">i</span>&nbsp;<span class="builtintype" id="2686354">int</span><span class="op" id="2686357">)</span>&nbsp;<span class="op" id="2686359">(</span><span class="ident" id="2686360">m</span>&nbsp;<span class="ident" id="2686362">Method</span><span class="op" id="2686368">)</span>&nbsp;<span class="op" id="2686370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686373">if</span>&nbsp;<span class="ident" id="2686376">t</span><span class="op" id="2686377">.</span><span class="ident" id="2686378">Kind</span><span class="op" id="2686382">(</span><span class="op" id="2686383">)</span>&nbsp;<span class="op" id="2686385">==</span>&nbsp;<span class="ident" id="2686388">Interface</span>&nbsp;<span class="op" id="2686398">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686402">tt</span>&nbsp;<span class="op" id="2686405">:=</span>&nbsp;<span class="op" id="2686408">(</span><span class="op" id="2686409">*</span><span class="ident" id="2686410">interfaceType</span><span class="op" id="2686423">)</span><span class="op" id="2686424">(</span><span class="ident" id="2686425">unsafe</span><span class="op" id="2686431">.</span><span class="ident" id="2686432">Pointer</span><span class="op" id="2686439">(</span><span class="ident" id="2686440">t</span><span class="op" id="2686441">)</span><span class="op" id="2686442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686446">return</span>&nbsp;<span class="ident" id="2686453">tt</span><span class="op" id="2686455">.</span><span class="ident" id="2686456">Method</span><span class="op" id="2686462">(</span><span class="ident" id="2686463">i</span><span class="op" id="2686464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686470">return</span>&nbsp;<span class="ident" id="2686477">t</span><span class="op" id="2686478">.</span><span class="ident" id="2686479">uncommonType</span><span class="op" id="2686491">.</span><span class="ident" id="2686492">Method</span><span class="op" id="2686498">(</span><span class="ident" id="2686499">i</span><span class="op" id="2686500">)</span><br>
<span class="lineno"></span><span class="op" id="2686502">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2686505">func</span>&nbsp;<span class="op" id="2686510">(</span><span class="ident" id="2686511">t</span>&nbsp;<span class="op" id="2686513">*</span><span class="ident" id="2686514">rtype</span><span class="op" id="2686519">)</span>&nbsp;<span class="ident" id="2686521">MethodByName</span><span class="op" id="2686533">(</span><span class="ident" id="2686534">name</span>&nbsp;<span class="builtintype" id="2686539">string</span><span class="op" id="2686545">)</span>&nbsp;<span class="op" id="2686547">(</span><span class="ident" id="2686548">m</span>&nbsp;<span class="ident" id="2686550">Method</span><span class="op" id="2686556">,</span>&nbsp;<span class="ident" id="2686558">ok</span>&nbsp;<span class="builtintype" id="2686561">bool</span><span class="op" id="2686565">)</span>&nbsp;<span class="op" id="2686567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686570">if</span>&nbsp;<span class="ident" id="2686573">t</span><span class="op" id="2686574">.</span><span class="ident" id="2686575">Kind</span><span class="op" id="2686579">(</span><span class="op" id="2686580">)</span>&nbsp;<span class="op" id="2686582">==</span>&nbsp;<span class="ident" id="2686585">Interface</span>&nbsp;<span class="op" id="2686595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686599">tt</span>&nbsp;<span class="op" id="2686602">:=</span>&nbsp;<span class="op" id="2686605">(</span><span class="op" id="2686606">*</span><span class="ident" id="2686607">interfaceType</span><span class="op" id="2686620">)</span><span class="op" id="2686621">(</span><span class="ident" id="2686622">unsafe</span><span class="op" id="2686628">.</span><span class="ident" id="2686629">Pointer</span><span class="op" id="2686636">(</span><span class="ident" id="2686637">t</span><span class="op" id="2686638">)</span><span class="op" id="2686639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686643">return</span>&nbsp;<span class="ident" id="2686650">tt</span><span class="op" id="2686652">.</span><span class="ident" id="2686653">MethodByName</span><span class="op" id="2686665">(</span><span class="ident" id="2686666">name</span><span class="op" id="2686670">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686676">return</span>&nbsp;<span class="ident" id="2686683">t</span><span class="op" id="2686684">.</span><span class="ident" id="2686685">uncommonType</span><span class="op" id="2686697">.</span><span class="ident" id="2686698">MethodByName</span><span class="op" id="2686710">(</span><span class="ident" id="2686711">name</span><span class="op" id="2686715">)</span><br>
<span class="lineno"></span><span class="op" id="2686717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2686720">func</span>&nbsp;<span class="op" id="2686725">(</span><span class="ident" id="2686726">t</span>&nbsp;<span class="op" id="2686728">*</span><span class="ident" id="2686729">rtype</span><span class="op" id="2686734">)</span>&nbsp;<span class="ident" id="2686736">PkgPath</span><span class="op" id="2686743">(</span><span class="op" id="2686744">)</span>&nbsp;<span class="builtintype" id="2686746">string</span>&nbsp;<span class="op" id="2686753">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686756">return</span>&nbsp;<span class="ident" id="2686763">t</span><span class="op" id="2686764">.</span><span class="ident" id="2686765">uncommonType</span><span class="op" id="2686777">.</span><span class="ident" id="2686778">PkgPath</span><span class="op" id="2686785">(</span><span class="op" id="2686786">)</span><br>
<span class="lineno"></span><span class="op" id="2686788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2686791">func</span>&nbsp;<span class="op" id="2686796">(</span><span class="ident" id="2686797">t</span>&nbsp;<span class="op" id="2686799">*</span><span class="ident" id="2686800">rtype</span><span class="op" id="2686805">)</span>&nbsp;<span class="ident" id="2686807">Name</span><span class="op" id="2686811">(</span><span class="op" id="2686812">)</span>&nbsp;<span class="builtintype" id="2686814">string</span>&nbsp;<span class="op" id="2686821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686824">return</span>&nbsp;<span class="ident" id="2686831">t</span><span class="op" id="2686832">.</span><span class="ident" id="2686833">uncommonType</span><span class="op" id="2686845">.</span><span class="ident" id="2686846">Name</span><span class="op" id="2686850">(</span><span class="op" id="2686851">)</span><br>
<span class="lineno">560</span><span class="op" id="2686853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2686856">func</span>&nbsp;<span class="op" id="2686861">(</span><span class="ident" id="2686862">t</span>&nbsp;<span class="op" id="2686864">*</span><span class="ident" id="2686865">rtype</span><span class="op" id="2686870">)</span>&nbsp;<span class="ident" id="2686872">ChanDir</span><span class="op" id="2686879">(</span><span class="op" id="2686880">)</span>&nbsp;<span class="ident" id="2686882">ChanDir</span>&nbsp;<span class="op" id="2686890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686893">if</span>&nbsp;<span class="ident" id="2686896">t</span><span class="op" id="2686897">.</span><span class="ident" id="2686898">Kind</span><span class="op" id="2686902">(</span><span class="op" id="2686903">)</span>&nbsp;<span class="op" id="2686905">!=</span>&nbsp;<span class="ident" id="2686908">Chan</span>&nbsp;<span class="op" id="2686913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2686917">panic</span><span class="op" id="2686922">(</span><span class="string" id="2686923">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2686958">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686964">tt</span>&nbsp;<span class="op" id="2686967">:=</span>&nbsp;<span class="op" id="2686970">(</span><span class="op" id="2686971">*</span><span class="ident" id="2686972">chanType</span><span class="op" id="2686980">)</span><span class="op" id="2686981">(</span><span class="ident" id="2686982">unsafe</span><span class="op" id="2686988">.</span><span class="ident" id="2686989">Pointer</span><span class="op" id="2686996">(</span><span class="ident" id="2686997">t</span><span class="op" id="2686998">)</span><span class="op" id="2686999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687002">return</span>&nbsp;<span class="ident" id="2687009">ChanDir</span><span class="op" id="2687016">(</span><span class="ident" id="2687017">tt</span><span class="op" id="2687019">.</span><span class="ident" id="2687020">dir</span><span class="op" id="2687023">)</span><br>
<span class="lineno"></span><span class="op" id="2687025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2687028">func</span>&nbsp;<span class="op" id="2687033">(</span><span class="ident" id="2687034">t</span>&nbsp;<span class="op" id="2687036">*</span><span class="ident" id="2687037">rtype</span><span class="op" id="2687042">)</span>&nbsp;<span class="ident" id="2687044">IsVariadic</span><span class="op" id="2687054">(</span><span class="op" id="2687055">)</span>&nbsp;<span class="builtintype" id="2687057">bool</span>&nbsp;<span class="op" id="2687062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687065">if</span>&nbsp;<span class="ident" id="2687068">t</span><span class="op" id="2687069">.</span><span class="ident" id="2687070">Kind</span><span class="op" id="2687074">(</span><span class="op" id="2687075">)</span>&nbsp;<span class="op" id="2687077">!=</span>&nbsp;<span class="ident" id="2687080">Func</span>&nbsp;<span class="op" id="2687085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2687089">panic</span><span class="op" id="2687094">(</span><span class="string" id="2687095">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2687133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687139">tt</span>&nbsp;<span class="op" id="2687142">:=</span>&nbsp;<span class="op" id="2687145">(</span><span class="op" id="2687146">*</span><span class="ident" id="2687147">funcType</span><span class="op" id="2687155">)</span><span class="op" id="2687156">(</span><span class="ident" id="2687157">unsafe</span><span class="op" id="2687163">.</span><span class="ident" id="2687164">Pointer</span><span class="op" id="2687171">(</span><span class="ident" id="2687172">t</span><span class="op" id="2687173">)</span><span class="op" id="2687174">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687177">return</span>&nbsp;<span class="ident" id="2687184">tt</span><span class="op" id="2687186">.</span><span class="ident" id="2687187">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2687197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2687200">func</span>&nbsp;<span class="op" id="2687205">(</span><span class="ident" id="2687206">t</span>&nbsp;<span class="op" id="2687208">*</span><span class="ident" id="2687209">rtype</span><span class="op" id="2687214">)</span>&nbsp;<span class="ident" id="2687216">Elem</span><span class="op" id="2687220">(</span><span class="op" id="2687221">)</span>&nbsp;<span class="ident" id="2687223">Type</span>&nbsp;<span class="op" id="2687228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687231">switch</span>&nbsp;<span class="ident" id="2687238">t</span><span class="op" id="2687239">.</span><span class="ident" id="2687240">Kind</span><span class="op" id="2687244">(</span><span class="op" id="2687245">)</span>&nbsp;<span class="op" id="2687247">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687250">case</span>&nbsp;<span class="ident" id="2687255">Array</span><span class="op" id="2687260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687264">tt</span>&nbsp;<span class="op" id="2687267">:=</span>&nbsp;<span class="op" id="2687270">(</span><span class="op" id="2687271">*</span><span class="ident" id="2687272">arrayType</span><span class="op" id="2687281">)</span><span class="op" id="2687282">(</span><span class="ident" id="2687283">unsafe</span><span class="op" id="2687289">.</span><span class="ident" id="2687290">Pointer</span><span class="op" id="2687297">(</span><span class="ident" id="2687298">t</span><span class="op" id="2687299">)</span><span class="op" id="2687300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687304">return</span>&nbsp;<span class="ident" id="2687311">toType</span><span class="op" id="2687317">(</span><span class="ident" id="2687318">tt</span><span class="op" id="2687320">.</span><span class="ident" id="2687321">elem</span><span class="op" id="2687325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687328">case</span>&nbsp;<span class="ident" id="2687333">Chan</span><span class="op" id="2687337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687341">tt</span>&nbsp;<span class="op" id="2687344">:=</span>&nbsp;<span class="op" id="2687347">(</span><span class="op" id="2687348">*</span><span class="ident" id="2687349">chanType</span><span class="op" id="2687357">)</span><span class="op" id="2687358">(</span><span class="ident" id="2687359">unsafe</span><span class="op" id="2687365">.</span><span class="ident" id="2687366">Pointer</span><span class="op" id="2687373">(</span><span class="ident" id="2687374">t</span><span class="op" id="2687375">)</span><span class="op" id="2687376">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687380">return</span>&nbsp;<span class="ident" id="2687387">toType</span><span class="op" id="2687393">(</span><span class="ident" id="2687394">tt</span><span class="op" id="2687396">.</span><span class="ident" id="2687397">elem</span><span class="op" id="2687401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687404">case</span>&nbsp;<span class="ident" id="2687409">Map</span><span class="op" id="2687412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687416">tt</span>&nbsp;<span class="op" id="2687419">:=</span>&nbsp;<span class="op" id="2687422">(</span><span class="op" id="2687423">*</span><span class="ident" id="2687424">mapType</span><span class="op" id="2687431">)</span><span class="op" id="2687432">(</span><span class="ident" id="2687433">unsafe</span><span class="op" id="2687439">.</span><span class="ident" id="2687440">Pointer</span><span class="op" id="2687447">(</span><span class="ident" id="2687448">t</span><span class="op" id="2687449">)</span><span class="op" id="2687450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687454">return</span>&nbsp;<span class="ident" id="2687461">toType</span><span class="op" id="2687467">(</span><span class="ident" id="2687468">tt</span><span class="op" id="2687470">.</span><span class="ident" id="2687471">elem</span><span class="op" id="2687475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687478">case</span>&nbsp;<span class="ident" id="2687483">Ptr</span><span class="op" id="2687486">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687490">tt</span>&nbsp;<span class="op" id="2687493">:=</span>&nbsp;<span class="op" id="2687496">(</span><span class="op" id="2687497">*</span><span class="ident" id="2687498">ptrType</span><span class="op" id="2687505">)</span><span class="op" id="2687506">(</span><span class="ident" id="2687507">unsafe</span><span class="op" id="2687513">.</span><span class="ident" id="2687514">Pointer</span><span class="op" id="2687521">(</span><span class="ident" id="2687522">t</span><span class="op" id="2687523">)</span><span class="op" id="2687524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687528">return</span>&nbsp;<span class="ident" id="2687535">toType</span><span class="op" id="2687541">(</span><span class="ident" id="2687542">tt</span><span class="op" id="2687544">.</span><span class="ident" id="2687545">elem</span><span class="op" id="2687549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687552">case</span>&nbsp;<span class="ident" id="2687557">Slice</span><span class="op" id="2687562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687566">tt</span>&nbsp;<span class="op" id="2687569">:=</span>&nbsp;<span class="op" id="2687572">(</span><span class="op" id="2687573">*</span><span class="ident" id="2687574">sliceType</span><span class="op" id="2687583">)</span><span class="op" id="2687584">(</span><span class="ident" id="2687585">unsafe</span><span class="op" id="2687591">.</span><span class="ident" id="2687592">Pointer</span><span class="op" id="2687599">(</span><span class="ident" id="2687600">t</span><span class="op" id="2687601">)</span><span class="op" id="2687602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687606">return</span>&nbsp;<span class="ident" id="2687613">toType</span><span class="op" id="2687619">(</span><span class="ident" id="2687620">tt</span><span class="op" id="2687622">.</span><span class="ident" id="2687623">elem</span><span class="op" id="2687627">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2687633">panic</span><span class="op" id="2687638">(</span><span class="string" id="2687639">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2687670">)</span><br>
<span class="lineno"></span><span class="op" id="2687672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2687675">func</span>&nbsp;<span class="op" id="2687680">(</span><span class="ident" id="2687681">t</span>&nbsp;<span class="op" id="2687683">*</span><span class="ident" id="2687684">rtype</span><span class="op" id="2687689">)</span>&nbsp;<span class="ident" id="2687691">Field</span><span class="op" id="2687696">(</span><span class="ident" id="2687697">i</span>&nbsp;<span class="builtintype" id="2687699">int</span><span class="op" id="2687702">)</span>&nbsp;<span class="ident" id="2687704">StructField</span>&nbsp;<span class="op" id="2687716">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687719">if</span>&nbsp;<span class="ident" id="2687722">t</span><span class="op" id="2687723">.</span><span class="ident" id="2687724">Kind</span><span class="op" id="2687728">(</span><span class="op" id="2687729">)</span>&nbsp;<span class="op" id="2687731">!=</span>&nbsp;<span class="ident" id="2687734">Struct</span>&nbsp;<span class="op" id="2687741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2687745">panic</span><span class="op" id="2687750">(</span><span class="string" id="2687751">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2687786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687792">tt</span>&nbsp;<span class="op" id="2687795">:=</span>&nbsp;<span class="op" id="2687798">(</span><span class="op" id="2687799">*</span><span class="ident" id="2687800">structType</span><span class="op" id="2687810">)</span><span class="op" id="2687811">(</span><span class="ident" id="2687812">unsafe</span><span class="op" id="2687818">.</span><span class="ident" id="2687819">Pointer</span><span class="op" id="2687826">(</span><span class="ident" id="2687827">t</span><span class="op" id="2687828">)</span><span class="op" id="2687829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687832">return</span>&nbsp;<span class="ident" id="2687839">tt</span><span class="op" id="2687841">.</span><span class="ident" id="2687842">Field</span><span class="op" id="2687847">(</span><span class="ident" id="2687848">i</span><span class="op" id="2687849">)</span><br>
<span class="lineno">605</span><span class="op" id="2687851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2687854">func</span>&nbsp;<span class="op" id="2687859">(</span><span class="ident" id="2687860">t</span>&nbsp;<span class="op" id="2687862">*</span><span class="ident" id="2687863">rtype</span><span class="op" id="2687868">)</span>&nbsp;<span class="ident" id="2687870">FieldByIndex</span><span class="op" id="2687882">(</span><span class="ident" id="2687883">index</span>&nbsp;<span class="op" id="2687889">[</span><span class="op" id="2687890">]</span><span class="builtintype" id="2687891">int</span><span class="op" id="2687894">)</span>&nbsp;<span class="ident" id="2687896">StructField</span>&nbsp;<span class="op" id="2687908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687911">if</span>&nbsp;<span class="ident" id="2687914">t</span><span class="op" id="2687915">.</span><span class="ident" id="2687916">Kind</span><span class="op" id="2687920">(</span><span class="op" id="2687921">)</span>&nbsp;<span class="op" id="2687923">!=</span>&nbsp;<span class="ident" id="2687926">Struct</span>&nbsp;<span class="op" id="2687933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2687937">panic</span><span class="op" id="2687942">(</span><span class="string" id="2687943">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2687985">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687991">tt</span>&nbsp;<span class="op" id="2687994">:=</span>&nbsp;<span class="op" id="2687997">(</span><span class="op" id="2687998">*</span><span class="ident" id="2687999">structType</span><span class="op" id="2688009">)</span><span class="op" id="2688010">(</span><span class="ident" id="2688011">unsafe</span><span class="op" id="2688017">.</span><span class="ident" id="2688018">Pointer</span><span class="op" id="2688025">(</span><span class="ident" id="2688026">t</span><span class="op" id="2688027">)</span><span class="op" id="2688028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688031">return</span>&nbsp;<span class="ident" id="2688038">tt</span><span class="op" id="2688040">.</span><span class="ident" id="2688041">FieldByIndex</span><span class="op" id="2688053">(</span><span class="ident" id="2688054">index</span><span class="op" id="2688059">)</span><br>
<span class="lineno"></span><span class="op" id="2688061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2688064">func</span>&nbsp;<span class="op" id="2688069">(</span><span class="ident" id="2688070">t</span>&nbsp;<span class="op" id="2688072">*</span><span class="ident" id="2688073">rtype</span><span class="op" id="2688078">)</span>&nbsp;<span class="ident" id="2688080">FieldByName</span><span class="op" id="2688091">(</span><span class="ident" id="2688092">name</span>&nbsp;<span class="builtintype" id="2688097">string</span><span class="op" id="2688103">)</span>&nbsp;<span class="op" id="2688105">(</span><span class="ident" id="2688106">StructField</span><span class="op" id="2688117">,</span>&nbsp;<span class="builtintype" id="2688119">bool</span><span class="op" id="2688123">)</span>&nbsp;<span class="op" id="2688125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688128">if</span>&nbsp;<span class="ident" id="2688131">t</span><span class="op" id="2688132">.</span><span class="ident" id="2688133">Kind</span><span class="op" id="2688137">(</span><span class="op" id="2688138">)</span>&nbsp;<span class="op" id="2688140">!=</span>&nbsp;<span class="ident" id="2688143">Struct</span>&nbsp;<span class="op" id="2688150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2688154">panic</span><span class="op" id="2688159">(</span><span class="string" id="2688160">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2688201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688207">tt</span>&nbsp;<span class="op" id="2688210">:=</span>&nbsp;<span class="op" id="2688213">(</span><span class="op" id="2688214">*</span><span class="ident" id="2688215">structType</span><span class="op" id="2688225">)</span><span class="op" id="2688226">(</span><span class="ident" id="2688227">unsafe</span><span class="op" id="2688233">.</span><span class="ident" id="2688234">Pointer</span><span class="op" id="2688241">(</span><span class="ident" id="2688242">t</span><span class="op" id="2688243">)</span><span class="op" id="2688244">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688247">return</span>&nbsp;<span class="ident" id="2688254">tt</span><span class="op" id="2688256">.</span><span class="ident" id="2688257">FieldByName</span><span class="op" id="2688268">(</span><span class="ident" id="2688269">name</span><span class="op" id="2688273">)</span><br>
<span class="lineno"></span><span class="op" id="2688275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688278">func</span>&nbsp;<span class="op" id="2688283">(</span><span class="ident" id="2688284">t</span>&nbsp;<span class="op" id="2688286">*</span><span class="ident" id="2688287">rtype</span><span class="op" id="2688292">)</span>&nbsp;<span class="ident" id="2688294">FieldByNameFunc</span><span class="op" id="2688309">(</span><span class="ident" id="2688310">match</span>&nbsp;<span class="keyword" id="2688316">func</span><span class="op" id="2688320">(</span><span class="builtintype" id="2688321">string</span><span class="op" id="2688327">)</span>&nbsp;<span class="builtintype" id="2688329">bool</span><span class="op" id="2688333">)</span>&nbsp;<span class="op" id="2688335">(</span><span class="ident" id="2688336">StructField</span><span class="op" id="2688347">,</span>&nbsp;<span class="builtintype" id="2688349">bool</span><span class="op" id="2688353">)</span>&nbsp;<span class="op" id="2688355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688358">if</span>&nbsp;<span class="ident" id="2688361">t</span><span class="op" id="2688362">.</span><span class="ident" id="2688363">Kind</span><span class="op" id="2688367">(</span><span class="op" id="2688368">)</span>&nbsp;<span class="op" id="2688370">!=</span>&nbsp;<span class="ident" id="2688373">Struct</span>&nbsp;<span class="op" id="2688380">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2688384">panic</span><span class="op" id="2688389">(</span><span class="string" id="2688390">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2688435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688441">tt</span>&nbsp;<span class="op" id="2688444">:=</span>&nbsp;<span class="op" id="2688447">(</span><span class="op" id="2688448">*</span><span class="ident" id="2688449">structType</span><span class="op" id="2688459">)</span><span class="op" id="2688460">(</span><span class="ident" id="2688461">unsafe</span><span class="op" id="2688467">.</span><span class="ident" id="2688468">Pointer</span><span class="op" id="2688475">(</span><span class="ident" id="2688476">t</span><span class="op" id="2688477">)</span><span class="op" id="2688478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688481">return</span>&nbsp;<span class="ident" id="2688488">tt</span><span class="op" id="2688490">.</span><span class="ident" id="2688491">FieldByNameFunc</span><span class="op" id="2688506">(</span><span class="ident" id="2688507">match</span><span class="op" id="2688512">)</span><br>
<span class="lineno"></span><span class="op" id="2688514">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2688517">func</span>&nbsp;<span class="op" id="2688522">(</span><span class="ident" id="2688523">t</span>&nbsp;<span class="op" id="2688525">*</span><span class="ident" id="2688526">rtype</span><span class="op" id="2688531">)</span>&nbsp;<span class="ident" id="2688533">In</span><span class="op" id="2688535">(</span><span class="ident" id="2688536">i</span>&nbsp;<span class="builtintype" id="2688538">int</span><span class="op" id="2688541">)</span>&nbsp;<span class="ident" id="2688543">Type</span>&nbsp;<span class="op" id="2688548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688551">if</span>&nbsp;<span class="ident" id="2688554">t</span><span class="op" id="2688555">.</span><span class="ident" id="2688556">Kind</span><span class="op" id="2688560">(</span><span class="op" id="2688561">)</span>&nbsp;<span class="op" id="2688563">!=</span>&nbsp;<span class="ident" id="2688566">Func</span>&nbsp;<span class="op" id="2688571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2688575">panic</span><span class="op" id="2688580">(</span><span class="string" id="2688581">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2688611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688614">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688617">tt</span>&nbsp;<span class="op" id="2688620">:=</span>&nbsp;<span class="op" id="2688623">(</span><span class="op" id="2688624">*</span><span class="ident" id="2688625">funcType</span><span class="op" id="2688633">)</span><span class="op" id="2688634">(</span><span class="ident" id="2688635">unsafe</span><span class="op" id="2688641">.</span><span class="ident" id="2688642">Pointer</span><span class="op" id="2688649">(</span><span class="ident" id="2688650">t</span><span class="op" id="2688651">)</span><span class="op" id="2688652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688655">return</span>&nbsp;<span class="ident" id="2688662">toType</span><span class="op" id="2688668">(</span><span class="ident" id="2688669">tt</span><span class="op" id="2688671">.</span><span class="ident" id="2688672">in</span><span class="op" id="2688674">[</span><span class="ident" id="2688675">i</span><span class="op" id="2688676">]</span><span class="op" id="2688677">)</span><br>
<span class="lineno"></span><span class="op" id="2688679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688682">func</span>&nbsp;<span class="op" id="2688687">(</span><span class="ident" id="2688688">t</span>&nbsp;<span class="op" id="2688690">*</span><span class="ident" id="2688691">rtype</span><span class="op" id="2688696">)</span>&nbsp;<span class="ident" id="2688698">Key</span><span class="op" id="2688701">(</span><span class="op" id="2688702">)</span>&nbsp;<span class="ident" id="2688704">Type</span>&nbsp;<span class="op" id="2688709">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688712">if</span>&nbsp;<span class="ident" id="2688715">t</span><span class="op" id="2688716">.</span><span class="ident" id="2688717">Kind</span><span class="op" id="2688721">(</span><span class="op" id="2688722">)</span>&nbsp;<span class="op" id="2688724">!=</span>&nbsp;<span class="ident" id="2688727">Map</span>&nbsp;<span class="op" id="2688731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2688735">panic</span><span class="op" id="2688740">(</span><span class="string" id="2688741">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2688771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688777">tt</span>&nbsp;<span class="op" id="2688780">:=</span>&nbsp;<span class="op" id="2688783">(</span><span class="op" id="2688784">*</span><span class="ident" id="2688785">mapType</span><span class="op" id="2688792">)</span><span class="op" id="2688793">(</span><span class="ident" id="2688794">unsafe</span><span class="op" id="2688800">.</span><span class="ident" id="2688801">Pointer</span><span class="op" id="2688808">(</span><span class="ident" id="2688809">t</span><span class="op" id="2688810">)</span><span class="op" id="2688811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688814">return</span>&nbsp;<span class="ident" id="2688821">toType</span><span class="op" id="2688827">(</span><span class="ident" id="2688828">tt</span><span class="op" id="2688830">.</span><span class="ident" id="2688831">key</span><span class="op" id="2688834">)</span><br>
<span class="lineno">645</span><span class="op" id="2688836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688839">func</span>&nbsp;<span class="op" id="2688844">(</span><span class="ident" id="2688845">t</span>&nbsp;<span class="op" id="2688847">*</span><span class="ident" id="2688848">rtype</span><span class="op" id="2688853">)</span>&nbsp;<span class="ident" id="2688855">Len</span><span class="op" id="2688858">(</span><span class="op" id="2688859">)</span>&nbsp;<span class="builtintype" id="2688861">int</span>&nbsp;<span class="op" id="2688865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688868">if</span>&nbsp;<span class="ident" id="2688871">t</span><span class="op" id="2688872">.</span><span class="ident" id="2688873">Kind</span><span class="op" id="2688877">(</span><span class="op" id="2688878">)</span>&nbsp;<span class="op" id="2688880">!=</span>&nbsp;<span class="ident" id="2688883">Array</span>&nbsp;<span class="op" id="2688889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2688893">panic</span><span class="op" id="2688898">(</span><span class="string" id="2688899">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2688931">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688937">tt</span>&nbsp;<span class="op" id="2688940">:=</span>&nbsp;<span class="op" id="2688943">(</span><span class="op" id="2688944">*</span><span class="ident" id="2688945">arrayType</span><span class="op" id="2688954">)</span><span class="op" id="2688955">(</span><span class="ident" id="2688956">unsafe</span><span class="op" id="2688962">.</span><span class="ident" id="2688963">Pointer</span><span class="op" id="2688970">(</span><span class="ident" id="2688971">t</span><span class="op" id="2688972">)</span><span class="op" id="2688973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688976">return</span>&nbsp;<span class="builtintype" id="2688983">int</span><span class="op" id="2688986">(</span><span class="ident" id="2688987">tt</span><span class="op" id="2688989">.</span><span class="builtinfunc" id="2688990">len</span><span class="op" id="2688993">)</span><br>
<span class="lineno"></span><span class="op" id="2688995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2688998">func</span>&nbsp;<span class="op" id="2689003">(</span><span class="ident" id="2689004">t</span>&nbsp;<span class="op" id="2689006">*</span><span class="ident" id="2689007">rtype</span><span class="op" id="2689012">)</span>&nbsp;<span class="ident" id="2689014">NumField</span><span class="op" id="2689022">(</span><span class="op" id="2689023">)</span>&nbsp;<span class="builtintype" id="2689025">int</span>&nbsp;<span class="op" id="2689029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689032">if</span>&nbsp;<span class="ident" id="2689035">t</span><span class="op" id="2689036">.</span><span class="ident" id="2689037">Kind</span><span class="op" id="2689041">(</span><span class="op" id="2689042">)</span>&nbsp;<span class="op" id="2689044">!=</span>&nbsp;<span class="ident" id="2689047">Struct</span>&nbsp;<span class="op" id="2689054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2689058">panic</span><span class="op" id="2689063">(</span><span class="string" id="2689064">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2689102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689108">tt</span>&nbsp;<span class="op" id="2689111">:=</span>&nbsp;<span class="op" id="2689114">(</span><span class="op" id="2689115">*</span><span class="ident" id="2689116">structType</span><span class="op" id="2689126">)</span><span class="op" id="2689127">(</span><span class="ident" id="2689128">unsafe</span><span class="op" id="2689134">.</span><span class="ident" id="2689135">Pointer</span><span class="op" id="2689142">(</span><span class="ident" id="2689143">t</span><span class="op" id="2689144">)</span><span class="op" id="2689145">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689148">return</span>&nbsp;<span class="builtinfunc" id="2689155">len</span><span class="op" id="2689158">(</span><span class="ident" id="2689159">tt</span><span class="op" id="2689161">.</span><span class="ident" id="2689162">fields</span><span class="op" id="2689168">)</span><br>
<span class="lineno"></span><span class="op" id="2689170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2689173">func</span>&nbsp;<span class="op" id="2689178">(</span><span class="ident" id="2689179">t</span>&nbsp;<span class="op" id="2689181">*</span><span class="ident" id="2689182">rtype</span><span class="op" id="2689187">)</span>&nbsp;<span class="ident" id="2689189">NumIn</span><span class="op" id="2689194">(</span><span class="op" id="2689195">)</span>&nbsp;<span class="builtintype" id="2689197">int</span>&nbsp;<span class="op" id="2689201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689204">if</span>&nbsp;<span class="ident" id="2689207">t</span><span class="op" id="2689208">.</span><span class="ident" id="2689209">Kind</span><span class="op" id="2689213">(</span><span class="op" id="2689214">)</span>&nbsp;<span class="op" id="2689216">!=</span>&nbsp;<span class="ident" id="2689219">Func</span>&nbsp;<span class="op" id="2689224">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2689228">panic</span><span class="op" id="2689233">(</span><span class="string" id="2689234">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2689267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689273">tt</span>&nbsp;<span class="op" id="2689276">:=</span>&nbsp;<span class="op" id="2689279">(</span><span class="op" id="2689280">*</span><span class="ident" id="2689281">funcType</span><span class="op" id="2689289">)</span><span class="op" id="2689290">(</span><span class="ident" id="2689291">unsafe</span><span class="op" id="2689297">.</span><span class="ident" id="2689298">Pointer</span><span class="op" id="2689305">(</span><span class="ident" id="2689306">t</span><span class="op" id="2689307">)</span><span class="op" id="2689308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689311">return</span>&nbsp;<span class="builtinfunc" id="2689318">len</span><span class="op" id="2689321">(</span><span class="ident" id="2689322">tt</span><span class="op" id="2689324">.</span><span class="ident" id="2689325">in</span><span class="op" id="2689327">)</span><br>
<span class="lineno"></span><span class="op" id="2689329">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2689332">func</span>&nbsp;<span class="op" id="2689337">(</span><span class="ident" id="2689338">t</span>&nbsp;<span class="op" id="2689340">*</span><span class="ident" id="2689341">rtype</span><span class="op" id="2689346">)</span>&nbsp;<span class="ident" id="2689348">NumOut</span><span class="op" id="2689354">(</span><span class="op" id="2689355">)</span>&nbsp;<span class="builtintype" id="2689357">int</span>&nbsp;<span class="op" id="2689361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689364">if</span>&nbsp;<span class="ident" id="2689367">t</span><span class="op" id="2689368">.</span><span class="ident" id="2689369">Kind</span><span class="op" id="2689373">(</span><span class="op" id="2689374">)</span>&nbsp;<span class="op" id="2689376">!=</span>&nbsp;<span class="ident" id="2689379">Func</span>&nbsp;<span class="op" id="2689384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2689388">panic</span><span class="op" id="2689393">(</span><span class="string" id="2689394">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2689428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689431">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689434">tt</span>&nbsp;<span class="op" id="2689437">:=</span>&nbsp;<span class="op" id="2689440">(</span><span class="op" id="2689441">*</span><span class="ident" id="2689442">funcType</span><span class="op" id="2689450">)</span><span class="op" id="2689451">(</span><span class="ident" id="2689452">unsafe</span><span class="op" id="2689458">.</span><span class="ident" id="2689459">Pointer</span><span class="op" id="2689466">(</span><span class="ident" id="2689467">t</span><span class="op" id="2689468">)</span><span class="op" id="2689469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689472">return</span>&nbsp;<span class="builtinfunc" id="2689479">len</span><span class="op" id="2689482">(</span><span class="ident" id="2689483">tt</span><span class="op" id="2689485">.</span><span class="ident" id="2689486">out</span><span class="op" id="2689489">)</span><br>
<span class="lineno"></span><span class="op" id="2689491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2689494">func</span>&nbsp;<span class="op" id="2689499">(</span><span class="ident" id="2689500">t</span>&nbsp;<span class="op" id="2689502">*</span><span class="ident" id="2689503">rtype</span><span class="op" id="2689508">)</span>&nbsp;<span class="ident" id="2689510">Out</span><span class="op" id="2689513">(</span><span class="ident" id="2689514">i</span>&nbsp;<span class="builtintype" id="2689516">int</span><span class="op" id="2689519">)</span>&nbsp;<span class="ident" id="2689521">Type</span>&nbsp;<span class="op" id="2689526">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689529">if</span>&nbsp;<span class="ident" id="2689532">t</span><span class="op" id="2689533">.</span><span class="ident" id="2689534">Kind</span><span class="op" id="2689538">(</span><span class="op" id="2689539">)</span>&nbsp;<span class="op" id="2689541">!=</span>&nbsp;<span class="ident" id="2689544">Func</span>&nbsp;<span class="op" id="2689549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2689553">panic</span><span class="op" id="2689558">(</span><span class="string" id="2689559">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2689590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689596">tt</span>&nbsp;<span class="op" id="2689599">:=</span>&nbsp;<span class="op" id="2689602">(</span><span class="op" id="2689603">*</span><span class="ident" id="2689604">funcType</span><span class="op" id="2689612">)</span><span class="op" id="2689613">(</span><span class="ident" id="2689614">unsafe</span><span class="op" id="2689620">.</span><span class="ident" id="2689621">Pointer</span><span class="op" id="2689628">(</span><span class="ident" id="2689629">t</span><span class="op" id="2689630">)</span><span class="op" id="2689631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689634">return</span>&nbsp;<span class="ident" id="2689641">toType</span><span class="op" id="2689647">(</span><span class="ident" id="2689648">tt</span><span class="op" id="2689650">.</span><span class="ident" id="2689651">out</span><span class="op" id="2689654">[</span><span class="ident" id="2689655">i</span><span class="op" id="2689656">]</span><span class="op" id="2689657">)</span><br>
<span class="lineno">685</span><span class="op" id="2689659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2689662">func</span>&nbsp;<span class="op" id="2689667">(</span><span class="ident" id="2689668">d</span>&nbsp;<span class="ident" id="2689670">ChanDir</span><span class="op" id="2689677">)</span>&nbsp;<span class="ident" id="2689679">String</span><span class="op" id="2689685">(</span><span class="op" id="2689686">)</span>&nbsp;<span class="builtintype" id="2689688">string</span>&nbsp;<span class="op" id="2689695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689698">switch</span>&nbsp;<span class="ident" id="2689705">d</span>&nbsp;<span class="op" id="2689707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689710">case</span>&nbsp;<span class="ident" id="2689715">SendDir</span><span class="op" id="2689722">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689726">return</span>&nbsp;<span class="string" id="2689733">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689743">case</span>&nbsp;<span class="ident" id="2689748">RecvDir</span><span class="op" id="2689755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689759">return</span>&nbsp;<span class="string" id="2689766">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689776">case</span>&nbsp;<span class="ident" id="2689781">BothDir</span><span class="op" id="2689788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689792">return</span>&nbsp;<span class="string" id="2689799">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689810">return</span>&nbsp;<span class="string" id="2689817">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2689827">+</span>&nbsp;<span class="ident" id="2689829">strconv</span><span class="op" id="2689836">.</span><span class="ident" id="2689837">Itoa</span><span class="op" id="2689841">(</span><span class="builtintype" id="2689842">int</span><span class="op" id="2689845">(</span><span class="ident" id="2689846">d</span><span class="op" id="2689847">)</span><span class="op" id="2689848">)</span><br>
<span class="lineno"></span><span class="op" id="2689850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2689853">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2689913">func</span>&nbsp;<span class="op" id="2689918">(</span><span class="ident" id="2689919">t</span>&nbsp;<span class="op" id="2689921">*</span><span class="ident" id="2689922">interfaceType</span><span class="op" id="2689935">)</span>&nbsp;<span class="ident" id="2689937">Method</span><span class="op" id="2689943">(</span><span class="ident" id="2689944">i</span>&nbsp;<span class="builtintype" id="2689946">int</span><span class="op" id="2689949">)</span>&nbsp;<span class="op" id="2689951">(</span><span class="ident" id="2689952">m</span>&nbsp;<span class="ident" id="2689954">Method</span><span class="op" id="2689960">)</span>&nbsp;<span class="op" id="2689962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689965">if</span>&nbsp;<span class="ident" id="2689968">i</span>&nbsp;<span class="op" id="2689970">&lt;</span>&nbsp;<span class="num" id="2689972">0</span>&nbsp;<span class="op" id="2689974">||</span>&nbsp;<span class="ident" id="2689977">i</span>&nbsp;<span class="op" id="2689979">&gt;=</span>&nbsp;<span class="builtinfunc" id="2689982">len</span><span class="op" id="2689985">(</span><span class="ident" id="2689986">t</span><span class="op" id="2689987">.</span><span class="ident" id="2689988">methods</span><span class="op" id="2689995">)</span>&nbsp;<span class="op" id="2689997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690012">p</span>&nbsp;<span class="op" id="2690014">:=</span>&nbsp;<span class="op" id="2690017">&amp;</span><span class="ident" id="2690018">t</span><span class="op" id="2690019">.</span><span class="ident" id="2690020">methods</span><span class="op" id="2690027">[</span><span class="ident" id="2690028">i</span><span class="op" id="2690029">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690032">m</span><span class="op" id="2690033">.</span><span class="ident" id="2690034">Name</span>&nbsp;<span class="op" id="2690039">=</span>&nbsp;<span class="op" id="2690041">*</span><span class="ident" id="2690042">p</span><span class="op" id="2690043">.</span><span class="ident" id="2690044">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690050">if</span>&nbsp;<span class="ident" id="2690053">p</span><span class="op" id="2690054">.</span><span class="ident" id="2690055">pkgPath</span>&nbsp;<span class="op" id="2690063">!=</span>&nbsp;<span class="ident" id="2690066">nil</span>&nbsp;<span class="op" id="2690070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690074">m</span><span class="op" id="2690075">.</span><span class="ident" id="2690076">PkgPath</span>&nbsp;<span class="op" id="2690084">=</span>&nbsp;<span class="op" id="2690086">*</span><span class="ident" id="2690087">p</span><span class="op" id="2690088">.</span><span class="ident" id="2690089">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690101">m</span><span class="op" id="2690102">.</span><span class="ident" id="2690103">Type</span>&nbsp;<span class="op" id="2690108">=</span>&nbsp;<span class="ident" id="2690110">toType</span><span class="op" id="2690116">(</span><span class="ident" id="2690117">p</span><span class="op" id="2690118">.</span><span class="ident" id="2690119">typ</span><span class="op" id="2690122">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690125">m</span><span class="op" id="2690126">.</span><span class="ident" id="2690127">Index</span>&nbsp;<span class="op" id="2690133">=</span>&nbsp;<span class="ident" id="2690135">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690138">return</span><br>
<span class="lineno"></span><span class="op" id="2690145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2690148">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2690227">func</span>&nbsp;<span class="op" id="2690232">(</span><span class="ident" id="2690233">t</span>&nbsp;<span class="op" id="2690235">*</span><span class="ident" id="2690236">interfaceType</span><span class="op" id="2690249">)</span>&nbsp;<span class="ident" id="2690251">NumMethod</span><span class="op" id="2690260">(</span><span class="op" id="2690261">)</span>&nbsp;<span class="builtintype" id="2690263">int</span>&nbsp;<span class="op" id="2690267">{</span>&nbsp;<span class="keyword" id="2690269">return</span>&nbsp;<span class="builtinfunc" id="2690276">len</span><span class="op" id="2690279">(</span><span class="ident" id="2690280">t</span><span class="op" id="2690281">.</span><span class="ident" id="2690282">methods</span><span class="op" id="2690289">)</span>&nbsp;<span class="op" id="2690291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2690294">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2690363">func</span>&nbsp;<span class="op" id="2690368">(</span><span class="ident" id="2690369">t</span>&nbsp;<span class="op" id="2690371">*</span><span class="ident" id="2690372">interfaceType</span><span class="op" id="2690385">)</span>&nbsp;<span class="ident" id="2690387">MethodByName</span><span class="op" id="2690399">(</span><span class="ident" id="2690400">name</span>&nbsp;<span class="builtintype" id="2690405">string</span><span class="op" id="2690411">)</span>&nbsp;<span class="op" id="2690413">(</span><span class="ident" id="2690414">m</span>&nbsp;<span class="ident" id="2690416">Method</span><span class="op" id="2690422">,</span>&nbsp;<span class="ident" id="2690424">ok</span>&nbsp;<span class="builtintype" id="2690427">bool</span><span class="op" id="2690431">)</span>&nbsp;<span class="op" id="2690433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690436">if</span>&nbsp;<span class="ident" id="2690439">t</span>&nbsp;<span class="op" id="2690441">==</span>&nbsp;<span class="ident" id="2690444">nil</span>&nbsp;<span class="op" id="2690448">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690452">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690463">var</span>&nbsp;<span class="ident" id="2690467">p</span>&nbsp;<span class="op" id="2690469">*</span><span class="ident" id="2690470">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690479">for</span>&nbsp;<span class="ident" id="2690483">i</span>&nbsp;<span class="op" id="2690485">:=</span>&nbsp;<span class="keyword" id="2690488">range</span>&nbsp;<span class="ident" id="2690494">t</span><span class="op" id="2690495">.</span><span class="ident" id="2690496">methods</span>&nbsp;<span class="op" id="2690504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690508">p</span>&nbsp;<span class="op" id="2690510">=</span>&nbsp;<span class="op" id="2690512">&amp;</span><span class="ident" id="2690513">t</span><span class="op" id="2690514">.</span><span class="ident" id="2690515">methods</span><span class="op" id="2690522">[</span><span class="ident" id="2690523">i</span><span class="op" id="2690524">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690528">if</span>&nbsp;<span class="op" id="2690531">*</span><span class="ident" id="2690532">p</span><span class="op" id="2690533">.</span><span class="ident" id="2690534">name</span>&nbsp;<span class="op" id="2690539">==</span>&nbsp;<span class="ident" id="2690542">name</span>&nbsp;<span class="op" id="2690547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690552">return</span>&nbsp;<span class="ident" id="2690559">t</span><span class="op" id="2690560">.</span><span class="ident" id="2690561">Method</span><span class="op" id="2690567">(</span><span class="ident" id="2690568">i</span><span class="op" id="2690569">)</span><span class="op" id="2690570">,</span>&nbsp;<span class="builtintype" id="2690572">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690585">return</span><br>
<span class="lineno">730</span><span class="op" id="2690592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2690595">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2690650">type</span>&nbsp;<span class="ident" id="2690655">StructField</span>&nbsp;<span class="keyword" id="2690667">struct</span>&nbsp;<span class="op" id="2690674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690677">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690705">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690778">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690846">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690907">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2690915">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690923">PkgPath</span>&nbsp;<span class="builtintype" id="2690931">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690940">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2690950">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2690960">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690975">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2690985">StructTag</span>&nbsp;<span class="comment" id="2690995">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691016">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2691026">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2691036">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691071">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2691081">[</span><span class="op" id="2691082">]</span><span class="builtintype" id="2691083">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2691091">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691132">Anonymous</span>&nbsp;<span class="builtintype" id="2691142">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2691152">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2691176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2691179">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2691231">//</span><br>
<span class="lineno">750</span><span class="comment" id="2691234">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2691287">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2691336">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2691396">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2691461">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2691527">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2691571">type</span>&nbsp;<span class="ident" id="2691576">StructTag</span>&nbsp;<span class="builtintype" id="2691586">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2691594">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2691658">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2691727">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2691790">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2691825">func</span>&nbsp;<span class="op" id="2691830">(</span><span class="ident" id="2691831">tag</span>&nbsp;<span class="ident" id="2691835">StructTag</span><span class="op" id="2691844">)</span>&nbsp;<span class="ident" id="2691846">Get</span><span class="op" id="2691849">(</span><span class="ident" id="2691850">key</span>&nbsp;<span class="builtintype" id="2691854">string</span><span class="op" id="2691860">)</span>&nbsp;<span class="builtintype" id="2691862">string</span>&nbsp;<span class="op" id="2691869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691872">for</span>&nbsp;<span class="ident" id="2691876">tag</span>&nbsp;<span class="op" id="2691880">!=</span>&nbsp;<span class="string" id="2691883">&#34;&#34;</span>&nbsp;<span class="op" id="2691886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691890">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691914">i</span>&nbsp;<span class="op" id="2691916">:=</span>&nbsp;<span class="num" id="2691919">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691923">for</span>&nbsp;<span class="ident" id="2691927">i</span>&nbsp;<span class="op" id="2691929">&lt;</span>&nbsp;<span class="builtinfunc" id="2691931">len</span><span class="op" id="2691934">(</span><span class="ident" id="2691935">tag</span><span class="op" id="2691938">)</span>&nbsp;<span class="op" id="2691940">&amp;&amp;</span>&nbsp;<span class="ident" id="2691943">tag</span><span class="op" id="2691946">[</span><span class="ident" id="2691947">i</span><span class="op" id="2691948">]</span>&nbsp;<span class="op" id="2691950">==</span>&nbsp;<span class="string" id="2691953">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2691957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691962">i</span><span class="op" id="2691963">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691972">tag</span>&nbsp;<span class="op" id="2691976">=</span>&nbsp;<span class="ident" id="2691978">tag</span><span class="op" id="2691981">[</span><span class="ident" id="2691982">i</span><span class="op" id="2691983">:</span><span class="op" id="2691984">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691988">if</span>&nbsp;<span class="ident" id="2691991">tag</span>&nbsp;<span class="op" id="2691995">==</span>&nbsp;<span class="string" id="2691998">&#34;&#34;</span>&nbsp;<span class="op" id="2692001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692006">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692019">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692039">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692081">i</span>&nbsp;<span class="op" id="2692083">=</span>&nbsp;<span class="num" id="2692085">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692089">for</span>&nbsp;<span class="ident" id="2692093">i</span>&nbsp;<span class="op" id="2692095">&lt;</span>&nbsp;<span class="builtinfunc" id="2692097">len</span><span class="op" id="2692100">(</span><span class="ident" id="2692101">tag</span><span class="op" id="2692104">)</span>&nbsp;<span class="op" id="2692106">&amp;&amp;</span>&nbsp;<span class="ident" id="2692109">tag</span><span class="op" id="2692112">[</span><span class="ident" id="2692113">i</span><span class="op" id="2692114">]</span>&nbsp;<span class="op" id="2692116">!=</span>&nbsp;<span class="string" id="2692119">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2692123">&amp;&amp;</span>&nbsp;<span class="ident" id="2692126">tag</span><span class="op" id="2692129">[</span><span class="ident" id="2692130">i</span><span class="op" id="2692131">]</span>&nbsp;<span class="op" id="2692133">!=</span>&nbsp;<span class="string" id="2692136">&#39;:&#39;</span>&nbsp;<span class="op" id="2692140">&amp;&amp;</span>&nbsp;<span class="ident" id="2692143">tag</span><span class="op" id="2692146">[</span><span class="ident" id="2692147">i</span><span class="op" id="2692148">]</span>&nbsp;<span class="op" id="2692150">!=</span>&nbsp;<span class="string" id="2692153">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2692157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692162">i</span><span class="op" id="2692163">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692168">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692172">if</span>&nbsp;<span class="ident" id="2692175">i</span><span class="op" id="2692176">+</span><span class="num" id="2692177">1</span>&nbsp;<span class="op" id="2692179">&gt;=</span>&nbsp;<span class="builtinfunc" id="2692182">len</span><span class="op" id="2692185">(</span><span class="ident" id="2692186">tag</span><span class="op" id="2692189">)</span>&nbsp;<span class="op" id="2692191">||</span>&nbsp;<span class="ident" id="2692194">tag</span><span class="op" id="2692197">[</span><span class="ident" id="2692198">i</span><span class="op" id="2692199">]</span>&nbsp;<span class="op" id="2692201">!=</span>&nbsp;<span class="string" id="2692204">&#39;:&#39;</span>&nbsp;<span class="op" id="2692208">||</span>&nbsp;<span class="ident" id="2692211">tag</span><span class="op" id="2692214">[</span><span class="ident" id="2692215">i</span><span class="op" id="2692216">+</span><span class="num" id="2692217">1</span><span class="op" id="2692218">]</span>&nbsp;<span class="op" id="2692220">!=</span>&nbsp;<span class="string" id="2692223">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2692227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692232">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692244">name</span>&nbsp;<span class="op" id="2692249">:=</span>&nbsp;<span class="builtintype" id="2692252">string</span><span class="op" id="2692258">(</span><span class="ident" id="2692259">tag</span><span class="op" id="2692262">[</span><span class="op" id="2692263">:</span><span class="ident" id="2692264">i</span><span class="op" id="2692265">]</span><span class="op" id="2692266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692270">tag</span>&nbsp;<span class="op" id="2692274">=</span>&nbsp;<span class="ident" id="2692276">tag</span><span class="op" id="2692279">[</span><span class="ident" id="2692280">i</span><span class="op" id="2692281">+</span><span class="num" id="2692282">1</span><span class="op" id="2692283">:</span><span class="op" id="2692284">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692289">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692327">i</span>&nbsp;<span class="op" id="2692329">=</span>&nbsp;<span class="num" id="2692331">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692335">for</span>&nbsp;<span class="ident" id="2692339">i</span>&nbsp;<span class="op" id="2692341">&lt;</span>&nbsp;<span class="builtinfunc" id="2692343">len</span><span class="op" id="2692346">(</span><span class="ident" id="2692347">tag</span><span class="op" id="2692350">)</span>&nbsp;<span class="op" id="2692352">&amp;&amp;</span>&nbsp;<span class="ident" id="2692355">tag</span><span class="op" id="2692358">[</span><span class="ident" id="2692359">i</span><span class="op" id="2692360">]</span>&nbsp;<span class="op" id="2692362">!=</span>&nbsp;<span class="string" id="2692365">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2692369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692374">if</span>&nbsp;<span class="ident" id="2692377">tag</span><span class="op" id="2692380">[</span><span class="ident" id="2692381">i</span><span class="op" id="2692382">]</span>&nbsp;<span class="op" id="2692384">==</span>&nbsp;<span class="string" id="2692387">&#39;\\&#39;</span>&nbsp;<span class="op" id="2692392">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692398">i</span><span class="op" id="2692399">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692410">i</span><span class="op" id="2692411">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692420">if</span>&nbsp;<span class="ident" id="2692423">i</span>&nbsp;<span class="op" id="2692425">&gt;=</span>&nbsp;<span class="builtinfunc" id="2692428">len</span><span class="op" id="2692431">(</span><span class="ident" id="2692432">tag</span><span class="op" id="2692435">)</span>&nbsp;<span class="op" id="2692437">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692442">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692454">qvalue</span>&nbsp;<span class="op" id="2692461">:=</span>&nbsp;<span class="builtintype" id="2692464">string</span><span class="op" id="2692470">(</span><span class="ident" id="2692471">tag</span><span class="op" id="2692474">[</span><span class="op" id="2692475">:</span><span class="ident" id="2692476">i</span><span class="op" id="2692477">+</span><span class="num" id="2692478">1</span><span class="op" id="2692479">]</span><span class="op" id="2692480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692484">tag</span>&nbsp;<span class="op" id="2692488">=</span>&nbsp;<span class="ident" id="2692490">tag</span><span class="op" id="2692493">[</span><span class="ident" id="2692494">i</span><span class="op" id="2692495">+</span><span class="num" id="2692496">1</span><span class="op" id="2692497">:</span><span class="op" id="2692498">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692503">if</span>&nbsp;<span class="ident" id="2692506">key</span>&nbsp;<span class="op" id="2692510">==</span>&nbsp;<span class="ident" id="2692513">name</span>&nbsp;<span class="op" id="2692518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692523">value</span><span class="op" id="2692528">,</span>&nbsp;<span class="ident" id="2692530">_</span>&nbsp;<span class="op" id="2692532">:=</span>&nbsp;<span class="ident" id="2692535">strconv</span><span class="op" id="2692542">.</span><span class="ident" id="2692543">Unquote</span><span class="op" id="2692550">(</span><span class="ident" id="2692551">qvalue</span><span class="op" id="2692557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692562">return</span>&nbsp;<span class="ident" id="2692569">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692580">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692583">return</span>&nbsp;<span class="string" id="2692590">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2692593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2692596">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2692636">func</span>&nbsp;<span class="op" id="2692641">(</span><span class="ident" id="2692642">t</span>&nbsp;<span class="op" id="2692644">*</span><span class="ident" id="2692645">structType</span><span class="op" id="2692655">)</span>&nbsp;<span class="ident" id="2692657">Field</span><span class="op" id="2692662">(</span><span class="ident" id="2692663">i</span>&nbsp;<span class="builtintype" id="2692665">int</span><span class="op" id="2692668">)</span>&nbsp;<span class="op" id="2692670">(</span><span class="ident" id="2692671">f</span>&nbsp;<span class="ident" id="2692673">StructField</span><span class="op" id="2692684">)</span>&nbsp;<span class="op" id="2692686">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692689">if</span>&nbsp;<span class="ident" id="2692692">i</span>&nbsp;<span class="op" id="2692694">&lt;</span>&nbsp;<span class="num" id="2692696">0</span>&nbsp;<span class="op" id="2692698">||</span>&nbsp;<span class="ident" id="2692701">i</span>&nbsp;<span class="op" id="2692703">&gt;=</span>&nbsp;<span class="builtinfunc" id="2692706">len</span><span class="op" id="2692709">(</span><span class="ident" id="2692710">t</span><span class="op" id="2692711">.</span><span class="ident" id="2692712">fields</span><span class="op" id="2692718">)</span>&nbsp;<span class="op" id="2692720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692724">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692735">p</span>&nbsp;<span class="op" id="2692737">:=</span>&nbsp;<span class="op" id="2692740">&amp;</span><span class="ident" id="2692741">t</span><span class="op" id="2692742">.</span><span class="ident" id="2692743">fields</span><span class="op" id="2692749">[</span><span class="ident" id="2692750">i</span><span class="op" id="2692751">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692754">f</span><span class="op" id="2692755">.</span><span class="ident" id="2692756">Type</span>&nbsp;<span class="op" id="2692761">=</span>&nbsp;<span class="ident" id="2692763">toType</span><span class="op" id="2692769">(</span><span class="ident" id="2692770">p</span><span class="op" id="2692771">.</span><span class="ident" id="2692772">typ</span><span class="op" id="2692775">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692778">if</span>&nbsp;<span class="ident" id="2692781">p</span><span class="op" id="2692782">.</span><span class="ident" id="2692783">name</span>&nbsp;<span class="op" id="2692788">!=</span>&nbsp;<span class="ident" id="2692791">nil</span>&nbsp;<span class="op" id="2692795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692799">f</span><span class="op" id="2692800">.</span><span class="ident" id="2692801">Name</span>&nbsp;<span class="op" id="2692806">=</span>&nbsp;<span class="op" id="2692808">*</span><span class="ident" id="2692809">p</span><span class="op" id="2692810">.</span><span class="ident" id="2692811">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692817">}</span>&nbsp;<span class="keyword" id="2692819">else</span>&nbsp;<span class="op" id="2692824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692828">t</span>&nbsp;<span class="op" id="2692830">:=</span>&nbsp;<span class="ident" id="2692833">f</span><span class="op" id="2692834">.</span><span class="ident" id="2692835">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692842">if</span>&nbsp;<span class="ident" id="2692845">t</span><span class="op" id="2692846">.</span><span class="ident" id="2692847">Kind</span><span class="op" id="2692851">(</span><span class="op" id="2692852">)</span>&nbsp;<span class="op" id="2692854">==</span>&nbsp;<span class="ident" id="2692857">Ptr</span>&nbsp;<span class="op" id="2692861">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692866">t</span>&nbsp;<span class="op" id="2692868">=</span>&nbsp;<span class="ident" id="2692870">t</span><span class="op" id="2692871">.</span><span class="ident" id="2692872">Elem</span><span class="op" id="2692876">(</span><span class="op" id="2692877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692885">f</span><span class="op" id="2692886">.</span><span class="ident" id="2692887">Name</span>&nbsp;<span class="op" id="2692892">=</span>&nbsp;<span class="ident" id="2692894">t</span><span class="op" id="2692895">.</span><span class="ident" id="2692896">Name</span><span class="op" id="2692900">(</span><span class="op" id="2692901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692905">f</span><span class="op" id="2692906">.</span><span class="ident" id="2692907">Anonymous</span>&nbsp;<span class="op" id="2692917">=</span>&nbsp;<span class="builtintype" id="2692919">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692925">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692928">if</span>&nbsp;<span class="ident" id="2692931">p</span><span class="op" id="2692932">.</span><span class="ident" id="2692933">pkgPath</span>&nbsp;<span class="op" id="2692941">!=</span>&nbsp;<span class="ident" id="2692944">nil</span>&nbsp;<span class="op" id="2692948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692952">f</span><span class="op" id="2692953">.</span><span class="ident" id="2692954">PkgPath</span>&nbsp;<span class="op" id="2692962">=</span>&nbsp;<span class="op" id="2692964">*</span><span class="ident" id="2692965">p</span><span class="op" id="2692966">.</span><span class="ident" id="2692967">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692979">if</span>&nbsp;<span class="ident" id="2692982">p</span><span class="op" id="2692983">.</span><span class="ident" id="2692984">tag</span>&nbsp;<span class="op" id="2692988">!=</span>&nbsp;<span class="ident" id="2692991">nil</span>&nbsp;<span class="op" id="2692995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692999">f</span><span class="op" id="2693000">.</span><span class="ident" id="2693001">Tag</span>&nbsp;<span class="op" id="2693005">=</span>&nbsp;<span class="ident" id="2693007">StructTag</span><span class="op" id="2693016">(</span><span class="op" id="2693017">*</span><span class="ident" id="2693018">p</span><span class="op" id="2693019">.</span><span class="ident" id="2693020">tag</span><span class="op" id="2693023">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693029">f</span><span class="op" id="2693030">.</span><span class="ident" id="2693031">Offset</span>&nbsp;<span class="op" id="2693038">=</span>&nbsp;<span class="ident" id="2693040">p</span><span class="op" id="2693041">.</span><span class="ident" id="2693042">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693051">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693111">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693172">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693231">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693291">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693351">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693409">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693460">f</span><span class="op" id="2693461">.</span><span class="ident" id="2693462">Index</span>&nbsp;<span class="op" id="2693468">=</span>&nbsp;<span class="op" id="2693470">[</span><span class="op" id="2693471">]</span><span class="builtintype" id="2693472">int</span><span class="op" id="2693475">{</span><span class="ident" id="2693476">i</span><span class="op" id="2693477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693480">return</span><br>
<span class="lineno"></span><span class="op" id="2693487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693490">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2693557">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693599">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2693664">func</span>&nbsp;<span class="op" id="2693669">(</span><span class="ident" id="2693670">t</span>&nbsp;<span class="op" id="2693672">*</span><span class="ident" id="2693673">structType</span><span class="op" id="2693683">)</span>&nbsp;<span class="ident" id="2693685">FieldByIndex</span><span class="op" id="2693697">(</span><span class="ident" id="2693698">index</span>&nbsp;<span class="op" id="2693704">[</span><span class="op" id="2693705">]</span><span class="builtintype" id="2693706">int</span><span class="op" id="2693709">)</span>&nbsp;<span class="op" id="2693711">(</span><span class="ident" id="2693712">f</span>&nbsp;<span class="ident" id="2693714">StructField</span><span class="op" id="2693725">)</span>&nbsp;<span class="op" id="2693727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693730">f</span><span class="op" id="2693731">.</span><span class="ident" id="2693732">Type</span>&nbsp;<span class="op" id="2693737">=</span>&nbsp;<span class="ident" id="2693739">toType</span><span class="op" id="2693745">(</span><span class="op" id="2693746">&amp;</span><span class="ident" id="2693747">t</span><span class="op" id="2693748">.</span><span class="ident" id="2693749">rtype</span><span class="op" id="2693754">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693757">for</span>&nbsp;<span class="ident" id="2693761">i</span><span class="op" id="2693762">,</span>&nbsp;<span class="ident" id="2693764">x</span>&nbsp;<span class="op" id="2693766">:=</span>&nbsp;<span class="keyword" id="2693769">range</span>&nbsp;<span class="ident" id="2693775">index</span>&nbsp;<span class="op" id="2693781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693785">if</span>&nbsp;<span class="ident" id="2693788">i</span>&nbsp;<span class="op" id="2693790">&gt;</span>&nbsp;<span class="num" id="2693792">0</span>&nbsp;<span class="op" id="2693794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693799">ft</span>&nbsp;<span class="op" id="2693802">:=</span>&nbsp;<span class="ident" id="2693805">f</span><span class="op" id="2693806">.</span><span class="ident" id="2693807">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693815">if</span>&nbsp;<span class="ident" id="2693818">ft</span><span class="op" id="2693820">.</span><span class="ident" id="2693821">Kind</span><span class="op" id="2693825">(</span><span class="op" id="2693826">)</span>&nbsp;<span class="op" id="2693828">==</span>&nbsp;<span class="ident" id="2693831">Ptr</span>&nbsp;<span class="op" id="2693835">&amp;&amp;</span>&nbsp;<span class="ident" id="2693838">ft</span><span class="op" id="2693840">.</span><span class="ident" id="2693841">Elem</span><span class="op" id="2693845">(</span><span class="op" id="2693846">)</span><span class="op" id="2693847">.</span><span class="ident" id="2693848">Kind</span><span class="op" id="2693852">(</span><span class="op" id="2693853">)</span>&nbsp;<span class="op" id="2693855">==</span>&nbsp;<span class="ident" id="2693858">Struct</span>&nbsp;<span class="op" id="2693865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693871">ft</span>&nbsp;<span class="op" id="2693874">=</span>&nbsp;<span class="ident" id="2693876">ft</span><span class="op" id="2693878">.</span><span class="ident" id="2693879">Elem</span><span class="op" id="2693883">(</span><span class="op" id="2693884">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693894">f</span><span class="op" id="2693895">.</span><span class="ident" id="2693896">Type</span>&nbsp;<span class="op" id="2693901">=</span>&nbsp;<span class="ident" id="2693903">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693912">f</span>&nbsp;<span class="op" id="2693914">=</span>&nbsp;<span class="ident" id="2693916">f</span><span class="op" id="2693917">.</span><span class="ident" id="2693918">Type</span><span class="op" id="2693922">.</span><span class="ident" id="2693923">Field</span><span class="op" id="2693928">(</span><span class="ident" id="2693929">x</span><span class="op" id="2693930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693933">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693936">return</span><br>
<span class="lineno"></span><span class="op" id="2693943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693946">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2694019">type</span>&nbsp;<span class="ident" id="2694024">fieldScan</span>&nbsp;<span class="keyword" id="2694034">struct</span>&nbsp;<span class="op" id="2694041">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694044">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2694050">*</span><span class="ident" id="2694051">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694063">index</span>&nbsp;<span class="op" id="2694069">[</span><span class="op" id="2694070">]</span><span class="builtintype" id="2694071">int</span><br>
<span class="lineno"></span><span class="op" id="2694075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2694078">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2694153">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2694221">func</span>&nbsp;<span class="op" id="2694226">(</span><span class="ident" id="2694227">t</span>&nbsp;<span class="op" id="2694229">*</span><span class="ident" id="2694230">structType</span><span class="op" id="2694240">)</span>&nbsp;<span class="ident" id="2694242">FieldByNameFunc</span><span class="op" id="2694257">(</span><span class="ident" id="2694258">match</span>&nbsp;<span class="keyword" id="2694264">func</span><span class="op" id="2694268">(</span><span class="builtintype" id="2694269">string</span><span class="op" id="2694275">)</span>&nbsp;<span class="builtintype" id="2694277">bool</span><span class="op" id="2694281">)</span>&nbsp;<span class="op" id="2694283">(</span><span class="ident" id="2694284">result</span>&nbsp;<span class="ident" id="2694291">StructField</span><span class="op" id="2694302">,</span>&nbsp;<span class="ident" id="2694304">ok</span>&nbsp;<span class="builtintype" id="2694307">bool</span><span class="op" id="2694311">)</span>&nbsp;<span class="op" id="2694313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694316">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694408">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694499">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694591">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694662">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694711">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694770">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694825">current</span>&nbsp;<span class="op" id="2694833">:=</span>&nbsp;<span class="op" id="2694836">[</span><span class="op" id="2694837">]</span><span class="ident" id="2694838">fieldScan</span><span class="op" id="2694847">{</span><span class="op" id="2694848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694851">next</span>&nbsp;<span class="op" id="2694856">:=</span>&nbsp;<span class="op" id="2694859">[</span><span class="op" id="2694860">]</span><span class="ident" id="2694861">fieldScan</span><span class="op" id="2694870">{</span><span class="op" id="2694871">{</span><span class="ident" id="2694872">typ</span><span class="op" id="2694875">:</span>&nbsp;<span class="ident" id="2694877">t</span><span class="op" id="2694878">}</span><span class="op" id="2694879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694883">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694951">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695016">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695085">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695162">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695235">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695270">var</span>&nbsp;<span class="ident" id="2695274">nextCount</span>&nbsp;<span class="keyword" id="2695284">map</span><span class="op" id="2695287">[</span><span class="op" id="2695288">*</span><span class="ident" id="2695289">structType</span><span class="op" id="2695299">]</span><span class="builtintype" id="2695300">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695306">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695373">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695435">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695504">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695576">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695651">visited</span>&nbsp;<span class="op" id="2695659">:=</span>&nbsp;<span class="keyword" id="2695662">map</span><span class="op" id="2695665">[</span><span class="op" id="2695666">*</span><span class="ident" id="2695667">structType</span><span class="op" id="2695677">]</span><span class="builtintype" id="2695678">bool</span><span class="op" id="2695682">{</span><span class="op" id="2695683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695687">for</span>&nbsp;<span class="builtinfunc" id="2695691">len</span><span class="op" id="2695694">(</span><span class="ident" id="2695695">next</span><span class="op" id="2695699">)</span>&nbsp;<span class="op" id="2695701">&gt;</span>&nbsp;<span class="num" id="2695703">0</span>&nbsp;<span class="op" id="2695705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695709">current</span><span class="op" id="2695716">,</span>&nbsp;<span class="ident" id="2695718">next</span>&nbsp;<span class="op" id="2695723">=</span>&nbsp;<span class="ident" id="2695725">next</span><span class="op" id="2695729">,</span>&nbsp;<span class="ident" id="2695731">current</span><span class="op" id="2695738">[</span><span class="op" id="2695739">:</span><span class="num" id="2695740">0</span><span class="op" id="2695741">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695745">count</span>&nbsp;<span class="op" id="2695751">:=</span>&nbsp;<span class="ident" id="2695754">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695766">nextCount</span>&nbsp;<span class="op" id="2695776">=</span>&nbsp;<span class="ident" id="2695778">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695785">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695853">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2695938">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696013">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696102">for</span>&nbsp;<span class="ident" id="2696106">_</span><span class="op" id="2696107">,</span>&nbsp;<span class="ident" id="2696109">scan</span>&nbsp;<span class="op" id="2696114">:=</span>&nbsp;<span class="keyword" id="2696117">range</span>&nbsp;<span class="ident" id="2696123">current</span>&nbsp;<span class="op" id="2696131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696136">t</span>&nbsp;<span class="op" id="2696138">:=</span>&nbsp;<span class="ident" id="2696141">scan</span><span class="op" id="2696145">.</span><span class="ident" id="2696146">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696153">if</span>&nbsp;<span class="ident" id="2696156">visited</span><span class="op" id="2696163">[</span><span class="ident" id="2696164">t</span><span class="op" id="2696165">]</span>&nbsp;<span class="op" id="2696167">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696173">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696238">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696306">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696359">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696371">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696376">visited</span><span class="op" id="2696383">[</span><span class="ident" id="2696384">t</span><span class="op" id="2696385">]</span>&nbsp;<span class="op" id="2696387">=</span>&nbsp;<span class="builtintype" id="2696389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696397">for</span>&nbsp;<span class="ident" id="2696401">i</span>&nbsp;<span class="op" id="2696403">:=</span>&nbsp;<span class="keyword" id="2696406">range</span>&nbsp;<span class="ident" id="2696412">t</span><span class="op" id="2696413">.</span><span class="ident" id="2696414">fields</span>&nbsp;<span class="op" id="2696421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696427">f</span>&nbsp;<span class="op" id="2696429">:=</span>&nbsp;<span class="op" id="2696432">&amp;</span><span class="ident" id="2696433">t</span><span class="op" id="2696434">.</span><span class="ident" id="2696435">fields</span><span class="op" id="2696441">[</span><span class="ident" id="2696442">i</span><span class="op" id="2696443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696449">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696488">var</span>&nbsp;<span class="ident" id="2696492">fname</span>&nbsp;<span class="builtintype" id="2696498">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696509">var</span>&nbsp;<span class="ident" id="2696513">ntyp</span>&nbsp;<span class="op" id="2696518">*</span><span class="ident" id="2696519">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696529">if</span>&nbsp;<span class="ident" id="2696532">f</span><span class="op" id="2696533">.</span><span class="ident" id="2696534">name</span>&nbsp;<span class="op" id="2696539">!=</span>&nbsp;<span class="ident" id="2696542">nil</span>&nbsp;<span class="op" id="2696546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696553">fname</span>&nbsp;<span class="op" id="2696559">=</span>&nbsp;<span class="op" id="2696561">*</span><span class="ident" id="2696562">f</span><span class="op" id="2696563">.</span><span class="ident" id="2696564">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696573">}</span>&nbsp;<span class="keyword" id="2696575">else</span>&nbsp;<span class="op" id="2696580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696587">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696628">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696658">ntyp</span>&nbsp;<span class="op" id="2696663">=</span>&nbsp;<span class="ident" id="2696665">f</span><span class="op" id="2696666">.</span><span class="ident" id="2696667">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696676">if</span>&nbsp;<span class="ident" id="2696679">ntyp</span><span class="op" id="2696683">.</span><span class="ident" id="2696684">Kind</span><span class="op" id="2696688">(</span><span class="op" id="2696689">)</span>&nbsp;<span class="op" id="2696691">==</span>&nbsp;<span class="ident" id="2696694">Ptr</span>&nbsp;<span class="op" id="2696698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696706">ntyp</span>&nbsp;<span class="op" id="2696711">=</span>&nbsp;<span class="ident" id="2696713">ntyp</span><span class="op" id="2696717">.</span><span class="ident" id="2696718">Elem</span><span class="op" id="2696722">(</span><span class="op" id="2696723">)</span><span class="op" id="2696724">.</span><span class="ident" id="2696725">common</span><span class="op" id="2696731">(</span><span class="op" id="2696732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696739">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696746">fname</span>&nbsp;<span class="op" id="2696752">=</span>&nbsp;<span class="ident" id="2696754">ntyp</span><span class="op" id="2696758">.</span><span class="ident" id="2696759">Name</span><span class="op" id="2696763">(</span><span class="op" id="2696764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696777">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696799">if</span>&nbsp;<span class="ident" id="2696802">match</span><span class="op" id="2696807">(</span><span class="ident" id="2696808">fname</span><span class="op" id="2696813">)</span>&nbsp;<span class="op" id="2696815">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696822">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696846">if</span>&nbsp;<span class="ident" id="2696849">count</span><span class="op" id="2696854">[</span><span class="ident" id="2696855">t</span><span class="op" id="2696856">]</span>&nbsp;<span class="op" id="2696858">&gt;</span>&nbsp;<span class="num" id="2696860">1</span>&nbsp;<span class="op" id="2696862">||</span>&nbsp;<span class="ident" id="2696865">ok</span>&nbsp;<span class="op" id="2696868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696876">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696941">return</span>&nbsp;<span class="ident" id="2696948">StructField</span><span class="op" id="2696959">{</span><span class="op" id="2696960">}</span><span class="op" id="2696961">,</span>&nbsp;<span class="builtintype" id="2696963">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696974">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696981">result</span>&nbsp;<span class="op" id="2696988">=</span>&nbsp;<span class="ident" id="2696990">t</span><span class="op" id="2696991">.</span><span class="ident" id="2696992">Field</span><span class="op" id="2696997">(</span><span class="ident" id="2696998">i</span><span class="op" id="2696999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697006">result</span><span class="op" id="2697012">.</span><span class="ident" id="2697013">Index</span>&nbsp;<span class="op" id="2697019">=</span>&nbsp;<span class="ident" id="2697021">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697030">result</span><span class="op" id="2697036">.</span><span class="ident" id="2697037">Index</span>&nbsp;<span class="op" id="2697043">=</span>&nbsp;<span class="builtinfunc" id="2697045">append</span><span class="op" id="2697051">(</span><span class="ident" id="2697052">result</span><span class="op" id="2697058">.</span><span class="ident" id="2697059">Index</span><span class="op" id="2697064">,</span>&nbsp;<span class="ident" id="2697066">scan</span><span class="op" id="2697070">.</span><span class="ident" id="2697071">index</span><span class="op" id="2697076">...</span><span class="op" id="2697079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697086">result</span><span class="op" id="2697092">.</span><span class="ident" id="2697093">Index</span>&nbsp;<span class="op" id="2697099">=</span>&nbsp;<span class="builtinfunc" id="2697101">append</span><span class="op" id="2697107">(</span><span class="ident" id="2697108">result</span><span class="op" id="2697114">.</span><span class="ident" id="2697115">Index</span><span class="op" id="2697120">,</span>&nbsp;<span class="ident" id="2697122">i</span><span class="op" id="2697123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697130">ok</span>&nbsp;<span class="op" id="2697133">=</span>&nbsp;<span class="builtintype" id="2697135">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697145">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697165">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697233">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697303">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697361">if</span>&nbsp;<span class="ident" id="2697364">ok</span>&nbsp;<span class="op" id="2697367">||</span>&nbsp;<span class="ident" id="2697370">ntyp</span>&nbsp;<span class="op" id="2697375">==</span>&nbsp;<span class="ident" id="2697378">nil</span>&nbsp;<span class="op" id="2697382">||</span>&nbsp;<span class="ident" id="2697385">ntyp</span><span class="op" id="2697389">.</span><span class="ident" id="2697390">Kind</span><span class="op" id="2697394">(</span><span class="op" id="2697395">)</span>&nbsp;<span class="op" id="2697397">!=</span>&nbsp;<span class="ident" id="2697400">Struct</span>&nbsp;<span class="op" id="2697407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697414">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697433">styp</span>&nbsp;<span class="op" id="2697438">:=</span>&nbsp;<span class="op" id="2697441">(</span><span class="op" id="2697442">*</span><span class="ident" id="2697443">structType</span><span class="op" id="2697453">)</span><span class="op" id="2697454">(</span><span class="ident" id="2697455">unsafe</span><span class="op" id="2697461">.</span><span class="ident" id="2697462">Pointer</span><span class="op" id="2697469">(</span><span class="ident" id="2697470">ntyp</span><span class="op" id="2697474">)</span><span class="op" id="2697475">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697481">if</span>&nbsp;<span class="ident" id="2697484">nextCount</span><span class="op" id="2697493">[</span><span class="ident" id="2697494">styp</span><span class="op" id="2697498">]</span>&nbsp;<span class="op" id="2697500">&gt;</span>&nbsp;<span class="num" id="2697502">0</span>&nbsp;<span class="op" id="2697504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697511">nextCount</span><span class="op" id="2697520">[</span><span class="ident" id="2697521">styp</span><span class="op" id="2697525">]</span>&nbsp;<span class="op" id="2697527">=</span>&nbsp;<span class="num" id="2697529">2</span>&nbsp;<span class="comment" id="2697531">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697569">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697588">if</span>&nbsp;<span class="ident" id="2697591">nextCount</span>&nbsp;<span class="op" id="2697601">==</span>&nbsp;<span class="ident" id="2697604">nil</span>&nbsp;<span class="op" id="2697608">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697615">nextCount</span>&nbsp;<span class="op" id="2697625">=</span>&nbsp;<span class="keyword" id="2697627">map</span><span class="op" id="2697630">[</span><span class="op" id="2697631">*</span><span class="ident" id="2697632">structType</span><span class="op" id="2697642">]</span><span class="builtintype" id="2697643">int</span><span class="op" id="2697646">{</span><span class="op" id="2697647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697659">nextCount</span><span class="op" id="2697668">[</span><span class="ident" id="2697669">styp</span><span class="op" id="2697673">]</span>&nbsp;<span class="op" id="2697675">=</span>&nbsp;<span class="num" id="2697677">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697683">if</span>&nbsp;<span class="ident" id="2697686">count</span><span class="op" id="2697691">[</span><span class="ident" id="2697692">t</span><span class="op" id="2697693">]</span>&nbsp;<span class="op" id="2697695">&gt;</span>&nbsp;<span class="num" id="2697697">1</span>&nbsp;<span class="op" id="2697699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697706">nextCount</span><span class="op" id="2697715">[</span><span class="ident" id="2697716">styp</span><span class="op" id="2697720">]</span>&nbsp;<span class="op" id="2697722">=</span>&nbsp;<span class="num" id="2697724">2</span>&nbsp;<span class="comment" id="2697726">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697769">var</span>&nbsp;<span class="ident" id="2697773">index</span>&nbsp;<span class="op" id="2697779">[</span><span class="op" id="2697780">]</span><span class="builtintype" id="2697781">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697789">index</span>&nbsp;<span class="op" id="2697795">=</span>&nbsp;<span class="builtinfunc" id="2697797">append</span><span class="op" id="2697803">(</span><span class="ident" id="2697804">index</span><span class="op" id="2697809">,</span>&nbsp;<span class="ident" id="2697811">scan</span><span class="op" id="2697815">.</span><span class="ident" id="2697816">index</span><span class="op" id="2697821">...</span><span class="op" id="2697824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697830">index</span>&nbsp;<span class="op" id="2697836">=</span>&nbsp;<span class="builtinfunc" id="2697838">append</span><span class="op" id="2697844">(</span><span class="ident" id="2697845">index</span><span class="op" id="2697850">,</span>&nbsp;<span class="ident" id="2697852">i</span><span class="op" id="2697853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697859">next</span>&nbsp;<span class="op" id="2697864">=</span>&nbsp;<span class="builtinfunc" id="2697866">append</span><span class="op" id="2697872">(</span><span class="ident" id="2697873">next</span><span class="op" id="2697877">,</span>&nbsp;<span class="ident" id="2697879">fieldScan</span><span class="op" id="2697888">{</span><span class="ident" id="2697889">styp</span><span class="op" id="2697893">,</span>&nbsp;<span class="ident" id="2697895">index</span><span class="op" id="2697900">}</span><span class="op" id="2697901">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697914">if</span>&nbsp;<span class="ident" id="2697917">ok</span>&nbsp;<span class="op" id="2697920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697925">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697933">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697939">return</span><br>
<span class="lineno"></span><span class="op" id="2697946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2697949">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2698009">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2698062">func</span>&nbsp;<span class="op" id="2698067">(</span><span class="ident" id="2698068">t</span>&nbsp;<span class="op" id="2698070">*</span><span class="ident" id="2698071">structType</span><span class="op" id="2698081">)</span>&nbsp;<span class="ident" id="2698083">FieldByName</span><span class="op" id="2698094">(</span><span class="ident" id="2698095">name</span>&nbsp;<span class="builtintype" id="2698100">string</span><span class="op" id="2698106">)</span>&nbsp;<span class="op" id="2698108">(</span><span class="ident" id="2698109">f</span>&nbsp;<span class="ident" id="2698111">StructField</span><span class="op" id="2698122">,</span>&nbsp;<span class="ident" id="2698124">present</span>&nbsp;<span class="builtintype" id="2698132">bool</span><span class="op" id="2698136">)</span>&nbsp;<span class="op" id="2698138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698141">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698213">hasAnon</span>&nbsp;<span class="op" id="2698221">:=</span>&nbsp;<span class="builtintype" id="2698224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698231">if</span>&nbsp;<span class="ident" id="2698234">name</span>&nbsp;<span class="op" id="2698239">!=</span>&nbsp;<span class="string" id="2698242">&#34;&#34;</span>&nbsp;<span class="op" id="2698245">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698249">for</span>&nbsp;<span class="ident" id="2698253">i</span>&nbsp;<span class="op" id="2698255">:=</span>&nbsp;<span class="keyword" id="2698258">range</span>&nbsp;<span class="ident" id="2698264">t</span><span class="op" id="2698265">.</span><span class="ident" id="2698266">fields</span>&nbsp;<span class="op" id="2698273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698278">tf</span>&nbsp;<span class="op" id="2698281">:=</span>&nbsp;<span class="op" id="2698284">&amp;</span><span class="ident" id="2698285">t</span><span class="op" id="2698286">.</span><span class="ident" id="2698287">fields</span><span class="op" id="2698293">[</span><span class="ident" id="2698294">i</span><span class="op" id="2698295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698300">if</span>&nbsp;<span class="ident" id="2698303">tf</span><span class="op" id="2698305">.</span><span class="ident" id="2698306">name</span>&nbsp;<span class="op" id="2698311">==</span>&nbsp;<span class="ident" id="2698314">nil</span>&nbsp;<span class="op" id="2698318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698324">hasAnon</span>&nbsp;<span class="op" id="2698332">=</span>&nbsp;<span class="builtintype" id="2698334">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698343">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698360">if</span>&nbsp;<span class="op" id="2698363">*</span><span class="ident" id="2698364">tf</span><span class="op" id="2698366">.</span><span class="ident" id="2698367">name</span>&nbsp;<span class="op" id="2698372">==</span>&nbsp;<span class="ident" id="2698375">name</span>&nbsp;<span class="op" id="2698380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698386">return</span>&nbsp;<span class="ident" id="2698393">t</span><span class="op" id="2698394">.</span><span class="ident" id="2698395">Field</span><span class="op" id="2698400">(</span><span class="ident" id="2698401">i</span><span class="op" id="2698402">)</span><span class="op" id="2698403">,</span>&nbsp;<span class="builtintype" id="2698405">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698417">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698423">if</span>&nbsp;<span class="op" id="2698426">!</span><span class="ident" id="2698427">hasAnon</span>&nbsp;<span class="op" id="2698435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698439">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698450">return</span>&nbsp;<span class="ident" id="2698457">t</span><span class="op" id="2698458">.</span><span class="ident" id="2698459">FieldByNameFunc</span><span class="op" id="2698474">(</span><span class="keyword" id="2698475">func</span><span class="op" id="2698479">(</span><span class="ident" id="2698480">s</span>&nbsp;<span class="builtintype" id="2698482">string</span><span class="op" id="2698488">)</span>&nbsp;<span class="builtintype" id="2698490">bool</span>&nbsp;<span class="op" id="2698495">{</span>&nbsp;<span class="keyword" id="2698497">return</span>&nbsp;<span class="ident" id="2698504">s</span>&nbsp;<span class="op" id="2698506">==</span>&nbsp;<span class="ident" id="2698509">name</span>&nbsp;<span class="op" id="2698514">}</span><span class="op" id="2698515">)</span><br>
<span class="lineno">1000</span><span class="op" id="2698517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2698520">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2698591">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2698619">func</span>&nbsp;<span class="ident" id="2698624">TypeOf</span><span class="op" id="2698630">(</span><span class="ident" id="2698631">i</span>&nbsp;<span class="keyword" id="2698633">interface</span><span class="op" id="2698642">{</span><span class="op" id="2698643">}</span><span class="op" id="2698644">)</span>&nbsp;<span class="ident" id="2698646">Type</span>&nbsp;<span class="op" id="2698651">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698654">eface</span>&nbsp;<span class="op" id="2698660">:=</span>&nbsp;<span class="op" id="2698663">*</span><span class="op" id="2698664">(</span><span class="op" id="2698665">*</span><span class="ident" id="2698666">emptyInterface</span><span class="op" id="2698680">)</span><span class="op" id="2698681">(</span><span class="ident" id="2698682">unsafe</span><span class="op" id="2698688">.</span><span class="ident" id="2698689">Pointer</span><span class="op" id="2698696">(</span><span class="op" id="2698697">&amp;</span><span class="ident" id="2698698">i</span><span class="op" id="2698699">)</span><span class="op" id="2698700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698703">return</span>&nbsp;<span class="ident" id="2698710">toType</span><span class="op" id="2698716">(</span><span class="ident" id="2698717">eface</span><span class="op" id="2698722">.</span><span class="ident" id="2698723">typ</span><span class="op" id="2698726">)</span><br>
<span class="lineno"></span><span class="op" id="2698728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2698731">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2698765">var</span>&nbsp;<span class="ident" id="2698769">ptrMap</span>&nbsp;<span class="keyword" id="2698776">struct</span>&nbsp;<span class="op" id="2698783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698786">sync</span><span class="op" id="2698790">.</span><span class="ident" id="2698791">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698800">m</span>&nbsp;<span class="keyword" id="2698802">map</span><span class="op" id="2698805">[</span><span class="op" id="2698806">*</span><span class="ident" id="2698807">rtype</span><span class="op" id="2698812">]</span><span class="op" id="2698813">*</span><span class="ident" id="2698814">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2698822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2698825">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2698875">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2698943">func</span>&nbsp;<span class="ident" id="2698948">PtrTo</span><span class="op" id="2698953">(</span><span class="ident" id="2698954">t</span>&nbsp;<span class="ident" id="2698956">Type</span><span class="op" id="2698960">)</span>&nbsp;<span class="ident" id="2698962">Type</span>&nbsp;<span class="op" id="2698967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698970">return</span>&nbsp;<span class="ident" id="2698977">t</span><span class="op" id="2698978">.</span><span class="op" id="2698979">(</span><span class="op" id="2698980">*</span><span class="ident" id="2698981">rtype</span><span class="op" id="2698986">)</span><span class="op" id="2698987">.</span><span class="ident" id="2698988">ptrTo</span><span class="op" id="2698993">(</span><span class="op" id="2698994">)</span><br>
<span class="lineno"></span><span class="op" id="2698996">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2698999">func</span>&nbsp;<span class="op" id="2699004">(</span><span class="ident" id="2699005">t</span>&nbsp;<span class="op" id="2699007">*</span><span class="ident" id="2699008">rtype</span><span class="op" id="2699013">)</span>&nbsp;<span class="ident" id="2699015">ptrTo</span><span class="op" id="2699020">(</span><span class="op" id="2699021">)</span>&nbsp;<span class="op" id="2699023">*</span><span class="ident" id="2699024">rtype</span>&nbsp;<span class="op" id="2699030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699033">if</span>&nbsp;<span class="ident" id="2699036">p</span>&nbsp;<span class="op" id="2699038">:=</span>&nbsp;<span class="ident" id="2699041">t</span><span class="op" id="2699042">.</span><span class="ident" id="2699043">ptrToThis</span><span class="op" id="2699052">;</span>&nbsp;<span class="ident" id="2699054">p</span>&nbsp;<span class="op" id="2699056">!=</span>&nbsp;<span class="ident" id="2699059">nil</span>&nbsp;<span class="op" id="2699063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699067">return</span>&nbsp;<span class="ident" id="2699074">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699077">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699081">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699112">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699164">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699218">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699277">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699322">ptrMap</span><span class="op" id="2699328">.</span><span class="ident" id="2699329">RLock</span><span class="op" id="2699334">(</span><span class="op" id="2699335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699338">if</span>&nbsp;<span class="ident" id="2699341">m</span>&nbsp;<span class="op" id="2699343">:=</span>&nbsp;<span class="ident" id="2699346">ptrMap</span><span class="op" id="2699352">.</span><span class="ident" id="2699353">m</span><span class="op" id="2699354">;</span>&nbsp;<span class="ident" id="2699356">m</span>&nbsp;<span class="op" id="2699358">!=</span>&nbsp;<span class="ident" id="2699361">nil</span>&nbsp;<span class="op" id="2699365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699369">if</span>&nbsp;<span class="ident" id="2699372">p</span>&nbsp;<span class="op" id="2699374">:=</span>&nbsp;<span class="ident" id="2699377">m</span><span class="op" id="2699378">[</span><span class="ident" id="2699379">t</span><span class="op" id="2699380">]</span><span class="op" id="2699381">;</span>&nbsp;<span class="ident" id="2699383">p</span>&nbsp;<span class="op" id="2699385">!=</span>&nbsp;<span class="ident" id="2699388">nil</span>&nbsp;<span class="op" id="2699392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699397">ptrMap</span><span class="op" id="2699403">.</span><span class="ident" id="2699404">RUnlock</span><span class="op" id="2699411">(</span><span class="op" id="2699412">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699417">return</span>&nbsp;<span class="op" id="2699424">&amp;</span><span class="ident" id="2699425">p</span><span class="op" id="2699426">.</span><span class="ident" id="2699427">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699441">ptrMap</span><span class="op" id="2699447">.</span><span class="ident" id="2699448">RUnlock</span><span class="op" id="2699455">(</span><span class="op" id="2699456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699459">ptrMap</span><span class="op" id="2699465">.</span><span class="ident" id="2699466">Lock</span><span class="op" id="2699470">(</span><span class="op" id="2699471">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699474">if</span>&nbsp;<span class="ident" id="2699477">ptrMap</span><span class="op" id="2699483">.</span><span class="ident" id="2699484">m</span>&nbsp;<span class="op" id="2699486">==</span>&nbsp;<span class="ident" id="2699489">nil</span>&nbsp;<span class="op" id="2699493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699497">ptrMap</span><span class="op" id="2699503">.</span><span class="ident" id="2699504">m</span>&nbsp;<span class="op" id="2699506">=</span>&nbsp;<span class="builtinfunc" id="2699508">make</span><span class="op" id="2699512">(</span><span class="keyword" id="2699513">map</span><span class="op" id="2699516">[</span><span class="op" id="2699517">*</span><span class="ident" id="2699518">rtype</span><span class="op" id="2699523">]</span><span class="op" id="2699524">*</span><span class="ident" id="2699525">ptrType</span><span class="op" id="2699532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699538">p</span>&nbsp;<span class="op" id="2699540">:=</span>&nbsp;<span class="ident" id="2699543">ptrMap</span><span class="op" id="2699549">.</span><span class="ident" id="2699550">m</span><span class="op" id="2699551">[</span><span class="ident" id="2699552">t</span><span class="op" id="2699553">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699556">if</span>&nbsp;<span class="ident" id="2699559">p</span>&nbsp;<span class="op" id="2699561">!=</span>&nbsp;<span class="ident" id="2699564">nil</span>&nbsp;<span class="op" id="2699568">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699572">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699626">ptrMap</span><span class="op" id="2699632">.</span><span class="ident" id="2699633">Unlock</span><span class="op" id="2699639">(</span><span class="op" id="2699640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699644">return</span>&nbsp;<span class="op" id="2699651">&amp;</span><span class="ident" id="2699652">p</span><span class="op" id="2699653">.</span><span class="ident" id="2699654">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699665">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699720">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699747">p</span>&nbsp;<span class="op" id="2699749">=</span>&nbsp;<span class="builtinfunc" id="2699751">new</span><span class="op" id="2699754">(</span><span class="ident" id="2699755">ptrType</span><span class="op" id="2699762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699765">var</span>&nbsp;<span class="ident" id="2699769">iptr</span>&nbsp;<span class="keyword" id="2699774">interface</span><span class="op" id="2699783">{</span><span class="op" id="2699784">}</span>&nbsp;<span class="op" id="2699786">=</span>&nbsp;<span class="op" id="2699788">(</span><span class="op" id="2699789">*</span><span class="ident" id="2699790">unsafe</span><span class="op" id="2699796">.</span><span class="ident" id="2699797">Pointer</span><span class="op" id="2699804">)</span><span class="op" id="2699805">(</span><span class="ident" id="2699806">nil</span><span class="op" id="2699809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699812">prototype</span>&nbsp;<span class="op" id="2699822">:=</span>&nbsp;<span class="op" id="2699825">*</span><span class="op" id="2699826">(</span><span class="op" id="2699827">*</span><span class="op" id="2699828">*</span><span class="ident" id="2699829">ptrType</span><span class="op" id="2699836">)</span><span class="op" id="2699837">(</span><span class="ident" id="2699838">unsafe</span><span class="op" id="2699844">.</span><span class="ident" id="2699845">Pointer</span><span class="op" id="2699852">(</span><span class="op" id="2699853">&amp;</span><span class="ident" id="2699854">iptr</span><span class="op" id="2699858">)</span><span class="op" id="2699859">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699862">*</span><span class="ident" id="2699863">p</span>&nbsp;<span class="op" id="2699865">=</span>&nbsp;<span class="op" id="2699867">*</span><span class="ident" id="2699868">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699880">s</span>&nbsp;<span class="op" id="2699882">:=</span>&nbsp;<span class="string" id="2699885">&#34;*&#34;</span>&nbsp;<span class="op" id="2699889">+</span>&nbsp;<span class="op" id="2699891">*</span><span class="ident" id="2699892">t</span><span class="op" id="2699893">.</span><span class="builtintype" id="2699894">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699902">p</span><span class="op" id="2699903">.</span><span class="builtintype" id="2699904">string</span>&nbsp;<span class="op" id="2699911">=</span>&nbsp;<span class="op" id="2699913">&amp;</span><span class="ident" id="2699914">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699918">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699974">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2700023">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2700074">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2700126">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700156">p</span><span class="op" id="2700157">.</span><span class="ident" id="2700158">hash</span>&nbsp;<span class="op" id="2700163">=</span>&nbsp;<span class="ident" id="2700165">fnv1</span><span class="op" id="2700169">(</span><span class="ident" id="2700170">t</span><span class="op" id="2700171">.</span><span class="ident" id="2700172">hash</span><span class="op" id="2700176">,</span>&nbsp;<span class="string" id="2700178">&#39;*&#39;</span><span class="op" id="2700181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700185">p</span><span class="op" id="2700186">.</span><span class="ident" id="2700187">uncommonType</span>&nbsp;<span class="op" id="2700200">=</span>&nbsp;<span class="ident" id="2700202">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700207">p</span><span class="op" id="2700208">.</span><span class="ident" id="2700209">ptrToThis</span>&nbsp;<span class="op" id="2700219">=</span>&nbsp;<span class="ident" id="2700221">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700226">p</span><span class="op" id="2700227">.</span><span class="ident" id="2700228">zero</span>&nbsp;<span class="op" id="2700233">=</span>&nbsp;<span class="ident" id="2700235">unsafe</span><span class="op" id="2700241">.</span><span class="ident" id="2700242">Pointer</span><span class="op" id="2700249">(</span><span class="op" id="2700250">&amp;</span><span class="builtinfunc" id="2700251">make</span><span class="op" id="2700255">(</span><span class="op" id="2700256">[</span><span class="op" id="2700257">]</span><span class="builtintype" id="2700258">byte</span><span class="op" id="2700262">,</span>&nbsp;<span class="ident" id="2700264">p</span><span class="op" id="2700265">.</span><span class="ident" id="2700266">size</span><span class="op" id="2700270">)</span><span class="op" id="2700271">[</span><span class="num" id="2700272">0</span><span class="op" id="2700273">]</span><span class="op" id="2700274">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700277">p</span><span class="op" id="2700278">.</span><span class="ident" id="2700279">elem</span>&nbsp;<span class="op" id="2700284">=</span>&nbsp;<span class="ident" id="2700286">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700290">ptrMap</span><span class="op" id="2700296">.</span><span class="ident" id="2700297">m</span><span class="op" id="2700298">[</span><span class="ident" id="2700299">t</span><span class="op" id="2700300">]</span>&nbsp;<span class="op" id="2700302">=</span>&nbsp;<span class="ident" id="2700304">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700307">ptrMap</span><span class="op" id="2700313">.</span><span class="ident" id="2700314">Unlock</span><span class="op" id="2700320">(</span><span class="op" id="2700321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700324">return</span>&nbsp;<span class="op" id="2700331">&amp;</span><span class="ident" id="2700332">p</span><span class="op" id="2700333">.</span><span class="ident" id="2700334">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2700340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2700343">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2700429">func</span>&nbsp;<span class="ident" id="2700434">fnv1</span><span class="op" id="2700438">(</span><span class="ident" id="2700439">x</span>&nbsp;<span class="builtintype" id="2700441">uint32</span><span class="op" id="2700447">,</span>&nbsp;<span class="ident" id="2700449">list</span>&nbsp;<span class="op" id="2700454">...</span><span class="builtintype" id="2700457">byte</span><span class="op" id="2700461">)</span>&nbsp;<span class="builtintype" id="2700463">uint32</span>&nbsp;<span class="op" id="2700470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700473">for</span>&nbsp;<span class="ident" id="2700477">_</span><span class="op" id="2700478">,</span>&nbsp;<span class="ident" id="2700480">b</span>&nbsp;<span class="op" id="2700482">:=</span>&nbsp;<span class="keyword" id="2700485">range</span>&nbsp;<span class="ident" id="2700491">list</span>&nbsp;<span class="op" id="2700496">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700500">x</span>&nbsp;<span class="op" id="2700502">=</span>&nbsp;<span class="ident" id="2700504">x</span><span class="op" id="2700505">*</span><span class="num" id="2700506">16777619</span>&nbsp;<span class="op" id="2700515">^</span>&nbsp;<span class="builtintype" id="2700517">uint32</span><span class="op" id="2700523">(</span><span class="ident" id="2700524">b</span><span class="op" id="2700525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700531">return</span>&nbsp;<span class="ident" id="2700538">x</span><br>
<span class="lineno"></span><span class="op" id="2700540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2700543">func</span>&nbsp;<span class="op" id="2700548">(</span><span class="ident" id="2700549">t</span>&nbsp;<span class="op" id="2700551">*</span><span class="ident" id="2700552">rtype</span><span class="op" id="2700557">)</span>&nbsp;<span class="ident" id="2700559">Implements</span><span class="op" id="2700569">(</span><span class="ident" id="2700570">u</span>&nbsp;<span class="ident" id="2700572">Type</span><span class="op" id="2700576">)</span>&nbsp;<span class="builtintype" id="2700578">bool</span>&nbsp;<span class="op" id="2700583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700586">if</span>&nbsp;<span class="ident" id="2700589">u</span>&nbsp;<span class="op" id="2700591">==</span>&nbsp;<span class="ident" id="2700594">nil</span>&nbsp;<span class="op" id="2700598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2700602">panic</span><span class="op" id="2700607">(</span><span class="string" id="2700608">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2700653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700659">if</span>&nbsp;<span class="ident" id="2700662">u</span><span class="op" id="2700663">.</span><span class="ident" id="2700664">Kind</span><span class="op" id="2700668">(</span><span class="op" id="2700669">)</span>&nbsp;<span class="op" id="2700671">!=</span>&nbsp;<span class="ident" id="2700674">Interface</span>&nbsp;<span class="op" id="2700684">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2700688">panic</span><span class="op" id="2700693">(</span><span class="string" id="2700694">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2700749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700755">return</span>&nbsp;<span class="ident" id="2700762">implements</span><span class="op" id="2700772">(</span><span class="ident" id="2700773">u</span><span class="op" id="2700774">.</span><span class="op" id="2700775">(</span><span class="op" id="2700776">*</span><span class="ident" id="2700777">rtype</span><span class="op" id="2700782">)</span><span class="op" id="2700783">,</span>&nbsp;<span class="ident" id="2700785">t</span><span class="op" id="2700786">)</span><br>
<span class="lineno"></span><span class="op" id="2700788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2700791">func</span>&nbsp;<span class="op" id="2700796">(</span><span class="ident" id="2700797">t</span>&nbsp;<span class="op" id="2700799">*</span><span class="ident" id="2700800">rtype</span><span class="op" id="2700805">)</span>&nbsp;<span class="ident" id="2700807">AssignableTo</span><span class="op" id="2700819">(</span><span class="ident" id="2700820">u</span>&nbsp;<span class="ident" id="2700822">Type</span><span class="op" id="2700826">)</span>&nbsp;<span class="builtintype" id="2700828">bool</span>&nbsp;<span class="op" id="2700833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700836">if</span>&nbsp;<span class="ident" id="2700839">u</span>&nbsp;<span class="op" id="2700841">==</span>&nbsp;<span class="ident" id="2700844">nil</span>&nbsp;<span class="op" id="2700848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2700852">panic</span><span class="op" id="2700857">(</span><span class="string" id="2700858">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2700905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700911">uu</span>&nbsp;<span class="op" id="2700914">:=</span>&nbsp;<span class="ident" id="2700917">u</span><span class="op" id="2700918">.</span><span class="op" id="2700919">(</span><span class="op" id="2700920">*</span><span class="ident" id="2700921">rtype</span><span class="op" id="2700926">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700929">return</span>&nbsp;<span class="ident" id="2700936">directlyAssignable</span><span class="op" id="2700954">(</span><span class="ident" id="2700955">uu</span><span class="op" id="2700957">,</span>&nbsp;<span class="ident" id="2700959">t</span><span class="op" id="2700960">)</span>&nbsp;<span class="op" id="2700962">||</span>&nbsp;<span class="ident" id="2700965">implements</span><span class="op" id="2700975">(</span><span class="ident" id="2700976">uu</span><span class="op" id="2700978">,</span>&nbsp;<span class="ident" id="2700980">t</span><span class="op" id="2700981">)</span><br>
<span class="lineno"></span><span class="op" id="2700983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2700986">func</span>&nbsp;<span class="op" id="2700991">(</span><span class="ident" id="2700992">t</span>&nbsp;<span class="op" id="2700994">*</span><span class="ident" id="2700995">rtype</span><span class="op" id="2701000">)</span>&nbsp;<span class="ident" id="2701002">ConvertibleTo</span><span class="op" id="2701015">(</span><span class="ident" id="2701016">u</span>&nbsp;<span class="ident" id="2701018">Type</span><span class="op" id="2701022">)</span>&nbsp;<span class="builtintype" id="2701024">bool</span>&nbsp;<span class="op" id="2701029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701032">if</span>&nbsp;<span class="ident" id="2701035">u</span>&nbsp;<span class="op" id="2701037">==</span>&nbsp;<span class="ident" id="2701040">nil</span>&nbsp;<span class="op" id="2701044">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2701048">panic</span><span class="op" id="2701053">(</span><span class="string" id="2701054">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2701102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701108">uu</span>&nbsp;<span class="op" id="2701111">:=</span>&nbsp;<span class="ident" id="2701114">u</span><span class="op" id="2701115">.</span><span class="op" id="2701116">(</span><span class="op" id="2701117">*</span><span class="ident" id="2701118">rtype</span><span class="op" id="2701123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701126">return</span>&nbsp;<span class="ident" id="2701133">convertOp</span><span class="op" id="2701142">(</span><span class="ident" id="2701143">uu</span><span class="op" id="2701145">,</span>&nbsp;<span class="ident" id="2701147">t</span><span class="op" id="2701148">)</span>&nbsp;<span class="op" id="2701150">!=</span>&nbsp;<span class="ident" id="2701153">nil</span><br>
<span class="lineno"></span><span class="op" id="2701157">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2701160">func</span>&nbsp;<span class="op" id="2701165">(</span><span class="ident" id="2701166">t</span>&nbsp;<span class="op" id="2701168">*</span><span class="ident" id="2701169">rtype</span><span class="op" id="2701174">)</span>&nbsp;<span class="ident" id="2701176">Comparable</span><span class="op" id="2701186">(</span><span class="op" id="2701187">)</span>&nbsp;<span class="builtintype" id="2701189">bool</span>&nbsp;<span class="op" id="2701194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701197">return</span>&nbsp;<span class="ident" id="2701204">t</span><span class="op" id="2701205">.</span><span class="ident" id="2701206">alg</span>&nbsp;<span class="op" id="2701210">!=</span>&nbsp;<span class="ident" id="2701213">nil</span>&nbsp;<span class="op" id="2701217">&amp;&amp;</span>&nbsp;<span class="ident" id="2701220">t</span><span class="op" id="2701221">.</span><span class="ident" id="2701222">alg</span><span class="op" id="2701225">.</span><span class="ident" id="2701226">equal</span>&nbsp;<span class="op" id="2701232">!=</span>&nbsp;<span class="ident" id="2701235">nil</span><br>
<span class="lineno"></span><span class="op" id="2701239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2701242">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2701316">func</span>&nbsp;<span class="ident" id="2701321">implements</span><span class="op" id="2701331">(</span><span class="ident" id="2701332">T</span><span class="op" id="2701333">,</span>&nbsp;<span class="ident" id="2701335">V</span>&nbsp;<span class="op" id="2701337">*</span><span class="ident" id="2701338">rtype</span><span class="op" id="2701343">)</span>&nbsp;<span class="builtintype" id="2701345">bool</span>&nbsp;<span class="op" id="2701350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701353">if</span>&nbsp;<span class="ident" id="2701356">T</span><span class="op" id="2701357">.</span><span class="ident" id="2701358">Kind</span><span class="op" id="2701362">(</span><span class="op" id="2701363">)</span>&nbsp;<span class="op" id="2701365">!=</span>&nbsp;<span class="ident" id="2701368">Interface</span>&nbsp;<span class="op" id="2701378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701382">return</span>&nbsp;<span class="builtintype" id="2701389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701396">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701399">t</span>&nbsp;<span class="op" id="2701401">:=</span>&nbsp;<span class="op" id="2701404">(</span><span class="op" id="2701405">*</span><span class="ident" id="2701406">interfaceType</span><span class="op" id="2701419">)</span><span class="op" id="2701420">(</span><span class="ident" id="2701421">unsafe</span><span class="op" id="2701427">.</span><span class="ident" id="2701428">Pointer</span><span class="op" id="2701435">(</span><span class="ident" id="2701436">T</span><span class="op" id="2701437">)</span><span class="op" id="2701438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701441">if</span>&nbsp;<span class="builtinfunc" id="2701444">len</span><span class="op" id="2701447">(</span><span class="ident" id="2701448">t</span><span class="op" id="2701449">.</span><span class="ident" id="2701450">methods</span><span class="op" id="2701457">)</span>&nbsp;<span class="op" id="2701459">==</span>&nbsp;<span class="num" id="2701462">0</span>&nbsp;<span class="op" id="2701464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701468">return</span>&nbsp;<span class="builtintype" id="2701475">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701485">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701539">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701599">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701645">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701707">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701765">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701825">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701886">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701943">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2702002">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2702066">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2702120">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702153">if</span>&nbsp;<span class="ident" id="2702156">V</span><span class="op" id="2702157">.</span><span class="ident" id="2702158">Kind</span><span class="op" id="2702162">(</span><span class="op" id="2702163">)</span>&nbsp;<span class="op" id="2702165">==</span>&nbsp;<span class="ident" id="2702168">Interface</span>&nbsp;<span class="op" id="2702178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702182">v</span>&nbsp;<span class="op" id="2702184">:=</span>&nbsp;<span class="op" id="2702187">(</span><span class="op" id="2702188">*</span><span class="ident" id="2702189">interfaceType</span><span class="op" id="2702202">)</span><span class="op" id="2702203">(</span><span class="ident" id="2702204">unsafe</span><span class="op" id="2702210">.</span><span class="ident" id="2702211">Pointer</span><span class="op" id="2702218">(</span><span class="ident" id="2702219">V</span><span class="op" id="2702220">)</span><span class="op" id="2702221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702225">i</span>&nbsp;<span class="op" id="2702227">:=</span>&nbsp;<span class="num" id="2702230">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702234">for</span>&nbsp;<span class="ident" id="2702238">j</span>&nbsp;<span class="op" id="2702240">:=</span>&nbsp;<span class="num" id="2702243">0</span><span class="op" id="2702244">;</span>&nbsp;<span class="ident" id="2702246">j</span>&nbsp;<span class="op" id="2702248">&lt;</span>&nbsp;<span class="builtinfunc" id="2702250">len</span><span class="op" id="2702253">(</span><span class="ident" id="2702254">v</span><span class="op" id="2702255">.</span><span class="ident" id="2702256">methods</span><span class="op" id="2702263">)</span><span class="op" id="2702264">;</span>&nbsp;<span class="ident" id="2702266">j</span><span class="op" id="2702267">++</span>&nbsp;<span class="op" id="2702270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702275">tm</span>&nbsp;<span class="op" id="2702278">:=</span>&nbsp;<span class="op" id="2702281">&amp;</span><span class="ident" id="2702282">t</span><span class="op" id="2702283">.</span><span class="ident" id="2702284">methods</span><span class="op" id="2702291">[</span><span class="ident" id="2702292">i</span><span class="op" id="2702293">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702298">vm</span>&nbsp;<span class="op" id="2702301">:=</span>&nbsp;<span class="op" id="2702304">&amp;</span><span class="ident" id="2702305">v</span><span class="op" id="2702306">.</span><span class="ident" id="2702307">methods</span><span class="op" id="2702314">[</span><span class="ident" id="2702315">j</span><span class="op" id="2702316">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702321">if</span>&nbsp;<span class="ident" id="2702324">vm</span><span class="op" id="2702326">.</span><span class="ident" id="2702327">name</span>&nbsp;<span class="op" id="2702332">==</span>&nbsp;<span class="ident" id="2702335">tm</span><span class="op" id="2702337">.</span><span class="ident" id="2702338">name</span>&nbsp;<span class="op" id="2702343">&amp;&amp;</span>&nbsp;<span class="ident" id="2702346">vm</span><span class="op" id="2702348">.</span><span class="ident" id="2702349">pkgPath</span>&nbsp;<span class="op" id="2702357">==</span>&nbsp;<span class="ident" id="2702360">tm</span><span class="op" id="2702362">.</span><span class="ident" id="2702363">pkgPath</span>&nbsp;<span class="op" id="2702371">&amp;&amp;</span>&nbsp;<span class="ident" id="2702374">vm</span><span class="op" id="2702376">.</span><span class="ident" id="2702377">typ</span>&nbsp;<span class="op" id="2702381">==</span>&nbsp;<span class="ident" id="2702384">tm</span><span class="op" id="2702386">.</span><span class="ident" id="2702387">typ</span>&nbsp;<span class="op" id="2702391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702397">if</span>&nbsp;<span class="ident" id="2702400">i</span><span class="op" id="2702401">++</span><span class="op" id="2702403">;</span>&nbsp;<span class="ident" id="2702405">i</span>&nbsp;<span class="op" id="2702407">&gt;=</span>&nbsp;<span class="builtinfunc" id="2702410">len</span><span class="op" id="2702413">(</span><span class="ident" id="2702414">t</span><span class="op" id="2702415">.</span><span class="ident" id="2702416">methods</span><span class="op" id="2702423">)</span>&nbsp;<span class="op" id="2702425">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702432">return</span>&nbsp;<span class="builtintype" id="2702439">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702461">return</span>&nbsp;<span class="builtintype" id="2702468">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702479">v</span>&nbsp;<span class="op" id="2702481">:=</span>&nbsp;<span class="ident" id="2702484">V</span><span class="op" id="2702485">.</span><span class="ident" id="2702486">uncommon</span><span class="op" id="2702494">(</span><span class="op" id="2702495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702498">if</span>&nbsp;<span class="ident" id="2702501">v</span>&nbsp;<span class="op" id="2702503">==</span>&nbsp;<span class="ident" id="2702506">nil</span>&nbsp;<span class="op" id="2702510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702514">return</span>&nbsp;<span class="builtintype" id="2702521">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702531">i</span>&nbsp;<span class="op" id="2702533">:=</span>&nbsp;<span class="num" id="2702536">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702539">for</span>&nbsp;<span class="ident" id="2702543">j</span>&nbsp;<span class="op" id="2702545">:=</span>&nbsp;<span class="num" id="2702548">0</span><span class="op" id="2702549">;</span>&nbsp;<span class="ident" id="2702551">j</span>&nbsp;<span class="op" id="2702553">&lt;</span>&nbsp;<span class="builtinfunc" id="2702555">len</span><span class="op" id="2702558">(</span><span class="ident" id="2702559">v</span><span class="op" id="2702560">.</span><span class="ident" id="2702561">methods</span><span class="op" id="2702568">)</span><span class="op" id="2702569">;</span>&nbsp;<span class="ident" id="2702571">j</span><span class="op" id="2702572">++</span>&nbsp;<span class="op" id="2702575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702579">tm</span>&nbsp;<span class="op" id="2702582">:=</span>&nbsp;<span class="op" id="2702585">&amp;</span><span class="ident" id="2702586">t</span><span class="op" id="2702587">.</span><span class="ident" id="2702588">methods</span><span class="op" id="2702595">[</span><span class="ident" id="2702596">i</span><span class="op" id="2702597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702601">vm</span>&nbsp;<span class="op" id="2702604">:=</span>&nbsp;<span class="op" id="2702607">&amp;</span><span class="ident" id="2702608">v</span><span class="op" id="2702609">.</span><span class="ident" id="2702610">methods</span><span class="op" id="2702617">[</span><span class="ident" id="2702618">j</span><span class="op" id="2702619">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702623">if</span>&nbsp;<span class="ident" id="2702626">vm</span><span class="op" id="2702628">.</span><span class="ident" id="2702629">name</span>&nbsp;<span class="op" id="2702634">==</span>&nbsp;<span class="ident" id="2702637">tm</span><span class="op" id="2702639">.</span><span class="ident" id="2702640">name</span>&nbsp;<span class="op" id="2702645">&amp;&amp;</span>&nbsp;<span class="ident" id="2702648">vm</span><span class="op" id="2702650">.</span><span class="ident" id="2702651">pkgPath</span>&nbsp;<span class="op" id="2702659">==</span>&nbsp;<span class="ident" id="2702662">tm</span><span class="op" id="2702664">.</span><span class="ident" id="2702665">pkgPath</span>&nbsp;<span class="op" id="2702673">&amp;&amp;</span>&nbsp;<span class="ident" id="2702676">vm</span><span class="op" id="2702678">.</span><span class="ident" id="2702679">mtyp</span>&nbsp;<span class="op" id="2702684">==</span>&nbsp;<span class="ident" id="2702687">tm</span><span class="op" id="2702689">.</span><span class="ident" id="2702690">typ</span>&nbsp;<span class="op" id="2702694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702699">if</span>&nbsp;<span class="ident" id="2702702">i</span><span class="op" id="2702703">++</span><span class="op" id="2702705">;</span>&nbsp;<span class="ident" id="2702707">i</span>&nbsp;<span class="op" id="2702709">&gt;=</span>&nbsp;<span class="builtinfunc" id="2702712">len</span><span class="op" id="2702715">(</span><span class="ident" id="2702716">t</span><span class="op" id="2702717">.</span><span class="ident" id="2702718">methods</span><span class="op" id="2702725">)</span>&nbsp;<span class="op" id="2702727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702733">return</span>&nbsp;<span class="builtintype" id="2702740">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702752">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702758">return</span>&nbsp;<span class="builtintype" id="2702765">false</span><br>
<span class="lineno"></span><span class="op" id="2702771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2702774">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2702848">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2702898">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2702950">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2703006">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2703072">func</span>&nbsp;<span class="ident" id="2703077">directlyAssignable</span><span class="op" id="2703095">(</span><span class="ident" id="2703096">T</span><span class="op" id="2703097">,</span>&nbsp;<span class="ident" id="2703099">V</span>&nbsp;<span class="op" id="2703101">*</span><span class="ident" id="2703102">rtype</span><span class="op" id="2703107">)</span>&nbsp;<span class="builtintype" id="2703109">bool</span>&nbsp;<span class="op" id="2703114">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703117">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703151">if</span>&nbsp;<span class="ident" id="2703154">T</span>&nbsp;<span class="op" id="2703156">==</span>&nbsp;<span class="ident" id="2703159">V</span>&nbsp;<span class="op" id="2703161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703165">return</span>&nbsp;<span class="builtintype" id="2703172">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703182">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703236">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703274">if</span>&nbsp;<span class="ident" id="2703277">T</span><span class="op" id="2703278">.</span><span class="ident" id="2703279">Name</span><span class="op" id="2703283">(</span><span class="op" id="2703284">)</span>&nbsp;<span class="op" id="2703286">!=</span>&nbsp;<span class="string" id="2703289">&#34;&#34;</span>&nbsp;<span class="op" id="2703292">&amp;&amp;</span>&nbsp;<span class="ident" id="2703295">V</span><span class="op" id="2703296">.</span><span class="ident" id="2703297">Name</span><span class="op" id="2703301">(</span><span class="op" id="2703302">)</span>&nbsp;<span class="op" id="2703304">!=</span>&nbsp;<span class="string" id="2703307">&#34;&#34;</span>&nbsp;<span class="op" id="2703310">||</span>&nbsp;<span class="ident" id="2703313">T</span><span class="op" id="2703314">.</span><span class="ident" id="2703315">Kind</span><span class="op" id="2703319">(</span><span class="op" id="2703320">)</span>&nbsp;<span class="op" id="2703322">!=</span>&nbsp;<span class="ident" id="2703325">V</span><span class="op" id="2703326">.</span><span class="ident" id="2703327">Kind</span><span class="op" id="2703331">(</span><span class="op" id="2703332">)</span>&nbsp;<span class="op" id="2703334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703338">return</span>&nbsp;<span class="builtintype" id="2703345">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703352">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703356">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703416">return</span>&nbsp;<span class="ident" id="2703423">haveIdenticalUnderlyingType</span><span class="op" id="2703450">(</span><span class="ident" id="2703451">T</span><span class="op" id="2703452">,</span>&nbsp;<span class="ident" id="2703454">V</span><span class="op" id="2703455">)</span><br>
<span class="lineno"></span><span class="op" id="2703457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2703460">func</span>&nbsp;<span class="ident" id="2703465">haveIdenticalUnderlyingType</span><span class="op" id="2703492">(</span><span class="ident" id="2703493">T</span><span class="op" id="2703494">,</span>&nbsp;<span class="ident" id="2703496">V</span>&nbsp;<span class="op" id="2703498">*</span><span class="ident" id="2703499">rtype</span><span class="op" id="2703504">)</span>&nbsp;<span class="builtintype" id="2703506">bool</span>&nbsp;<span class="op" id="2703511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703514">if</span>&nbsp;<span class="ident" id="2703517">T</span>&nbsp;<span class="op" id="2703519">==</span>&nbsp;<span class="ident" id="2703522">V</span>&nbsp;<span class="op" id="2703524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703528">return</span>&nbsp;<span class="builtintype" id="2703535">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703545">kind</span>&nbsp;<span class="op" id="2703550">:=</span>&nbsp;<span class="ident" id="2703553">T</span><span class="op" id="2703554">.</span><span class="ident" id="2703555">Kind</span><span class="op" id="2703559">(</span><span class="op" id="2703560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703563">if</span>&nbsp;<span class="ident" id="2703566">kind</span>&nbsp;<span class="op" id="2703571">!=</span>&nbsp;<span class="ident" id="2703574">V</span><span class="op" id="2703575">.</span><span class="ident" id="2703576">Kind</span><span class="op" id="2703580">(</span><span class="op" id="2703581">)</span>&nbsp;<span class="op" id="2703583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703587">return</span>&nbsp;<span class="builtintype" id="2703594">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703605">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703669">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703712">if</span>&nbsp;<span class="ident" id="2703715">Bool</span>&nbsp;<span class="op" id="2703720">&lt;=</span>&nbsp;<span class="ident" id="2703723">kind</span>&nbsp;<span class="op" id="2703728">&amp;&amp;</span>&nbsp;<span class="ident" id="2703731">kind</span>&nbsp;<span class="op" id="2703736">&lt;=</span>&nbsp;<span class="ident" id="2703739">Complex128</span>&nbsp;<span class="op" id="2703750">||</span>&nbsp;<span class="ident" id="2703753">kind</span>&nbsp;<span class="op" id="2703758">==</span>&nbsp;<span class="ident" id="2703761">String</span>&nbsp;<span class="op" id="2703768">||</span>&nbsp;<span class="ident" id="2703771">kind</span>&nbsp;<span class="op" id="2703776">==</span>&nbsp;<span class="ident" id="2703779">UnsafePointer</span>&nbsp;<span class="op" id="2703793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703797">return</span>&nbsp;<span class="builtintype" id="2703804">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703810">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703814">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703835">switch</span>&nbsp;<span class="ident" id="2703842">kind</span>&nbsp;<span class="op" id="2703847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703850">case</span>&nbsp;<span class="ident" id="2703855">Array</span><span class="op" id="2703860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703864">return</span>&nbsp;<span class="ident" id="2703871">T</span><span class="op" id="2703872">.</span><span class="ident" id="2703873">Elem</span><span class="op" id="2703877">(</span><span class="op" id="2703878">)</span>&nbsp;<span class="op" id="2703880">==</span>&nbsp;<span class="ident" id="2703883">V</span><span class="op" id="2703884">.</span><span class="ident" id="2703885">Elem</span><span class="op" id="2703889">(</span><span class="op" id="2703890">)</span>&nbsp;<span class="op" id="2703892">&amp;&amp;</span>&nbsp;<span class="ident" id="2703895">T</span><span class="op" id="2703896">.</span><span class="ident" id="2703897">Len</span><span class="op" id="2703900">(</span><span class="op" id="2703901">)</span>&nbsp;<span class="op" id="2703903">==</span>&nbsp;<span class="ident" id="2703906">V</span><span class="op" id="2703907">.</span><span class="ident" id="2703908">Len</span><span class="op" id="2703911">(</span><span class="op" id="2703912">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703916">case</span>&nbsp;<span class="ident" id="2703921">Chan</span><span class="op" id="2703925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703929">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703948">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2704010">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704066">if</span>&nbsp;<span class="ident" id="2704069">V</span><span class="op" id="2704070">.</span><span class="ident" id="2704071">ChanDir</span><span class="op" id="2704078">(</span><span class="op" id="2704079">)</span>&nbsp;<span class="op" id="2704081">==</span>&nbsp;<span class="ident" id="2704084">BothDir</span>&nbsp;<span class="op" id="2704092">&amp;&amp;</span>&nbsp;<span class="ident" id="2704095">T</span><span class="op" id="2704096">.</span><span class="ident" id="2704097">Elem</span><span class="op" id="2704101">(</span><span class="op" id="2704102">)</span>&nbsp;<span class="op" id="2704104">==</span>&nbsp;<span class="ident" id="2704107">V</span><span class="op" id="2704108">.</span><span class="ident" id="2704109">Elem</span><span class="op" id="2704113">(</span><span class="op" id="2704114">)</span>&nbsp;<span class="op" id="2704116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704121">return</span>&nbsp;<span class="builtintype" id="2704128">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2704140">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704200">return</span>&nbsp;<span class="ident" id="2704207">V</span><span class="op" id="2704208">.</span><span class="ident" id="2704209">ChanDir</span><span class="op" id="2704216">(</span><span class="op" id="2704217">)</span>&nbsp;<span class="op" id="2704219">==</span>&nbsp;<span class="ident" id="2704222">T</span><span class="op" id="2704223">.</span><span class="ident" id="2704224">ChanDir</span><span class="op" id="2704231">(</span><span class="op" id="2704232">)</span>&nbsp;<span class="op" id="2704234">&amp;&amp;</span>&nbsp;<span class="ident" id="2704237">T</span><span class="op" id="2704238">.</span><span class="ident" id="2704239">Elem</span><span class="op" id="2704243">(</span><span class="op" id="2704244">)</span>&nbsp;<span class="op" id="2704246">==</span>&nbsp;<span class="ident" id="2704249">V</span><span class="op" id="2704250">.</span><span class="ident" id="2704251">Elem</span><span class="op" id="2704255">(</span><span class="op" id="2704256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704260">case</span>&nbsp;<span class="ident" id="2704265">Func</span><span class="op" id="2704269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704273">t</span>&nbsp;<span class="op" id="2704275">:=</span>&nbsp;<span class="op" id="2704278">(</span><span class="op" id="2704279">*</span><span class="ident" id="2704280">funcType</span><span class="op" id="2704288">)</span><span class="op" id="2704289">(</span><span class="ident" id="2704290">unsafe</span><span class="op" id="2704296">.</span><span class="ident" id="2704297">Pointer</span><span class="op" id="2704304">(</span><span class="ident" id="2704305">T</span><span class="op" id="2704306">)</span><span class="op" id="2704307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704311">v</span>&nbsp;<span class="op" id="2704313">:=</span>&nbsp;<span class="op" id="2704316">(</span><span class="op" id="2704317">*</span><span class="ident" id="2704318">funcType</span><span class="op" id="2704326">)</span><span class="op" id="2704327">(</span><span class="ident" id="2704328">unsafe</span><span class="op" id="2704334">.</span><span class="ident" id="2704335">Pointer</span><span class="op" id="2704342">(</span><span class="ident" id="2704343">V</span><span class="op" id="2704344">)</span><span class="op" id="2704345">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704349">if</span>&nbsp;<span class="ident" id="2704352">t</span><span class="op" id="2704353">.</span><span class="ident" id="2704354">dotdotdot</span>&nbsp;<span class="op" id="2704364">!=</span>&nbsp;<span class="ident" id="2704367">v</span><span class="op" id="2704368">.</span><span class="ident" id="2704369">dotdotdot</span>&nbsp;<span class="op" id="2704379">||</span>&nbsp;<span class="builtinfunc" id="2704382">len</span><span class="op" id="2704385">(</span><span class="ident" id="2704386">t</span><span class="op" id="2704387">.</span><span class="ident" id="2704388">in</span><span class="op" id="2704390">)</span>&nbsp;<span class="op" id="2704392">!=</span>&nbsp;<span class="builtinfunc" id="2704395">len</span><span class="op" id="2704398">(</span><span class="ident" id="2704399">v</span><span class="op" id="2704400">.</span><span class="ident" id="2704401">in</span><span class="op" id="2704403">)</span>&nbsp;<span class="op" id="2704405">||</span>&nbsp;<span class="builtinfunc" id="2704408">len</span><span class="op" id="2704411">(</span><span class="ident" id="2704412">t</span><span class="op" id="2704413">.</span><span class="ident" id="2704414">out</span><span class="op" id="2704417">)</span>&nbsp;<span class="op" id="2704419">!=</span>&nbsp;<span class="builtinfunc" id="2704422">len</span><span class="op" id="2704425">(</span><span class="ident" id="2704426">v</span><span class="op" id="2704427">.</span><span class="ident" id="2704428">out</span><span class="op" id="2704431">)</span>&nbsp;<span class="op" id="2704433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704438">return</span>&nbsp;<span class="builtintype" id="2704445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704457">for</span>&nbsp;<span class="ident" id="2704461">i</span><span class="op" id="2704462">,</span>&nbsp;<span class="ident" id="2704464">typ</span>&nbsp;<span class="op" id="2704468">:=</span>&nbsp;<span class="keyword" id="2704471">range</span>&nbsp;<span class="ident" id="2704477">t</span><span class="op" id="2704478">.</span><span class="ident" id="2704479">in</span>&nbsp;<span class="op" id="2704482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704487">if</span>&nbsp;<span class="ident" id="2704490">typ</span>&nbsp;<span class="op" id="2704494">!=</span>&nbsp;<span class="ident" id="2704497">v</span><span class="op" id="2704498">.</span><span class="ident" id="2704499">in</span><span class="op" id="2704501">[</span><span class="ident" id="2704502">i</span><span class="op" id="2704503">]</span>&nbsp;<span class="op" id="2704505">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704511">return</span>&nbsp;<span class="builtintype" id="2704518">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704535">for</span>&nbsp;<span class="ident" id="2704539">i</span><span class="op" id="2704540">,</span>&nbsp;<span class="ident" id="2704542">typ</span>&nbsp;<span class="op" id="2704546">:=</span>&nbsp;<span class="keyword" id="2704549">range</span>&nbsp;<span class="ident" id="2704555">t</span><span class="op" id="2704556">.</span><span class="ident" id="2704557">out</span>&nbsp;<span class="op" id="2704561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704566">if</span>&nbsp;<span class="ident" id="2704569">typ</span>&nbsp;<span class="op" id="2704573">!=</span>&nbsp;<span class="ident" id="2704576">v</span><span class="op" id="2704577">.</span><span class="ident" id="2704578">out</span><span class="op" id="2704581">[</span><span class="ident" id="2704582">i</span><span class="op" id="2704583">]</span>&nbsp;<span class="op" id="2704585">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704591">return</span>&nbsp;<span class="builtintype" id="2704598">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704615">return</span>&nbsp;<span class="builtintype" id="2704622">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704629">case</span>&nbsp;<span class="ident" id="2704634">Interface</span><span class="op" id="2704643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704647">t</span>&nbsp;<span class="op" id="2704649">:=</span>&nbsp;<span class="op" id="2704652">(</span><span class="op" id="2704653">*</span><span class="ident" id="2704654">interfaceType</span><span class="op" id="2704667">)</span><span class="op" id="2704668">(</span><span class="ident" id="2704669">unsafe</span><span class="op" id="2704675">.</span><span class="ident" id="2704676">Pointer</span><span class="op" id="2704683">(</span><span class="ident" id="2704684">T</span><span class="op" id="2704685">)</span><span class="op" id="2704686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704690">v</span>&nbsp;<span class="op" id="2704692">:=</span>&nbsp;<span class="op" id="2704695">(</span><span class="op" id="2704696">*</span><span class="ident" id="2704697">interfaceType</span><span class="op" id="2704710">)</span><span class="op" id="2704711">(</span><span class="ident" id="2704712">unsafe</span><span class="op" id="2704718">.</span><span class="ident" id="2704719">Pointer</span><span class="op" id="2704726">(</span><span class="ident" id="2704727">V</span><span class="op" id="2704728">)</span><span class="op" id="2704729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704733">if</span>&nbsp;<span class="builtinfunc" id="2704736">len</span><span class="op" id="2704739">(</span><span class="ident" id="2704740">t</span><span class="op" id="2704741">.</span><span class="ident" id="2704742">methods</span><span class="op" id="2704749">)</span>&nbsp;<span class="op" id="2704751">==</span>&nbsp;<span class="num" id="2704754">0</span>&nbsp;<span class="op" id="2704756">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2704759">len</span><span class="op" id="2704762">(</span><span class="ident" id="2704763">v</span><span class="op" id="2704764">.</span><span class="ident" id="2704765">methods</span><span class="op" id="2704772">)</span>&nbsp;<span class="op" id="2704774">==</span>&nbsp;<span class="num" id="2704777">0</span>&nbsp;<span class="op" id="2704779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704784">return</span>&nbsp;<span class="builtintype" id="2704791">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2704802">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2704845">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704878">return</span>&nbsp;<span class="builtintype" id="2704885">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704893">case</span>&nbsp;<span class="ident" id="2704898">Map</span><span class="op" id="2704901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704905">return</span>&nbsp;<span class="ident" id="2704912">T</span><span class="op" id="2704913">.</span><span class="ident" id="2704914">Key</span><span class="op" id="2704917">(</span><span class="op" id="2704918">)</span>&nbsp;<span class="op" id="2704920">==</span>&nbsp;<span class="ident" id="2704923">V</span><span class="op" id="2704924">.</span><span class="ident" id="2704925">Key</span><span class="op" id="2704928">(</span><span class="op" id="2704929">)</span>&nbsp;<span class="op" id="2704931">&amp;&amp;</span>&nbsp;<span class="ident" id="2704934">T</span><span class="op" id="2704935">.</span><span class="ident" id="2704936">Elem</span><span class="op" id="2704940">(</span><span class="op" id="2704941">)</span>&nbsp;<span class="op" id="2704943">==</span>&nbsp;<span class="ident" id="2704946">V</span><span class="op" id="2704947">.</span><span class="ident" id="2704948">Elem</span><span class="op" id="2704952">(</span><span class="op" id="2704953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704957">case</span>&nbsp;<span class="ident" id="2704962">Ptr</span><span class="op" id="2704965">,</span>&nbsp;<span class="ident" id="2704967">Slice</span><span class="op" id="2704972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704976">return</span>&nbsp;<span class="ident" id="2704983">T</span><span class="op" id="2704984">.</span><span class="ident" id="2704985">Elem</span><span class="op" id="2704989">(</span><span class="op" id="2704990">)</span>&nbsp;<span class="op" id="2704992">==</span>&nbsp;<span class="ident" id="2704995">V</span><span class="op" id="2704996">.</span><span class="ident" id="2704997">Elem</span><span class="op" id="2705001">(</span><span class="op" id="2705002">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705006">case</span>&nbsp;<span class="ident" id="2705011">Struct</span><span class="op" id="2705017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705021">t</span>&nbsp;<span class="op" id="2705023">:=</span>&nbsp;<span class="op" id="2705026">(</span><span class="op" id="2705027">*</span><span class="ident" id="2705028">structType</span><span class="op" id="2705038">)</span><span class="op" id="2705039">(</span><span class="ident" id="2705040">unsafe</span><span class="op" id="2705046">.</span><span class="ident" id="2705047">Pointer</span><span class="op" id="2705054">(</span><span class="ident" id="2705055">T</span><span class="op" id="2705056">)</span><span class="op" id="2705057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705061">v</span>&nbsp;<span class="op" id="2705063">:=</span>&nbsp;<span class="op" id="2705066">(</span><span class="op" id="2705067">*</span><span class="ident" id="2705068">structType</span><span class="op" id="2705078">)</span><span class="op" id="2705079">(</span><span class="ident" id="2705080">unsafe</span><span class="op" id="2705086">.</span><span class="ident" id="2705087">Pointer</span><span class="op" id="2705094">(</span><span class="ident" id="2705095">V</span><span class="op" id="2705096">)</span><span class="op" id="2705097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705101">if</span>&nbsp;<span class="builtinfunc" id="2705104">len</span><span class="op" id="2705107">(</span><span class="ident" id="2705108">t</span><span class="op" id="2705109">.</span><span class="ident" id="2705110">fields</span><span class="op" id="2705116">)</span>&nbsp;<span class="op" id="2705118">!=</span>&nbsp;<span class="builtinfunc" id="2705121">len</span><span class="op" id="2705124">(</span><span class="ident" id="2705125">v</span><span class="op" id="2705126">.</span><span class="ident" id="2705127">fields</span><span class="op" id="2705133">)</span>&nbsp;<span class="op" id="2705135">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705140">return</span>&nbsp;<span class="builtintype" id="2705147">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705159">for</span>&nbsp;<span class="ident" id="2705163">i</span>&nbsp;<span class="op" id="2705165">:=</span>&nbsp;<span class="keyword" id="2705168">range</span>&nbsp;<span class="ident" id="2705174">t</span><span class="op" id="2705175">.</span><span class="ident" id="2705176">fields</span>&nbsp;<span class="op" id="2705183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705188">tf</span>&nbsp;<span class="op" id="2705191">:=</span>&nbsp;<span class="op" id="2705194">&amp;</span><span class="ident" id="2705195">t</span><span class="op" id="2705196">.</span><span class="ident" id="2705197">fields</span><span class="op" id="2705203">[</span><span class="ident" id="2705204">i</span><span class="op" id="2705205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705210">vf</span>&nbsp;<span class="op" id="2705213">:=</span>&nbsp;<span class="op" id="2705216">&amp;</span><span class="ident" id="2705217">v</span><span class="op" id="2705218">.</span><span class="ident" id="2705219">fields</span><span class="op" id="2705225">[</span><span class="ident" id="2705226">i</span><span class="op" id="2705227">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705232">if</span>&nbsp;<span class="ident" id="2705235">tf</span><span class="op" id="2705237">.</span><span class="ident" id="2705238">name</span>&nbsp;<span class="op" id="2705243">!=</span>&nbsp;<span class="ident" id="2705246">vf</span><span class="op" id="2705248">.</span><span class="ident" id="2705249">name</span>&nbsp;<span class="op" id="2705254">&amp;&amp;</span>&nbsp;<span class="op" id="2705257">(</span><span class="ident" id="2705258">tf</span><span class="op" id="2705260">.</span><span class="ident" id="2705261">name</span>&nbsp;<span class="op" id="2705266">==</span>&nbsp;<span class="ident" id="2705269">nil</span>&nbsp;<span class="op" id="2705273">||</span>&nbsp;<span class="ident" id="2705276">vf</span><span class="op" id="2705278">.</span><span class="ident" id="2705279">name</span>&nbsp;<span class="op" id="2705284">==</span>&nbsp;<span class="ident" id="2705287">nil</span>&nbsp;<span class="op" id="2705291">||</span>&nbsp;<span class="op" id="2705294">*</span><span class="ident" id="2705295">tf</span><span class="op" id="2705297">.</span><span class="ident" id="2705298">name</span>&nbsp;<span class="op" id="2705303">!=</span>&nbsp;<span class="op" id="2705306">*</span><span class="ident" id="2705307">vf</span><span class="op" id="2705309">.</span><span class="ident" id="2705310">name</span><span class="op" id="2705314">)</span>&nbsp;<span class="op" id="2705316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705322">return</span>&nbsp;<span class="builtintype" id="2705329">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705343">if</span>&nbsp;<span class="ident" id="2705346">tf</span><span class="op" id="2705348">.</span><span class="ident" id="2705349">pkgPath</span>&nbsp;<span class="op" id="2705357">!=</span>&nbsp;<span class="ident" id="2705360">vf</span><span class="op" id="2705362">.</span><span class="ident" id="2705363">pkgPath</span>&nbsp;<span class="op" id="2705371">&amp;&amp;</span>&nbsp;<span class="op" id="2705374">(</span><span class="ident" id="2705375">tf</span><span class="op" id="2705377">.</span><span class="ident" id="2705378">pkgPath</span>&nbsp;<span class="op" id="2705386">==</span>&nbsp;<span class="ident" id="2705389">nil</span>&nbsp;<span class="op" id="2705393">||</span>&nbsp;<span class="ident" id="2705396">vf</span><span class="op" id="2705398">.</span><span class="ident" id="2705399">pkgPath</span>&nbsp;<span class="op" id="2705407">==</span>&nbsp;<span class="ident" id="2705410">nil</span>&nbsp;<span class="op" id="2705414">||</span>&nbsp;<span class="op" id="2705417">*</span><span class="ident" id="2705418">tf</span><span class="op" id="2705420">.</span><span class="ident" id="2705421">pkgPath</span>&nbsp;<span class="op" id="2705429">!=</span>&nbsp;<span class="op" id="2705432">*</span><span class="ident" id="2705433">vf</span><span class="op" id="2705435">.</span><span class="ident" id="2705436">pkgPath</span><span class="op" id="2705443">)</span>&nbsp;<span class="op" id="2705445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705451">return</span>&nbsp;<span class="builtintype" id="2705458">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705472">if</span>&nbsp;<span class="ident" id="2705475">tf</span><span class="op" id="2705477">.</span><span class="ident" id="2705478">typ</span>&nbsp;<span class="op" id="2705482">!=</span>&nbsp;<span class="ident" id="2705485">vf</span><span class="op" id="2705487">.</span><span class="ident" id="2705488">typ</span>&nbsp;<span class="op" id="2705492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705498">return</span>&nbsp;<span class="builtintype" id="2705505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705519">if</span>&nbsp;<span class="ident" id="2705522">tf</span><span class="op" id="2705524">.</span><span class="ident" id="2705525">tag</span>&nbsp;<span class="op" id="2705529">!=</span>&nbsp;<span class="ident" id="2705532">vf</span><span class="op" id="2705534">.</span><span class="ident" id="2705535">tag</span>&nbsp;<span class="op" id="2705539">&amp;&amp;</span>&nbsp;<span class="op" id="2705542">(</span><span class="ident" id="2705543">tf</span><span class="op" id="2705545">.</span><span class="ident" id="2705546">tag</span>&nbsp;<span class="op" id="2705550">==</span>&nbsp;<span class="ident" id="2705553">nil</span>&nbsp;<span class="op" id="2705557">||</span>&nbsp;<span class="ident" id="2705560">vf</span><span class="op" id="2705562">.</span><span class="ident" id="2705563">tag</span>&nbsp;<span class="op" id="2705567">==</span>&nbsp;<span class="ident" id="2705570">nil</span>&nbsp;<span class="op" id="2705574">||</span>&nbsp;<span class="op" id="2705577">*</span><span class="ident" id="2705578">tf</span><span class="op" id="2705580">.</span><span class="ident" id="2705581">tag</span>&nbsp;<span class="op" id="2705585">!=</span>&nbsp;<span class="op" id="2705588">*</span><span class="ident" id="2705589">vf</span><span class="op" id="2705591">.</span><span class="ident" id="2705592">tag</span><span class="op" id="2705595">)</span>&nbsp;<span class="op" id="2705597">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705603">return</span>&nbsp;<span class="builtintype" id="2705610">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705624">if</span>&nbsp;<span class="ident" id="2705627">tf</span><span class="op" id="2705629">.</span><span class="ident" id="2705630">offset</span>&nbsp;<span class="op" id="2705637">!=</span>&nbsp;<span class="ident" id="2705640">vf</span><span class="op" id="2705642">.</span><span class="ident" id="2705643">offset</span>&nbsp;<span class="op" id="2705650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705656">return</span>&nbsp;<span class="builtintype" id="2705663">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705672">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705680">return</span>&nbsp;<span class="builtintype" id="2705687">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705697">return</span>&nbsp;<span class="builtintype" id="2705704">false</span><br>
<span class="lineno">1285</span><span class="op" id="2705710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2705713">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2705761">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2705832">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2705893">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2705952">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2706003">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2706056">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2706095">func</span>&nbsp;<span class="ident" id="2706100">typelinks</span><span class="op" id="2706109">(</span><span class="op" id="2706110">)</span>&nbsp;<span class="op" id="2706112">[</span><span class="op" id="2706113">]</span><span class="op" id="2706114">*</span><span class="ident" id="2706115">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2706122">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2706195">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2706231">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2706296">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2706352">func</span>&nbsp;<span class="ident" id="2706357">typesByString</span><span class="op" id="2706370">(</span><span class="ident" id="2706371">s</span>&nbsp;<span class="builtintype" id="2706373">string</span><span class="op" id="2706379">)</span>&nbsp;<span class="op" id="2706381">[</span><span class="op" id="2706382">]</span><span class="op" id="2706383">*</span><span class="ident" id="2706384">rtype</span>&nbsp;<span class="op" id="2706390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706393">typ</span>&nbsp;<span class="op" id="2706397">:=</span>&nbsp;<span class="ident" id="2706400">typelinks</span><span class="op" id="2706409">(</span><span class="op" id="2706410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706414">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706486">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706566">i</span><span class="op" id="2706567">,</span>&nbsp;<span class="ident" id="2706569">j</span>&nbsp;<span class="op" id="2706571">:=</span>&nbsp;<span class="num" id="2706574">0</span><span class="op" id="2706575">,</span>&nbsp;<span class="builtinfunc" id="2706577">len</span><span class="op" id="2706580">(</span><span class="ident" id="2706581">typ</span><span class="op" id="2706584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706587">for</span>&nbsp;<span class="ident" id="2706591">i</span>&nbsp;<span class="op" id="2706593">&lt;</span>&nbsp;<span class="ident" id="2706595">j</span>&nbsp;<span class="op" id="2706597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706601">h</span>&nbsp;<span class="op" id="2706603">:=</span>&nbsp;<span class="ident" id="2706606">i</span>&nbsp;<span class="op" id="2706608">+</span>&nbsp;<span class="op" id="2706610">(</span><span class="ident" id="2706611">j</span><span class="op" id="2706612">-</span><span class="ident" id="2706613">i</span><span class="op" id="2706614">)</span><span class="op" id="2706615">/</span><span class="num" id="2706616">2</span>&nbsp;<span class="comment" id="2706618">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706655">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706672">if</span>&nbsp;<span class="op" id="2706675">!</span><span class="op" id="2706676">(</span><span class="op" id="2706677">*</span><span class="ident" id="2706678">typ</span><span class="op" id="2706681">[</span><span class="ident" id="2706682">h</span><span class="op" id="2706683">]</span><span class="op" id="2706684">.</span><span class="builtintype" id="2706685">string</span>&nbsp;<span class="op" id="2706692">&gt;=</span>&nbsp;<span class="ident" id="2706695">s</span><span class="op" id="2706696">)</span>&nbsp;<span class="op" id="2706698">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706703">i</span>&nbsp;<span class="op" id="2706705">=</span>&nbsp;<span class="ident" id="2706707">h</span>&nbsp;<span class="op" id="2706709">+</span>&nbsp;<span class="num" id="2706711">1</span>&nbsp;<span class="comment" id="2706713">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706744">}</span>&nbsp;<span class="keyword" id="2706746">else</span>&nbsp;<span class="op" id="2706751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706756">j</span>&nbsp;<span class="op" id="2706758">=</span>&nbsp;<span class="ident" id="2706760">h</span>&nbsp;<span class="comment" id="2706762">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706793">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706796">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706870">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2706936">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2707000">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707032">j</span>&nbsp;<span class="op" id="2707034">=</span>&nbsp;<span class="ident" id="2707036">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707039">for</span>&nbsp;<span class="ident" id="2707043">j</span>&nbsp;<span class="op" id="2707045">&lt;</span>&nbsp;<span class="builtinfunc" id="2707047">len</span><span class="op" id="2707050">(</span><span class="ident" id="2707051">typ</span><span class="op" id="2707054">)</span>&nbsp;<span class="op" id="2707056">&amp;&amp;</span>&nbsp;<span class="op" id="2707059">*</span><span class="ident" id="2707060">typ</span><span class="op" id="2707063">[</span><span class="ident" id="2707064">j</span><span class="op" id="2707065">]</span><span class="op" id="2707066">.</span><span class="builtintype" id="2707067">string</span>&nbsp;<span class="op" id="2707074">==</span>&nbsp;<span class="ident" id="2707077">s</span>&nbsp;<span class="op" id="2707079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707083">j</span><span class="op" id="2707084">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2707092">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707149">return</span>&nbsp;<span class="ident" id="2707156">typ</span><span class="op" id="2707159">[</span><span class="ident" id="2707160">i</span><span class="op" id="2707161">:</span><span class="ident" id="2707162">j</span><span class="op" id="2707163">]</span><br>
<span class="lineno"></span><span class="op" id="2707165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2707168">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2707230">var</span>&nbsp;<span class="ident" id="2707234">lookupCache</span>&nbsp;<span class="keyword" id="2707246">struct</span>&nbsp;<span class="op" id="2707253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707256">sync</span><span class="op" id="2707260">.</span><span class="ident" id="2707261">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707270">m</span>&nbsp;<span class="keyword" id="2707272">map</span><span class="op" id="2707275">[</span><span class="ident" id="2707276">cacheKey</span><span class="op" id="2707284">]</span><span class="op" id="2707285">*</span><span class="ident" id="2707286">rtype</span><br>
<span class="lineno"></span><span class="op" id="2707292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2707295">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2707348">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2707409">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2707466">type</span>&nbsp;<span class="ident" id="2707471">cacheKey</span>&nbsp;<span class="keyword" id="2707480">struct</span>&nbsp;<span class="op" id="2707487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707490">kind</span>&nbsp;&nbsp;<span class="ident" id="2707496">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707502">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707508">*</span><span class="ident" id="2707509">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707516">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707522">*</span><span class="ident" id="2707523">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707530">extra</span>&nbsp;<span class="builtintype" id="2707536">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2707544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2707547">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2707612">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2707654">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2707703">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2707766">func</span>&nbsp;<span class="ident" id="2707771">cacheGet</span><span class="op" id="2707779">(</span><span class="ident" id="2707780">k</span>&nbsp;<span class="ident" id="2707782">cacheKey</span><span class="op" id="2707790">)</span>&nbsp;<span class="ident" id="2707792">Type</span>&nbsp;<span class="op" id="2707797">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707800">lookupCache</span><span class="op" id="2707811">.</span><span class="ident" id="2707812">RLock</span><span class="op" id="2707817">(</span><span class="op" id="2707818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707821">t</span>&nbsp;<span class="op" id="2707823">:=</span>&nbsp;<span class="ident" id="2707826">lookupCache</span><span class="op" id="2707837">.</span><span class="ident" id="2707838">m</span><span class="op" id="2707839">[</span><span class="ident" id="2707840">k</span><span class="op" id="2707841">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707844">lookupCache</span><span class="op" id="2707855">.</span><span class="ident" id="2707856">RUnlock</span><span class="op" id="2707863">(</span><span class="op" id="2707864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707867">if</span>&nbsp;<span class="ident" id="2707870">t</span>&nbsp;<span class="op" id="2707872">!=</span>&nbsp;<span class="ident" id="2707875">nil</span>&nbsp;<span class="op" id="2707879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707883">return</span>&nbsp;<span class="ident" id="2707890">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707897">lookupCache</span><span class="op" id="2707908">.</span><span class="ident" id="2707909">Lock</span><span class="op" id="2707913">(</span><span class="op" id="2707914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707917">t</span>&nbsp;<span class="op" id="2707919">=</span>&nbsp;<span class="ident" id="2707921">lookupCache</span><span class="op" id="2707932">.</span><span class="ident" id="2707933">m</span><span class="op" id="2707934">[</span><span class="ident" id="2707935">k</span><span class="op" id="2707936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707939">if</span>&nbsp;<span class="ident" id="2707942">t</span>&nbsp;<span class="op" id="2707944">!=</span>&nbsp;<span class="ident" id="2707947">nil</span>&nbsp;<span class="op" id="2707951">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707955">lookupCache</span><span class="op" id="2707966">.</span><span class="ident" id="2707967">Unlock</span><span class="op" id="2707973">(</span><span class="op" id="2707974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707978">return</span>&nbsp;<span class="ident" id="2707985">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707992">if</span>&nbsp;<span class="ident" id="2707995">lookupCache</span><span class="op" id="2708006">.</span><span class="ident" id="2708007">m</span>&nbsp;<span class="op" id="2708009">==</span>&nbsp;<span class="ident" id="2708012">nil</span>&nbsp;<span class="op" id="2708016">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708020">lookupCache</span><span class="op" id="2708031">.</span><span class="ident" id="2708032">m</span>&nbsp;<span class="op" id="2708034">=</span>&nbsp;<span class="builtinfunc" id="2708036">make</span><span class="op" id="2708040">(</span><span class="keyword" id="2708041">map</span><span class="op" id="2708044">[</span><span class="ident" id="2708045">cacheKey</span><span class="op" id="2708053">]</span><span class="op" id="2708054">*</span><span class="ident" id="2708055">rtype</span><span class="op" id="2708060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708067">return</span>&nbsp;<span class="ident" id="2708074">nil</span><br>
<span class="lineno"></span><span class="op" id="2708078">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2708081">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2708148">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2708213">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2708247">func</span>&nbsp;<span class="ident" id="2708252">cachePut</span><span class="op" id="2708260">(</span><span class="ident" id="2708261">k</span>&nbsp;<span class="ident" id="2708263">cacheKey</span><span class="op" id="2708271">,</span>&nbsp;<span class="ident" id="2708273">t</span>&nbsp;<span class="op" id="2708275">*</span><span class="ident" id="2708276">rtype</span><span class="op" id="2708281">)</span>&nbsp;<span class="ident" id="2708283">Type</span>&nbsp;<span class="op" id="2708288">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708291">lookupCache</span><span class="op" id="2708302">.</span><span class="ident" id="2708303">m</span><span class="op" id="2708304">[</span><span class="ident" id="2708305">k</span><span class="op" id="2708306">]</span>&nbsp;<span class="op" id="2708308">=</span>&nbsp;<span class="ident" id="2708310">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708313">lookupCache</span><span class="op" id="2708324">.</span><span class="ident" id="2708325">Unlock</span><span class="op" id="2708331">(</span><span class="op" id="2708332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708335">return</span>&nbsp;<span class="ident" id="2708342">t</span><br>
<span class="lineno"></span><span class="op" id="2708344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2708347">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2708425">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2708504">//</span><br>
<span class="lineno"></span><span class="comment" id="2708507">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2708576">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2708641">func</span>&nbsp;<span class="ident" id="2708646">ChanOf</span><span class="op" id="2708652">(</span><span class="ident" id="2708653">dir</span>&nbsp;<span class="ident" id="2708657">ChanDir</span><span class="op" id="2708664">,</span>&nbsp;<span class="ident" id="2708666">t</span>&nbsp;<span class="ident" id="2708668">Type</span><span class="op" id="2708672">)</span>&nbsp;<span class="ident" id="2708674">Type</span>&nbsp;<span class="op" id="2708679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708682">typ</span>&nbsp;<span class="op" id="2708686">:=</span>&nbsp;<span class="ident" id="2708689">t</span><span class="op" id="2708690">.</span><span class="op" id="2708691">(</span><span class="op" id="2708692">*</span><span class="ident" id="2708693">rtype</span><span class="op" id="2708698">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708702">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708721">ckey</span>&nbsp;<span class="op" id="2708726">:=</span>&nbsp;<span class="ident" id="2708729">cacheKey</span><span class="op" id="2708737">{</span><span class="ident" id="2708738">Chan</span><span class="op" id="2708742">,</span>&nbsp;<span class="ident" id="2708744">typ</span><span class="op" id="2708747">,</span>&nbsp;<span class="ident" id="2708749">nil</span><span class="op" id="2708752">,</span>&nbsp;<span class="builtintype" id="2708754">uintptr</span><span class="op" id="2708761">(</span><span class="ident" id="2708762">dir</span><span class="op" id="2708765">)</span><span class="op" id="2708766">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708769">if</span>&nbsp;<span class="ident" id="2708772">ch</span>&nbsp;<span class="op" id="2708775">:=</span>&nbsp;<span class="ident" id="2708778">cacheGet</span><span class="op" id="2708786">(</span><span class="ident" id="2708787">ckey</span><span class="op" id="2708791">)</span><span class="op" id="2708792">;</span>&nbsp;<span class="ident" id="2708794">ch</span>&nbsp;<span class="op" id="2708797">!=</span>&nbsp;<span class="ident" id="2708800">nil</span>&nbsp;<span class="op" id="2708804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708808">return</span>&nbsp;<span class="ident" id="2708815">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708823">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708891">if</span>&nbsp;<span class="ident" id="2708894">typ</span><span class="op" id="2708897">.</span><span class="ident" id="2708898">size</span>&nbsp;<span class="op" id="2708903">&gt;=</span>&nbsp;<span class="num" id="2708906">1</span><span class="op" id="2708907">&lt;&lt;</span><span class="num" id="2708909">16</span>&nbsp;<span class="op" id="2708912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708916">lookupCache</span><span class="op" id="2708927">.</span><span class="ident" id="2708928">Unlock</span><span class="op" id="2708934">(</span><span class="op" id="2708935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2708939">panic</span><span class="op" id="2708944">(</span><span class="string" id="2708945">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2708985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708992">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709017">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709064">var</span>&nbsp;<span class="ident" id="2709068">s</span>&nbsp;<span class="builtintype" id="2709070">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709078">switch</span>&nbsp;<span class="ident" id="2709085">dir</span>&nbsp;<span class="op" id="2709089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709092">default</span><span class="op" id="2709099">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709103">lookupCache</span><span class="op" id="2709114">.</span><span class="ident" id="2709115">Unlock</span><span class="op" id="2709121">(</span><span class="op" id="2709122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2709126">panic</span><span class="op" id="2709131">(</span><span class="string" id="2709132">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2709161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709164">case</span>&nbsp;<span class="ident" id="2709169">SendDir</span><span class="op" id="2709176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709180">s</span>&nbsp;<span class="op" id="2709182">=</span>&nbsp;<span class="string" id="2709184">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2709194">+</span>&nbsp;<span class="op" id="2709196">*</span><span class="ident" id="2709197">typ</span><span class="op" id="2709200">.</span><span class="builtintype" id="2709201">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709209">case</span>&nbsp;<span class="ident" id="2709214">RecvDir</span><span class="op" id="2709221">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709225">s</span>&nbsp;<span class="op" id="2709227">=</span>&nbsp;<span class="string" id="2709229">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2709239">+</span>&nbsp;<span class="op" id="2709241">*</span><span class="ident" id="2709242">typ</span><span class="op" id="2709245">.</span><span class="builtintype" id="2709246">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709254">case</span>&nbsp;<span class="ident" id="2709259">BothDir</span><span class="op" id="2709266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709270">s</span>&nbsp;<span class="op" id="2709272">=</span>&nbsp;<span class="string" id="2709274">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2709282">+</span>&nbsp;<span class="op" id="2709284">*</span><span class="ident" id="2709285">typ</span><span class="op" id="2709288">.</span><span class="builtintype" id="2709289">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709300">for</span>&nbsp;<span class="ident" id="2709304">_</span><span class="op" id="2709305">,</span>&nbsp;<span class="ident" id="2709307">tt</span>&nbsp;<span class="op" id="2709310">:=</span>&nbsp;<span class="keyword" id="2709313">range</span>&nbsp;<span class="ident" id="2709319">typesByString</span><span class="op" id="2709332">(</span><span class="ident" id="2709333">s</span><span class="op" id="2709334">)</span>&nbsp;<span class="op" id="2709336">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709340">ch</span>&nbsp;<span class="op" id="2709343">:=</span>&nbsp;<span class="op" id="2709346">(</span><span class="op" id="2709347">*</span><span class="ident" id="2709348">chanType</span><span class="op" id="2709356">)</span><span class="op" id="2709357">(</span><span class="ident" id="2709358">unsafe</span><span class="op" id="2709364">.</span><span class="ident" id="2709365">Pointer</span><span class="op" id="2709372">(</span><span class="ident" id="2709373">tt</span><span class="op" id="2709375">)</span><span class="op" id="2709376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709380">if</span>&nbsp;<span class="ident" id="2709383">ch</span><span class="op" id="2709385">.</span><span class="ident" id="2709386">elem</span>&nbsp;<span class="op" id="2709391">==</span>&nbsp;<span class="ident" id="2709394">typ</span>&nbsp;<span class="op" id="2709398">&amp;&amp;</span>&nbsp;<span class="ident" id="2709401">ch</span><span class="op" id="2709403">.</span><span class="ident" id="2709404">dir</span>&nbsp;<span class="op" id="2709408">==</span>&nbsp;<span class="builtintype" id="2709411">uintptr</span><span class="op" id="2709418">(</span><span class="ident" id="2709419">dir</span><span class="op" id="2709422">)</span>&nbsp;<span class="op" id="2709424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709429">return</span>&nbsp;<span class="ident" id="2709436">cachePut</span><span class="op" id="2709444">(</span><span class="ident" id="2709445">ckey</span><span class="op" id="2709449">,</span>&nbsp;<span class="ident" id="2709451">tt</span><span class="op" id="2709453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709460">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709464">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709489">var</span>&nbsp;<span class="ident" id="2709493">ichan</span>&nbsp;<span class="keyword" id="2709499">interface</span><span class="op" id="2709508">{</span><span class="op" id="2709509">}</span>&nbsp;<span class="op" id="2709511">=</span>&nbsp;<span class="op" id="2709513">(</span><span class="keyword" id="2709514">chan</span>&nbsp;<span class="ident" id="2709519">unsafe</span><span class="op" id="2709525">.</span><span class="ident" id="2709526">Pointer</span><span class="op" id="2709533">)</span><span class="op" id="2709534">(</span><span class="ident" id="2709535">nil</span><span class="op" id="2709538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709541">prototype</span>&nbsp;<span class="op" id="2709551">:=</span>&nbsp;<span class="op" id="2709554">*</span><span class="op" id="2709555">(</span><span class="op" id="2709556">*</span><span class="op" id="2709557">*</span><span class="ident" id="2709558">chanType</span><span class="op" id="2709566">)</span><span class="op" id="2709567">(</span><span class="ident" id="2709568">unsafe</span><span class="op" id="2709574">.</span><span class="ident" id="2709575">Pointer</span><span class="op" id="2709582">(</span><span class="op" id="2709583">&amp;</span><span class="ident" id="2709584">ichan</span><span class="op" id="2709589">)</span><span class="op" id="2709590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709593">ch</span>&nbsp;<span class="op" id="2709596">:=</span>&nbsp;<span class="builtinfunc" id="2709599">new</span><span class="op" id="2709602">(</span><span class="ident" id="2709603">chanType</span><span class="op" id="2709611">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709614">*</span><span class="ident" id="2709615">ch</span>&nbsp;<span class="op" id="2709618">=</span>&nbsp;<span class="op" id="2709620">*</span><span class="ident" id="2709621">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709632">ch</span><span class="op" id="2709634">.</span><span class="builtintype" id="2709635">string</span>&nbsp;<span class="op" id="2709642">=</span>&nbsp;<span class="op" id="2709644">&amp;</span><span class="ident" id="2709645">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709648">ch</span><span class="op" id="2709650">.</span><span class="ident" id="2709651">hash</span>&nbsp;<span class="op" id="2709656">=</span>&nbsp;<span class="ident" id="2709658">fnv1</span><span class="op" id="2709662">(</span><span class="ident" id="2709663">typ</span><span class="op" id="2709666">.</span><span class="ident" id="2709667">hash</span><span class="op" id="2709671">,</span>&nbsp;<span class="string" id="2709673">&#39;c&#39;</span><span class="op" id="2709676">,</span>&nbsp;<span class="builtintype" id="2709678">byte</span><span class="op" id="2709682">(</span><span class="ident" id="2709683">dir</span><span class="op" id="2709686">)</span><span class="op" id="2709687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709690">ch</span><span class="op" id="2709692">.</span><span class="ident" id="2709693">elem</span>&nbsp;<span class="op" id="2709698">=</span>&nbsp;<span class="ident" id="2709700">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709705">ch</span><span class="op" id="2709707">.</span><span class="ident" id="2709708">uncommonType</span>&nbsp;<span class="op" id="2709721">=</span>&nbsp;<span class="ident" id="2709723">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709728">ch</span><span class="op" id="2709730">.</span><span class="ident" id="2709731">ptrToThis</span>&nbsp;<span class="op" id="2709741">=</span>&nbsp;<span class="ident" id="2709743">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709748">ch</span><span class="op" id="2709750">.</span><span class="ident" id="2709751">zero</span>&nbsp;<span class="op" id="2709756">=</span>&nbsp;<span class="ident" id="2709758">unsafe</span><span class="op" id="2709764">.</span><span class="ident" id="2709765">Pointer</span><span class="op" id="2709772">(</span><span class="op" id="2709773">&amp;</span><span class="builtinfunc" id="2709774">make</span><span class="op" id="2709778">(</span><span class="op" id="2709779">[</span><span class="op" id="2709780">]</span><span class="builtintype" id="2709781">byte</span><span class="op" id="2709785">,</span>&nbsp;<span class="ident" id="2709787">ch</span><span class="op" id="2709789">.</span><span class="ident" id="2709790">size</span><span class="op" id="2709794">)</span><span class="op" id="2709795">[</span><span class="num" id="2709796">0</span><span class="op" id="2709797">]</span><span class="op" id="2709798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709802">return</span>&nbsp;<span class="ident" id="2709809">cachePut</span><span class="op" id="2709817">(</span><span class="ident" id="2709818">ckey</span><span class="op" id="2709822">,</span>&nbsp;<span class="op" id="2709824">&amp;</span><span class="ident" id="2709825">ch</span><span class="op" id="2709827">.</span><span class="ident" id="2709828">rtype</span><span class="op" id="2709833">)</span><br>
<span class="lineno"></span><span class="op" id="2709835">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2709838">func</span>&nbsp;<span class="ident" id="2709843">ismapkey</span><span class="op" id="2709851">(</span><span class="op" id="2709852">*</span><span class="ident" id="2709853">rtype</span><span class="op" id="2709858">)</span>&nbsp;<span class="builtintype" id="2709860">bool</span>&nbsp;<span class="comment" id="2709865">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2709892">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2709960">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2710021">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2710063">//</span><br>
<span class="lineno"></span><span class="comment" id="2710066">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2710134">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2710184">func</span>&nbsp;<span class="ident" id="2710189">MapOf</span><span class="op" id="2710194">(</span><span class="ident" id="2710195">key</span><span class="op" id="2710198">,</span>&nbsp;<span class="ident" id="2710200">elem</span>&nbsp;<span class="ident" id="2710205">Type</span><span class="op" id="2710209">)</span>&nbsp;<span class="ident" id="2710211">Type</span>&nbsp;<span class="op" id="2710216">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710219">ktyp</span>&nbsp;<span class="op" id="2710224">:=</span>&nbsp;<span class="ident" id="2710227">key</span><span class="op" id="2710230">.</span><span class="op" id="2710231">(</span><span class="op" id="2710232">*</span><span class="ident" id="2710233">rtype</span><span class="op" id="2710238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710241">etyp</span>&nbsp;<span class="op" id="2710246">:=</span>&nbsp;<span class="ident" id="2710249">elem</span><span class="op" id="2710253">.</span><span class="op" id="2710254">(</span><span class="op" id="2710255">*</span><span class="ident" id="2710256">rtype</span><span class="op" id="2710261">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710265">if</span>&nbsp;<span class="op" id="2710268">!</span><span class="ident" id="2710269">ismapkey</span><span class="op" id="2710277">(</span><span class="ident" id="2710278">ktyp</span><span class="op" id="2710282">)</span>&nbsp;<span class="op" id="2710284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2710288">panic</span><span class="op" id="2710293">(</span><span class="string" id="2710294">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2710329">+</span>&nbsp;<span class="ident" id="2710331">ktyp</span><span class="op" id="2710335">.</span><span class="ident" id="2710336">String</span><span class="op" id="2710342">(</span><span class="op" id="2710343">)</span><span class="op" id="2710344">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710351">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710370">ckey</span>&nbsp;<span class="op" id="2710375">:=</span>&nbsp;<span class="ident" id="2710378">cacheKey</span><span class="op" id="2710386">{</span><span class="ident" id="2710387">Map</span><span class="op" id="2710390">,</span>&nbsp;<span class="ident" id="2710392">ktyp</span><span class="op" id="2710396">,</span>&nbsp;<span class="ident" id="2710398">etyp</span><span class="op" id="2710402">,</span>&nbsp;<span class="num" id="2710404">0</span><span class="op" id="2710405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710408">if</span>&nbsp;<span class="ident" id="2710411">mt</span>&nbsp;<span class="op" id="2710414">:=</span>&nbsp;<span class="ident" id="2710417">cacheGet</span><span class="op" id="2710425">(</span><span class="ident" id="2710426">ckey</span><span class="op" id="2710430">)</span><span class="op" id="2710431">;</span>&nbsp;<span class="ident" id="2710433">mt</span>&nbsp;<span class="op" id="2710436">!=</span>&nbsp;<span class="ident" id="2710439">nil</span>&nbsp;<span class="op" id="2710443">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710447">return</span>&nbsp;<span class="ident" id="2710454">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710462">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710487">s</span>&nbsp;<span class="op" id="2710489">:=</span>&nbsp;<span class="string" id="2710492">&#34;map[&#34;</span>&nbsp;<span class="op" id="2710499">+</span>&nbsp;<span class="op" id="2710501">*</span><span class="ident" id="2710502">ktyp</span><span class="op" id="2710506">.</span><span class="builtintype" id="2710507">string</span>&nbsp;<span class="op" id="2710514">+</span>&nbsp;<span class="string" id="2710516">&#34;]&#34;</span>&nbsp;<span class="op" id="2710520">+</span>&nbsp;<span class="op" id="2710522">*</span><span class="ident" id="2710523">etyp</span><span class="op" id="2710527">.</span><span class="builtintype" id="2710528">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710536">for</span>&nbsp;<span class="ident" id="2710540">_</span><span class="op" id="2710541">,</span>&nbsp;<span class="ident" id="2710543">tt</span>&nbsp;<span class="op" id="2710546">:=</span>&nbsp;<span class="keyword" id="2710549">range</span>&nbsp;<span class="ident" id="2710555">typesByString</span><span class="op" id="2710568">(</span><span class="ident" id="2710569">s</span><span class="op" id="2710570">)</span>&nbsp;<span class="op" id="2710572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710576">mt</span>&nbsp;<span class="op" id="2710579">:=</span>&nbsp;<span class="op" id="2710582">(</span><span class="op" id="2710583">*</span><span class="ident" id="2710584">mapType</span><span class="op" id="2710591">)</span><span class="op" id="2710592">(</span><span class="ident" id="2710593">unsafe</span><span class="op" id="2710599">.</span><span class="ident" id="2710600">Pointer</span><span class="op" id="2710607">(</span><span class="ident" id="2710608">tt</span><span class="op" id="2710610">)</span><span class="op" id="2710611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710615">if</span>&nbsp;<span class="ident" id="2710618">mt</span><span class="op" id="2710620">.</span><span class="ident" id="2710621">key</span>&nbsp;<span class="op" id="2710625">==</span>&nbsp;<span class="ident" id="2710628">ktyp</span>&nbsp;<span class="op" id="2710633">&amp;&amp;</span>&nbsp;<span class="ident" id="2710636">mt</span><span class="op" id="2710638">.</span><span class="ident" id="2710639">elem</span>&nbsp;<span class="op" id="2710644">==</span>&nbsp;<span class="ident" id="2710647">etyp</span>&nbsp;<span class="op" id="2710652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710657">return</span>&nbsp;<span class="ident" id="2710664">cachePut</span><span class="op" id="2710672">(</span><span class="ident" id="2710673">ckey</span><span class="op" id="2710677">,</span>&nbsp;<span class="ident" id="2710679">tt</span><span class="op" id="2710681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710685">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710692">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710713">var</span>&nbsp;<span class="ident" id="2710717">imap</span>&nbsp;<span class="keyword" id="2710722">interface</span><span class="op" id="2710731">{</span><span class="op" id="2710732">}</span>&nbsp;<span class="op" id="2710734">=</span>&nbsp;<span class="op" id="2710736">(</span><span class="keyword" id="2710737">map</span><span class="op" id="2710740">[</span><span class="ident" id="2710741">unsafe</span><span class="op" id="2710747">.</span><span class="ident" id="2710748">Pointer</span><span class="op" id="2710755">]</span><span class="ident" id="2710756">unsafe</span><span class="op" id="2710762">.</span><span class="ident" id="2710763">Pointer</span><span class="op" id="2710770">)</span><span class="op" id="2710771">(</span><span class="ident" id="2710772">nil</span><span class="op" id="2710775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710778">prototype</span>&nbsp;<span class="op" id="2710788">:=</span>&nbsp;<span class="op" id="2710791">*</span><span class="op" id="2710792">(</span><span class="op" id="2710793">*</span><span class="op" id="2710794">*</span><span class="ident" id="2710795">mapType</span><span class="op" id="2710802">)</span><span class="op" id="2710803">(</span><span class="ident" id="2710804">unsafe</span><span class="op" id="2710810">.</span><span class="ident" id="2710811">Pointer</span><span class="op" id="2710818">(</span><span class="op" id="2710819">&amp;</span><span class="ident" id="2710820">imap</span><span class="op" id="2710824">)</span><span class="op" id="2710825">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710828">mt</span>&nbsp;<span class="op" id="2710831">:=</span>&nbsp;<span class="builtinfunc" id="2710834">new</span><span class="op" id="2710837">(</span><span class="ident" id="2710838">mapType</span><span class="op" id="2710845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710848">*</span><span class="ident" id="2710849">mt</span>&nbsp;<span class="op" id="2710852">=</span>&nbsp;<span class="op" id="2710854">*</span><span class="ident" id="2710855">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710866">mt</span><span class="op" id="2710868">.</span><span class="builtintype" id="2710869">string</span>&nbsp;<span class="op" id="2710876">=</span>&nbsp;<span class="op" id="2710878">&amp;</span><span class="ident" id="2710879">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710882">mt</span><span class="op" id="2710884">.</span><span class="ident" id="2710885">hash</span>&nbsp;<span class="op" id="2710890">=</span>&nbsp;<span class="ident" id="2710892">fnv1</span><span class="op" id="2710896">(</span><span class="ident" id="2710897">etyp</span><span class="op" id="2710901">.</span><span class="ident" id="2710902">hash</span><span class="op" id="2710906">,</span>&nbsp;<span class="string" id="2710908">&#39;m&#39;</span><span class="op" id="2710911">,</span>&nbsp;<span class="builtintype" id="2710913">byte</span><span class="op" id="2710917">(</span><span class="ident" id="2710918">ktyp</span><span class="op" id="2710922">.</span><span class="ident" id="2710923">hash</span><span class="op" id="2710927">&gt;&gt;</span><span class="num" id="2710929">24</span><span class="op" id="2710931">)</span><span class="op" id="2710932">,</span>&nbsp;<span class="builtintype" id="2710934">byte</span><span class="op" id="2710938">(</span><span class="ident" id="2710939">ktyp</span><span class="op" id="2710943">.</span><span class="ident" id="2710944">hash</span><span class="op" id="2710948">&gt;&gt;</span><span class="num" id="2710950">16</span><span class="op" id="2710952">)</span><span class="op" id="2710953">,</span>&nbsp;<span class="builtintype" id="2710955">byte</span><span class="op" id="2710959">(</span><span class="ident" id="2710960">ktyp</span><span class="op" id="2710964">.</span><span class="ident" id="2710965">hash</span><span class="op" id="2710969">&gt;&gt;</span><span class="num" id="2710971">8</span><span class="op" id="2710972">)</span><span class="op" id="2710973">,</span>&nbsp;<span class="builtintype" id="2710975">byte</span><span class="op" id="2710979">(</span><span class="ident" id="2710980">ktyp</span><span class="op" id="2710984">.</span><span class="ident" id="2710985">hash</span><span class="op" id="2710989">)</span><span class="op" id="2710990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710993">mt</span><span class="op" id="2710995">.</span><span class="ident" id="2710996">key</span>&nbsp;<span class="op" id="2711000">=</span>&nbsp;<span class="ident" id="2711002">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711008">mt</span><span class="op" id="2711010">.</span><span class="ident" id="2711011">elem</span>&nbsp;<span class="op" id="2711016">=</span>&nbsp;<span class="ident" id="2711018">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711024">mt</span><span class="op" id="2711026">.</span><span class="ident" id="2711027">bucket</span>&nbsp;<span class="op" id="2711034">=</span>&nbsp;<span class="ident" id="2711036">bucketOf</span><span class="op" id="2711044">(</span><span class="ident" id="2711045">ktyp</span><span class="op" id="2711049">,</span>&nbsp;<span class="ident" id="2711051">etyp</span><span class="op" id="2711055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711058">if</span>&nbsp;<span class="ident" id="2711061">ktyp</span><span class="op" id="2711065">.</span><span class="ident" id="2711066">size</span>&nbsp;<span class="op" id="2711071">&gt;</span>&nbsp;<span class="ident" id="2711073">maxKeySize</span>&nbsp;<span class="op" id="2711084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711088">mt</span><span class="op" id="2711090">.</span><span class="ident" id="2711091">keysize</span>&nbsp;<span class="op" id="2711099">=</span>&nbsp;<span class="builtintype" id="2711101">uint8</span><span class="op" id="2711106">(</span><span class="ident" id="2711107">ptrSize</span><span class="op" id="2711114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711118">mt</span><span class="op" id="2711120">.</span><span class="ident" id="2711121">indirectkey</span>&nbsp;<span class="op" id="2711133">=</span>&nbsp;<span class="num" id="2711135">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711138">}</span>&nbsp;<span class="keyword" id="2711140">else</span>&nbsp;<span class="op" id="2711145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711149">mt</span><span class="op" id="2711151">.</span><span class="ident" id="2711152">keysize</span>&nbsp;<span class="op" id="2711160">=</span>&nbsp;<span class="builtintype" id="2711162">uint8</span><span class="op" id="2711167">(</span><span class="ident" id="2711168">ktyp</span><span class="op" id="2711172">.</span><span class="ident" id="2711173">size</span><span class="op" id="2711177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711181">mt</span><span class="op" id="2711183">.</span><span class="ident" id="2711184">indirectkey</span>&nbsp;<span class="op" id="2711196">=</span>&nbsp;<span class="num" id="2711198">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711204">if</span>&nbsp;<span class="ident" id="2711207">etyp</span><span class="op" id="2711211">.</span><span class="ident" id="2711212">size</span>&nbsp;<span class="op" id="2711217">&gt;</span>&nbsp;<span class="ident" id="2711219">maxValSize</span>&nbsp;<span class="op" id="2711230">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711234">mt</span><span class="op" id="2711236">.</span><span class="ident" id="2711237">valuesize</span>&nbsp;<span class="op" id="2711247">=</span>&nbsp;<span class="builtintype" id="2711249">uint8</span><span class="op" id="2711254">(</span><span class="ident" id="2711255">ptrSize</span><span class="op" id="2711262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711266">mt</span><span class="op" id="2711268">.</span><span class="ident" id="2711269">indirectvalue</span>&nbsp;<span class="op" id="2711283">=</span>&nbsp;<span class="num" id="2711285">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711288">}</span>&nbsp;<span class="keyword" id="2711290">else</span>&nbsp;<span class="op" id="2711295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711299">mt</span><span class="op" id="2711301">.</span><span class="ident" id="2711302">valuesize</span>&nbsp;<span class="op" id="2711312">=</span>&nbsp;<span class="builtintype" id="2711314">uint8</span><span class="op" id="2711319">(</span><span class="ident" id="2711320">etyp</span><span class="op" id="2711324">.</span><span class="ident" id="2711325">size</span><span class="op" id="2711329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711333">mt</span><span class="op" id="2711335">.</span><span class="ident" id="2711336">indirectvalue</span>&nbsp;<span class="op" id="2711350">=</span>&nbsp;<span class="num" id="2711352">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711358">mt</span><span class="op" id="2711360">.</span><span class="ident" id="2711361">bucketsize</span>&nbsp;<span class="op" id="2711372">=</span>&nbsp;<span class="builtintype" id="2711374">uint16</span><span class="op" id="2711380">(</span><span class="ident" id="2711381">mt</span><span class="op" id="2711383">.</span><span class="ident" id="2711384">bucket</span><span class="op" id="2711390">.</span><span class="ident" id="2711391">size</span><span class="op" id="2711395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711398">mt</span><span class="op" id="2711400">.</span><span class="ident" id="2711401">uncommonType</span>&nbsp;<span class="op" id="2711414">=</span>&nbsp;<span class="ident" id="2711416">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711421">mt</span><span class="op" id="2711423">.</span><span class="ident" id="2711424">ptrToThis</span>&nbsp;<span class="op" id="2711434">=</span>&nbsp;<span class="ident" id="2711436">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711441">mt</span><span class="op" id="2711443">.</span><span class="ident" id="2711444">zero</span>&nbsp;<span class="op" id="2711449">=</span>&nbsp;<span class="ident" id="2711451">unsafe</span><span class="op" id="2711457">.</span><span class="ident" id="2711458">Pointer</span><span class="op" id="2711465">(</span><span class="op" id="2711466">&amp;</span><span class="builtinfunc" id="2711467">make</span><span class="op" id="2711471">(</span><span class="op" id="2711472">[</span><span class="op" id="2711473">]</span><span class="builtintype" id="2711474">byte</span><span class="op" id="2711478">,</span>&nbsp;<span class="ident" id="2711480">mt</span><span class="op" id="2711482">.</span><span class="ident" id="2711483">size</span><span class="op" id="2711487">)</span><span class="op" id="2711488">[</span><span class="num" id="2711489">0</span><span class="op" id="2711490">]</span><span class="op" id="2711491">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711495">return</span>&nbsp;<span class="ident" id="2711502">cachePut</span><span class="op" id="2711510">(</span><span class="ident" id="2711511">ckey</span><span class="op" id="2711515">,</span>&nbsp;<span class="op" id="2711517">&amp;</span><span class="ident" id="2711518">mt</span><span class="op" id="2711520">.</span><span class="ident" id="2711521">rtype</span><span class="op" id="2711526">)</span><br>
<span class="lineno"></span><span class="op" id="2711528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2711531">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2711595">type</span>&nbsp;<span class="ident" id="2711600">gcProg</span>&nbsp;<span class="keyword" id="2711607">struct</span>&nbsp;<span class="op" id="2711614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711617">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2711622">[</span><span class="op" id="2711623">]</span><span class="builtintype" id="2711624">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711630">size</span>&nbsp;<span class="builtintype" id="2711635">uintptr</span>&nbsp;<span class="comment" id="2711643">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2711668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2711671">func</span>&nbsp;<span class="op" id="2711676">(</span><span class="ident" id="2711677">gc</span>&nbsp;<span class="op" id="2711680">*</span><span class="ident" id="2711681">gcProg</span><span class="op" id="2711687">)</span>&nbsp;<span class="builtinfunc" id="2711689">append</span><span class="op" id="2711695">(</span><span class="ident" id="2711696">v</span>&nbsp;<span class="builtintype" id="2711698">byte</span><span class="op" id="2711702">)</span>&nbsp;<span class="op" id="2711704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711707">gc</span><span class="op" id="2711709">.</span><span class="ident" id="2711710">align</span><span class="op" id="2711715">(</span><span class="ident" id="2711716">unsafe</span><span class="op" id="2711722">.</span><span class="ident" id="2711723">Sizeof</span><span class="op" id="2711729">(</span><span class="builtintype" id="2711730">uintptr</span><span class="op" id="2711737">(</span><span class="num" id="2711738">0</span><span class="op" id="2711739">)</span><span class="op" id="2711740">)</span><span class="op" id="2711741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711744">gc</span><span class="op" id="2711746">.</span><span class="ident" id="2711747">appendWord</span><span class="op" id="2711757">(</span><span class="ident" id="2711758">v</span><span class="op" id="2711759">)</span><br>
<span class="lineno"></span><span class="op" id="2711761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2711764">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2711813">func</span>&nbsp;<span class="op" id="2711818">(</span><span class="ident" id="2711819">gc</span>&nbsp;<span class="op" id="2711822">*</span><span class="ident" id="2711823">gcProg</span><span class="op" id="2711829">)</span>&nbsp;<span class="ident" id="2711831">appendProg</span><span class="op" id="2711841">(</span><span class="ident" id="2711842">t</span>&nbsp;<span class="op" id="2711844">*</span><span class="ident" id="2711845">rtype</span><span class="op" id="2711850">)</span>&nbsp;<span class="op" id="2711852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711855">gc</span><span class="op" id="2711857">.</span><span class="ident" id="2711858">align</span><span class="op" id="2711863">(</span><span class="builtintype" id="2711864">uintptr</span><span class="op" id="2711871">(</span><span class="ident" id="2711872">t</span><span class="op" id="2711873">.</span><span class="ident" id="2711874">align</span><span class="op" id="2711879">)</span><span class="op" id="2711880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711883">if</span>&nbsp;<span class="op" id="2711886">!</span><span class="ident" id="2711887">t</span><span class="op" id="2711888">.</span><span class="ident" id="2711889">pointers</span><span class="op" id="2711897">(</span><span class="op" id="2711898">)</span>&nbsp;<span class="op" id="2711900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711904">gc</span><span class="op" id="2711906">.</span><span class="ident" id="2711907">size</span>&nbsp;<span class="op" id="2711912">+=</span>&nbsp;<span class="ident" id="2711915">t</span><span class="op" id="2711916">.</span><span class="ident" id="2711917">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711924">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711935">switch</span>&nbsp;<span class="ident" id="2711942">t</span><span class="op" id="2711943">.</span><span class="ident" id="2711944">Kind</span><span class="op" id="2711948">(</span><span class="op" id="2711949">)</span>&nbsp;<span class="op" id="2711951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711954">default</span><span class="op" id="2711961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2711965">panic</span><span class="op" id="2711970">(</span><span class="string" id="2711971">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2712024">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712027">case</span>&nbsp;<span class="ident" id="2712032">Ptr</span><span class="op" id="2712035">,</span>&nbsp;<span class="ident" id="2712037">UnsafePointer</span><span class="op" id="2712050">,</span>&nbsp;<span class="ident" id="2712052">Chan</span><span class="op" id="2712056">,</span>&nbsp;<span class="ident" id="2712058">Func</span><span class="op" id="2712062">,</span>&nbsp;<span class="ident" id="2712064">Map</span><span class="op" id="2712067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712071">gc</span><span class="op" id="2712073">.</span><span class="ident" id="2712074">appendWord</span><span class="op" id="2712084">(</span><span class="ident" id="2712085">bitsPointer</span><span class="op" id="2712096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712099">case</span>&nbsp;<span class="ident" id="2712104">Slice</span><span class="op" id="2712109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712113">gc</span><span class="op" id="2712115">.</span><span class="ident" id="2712116">appendWord</span><span class="op" id="2712126">(</span><span class="ident" id="2712127">bitsPointer</span><span class="op" id="2712138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712142">gc</span><span class="op" id="2712144">.</span><span class="ident" id="2712145">appendWord</span><span class="op" id="2712155">(</span><span class="ident" id="2712156">bitsScalar</span><span class="op" id="2712166">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712170">gc</span><span class="op" id="2712172">.</span><span class="ident" id="2712173">appendWord</span><span class="op" id="2712183">(</span><span class="ident" id="2712184">bitsScalar</span><span class="op" id="2712194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712197">case</span>&nbsp;<span class="ident" id="2712202">String</span><span class="op" id="2712208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712212">gc</span><span class="op" id="2712214">.</span><span class="ident" id="2712215">appendWord</span><span class="op" id="2712225">(</span><span class="ident" id="2712226">bitsPointer</span><span class="op" id="2712237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712241">gc</span><span class="op" id="2712243">.</span><span class="ident" id="2712244">appendWord</span><span class="op" id="2712254">(</span><span class="ident" id="2712255">bitsScalar</span><span class="op" id="2712265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712268">case</span>&nbsp;<span class="ident" id="2712273">Array</span><span class="op" id="2712278">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712282">c</span>&nbsp;<span class="op" id="2712284">:=</span>&nbsp;<span class="ident" id="2712287">t</span><span class="op" id="2712288">.</span><span class="ident" id="2712289">Len</span><span class="op" id="2712292">(</span><span class="op" id="2712293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712297">e</span>&nbsp;<span class="op" id="2712299">:=</span>&nbsp;<span class="ident" id="2712302">t</span><span class="op" id="2712303">.</span><span class="ident" id="2712304">Elem</span><span class="op" id="2712308">(</span><span class="op" id="2712309">)</span><span class="op" id="2712310">.</span><span class="ident" id="2712311">common</span><span class="op" id="2712317">(</span><span class="op" id="2712318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712322">for</span>&nbsp;<span class="ident" id="2712326">i</span>&nbsp;<span class="op" id="2712328">:=</span>&nbsp;<span class="num" id="2712331">0</span><span class="op" id="2712332">;</span>&nbsp;<span class="ident" id="2712334">i</span>&nbsp;<span class="op" id="2712336">&lt;</span>&nbsp;<span class="ident" id="2712338">c</span><span class="op" id="2712339">;</span>&nbsp;<span class="ident" id="2712341">i</span><span class="op" id="2712342">++</span>&nbsp;<span class="op" id="2712345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712350">gc</span><span class="op" id="2712352">.</span><span class="ident" id="2712353">appendProg</span><span class="op" id="2712363">(</span><span class="ident" id="2712364">e</span><span class="op" id="2712365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712369">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712372">case</span>&nbsp;<span class="ident" id="2712377">Interface</span><span class="op" id="2712386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712390">gc</span><span class="op" id="2712392">.</span><span class="ident" id="2712393">appendWord</span><span class="op" id="2712403">(</span><span class="ident" id="2712404">bitsMultiWord</span><span class="op" id="2712417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712421">if</span>&nbsp;<span class="ident" id="2712424">t</span><span class="op" id="2712425">.</span><span class="ident" id="2712426">NumMethod</span><span class="op" id="2712435">(</span><span class="op" id="2712436">)</span>&nbsp;<span class="op" id="2712438">==</span>&nbsp;<span class="num" id="2712441">0</span>&nbsp;<span class="op" id="2712443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712448">gc</span><span class="op" id="2712450">.</span><span class="ident" id="2712451">appendWord</span><span class="op" id="2712461">(</span><span class="ident" id="2712462">bitsEface</span><span class="op" id="2712471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712475">}</span>&nbsp;<span class="keyword" id="2712477">else</span>&nbsp;<span class="op" id="2712482">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712487">gc</span><span class="op" id="2712489">.</span><span class="ident" id="2712490">appendWord</span><span class="op" id="2712500">(</span><span class="ident" id="2712501">bitsIface</span><span class="op" id="2712510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712517">case</span>&nbsp;<span class="ident" id="2712522">Struct</span><span class="op" id="2712528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712532">c</span>&nbsp;<span class="op" id="2712534">:=</span>&nbsp;<span class="ident" id="2712537">t</span><span class="op" id="2712538">.</span><span class="ident" id="2712539">NumField</span><span class="op" id="2712547">(</span><span class="op" id="2712548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712552">for</span>&nbsp;<span class="ident" id="2712556">i</span>&nbsp;<span class="op" id="2712558">:=</span>&nbsp;<span class="num" id="2712561">0</span><span class="op" id="2712562">;</span>&nbsp;<span class="ident" id="2712564">i</span>&nbsp;<span class="op" id="2712566">&lt;</span>&nbsp;<span class="ident" id="2712568">c</span><span class="op" id="2712569">;</span>&nbsp;<span class="ident" id="2712571">i</span><span class="op" id="2712572">++</span>&nbsp;<span class="op" id="2712575">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712580">gc</span><span class="op" id="2712582">.</span><span class="ident" id="2712583">appendProg</span><span class="op" id="2712593">(</span><span class="ident" id="2712594">t</span><span class="op" id="2712595">.</span><span class="ident" id="2712596">Field</span><span class="op" id="2712601">(</span><span class="ident" id="2712602">i</span><span class="op" id="2712603">)</span><span class="op" id="2712604">.</span><span class="ident" id="2712605">Type</span><span class="op" id="2712609">.</span><span class="ident" id="2712610">common</span><span class="op" id="2712616">(</span><span class="op" id="2712617">)</span><span class="op" id="2712618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712626">gc</span><span class="op" id="2712628">.</span><span class="ident" id="2712629">align</span><span class="op" id="2712634">(</span><span class="builtintype" id="2712635">uintptr</span><span class="op" id="2712642">(</span><span class="ident" id="2712643">t</span><span class="op" id="2712644">.</span><span class="ident" id="2712645">align</span><span class="op" id="2712650">)</span><span class="op" id="2712651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712654">}</span><br>
<span class="lineno"></span><span class="op" id="2712656">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2712659">func</span>&nbsp;<span class="op" id="2712664">(</span><span class="ident" id="2712665">gc</span>&nbsp;<span class="op" id="2712668">*</span><span class="ident" id="2712669">gcProg</span><span class="op" id="2712675">)</span>&nbsp;<span class="ident" id="2712677">appendWord</span><span class="op" id="2712687">(</span><span class="ident" id="2712688">v</span>&nbsp;<span class="builtintype" id="2712690">byte</span><span class="op" id="2712694">)</span>&nbsp;<span class="op" id="2712696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712699">ptrsize</span>&nbsp;<span class="op" id="2712707">:=</span>&nbsp;<span class="ident" id="2712710">unsafe</span><span class="op" id="2712716">.</span><span class="ident" id="2712717">Sizeof</span><span class="op" id="2712723">(</span><span class="builtintype" id="2712724">uintptr</span><span class="op" id="2712731">(</span><span class="num" id="2712732">0</span><span class="op" id="2712733">)</span><span class="op" id="2712734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712737">if</span>&nbsp;<span class="ident" id="2712740">gc</span><span class="op" id="2712742">.</span><span class="ident" id="2712743">size</span><span class="op" id="2712747">%</span><span class="ident" id="2712748">ptrsize</span>&nbsp;<span class="op" id="2712756">!=</span>&nbsp;<span class="num" id="2712759">0</span>&nbsp;<span class="op" id="2712761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2712765">panic</span><span class="op" id="2712770">(</span><span class="string" id="2712771">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2712802">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712808">nptr</span>&nbsp;<span class="op" id="2712813">:=</span>&nbsp;<span class="ident" id="2712816">gc</span><span class="op" id="2712818">.</span><span class="ident" id="2712819">size</span>&nbsp;<span class="op" id="2712824">/</span>&nbsp;<span class="ident" id="2712826">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712835">for</span>&nbsp;<span class="builtintype" id="2712839">uintptr</span><span class="op" id="2712846">(</span><span class="builtinfunc" id="2712847">len</span><span class="op" id="2712850">(</span><span class="ident" id="2712851">gc</span><span class="op" id="2712853">.</span><span class="ident" id="2712854">gc</span><span class="op" id="2712856">)</span><span class="op" id="2712857">)</span>&nbsp;<span class="op" id="2712859">&lt;</span>&nbsp;<span class="ident" id="2712861">nptr</span><span class="op" id="2712865">/</span><span class="num" id="2712866">2</span><span class="op" id="2712867">+</span><span class="num" id="2712868">1</span>&nbsp;<span class="op" id="2712870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712874">gc</span><span class="op" id="2712876">.</span><span class="ident" id="2712877">gc</span>&nbsp;<span class="op" id="2712880">=</span>&nbsp;<span class="builtinfunc" id="2712882">append</span><span class="op" id="2712888">(</span><span class="ident" id="2712889">gc</span><span class="op" id="2712891">.</span><span class="ident" id="2712892">gc</span><span class="op" id="2712894">,</span>&nbsp;<span class="num" id="2712896">0x44</span><span class="op" id="2712900">)</span>&nbsp;<span class="comment" id="2712902">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712917">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712920">gc</span><span class="op" id="2712922">.</span><span class="ident" id="2712923">gc</span><span class="op" id="2712925">[</span><span class="ident" id="2712926">nptr</span><span class="op" id="2712930">/</span><span class="num" id="2712931">2</span><span class="op" id="2712932">]</span>&nbsp;<span class="op" id="2712934">&amp;=</span>&nbsp;<span class="op" id="2712937">^</span><span class="op" id="2712938">(</span><span class="num" id="2712939">3</span>&nbsp;<span class="op" id="2712941">&lt;&lt;</span>&nbsp;<span class="op" id="2712944">(</span><span class="op" id="2712945">(</span><span class="ident" id="2712946">nptr</span><span class="op" id="2712950">%</span><span class="num" id="2712951">2</span><span class="op" id="2712952">)</span><span class="op" id="2712953">*</span><span class="num" id="2712954">4</span>&nbsp;<span class="op" id="2712956">+</span>&nbsp;<span class="num" id="2712958">2</span><span class="op" id="2712959">)</span><span class="op" id="2712960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712963">gc</span><span class="op" id="2712965">.</span><span class="ident" id="2712966">gc</span><span class="op" id="2712968">[</span><span class="ident" id="2712969">nptr</span><span class="op" id="2712973">/</span><span class="num" id="2712974">2</span><span class="op" id="2712975">]</span>&nbsp;<span class="op" id="2712977">|=</span>&nbsp;<span class="ident" id="2712980">v</span>&nbsp;<span class="op" id="2712982">&lt;&lt;</span>&nbsp;<span class="op" id="2712985">(</span><span class="op" id="2712986">(</span><span class="ident" id="2712987">nptr</span><span class="op" id="2712991">%</span><span class="num" id="2712992">2</span><span class="op" id="2712993">)</span><span class="op" id="2712994">*</span><span class="num" id="2712995">4</span>&nbsp;<span class="op" id="2712997">+</span>&nbsp;<span class="num" id="2712999">2</span><span class="op" id="2713000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713003">gc</span><span class="op" id="2713005">.</span><span class="ident" id="2713006">size</span>&nbsp;<span class="op" id="2713011">+=</span>&nbsp;<span class="ident" id="2713014">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2713022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2713025">func</span>&nbsp;<span class="op" id="2713030">(</span><span class="ident" id="2713031">gc</span>&nbsp;<span class="op" id="2713034">*</span><span class="ident" id="2713035">gcProg</span><span class="op" id="2713041">)</span>&nbsp;<span class="ident" id="2713043">finalize</span><span class="op" id="2713051">(</span><span class="op" id="2713052">)</span>&nbsp;<span class="ident" id="2713054">unsafe</span><span class="op" id="2713060">.</span><span class="ident" id="2713061">Pointer</span>&nbsp;<span class="op" id="2713069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713072">if</span>&nbsp;<span class="ident" id="2713075">gc</span><span class="op" id="2713077">.</span><span class="ident" id="2713078">size</span>&nbsp;<span class="op" id="2713083">==</span>&nbsp;<span class="num" id="2713086">0</span>&nbsp;<span class="op" id="2713088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713092">return</span>&nbsp;<span class="ident" id="2713099">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713107">ptrsize</span>&nbsp;<span class="op" id="2713115">:=</span>&nbsp;<span class="ident" id="2713118">unsafe</span><span class="op" id="2713124">.</span><span class="ident" id="2713125">Sizeof</span><span class="op" id="2713131">(</span><span class="builtintype" id="2713132">uintptr</span><span class="op" id="2713139">(</span><span class="num" id="2713140">0</span><span class="op" id="2713141">)</span><span class="op" id="2713142">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713145">gc</span><span class="op" id="2713147">.</span><span class="ident" id="2713148">align</span><span class="op" id="2713153">(</span><span class="ident" id="2713154">ptrsize</span><span class="op" id="2713161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713164">nptr</span>&nbsp;<span class="op" id="2713169">:=</span>&nbsp;<span class="ident" id="2713172">gc</span><span class="op" id="2713174">.</span><span class="ident" id="2713175">size</span>&nbsp;<span class="op" id="2713180">/</span>&nbsp;<span class="ident" id="2713182">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713191">for</span>&nbsp;<span class="builtintype" id="2713195">uintptr</span><span class="op" id="2713202">(</span><span class="builtinfunc" id="2713203">len</span><span class="op" id="2713206">(</span><span class="ident" id="2713207">gc</span><span class="op" id="2713209">.</span><span class="ident" id="2713210">gc</span><span class="op" id="2713212">)</span><span class="op" id="2713213">)</span>&nbsp;<span class="op" id="2713215">&lt;</span>&nbsp;<span class="ident" id="2713217">nptr</span><span class="op" id="2713221">/</span><span class="num" id="2713222">2</span><span class="op" id="2713223">+</span><span class="num" id="2713224">1</span>&nbsp;<span class="op" id="2713226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713230">gc</span><span class="op" id="2713232">.</span><span class="ident" id="2713233">gc</span>&nbsp;<span class="op" id="2713236">=</span>&nbsp;<span class="builtinfunc" id="2713238">append</span><span class="op" id="2713244">(</span><span class="ident" id="2713245">gc</span><span class="op" id="2713247">.</span><span class="ident" id="2713248">gc</span><span class="op" id="2713250">,</span>&nbsp;<span class="num" id="2713252">0x44</span><span class="op" id="2713256">)</span>&nbsp;<span class="comment" id="2713258">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713273">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2713276">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2713330">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713358">if</span>&nbsp;<span class="ident" id="2713361">nptr</span><span class="op" id="2713365">%</span><span class="num" id="2713366">2</span>&nbsp;<span class="op" id="2713368">!=</span>&nbsp;<span class="num" id="2713371">0</span>&nbsp;<span class="op" id="2713373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713377">for</span>&nbsp;<span class="ident" id="2713381">i</span>&nbsp;<span class="op" id="2713383">:=</span>&nbsp;<span class="builtintype" id="2713386">uintptr</span><span class="op" id="2713393">(</span><span class="num" id="2713394">0</span><span class="op" id="2713395">)</span><span class="op" id="2713396">;</span>&nbsp;<span class="ident" id="2713398">i</span>&nbsp;<span class="op" id="2713400">&lt;</span>&nbsp;<span class="ident" id="2713402">nptr</span><span class="op" id="2713406">;</span>&nbsp;<span class="ident" id="2713408">i</span><span class="op" id="2713409">++</span>&nbsp;<span class="op" id="2713412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713417">gc</span><span class="op" id="2713419">.</span><span class="ident" id="2713420">appendWord</span><span class="op" id="2713430">(</span><span class="ident" id="2713431">extractGCWord</span><span class="op" id="2713444">(</span><span class="ident" id="2713445">gc</span><span class="op" id="2713447">.</span><span class="ident" id="2713448">gc</span><span class="op" id="2713450">,</span>&nbsp;<span class="ident" id="2713452">i</span><span class="op" id="2713453">)</span><span class="op" id="2713454">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713464">return</span>&nbsp;<span class="ident" id="2713471">unsafe</span><span class="op" id="2713477">.</span><span class="ident" id="2713478">Pointer</span><span class="op" id="2713485">(</span><span class="op" id="2713486">&amp;</span><span class="ident" id="2713487">gc</span><span class="op" id="2713489">.</span><span class="ident" id="2713490">gc</span><span class="op" id="2713492">[</span><span class="num" id="2713493">0</span><span class="op" id="2713494">]</span><span class="op" id="2713495">)</span><br>
<span class="lineno"></span><span class="op" id="2713497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2713500">func</span>&nbsp;<span class="ident" id="2713505">extractGCWord</span><span class="op" id="2713518">(</span><span class="ident" id="2713519">gc</span>&nbsp;<span class="op" id="2713522">[</span><span class="op" id="2713523">]</span><span class="builtintype" id="2713524">byte</span><span class="op" id="2713528">,</span>&nbsp;<span class="ident" id="2713530">i</span>&nbsp;<span class="builtintype" id="2713532">uintptr</span><span class="op" id="2713539">)</span>&nbsp;<span class="builtintype" id="2713541">byte</span>&nbsp;<span class="op" id="2713546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713549">return</span>&nbsp;<span class="op" id="2713556">(</span><span class="ident" id="2713557">gc</span><span class="op" id="2713559">[</span><span class="ident" id="2713560">i</span><span class="op" id="2713561">/</span><span class="num" id="2713562">2</span><span class="op" id="2713563">]</span>&nbsp;<span class="op" id="2713565">&gt;&gt;</span>&nbsp;<span class="op" id="2713568">(</span><span class="op" id="2713569">(</span><span class="ident" id="2713570">i</span><span class="op" id="2713571">%</span><span class="num" id="2713572">2</span><span class="op" id="2713573">)</span><span class="op" id="2713574">*</span><span class="num" id="2713575">4</span>&nbsp;<span class="op" id="2713577">+</span>&nbsp;<span class="num" id="2713579">2</span><span class="op" id="2713580">)</span><span class="op" id="2713581">)</span>&nbsp;<span class="op" id="2713583">&amp;</span>&nbsp;<span class="num" id="2713585">3</span><br>
<span class="lineno"></span><span class="op" id="2713587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2713590">func</span>&nbsp;<span class="op" id="2713595">(</span><span class="ident" id="2713596">gc</span>&nbsp;<span class="op" id="2713599">*</span><span class="ident" id="2713600">gcProg</span><span class="op" id="2713606">)</span>&nbsp;<span class="ident" id="2713608">align</span><span class="op" id="2713613">(</span><span class="ident" id="2713614">a</span>&nbsp;<span class="builtintype" id="2713616">uintptr</span><span class="op" id="2713623">)</span>&nbsp;<span class="op" id="2713625">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713628">gc</span><span class="op" id="2713630">.</span><span class="ident" id="2713631">size</span>&nbsp;<span class="op" id="2713636">=</span>&nbsp;<span class="ident" id="2713638">align</span><span class="op" id="2713643">(</span><span class="ident" id="2713644">gc</span><span class="op" id="2713646">.</span><span class="ident" id="2713647">size</span><span class="op" id="2713651">,</span>&nbsp;<span class="ident" id="2713653">a</span><span class="op" id="2713654">)</span><br>
<span class="lineno"></span><span class="op" id="2713656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713659">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2713720">const</span>&nbsp;<span class="op" id="2713726">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713729">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2713743">=</span>&nbsp;<span class="num" id="2713745">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713748">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2713762">=</span>&nbsp;<span class="num" id="2713764">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713767">bitsMultiWord</span>&nbsp;<span class="op" id="2713781">=</span>&nbsp;<span class="num" id="2713783">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713787">bitsIface</span>&nbsp;<span class="op" id="2713797">=</span>&nbsp;<span class="num" id="2713799">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713802">bitsEface</span>&nbsp;<span class="op" id="2713812">=</span>&nbsp;<span class="num" id="2713814">3</span><br>
<span class="lineno"></span><span class="op" id="2713816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713819">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2713891">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2713963">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2714038">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2714069">const</span>&nbsp;<span class="op" id="2714075">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714078">bucketSize</span>&nbsp;<span class="op" id="2714089">=</span>&nbsp;<span class="num" id="2714091">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714094">maxKeySize</span>&nbsp;<span class="op" id="2714105">=</span>&nbsp;<span class="num" id="2714107">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714112">maxValSize</span>&nbsp;<span class="op" id="2714123">=</span>&nbsp;<span class="num" id="2714125">128</span><br>
<span class="lineno"></span><span class="op" id="2714129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2714132">func</span>&nbsp;<span class="ident" id="2714137">bucketOf</span><span class="op" id="2714145">(</span><span class="ident" id="2714146">ktyp</span><span class="op" id="2714150">,</span>&nbsp;<span class="ident" id="2714152">etyp</span>&nbsp;<span class="op" id="2714157">*</span><span class="ident" id="2714158">rtype</span><span class="op" id="2714163">)</span>&nbsp;<span class="op" id="2714165">*</span><span class="ident" id="2714166">rtype</span>&nbsp;<span class="op" id="2714172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714175">if</span>&nbsp;<span class="ident" id="2714178">ktyp</span><span class="op" id="2714182">.</span><span class="ident" id="2714183">size</span>&nbsp;<span class="op" id="2714188">&gt;</span>&nbsp;<span class="ident" id="2714190">maxKeySize</span>&nbsp;<span class="op" id="2714201">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714205">ktyp</span>&nbsp;<span class="op" id="2714210">=</span>&nbsp;<span class="ident" id="2714212">PtrTo</span><span class="op" id="2714217">(</span><span class="ident" id="2714218">ktyp</span><span class="op" id="2714222">)</span><span class="op" id="2714223">.</span><span class="op" id="2714224">(</span><span class="op" id="2714225">*</span><span class="ident" id="2714226">rtype</span><span class="op" id="2714231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714237">if</span>&nbsp;<span class="ident" id="2714240">etyp</span><span class="op" id="2714244">.</span><span class="ident" id="2714245">size</span>&nbsp;<span class="op" id="2714250">&gt;</span>&nbsp;<span class="ident" id="2714252">maxValSize</span>&nbsp;<span class="op" id="2714263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714267">etyp</span>&nbsp;<span class="op" id="2714272">=</span>&nbsp;<span class="ident" id="2714274">PtrTo</span><span class="op" id="2714279">(</span><span class="ident" id="2714280">etyp</span><span class="op" id="2714284">)</span><span class="op" id="2714285">.</span><span class="op" id="2714286">(</span><span class="op" id="2714287">*</span><span class="ident" id="2714288">rtype</span><span class="op" id="2714293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714296">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714299">ptrsize</span>&nbsp;<span class="op" id="2714307">:=</span>&nbsp;<span class="ident" id="2714310">unsafe</span><span class="op" id="2714316">.</span><span class="ident" id="2714317">Sizeof</span><span class="op" id="2714323">(</span><span class="builtintype" id="2714324">uintptr</span><span class="op" id="2714331">(</span><span class="num" id="2714332">0</span><span class="op" id="2714333">)</span><span class="op" id="2714334">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714338">var</span>&nbsp;<span class="ident" id="2714342">gc</span>&nbsp;<span class="ident" id="2714345">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714353">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714365">for</span>&nbsp;<span class="ident" id="2714369">i</span>&nbsp;<span class="op" id="2714371">:=</span>&nbsp;<span class="num" id="2714374">0</span><span class="op" id="2714375">;</span>&nbsp;<span class="ident" id="2714377">i</span>&nbsp;<span class="op" id="2714379">&lt;</span>&nbsp;<span class="builtintype" id="2714381">int</span><span class="op" id="2714384">(</span><span class="ident" id="2714385">bucketSize</span><span class="op" id="2714395">*</span><span class="ident" id="2714396">unsafe</span><span class="op" id="2714402">.</span><span class="ident" id="2714403">Sizeof</span><span class="op" id="2714409">(</span><span class="builtintype" id="2714410">uint8</span><span class="op" id="2714415">(</span><span class="num" id="2714416">0</span><span class="op" id="2714417">)</span><span class="op" id="2714418">)</span><span class="op" id="2714419">/</span><span class="ident" id="2714420">ptrsize</span><span class="op" id="2714427">)</span><span class="op" id="2714428">;</span>&nbsp;<span class="ident" id="2714430">i</span><span class="op" id="2714431">++</span>&nbsp;<span class="op" id="2714434">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714438">gc</span><span class="op" id="2714440">.</span><span class="builtinfunc" id="2714441">append</span><span class="op" id="2714447">(</span><span class="ident" id="2714448">bitsScalar</span><span class="op" id="2714458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714464">gc</span><span class="op" id="2714466">.</span><span class="builtinfunc" id="2714467">append</span><span class="op" id="2714473">(</span><span class="ident" id="2714474">bitsPointer</span><span class="op" id="2714485">)</span>&nbsp;<span class="comment" id="2714487">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714500">if</span>&nbsp;<span class="ident" id="2714503">runtime</span><span class="op" id="2714510">.</span><span class="ident" id="2714511">GOARCH</span>&nbsp;<span class="op" id="2714518">==</span>&nbsp;<span class="string" id="2714521">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2714532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714536">gc</span><span class="op" id="2714538">.</span><span class="builtinfunc" id="2714539">append</span><span class="op" id="2714545">(</span><span class="ident" id="2714546">bitsScalar</span><span class="op" id="2714556">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714562">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714571">for</span>&nbsp;<span class="ident" id="2714575">i</span>&nbsp;<span class="op" id="2714577">:=</span>&nbsp;<span class="num" id="2714580">0</span><span class="op" id="2714581">;</span>&nbsp;<span class="ident" id="2714583">i</span>&nbsp;<span class="op" id="2714585">&lt;</span>&nbsp;<span class="ident" id="2714587">bucketSize</span><span class="op" id="2714597">;</span>&nbsp;<span class="ident" id="2714599">i</span><span class="op" id="2714600">++</span>&nbsp;<span class="op" id="2714603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714607">gc</span><span class="op" id="2714609">.</span><span class="ident" id="2714610">appendProg</span><span class="op" id="2714620">(</span><span class="ident" id="2714621">ktyp</span><span class="op" id="2714625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714628">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714631">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714642">for</span>&nbsp;<span class="ident" id="2714646">i</span>&nbsp;<span class="op" id="2714648">:=</span>&nbsp;<span class="num" id="2714651">0</span><span class="op" id="2714652">;</span>&nbsp;<span class="ident" id="2714654">i</span>&nbsp;<span class="op" id="2714656">&lt;</span>&nbsp;<span class="ident" id="2714658">bucketSize</span><span class="op" id="2714668">;</span>&nbsp;<span class="ident" id="2714670">i</span><span class="op" id="2714671">++</span>&nbsp;<span class="op" id="2714674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714678">gc</span><span class="op" id="2714680">.</span><span class="ident" id="2714681">appendProg</span><span class="op" id="2714691">(</span><span class="ident" id="2714692">etyp</span><span class="op" id="2714696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714703">b</span>&nbsp;<span class="op" id="2714705">:=</span>&nbsp;<span class="builtinfunc" id="2714708">new</span><span class="op" id="2714711">(</span><span class="ident" id="2714712">rtype</span><span class="op" id="2714717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714720">b</span><span class="op" id="2714721">.</span><span class="ident" id="2714722">size</span>&nbsp;<span class="op" id="2714727">=</span>&nbsp;<span class="ident" id="2714729">gc</span><span class="op" id="2714731">.</span><span class="ident" id="2714732">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714738">b</span><span class="op" id="2714739">.</span><span class="ident" id="2714740">gc</span><span class="op" id="2714742">[</span><span class="num" id="2714743">0</span><span class="op" id="2714744">]</span>&nbsp;<span class="op" id="2714746">=</span>&nbsp;<span class="ident" id="2714748">gc</span><span class="op" id="2714750">.</span><span class="ident" id="2714751">finalize</span><span class="op" id="2714759">(</span><span class="op" id="2714760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714763">s</span>&nbsp;<span class="op" id="2714765">:=</span>&nbsp;<span class="string" id="2714768">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2714778">+</span>&nbsp;<span class="op" id="2714780">*</span><span class="ident" id="2714781">ktyp</span><span class="op" id="2714785">.</span><span class="builtintype" id="2714786">string</span>&nbsp;<span class="op" id="2714793">+</span>&nbsp;<span class="string" id="2714795">&#34;,&#34;</span>&nbsp;<span class="op" id="2714799">+</span>&nbsp;<span class="op" id="2714801">*</span><span class="ident" id="2714802">etyp</span><span class="op" id="2714806">.</span><span class="builtintype" id="2714807">string</span>&nbsp;<span class="op" id="2714814">+</span>&nbsp;<span class="string" id="2714816">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714821">b</span><span class="op" id="2714822">.</span><span class="builtintype" id="2714823">string</span>&nbsp;<span class="op" id="2714830">=</span>&nbsp;<span class="op" id="2714832">&amp;</span><span class="ident" id="2714833">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714836">return</span>&nbsp;<span class="ident" id="2714843">b</span><br>
<span class="lineno"></span><span class="op" id="2714845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2714848">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2714903">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2714969">func</span>&nbsp;<span class="ident" id="2714974">SliceOf</span><span class="op" id="2714981">(</span><span class="ident" id="2714982">t</span>&nbsp;<span class="ident" id="2714984">Type</span><span class="op" id="2714988">)</span>&nbsp;<span class="ident" id="2714990">Type</span>&nbsp;<span class="op" id="2714995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714998">typ</span>&nbsp;<span class="op" id="2715002">:=</span>&nbsp;<span class="ident" id="2715005">t</span><span class="op" id="2715006">.</span><span class="op" id="2715007">(</span><span class="op" id="2715008">*</span><span class="ident" id="2715009">rtype</span><span class="op" id="2715014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715018">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715037">ckey</span>&nbsp;<span class="op" id="2715042">:=</span>&nbsp;<span class="ident" id="2715045">cacheKey</span><span class="op" id="2715053">{</span><span class="ident" id="2715054">Slice</span><span class="op" id="2715059">,</span>&nbsp;<span class="ident" id="2715061">typ</span><span class="op" id="2715064">,</span>&nbsp;<span class="ident" id="2715066">nil</span><span class="op" id="2715069">,</span>&nbsp;<span class="num" id="2715071">0</span><span class="op" id="2715072">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715075">if</span>&nbsp;<span class="ident" id="2715078">slice</span>&nbsp;<span class="op" id="2715084">:=</span>&nbsp;<span class="ident" id="2715087">cacheGet</span><span class="op" id="2715095">(</span><span class="ident" id="2715096">ckey</span><span class="op" id="2715100">)</span><span class="op" id="2715101">;</span>&nbsp;<span class="ident" id="2715103">slice</span>&nbsp;<span class="op" id="2715109">!=</span>&nbsp;<span class="ident" id="2715112">nil</span>&nbsp;<span class="op" id="2715116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715120">return</span>&nbsp;<span class="ident" id="2715127">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715138">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715163">s</span>&nbsp;<span class="op" id="2715165">:=</span>&nbsp;<span class="string" id="2715168">&#34;[]&#34;</span>&nbsp;<span class="op" id="2715173">+</span>&nbsp;<span class="op" id="2715175">*</span><span class="ident" id="2715176">typ</span><span class="op" id="2715179">.</span><span class="builtintype" id="2715180">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715188">for</span>&nbsp;<span class="ident" id="2715192">_</span><span class="op" id="2715193">,</span>&nbsp;<span class="ident" id="2715195">tt</span>&nbsp;<span class="op" id="2715198">:=</span>&nbsp;<span class="keyword" id="2715201">range</span>&nbsp;<span class="ident" id="2715207">typesByString</span><span class="op" id="2715220">(</span><span class="ident" id="2715221">s</span><span class="op" id="2715222">)</span>&nbsp;<span class="op" id="2715224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715228">slice</span>&nbsp;<span class="op" id="2715234">:=</span>&nbsp;<span class="op" id="2715237">(</span><span class="op" id="2715238">*</span><span class="ident" id="2715239">sliceType</span><span class="op" id="2715248">)</span><span class="op" id="2715249">(</span><span class="ident" id="2715250">unsafe</span><span class="op" id="2715256">.</span><span class="ident" id="2715257">Pointer</span><span class="op" id="2715264">(</span><span class="ident" id="2715265">tt</span><span class="op" id="2715267">)</span><span class="op" id="2715268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715272">if</span>&nbsp;<span class="ident" id="2715275">slice</span><span class="op" id="2715280">.</span><span class="ident" id="2715281">elem</span>&nbsp;<span class="op" id="2715286">==</span>&nbsp;<span class="ident" id="2715289">typ</span>&nbsp;<span class="op" id="2715293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715298">return</span>&nbsp;<span class="ident" id="2715305">cachePut</span><span class="op" id="2715313">(</span><span class="ident" id="2715314">ckey</span><span class="op" id="2715318">,</span>&nbsp;<span class="ident" id="2715320">tt</span><span class="op" id="2715322">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715333">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715356">var</span>&nbsp;<span class="ident" id="2715360">islice</span>&nbsp;<span class="keyword" id="2715367">interface</span><span class="op" id="2715376">{</span><span class="op" id="2715377">}</span>&nbsp;<span class="op" id="2715379">=</span>&nbsp;<span class="op" id="2715381">(</span><span class="op" id="2715382">[</span><span class="op" id="2715383">]</span><span class="ident" id="2715384">unsafe</span><span class="op" id="2715390">.</span><span class="ident" id="2715391">Pointer</span><span class="op" id="2715398">)</span><span class="op" id="2715399">(</span><span class="ident" id="2715400">nil</span><span class="op" id="2715403">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715406">prototype</span>&nbsp;<span class="op" id="2715416">:=</span>&nbsp;<span class="op" id="2715419">*</span><span class="op" id="2715420">(</span><span class="op" id="2715421">*</span><span class="op" id="2715422">*</span><span class="ident" id="2715423">sliceType</span><span class="op" id="2715432">)</span><span class="op" id="2715433">(</span><span class="ident" id="2715434">unsafe</span><span class="op" id="2715440">.</span><span class="ident" id="2715441">Pointer</span><span class="op" id="2715448">(</span><span class="op" id="2715449">&amp;</span><span class="ident" id="2715450">islice</span><span class="op" id="2715456">)</span><span class="op" id="2715457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715460">slice</span>&nbsp;<span class="op" id="2715466">:=</span>&nbsp;<span class="builtinfunc" id="2715469">new</span><span class="op" id="2715472">(</span><span class="ident" id="2715473">sliceType</span><span class="op" id="2715482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715485">*</span><span class="ident" id="2715486">slice</span>&nbsp;<span class="op" id="2715492">=</span>&nbsp;<span class="op" id="2715494">*</span><span class="ident" id="2715495">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715506">slice</span><span class="op" id="2715511">.</span><span class="builtintype" id="2715512">string</span>&nbsp;<span class="op" id="2715519">=</span>&nbsp;<span class="op" id="2715521">&amp;</span><span class="ident" id="2715522">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715525">slice</span><span class="op" id="2715530">.</span><span class="ident" id="2715531">hash</span>&nbsp;<span class="op" id="2715536">=</span>&nbsp;<span class="ident" id="2715538">fnv1</span><span class="op" id="2715542">(</span><span class="ident" id="2715543">typ</span><span class="op" id="2715546">.</span><span class="ident" id="2715547">hash</span><span class="op" id="2715551">,</span>&nbsp;<span class="string" id="2715553">&#39;[&#39;</span><span class="op" id="2715556">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715559">slice</span><span class="op" id="2715564">.</span><span class="ident" id="2715565">elem</span>&nbsp;<span class="op" id="2715570">=</span>&nbsp;<span class="ident" id="2715572">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715577">slice</span><span class="op" id="2715582">.</span><span class="ident" id="2715583">uncommonType</span>&nbsp;<span class="op" id="2715596">=</span>&nbsp;<span class="ident" id="2715598">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715603">slice</span><span class="op" id="2715608">.</span><span class="ident" id="2715609">ptrToThis</span>&nbsp;<span class="op" id="2715619">=</span>&nbsp;<span class="ident" id="2715621">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715626">slice</span><span class="op" id="2715631">.</span><span class="ident" id="2715632">zero</span>&nbsp;<span class="op" id="2715637">=</span>&nbsp;<span class="ident" id="2715639">unsafe</span><span class="op" id="2715645">.</span><span class="ident" id="2715646">Pointer</span><span class="op" id="2715653">(</span><span class="op" id="2715654">&amp;</span><span class="builtinfunc" id="2715655">make</span><span class="op" id="2715659">(</span><span class="op" id="2715660">[</span><span class="op" id="2715661">]</span><span class="builtintype" id="2715662">byte</span><span class="op" id="2715666">,</span>&nbsp;<span class="ident" id="2715668">slice</span><span class="op" id="2715673">.</span><span class="ident" id="2715674">size</span><span class="op" id="2715678">)</span><span class="op" id="2715679">[</span><span class="num" id="2715680">0</span><span class="op" id="2715681">]</span><span class="op" id="2715682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715686">return</span>&nbsp;<span class="ident" id="2715693">cachePut</span><span class="op" id="2715701">(</span><span class="ident" id="2715702">ckey</span><span class="op" id="2715706">,</span>&nbsp;<span class="op" id="2715708">&amp;</span><span class="ident" id="2715709">slice</span><span class="op" id="2715714">.</span><span class="ident" id="2715715">rtype</span><span class="op" id="2715720">)</span><br>
<span class="lineno"></span><span class="op" id="2715722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2715725">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2715798">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2715868">//</span><br>
<span class="lineno"></span><span class="comment" id="2715871">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2715946">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2715965">//</span><br>
<span class="lineno"></span><span class="comment" id="2715968">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2716045">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2716097">//</span><br>
<span class="lineno"></span><span class="comment" id="2716100">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2716155">func</span>&nbsp;<span class="ident" id="2716160">arrayOf</span><span class="op" id="2716167">(</span><span class="ident" id="2716168">count</span>&nbsp;<span class="builtintype" id="2716174">int</span><span class="op" id="2716177">,</span>&nbsp;<span class="ident" id="2716179">elem</span>&nbsp;<span class="ident" id="2716184">Type</span><span class="op" id="2716188">)</span>&nbsp;<span class="ident" id="2716190">Type</span>&nbsp;<span class="op" id="2716195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716198">typ</span>&nbsp;<span class="op" id="2716202">:=</span>&nbsp;<span class="ident" id="2716205">elem</span><span class="op" id="2716209">.</span><span class="op" id="2716210">(</span><span class="op" id="2716211">*</span><span class="ident" id="2716212">rtype</span><span class="op" id="2716217">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716220">slice</span>&nbsp;<span class="op" id="2716226">:=</span>&nbsp;<span class="ident" id="2716229">SliceOf</span><span class="op" id="2716236">(</span><span class="ident" id="2716237">elem</span><span class="op" id="2716241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716245">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716264">ckey</span>&nbsp;<span class="op" id="2716269">:=</span>&nbsp;<span class="ident" id="2716272">cacheKey</span><span class="op" id="2716280">{</span><span class="ident" id="2716281">Array</span><span class="op" id="2716286">,</span>&nbsp;<span class="ident" id="2716288">typ</span><span class="op" id="2716291">,</span>&nbsp;<span class="ident" id="2716293">nil</span><span class="op" id="2716296">,</span>&nbsp;<span class="builtintype" id="2716298">uintptr</span><span class="op" id="2716305">(</span><span class="ident" id="2716306">count</span><span class="op" id="2716311">)</span><span class="op" id="2716312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716315">if</span>&nbsp;<span class="ident" id="2716318">slice</span>&nbsp;<span class="op" id="2716324">:=</span>&nbsp;<span class="ident" id="2716327">cacheGet</span><span class="op" id="2716335">(</span><span class="ident" id="2716336">ckey</span><span class="op" id="2716340">)</span><span class="op" id="2716341">;</span>&nbsp;<span class="ident" id="2716343">slice</span>&nbsp;<span class="op" id="2716349">!=</span>&nbsp;<span class="ident" id="2716352">nil</span>&nbsp;<span class="op" id="2716356">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716360">return</span>&nbsp;<span class="ident" id="2716367">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716378">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716403">s</span>&nbsp;<span class="op" id="2716405">:=</span>&nbsp;<span class="string" id="2716408">&#34;[&#34;</span>&nbsp;<span class="op" id="2716412">+</span>&nbsp;<span class="ident" id="2716414">strconv</span><span class="op" id="2716421">.</span><span class="ident" id="2716422">Itoa</span><span class="op" id="2716426">(</span><span class="ident" id="2716427">count</span><span class="op" id="2716432">)</span>&nbsp;<span class="op" id="2716434">+</span>&nbsp;<span class="string" id="2716436">&#34;]&#34;</span>&nbsp;<span class="op" id="2716440">+</span>&nbsp;<span class="op" id="2716442">*</span><span class="ident" id="2716443">typ</span><span class="op" id="2716446">.</span><span class="builtintype" id="2716447">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716455">for</span>&nbsp;<span class="ident" id="2716459">_</span><span class="op" id="2716460">,</span>&nbsp;<span class="ident" id="2716462">tt</span>&nbsp;<span class="op" id="2716465">:=</span>&nbsp;<span class="keyword" id="2716468">range</span>&nbsp;<span class="ident" id="2716474">typesByString</span><span class="op" id="2716487">(</span><span class="ident" id="2716488">s</span><span class="op" id="2716489">)</span>&nbsp;<span class="op" id="2716491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716495">slice</span>&nbsp;<span class="op" id="2716501">:=</span>&nbsp;<span class="op" id="2716504">(</span><span class="op" id="2716505">*</span><span class="ident" id="2716506">sliceType</span><span class="op" id="2716515">)</span><span class="op" id="2716516">(</span><span class="ident" id="2716517">unsafe</span><span class="op" id="2716523">.</span><span class="ident" id="2716524">Pointer</span><span class="op" id="2716531">(</span><span class="ident" id="2716532">tt</span><span class="op" id="2716534">)</span><span class="op" id="2716535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716539">if</span>&nbsp;<span class="ident" id="2716542">slice</span><span class="op" id="2716547">.</span><span class="ident" id="2716548">elem</span>&nbsp;<span class="op" id="2716553">==</span>&nbsp;<span class="ident" id="2716556">typ</span>&nbsp;<span class="op" id="2716560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716565">return</span>&nbsp;<span class="ident" id="2716572">cachePut</span><span class="op" id="2716580">(</span><span class="ident" id="2716581">ckey</span><span class="op" id="2716585">,</span>&nbsp;<span class="ident" id="2716587">tt</span><span class="op" id="2716589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716593">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716600">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716624">var</span>&nbsp;<span class="ident" id="2716628">iarray</span>&nbsp;<span class="keyword" id="2716635">interface</span><span class="op" id="2716644">{</span><span class="op" id="2716645">}</span>&nbsp;<span class="op" id="2716647">=</span>&nbsp;<span class="op" id="2716649">[</span><span class="num" id="2716650">1</span><span class="op" id="2716651">]</span><span class="ident" id="2716652">unsafe</span><span class="op" id="2716658">.</span><span class="ident" id="2716659">Pointer</span><span class="op" id="2716666">{</span><span class="op" id="2716667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716670">prototype</span>&nbsp;<span class="op" id="2716680">:=</span>&nbsp;<span class="op" id="2716683">*</span><span class="op" id="2716684">(</span><span class="op" id="2716685">*</span><span class="op" id="2716686">*</span><span class="ident" id="2716687">arrayType</span><span class="op" id="2716696">)</span><span class="op" id="2716697">(</span><span class="ident" id="2716698">unsafe</span><span class="op" id="2716704">.</span><span class="ident" id="2716705">Pointer</span><span class="op" id="2716712">(</span><span class="op" id="2716713">&amp;</span><span class="ident" id="2716714">iarray</span><span class="op" id="2716720">)</span><span class="op" id="2716721">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716724">array</span>&nbsp;<span class="op" id="2716730">:=</span>&nbsp;<span class="builtinfunc" id="2716733">new</span><span class="op" id="2716736">(</span><span class="ident" id="2716737">arrayType</span><span class="op" id="2716746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716749">*</span><span class="ident" id="2716750">array</span>&nbsp;<span class="op" id="2716756">=</span>&nbsp;<span class="op" id="2716758">*</span><span class="ident" id="2716759">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716770">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716811">array</span><span class="op" id="2716816">.</span><span class="builtintype" id="2716817">string</span>&nbsp;<span class="op" id="2716824">=</span>&nbsp;<span class="op" id="2716826">&amp;</span><span class="ident" id="2716827">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716830">array</span><span class="op" id="2716835">.</span><span class="ident" id="2716836">hash</span>&nbsp;<span class="op" id="2716841">=</span>&nbsp;<span class="ident" id="2716843">fnv1</span><span class="op" id="2716847">(</span><span class="ident" id="2716848">typ</span><span class="op" id="2716851">.</span><span class="ident" id="2716852">hash</span><span class="op" id="2716856">,</span>&nbsp;<span class="string" id="2716858">&#39;[&#39;</span><span class="op" id="2716861">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716864">for</span>&nbsp;<span class="ident" id="2716868">n</span>&nbsp;<span class="op" id="2716870">:=</span>&nbsp;<span class="builtintype" id="2716873">uint32</span><span class="op" id="2716879">(</span><span class="ident" id="2716880">count</span><span class="op" id="2716885">)</span><span class="op" id="2716886">;</span>&nbsp;<span class="ident" id="2716888">n</span>&nbsp;<span class="op" id="2716890">&gt;</span>&nbsp;<span class="num" id="2716892">0</span><span class="op" id="2716893">;</span>&nbsp;<span class="ident" id="2716895">n</span>&nbsp;<span class="op" id="2716897">&gt;&gt;=</span>&nbsp;<span class="num" id="2716901">8</span>&nbsp;<span class="op" id="2716903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716907">array</span><span class="op" id="2716912">.</span><span class="ident" id="2716913">hash</span>&nbsp;<span class="op" id="2716918">=</span>&nbsp;<span class="ident" id="2716920">fnv1</span><span class="op" id="2716924">(</span><span class="ident" id="2716925">array</span><span class="op" id="2716930">.</span><span class="ident" id="2716931">hash</span><span class="op" id="2716935">,</span>&nbsp;<span class="builtintype" id="2716937">byte</span><span class="op" id="2716941">(</span><span class="ident" id="2716942">n</span><span class="op" id="2716943">)</span><span class="op" id="2716944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716950">array</span><span class="op" id="2716955">.</span><span class="ident" id="2716956">hash</span>&nbsp;<span class="op" id="2716961">=</span>&nbsp;<span class="ident" id="2716963">fnv1</span><span class="op" id="2716967">(</span><span class="ident" id="2716968">array</span><span class="op" id="2716973">.</span><span class="ident" id="2716974">hash</span><span class="op" id="2716978">,</span>&nbsp;<span class="string" id="2716980">&#39;]&#39;</span><span class="op" id="2716983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716986">array</span><span class="op" id="2716991">.</span><span class="ident" id="2716992">elem</span>&nbsp;<span class="op" id="2716997">=</span>&nbsp;<span class="ident" id="2716999">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717004">max</span>&nbsp;<span class="op" id="2717008">:=</span>&nbsp;<span class="op" id="2717011">^</span><span class="builtintype" id="2717012">uintptr</span><span class="op" id="2717019">(</span><span class="num" id="2717020">0</span><span class="op" id="2717021">)</span>&nbsp;<span class="op" id="2717023">/</span>&nbsp;<span class="ident" id="2717025">typ</span><span class="op" id="2717028">.</span><span class="ident" id="2717029">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2717035">if</span>&nbsp;<span class="builtintype" id="2717038">uintptr</span><span class="op" id="2717045">(</span><span class="ident" id="2717046">count</span><span class="op" id="2717051">)</span>&nbsp;<span class="op" id="2717053">&gt;</span>&nbsp;<span class="ident" id="2717055">max</span>&nbsp;<span class="op" id="2717059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2717063">panic</span><span class="op" id="2717068">(</span><span class="string" id="2717069">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2717133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2717136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717139">array</span><span class="op" id="2717144">.</span><span class="ident" id="2717145">size</span>&nbsp;<span class="op" id="2717150">=</span>&nbsp;<span class="ident" id="2717152">typ</span><span class="op" id="2717155">.</span><span class="ident" id="2717156">size</span>&nbsp;<span class="op" id="2717161">*</span>&nbsp;<span class="builtintype" id="2717163">uintptr</span><span class="op" id="2717170">(</span><span class="ident" id="2717171">count</span><span class="op" id="2717176">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717179">array</span><span class="op" id="2717184">.</span><span class="ident" id="2717185">align</span>&nbsp;<span class="op" id="2717191">=</span>&nbsp;<span class="ident" id="2717193">typ</span><span class="op" id="2717196">.</span><span class="ident" id="2717197">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717204">array</span><span class="op" id="2717209">.</span><span class="ident" id="2717210">fieldAlign</span>&nbsp;<span class="op" id="2717221">=</span>&nbsp;<span class="ident" id="2717223">typ</span><span class="op" id="2717226">.</span><span class="ident" id="2717227">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2717239">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2717259">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2717278">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717288">array</span><span class="op" id="2717293">.</span><span class="ident" id="2717294">uncommonType</span>&nbsp;<span class="op" id="2717307">=</span>&nbsp;<span class="ident" id="2717309">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717314">array</span><span class="op" id="2717319">.</span><span class="ident" id="2717320">ptrToThis</span>&nbsp;<span class="op" id="2717330">=</span>&nbsp;<span class="ident" id="2717332">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717337">array</span><span class="op" id="2717342">.</span><span class="ident" id="2717343">zero</span>&nbsp;<span class="op" id="2717348">=</span>&nbsp;<span class="ident" id="2717350">unsafe</span><span class="op" id="2717356">.</span><span class="ident" id="2717357">Pointer</span><span class="op" id="2717364">(</span><span class="op" id="2717365">&amp;</span><span class="builtinfunc" id="2717366">make</span><span class="op" id="2717370">(</span><span class="op" id="2717371">[</span><span class="op" id="2717372">]</span><span class="builtintype" id="2717373">byte</span><span class="op" id="2717377">,</span>&nbsp;<span class="ident" id="2717379">array</span><span class="op" id="2717384">.</span><span class="ident" id="2717385">size</span><span class="op" id="2717389">)</span><span class="op" id="2717390">[</span><span class="num" id="2717391">0</span><span class="op" id="2717392">]</span><span class="op" id="2717393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717396">array</span><span class="op" id="2717401">.</span><span class="builtinfunc" id="2717402">len</span>&nbsp;<span class="op" id="2717406">=</span>&nbsp;<span class="builtintype" id="2717408">uintptr</span><span class="op" id="2717415">(</span><span class="ident" id="2717416">count</span><span class="op" id="2717421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717424">array</span><span class="op" id="2717429">.</span><span class="ident" id="2717430">slice</span>&nbsp;<span class="op" id="2717436">=</span>&nbsp;<span class="ident" id="2717438">slice</span><span class="op" id="2717443">.</span><span class="op" id="2717444">(</span><span class="op" id="2717445">*</span><span class="ident" id="2717446">rtype</span><span class="op" id="2717451">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2717455">return</span>&nbsp;<span class="ident" id="2717462">cachePut</span><span class="op" id="2717470">(</span><span class="ident" id="2717471">ckey</span><span class="op" id="2717475">,</span>&nbsp;<span class="op" id="2717477">&amp;</span><span class="ident" id="2717478">array</span><span class="op" id="2717483">.</span><span class="ident" id="2717484">rtype</span><span class="op" id="2717489">)</span><br>
<span class="lineno"></span><span class="op" id="2717491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2717494">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2717558">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2717627">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2717693">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2717762">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2717804">func</span>&nbsp;<span class="ident" id="2717809">toType</span><span class="op" id="2717815">(</span><span class="ident" id="2717816">t</span>&nbsp;<span class="op" id="2717818">*</span><span class="ident" id="2717819">rtype</span><span class="op" id="2717824">)</span>&nbsp;<span class="ident" id="2717826">Type</span>&nbsp;<span class="op" id="2717831">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2717834">if</span>&nbsp;<span class="ident" id="2717837">t</span>&nbsp;<span class="op" id="2717839">==</span>&nbsp;<span class="ident" id="2717842">nil</span>&nbsp;<span class="op" id="2717846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2717850">return</span>&nbsp;<span class="ident" id="2717857">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2717862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2717865">return</span>&nbsp;<span class="ident" id="2717872">t</span><br>
<span class="lineno"></span><span class="op" id="2717874">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2717877">type</span>&nbsp;<span class="ident" id="2717882">layoutKey</span>&nbsp;<span class="keyword" id="2717892">struct</span>&nbsp;<span class="op" id="2717899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717902">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2717907">*</span><span class="ident" id="2717908">rtype</span>&nbsp;<span class="comment" id="2717914">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717937">rcvr</span>&nbsp;<span class="op" id="2717942">*</span><span class="ident" id="2717943">rtype</span>&nbsp;<span class="comment" id="2717949">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2717982">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2717985">type</span>&nbsp;<span class="ident" id="2717990">layoutType</span>&nbsp;<span class="keyword" id="2718001">struct</span>&nbsp;<span class="op" id="2718008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718011">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718021">*</span><span class="ident" id="2718022">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718029">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2718039">uintptr</span>&nbsp;<span class="comment" id="2718047">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718069">retOffset</span>&nbsp;<span class="builtintype" id="2718079">uintptr</span>&nbsp;<span class="comment" id="2718087">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718116">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718126">*</span><span class="ident" id="2718127">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2718137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2718140">var</span>&nbsp;<span class="ident" id="2718144">layoutCache</span>&nbsp;<span class="keyword" id="2718156">struct</span>&nbsp;<span class="op" id="2718163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718166">sync</span><span class="op" id="2718170">.</span><span class="ident" id="2718171">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718180">m</span>&nbsp;<span class="keyword" id="2718182">map</span><span class="op" id="2718185">[</span><span class="ident" id="2718186">layoutKey</span><span class="op" id="2718195">]</span><span class="ident" id="2718196">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2718207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2718210">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2718278">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2718343">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2718403">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2718482">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2718550">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2718590">func</span>&nbsp;<span class="ident" id="2718595">funcLayout</span><span class="op" id="2718605">(</span><span class="ident" id="2718606">t</span>&nbsp;<span class="op" id="2718608">*</span><span class="ident" id="2718609">rtype</span><span class="op" id="2718614">,</span>&nbsp;<span class="ident" id="2718616">rcvr</span>&nbsp;<span class="op" id="2718621">*</span><span class="ident" id="2718622">rtype</span><span class="op" id="2718627">)</span>&nbsp;<span class="op" id="2718629">(</span><span class="ident" id="2718630">frametype</span>&nbsp;<span class="op" id="2718640">*</span><span class="ident" id="2718641">rtype</span><span class="op" id="2718646">,</span>&nbsp;<span class="ident" id="2718648">argSize</span><span class="op" id="2718655">,</span>&nbsp;<span class="ident" id="2718657">retOffset</span>&nbsp;<span class="builtintype" id="2718667">uintptr</span><span class="op" id="2718674">,</span>&nbsp;<span class="ident" id="2718676">stack</span>&nbsp;<span class="op" id="2718682">*</span><span class="ident" id="2718683">bitVector</span><span class="op" id="2718692">)</span>&nbsp;<span class="op" id="2718694">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718697">if</span>&nbsp;<span class="ident" id="2718700">t</span><span class="op" id="2718701">.</span><span class="ident" id="2718702">Kind</span><span class="op" id="2718706">(</span><span class="op" id="2718707">)</span>&nbsp;<span class="op" id="2718709">!=</span>&nbsp;<span class="ident" id="2718712">Func</span>&nbsp;<span class="op" id="2718717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2718721">panic</span><span class="op" id="2718726">(</span><span class="string" id="2718727">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2718765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718771">if</span>&nbsp;<span class="ident" id="2718774">rcvr</span>&nbsp;<span class="op" id="2718779">!=</span>&nbsp;<span class="ident" id="2718782">nil</span>&nbsp;<span class="op" id="2718786">&amp;&amp;</span>&nbsp;<span class="ident" id="2718789">rcvr</span><span class="op" id="2718793">.</span><span class="ident" id="2718794">Kind</span><span class="op" id="2718798">(</span><span class="op" id="2718799">)</span>&nbsp;<span class="op" id="2718801">==</span>&nbsp;<span class="ident" id="2718804">Interface</span>&nbsp;<span class="op" id="2718814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2718818">panic</span><span class="op" id="2718823">(</span><span class="string" id="2718824">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2718871">+</span>&nbsp;<span class="ident" id="2718873">rcvr</span><span class="op" id="2718877">.</span><span class="ident" id="2718878">String</span><span class="op" id="2718884">(</span><span class="op" id="2718885">)</span><span class="op" id="2718886">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718892">k</span>&nbsp;<span class="op" id="2718894">:=</span>&nbsp;<span class="ident" id="2718897">layoutKey</span><span class="op" id="2718906">{</span><span class="ident" id="2718907">t</span><span class="op" id="2718908">,</span>&nbsp;<span class="ident" id="2718910">rcvr</span><span class="op" id="2718914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718917">layoutCache</span><span class="op" id="2718928">.</span><span class="ident" id="2718929">RLock</span><span class="op" id="2718934">(</span><span class="op" id="2718935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718938">if</span>&nbsp;<span class="ident" id="2718941">x</span>&nbsp;<span class="op" id="2718943">:=</span>&nbsp;<span class="ident" id="2718946">layoutCache</span><span class="op" id="2718957">.</span><span class="ident" id="2718958">m</span><span class="op" id="2718959">[</span><span class="ident" id="2718960">k</span><span class="op" id="2718961">]</span><span class="op" id="2718962">;</span>&nbsp;<span class="ident" id="2718964">x</span><span class="op" id="2718965">.</span><span class="ident" id="2718966">t</span>&nbsp;<span class="op" id="2718968">!=</span>&nbsp;<span class="ident" id="2718971">nil</span>&nbsp;<span class="op" id="2718975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718979">layoutCache</span><span class="op" id="2718990">.</span><span class="ident" id="2718991">RUnlock</span><span class="op" id="2718998">(</span><span class="op" id="2718999">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719003">return</span>&nbsp;<span class="ident" id="2719010">x</span><span class="op" id="2719011">.</span><span class="ident" id="2719012">t</span><span class="op" id="2719013">,</span>&nbsp;<span class="ident" id="2719015">x</span><span class="op" id="2719016">.</span><span class="ident" id="2719017">argSize</span><span class="op" id="2719024">,</span>&nbsp;<span class="ident" id="2719026">x</span><span class="op" id="2719027">.</span><span class="ident" id="2719028">retOffset</span><span class="op" id="2719037">,</span>&nbsp;<span class="ident" id="2719039">x</span><span class="op" id="2719040">.</span><span class="ident" id="2719041">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719051">layoutCache</span><span class="op" id="2719062">.</span><span class="ident" id="2719063">RUnlock</span><span class="op" id="2719070">(</span><span class="op" id="2719071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719074">layoutCache</span><span class="op" id="2719085">.</span><span class="ident" id="2719086">Lock</span><span class="op" id="2719090">(</span><span class="op" id="2719091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719094">if</span>&nbsp;<span class="ident" id="2719097">x</span>&nbsp;<span class="op" id="2719099">:=</span>&nbsp;<span class="ident" id="2719102">layoutCache</span><span class="op" id="2719113">.</span><span class="ident" id="2719114">m</span><span class="op" id="2719115">[</span><span class="ident" id="2719116">k</span><span class="op" id="2719117">]</span><span class="op" id="2719118">;</span>&nbsp;<span class="ident" id="2719120">x</span><span class="op" id="2719121">.</span><span class="ident" id="2719122">t</span>&nbsp;<span class="op" id="2719124">!=</span>&nbsp;<span class="ident" id="2719127">nil</span>&nbsp;<span class="op" id="2719131">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719135">layoutCache</span><span class="op" id="2719146">.</span><span class="ident" id="2719147">Unlock</span><span class="op" id="2719153">(</span><span class="op" id="2719154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719158">return</span>&nbsp;<span class="ident" id="2719165">x</span><span class="op" id="2719166">.</span><span class="ident" id="2719167">t</span><span class="op" id="2719168">,</span>&nbsp;<span class="ident" id="2719170">x</span><span class="op" id="2719171">.</span><span class="ident" id="2719172">argSize</span><span class="op" id="2719179">,</span>&nbsp;<span class="ident" id="2719181">x</span><span class="op" id="2719182">.</span><span class="ident" id="2719183">retOffset</span><span class="op" id="2719192">,</span>&nbsp;<span class="ident" id="2719194">x</span><span class="op" id="2719195">.</span><span class="ident" id="2719196">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719207">tt</span>&nbsp;<span class="op" id="2719210">:=</span>&nbsp;<span class="op" id="2719213">(</span><span class="op" id="2719214">*</span><span class="ident" id="2719215">funcType</span><span class="op" id="2719223">)</span><span class="op" id="2719224">(</span><span class="ident" id="2719225">unsafe</span><span class="op" id="2719231">.</span><span class="ident" id="2719232">Pointer</span><span class="op" id="2719239">(</span><span class="ident" id="2719240">t</span><span class="op" id="2719241">)</span><span class="op" id="2719242">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719246">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719298">stack</span>&nbsp;<span class="op" id="2719304">=</span>&nbsp;<span class="builtinfunc" id="2719306">new</span><span class="op" id="2719309">(</span><span class="ident" id="2719310">bitVector</span><span class="op" id="2719319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719322">var</span>&nbsp;<span class="ident" id="2719326">gc</span>&nbsp;<span class="ident" id="2719329">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719337">var</span>&nbsp;<span class="ident" id="2719341">offset</span>&nbsp;<span class="builtintype" id="2719348">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719357">if</span>&nbsp;<span class="ident" id="2719360">rcvr</span>&nbsp;<span class="op" id="2719365">!=</span>&nbsp;<span class="ident" id="2719368">nil</span>&nbsp;<span class="op" id="2719372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719376">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719433">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719489">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719537">if</span>&nbsp;<span class="ident" id="2719540">ifaceIndir</span><span class="op" id="2719550">(</span><span class="ident" id="2719551">rcvr</span><span class="op" id="2719555">)</span>&nbsp;<span class="op" id="2719557">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719562">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719603">gc</span><span class="op" id="2719605">.</span><span class="builtinfunc" id="2719606">append</span><span class="op" id="2719612">(</span><span class="ident" id="2719613">bitsPointer</span><span class="op" id="2719624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719629">stack</span><span class="op" id="2719634">.</span><span class="ident" id="2719635">append2</span><span class="op" id="2719642">(</span><span class="ident" id="2719643">bitsPointer</span><span class="op" id="2719654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719658">}</span>&nbsp;<span class="keyword" id="2719660">else</span>&nbsp;<span class="keyword" id="2719665">if</span>&nbsp;<span class="ident" id="2719668">rcvr</span><span class="op" id="2719672">.</span><span class="ident" id="2719673">pointers</span><span class="op" id="2719681">(</span><span class="op" id="2719682">)</span>&nbsp;<span class="op" id="2719684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719689">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2719746">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719779">gc</span><span class="op" id="2719781">.</span><span class="builtinfunc" id="2719782">append</span><span class="op" id="2719788">(</span><span class="ident" id="2719789">bitsPointer</span><span class="op" id="2719800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719805">stack</span><span class="op" id="2719810">.</span><span class="ident" id="2719811">append2</span><span class="op" id="2719818">(</span><span class="ident" id="2719819">bitsPointer</span><span class="op" id="2719830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719834">}</span>&nbsp;<span class="keyword" id="2719836">else</span>&nbsp;<span class="op" id="2719841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719846">gc</span><span class="op" id="2719848">.</span><span class="builtinfunc" id="2719849">append</span><span class="op" id="2719855">(</span><span class="ident" id="2719856">bitsScalar</span><span class="op" id="2719866">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719871">stack</span><span class="op" id="2719876">.</span><span class="ident" id="2719877">append2</span><span class="op" id="2719884">(</span><span class="ident" id="2719885">bitsScalar</span><span class="op" id="2719895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719903">offset</span>&nbsp;<span class="op" id="2719910">+=</span>&nbsp;<span class="ident" id="2719913">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719925">for</span>&nbsp;<span class="ident" id="2719929">_</span><span class="op" id="2719930">,</span>&nbsp;<span class="ident" id="2719932">arg</span>&nbsp;<span class="op" id="2719936">:=</span>&nbsp;<span class="keyword" id="2719939">range</span>&nbsp;<span class="ident" id="2719945">tt</span><span class="op" id="2719947">.</span><span class="ident" id="2719948">in</span>&nbsp;<span class="op" id="2719951">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719955">gc</span><span class="op" id="2719957">.</span><span class="ident" id="2719958">appendProg</span><span class="op" id="2719968">(</span><span class="ident" id="2719969">arg</span><span class="op" id="2719972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719976">addTypeBits</span><span class="op" id="2719987">(</span><span class="ident" id="2719988">stack</span><span class="op" id="2719993">,</span>&nbsp;<span class="op" id="2719995">&amp;</span><span class="ident" id="2719996">offset</span><span class="op" id="2720002">,</span>&nbsp;<span class="ident" id="2720004">arg</span><span class="op" id="2720007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720013">argSize</span>&nbsp;<span class="op" id="2720021">=</span>&nbsp;<span class="ident" id="2720023">gc</span><span class="op" id="2720025">.</span><span class="ident" id="2720026">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720032">if</span>&nbsp;<span class="ident" id="2720035">runtime</span><span class="op" id="2720042">.</span><span class="ident" id="2720043">GOARCH</span>&nbsp;<span class="op" id="2720050">==</span>&nbsp;<span class="string" id="2720053">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2720064">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720068">gc</span><span class="op" id="2720070">.</span><span class="ident" id="2720071">align</span><span class="op" id="2720076">(</span><span class="num" id="2720077">8</span><span class="op" id="2720078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720084">gc</span><span class="op" id="2720086">.</span><span class="ident" id="2720087">align</span><span class="op" id="2720092">(</span><span class="ident" id="2720093">ptrSize</span><span class="op" id="2720100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720103">retOffset</span>&nbsp;<span class="op" id="2720113">=</span>&nbsp;<span class="ident" id="2720115">gc</span><span class="op" id="2720117">.</span><span class="ident" id="2720118">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720124">for</span>&nbsp;<span class="ident" id="2720128">_</span><span class="op" id="2720129">,</span>&nbsp;<span class="ident" id="2720131">res</span>&nbsp;<span class="op" id="2720135">:=</span>&nbsp;<span class="keyword" id="2720138">range</span>&nbsp;<span class="ident" id="2720144">tt</span><span class="op" id="2720146">.</span><span class="ident" id="2720147">out</span>&nbsp;<span class="op" id="2720151">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720155">gc</span><span class="op" id="2720157">.</span><span class="ident" id="2720158">appendProg</span><span class="op" id="2720168">(</span><span class="ident" id="2720169">res</span><span class="op" id="2720172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2720176">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720219">gc</span><span class="op" id="2720221">.</span><span class="ident" id="2720222">align</span><span class="op" id="2720227">(</span><span class="ident" id="2720228">ptrSize</span><span class="op" id="2720235">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2720239">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720280">x</span>&nbsp;<span class="op" id="2720282">:=</span>&nbsp;<span class="builtinfunc" id="2720285">new</span><span class="op" id="2720288">(</span><span class="ident" id="2720289">rtype</span><span class="op" id="2720294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720297">x</span><span class="op" id="2720298">.</span><span class="ident" id="2720299">size</span>&nbsp;<span class="op" id="2720304">=</span>&nbsp;<span class="ident" id="2720306">gc</span><span class="op" id="2720308">.</span><span class="ident" id="2720309">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720315">x</span><span class="op" id="2720316">.</span><span class="ident" id="2720317">gc</span><span class="op" id="2720319">[</span><span class="num" id="2720320">0</span><span class="op" id="2720321">]</span>&nbsp;<span class="op" id="2720323">=</span>&nbsp;<span class="ident" id="2720325">gc</span><span class="op" id="2720327">.</span><span class="ident" id="2720328">finalize</span><span class="op" id="2720336">(</span><span class="op" id="2720337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720340">var</span>&nbsp;<span class="ident" id="2720344">s</span>&nbsp;<span class="builtintype" id="2720346">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720354">if</span>&nbsp;<span class="ident" id="2720357">rcvr</span>&nbsp;<span class="op" id="2720362">!=</span>&nbsp;<span class="ident" id="2720365">nil</span>&nbsp;<span class="op" id="2720369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720373">s</span>&nbsp;<span class="op" id="2720375">=</span>&nbsp;<span class="string" id="2720377">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2720391">+</span>&nbsp;<span class="op" id="2720393">*</span><span class="ident" id="2720394">rcvr</span><span class="op" id="2720398">.</span><span class="builtintype" id="2720399">string</span>&nbsp;<span class="op" id="2720406">+</span>&nbsp;<span class="string" id="2720408">&#34;)(&#34;</span>&nbsp;<span class="op" id="2720413">+</span>&nbsp;<span class="op" id="2720415">*</span><span class="ident" id="2720416">t</span><span class="op" id="2720417">.</span><span class="builtintype" id="2720418">string</span>&nbsp;<span class="op" id="2720425">+</span>&nbsp;<span class="string" id="2720427">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720432">}</span>&nbsp;<span class="keyword" id="2720434">else</span>&nbsp;<span class="op" id="2720439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720443">s</span>&nbsp;<span class="op" id="2720445">=</span>&nbsp;<span class="string" id="2720447">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2720459">+</span>&nbsp;<span class="op" id="2720461">*</span><span class="ident" id="2720462">t</span><span class="op" id="2720463">.</span><span class="builtintype" id="2720464">string</span>&nbsp;<span class="op" id="2720471">+</span>&nbsp;<span class="string" id="2720473">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720478">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720481">x</span><span class="op" id="2720482">.</span><span class="builtintype" id="2720483">string</span>&nbsp;<span class="op" id="2720490">=</span>&nbsp;<span class="op" id="2720492">&amp;</span><span class="ident" id="2720493">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2720497">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720533">if</span>&nbsp;<span class="ident" id="2720536">layoutCache</span><span class="op" id="2720547">.</span><span class="ident" id="2720548">m</span>&nbsp;<span class="op" id="2720550">==</span>&nbsp;<span class="ident" id="2720553">nil</span>&nbsp;<span class="op" id="2720557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720561">layoutCache</span><span class="op" id="2720572">.</span><span class="ident" id="2720573">m</span>&nbsp;<span class="op" id="2720575">=</span>&nbsp;<span class="builtinfunc" id="2720577">make</span><span class="op" id="2720581">(</span><span class="keyword" id="2720582">map</span><span class="op" id="2720585">[</span><span class="ident" id="2720586">layoutKey</span><span class="op" id="2720595">]</span><span class="ident" id="2720596">layoutType</span><span class="op" id="2720606">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720612">layoutCache</span><span class="op" id="2720623">.</span><span class="ident" id="2720624">m</span><span class="op" id="2720625">[</span><span class="ident" id="2720626">k</span><span class="op" id="2720627">]</span>&nbsp;<span class="op" id="2720629">=</span>&nbsp;<span class="ident" id="2720631">layoutType</span><span class="op" id="2720641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720645">t</span><span class="op" id="2720646">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720656">x</span><span class="op" id="2720657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720661">argSize</span><span class="op" id="2720668">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2720672">argSize</span><span class="op" id="2720679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720683">retOffset</span><span class="op" id="2720692">:</span>&nbsp;<span class="ident" id="2720694">retOffset</span><span class="op" id="2720703">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720707">stack</span><span class="op" id="2720712">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720718">stack</span><span class="op" id="2720723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720729">layoutCache</span><span class="op" id="2720740">.</span><span class="ident" id="2720741">Unlock</span><span class="op" id="2720747">(</span><span class="op" id="2720748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720751">return</span>&nbsp;<span class="ident" id="2720758">x</span><span class="op" id="2720759">,</span>&nbsp;<span class="ident" id="2720761">argSize</span><span class="op" id="2720768">,</span>&nbsp;<span class="ident" id="2720770">retOffset</span><span class="op" id="2720779">,</span>&nbsp;<span class="ident" id="2720781">stack</span><br>
<span class="lineno"></span><span class="op" id="2720787">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2720790">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2720866">func</span>&nbsp;<span class="ident" id="2720871">ifaceIndir</span><span class="op" id="2720881">(</span><span class="ident" id="2720882">t</span>&nbsp;<span class="op" id="2720884">*</span><span class="ident" id="2720885">rtype</span><span class="op" id="2720890">)</span>&nbsp;<span class="builtintype" id="2720892">bool</span>&nbsp;<span class="op" id="2720897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720900">return</span>&nbsp;<span class="ident" id="2720907">t</span><span class="op" id="2720908">.</span><span class="ident" id="2720909">kind</span><span class="op" id="2720913">&amp;</span><span class="ident" id="2720914">kindDirectIface</span>&nbsp;<span class="op" id="2720930">==</span>&nbsp;<span class="num" id="2720933">0</span><br>
<span class="lineno"></span><span class="op" id="2720935">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2720938">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2720989">type</span>&nbsp;<span class="ident" id="2720994">bitVector</span>&nbsp;<span class="keyword" id="2721004">struct</span>&nbsp;<span class="op" id="2721011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721014">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2721019">uint32</span>&nbsp;<span class="comment" id="2721026">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721045">data</span>&nbsp;<span class="op" id="2721050">[</span><span class="op" id="2721051">]</span><span class="builtintype" id="2721052">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2721057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2721060">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2721096">func</span>&nbsp;<span class="op" id="2721101">(</span><span class="ident" id="2721102">bv</span>&nbsp;<span class="op" id="2721105">*</span><span class="ident" id="2721106">bitVector</span><span class="op" id="2721115">)</span>&nbsp;<span class="ident" id="2721117">append2</span><span class="op" id="2721124">(</span><span class="ident" id="2721125">bits</span>&nbsp;<span class="builtintype" id="2721130">uint8</span><span class="op" id="2721135">)</span>&nbsp;<span class="op" id="2721137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2721140">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721213">if</span>&nbsp;<span class="ident" id="2721216">bv</span><span class="op" id="2721218">.</span><span class="ident" id="2721219">n</span><span class="op" id="2721220">%</span><span class="num" id="2721221">8</span>&nbsp;<span class="op" id="2721223">==</span>&nbsp;<span class="num" id="2721226">0</span>&nbsp;<span class="op" id="2721228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721232">bv</span><span class="op" id="2721234">.</span><span class="ident" id="2721235">data</span>&nbsp;<span class="op" id="2721240">=</span>&nbsp;<span class="builtinfunc" id="2721242">append</span><span class="op" id="2721248">(</span><span class="ident" id="2721249">bv</span><span class="op" id="2721251">.</span><span class="ident" id="2721252">data</span><span class="op" id="2721256">,</span>&nbsp;<span class="num" id="2721258">0</span><span class="op" id="2721259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2721262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721265">bv</span><span class="op" id="2721267">.</span><span class="ident" id="2721268">data</span><span class="op" id="2721272">[</span><span class="ident" id="2721273">bv</span><span class="op" id="2721275">.</span><span class="ident" id="2721276">n</span><span class="op" id="2721277">/</span><span class="num" id="2721278">8</span><span class="op" id="2721279">]</span>&nbsp;<span class="op" id="2721281">|=</span>&nbsp;<span class="ident" id="2721284">bits</span>&nbsp;<span class="op" id="2721289">&lt;&lt;</span>&nbsp;<span class="op" id="2721292">(</span><span class="ident" id="2721293">bv</span><span class="op" id="2721295">.</span><span class="ident" id="2721296">n</span>&nbsp;<span class="op" id="2721298">%</span>&nbsp;<span class="num" id="2721300">8</span><span class="op" id="2721301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721304">bv</span><span class="op" id="2721306">.</span><span class="ident" id="2721307">n</span>&nbsp;<span class="op" id="2721309">+=</span>&nbsp;<span class="num" id="2721312">2</span><br>
<span class="lineno">1885</span><span class="op" id="2721314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2721317">func</span>&nbsp;<span class="ident" id="2721322">addTypeBits</span><span class="op" id="2721333">(</span><span class="ident" id="2721334">bv</span>&nbsp;<span class="op" id="2721337">*</span><span class="ident" id="2721338">bitVector</span><span class="op" id="2721347">,</span>&nbsp;<span class="ident" id="2721349">offset</span>&nbsp;<span class="op" id="2721356">*</span><span class="builtintype" id="2721357">uintptr</span><span class="op" id="2721364">,</span>&nbsp;<span class="ident" id="2721366">t</span>&nbsp;<span class="op" id="2721368">*</span><span class="ident" id="2721369">rtype</span><span class="op" id="2721374">)</span>&nbsp;<span class="op" id="2721376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2721379">*</span><span class="ident" id="2721380">offset</span>&nbsp;<span class="op" id="2721387">=</span>&nbsp;<span class="ident" id="2721389">align</span><span class="op" id="2721394">(</span><span class="op" id="2721395">*</span><span class="ident" id="2721396">offset</span><span class="op" id="2721402">,</span>&nbsp;<span class="builtintype" id="2721404">uintptr</span><span class="op" id="2721411">(</span><span class="ident" id="2721412">t</span><span class="op" id="2721413">.</span><span class="ident" id="2721414">align</span><span class="op" id="2721419">)</span><span class="op" id="2721420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721423">if</span>&nbsp;<span class="ident" id="2721426">t</span><span class="op" id="2721427">.</span><span class="ident" id="2721428">kind</span><span class="op" id="2721432">&amp;</span><span class="ident" id="2721433">kindNoPointers</span>&nbsp;<span class="op" id="2721448">!=</span>&nbsp;<span class="num" id="2721451">0</span>&nbsp;<span class="op" id="2721453">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2721457">*</span><span class="ident" id="2721458">offset</span>&nbsp;<span class="op" id="2721465">+=</span>&nbsp;<span class="ident" id="2721468">t</span><span class="op" id="2721469">.</span><span class="ident" id="2721470">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721477">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2721485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721489">switch</span>&nbsp;<span class="ident" id="2721496">Kind</span><span class="op" id="2721500">(</span><span class="ident" id="2721501">t</span><span class="op" id="2721502">.</span><span class="ident" id="2721503">kind</span>&nbsp;<span class="op" id="2721508">&amp;</span>&nbsp;<span class="ident" id="2721510">kindMask</span><span class="op" id="2721518">)</span>&nbsp;<span class="op" id="2721520">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721523">case</span>&nbsp;<span class="ident" id="2721528">Chan</span><span class="op" id="2721532">,</span>&nbsp;<span class="ident" id="2721534">Func</span><span class="op" id="2721538">,</span>&nbsp;<span class="ident" id="2721540">Map</span><span class="op" id="2721543">,</span>&nbsp;<span class="ident" id="2721545">Ptr</span><span class="op" id="2721548">,</span>&nbsp;<span class="ident" id="2721550">Slice</span><span class="op" id="2721555">,</span>&nbsp;<span class="ident" id="2721557">String</span><span class="op" id="2721563">,</span>&nbsp;<span class="ident" id="2721565">UnsafePointer</span><span class="op" id="2721578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2721582">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721624">for</span>&nbsp;<span class="ident" id="2721628">bv</span><span class="op" id="2721630">.</span><span class="ident" id="2721631">n</span>&nbsp;<span class="op" id="2721633">&lt;</span>&nbsp;<span class="num" id="2721635">2</span><span class="op" id="2721636">*</span><span class="builtintype" id="2721637">uint32</span><span class="op" id="2721643">(</span><span class="op" id="2721644">*</span><span class="ident" id="2721645">offset</span><span class="op" id="2721651">/</span><span class="builtintype" id="2721652">uintptr</span><span class="op" id="2721659">(</span><span class="ident" id="2721660">ptrSize</span><span class="op" id="2721667">)</span><span class="op" id="2721668">)</span>&nbsp;<span class="op" id="2721670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721675">bv</span><span class="op" id="2721677">.</span><span class="ident" id="2721678">append2</span><span class="op" id="2721685">(</span><span class="ident" id="2721686">bitsScalar</span><span class="op" id="2721696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2721700">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721704">bv</span><span class="op" id="2721706">.</span><span class="ident" id="2721707">append2</span><span class="op" id="2721714">(</span><span class="ident" id="2721715">bitsPointer</span><span class="op" id="2721726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721730">case</span>&nbsp;<span class="ident" id="2721735">Interface</span><span class="op" id="2721744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2721748">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721764">for</span>&nbsp;<span class="ident" id="2721768">bv</span><span class="op" id="2721770">.</span><span class="ident" id="2721771">n</span>&nbsp;<span class="op" id="2721773">&lt;</span>&nbsp;<span class="num" id="2721775">2</span><span class="op" id="2721776">*</span><span class="builtintype" id="2721777">uint32</span><span class="op" id="2721783">(</span><span class="op" id="2721784">*</span><span class="ident" id="2721785">offset</span><span class="op" id="2721791">/</span><span class="builtintype" id="2721792">uintptr</span><span class="op" id="2721799">(</span><span class="ident" id="2721800">ptrSize</span><span class="op" id="2721807">)</span><span class="op" id="2721808">)</span>&nbsp;<span class="op" id="2721810">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721815">bv</span><span class="op" id="2721817">.</span><span class="ident" id="2721818">append2</span><span class="op" id="2721825">(</span><span class="ident" id="2721826">bitsScalar</span><span class="op" id="2721836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2721840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721844">bv</span><span class="op" id="2721846">.</span><span class="ident" id="2721847">append2</span><span class="op" id="2721854">(</span><span class="ident" id="2721855">bitsPointer</span><span class="op" id="2721866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721870">bv</span><span class="op" id="2721872">.</span><span class="ident" id="2721873">append2</span><span class="op" id="2721880">(</span><span class="ident" id="2721881">bitsPointer</span><span class="op" id="2721892">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721896">case</span>&nbsp;<span class="ident" id="2721901">Array</span><span class="op" id="2721906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2721910">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2721933">tt</span>&nbsp;<span class="op" id="2721936">:=</span>&nbsp;<span class="op" id="2721939">(</span><span class="op" id="2721940">*</span><span class="ident" id="2721941">arrayType</span><span class="op" id="2721950">)</span><span class="op" id="2721951">(</span><span class="ident" id="2721952">unsafe</span><span class="op" id="2721958">.</span><span class="ident" id="2721959">Pointer</span><span class="op" id="2721966">(</span><span class="ident" id="2721967">t</span><span class="op" id="2721968">)</span><span class="op" id="2721969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2721973">for</span>&nbsp;<span class="ident" id="2721977">i</span>&nbsp;<span class="op" id="2721979">:=</span>&nbsp;<span class="num" id="2721982">0</span><span class="op" id="2721983">;</span>&nbsp;<span class="ident" id="2721985">i</span>&nbsp;<span class="op" id="2721987">&lt;</span>&nbsp;<span class="builtintype" id="2721989">int</span><span class="op" id="2721992">(</span><span class="ident" id="2721993">tt</span><span class="op" id="2721995">.</span><span class="builtinfunc" id="2721996">len</span><span class="op" id="2721999">)</span><span class="op" id="2722000">;</span>&nbsp;<span class="ident" id="2722002">i</span><span class="op" id="2722003">++</span>&nbsp;<span class="op" id="2722006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2722011">addTypeBits</span><span class="op" id="2722022">(</span><span class="ident" id="2722023">bv</span><span class="op" id="2722025">,</span>&nbsp;<span class="ident" id="2722027">offset</span><span class="op" id="2722033">,</span>&nbsp;<span class="ident" id="2722035">tt</span><span class="op" id="2722037">.</span><span class="ident" id="2722038">elem</span><span class="op" id="2722042">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2722046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2722050">case</span>&nbsp;<span class="ident" id="2722055">Struct</span><span class="op" id="2722061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2722065">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2722083">tt</span>&nbsp;<span class="op" id="2722086">:=</span>&nbsp;<span class="op" id="2722089">(</span><span class="op" id="2722090">*</span><span class="ident" id="2722091">structType</span><span class="op" id="2722101">)</span><span class="op" id="2722102">(</span><span class="ident" id="2722103">unsafe</span><span class="op" id="2722109">.</span><span class="ident" id="2722110">Pointer</span><span class="op" id="2722117">(</span><span class="ident" id="2722118">t</span><span class="op" id="2722119">)</span><span class="op" id="2722120">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2722124">start</span>&nbsp;<span class="op" id="2722130">:=</span>&nbsp;<span class="op" id="2722133">*</span><span class="ident" id="2722134">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2722143">for</span>&nbsp;<span class="ident" id="2722147">i</span>&nbsp;<span class="op" id="2722149">:=</span>&nbsp;<span class="keyword" id="2722152">range</span>&nbsp;<span class="ident" id="2722158">tt</span><span class="op" id="2722160">.</span><span class="ident" id="2722161">fields</span>&nbsp;<span class="op" id="2722168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2722173">f</span>&nbsp;<span class="op" id="2722175">:=</span>&nbsp;<span class="op" id="2722178">&amp;</span><span class="ident" id="2722179">tt</span><span class="op" id="2722181">.</span><span class="ident" id="2722182">fields</span><span class="op" id="2722188">[</span><span class="ident" id="2722189">i</span><span class="op" id="2722190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2722195">off</span>&nbsp;<span class="op" id="2722199">:=</span>&nbsp;<span class="ident" id="2722202">start</span>&nbsp;<span class="op" id="2722208">+</span>&nbsp;<span class="ident" id="2722210">f</span><span class="op" id="2722211">.</span><span class="ident" id="2722212">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2722222">addTypeBits</span><span class="op" id="2722233">(</span><span class="ident" id="2722234">bv</span><span class="op" id="2722236">,</span>&nbsp;<span class="op" id="2722238">&amp;</span><span class="ident" id="2722239">off</span><span class="op" id="2722242">,</span>&nbsp;<span class="ident" id="2722244">f</span><span class="op" id="2722245">.</span><span class="ident" id="2722246">typ</span><span class="op" id="2722249">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2722253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2722256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2722260">*</span><span class="ident" id="2722261">offset</span>&nbsp;<span class="op" id="2722268">+=</span>&nbsp;<span class="ident" id="2722271">t</span><span class="op" id="2722272">.</span><span class="ident" id="2722273">size</span><br>
<span class="lineno"></span><span class="op" id="2722278">}</span>
</div>
</body>
</html>
