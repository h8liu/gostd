<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6193303">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6193358">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6193412">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6193463">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="6193539">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="6193614">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6193686">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="6193762">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="6193838">//</span><br>
<span class="lineno"></span><span class="comment" id="6193841">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="6193919">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6193987">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="6194063">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="6194115">//</span><br>
<span class="lineno"></span><span class="comment" id="6194118">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="6194142">//</span><br>
<span class="lineno"></span><span class="comment" id="6194145">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="6194170">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="6194185">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6194204">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6194232">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="6194261">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6194280">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="6194285">//</span><br>
<span class="lineno"></span><span class="keyword" id="6194288">package</span>&nbsp;<span class="ident" id="6194296">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6194305">import</span>&nbsp;<span class="op" id="6194312">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6194315">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6194324">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6194331">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6194337">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6194343">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6194354">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6194369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6194372">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="6194429">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="6194465">type</span>&nbsp;<span class="ident" id="6194470">Position</span>&nbsp;<span class="keyword" id="6194479">struct</span>&nbsp;<span class="op" id="6194486">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194489">Filename</span>&nbsp;<span class="builtintype" id="6194498">string</span>&nbsp;<span class="comment" id="6194505">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194526">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6194535">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194542">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194573">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6194582">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194589">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194620">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6194629">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194636">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="6194695">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6194698">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="6194748">func</span>&nbsp;<span class="op" id="6194753">(</span><span class="ident" id="6194754">pos</span>&nbsp;<span class="op" id="6194758">*</span><span class="ident" id="6194759">Position</span><span class="op" id="6194767">)</span>&nbsp;<span class="ident" id="6194769">IsValid</span><span class="op" id="6194776">(</span><span class="op" id="6194777">)</span>&nbsp;<span class="builtintype" id="6194779">bool</span>&nbsp;<span class="op" id="6194784">{</span>&nbsp;<span class="keyword" id="6194786">return</span>&nbsp;<span class="ident" id="6194793">pos</span><span class="op" id="6194796">.</span><span class="ident" id="6194797">Line</span>&nbsp;<span class="op" id="6194802">&gt;</span>&nbsp;<span class="num" id="6194804">0</span>&nbsp;<span class="op" id="6194806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6194809">func</span>&nbsp;<span class="op" id="6194814">(</span><span class="ident" id="6194815">pos</span>&nbsp;<span class="ident" id="6194819">Position</span><span class="op" id="6194827">)</span>&nbsp;<span class="ident" id="6194829">String</span><span class="op" id="6194835">(</span><span class="op" id="6194836">)</span>&nbsp;<span class="builtintype" id="6194838">string</span>&nbsp;<span class="op" id="6194845">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194848">s</span>&nbsp;<span class="op" id="6194850">:=</span>&nbsp;<span class="ident" id="6194853">pos</span><span class="op" id="6194856">.</span><span class="ident" id="6194857">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194867">if</span>&nbsp;<span class="ident" id="6194870">pos</span><span class="op" id="6194873">.</span><span class="ident" id="6194874">IsValid</span><span class="op" id="6194881">(</span><span class="op" id="6194882">)</span>&nbsp;<span class="op" id="6194884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194888">if</span>&nbsp;<span class="ident" id="6194891">s</span>&nbsp;<span class="op" id="6194893">!=</span>&nbsp;<span class="string" id="6194896">&#34;&#34;</span>&nbsp;<span class="op" id="6194899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194904">s</span>&nbsp;<span class="op" id="6194906">+=</span>&nbsp;<span class="string" id="6194909">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194915">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194919">s</span>&nbsp;<span class="op" id="6194921">+=</span>&nbsp;<span class="ident" id="6194924">fmt</span><span class="op" id="6194927">.</span><span class="ident" id="6194928">Sprintf</span><span class="op" id="6194935">(</span><span class="string" id="6194936">&#34;%d:%d&#34;</span><span class="op" id="6194943">,</span>&nbsp;<span class="ident" id="6194945">pos</span><span class="op" id="6194948">.</span><span class="ident" id="6194949">Line</span><span class="op" id="6194953">,</span>&nbsp;<span class="ident" id="6194955">pos</span><span class="op" id="6194958">.</span><span class="ident" id="6194959">Column</span><span class="op" id="6194965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194971">if</span>&nbsp;<span class="ident" id="6194974">s</span>&nbsp;<span class="op" id="6194976">==</span>&nbsp;<span class="string" id="6194979">&#34;&#34;</span>&nbsp;<span class="op" id="6194982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194986">s</span>&nbsp;<span class="op" id="6194988">=</span>&nbsp;<span class="string" id="6194990">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194997">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195000">return</span>&nbsp;<span class="ident" id="6195007">s</span><br>
<span class="lineno"></span><span class="op" id="6195009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6195012">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="6195084">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="6195157">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="6195223">//</span><br>
<span class="lineno"></span><span class="comment" id="6195226">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="6195266">//</span><br>
<span class="lineno"></span><span class="comment" id="6195269">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="6195342">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="6195415">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="6195489">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="6195562">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6195619">//</span><br>
<span class="lineno">75</span><span class="keyword" id="6195622">const</span>&nbsp;<span class="op" id="6195628">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195631">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195646">=</span>&nbsp;<span class="num" id="6195648">1</span>&nbsp;<span class="op" id="6195650">&lt;&lt;</span>&nbsp;<span class="op" id="6195653">-</span><span class="ident" id="6195654">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195661">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195676">=</span>&nbsp;<span class="num" id="6195678">1</span>&nbsp;<span class="op" id="6195680">&lt;&lt;</span>&nbsp;<span class="op" id="6195683">-</span><span class="ident" id="6195684">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195689">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195704">=</span>&nbsp;<span class="num" id="6195706">1</span>&nbsp;<span class="op" id="6195708">&lt;&lt;</span>&nbsp;<span class="op" id="6195711">-</span><span class="ident" id="6195712">Float</span>&nbsp;<span class="comment" id="6195718">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195736">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195751">=</span>&nbsp;<span class="num" id="6195753">1</span>&nbsp;<span class="op" id="6195755">&lt;&lt;</span>&nbsp;<span class="op" id="6195758">-</span><span class="ident" id="6195759">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195765">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195780">=</span>&nbsp;<span class="num" id="6195782">1</span>&nbsp;<span class="op" id="6195784">&lt;&lt;</span>&nbsp;<span class="op" id="6195787">-</span><span class="ident" id="6195788">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195796">ScanRawStrings</span>&nbsp;<span class="op" id="6195811">=</span>&nbsp;<span class="num" id="6195813">1</span>&nbsp;<span class="op" id="6195815">&lt;&lt;</span>&nbsp;<span class="op" id="6195818">-</span><span class="ident" id="6195819">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195830">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6195845">=</span>&nbsp;<span class="num" id="6195847">1</span>&nbsp;<span class="op" id="6195849">&lt;&lt;</span>&nbsp;<span class="op" id="6195852">-</span><span class="ident" id="6195853">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195862">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6195877">=</span>&nbsp;<span class="num" id="6195879">1</span>&nbsp;<span class="op" id="6195881">&lt;&lt;</span>&nbsp;<span class="op" id="6195884">-</span><span class="ident" id="6195885">skipComment</span>&nbsp;<span class="comment" id="6195897">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195955">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195970">=</span>&nbsp;<span class="ident" id="6195972">ScanIdents</span>&nbsp;<span class="op" id="6195983">|</span>&nbsp;<span class="ident" id="6195985">ScanFloats</span>&nbsp;<span class="op" id="6195996">|</span>&nbsp;<span class="ident" id="6195998">ScanChars</span>&nbsp;<span class="op" id="6196008">|</span>&nbsp;<span class="ident" id="6196010">ScanStrings</span>&nbsp;<span class="op" id="6196022">|</span>&nbsp;<span class="ident" id="6196024">ScanRawStrings</span>&nbsp;<span class="op" id="6196039">|</span>&nbsp;<span class="ident" id="6196041">ScanComments</span>&nbsp;<span class="op" id="6196054">|</span>&nbsp;<span class="ident" id="6196056">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="6196069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6196072">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6196149">const</span>&nbsp;<span class="op" id="6196155">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196158">EOF</span>&nbsp;<span class="op" id="6196162">=</span>&nbsp;<span class="op" id="6196164">-</span><span class="op" id="6196165">(</span><span class="ident" id="6196166">iota</span>&nbsp;<span class="op" id="6196171">+</span>&nbsp;<span class="num" id="6196173">1</span><span class="op" id="6196174">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196177">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196184">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196189">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196196">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196202">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196210">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196221">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196230">skipComment</span><br>
<span class="lineno"></span><span class="op" id="6196242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6196245">var</span>&nbsp;<span class="ident" id="6196249">tokenString</span>&nbsp;<span class="op" id="6196261">=</span>&nbsp;<span class="keyword" id="6196263">map</span><span class="op" id="6196266">[</span><span class="builtintype" id="6196267">rune</span><span class="op" id="6196271">]</span><span class="builtintype" id="6196272">string</span><span class="op" id="6196278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196281">EOF</span><span class="op" id="6196284">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6196292">&#34;EOF&#34;</span><span class="op" id="6196297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196300">Ident</span><span class="op" id="6196305">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6196311">&#34;Ident&#34;</span><span class="op" id="6196318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196321">Int</span><span class="op" id="6196324">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6196332">&#34;Int&#34;</span><span class="op" id="6196337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196340">Float</span><span class="op" id="6196345">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6196351">&#34;Float&#34;</span><span class="op" id="6196358">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196361">Char</span><span class="op" id="6196365">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6196372">&#34;Char&#34;</span><span class="op" id="6196378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196381">String</span><span class="op" id="6196387">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6196392">&#34;String&#34;</span><span class="op" id="6196400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196403">RawString</span><span class="op" id="6196412">:</span>&nbsp;<span class="string" id="6196414">&#34;RawString&#34;</span><span class="op" id="6196425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196428">Comment</span><span class="op" id="6196435">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6196439">&#34;Comment&#34;</span><span class="op" id="6196448">,</span><br>
<span class="lineno"></span><span class="op" id="6196450">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6196453">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6196529">func</span>&nbsp;<span class="ident" id="6196534">TokenString</span><span class="op" id="6196545">(</span><span class="ident" id="6196546">tok</span>&nbsp;<span class="builtintype" id="6196550">rune</span><span class="op" id="6196554">)</span>&nbsp;<span class="builtintype" id="6196556">string</span>&nbsp;<span class="op" id="6196563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196566">if</span>&nbsp;<span class="ident" id="6196569">s</span><span class="op" id="6196570">,</span>&nbsp;<span class="ident" id="6196572">found</span>&nbsp;<span class="op" id="6196578">:=</span>&nbsp;<span class="ident" id="6196581">tokenString</span><span class="op" id="6196592">[</span><span class="ident" id="6196593">tok</span><span class="op" id="6196596">]</span><span class="op" id="6196597">;</span>&nbsp;<span class="ident" id="6196599">found</span>&nbsp;<span class="op" id="6196605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196609">return</span>&nbsp;<span class="ident" id="6196616">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196622">return</span>&nbsp;<span class="ident" id="6196629">fmt</span><span class="op" id="6196632">.</span><span class="ident" id="6196633">Sprintf</span><span class="op" id="6196640">(</span><span class="string" id="6196641">&#34;%q&#34;</span><span class="op" id="6196645">,</span>&nbsp;<span class="builtintype" id="6196647">string</span><span class="op" id="6196653">(</span><span class="ident" id="6196654">tok</span><span class="op" id="6196657">)</span><span class="op" id="6196658">)</span><br>
<span class="lineno"></span><span class="op" id="6196660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6196663">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="6196736">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6196786">const</span>&nbsp;<span class="ident" id="6196792">GoWhitespace</span>&nbsp;<span class="op" id="6196805">=</span>&nbsp;<span class="num" id="6196807">1</span><span class="op" id="6196808">&lt;&lt;</span><span class="string" id="6196810">&#39;\t&#39;</span>&nbsp;<span class="op" id="6196815">|</span>&nbsp;<span class="num" id="6196817">1</span><span class="op" id="6196818">&lt;&lt;</span><span class="string" id="6196820">&#39;\n&#39;</span>&nbsp;<span class="op" id="6196825">|</span>&nbsp;<span class="num" id="6196827">1</span><span class="op" id="6196828">&lt;&lt;</span><span class="string" id="6196830">&#39;\r&#39;</span>&nbsp;<span class="op" id="6196835">|</span>&nbsp;<span class="num" id="6196837">1</span><span class="op" id="6196838">&lt;&lt;</span><span class="string" id="6196840">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6196845">const</span>&nbsp;<span class="ident" id="6196851">bufLen</span>&nbsp;<span class="op" id="6196858">=</span>&nbsp;<span class="num" id="6196860">1024</span>&nbsp;<span class="comment" id="6196865">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6196890">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6196974">type</span>&nbsp;<span class="ident" id="6196979">Scanner</span>&nbsp;<span class="keyword" id="6196987">struct</span>&nbsp;<span class="op" id="6196994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196997">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197007">src</span>&nbsp;<span class="ident" id="6197011">io</span><span class="op" id="6197013">.</span><span class="ident" id="6197014">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197023">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197041">srcBuf</span>&nbsp;<span class="op" id="6197048">[</span><span class="ident" id="6197049">bufLen</span>&nbsp;<span class="op" id="6197056">+</span>&nbsp;<span class="num" id="6197058">1</span><span class="op" id="6197059">]</span><span class="builtintype" id="6197060">byte</span>&nbsp;<span class="comment" id="6197065">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197113">srcPos</span>&nbsp;<span class="builtintype" id="6197120">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6197137">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197173">srcEnd</span>&nbsp;<span class="builtintype" id="6197180">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6197197">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197228">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197248">srcBufOffset</span>&nbsp;<span class="builtintype" id="6197261">int</span>&nbsp;<span class="comment" id="6197265">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197304">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6197317">int</span>&nbsp;<span class="comment" id="6197321">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197336">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6197349">int</span>&nbsp;<span class="comment" id="6197353">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197373">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="6197386">int</span>&nbsp;<span class="comment" id="6197390">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197459">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="6197472">int</span>&nbsp;<span class="comment" id="6197476">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197515">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197537">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197610">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197685">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197715">tokBuf</span>&nbsp;<span class="ident" id="6197722">bytes</span><span class="op" id="6197727">.</span><span class="ident" id="6197728">Buffer</span>&nbsp;<span class="comment" id="6197735">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197785">tokPos</span>&nbsp;<span class="builtintype" id="6197792">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6197805">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197864">tokEnd</span>&nbsp;<span class="builtintype" id="6197871">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6197884">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197924">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197953">ch</span>&nbsp;<span class="builtintype" id="6197956">rune</span>&nbsp;<span class="comment" id="6197961">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197998">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198058">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198115">Error</span>&nbsp;<span class="keyword" id="6198121">func</span><span class="op" id="6198125">(</span><span class="ident" id="6198126">s</span>&nbsp;<span class="op" id="6198128">*</span><span class="ident" id="6198129">Scanner</span><span class="op" id="6198136">,</span>&nbsp;<span class="ident" id="6198138">msg</span>&nbsp;<span class="builtintype" id="6198142">string</span><span class="op" id="6198148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198152">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198217">ErrorCount</span>&nbsp;<span class="builtintype" id="6198228">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198234">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198305">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198375">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198400">Mode</span>&nbsp;<span class="builtintype" id="6198405">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198412">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198478">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198549">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198622">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198686">Whitespace</span>&nbsp;<span class="ident" id="6198697">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198706">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198773">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198839">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198902">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198968">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199028">IsIdentRune</span>&nbsp;<span class="keyword" id="6199040">func</span><span class="op" id="6199044">(</span><span class="ident" id="6199045">ch</span>&nbsp;<span class="builtintype" id="6199048">rune</span><span class="op" id="6199052">,</span>&nbsp;<span class="ident" id="6199054">i</span>&nbsp;<span class="builtintype" id="6199056">int</span><span class="op" id="6199059">)</span>&nbsp;<span class="builtintype" id="6199061">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199068">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199132">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199195">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199259">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199324">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199391">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199418">Position</span><br>
<span class="lineno">185</span><span class="op" id="6199427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6199430">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="6199493">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="6199566">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="6199608">func</span>&nbsp;<span class="op" id="6199613">(</span><span class="ident" id="6199614">s</span>&nbsp;<span class="op" id="6199616">*</span><span class="ident" id="6199617">Scanner</span><span class="op" id="6199624">)</span>&nbsp;<span class="ident" id="6199626">Init</span><span class="op" id="6199630">(</span><span class="ident" id="6199631">src</span>&nbsp;<span class="ident" id="6199635">io</span><span class="op" id="6199637">.</span><span class="ident" id="6199638">Reader</span><span class="op" id="6199644">)</span>&nbsp;<span class="op" id="6199646">*</span><span class="ident" id="6199647">Scanner</span>&nbsp;<span class="op" id="6199655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199658">s</span><span class="op" id="6199659">.</span><span class="ident" id="6199660">src</span>&nbsp;<span class="op" id="6199664">=</span>&nbsp;<span class="ident" id="6199666">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199672">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199701">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199765">s</span><span class="op" id="6199766">.</span><span class="ident" id="6199767">srcBuf</span><span class="op" id="6199773">[</span><span class="num" id="6199774">0</span><span class="op" id="6199775">]</span>&nbsp;<span class="op" id="6199777">=</span>&nbsp;<span class="ident" id="6199779">utf8</span><span class="op" id="6199783">.</span><span class="ident" id="6199784">RuneSelf</span>&nbsp;<span class="comment" id="6199793">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199806">s</span><span class="op" id="6199807">.</span><span class="ident" id="6199808">srcPos</span>&nbsp;<span class="op" id="6199815">=</span>&nbsp;<span class="num" id="6199817">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199820">s</span><span class="op" id="6199821">.</span><span class="ident" id="6199822">srcEnd</span>&nbsp;<span class="op" id="6199829">=</span>&nbsp;<span class="num" id="6199831">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199835">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199866">s</span><span class="op" id="6199867">.</span><span class="ident" id="6199868">srcBufOffset</span>&nbsp;<span class="op" id="6199881">=</span>&nbsp;<span class="num" id="6199883">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199886">s</span><span class="op" id="6199887">.</span><span class="ident" id="6199888">line</span>&nbsp;<span class="op" id="6199893">=</span>&nbsp;<span class="num" id="6199895">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199898">s</span><span class="op" id="6199899">.</span><span class="ident" id="6199900">column</span>&nbsp;<span class="op" id="6199907">=</span>&nbsp;<span class="num" id="6199909">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199912">s</span><span class="op" id="6199913">.</span><span class="ident" id="6199914">lastLineLen</span>&nbsp;<span class="op" id="6199926">=</span>&nbsp;<span class="num" id="6199928">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199931">s</span><span class="op" id="6199932">.</span><span class="ident" id="6199933">lastCharLen</span>&nbsp;<span class="op" id="6199945">=</span>&nbsp;<span class="num" id="6199947">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199951">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199984">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200025">s</span><span class="op" id="6200026">.</span><span class="ident" id="6200027">tokPos</span>&nbsp;<span class="op" id="6200034">=</span>&nbsp;<span class="op" id="6200036">-</span><span class="num" id="6200037">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200041">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200081">s</span><span class="op" id="6200082">.</span><span class="ident" id="6200083">ch</span>&nbsp;<span class="op" id="6200086">=</span>&nbsp;<span class="op" id="6200088">-</span><span class="num" id="6200089">1</span>&nbsp;<span class="comment" id="6200091">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200113">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200142">s</span><span class="op" id="6200143">.</span><span class="ident" id="6200144">Error</span>&nbsp;<span class="op" id="6200150">=</span>&nbsp;<span class="ident" id="6200152">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200157">s</span><span class="op" id="6200158">.</span><span class="ident" id="6200159">ErrorCount</span>&nbsp;<span class="op" id="6200170">=</span>&nbsp;<span class="num" id="6200172">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200175">s</span><span class="op" id="6200176">.</span><span class="ident" id="6200177">Mode</span>&nbsp;<span class="op" id="6200182">=</span>&nbsp;<span class="ident" id="6200184">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200194">s</span><span class="op" id="6200195">.</span><span class="ident" id="6200196">Whitespace</span>&nbsp;<span class="op" id="6200207">=</span>&nbsp;<span class="ident" id="6200209">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200223">s</span><span class="op" id="6200224">.</span><span class="ident" id="6200225">Line</span>&nbsp;<span class="op" id="6200230">=</span>&nbsp;<span class="num" id="6200232">0</span>&nbsp;<span class="comment" id="6200234">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200265">return</span>&nbsp;<span class="ident" id="6200272">s</span><br>
<span class="lineno"></span><span class="op" id="6200274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6200277">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6200351">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="6200426">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6200500">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="6200527">func</span>&nbsp;<span class="op" id="6200532">(</span><span class="ident" id="6200533">s</span>&nbsp;<span class="op" id="6200535">*</span><span class="ident" id="6200536">Scanner</span><span class="op" id="6200543">)</span>&nbsp;<span class="ident" id="6200545">next</span><span class="op" id="6200549">(</span><span class="op" id="6200550">)</span>&nbsp;<span class="builtintype" id="6200552">rune</span>&nbsp;<span class="op" id="6200557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200560">ch</span><span class="op" id="6200562">,</span>&nbsp;<span class="ident" id="6200564">width</span>&nbsp;<span class="op" id="6200570">:=</span>&nbsp;<span class="builtintype" id="6200573">rune</span><span class="op" id="6200577">(</span><span class="ident" id="6200578">s</span><span class="op" id="6200579">.</span><span class="ident" id="6200580">srcBuf</span><span class="op" id="6200586">[</span><span class="ident" id="6200587">s</span><span class="op" id="6200588">.</span><span class="ident" id="6200589">srcPos</span><span class="op" id="6200595">]</span><span class="op" id="6200596">)</span><span class="op" id="6200597">,</span>&nbsp;<span class="num" id="6200599">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200603">if</span>&nbsp;<span class="ident" id="6200606">ch</span>&nbsp;<span class="op" id="6200609">&gt;=</span>&nbsp;<span class="ident" id="6200612">utf8</span><span class="op" id="6200616">.</span><span class="ident" id="6200617">RuneSelf</span>&nbsp;<span class="op" id="6200626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200630">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200680">for</span>&nbsp;<span class="ident" id="6200684">s</span><span class="op" id="6200685">.</span><span class="ident" id="6200686">srcPos</span><span class="op" id="6200692">+</span><span class="ident" id="6200693">utf8</span><span class="op" id="6200697">.</span><span class="ident" id="6200698">UTFMax</span>&nbsp;<span class="op" id="6200705">&gt;</span>&nbsp;<span class="ident" id="6200707">s</span><span class="op" id="6200708">.</span><span class="ident" id="6200709">srcEnd</span>&nbsp;<span class="op" id="6200716">&amp;&amp;</span>&nbsp;<span class="op" id="6200719">!</span><span class="ident" id="6200720">utf8</span><span class="op" id="6200724">.</span><span class="ident" id="6200725">FullRune</span><span class="op" id="6200733">(</span><span class="ident" id="6200734">s</span><span class="op" id="6200735">.</span><span class="ident" id="6200736">srcBuf</span><span class="op" id="6200742">[</span><span class="ident" id="6200743">s</span><span class="op" id="6200744">.</span><span class="ident" id="6200745">srcPos</span><span class="op" id="6200751">:</span><span class="ident" id="6200752">s</span><span class="op" id="6200753">.</span><span class="ident" id="6200754">srcEnd</span><span class="op" id="6200760">]</span><span class="op" id="6200761">)</span>&nbsp;<span class="op" id="6200763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200768">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200818">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200852">if</span>&nbsp;<span class="ident" id="6200855">s</span><span class="op" id="6200856">.</span><span class="ident" id="6200857">tokPos</span>&nbsp;<span class="op" id="6200864">&gt;=</span>&nbsp;<span class="num" id="6200867">0</span>&nbsp;<span class="op" id="6200869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200875">s</span><span class="op" id="6200876">.</span><span class="ident" id="6200877">tokBuf</span><span class="op" id="6200883">.</span><span class="ident" id="6200884">Write</span><span class="op" id="6200889">(</span><span class="ident" id="6200890">s</span><span class="op" id="6200891">.</span><span class="ident" id="6200892">srcBuf</span><span class="op" id="6200898">[</span><span class="ident" id="6200899">s</span><span class="op" id="6200900">.</span><span class="ident" id="6200901">tokPos</span><span class="op" id="6200907">:</span><span class="ident" id="6200908">s</span><span class="op" id="6200909">.</span><span class="ident" id="6200910">srcPos</span><span class="op" id="6200916">]</span><span class="op" id="6200917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200923">s</span><span class="op" id="6200924">.</span><span class="ident" id="6200925">tokPos</span>&nbsp;<span class="op" id="6200932">=</span>&nbsp;<span class="num" id="6200934">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200940">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200972">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6200977">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6201024">copy</span><span class="op" id="6201028">(</span><span class="ident" id="6201029">s</span><span class="op" id="6201030">.</span><span class="ident" id="6201031">srcBuf</span><span class="op" id="6201037">[</span><span class="num" id="6201038">0</span><span class="op" id="6201039">:</span><span class="op" id="6201040">]</span><span class="op" id="6201041">,</span>&nbsp;<span class="ident" id="6201043">s</span><span class="op" id="6201044">.</span><span class="ident" id="6201045">srcBuf</span><span class="op" id="6201051">[</span><span class="ident" id="6201052">s</span><span class="op" id="6201053">.</span><span class="ident" id="6201054">srcPos</span><span class="op" id="6201060">:</span><span class="ident" id="6201061">s</span><span class="op" id="6201062">.</span><span class="ident" id="6201063">srcEnd</span><span class="op" id="6201069">]</span><span class="op" id="6201070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201075">s</span><span class="op" id="6201076">.</span><span class="ident" id="6201077">srcBufOffset</span>&nbsp;<span class="op" id="6201090">+=</span>&nbsp;<span class="ident" id="6201093">s</span><span class="op" id="6201094">.</span><span class="ident" id="6201095">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201105">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201127">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201182">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201237">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201293">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201351">i</span>&nbsp;<span class="op" id="6201353">:=</span>&nbsp;<span class="ident" id="6201356">s</span><span class="op" id="6201357">.</span><span class="ident" id="6201358">srcEnd</span>&nbsp;<span class="op" id="6201365">-</span>&nbsp;<span class="ident" id="6201367">s</span><span class="op" id="6201368">.</span><span class="ident" id="6201369">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201379">n</span><span class="op" id="6201380">,</span>&nbsp;<span class="ident" id="6201382">err</span>&nbsp;<span class="op" id="6201386">:=</span>&nbsp;<span class="ident" id="6201389">s</span><span class="op" id="6201390">.</span><span class="ident" id="6201391">src</span><span class="op" id="6201394">.</span><span class="ident" id="6201395">Read</span><span class="op" id="6201399">(</span><span class="ident" id="6201400">s</span><span class="op" id="6201401">.</span><span class="ident" id="6201402">srcBuf</span><span class="op" id="6201408">[</span><span class="ident" id="6201409">i</span><span class="op" id="6201410">:</span><span class="ident" id="6201411">bufLen</span><span class="op" id="6201417">]</span><span class="op" id="6201418">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201423">s</span><span class="op" id="6201424">.</span><span class="ident" id="6201425">srcPos</span>&nbsp;<span class="op" id="6201432">=</span>&nbsp;<span class="num" id="6201434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201439">s</span><span class="op" id="6201440">.</span><span class="ident" id="6201441">srcEnd</span>&nbsp;<span class="op" id="6201448">=</span>&nbsp;<span class="ident" id="6201450">i</span>&nbsp;<span class="op" id="6201452">+</span>&nbsp;<span class="ident" id="6201454">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201459">s</span><span class="op" id="6201460">.</span><span class="ident" id="6201461">srcBuf</span><span class="op" id="6201467">[</span><span class="ident" id="6201468">s</span><span class="op" id="6201469">.</span><span class="ident" id="6201470">srcEnd</span><span class="op" id="6201476">]</span>&nbsp;<span class="op" id="6201478">=</span>&nbsp;<span class="ident" id="6201480">utf8</span><span class="op" id="6201484">.</span><span class="ident" id="6201485">RuneSelf</span>&nbsp;<span class="comment" id="6201494">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201509">if</span>&nbsp;<span class="ident" id="6201512">err</span>&nbsp;<span class="op" id="6201516">!=</span>&nbsp;<span class="ident" id="6201519">nil</span>&nbsp;<span class="op" id="6201523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201529">if</span>&nbsp;<span class="ident" id="6201532">err</span>&nbsp;<span class="op" id="6201536">!=</span>&nbsp;<span class="ident" id="6201539">io</span><span class="op" id="6201541">.</span><span class="ident" id="6201542">EOF</span>&nbsp;<span class="op" id="6201546">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201553">s</span><span class="op" id="6201554">.</span><span class="builtintype" id="6201555">error</span><span class="op" id="6201560">(</span><span class="ident" id="6201561">err</span><span class="op" id="6201564">.</span><span class="ident" id="6201565">Error</span><span class="op" id="6201570">(</span><span class="op" id="6201571">)</span><span class="op" id="6201572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201584">if</span>&nbsp;<span class="ident" id="6201587">s</span><span class="op" id="6201588">.</span><span class="ident" id="6201589">srcEnd</span>&nbsp;<span class="op" id="6201596">==</span>&nbsp;<span class="num" id="6201599">0</span>&nbsp;<span class="op" id="6201601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201608">if</span>&nbsp;<span class="ident" id="6201611">s</span><span class="op" id="6201612">.</span><span class="ident" id="6201613">lastCharLen</span>&nbsp;<span class="op" id="6201625">&gt;</span>&nbsp;<span class="num" id="6201627">0</span>&nbsp;<span class="op" id="6201629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201637">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201677">s</span><span class="op" id="6201678">.</span><span class="ident" id="6201679">column</span><span class="op" id="6201685">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201700">s</span><span class="op" id="6201701">.</span><span class="ident" id="6201702">lastCharLen</span>&nbsp;<span class="op" id="6201714">=</span>&nbsp;<span class="num" id="6201716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201723">return</span>&nbsp;<span class="ident" id="6201730">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201738">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201744">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201791">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201838">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201885">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201932">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201949">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201972">ch</span>&nbsp;<span class="op" id="6201975">=</span>&nbsp;<span class="builtintype" id="6201977">rune</span><span class="op" id="6201981">(</span><span class="ident" id="6201982">s</span><span class="op" id="6201983">.</span><span class="ident" id="6201984">srcBuf</span><span class="op" id="6201990">[</span><span class="ident" id="6201991">s</span><span class="op" id="6201992">.</span><span class="ident" id="6201993">srcPos</span><span class="op" id="6201999">]</span><span class="op" id="6202000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202004">if</span>&nbsp;<span class="ident" id="6202007">ch</span>&nbsp;<span class="op" id="6202010">&gt;=</span>&nbsp;<span class="ident" id="6202013">utf8</span><span class="op" id="6202017">.</span><span class="ident" id="6202018">RuneSelf</span>&nbsp;<span class="op" id="6202027">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202032">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202063">ch</span><span class="op" id="6202065">,</span>&nbsp;<span class="ident" id="6202067">width</span>&nbsp;<span class="op" id="6202073">=</span>&nbsp;<span class="ident" id="6202075">utf8</span><span class="op" id="6202079">.</span><span class="ident" id="6202080">DecodeRune</span><span class="op" id="6202090">(</span><span class="ident" id="6202091">s</span><span class="op" id="6202092">.</span><span class="ident" id="6202093">srcBuf</span><span class="op" id="6202099">[</span><span class="ident" id="6202100">s</span><span class="op" id="6202101">.</span><span class="ident" id="6202102">srcPos</span><span class="op" id="6202108">:</span><span class="ident" id="6202109">s</span><span class="op" id="6202110">.</span><span class="ident" id="6202111">srcEnd</span><span class="op" id="6202117">]</span><span class="op" id="6202118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202123">if</span>&nbsp;<span class="ident" id="6202126">ch</span>&nbsp;<span class="op" id="6202129">==</span>&nbsp;<span class="ident" id="6202132">utf8</span><span class="op" id="6202136">.</span><span class="ident" id="6202137">RuneError</span>&nbsp;<span class="op" id="6202147">&amp;&amp;</span>&nbsp;<span class="ident" id="6202150">width</span>&nbsp;<span class="op" id="6202156">==</span>&nbsp;<span class="num" id="6202159">1</span>&nbsp;<span class="op" id="6202161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202167">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202209">s</span><span class="op" id="6202210">.</span><span class="ident" id="6202211">srcPos</span>&nbsp;<span class="op" id="6202218">+=</span>&nbsp;<span class="ident" id="6202221">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202231">s</span><span class="op" id="6202232">.</span><span class="ident" id="6202233">lastCharLen</span>&nbsp;<span class="op" id="6202245">=</span>&nbsp;<span class="ident" id="6202247">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202257">s</span><span class="op" id="6202258">.</span><span class="ident" id="6202259">column</span><span class="op" id="6202265">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202272">s</span><span class="op" id="6202273">.</span><span class="builtintype" id="6202274">error</span><span class="op" id="6202279">(</span><span class="string" id="6202280">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="6202304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202310">return</span>&nbsp;<span class="ident" id="6202317">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202323">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202334">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202346">s</span><span class="op" id="6202347">.</span><span class="ident" id="6202348">srcPos</span>&nbsp;<span class="op" id="6202355">+=</span>&nbsp;<span class="ident" id="6202358">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202365">s</span><span class="op" id="6202366">.</span><span class="ident" id="6202367">lastCharLen</span>&nbsp;<span class="op" id="6202379">=</span>&nbsp;<span class="ident" id="6202381">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202388">s</span><span class="op" id="6202389">.</span><span class="ident" id="6202390">column</span><span class="op" id="6202396">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202401">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202424">switch</span>&nbsp;<span class="ident" id="6202431">ch</span>&nbsp;<span class="op" id="6202434">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202437">case</span>&nbsp;<span class="num" id="6202442">0</span><span class="op" id="6202443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202447">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202487">s</span><span class="op" id="6202488">.</span><span class="builtintype" id="6202489">error</span><span class="op" id="6202494">(</span><span class="string" id="6202495">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="6202518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202521">case</span>&nbsp;<span class="string" id="6202526">&#39;\n&#39;</span><span class="op" id="6202530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202534">s</span><span class="op" id="6202535">.</span><span class="ident" id="6202536">line</span><span class="op" id="6202540">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202545">s</span><span class="op" id="6202546">.</span><span class="ident" id="6202547">lastLineLen</span>&nbsp;<span class="op" id="6202559">=</span>&nbsp;<span class="ident" id="6202561">s</span><span class="op" id="6202562">.</span><span class="ident" id="6202563">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202572">s</span><span class="op" id="6202573">.</span><span class="ident" id="6202574">column</span>&nbsp;<span class="op" id="6202581">=</span>&nbsp;<span class="num" id="6202583">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202590">return</span>&nbsp;<span class="ident" id="6202597">ch</span><br>
<span class="lineno">305</span><span class="op" id="6202600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6202603">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6202657">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="6202712">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="6202770">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6202828">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6202881">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="6202910">func</span>&nbsp;<span class="op" id="6202915">(</span><span class="ident" id="6202916">s</span>&nbsp;<span class="op" id="6202918">*</span><span class="ident" id="6202919">Scanner</span><span class="op" id="6202926">)</span>&nbsp;<span class="ident" id="6202928">Next</span><span class="op" id="6202932">(</span><span class="op" id="6202933">)</span>&nbsp;<span class="builtintype" id="6202935">rune</span>&nbsp;<span class="op" id="6202940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202943">s</span><span class="op" id="6202944">.</span><span class="ident" id="6202945">tokPos</span>&nbsp;<span class="op" id="6202952">=</span>&nbsp;<span class="op" id="6202954">-</span><span class="num" id="6202955">1</span>&nbsp;<span class="comment" id="6202957">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202986">s</span><span class="op" id="6202987">.</span><span class="ident" id="6202988">Line</span>&nbsp;<span class="op" id="6202993">=</span>&nbsp;<span class="num" id="6202995">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6203000">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203030">ch</span>&nbsp;<span class="op" id="6203033">:=</span>&nbsp;<span class="ident" id="6203036">s</span><span class="op" id="6203037">.</span><span class="ident" id="6203038">Peek</span><span class="op" id="6203042">(</span><span class="op" id="6203043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203046">s</span><span class="op" id="6203047">.</span><span class="ident" id="6203048">ch</span>&nbsp;<span class="op" id="6203051">=</span>&nbsp;<span class="ident" id="6203053">s</span><span class="op" id="6203054">.</span><span class="ident" id="6203055">next</span><span class="op" id="6203059">(</span><span class="op" id="6203060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203063">return</span>&nbsp;<span class="ident" id="6203070">ch</span><br>
<span class="lineno"></span><span class="op" id="6203073">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6203076">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="6203151">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="6203223">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="6203251">func</span>&nbsp;<span class="op" id="6203256">(</span><span class="ident" id="6203257">s</span>&nbsp;<span class="op" id="6203259">*</span><span class="ident" id="6203260">Scanner</span><span class="op" id="6203267">)</span>&nbsp;<span class="ident" id="6203269">Peek</span><span class="op" id="6203273">(</span><span class="op" id="6203274">)</span>&nbsp;<span class="builtintype" id="6203276">rune</span>&nbsp;<span class="op" id="6203281">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203284">if</span>&nbsp;<span class="ident" id="6203287">s</span><span class="op" id="6203288">.</span><span class="ident" id="6203289">ch</span>&nbsp;<span class="op" id="6203292">&lt;</span>&nbsp;<span class="num" id="6203294">0</span>&nbsp;<span class="op" id="6203296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203300">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203356">s</span><span class="op" id="6203357">.</span><span class="ident" id="6203358">ch</span>&nbsp;<span class="op" id="6203361">=</span>&nbsp;<span class="ident" id="6203363">s</span><span class="op" id="6203364">.</span><span class="ident" id="6203365">next</span><span class="op" id="6203369">(</span><span class="op" id="6203370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203374">if</span>&nbsp;<span class="ident" id="6203377">s</span><span class="op" id="6203378">.</span><span class="ident" id="6203379">ch</span>&nbsp;<span class="op" id="6203382">==</span>&nbsp;<span class="string" id="6203385">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="6203394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203399">s</span><span class="op" id="6203400">.</span><span class="ident" id="6203401">ch</span>&nbsp;<span class="op" id="6203404">=</span>&nbsp;<span class="ident" id="6203406">s</span><span class="op" id="6203407">.</span><span class="ident" id="6203408">next</span><span class="op" id="6203412">(</span><span class="op" id="6203413">)</span>&nbsp;<span class="comment" id="6203415">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203437">return</span>&nbsp;<span class="ident" id="6203444">s</span><span class="op" id="6203445">.</span><span class="ident" id="6203446">ch</span><br>
<span class="lineno"></span><span class="op" id="6203449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6203452">func</span>&nbsp;<span class="op" id="6203457">(</span><span class="ident" id="6203458">s</span>&nbsp;<span class="op" id="6203460">*</span><span class="ident" id="6203461">Scanner</span><span class="op" id="6203468">)</span>&nbsp;<span class="builtintype" id="6203470">error</span><span class="op" id="6203475">(</span><span class="ident" id="6203476">msg</span>&nbsp;<span class="builtintype" id="6203480">string</span><span class="op" id="6203486">)</span>&nbsp;<span class="op" id="6203488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203491">s</span><span class="op" id="6203492">.</span><span class="ident" id="6203493">ErrorCount</span><span class="op" id="6203503">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203507">if</span>&nbsp;<span class="ident" id="6203510">s</span><span class="op" id="6203511">.</span><span class="ident" id="6203512">Error</span>&nbsp;<span class="op" id="6203518">!=</span>&nbsp;<span class="ident" id="6203521">nil</span>&nbsp;<span class="op" id="6203525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203529">s</span><span class="op" id="6203530">.</span><span class="ident" id="6203531">Error</span><span class="op" id="6203536">(</span><span class="ident" id="6203537">s</span><span class="op" id="6203538">,</span>&nbsp;<span class="ident" id="6203540">msg</span><span class="op" id="6203543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203547">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203558">pos</span>&nbsp;<span class="op" id="6203562">:=</span>&nbsp;<span class="ident" id="6203565">s</span><span class="op" id="6203566">.</span><span class="ident" id="6203567">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203577">if</span>&nbsp;<span class="op" id="6203580">!</span><span class="ident" id="6203581">pos</span><span class="op" id="6203584">.</span><span class="ident" id="6203585">IsValid</span><span class="op" id="6203592">(</span><span class="op" id="6203593">)</span>&nbsp;<span class="op" id="6203595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203599">pos</span>&nbsp;<span class="op" id="6203603">=</span>&nbsp;<span class="ident" id="6203605">s</span><span class="op" id="6203606">.</span><span class="ident" id="6203607">Pos</span><span class="op" id="6203610">(</span><span class="op" id="6203611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203614">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203617">fmt</span><span class="op" id="6203620">.</span><span class="ident" id="6203621">Fprintf</span><span class="op" id="6203628">(</span><span class="ident" id="6203629">os</span><span class="op" id="6203631">.</span><span class="ident" id="6203632">Stderr</span><span class="op" id="6203638">,</span>&nbsp;<span class="string" id="6203640">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6203650">,</span>&nbsp;<span class="ident" id="6203652">pos</span><span class="op" id="6203655">,</span>&nbsp;<span class="ident" id="6203657">msg</span><span class="op" id="6203660">)</span><br>
<span class="lineno"></span><span class="op" id="6203662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6203665">func</span>&nbsp;<span class="op" id="6203670">(</span><span class="ident" id="6203671">s</span>&nbsp;<span class="op" id="6203673">*</span><span class="ident" id="6203674">Scanner</span><span class="op" id="6203681">)</span>&nbsp;<span class="ident" id="6203683">isIdentRune</span><span class="op" id="6203694">(</span><span class="ident" id="6203695">ch</span>&nbsp;<span class="builtintype" id="6203698">rune</span><span class="op" id="6203702">,</span>&nbsp;<span class="ident" id="6203704">i</span>&nbsp;<span class="builtintype" id="6203706">int</span><span class="op" id="6203709">)</span>&nbsp;<span class="builtintype" id="6203711">bool</span>&nbsp;<span class="op" id="6203716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203719">if</span>&nbsp;<span class="ident" id="6203722">s</span><span class="op" id="6203723">.</span><span class="ident" id="6203724">IsIdentRune</span>&nbsp;<span class="op" id="6203736">!=</span>&nbsp;<span class="ident" id="6203739">nil</span>&nbsp;<span class="op" id="6203743">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203747">return</span>&nbsp;<span class="ident" id="6203754">s</span><span class="op" id="6203755">.</span><span class="ident" id="6203756">IsIdentRune</span><span class="op" id="6203767">(</span><span class="ident" id="6203768">ch</span><span class="op" id="6203770">,</span>&nbsp;<span class="ident" id="6203772">i</span><span class="op" id="6203773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203779">return</span>&nbsp;<span class="ident" id="6203786">ch</span>&nbsp;<span class="op" id="6203789">==</span>&nbsp;<span class="string" id="6203792">&#39;_&#39;</span>&nbsp;<span class="op" id="6203796">||</span>&nbsp;<span class="ident" id="6203799">unicode</span><span class="op" id="6203806">.</span><span class="ident" id="6203807">IsLetter</span><span class="op" id="6203815">(</span><span class="ident" id="6203816">ch</span><span class="op" id="6203818">)</span>&nbsp;<span class="op" id="6203820">||</span>&nbsp;<span class="ident" id="6203823">unicode</span><span class="op" id="6203830">.</span><span class="ident" id="6203831">IsDigit</span><span class="op" id="6203838">(</span><span class="ident" id="6203839">ch</span><span class="op" id="6203841">)</span>&nbsp;<span class="op" id="6203843">&amp;&amp;</span>&nbsp;<span class="ident" id="6203846">i</span>&nbsp;<span class="op" id="6203848">&gt;</span>&nbsp;<span class="num" id="6203850">0</span><br>
<span class="lineno"></span><span class="op" id="6203852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6203855">func</span>&nbsp;<span class="op" id="6203860">(</span><span class="ident" id="6203861">s</span>&nbsp;<span class="op" id="6203863">*</span><span class="ident" id="6203864">Scanner</span><span class="op" id="6203871">)</span>&nbsp;<span class="ident" id="6203873">scanIdentifier</span><span class="op" id="6203887">(</span><span class="op" id="6203888">)</span>&nbsp;<span class="builtintype" id="6203890">rune</span>&nbsp;<span class="op" id="6203895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203898">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203965">ch</span>&nbsp;<span class="op" id="6203968">:=</span>&nbsp;<span class="ident" id="6203971">s</span><span class="op" id="6203972">.</span><span class="ident" id="6203973">next</span><span class="op" id="6203977">(</span><span class="op" id="6203978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203981">for</span>&nbsp;<span class="ident" id="6203985">i</span>&nbsp;<span class="op" id="6203987">:=</span>&nbsp;<span class="num" id="6203990">1</span><span class="op" id="6203991">;</span>&nbsp;<span class="ident" id="6203993">s</span><span class="op" id="6203994">.</span><span class="ident" id="6203995">isIdentRune</span><span class="op" id="6204006">(</span><span class="ident" id="6204007">ch</span><span class="op" id="6204009">,</span>&nbsp;<span class="ident" id="6204011">i</span><span class="op" id="6204012">)</span><span class="op" id="6204013">;</span>&nbsp;<span class="ident" id="6204015">i</span><span class="op" id="6204016">++</span>&nbsp;<span class="op" id="6204019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204023">ch</span>&nbsp;<span class="op" id="6204026">=</span>&nbsp;<span class="ident" id="6204028">s</span><span class="op" id="6204029">.</span><span class="ident" id="6204030">next</span><span class="op" id="6204034">(</span><span class="op" id="6204035">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204041">return</span>&nbsp;<span class="ident" id="6204048">ch</span><br>
<span class="lineno"></span><span class="op" id="6204051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6204054">func</span>&nbsp;<span class="ident" id="6204059">digitVal</span><span class="op" id="6204067">(</span><span class="ident" id="6204068">ch</span>&nbsp;<span class="builtintype" id="6204071">rune</span><span class="op" id="6204075">)</span>&nbsp;<span class="builtintype" id="6204077">int</span>&nbsp;<span class="op" id="6204081">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204084">switch</span>&nbsp;<span class="op" id="6204091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204094">case</span>&nbsp;<span class="string" id="6204099">&#39;0&#39;</span>&nbsp;<span class="op" id="6204103">&lt;=</span>&nbsp;<span class="ident" id="6204106">ch</span>&nbsp;<span class="op" id="6204109">&amp;&amp;</span>&nbsp;<span class="ident" id="6204112">ch</span>&nbsp;<span class="op" id="6204115">&lt;=</span>&nbsp;<span class="string" id="6204118">&#39;9&#39;</span><span class="op" id="6204121">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204125">return</span>&nbsp;<span class="builtintype" id="6204132">int</span><span class="op" id="6204135">(</span><span class="ident" id="6204136">ch</span>&nbsp;<span class="op" id="6204139">-</span>&nbsp;<span class="string" id="6204141">&#39;0&#39;</span><span class="op" id="6204144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204147">case</span>&nbsp;<span class="string" id="6204152">&#39;a&#39;</span>&nbsp;<span class="op" id="6204156">&lt;=</span>&nbsp;<span class="ident" id="6204159">ch</span>&nbsp;<span class="op" id="6204162">&amp;&amp;</span>&nbsp;<span class="ident" id="6204165">ch</span>&nbsp;<span class="op" id="6204168">&lt;=</span>&nbsp;<span class="string" id="6204171">&#39;f&#39;</span><span class="op" id="6204174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204178">return</span>&nbsp;<span class="builtintype" id="6204185">int</span><span class="op" id="6204188">(</span><span class="ident" id="6204189">ch</span>&nbsp;<span class="op" id="6204192">-</span>&nbsp;<span class="string" id="6204194">&#39;a&#39;</span>&nbsp;<span class="op" id="6204198">+</span>&nbsp;<span class="num" id="6204200">10</span><span class="op" id="6204202">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204205">case</span>&nbsp;<span class="string" id="6204210">&#39;A&#39;</span>&nbsp;<span class="op" id="6204214">&lt;=</span>&nbsp;<span class="ident" id="6204217">ch</span>&nbsp;<span class="op" id="6204220">&amp;&amp;</span>&nbsp;<span class="ident" id="6204223">ch</span>&nbsp;<span class="op" id="6204226">&lt;=</span>&nbsp;<span class="string" id="6204229">&#39;F&#39;</span><span class="op" id="6204232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204236">return</span>&nbsp;<span class="builtintype" id="6204243">int</span><span class="op" id="6204246">(</span><span class="ident" id="6204247">ch</span>&nbsp;<span class="op" id="6204250">-</span>&nbsp;<span class="string" id="6204252">&#39;A&#39;</span>&nbsp;<span class="op" id="6204256">+</span>&nbsp;<span class="num" id="6204258">10</span><span class="op" id="6204260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204266">return</span>&nbsp;<span class="num" id="6204273">16</span>&nbsp;<span class="comment" id="6204276">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="6204311">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6204314">func</span>&nbsp;<span class="ident" id="6204319">isDecimal</span><span class="op" id="6204328">(</span><span class="ident" id="6204329">ch</span>&nbsp;<span class="builtintype" id="6204332">rune</span><span class="op" id="6204336">)</span>&nbsp;<span class="builtintype" id="6204338">bool</span>&nbsp;<span class="op" id="6204343">{</span>&nbsp;<span class="keyword" id="6204345">return</span>&nbsp;<span class="string" id="6204352">&#39;0&#39;</span>&nbsp;<span class="op" id="6204356">&lt;=</span>&nbsp;<span class="ident" id="6204359">ch</span>&nbsp;<span class="op" id="6204362">&amp;&amp;</span>&nbsp;<span class="ident" id="6204365">ch</span>&nbsp;<span class="op" id="6204368">&lt;=</span>&nbsp;<span class="string" id="6204371">&#39;9&#39;</span>&nbsp;<span class="op" id="6204375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6204378">func</span>&nbsp;<span class="op" id="6204383">(</span><span class="ident" id="6204384">s</span>&nbsp;<span class="op" id="6204386">*</span><span class="ident" id="6204387">Scanner</span><span class="op" id="6204394">)</span>&nbsp;<span class="ident" id="6204396">scanMantissa</span><span class="op" id="6204408">(</span><span class="ident" id="6204409">ch</span>&nbsp;<span class="builtintype" id="6204412">rune</span><span class="op" id="6204416">)</span>&nbsp;<span class="builtintype" id="6204418">rune</span>&nbsp;<span class="op" id="6204423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204426">for</span>&nbsp;<span class="ident" id="6204430">isDecimal</span><span class="op" id="6204439">(</span><span class="ident" id="6204440">ch</span><span class="op" id="6204442">)</span>&nbsp;<span class="op" id="6204444">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204448">ch</span>&nbsp;<span class="op" id="6204451">=</span>&nbsp;<span class="ident" id="6204453">s</span><span class="op" id="6204454">.</span><span class="ident" id="6204455">next</span><span class="op" id="6204459">(</span><span class="op" id="6204460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204466">return</span>&nbsp;<span class="ident" id="6204473">ch</span><br>
<span class="lineno"></span><span class="op" id="6204476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6204479">func</span>&nbsp;<span class="op" id="6204484">(</span><span class="ident" id="6204485">s</span>&nbsp;<span class="op" id="6204487">*</span><span class="ident" id="6204488">Scanner</span><span class="op" id="6204495">)</span>&nbsp;<span class="ident" id="6204497">scanFraction</span><span class="op" id="6204509">(</span><span class="ident" id="6204510">ch</span>&nbsp;<span class="builtintype" id="6204513">rune</span><span class="op" id="6204517">)</span>&nbsp;<span class="builtintype" id="6204519">rune</span>&nbsp;<span class="op" id="6204524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204527">if</span>&nbsp;<span class="ident" id="6204530">ch</span>&nbsp;<span class="op" id="6204533">==</span>&nbsp;<span class="string" id="6204536">&#39;.&#39;</span>&nbsp;<span class="op" id="6204540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204544">ch</span>&nbsp;<span class="op" id="6204547">=</span>&nbsp;<span class="ident" id="6204549">s</span><span class="op" id="6204550">.</span><span class="ident" id="6204551">scanMantissa</span><span class="op" id="6204563">(</span><span class="ident" id="6204564">s</span><span class="op" id="6204565">.</span><span class="ident" id="6204566">next</span><span class="op" id="6204570">(</span><span class="op" id="6204571">)</span><span class="op" id="6204572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204578">return</span>&nbsp;<span class="ident" id="6204585">ch</span><br>
<span class="lineno">390</span><span class="op" id="6204588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6204591">func</span>&nbsp;<span class="op" id="6204596">(</span><span class="ident" id="6204597">s</span>&nbsp;<span class="op" id="6204599">*</span><span class="ident" id="6204600">Scanner</span><span class="op" id="6204607">)</span>&nbsp;<span class="ident" id="6204609">scanExponent</span><span class="op" id="6204621">(</span><span class="ident" id="6204622">ch</span>&nbsp;<span class="builtintype" id="6204625">rune</span><span class="op" id="6204629">)</span>&nbsp;<span class="builtintype" id="6204631">rune</span>&nbsp;<span class="op" id="6204636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204639">if</span>&nbsp;<span class="ident" id="6204642">ch</span>&nbsp;<span class="op" id="6204645">==</span>&nbsp;<span class="string" id="6204648">&#39;e&#39;</span>&nbsp;<span class="op" id="6204652">||</span>&nbsp;<span class="ident" id="6204655">ch</span>&nbsp;<span class="op" id="6204658">==</span>&nbsp;<span class="string" id="6204661">&#39;E&#39;</span>&nbsp;<span class="op" id="6204665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204669">ch</span>&nbsp;<span class="op" id="6204672">=</span>&nbsp;<span class="ident" id="6204674">s</span><span class="op" id="6204675">.</span><span class="ident" id="6204676">next</span><span class="op" id="6204680">(</span><span class="op" id="6204681">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204685">if</span>&nbsp;<span class="ident" id="6204688">ch</span>&nbsp;<span class="op" id="6204691">==</span>&nbsp;<span class="string" id="6204694">&#39;-&#39;</span>&nbsp;<span class="op" id="6204698">||</span>&nbsp;<span class="ident" id="6204701">ch</span>&nbsp;<span class="op" id="6204704">==</span>&nbsp;<span class="string" id="6204707">&#39;+&#39;</span>&nbsp;<span class="op" id="6204711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204716">ch</span>&nbsp;<span class="op" id="6204719">=</span>&nbsp;<span class="ident" id="6204721">s</span><span class="op" id="6204722">.</span><span class="ident" id="6204723">next</span><span class="op" id="6204727">(</span><span class="op" id="6204728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204736">ch</span>&nbsp;<span class="op" id="6204739">=</span>&nbsp;<span class="ident" id="6204741">s</span><span class="op" id="6204742">.</span><span class="ident" id="6204743">scanMantissa</span><span class="op" id="6204755">(</span><span class="ident" id="6204756">ch</span><span class="op" id="6204758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204761">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204764">return</span>&nbsp;<span class="ident" id="6204771">ch</span><br>
<span class="lineno"></span><span class="op" id="6204774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6204777">func</span>&nbsp;<span class="op" id="6204782">(</span><span class="ident" id="6204783">s</span>&nbsp;<span class="op" id="6204785">*</span><span class="ident" id="6204786">Scanner</span><span class="op" id="6204793">)</span>&nbsp;<span class="ident" id="6204795">scanNumber</span><span class="op" id="6204805">(</span><span class="ident" id="6204806">ch</span>&nbsp;<span class="builtintype" id="6204809">rune</span><span class="op" id="6204813">)</span>&nbsp;<span class="op" id="6204815">(</span><span class="builtintype" id="6204816">rune</span><span class="op" id="6204820">,</span>&nbsp;<span class="builtintype" id="6204822">rune</span><span class="op" id="6204826">)</span>&nbsp;<span class="op" id="6204828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204831">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204849">if</span>&nbsp;<span class="ident" id="6204852">ch</span>&nbsp;<span class="op" id="6204855">==</span>&nbsp;<span class="string" id="6204858">&#39;0&#39;</span>&nbsp;<span class="op" id="6204862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204866">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204884">ch</span>&nbsp;<span class="op" id="6204887">=</span>&nbsp;<span class="ident" id="6204889">s</span><span class="op" id="6204890">.</span><span class="ident" id="6204891">next</span><span class="op" id="6204895">(</span><span class="op" id="6204896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204900">if</span>&nbsp;<span class="ident" id="6204903">ch</span>&nbsp;<span class="op" id="6204906">==</span>&nbsp;<span class="string" id="6204909">&#39;x&#39;</span>&nbsp;<span class="op" id="6204913">||</span>&nbsp;<span class="ident" id="6204916">ch</span>&nbsp;<span class="op" id="6204919">==</span>&nbsp;<span class="string" id="6204922">&#39;X&#39;</span>&nbsp;<span class="op" id="6204926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204931">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204953">ch</span>&nbsp;<span class="op" id="6204956">=</span>&nbsp;<span class="ident" id="6204958">s</span><span class="op" id="6204959">.</span><span class="ident" id="6204960">next</span><span class="op" id="6204964">(</span><span class="op" id="6204965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204970">hasMantissa</span>&nbsp;<span class="op" id="6204982">:=</span>&nbsp;<span class="builtintype" id="6204985">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204994">for</span>&nbsp;<span class="ident" id="6204998">digitVal</span><span class="op" id="6205006">(</span><span class="ident" id="6205007">ch</span><span class="op" id="6205009">)</span>&nbsp;<span class="op" id="6205011">&lt;</span>&nbsp;<span class="num" id="6205013">16</span>&nbsp;<span class="op" id="6205016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205022">ch</span>&nbsp;<span class="op" id="6205025">=</span>&nbsp;<span class="ident" id="6205027">s</span><span class="op" id="6205028">.</span><span class="ident" id="6205029">next</span><span class="op" id="6205033">(</span><span class="op" id="6205034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205040">hasMantissa</span>&nbsp;<span class="op" id="6205052">=</span>&nbsp;<span class="builtintype" id="6205054">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205067">if</span>&nbsp;<span class="op" id="6205070">!</span><span class="ident" id="6205071">hasMantissa</span>&nbsp;<span class="op" id="6205083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205089">s</span><span class="op" id="6205090">.</span><span class="builtintype" id="6205091">error</span><span class="op" id="6205096">(</span><span class="string" id="6205097">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="6205125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205134">}</span>&nbsp;<span class="keyword" id="6205136">else</span>&nbsp;<span class="op" id="6205141">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205146">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205171">has8or9</span>&nbsp;<span class="op" id="6205179">:=</span>&nbsp;<span class="builtintype" id="6205182">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205191">for</span>&nbsp;<span class="ident" id="6205195">isDecimal</span><span class="op" id="6205204">(</span><span class="ident" id="6205205">ch</span><span class="op" id="6205207">)</span>&nbsp;<span class="op" id="6205209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205215">if</span>&nbsp;<span class="ident" id="6205218">ch</span>&nbsp;<span class="op" id="6205221">&gt;</span>&nbsp;<span class="string" id="6205223">&#39;7&#39;</span>&nbsp;<span class="op" id="6205227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205234">has8or9</span>&nbsp;<span class="op" id="6205242">=</span>&nbsp;<span class="builtintype" id="6205244">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205259">ch</span>&nbsp;<span class="op" id="6205262">=</span>&nbsp;<span class="ident" id="6205264">s</span><span class="op" id="6205265">.</span><span class="ident" id="6205266">next</span><span class="op" id="6205270">(</span><span class="op" id="6205271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205281">if</span>&nbsp;<span class="ident" id="6205284">s</span><span class="op" id="6205285">.</span><span class="ident" id="6205286">Mode</span><span class="op" id="6205290">&amp;</span><span class="ident" id="6205291">ScanFloats</span>&nbsp;<span class="op" id="6205302">!=</span>&nbsp;<span class="num" id="6205305">0</span>&nbsp;<span class="op" id="6205307">&amp;&amp;</span>&nbsp;<span class="op" id="6205310">(</span><span class="ident" id="6205311">ch</span>&nbsp;<span class="op" id="6205314">==</span>&nbsp;<span class="string" id="6205317">&#39;.&#39;</span>&nbsp;<span class="op" id="6205321">||</span>&nbsp;<span class="ident" id="6205324">ch</span>&nbsp;<span class="op" id="6205327">==</span>&nbsp;<span class="string" id="6205330">&#39;e&#39;</span>&nbsp;<span class="op" id="6205334">||</span>&nbsp;<span class="ident" id="6205337">ch</span>&nbsp;<span class="op" id="6205340">==</span>&nbsp;<span class="string" id="6205343">&#39;E&#39;</span><span class="op" id="6205346">)</span>&nbsp;<span class="op" id="6205348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205354">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205367">ch</span>&nbsp;<span class="op" id="6205370">=</span>&nbsp;<span class="ident" id="6205372">s</span><span class="op" id="6205373">.</span><span class="ident" id="6205374">scanFraction</span><span class="op" id="6205386">(</span><span class="ident" id="6205387">ch</span><span class="op" id="6205389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205395">ch</span>&nbsp;<span class="op" id="6205398">=</span>&nbsp;<span class="ident" id="6205400">s</span><span class="op" id="6205401">.</span><span class="ident" id="6205402">scanExponent</span><span class="op" id="6205414">(</span><span class="ident" id="6205415">ch</span><span class="op" id="6205417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205423">return</span>&nbsp;<span class="ident" id="6205430">Float</span><span class="op" id="6205435">,</span>&nbsp;<span class="ident" id="6205437">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205448">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205464">if</span>&nbsp;<span class="ident" id="6205467">has8or9</span>&nbsp;<span class="op" id="6205475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205481">s</span><span class="op" id="6205482">.</span><span class="builtintype" id="6205483">error</span><span class="op" id="6205488">(</span><span class="string" id="6205489">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="6205511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205524">return</span>&nbsp;<span class="ident" id="6205531">Int</span><span class="op" id="6205534">,</span>&nbsp;<span class="ident" id="6205536">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205543">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205568">ch</span>&nbsp;<span class="op" id="6205571">=</span>&nbsp;<span class="ident" id="6205573">s</span><span class="op" id="6205574">.</span><span class="ident" id="6205575">scanMantissa</span><span class="op" id="6205587">(</span><span class="ident" id="6205588">ch</span><span class="op" id="6205590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205593">if</span>&nbsp;<span class="ident" id="6205596">s</span><span class="op" id="6205597">.</span><span class="ident" id="6205598">Mode</span><span class="op" id="6205602">&amp;</span><span class="ident" id="6205603">ScanFloats</span>&nbsp;<span class="op" id="6205614">!=</span>&nbsp;<span class="num" id="6205617">0</span>&nbsp;<span class="op" id="6205619">&amp;&amp;</span>&nbsp;<span class="op" id="6205622">(</span><span class="ident" id="6205623">ch</span>&nbsp;<span class="op" id="6205626">==</span>&nbsp;<span class="string" id="6205629">&#39;.&#39;</span>&nbsp;<span class="op" id="6205633">||</span>&nbsp;<span class="ident" id="6205636">ch</span>&nbsp;<span class="op" id="6205639">==</span>&nbsp;<span class="string" id="6205642">&#39;e&#39;</span>&nbsp;<span class="op" id="6205646">||</span>&nbsp;<span class="ident" id="6205649">ch</span>&nbsp;<span class="op" id="6205652">==</span>&nbsp;<span class="string" id="6205655">&#39;E&#39;</span><span class="op" id="6205658">)</span>&nbsp;<span class="op" id="6205660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205664">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205675">ch</span>&nbsp;<span class="op" id="6205678">=</span>&nbsp;<span class="ident" id="6205680">s</span><span class="op" id="6205681">.</span><span class="ident" id="6205682">scanFraction</span><span class="op" id="6205694">(</span><span class="ident" id="6205695">ch</span><span class="op" id="6205697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205701">ch</span>&nbsp;<span class="op" id="6205704">=</span>&nbsp;<span class="ident" id="6205706">s</span><span class="op" id="6205707">.</span><span class="ident" id="6205708">scanExponent</span><span class="op" id="6205720">(</span><span class="ident" id="6205721">ch</span><span class="op" id="6205723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205727">return</span>&nbsp;<span class="ident" id="6205734">Float</span><span class="op" id="6205739">,</span>&nbsp;<span class="ident" id="6205741">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205748">return</span>&nbsp;<span class="ident" id="6205755">Int</span><span class="op" id="6205758">,</span>&nbsp;<span class="ident" id="6205760">ch</span><br>
<span class="lineno">450</span><span class="op" id="6205763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6205766">func</span>&nbsp;<span class="op" id="6205771">(</span><span class="ident" id="6205772">s</span>&nbsp;<span class="op" id="6205774">*</span><span class="ident" id="6205775">Scanner</span><span class="op" id="6205782">)</span>&nbsp;<span class="ident" id="6205784">scanDigits</span><span class="op" id="6205794">(</span><span class="ident" id="6205795">ch</span>&nbsp;<span class="builtintype" id="6205798">rune</span><span class="op" id="6205802">,</span>&nbsp;<span class="ident" id="6205804">base</span><span class="op" id="6205808">,</span>&nbsp;<span class="ident" id="6205810">n</span>&nbsp;<span class="builtintype" id="6205812">int</span><span class="op" id="6205815">)</span>&nbsp;<span class="builtintype" id="6205817">rune</span>&nbsp;<span class="op" id="6205822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205825">for</span>&nbsp;<span class="ident" id="6205829">n</span>&nbsp;<span class="op" id="6205831">&gt;</span>&nbsp;<span class="num" id="6205833">0</span>&nbsp;<span class="op" id="6205835">&amp;&amp;</span>&nbsp;<span class="ident" id="6205838">digitVal</span><span class="op" id="6205846">(</span><span class="ident" id="6205847">ch</span><span class="op" id="6205849">)</span>&nbsp;<span class="op" id="6205851">&lt;</span>&nbsp;<span class="ident" id="6205853">base</span>&nbsp;<span class="op" id="6205858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205862">ch</span>&nbsp;<span class="op" id="6205865">=</span>&nbsp;<span class="ident" id="6205867">s</span><span class="op" id="6205868">.</span><span class="ident" id="6205869">next</span><span class="op" id="6205873">(</span><span class="op" id="6205874">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205878">n</span><span class="op" id="6205879">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205886">if</span>&nbsp;<span class="ident" id="6205889">n</span>&nbsp;<span class="op" id="6205891">&gt;</span>&nbsp;<span class="num" id="6205893">0</span>&nbsp;<span class="op" id="6205895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205899">s</span><span class="op" id="6205900">.</span><span class="builtintype" id="6205901">error</span><span class="op" id="6205906">(</span><span class="string" id="6205907">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6205928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205931">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205934">return</span>&nbsp;<span class="ident" id="6205941">ch</span><br>
<span class="lineno"></span><span class="op" id="6205944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6205947">func</span>&nbsp;<span class="op" id="6205952">(</span><span class="ident" id="6205953">s</span>&nbsp;<span class="op" id="6205955">*</span><span class="ident" id="6205956">Scanner</span><span class="op" id="6205963">)</span>&nbsp;<span class="ident" id="6205965">scanEscape</span><span class="op" id="6205975">(</span><span class="ident" id="6205976">quote</span>&nbsp;<span class="builtintype" id="6205982">rune</span><span class="op" id="6205986">)</span>&nbsp;<span class="builtintype" id="6205988">rune</span>&nbsp;<span class="op" id="6205993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205996">ch</span>&nbsp;<span class="op" id="6205999">:=</span>&nbsp;<span class="ident" id="6206002">s</span><span class="op" id="6206003">.</span><span class="ident" id="6206004">next</span><span class="op" id="6206008">(</span><span class="op" id="6206009">)</span>&nbsp;<span class="comment" id="6206011">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206040">switch</span>&nbsp;<span class="ident" id="6206047">ch</span>&nbsp;<span class="op" id="6206050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206053">case</span>&nbsp;<span class="string" id="6206058">&#39;a&#39;</span><span class="op" id="6206061">,</span>&nbsp;<span class="string" id="6206063">&#39;b&#39;</span><span class="op" id="6206066">,</span>&nbsp;<span class="string" id="6206068">&#39;f&#39;</span><span class="op" id="6206071">,</span>&nbsp;<span class="string" id="6206073">&#39;n&#39;</span><span class="op" id="6206076">,</span>&nbsp;<span class="string" id="6206078">&#39;r&#39;</span><span class="op" id="6206081">,</span>&nbsp;<span class="string" id="6206083">&#39;t&#39;</span><span class="op" id="6206086">,</span>&nbsp;<span class="string" id="6206088">&#39;v&#39;</span><span class="op" id="6206091">,</span>&nbsp;<span class="string" id="6206093">&#39;\\&#39;</span><span class="op" id="6206097">,</span>&nbsp;<span class="ident" id="6206099">quote</span><span class="op" id="6206104">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6206108">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206127">ch</span>&nbsp;<span class="op" id="6206130">=</span>&nbsp;<span class="ident" id="6206132">s</span><span class="op" id="6206133">.</span><span class="ident" id="6206134">next</span><span class="op" id="6206138">(</span><span class="op" id="6206139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206142">case</span>&nbsp;<span class="string" id="6206147">&#39;0&#39;</span><span class="op" id="6206150">,</span>&nbsp;<span class="string" id="6206152">&#39;1&#39;</span><span class="op" id="6206155">,</span>&nbsp;<span class="string" id="6206157">&#39;2&#39;</span><span class="op" id="6206160">,</span>&nbsp;<span class="string" id="6206162">&#39;3&#39;</span><span class="op" id="6206165">,</span>&nbsp;<span class="string" id="6206167">&#39;4&#39;</span><span class="op" id="6206170">,</span>&nbsp;<span class="string" id="6206172">&#39;5&#39;</span><span class="op" id="6206175">,</span>&nbsp;<span class="string" id="6206177">&#39;6&#39;</span><span class="op" id="6206180">,</span>&nbsp;<span class="string" id="6206182">&#39;7&#39;</span><span class="op" id="6206185">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206189">ch</span>&nbsp;<span class="op" id="6206192">=</span>&nbsp;<span class="ident" id="6206194">s</span><span class="op" id="6206195">.</span><span class="ident" id="6206196">scanDigits</span><span class="op" id="6206206">(</span><span class="ident" id="6206207">ch</span><span class="op" id="6206209">,</span>&nbsp;<span class="num" id="6206211">8</span><span class="op" id="6206212">,</span>&nbsp;<span class="num" id="6206214">3</span><span class="op" id="6206215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206218">case</span>&nbsp;<span class="string" id="6206223">&#39;x&#39;</span><span class="op" id="6206226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206230">ch</span>&nbsp;<span class="op" id="6206233">=</span>&nbsp;<span class="ident" id="6206235">s</span><span class="op" id="6206236">.</span><span class="ident" id="6206237">scanDigits</span><span class="op" id="6206247">(</span><span class="ident" id="6206248">s</span><span class="op" id="6206249">.</span><span class="ident" id="6206250">next</span><span class="op" id="6206254">(</span><span class="op" id="6206255">)</span><span class="op" id="6206256">,</span>&nbsp;<span class="num" id="6206258">16</span><span class="op" id="6206260">,</span>&nbsp;<span class="num" id="6206262">2</span><span class="op" id="6206263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206266">case</span>&nbsp;<span class="string" id="6206271">&#39;u&#39;</span><span class="op" id="6206274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206278">ch</span>&nbsp;<span class="op" id="6206281">=</span>&nbsp;<span class="ident" id="6206283">s</span><span class="op" id="6206284">.</span><span class="ident" id="6206285">scanDigits</span><span class="op" id="6206295">(</span><span class="ident" id="6206296">s</span><span class="op" id="6206297">.</span><span class="ident" id="6206298">next</span><span class="op" id="6206302">(</span><span class="op" id="6206303">)</span><span class="op" id="6206304">,</span>&nbsp;<span class="num" id="6206306">16</span><span class="op" id="6206308">,</span>&nbsp;<span class="num" id="6206310">4</span><span class="op" id="6206311">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206314">case</span>&nbsp;<span class="string" id="6206319">&#39;U&#39;</span><span class="op" id="6206322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206326">ch</span>&nbsp;<span class="op" id="6206329">=</span>&nbsp;<span class="ident" id="6206331">s</span><span class="op" id="6206332">.</span><span class="ident" id="6206333">scanDigits</span><span class="op" id="6206343">(</span><span class="ident" id="6206344">s</span><span class="op" id="6206345">.</span><span class="ident" id="6206346">next</span><span class="op" id="6206350">(</span><span class="op" id="6206351">)</span><span class="op" id="6206352">,</span>&nbsp;<span class="num" id="6206354">16</span><span class="op" id="6206356">,</span>&nbsp;<span class="num" id="6206358">8</span><span class="op" id="6206359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206362">default</span><span class="op" id="6206369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206373">s</span><span class="op" id="6206374">.</span><span class="builtintype" id="6206375">error</span><span class="op" id="6206380">(</span><span class="string" id="6206381">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6206402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206405">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206408">return</span>&nbsp;<span class="ident" id="6206415">ch</span><br>
<span class="lineno"></span><span class="op" id="6206418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6206421">func</span>&nbsp;<span class="op" id="6206426">(</span><span class="ident" id="6206427">s</span>&nbsp;<span class="op" id="6206429">*</span><span class="ident" id="6206430">Scanner</span><span class="op" id="6206437">)</span>&nbsp;<span class="ident" id="6206439">scanString</span><span class="op" id="6206449">(</span><span class="ident" id="6206450">quote</span>&nbsp;<span class="builtintype" id="6206456">rune</span><span class="op" id="6206460">)</span>&nbsp;<span class="op" id="6206462">(</span><span class="ident" id="6206463">n</span>&nbsp;<span class="builtintype" id="6206465">int</span><span class="op" id="6206468">)</span>&nbsp;<span class="op" id="6206470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206473">ch</span>&nbsp;<span class="op" id="6206476">:=</span>&nbsp;<span class="ident" id="6206479">s</span><span class="op" id="6206480">.</span><span class="ident" id="6206481">next</span><span class="op" id="6206485">(</span><span class="op" id="6206486">)</span>&nbsp;<span class="comment" id="6206488">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206519">for</span>&nbsp;<span class="ident" id="6206523">ch</span>&nbsp;<span class="op" id="6206526">!=</span>&nbsp;<span class="ident" id="6206529">quote</span>&nbsp;<span class="op" id="6206535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206539">if</span>&nbsp;<span class="ident" id="6206542">ch</span>&nbsp;<span class="op" id="6206545">==</span>&nbsp;<span class="string" id="6206548">&#39;\n&#39;</span>&nbsp;<span class="op" id="6206553">||</span>&nbsp;<span class="ident" id="6206556">ch</span>&nbsp;<span class="op" id="6206559">&lt;</span>&nbsp;<span class="num" id="6206561">0</span>&nbsp;<span class="op" id="6206563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206568">s</span><span class="op" id="6206569">.</span><span class="builtintype" id="6206570">error</span><span class="op" id="6206575">(</span><span class="string" id="6206576">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6206600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206605">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206614">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206618">if</span>&nbsp;<span class="ident" id="6206621">ch</span>&nbsp;<span class="op" id="6206624">==</span>&nbsp;<span class="string" id="6206627">&#39;\\&#39;</span>&nbsp;<span class="op" id="6206632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206637">ch</span>&nbsp;<span class="op" id="6206640">=</span>&nbsp;<span class="ident" id="6206642">s</span><span class="op" id="6206643">.</span><span class="ident" id="6206644">scanEscape</span><span class="op" id="6206654">(</span><span class="ident" id="6206655">quote</span><span class="op" id="6206660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206664">}</span>&nbsp;<span class="keyword" id="6206666">else</span>&nbsp;<span class="op" id="6206671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206676">ch</span>&nbsp;<span class="op" id="6206679">=</span>&nbsp;<span class="ident" id="6206681">s</span><span class="op" id="6206682">.</span><span class="ident" id="6206683">next</span><span class="op" id="6206687">(</span><span class="op" id="6206688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206692">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206696">n</span><span class="op" id="6206697">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206704">return</span><br>
<span class="lineno"></span><span class="op" id="6206711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6206714">func</span>&nbsp;<span class="op" id="6206719">(</span><span class="ident" id="6206720">s</span>&nbsp;<span class="op" id="6206722">*</span><span class="ident" id="6206723">Scanner</span><span class="op" id="6206730">)</span>&nbsp;<span class="ident" id="6206732">scanRawString</span><span class="op" id="6206745">(</span><span class="op" id="6206746">)</span>&nbsp;<span class="op" id="6206748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206751">ch</span>&nbsp;<span class="op" id="6206754">:=</span>&nbsp;<span class="ident" id="6206757">s</span><span class="op" id="6206758">.</span><span class="ident" id="6206759">next</span><span class="op" id="6206763">(</span><span class="op" id="6206764">)</span>&nbsp;<span class="comment" id="6206766">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206795">for</span>&nbsp;<span class="ident" id="6206799">ch</span>&nbsp;<span class="op" id="6206802">!=</span>&nbsp;<span class="string" id="6206805">&#39;`&#39;</span>&nbsp;<span class="op" id="6206809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206813">if</span>&nbsp;<span class="ident" id="6206816">ch</span>&nbsp;<span class="op" id="6206819">&lt;</span>&nbsp;<span class="num" id="6206821">0</span>&nbsp;<span class="op" id="6206823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206828">s</span><span class="op" id="6206829">.</span><span class="builtintype" id="6206830">error</span><span class="op" id="6206835">(</span><span class="string" id="6206836">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6206860">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206865">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206878">ch</span>&nbsp;<span class="op" id="6206881">=</span>&nbsp;<span class="ident" id="6206883">s</span><span class="op" id="6206884">.</span><span class="ident" id="6206885">next</span><span class="op" id="6206889">(</span><span class="op" id="6206890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206893">}</span><br>
<span class="lineno"></span><span class="op" id="6206895">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="6206898">func</span>&nbsp;<span class="op" id="6206903">(</span><span class="ident" id="6206904">s</span>&nbsp;<span class="op" id="6206906">*</span><span class="ident" id="6206907">Scanner</span><span class="op" id="6206914">)</span>&nbsp;<span class="ident" id="6206916">scanChar</span><span class="op" id="6206924">(</span><span class="op" id="6206925">)</span>&nbsp;<span class="op" id="6206927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206930">if</span>&nbsp;<span class="ident" id="6206933">s</span><span class="op" id="6206934">.</span><span class="ident" id="6206935">scanString</span><span class="op" id="6206945">(</span><span class="string" id="6206946">&#39;\&#39;&#39;</span><span class="op" id="6206950">)</span>&nbsp;<span class="op" id="6206952">!=</span>&nbsp;<span class="num" id="6206955">1</span>&nbsp;<span class="op" id="6206957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206961">s</span><span class="op" id="6206962">.</span><span class="builtintype" id="6206963">error</span><span class="op" id="6206968">(</span><span class="string" id="6206969">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="6206991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206994">}</span><br>
<span class="lineno">515</span><span class="op" id="6206996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6206999">func</span>&nbsp;<span class="op" id="6207004">(</span><span class="ident" id="6207005">s</span>&nbsp;<span class="op" id="6207007">*</span><span class="ident" id="6207008">Scanner</span><span class="op" id="6207015">)</span>&nbsp;<span class="ident" id="6207017">scanComment</span><span class="op" id="6207028">(</span><span class="ident" id="6207029">ch</span>&nbsp;<span class="builtintype" id="6207032">rune</span><span class="op" id="6207036">)</span>&nbsp;<span class="builtintype" id="6207038">rune</span>&nbsp;<span class="op" id="6207043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207046">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207073">if</span>&nbsp;<span class="ident" id="6207076">ch</span>&nbsp;<span class="op" id="6207079">==</span>&nbsp;<span class="string" id="6207082">&#39;/&#39;</span>&nbsp;<span class="op" id="6207086">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207090">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207108">ch</span>&nbsp;<span class="op" id="6207111">=</span>&nbsp;<span class="ident" id="6207113">s</span><span class="op" id="6207114">.</span><span class="ident" id="6207115">next</span><span class="op" id="6207119">(</span><span class="op" id="6207120">)</span>&nbsp;<span class="comment" id="6207122">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207153">for</span>&nbsp;<span class="ident" id="6207157">ch</span>&nbsp;<span class="op" id="6207160">!=</span>&nbsp;<span class="string" id="6207163">&#39;\n&#39;</span>&nbsp;<span class="op" id="6207168">&amp;&amp;</span>&nbsp;<span class="ident" id="6207171">ch</span>&nbsp;<span class="op" id="6207174">&gt;=</span>&nbsp;<span class="num" id="6207177">0</span>&nbsp;<span class="op" id="6207179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207184">ch</span>&nbsp;<span class="op" id="6207187">=</span>&nbsp;<span class="ident" id="6207189">s</span><span class="op" id="6207190">.</span><span class="ident" id="6207191">next</span><span class="op" id="6207195">(</span><span class="op" id="6207196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207200">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207204">return</span>&nbsp;<span class="ident" id="6207211">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207219">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207239">ch</span>&nbsp;<span class="op" id="6207242">=</span>&nbsp;<span class="ident" id="6207244">s</span><span class="op" id="6207245">.</span><span class="ident" id="6207246">next</span><span class="op" id="6207250">(</span><span class="op" id="6207251">)</span>&nbsp;<span class="comment" id="6207253">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207283">for</span>&nbsp;<span class="op" id="6207287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207291">if</span>&nbsp;<span class="ident" id="6207294">ch</span>&nbsp;<span class="op" id="6207297">&lt;</span>&nbsp;<span class="num" id="6207299">0</span>&nbsp;<span class="op" id="6207301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207306">s</span><span class="op" id="6207307">.</span><span class="builtintype" id="6207308">error</span><span class="op" id="6207313">(</span><span class="string" id="6207314">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6207338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207343">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207351">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207355">ch0</span>&nbsp;<span class="op" id="6207359">:=</span>&nbsp;<span class="ident" id="6207362">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207367">ch</span>&nbsp;<span class="op" id="6207370">=</span>&nbsp;<span class="ident" id="6207372">s</span><span class="op" id="6207373">.</span><span class="ident" id="6207374">next</span><span class="op" id="6207378">(</span><span class="op" id="6207379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207383">if</span>&nbsp;<span class="ident" id="6207386">ch0</span>&nbsp;<span class="op" id="6207390">==</span>&nbsp;<span class="string" id="6207393">&#39;*&#39;</span>&nbsp;<span class="op" id="6207397">&amp;&amp;</span>&nbsp;<span class="ident" id="6207400">ch</span>&nbsp;<span class="op" id="6207403">==</span>&nbsp;<span class="string" id="6207406">&#39;/&#39;</span>&nbsp;<span class="op" id="6207410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207415">ch</span>&nbsp;<span class="op" id="6207418">=</span>&nbsp;<span class="ident" id="6207420">s</span><span class="op" id="6207421">.</span><span class="ident" id="6207422">next</span><span class="op" id="6207426">(</span><span class="op" id="6207427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207432">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207446">return</span>&nbsp;<span class="ident" id="6207453">ch</span><br>
<span class="lineno"></span><span class="op" id="6207456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="6207459">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6207537">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6207618">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6207698">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6207776">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="6207801">func</span>&nbsp;<span class="op" id="6207806">(</span><span class="ident" id="6207807">s</span>&nbsp;<span class="op" id="6207809">*</span><span class="ident" id="6207810">Scanner</span><span class="op" id="6207817">)</span>&nbsp;<span class="ident" id="6207819">Scan</span><span class="op" id="6207823">(</span><span class="op" id="6207824">)</span>&nbsp;<span class="builtintype" id="6207826">rune</span>&nbsp;<span class="op" id="6207831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207834">ch</span>&nbsp;<span class="op" id="6207837">:=</span>&nbsp;<span class="ident" id="6207840">s</span><span class="op" id="6207841">.</span><span class="ident" id="6207842">Peek</span><span class="op" id="6207846">(</span><span class="op" id="6207847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207851">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207881">s</span><span class="op" id="6207882">.</span><span class="ident" id="6207883">tokPos</span>&nbsp;<span class="op" id="6207890">=</span>&nbsp;<span class="op" id="6207892">-</span><span class="num" id="6207893">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207896">s</span><span class="op" id="6207897">.</span><span class="ident" id="6207898">Line</span>&nbsp;<span class="op" id="6207903">=</span>&nbsp;<span class="num" id="6207905">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6207908">redo</span><span class="op" id="6207912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207915">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207936">for</span>&nbsp;<span class="ident" id="6207940">s</span><span class="op" id="6207941">.</span><span class="ident" id="6207942">Whitespace</span><span class="op" id="6207952">&amp;</span><span class="op" id="6207953">(</span><span class="num" id="6207954">1</span><span class="op" id="6207955">&lt;&lt;</span><span class="builtintype" id="6207957">uint</span><span class="op" id="6207961">(</span><span class="ident" id="6207962">ch</span><span class="op" id="6207964">)</span><span class="op" id="6207965">)</span>&nbsp;<span class="op" id="6207967">!=</span>&nbsp;<span class="num" id="6207970">0</span>&nbsp;<span class="op" id="6207972">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207976">ch</span>&nbsp;<span class="op" id="6207979">=</span>&nbsp;<span class="ident" id="6207981">s</span><span class="op" id="6207982">.</span><span class="ident" id="6207983">next</span><span class="op" id="6207987">(</span><span class="op" id="6207988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207995">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208027">s</span><span class="op" id="6208028">.</span><span class="ident" id="6208029">tokBuf</span><span class="op" id="6208035">.</span><span class="ident" id="6208036">Reset</span><span class="op" id="6208041">(</span><span class="op" id="6208042">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208045">s</span><span class="op" id="6208046">.</span><span class="ident" id="6208047">tokPos</span>&nbsp;<span class="op" id="6208054">=</span>&nbsp;<span class="ident" id="6208056">s</span><span class="op" id="6208057">.</span><span class="ident" id="6208058">srcPos</span>&nbsp;<span class="op" id="6208065">-</span>&nbsp;<span class="ident" id="6208067">s</span><span class="op" id="6208068">.</span><span class="ident" id="6208069">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208083">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208106">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208170">s</span><span class="op" id="6208171">.</span><span class="ident" id="6208172">Offset</span>&nbsp;<span class="op" id="6208179">=</span>&nbsp;<span class="ident" id="6208181">s</span><span class="op" id="6208182">.</span><span class="ident" id="6208183">srcBufOffset</span>&nbsp;<span class="op" id="6208196">+</span>&nbsp;<span class="ident" id="6208198">s</span><span class="op" id="6208199">.</span><span class="ident" id="6208200">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208208">if</span>&nbsp;<span class="ident" id="6208211">s</span><span class="op" id="6208212">.</span><span class="ident" id="6208213">column</span>&nbsp;<span class="op" id="6208220">&gt;</span>&nbsp;<span class="num" id="6208222">0</span>&nbsp;<span class="op" id="6208224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208228">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208276">s</span><span class="op" id="6208277">.</span><span class="ident" id="6208278">Line</span>&nbsp;<span class="op" id="6208283">=</span>&nbsp;<span class="ident" id="6208285">s</span><span class="op" id="6208286">.</span><span class="ident" id="6208287">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208294">s</span><span class="op" id="6208295">.</span><span class="ident" id="6208296">Column</span>&nbsp;<span class="op" id="6208303">=</span>&nbsp;<span class="ident" id="6208305">s</span><span class="op" id="6208306">.</span><span class="ident" id="6208307">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208315">}</span>&nbsp;<span class="keyword" id="6208317">else</span>&nbsp;<span class="op" id="6208322">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208326">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208357">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208407">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208455">s</span><span class="op" id="6208456">.</span><span class="ident" id="6208457">Line</span>&nbsp;<span class="op" id="6208462">=</span>&nbsp;<span class="ident" id="6208464">s</span><span class="op" id="6208465">.</span><span class="ident" id="6208466">line</span>&nbsp;<span class="op" id="6208471">-</span>&nbsp;<span class="num" id="6208473">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208477">s</span><span class="op" id="6208478">.</span><span class="ident" id="6208479">Column</span>&nbsp;<span class="op" id="6208486">=</span>&nbsp;<span class="ident" id="6208488">s</span><span class="op" id="6208489">.</span><span class="ident" id="6208490">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208507">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208533">tok</span>&nbsp;<span class="op" id="6208537">:=</span>&nbsp;<span class="ident" id="6208540">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208544">switch</span>&nbsp;<span class="op" id="6208551">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208554">case</span>&nbsp;<span class="ident" id="6208559">s</span><span class="op" id="6208560">.</span><span class="ident" id="6208561">isIdentRune</span><span class="op" id="6208572">(</span><span class="ident" id="6208573">ch</span><span class="op" id="6208575">,</span>&nbsp;<span class="num" id="6208577">0</span><span class="op" id="6208578">)</span><span class="op" id="6208579">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208583">if</span>&nbsp;<span class="ident" id="6208586">s</span><span class="op" id="6208587">.</span><span class="ident" id="6208588">Mode</span><span class="op" id="6208592">&amp;</span><span class="ident" id="6208593">ScanIdents</span>&nbsp;<span class="op" id="6208604">!=</span>&nbsp;<span class="num" id="6208607">0</span>&nbsp;<span class="op" id="6208609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208614">tok</span>&nbsp;<span class="op" id="6208618">=</span>&nbsp;<span class="ident" id="6208620">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208629">ch</span>&nbsp;<span class="op" id="6208632">=</span>&nbsp;<span class="ident" id="6208634">s</span><span class="op" id="6208635">.</span><span class="ident" id="6208636">scanIdentifier</span><span class="op" id="6208650">(</span><span class="op" id="6208651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208655">}</span>&nbsp;<span class="keyword" id="6208657">else</span>&nbsp;<span class="op" id="6208662">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208667">ch</span>&nbsp;<span class="op" id="6208670">=</span>&nbsp;<span class="ident" id="6208672">s</span><span class="op" id="6208673">.</span><span class="ident" id="6208674">next</span><span class="op" id="6208678">(</span><span class="op" id="6208679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208686">case</span>&nbsp;<span class="ident" id="6208691">isDecimal</span><span class="op" id="6208700">(</span><span class="ident" id="6208701">ch</span><span class="op" id="6208703">)</span><span class="op" id="6208704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208708">if</span>&nbsp;<span class="ident" id="6208711">s</span><span class="op" id="6208712">.</span><span class="ident" id="6208713">Mode</span><span class="op" id="6208717">&amp;</span><span class="op" id="6208718">(</span><span class="ident" id="6208719">ScanInts</span><span class="op" id="6208727">|</span><span class="ident" id="6208728">ScanFloats</span><span class="op" id="6208738">)</span>&nbsp;<span class="op" id="6208740">!=</span>&nbsp;<span class="num" id="6208743">0</span>&nbsp;<span class="op" id="6208745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208750">tok</span><span class="op" id="6208753">,</span>&nbsp;<span class="ident" id="6208755">ch</span>&nbsp;<span class="op" id="6208758">=</span>&nbsp;<span class="ident" id="6208760">s</span><span class="op" id="6208761">.</span><span class="ident" id="6208762">scanNumber</span><span class="op" id="6208772">(</span><span class="ident" id="6208773">ch</span><span class="op" id="6208775">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208779">}</span>&nbsp;<span class="keyword" id="6208781">else</span>&nbsp;<span class="op" id="6208786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208791">ch</span>&nbsp;<span class="op" id="6208794">=</span>&nbsp;<span class="ident" id="6208796">s</span><span class="op" id="6208797">.</span><span class="ident" id="6208798">next</span><span class="op" id="6208802">(</span><span class="op" id="6208803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208810">default</span><span class="op" id="6208817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208821">switch</span>&nbsp;<span class="ident" id="6208828">ch</span>&nbsp;<span class="op" id="6208831">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208835">case</span>&nbsp;<span class="string" id="6208840">&#39;&#34;&#39;</span><span class="op" id="6208843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208848">if</span>&nbsp;<span class="ident" id="6208851">s</span><span class="op" id="6208852">.</span><span class="ident" id="6208853">Mode</span><span class="op" id="6208857">&amp;</span><span class="ident" id="6208858">ScanStrings</span>&nbsp;<span class="op" id="6208870">!=</span>&nbsp;<span class="num" id="6208873">0</span>&nbsp;<span class="op" id="6208875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208881">s</span><span class="op" id="6208882">.</span><span class="ident" id="6208883">scanString</span><span class="op" id="6208893">(</span><span class="string" id="6208894">&#39;&#34;&#39;</span><span class="op" id="6208897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208903">tok</span>&nbsp;<span class="op" id="6208907">=</span>&nbsp;<span class="ident" id="6208909">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208919">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208924">ch</span>&nbsp;<span class="op" id="6208927">=</span>&nbsp;<span class="ident" id="6208929">s</span><span class="op" id="6208930">.</span><span class="ident" id="6208931">next</span><span class="op" id="6208935">(</span><span class="op" id="6208936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208940">case</span>&nbsp;<span class="string" id="6208945">&#39;\&#39;&#39;</span><span class="op" id="6208949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208954">if</span>&nbsp;<span class="ident" id="6208957">s</span><span class="op" id="6208958">.</span><span class="ident" id="6208959">Mode</span><span class="op" id="6208963">&amp;</span><span class="ident" id="6208964">ScanChars</span>&nbsp;<span class="op" id="6208974">!=</span>&nbsp;<span class="num" id="6208977">0</span>&nbsp;<span class="op" id="6208979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208985">s</span><span class="op" id="6208986">.</span><span class="ident" id="6208987">scanChar</span><span class="op" id="6208995">(</span><span class="op" id="6208996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209002">tok</span>&nbsp;<span class="op" id="6209006">=</span>&nbsp;<span class="ident" id="6209008">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209021">ch</span>&nbsp;<span class="op" id="6209024">=</span>&nbsp;<span class="ident" id="6209026">s</span><span class="op" id="6209027">.</span><span class="ident" id="6209028">next</span><span class="op" id="6209032">(</span><span class="op" id="6209033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209037">case</span>&nbsp;<span class="string" id="6209042">&#39;.&#39;</span><span class="op" id="6209045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209050">ch</span>&nbsp;<span class="op" id="6209053">=</span>&nbsp;<span class="ident" id="6209055">s</span><span class="op" id="6209056">.</span><span class="ident" id="6209057">next</span><span class="op" id="6209061">(</span><span class="op" id="6209062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209067">if</span>&nbsp;<span class="ident" id="6209070">isDecimal</span><span class="op" id="6209079">(</span><span class="ident" id="6209080">ch</span><span class="op" id="6209082">)</span>&nbsp;<span class="op" id="6209084">&amp;&amp;</span>&nbsp;<span class="ident" id="6209087">s</span><span class="op" id="6209088">.</span><span class="ident" id="6209089">Mode</span><span class="op" id="6209093">&amp;</span><span class="ident" id="6209094">ScanFloats</span>&nbsp;<span class="op" id="6209105">!=</span>&nbsp;<span class="num" id="6209108">0</span>&nbsp;<span class="op" id="6209110">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209116">tok</span>&nbsp;<span class="op" id="6209120">=</span>&nbsp;<span class="ident" id="6209122">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209132">ch</span>&nbsp;<span class="op" id="6209135">=</span>&nbsp;<span class="ident" id="6209137">s</span><span class="op" id="6209138">.</span><span class="ident" id="6209139">scanMantissa</span><span class="op" id="6209151">(</span><span class="ident" id="6209152">ch</span><span class="op" id="6209154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209160">ch</span>&nbsp;<span class="op" id="6209163">=</span>&nbsp;<span class="ident" id="6209165">s</span><span class="op" id="6209166">.</span><span class="ident" id="6209167">scanExponent</span><span class="op" id="6209179">(</span><span class="ident" id="6209180">ch</span><span class="op" id="6209182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209191">case</span>&nbsp;<span class="string" id="6209196">&#39;/&#39;</span><span class="op" id="6209199">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209204">ch</span>&nbsp;<span class="op" id="6209207">=</span>&nbsp;<span class="ident" id="6209209">s</span><span class="op" id="6209210">.</span><span class="ident" id="6209211">next</span><span class="op" id="6209215">(</span><span class="op" id="6209216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209221">if</span>&nbsp;<span class="op" id="6209224">(</span><span class="ident" id="6209225">ch</span>&nbsp;<span class="op" id="6209228">==</span>&nbsp;<span class="string" id="6209231">&#39;/&#39;</span>&nbsp;<span class="op" id="6209235">||</span>&nbsp;<span class="ident" id="6209238">ch</span>&nbsp;<span class="op" id="6209241">==</span>&nbsp;<span class="string" id="6209244">&#39;*&#39;</span><span class="op" id="6209247">)</span>&nbsp;<span class="op" id="6209249">&amp;&amp;</span>&nbsp;<span class="ident" id="6209252">s</span><span class="op" id="6209253">.</span><span class="ident" id="6209254">Mode</span><span class="op" id="6209258">&amp;</span><span class="ident" id="6209259">ScanComments</span>&nbsp;<span class="op" id="6209272">!=</span>&nbsp;<span class="num" id="6209275">0</span>&nbsp;<span class="op" id="6209277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209283">if</span>&nbsp;<span class="ident" id="6209286">s</span><span class="op" id="6209287">.</span><span class="ident" id="6209288">Mode</span><span class="op" id="6209292">&amp;</span><span class="ident" id="6209293">SkipComments</span>&nbsp;<span class="op" id="6209306">!=</span>&nbsp;<span class="num" id="6209309">0</span>&nbsp;<span class="op" id="6209311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209318">s</span><span class="op" id="6209319">.</span><span class="ident" id="6209320">tokPos</span>&nbsp;<span class="op" id="6209327">=</span>&nbsp;<span class="op" id="6209329">-</span><span class="num" id="6209330">1</span>&nbsp;<span class="comment" id="6209332">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209365">ch</span>&nbsp;<span class="op" id="6209368">=</span>&nbsp;<span class="ident" id="6209370">s</span><span class="op" id="6209371">.</span><span class="ident" id="6209372">scanComment</span><span class="op" id="6209383">(</span><span class="ident" id="6209384">ch</span><span class="op" id="6209386">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209393">goto</span>&nbsp;<span class="ident" id="6209398">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209413">ch</span>&nbsp;<span class="op" id="6209416">=</span>&nbsp;<span class="ident" id="6209418">s</span><span class="op" id="6209419">.</span><span class="ident" id="6209420">scanComment</span><span class="op" id="6209431">(</span><span class="ident" id="6209432">ch</span><span class="op" id="6209434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209440">tok</span>&nbsp;<span class="op" id="6209444">=</span>&nbsp;<span class="ident" id="6209446">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209457">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209461">case</span>&nbsp;<span class="string" id="6209466">&#39;`&#39;</span><span class="op" id="6209469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209474">if</span>&nbsp;<span class="ident" id="6209477">s</span><span class="op" id="6209478">.</span><span class="ident" id="6209479">Mode</span><span class="op" id="6209483">&amp;</span><span class="ident" id="6209484">ScanRawStrings</span>&nbsp;<span class="op" id="6209499">!=</span>&nbsp;<span class="num" id="6209502">0</span>&nbsp;<span class="op" id="6209504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209510">s</span><span class="op" id="6209511">.</span><span class="ident" id="6209512">scanRawString</span><span class="op" id="6209525">(</span><span class="op" id="6209526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209532">tok</span>&nbsp;<span class="op" id="6209536">=</span>&nbsp;<span class="ident" id="6209538">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209548">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209553">ch</span>&nbsp;<span class="op" id="6209556">=</span>&nbsp;<span class="ident" id="6209558">s</span><span class="op" id="6209559">.</span><span class="ident" id="6209560">next</span><span class="op" id="6209564">(</span><span class="op" id="6209565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209569">default</span><span class="op" id="6209576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209581">ch</span>&nbsp;<span class="op" id="6209584">=</span>&nbsp;<span class="ident" id="6209586">s</span><span class="op" id="6209587">.</span><span class="ident" id="6209588">next</span><span class="op" id="6209592">(</span><span class="op" id="6209593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209600">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6209604">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209626">s</span><span class="op" id="6209627">.</span><span class="ident" id="6209628">tokEnd</span>&nbsp;<span class="op" id="6209635">=</span>&nbsp;<span class="ident" id="6209637">s</span><span class="op" id="6209638">.</span><span class="ident" id="6209639">srcPos</span>&nbsp;<span class="op" id="6209646">-</span>&nbsp;<span class="ident" id="6209648">s</span><span class="op" id="6209649">.</span><span class="ident" id="6209650">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209664">s</span><span class="op" id="6209665">.</span><span class="ident" id="6209666">ch</span>&nbsp;<span class="op" id="6209669">=</span>&nbsp;<span class="ident" id="6209671">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209675">return</span>&nbsp;<span class="ident" id="6209682">tok</span><br>
<span class="lineno"></span><span class="op" id="6209686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6209689">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="6209752">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="6209821">func</span>&nbsp;<span class="op" id="6209826">(</span><span class="ident" id="6209827">s</span>&nbsp;<span class="op" id="6209829">*</span><span class="ident" id="6209830">Scanner</span><span class="op" id="6209837">)</span>&nbsp;<span class="ident" id="6209839">Pos</span><span class="op" id="6209842">(</span><span class="op" id="6209843">)</span>&nbsp;<span class="op" id="6209845">(</span><span class="ident" id="6209846">pos</span>&nbsp;<span class="ident" id="6209850">Position</span><span class="op" id="6209858">)</span>&nbsp;<span class="op" id="6209860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209863">pos</span><span class="op" id="6209866">.</span><span class="ident" id="6209867">Filename</span>&nbsp;<span class="op" id="6209876">=</span>&nbsp;<span class="ident" id="6209878">s</span><span class="op" id="6209879">.</span><span class="ident" id="6209880">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209890">pos</span><span class="op" id="6209893">.</span><span class="ident" id="6209894">Offset</span>&nbsp;<span class="op" id="6209901">=</span>&nbsp;<span class="ident" id="6209903">s</span><span class="op" id="6209904">.</span><span class="ident" id="6209905">srcBufOffset</span>&nbsp;<span class="op" id="6209918">+</span>&nbsp;<span class="ident" id="6209920">s</span><span class="op" id="6209921">.</span><span class="ident" id="6209922">srcPos</span>&nbsp;<span class="op" id="6209929">-</span>&nbsp;<span class="ident" id="6209931">s</span><span class="op" id="6209932">.</span><span class="ident" id="6209933">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209946">switch</span>&nbsp;<span class="op" id="6209953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209956">case</span>&nbsp;<span class="ident" id="6209961">s</span><span class="op" id="6209962">.</span><span class="ident" id="6209963">column</span>&nbsp;<span class="op" id="6209970">&gt;</span>&nbsp;<span class="num" id="6209972">0</span><span class="op" id="6209973">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6209977">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210025">pos</span><span class="op" id="6210028">.</span><span class="ident" id="6210029">Line</span>&nbsp;<span class="op" id="6210034">=</span>&nbsp;<span class="ident" id="6210036">s</span><span class="op" id="6210037">.</span><span class="ident" id="6210038">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210045">pos</span><span class="op" id="6210048">.</span><span class="ident" id="6210049">Column</span>&nbsp;<span class="op" id="6210056">=</span>&nbsp;<span class="ident" id="6210058">s</span><span class="op" id="6210059">.</span><span class="ident" id="6210060">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210068">case</span>&nbsp;<span class="ident" id="6210073">s</span><span class="op" id="6210074">.</span><span class="ident" id="6210075">lastLineLen</span>&nbsp;<span class="op" id="6210087">&gt;</span>&nbsp;<span class="num" id="6210089">0</span><span class="op" id="6210090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210094">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210125">pos</span><span class="op" id="6210128">.</span><span class="ident" id="6210129">Line</span>&nbsp;<span class="op" id="6210134">=</span>&nbsp;<span class="ident" id="6210136">s</span><span class="op" id="6210137">.</span><span class="ident" id="6210138">line</span>&nbsp;<span class="op" id="6210143">-</span>&nbsp;<span class="num" id="6210145">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210149">pos</span><span class="op" id="6210152">.</span><span class="ident" id="6210153">Column</span>&nbsp;<span class="op" id="6210160">=</span>&nbsp;<span class="ident" id="6210162">s</span><span class="op" id="6210163">.</span><span class="ident" id="6210164">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210177">default</span><span class="op" id="6210184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210188">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210224">pos</span><span class="op" id="6210227">.</span><span class="ident" id="6210228">Line</span>&nbsp;<span class="op" id="6210233">=</span>&nbsp;<span class="num" id="6210235">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210239">pos</span><span class="op" id="6210242">.</span><span class="ident" id="6210243">Column</span>&nbsp;<span class="op" id="6210250">=</span>&nbsp;<span class="num" id="6210252">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210258">return</span><br>
<span class="lineno"></span><span class="op" id="6210265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="6210268">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6210350">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="6210381">func</span>&nbsp;<span class="op" id="6210386">(</span><span class="ident" id="6210387">s</span>&nbsp;<span class="op" id="6210389">*</span><span class="ident" id="6210390">Scanner</span><span class="op" id="6210397">)</span>&nbsp;<span class="ident" id="6210399">TokenText</span><span class="op" id="6210408">(</span><span class="op" id="6210409">)</span>&nbsp;<span class="builtintype" id="6210411">string</span>&nbsp;<span class="op" id="6210418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210421">if</span>&nbsp;<span class="ident" id="6210424">s</span><span class="op" id="6210425">.</span><span class="ident" id="6210426">tokPos</span>&nbsp;<span class="op" id="6210433">&lt;</span>&nbsp;<span class="num" id="6210435">0</span>&nbsp;<span class="op" id="6210437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210441">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210460">return</span>&nbsp;<span class="string" id="6210467">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210475">if</span>&nbsp;<span class="ident" id="6210478">s</span><span class="op" id="6210479">.</span><span class="ident" id="6210480">tokEnd</span>&nbsp;<span class="op" id="6210487">&lt;</span>&nbsp;<span class="num" id="6210489">0</span>&nbsp;<span class="op" id="6210491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210495">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210558">s</span><span class="op" id="6210559">.</span><span class="ident" id="6210560">tokEnd</span>&nbsp;<span class="op" id="6210567">=</span>&nbsp;<span class="ident" id="6210569">s</span><span class="op" id="6210570">.</span><span class="ident" id="6210571">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210583">if</span>&nbsp;<span class="ident" id="6210586">s</span><span class="op" id="6210587">.</span><span class="ident" id="6210588">tokBuf</span><span class="op" id="6210594">.</span><span class="ident" id="6210595">Len</span><span class="op" id="6210598">(</span><span class="op" id="6210599">)</span>&nbsp;<span class="op" id="6210601">==</span>&nbsp;<span class="num" id="6210604">0</span>&nbsp;<span class="op" id="6210606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210610">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210669">return</span>&nbsp;<span class="builtintype" id="6210676">string</span><span class="op" id="6210682">(</span><span class="ident" id="6210683">s</span><span class="op" id="6210684">.</span><span class="ident" id="6210685">srcBuf</span><span class="op" id="6210691">[</span><span class="ident" id="6210692">s</span><span class="op" id="6210693">.</span><span class="ident" id="6210694">tokPos</span><span class="op" id="6210700">:</span><span class="ident" id="6210701">s</span><span class="op" id="6210702">.</span><span class="ident" id="6210703">tokEnd</span><span class="op" id="6210709">]</span><span class="op" id="6210710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210717">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210782">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210824">s</span><span class="op" id="6210825">.</span><span class="ident" id="6210826">tokBuf</span><span class="op" id="6210832">.</span><span class="ident" id="6210833">Write</span><span class="op" id="6210838">(</span><span class="ident" id="6210839">s</span><span class="op" id="6210840">.</span><span class="ident" id="6210841">srcBuf</span><span class="op" id="6210847">[</span><span class="ident" id="6210848">s</span><span class="op" id="6210849">.</span><span class="ident" id="6210850">tokPos</span><span class="op" id="6210856">:</span><span class="ident" id="6210857">s</span><span class="op" id="6210858">.</span><span class="ident" id="6210859">tokEnd</span><span class="op" id="6210865">]</span><span class="op" id="6210866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210869">s</span><span class="op" id="6210870">.</span><span class="ident" id="6210871">tokPos</span>&nbsp;<span class="op" id="6210878">=</span>&nbsp;<span class="ident" id="6210880">s</span><span class="op" id="6210881">.</span><span class="ident" id="6210882">tokEnd</span>&nbsp;<span class="comment" id="6210889">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210932">return</span>&nbsp;<span class="ident" id="6210939">s</span><span class="op" id="6210940">.</span><span class="ident" id="6210941">tokBuf</span><span class="op" id="6210947">.</span><span class="ident" id="6210948">String</span><span class="op" id="6210954">(</span><span class="op" id="6210955">)</span><br>
<span class="lineno"></span><span class="op" id="6210957">}</span>
</div>
</body>
</html>
