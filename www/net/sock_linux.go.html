<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2678242">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2678298">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2678352">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2678403">package</span>&nbsp;<span class="ident" id="2678411">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678416">import</span>&nbsp;<span class="string" id="2678423">&#34;syscall&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678434">func</span>&nbsp;<span class="ident" id="2678439">maxListenerBacklog</span><span class="op" id="2678457">(</span><span class="op" id="2678458">)</span>&nbsp;<span class="builtintype" id="2678460">int</span>&nbsp;<span class="op" id="2678464">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678467">fd</span><span class="op" id="2678469">,</span>&nbsp;<span class="ident" id="2678471">err</span>&nbsp;<span class="op" id="2678475">:=</span>&nbsp;<span class="ident" id="2678478"><a href="/net/parse.go.html#2663938">open</a></span><span class="op" id="2678482">(</span><span class="string" id="2678483">&#34;/proc/sys/net/core/somaxconn&#34;</span><span class="op" id="2678513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678516">if</span>&nbsp;<span class="ident" id="2678519"><a href="/net/sock_linux.go.html#2678471">err</a></span>&nbsp;<span class="op" id="2678523">!=</span>&nbsp;<span class="ident" id="2678526">nil</span>&nbsp;<span class="op" id="2678530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678534">return</span>&nbsp;<span class="ident" id="2678541"><a href="/net/sock_linux.go.html#2678423">syscall</a></span><span class="op" id="2678548">.</span><span class="ident" id="2678549">SOMAXCONN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678563">defer</span>&nbsp;<span class="ident" id="2678569"><a href="/net/sock_linux.go.html#2678467">fd</a></span><span class="op" id="2678571">.</span><span class="builtinfunc" id="2678572">close</span><span class="op" id="2678577">(</span><span class="op" id="2678578">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678581">l</span><span class="op" id="2678582">,</span>&nbsp;<span class="ident" id="2678584">ok</span>&nbsp;<span class="op" id="2678587">:=</span>&nbsp;<span class="ident" id="2678590"><a href="/net/sock_linux.go.html#2678467">fd</a></span><span class="op" id="2678592">.</span><span class="ident" id="2678593">readLine</span><span class="op" id="2678601">(</span><span class="op" id="2678602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678605">if</span>&nbsp;<span class="op" id="2678608">!</span><span class="ident" id="2678609"><a href="/net/sock_linux.go.html#2678584">ok</a></span>&nbsp;<span class="op" id="2678612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678616">return</span>&nbsp;<span class="ident" id="2678623"><a href="/net/sock_linux.go.html#2678423">syscall</a></span><span class="op" id="2678630">.</span><span class="ident" id="2678631">SOMAXCONN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678645">f</span>&nbsp;<span class="op" id="2678647">:=</span>&nbsp;<span class="ident" id="2678650"><a href="/net/parse.go.html#2664774">getFields</a></span><span class="op" id="2678659">(</span><span class="ident" id="2678660"><a href="/net/sock_linux.go.html#2678581">l</a></span><span class="op" id="2678661">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678664">n</span><span class="op" id="2678665">,</span>&nbsp;<span class="ident" id="2678667">_</span><span class="op" id="2678668">,</span>&nbsp;<span class="ident" id="2678670"><a href="/net/sock_linux.go.html#2678584">ok</a></span>&nbsp;<span class="op" id="2678673">:=</span>&nbsp;<span class="ident" id="2678676"><a href="/net/parse.go.html#2665011">dtoi</a></span><span class="op" id="2678680">(</span><span class="ident" id="2678681"><a href="/net/sock_linux.go.html#2678645">f</a></span><span class="op" id="2678682">[</span><span class="num" id="2678683">0</span><span class="op" id="2678684">]</span><span class="op" id="2678685">,</span>&nbsp;<span class="num" id="2678687">0</span><span class="op" id="2678688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678691">if</span>&nbsp;<span class="ident" id="2678694"><a href="/net/sock_linux.go.html#2678664">n</a></span>&nbsp;<span class="op" id="2678696">==</span>&nbsp;<span class="num" id="2678699">0</span>&nbsp;<span class="op" id="2678701">||</span>&nbsp;<span class="op" id="2678704">!</span><span class="ident" id="2678705"><a href="/net/sock_linux.go.html#2678584">ok</a></span>&nbsp;<span class="op" id="2678708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678712">return</span>&nbsp;<span class="ident" id="2678719"><a href="/net/sock_linux.go.html#2678423">syscall</a></span><span class="op" id="2678726">.</span><span class="ident" id="2678727">SOMAXCONN</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2678741">//&nbsp;Linux&nbsp;stores&nbsp;the&nbsp;backlog&nbsp;in&nbsp;a&nbsp;uint16.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2678783">//&nbsp;Truncate&nbsp;number&nbsp;to&nbsp;avoid&nbsp;wrapping.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2678822">//&nbsp;See&nbsp;issue&nbsp;5030.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678842">if</span>&nbsp;<span class="ident" id="2678845"><a href="/net/sock_linux.go.html#2678664">n</a></span>&nbsp;<span class="op" id="2678847">&gt;</span>&nbsp;<span class="num" id="2678849">1</span><span class="op" id="2678850">&lt;&lt;</span><span class="num" id="2678852">16</span><span class="op" id="2678854">-</span><span class="num" id="2678855">1</span>&nbsp;<span class="op" id="2678857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678861"><a href="/net/sock_linux.go.html#2678664">n</a></span>&nbsp;<span class="op" id="2678863">=</span>&nbsp;<span class="num" id="2678865">1</span><span class="op" id="2678866">&lt;&lt;</span><span class="num" id="2678868">16</span>&nbsp;<span class="op" id="2678871">-</span>&nbsp;<span class="num" id="2678873">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678876">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678879">return</span>&nbsp;<span class="ident" id="2678886"><a href="/net/sock_linux.go.html#2678664">n</a></span><br>
<span class="lineno"></span><span class="op" id="2678888">}</span>
</div>
</body>
</html>
