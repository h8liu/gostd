<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5021336">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5021391">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5021445">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5021496">package</span>&nbsp;<span class="ident" id="5021504">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5021510">import</span>&nbsp;<span class="op" id="5021517">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021520">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021529">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021536">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021543">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021550">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021561">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5021572">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5021579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5021582">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="5021636">//</span><br>
<span class="lineno"></span><span class="comment" id="5021639">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5021681">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5021758">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="5021816">type</span>&nbsp;<span class="ident" id="5021821">Cookie</span>&nbsp;<span class="keyword" id="5021828">struct</span>&nbsp;<span class="op" id="5021835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021838">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5021849">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021857">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5021868">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021876">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5021887">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021895">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5021906">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021914">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5021925">time</span><span class="op" id="5021929">.</span><span class="ident" id="5021930">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021936">RawExpires</span>&nbsp;<span class="builtintype" id="5021947">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021956">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022009">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022073">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022139">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5022148">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022153">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5022162">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022168">HttpOnly</span>&nbsp;<span class="builtintype" id="5022177">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022183">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5022192">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022200">Unparsed</span>&nbsp;<span class="op" id="5022209">[</span><span class="op" id="5022210">]</span><span class="builtintype" id="5022211">string</span>&nbsp;<span class="comment" id="5022218">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="5022264">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="5022267">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5022321">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="5022382">func</span>&nbsp;<span class="ident" id="5022387">readSetCookies</span><span class="op" id="5022401">(</span><span class="ident" id="5022402">h</span>&nbsp;<span class="ident" id="5022404">Header</span><span class="op" id="5022410">)</span>&nbsp;<span class="op" id="5022412">[</span><span class="op" id="5022413">]</span><span class="op" id="5022414">*</span><span class="ident" id="5022415">Cookie</span>&nbsp;<span class="op" id="5022422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022425">cookies</span>&nbsp;<span class="op" id="5022433">:=</span>&nbsp;<span class="op" id="5022436">[</span><span class="op" id="5022437">]</span><span class="op" id="5022438">*</span><span class="ident" id="5022439">Cookie</span><span class="op" id="5022445">{</span><span class="op" id="5022446">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022449">for</span>&nbsp;<span class="ident" id="5022453">_</span><span class="op" id="5022454">,</span>&nbsp;<span class="ident" id="5022456">line</span>&nbsp;<span class="op" id="5022461">:=</span>&nbsp;<span class="keyword" id="5022464">range</span>&nbsp;<span class="ident" id="5022470">h</span><span class="op" id="5022471">[</span><span class="string" id="5022472">&#34;Set-Cookie&#34;</span><span class="op" id="5022484">]</span>&nbsp;<span class="op" id="5022486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022490">parts</span>&nbsp;<span class="op" id="5022496">:=</span>&nbsp;<span class="ident" id="5022499">strings</span><span class="op" id="5022506">.</span><span class="ident" id="5022507">Split</span><span class="op" id="5022512">(</span><span class="ident" id="5022513">strings</span><span class="op" id="5022520">.</span><span class="ident" id="5022521">TrimSpace</span><span class="op" id="5022530">(</span><span class="ident" id="5022531">line</span><span class="op" id="5022535">)</span><span class="op" id="5022536">,</span>&nbsp;<span class="string" id="5022538">&#34;;&#34;</span><span class="op" id="5022541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022545">if</span>&nbsp;<span class="builtinfunc" id="5022548">len</span><span class="op" id="5022551">(</span><span class="ident" id="5022552">parts</span><span class="op" id="5022557">)</span>&nbsp;<span class="op" id="5022559">==</span>&nbsp;<span class="num" id="5022562">1</span>&nbsp;<span class="op" id="5022564">&amp;&amp;</span>&nbsp;<span class="ident" id="5022567">parts</span><span class="op" id="5022572">[</span><span class="num" id="5022573">0</span><span class="op" id="5022574">]</span>&nbsp;<span class="op" id="5022576">==</span>&nbsp;<span class="string" id="5022579">&#34;&#34;</span>&nbsp;<span class="op" id="5022582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022587">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5022598">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022602">parts</span><span class="op" id="5022607">[</span><span class="num" id="5022608">0</span><span class="op" id="5022609">]</span>&nbsp;<span class="op" id="5022611">=</span>&nbsp;<span class="ident" id="5022613">strings</span><span class="op" id="5022620">.</span><span class="ident" id="5022621">TrimSpace</span><span class="op" id="5022630">(</span><span class="ident" id="5022631">parts</span><span class="op" id="5022636">[</span><span class="num" id="5022637">0</span><span class="op" id="5022638">]</span><span class="op" id="5022639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022643">j</span>&nbsp;<span class="op" id="5022645">:=</span>&nbsp;<span class="ident" id="5022648">strings</span><span class="op" id="5022655">.</span><span class="ident" id="5022656">Index</span><span class="op" id="5022661">(</span><span class="ident" id="5022662">parts</span><span class="op" id="5022667">[</span><span class="num" id="5022668">0</span><span class="op" id="5022669">]</span><span class="op" id="5022670">,</span>&nbsp;<span class="string" id="5022672">&#34;=&#34;</span><span class="op" id="5022675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022679">if</span>&nbsp;<span class="ident" id="5022682">j</span>&nbsp;<span class="op" id="5022684">&lt;</span>&nbsp;<span class="num" id="5022686">0</span>&nbsp;<span class="op" id="5022688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022693">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5022704">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022708">name</span><span class="op" id="5022712">,</span>&nbsp;<span class="ident" id="5022714">value</span>&nbsp;<span class="op" id="5022720">:=</span>&nbsp;<span class="ident" id="5022723">parts</span><span class="op" id="5022728">[</span><span class="num" id="5022729">0</span><span class="op" id="5022730">]</span><span class="op" id="5022731">[</span><span class="op" id="5022732">:</span><span class="ident" id="5022733">j</span><span class="op" id="5022734">]</span><span class="op" id="5022735">,</span>&nbsp;<span class="ident" id="5022737">parts</span><span class="op" id="5022742">[</span><span class="num" id="5022743">0</span><span class="op" id="5022744">]</span><span class="op" id="5022745">[</span><span class="ident" id="5022746">j</span><span class="op" id="5022747">+</span><span class="num" id="5022748">1</span><span class="op" id="5022749">:</span><span class="op" id="5022750">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022754">if</span>&nbsp;<span class="op" id="5022757">!</span><span class="ident" id="5022758">isCookieNameValid</span><span class="op" id="5022775">(</span><span class="ident" id="5022776">name</span><span class="op" id="5022780">)</span>&nbsp;<span class="op" id="5022782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022787">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5022798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022802">value</span><span class="op" id="5022807">,</span>&nbsp;<span class="ident" id="5022809">success</span>&nbsp;<span class="op" id="5022817">:=</span>&nbsp;<span class="ident" id="5022820">parseCookieValue</span><span class="op" id="5022836">(</span><span class="ident" id="5022837">value</span><span class="op" id="5022842">,</span>&nbsp;<span class="builtintype" id="5022844">true</span><span class="op" id="5022848">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022852">if</span>&nbsp;<span class="op" id="5022855">!</span><span class="ident" id="5022856">success</span>&nbsp;<span class="op" id="5022864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022869">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5022880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022884">c</span>&nbsp;<span class="op" id="5022886">:=</span>&nbsp;<span class="op" id="5022889">&amp;</span><span class="ident" id="5022890">Cookie</span><span class="op" id="5022896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022901">Name</span><span class="op" id="5022905">:</span>&nbsp;&nbsp;<span class="ident" id="5022908">name</span><span class="op" id="5022912">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022917">Value</span><span class="op" id="5022922">:</span>&nbsp;<span class="ident" id="5022924">value</span><span class="op" id="5022929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022934">Raw</span><span class="op" id="5022937">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5022941">line</span><span class="op" id="5022945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5022949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5022953">for</span>&nbsp;<span class="ident" id="5022957">i</span>&nbsp;<span class="op" id="5022959">:=</span>&nbsp;<span class="num" id="5022962">1</span><span class="op" id="5022963">;</span>&nbsp;<span class="ident" id="5022965">i</span>&nbsp;<span class="op" id="5022967">&lt;</span>&nbsp;<span class="builtinfunc" id="5022969">len</span><span class="op" id="5022972">(</span><span class="ident" id="5022973">parts</span><span class="op" id="5022978">)</span><span class="op" id="5022979">;</span>&nbsp;<span class="ident" id="5022981">i</span><span class="op" id="5022982">++</span>&nbsp;<span class="op" id="5022985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022990">parts</span><span class="op" id="5022995">[</span><span class="ident" id="5022996">i</span><span class="op" id="5022997">]</span>&nbsp;<span class="op" id="5022999">=</span>&nbsp;<span class="ident" id="5023001">strings</span><span class="op" id="5023008">.</span><span class="ident" id="5023009">TrimSpace</span><span class="op" id="5023018">(</span><span class="ident" id="5023019">parts</span><span class="op" id="5023024">[</span><span class="ident" id="5023025">i</span><span class="op" id="5023026">]</span><span class="op" id="5023027">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023032">if</span>&nbsp;<span class="builtinfunc" id="5023035">len</span><span class="op" id="5023038">(</span><span class="ident" id="5023039">parts</span><span class="op" id="5023044">[</span><span class="ident" id="5023045">i</span><span class="op" id="5023046">]</span><span class="op" id="5023047">)</span>&nbsp;<span class="op" id="5023049">==</span>&nbsp;<span class="num" id="5023052">0</span>&nbsp;<span class="op" id="5023054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023060">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023078">attr</span><span class="op" id="5023082">,</span>&nbsp;<span class="ident" id="5023084">val</span>&nbsp;<span class="op" id="5023088">:=</span>&nbsp;<span class="ident" id="5023091">parts</span><span class="op" id="5023096">[</span><span class="ident" id="5023097">i</span><span class="op" id="5023098">]</span><span class="op" id="5023099">,</span>&nbsp;<span class="string" id="5023101">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023107">if</span>&nbsp;<span class="ident" id="5023110">j</span>&nbsp;<span class="op" id="5023112">:=</span>&nbsp;<span class="ident" id="5023115">strings</span><span class="op" id="5023122">.</span><span class="ident" id="5023123">Index</span><span class="op" id="5023128">(</span><span class="ident" id="5023129">attr</span><span class="op" id="5023133">,</span>&nbsp;<span class="string" id="5023135">&#34;=&#34;</span><span class="op" id="5023138">)</span><span class="op" id="5023139">;</span>&nbsp;<span class="ident" id="5023141">j</span>&nbsp;<span class="op" id="5023143">&gt;=</span>&nbsp;<span class="num" id="5023146">0</span>&nbsp;<span class="op" id="5023148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023154">attr</span><span class="op" id="5023158">,</span>&nbsp;<span class="ident" id="5023160">val</span>&nbsp;<span class="op" id="5023164">=</span>&nbsp;<span class="ident" id="5023166">attr</span><span class="op" id="5023170">[</span><span class="op" id="5023171">:</span><span class="ident" id="5023172">j</span><span class="op" id="5023173">]</span><span class="op" id="5023174">,</span>&nbsp;<span class="ident" id="5023176">attr</span><span class="op" id="5023180">[</span><span class="ident" id="5023181">j</span><span class="op" id="5023182">+</span><span class="num" id="5023183">1</span><span class="op" id="5023184">:</span><span class="op" id="5023185">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023195">lowerAttr</span>&nbsp;<span class="op" id="5023205">:=</span>&nbsp;<span class="ident" id="5023208">strings</span><span class="op" id="5023215">.</span><span class="ident" id="5023216">ToLower</span><span class="op" id="5023223">(</span><span class="ident" id="5023224">attr</span><span class="op" id="5023228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023233">val</span><span class="op" id="5023236">,</span>&nbsp;<span class="ident" id="5023238">success</span>&nbsp;<span class="op" id="5023246">=</span>&nbsp;<span class="ident" id="5023248">parseCookieValue</span><span class="op" id="5023264">(</span><span class="ident" id="5023265">val</span><span class="op" id="5023268">,</span>&nbsp;<span class="builtintype" id="5023270">false</span><span class="op" id="5023275">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023280">if</span>&nbsp;<span class="op" id="5023283">!</span><span class="ident" id="5023284">success</span>&nbsp;<span class="op" id="5023292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023298">c</span><span class="op" id="5023299">.</span><span class="ident" id="5023300">Unparsed</span>&nbsp;<span class="op" id="5023309">=</span>&nbsp;<span class="builtinfunc" id="5023311">append</span><span class="op" id="5023317">(</span><span class="ident" id="5023318">c</span><span class="op" id="5023319">.</span><span class="ident" id="5023320">Unparsed</span><span class="op" id="5023328">,</span>&nbsp;<span class="ident" id="5023330">parts</span><span class="op" id="5023335">[</span><span class="ident" id="5023336">i</span><span class="op" id="5023337">]</span><span class="op" id="5023338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023344">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023361">switch</span>&nbsp;<span class="ident" id="5023368">lowerAttr</span>&nbsp;<span class="op" id="5023378">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023383">case</span>&nbsp;<span class="string" id="5023388">&#34;secure&#34;</span><span class="op" id="5023396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023402">c</span><span class="op" id="5023403">.</span><span class="ident" id="5023404">Secure</span>&nbsp;<span class="op" id="5023411">=</span>&nbsp;<span class="builtintype" id="5023413">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023422">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023434">case</span>&nbsp;<span class="string" id="5023439">&#34;httponly&#34;</span><span class="op" id="5023449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023455">c</span><span class="op" id="5023456">.</span><span class="ident" id="5023457">HttpOnly</span>&nbsp;<span class="op" id="5023466">=</span>&nbsp;<span class="builtintype" id="5023468">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023477">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023489">case</span>&nbsp;<span class="string" id="5023494">&#34;domain&#34;</span><span class="op" id="5023502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023508">c</span><span class="op" id="5023509">.</span><span class="ident" id="5023510">Domain</span>&nbsp;<span class="op" id="5023517">=</span>&nbsp;<span class="ident" id="5023519">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023527">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023539">case</span>&nbsp;<span class="string" id="5023544">&#34;max-age&#34;</span><span class="op" id="5023553">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023559">secs</span><span class="op" id="5023563">,</span>&nbsp;<span class="ident" id="5023565">err</span>&nbsp;<span class="op" id="5023569">:=</span>&nbsp;<span class="ident" id="5023572">strconv</span><span class="op" id="5023579">.</span><span class="ident" id="5023580">Atoi</span><span class="op" id="5023584">(</span><span class="ident" id="5023585">val</span><span class="op" id="5023588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023594">if</span>&nbsp;<span class="ident" id="5023597">err</span>&nbsp;<span class="op" id="5023601">!=</span>&nbsp;<span class="ident" id="5023604">nil</span>&nbsp;<span class="op" id="5023608">||</span>&nbsp;<span class="ident" id="5023611">secs</span>&nbsp;<span class="op" id="5023616">!=</span>&nbsp;<span class="num" id="5023619">0</span>&nbsp;<span class="op" id="5023621">&amp;&amp;</span>&nbsp;<span class="ident" id="5023624">val</span><span class="op" id="5023627">[</span><span class="num" id="5023628">0</span><span class="op" id="5023629">]</span>&nbsp;<span class="op" id="5023631">==</span>&nbsp;<span class="string" id="5023634">&#39;0&#39;</span>&nbsp;<span class="op" id="5023638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023645">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023661">if</span>&nbsp;<span class="ident" id="5023664">secs</span>&nbsp;<span class="op" id="5023669">&lt;=</span>&nbsp;<span class="num" id="5023672">0</span>&nbsp;<span class="op" id="5023674">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023681">c</span><span class="op" id="5023682">.</span><span class="ident" id="5023683">MaxAge</span>&nbsp;<span class="op" id="5023690">=</span>&nbsp;<span class="op" id="5023692">-</span><span class="num" id="5023693">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023699">}</span>&nbsp;<span class="keyword" id="5023701">else</span>&nbsp;<span class="op" id="5023706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023713">c</span><span class="op" id="5023714">.</span><span class="ident" id="5023715">MaxAge</span>&nbsp;<span class="op" id="5023722">=</span>&nbsp;<span class="ident" id="5023724">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023739">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023751">case</span>&nbsp;<span class="string" id="5023756">&#34;expires&#34;</span><span class="op" id="5023765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023771">c</span><span class="op" id="5023772">.</span><span class="ident" id="5023773">RawExpires</span>&nbsp;<span class="op" id="5023784">=</span>&nbsp;<span class="ident" id="5023786">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023794">exptime</span><span class="op" id="5023801">,</span>&nbsp;<span class="ident" id="5023803">err</span>&nbsp;<span class="op" id="5023807">:=</span>&nbsp;<span class="ident" id="5023810">time</span><span class="op" id="5023814">.</span><span class="ident" id="5023815">Parse</span><span class="op" id="5023820">(</span><span class="ident" id="5023821">time</span><span class="op" id="5023825">.</span><span class="ident" id="5023826">RFC1123</span><span class="op" id="5023833">,</span>&nbsp;<span class="ident" id="5023835">val</span><span class="op" id="5023838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023844">if</span>&nbsp;<span class="ident" id="5023847">err</span>&nbsp;<span class="op" id="5023851">!=</span>&nbsp;<span class="ident" id="5023854">nil</span>&nbsp;<span class="op" id="5023858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023865">exptime</span><span class="op" id="5023872">,</span>&nbsp;<span class="ident" id="5023874">err</span>&nbsp;<span class="op" id="5023878">=</span>&nbsp;<span class="ident" id="5023880">time</span><span class="op" id="5023884">.</span><span class="ident" id="5023885">Parse</span><span class="op" id="5023890">(</span><span class="string" id="5023891">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="5023922">,</span>&nbsp;<span class="ident" id="5023924">val</span><span class="op" id="5023927">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023934">if</span>&nbsp;<span class="ident" id="5023937">err</span>&nbsp;<span class="op" id="5023941">!=</span>&nbsp;<span class="ident" id="5023944">nil</span>&nbsp;<span class="op" id="5023948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023956">c</span><span class="op" id="5023957">.</span><span class="ident" id="5023958">Expires</span>&nbsp;<span class="op" id="5023966">=</span>&nbsp;<span class="ident" id="5023968">time</span><span class="op" id="5023972">.</span><span class="ident" id="5023973">Time</span><span class="op" id="5023977">{</span><span class="op" id="5023978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023986">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5024003">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024009">c</span><span class="op" id="5024010">.</span><span class="ident" id="5024011">Expires</span>&nbsp;<span class="op" id="5024019">=</span>&nbsp;<span class="ident" id="5024021">exptime</span><span class="op" id="5024028">.</span><span class="ident" id="5024029">UTC</span><span class="op" id="5024032">(</span><span class="op" id="5024033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024039">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024051">case</span>&nbsp;<span class="string" id="5024056">&#34;path&#34;</span><span class="op" id="5024062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024068">c</span><span class="op" id="5024069">.</span><span class="ident" id="5024070">Path</span>&nbsp;<span class="op" id="5024075">=</span>&nbsp;<span class="ident" id="5024077">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024085">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5024097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024102">c</span><span class="op" id="5024103">.</span><span class="ident" id="5024104">Unparsed</span>&nbsp;<span class="op" id="5024113">=</span>&nbsp;<span class="builtinfunc" id="5024115">append</span><span class="op" id="5024121">(</span><span class="ident" id="5024122">c</span><span class="op" id="5024123">.</span><span class="ident" id="5024124">Unparsed</span><span class="op" id="5024132">,</span>&nbsp;<span class="ident" id="5024134">parts</span><span class="op" id="5024139">[</span><span class="ident" id="5024140">i</span><span class="op" id="5024141">]</span><span class="op" id="5024142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5024146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024150">cookies</span>&nbsp;<span class="op" id="5024158">=</span>&nbsp;<span class="builtinfunc" id="5024160">append</span><span class="op" id="5024166">(</span><span class="ident" id="5024167">cookies</span><span class="op" id="5024174">,</span>&nbsp;<span class="ident" id="5024176">c</span><span class="op" id="5024177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5024180">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024183">return</span>&nbsp;<span class="ident" id="5024190">cookies</span><br>
<span class="lineno"></span><span class="op" id="5024198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5024201">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="5024281">func</span>&nbsp;<span class="ident" id="5024286">SetCookie</span><span class="op" id="5024295">(</span><span class="ident" id="5024296">w</span>&nbsp;<span class="ident" id="5024298">ResponseWriter</span><span class="op" id="5024312">,</span>&nbsp;<span class="ident" id="5024314">cookie</span>&nbsp;<span class="op" id="5024321">*</span><span class="ident" id="5024322">Cookie</span><span class="op" id="5024328">)</span>&nbsp;<span class="op" id="5024330">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024333">w</span><span class="op" id="5024334">.</span><span class="ident" id="5024335">Header</span><span class="op" id="5024341">(</span><span class="op" id="5024342">)</span><span class="op" id="5024343">.</span><span class="ident" id="5024344">Add</span><span class="op" id="5024347">(</span><span class="string" id="5024348">&#34;Set-Cookie&#34;</span><span class="op" id="5024360">,</span>&nbsp;<span class="ident" id="5024362">cookie</span><span class="op" id="5024368">.</span><span class="ident" id="5024369">String</span><span class="op" id="5024375">(</span><span class="op" id="5024376">)</span><span class="op" id="5024377">)</span><br>
<span class="lineno"></span><span class="op" id="5024379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5024382">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="5024452">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="5024520">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="5024557">func</span>&nbsp;<span class="op" id="5024562">(</span><span class="ident" id="5024563">c</span>&nbsp;<span class="op" id="5024565">*</span><span class="ident" id="5024566">Cookie</span><span class="op" id="5024572">)</span>&nbsp;<span class="ident" id="5024574">String</span><span class="op" id="5024580">(</span><span class="op" id="5024581">)</span>&nbsp;<span class="builtintype" id="5024583">string</span>&nbsp;<span class="op" id="5024590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024593">var</span>&nbsp;<span class="ident" id="5024597">b</span>&nbsp;<span class="ident" id="5024599">bytes</span><span class="op" id="5024604">.</span><span class="ident" id="5024605">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024613">fmt</span><span class="op" id="5024616">.</span><span class="ident" id="5024617">Fprintf</span><span class="op" id="5024624">(</span><span class="op" id="5024625">&amp;</span><span class="ident" id="5024626">b</span><span class="op" id="5024627">,</span>&nbsp;<span class="string" id="5024629">&#34;%s=%s&#34;</span><span class="op" id="5024636">,</span>&nbsp;<span class="ident" id="5024638">sanitizeCookieName</span><span class="op" id="5024656">(</span><span class="ident" id="5024657">c</span><span class="op" id="5024658">.</span><span class="ident" id="5024659">Name</span><span class="op" id="5024663">)</span><span class="op" id="5024664">,</span>&nbsp;<span class="ident" id="5024666">sanitizeCookieValue</span><span class="op" id="5024685">(</span><span class="ident" id="5024686">c</span><span class="op" id="5024687">.</span><span class="ident" id="5024688">Value</span><span class="op" id="5024693">)</span><span class="op" id="5024694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024697">if</span>&nbsp;<span class="builtinfunc" id="5024700">len</span><span class="op" id="5024703">(</span><span class="ident" id="5024704">c</span><span class="op" id="5024705">.</span><span class="ident" id="5024706">Path</span><span class="op" id="5024710">)</span>&nbsp;<span class="op" id="5024712">&gt;</span>&nbsp;<span class="num" id="5024714">0</span>&nbsp;<span class="op" id="5024716">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024720">fmt</span><span class="op" id="5024723">.</span><span class="ident" id="5024724">Fprintf</span><span class="op" id="5024731">(</span><span class="op" id="5024732">&amp;</span><span class="ident" id="5024733">b</span><span class="op" id="5024734">,</span>&nbsp;<span class="string" id="5024736">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="5024747">,</span>&nbsp;<span class="ident" id="5024749">sanitizeCookiePath</span><span class="op" id="5024767">(</span><span class="ident" id="5024768">c</span><span class="op" id="5024769">.</span><span class="ident" id="5024770">Path</span><span class="op" id="5024774">)</span><span class="op" id="5024775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5024778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024781">if</span>&nbsp;<span class="builtinfunc" id="5024784">len</span><span class="op" id="5024787">(</span><span class="ident" id="5024788">c</span><span class="op" id="5024789">.</span><span class="ident" id="5024790">Domain</span><span class="op" id="5024796">)</span>&nbsp;<span class="op" id="5024798">&gt;</span>&nbsp;<span class="num" id="5024800">0</span>&nbsp;<span class="op" id="5024802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024806">if</span>&nbsp;<span class="ident" id="5024809">validCookieDomain</span><span class="op" id="5024826">(</span><span class="ident" id="5024827">c</span><span class="op" id="5024828">.</span><span class="ident" id="5024829">Domain</span><span class="op" id="5024835">)</span>&nbsp;<span class="op" id="5024837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024842">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024896">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024954">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025007">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025032">d</span>&nbsp;<span class="op" id="5025034">:=</span>&nbsp;<span class="ident" id="5025037">c</span><span class="op" id="5025038">.</span><span class="ident" id="5025039">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025049">if</span>&nbsp;<span class="ident" id="5025052">d</span><span class="op" id="5025053">[</span><span class="num" id="5025054">0</span><span class="op" id="5025055">]</span>&nbsp;<span class="op" id="5025057">==</span>&nbsp;<span class="string" id="5025060">&#39;.&#39;</span>&nbsp;<span class="op" id="5025064">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025070">d</span>&nbsp;<span class="op" id="5025072">=</span>&nbsp;<span class="ident" id="5025074">d</span><span class="op" id="5025075">[</span><span class="num" id="5025076">1</span><span class="op" id="5025077">:</span><span class="op" id="5025078">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025088">fmt</span><span class="op" id="5025091">.</span><span class="ident" id="5025092">Fprintf</span><span class="op" id="5025099">(</span><span class="op" id="5025100">&amp;</span><span class="ident" id="5025101">b</span><span class="op" id="5025102">,</span>&nbsp;<span class="string" id="5025104">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="5025117">,</span>&nbsp;<span class="ident" id="5025119">d</span><span class="op" id="5025120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025124">}</span>&nbsp;<span class="keyword" id="5025126">else</span>&nbsp;<span class="op" id="5025131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025136">log</span><span class="op" id="5025139">.</span><span class="ident" id="5025140">Printf</span><span class="op" id="5025146">(</span><span class="string" id="5025147">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="5025210">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025216">c</span><span class="op" id="5025217">.</span><span class="ident" id="5025218">Domain</span><span class="op" id="5025224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025234">if</span>&nbsp;<span class="ident" id="5025237">c</span><span class="op" id="5025238">.</span><span class="ident" id="5025239">Expires</span><span class="op" id="5025246">.</span><span class="ident" id="5025247">Unix</span><span class="op" id="5025251">(</span><span class="op" id="5025252">)</span>&nbsp;<span class="op" id="5025254">&gt;</span>&nbsp;<span class="num" id="5025256">0</span>&nbsp;<span class="op" id="5025258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025262">fmt</span><span class="op" id="5025265">.</span><span class="ident" id="5025266">Fprintf</span><span class="op" id="5025273">(</span><span class="op" id="5025274">&amp;</span><span class="ident" id="5025275">b</span><span class="op" id="5025276">,</span>&nbsp;<span class="string" id="5025278">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="5025292">,</span>&nbsp;<span class="ident" id="5025294">c</span><span class="op" id="5025295">.</span><span class="ident" id="5025296">Expires</span><span class="op" id="5025303">.</span><span class="ident" id="5025304">UTC</span><span class="op" id="5025307">(</span><span class="op" id="5025308">)</span><span class="op" id="5025309">.</span><span class="ident" id="5025310">Format</span><span class="op" id="5025316">(</span><span class="ident" id="5025317">time</span><span class="op" id="5025321">.</span><span class="ident" id="5025322">RFC1123</span><span class="op" id="5025329">)</span><span class="op" id="5025330">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025336">if</span>&nbsp;<span class="ident" id="5025339">c</span><span class="op" id="5025340">.</span><span class="ident" id="5025341">MaxAge</span>&nbsp;<span class="op" id="5025348">&gt;</span>&nbsp;<span class="num" id="5025350">0</span>&nbsp;<span class="op" id="5025352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025356">fmt</span><span class="op" id="5025359">.</span><span class="ident" id="5025360">Fprintf</span><span class="op" id="5025367">(</span><span class="op" id="5025368">&amp;</span><span class="ident" id="5025369">b</span><span class="op" id="5025370">,</span>&nbsp;<span class="string" id="5025372">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="5025386">,</span>&nbsp;<span class="ident" id="5025388">c</span><span class="op" id="5025389">.</span><span class="ident" id="5025390">MaxAge</span><span class="op" id="5025396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025399">}</span>&nbsp;<span class="keyword" id="5025401">else</span>&nbsp;<span class="keyword" id="5025406">if</span>&nbsp;<span class="ident" id="5025409">c</span><span class="op" id="5025410">.</span><span class="ident" id="5025411">MaxAge</span>&nbsp;<span class="op" id="5025418">&lt;</span>&nbsp;<span class="num" id="5025420">0</span>&nbsp;<span class="op" id="5025422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025426">fmt</span><span class="op" id="5025429">.</span><span class="ident" id="5025430">Fprintf</span><span class="op" id="5025437">(</span><span class="op" id="5025438">&amp;</span><span class="ident" id="5025439">b</span><span class="op" id="5025440">,</span>&nbsp;<span class="string" id="5025442">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="5025455">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025461">if</span>&nbsp;<span class="ident" id="5025464">c</span><span class="op" id="5025465">.</span><span class="ident" id="5025466">HttpOnly</span>&nbsp;<span class="op" id="5025475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025479">fmt</span><span class="op" id="5025482">.</span><span class="ident" id="5025483">Fprintf</span><span class="op" id="5025490">(</span><span class="op" id="5025491">&amp;</span><span class="ident" id="5025492">b</span><span class="op" id="5025493">,</span>&nbsp;<span class="string" id="5025495">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="5025507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025513">if</span>&nbsp;<span class="ident" id="5025516">c</span><span class="op" id="5025517">.</span><span class="ident" id="5025518">Secure</span>&nbsp;<span class="op" id="5025525">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025529">fmt</span><span class="op" id="5025532">.</span><span class="ident" id="5025533">Fprintf</span><span class="op" id="5025540">(</span><span class="op" id="5025541">&amp;</span><span class="ident" id="5025542">b</span><span class="op" id="5025543">,</span>&nbsp;<span class="string" id="5025545">&#34;;&nbsp;Secure&#34;</span><span class="op" id="5025555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025561">return</span>&nbsp;<span class="ident" id="5025568">b</span><span class="op" id="5025569">.</span><span class="ident" id="5025570">String</span><span class="op" id="5025576">(</span><span class="op" id="5025577">)</span><br>
<span class="lineno"></span><span class="op" id="5025579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="5025582">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5025646">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="5025690">//</span><br>
<span class="lineno"></span><span class="comment" id="5025693">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="5025758">func</span>&nbsp;<span class="ident" id="5025763">readCookies</span><span class="op" id="5025774">(</span><span class="ident" id="5025775">h</span>&nbsp;<span class="ident" id="5025777">Header</span><span class="op" id="5025783">,</span>&nbsp;<span class="ident" id="5025785">filter</span>&nbsp;<span class="builtintype" id="5025792">string</span><span class="op" id="5025798">)</span>&nbsp;<span class="op" id="5025800">[</span><span class="op" id="5025801">]</span><span class="op" id="5025802">*</span><span class="ident" id="5025803">Cookie</span>&nbsp;<span class="op" id="5025810">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025813">cookies</span>&nbsp;<span class="op" id="5025821">:=</span>&nbsp;<span class="op" id="5025824">[</span><span class="op" id="5025825">]</span><span class="op" id="5025826">*</span><span class="ident" id="5025827">Cookie</span><span class="op" id="5025833">{</span><span class="op" id="5025834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025837">lines</span><span class="op" id="5025842">,</span>&nbsp;<span class="ident" id="5025844">ok</span>&nbsp;<span class="op" id="5025847">:=</span>&nbsp;<span class="ident" id="5025850">h</span><span class="op" id="5025851">[</span><span class="string" id="5025852">&#34;Cookie&#34;</span><span class="op" id="5025860">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025863">if</span>&nbsp;<span class="op" id="5025866">!</span><span class="ident" id="5025867">ok</span>&nbsp;<span class="op" id="5025870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025874">return</span>&nbsp;<span class="ident" id="5025881">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025890">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025894">for</span>&nbsp;<span class="ident" id="5025898">_</span><span class="op" id="5025899">,</span>&nbsp;<span class="ident" id="5025901">line</span>&nbsp;<span class="op" id="5025906">:=</span>&nbsp;<span class="keyword" id="5025909">range</span>&nbsp;<span class="ident" id="5025915">lines</span>&nbsp;<span class="op" id="5025921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025925">parts</span>&nbsp;<span class="op" id="5025931">:=</span>&nbsp;<span class="ident" id="5025934">strings</span><span class="op" id="5025941">.</span><span class="ident" id="5025942">Split</span><span class="op" id="5025947">(</span><span class="ident" id="5025948">strings</span><span class="op" id="5025955">.</span><span class="ident" id="5025956">TrimSpace</span><span class="op" id="5025965">(</span><span class="ident" id="5025966">line</span><span class="op" id="5025970">)</span><span class="op" id="5025971">,</span>&nbsp;<span class="string" id="5025973">&#34;;&#34;</span><span class="op" id="5025976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025980">if</span>&nbsp;<span class="builtinfunc" id="5025983">len</span><span class="op" id="5025986">(</span><span class="ident" id="5025987">parts</span><span class="op" id="5025992">)</span>&nbsp;<span class="op" id="5025994">==</span>&nbsp;<span class="num" id="5025997">1</span>&nbsp;<span class="op" id="5025999">&amp;&amp;</span>&nbsp;<span class="ident" id="5026002">parts</span><span class="op" id="5026007">[</span><span class="num" id="5026008">0</span><span class="op" id="5026009">]</span>&nbsp;<span class="op" id="5026011">==</span>&nbsp;<span class="string" id="5026014">&#34;&#34;</span>&nbsp;<span class="op" id="5026017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026022">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5026037">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026062">parsedPairs</span>&nbsp;<span class="op" id="5026074">:=</span>&nbsp;<span class="num" id="5026077">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026081">for</span>&nbsp;<span class="ident" id="5026085">i</span>&nbsp;<span class="op" id="5026087">:=</span>&nbsp;<span class="num" id="5026090">0</span><span class="op" id="5026091">;</span>&nbsp;<span class="ident" id="5026093">i</span>&nbsp;<span class="op" id="5026095">&lt;</span>&nbsp;<span class="builtinfunc" id="5026097">len</span><span class="op" id="5026100">(</span><span class="ident" id="5026101">parts</span><span class="op" id="5026106">)</span><span class="op" id="5026107">;</span>&nbsp;<span class="ident" id="5026109">i</span><span class="op" id="5026110">++</span>&nbsp;<span class="op" id="5026113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026118">parts</span><span class="op" id="5026123">[</span><span class="ident" id="5026124">i</span><span class="op" id="5026125">]</span>&nbsp;<span class="op" id="5026127">=</span>&nbsp;<span class="ident" id="5026129">strings</span><span class="op" id="5026136">.</span><span class="ident" id="5026137">TrimSpace</span><span class="op" id="5026146">(</span><span class="ident" id="5026147">parts</span><span class="op" id="5026152">[</span><span class="ident" id="5026153">i</span><span class="op" id="5026154">]</span><span class="op" id="5026155">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026160">if</span>&nbsp;<span class="builtinfunc" id="5026163">len</span><span class="op" id="5026166">(</span><span class="ident" id="5026167">parts</span><span class="op" id="5026172">[</span><span class="ident" id="5026173">i</span><span class="op" id="5026174">]</span><span class="op" id="5026175">)</span>&nbsp;<span class="op" id="5026177">==</span>&nbsp;<span class="num" id="5026180">0</span>&nbsp;<span class="op" id="5026182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026188">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026205">name</span><span class="op" id="5026209">,</span>&nbsp;<span class="ident" id="5026211">val</span>&nbsp;<span class="op" id="5026215">:=</span>&nbsp;<span class="ident" id="5026218">parts</span><span class="op" id="5026223">[</span><span class="ident" id="5026224">i</span><span class="op" id="5026225">]</span><span class="op" id="5026226">,</span>&nbsp;<span class="string" id="5026228">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026234">if</span>&nbsp;<span class="ident" id="5026237">j</span>&nbsp;<span class="op" id="5026239">:=</span>&nbsp;<span class="ident" id="5026242">strings</span><span class="op" id="5026249">.</span><span class="ident" id="5026250">Index</span><span class="op" id="5026255">(</span><span class="ident" id="5026256">name</span><span class="op" id="5026260">,</span>&nbsp;<span class="string" id="5026262">&#34;=&#34;</span><span class="op" id="5026265">)</span><span class="op" id="5026266">;</span>&nbsp;<span class="ident" id="5026268">j</span>&nbsp;<span class="op" id="5026270">&gt;=</span>&nbsp;<span class="num" id="5026273">0</span>&nbsp;<span class="op" id="5026275">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026281">name</span><span class="op" id="5026285">,</span>&nbsp;<span class="ident" id="5026287">val</span>&nbsp;<span class="op" id="5026291">=</span>&nbsp;<span class="ident" id="5026293">name</span><span class="op" id="5026297">[</span><span class="op" id="5026298">:</span><span class="ident" id="5026299">j</span><span class="op" id="5026300">]</span><span class="op" id="5026301">,</span>&nbsp;<span class="ident" id="5026303">name</span><span class="op" id="5026307">[</span><span class="ident" id="5026308">j</span><span class="op" id="5026309">+</span><span class="num" id="5026310">1</span><span class="op" id="5026311">:</span><span class="op" id="5026312">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026322">if</span>&nbsp;<span class="op" id="5026325">!</span><span class="ident" id="5026326">isCookieNameValid</span><span class="op" id="5026343">(</span><span class="ident" id="5026344">name</span><span class="op" id="5026348">)</span>&nbsp;<span class="op" id="5026350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026356">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026368">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026373">if</span>&nbsp;<span class="ident" id="5026376">filter</span>&nbsp;<span class="op" id="5026383">!=</span>&nbsp;<span class="string" id="5026386">&#34;&#34;</span>&nbsp;<span class="op" id="5026389">&amp;&amp;</span>&nbsp;<span class="ident" id="5026392">filter</span>&nbsp;<span class="op" id="5026399">!=</span>&nbsp;<span class="ident" id="5026402">name</span>&nbsp;<span class="op" id="5026407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026413">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026430">val</span><span class="op" id="5026433">,</span>&nbsp;<span class="ident" id="5026435">success</span>&nbsp;<span class="op" id="5026443">:=</span>&nbsp;<span class="ident" id="5026446">parseCookieValue</span><span class="op" id="5026462">(</span><span class="ident" id="5026463">val</span><span class="op" id="5026466">,</span>&nbsp;<span class="builtintype" id="5026468">true</span><span class="op" id="5026472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026477">if</span>&nbsp;<span class="op" id="5026480">!</span><span class="ident" id="5026481">success</span>&nbsp;<span class="op" id="5026489">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026495">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026512">cookies</span>&nbsp;<span class="op" id="5026520">=</span>&nbsp;<span class="builtinfunc" id="5026522">append</span><span class="op" id="5026528">(</span><span class="ident" id="5026529">cookies</span><span class="op" id="5026536">,</span>&nbsp;<span class="op" id="5026538">&amp;</span><span class="ident" id="5026539">Cookie</span><span class="op" id="5026545">{</span><span class="ident" id="5026546">Name</span><span class="op" id="5026550">:</span>&nbsp;<span class="ident" id="5026552">name</span><span class="op" id="5026556">,</span>&nbsp;<span class="ident" id="5026558">Value</span><span class="op" id="5026563">:</span>&nbsp;<span class="ident" id="5026565">val</span><span class="op" id="5026568">}</span><span class="op" id="5026569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026574">parsedPairs</span><span class="op" id="5026585">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026590">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026596">return</span>&nbsp;<span class="ident" id="5026603">cookies</span><br>
<span class="lineno"></span><span class="op" id="5026611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5026614">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="5026684">func</span>&nbsp;<span class="ident" id="5026689">validCookieDomain</span><span class="op" id="5026706">(</span><span class="ident" id="5026707">v</span>&nbsp;<span class="builtintype" id="5026709">string</span><span class="op" id="5026715">)</span>&nbsp;<span class="builtintype" id="5026717">bool</span>&nbsp;<span class="op" id="5026722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026725">if</span>&nbsp;<span class="ident" id="5026728">isCookieDomainName</span><span class="op" id="5026746">(</span><span class="ident" id="5026747">v</span><span class="op" id="5026748">)</span>&nbsp;<span class="op" id="5026750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026754">return</span>&nbsp;<span class="builtintype" id="5026761">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026770">if</span>&nbsp;<span class="ident" id="5026773">net</span><span class="op" id="5026776">.</span><span class="ident" id="5026777">ParseIP</span><span class="op" id="5026784">(</span><span class="ident" id="5026785">v</span><span class="op" id="5026786">)</span>&nbsp;<span class="op" id="5026788">!=</span>&nbsp;<span class="ident" id="5026791">nil</span>&nbsp;<span class="op" id="5026795">&amp;&amp;</span>&nbsp;<span class="op" id="5026798">!</span><span class="ident" id="5026799">strings</span><span class="op" id="5026806">.</span><span class="ident" id="5026807">Contains</span><span class="op" id="5026815">(</span><span class="ident" id="5026816">v</span><span class="op" id="5026817">,</span>&nbsp;<span class="string" id="5026819">&#34;:&#34;</span><span class="op" id="5026822">)</span>&nbsp;<span class="op" id="5026824">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026828">return</span>&nbsp;<span class="builtintype" id="5026835">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026844">return</span>&nbsp;<span class="builtintype" id="5026851">false</span><br>
<span class="lineno"></span><span class="op" id="5026857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="5026860">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="5026934">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5027004">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="5027035">func</span>&nbsp;<span class="ident" id="5027040">isCookieDomainName</span><span class="op" id="5027058">(</span><span class="ident" id="5027059">s</span>&nbsp;<span class="builtintype" id="5027061">string</span><span class="op" id="5027067">)</span>&nbsp;<span class="builtintype" id="5027069">bool</span>&nbsp;<span class="op" id="5027074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027077">if</span>&nbsp;<span class="builtinfunc" id="5027080">len</span><span class="op" id="5027083">(</span><span class="ident" id="5027084">s</span><span class="op" id="5027085">)</span>&nbsp;<span class="op" id="5027087">==</span>&nbsp;<span class="num" id="5027090">0</span>&nbsp;<span class="op" id="5027092">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027096">return</span>&nbsp;<span class="builtintype" id="5027103">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027113">if</span>&nbsp;<span class="builtinfunc" id="5027116">len</span><span class="op" id="5027119">(</span><span class="ident" id="5027120">s</span><span class="op" id="5027121">)</span>&nbsp;<span class="op" id="5027123">&gt;</span>&nbsp;<span class="num" id="5027125">255</span>&nbsp;<span class="op" id="5027129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027133">return</span>&nbsp;<span class="builtintype" id="5027140">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027147">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027151">if</span>&nbsp;<span class="ident" id="5027154">s</span><span class="op" id="5027155">[</span><span class="num" id="5027156">0</span><span class="op" id="5027157">]</span>&nbsp;<span class="op" id="5027159">==</span>&nbsp;<span class="string" id="5027162">&#39;.&#39;</span>&nbsp;<span class="op" id="5027166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027170">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027233">s</span>&nbsp;<span class="op" id="5027235">=</span>&nbsp;<span class="ident" id="5027237">s</span><span class="op" id="5027238">[</span><span class="num" id="5027239">1</span><span class="op" id="5027240">:</span><span class="op" id="5027241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027244">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027247">last</span>&nbsp;<span class="op" id="5027252">:=</span>&nbsp;<span class="builtintype" id="5027255">byte</span><span class="op" id="5027259">(</span><span class="string" id="5027260">&#39;.&#39;</span><span class="op" id="5027263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027266">ok</span>&nbsp;<span class="op" id="5027269">:=</span>&nbsp;<span class="builtintype" id="5027272">false</span>&nbsp;<span class="comment" id="5027278">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027311">partlen</span>&nbsp;<span class="op" id="5027319">:=</span>&nbsp;<span class="num" id="5027322">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027325">for</span>&nbsp;<span class="ident" id="5027329">i</span>&nbsp;<span class="op" id="5027331">:=</span>&nbsp;<span class="num" id="5027334">0</span><span class="op" id="5027335">;</span>&nbsp;<span class="ident" id="5027337">i</span>&nbsp;<span class="op" id="5027339">&lt;</span>&nbsp;<span class="builtinfunc" id="5027341">len</span><span class="op" id="5027344">(</span><span class="ident" id="5027345">s</span><span class="op" id="5027346">)</span><span class="op" id="5027347">;</span>&nbsp;<span class="ident" id="5027349">i</span><span class="op" id="5027350">++</span>&nbsp;<span class="op" id="5027353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027357">c</span>&nbsp;<span class="op" id="5027359">:=</span>&nbsp;<span class="ident" id="5027362">s</span><span class="op" id="5027363">[</span><span class="ident" id="5027364">i</span><span class="op" id="5027365">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027369">switch</span>&nbsp;<span class="op" id="5027376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027380">default</span><span class="op" id="5027387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027392">return</span>&nbsp;<span class="builtintype" id="5027399">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027407">case</span>&nbsp;<span class="string" id="5027412">&#39;a&#39;</span>&nbsp;<span class="op" id="5027416">&lt;=</span>&nbsp;<span class="ident" id="5027419">c</span>&nbsp;<span class="op" id="5027421">&amp;&amp;</span>&nbsp;<span class="ident" id="5027424">c</span>&nbsp;<span class="op" id="5027426">&lt;=</span>&nbsp;<span class="string" id="5027429">&#39;z&#39;</span>&nbsp;<span class="op" id="5027433">||</span>&nbsp;<span class="string" id="5027436">&#39;A&#39;</span>&nbsp;<span class="op" id="5027440">&lt;=</span>&nbsp;<span class="ident" id="5027443">c</span>&nbsp;<span class="op" id="5027445">&amp;&amp;</span>&nbsp;<span class="ident" id="5027448">c</span>&nbsp;<span class="op" id="5027450">&lt;=</span>&nbsp;<span class="string" id="5027453">&#39;Z&#39;</span><span class="op" id="5027456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027461">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027517">ok</span>&nbsp;<span class="op" id="5027520">=</span>&nbsp;<span class="builtintype" id="5027522">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027530">partlen</span><span class="op" id="5027537">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027542">case</span>&nbsp;<span class="string" id="5027547">&#39;0&#39;</span>&nbsp;<span class="op" id="5027551">&lt;=</span>&nbsp;<span class="ident" id="5027554">c</span>&nbsp;<span class="op" id="5027556">&amp;&amp;</span>&nbsp;<span class="ident" id="5027559">c</span>&nbsp;<span class="op" id="5027561">&lt;=</span>&nbsp;<span class="string" id="5027564">&#39;9&#39;</span><span class="op" id="5027567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027572">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027583">partlen</span><span class="op" id="5027590">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027595">case</span>&nbsp;<span class="ident" id="5027600">c</span>&nbsp;<span class="op" id="5027602">==</span>&nbsp;<span class="string" id="5027605">&#39;-&#39;</span><span class="op" id="5027608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027613">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027651">if</span>&nbsp;<span class="ident" id="5027654">last</span>&nbsp;<span class="op" id="5027659">==</span>&nbsp;<span class="string" id="5027662">&#39;.&#39;</span>&nbsp;<span class="op" id="5027666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027672">return</span>&nbsp;<span class="builtintype" id="5027679">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027688">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027693">partlen</span><span class="op" id="5027700">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027705">case</span>&nbsp;<span class="ident" id="5027710">c</span>&nbsp;<span class="op" id="5027712">==</span>&nbsp;<span class="string" id="5027715">&#39;.&#39;</span><span class="op" id="5027718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027723">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027766">if</span>&nbsp;<span class="ident" id="5027769">last</span>&nbsp;<span class="op" id="5027774">==</span>&nbsp;<span class="string" id="5027777">&#39;.&#39;</span>&nbsp;<span class="op" id="5027781">||</span>&nbsp;<span class="ident" id="5027784">last</span>&nbsp;<span class="op" id="5027789">==</span>&nbsp;<span class="string" id="5027792">&#39;-&#39;</span>&nbsp;<span class="op" id="5027796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027802">return</span>&nbsp;<span class="builtintype" id="5027809">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027823">if</span>&nbsp;<span class="ident" id="5027826">partlen</span>&nbsp;<span class="op" id="5027834">&gt;</span>&nbsp;<span class="num" id="5027836">63</span>&nbsp;<span class="op" id="5027839">||</span>&nbsp;<span class="ident" id="5027842">partlen</span>&nbsp;<span class="op" id="5027850">==</span>&nbsp;<span class="num" id="5027853">0</span>&nbsp;<span class="op" id="5027855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027861">return</span>&nbsp;<span class="builtintype" id="5027868">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027882">partlen</span>&nbsp;<span class="op" id="5027890">=</span>&nbsp;<span class="num" id="5027892">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027900">last</span>&nbsp;<span class="op" id="5027905">=</span>&nbsp;<span class="ident" id="5027907">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027913">if</span>&nbsp;<span class="ident" id="5027916">last</span>&nbsp;<span class="op" id="5027921">==</span>&nbsp;<span class="string" id="5027924">&#39;-&#39;</span>&nbsp;<span class="op" id="5027928">||</span>&nbsp;<span class="ident" id="5027931">partlen</span>&nbsp;<span class="op" id="5027939">&gt;</span>&nbsp;<span class="num" id="5027941">63</span>&nbsp;<span class="op" id="5027944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027948">return</span>&nbsp;<span class="builtintype" id="5027955">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027966">return</span>&nbsp;<span class="ident" id="5027973">ok</span><br>
<span class="lineno"></span><span class="op" id="5027976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5027979">var</span>&nbsp;<span class="ident" id="5027983">cookieNameSanitizer</span>&nbsp;<span class="op" id="5028003">=</span>&nbsp;<span class="ident" id="5028005">strings</span><span class="op" id="5028012">.</span><span class="ident" id="5028013">NewReplacer</span><span class="op" id="5028024">(</span><span class="string" id="5028025">&#34;\n&#34;</span><span class="op" id="5028029">,</span>&nbsp;<span class="string" id="5028031">&#34;-&#34;</span><span class="op" id="5028034">,</span>&nbsp;<span class="string" id="5028036">&#34;\r&#34;</span><span class="op" id="5028040">,</span>&nbsp;<span class="string" id="5028042">&#34;-&#34;</span><span class="op" id="5028045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5028048">func</span>&nbsp;<span class="ident" id="5028053">sanitizeCookieName</span><span class="op" id="5028071">(</span><span class="ident" id="5028072">n</span>&nbsp;<span class="builtintype" id="5028074">string</span><span class="op" id="5028080">)</span>&nbsp;<span class="builtintype" id="5028082">string</span>&nbsp;<span class="op" id="5028089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028092">return</span>&nbsp;<span class="ident" id="5028099">cookieNameSanitizer</span><span class="op" id="5028118">.</span><span class="ident" id="5028119">Replace</span><span class="op" id="5028126">(</span><span class="ident" id="5028127">n</span><span class="op" id="5028128">)</span><br>
<span class="lineno"></span><span class="op" id="5028130">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="5028133">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="5028185">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="5028256">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="5028324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="5028375">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="5028427">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="5028456">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5028523">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="5028592">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="5028618">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="5028674">func</span>&nbsp;<span class="ident" id="5028679">sanitizeCookieValue</span><span class="op" id="5028698">(</span><span class="ident" id="5028699">v</span>&nbsp;<span class="builtintype" id="5028701">string</span><span class="op" id="5028707">)</span>&nbsp;<span class="builtintype" id="5028709">string</span>&nbsp;<span class="op" id="5028716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5028719">v</span>&nbsp;<span class="op" id="5028721">=</span>&nbsp;<span class="ident" id="5028723">sanitizeOrWarn</span><span class="op" id="5028737">(</span><span class="string" id="5028738">&#34;Cookie.Value&#34;</span><span class="op" id="5028752">,</span>&nbsp;<span class="ident" id="5028754">validCookieValueByte</span><span class="op" id="5028774">,</span>&nbsp;<span class="ident" id="5028776">v</span><span class="op" id="5028777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028780">if</span>&nbsp;<span class="builtinfunc" id="5028783">len</span><span class="op" id="5028786">(</span><span class="ident" id="5028787">v</span><span class="op" id="5028788">)</span>&nbsp;<span class="op" id="5028790">==</span>&nbsp;<span class="num" id="5028793">0</span>&nbsp;<span class="op" id="5028795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028799">return</span>&nbsp;<span class="ident" id="5028806">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5028809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028812">if</span>&nbsp;<span class="ident" id="5028815">v</span><span class="op" id="5028816">[</span><span class="num" id="5028817">0</span><span class="op" id="5028818">]</span>&nbsp;<span class="op" id="5028820">==</span>&nbsp;<span class="string" id="5028823">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5028827">||</span>&nbsp;<span class="ident" id="5028830">v</span><span class="op" id="5028831">[</span><span class="num" id="5028832">0</span><span class="op" id="5028833">]</span>&nbsp;<span class="op" id="5028835">==</span>&nbsp;<span class="string" id="5028838">&#39;,&#39;</span>&nbsp;<span class="op" id="5028842">||</span>&nbsp;<span class="ident" id="5028845">v</span><span class="op" id="5028846">[</span><span class="builtinfunc" id="5028847">len</span><span class="op" id="5028850">(</span><span class="ident" id="5028851">v</span><span class="op" id="5028852">)</span><span class="op" id="5028853">-</span><span class="num" id="5028854">1</span><span class="op" id="5028855">]</span>&nbsp;<span class="op" id="5028857">==</span>&nbsp;<span class="string" id="5028860">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5028864">||</span>&nbsp;<span class="ident" id="5028867">v</span><span class="op" id="5028868">[</span><span class="builtinfunc" id="5028869">len</span><span class="op" id="5028872">(</span><span class="ident" id="5028873">v</span><span class="op" id="5028874">)</span><span class="op" id="5028875">-</span><span class="num" id="5028876">1</span><span class="op" id="5028877">]</span>&nbsp;<span class="op" id="5028879">==</span>&nbsp;<span class="string" id="5028882">&#39;,&#39;</span>&nbsp;<span class="op" id="5028886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028890">return</span>&nbsp;<span class="string" id="5028897">`&#34;`</span>&nbsp;<span class="op" id="5028901">+</span>&nbsp;<span class="ident" id="5028903">v</span>&nbsp;<span class="op" id="5028905">+</span>&nbsp;<span class="string" id="5028907">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5028912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028915">return</span>&nbsp;<span class="ident" id="5028922">v</span><br>
<span class="lineno">310</span><span class="op" id="5028924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5028927">func</span>&nbsp;<span class="ident" id="5028932">validCookieValueByte</span><span class="op" id="5028952">(</span><span class="ident" id="5028953">b</span>&nbsp;<span class="builtintype" id="5028955">byte</span><span class="op" id="5028959">)</span>&nbsp;<span class="builtintype" id="5028961">bool</span>&nbsp;<span class="op" id="5028966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028969">return</span>&nbsp;<span class="num" id="5028976">0x20</span>&nbsp;<span class="op" id="5028981">&lt;=</span>&nbsp;<span class="ident" id="5028984">b</span>&nbsp;<span class="op" id="5028986">&amp;&amp;</span>&nbsp;<span class="ident" id="5028989">b</span>&nbsp;<span class="op" id="5028991">&lt;</span>&nbsp;<span class="num" id="5028993">0x7f</span>&nbsp;<span class="op" id="5028998">&amp;&amp;</span>&nbsp;<span class="ident" id="5029001">b</span>&nbsp;<span class="op" id="5029003">!=</span>&nbsp;<span class="string" id="5029006">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5029010">&amp;&amp;</span>&nbsp;<span class="ident" id="5029013">b</span>&nbsp;<span class="op" id="5029015">!=</span>&nbsp;<span class="string" id="5029018">&#39;;&#39;</span>&nbsp;<span class="op" id="5029022">&amp;&amp;</span>&nbsp;<span class="ident" id="5029025">b</span>&nbsp;<span class="op" id="5029027">!=</span>&nbsp;<span class="string" id="5029030">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="5029035">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5029038">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="5029080">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="5029133">func</span>&nbsp;<span class="ident" id="5029138">sanitizeCookiePath</span><span class="op" id="5029156">(</span><span class="ident" id="5029157">v</span>&nbsp;<span class="builtintype" id="5029159">string</span><span class="op" id="5029165">)</span>&nbsp;<span class="builtintype" id="5029167">string</span>&nbsp;<span class="op" id="5029174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029177">return</span>&nbsp;<span class="ident" id="5029184">sanitizeOrWarn</span><span class="op" id="5029198">(</span><span class="string" id="5029199">&#34;Cookie.Path&#34;</span><span class="op" id="5029212">,</span>&nbsp;<span class="ident" id="5029214">validCookiePathByte</span><span class="op" id="5029233">,</span>&nbsp;<span class="ident" id="5029235">v</span><span class="op" id="5029236">)</span><br>
<span class="lineno">320</span><span class="op" id="5029238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5029241">func</span>&nbsp;<span class="ident" id="5029246">validCookiePathByte</span><span class="op" id="5029265">(</span><span class="ident" id="5029266">b</span>&nbsp;<span class="builtintype" id="5029268">byte</span><span class="op" id="5029272">)</span>&nbsp;<span class="builtintype" id="5029274">bool</span>&nbsp;<span class="op" id="5029279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029282">return</span>&nbsp;<span class="num" id="5029289">0x20</span>&nbsp;<span class="op" id="5029294">&lt;=</span>&nbsp;<span class="ident" id="5029297">b</span>&nbsp;<span class="op" id="5029299">&amp;&amp;</span>&nbsp;<span class="ident" id="5029302">b</span>&nbsp;<span class="op" id="5029304">&lt;</span>&nbsp;<span class="num" id="5029306">0x7f</span>&nbsp;<span class="op" id="5029311">&amp;&amp;</span>&nbsp;<span class="ident" id="5029314">b</span>&nbsp;<span class="op" id="5029316">!=</span>&nbsp;<span class="string" id="5029319">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="5029323">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="5029326">func</span>&nbsp;<span class="ident" id="5029331">sanitizeOrWarn</span><span class="op" id="5029345">(</span><span class="ident" id="5029346">fieldName</span>&nbsp;<span class="builtintype" id="5029356">string</span><span class="op" id="5029362">,</span>&nbsp;<span class="ident" id="5029364">valid</span>&nbsp;<span class="keyword" id="5029370">func</span><span class="op" id="5029374">(</span><span class="builtintype" id="5029375">byte</span><span class="op" id="5029379">)</span>&nbsp;<span class="builtintype" id="5029381">bool</span><span class="op" id="5029385">,</span>&nbsp;<span class="ident" id="5029387">v</span>&nbsp;<span class="builtintype" id="5029389">string</span><span class="op" id="5029395">)</span>&nbsp;<span class="builtintype" id="5029397">string</span>&nbsp;<span class="op" id="5029404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029407">ok</span>&nbsp;<span class="op" id="5029410">:=</span>&nbsp;<span class="builtintype" id="5029413">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029419">for</span>&nbsp;<span class="ident" id="5029423">i</span>&nbsp;<span class="op" id="5029425">:=</span>&nbsp;<span class="num" id="5029428">0</span><span class="op" id="5029429">;</span>&nbsp;<span class="ident" id="5029431">i</span>&nbsp;<span class="op" id="5029433">&lt;</span>&nbsp;<span class="builtinfunc" id="5029435">len</span><span class="op" id="5029438">(</span><span class="ident" id="5029439">v</span><span class="op" id="5029440">)</span><span class="op" id="5029441">;</span>&nbsp;<span class="ident" id="5029443">i</span><span class="op" id="5029444">++</span>&nbsp;<span class="op" id="5029447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029451">if</span>&nbsp;<span class="ident" id="5029454">valid</span><span class="op" id="5029459">(</span><span class="ident" id="5029460">v</span><span class="op" id="5029461">[</span><span class="ident" id="5029462">i</span><span class="op" id="5029463">]</span><span class="op" id="5029464">)</span>&nbsp;<span class="op" id="5029466">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029471">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029486">log</span><span class="op" id="5029489">.</span><span class="ident" id="5029490">Printf</span><span class="op" id="5029496">(</span><span class="string" id="5029497">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="5029554">,</span>&nbsp;<span class="ident" id="5029556">v</span><span class="op" id="5029557">[</span><span class="ident" id="5029558">i</span><span class="op" id="5029559">]</span><span class="op" id="5029560">,</span>&nbsp;<span class="ident" id="5029562">fieldName</span><span class="op" id="5029571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029575">ok</span>&nbsp;<span class="op" id="5029578">=</span>&nbsp;<span class="builtintype" id="5029580">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029588">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029598">if</span>&nbsp;<span class="ident" id="5029601">ok</span>&nbsp;<span class="op" id="5029604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029608">return</span>&nbsp;<span class="ident" id="5029615">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029621">buf</span>&nbsp;<span class="op" id="5029625">:=</span>&nbsp;<span class="builtinfunc" id="5029628">make</span><span class="op" id="5029632">(</span><span class="op" id="5029633">[</span><span class="op" id="5029634">]</span><span class="builtintype" id="5029635">byte</span><span class="op" id="5029639">,</span>&nbsp;<span class="num" id="5029641">0</span><span class="op" id="5029642">,</span>&nbsp;<span class="builtinfunc" id="5029644">len</span><span class="op" id="5029647">(</span><span class="ident" id="5029648">v</span><span class="op" id="5029649">)</span><span class="op" id="5029650">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029653">for</span>&nbsp;<span class="ident" id="5029657">i</span>&nbsp;<span class="op" id="5029659">:=</span>&nbsp;<span class="num" id="5029662">0</span><span class="op" id="5029663">;</span>&nbsp;<span class="ident" id="5029665">i</span>&nbsp;<span class="op" id="5029667">&lt;</span>&nbsp;<span class="builtinfunc" id="5029669">len</span><span class="op" id="5029672">(</span><span class="ident" id="5029673">v</span><span class="op" id="5029674">)</span><span class="op" id="5029675">;</span>&nbsp;<span class="ident" id="5029677">i</span><span class="op" id="5029678">++</span>&nbsp;<span class="op" id="5029681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029685">if</span>&nbsp;<span class="ident" id="5029688">b</span>&nbsp;<span class="op" id="5029690">:=</span>&nbsp;<span class="ident" id="5029693">v</span><span class="op" id="5029694">[</span><span class="ident" id="5029695">i</span><span class="op" id="5029696">]</span><span class="op" id="5029697">;</span>&nbsp;<span class="ident" id="5029699">valid</span><span class="op" id="5029704">(</span><span class="ident" id="5029705">b</span><span class="op" id="5029706">)</span>&nbsp;<span class="op" id="5029708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029713">buf</span>&nbsp;<span class="op" id="5029717">=</span>&nbsp;<span class="builtinfunc" id="5029719">append</span><span class="op" id="5029725">(</span><span class="ident" id="5029726">buf</span><span class="op" id="5029729">,</span>&nbsp;<span class="ident" id="5029731">b</span><span class="op" id="5029732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029739">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029742">return</span>&nbsp;<span class="builtintype" id="5029749">string</span><span class="op" id="5029755">(</span><span class="ident" id="5029756">buf</span><span class="op" id="5029759">)</span><br>
<span class="lineno"></span><span class="op" id="5029761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5029764">func</span>&nbsp;<span class="ident" id="5029769">parseCookieValue</span><span class="op" id="5029785">(</span><span class="ident" id="5029786">raw</span>&nbsp;<span class="builtintype" id="5029790">string</span><span class="op" id="5029796">,</span>&nbsp;<span class="ident" id="5029798">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="5029815">bool</span><span class="op" id="5029819">)</span>&nbsp;<span class="op" id="5029821">(</span><span class="builtintype" id="5029822">string</span><span class="op" id="5029828">,</span>&nbsp;<span class="builtintype" id="5029830">bool</span><span class="op" id="5029834">)</span>&nbsp;<span class="op" id="5029836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029839">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029873">if</span>&nbsp;<span class="ident" id="5029876">allowDoubleQuote</span>&nbsp;<span class="op" id="5029893">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5029896">len</span><span class="op" id="5029899">(</span><span class="ident" id="5029900">raw</span><span class="op" id="5029903">)</span>&nbsp;<span class="op" id="5029905">&gt;</span>&nbsp;<span class="num" id="5029907">1</span>&nbsp;<span class="op" id="5029909">&amp;&amp;</span>&nbsp;<span class="ident" id="5029912">raw</span><span class="op" id="5029915">[</span><span class="num" id="5029916">0</span><span class="op" id="5029917">]</span>&nbsp;<span class="op" id="5029919">==</span>&nbsp;<span class="string" id="5029922">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5029926">&amp;&amp;</span>&nbsp;<span class="ident" id="5029929">raw</span><span class="op" id="5029932">[</span><span class="builtinfunc" id="5029933">len</span><span class="op" id="5029936">(</span><span class="ident" id="5029937">raw</span><span class="op" id="5029940">)</span><span class="op" id="5029941">-</span><span class="num" id="5029942">1</span><span class="op" id="5029943">]</span>&nbsp;<span class="op" id="5029945">==</span>&nbsp;<span class="string" id="5029948">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5029952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029956">raw</span>&nbsp;<span class="op" id="5029960">=</span>&nbsp;<span class="ident" id="5029962">raw</span><span class="op" id="5029965">[</span><span class="num" id="5029966">1</span>&nbsp;<span class="op" id="5029968">:</span>&nbsp;<span class="builtinfunc" id="5029970">len</span><span class="op" id="5029973">(</span><span class="ident" id="5029974">raw</span><span class="op" id="5029977">)</span><span class="op" id="5029978">-</span><span class="num" id="5029979">1</span><span class="op" id="5029980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029986">for</span>&nbsp;<span class="ident" id="5029990">i</span>&nbsp;<span class="op" id="5029992">:=</span>&nbsp;<span class="num" id="5029995">0</span><span class="op" id="5029996">;</span>&nbsp;<span class="ident" id="5029998">i</span>&nbsp;<span class="op" id="5030000">&lt;</span>&nbsp;<span class="builtinfunc" id="5030002">len</span><span class="op" id="5030005">(</span><span class="ident" id="5030006">raw</span><span class="op" id="5030009">)</span><span class="op" id="5030010">;</span>&nbsp;<span class="ident" id="5030012">i</span><span class="op" id="5030013">++</span>&nbsp;<span class="op" id="5030016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030020">if</span>&nbsp;<span class="op" id="5030023">!</span><span class="ident" id="5030024">validCookieValueByte</span><span class="op" id="5030044">(</span><span class="ident" id="5030045">raw</span><span class="op" id="5030048">[</span><span class="ident" id="5030049">i</span><span class="op" id="5030050">]</span><span class="op" id="5030051">)</span>&nbsp;<span class="op" id="5030053">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030058">return</span>&nbsp;<span class="string" id="5030065">&#34;&#34;</span><span class="op" id="5030067">,</span>&nbsp;<span class="builtintype" id="5030069">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030083">return</span>&nbsp;<span class="ident" id="5030090">raw</span><span class="op" id="5030093">,</span>&nbsp;<span class="builtintype" id="5030095">true</span><br>
<span class="lineno"></span><span class="op" id="5030100">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="5030103">func</span>&nbsp;<span class="ident" id="5030108">isCookieNameValid</span><span class="op" id="5030125">(</span><span class="ident" id="5030126">raw</span>&nbsp;<span class="builtintype" id="5030130">string</span><span class="op" id="5030136">)</span>&nbsp;<span class="builtintype" id="5030138">bool</span>&nbsp;<span class="op" id="5030143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030146">return</span>&nbsp;<span class="ident" id="5030153">strings</span><span class="op" id="5030160">.</span><span class="ident" id="5030161">IndexFunc</span><span class="op" id="5030170">(</span><span class="ident" id="5030171">raw</span><span class="op" id="5030174">,</span>&nbsp;<span class="ident" id="5030176">isNotToken</span><span class="op" id="5030186">)</span>&nbsp;<span class="op" id="5030188">&lt;</span>&nbsp;<span class="num" id="5030190">0</span><br>
<span class="lineno"></span><span class="op" id="5030192">}</span>
</div>
</body>
</html>
