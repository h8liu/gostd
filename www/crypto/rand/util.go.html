<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3657683">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3657739">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3657793">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3657844">package</span>&nbsp;<span class="ident" id="3657852">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3657858">import</span>&nbsp;<span class="op" id="3657865">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3657868">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3657878">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3657884">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3657895">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3657898">//&nbsp;smallPrimes&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;small,&nbsp;prime&nbsp;numbers&nbsp;that&nbsp;allows&nbsp;us&nbsp;to&nbsp;rapidly</span><br>
<span class="lineno"></span><span class="comment" id="3657973">//&nbsp;exclude&nbsp;some&nbsp;fraction&nbsp;of&nbsp;composite&nbsp;candidates&nbsp;when&nbsp;searching&nbsp;for&nbsp;a&nbsp;random</span><br>
<span class="lineno">15</span><span class="comment" id="3658050">//&nbsp;prime.&nbsp;This&nbsp;list&nbsp;is&nbsp;truncated&nbsp;at&nbsp;the&nbsp;point&nbsp;where&nbsp;smallPrimesProduct&nbsp;exceeds</span><br>
<span class="lineno"></span><span class="comment" id="3658129">//&nbsp;a&nbsp;uint64.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;two&nbsp;because&nbsp;we&nbsp;ensure&nbsp;that&nbsp;the&nbsp;candidates&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3658208">//&nbsp;odd&nbsp;by&nbsp;construction.</span><br>
<span class="lineno"></span><span class="keyword" id="3658232">var</span>&nbsp;<span class="ident" id="3658236">smallPrimes</span>&nbsp;<span class="op" id="3658248">=</span>&nbsp;<span class="op" id="3658250">[</span><span class="op" id="3658251">]</span><span class="builtintype" id="3658252">uint8</span><span class="op" id="3658257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3658260">3</span><span class="op" id="3658261">,</span>&nbsp;<span class="num" id="3658263">5</span><span class="op" id="3658264">,</span>&nbsp;<span class="num" id="3658266">7</span><span class="op" id="3658267">,</span>&nbsp;<span class="num" id="3658269">11</span><span class="op" id="3658271">,</span>&nbsp;<span class="num" id="3658273">13</span><span class="op" id="3658275">,</span>&nbsp;<span class="num" id="3658277">17</span><span class="op" id="3658279">,</span>&nbsp;<span class="num" id="3658281">19</span><span class="op" id="3658283">,</span>&nbsp;<span class="num" id="3658285">23</span><span class="op" id="3658287">,</span>&nbsp;<span class="num" id="3658289">29</span><span class="op" id="3658291">,</span>&nbsp;<span class="num" id="3658293">31</span><span class="op" id="3658295">,</span>&nbsp;<span class="num" id="3658297">37</span><span class="op" id="3658299">,</span>&nbsp;<span class="num" id="3658301">41</span><span class="op" id="3658303">,</span>&nbsp;<span class="num" id="3658305">43</span><span class="op" id="3658307">,</span>&nbsp;<span class="num" id="3658309">47</span><span class="op" id="3658311">,</span>&nbsp;<span class="num" id="3658313">53</span><span class="op" id="3658315">,</span><br>
<span class="lineno">20</span><span class="op" id="3658317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3658320">//&nbsp;smallPrimesProduct&nbsp;is&nbsp;the&nbsp;product&nbsp;of&nbsp;the&nbsp;values&nbsp;in&nbsp;smallPrimes&nbsp;and&nbsp;allows&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="3658400">//&nbsp;to&nbsp;reduce&nbsp;a&nbsp;candidate&nbsp;prime&nbsp;by&nbsp;this&nbsp;number&nbsp;and&nbsp;then&nbsp;determine&nbsp;whether&nbsp;it&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3658478">//&nbsp;coprime&nbsp;to&nbsp;all&nbsp;the&nbsp;elements&nbsp;of&nbsp;smallPrimes&nbsp;without&nbsp;further&nbsp;big.Int</span><br>
<span class="lineno">25</span><span class="comment" id="3658548">//&nbsp;operations.</span><br>
<span class="lineno"></span><span class="keyword" id="3658563">var</span>&nbsp;<span class="ident" id="3658567">smallPrimesProduct</span>&nbsp;<span class="op" id="3658586">=</span>&nbsp;<span class="builtinfunc" id="3658588">new</span><span class="op" id="3658591">(</span><span class="ident" id="3658592"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3658595">.</span><span class="ident" id="3658596">Int</span><span class="op" id="3658599">)</span><span class="op" id="3658600">.</span><span class="ident" id="3658601">SetUint64</span><span class="op" id="3658610">(</span><span class="num" id="3658611">16294579238595022365</span><span class="op" id="3658631">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3658634">//&nbsp;Prime&nbsp;returns&nbsp;a&nbsp;number,&nbsp;p,&nbsp;of&nbsp;the&nbsp;given&nbsp;size,&nbsp;such&nbsp;that&nbsp;p&nbsp;is&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="3658704">//&nbsp;with&nbsp;high&nbsp;probability.</span><br>
<span class="lineno">30</span><span class="comment" id="3658730">//&nbsp;Prime&nbsp;will&nbsp;return&nbsp;error&nbsp;for&nbsp;any&nbsp;error&nbsp;returned&nbsp;by&nbsp;rand.Read&nbsp;or&nbsp;if&nbsp;bits&nbsp;&lt;&nbsp;2.</span><br>
<span class="lineno"></span><span class="keyword" id="3658809">func</span>&nbsp;<span class="ident" id="3658814">Prime</span><span class="op" id="3658819">(</span><span class="ident" id="3658820">rand</span>&nbsp;<span class="ident" id="3658825"><a href="/crypto/rand/util.go.html#3657878">io</a></span><span class="op" id="3658827">.</span><span class="ident" id="3658828">Reader</span><span class="op" id="3658834">,</span>&nbsp;<span class="ident" id="3658836">bits</span>&nbsp;<span class="builtintype" id="3658841">int</span><span class="op" id="3658844">)</span>&nbsp;<span class="op" id="3658846">(</span><span class="ident" id="3658847">p</span>&nbsp;<span class="op" id="3658849">*</span><span class="ident" id="3658850"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3658853">.</span><span class="ident" id="3658854">Int</span><span class="op" id="3658857">,</span>&nbsp;<span class="ident" id="3658859">err</span>&nbsp;<span class="builtintype" id="3658863">error</span><span class="op" id="3658868">)</span>&nbsp;<span class="op" id="3658870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658873">if</span>&nbsp;<span class="ident" id="3658876"><a href="/crypto/rand/util.go.html#3658836">bits</a></span>&nbsp;<span class="op" id="3658881">&lt;</span>&nbsp;<span class="num" id="3658883">2</span>&nbsp;<span class="op" id="3658885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658889"><a href="/crypto/rand/util.go.html#3658859">err</a></span>&nbsp;<span class="op" id="3658893">=</span>&nbsp;<span class="ident" id="3658895"><a href="/crypto/rand/util.go.html#3657868">errors</a></span><span class="op" id="3658901">.</span><span class="ident" id="3658902">New</span><span class="op" id="3658905">(</span><span class="string" id="3658906">&#34;crypto/rand:&nbsp;prime&nbsp;size&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2-bit&#34;</span><span class="op" id="3658954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658958">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3658966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3658970">b</span>&nbsp;<span class="op" id="3658972">:=</span>&nbsp;<span class="builtintype" id="3658975">uint</span><span class="op" id="3658979">(</span><span class="ident" id="3658980"><a href="/crypto/rand/util.go.html#3658836">bits</a></span>&nbsp;<span class="op" id="3658985">%</span>&nbsp;<span class="num" id="3658987">8</span><span class="op" id="3658988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3658991">if</span>&nbsp;<span class="ident" id="3658994"><a href="/crypto/rand/util.go.html#3658970">b</a></span>&nbsp;<span class="op" id="3658996">==</span>&nbsp;<span class="num" id="3658999">0</span>&nbsp;<span class="op" id="3659001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659005"><a href="/crypto/rand/util.go.html#3658970">b</a></span>&nbsp;<span class="op" id="3659007">=</span>&nbsp;<span class="num" id="3659009">8</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659016">bytes</span>&nbsp;<span class="op" id="3659022">:=</span>&nbsp;<span class="builtinfunc" id="3659025">make</span><span class="op" id="3659029">(</span><span class="op" id="3659030">[</span><span class="op" id="3659031">]</span><span class="builtintype" id="3659032">byte</span><span class="op" id="3659036">,</span>&nbsp;<span class="op" id="3659038">(</span><span class="ident" id="3659039"><a href="/crypto/rand/util.go.html#3658836">bits</a></span><span class="op" id="3659043">+</span><span class="num" id="3659044">7</span><span class="op" id="3659045">)</span><span class="op" id="3659046">/</span><span class="num" id="3659047">8</span><span class="op" id="3659048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659051"><a href="/crypto/rand/util.go.html#3658847">p</a></span>&nbsp;<span class="op" id="3659053">=</span>&nbsp;<span class="builtinfunc" id="3659055">new</span><span class="op" id="3659058">(</span><span class="ident" id="3659059"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3659062">.</span><span class="ident" id="3659063">Int</span><span class="op" id="3659066">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659070">bigMod</span>&nbsp;<span class="op" id="3659077">:=</span>&nbsp;<span class="builtinfunc" id="3659080">new</span><span class="op" id="3659083">(</span><span class="ident" id="3659084"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3659087">.</span><span class="ident" id="3659088">Int</span><span class="op" id="3659091">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659095">for</span>&nbsp;<span class="op" id="3659099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659103">_</span><span class="op" id="3659104">,</span>&nbsp;<span class="ident" id="3659106"><a href="/crypto/rand/util.go.html#3658859">err</a></span>&nbsp;<span class="op" id="3659110">=</span>&nbsp;<span class="ident" id="3659112"><a href="/crypto/rand/util.go.html#3657878">io</a></span><span class="op" id="3659114">.</span><span class="ident" id="3659115">ReadFull</span><span class="op" id="3659123">(</span><span class="ident" id="3659124"><a href="/crypto/rand/util.go.html#3658820">rand</a></span><span class="op" id="3659128">,</span>&nbsp;<span class="ident" id="3659130"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659139">if</span>&nbsp;<span class="ident" id="3659142"><a href="/crypto/rand/util.go.html#3658859">err</a></span>&nbsp;<span class="op" id="3659146">!=</span>&nbsp;<span class="ident" id="3659149">nil</span>&nbsp;<span class="op" id="3659153">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659158">return</span>&nbsp;<span class="ident" id="3659165">nil</span><span class="op" id="3659168">,</span>&nbsp;<span class="ident" id="3659170"><a href="/crypto/rand/util.go.html#3658859">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659181">//&nbsp;Clear&nbsp;bits&nbsp;in&nbsp;the&nbsp;first&nbsp;byte&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;candidate&nbsp;has&nbsp;a&nbsp;size&nbsp;&lt;=&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659262"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659267">[</span><span class="num" id="3659268">0</span><span class="op" id="3659269">]</span>&nbsp;<span class="op" id="3659271">&amp;=</span>&nbsp;<span class="builtintype" id="3659274">uint8</span><span class="op" id="3659279">(</span><span class="builtintype" id="3659280">int</span><span class="op" id="3659283">(</span><span class="num" id="3659284">1</span><span class="op" id="3659285">&lt;&lt;</span><span class="ident" id="3659287"><a href="/crypto/rand/util.go.html#3658970">b</a></span><span class="op" id="3659288">)</span>&nbsp;<span class="op" id="3659290">-</span>&nbsp;<span class="num" id="3659292">1</span><span class="op" id="3659293">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659297">//&nbsp;Don&#39;t&nbsp;let&nbsp;the&nbsp;value&nbsp;be&nbsp;too&nbsp;small,&nbsp;i.e,&nbsp;set&nbsp;the&nbsp;most&nbsp;significant&nbsp;two&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659376">//&nbsp;Setting&nbsp;the&nbsp;top&nbsp;two&nbsp;bits,&nbsp;rather&nbsp;than&nbsp;just&nbsp;the&nbsp;top&nbsp;bit,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659437">//&nbsp;means&nbsp;that&nbsp;when&nbsp;two&nbsp;of&nbsp;these&nbsp;values&nbsp;are&nbsp;multiplied&nbsp;together,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659503">//&nbsp;the&nbsp;result&nbsp;isn&#39;t&nbsp;ever&nbsp;one&nbsp;bit&nbsp;short.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659545">if</span>&nbsp;<span class="ident" id="3659548"><a href="/crypto/rand/util.go.html#3658970">b</a></span>&nbsp;<span class="op" id="3659550">&gt;=</span>&nbsp;<span class="num" id="3659553">2</span>&nbsp;<span class="op" id="3659555">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659560"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659565">[</span><span class="num" id="3659566">0</span><span class="op" id="3659567">]</span>&nbsp;<span class="op" id="3659569">|=</span>&nbsp;<span class="num" id="3659572">3</span>&nbsp;<span class="op" id="3659574">&lt;&lt;</span>&nbsp;<span class="op" id="3659577">(</span><span class="ident" id="3659578"><a href="/crypto/rand/util.go.html#3658970">b</a></span>&nbsp;<span class="op" id="3659580">-</span>&nbsp;<span class="num" id="3659582">2</span><span class="op" id="3659583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659587">}</span>&nbsp;<span class="keyword" id="3659589">else</span>&nbsp;<span class="op" id="3659594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659599">//&nbsp;Here&nbsp;b==1,&nbsp;because&nbsp;b&nbsp;cannot&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659642"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659647">[</span><span class="num" id="3659648">0</span><span class="op" id="3659649">]</span>&nbsp;<span class="op" id="3659651">|=</span>&nbsp;<span class="num" id="3659654">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3659659">if</span>&nbsp;<span class="builtinfunc" id="3659662">len</span><span class="op" id="3659665">(</span><span class="ident" id="3659666"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659671">)</span>&nbsp;<span class="op" id="3659673">&gt;</span>&nbsp;<span class="num" id="3659675">1</span>&nbsp;<span class="op" id="3659677">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659683"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659688">[</span><span class="num" id="3659689">1</span><span class="op" id="3659690">]</span>&nbsp;<span class="op" id="3659692">|=</span>&nbsp;<span class="num" id="3659695">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3659707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659711">//&nbsp;Make&nbsp;the&nbsp;value&nbsp;odd&nbsp;since&nbsp;an&nbsp;even&nbsp;number&nbsp;this&nbsp;large&nbsp;certainly&nbsp;isn&#39;t&nbsp;prime.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659790"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659795">[</span><span class="builtinfunc" id="3659796">len</span><span class="op" id="3659799">(</span><span class="ident" id="3659800"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659805">)</span><span class="op" id="3659806">-</span><span class="num" id="3659807">1</span><span class="op" id="3659808">]</span>&nbsp;<span class="op" id="3659810">|=</span>&nbsp;<span class="num" id="3659813">1</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3659818"><a href="/crypto/rand/util.go.html#3658847">p</a></span><span class="op" id="3659819">.</span><span class="ident" id="3659820">SetBytes</span><span class="op" id="3659828">(</span><span class="ident" id="3659829"><a href="/crypto/rand/util.go.html#3659016">bytes</a></span><span class="op" id="3659834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659839">//&nbsp;Calculate&nbsp;the&nbsp;value&nbsp;mod&nbsp;the&nbsp;product&nbsp;of&nbsp;smallPrimes.&nbsp;&nbsp;If&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659905">//&nbsp;a&nbsp;multiple&nbsp;of&nbsp;any&nbsp;of&nbsp;these&nbsp;primes&nbsp;we&nbsp;add&nbsp;two&nbsp;until&nbsp;it&nbsp;isn&#39;t.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3659971">//&nbsp;The&nbsp;probability&nbsp;of&nbsp;overflowing&nbsp;is&nbsp;minimal&nbsp;and&nbsp;can&nbsp;be&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3660037">//&nbsp;because&nbsp;we&nbsp;still&nbsp;perform&nbsp;Miller-Rabin&nbsp;tests&nbsp;on&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660101"><a href="/crypto/rand/util.go.html#3659070">bigMod</a></span><span class="op" id="3660107">.</span><span class="ident" id="3660108">Mod</span><span class="op" id="3660111">(</span><span class="ident" id="3660112"><a href="/crypto/rand/util.go.html#3658847">p</a></span><span class="op" id="3660113">,</span>&nbsp;<span class="ident" id="3660115"><a href="/crypto/rand/util.go.html#3658567">smallPrimesProduct</a></span><span class="op" id="3660133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660137">mod</span>&nbsp;<span class="op" id="3660141">:=</span>&nbsp;<span class="ident" id="3660144"><a href="/crypto/rand/util.go.html#3659070">bigMod</a></span><span class="op" id="3660150">.</span><span class="ident" id="3660151">Uint64</span><span class="op" id="3660157">(</span><span class="op" id="3660158">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660162">NextDelta</span><span class="op" id="3660171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660175">for</span>&nbsp;<span class="ident" id="3660179">delta</span>&nbsp;<span class="op" id="3660185">:=</span>&nbsp;<span class="ident" id="3660188">uint64</span><span class="op" id="3660194">(</span><span class="num" id="3660195">0</span><span class="op" id="3660196">)</span><span class="op" id="3660197">;</span>&nbsp;<span class="ident" id="3660199"><a href="/crypto/rand/util.go.html#3660179">delta</a></span>&nbsp;<span class="op" id="3660205">&lt;</span>&nbsp;<span class="num" id="3660207">1</span><span class="op" id="3660208">&lt;&lt;</span><span class="num" id="3660210">20</span><span class="op" id="3660212">;</span>&nbsp;<span class="ident" id="3660214"><a href="/crypto/rand/util.go.html#3660179">delta</a></span>&nbsp;<span class="op" id="3660220">+=</span>&nbsp;<span class="num" id="3660223">2</span>&nbsp;<span class="op" id="3660225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660230">m</span>&nbsp;<span class="op" id="3660232">:=</span>&nbsp;<span class="ident" id="3660235"><a href="/crypto/rand/util.go.html#3660137">mod</a></span>&nbsp;<span class="op" id="3660239">+</span>&nbsp;<span class="ident" id="3660241"><a href="/crypto/rand/util.go.html#3660179">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660250">for</span>&nbsp;<span class="ident" id="3660254">_</span><span class="op" id="3660255">,</span>&nbsp;<span class="ident" id="3660257">prime</span>&nbsp;<span class="op" id="3660263">:=</span>&nbsp;<span class="keyword" id="3660266">range</span>&nbsp;<span class="ident" id="3660272"><a href="/crypto/rand/util.go.html#3658236">smallPrimes</a></span>&nbsp;<span class="op" id="3660284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660290">if</span>&nbsp;<span class="ident" id="3660293"><a href="/crypto/rand/util.go.html#3660230">m</a></span><span class="op" id="3660294">%</span><span class="ident" id="3660295">uint64</span><span class="op" id="3660301">(</span><span class="ident" id="3660302"><a href="/crypto/rand/util.go.html#3660257">prime</a></span><span class="op" id="3660307">)</span>&nbsp;<span class="op" id="3660309">==</span>&nbsp;<span class="num" id="3660312">0</span>&nbsp;<span class="op" id="3660314">&amp;&amp;</span>&nbsp;<span class="op" id="3660317">(</span><span class="ident" id="3660318"><a href="/crypto/rand/util.go.html#3658836">bits</a></span>&nbsp;<span class="op" id="3660323">&gt;</span>&nbsp;<span class="num" id="3660325">6</span>&nbsp;<span class="op" id="3660327">||</span>&nbsp;<span class="ident" id="3660330"><a href="/crypto/rand/util.go.html#3660230">m</a></span>&nbsp;<span class="op" id="3660332">!=</span>&nbsp;<span class="ident" id="3660335">uint64</span><span class="op" id="3660341">(</span><span class="ident" id="3660342"><a href="/crypto/rand/util.go.html#3660257">prime</a></span><span class="op" id="3660347">)</span><span class="op" id="3660348">)</span>&nbsp;<span class="op" id="3660350">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660357">continue</span>&nbsp;<span class="ident" id="3660366">NextDelta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660391">if</span>&nbsp;<span class="ident" id="3660394"><a href="/crypto/rand/util.go.html#3660179">delta</a></span>&nbsp;<span class="op" id="3660400">&gt;</span>&nbsp;<span class="num" id="3660402">0</span>&nbsp;<span class="op" id="3660404">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660410"><a href="/crypto/rand/util.go.html#3659070">bigMod</a></span><span class="op" id="3660416">.</span><span class="ident" id="3660417">SetUint64</span><span class="op" id="3660426">(</span><span class="ident" id="3660427"><a href="/crypto/rand/util.go.html#3660179">delta</a></span><span class="op" id="3660432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660438"><a href="/crypto/rand/util.go.html#3658847">p</a></span><span class="op" id="3660439">.</span><span class="ident" id="3660440">Add</span><span class="op" id="3660443">(</span><span class="ident" id="3660444"><a href="/crypto/rand/util.go.html#3658847">p</a></span><span class="op" id="3660445">,</span>&nbsp;<span class="ident" id="3660447"><a href="/crypto/rand/util.go.html#3659070">bigMod</a></span><span class="op" id="3660453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660463">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660471">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3660476">//&nbsp;There&nbsp;is&nbsp;a&nbsp;tiny&nbsp;possibility&nbsp;that,&nbsp;by&nbsp;adding&nbsp;delta,&nbsp;we&nbsp;caused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3660542">//&nbsp;the&nbsp;number&nbsp;to&nbsp;be&nbsp;one&nbsp;bit&nbsp;too&nbsp;long.&nbsp;Thus&nbsp;we&nbsp;check&nbsp;BitLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3660603">//&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660614">if</span>&nbsp;<span class="ident" id="3660617"><a href="/crypto/rand/util.go.html#3658847">p</a></span><span class="op" id="3660618">.</span><span class="ident" id="3660619">ProbablyPrime</span><span class="op" id="3660632">(</span><span class="num" id="3660633">20</span><span class="op" id="3660635">)</span>&nbsp;<span class="op" id="3660637">&amp;&amp;</span>&nbsp;<span class="ident" id="3660640"><a href="/crypto/rand/util.go.html#3658847">p</a></span><span class="op" id="3660641">.</span><span class="ident" id="3660642">BitLen</span><span class="op" id="3660648">(</span><span class="op" id="3660649">)</span>&nbsp;<span class="op" id="3660651">==</span>&nbsp;<span class="ident" id="3660654"><a href="/crypto/rand/util.go.html#3658836">bits</a></span>&nbsp;<span class="op" id="3660659">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660664">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660676">}</span><br>
<span class="lineno"></span><span class="op" id="3660678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3660681">//&nbsp;Int&nbsp;returns&nbsp;a&nbsp;uniform&nbsp;random&nbsp;value&nbsp;in&nbsp;[0,&nbsp;max).&nbsp;It&nbsp;panics&nbsp;if&nbsp;max&nbsp;&lt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="3660755">func</span>&nbsp;<span class="ident" id="3660760">Int</span><span class="op" id="3660763">(</span><span class="ident" id="3660764">rand</span>&nbsp;<span class="ident" id="3660769"><a href="/crypto/rand/util.go.html#3657878">io</a></span><span class="op" id="3660771">.</span><span class="ident" id="3660772">Reader</span><span class="op" id="3660778">,</span>&nbsp;<span class="ident" id="3660780">max</span>&nbsp;<span class="op" id="3660784">*</span><span class="ident" id="3660785"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3660788">.</span><span class="ident" id="3660789">Int</span><span class="op" id="3660792">)</span>&nbsp;<span class="op" id="3660794">(</span><span class="ident" id="3660795">n</span>&nbsp;<span class="op" id="3660797">*</span><span class="ident" id="3660798"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3660801">.</span><span class="ident" id="3660802">Int</span><span class="op" id="3660805">,</span>&nbsp;<span class="ident" id="3660807">err</span>&nbsp;<span class="builtintype" id="3660811">error</span><span class="op" id="3660816">)</span>&nbsp;<span class="op" id="3660818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3660821">if</span>&nbsp;<span class="ident" id="3660824"><a href="/crypto/rand/util.go.html#3660780">max</a></span><span class="op" id="3660827">.</span><span class="ident" id="3660828">Sign</span><span class="op" id="3660832">(</span><span class="op" id="3660833">)</span>&nbsp;<span class="op" id="3660835">&lt;=</span>&nbsp;<span class="num" id="3660838">0</span>&nbsp;<span class="op" id="3660840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3660844">panic</span><span class="op" id="3660849">(</span><span class="string" id="3660850">&#34;crypto/rand:&nbsp;argument&nbsp;to&nbsp;Int&nbsp;is&nbsp;&lt;=&nbsp;0&#34;</span><span class="op" id="3660888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3660891">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660894">k</span>&nbsp;<span class="op" id="3660896">:=</span>&nbsp;<span class="op" id="3660899">(</span><span class="ident" id="3660900"><a href="/crypto/rand/util.go.html#3660780">max</a></span><span class="op" id="3660903">.</span><span class="ident" id="3660904">BitLen</span><span class="op" id="3660910">(</span><span class="op" id="3660911">)</span>&nbsp;<span class="op" id="3660913">+</span>&nbsp;<span class="num" id="3660915">7</span><span class="op" id="3660916">)</span>&nbsp;<span class="op" id="3660918">/</span>&nbsp;<span class="num" id="3660920">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3660924">//&nbsp;b&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bits&nbsp;in&nbsp;the&nbsp;most&nbsp;significant&nbsp;byte&nbsp;of&nbsp;max.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3660989">b</span>&nbsp;<span class="op" id="3660991">:=</span>&nbsp;<span class="builtintype" id="3660994">uint</span><span class="op" id="3660998">(</span><span class="ident" id="3660999"><a href="/crypto/rand/util.go.html#3660780">max</a></span><span class="op" id="3661002">.</span><span class="ident" id="3661003">BitLen</span><span class="op" id="3661009">(</span><span class="op" id="3661010">)</span>&nbsp;<span class="op" id="3661012">%</span>&nbsp;<span class="num" id="3661014">8</span><span class="op" id="3661015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661018">if</span>&nbsp;<span class="ident" id="3661021"><a href="/crypto/rand/util.go.html#3660989">b</a></span>&nbsp;<span class="op" id="3661023">==</span>&nbsp;<span class="num" id="3661026">0</span>&nbsp;<span class="op" id="3661028">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661032"><a href="/crypto/rand/util.go.html#3660989">b</a></span>&nbsp;<span class="op" id="3661034">=</span>&nbsp;<span class="num" id="3661036">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661043">bytes</span>&nbsp;<span class="op" id="3661049">:=</span>&nbsp;<span class="builtinfunc" id="3661052">make</span><span class="op" id="3661056">(</span><span class="op" id="3661057">[</span><span class="op" id="3661058">]</span><span class="builtintype" id="3661059">byte</span><span class="op" id="3661063">,</span>&nbsp;<span class="ident" id="3661065"><a href="/crypto/rand/util.go.html#3660894">k</a></span><span class="op" id="3661066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661069"><a href="/crypto/rand/util.go.html#3660795">n</a></span>&nbsp;<span class="op" id="3661071">=</span>&nbsp;<span class="builtinfunc" id="3661073">new</span><span class="op" id="3661076">(</span><span class="ident" id="3661077"><a href="/crypto/rand/util.go.html#3657884">big</a></span><span class="op" id="3661080">.</span><span class="ident" id="3661081">Int</span><span class="op" id="3661084">)</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661088">for</span>&nbsp;<span class="op" id="3661092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661096">_</span><span class="op" id="3661097">,</span>&nbsp;<span class="ident" id="3661099"><a href="/crypto/rand/util.go.html#3660807">err</a></span>&nbsp;<span class="op" id="3661103">=</span>&nbsp;<span class="ident" id="3661105"><a href="/crypto/rand/util.go.html#3657878">io</a></span><span class="op" id="3661107">.</span><span class="ident" id="3661108">ReadFull</span><span class="op" id="3661116">(</span><span class="ident" id="3661117"><a href="/crypto/rand/util.go.html#3660764">rand</a></span><span class="op" id="3661121">,</span>&nbsp;<span class="ident" id="3661123"><a href="/crypto/rand/util.go.html#3661043">bytes</a></span><span class="op" id="3661128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661132">if</span>&nbsp;<span class="ident" id="3661135"><a href="/crypto/rand/util.go.html#3660807">err</a></span>&nbsp;<span class="op" id="3661139">!=</span>&nbsp;<span class="ident" id="3661142">nil</span>&nbsp;<span class="op" id="3661146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661151">return</span>&nbsp;<span class="ident" id="3661158">nil</span><span class="op" id="3661161">,</span>&nbsp;<span class="ident" id="3661163"><a href="/crypto/rand/util.go.html#3660807">err</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3661174">//&nbsp;Clear&nbsp;bits&nbsp;in&nbsp;the&nbsp;first&nbsp;byte&nbsp;to&nbsp;increase&nbsp;the&nbsp;probability</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3661236">//&nbsp;that&nbsp;the&nbsp;candidate&nbsp;is&nbsp;&lt;&nbsp;max.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661270"><a href="/crypto/rand/util.go.html#3661043">bytes</a></span><span class="op" id="3661275">[</span><span class="num" id="3661276">0</span><span class="op" id="3661277">]</span>&nbsp;<span class="op" id="3661279">&amp;=</span>&nbsp;<span class="builtintype" id="3661282">uint8</span><span class="op" id="3661287">(</span><span class="builtintype" id="3661288">int</span><span class="op" id="3661291">(</span><span class="num" id="3661292">1</span><span class="op" id="3661293">&lt;&lt;</span><span class="ident" id="3661295"><a href="/crypto/rand/util.go.html#3660989">b</a></span><span class="op" id="3661296">)</span>&nbsp;<span class="op" id="3661298">-</span>&nbsp;<span class="num" id="3661300">1</span><span class="op" id="3661301">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3661306"><a href="/crypto/rand/util.go.html#3660795">n</a></span><span class="op" id="3661307">.</span><span class="ident" id="3661308">SetBytes</span><span class="op" id="3661316">(</span><span class="ident" id="3661317"><a href="/crypto/rand/util.go.html#3661043">bytes</a></span><span class="op" id="3661322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661326">if</span>&nbsp;<span class="ident" id="3661329"><a href="/crypto/rand/util.go.html#3660795">n</a></span><span class="op" id="3661330">.</span><span class="ident" id="3661331">Cmp</span><span class="op" id="3661334">(</span><span class="ident" id="3661335"><a href="/crypto/rand/util.go.html#3660780">max</a></span><span class="op" id="3661338">)</span>&nbsp;<span class="op" id="3661340">&lt;</span>&nbsp;<span class="num" id="3661342">0</span>&nbsp;<span class="op" id="3661344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3661349">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661358">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3661361">}</span><br>
<span class="lineno"></span><span class="op" id="3661363">}</span>
</div>
</body>
</html>
