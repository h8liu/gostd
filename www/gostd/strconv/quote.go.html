<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html" class="current">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2133508">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2133563">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2133617">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2133668">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2133724">package</span>&nbsp;<span class="ident" id="2133732">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2133741">import</span>&nbsp;<span class="op" id="2133748">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2133751">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2133766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2133769">const</span>&nbsp;<span class="ident" id="2133775">lowerhex</span>&nbsp;<span class="op" id="2133784">=</span>&nbsp;<span class="string" id="2133786">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2133806">func</span>&nbsp;<span class="ident" id="2133811">quoteWith</span><span class="op" id="2133820">(</span><span class="ident" id="2133821">s</span>&nbsp;<span class="builtintype" id="2133823">string</span><span class="op" id="2133829">,</span>&nbsp;<span class="ident" id="2133831">quote</span>&nbsp;<span class="builtintype" id="2133837">byte</span><span class="op" id="2133841">,</span>&nbsp;<span class="ident" id="2133843">ASCIIonly</span>&nbsp;<span class="builtintype" id="2133853">bool</span><span class="op" id="2133857">)</span>&nbsp;<span class="builtintype" id="2133859">string</span>&nbsp;<span class="op" id="2133866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2133869">var</span>&nbsp;<span class="ident" id="2133873">runeTmp</span>&nbsp;<span class="op" id="2133881">[</span><span class="ident" id="2133882">utf8</span><span class="op" id="2133886">.</span><span class="ident" id="2133887">UTFMax</span><span class="op" id="2133893">]</span><span class="builtintype" id="2133894">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2133900">buf</span>&nbsp;<span class="op" id="2133904">:=</span>&nbsp;<span class="builtinfunc" id="2133907">make</span><span class="op" id="2133911">(</span><span class="op" id="2133912">[</span><span class="op" id="2133913">]</span><span class="builtintype" id="2133914">byte</span><span class="op" id="2133918">,</span>&nbsp;<span class="num" id="2133920">0</span><span class="op" id="2133921">,</span>&nbsp;<span class="num" id="2133923">3</span><span class="op" id="2133924">*</span><span class="builtinfunc" id="2133925">len</span><span class="op" id="2133928">(</span><span class="ident" id="2133929">s</span><span class="op" id="2133930">)</span><span class="op" id="2133931">/</span><span class="num" id="2133932">2</span><span class="op" id="2133933">)</span>&nbsp;<span class="comment" id="2133935">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2133970">buf</span>&nbsp;<span class="op" id="2133974">=</span>&nbsp;<span class="builtinfunc" id="2133976">append</span><span class="op" id="2133982">(</span><span class="ident" id="2133983">buf</span><span class="op" id="2133986">,</span>&nbsp;<span class="ident" id="2133988">quote</span><span class="op" id="2133993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2133996">for</span>&nbsp;<span class="ident" id="2134000">width</span>&nbsp;<span class="op" id="2134006">:=</span>&nbsp;<span class="num" id="2134009">0</span><span class="op" id="2134010">;</span>&nbsp;<span class="builtinfunc" id="2134012">len</span><span class="op" id="2134015">(</span><span class="ident" id="2134016">s</span><span class="op" id="2134017">)</span>&nbsp;<span class="op" id="2134019">&gt;</span>&nbsp;<span class="num" id="2134021">0</span><span class="op" id="2134022">;</span>&nbsp;<span class="ident" id="2134024">s</span>&nbsp;<span class="op" id="2134026">=</span>&nbsp;<span class="ident" id="2134028">s</span><span class="op" id="2134029">[</span><span class="ident" id="2134030">width</span><span class="op" id="2134035">:</span><span class="op" id="2134036">]</span>&nbsp;<span class="op" id="2134038">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134042">r</span>&nbsp;<span class="op" id="2134044">:=</span>&nbsp;<span class="builtintype" id="2134047">rune</span><span class="op" id="2134051">(</span><span class="ident" id="2134052">s</span><span class="op" id="2134053">[</span><span class="num" id="2134054">0</span><span class="op" id="2134055">]</span><span class="op" id="2134056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134060">width</span>&nbsp;<span class="op" id="2134066">=</span>&nbsp;<span class="num" id="2134068">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134072">if</span>&nbsp;<span class="ident" id="2134075">r</span>&nbsp;<span class="op" id="2134077">&gt;=</span>&nbsp;<span class="ident" id="2134080">utf8</span><span class="op" id="2134084">.</span><span class="ident" id="2134085">RuneSelf</span>&nbsp;<span class="op" id="2134094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134099">r</span><span class="op" id="2134100">,</span>&nbsp;<span class="ident" id="2134102">width</span>&nbsp;<span class="op" id="2134108">=</span>&nbsp;<span class="ident" id="2134110">utf8</span><span class="op" id="2134114">.</span><span class="ident" id="2134115">DecodeRuneInString</span><span class="op" id="2134133">(</span><span class="ident" id="2134134">s</span><span class="op" id="2134135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134139">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134143">if</span>&nbsp;<span class="ident" id="2134146">width</span>&nbsp;<span class="op" id="2134152">==</span>&nbsp;<span class="num" id="2134155">1</span>&nbsp;<span class="op" id="2134157">&amp;&amp;</span>&nbsp;<span class="ident" id="2134160">r</span>&nbsp;<span class="op" id="2134162">==</span>&nbsp;<span class="ident" id="2134165">utf8</span><span class="op" id="2134169">.</span><span class="ident" id="2134170">RuneError</span>&nbsp;<span class="op" id="2134180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134185">buf</span>&nbsp;<span class="op" id="2134189">=</span>&nbsp;<span class="builtinfunc" id="2134191">append</span><span class="op" id="2134197">(</span><span class="ident" id="2134198">buf</span><span class="op" id="2134201">,</span>&nbsp;<span class="string" id="2134203">`\x`</span><span class="op" id="2134207">...</span><span class="op" id="2134210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134215">buf</span>&nbsp;<span class="op" id="2134219">=</span>&nbsp;<span class="builtinfunc" id="2134221">append</span><span class="op" id="2134227">(</span><span class="ident" id="2134228">buf</span><span class="op" id="2134231">,</span>&nbsp;<span class="ident" id="2134233">lowerhex</span><span class="op" id="2134241">[</span><span class="ident" id="2134242">s</span><span class="op" id="2134243">[</span><span class="num" id="2134244">0</span><span class="op" id="2134245">]</span><span class="op" id="2134246">&gt;&gt;</span><span class="num" id="2134248">4</span><span class="op" id="2134249">]</span><span class="op" id="2134250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134255">buf</span>&nbsp;<span class="op" id="2134259">=</span>&nbsp;<span class="builtinfunc" id="2134261">append</span><span class="op" id="2134267">(</span><span class="ident" id="2134268">buf</span><span class="op" id="2134271">,</span>&nbsp;<span class="ident" id="2134273">lowerhex</span><span class="op" id="2134281">[</span><span class="ident" id="2134282">s</span><span class="op" id="2134283">[</span><span class="num" id="2134284">0</span><span class="op" id="2134285">]</span><span class="op" id="2134286">&amp;</span><span class="num" id="2134287">0xF</span><span class="op" id="2134290">]</span><span class="op" id="2134291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134296">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134311">if</span>&nbsp;<span class="ident" id="2134314">r</span>&nbsp;<span class="op" id="2134316">==</span>&nbsp;<span class="builtintype" id="2134319">rune</span><span class="op" id="2134323">(</span><span class="ident" id="2134324">quote</span><span class="op" id="2134329">)</span>&nbsp;<span class="op" id="2134331">||</span>&nbsp;<span class="ident" id="2134334">r</span>&nbsp;<span class="op" id="2134336">==</span>&nbsp;<span class="string" id="2134339">&#39;\\&#39;</span>&nbsp;<span class="op" id="2134344">{</span>&nbsp;<span class="comment" id="2134346">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134371">buf</span>&nbsp;<span class="op" id="2134375">=</span>&nbsp;<span class="builtinfunc" id="2134377">append</span><span class="op" id="2134383">(</span><span class="ident" id="2134384">buf</span><span class="op" id="2134387">,</span>&nbsp;<span class="string" id="2134389">&#39;\\&#39;</span><span class="op" id="2134393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134398">buf</span>&nbsp;<span class="op" id="2134402">=</span>&nbsp;<span class="builtinfunc" id="2134404">append</span><span class="op" id="2134410">(</span><span class="ident" id="2134411">buf</span><span class="op" id="2134414">,</span>&nbsp;<span class="builtintype" id="2134416">byte</span><span class="op" id="2134420">(</span><span class="ident" id="2134421">r</span><span class="op" id="2134422">)</span><span class="op" id="2134423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134428">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134443">if</span>&nbsp;<span class="ident" id="2134446">ASCIIonly</span>&nbsp;<span class="op" id="2134456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134461">if</span>&nbsp;<span class="ident" id="2134464">r</span>&nbsp;<span class="op" id="2134466">&lt;</span>&nbsp;<span class="ident" id="2134468">utf8</span><span class="op" id="2134472">.</span><span class="ident" id="2134473">RuneSelf</span>&nbsp;<span class="op" id="2134482">&amp;&amp;</span>&nbsp;<span class="ident" id="2134485">IsPrint</span><span class="op" id="2134492">(</span><span class="ident" id="2134493">r</span><span class="op" id="2134494">)</span>&nbsp;<span class="op" id="2134496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134502">buf</span>&nbsp;<span class="op" id="2134506">=</span>&nbsp;<span class="builtinfunc" id="2134508">append</span><span class="op" id="2134514">(</span><span class="ident" id="2134515">buf</span><span class="op" id="2134518">,</span>&nbsp;<span class="builtintype" id="2134520">byte</span><span class="op" id="2134524">(</span><span class="ident" id="2134525">r</span><span class="op" id="2134526">)</span><span class="op" id="2134527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134533">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134549">}</span>&nbsp;<span class="keyword" id="2134551">else</span>&nbsp;<span class="keyword" id="2134556">if</span>&nbsp;<span class="ident" id="2134559">IsPrint</span><span class="op" id="2134566">(</span><span class="ident" id="2134567">r</span><span class="op" id="2134568">)</span>&nbsp;<span class="op" id="2134570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134575">n</span>&nbsp;<span class="op" id="2134577">:=</span>&nbsp;<span class="ident" id="2134580">utf8</span><span class="op" id="2134584">.</span><span class="ident" id="2134585">EncodeRune</span><span class="op" id="2134595">(</span><span class="ident" id="2134596">runeTmp</span><span class="op" id="2134603">[</span><span class="op" id="2134604">:</span><span class="op" id="2134605">]</span><span class="op" id="2134606">,</span>&nbsp;<span class="ident" id="2134608">r</span><span class="op" id="2134609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134614">buf</span>&nbsp;<span class="op" id="2134618">=</span>&nbsp;<span class="builtinfunc" id="2134620">append</span><span class="op" id="2134626">(</span><span class="ident" id="2134627">buf</span><span class="op" id="2134630">,</span>&nbsp;<span class="ident" id="2134632">runeTmp</span><span class="op" id="2134639">[</span><span class="op" id="2134640">:</span><span class="ident" id="2134641">n</span><span class="op" id="2134642">]</span><span class="op" id="2134643">...</span><span class="op" id="2134646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134651">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134666">switch</span>&nbsp;<span class="ident" id="2134673">r</span>&nbsp;<span class="op" id="2134675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134679">case</span>&nbsp;<span class="string" id="2134684">&#39;\a&#39;</span><span class="op" id="2134688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134693">buf</span>&nbsp;<span class="op" id="2134697">=</span>&nbsp;<span class="builtinfunc" id="2134699">append</span><span class="op" id="2134705">(</span><span class="ident" id="2134706">buf</span><span class="op" id="2134709">,</span>&nbsp;<span class="string" id="2134711">`\a`</span><span class="op" id="2134715">...</span><span class="op" id="2134718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134722">case</span>&nbsp;<span class="string" id="2134727">&#39;\b&#39;</span><span class="op" id="2134731">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134736">buf</span>&nbsp;<span class="op" id="2134740">=</span>&nbsp;<span class="builtinfunc" id="2134742">append</span><span class="op" id="2134748">(</span><span class="ident" id="2134749">buf</span><span class="op" id="2134752">,</span>&nbsp;<span class="string" id="2134754">`\b`</span><span class="op" id="2134758">...</span><span class="op" id="2134761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134765">case</span>&nbsp;<span class="string" id="2134770">&#39;\f&#39;</span><span class="op" id="2134774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134779">buf</span>&nbsp;<span class="op" id="2134783">=</span>&nbsp;<span class="builtinfunc" id="2134785">append</span><span class="op" id="2134791">(</span><span class="ident" id="2134792">buf</span><span class="op" id="2134795">,</span>&nbsp;<span class="string" id="2134797">`\f`</span><span class="op" id="2134801">...</span><span class="op" id="2134804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134808">case</span>&nbsp;<span class="string" id="2134813">&#39;\n&#39;</span><span class="op" id="2134817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134822">buf</span>&nbsp;<span class="op" id="2134826">=</span>&nbsp;<span class="builtinfunc" id="2134828">append</span><span class="op" id="2134834">(</span><span class="ident" id="2134835">buf</span><span class="op" id="2134838">,</span>&nbsp;<span class="string" id="2134840">`\n`</span><span class="op" id="2134844">...</span><span class="op" id="2134847">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134851">case</span>&nbsp;<span class="string" id="2134856">&#39;\r&#39;</span><span class="op" id="2134860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134865">buf</span>&nbsp;<span class="op" id="2134869">=</span>&nbsp;<span class="builtinfunc" id="2134871">append</span><span class="op" id="2134877">(</span><span class="ident" id="2134878">buf</span><span class="op" id="2134881">,</span>&nbsp;<span class="string" id="2134883">`\r`</span><span class="op" id="2134887">...</span><span class="op" id="2134890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134894">case</span>&nbsp;<span class="string" id="2134899">&#39;\t&#39;</span><span class="op" id="2134903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134908">buf</span>&nbsp;<span class="op" id="2134912">=</span>&nbsp;<span class="builtinfunc" id="2134914">append</span><span class="op" id="2134920">(</span><span class="ident" id="2134921">buf</span><span class="op" id="2134924">,</span>&nbsp;<span class="string" id="2134926">`\t`</span><span class="op" id="2134930">...</span><span class="op" id="2134933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134937">case</span>&nbsp;<span class="string" id="2134942">&#39;\v&#39;</span><span class="op" id="2134946">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134951">buf</span>&nbsp;<span class="op" id="2134955">=</span>&nbsp;<span class="builtinfunc" id="2134957">append</span><span class="op" id="2134963">(</span><span class="ident" id="2134964">buf</span><span class="op" id="2134967">,</span>&nbsp;<span class="string" id="2134969">`\v`</span><span class="op" id="2134973">...</span><span class="op" id="2134976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134980">default</span><span class="op" id="2134987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134992">switch</span>&nbsp;<span class="op" id="2134999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135004">case</span>&nbsp;<span class="ident" id="2135009">r</span>&nbsp;<span class="op" id="2135011">&lt;</span>&nbsp;<span class="string" id="2135013">&#39;&nbsp;&#39;</span><span class="op" id="2135016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135022">buf</span>&nbsp;<span class="op" id="2135026">=</span>&nbsp;<span class="builtinfunc" id="2135028">append</span><span class="op" id="2135034">(</span><span class="ident" id="2135035">buf</span><span class="op" id="2135038">,</span>&nbsp;<span class="string" id="2135040">`\x`</span><span class="op" id="2135044">...</span><span class="op" id="2135047">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135053">buf</span>&nbsp;<span class="op" id="2135057">=</span>&nbsp;<span class="builtinfunc" id="2135059">append</span><span class="op" id="2135065">(</span><span class="ident" id="2135066">buf</span><span class="op" id="2135069">,</span>&nbsp;<span class="ident" id="2135071">lowerhex</span><span class="op" id="2135079">[</span><span class="ident" id="2135080">s</span><span class="op" id="2135081">[</span><span class="num" id="2135082">0</span><span class="op" id="2135083">]</span><span class="op" id="2135084">&gt;&gt;</span><span class="num" id="2135086">4</span><span class="op" id="2135087">]</span><span class="op" id="2135088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135094">buf</span>&nbsp;<span class="op" id="2135098">=</span>&nbsp;<span class="builtinfunc" id="2135100">append</span><span class="op" id="2135106">(</span><span class="ident" id="2135107">buf</span><span class="op" id="2135110">,</span>&nbsp;<span class="ident" id="2135112">lowerhex</span><span class="op" id="2135120">[</span><span class="ident" id="2135121">s</span><span class="op" id="2135122">[</span><span class="num" id="2135123">0</span><span class="op" id="2135124">]</span><span class="op" id="2135125">&amp;</span><span class="num" id="2135126">0xF</span><span class="op" id="2135129">]</span><span class="op" id="2135130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135135">case</span>&nbsp;<span class="ident" id="2135140">r</span>&nbsp;<span class="op" id="2135142">&gt;</span>&nbsp;<span class="ident" id="2135144">utf8</span><span class="op" id="2135148">.</span><span class="ident" id="2135149">MaxRune</span><span class="op" id="2135156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135162">r</span>&nbsp;<span class="op" id="2135164">=</span>&nbsp;<span class="num" id="2135166">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135177">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135192">case</span>&nbsp;<span class="ident" id="2135197">r</span>&nbsp;<span class="op" id="2135199">&lt;</span>&nbsp;<span class="num" id="2135201">0x10000</span><span class="op" id="2135208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135214">buf</span>&nbsp;<span class="op" id="2135218">=</span>&nbsp;<span class="builtinfunc" id="2135220">append</span><span class="op" id="2135226">(</span><span class="ident" id="2135227">buf</span><span class="op" id="2135230">,</span>&nbsp;<span class="string" id="2135232">`\u`</span><span class="op" id="2135236">...</span><span class="op" id="2135239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135245">for</span>&nbsp;<span class="ident" id="2135249">s</span>&nbsp;<span class="op" id="2135251">:=</span>&nbsp;<span class="num" id="2135254">12</span><span class="op" id="2135256">;</span>&nbsp;<span class="ident" id="2135258">s</span>&nbsp;<span class="op" id="2135260">&gt;=</span>&nbsp;<span class="num" id="2135263">0</span><span class="op" id="2135264">;</span>&nbsp;<span class="ident" id="2135266">s</span>&nbsp;<span class="op" id="2135268">-=</span>&nbsp;<span class="num" id="2135271">4</span>&nbsp;<span class="op" id="2135273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135280">buf</span>&nbsp;<span class="op" id="2135284">=</span>&nbsp;<span class="builtinfunc" id="2135286">append</span><span class="op" id="2135292">(</span><span class="ident" id="2135293">buf</span><span class="op" id="2135296">,</span>&nbsp;<span class="ident" id="2135298">lowerhex</span><span class="op" id="2135306">[</span><span class="ident" id="2135307">r</span><span class="op" id="2135308">&gt;&gt;</span><span class="builtintype" id="2135310">uint</span><span class="op" id="2135314">(</span><span class="ident" id="2135315">s</span><span class="op" id="2135316">)</span><span class="op" id="2135317">&amp;</span><span class="num" id="2135318">0xF</span><span class="op" id="2135321">]</span><span class="op" id="2135322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135328">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135333">default</span><span class="op" id="2135340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135346">buf</span>&nbsp;<span class="op" id="2135350">=</span>&nbsp;<span class="builtinfunc" id="2135352">append</span><span class="op" id="2135358">(</span><span class="ident" id="2135359">buf</span><span class="op" id="2135362">,</span>&nbsp;<span class="string" id="2135364">`\U`</span><span class="op" id="2135368">...</span><span class="op" id="2135371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135377">for</span>&nbsp;<span class="ident" id="2135381">s</span>&nbsp;<span class="op" id="2135383">:=</span>&nbsp;<span class="num" id="2135386">28</span><span class="op" id="2135388">;</span>&nbsp;<span class="ident" id="2135390">s</span>&nbsp;<span class="op" id="2135392">&gt;=</span>&nbsp;<span class="num" id="2135395">0</span><span class="op" id="2135396">;</span>&nbsp;<span class="ident" id="2135398">s</span>&nbsp;<span class="op" id="2135400">-=</span>&nbsp;<span class="num" id="2135403">4</span>&nbsp;<span class="op" id="2135405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135412">buf</span>&nbsp;<span class="op" id="2135416">=</span>&nbsp;<span class="builtinfunc" id="2135418">append</span><span class="op" id="2135424">(</span><span class="ident" id="2135425">buf</span><span class="op" id="2135428">,</span>&nbsp;<span class="ident" id="2135430">lowerhex</span><span class="op" id="2135438">[</span><span class="ident" id="2135439">r</span><span class="op" id="2135440">&gt;&gt;</span><span class="builtintype" id="2135442">uint</span><span class="op" id="2135446">(</span><span class="ident" id="2135447">s</span><span class="op" id="2135448">)</span><span class="op" id="2135449">&amp;</span><span class="num" id="2135450">0xF</span><span class="op" id="2135453">]</span><span class="op" id="2135454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135460">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135475">buf</span>&nbsp;<span class="op" id="2135479">=</span>&nbsp;<span class="builtinfunc" id="2135481">append</span><span class="op" id="2135487">(</span><span class="ident" id="2135488">buf</span><span class="op" id="2135491">,</span>&nbsp;<span class="ident" id="2135493">quote</span><span class="op" id="2135498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135501">return</span>&nbsp;<span class="builtintype" id="2135508">string</span><span class="op" id="2135514">(</span><span class="ident" id="2135515">buf</span><span class="op" id="2135518">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2135521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2135524">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2135596">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2135667">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2135732">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2135744">func</span>&nbsp;<span class="ident" id="2135749">Quote</span><span class="op" id="2135754">(</span><span class="ident" id="2135755">s</span>&nbsp;<span class="builtintype" id="2135757">string</span><span class="op" id="2135763">)</span>&nbsp;<span class="builtintype" id="2135765">string</span>&nbsp;<span class="op" id="2135772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135775">return</span>&nbsp;<span class="ident" id="2135782">quoteWith</span><span class="op" id="2135791">(</span><span class="ident" id="2135792">s</span><span class="op" id="2135793">,</span>&nbsp;<span class="string" id="2135795">&#39;&#34;&#39;</span><span class="op" id="2135798">,</span>&nbsp;<span class="builtintype" id="2135800">false</span><span class="op" id="2135805">)</span><br>
<span class="lineno"></span><span class="op" id="2135807">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2135810">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2135883">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2135949">func</span>&nbsp;<span class="ident" id="2135954">AppendQuote</span><span class="op" id="2135965">(</span><span class="ident" id="2135966">dst</span>&nbsp;<span class="op" id="2135970">[</span><span class="op" id="2135971">]</span><span class="builtintype" id="2135972">byte</span><span class="op" id="2135976">,</span>&nbsp;<span class="ident" id="2135978">s</span>&nbsp;<span class="builtintype" id="2135980">string</span><span class="op" id="2135986">)</span>&nbsp;<span class="op" id="2135988">[</span><span class="op" id="2135989">]</span><span class="builtintype" id="2135990">byte</span>&nbsp;<span class="op" id="2135995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135998">return</span>&nbsp;<span class="builtinfunc" id="2136005">append</span><span class="op" id="2136011">(</span><span class="ident" id="2136012">dst</span><span class="op" id="2136015">,</span>&nbsp;<span class="ident" id="2136017">Quote</span><span class="op" id="2136022">(</span><span class="ident" id="2136023">s</span><span class="op" id="2136024">)</span><span class="op" id="2136025">...</span><span class="op" id="2136028">)</span><br>
<span class="lineno">100</span><span class="op" id="2136030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2136033">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2136107">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2136182">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2136258">func</span>&nbsp;<span class="ident" id="2136263">QuoteToASCII</span><span class="op" id="2136275">(</span><span class="ident" id="2136276">s</span>&nbsp;<span class="builtintype" id="2136278">string</span><span class="op" id="2136284">)</span>&nbsp;<span class="builtintype" id="2136286">string</span>&nbsp;<span class="op" id="2136293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136296">return</span>&nbsp;<span class="ident" id="2136303">quoteWith</span><span class="op" id="2136312">(</span><span class="ident" id="2136313">s</span><span class="op" id="2136314">,</span>&nbsp;<span class="string" id="2136316">&#39;&#34;&#39;</span><span class="op" id="2136319">,</span>&nbsp;<span class="builtintype" id="2136321">true</span><span class="op" id="2136325">)</span><br>
<span class="lineno"></span><span class="op" id="2136327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2136330">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2136410">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2136483">func</span>&nbsp;<span class="ident" id="2136488">AppendQuoteToASCII</span><span class="op" id="2136506">(</span><span class="ident" id="2136507">dst</span>&nbsp;<span class="op" id="2136511">[</span><span class="op" id="2136512">]</span><span class="builtintype" id="2136513">byte</span><span class="op" id="2136517">,</span>&nbsp;<span class="ident" id="2136519">s</span>&nbsp;<span class="builtintype" id="2136521">string</span><span class="op" id="2136527">)</span>&nbsp;<span class="op" id="2136529">[</span><span class="op" id="2136530">]</span><span class="builtintype" id="2136531">byte</span>&nbsp;<span class="op" id="2136536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136539">return</span>&nbsp;<span class="builtinfunc" id="2136546">append</span><span class="op" id="2136552">(</span><span class="ident" id="2136553">dst</span><span class="op" id="2136556">,</span>&nbsp;<span class="ident" id="2136558">QuoteToASCII</span><span class="op" id="2136570">(</span><span class="ident" id="2136571">s</span><span class="op" id="2136572">)</span><span class="op" id="2136573">...</span><span class="op" id="2136576">)</span><br>
<span class="lineno"></span><span class="op" id="2136578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2136581">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2136656">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2136734">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2136812">func</span>&nbsp;<span class="ident" id="2136817">QuoteRune</span><span class="op" id="2136826">(</span><span class="ident" id="2136827">r</span>&nbsp;<span class="builtintype" id="2136829">rune</span><span class="op" id="2136833">)</span>&nbsp;<span class="builtintype" id="2136835">string</span>&nbsp;<span class="op" id="2136842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2136845">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136882">return</span>&nbsp;<span class="ident" id="2136889">quoteWith</span><span class="op" id="2136898">(</span><span class="builtintype" id="2136899">string</span><span class="op" id="2136905">(</span><span class="ident" id="2136906">r</span><span class="op" id="2136907">)</span><span class="op" id="2136908">,</span>&nbsp;<span class="string" id="2136910">&#39;\&#39;&#39;</span><span class="op" id="2136914">,</span>&nbsp;<span class="builtintype" id="2136916">false</span><span class="op" id="2136921">)</span><br>
<span class="lineno"></span><span class="op" id="2136923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2136926">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2137013">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2137083">func</span>&nbsp;<span class="ident" id="2137088">AppendQuoteRune</span><span class="op" id="2137103">(</span><span class="ident" id="2137104">dst</span>&nbsp;<span class="op" id="2137108">[</span><span class="op" id="2137109">]</span><span class="builtintype" id="2137110">byte</span><span class="op" id="2137114">,</span>&nbsp;<span class="ident" id="2137116">r</span>&nbsp;<span class="builtintype" id="2137118">rune</span><span class="op" id="2137122">)</span>&nbsp;<span class="op" id="2137124">[</span><span class="op" id="2137125">]</span><span class="builtintype" id="2137126">byte</span>&nbsp;<span class="op" id="2137131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137134">return</span>&nbsp;<span class="builtinfunc" id="2137141">append</span><span class="op" id="2137147">(</span><span class="ident" id="2137148">dst</span><span class="op" id="2137151">,</span>&nbsp;<span class="ident" id="2137153">QuoteRune</span><span class="op" id="2137162">(</span><span class="ident" id="2137163">r</span><span class="op" id="2137164">)</span><span class="op" id="2137165">...</span><span class="op" id="2137168">)</span><br>
<span class="lineno"></span><span class="op" id="2137170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2137173">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2137251">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2137325">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2137401">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2137416">func</span>&nbsp;<span class="ident" id="2137421">QuoteRuneToASCII</span><span class="op" id="2137437">(</span><span class="ident" id="2137438">r</span>&nbsp;<span class="builtintype" id="2137440">rune</span><span class="op" id="2137444">)</span>&nbsp;<span class="builtintype" id="2137446">string</span>&nbsp;<span class="op" id="2137453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2137456">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137493">return</span>&nbsp;<span class="ident" id="2137500">quoteWith</span><span class="op" id="2137509">(</span><span class="builtintype" id="2137510">string</span><span class="op" id="2137516">(</span><span class="ident" id="2137517">r</span><span class="op" id="2137518">)</span><span class="op" id="2137519">,</span>&nbsp;<span class="string" id="2137521">&#39;\&#39;&#39;</span><span class="op" id="2137525">,</span>&nbsp;<span class="builtintype" id="2137527">true</span><span class="op" id="2137531">)</span><br>
<span class="lineno"></span><span class="op" id="2137533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2137536">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2137630">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2137707">func</span>&nbsp;<span class="ident" id="2137712">AppendQuoteRuneToASCII</span><span class="op" id="2137734">(</span><span class="ident" id="2137735">dst</span>&nbsp;<span class="op" id="2137739">[</span><span class="op" id="2137740">]</span><span class="builtintype" id="2137741">byte</span><span class="op" id="2137745">,</span>&nbsp;<span class="ident" id="2137747">r</span>&nbsp;<span class="builtintype" id="2137749">rune</span><span class="op" id="2137753">)</span>&nbsp;<span class="op" id="2137755">[</span><span class="op" id="2137756">]</span><span class="builtintype" id="2137757">byte</span>&nbsp;<span class="op" id="2137762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137765">return</span>&nbsp;<span class="builtinfunc" id="2137772">append</span><span class="op" id="2137778">(</span><span class="ident" id="2137779">dst</span><span class="op" id="2137782">,</span>&nbsp;<span class="ident" id="2137784">QuoteRuneToASCII</span><span class="op" id="2137800">(</span><span class="ident" id="2137801">r</span><span class="op" id="2137802">)</span><span class="op" id="2137803">...</span><span class="op" id="2137806">)</span><br>
<span class="lineno"></span><span class="op" id="2137808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2137811">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2137875">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2137939">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2137969">func</span>&nbsp;<span class="ident" id="2137974">CanBackquote</span><span class="op" id="2137986">(</span><span class="ident" id="2137987">s</span>&nbsp;<span class="builtintype" id="2137989">string</span><span class="op" id="2137995">)</span>&nbsp;<span class="builtintype" id="2137997">bool</span>&nbsp;<span class="op" id="2138002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138005">for</span>&nbsp;<span class="builtinfunc" id="2138009">len</span><span class="op" id="2138012">(</span><span class="ident" id="2138013">s</span><span class="op" id="2138014">)</span>&nbsp;<span class="op" id="2138016">&gt;</span>&nbsp;<span class="num" id="2138018">0</span>&nbsp;<span class="op" id="2138020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138024">r</span><span class="op" id="2138025">,</span>&nbsp;<span class="ident" id="2138027">wid</span>&nbsp;<span class="op" id="2138031">:=</span>&nbsp;<span class="ident" id="2138034">utf8</span><span class="op" id="2138038">.</span><span class="ident" id="2138039">DecodeRuneInString</span><span class="op" id="2138057">(</span><span class="ident" id="2138058">s</span><span class="op" id="2138059">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138063">s</span>&nbsp;<span class="op" id="2138065">=</span>&nbsp;<span class="ident" id="2138067">s</span><span class="op" id="2138068">[</span><span class="ident" id="2138069">wid</span><span class="op" id="2138072">:</span><span class="op" id="2138073">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138077">if</span>&nbsp;<span class="ident" id="2138080">wid</span>&nbsp;<span class="op" id="2138084">&gt;</span>&nbsp;<span class="num" id="2138086">1</span>&nbsp;<span class="op" id="2138088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138093">if</span>&nbsp;<span class="ident" id="2138096">r</span>&nbsp;<span class="op" id="2138098">==</span>&nbsp;<span class="string" id="2138101">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2138110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138116">return</span>&nbsp;<span class="builtintype" id="2138123">false</span>&nbsp;<span class="comment" id="2138129">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138180">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138185">continue</span>&nbsp;<span class="comment" id="2138194">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138274">if</span>&nbsp;<span class="ident" id="2138277">r</span>&nbsp;<span class="op" id="2138279">==</span>&nbsp;<span class="ident" id="2138282">utf8</span><span class="op" id="2138286">.</span><span class="ident" id="2138287">RuneError</span>&nbsp;<span class="op" id="2138297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138302">return</span>&nbsp;<span class="builtintype" id="2138309">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138317">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138321">if</span>&nbsp;<span class="op" id="2138324">(</span><span class="ident" id="2138325">r</span>&nbsp;<span class="op" id="2138327">&lt;</span>&nbsp;<span class="string" id="2138329">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2138333">&amp;&amp;</span>&nbsp;<span class="ident" id="2138336">r</span>&nbsp;<span class="op" id="2138338">!=</span>&nbsp;<span class="string" id="2138341">&#39;\t&#39;</span><span class="op" id="2138345">)</span>&nbsp;<span class="op" id="2138347">||</span>&nbsp;<span class="ident" id="2138350">r</span>&nbsp;<span class="op" id="2138352">==</span>&nbsp;<span class="string" id="2138355">&#39;`&#39;</span>&nbsp;<span class="op" id="2138359">||</span>&nbsp;<span class="ident" id="2138362">r</span>&nbsp;<span class="op" id="2138364">==</span>&nbsp;<span class="string" id="2138367">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2138376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138381">return</span>&nbsp;<span class="builtintype" id="2138388">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138402">return</span>&nbsp;<span class="builtintype" id="2138409">true</span><br>
<span class="lineno">165</span><span class="op" id="2138414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2138417">func</span>&nbsp;<span class="ident" id="2138422">unhex</span><span class="op" id="2138427">(</span><span class="ident" id="2138428">b</span>&nbsp;<span class="builtintype" id="2138430">byte</span><span class="op" id="2138434">)</span>&nbsp;<span class="op" id="2138436">(</span><span class="ident" id="2138437">v</span>&nbsp;<span class="builtintype" id="2138439">rune</span><span class="op" id="2138443">,</span>&nbsp;<span class="ident" id="2138445">ok</span>&nbsp;<span class="builtintype" id="2138448">bool</span><span class="op" id="2138452">)</span>&nbsp;<span class="op" id="2138454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138457">c</span>&nbsp;<span class="op" id="2138459">:=</span>&nbsp;<span class="builtintype" id="2138462">rune</span><span class="op" id="2138466">(</span><span class="ident" id="2138467">b</span><span class="op" id="2138468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138471">switch</span>&nbsp;<span class="op" id="2138478">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138481">case</span>&nbsp;<span class="string" id="2138486">&#39;0&#39;</span>&nbsp;<span class="op" id="2138490">&lt;=</span>&nbsp;<span class="ident" id="2138493">c</span>&nbsp;<span class="op" id="2138495">&amp;&amp;</span>&nbsp;<span class="ident" id="2138498">c</span>&nbsp;<span class="op" id="2138500">&lt;=</span>&nbsp;<span class="string" id="2138503">&#39;9&#39;</span><span class="op" id="2138506">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138510">return</span>&nbsp;<span class="ident" id="2138517">c</span>&nbsp;<span class="op" id="2138519">-</span>&nbsp;<span class="string" id="2138521">&#39;0&#39;</span><span class="op" id="2138524">,</span>&nbsp;<span class="builtintype" id="2138526">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138532">case</span>&nbsp;<span class="string" id="2138537">&#39;a&#39;</span>&nbsp;<span class="op" id="2138541">&lt;=</span>&nbsp;<span class="ident" id="2138544">c</span>&nbsp;<span class="op" id="2138546">&amp;&amp;</span>&nbsp;<span class="ident" id="2138549">c</span>&nbsp;<span class="op" id="2138551">&lt;=</span>&nbsp;<span class="string" id="2138554">&#39;f&#39;</span><span class="op" id="2138557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138561">return</span>&nbsp;<span class="ident" id="2138568">c</span>&nbsp;<span class="op" id="2138570">-</span>&nbsp;<span class="string" id="2138572">&#39;a&#39;</span>&nbsp;<span class="op" id="2138576">+</span>&nbsp;<span class="num" id="2138578">10</span><span class="op" id="2138580">,</span>&nbsp;<span class="builtintype" id="2138582">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138588">case</span>&nbsp;<span class="string" id="2138593">&#39;A&#39;</span>&nbsp;<span class="op" id="2138597">&lt;=</span>&nbsp;<span class="ident" id="2138600">c</span>&nbsp;<span class="op" id="2138602">&amp;&amp;</span>&nbsp;<span class="ident" id="2138605">c</span>&nbsp;<span class="op" id="2138607">&lt;=</span>&nbsp;<span class="string" id="2138610">&#39;F&#39;</span><span class="op" id="2138613">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138617">return</span>&nbsp;<span class="ident" id="2138624">c</span>&nbsp;<span class="op" id="2138626">-</span>&nbsp;<span class="string" id="2138628">&#39;A&#39;</span>&nbsp;<span class="op" id="2138632">+</span>&nbsp;<span class="num" id="2138634">10</span><span class="op" id="2138636">,</span>&nbsp;<span class="builtintype" id="2138638">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138647">return</span><br>
<span class="lineno"></span><span class="op" id="2138654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2138657">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2138730">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2138783">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2138810">//</span><br>
<span class="lineno"></span><span class="comment" id="2138813">//&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2138872">//&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2138983">//&nbsp;&nbsp;&nbsp;&nbsp;3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2139048">//&nbsp;&nbsp;&nbsp;&nbsp;4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2139121">//</span><br>
<span class="lineno"></span><span class="comment" id="2139124">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2139198">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2139259">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2139342">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2139412">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2139518">func</span>&nbsp;<span class="ident" id="2139523">UnquoteChar</span><span class="op" id="2139534">(</span><span class="ident" id="2139535">s</span>&nbsp;<span class="builtintype" id="2139537">string</span><span class="op" id="2139543">,</span>&nbsp;<span class="ident" id="2139545">quote</span>&nbsp;<span class="builtintype" id="2139551">byte</span><span class="op" id="2139555">)</span>&nbsp;<span class="op" id="2139557">(</span><span class="ident" id="2139558">value</span>&nbsp;<span class="builtintype" id="2139564">rune</span><span class="op" id="2139568">,</span>&nbsp;<span class="ident" id="2139570">multibyte</span>&nbsp;<span class="builtintype" id="2139580">bool</span><span class="op" id="2139584">,</span>&nbsp;<span class="ident" id="2139586">tail</span>&nbsp;<span class="builtintype" id="2139591">string</span><span class="op" id="2139597">,</span>&nbsp;<span class="ident" id="2139599">err</span>&nbsp;<span class="builtintype" id="2139603">error</span><span class="op" id="2139608">)</span>&nbsp;<span class="op" id="2139610">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2139613">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139628">switch</span>&nbsp;<span class="ident" id="2139635">c</span>&nbsp;<span class="op" id="2139637">:=</span>&nbsp;<span class="ident" id="2139640">s</span><span class="op" id="2139641">[</span><span class="num" id="2139642">0</span><span class="op" id="2139643">]</span><span class="op" id="2139644">;</span>&nbsp;<span class="op" id="2139646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139649">case</span>&nbsp;<span class="ident" id="2139654">c</span>&nbsp;<span class="op" id="2139656">==</span>&nbsp;<span class="ident" id="2139659">quote</span>&nbsp;<span class="op" id="2139665">&amp;&amp;</span>&nbsp;<span class="op" id="2139668">(</span><span class="ident" id="2139669">quote</span>&nbsp;<span class="op" id="2139675">==</span>&nbsp;<span class="string" id="2139678">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2139683">||</span>&nbsp;<span class="ident" id="2139686">quote</span>&nbsp;<span class="op" id="2139692">==</span>&nbsp;<span class="string" id="2139695">&#39;&#34;&#39;</span><span class="op" id="2139698">)</span><span class="op" id="2139699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2139703">err</span>&nbsp;<span class="op" id="2139707">=</span>&nbsp;<span class="ident" id="2139709">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139721">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139729">case</span>&nbsp;<span class="ident" id="2139734">c</span>&nbsp;<span class="op" id="2139736">&gt;=</span>&nbsp;<span class="ident" id="2139739">utf8</span><span class="op" id="2139743">.</span><span class="ident" id="2139744">RuneSelf</span><span class="op" id="2139752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2139756">r</span><span class="op" id="2139757">,</span>&nbsp;<span class="ident" id="2139759">size</span>&nbsp;<span class="op" id="2139764">:=</span>&nbsp;<span class="ident" id="2139767">utf8</span><span class="op" id="2139771">.</span><span class="ident" id="2139772">DecodeRuneInString</span><span class="op" id="2139790">(</span><span class="ident" id="2139791">s</span><span class="op" id="2139792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139796">return</span>&nbsp;<span class="ident" id="2139803">r</span><span class="op" id="2139804">,</span>&nbsp;<span class="builtintype" id="2139806">true</span><span class="op" id="2139810">,</span>&nbsp;<span class="ident" id="2139812">s</span><span class="op" id="2139813">[</span><span class="ident" id="2139814">size</span><span class="op" id="2139818">:</span><span class="op" id="2139819">]</span><span class="op" id="2139820">,</span>&nbsp;<span class="builtintype" id="2139822">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139827">case</span>&nbsp;<span class="ident" id="2139832">c</span>&nbsp;<span class="op" id="2139834">!=</span>&nbsp;<span class="string" id="2139837">&#39;\\&#39;</span><span class="op" id="2139841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139845">return</span>&nbsp;<span class="builtintype" id="2139852">rune</span><span class="op" id="2139856">(</span><span class="ident" id="2139857">s</span><span class="op" id="2139858">[</span><span class="num" id="2139859">0</span><span class="op" id="2139860">]</span><span class="op" id="2139861">)</span><span class="op" id="2139862">,</span>&nbsp;<span class="builtintype" id="2139864">false</span><span class="op" id="2139869">,</span>&nbsp;<span class="ident" id="2139871">s</span><span class="op" id="2139872">[</span><span class="num" id="2139873">1</span><span class="op" id="2139874">:</span><span class="op" id="2139875">]</span><span class="op" id="2139876">,</span>&nbsp;<span class="builtintype" id="2139878">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2139883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2139887">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139917">if</span>&nbsp;<span class="builtinfunc" id="2139920">len</span><span class="op" id="2139923">(</span><span class="ident" id="2139924">s</span><span class="op" id="2139925">)</span>&nbsp;<span class="op" id="2139927">&lt;=</span>&nbsp;<span class="num" id="2139930">1</span>&nbsp;<span class="op" id="2139932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2139936">err</span>&nbsp;<span class="op" id="2139940">=</span>&nbsp;<span class="ident" id="2139942">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139954">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2139962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2139965">c</span>&nbsp;<span class="op" id="2139967">:=</span>&nbsp;<span class="ident" id="2139970">s</span><span class="op" id="2139971">[</span><span class="num" id="2139972">1</span><span class="op" id="2139973">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2139976">s</span>&nbsp;<span class="op" id="2139978">=</span>&nbsp;<span class="ident" id="2139980">s</span><span class="op" id="2139981">[</span><span class="num" id="2139982">2</span><span class="op" id="2139983">:</span><span class="op" id="2139984">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2139988">switch</span>&nbsp;<span class="ident" id="2139995">c</span>&nbsp;<span class="op" id="2139997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140000">case</span>&nbsp;<span class="string" id="2140005">&#39;a&#39;</span><span class="op" id="2140008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140012">value</span>&nbsp;<span class="op" id="2140018">=</span>&nbsp;<span class="string" id="2140020">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140026">case</span>&nbsp;<span class="string" id="2140031">&#39;b&#39;</span><span class="op" id="2140034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140038">value</span>&nbsp;<span class="op" id="2140044">=</span>&nbsp;<span class="string" id="2140046">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140052">case</span>&nbsp;<span class="string" id="2140057">&#39;f&#39;</span><span class="op" id="2140060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140064">value</span>&nbsp;<span class="op" id="2140070">=</span>&nbsp;<span class="string" id="2140072">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140078">case</span>&nbsp;<span class="string" id="2140083">&#39;n&#39;</span><span class="op" id="2140086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140090">value</span>&nbsp;<span class="op" id="2140096">=</span>&nbsp;<span class="string" id="2140098">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140104">case</span>&nbsp;<span class="string" id="2140109">&#39;r&#39;</span><span class="op" id="2140112">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140116">value</span>&nbsp;<span class="op" id="2140122">=</span>&nbsp;<span class="string" id="2140124">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140130">case</span>&nbsp;<span class="string" id="2140135">&#39;t&#39;</span><span class="op" id="2140138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140142">value</span>&nbsp;<span class="op" id="2140148">=</span>&nbsp;<span class="string" id="2140150">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140156">case</span>&nbsp;<span class="string" id="2140161">&#39;v&#39;</span><span class="op" id="2140164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140168">value</span>&nbsp;<span class="op" id="2140174">=</span>&nbsp;<span class="string" id="2140176">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140182">case</span>&nbsp;<span class="string" id="2140187">&#39;x&#39;</span><span class="op" id="2140190">,</span>&nbsp;<span class="string" id="2140192">&#39;u&#39;</span><span class="op" id="2140195">,</span>&nbsp;<span class="string" id="2140197">&#39;U&#39;</span><span class="op" id="2140200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140204">n</span>&nbsp;<span class="op" id="2140206">:=</span>&nbsp;<span class="num" id="2140209">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140213">switch</span>&nbsp;<span class="ident" id="2140220">c</span>&nbsp;<span class="op" id="2140222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140226">case</span>&nbsp;<span class="string" id="2140231">&#39;x&#39;</span><span class="op" id="2140234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140239">n</span>&nbsp;<span class="op" id="2140241">=</span>&nbsp;<span class="num" id="2140243">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140247">case</span>&nbsp;<span class="string" id="2140252">&#39;u&#39;</span><span class="op" id="2140255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140260">n</span>&nbsp;<span class="op" id="2140262">=</span>&nbsp;<span class="num" id="2140264">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140268">case</span>&nbsp;<span class="string" id="2140273">&#39;U&#39;</span><span class="op" id="2140276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140281">n</span>&nbsp;<span class="op" id="2140283">=</span>&nbsp;<span class="num" id="2140285">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140289">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140293">var</span>&nbsp;<span class="ident" id="2140297">v</span>&nbsp;<span class="builtintype" id="2140299">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140306">if</span>&nbsp;<span class="builtinfunc" id="2140309">len</span><span class="op" id="2140312">(</span><span class="ident" id="2140313">s</span><span class="op" id="2140314">)</span>&nbsp;<span class="op" id="2140316">&lt;</span>&nbsp;<span class="ident" id="2140318">n</span>&nbsp;<span class="op" id="2140320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140325">err</span>&nbsp;<span class="op" id="2140329">=</span>&nbsp;<span class="ident" id="2140331">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140344">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140353">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140357">for</span>&nbsp;<span class="ident" id="2140361">j</span>&nbsp;<span class="op" id="2140363">:=</span>&nbsp;<span class="num" id="2140366">0</span><span class="op" id="2140367">;</span>&nbsp;<span class="ident" id="2140369">j</span>&nbsp;<span class="op" id="2140371">&lt;</span>&nbsp;<span class="ident" id="2140373">n</span><span class="op" id="2140374">;</span>&nbsp;<span class="ident" id="2140376">j</span><span class="op" id="2140377">++</span>&nbsp;<span class="op" id="2140380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140385">x</span><span class="op" id="2140386">,</span>&nbsp;<span class="ident" id="2140388">ok</span>&nbsp;<span class="op" id="2140391">:=</span>&nbsp;<span class="ident" id="2140394">unhex</span><span class="op" id="2140399">(</span><span class="ident" id="2140400">s</span><span class="op" id="2140401">[</span><span class="ident" id="2140402">j</span><span class="op" id="2140403">]</span><span class="op" id="2140404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140409">if</span>&nbsp;<span class="op" id="2140412">!</span><span class="ident" id="2140413">ok</span>&nbsp;<span class="op" id="2140416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140422">err</span>&nbsp;<span class="op" id="2140426">=</span>&nbsp;<span class="ident" id="2140428">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140442">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140457">v</span>&nbsp;<span class="op" id="2140459">=</span>&nbsp;<span class="ident" id="2140461">v</span><span class="op" id="2140462">&lt;&lt;</span><span class="num" id="2140464">4</span>&nbsp;<span class="op" id="2140466">|</span>&nbsp;<span class="ident" id="2140468">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140476">s</span>&nbsp;<span class="op" id="2140478">=</span>&nbsp;<span class="ident" id="2140480">s</span><span class="op" id="2140481">[</span><span class="ident" id="2140482">n</span><span class="op" id="2140483">:</span><span class="op" id="2140484">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140488">if</span>&nbsp;<span class="ident" id="2140491">c</span>&nbsp;<span class="op" id="2140493">==</span>&nbsp;<span class="string" id="2140496">&#39;x&#39;</span>&nbsp;<span class="op" id="2140500">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2140505">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140550">value</span>&nbsp;<span class="op" id="2140556">=</span>&nbsp;<span class="ident" id="2140558">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140563">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140575">if</span>&nbsp;<span class="ident" id="2140578">v</span>&nbsp;<span class="op" id="2140580">&gt;</span>&nbsp;<span class="ident" id="2140582">utf8</span><span class="op" id="2140586">.</span><span class="ident" id="2140587">MaxRune</span>&nbsp;<span class="op" id="2140595">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140600">err</span>&nbsp;<span class="op" id="2140604">=</span>&nbsp;<span class="ident" id="2140606">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140619">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140632">value</span>&nbsp;<span class="op" id="2140638">=</span>&nbsp;<span class="ident" id="2140640">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140644">multibyte</span>&nbsp;<span class="op" id="2140654">=</span>&nbsp;<span class="builtintype" id="2140656">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140662">case</span>&nbsp;<span class="string" id="2140667">&#39;0&#39;</span><span class="op" id="2140670">,</span>&nbsp;<span class="string" id="2140672">&#39;1&#39;</span><span class="op" id="2140675">,</span>&nbsp;<span class="string" id="2140677">&#39;2&#39;</span><span class="op" id="2140680">,</span>&nbsp;<span class="string" id="2140682">&#39;3&#39;</span><span class="op" id="2140685">,</span>&nbsp;<span class="string" id="2140687">&#39;4&#39;</span><span class="op" id="2140690">,</span>&nbsp;<span class="string" id="2140692">&#39;5&#39;</span><span class="op" id="2140695">,</span>&nbsp;<span class="string" id="2140697">&#39;6&#39;</span><span class="op" id="2140700">,</span>&nbsp;<span class="string" id="2140702">&#39;7&#39;</span><span class="op" id="2140705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140709">v</span>&nbsp;<span class="op" id="2140711">:=</span>&nbsp;<span class="builtintype" id="2140714">rune</span><span class="op" id="2140718">(</span><span class="ident" id="2140719">c</span><span class="op" id="2140720">)</span>&nbsp;<span class="op" id="2140722">-</span>&nbsp;<span class="string" id="2140724">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140730">if</span>&nbsp;<span class="builtinfunc" id="2140733">len</span><span class="op" id="2140736">(</span><span class="ident" id="2140737">s</span><span class="op" id="2140738">)</span>&nbsp;<span class="op" id="2140740">&lt;</span>&nbsp;<span class="num" id="2140742">2</span>&nbsp;<span class="op" id="2140744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140749">err</span>&nbsp;<span class="op" id="2140753">=</span>&nbsp;<span class="ident" id="2140755">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140768">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140781">for</span>&nbsp;<span class="ident" id="2140785">j</span>&nbsp;<span class="op" id="2140787">:=</span>&nbsp;<span class="num" id="2140790">0</span><span class="op" id="2140791">;</span>&nbsp;<span class="ident" id="2140793">j</span>&nbsp;<span class="op" id="2140795">&lt;</span>&nbsp;<span class="num" id="2140797">2</span><span class="op" id="2140798">;</span>&nbsp;<span class="ident" id="2140800">j</span><span class="op" id="2140801">++</span>&nbsp;<span class="op" id="2140804">{</span>&nbsp;<span class="comment" id="2140806">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140840">x</span>&nbsp;<span class="op" id="2140842">:=</span>&nbsp;<span class="builtintype" id="2140845">rune</span><span class="op" id="2140849">(</span><span class="ident" id="2140850">s</span><span class="op" id="2140851">[</span><span class="ident" id="2140852">j</span><span class="op" id="2140853">]</span><span class="op" id="2140854">)</span>&nbsp;<span class="op" id="2140856">-</span>&nbsp;<span class="string" id="2140858">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140865">if</span>&nbsp;<span class="ident" id="2140868">x</span>&nbsp;<span class="op" id="2140870">&lt;</span>&nbsp;<span class="num" id="2140872">0</span>&nbsp;<span class="op" id="2140874">||</span>&nbsp;<span class="ident" id="2140877">x</span>&nbsp;<span class="op" id="2140879">&gt;</span>&nbsp;<span class="num" id="2140881">7</span>&nbsp;<span class="op" id="2140883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140889">err</span>&nbsp;<span class="op" id="2140893">=</span>&nbsp;<span class="ident" id="2140895">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140909">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140924">v</span>&nbsp;<span class="op" id="2140926">=</span>&nbsp;<span class="op" id="2140928">(</span><span class="ident" id="2140929">v</span>&nbsp;<span class="op" id="2140931">&lt;&lt;</span>&nbsp;<span class="num" id="2140934">3</span><span class="op" id="2140935">)</span>&nbsp;<span class="op" id="2140937">|</span>&nbsp;<span class="ident" id="2140939">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2140943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140947">s</span>&nbsp;<span class="op" id="2140949">=</span>&nbsp;<span class="ident" id="2140951">s</span><span class="op" id="2140952">[</span><span class="num" id="2140953">2</span><span class="op" id="2140954">:</span><span class="op" id="2140955">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140959">if</span>&nbsp;<span class="ident" id="2140962">v</span>&nbsp;<span class="op" id="2140964">&gt;</span>&nbsp;<span class="num" id="2140966">255</span>&nbsp;<span class="op" id="2140970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2140975">err</span>&nbsp;<span class="op" id="2140979">=</span>&nbsp;<span class="ident" id="2140981">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2140994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141007">value</span>&nbsp;<span class="op" id="2141013">=</span>&nbsp;<span class="ident" id="2141015">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141018">case</span>&nbsp;<span class="string" id="2141023">&#39;\\&#39;</span><span class="op" id="2141027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141031">value</span>&nbsp;<span class="op" id="2141037">=</span>&nbsp;<span class="string" id="2141039">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141045">case</span>&nbsp;<span class="string" id="2141050">&#39;\&#39;&#39;</span><span class="op" id="2141054">,</span>&nbsp;<span class="string" id="2141056">&#39;&#34;&#39;</span><span class="op" id="2141059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141063">if</span>&nbsp;<span class="ident" id="2141066">c</span>&nbsp;<span class="op" id="2141068">!=</span>&nbsp;<span class="ident" id="2141071">quote</span>&nbsp;<span class="op" id="2141077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141082">err</span>&nbsp;<span class="op" id="2141086">=</span>&nbsp;<span class="ident" id="2141088">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141101">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141114">value</span>&nbsp;<span class="op" id="2141120">=</span>&nbsp;<span class="builtintype" id="2141122">rune</span><span class="op" id="2141126">(</span><span class="ident" id="2141127">c</span><span class="op" id="2141128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141131">default</span><span class="op" id="2141138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141142">err</span>&nbsp;<span class="op" id="2141146">=</span>&nbsp;<span class="ident" id="2141148">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141160">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141171">tail</span>&nbsp;<span class="op" id="2141176">=</span>&nbsp;<span class="ident" id="2141178">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141181">return</span><br>
<span class="lineno"></span><span class="op" id="2141188">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2141191">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2141250">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2141313">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2141373">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2141429">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2141455">func</span>&nbsp;<span class="ident" id="2141460">Unquote</span><span class="op" id="2141467">(</span><span class="ident" id="2141468">s</span>&nbsp;<span class="builtintype" id="2141470">string</span><span class="op" id="2141476">)</span>&nbsp;<span class="op" id="2141478">(</span><span class="ident" id="2141479">t</span>&nbsp;<span class="builtintype" id="2141481">string</span><span class="op" id="2141487">,</span>&nbsp;<span class="ident" id="2141489">err</span>&nbsp;<span class="builtintype" id="2141493">error</span><span class="op" id="2141498">)</span>&nbsp;<span class="op" id="2141500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141503">n</span>&nbsp;<span class="op" id="2141505">:=</span>&nbsp;<span class="builtinfunc" id="2141508">len</span><span class="op" id="2141511">(</span><span class="ident" id="2141512">s</span><span class="op" id="2141513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141516">if</span>&nbsp;<span class="ident" id="2141519">n</span>&nbsp;<span class="op" id="2141521">&lt;</span>&nbsp;<span class="num" id="2141523">2</span>&nbsp;<span class="op" id="2141525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141529">return</span>&nbsp;<span class="string" id="2141536">&#34;&#34;</span><span class="op" id="2141538">,</span>&nbsp;<span class="ident" id="2141540">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141554">quote</span>&nbsp;<span class="op" id="2141560">:=</span>&nbsp;<span class="ident" id="2141563">s</span><span class="op" id="2141564">[</span><span class="num" id="2141565">0</span><span class="op" id="2141566">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141569">if</span>&nbsp;<span class="ident" id="2141572">quote</span>&nbsp;<span class="op" id="2141578">!=</span>&nbsp;<span class="ident" id="2141581">s</span><span class="op" id="2141582">[</span><span class="ident" id="2141583">n</span><span class="op" id="2141584">-</span><span class="num" id="2141585">1</span><span class="op" id="2141586">]</span>&nbsp;<span class="op" id="2141588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141592">return</span>&nbsp;<span class="string" id="2141599">&#34;&#34;</span><span class="op" id="2141601">,</span>&nbsp;<span class="ident" id="2141603">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141614">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141617">s</span>&nbsp;<span class="op" id="2141619">=</span>&nbsp;<span class="ident" id="2141621">s</span><span class="op" id="2141622">[</span><span class="num" id="2141623">1</span>&nbsp;<span class="op" id="2141625">:</span>&nbsp;<span class="ident" id="2141627">n</span><span class="op" id="2141628">-</span><span class="num" id="2141629">1</span><span class="op" id="2141630">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141634">if</span>&nbsp;<span class="ident" id="2141637">quote</span>&nbsp;<span class="op" id="2141643">==</span>&nbsp;<span class="string" id="2141646">&#39;`&#39;</span>&nbsp;<span class="op" id="2141650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141654">if</span>&nbsp;<span class="ident" id="2141657">contains</span><span class="op" id="2141665">(</span><span class="ident" id="2141666">s</span><span class="op" id="2141667">,</span>&nbsp;<span class="string" id="2141669">&#39;`&#39;</span><span class="op" id="2141672">)</span>&nbsp;<span class="op" id="2141674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141679">return</span>&nbsp;<span class="string" id="2141686">&#34;&#34;</span><span class="op" id="2141688">,</span>&nbsp;<span class="ident" id="2141690">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141706">return</span>&nbsp;<span class="ident" id="2141713">s</span><span class="op" id="2141714">,</span>&nbsp;<span class="builtintype" id="2141716">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141724">if</span>&nbsp;<span class="ident" id="2141727">quote</span>&nbsp;<span class="op" id="2141733">!=</span>&nbsp;<span class="string" id="2141736">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2141740">&amp;&amp;</span>&nbsp;<span class="ident" id="2141743">quote</span>&nbsp;<span class="op" id="2141749">!=</span>&nbsp;<span class="string" id="2141752">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2141757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141761">return</span>&nbsp;<span class="string" id="2141768">&#34;&#34;</span><span class="op" id="2141770">,</span>&nbsp;<span class="ident" id="2141772">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141786">if</span>&nbsp;<span class="ident" id="2141789">contains</span><span class="op" id="2141797">(</span><span class="ident" id="2141798">s</span><span class="op" id="2141799">,</span>&nbsp;<span class="string" id="2141801">&#39;\n&#39;</span><span class="op" id="2141805">)</span>&nbsp;<span class="op" id="2141807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141811">return</span>&nbsp;<span class="string" id="2141818">&#34;&#34;</span><span class="op" id="2141820">,</span>&nbsp;<span class="ident" id="2141822">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2141833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2141837">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141875">if</span>&nbsp;<span class="op" id="2141878">!</span><span class="ident" id="2141879">contains</span><span class="op" id="2141887">(</span><span class="ident" id="2141888">s</span><span class="op" id="2141889">,</span>&nbsp;<span class="string" id="2141891">&#39;\\&#39;</span><span class="op" id="2141895">)</span>&nbsp;<span class="op" id="2141897">&amp;&amp;</span>&nbsp;<span class="op" id="2141900">!</span><span class="ident" id="2141901">contains</span><span class="op" id="2141909">(</span><span class="ident" id="2141910">s</span><span class="op" id="2141911">,</span>&nbsp;<span class="ident" id="2141913">quote</span><span class="op" id="2141918">)</span>&nbsp;<span class="op" id="2141920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141924">switch</span>&nbsp;<span class="ident" id="2141931">quote</span>&nbsp;<span class="op" id="2141937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141941">case</span>&nbsp;<span class="string" id="2141946">&#39;&#34;&#39;</span><span class="op" id="2141949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141954">return</span>&nbsp;<span class="ident" id="2141961">s</span><span class="op" id="2141962">,</span>&nbsp;<span class="builtintype" id="2141964">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2141970">case</span>&nbsp;<span class="string" id="2141975">&#39;\&#39;&#39;</span><span class="op" id="2141979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2141984">r</span><span class="op" id="2141985">,</span>&nbsp;<span class="ident" id="2141987">size</span>&nbsp;<span class="op" id="2141992">:=</span>&nbsp;<span class="ident" id="2141995">utf8</span><span class="op" id="2141999">.</span><span class="ident" id="2142000">DecodeRuneInString</span><span class="op" id="2142018">(</span><span class="ident" id="2142019">s</span><span class="op" id="2142020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142025">if</span>&nbsp;<span class="ident" id="2142028">size</span>&nbsp;<span class="op" id="2142033">==</span>&nbsp;<span class="builtinfunc" id="2142036">len</span><span class="op" id="2142039">(</span><span class="ident" id="2142040">s</span><span class="op" id="2142041">)</span>&nbsp;<span class="op" id="2142043">&amp;&amp;</span>&nbsp;<span class="op" id="2142046">(</span><span class="ident" id="2142047">r</span>&nbsp;<span class="op" id="2142049">!=</span>&nbsp;<span class="ident" id="2142052">utf8</span><span class="op" id="2142056">.</span><span class="ident" id="2142057">RuneError</span>&nbsp;<span class="op" id="2142067">||</span>&nbsp;<span class="ident" id="2142070">size</span>&nbsp;<span class="op" id="2142075">!=</span>&nbsp;<span class="num" id="2142078">1</span><span class="op" id="2142079">)</span>&nbsp;<span class="op" id="2142081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142087">return</span>&nbsp;<span class="ident" id="2142094">s</span><span class="op" id="2142095">,</span>&nbsp;<span class="builtintype" id="2142097">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142104">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142115">var</span>&nbsp;<span class="ident" id="2142119">runeTmp</span>&nbsp;<span class="op" id="2142127">[</span><span class="ident" id="2142128">utf8</span><span class="op" id="2142132">.</span><span class="ident" id="2142133">UTFMax</span><span class="op" id="2142139">]</span><span class="builtintype" id="2142140">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142146">buf</span>&nbsp;<span class="op" id="2142150">:=</span>&nbsp;<span class="builtinfunc" id="2142153">make</span><span class="op" id="2142157">(</span><span class="op" id="2142158">[</span><span class="op" id="2142159">]</span><span class="builtintype" id="2142160">byte</span><span class="op" id="2142164">,</span>&nbsp;<span class="num" id="2142166">0</span><span class="op" id="2142167">,</span>&nbsp;<span class="num" id="2142169">3</span><span class="op" id="2142170">*</span><span class="builtinfunc" id="2142171">len</span><span class="op" id="2142174">(</span><span class="ident" id="2142175">s</span><span class="op" id="2142176">)</span><span class="op" id="2142177">/</span><span class="num" id="2142178">2</span><span class="op" id="2142179">)</span>&nbsp;<span class="comment" id="2142181">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142216">for</span>&nbsp;<span class="builtinfunc" id="2142220">len</span><span class="op" id="2142223">(</span><span class="ident" id="2142224">s</span><span class="op" id="2142225">)</span>&nbsp;<span class="op" id="2142227">&gt;</span>&nbsp;<span class="num" id="2142229">0</span>&nbsp;<span class="op" id="2142231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142235">c</span><span class="op" id="2142236">,</span>&nbsp;<span class="ident" id="2142238">multibyte</span><span class="op" id="2142247">,</span>&nbsp;<span class="ident" id="2142249">ss</span><span class="op" id="2142251">,</span>&nbsp;<span class="ident" id="2142253">err</span>&nbsp;<span class="op" id="2142257">:=</span>&nbsp;<span class="ident" id="2142260">UnquoteChar</span><span class="op" id="2142271">(</span><span class="ident" id="2142272">s</span><span class="op" id="2142273">,</span>&nbsp;<span class="ident" id="2142275">quote</span><span class="op" id="2142280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142284">if</span>&nbsp;<span class="ident" id="2142287">err</span>&nbsp;<span class="op" id="2142291">!=</span>&nbsp;<span class="builtintype" id="2142294">nil</span>&nbsp;<span class="op" id="2142298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142303">return</span>&nbsp;<span class="string" id="2142310">&#34;&#34;</span><span class="op" id="2142312">,</span>&nbsp;<span class="ident" id="2142314">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142320">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142324">s</span>&nbsp;<span class="op" id="2142326">=</span>&nbsp;<span class="ident" id="2142328">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142333">if</span>&nbsp;<span class="ident" id="2142336">c</span>&nbsp;<span class="op" id="2142338">&lt;</span>&nbsp;<span class="ident" id="2142340">utf8</span><span class="op" id="2142344">.</span><span class="ident" id="2142345">RuneSelf</span>&nbsp;<span class="op" id="2142354">||</span>&nbsp;<span class="op" id="2142357">!</span><span class="ident" id="2142358">multibyte</span>&nbsp;<span class="op" id="2142368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142373">buf</span>&nbsp;<span class="op" id="2142377">=</span>&nbsp;<span class="builtinfunc" id="2142379">append</span><span class="op" id="2142385">(</span><span class="ident" id="2142386">buf</span><span class="op" id="2142389">,</span>&nbsp;<span class="builtintype" id="2142391">byte</span><span class="op" id="2142395">(</span><span class="ident" id="2142396">c</span><span class="op" id="2142397">)</span><span class="op" id="2142398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142402">}</span>&nbsp;<span class="keyword" id="2142404">else</span>&nbsp;<span class="op" id="2142409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142414">n</span>&nbsp;<span class="op" id="2142416">:=</span>&nbsp;<span class="ident" id="2142419">utf8</span><span class="op" id="2142423">.</span><span class="ident" id="2142424">EncodeRune</span><span class="op" id="2142434">(</span><span class="ident" id="2142435">runeTmp</span><span class="op" id="2142442">[</span><span class="op" id="2142443">:</span><span class="op" id="2142444">]</span><span class="op" id="2142445">,</span>&nbsp;<span class="ident" id="2142447">c</span><span class="op" id="2142448">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142453">buf</span>&nbsp;<span class="op" id="2142457">=</span>&nbsp;<span class="builtinfunc" id="2142459">append</span><span class="op" id="2142465">(</span><span class="ident" id="2142466">buf</span><span class="op" id="2142469">,</span>&nbsp;<span class="ident" id="2142471">runeTmp</span><span class="op" id="2142478">[</span><span class="op" id="2142479">:</span><span class="ident" id="2142480">n</span><span class="op" id="2142481">]</span><span class="op" id="2142482">...</span><span class="op" id="2142485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142493">if</span>&nbsp;<span class="ident" id="2142496">quote</span>&nbsp;<span class="op" id="2142502">==</span>&nbsp;<span class="string" id="2142505">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2142510">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2142513">len</span><span class="op" id="2142516">(</span><span class="ident" id="2142517">s</span><span class="op" id="2142518">)</span>&nbsp;<span class="op" id="2142520">!=</span>&nbsp;<span class="num" id="2142523">0</span>&nbsp;<span class="op" id="2142525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2142530">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142575">return</span>&nbsp;<span class="string" id="2142582">&#34;&#34;</span><span class="op" id="2142584">,</span>&nbsp;<span class="ident" id="2142586">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142604">return</span>&nbsp;<span class="builtintype" id="2142611">string</span><span class="op" id="2142617">(</span><span class="ident" id="2142618">buf</span><span class="op" id="2142621">)</span><span class="op" id="2142622">,</span>&nbsp;<span class="builtintype" id="2142624">nil</span><br>
<span class="lineno"></span><span class="op" id="2142628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2142631">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2142691">func</span>&nbsp;<span class="ident" id="2142696">contains</span><span class="op" id="2142704">(</span><span class="ident" id="2142705">s</span>&nbsp;<span class="builtintype" id="2142707">string</span><span class="op" id="2142713">,</span>&nbsp;<span class="ident" id="2142715">c</span>&nbsp;<span class="builtintype" id="2142717">byte</span><span class="op" id="2142721">)</span>&nbsp;<span class="builtintype" id="2142723">bool</span>&nbsp;<span class="op" id="2142728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142731">for</span>&nbsp;<span class="ident" id="2142735">i</span>&nbsp;<span class="op" id="2142737">:=</span>&nbsp;<span class="num" id="2142740">0</span><span class="op" id="2142741">;</span>&nbsp;<span class="ident" id="2142743">i</span>&nbsp;<span class="op" id="2142745">&lt;</span>&nbsp;<span class="builtinfunc" id="2142747">len</span><span class="op" id="2142750">(</span><span class="ident" id="2142751">s</span><span class="op" id="2142752">)</span><span class="op" id="2142753">;</span>&nbsp;<span class="ident" id="2142755">i</span><span class="op" id="2142756">++</span>&nbsp;<span class="op" id="2142759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142763">if</span>&nbsp;<span class="ident" id="2142766">s</span><span class="op" id="2142767">[</span><span class="ident" id="2142768">i</span><span class="op" id="2142769">]</span>&nbsp;<span class="op" id="2142771">==</span>&nbsp;<span class="ident" id="2142774">c</span>&nbsp;<span class="op" id="2142776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142781">return</span>&nbsp;<span class="builtintype" id="2142788">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2142798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142801">return</span>&nbsp;<span class="builtintype" id="2142808">false</span><br>
<span class="lineno"></span><span class="op" id="2142814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2142817">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2142874">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2142926">func</span>&nbsp;<span class="ident" id="2142931">bsearch16</span><span class="op" id="2142940">(</span><span class="ident" id="2142941">a</span>&nbsp;<span class="op" id="2142943">[</span><span class="op" id="2142944">]</span><span class="builtintype" id="2142945">uint16</span><span class="op" id="2142951">,</span>&nbsp;<span class="ident" id="2142953">x</span>&nbsp;<span class="builtintype" id="2142955">uint16</span><span class="op" id="2142961">)</span>&nbsp;<span class="builtintype" id="2142963">int</span>&nbsp;<span class="op" id="2142967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2142970">i</span><span class="op" id="2142971">,</span>&nbsp;<span class="ident" id="2142973">j</span>&nbsp;<span class="op" id="2142975">:=</span>&nbsp;<span class="num" id="2142978">0</span><span class="op" id="2142979">,</span>&nbsp;<span class="builtinfunc" id="2142981">len</span><span class="op" id="2142984">(</span><span class="ident" id="2142985">a</span><span class="op" id="2142986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2142989">for</span>&nbsp;<span class="ident" id="2142993">i</span>&nbsp;<span class="op" id="2142995">&lt;</span>&nbsp;<span class="ident" id="2142997">j</span>&nbsp;<span class="op" id="2142999">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143003">h</span>&nbsp;<span class="op" id="2143005">:=</span>&nbsp;<span class="ident" id="2143008">i</span>&nbsp;<span class="op" id="2143010">+</span>&nbsp;<span class="op" id="2143012">(</span><span class="ident" id="2143013">j</span><span class="op" id="2143014">-</span><span class="ident" id="2143015">i</span><span class="op" id="2143016">)</span><span class="op" id="2143017">/</span><span class="num" id="2143018">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143022">if</span>&nbsp;<span class="ident" id="2143025">a</span><span class="op" id="2143026">[</span><span class="ident" id="2143027">h</span><span class="op" id="2143028">]</span>&nbsp;<span class="op" id="2143030">&lt;</span>&nbsp;<span class="ident" id="2143032">x</span>&nbsp;<span class="op" id="2143034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143039">i</span>&nbsp;<span class="op" id="2143041">=</span>&nbsp;<span class="ident" id="2143043">h</span>&nbsp;<span class="op" id="2143045">+</span>&nbsp;<span class="num" id="2143047">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2143051">}</span>&nbsp;<span class="keyword" id="2143053">else</span>&nbsp;<span class="op" id="2143058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143063">j</span>&nbsp;<span class="op" id="2143065">=</span>&nbsp;<span class="ident" id="2143067">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2143071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2143074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143077">return</span>&nbsp;<span class="ident" id="2143084">i</span><br>
<span class="lineno"></span><span class="op" id="2143086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2143089">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2143146">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2143198">func</span>&nbsp;<span class="ident" id="2143203">bsearch32</span><span class="op" id="2143212">(</span><span class="ident" id="2143213">a</span>&nbsp;<span class="op" id="2143215">[</span><span class="op" id="2143216">]</span><span class="builtintype" id="2143217">uint32</span><span class="op" id="2143223">,</span>&nbsp;<span class="ident" id="2143225">x</span>&nbsp;<span class="builtintype" id="2143227">uint32</span><span class="op" id="2143233">)</span>&nbsp;<span class="builtintype" id="2143235">int</span>&nbsp;<span class="op" id="2143239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143242">i</span><span class="op" id="2143243">,</span>&nbsp;<span class="ident" id="2143245">j</span>&nbsp;<span class="op" id="2143247">:=</span>&nbsp;<span class="num" id="2143250">0</span><span class="op" id="2143251">,</span>&nbsp;<span class="builtinfunc" id="2143253">len</span><span class="op" id="2143256">(</span><span class="ident" id="2143257">a</span><span class="op" id="2143258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143261">for</span>&nbsp;<span class="ident" id="2143265">i</span>&nbsp;<span class="op" id="2143267">&lt;</span>&nbsp;<span class="ident" id="2143269">j</span>&nbsp;<span class="op" id="2143271">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143275">h</span>&nbsp;<span class="op" id="2143277">:=</span>&nbsp;<span class="ident" id="2143280">i</span>&nbsp;<span class="op" id="2143282">+</span>&nbsp;<span class="op" id="2143284">(</span><span class="ident" id="2143285">j</span><span class="op" id="2143286">-</span><span class="ident" id="2143287">i</span><span class="op" id="2143288">)</span><span class="op" id="2143289">/</span><span class="num" id="2143290">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143294">if</span>&nbsp;<span class="ident" id="2143297">a</span><span class="op" id="2143298">[</span><span class="ident" id="2143299">h</span><span class="op" id="2143300">]</span>&nbsp;<span class="op" id="2143302">&lt;</span>&nbsp;<span class="ident" id="2143304">x</span>&nbsp;<span class="op" id="2143306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143311">i</span>&nbsp;<span class="op" id="2143313">=</span>&nbsp;<span class="ident" id="2143315">h</span>&nbsp;<span class="op" id="2143317">+</span>&nbsp;<span class="num" id="2143319">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2143323">}</span>&nbsp;<span class="keyword" id="2143325">else</span>&nbsp;<span class="op" id="2143330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2143335">j</span>&nbsp;<span class="op" id="2143337">=</span>&nbsp;<span class="ident" id="2143339">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2143343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2143346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143349">return</span>&nbsp;<span class="ident" id="2143356">i</span><br>
<span class="lineno"></span><span class="op" id="2143358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2143361">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2143446">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2143523">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2143602">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2143672">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2143696">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2143768">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2143842">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2143870">func</span>&nbsp;<span class="ident" id="2143875">IsPrint</span><span class="op" id="2143882">(</span><span class="ident" id="2143883">r</span>&nbsp;<span class="builtintype" id="2143885">rune</span><span class="op" id="2143889">)</span>&nbsp;<span class="builtintype" id="2143891">bool</span>&nbsp;<span class="op" id="2143896">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2143899">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143926">if</span>&nbsp;<span class="ident" id="2143929">r</span>&nbsp;<span class="op" id="2143931">&lt;=</span>&nbsp;<span class="num" id="2143934">0xFF</span>&nbsp;<span class="op" id="2143939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2143943">if</span>&nbsp;<span class="num" id="2143946">0x20</span>&nbsp;<span class="op" id="2143951">&lt;=</span>&nbsp;<span class="ident" id="2143954">r</span>&nbsp;<span class="op" id="2143956">&amp;&amp;</span>&nbsp;<span class="ident" id="2143959">r</span>&nbsp;<span class="op" id="2143961">&lt;=</span>&nbsp;<span class="num" id="2143964">0x7E</span>&nbsp;<span class="op" id="2143969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2143974">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144033">return</span>&nbsp;<span class="builtintype" id="2144040">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2144047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144051">if</span>&nbsp;<span class="num" id="2144054">0xA1</span>&nbsp;<span class="op" id="2144059">&lt;=</span>&nbsp;<span class="ident" id="2144062">r</span>&nbsp;<span class="op" id="2144064">&amp;&amp;</span>&nbsp;<span class="ident" id="2144067">r</span>&nbsp;<span class="op" id="2144069">&lt;=</span>&nbsp;<span class="num" id="2144072">0xFF</span>&nbsp;<span class="op" id="2144077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2144082">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144119">return</span>&nbsp;<span class="ident" id="2144126">r</span>&nbsp;<span class="op" id="2144128">!=</span>&nbsp;<span class="num" id="2144131">0xAD</span>&nbsp;<span class="comment" id="2144136">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2144180">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144184">return</span>&nbsp;<span class="builtintype" id="2144191">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2144198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2144202">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2144256">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2144307">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2144385">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2144458">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144527">if</span>&nbsp;<span class="num" id="2144530">0</span>&nbsp;<span class="op" id="2144532">&lt;=</span>&nbsp;<span class="ident" id="2144535">r</span>&nbsp;<span class="op" id="2144537">&amp;&amp;</span>&nbsp;<span class="ident" id="2144540">r</span>&nbsp;<span class="op" id="2144542">&lt;</span>&nbsp;<span class="num" id="2144544">1</span><span class="op" id="2144545">&lt;&lt;</span><span class="num" id="2144547">16</span>&nbsp;<span class="op" id="2144550">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2144554">rr</span><span class="op" id="2144556">,</span>&nbsp;<span class="ident" id="2144558">isPrint</span><span class="op" id="2144565">,</span>&nbsp;<span class="ident" id="2144567">isNotPrint</span>&nbsp;<span class="op" id="2144578">:=</span>&nbsp;<span class="builtintype" id="2144581">uint16</span><span class="op" id="2144587">(</span><span class="ident" id="2144588">r</span><span class="op" id="2144589">)</span><span class="op" id="2144590">,</span>&nbsp;<span class="ident" id="2144592">isPrint16</span><span class="op" id="2144601">,</span>&nbsp;<span class="ident" id="2144603">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2144618">i</span>&nbsp;<span class="op" id="2144620">:=</span>&nbsp;<span class="ident" id="2144623">bsearch16</span><span class="op" id="2144632">(</span><span class="ident" id="2144633">isPrint</span><span class="op" id="2144640">,</span>&nbsp;<span class="ident" id="2144642">rr</span><span class="op" id="2144644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144648">if</span>&nbsp;<span class="ident" id="2144651">i</span>&nbsp;<span class="op" id="2144653">&gt;=</span>&nbsp;<span class="builtinfunc" id="2144656">len</span><span class="op" id="2144659">(</span><span class="ident" id="2144660">isPrint</span><span class="op" id="2144667">)</span>&nbsp;<span class="op" id="2144669">||</span>&nbsp;<span class="ident" id="2144672">rr</span>&nbsp;<span class="op" id="2144675">&lt;</span>&nbsp;<span class="ident" id="2144677">isPrint</span><span class="op" id="2144684">[</span><span class="ident" id="2144685">i</span><span class="op" id="2144686">&amp;^</span><span class="num" id="2144688">1</span><span class="op" id="2144689">]</span>&nbsp;<span class="op" id="2144691">||</span>&nbsp;<span class="ident" id="2144694">isPrint</span><span class="op" id="2144701">[</span><span class="ident" id="2144702">i</span><span class="op" id="2144703">|</span><span class="num" id="2144704">1</span><span class="op" id="2144705">]</span>&nbsp;<span class="op" id="2144707">&lt;</span>&nbsp;<span class="ident" id="2144709">rr</span>&nbsp;<span class="op" id="2144712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144717">return</span>&nbsp;<span class="builtintype" id="2144724">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2144732">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2144736">j</span>&nbsp;<span class="op" id="2144738">:=</span>&nbsp;<span class="ident" id="2144741">bsearch16</span><span class="op" id="2144750">(</span><span class="ident" id="2144751">isNotPrint</span><span class="op" id="2144761">,</span>&nbsp;<span class="ident" id="2144763">rr</span><span class="op" id="2144765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144769">return</span>&nbsp;<span class="ident" id="2144776">j</span>&nbsp;<span class="op" id="2144778">&gt;=</span>&nbsp;<span class="builtinfunc" id="2144781">len</span><span class="op" id="2144784">(</span><span class="ident" id="2144785">isNotPrint</span><span class="op" id="2144795">)</span>&nbsp;<span class="op" id="2144797">||</span>&nbsp;<span class="ident" id="2144800">isNotPrint</span><span class="op" id="2144810">[</span><span class="ident" id="2144811">j</span><span class="op" id="2144812">]</span>&nbsp;<span class="op" id="2144814">!=</span>&nbsp;<span class="ident" id="2144817">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2144821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2144825">rr</span><span class="op" id="2144827">,</span>&nbsp;<span class="ident" id="2144829">isPrint</span><span class="op" id="2144836">,</span>&nbsp;<span class="ident" id="2144838">isNotPrint</span>&nbsp;<span class="op" id="2144849">:=</span>&nbsp;<span class="builtintype" id="2144852">uint32</span><span class="op" id="2144858">(</span><span class="ident" id="2144859">r</span><span class="op" id="2144860">)</span><span class="op" id="2144861">,</span>&nbsp;<span class="ident" id="2144863">isPrint32</span><span class="op" id="2144872">,</span>&nbsp;<span class="ident" id="2144874">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2144888">i</span>&nbsp;<span class="op" id="2144890">:=</span>&nbsp;<span class="ident" id="2144893">bsearch32</span><span class="op" id="2144902">(</span><span class="ident" id="2144903">isPrint</span><span class="op" id="2144910">,</span>&nbsp;<span class="ident" id="2144912">rr</span><span class="op" id="2144914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144917">if</span>&nbsp;<span class="ident" id="2144920">i</span>&nbsp;<span class="op" id="2144922">&gt;=</span>&nbsp;<span class="builtinfunc" id="2144925">len</span><span class="op" id="2144928">(</span><span class="ident" id="2144929">isPrint</span><span class="op" id="2144936">)</span>&nbsp;<span class="op" id="2144938">||</span>&nbsp;<span class="ident" id="2144941">rr</span>&nbsp;<span class="op" id="2144944">&lt;</span>&nbsp;<span class="ident" id="2144946">isPrint</span><span class="op" id="2144953">[</span><span class="ident" id="2144954">i</span><span class="op" id="2144955">&amp;^</span><span class="num" id="2144957">1</span><span class="op" id="2144958">]</span>&nbsp;<span class="op" id="2144960">||</span>&nbsp;<span class="ident" id="2144963">isPrint</span><span class="op" id="2144970">[</span><span class="ident" id="2144971">i</span><span class="op" id="2144972">|</span><span class="num" id="2144973">1</span><span class="op" id="2144974">]</span>&nbsp;<span class="op" id="2144976">&lt;</span>&nbsp;<span class="ident" id="2144978">rr</span>&nbsp;<span class="op" id="2144981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2144985">return</span>&nbsp;<span class="builtintype" id="2144992">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2144999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2145002">if</span>&nbsp;<span class="ident" id="2145005">r</span>&nbsp;<span class="op" id="2145007">&gt;=</span>&nbsp;<span class="num" id="2145010">0x20000</span>&nbsp;<span class="op" id="2145018">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2145022">return</span>&nbsp;<span class="builtintype" id="2145029">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2145035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2145038">r</span>&nbsp;<span class="op" id="2145040">-=</span>&nbsp;<span class="num" id="2145043">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2145052">j</span>&nbsp;<span class="op" id="2145054">:=</span>&nbsp;<span class="ident" id="2145057">bsearch16</span><span class="op" id="2145066">(</span><span class="ident" id="2145067">isNotPrint</span><span class="op" id="2145077">,</span>&nbsp;<span class="builtintype" id="2145079">uint16</span><span class="op" id="2145085">(</span><span class="ident" id="2145086">r</span><span class="op" id="2145087">)</span><span class="op" id="2145088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2145091">return</span>&nbsp;<span class="ident" id="2145098">j</span>&nbsp;<span class="op" id="2145100">&gt;=</span>&nbsp;<span class="builtinfunc" id="2145103">len</span><span class="op" id="2145106">(</span><span class="ident" id="2145107">isNotPrint</span><span class="op" id="2145117">)</span>&nbsp;<span class="op" id="2145119">||</span>&nbsp;<span class="ident" id="2145122">isNotPrint</span><span class="op" id="2145132">[</span><span class="ident" id="2145133">j</span><span class="op" id="2145134">]</span>&nbsp;<span class="op" id="2145136">!=</span>&nbsp;<span class="builtintype" id="2145139">uint16</span><span class="op" id="2145145">(</span><span class="ident" id="2145146">r</span><span class="op" id="2145147">)</span><br>
<span class="lineno">455</span><span class="op" id="2145149">}</span>
</div>
</body>
</html>
