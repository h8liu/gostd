<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1597038">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1597093">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1597147">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1597198">package</span>&nbsp;<span class="ident" id="1597206">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1597212">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1597278">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1597332">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1597383">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1597438">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1597468">//</span><br>
<span class="lineno"></span><span class="comment" id="1597471">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1597527">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1597596">//</span><br>
<span class="lineno"></span><span class="comment" id="1597599">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1597658">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1597714">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1597771">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1597788">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1597844">//</span><br>
<span class="lineno">25</span><span class="comment" id="1597847">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1597889">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="1597949">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1597963">//</span><br>
<span class="lineno"></span><span class="comment" id="1597966">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="1597984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="1598049">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="1598112">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="1598146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="1598180">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="1598214">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="1598266">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="1598306">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1598361">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="1598416">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="1598473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1598526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1598580">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="1598614">//</span><br>
<span class="lineno"></span><span class="comment" id="1598617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="1598668">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="1598715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1598739">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="1598800">//</span><br>
<span class="lineno">50</span><span class="comment" id="1598803">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1598825">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1598845">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1598865">func</span>&nbsp;<span class="ident" id="1598870">Jn</span><span class="op" id="1598872">(</span><span class="ident" id="1598873">n</span>&nbsp;<span class="builtintype" id="1598875">int</span><span class="op" id="1598878">,</span>&nbsp;<span class="ident" id="1598880">x</span>&nbsp;<span class="builtintype" id="1598882">float64</span><span class="op" id="1598889">)</span>&nbsp;<span class="builtintype" id="1598891">float64</span>&nbsp;<span class="op" id="1598899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1598902">const</span>&nbsp;<span class="op" id="1598908">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1598912">TwoM29</span>&nbsp;<span class="op" id="1598919">=</span>&nbsp;<span class="num" id="1598921">1.0</span>&nbsp;<span class="op" id="1598925">/</span>&nbsp;<span class="op" id="1598927">(</span><span class="num" id="1598928">1</span>&nbsp;<span class="op" id="1598930">&lt;&lt;</span>&nbsp;<span class="num" id="1598933">29</span><span class="op" id="1598935">)</span>&nbsp;<span class="comment" id="1598937">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1598968">Two302</span>&nbsp;<span class="op" id="1598975">=</span>&nbsp;<span class="num" id="1598977">1</span>&nbsp;<span class="op" id="1598979">&lt;&lt;</span>&nbsp;<span class="num" id="1598982">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1598993">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599026">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599044">switch</span>&nbsp;<span class="op" id="1599051">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599054">case</span>&nbsp;<span class="ident" id="1599059">IsNaN</span><span class="op" id="1599064">(</span><span class="ident" id="1599065">x</span><span class="op" id="1599066">)</span><span class="op" id="1599067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599071">return</span>&nbsp;<span class="ident" id="1599078">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599081">case</span>&nbsp;<span class="ident" id="1599086">IsInf</span><span class="op" id="1599091">(</span><span class="ident" id="1599092">x</span><span class="op" id="1599093">,</span>&nbsp;<span class="num" id="1599095">0</span><span class="op" id="1599096">)</span><span class="op" id="1599097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599101">return</span>&nbsp;<span class="num" id="1599108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599111">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599114">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599177">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599208">if</span>&nbsp;<span class="ident" id="1599211">n</span>&nbsp;<span class="op" id="1599213">==</span>&nbsp;<span class="num" id="1599216">0</span>&nbsp;<span class="op" id="1599218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599222">return</span>&nbsp;<span class="ident" id="1599229">J0</span><span class="op" id="1599231">(</span><span class="ident" id="1599232">x</span><span class="op" id="1599233">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599239">if</span>&nbsp;<span class="ident" id="1599242">x</span>&nbsp;<span class="op" id="1599244">==</span>&nbsp;<span class="num" id="1599247">0</span>&nbsp;<span class="op" id="1599249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599253">return</span>&nbsp;<span class="num" id="1599260">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599266">if</span>&nbsp;<span class="ident" id="1599269">n</span>&nbsp;<span class="op" id="1599271">&lt;</span>&nbsp;<span class="num" id="1599273">0</span>&nbsp;<span class="op" id="1599275">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1599279">n</span><span class="op" id="1599280">,</span>&nbsp;<span class="ident" id="1599282">x</span>&nbsp;<span class="op" id="1599284">=</span>&nbsp;<span class="op" id="1599286">-</span><span class="ident" id="1599287">n</span><span class="op" id="1599288">,</span>&nbsp;<span class="op" id="1599290">-</span><span class="ident" id="1599291">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599297">if</span>&nbsp;<span class="ident" id="1599300">n</span>&nbsp;<span class="op" id="1599302">==</span>&nbsp;<span class="num" id="1599305">1</span>&nbsp;<span class="op" id="1599307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599311">return</span>&nbsp;<span class="ident" id="1599318">J1</span><span class="op" id="1599320">(</span><span class="ident" id="1599321">x</span><span class="op" id="1599322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599325">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1599328">sign</span>&nbsp;<span class="op" id="1599333">:=</span>&nbsp;<span class="builtintype" id="1599336">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599343">if</span>&nbsp;<span class="ident" id="1599346">x</span>&nbsp;<span class="op" id="1599348">&lt;</span>&nbsp;<span class="num" id="1599350">0</span>&nbsp;<span class="op" id="1599352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1599356">x</span>&nbsp;<span class="op" id="1599358">=</span>&nbsp;<span class="op" id="1599360">-</span><span class="ident" id="1599361">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599365">if</span>&nbsp;<span class="ident" id="1599368">n</span><span class="op" id="1599369">&amp;</span><span class="num" id="1599370">1</span>&nbsp;<span class="op" id="1599372">==</span>&nbsp;<span class="num" id="1599375">1</span>&nbsp;<span class="op" id="1599377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1599382">sign</span>&nbsp;<span class="op" id="1599387">=</span>&nbsp;<span class="builtintype" id="1599389">true</span>&nbsp;<span class="comment" id="1599394">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1599423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599426">var</span>&nbsp;<span class="ident" id="1599430">b</span>&nbsp;<span class="builtintype" id="1599432">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599441">if</span>&nbsp;<span class="builtintype" id="1599444">float64</span><span class="op" id="1599451">(</span><span class="ident" id="1599452">n</span><span class="op" id="1599453">)</span>&nbsp;<span class="op" id="1599455">&lt;=</span>&nbsp;<span class="ident" id="1599458">x</span>&nbsp;<span class="op" id="1599460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599464">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1599512">if</span>&nbsp;<span class="ident" id="1599515">x</span>&nbsp;<span class="op" id="1599517">&gt;=</span>&nbsp;<span class="ident" id="1599520">Two302</span>&nbsp;<span class="op" id="1599527">{</span>&nbsp;<span class="comment" id="1599529">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599547">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599620">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599675">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599714">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599771">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599777">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1599983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600031">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600080">var</span>&nbsp;<span class="ident" id="1600084">temp</span>&nbsp;<span class="builtintype" id="1600089">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600100">switch</span>&nbsp;<span class="ident" id="1600107">n</span>&nbsp;<span class="op" id="1600109">&amp;</span>&nbsp;<span class="num" id="1600111">3</span>&nbsp;<span class="op" id="1600113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600118">case</span>&nbsp;<span class="num" id="1600123">0</span><span class="op" id="1600124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600130">temp</span>&nbsp;<span class="op" id="1600135">=</span>&nbsp;<span class="ident" id="1600137">Cos</span><span class="op" id="1600140">(</span><span class="ident" id="1600141">x</span><span class="op" id="1600142">)</span>&nbsp;<span class="op" id="1600144">+</span>&nbsp;<span class="ident" id="1600146">Sin</span><span class="op" id="1600149">(</span><span class="ident" id="1600150">x</span><span class="op" id="1600151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600156">case</span>&nbsp;<span class="num" id="1600161">1</span><span class="op" id="1600162">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600168">temp</span>&nbsp;<span class="op" id="1600173">=</span>&nbsp;<span class="op" id="1600175">-</span><span class="ident" id="1600176">Cos</span><span class="op" id="1600179">(</span><span class="ident" id="1600180">x</span><span class="op" id="1600181">)</span>&nbsp;<span class="op" id="1600183">+</span>&nbsp;<span class="ident" id="1600185">Sin</span><span class="op" id="1600188">(</span><span class="ident" id="1600189">x</span><span class="op" id="1600190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600195">case</span>&nbsp;<span class="num" id="1600200">2</span><span class="op" id="1600201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600207">temp</span>&nbsp;<span class="op" id="1600212">=</span>&nbsp;<span class="op" id="1600214">-</span><span class="ident" id="1600215">Cos</span><span class="op" id="1600218">(</span><span class="ident" id="1600219">x</span><span class="op" id="1600220">)</span>&nbsp;<span class="op" id="1600222">-</span>&nbsp;<span class="ident" id="1600224">Sin</span><span class="op" id="1600227">(</span><span class="ident" id="1600228">x</span><span class="op" id="1600229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600234">case</span>&nbsp;<span class="num" id="1600239">3</span><span class="op" id="1600240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600246">temp</span>&nbsp;<span class="op" id="1600251">=</span>&nbsp;<span class="ident" id="1600253">Cos</span><span class="op" id="1600256">(</span><span class="ident" id="1600257">x</span><span class="op" id="1600258">)</span>&nbsp;<span class="op" id="1600260">-</span>&nbsp;<span class="ident" id="1600262">Sin</span><span class="op" id="1600265">(</span><span class="ident" id="1600266">x</span><span class="op" id="1600267">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600277">b</span>&nbsp;<span class="op" id="1600279">=</span>&nbsp;<span class="op" id="1600281">(</span><span class="num" id="1600282">1</span>&nbsp;<span class="op" id="1600284">/</span>&nbsp;<span class="ident" id="1600286">SqrtPi</span><span class="op" id="1600292">)</span>&nbsp;<span class="op" id="1600294">*</span>&nbsp;<span class="ident" id="1600296">temp</span>&nbsp;<span class="op" id="1600301">/</span>&nbsp;<span class="ident" id="1600303">Sqrt</span><span class="op" id="1600307">(</span><span class="ident" id="1600308">x</span><span class="op" id="1600309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600313">}</span>&nbsp;<span class="keyword" id="1600315">else</span>&nbsp;<span class="op" id="1600320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600325">b</span>&nbsp;<span class="op" id="1600327">=</span>&nbsp;<span class="ident" id="1600329">J1</span><span class="op" id="1600331">(</span><span class="ident" id="1600332">x</span><span class="op" id="1600333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600338">for</span>&nbsp;<span class="ident" id="1600342">i</span><span class="op" id="1600343">,</span>&nbsp;<span class="ident" id="1600345">a</span>&nbsp;<span class="op" id="1600347">:=</span>&nbsp;<span class="num" id="1600350">1</span><span class="op" id="1600351">,</span>&nbsp;<span class="ident" id="1600353">J0</span><span class="op" id="1600355">(</span><span class="ident" id="1600356">x</span><span class="op" id="1600357">)</span><span class="op" id="1600358">;</span>&nbsp;<span class="ident" id="1600360">i</span>&nbsp;<span class="op" id="1600362">&lt;</span>&nbsp;<span class="ident" id="1600364">n</span><span class="op" id="1600365">;</span>&nbsp;<span class="ident" id="1600367">i</span><span class="op" id="1600368">++</span>&nbsp;<span class="op" id="1600371">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600377">a</span><span class="op" id="1600378">,</span>&nbsp;<span class="ident" id="1600380">b</span>&nbsp;<span class="op" id="1600382">=</span>&nbsp;<span class="ident" id="1600384">b</span><span class="op" id="1600385">,</span>&nbsp;<span class="ident" id="1600387">b</span><span class="op" id="1600388">*</span><span class="op" id="1600389">(</span><span class="builtintype" id="1600390">float64</span><span class="op" id="1600397">(</span><span class="ident" id="1600398">i</span><span class="op" id="1600399">+</span><span class="ident" id="1600400">i</span><span class="op" id="1600401">)</span><span class="op" id="1600402">/</span><span class="ident" id="1600403">x</span><span class="op" id="1600404">)</span><span class="op" id="1600405">-</span><span class="ident" id="1600406">a</span>&nbsp;<span class="comment" id="1600408">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600437">}</span>&nbsp;<span class="keyword" id="1600439">else</span>&nbsp;<span class="op" id="1600444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600448">if</span>&nbsp;<span class="ident" id="1600451">x</span>&nbsp;<span class="op" id="1600453">&lt;</span>&nbsp;<span class="ident" id="1600455">TwoM29</span>&nbsp;<span class="op" id="1600462">{</span>&nbsp;<span class="comment" id="1600464">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600481">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600542">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600579">if</span>&nbsp;<span class="ident" id="1600582">n</span>&nbsp;<span class="op" id="1600584">&gt;</span>&nbsp;<span class="num" id="1600586">33</span>&nbsp;<span class="op" id="1600589">{</span>&nbsp;<span class="comment" id="1600591">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600608">b</span>&nbsp;<span class="op" id="1600610">=</span>&nbsp;<span class="num" id="1600612">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600617">}</span>&nbsp;<span class="keyword" id="1600619">else</span>&nbsp;<span class="op" id="1600624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600630">temp</span>&nbsp;<span class="op" id="1600635">:=</span>&nbsp;<span class="ident" id="1600638">x</span>&nbsp;<span class="op" id="1600640">*</span>&nbsp;<span class="num" id="1600642">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600650">b</span>&nbsp;<span class="op" id="1600652">=</span>&nbsp;<span class="ident" id="1600654">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600663">a</span>&nbsp;<span class="op" id="1600665">:=</span>&nbsp;<span class="num" id="1600668">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1600676">for</span>&nbsp;<span class="ident" id="1600680">i</span>&nbsp;<span class="op" id="1600682">:=</span>&nbsp;<span class="num" id="1600685">2</span><span class="op" id="1600686">;</span>&nbsp;<span class="ident" id="1600688">i</span>&nbsp;<span class="op" id="1600690">&lt;=</span>&nbsp;<span class="ident" id="1600693">n</span><span class="op" id="1600694">;</span>&nbsp;<span class="ident" id="1600696">i</span><span class="op" id="1600697">++</span>&nbsp;<span class="op" id="1600700">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600707">a</span>&nbsp;<span class="op" id="1600709">*=</span>&nbsp;<span class="builtintype" id="1600712">float64</span><span class="op" id="1600719">(</span><span class="ident" id="1600720">i</span><span class="op" id="1600721">)</span>&nbsp;<span class="comment" id="1600723">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600738">b</span>&nbsp;<span class="op" id="1600740">*=</span>&nbsp;<span class="ident" id="1600743">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1600754">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1600780">b</span>&nbsp;<span class="op" id="1600782">/=</span>&nbsp;<span class="ident" id="1600785">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600790">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1600794">}</span>&nbsp;<span class="keyword" id="1600796">else</span>&nbsp;<span class="op" id="1600801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600806">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600885">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600942">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600991">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1600997">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601042">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601098">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601196">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601242">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601248">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601302">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601344">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601369">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601406">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601434">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601470">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601501">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601536">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601573">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601579">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601625">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601660">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601698">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601736">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601774">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1601817">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601835">w</span>&nbsp;<span class="op" id="1601837">:=</span>&nbsp;<span class="builtintype" id="1601840">float64</span><span class="op" id="1601847">(</span><span class="ident" id="1601848">n</span><span class="op" id="1601849">+</span><span class="ident" id="1601850">n</span><span class="op" id="1601851">)</span>&nbsp;<span class="op" id="1601853">/</span>&nbsp;<span class="ident" id="1601855">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601860">h</span>&nbsp;<span class="op" id="1601862">:=</span>&nbsp;<span class="num" id="1601865">2</span>&nbsp;<span class="op" id="1601867">/</span>&nbsp;<span class="ident" id="1601869">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601874">q0</span>&nbsp;<span class="op" id="1601877">:=</span>&nbsp;<span class="ident" id="1601880">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601885">z</span>&nbsp;<span class="op" id="1601887">:=</span>&nbsp;<span class="ident" id="1601890">w</span>&nbsp;<span class="op" id="1601892">+</span>&nbsp;<span class="ident" id="1601894">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601899">q1</span>&nbsp;<span class="op" id="1601902">:=</span>&nbsp;<span class="ident" id="1601905">w</span><span class="op" id="1601906">*</span><span class="ident" id="1601907">z</span>&nbsp;<span class="op" id="1601909">-</span>&nbsp;<span class="num" id="1601911">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601916">k</span>&nbsp;<span class="op" id="1601918">:=</span>&nbsp;<span class="num" id="1601921">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1601926">for</span>&nbsp;<span class="ident" id="1601930">q1</span>&nbsp;<span class="op" id="1601933">&lt;</span>&nbsp;<span class="num" id="1601935">1e9</span>&nbsp;<span class="op" id="1601939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601945">k</span>&nbsp;<span class="op" id="1601947">+=</span>&nbsp;<span class="num" id="1601950">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601956">z</span>&nbsp;<span class="op" id="1601958">+=</span>&nbsp;<span class="ident" id="1601961">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601967">q0</span><span class="op" id="1601969">,</span>&nbsp;<span class="ident" id="1601971">q1</span>&nbsp;<span class="op" id="1601974">=</span>&nbsp;<span class="ident" id="1601976">q1</span><span class="op" id="1601978">,</span>&nbsp;<span class="ident" id="1601980">z</span><span class="op" id="1601981">*</span><span class="ident" id="1601982">q1</span><span class="op" id="1601984">-</span><span class="ident" id="1601985">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1601991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601996">m</span>&nbsp;<span class="op" id="1601998">:=</span>&nbsp;<span class="ident" id="1602001">n</span>&nbsp;<span class="op" id="1602003">+</span>&nbsp;<span class="ident" id="1602005">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602010">t</span>&nbsp;<span class="op" id="1602012">:=</span>&nbsp;<span class="num" id="1602015">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602022">for</span>&nbsp;<span class="ident" id="1602026">i</span>&nbsp;<span class="op" id="1602028">:=</span>&nbsp;<span class="num" id="1602031">2</span>&nbsp;<span class="op" id="1602033">*</span>&nbsp;<span class="op" id="1602035">(</span><span class="ident" id="1602036">n</span>&nbsp;<span class="op" id="1602038">+</span>&nbsp;<span class="ident" id="1602040">k</span><span class="op" id="1602041">)</span><span class="op" id="1602042">;</span>&nbsp;<span class="ident" id="1602044">i</span>&nbsp;<span class="op" id="1602046">&gt;=</span>&nbsp;<span class="ident" id="1602049">m</span><span class="op" id="1602050">;</span>&nbsp;<span class="ident" id="1602052">i</span>&nbsp;<span class="op" id="1602054">-=</span>&nbsp;<span class="num" id="1602057">2</span>&nbsp;<span class="op" id="1602059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602065">t</span>&nbsp;<span class="op" id="1602067">=</span>&nbsp;<span class="num" id="1602069">1</span>&nbsp;<span class="op" id="1602071">/</span>&nbsp;<span class="op" id="1602073">(</span><span class="builtintype" id="1602074">float64</span><span class="op" id="1602081">(</span><span class="ident" id="1602082">i</span><span class="op" id="1602083">)</span><span class="op" id="1602084">/</span><span class="ident" id="1602085">x</span>&nbsp;<span class="op" id="1602087">-</span>&nbsp;<span class="ident" id="1602089">t</span><span class="op" id="1602090">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602100">a</span>&nbsp;<span class="op" id="1602102">:=</span>&nbsp;<span class="ident" id="1602105">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602110">b</span>&nbsp;<span class="op" id="1602112">=</span>&nbsp;<span class="num" id="1602114">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602119">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602173">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602210">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602241">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602282">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602348">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602407">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602440">tmp</span>&nbsp;<span class="op" id="1602444">:=</span>&nbsp;<span class="builtintype" id="1602447">float64</span><span class="op" id="1602454">(</span><span class="ident" id="1602455">n</span><span class="op" id="1602456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602461">v</span>&nbsp;<span class="op" id="1602463">:=</span>&nbsp;<span class="num" id="1602466">2</span>&nbsp;<span class="op" id="1602468">/</span>&nbsp;<span class="ident" id="1602470">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602475">tmp</span>&nbsp;<span class="op" id="1602479">=</span>&nbsp;<span class="ident" id="1602481">tmp</span>&nbsp;<span class="op" id="1602485">*</span>&nbsp;<span class="ident" id="1602487">Log</span><span class="op" id="1602490">(</span><span class="ident" id="1602491">Abs</span><span class="op" id="1602494">(</span><span class="ident" id="1602495">v</span><span class="op" id="1602496">*</span><span class="ident" id="1602497">tmp</span><span class="op" id="1602500">)</span><span class="op" id="1602501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602506">if</span>&nbsp;<span class="ident" id="1602509">tmp</span>&nbsp;<span class="op" id="1602513">&lt;</span>&nbsp;<span class="num" id="1602515">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="1602542">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602548">for</span>&nbsp;<span class="ident" id="1602552">i</span>&nbsp;<span class="op" id="1602554">:=</span>&nbsp;<span class="ident" id="1602557">n</span>&nbsp;<span class="op" id="1602559">-</span>&nbsp;<span class="num" id="1602561">1</span><span class="op" id="1602562">;</span>&nbsp;<span class="ident" id="1602564">i</span>&nbsp;<span class="op" id="1602566">&gt;</span>&nbsp;<span class="num" id="1602568">0</span><span class="op" id="1602569">;</span>&nbsp;<span class="ident" id="1602571">i</span><span class="op" id="1602572">--</span>&nbsp;<span class="op" id="1602575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602582">di</span>&nbsp;<span class="op" id="1602585">:=</span>&nbsp;<span class="builtintype" id="1602588">float64</span><span class="op" id="1602595">(</span><span class="ident" id="1602596">i</span>&nbsp;<span class="op" id="1602598">+</span>&nbsp;<span class="ident" id="1602600">i</span><span class="op" id="1602601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602608">a</span><span class="op" id="1602609">,</span>&nbsp;<span class="ident" id="1602611">b</span>&nbsp;<span class="op" id="1602613">=</span>&nbsp;<span class="ident" id="1602615">b</span><span class="op" id="1602616">,</span>&nbsp;<span class="ident" id="1602618">b</span><span class="op" id="1602619">*</span><span class="ident" id="1602620">di</span><span class="op" id="1602622">/</span><span class="ident" id="1602623">x</span><span class="op" id="1602624">-</span><span class="ident" id="1602625">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602632">di</span>&nbsp;<span class="op" id="1602635">-=</span>&nbsp;<span class="num" id="1602638">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602644">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602649">}</span>&nbsp;<span class="keyword" id="1602651">else</span>&nbsp;<span class="op" id="1602656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602662">for</span>&nbsp;<span class="ident" id="1602666">i</span>&nbsp;<span class="op" id="1602668">:=</span>&nbsp;<span class="ident" id="1602671">n</span>&nbsp;<span class="op" id="1602673">-</span>&nbsp;<span class="num" id="1602675">1</span><span class="op" id="1602676">;</span>&nbsp;<span class="ident" id="1602678">i</span>&nbsp;<span class="op" id="1602680">&gt;</span>&nbsp;<span class="num" id="1602682">0</span><span class="op" id="1602683">;</span>&nbsp;<span class="ident" id="1602685">i</span><span class="op" id="1602686">--</span>&nbsp;<span class="op" id="1602689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602696">di</span>&nbsp;<span class="op" id="1602699">:=</span>&nbsp;<span class="builtintype" id="1602702">float64</span><span class="op" id="1602709">(</span><span class="ident" id="1602710">i</span>&nbsp;<span class="op" id="1602712">+</span>&nbsp;<span class="ident" id="1602714">i</span><span class="op" id="1602715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602722">a</span><span class="op" id="1602723">,</span>&nbsp;<span class="ident" id="1602725">b</span>&nbsp;<span class="op" id="1602727">=</span>&nbsp;<span class="ident" id="1602729">b</span><span class="op" id="1602730">,</span>&nbsp;<span class="ident" id="1602732">b</span><span class="op" id="1602733">*</span><span class="ident" id="1602734">di</span><span class="op" id="1602736">/</span><span class="ident" id="1602737">x</span><span class="op" id="1602738">-</span><span class="ident" id="1602739">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602746">di</span>&nbsp;<span class="op" id="1602749">-=</span>&nbsp;<span class="num" id="1602752">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1602759">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602802">if</span>&nbsp;<span class="ident" id="1602805">b</span>&nbsp;<span class="op" id="1602807">&gt;</span>&nbsp;<span class="num" id="1602809">1e100</span>&nbsp;<span class="op" id="1602815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602823">a</span>&nbsp;<span class="op" id="1602825">/=</span>&nbsp;<span class="ident" id="1602828">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602836">t</span>&nbsp;<span class="op" id="1602838">/=</span>&nbsp;<span class="ident" id="1602841">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602849">b</span>&nbsp;<span class="op" id="1602851">=</span>&nbsp;<span class="num" id="1602853">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1602876">b</span>&nbsp;<span class="op" id="1602878">=</span>&nbsp;<span class="ident" id="1602880">t</span>&nbsp;<span class="op" id="1602882">*</span>&nbsp;<span class="ident" id="1602884">J0</span><span class="op" id="1602886">(</span><span class="ident" id="1602887">x</span><span class="op" id="1602888">)</span>&nbsp;<span class="op" id="1602890">/</span>&nbsp;<span class="ident" id="1602892">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602896">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602902">if</span>&nbsp;<span class="ident" id="1602905">sign</span>&nbsp;<span class="op" id="1602910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602914">return</span>&nbsp;<span class="op" id="1602921">-</span><span class="ident" id="1602922">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1602925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602928">return</span>&nbsp;<span class="ident" id="1602935">b</span><br>
<span class="lineno">225</span><span class="op" id="1602937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1602940">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="1603002">//</span><br>
<span class="lineno"></span><span class="comment" id="1603005">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="1603027">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1603046">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1603069">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="1603123">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1603145">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="1603165">func</span>&nbsp;<span class="ident" id="1603170">Yn</span><span class="op" id="1603172">(</span><span class="ident" id="1603173">n</span>&nbsp;<span class="builtintype" id="1603175">int</span><span class="op" id="1603178">,</span>&nbsp;<span class="ident" id="1603180">x</span>&nbsp;<span class="builtintype" id="1603182">float64</span><span class="op" id="1603189">)</span>&nbsp;<span class="builtintype" id="1603191">float64</span>&nbsp;<span class="op" id="1603199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603202">const</span>&nbsp;<span class="ident" id="1603208">Two302</span>&nbsp;<span class="op" id="1603215">=</span>&nbsp;<span class="num" id="1603217">1</span>&nbsp;<span class="op" id="1603219">&lt;&lt;</span>&nbsp;<span class="num" id="1603222">302</span>&nbsp;<span class="comment" id="1603226">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603256">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603274">switch</span>&nbsp;<span class="op" id="1603281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603284">case</span>&nbsp;<span class="ident" id="1603289">x</span>&nbsp;<span class="op" id="1603291">&lt;</span>&nbsp;<span class="num" id="1603293">0</span>&nbsp;<span class="op" id="1603295">||</span>&nbsp;<span class="ident" id="1603298">IsNaN</span><span class="op" id="1603303">(</span><span class="ident" id="1603304">x</span><span class="op" id="1603305">)</span><span class="op" id="1603306">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603310">return</span>&nbsp;<span class="ident" id="1603317">NaN</span><span class="op" id="1603320">(</span><span class="op" id="1603321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603324">case</span>&nbsp;<span class="ident" id="1603329">IsInf</span><span class="op" id="1603334">(</span><span class="ident" id="1603335">x</span><span class="op" id="1603336">,</span>&nbsp;<span class="num" id="1603338">1</span><span class="op" id="1603339">)</span><span class="op" id="1603340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603344">return</span>&nbsp;<span class="num" id="1603351">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603358">if</span>&nbsp;<span class="ident" id="1603361">n</span>&nbsp;<span class="op" id="1603363">==</span>&nbsp;<span class="num" id="1603366">0</span>&nbsp;<span class="op" id="1603368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603372">return</span>&nbsp;<span class="ident" id="1603379">Y0</span><span class="op" id="1603381">(</span><span class="ident" id="1603382">x</span><span class="op" id="1603383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603389">if</span>&nbsp;<span class="ident" id="1603392">x</span>&nbsp;<span class="op" id="1603394">==</span>&nbsp;<span class="num" id="1603397">0</span>&nbsp;<span class="op" id="1603399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603403">if</span>&nbsp;<span class="ident" id="1603406">n</span>&nbsp;<span class="op" id="1603408">&lt;</span>&nbsp;<span class="num" id="1603410">0</span>&nbsp;<span class="op" id="1603412">&amp;&amp;</span>&nbsp;<span class="ident" id="1603415">n</span><span class="op" id="1603416">&amp;</span><span class="num" id="1603417">1</span>&nbsp;<span class="op" id="1603419">==</span>&nbsp;<span class="num" id="1603422">1</span>&nbsp;<span class="op" id="1603424">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603429">return</span>&nbsp;<span class="ident" id="1603436">Inf</span><span class="op" id="1603439">(</span><span class="num" id="1603440">1</span><span class="op" id="1603441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603449">return</span>&nbsp;<span class="ident" id="1603456">Inf</span><span class="op" id="1603459">(</span><span class="op" id="1603460">-</span><span class="num" id="1603461">1</span><span class="op" id="1603462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603468">sign</span>&nbsp;<span class="op" id="1603473">:=</span>&nbsp;<span class="builtintype" id="1603476">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603483">if</span>&nbsp;<span class="ident" id="1603486">n</span>&nbsp;<span class="op" id="1603488">&lt;</span>&nbsp;<span class="num" id="1603490">0</span>&nbsp;<span class="op" id="1603492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603496">n</span>&nbsp;<span class="op" id="1603498">=</span>&nbsp;<span class="op" id="1603500">-</span><span class="ident" id="1603501">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603505">if</span>&nbsp;<span class="ident" id="1603508">n</span><span class="op" id="1603509">&amp;</span><span class="num" id="1603510">1</span>&nbsp;<span class="op" id="1603512">==</span>&nbsp;<span class="num" id="1603515">1</span>&nbsp;<span class="op" id="1603517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603522">sign</span>&nbsp;<span class="op" id="1603527">=</span>&nbsp;<span class="builtintype" id="1603529">true</span>&nbsp;<span class="comment" id="1603534">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603569">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603575">if</span>&nbsp;<span class="ident" id="1603578">n</span>&nbsp;<span class="op" id="1603580">==</span>&nbsp;<span class="num" id="1603583">1</span>&nbsp;<span class="op" id="1603585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603589">if</span>&nbsp;<span class="ident" id="1603592">sign</span>&nbsp;<span class="op" id="1603597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603602">return</span>&nbsp;<span class="op" id="1603609">-</span><span class="ident" id="1603610">Y1</span><span class="op" id="1603612">(</span><span class="ident" id="1603613">x</span><span class="op" id="1603614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603618">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603622">return</span>&nbsp;<span class="ident" id="1603629">Y1</span><span class="op" id="1603631">(</span><span class="ident" id="1603632">x</span><span class="op" id="1603633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603639">var</span>&nbsp;<span class="ident" id="1603643">b</span>&nbsp;<span class="builtintype" id="1603645">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603654">if</span>&nbsp;<span class="ident" id="1603657">x</span>&nbsp;<span class="op" id="1603659">&gt;=</span>&nbsp;<span class="ident" id="1603662">Two302</span>&nbsp;<span class="op" id="1603669">{</span>&nbsp;<span class="comment" id="1603671">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603687">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603704">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603753">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603802">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603835">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603879">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603884">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603921">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603962">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603984">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604007">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604029">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604052">var</span>&nbsp;<span class="ident" id="1604056">temp</span>&nbsp;<span class="builtintype" id="1604061">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604071">switch</span>&nbsp;<span class="ident" id="1604078">n</span>&nbsp;<span class="op" id="1604080">&amp;</span>&nbsp;<span class="num" id="1604082">3</span>&nbsp;<span class="op" id="1604084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604088">case</span>&nbsp;<span class="num" id="1604093">0</span><span class="op" id="1604094">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604099">temp</span>&nbsp;<span class="op" id="1604104">=</span>&nbsp;<span class="ident" id="1604106">Sin</span><span class="op" id="1604109">(</span><span class="ident" id="1604110">x</span><span class="op" id="1604111">)</span>&nbsp;<span class="op" id="1604113">-</span>&nbsp;<span class="ident" id="1604115">Cos</span><span class="op" id="1604118">(</span><span class="ident" id="1604119">x</span><span class="op" id="1604120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604124">case</span>&nbsp;<span class="num" id="1604129">1</span><span class="op" id="1604130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604135">temp</span>&nbsp;<span class="op" id="1604140">=</span>&nbsp;<span class="op" id="1604142">-</span><span class="ident" id="1604143">Sin</span><span class="op" id="1604146">(</span><span class="ident" id="1604147">x</span><span class="op" id="1604148">)</span>&nbsp;<span class="op" id="1604150">-</span>&nbsp;<span class="ident" id="1604152">Cos</span><span class="op" id="1604155">(</span><span class="ident" id="1604156">x</span><span class="op" id="1604157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604161">case</span>&nbsp;<span class="num" id="1604166">2</span><span class="op" id="1604167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604172">temp</span>&nbsp;<span class="op" id="1604177">=</span>&nbsp;<span class="op" id="1604179">-</span><span class="ident" id="1604180">Sin</span><span class="op" id="1604183">(</span><span class="ident" id="1604184">x</span><span class="op" id="1604185">)</span>&nbsp;<span class="op" id="1604187">+</span>&nbsp;<span class="ident" id="1604189">Cos</span><span class="op" id="1604192">(</span><span class="ident" id="1604193">x</span><span class="op" id="1604194">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604198">case</span>&nbsp;<span class="num" id="1604203">3</span><span class="op" id="1604204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604209">temp</span>&nbsp;<span class="op" id="1604214">=</span>&nbsp;<span class="ident" id="1604216">Sin</span><span class="op" id="1604219">(</span><span class="ident" id="1604220">x</span><span class="op" id="1604221">)</span>&nbsp;<span class="op" id="1604223">+</span>&nbsp;<span class="ident" id="1604225">Cos</span><span class="op" id="1604228">(</span><span class="ident" id="1604229">x</span><span class="op" id="1604230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604238">b</span>&nbsp;<span class="op" id="1604240">=</span>&nbsp;<span class="op" id="1604242">(</span><span class="num" id="1604243">1</span>&nbsp;<span class="op" id="1604245">/</span>&nbsp;<span class="ident" id="1604247">SqrtPi</span><span class="op" id="1604253">)</span>&nbsp;<span class="op" id="1604255">*</span>&nbsp;<span class="ident" id="1604257">temp</span>&nbsp;<span class="op" id="1604262">/</span>&nbsp;<span class="ident" id="1604264">Sqrt</span><span class="op" id="1604268">(</span><span class="ident" id="1604269">x</span><span class="op" id="1604270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604273">}</span>&nbsp;<span class="keyword" id="1604275">else</span>&nbsp;<span class="op" id="1604280">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604284">a</span>&nbsp;<span class="op" id="1604286">:=</span>&nbsp;<span class="ident" id="1604289">Y0</span><span class="op" id="1604291">(</span><span class="ident" id="1604292">x</span><span class="op" id="1604293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604297">b</span>&nbsp;<span class="op" id="1604299">=</span>&nbsp;<span class="ident" id="1604301">Y1</span><span class="op" id="1604303">(</span><span class="ident" id="1604304">x</span><span class="op" id="1604305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604309">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604332">for</span>&nbsp;<span class="ident" id="1604336">i</span>&nbsp;<span class="op" id="1604338">:=</span>&nbsp;<span class="num" id="1604341">1</span><span class="op" id="1604342">;</span>&nbsp;<span class="ident" id="1604344">i</span>&nbsp;<span class="op" id="1604346">&lt;</span>&nbsp;<span class="ident" id="1604348">n</span>&nbsp;<span class="op" id="1604350">&amp;&amp;</span>&nbsp;<span class="op" id="1604353">!</span><span class="ident" id="1604354">IsInf</span><span class="op" id="1604359">(</span><span class="ident" id="1604360">b</span><span class="op" id="1604361">,</span>&nbsp;<span class="op" id="1604363">-</span><span class="num" id="1604364">1</span><span class="op" id="1604365">)</span><span class="op" id="1604366">;</span>&nbsp;<span class="ident" id="1604368">i</span><span class="op" id="1604369">++</span>&nbsp;<span class="op" id="1604372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604377">a</span><span class="op" id="1604378">,</span>&nbsp;<span class="ident" id="1604380">b</span>&nbsp;<span class="op" id="1604382">=</span>&nbsp;<span class="ident" id="1604384">b</span><span class="op" id="1604385">,</span>&nbsp;<span class="op" id="1604387">(</span><span class="builtintype" id="1604388">float64</span><span class="op" id="1604395">(</span><span class="ident" id="1604396">i</span><span class="op" id="1604397">+</span><span class="ident" id="1604398">i</span><span class="op" id="1604399">)</span><span class="op" id="1604400">/</span><span class="ident" id="1604401">x</span><span class="op" id="1604402">)</span><span class="op" id="1604403">*</span><span class="ident" id="1604404">b</span><span class="op" id="1604405">-</span><span class="ident" id="1604406">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604416">if</span>&nbsp;<span class="ident" id="1604419">sign</span>&nbsp;<span class="op" id="1604424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604428">return</span>&nbsp;<span class="op" id="1604435">-</span><span class="ident" id="1604436">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604439">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604442">return</span>&nbsp;<span class="ident" id="1604449">b</span><br>
<span class="lineno"></span><span class="op" id="1604451">}</span>
</div>
</body>
</html>
