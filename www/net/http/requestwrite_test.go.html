<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7436759">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7436815">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7436869">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7436920">package</span>&nbsp;<span class="ident" id="7436928">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7436934">import</span>&nbsp;<span class="op" id="7436941">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7436944">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7436953">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7436963">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7436970">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7436976">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7436989">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437000">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437011">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7437021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7437024">type</span>&nbsp;<span class="ident" id="7437029">reqWriteTest</span>&nbsp;<span class="keyword" id="7437042">struct</span>&nbsp;<span class="op" id="7437049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437052">Req</span>&nbsp;&nbsp;<span class="ident" id="7437057"><a href="/net/http/request.go.html#3791418">Request</a></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437066">Body</span>&nbsp;<span class="keyword" id="7437071">interface</span><span class="op" id="7437080">{</span><span class="op" id="7437081">}</span>&nbsp;<span class="comment" id="7437083">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7437149">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437204">WantWrite</span>&nbsp;<span class="builtintype" id="7437214">string</span>&nbsp;<span class="comment" id="7437221">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437239">WantProxy</span>&nbsp;<span class="builtintype" id="7437249">string</span>&nbsp;<span class="comment" id="7437256">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437280">WantError</span>&nbsp;<span class="builtintype" id="7437290">error</span>&nbsp;<span class="comment" id="7437296">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="7437331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7437334">var</span>&nbsp;<span class="ident" id="7437338">reqWriteTests</span>&nbsp;<span class="op" id="7437352">=</span>&nbsp;<span class="op" id="7437354">[</span><span class="op" id="7437355">]</span><span class="ident" id="7437356"><a href="/net/http/requestwrite_test.go.html#7437029">reqWriteTest</a></span><span class="op" id="7437368">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7437371">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7437423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437427">Req</span><span class="op" id="7437430">:</span>&nbsp;<span class="ident" id="7437432"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7437439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437444">Method</span><span class="op" id="7437450">:</span>&nbsp;<span class="string" id="7437452">&#34;GET&#34;</span><span class="op" id="7437457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437462">URL</span><span class="op" id="7437465">:</span>&nbsp;<span class="op" id="7437467">&amp;</span><span class="ident" id="7437468"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7437471">.</span><span class="ident" id="7437472">URL</span><span class="op" id="7437475">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437481">Scheme</span><span class="op" id="7437487">:</span>&nbsp;<span class="string" id="7437489">&#34;http&#34;</span><span class="op" id="7437495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437501">Host</span><span class="op" id="7437505">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7437509">&#34;www.techcrunch.com&#34;</span><span class="op" id="7437529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437535">Path</span><span class="op" id="7437539">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7437543">&#34;/&#34;</span><span class="op" id="7437546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7437551">}</span><span class="op" id="7437552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437557">Proto</span><span class="op" id="7437562">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7437569">&#34;HTTP/1.1&#34;</span><span class="op" id="7437579">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437584">ProtoMajor</span><span class="op" id="7437594">:</span>&nbsp;<span class="num" id="7437596">1</span><span class="op" id="7437597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437602">ProtoMinor</span><span class="op" id="7437612">:</span>&nbsp;<span class="num" id="7437614">1</span><span class="op" id="7437615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437620">Header</span><span class="op" id="7437626">:</span>&nbsp;<span class="ident" id="7437628"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7437634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437640">&#34;Accept&#34;</span><span class="op" id="7437648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7437660">{</span><span class="string" id="7437661">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="7437726">}</span><span class="op" id="7437727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437733">&#34;Accept-Charset&#34;</span><span class="op" id="7437749">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7437753">{</span><span class="string" id="7437754">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="7437786">}</span><span class="op" id="7437787">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437793">&#34;Accept-Encoding&#34;</span><span class="op" id="7437810">:</span>&nbsp;&nbsp;<span class="op" id="7437813">{</span><span class="string" id="7437814">&#34;gzip,deflate&#34;</span><span class="op" id="7437828">}</span><span class="op" id="7437829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437835">&#34;Accept-Language&#34;</span><span class="op" id="7437852">:</span>&nbsp;&nbsp;<span class="op" id="7437855">{</span><span class="string" id="7437856">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="7437872">}</span><span class="op" id="7437873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437879">&#34;Keep-Alive&#34;</span><span class="op" id="7437891">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7437899">{</span><span class="string" id="7437900">&#34;300&#34;</span><span class="op" id="7437905">}</span><span class="op" id="7437906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437912">&#34;Proxy-Connection&#34;</span><span class="op" id="7437930">:</span>&nbsp;<span class="op" id="7437932">{</span><span class="string" id="7437933">&#34;keep-alive&#34;</span><span class="op" id="7437945">}</span><span class="op" id="7437946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7437952">&#34;User-Agent&#34;</span><span class="op" id="7437964">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7437972">{</span><span class="string" id="7437973">&#34;Fake&#34;</span><span class="op" id="7437979">}</span><span class="op" id="7437980">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7437985">}</span><span class="op" id="7437986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7437991">Body</span><span class="op" id="7437995">:</span>&nbsp;&nbsp;<span class="ident" id="7437998">nil</span><span class="op" id="7438001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438006">Close</span><span class="op" id="7438011">:</span>&nbsp;<span class="ident" id="7438013">false</span><span class="op" id="7438018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438023">Host</span><span class="op" id="7438027">:</span>&nbsp;&nbsp;<span class="string" id="7438030">&#34;www.techcrunch.com&#34;</span><span class="op" id="7438050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438055">Form</span><span class="op" id="7438059">:</span>&nbsp;&nbsp;<span class="keyword" id="7438062">map</span><span class="op" id="7438065">[</span><span class="builtintype" id="7438066">string</span><span class="op" id="7438072">]</span><span class="op" id="7438073">[</span><span class="op" id="7438074">]</span><span class="builtintype" id="7438075">string</span><span class="op" id="7438081">{</span><span class="op" id="7438082">}</span><span class="op" id="7438083">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7438087">}</span><span class="op" id="7438088">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438093">WantWrite</span><span class="op" id="7438102">:</span>&nbsp;<span class="string" id="7438104">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7438125">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438130">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7438161">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438166">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7438189">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438194">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7438272">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438277">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7438330">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438335">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7438371">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438376">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7438414">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438419">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7438441">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438446">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7438484">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438489">WantProxy</span><span class="op" id="7438498">:</span>&nbsp;<span class="string" id="7438500">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7438546">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438551">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7438582">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438587">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7438610">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438615">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7438693">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438698">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7438751">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438756">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7438792">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438797">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7438835">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438840">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7438862">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7438867">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7438905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7438908">}</span><span class="op" id="7438909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7438912">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7438964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438968">Req</span><span class="op" id="7438971">:</span>&nbsp;<span class="ident" id="7438973"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7438980">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7438985">Method</span><span class="op" id="7438991">:</span>&nbsp;<span class="string" id="7438993">&#34;GET&#34;</span><span class="op" id="7438998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439003">URL</span><span class="op" id="7439006">:</span>&nbsp;<span class="op" id="7439008">&amp;</span><span class="ident" id="7439009"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7439012">.</span><span class="ident" id="7439013">URL</span><span class="op" id="7439016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439022">Scheme</span><span class="op" id="7439028">:</span>&nbsp;<span class="string" id="7439030">&#34;http&#34;</span><span class="op" id="7439036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439042">Host</span><span class="op" id="7439046">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7439050">&#34;www.google.com&#34;</span><span class="op" id="7439066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439072">Path</span><span class="op" id="7439076">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7439080">&#34;/search&#34;</span><span class="op" id="7439089">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7439094">}</span><span class="op" id="7439095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439100">ProtoMajor</span><span class="op" id="7439110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7439118">1</span><span class="op" id="7439119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439124">ProtoMinor</span><span class="op" id="7439134">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7439142">1</span><span class="op" id="7439143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439148">Header</span><span class="op" id="7439154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7439166"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7439172">{</span><span class="op" id="7439173">}</span><span class="op" id="7439174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439179">TransferEncoding</span><span class="op" id="7439195">:</span>&nbsp;<span class="op" id="7439197">[</span><span class="op" id="7439198">]</span><span class="builtintype" id="7439199">string</span><span class="op" id="7439205">{</span><span class="string" id="7439206">&#34;chunked&#34;</span><span class="op" id="7439215">}</span><span class="op" id="7439216">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7439220">}</span><span class="op" id="7439221">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439226">Body</span><span class="op" id="7439230">:</span>&nbsp;<span class="op" id="7439232">[</span><span class="op" id="7439233">]</span><span class="builtintype" id="7439234">byte</span><span class="op" id="7439238">(</span><span class="string" id="7439239">&#34;abcdef&#34;</span><span class="op" id="7439247">)</span><span class="op" id="7439248">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439253">WantWrite</span><span class="op" id="7439262">:</span>&nbsp;<span class="string" id="7439264">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7439291">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7439296">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7439323">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7439328">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7439366">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7439371">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7439408">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439413"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7439418">(</span><span class="string" id="7439419">&#34;abcdef&#34;</span><span class="op" id="7439427">)</span>&nbsp;<span class="op" id="7439429">+</span>&nbsp;<span class="ident" id="7439431"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7439436">(</span><span class="string" id="7439437">&#34;&#34;</span><span class="op" id="7439439">)</span><span class="op" id="7439440">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439445">WantProxy</span><span class="op" id="7439454">:</span>&nbsp;<span class="string" id="7439456">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7439504">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7439509">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7439536">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7439541">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7439579">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7439584">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7439621">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439626"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7439631">(</span><span class="string" id="7439632">&#34;abcdef&#34;</span><span class="op" id="7439640">)</span>&nbsp;<span class="op" id="7439642">+</span>&nbsp;<span class="ident" id="7439644"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7439649">(</span><span class="string" id="7439650">&#34;&#34;</span><span class="op" id="7439652">)</span><span class="op" id="7439653">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7439656">}</span><span class="op" id="7439657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7439660">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7439717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439721">Req</span><span class="op" id="7439724">:</span>&nbsp;<span class="ident" id="7439726"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7439733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439738">Method</span><span class="op" id="7439744">:</span>&nbsp;<span class="string" id="7439746">&#34;POST&#34;</span><span class="op" id="7439752">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439757">URL</span><span class="op" id="7439760">:</span>&nbsp;<span class="op" id="7439762">&amp;</span><span class="ident" id="7439763"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7439766">.</span><span class="ident" id="7439767">URL</span><span class="op" id="7439770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439776">Scheme</span><span class="op" id="7439782">:</span>&nbsp;<span class="string" id="7439784">&#34;http&#34;</span><span class="op" id="7439790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439796">Host</span><span class="op" id="7439800">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7439804">&#34;www.google.com&#34;</span><span class="op" id="7439820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439826">Path</span><span class="op" id="7439830">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7439834">&#34;/search&#34;</span><span class="op" id="7439843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7439848">}</span><span class="op" id="7439849">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439854">ProtoMajor</span><span class="op" id="7439864">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7439872">1</span><span class="op" id="7439873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439878">ProtoMinor</span><span class="op" id="7439888">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7439896">1</span><span class="op" id="7439897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439902">Header</span><span class="op" id="7439908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7439920"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7439926">{</span><span class="op" id="7439927">}</span><span class="op" id="7439928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439933">Close</span><span class="op" id="7439938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7439951">true</span><span class="op" id="7439955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7439960">TransferEncoding</span><span class="op" id="7439976">:</span>&nbsp;<span class="op" id="7439978">[</span><span class="op" id="7439979">]</span><span class="builtintype" id="7439980">string</span><span class="op" id="7439986">{</span><span class="string" id="7439987">&#34;chunked&#34;</span><span class="op" id="7439996">}</span><span class="op" id="7439997">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7440001">}</span><span class="op" id="7440002">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440007">Body</span><span class="op" id="7440011">:</span>&nbsp;<span class="op" id="7440013">[</span><span class="op" id="7440014">]</span><span class="builtintype" id="7440015">byte</span><span class="op" id="7440019">(</span><span class="string" id="7440020">&#34;abcdef&#34;</span><span class="op" id="7440028">)</span><span class="op" id="7440029">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440034">WantWrite</span><span class="op" id="7440043">:</span>&nbsp;<span class="string" id="7440045">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7440073">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440078">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7440105">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440110">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7440148">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440153">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7440177">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440182">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7440219">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440224"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7440229">(</span><span class="string" id="7440230">&#34;abcdef&#34;</span><span class="op" id="7440238">)</span>&nbsp;<span class="op" id="7440240">+</span>&nbsp;<span class="ident" id="7440242"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7440247">(</span><span class="string" id="7440248">&#34;&#34;</span><span class="op" id="7440250">)</span><span class="op" id="7440251">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440256">WantProxy</span><span class="op" id="7440265">:</span>&nbsp;<span class="string" id="7440267">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7440316">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440321">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7440348">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440353">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7440391">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440396">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7440420">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440425">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7440462">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440467"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7440472">(</span><span class="string" id="7440473">&#34;abcdef&#34;</span><span class="op" id="7440481">)</span>&nbsp;<span class="op" id="7440483">+</span>&nbsp;<span class="ident" id="7440485"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7440490">(</span><span class="string" id="7440491">&#34;&#34;</span><span class="op" id="7440493">)</span><span class="op" id="7440494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7440497">}</span><span class="op" id="7440498">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7440502">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7440553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440557">Req</span><span class="op" id="7440560">:</span>&nbsp;<span class="ident" id="7440562"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7440569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440574">Method</span><span class="op" id="7440580">:</span>&nbsp;<span class="string" id="7440582">&#34;POST&#34;</span><span class="op" id="7440588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440593">URL</span><span class="op" id="7440596">:</span>&nbsp;<span class="op" id="7440598">&amp;</span><span class="ident" id="7440599"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7440602">.</span><span class="ident" id="7440603">URL</span><span class="op" id="7440606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440612">Scheme</span><span class="op" id="7440618">:</span>&nbsp;<span class="string" id="7440620">&#34;http&#34;</span><span class="op" id="7440626">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440632">Host</span><span class="op" id="7440636">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7440640">&#34;www.google.com&#34;</span><span class="op" id="7440656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440662">Path</span><span class="op" id="7440666">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7440670">&#34;/search&#34;</span><span class="op" id="7440679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7440684">}</span><span class="op" id="7440685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440690">ProtoMajor</span><span class="op" id="7440700">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7440705">1</span><span class="op" id="7440706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440711">ProtoMinor</span><span class="op" id="7440721">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7440726">1</span><span class="op" id="7440727">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440732">Header</span><span class="op" id="7440738">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7440747"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7440753">{</span><span class="op" id="7440754">}</span><span class="op" id="7440755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440760">Close</span><span class="op" id="7440765">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7440775">true</span><span class="op" id="7440779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440784">ContentLength</span><span class="op" id="7440797">:</span>&nbsp;<span class="num" id="7440799">6</span><span class="op" id="7440800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7440804">}</span><span class="op" id="7440805">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440810">Body</span><span class="op" id="7440814">:</span>&nbsp;<span class="op" id="7440816">[</span><span class="op" id="7440817">]</span><span class="builtintype" id="7440818">byte</span><span class="op" id="7440822">(</span><span class="string" id="7440823">&#34;abcdef&#34;</span><span class="op" id="7440831">)</span><span class="op" id="7440832">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7440837">WantWrite</span><span class="op" id="7440846">:</span>&nbsp;<span class="string" id="7440848">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7440876">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440881">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7440908">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440913">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7440951">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440956">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7440980">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7440985">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7441009">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441014">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7441021">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441026">&#34;abcdef&#34;</span><span class="op" id="7441034">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441039">WantProxy</span><span class="op" id="7441048">:</span>&nbsp;<span class="string" id="7441050">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7441099">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441104">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7441131">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441136">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7441174">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441179">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7441203">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441208">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7441232">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441237">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7441244">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441249">&#34;abcdef&#34;</span><span class="op" id="7441257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441260">}</span><span class="op" id="7441261">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7441265">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441318">Req</span><span class="op" id="7441321">:</span>&nbsp;<span class="ident" id="7441323"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7441330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441335">Method</span><span class="op" id="7441341">:</span>&nbsp;<span class="string" id="7441343">&#34;POST&#34;</span><span class="op" id="7441349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441354">URL</span><span class="op" id="7441357">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7441362"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7441374">(</span><span class="string" id="7441375">&#34;http://example.com/&#34;</span><span class="op" id="7441396">)</span><span class="op" id="7441397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441402">Host</span><span class="op" id="7441406">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7441410">&#34;example.com&#34;</span><span class="op" id="7441423">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441428">Header</span><span class="op" id="7441434">:</span>&nbsp;<span class="ident" id="7441436"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7441442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441448">&#34;Content-Length&#34;</span><span class="op" id="7441464">:</span>&nbsp;<span class="op" id="7441466">[</span><span class="op" id="7441467">]</span><span class="builtintype" id="7441468">string</span><span class="op" id="7441474">{</span><span class="string" id="7441475">&#34;10&#34;</span><span class="op" id="7441479">}</span><span class="op" id="7441480">,</span>&nbsp;<span class="comment" id="7441482">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441496">}</span><span class="op" id="7441497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441502">ContentLength</span><span class="op" id="7441515">:</span>&nbsp;<span class="num" id="7441517">6</span><span class="op" id="7441518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441522">}</span><span class="op" id="7441523">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441528">Body</span><span class="op" id="7441532">:</span>&nbsp;<span class="op" id="7441534">[</span><span class="op" id="7441535">]</span><span class="builtintype" id="7441536">byte</span><span class="op" id="7441540">(</span><span class="string" id="7441541">&#34;abcdef&#34;</span><span class="op" id="7441549">)</span><span class="op" id="7441550">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441555">WantWrite</span><span class="op" id="7441564">:</span>&nbsp;<span class="string" id="7441566">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7441588">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441593">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7441617">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441622">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7441660">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441665">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7441689">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441694">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7441701">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441706">&#34;abcdef&#34;</span><span class="op" id="7441714">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441719">WantProxy</span><span class="op" id="7441728">:</span>&nbsp;<span class="string" id="7441730">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7441770">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441775">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7441799">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441804">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7441842">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441847">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7441871">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441876">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7441883">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441888">&#34;abcdef&#34;</span><span class="op" id="7441896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441899">}</span><span class="op" id="7441900">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7441904">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441928">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441932">Req</span><span class="op" id="7441935">:</span>&nbsp;<span class="ident" id="7441937"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7441944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441949">Method</span><span class="op" id="7441955">:</span>&nbsp;<span class="string" id="7441957">&#34;GET&#34;</span><span class="op" id="7441962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441967">URL</span><span class="op" id="7441970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7441975"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7441987">(</span><span class="string" id="7441988">&#34;/search&#34;</span><span class="op" id="7441997">)</span><span class="op" id="7441998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442003">Host</span><span class="op" id="7442007">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7442011">&#34;www.google.com&#34;</span><span class="op" id="7442027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442031">}</span><span class="op" id="7442032">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442037">WantWrite</span><span class="op" id="7442046">:</span>&nbsp;<span class="string" id="7442048">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7442075">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442080">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7442107">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442112">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7442150">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442155">&#34;\r\n&#34;</span><span class="op" id="7442161">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442164">}</span><span class="op" id="7442165">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7442169">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442227">Req</span><span class="op" id="7442230">:</span>&nbsp;<span class="ident" id="7442232"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7442239">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442244">Method</span><span class="op" id="7442250">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7442259">&#34;POST&#34;</span><span class="op" id="7442265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442270">URL</span><span class="op" id="7442273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7442285"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7442297">(</span><span class="string" id="7442298">&#34;/&#34;</span><span class="op" id="7442301">)</span><span class="op" id="7442302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442307">Host</span><span class="op" id="7442311">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7442322">&#34;example.com&#34;</span><span class="op" id="7442335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442340">ProtoMajor</span><span class="op" id="7442350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7442355">1</span><span class="op" id="7442356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442361">ProtoMinor</span><span class="op" id="7442371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7442376">1</span><span class="op" id="7442377">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442382">ContentLength</span><span class="op" id="7442395">:</span>&nbsp;<span class="num" id="7442397">0</span><span class="op" id="7442398">,</span>&nbsp;<span class="comment" id="7442400">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442425">}</span><span class="op" id="7442426">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442431">Body</span><span class="op" id="7442435">:</span>&nbsp;<span class="keyword" id="7442437">func</span><span class="op" id="7442441">(</span><span class="op" id="7442442">)</span>&nbsp;<span class="ident" id="7442444"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7442446">.</span><span class="ident" id="7442447">ReadCloser</span>&nbsp;<span class="op" id="7442458">{</span>&nbsp;<span class="keyword" id="7442460">return</span>&nbsp;<span class="ident" id="7442467"><a href="/net/http/requestwrite_test.go.html#7436976">ioutil</a></span><span class="op" id="7442473">.</span><span class="ident" id="7442474">NopCloser</span><span class="op" id="7442483">(</span><span class="ident" id="7442484"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7442486">.</span><span class="ident" id="7442487">LimitReader</span><span class="op" id="7442498">(</span><span class="ident" id="7442499"><a href="/net/http/requestwrite_test.go.html#7437000">strings</a></span><span class="op" id="7442506">.</span><span class="ident" id="7442507">NewReader</span><span class="op" id="7442516">(</span><span class="string" id="7442517">&#34;xx&#34;</span><span class="op" id="7442521">)</span><span class="op" id="7442522">,</span>&nbsp;<span class="num" id="7442524">0</span><span class="op" id="7442525">)</span><span class="op" id="7442526">)</span>&nbsp;<span class="op" id="7442528">}</span><span class="op" id="7442529">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7442534">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7442602">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7442656">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442702">WantWrite</span><span class="op" id="7442711">:</span>&nbsp;<span class="string" id="7442713">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7442735">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442740">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7442764">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442769">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7442807">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442812">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7442836">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442841">&#34;\r\n&#34;</span><span class="op" id="7442847">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442852">WantProxy</span><span class="op" id="7442861">:</span>&nbsp;<span class="string" id="7442863">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7442885">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442890">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7442914">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442919">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7442957">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442962">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7442986">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442991">&#34;\r\n&#34;</span><span class="op" id="7442997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443000">}</span><span class="op" id="7443001">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7443005">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443063">Req</span><span class="op" id="7443066">:</span>&nbsp;<span class="ident" id="7443068"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7443075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443080">Method</span><span class="op" id="7443086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7443095">&#34;POST&#34;</span><span class="op" id="7443101">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443106">URL</span><span class="op" id="7443109">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443121"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7443133">(</span><span class="string" id="7443134">&#34;/&#34;</span><span class="op" id="7443137">)</span><span class="op" id="7443138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443143">Host</span><span class="op" id="7443147">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7443158">&#34;example.com&#34;</span><span class="op" id="7443171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443176">ProtoMajor</span><span class="op" id="7443186">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7443191">1</span><span class="op" id="7443192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443197">ProtoMinor</span><span class="op" id="7443207">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7443212">1</span><span class="op" id="7443213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443218">ContentLength</span><span class="op" id="7443231">:</span>&nbsp;<span class="num" id="7443233">0</span><span class="op" id="7443234">,</span>&nbsp;<span class="comment" id="7443236">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443261">}</span><span class="op" id="7443262">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443267">Body</span><span class="op" id="7443271">:</span>&nbsp;<span class="keyword" id="7443273">func</span><span class="op" id="7443277">(</span><span class="op" id="7443278">)</span>&nbsp;<span class="ident" id="7443280"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7443282">.</span><span class="ident" id="7443283">ReadCloser</span>&nbsp;<span class="op" id="7443294">{</span>&nbsp;<span class="keyword" id="7443296">return</span>&nbsp;<span class="ident" id="7443303"><a href="/net/http/requestwrite_test.go.html#7436976">ioutil</a></span><span class="op" id="7443309">.</span><span class="ident" id="7443310">NopCloser</span><span class="op" id="7443319">(</span><span class="ident" id="7443320"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7443322">.</span><span class="ident" id="7443323">LimitReader</span><span class="op" id="7443334">(</span><span class="ident" id="7443335"><a href="/net/http/requestwrite_test.go.html#7437000">strings</a></span><span class="op" id="7443342">.</span><span class="ident" id="7443343">NewReader</span><span class="op" id="7443352">(</span><span class="string" id="7443353">&#34;xx&#34;</span><span class="op" id="7443357">)</span><span class="op" id="7443358">,</span>&nbsp;<span class="num" id="7443360">1</span><span class="op" id="7443361">)</span><span class="op" id="7443362">)</span>&nbsp;<span class="op" id="7443364">}</span><span class="op" id="7443365">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443370">WantWrite</span><span class="op" id="7443379">:</span>&nbsp;<span class="string" id="7443381">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7443403">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443408">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7443432">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443437">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7443475">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443480">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7443517">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443522"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7443527">(</span><span class="string" id="7443528">&#34;x&#34;</span><span class="op" id="7443531">)</span>&nbsp;<span class="op" id="7443533">+</span>&nbsp;<span class="ident" id="7443535"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7443540">(</span><span class="string" id="7443541">&#34;&#34;</span><span class="op" id="7443543">)</span><span class="op" id="7443544">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443549">WantProxy</span><span class="op" id="7443558">:</span>&nbsp;<span class="string" id="7443560">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7443582">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443587">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7443611">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443616">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7443654">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7443659">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7443696">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443701"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7443706">(</span><span class="string" id="7443707">&#34;x&#34;</span><span class="op" id="7443710">)</span>&nbsp;<span class="op" id="7443712">+</span>&nbsp;<span class="ident" id="7443714"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7443719">(</span><span class="string" id="7443720">&#34;&#34;</span><span class="op" id="7443722">)</span><span class="op" id="7443723">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443726">}</span><span class="op" id="7443727">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7443731">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443793">Req</span><span class="op" id="7443796">:</span>&nbsp;<span class="ident" id="7443798"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7443805">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443810">Method</span><span class="op" id="7443816">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7443825">&#34;POST&#34;</span><span class="op" id="7443831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443836">URL</span><span class="op" id="7443839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7443851"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7443863">(</span><span class="string" id="7443864">&#34;/&#34;</span><span class="op" id="7443867">)</span><span class="op" id="7443868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443873">Host</span><span class="op" id="7443877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7443888">&#34;example.com&#34;</span><span class="op" id="7443901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443906">ProtoMajor</span><span class="op" id="7443916">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7443921">1</span><span class="op" id="7443922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443927">ProtoMinor</span><span class="op" id="7443937">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7443942">1</span><span class="op" id="7443943">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443948">ContentLength</span><span class="op" id="7443961">:</span>&nbsp;<span class="num" id="7443963">10</span><span class="op" id="7443965">,</span>&nbsp;<span class="comment" id="7443967">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444009">}</span><span class="op" id="7444010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444014">Body</span><span class="op" id="7444018">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444025">[</span><span class="op" id="7444026">]</span><span class="builtintype" id="7444027">byte</span><span class="op" id="7444031">(</span><span class="string" id="7444032">&#34;12345&#34;</span><span class="op" id="7444039">)</span><span class="op" id="7444040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444044">WantError</span><span class="op" id="7444053">:</span>&nbsp;<span class="ident" id="7444055"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7444061">.</span><span class="ident" id="7444062">New</span><span class="op" id="7444065">(</span><span class="string" id="7444066">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="7444109">)</span><span class="op" id="7444110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444113">}</span><span class="op" id="7444114">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7444118">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444180">Req</span><span class="op" id="7444183">:</span>&nbsp;<span class="ident" id="7444185"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7444192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444197">Method</span><span class="op" id="7444203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7444212">&#34;POST&#34;</span><span class="op" id="7444218">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444223">URL</span><span class="op" id="7444226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444238"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7444250">(</span><span class="string" id="7444251">&#34;/&#34;</span><span class="op" id="7444254">)</span><span class="op" id="7444255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444260">Host</span><span class="op" id="7444264">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7444275">&#34;example.com&#34;</span><span class="op" id="7444288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444293">ProtoMajor</span><span class="op" id="7444303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7444308">1</span><span class="op" id="7444309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444314">ProtoMinor</span><span class="op" id="7444324">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7444329">1</span><span class="op" id="7444330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444335">ContentLength</span><span class="op" id="7444348">:</span>&nbsp;<span class="num" id="7444350">4</span><span class="op" id="7444351">,</span>&nbsp;<span class="comment" id="7444353">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444397">}</span><span class="op" id="7444398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444402">Body</span><span class="op" id="7444406">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7444413">[</span><span class="op" id="7444414">]</span><span class="builtintype" id="7444415">byte</span><span class="op" id="7444419">(</span><span class="string" id="7444420">&#34;12345678&#34;</span><span class="op" id="7444430">)</span><span class="op" id="7444431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444435">WantError</span><span class="op" id="7444444">:</span>&nbsp;<span class="ident" id="7444446"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7444452">.</span><span class="ident" id="7444453">New</span><span class="op" id="7444456">(</span><span class="string" id="7444457">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="7444499">)</span><span class="op" id="7444500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444503">}</span><span class="op" id="7444504">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7444508">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444561">Req</span><span class="op" id="7444564">:</span>&nbsp;<span class="ident" id="7444566"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7444573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444578">Method</span><span class="op" id="7444584">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7444593">&#34;POST&#34;</span><span class="op" id="7444599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444604">URL</span><span class="op" id="7444607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444619"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7444631">(</span><span class="string" id="7444632">&#34;/&#34;</span><span class="op" id="7444635">)</span><span class="op" id="7444636">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444641">Host</span><span class="op" id="7444645">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7444656">&#34;example.com&#34;</span><span class="op" id="7444669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444674">ProtoMajor</span><span class="op" id="7444684">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7444689">1</span><span class="op" id="7444690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444695">ProtoMinor</span><span class="op" id="7444705">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7444710">1</span><span class="op" id="7444711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444716">ContentLength</span><span class="op" id="7444729">:</span>&nbsp;<span class="num" id="7444731">5</span><span class="op" id="7444732">,</span>&nbsp;<span class="comment" id="7444734">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444763">}</span><span class="op" id="7444764">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444768">WantError</span><span class="op" id="7444777">:</span>&nbsp;<span class="ident" id="7444779"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7444785">.</span><span class="ident" id="7444786">New</span><span class="op" id="7444789">(</span><span class="string" id="7444790">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="7444835">)</span><span class="op" id="7444836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444839">}</span><span class="op" id="7444840">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7444844">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444924">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444928">Req</span><span class="op" id="7444931">:</span>&nbsp;<span class="ident" id="7444933"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7444940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444945">Method</span><span class="op" id="7444951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7444960">&#34;POST&#34;</span><span class="op" id="7444966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444971">URL</span><span class="op" id="7444974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7444986"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7444998">(</span><span class="string" id="7444999">&#34;/&#34;</span><span class="op" id="7445002">)</span><span class="op" id="7445003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445008">Host</span><span class="op" id="7445012">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7445023">&#34;example.com&#34;</span><span class="op" id="7445036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445041">ProtoMajor</span><span class="op" id="7445051">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7445056">1</span><span class="op" id="7445057">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445062">ProtoMinor</span><span class="op" id="7445072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7445077">1</span><span class="op" id="7445078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445083">ContentLength</span><span class="op" id="7445096">:</span>&nbsp;<span class="num" id="7445098">0</span><span class="op" id="7445099">,</span>&nbsp;<span class="comment" id="7445101">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445126">}</span><span class="op" id="7445127">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445132">Body</span><span class="op" id="7445136">:</span>&nbsp;<span class="keyword" id="7445138">func</span><span class="op" id="7445142">(</span><span class="op" id="7445143">)</span>&nbsp;<span class="ident" id="7445145"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7445147">.</span><span class="ident" id="7445148">ReadCloser</span>&nbsp;<span class="op" id="7445159">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445164">err</span>&nbsp;<span class="op" id="7445168">:=</span>&nbsp;<span class="ident" id="7445171"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7445177">.</span><span class="ident" id="7445178">New</span><span class="op" id="7445181">(</span><span class="string" id="7445182">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7445203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445208">errReader</span>&nbsp;<span class="op" id="7445218">:=</span>&nbsp;<span class="op" id="7445221">&amp;</span><span class="ident" id="7445222"><a href="/net/http/transfer.go.html#3896521">errorReader</a></span><span class="op" id="7445233">{</span><span class="ident" id="7445234"><a href="/net/http/requestwrite_test.go.html#7445164">err</a></span><span class="op" id="7445237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7445242">return</span>&nbsp;<span class="ident" id="7445249"><a href="/net/http/requestwrite_test.go.html#7436976">ioutil</a></span><span class="op" id="7445255">.</span><span class="ident" id="7445256">NopCloser</span><span class="op" id="7445265">(</span><span class="ident" id="7445266"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7445268">.</span><span class="ident" id="7445269">MultiReader</span><span class="op" id="7445280">(</span><span class="ident" id="7445281"><a href="/net/http/requestwrite_test.go.html#7437000">strings</a></span><span class="op" id="7445288">.</span><span class="ident" id="7445289">NewReader</span><span class="op" id="7445298">(</span><span class="string" id="7445299">&#34;x&#34;</span><span class="op" id="7445302">)</span><span class="op" id="7445303">,</span>&nbsp;<span class="ident" id="7445305"><a href="/net/http/requestwrite_test.go.html#7445208">errReader</a></span><span class="op" id="7445314">)</span><span class="op" id="7445315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445319">}</span><span class="op" id="7445320">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445325">WantError</span><span class="op" id="7445334">:</span>&nbsp;<span class="ident" id="7445336"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7445342">.</span><span class="ident" id="7445343">New</span><span class="op" id="7445346">(</span><span class="string" id="7445347">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7445368">)</span><span class="op" id="7445369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445372">}</span><span class="op" id="7445373">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7445377">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445453">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445457">Req</span><span class="op" id="7445460">:</span>&nbsp;<span class="ident" id="7445462"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7445469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445474">Method</span><span class="op" id="7445480">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7445489">&#34;POST&#34;</span><span class="op" id="7445495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445500">URL</span><span class="op" id="7445503">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7445515"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7445527">(</span><span class="string" id="7445528">&#34;/&#34;</span><span class="op" id="7445531">)</span><span class="op" id="7445532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445537">Host</span><span class="op" id="7445541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7445552">&#34;example.com&#34;</span><span class="op" id="7445565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445570">ProtoMajor</span><span class="op" id="7445580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7445585">1</span><span class="op" id="7445586">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445591">ProtoMinor</span><span class="op" id="7445601">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7445606">1</span><span class="op" id="7445607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445612">ContentLength</span><span class="op" id="7445625">:</span>&nbsp;<span class="num" id="7445627">0</span><span class="op" id="7445628">,</span>&nbsp;<span class="comment" id="7445630">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445655">}</span><span class="op" id="7445656">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445661">Body</span><span class="op" id="7445665">:</span>&nbsp;<span class="keyword" id="7445667">func</span><span class="op" id="7445671">(</span><span class="op" id="7445672">)</span>&nbsp;<span class="ident" id="7445674"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7445676">.</span><span class="ident" id="7445677">ReadCloser</span>&nbsp;<span class="op" id="7445688">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445693">err</span>&nbsp;<span class="op" id="7445697">:=</span>&nbsp;<span class="ident" id="7445700"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7445706">.</span><span class="ident" id="7445707">New</span><span class="op" id="7445710">(</span><span class="string" id="7445711">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7445732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445737">errReader</span>&nbsp;<span class="op" id="7445747">:=</span>&nbsp;<span class="op" id="7445750">&amp;</span><span class="ident" id="7445751"><a href="/net/http/transfer.go.html#3896521">errorReader</a></span><span class="op" id="7445762">{</span><span class="ident" id="7445763"><a href="/net/http/requestwrite_test.go.html#7445693">err</a></span><span class="op" id="7445766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7445771">return</span>&nbsp;<span class="ident" id="7445778"><a href="/net/http/requestwrite_test.go.html#7436976">ioutil</a></span><span class="op" id="7445784">.</span><span class="ident" id="7445785">NopCloser</span><span class="op" id="7445794">(</span><span class="ident" id="7445795"><a href="/net/http/requestwrite_test.go.html#7445737">errReader</a></span><span class="op" id="7445804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445808">}</span><span class="op" id="7445809">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445814">WantError</span><span class="op" id="7445823">:</span>&nbsp;<span class="ident" id="7445825"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7445831">.</span><span class="ident" id="7445832">New</span><span class="op" id="7445835">(</span><span class="string" id="7445836">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7445857">)</span><span class="op" id="7445858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445861">}</span><span class="op" id="7445862">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7445866">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7445949">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445987">Req</span><span class="op" id="7445990">:</span>&nbsp;<span class="ident" id="7445992"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7445999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446004">Method</span><span class="op" id="7446010">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7446016">&#34;GET&#34;</span><span class="op" id="7446021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446026">URL</span><span class="op" id="7446029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7446038"><a href="/net/http/requestwrite_test.go.html#7450575">mustParseURL</a></span><span class="op" id="7446050">(</span><span class="string" id="7446051">&#34;/foo&#34;</span><span class="op" id="7446057">)</span><span class="op" id="7446058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446063">ProtoMajor</span><span class="op" id="7446073">:</span>&nbsp;<span class="num" id="7446075">1</span><span class="op" id="7446076">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446081">ProtoMinor</span><span class="op" id="7446091">:</span>&nbsp;<span class="num" id="7446093">0</span><span class="op" id="7446094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446099">Header</span><span class="op" id="7446105">:</span>&nbsp;<span class="ident" id="7446107"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7446113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446119">&#34;X-Foo&#34;</span><span class="op" id="7446126">:</span>&nbsp;<span class="op" id="7446128">[</span><span class="op" id="7446129">]</span><span class="builtintype" id="7446130">string</span><span class="op" id="7446136">{</span><span class="string" id="7446137">&#34;X-Bar&#34;</span><span class="op" id="7446144">}</span><span class="op" id="7446145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446150">}</span><span class="op" id="7446151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446155">}</span><span class="op" id="7446156">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446161">WantWrite</span><span class="op" id="7446170">:</span>&nbsp;<span class="string" id="7446172">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7446196">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446201">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7446214">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446219">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7446257">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446262">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7446284">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446287">}</span><span class="op" id="7446288">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7446292">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7446348">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7446388">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7446442">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446483">Req</span><span class="op" id="7446486">:</span>&nbsp;<span class="ident" id="7446488"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7446495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446500">Method</span><span class="op" id="7446506">:</span>&nbsp;<span class="string" id="7446508">&#34;GET&#34;</span><span class="op" id="7446513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446518">Host</span><span class="op" id="7446522">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7446526">&#34;&#34;</span><span class="op" id="7446528">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446533">URL</span><span class="op" id="7446536">:</span>&nbsp;<span class="op" id="7446538">&amp;</span><span class="ident" id="7446539"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7446542">.</span><span class="ident" id="7446543">URL</span><span class="op" id="7446546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446552">Scheme</span><span class="op" id="7446558">:</span>&nbsp;<span class="string" id="7446560">&#34;http&#34;</span><span class="op" id="7446566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446572">Host</span><span class="op" id="7446576">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7446580">&#34;&#34;</span><span class="op" id="7446582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446588">Path</span><span class="op" id="7446592">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7446596">&#34;/search&#34;</span><span class="op" id="7446605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446610">}</span><span class="op" id="7446611">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446616">ProtoMajor</span><span class="op" id="7446626">:</span>&nbsp;<span class="num" id="7446628">1</span><span class="op" id="7446629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446634">ProtoMinor</span><span class="op" id="7446644">:</span>&nbsp;<span class="num" id="7446646">1</span><span class="op" id="7446647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446652">Header</span><span class="op" id="7446658">:</span>&nbsp;<span class="ident" id="7446660"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7446666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446672">&#34;Host&#34;</span><span class="op" id="7446678">:</span>&nbsp;<span class="op" id="7446680">[</span><span class="op" id="7446681">]</span><span class="builtintype" id="7446682">string</span><span class="op" id="7446688">{</span><span class="string" id="7446689">&#34;bad.example.com&#34;</span><span class="op" id="7446706">}</span><span class="op" id="7446707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446712">}</span><span class="op" id="7446713">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446717">}</span><span class="op" id="7446718">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446723">WantWrite</span><span class="op" id="7446732">:</span>&nbsp;<span class="string" id="7446734">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7446761">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446766">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7446779">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7446784">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7446825">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446828">}</span><span class="op" id="7446829">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7446833">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446883">Req</span><span class="op" id="7446886">:</span>&nbsp;<span class="ident" id="7446888"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7446895">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446900">Method</span><span class="op" id="7446906">:</span>&nbsp;<span class="string" id="7446908">&#34;GET&#34;</span><span class="op" id="7446913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446918">URL</span><span class="op" id="7446921">:</span>&nbsp;<span class="op" id="7446923">&amp;</span><span class="ident" id="7446924"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7446927">.</span><span class="ident" id="7446928">URL</span><span class="op" id="7446931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446937">Scheme</span><span class="op" id="7446943">:</span>&nbsp;<span class="string" id="7446945">&#34;http&#34;</span><span class="op" id="7446951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446957">Host</span><span class="op" id="7446961">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7446965">&#34;www.google.com&#34;</span><span class="op" id="7446981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446987">Opaque</span><span class="op" id="7446993">:</span>&nbsp;<span class="string" id="7446995">&#34;/%2F/%2F/&#34;</span><span class="op" id="7447006">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447011">}</span><span class="op" id="7447012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447017">ProtoMajor</span><span class="op" id="7447027">:</span>&nbsp;<span class="num" id="7447029">1</span><span class="op" id="7447030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447035">ProtoMinor</span><span class="op" id="7447045">:</span>&nbsp;<span class="num" id="7447047">1</span><span class="op" id="7447048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447053">Header</span><span class="op" id="7447059">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447065"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7447071">{</span><span class="op" id="7447072">}</span><span class="op" id="7447073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447077">}</span><span class="op" id="7447078">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447083">WantWrite</span><span class="op" id="7447092">:</span>&nbsp;<span class="string" id="7447094">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7447123">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447128">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7447155">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447160">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7447201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447204">}</span><span class="op" id="7447205">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7447209">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447259">Req</span><span class="op" id="7447262">:</span>&nbsp;<span class="ident" id="7447264"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7447271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447276">Method</span><span class="op" id="7447282">:</span>&nbsp;<span class="string" id="7447284">&#34;GET&#34;</span><span class="op" id="7447289">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447294">URL</span><span class="op" id="7447297">:</span>&nbsp;<span class="op" id="7447299">&amp;</span><span class="ident" id="7447300"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7447303">.</span><span class="ident" id="7447304">URL</span><span class="op" id="7447307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447313">Scheme</span><span class="op" id="7447319">:</span>&nbsp;<span class="string" id="7447321">&#34;http&#34;</span><span class="op" id="7447327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447333">Host</span><span class="op" id="7447337">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7447341">&#34;x.google.com&#34;</span><span class="op" id="7447355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447361">Opaque</span><span class="op" id="7447367">:</span>&nbsp;<span class="string" id="7447369">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="7447394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447399">}</span><span class="op" id="7447400">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447405">ProtoMajor</span><span class="op" id="7447415">:</span>&nbsp;<span class="num" id="7447417">1</span><span class="op" id="7447418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447423">ProtoMinor</span><span class="op" id="7447433">:</span>&nbsp;<span class="num" id="7447435">1</span><span class="op" id="7447436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447441">Header</span><span class="op" id="7447447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7447453"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7447459">{</span><span class="op" id="7447460">}</span><span class="op" id="7447461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447465">}</span><span class="op" id="7447466">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447471">WantWrite</span><span class="op" id="7447480">:</span>&nbsp;<span class="string" id="7447482">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7447530">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447535">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7447560">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447565">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7447606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447609">}</span><span class="op" id="7447610">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7447614">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447670">Req</span><span class="op" id="7447673">:</span>&nbsp;<span class="ident" id="7447675"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="7447682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447687">Method</span><span class="op" id="7447693">:</span>&nbsp;<span class="string" id="7447695">&#34;GET&#34;</span><span class="op" id="7447700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447705">URL</span><span class="op" id="7447708">:</span>&nbsp;<span class="op" id="7447710">&amp;</span><span class="ident" id="7447711"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7447714">.</span><span class="ident" id="7447715">URL</span><span class="op" id="7447718">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447724">Scheme</span><span class="op" id="7447730">:</span>&nbsp;<span class="string" id="7447732">&#34;http&#34;</span><span class="op" id="7447738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447744">Host</span><span class="op" id="7447748">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7447752">&#34;www.google.com&#34;</span><span class="op" id="7447768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447774">Path</span><span class="op" id="7447778">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7447782">&#34;/&#34;</span><span class="op" id="7447785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447790">}</span><span class="op" id="7447791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447796">Proto</span><span class="op" id="7447801">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7447808">&#34;HTTP/1.1&#34;</span><span class="op" id="7447818">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447823">ProtoMajor</span><span class="op" id="7447833">:</span>&nbsp;<span class="num" id="7447835">1</span><span class="op" id="7447836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447841">ProtoMinor</span><span class="op" id="7447851">:</span>&nbsp;<span class="num" id="7447853">1</span><span class="op" id="7447854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447859">Header</span><span class="op" id="7447865">:</span>&nbsp;<span class="ident" id="7447867"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7447873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447879">&#34;ALL-CAPS&#34;</span><span class="op" id="7447889">:</span>&nbsp;<span class="op" id="7447891">{</span><span class="string" id="7447892">&#34;x&#34;</span><span class="op" id="7447895">}</span><span class="op" id="7447896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447901">}</span><span class="op" id="7447902">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447906">}</span><span class="op" id="7447907">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447912">WantWrite</span><span class="op" id="7447921">:</span>&nbsp;<span class="string" id="7447923">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7447944">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447949">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7447976">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447981">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7448019">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7448024">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="7448042">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7448047">&#34;\r\n&#34;</span><span class="op" id="7448053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448056">}</span><span class="op" id="7448057">,</span><br>
<span class="lineno"></span><span class="op" id="7448059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="7448062">func</span>&nbsp;<span class="ident" id="7448067">TestRequestWrite</span><span class="op" id="7448083">(</span><span class="ident" id="7448084">t</span>&nbsp;<span class="op" id="7448086">*</span><span class="ident" id="7448087"><a href="/net/http/requestwrite_test.go.html#7437011">testing</a></span><span class="op" id="7448094">.</span><span class="ident" id="7448095">T</span><span class="op" id="7448096">)</span>&nbsp;<span class="op" id="7448098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448101">for</span>&nbsp;<span class="ident" id="7448105">i</span>&nbsp;<span class="op" id="7448107">:=</span>&nbsp;<span class="keyword" id="7448110">range</span>&nbsp;<span class="ident" id="7448116"><a href="/net/http/requestwrite_test.go.html#7437338">reqWriteTests</a></span>&nbsp;<span class="op" id="7448130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448134">tt</span>&nbsp;<span class="op" id="7448137">:=</span>&nbsp;<span class="op" id="7448140">&amp;</span><span class="ident" id="7448141"><a href="/net/http/requestwrite_test.go.html#7437338">reqWriteTests</a></span><span class="op" id="7448154">[</span><span class="ident" id="7448155"><a href="/net/http/requestwrite_test.go.html#7448105">i</a></span><span class="op" id="7448156">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448161">setBody</span>&nbsp;<span class="op" id="7448169">:=</span>&nbsp;<span class="keyword" id="7448172">func</span><span class="op" id="7448176">(</span><span class="op" id="7448177">)</span>&nbsp;<span class="op" id="7448179">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448184">if</span>&nbsp;<span class="ident" id="7448187"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448189">.</span><span class="ident" id="7448190">Body</span>&nbsp;<span class="op" id="7448195">==</span>&nbsp;<span class="ident" id="7448198">nil</span>&nbsp;<span class="op" id="7448202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448208">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448223">switch</span>&nbsp;<span class="ident" id="7448230">b</span>&nbsp;<span class="op" id="7448232">:=</span>&nbsp;<span class="ident" id="7448235"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448237">.</span><span class="ident" id="7448238">Body</span><span class="op" id="7448242">.</span><span class="op" id="7448243">(</span><span class="keyword" id="7448244">type</span><span class="op" id="7448248">)</span>&nbsp;<span class="op" id="7448250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448255">case</span>&nbsp;<span class="op" id="7448260">[</span><span class="op" id="7448261">]</span><span class="builtintype" id="7448262">byte</span><span class="op" id="7448266">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448272"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448274">.</span><span class="ident" id="7448275">Req</span><span class="op" id="7448278">.</span><span class="ident" id="7448279">Body</span>&nbsp;<span class="op" id="7448284">=</span>&nbsp;<span class="ident" id="7448286"><a href="/net/http/requestwrite_test.go.html#7436976">ioutil</a></span><span class="op" id="7448292">.</span><span class="ident" id="7448293">NopCloser</span><span class="op" id="7448302">(</span><span class="ident" id="7448303"><a href="/net/http/requestwrite_test.go.html#7436944">bytes</a></span><span class="op" id="7448308">.</span><span class="ident" id="7448309">NewReader</span><span class="op" id="7448318">(</span><span class="ident" id="7448319"><a href="/net/http/requestwrite_test.go.html#7448230">b</a></span><span class="op" id="7448320">)</span><span class="op" id="7448321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448326">case</span>&nbsp;<span class="keyword" id="7448331">func</span><span class="op" id="7448335">(</span><span class="op" id="7448336">)</span>&nbsp;<span class="ident" id="7448338"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7448340">.</span><span class="ident" id="7448341">ReadCloser</span><span class="op" id="7448351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448357"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448359">.</span><span class="ident" id="7448360">Req</span><span class="op" id="7448363">.</span><span class="ident" id="7448364">Body</span>&nbsp;<span class="op" id="7448369">=</span>&nbsp;<span class="ident" id="7448371"><a href="/net/http/requestwrite_test.go.html#7448230">b</a></span><span class="op" id="7448372">(</span><span class="op" id="7448373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448382">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448386"><a href="/net/http/requestwrite_test.go.html#7448161">setBody</a></span><span class="op" id="7448393">(</span><span class="op" id="7448394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448398">if</span>&nbsp;<span class="ident" id="7448401"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448403">.</span><span class="ident" id="7448404">Req</span><span class="op" id="7448407">.</span><span class="ident" id="7448408">Header</span>&nbsp;<span class="op" id="7448415">==</span>&nbsp;<span class="ident" id="7448418">nil</span>&nbsp;<span class="op" id="7448422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448427"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448429">.</span><span class="ident" id="7448430">Req</span><span class="op" id="7448433">.</span><span class="ident" id="7448434">Header</span>&nbsp;<span class="op" id="7448441">=</span>&nbsp;<span class="builtinfunc" id="7448443">make</span><span class="op" id="7448447">(</span><span class="ident" id="7448448"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="7448454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448463">var</span>&nbsp;<span class="ident" id="7448467">braw</span>&nbsp;<span class="ident" id="7448472"><a href="/net/http/requestwrite_test.go.html#7436944">bytes</a></span><span class="op" id="7448477">.</span><span class="ident" id="7448478">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448487">err</span>&nbsp;<span class="op" id="7448491">:=</span>&nbsp;<span class="ident" id="7448494"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448496">.</span><span class="ident" id="7448497">Req</span><span class="op" id="7448500">.</span><span class="ident" id="7448501">Write</span><span class="op" id="7448506">(</span><span class="op" id="7448507">&amp;</span><span class="ident" id="7448508"><a href="/net/http/requestwrite_test.go.html#7448467">braw</a></span><span class="op" id="7448512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448516">if</span>&nbsp;<span class="ident" id="7448519">g</span><span class="op" id="7448520">,</span>&nbsp;<span class="ident" id="7448522">e</span>&nbsp;<span class="op" id="7448524">:=</span>&nbsp;<span class="ident" id="7448527"><a href="/net/http/requestwrite_test.go.html#7436963">fmt</a></span><span class="op" id="7448530">.</span><span class="ident" id="7448531">Sprintf</span><span class="op" id="7448538">(</span><span class="string" id="7448539">&#34;%v&#34;</span><span class="op" id="7448543">,</span>&nbsp;<span class="ident" id="7448545"><a href="/net/http/requestwrite_test.go.html#7448487">err</a></span><span class="op" id="7448548">)</span><span class="op" id="7448549">,</span>&nbsp;<span class="ident" id="7448551"><a href="/net/http/requestwrite_test.go.html#7436963">fmt</a></span><span class="op" id="7448554">.</span><span class="ident" id="7448555">Sprintf</span><span class="op" id="7448562">(</span><span class="string" id="7448563">&#34;%v&#34;</span><span class="op" id="7448567">,</span>&nbsp;<span class="ident" id="7448569"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448571">.</span><span class="ident" id="7448572">WantError</span><span class="op" id="7448581">)</span><span class="op" id="7448582">;</span>&nbsp;<span class="ident" id="7448584"><a href="/net/http/requestwrite_test.go.html#7448519">g</a></span>&nbsp;<span class="op" id="7448586">!=</span>&nbsp;<span class="ident" id="7448589"><a href="/net/http/requestwrite_test.go.html#7448522">e</a></span>&nbsp;<span class="op" id="7448591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448596"><a href="/net/http/requestwrite_test.go.html#7448084">t</a></span><span class="op" id="7448597">.</span><span class="ident" id="7448598">Errorf</span><span class="op" id="7448604">(</span><span class="string" id="7448605">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7448637">,</span>&nbsp;<span class="ident" id="7448639"><a href="/net/http/requestwrite_test.go.html#7448105">i</a></span><span class="op" id="7448640">,</span>&nbsp;<span class="ident" id="7448642"><a href="/net/http/requestwrite_test.go.html#7448519">g</a></span><span class="op" id="7448643">,</span>&nbsp;<span class="ident" id="7448645"><a href="/net/http/requestwrite_test.go.html#7448522">e</a></span><span class="op" id="7448646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448651">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448666">if</span>&nbsp;<span class="ident" id="7448669"><a href="/net/http/requestwrite_test.go.html#7448487">err</a></span>&nbsp;<span class="op" id="7448673">!=</span>&nbsp;<span class="ident" id="7448676">nil</span>&nbsp;<span class="op" id="7448680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448685">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448701">if</span>&nbsp;<span class="ident" id="7448704"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448706">.</span><span class="ident" id="7448707">WantWrite</span>&nbsp;<span class="op" id="7448717">!=</span>&nbsp;<span class="string" id="7448720">&#34;&#34;</span>&nbsp;<span class="op" id="7448723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448728">sraw</span>&nbsp;<span class="op" id="7448733">:=</span>&nbsp;<span class="ident" id="7448736"><a href="/net/http/requestwrite_test.go.html#7448467">braw</a></span><span class="op" id="7448740">.</span><span class="ident" id="7448741">String</span><span class="op" id="7448747">(</span><span class="op" id="7448748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448753">if</span>&nbsp;<span class="ident" id="7448756"><a href="/net/http/requestwrite_test.go.html#7448728">sraw</a></span>&nbsp;<span class="op" id="7448761">!=</span>&nbsp;<span class="ident" id="7448764"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448766">.</span><span class="ident" id="7448767">WantWrite</span>&nbsp;<span class="op" id="7448777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448783"><a href="/net/http/requestwrite_test.go.html#7448084">t</a></span><span class="op" id="7448784">.</span><span class="ident" id="7448785">Errorf</span><span class="op" id="7448791">(</span><span class="string" id="7448792">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7448829">,</span>&nbsp;<span class="ident" id="7448831"><a href="/net/http/requestwrite_test.go.html#7448105">i</a></span><span class="op" id="7448832">,</span>&nbsp;<span class="ident" id="7448834"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448836">.</span><span class="ident" id="7448837">WantWrite</span><span class="op" id="7448846">,</span>&nbsp;<span class="ident" id="7448848"><a href="/net/http/requestwrite_test.go.html#7448728">sraw</a></span><span class="op" id="7448852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448858">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448879">if</span>&nbsp;<span class="ident" id="7448882"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448884">.</span><span class="ident" id="7448885">WantProxy</span>&nbsp;<span class="op" id="7448895">!=</span>&nbsp;<span class="string" id="7448898">&#34;&#34;</span>&nbsp;<span class="op" id="7448901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448906"><a href="/net/http/requestwrite_test.go.html#7448161">setBody</a></span><span class="op" id="7448913">(</span><span class="op" id="7448914">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448919">var</span>&nbsp;<span class="ident" id="7448923">praw</span>&nbsp;<span class="ident" id="7448928"><a href="/net/http/requestwrite_test.go.html#7436944">bytes</a></span><span class="op" id="7448933">.</span><span class="ident" id="7448934">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448944"><a href="/net/http/requestwrite_test.go.html#7448487">err</a></span>&nbsp;<span class="op" id="7448948">=</span>&nbsp;<span class="ident" id="7448950"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7448952">.</span><span class="ident" id="7448953">Req</span><span class="op" id="7448956">.</span><span class="ident" id="7448957">WriteProxy</span><span class="op" id="7448967">(</span><span class="op" id="7448968">&amp;</span><span class="ident" id="7448969"><a href="/net/http/requestwrite_test.go.html#7448923">praw</a></span><span class="op" id="7448973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448978">if</span>&nbsp;<span class="ident" id="7448981"><a href="/net/http/requestwrite_test.go.html#7448487">err</a></span>&nbsp;<span class="op" id="7448985">!=</span>&nbsp;<span class="ident" id="7448988">nil</span>&nbsp;<span class="op" id="7448992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448998"><a href="/net/http/requestwrite_test.go.html#7448084">t</a></span><span class="op" id="7448999">.</span><span class="ident" id="7449000">Errorf</span><span class="op" id="7449006">(</span><span class="string" id="7449007">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7449027">,</span>&nbsp;<span class="ident" id="7449029"><a href="/net/http/requestwrite_test.go.html#7448105">i</a></span><span class="op" id="7449030">,</span>&nbsp;<span class="ident" id="7449032"><a href="/net/http/requestwrite_test.go.html#7448487">err</a></span><span class="op" id="7449035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449041">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449058">sraw</span>&nbsp;<span class="op" id="7449063">:=</span>&nbsp;<span class="ident" id="7449066"><a href="/net/http/requestwrite_test.go.html#7448923">praw</a></span><span class="op" id="7449070">.</span><span class="ident" id="7449071">String</span><span class="op" id="7449077">(</span><span class="op" id="7449078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449083">if</span>&nbsp;<span class="ident" id="7449086"><a href="/net/http/requestwrite_test.go.html#7449058">sraw</a></span>&nbsp;<span class="op" id="7449091">!=</span>&nbsp;<span class="ident" id="7449094"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7449096">.</span><span class="ident" id="7449097">WantProxy</span>&nbsp;<span class="op" id="7449107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449113"><a href="/net/http/requestwrite_test.go.html#7448084">t</a></span><span class="op" id="7449114">.</span><span class="ident" id="7449115">Errorf</span><span class="op" id="7449121">(</span><span class="string" id="7449122">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7449165">,</span>&nbsp;<span class="ident" id="7449167"><a href="/net/http/requestwrite_test.go.html#7448105">i</a></span><span class="op" id="7449168">,</span>&nbsp;<span class="ident" id="7449170"><a href="/net/http/requestwrite_test.go.html#7448134">tt</a></span><span class="op" id="7449172">.</span><span class="ident" id="7449173">WantProxy</span><span class="op" id="7449182">,</span>&nbsp;<span class="ident" id="7449184"><a href="/net/http/requestwrite_test.go.html#7449058">sraw</a></span><span class="op" id="7449188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449194">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449213">}</span><br>
<span class="lineno"></span><span class="op" id="7449215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7449218">type</span>&nbsp;<span class="ident" id="7449223">closeChecker</span>&nbsp;<span class="keyword" id="7449236">struct</span>&nbsp;<span class="op" id="7449243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449246"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7449248">.</span><span class="ident" id="7449249">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449257">closed</span>&nbsp;<span class="builtintype" id="7449264">bool</span><br>
<span class="lineno"></span><span class="op" id="7449269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="7449272">func</span>&nbsp;<span class="op" id="7449277">(</span><span class="ident" id="7449278">rc</span>&nbsp;<span class="op" id="7449281">*</span><span class="ident" id="7449282"><a href="/net/http/requestwrite_test.go.html#7449223">closeChecker</a></span><span class="op" id="7449294">)</span>&nbsp;<span class="ident" id="7449296">Close</span><span class="op" id="7449301">(</span><span class="op" id="7449302">)</span>&nbsp;<span class="builtintype" id="7449304">error</span>&nbsp;<span class="op" id="7449310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449313"><a href="/net/http/requestwrite_test.go.html#7449278">rc</a></span><span class="op" id="7449315">.</span><span class="ident" id="7449316">closed</span>&nbsp;<span class="op" id="7449323">=</span>&nbsp;<span class="ident" id="7449325">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449331">return</span>&nbsp;<span class="ident" id="7449338">nil</span><br>
<span class="lineno"></span><span class="op" id="7449342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="7449345">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="7449429">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="7449512">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="7449572">func</span>&nbsp;<span class="ident" id="7449577">TestRequestWriteClosesBody</span><span class="op" id="7449603">(</span><span class="ident" id="7449604">t</span>&nbsp;<span class="op" id="7449606">*</span><span class="ident" id="7449607"><a href="/net/http/requestwrite_test.go.html#7437011">testing</a></span><span class="op" id="7449614">.</span><span class="ident" id="7449615">T</span><span class="op" id="7449616">)</span>&nbsp;<span class="op" id="7449618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449621">rc</span>&nbsp;<span class="op" id="7449624">:=</span>&nbsp;<span class="op" id="7449627">&amp;</span><span class="ident" id="7449628"><a href="/net/http/requestwrite_test.go.html#7449223">closeChecker</a></span><span class="op" id="7449640">{</span><span class="ident" id="7449641">Reader</span><span class="op" id="7449647">:</span>&nbsp;<span class="ident" id="7449649"><a href="/net/http/requestwrite_test.go.html#7437000">strings</a></span><span class="op" id="7449656">.</span><span class="ident" id="7449657">NewReader</span><span class="op" id="7449666">(</span><span class="string" id="7449667">&#34;my&nbsp;body&#34;</span><span class="op" id="7449676">)</span><span class="op" id="7449677">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449680">req</span><span class="op" id="7449683">,</span>&nbsp;<span class="ident" id="7449685">_</span>&nbsp;<span class="op" id="7449687">:=</span>&nbsp;<span class="ident" id="7449690"><a href="/net/http/request.go.html#3804993">NewRequest</a></span><span class="op" id="7449700">(</span><span class="string" id="7449701">&#34;POST&#34;</span><span class="op" id="7449707">,</span>&nbsp;<span class="string" id="7449709">&#34;http://foo.com/&#34;</span><span class="op" id="7449726">,</span>&nbsp;<span class="ident" id="7449728"><a href="/net/http/requestwrite_test.go.html#7449621">rc</a></span><span class="op" id="7449730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449733">if</span>&nbsp;<span class="ident" id="7449736"><a href="/net/http/requestwrite_test.go.html#7449680">req</a></span><span class="op" id="7449739">.</span><span class="ident" id="7449740">ContentLength</span>&nbsp;<span class="op" id="7449754">!=</span>&nbsp;<span class="num" id="7449757">0</span>&nbsp;<span class="op" id="7449759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449763"><a href="/net/http/requestwrite_test.go.html#7449604">t</a></span><span class="op" id="7449764">.</span><span class="ident" id="7449765">Errorf</span><span class="op" id="7449771">(</span><span class="string" id="7449772">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7449806">,</span>&nbsp;<span class="ident" id="7449808"><a href="/net/http/requestwrite_test.go.html#7449680">req</a></span><span class="op" id="7449811">.</span><span class="ident" id="7449812">ContentLength</span><span class="op" id="7449825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449831">buf</span>&nbsp;<span class="op" id="7449835">:=</span>&nbsp;<span class="builtinfunc" id="7449838">new</span><span class="op" id="7449841">(</span><span class="ident" id="7449842"><a href="/net/http/requestwrite_test.go.html#7436944">bytes</a></span><span class="op" id="7449847">.</span><span class="ident" id="7449848">Buffer</span><span class="op" id="7449854">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449857"><a href="/net/http/requestwrite_test.go.html#7449680">req</a></span><span class="op" id="7449860">.</span><span class="ident" id="7449861">Write</span><span class="op" id="7449866">(</span><span class="ident" id="7449867"><a href="/net/http/requestwrite_test.go.html#7449831">buf</a></span><span class="op" id="7449870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449873">if</span>&nbsp;<span class="op" id="7449876">!</span><span class="ident" id="7449877"><a href="/net/http/requestwrite_test.go.html#7449621">rc</a></span><span class="op" id="7449879">.</span><span class="ident" id="7449880">closed</span>&nbsp;<span class="op" id="7449887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449891"><a href="/net/http/requestwrite_test.go.html#7449604">t</a></span><span class="op" id="7449892">.</span><span class="ident" id="7449893">Error</span><span class="op" id="7449898">(</span><span class="string" id="7449899">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="7449928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449934">expected</span>&nbsp;<span class="op" id="7449943">:=</span>&nbsp;<span class="string" id="7449946">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7449968">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7449972">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="7449992">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7449996">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7450034">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7450038">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7450075">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7450079">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7450145">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7450215">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7450286">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450343"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7450348">(</span><span class="string" id="7450349">&#34;m&#34;</span><span class="op" id="7450352">)</span>&nbsp;<span class="op" id="7450354">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450358"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7450363">(</span><span class="string" id="7450364">&#34;y&nbsp;body&#34;</span><span class="op" id="7450372">)</span>&nbsp;<span class="op" id="7450374">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450378"><a href="/net/http/requestwrite_test.go.html#7450495">chunk</a></span><span class="op" id="7450383">(</span><span class="string" id="7450384">&#34;&#34;</span><span class="op" id="7450386">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450389">if</span>&nbsp;<span class="ident" id="7450392"><a href="/net/http/requestwrite_test.go.html#7449831">buf</a></span><span class="op" id="7450395">.</span><span class="ident" id="7450396">String</span><span class="op" id="7450402">(</span><span class="op" id="7450403">)</span>&nbsp;<span class="op" id="7450405">!=</span>&nbsp;<span class="ident" id="7450408"><a href="/net/http/requestwrite_test.go.html#7449934">expected</a></span>&nbsp;<span class="op" id="7450417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450421"><a href="/net/http/requestwrite_test.go.html#7449604">t</a></span><span class="op" id="7450422">.</span><span class="ident" id="7450423">Errorf</span><span class="op" id="7450429">(</span><span class="string" id="7450430">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7450458">,</span>&nbsp;<span class="ident" id="7450460"><a href="/net/http/requestwrite_test.go.html#7449831">buf</a></span><span class="op" id="7450463">.</span><span class="ident" id="7450464">String</span><span class="op" id="7450470">(</span><span class="op" id="7450471">)</span><span class="op" id="7450472">,</span>&nbsp;<span class="ident" id="7450474"><a href="/net/http/requestwrite_test.go.html#7449934">expected</a></span><span class="op" id="7450482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7450485">}</span><br>
<span class="lineno"></span><span class="op" id="7450487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="7450490">func</span>&nbsp;<span class="ident" id="7450495">chunk</span><span class="op" id="7450500">(</span><span class="ident" id="7450501">s</span>&nbsp;<span class="builtintype" id="7450503">string</span><span class="op" id="7450509">)</span>&nbsp;<span class="builtintype" id="7450511">string</span>&nbsp;<span class="op" id="7450518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450521">return</span>&nbsp;<span class="ident" id="7450528"><a href="/net/http/requestwrite_test.go.html#7436963">fmt</a></span><span class="op" id="7450531">.</span><span class="ident" id="7450532">Sprintf</span><span class="op" id="7450539">(</span><span class="string" id="7450540">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7450554">,</span>&nbsp;<span class="builtinfunc" id="7450556">len</span><span class="op" id="7450559">(</span><span class="ident" id="7450560"><a href="/net/http/requestwrite_test.go.html#7450501">s</a></span><span class="op" id="7450561">)</span><span class="op" id="7450562">,</span>&nbsp;<span class="ident" id="7450564"><a href="/net/http/requestwrite_test.go.html#7450501">s</a></span><span class="op" id="7450565">)</span><br>
<span class="lineno"></span><span class="op" id="7450567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7450570">func</span>&nbsp;<span class="ident" id="7450575">mustParseURL</span><span class="op" id="7450587">(</span><span class="ident" id="7450588">s</span>&nbsp;<span class="builtintype" id="7450590">string</span><span class="op" id="7450596">)</span>&nbsp;<span class="op" id="7450598">*</span><span class="ident" id="7450599"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7450602">.</span><span class="ident" id="7450603">URL</span>&nbsp;<span class="op" id="7450607">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450610">u</span><span class="op" id="7450611">,</span>&nbsp;<span class="ident" id="7450613">err</span>&nbsp;<span class="op" id="7450617">:=</span>&nbsp;<span class="ident" id="7450620"><a href="/net/http/requestwrite_test.go.html#7436989">url</a></span><span class="op" id="7450623">.</span><span class="ident" id="7450624">Parse</span><span class="op" id="7450629">(</span><span class="ident" id="7450630"><a href="/net/http/requestwrite_test.go.html#7450588">s</a></span><span class="op" id="7450631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450634">if</span>&nbsp;<span class="ident" id="7450637"><a href="/net/http/requestwrite_test.go.html#7450613">err</a></span>&nbsp;<span class="op" id="7450641">!=</span>&nbsp;<span class="ident" id="7450644">nil</span>&nbsp;<span class="op" id="7450648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7450652">panic</span><span class="op" id="7450657">(</span><span class="ident" id="7450658"><a href="/net/http/requestwrite_test.go.html#7436963">fmt</a></span><span class="op" id="7450661">.</span><span class="ident" id="7450662">Sprintf</span><span class="op" id="7450669">(</span><span class="string" id="7450670">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7450696">,</span>&nbsp;<span class="ident" id="7450698"><a href="/net/http/requestwrite_test.go.html#7450588">s</a></span><span class="op" id="7450699">,</span>&nbsp;<span class="ident" id="7450701"><a href="/net/http/requestwrite_test.go.html#7450613">err</a></span><span class="op" id="7450704">)</span><span class="op" id="7450705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7450708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450711">return</span>&nbsp;<span class="ident" id="7450718"><a href="/net/http/requestwrite_test.go.html#7450610">u</a></span><br>
<span class="lineno">565</span><span class="op" id="7450720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7450723">type</span>&nbsp;<span class="ident" id="7450728">writerFunc</span>&nbsp;<span class="keyword" id="7450739">func</span><span class="op" id="7450743">(</span><span class="op" id="7450744">[</span><span class="op" id="7450745">]</span><span class="builtintype" id="7450746">byte</span><span class="op" id="7450750">)</span>&nbsp;<span class="op" id="7450752">(</span><span class="builtintype" id="7450753">int</span><span class="op" id="7450756">,</span>&nbsp;<span class="builtintype" id="7450758">error</span><span class="op" id="7450763">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7450766">func</span>&nbsp;<span class="op" id="7450771">(</span><span class="ident" id="7450772">f</span>&nbsp;<span class="ident" id="7450774"><a href="/net/http/requestwrite_test.go.html#7450728">writerFunc</a></span><span class="op" id="7450784">)</span>&nbsp;<span class="ident" id="7450786">Write</span><span class="op" id="7450791">(</span><span class="ident" id="7450792">p</span>&nbsp;<span class="op" id="7450794">[</span><span class="op" id="7450795">]</span><span class="builtintype" id="7450796">byte</span><span class="op" id="7450800">)</span>&nbsp;<span class="op" id="7450802">(</span><span class="builtintype" id="7450803">int</span><span class="op" id="7450806">,</span>&nbsp;<span class="builtintype" id="7450808">error</span><span class="op" id="7450813">)</span>&nbsp;<span class="op" id="7450815">{</span>&nbsp;<span class="keyword" id="7450817">return</span>&nbsp;<span class="ident" id="7450824"><a href="/net/http/requestwrite_test.go.html#7450772">f</a></span><span class="op" id="7450825">(</span><span class="ident" id="7450826"><a href="/net/http/requestwrite_test.go.html#7450792">p</a></span><span class="op" id="7450827">)</span>&nbsp;<span class="op" id="7450829">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="7450832">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="7450912">func</span>&nbsp;<span class="ident" id="7450917">TestRequestWriteError</span><span class="op" id="7450938">(</span><span class="ident" id="7450939">t</span>&nbsp;<span class="op" id="7450941">*</span><span class="ident" id="7450942"><a href="/net/http/requestwrite_test.go.html#7437011">testing</a></span><span class="op" id="7450949">.</span><span class="ident" id="7450950">T</span><span class="op" id="7450951">)</span>&nbsp;<span class="op" id="7450953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450956">failAfter</span><span class="op" id="7450965">,</span>&nbsp;<span class="ident" id="7450967">writeCount</span>&nbsp;<span class="op" id="7450978">:=</span>&nbsp;<span class="num" id="7450981">0</span><span class="op" id="7450982">,</span>&nbsp;<span class="num" id="7450984">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450987">errFail</span>&nbsp;<span class="op" id="7450995">:=</span>&nbsp;<span class="ident" id="7450998"><a href="/net/http/requestwrite_test.go.html#7436953">errors</a></span><span class="op" id="7451004">.</span><span class="ident" id="7451005">New</span><span class="op" id="7451008">(</span><span class="string" id="7451009">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7451029">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7451033">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7451094">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7451157">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7451210">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451226">w</span>&nbsp;<span class="op" id="7451228">:=</span>&nbsp;<span class="keyword" id="7451231">struct</span>&nbsp;<span class="op" id="7451238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451242"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7451244">.</span><span class="ident" id="7451245">ByteWriter</span>&nbsp;<span class="comment" id="7451256">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451302"><a href="/net/http/requestwrite_test.go.html#7436970">io</a></span><span class="op" id="7451304">.</span><span class="ident" id="7451305">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451313">}</span><span class="op" id="7451314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451318">nil</span><span class="op" id="7451321">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451325"><a href="/net/http/requestwrite_test.go.html#7450728">writerFunc</a></span><span class="op" id="7451335">(</span><span class="keyword" id="7451336">func</span><span class="op" id="7451340">(</span><span class="ident" id="7451341">p</span>&nbsp;<span class="op" id="7451343">[</span><span class="op" id="7451344">]</span><span class="builtintype" id="7451345">byte</span><span class="op" id="7451349">)</span>&nbsp;<span class="op" id="7451351">(</span><span class="ident" id="7451352">n</span>&nbsp;<span class="builtintype" id="7451354">int</span><span class="op" id="7451357">,</span>&nbsp;<span class="ident" id="7451359">err</span>&nbsp;<span class="builtintype" id="7451363">error</span><span class="op" id="7451368">)</span>&nbsp;<span class="op" id="7451370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451375"><a href="/net/http/requestwrite_test.go.html#7450967">writeCount</a></span><span class="op" id="7451385">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451391">if</span>&nbsp;<span class="ident" id="7451394"><a href="/net/http/requestwrite_test.go.html#7450956">failAfter</a></span>&nbsp;<span class="op" id="7451404">==</span>&nbsp;<span class="num" id="7451407">0</span>&nbsp;<span class="op" id="7451409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451415"><a href="/net/http/requestwrite_test.go.html#7451359">err</a></span>&nbsp;<span class="op" id="7451419">=</span>&nbsp;<span class="ident" id="7451421"><a href="/net/http/requestwrite_test.go.html#7450987">errFail</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451432">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451437"><a href="/net/http/requestwrite_test.go.html#7450956">failAfter</a></span><span class="op" id="7451446">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451452">return</span>&nbsp;<span class="builtinfunc" id="7451459">len</span><span class="op" id="7451462">(</span><span class="ident" id="7451463"><a href="/net/http/requestwrite_test.go.html#7451341">p</a></span><span class="op" id="7451464">)</span><span class="op" id="7451465">,</span>&nbsp;<span class="ident" id="7451467"><a href="/net/http/requestwrite_test.go.html#7451359">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451473">}</span><span class="op" id="7451474">)</span><span class="op" id="7451475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451482">req</span><span class="op" id="7451485">,</span>&nbsp;<span class="ident" id="7451487">_</span>&nbsp;<span class="op" id="7451489">:=</span>&nbsp;<span class="ident" id="7451492"><a href="/net/http/request.go.html#3804993">NewRequest</a></span><span class="op" id="7451502">(</span><span class="string" id="7451503">&#34;GET&#34;</span><span class="op" id="7451508">,</span>&nbsp;<span class="string" id="7451510">&#34;http://example.com/&#34;</span><span class="op" id="7451531">,</span>&nbsp;<span class="ident" id="7451533">nil</span><span class="op" id="7451536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451539">const</span>&nbsp;<span class="ident" id="7451545">writeCalls</span>&nbsp;<span class="op" id="7451556">=</span>&nbsp;<span class="num" id="7451558">4</span>&nbsp;<span class="comment" id="7451560">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451612">sawGood</span>&nbsp;<span class="op" id="7451620">:=</span>&nbsp;<span class="ident" id="7451623">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451630">for</span>&nbsp;<span class="ident" id="7451634">n</span>&nbsp;<span class="op" id="7451636">:=</span>&nbsp;<span class="num" id="7451639">0</span><span class="op" id="7451640">;</span>&nbsp;<span class="ident" id="7451642"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span>&nbsp;<span class="op" id="7451644">&lt;=</span>&nbsp;<span class="ident" id="7451647"><a href="/net/http/requestwrite_test.go.html#7451545">writeCalls</a></span><span class="op" id="7451657">+</span><span class="num" id="7451658">2</span><span class="op" id="7451659">;</span>&nbsp;<span class="ident" id="7451661"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span><span class="op" id="7451662">++</span>&nbsp;<span class="op" id="7451665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451669"><a href="/net/http/requestwrite_test.go.html#7450956">failAfter</a></span>&nbsp;<span class="op" id="7451679">=</span>&nbsp;<span class="ident" id="7451681"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451685"><a href="/net/http/requestwrite_test.go.html#7450967">writeCount</a></span>&nbsp;<span class="op" id="7451696">=</span>&nbsp;<span class="num" id="7451698">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451702">err</span>&nbsp;<span class="op" id="7451706">:=</span>&nbsp;<span class="ident" id="7451709"><a href="/net/http/requestwrite_test.go.html#7451482">req</a></span><span class="op" id="7451712">.</span><span class="ident" id="7451713">Write</span><span class="op" id="7451718">(</span><span class="ident" id="7451719"><a href="/net/http/requestwrite_test.go.html#7451226">w</a></span><span class="op" id="7451720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451724">var</span>&nbsp;<span class="ident" id="7451728">wantErr</span>&nbsp;<span class="builtintype" id="7451736">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451744">if</span>&nbsp;<span class="ident" id="7451747"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span>&nbsp;<span class="op" id="7451749">&lt;</span>&nbsp;<span class="ident" id="7451751"><a href="/net/http/requestwrite_test.go.html#7451545">writeCalls</a></span>&nbsp;<span class="op" id="7451762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451767"><a href="/net/http/requestwrite_test.go.html#7451728">wantErr</a></span>&nbsp;<span class="op" id="7451775">=</span>&nbsp;<span class="ident" id="7451777"><a href="/net/http/requestwrite_test.go.html#7450987">errFail</a></span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451791">if</span>&nbsp;<span class="ident" id="7451794"><a href="/net/http/requestwrite_test.go.html#7451702">err</a></span>&nbsp;<span class="op" id="7451798">!=</span>&nbsp;<span class="ident" id="7451801"><a href="/net/http/requestwrite_test.go.html#7451728">wantErr</a></span>&nbsp;<span class="op" id="7451809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451814"><a href="/net/http/requestwrite_test.go.html#7450939">t</a></span><span class="op" id="7451815">.</span><span class="ident" id="7451816">Errorf</span><span class="op" id="7451822">(</span><span class="string" id="7451823">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7451868">,</span>&nbsp;<span class="ident" id="7451870"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span><span class="op" id="7451871">,</span>&nbsp;<span class="ident" id="7451873"><a href="/net/http/requestwrite_test.go.html#7451702">err</a></span><span class="op" id="7451876">,</span>&nbsp;<span class="ident" id="7451878"><a href="/net/http/requestwrite_test.go.html#7451728">wantErr</a></span><span class="op" id="7451885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451890">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451901">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451905">if</span>&nbsp;<span class="ident" id="7451908"><a href="/net/http/requestwrite_test.go.html#7451702">err</a></span>&nbsp;<span class="op" id="7451912">==</span>&nbsp;<span class="ident" id="7451915">nil</span>&nbsp;<span class="op" id="7451919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451924"><a href="/net/http/requestwrite_test.go.html#7451612">sawGood</a></span>&nbsp;<span class="op" id="7451932">=</span>&nbsp;<span class="ident" id="7451934">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451942">if</span>&nbsp;<span class="ident" id="7451945"><a href="/net/http/requestwrite_test.go.html#7450967">writeCount</a></span>&nbsp;<span class="op" id="7451956">!=</span>&nbsp;<span class="ident" id="7451959"><a href="/net/http/requestwrite_test.go.html#7451545">writeCalls</a></span>&nbsp;<span class="op" id="7451970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451976"><a href="/net/http/requestwrite_test.go.html#7450939">t</a></span><span class="op" id="7451977">.</span><span class="ident" id="7451978">Fatalf</span><span class="op" id="7451984">(</span><span class="string" id="7451985">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7452026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7452031">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7452035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7452039">if</span>&nbsp;<span class="ident" id="7452042"><a href="/net/http/requestwrite_test.go.html#7450967">writeCount</a></span>&nbsp;<span class="op" id="7452053">&gt;</span>&nbsp;<span class="ident" id="7452055"><a href="/net/http/requestwrite_test.go.html#7451545">writeCalls</a></span>&nbsp;<span class="op" id="7452066">||</span>&nbsp;<span class="ident" id="7452069"><a href="/net/http/requestwrite_test.go.html#7450967">writeCount</a></span>&nbsp;<span class="op" id="7452080">&gt;</span>&nbsp;<span class="ident" id="7452082"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span><span class="op" id="7452083">+</span><span class="num" id="7452084">1</span>&nbsp;<span class="op" id="7452086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7452091"><a href="/net/http/requestwrite_test.go.html#7450939">t</a></span><span class="op" id="7452092">.</span><span class="ident" id="7452093">Errorf</span><span class="op" id="7452099">(</span><span class="string" id="7452100">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="7452159">,</span>&nbsp;<span class="ident" id="7452161"><a href="/net/http/requestwrite_test.go.html#7451634">n</a></span><span class="op" id="7452162">,</span>&nbsp;<span class="ident" id="7452164"><a href="/net/http/requestwrite_test.go.html#7450967">writeCount</a></span><span class="op" id="7452174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7452178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7452181">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7452184">if</span>&nbsp;<span class="op" id="7452187">!</span><span class="ident" id="7452188"><a href="/net/http/requestwrite_test.go.html#7451612">sawGood</a></span>&nbsp;<span class="op" id="7452196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7452200"><a href="/net/http/requestwrite_test.go.html#7450939">t</a></span><span class="op" id="7452201">.</span><span class="ident" id="7452202">Fatalf</span><span class="op" id="7452208">(</span><span class="string" id="7452209">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7452250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7452253">}</span><br>
<span class="lineno"></span><span class="op" id="7452255">}</span>
</div>
</body>
</html>
