<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3783117">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3783173">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3783227">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3783278">package</span>&nbsp;<span class="ident" id="3783286">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3783297">import</span>&nbsp;<span class="op" id="3783304">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3783307">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3783316">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3783323">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3783328">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3783331">//&nbsp;A&nbsp;Writer&nbsp;implements&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;writing</span><br>
<span class="lineno"></span><span class="comment" id="3783386">//&nbsp;requests&nbsp;or&nbsp;responses&nbsp;to&nbsp;a&nbsp;text&nbsp;protocol&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">15</span><span class="keyword" id="3783450">type</span>&nbsp;<span class="ident" id="3783455">Writer</span>&nbsp;<span class="keyword" id="3783462">struct</span>&nbsp;<span class="op" id="3783469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783472">W</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3783476">*</span><span class="ident" id="3783477">bufio</span><span class="op" id="3783482">.</span><span class="ident" id="3783483">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783491">dot</span>&nbsp;<span class="op" id="3783495">*</span><span class="ident" id="3783496">dotWriter</span><br>
<span class="lineno"></span><span class="op" id="3783506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3783509">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="3783557">func</span>&nbsp;<span class="ident" id="3783562">NewWriter</span><span class="op" id="3783571">(</span><span class="ident" id="3783572">w</span>&nbsp;<span class="op" id="3783574">*</span><span class="ident" id="3783575">bufio</span><span class="op" id="3783580">.</span><span class="ident" id="3783581">Writer</span><span class="op" id="3783587">)</span>&nbsp;<span class="op" id="3783589">*</span><span class="ident" id="3783590">Writer</span>&nbsp;<span class="op" id="3783597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783600">return</span>&nbsp;<span class="op" id="3783607">&amp;</span><span class="ident" id="3783608">Writer</span><span class="op" id="3783614">{</span><span class="ident" id="3783615">W</span><span class="op" id="3783616">:</span>&nbsp;<span class="ident" id="3783618">w</span><span class="op" id="3783619">}</span><br>
<span class="lineno"></span><span class="op" id="3783621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3783624">var</span>&nbsp;<span class="ident" id="3783628">crnl</span>&nbsp;<span class="op" id="3783633">=</span>&nbsp;<span class="op" id="3783635">[</span><span class="op" id="3783636">]</span><span class="builtintype" id="3783637">byte</span><span class="op" id="3783641">{</span><span class="string" id="3783642">&#39;\r&#39;</span><span class="op" id="3783646">,</span>&nbsp;<span class="string" id="3783648">&#39;\n&#39;</span><span class="op" id="3783652">}</span><br>
<span class="lineno"></span><span class="keyword" id="3783654">var</span>&nbsp;<span class="ident" id="3783658">dotcrnl</span>&nbsp;<span class="op" id="3783666">=</span>&nbsp;<span class="op" id="3783668">[</span><span class="op" id="3783669">]</span><span class="builtintype" id="3783670">byte</span><span class="op" id="3783674">{</span><span class="string" id="3783675">&#39;.&#39;</span><span class="op" id="3783678">,</span>&nbsp;<span class="string" id="3783680">&#39;\r&#39;</span><span class="op" id="3783684">,</span>&nbsp;<span class="string" id="3783686">&#39;\n&#39;</span><span class="op" id="3783690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3783693">//&nbsp;PrintfLine&nbsp;writes&nbsp;the&nbsp;formatted&nbsp;output&nbsp;followed&nbsp;by&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="keyword" id="3783753">func</span>&nbsp;<span class="op" id="3783758">(</span><span class="ident" id="3783759">w</span>&nbsp;<span class="op" id="3783761">*</span><span class="ident" id="3783762">Writer</span><span class="op" id="3783768">)</span>&nbsp;<span class="ident" id="3783770">PrintfLine</span><span class="op" id="3783780">(</span><span class="ident" id="3783781">format</span>&nbsp;<span class="builtintype" id="3783788">string</span><span class="op" id="3783794">,</span>&nbsp;<span class="ident" id="3783796">args</span>&nbsp;<span class="op" id="3783801">...</span><span class="keyword" id="3783804">interface</span><span class="op" id="3783813">{</span><span class="op" id="3783814">}</span><span class="op" id="3783815">)</span>&nbsp;<span class="builtintype" id="3783817">error</span>&nbsp;<span class="op" id="3783823">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783826">w</span><span class="op" id="3783827">.</span><span class="ident" id="3783828">closeDot</span><span class="op" id="3783836">(</span><span class="op" id="3783837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783840">fmt</span><span class="op" id="3783843">.</span><span class="ident" id="3783844">Fprintf</span><span class="op" id="3783851">(</span><span class="ident" id="3783852">w</span><span class="op" id="3783853">.</span><span class="ident" id="3783854">W</span><span class="op" id="3783855">,</span>&nbsp;<span class="ident" id="3783857">format</span><span class="op" id="3783863">,</span>&nbsp;<span class="ident" id="3783865">args</span><span class="op" id="3783869">...</span><span class="op" id="3783872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3783875">w</span><span class="op" id="3783876">.</span><span class="ident" id="3783877">W</span><span class="op" id="3783878">.</span><span class="ident" id="3783879">Write</span><span class="op" id="3783884">(</span><span class="ident" id="3783885">crnl</span><span class="op" id="3783889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3783892">return</span>&nbsp;<span class="ident" id="3783899">w</span><span class="op" id="3783900">.</span><span class="ident" id="3783901">W</span><span class="op" id="3783902">.</span><span class="ident" id="3783903">Flush</span><span class="op" id="3783908">(</span><span class="op" id="3783909">)</span><br>
<span class="lineno"></span><span class="op" id="3783911">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3783914">//&nbsp;DotWriter&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;write&nbsp;a&nbsp;dot-encoding&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3783991">//&nbsp;It&nbsp;takes&nbsp;care&nbsp;of&nbsp;inserting&nbsp;leading&nbsp;dots&nbsp;when&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3784050">//&nbsp;translating&nbsp;line-ending&nbsp;\n&nbsp;into&nbsp;\r\n,&nbsp;and&nbsp;adding&nbsp;the&nbsp;final&nbsp;.\r\n&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="3784123">//&nbsp;when&nbsp;the&nbsp;DotWriter&nbsp;is&nbsp;closed.&nbsp;&nbsp;The&nbsp;caller&nbsp;should&nbsp;close&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="3784185">//&nbsp;DotWriter&nbsp;before&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;a&nbsp;method&nbsp;on&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="3784237">//</span><br>
<span class="lineno"></span><span class="comment" id="3784240">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Reader&#39;s&nbsp;DotReader&nbsp;method&nbsp;for&nbsp;details&nbsp;about&nbsp;dot-encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="3784327">func</span>&nbsp;<span class="op" id="3784332">(</span><span class="ident" id="3784333">w</span>&nbsp;<span class="op" id="3784335">*</span><span class="ident" id="3784336">Writer</span><span class="op" id="3784342">)</span>&nbsp;<span class="ident" id="3784344">DotWriter</span><span class="op" id="3784353">(</span><span class="op" id="3784354">)</span>&nbsp;<span class="ident" id="3784356">io</span><span class="op" id="3784358">.</span><span class="ident" id="3784359">WriteCloser</span>&nbsp;<span class="op" id="3784371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784374">w</span><span class="op" id="3784375">.</span><span class="ident" id="3784376">closeDot</span><span class="op" id="3784384">(</span><span class="op" id="3784385">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784388">w</span><span class="op" id="3784389">.</span><span class="ident" id="3784390">dot</span>&nbsp;<span class="op" id="3784394">=</span>&nbsp;<span class="op" id="3784396">&amp;</span><span class="ident" id="3784397">dotWriter</span><span class="op" id="3784406">{</span><span class="ident" id="3784407">w</span><span class="op" id="3784408">:</span>&nbsp;<span class="ident" id="3784410">w</span><span class="op" id="3784411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784414">return</span>&nbsp;<span class="ident" id="3784421">w</span><span class="op" id="3784422">.</span><span class="ident" id="3784423">dot</span><br>
<span class="lineno"></span><span class="op" id="3784427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3784430">func</span>&nbsp;<span class="op" id="3784435">(</span><span class="ident" id="3784436">w</span>&nbsp;<span class="op" id="3784438">*</span><span class="ident" id="3784439">Writer</span><span class="op" id="3784445">)</span>&nbsp;<span class="ident" id="3784447">closeDot</span><span class="op" id="3784455">(</span><span class="op" id="3784456">)</span>&nbsp;<span class="op" id="3784458">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784461">if</span>&nbsp;<span class="ident" id="3784464">w</span><span class="op" id="3784465">.</span><span class="ident" id="3784466">dot</span>&nbsp;<span class="op" id="3784470">!=</span>&nbsp;<span class="ident" id="3784473">nil</span>&nbsp;<span class="op" id="3784477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784481">w</span><span class="op" id="3784482">.</span><span class="ident" id="3784483">dot</span><span class="op" id="3784486">.</span><span class="ident" id="3784487">Close</span><span class="op" id="3784492">(</span><span class="op" id="3784493">)</span>&nbsp;<span class="comment" id="3784495">//&nbsp;sets&nbsp;w.dot&nbsp;=&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3784516">}</span><br>
<span class="lineno"></span><span class="op" id="3784518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3784521">type</span>&nbsp;<span class="ident" id="3784526">dotWriter</span>&nbsp;<span class="keyword" id="3784536">struct</span>&nbsp;<span class="op" id="3784543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784546">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3784552">*</span><span class="ident" id="3784553">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784561">state</span>&nbsp;<span class="builtintype" id="3784567">int</span><br>
<span class="lineno"></span><span class="op" id="3784571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3784574">const</span>&nbsp;<span class="op" id="3784580">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784583">wstateBeginLine</span>&nbsp;<span class="op" id="3784599">=</span>&nbsp;<span class="ident" id="3784601">iota</span>&nbsp;<span class="comment" id="3784606">//&nbsp;beginning&nbsp;of&nbsp;line;&nbsp;initial&nbsp;state;&nbsp;must&nbsp;be&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784657">wstateCR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3784680">//&nbsp;wrote&nbsp;\r&nbsp;(possibly&nbsp;at&nbsp;end&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784719">wstateData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3784742">//&nbsp;writing&nbsp;data&nbsp;in&nbsp;middle&nbsp;of&nbsp;line</span><br>
<span class="lineno"></span><span class="op" id="3784776">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3784779">func</span>&nbsp;<span class="op" id="3784784">(</span><span class="ident" id="3784785">d</span>&nbsp;<span class="op" id="3784787">*</span><span class="ident" id="3784788">dotWriter</span><span class="op" id="3784797">)</span>&nbsp;<span class="ident" id="3784799">Write</span><span class="op" id="3784804">(</span><span class="ident" id="3784805">b</span>&nbsp;<span class="op" id="3784807">[</span><span class="op" id="3784808">]</span><span class="builtintype" id="3784809">byte</span><span class="op" id="3784813">)</span>&nbsp;<span class="op" id="3784815">(</span><span class="ident" id="3784816">n</span>&nbsp;<span class="builtintype" id="3784818">int</span><span class="op" id="3784821">,</span>&nbsp;<span class="ident" id="3784823">err</span>&nbsp;<span class="builtintype" id="3784827">error</span><span class="op" id="3784832">)</span>&nbsp;<span class="op" id="3784834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784837">bw</span>&nbsp;<span class="op" id="3784840">:=</span>&nbsp;<span class="ident" id="3784843">d</span><span class="op" id="3784844">.</span><span class="ident" id="3784845">w</span><span class="op" id="3784846">.</span><span class="ident" id="3784847">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784850">for</span>&nbsp;<span class="ident" id="3784854">n</span>&nbsp;<span class="op" id="3784856">&lt;</span>&nbsp;<span class="builtinfunc" id="3784858">len</span><span class="op" id="3784861">(</span><span class="ident" id="3784862">b</span><span class="op" id="3784863">)</span>&nbsp;<span class="op" id="3784865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784869">c</span>&nbsp;<span class="op" id="3784871">:=</span>&nbsp;<span class="ident" id="3784874">b</span><span class="op" id="3784875">[</span><span class="ident" id="3784876">n</span><span class="op" id="3784877">]</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784881">switch</span>&nbsp;<span class="ident" id="3784888">d</span><span class="op" id="3784889">.</span><span class="ident" id="3784890">state</span>&nbsp;<span class="op" id="3784896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784900">case</span>&nbsp;<span class="ident" id="3784905">wstateBeginLine</span><span class="op" id="3784920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784925">d</span><span class="op" id="3784926">.</span><span class="ident" id="3784927">state</span>&nbsp;<span class="op" id="3784933">=</span>&nbsp;<span class="ident" id="3784935">wstateData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3784949">if</span>&nbsp;<span class="ident" id="3784952">c</span>&nbsp;<span class="op" id="3784954">==</span>&nbsp;<span class="string" id="3784957">&#39;.&#39;</span>&nbsp;<span class="op" id="3784961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3784967">//&nbsp;escape&nbsp;leading&nbsp;dot</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3784993">bw</span><span class="op" id="3784995">.</span><span class="ident" id="3784996">WriteByte</span><span class="op" id="3785005">(</span><span class="string" id="3785006">&#39;.&#39;</span><span class="op" id="3785009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785019">fallthrough</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785034">case</span>&nbsp;<span class="ident" id="3785039">wstateData</span><span class="op" id="3785049">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785054">if</span>&nbsp;<span class="ident" id="3785057">c</span>&nbsp;<span class="op" id="3785059">==</span>&nbsp;<span class="string" id="3785062">&#39;\r&#39;</span>&nbsp;<span class="op" id="3785067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785073">d</span><span class="op" id="3785074">.</span><span class="ident" id="3785075">state</span>&nbsp;<span class="op" id="3785081">=</span>&nbsp;<span class="ident" id="3785083">wstateCR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785100">if</span>&nbsp;<span class="ident" id="3785103">c</span>&nbsp;<span class="op" id="3785105">==</span>&nbsp;<span class="string" id="3785108">&#39;\n&#39;</span>&nbsp;<span class="op" id="3785113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785119">bw</span><span class="op" id="3785121">.</span><span class="ident" id="3785122">WriteByte</span><span class="op" id="3785131">(</span><span class="string" id="3785132">&#39;\r&#39;</span><span class="op" id="3785136">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785142">d</span><span class="op" id="3785143">.</span><span class="ident" id="3785144">state</span>&nbsp;<span class="op" id="3785150">=</span>&nbsp;<span class="ident" id="3785152">wstateBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785176">case</span>&nbsp;<span class="ident" id="3785181">wstateCR</span><span class="op" id="3785189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785194">d</span><span class="op" id="3785195">.</span><span class="ident" id="3785196">state</span>&nbsp;<span class="op" id="3785202">=</span>&nbsp;<span class="ident" id="3785204">wstateData</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785218">if</span>&nbsp;<span class="ident" id="3785221">c</span>&nbsp;<span class="op" id="3785223">==</span>&nbsp;<span class="string" id="3785226">&#39;\n&#39;</span>&nbsp;<span class="op" id="3785231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785237">d</span><span class="op" id="3785238">.</span><span class="ident" id="3785239">state</span>&nbsp;<span class="op" id="3785245">=</span>&nbsp;<span class="ident" id="3785247">wstateBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785274">if</span>&nbsp;<span class="ident" id="3785277">err</span>&nbsp;<span class="op" id="3785281">=</span>&nbsp;<span class="ident" id="3785283">bw</span><span class="op" id="3785285">.</span><span class="ident" id="3785286">WriteByte</span><span class="op" id="3785295">(</span><span class="ident" id="3785296">c</span><span class="op" id="3785297">)</span><span class="op" id="3785298">;</span>&nbsp;<span class="ident" id="3785300">err</span>&nbsp;<span class="op" id="3785304">!=</span>&nbsp;<span class="ident" id="3785307">nil</span>&nbsp;<span class="op" id="3785311">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785316">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785328">n</span><span class="op" id="3785329">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785336">return</span><br>
<span class="lineno">100</span><span class="op" id="3785343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3785346">func</span>&nbsp;<span class="op" id="3785351">(</span><span class="ident" id="3785352">d</span>&nbsp;<span class="op" id="3785354">*</span><span class="ident" id="3785355">dotWriter</span><span class="op" id="3785364">)</span>&nbsp;<span class="ident" id="3785366">Close</span><span class="op" id="3785371">(</span><span class="op" id="3785372">)</span>&nbsp;<span class="builtintype" id="3785374">error</span>&nbsp;<span class="op" id="3785380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785383">if</span>&nbsp;<span class="ident" id="3785386">d</span><span class="op" id="3785387">.</span><span class="ident" id="3785388">w</span><span class="op" id="3785389">.</span><span class="ident" id="3785390">dot</span>&nbsp;<span class="op" id="3785394">==</span>&nbsp;<span class="ident" id="3785397">d</span>&nbsp;<span class="op" id="3785399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785403">d</span><span class="op" id="3785404">.</span><span class="ident" id="3785405">w</span><span class="op" id="3785406">.</span><span class="ident" id="3785407">dot</span>&nbsp;<span class="op" id="3785411">=</span>&nbsp;<span class="ident" id="3785413">nil</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785421">bw</span>&nbsp;<span class="op" id="3785424">:=</span>&nbsp;<span class="ident" id="3785427">d</span><span class="op" id="3785428">.</span><span class="ident" id="3785429">w</span><span class="op" id="3785430">.</span><span class="ident" id="3785431">W</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785434">switch</span>&nbsp;<span class="ident" id="3785441">d</span><span class="op" id="3785442">.</span><span class="ident" id="3785443">state</span>&nbsp;<span class="op" id="3785449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785452">default</span><span class="op" id="3785459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785463">bw</span><span class="op" id="3785465">.</span><span class="ident" id="3785466">WriteByte</span><span class="op" id="3785475">(</span><span class="string" id="3785476">&#39;\r&#39;</span><span class="op" id="3785480">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785484">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785497">case</span>&nbsp;<span class="ident" id="3785502">wstateCR</span><span class="op" id="3785510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785514">bw</span><span class="op" id="3785516">.</span><span class="ident" id="3785517">WriteByte</span><span class="op" id="3785526">(</span><span class="string" id="3785527">&#39;\n&#39;</span><span class="op" id="3785531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785535">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785548">case</span>&nbsp;<span class="ident" id="3785553">wstateBeginLine</span><span class="op" id="3785568">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3785572">bw</span><span class="op" id="3785574">.</span><span class="ident" id="3785575">Write</span><span class="op" id="3785580">(</span><span class="ident" id="3785581">dotcrnl</span><span class="op" id="3785588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3785591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3785594">return</span>&nbsp;<span class="ident" id="3785601">bw</span><span class="op" id="3785603">.</span><span class="ident" id="3785604">Flush</span><span class="op" id="3785609">(</span><span class="op" id="3785610">)</span><br>
<span class="lineno"></span><span class="op" id="3785612">}</span>
</div>
</body>
</html>
