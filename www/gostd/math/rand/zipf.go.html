<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3807042">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3807097">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3807151">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3807202">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3807230">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3807275">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3807316">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3807377">package</span>&nbsp;<span class="ident" id="3807385">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3807391">import</span>&nbsp;<span class="string" id="3807398">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3807406">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3807453">type</span>&nbsp;<span class="ident" id="3807458">Zipf</span>&nbsp;<span class="keyword" id="3807463">struct</span>&nbsp;<span class="op" id="3807470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807473">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807486">*</span><span class="ident" id="3807487">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807493">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807506">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807515">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807528">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807537">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807550">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807559">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807572">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807581">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807594">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807603">oneminusQinv</span>&nbsp;<span class="builtintype" id="3807616">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807625">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807638">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807647">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3807660">float64</span><br>
<span class="lineno">25</span><span class="op" id="3807668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3807671">func</span>&nbsp;<span class="op" id="3807676">(</span><span class="ident" id="3807677">z</span>&nbsp;<span class="op" id="3807679">*</span><span class="ident" id="3807680">Zipf</span><span class="op" id="3807684">)</span>&nbsp;<span class="ident" id="3807686">h</span><span class="op" id="3807687">(</span><span class="ident" id="3807688">x</span>&nbsp;<span class="builtintype" id="3807690">float64</span><span class="op" id="3807697">)</span>&nbsp;<span class="builtintype" id="3807699">float64</span>&nbsp;<span class="op" id="3807707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807710">return</span>&nbsp;<span class="ident" id="3807717">math</span><span class="op" id="3807721">.</span><span class="ident" id="3807722">Exp</span><span class="op" id="3807725">(</span><span class="ident" id="3807726">z</span><span class="op" id="3807727">.</span><span class="ident" id="3807728">oneminusQ</span><span class="op" id="3807737">*</span><span class="ident" id="3807738">math</span><span class="op" id="3807742">.</span><span class="ident" id="3807743">Log</span><span class="op" id="3807746">(</span><span class="ident" id="3807747">z</span><span class="op" id="3807748">.</span><span class="ident" id="3807749">v</span><span class="op" id="3807750">+</span><span class="ident" id="3807751">x</span><span class="op" id="3807752">)</span><span class="op" id="3807753">)</span>&nbsp;<span class="op" id="3807755">*</span>&nbsp;<span class="ident" id="3807757">z</span><span class="op" id="3807758">.</span><span class="ident" id="3807759">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3807772">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3807775">func</span>&nbsp;<span class="op" id="3807780">(</span><span class="ident" id="3807781">z</span>&nbsp;<span class="op" id="3807783">*</span><span class="ident" id="3807784">Zipf</span><span class="op" id="3807788">)</span>&nbsp;<span class="ident" id="3807790">hinv</span><span class="op" id="3807794">(</span><span class="ident" id="3807795">x</span>&nbsp;<span class="builtintype" id="3807797">float64</span><span class="op" id="3807804">)</span>&nbsp;<span class="builtintype" id="3807806">float64</span>&nbsp;<span class="op" id="3807814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807817">return</span>&nbsp;<span class="ident" id="3807824">math</span><span class="op" id="3807828">.</span><span class="ident" id="3807829">Exp</span><span class="op" id="3807832">(</span><span class="ident" id="3807833">z</span><span class="op" id="3807834">.</span><span class="ident" id="3807835">oneminusQinv</span><span class="op" id="3807847">*</span><span class="ident" id="3807848">math</span><span class="op" id="3807852">.</span><span class="ident" id="3807853">Log</span><span class="op" id="3807856">(</span><span class="ident" id="3807857">z</span><span class="op" id="3807858">.</span><span class="ident" id="3807859">oneminusQ</span><span class="op" id="3807868">*</span><span class="ident" id="3807869">x</span><span class="op" id="3807870">)</span><span class="op" id="3807871">)</span>&nbsp;<span class="op" id="3807873">-</span>&nbsp;<span class="ident" id="3807875">z</span><span class="op" id="3807876">.</span><span class="ident" id="3807877">v</span><br>
<span class="lineno"></span><span class="op" id="3807879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3807882">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3807946">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3808007">func</span>&nbsp;<span class="ident" id="3808012">NewZipf</span><span class="op" id="3808019">(</span><span class="ident" id="3808020">r</span>&nbsp;<span class="op" id="3808022">*</span><span class="ident" id="3808023">Rand</span><span class="op" id="3808027">,</span>&nbsp;<span class="ident" id="3808029">s</span>&nbsp;<span class="builtintype" id="3808031">float64</span><span class="op" id="3808038">,</span>&nbsp;<span class="ident" id="3808040">v</span>&nbsp;<span class="builtintype" id="3808042">float64</span><span class="op" id="3808049">,</span>&nbsp;<span class="ident" id="3808051">imax</span>&nbsp;<span class="ident" id="3808056">uint64</span><span class="op" id="3808062">)</span>&nbsp;<span class="op" id="3808064">*</span><span class="ident" id="3808065">Zipf</span>&nbsp;<span class="op" id="3808070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808073">z</span>&nbsp;<span class="op" id="3808075">:=</span>&nbsp;<span class="builtinfunc" id="3808078">new</span><span class="op" id="3808081">(</span><span class="ident" id="3808082">Zipf</span><span class="op" id="3808086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808089">if</span>&nbsp;<span class="ident" id="3808092">s</span>&nbsp;<span class="op" id="3808094">&lt;=</span>&nbsp;<span class="num" id="3808097">1.0</span>&nbsp;<span class="op" id="3808101">||</span>&nbsp;<span class="ident" id="3808104">v</span>&nbsp;<span class="op" id="3808106">&lt;</span>&nbsp;<span class="num" id="3808108">1</span>&nbsp;<span class="op" id="3808110">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808114">return</span>&nbsp;<span class="ident" id="3808121">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808129">z</span><span class="op" id="3808130">.</span><span class="ident" id="3808131">r</span>&nbsp;<span class="op" id="3808133">=</span>&nbsp;<span class="ident" id="3808135">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808138">z</span><span class="op" id="3808139">.</span><span class="ident" id="3808140">imax</span>&nbsp;<span class="op" id="3808145">=</span>&nbsp;<span class="builtintype" id="3808147">float64</span><span class="op" id="3808154">(</span><span class="ident" id="3808155">imax</span><span class="op" id="3808159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808162">z</span><span class="op" id="3808163">.</span><span class="ident" id="3808164">v</span>&nbsp;<span class="op" id="3808166">=</span>&nbsp;<span class="ident" id="3808168">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808171">z</span><span class="op" id="3808172">.</span><span class="ident" id="3808173">q</span>&nbsp;<span class="op" id="3808175">=</span>&nbsp;<span class="ident" id="3808177">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808180">z</span><span class="op" id="3808181">.</span><span class="ident" id="3808182">oneminusQ</span>&nbsp;<span class="op" id="3808192">=</span>&nbsp;<span class="num" id="3808194">1.0</span>&nbsp;<span class="op" id="3808198">-</span>&nbsp;<span class="ident" id="3808200">z</span><span class="op" id="3808201">.</span><span class="ident" id="3808202">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808205">z</span><span class="op" id="3808206">.</span><span class="ident" id="3808207">oneminusQinv</span>&nbsp;<span class="op" id="3808220">=</span>&nbsp;<span class="num" id="3808222">1.0</span>&nbsp;<span class="op" id="3808226">/</span>&nbsp;<span class="ident" id="3808228">z</span><span class="op" id="3808229">.</span><span class="ident" id="3808230">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808241">z</span><span class="op" id="3808242">.</span><span class="ident" id="3808243">hxm</span>&nbsp;<span class="op" id="3808247">=</span>&nbsp;<span class="ident" id="3808249">z</span><span class="op" id="3808250">.</span><span class="ident" id="3808251">h</span><span class="op" id="3808252">(</span><span class="ident" id="3808253">z</span><span class="op" id="3808254">.</span><span class="ident" id="3808255">imax</span>&nbsp;<span class="op" id="3808260">+</span>&nbsp;<span class="num" id="3808262">0.5</span><span class="op" id="3808265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808268">z</span><span class="op" id="3808269">.</span><span class="ident" id="3808270">hx0minusHxm</span>&nbsp;<span class="op" id="3808282">=</span>&nbsp;<span class="ident" id="3808284">z</span><span class="op" id="3808285">.</span><span class="ident" id="3808286">h</span><span class="op" id="3808287">(</span><span class="num" id="3808288">0.5</span><span class="op" id="3808291">)</span>&nbsp;<span class="op" id="3808293">-</span>&nbsp;<span class="ident" id="3808295">math</span><span class="op" id="3808299">.</span><span class="ident" id="3808300">Exp</span><span class="op" id="3808303">(</span><span class="ident" id="3808304">math</span><span class="op" id="3808308">.</span><span class="ident" id="3808309">Log</span><span class="op" id="3808312">(</span><span class="ident" id="3808313">z</span><span class="op" id="3808314">.</span><span class="ident" id="3808315">v</span><span class="op" id="3808316">)</span><span class="op" id="3808317">*</span><span class="op" id="3808318">(</span><span class="op" id="3808319">-</span><span class="ident" id="3808320">z</span><span class="op" id="3808321">.</span><span class="ident" id="3808322">q</span><span class="op" id="3808323">)</span><span class="op" id="3808324">)</span>&nbsp;<span class="op" id="3808326">-</span>&nbsp;<span class="ident" id="3808328">z</span><span class="op" id="3808329">.</span><span class="ident" id="3808330">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808335">z</span><span class="op" id="3808336">.</span><span class="ident" id="3808337">s</span>&nbsp;<span class="op" id="3808339">=</span>&nbsp;<span class="num" id="3808341">1</span>&nbsp;<span class="op" id="3808343">-</span>&nbsp;<span class="ident" id="3808345">z</span><span class="op" id="3808346">.</span><span class="ident" id="3808347">hinv</span><span class="op" id="3808351">(</span><span class="ident" id="3808352">z</span><span class="op" id="3808353">.</span><span class="ident" id="3808354">h</span><span class="op" id="3808355">(</span><span class="num" id="3808356">1.5</span><span class="op" id="3808359">)</span><span class="op" id="3808360">-</span><span class="ident" id="3808361">math</span><span class="op" id="3808365">.</span><span class="ident" id="3808366">Exp</span><span class="op" id="3808369">(</span><span class="op" id="3808370">-</span><span class="ident" id="3808371">z</span><span class="op" id="3808372">.</span><span class="ident" id="3808373">q</span><span class="op" id="3808374">*</span><span class="ident" id="3808375">math</span><span class="op" id="3808379">.</span><span class="ident" id="3808380">Log</span><span class="op" id="3808383">(</span><span class="ident" id="3808384">z</span><span class="op" id="3808385">.</span><span class="ident" id="3808386">v</span><span class="op" id="3808387">+</span><span class="num" id="3808388">1.0</span><span class="op" id="3808391">)</span><span class="op" id="3808392">)</span><span class="op" id="3808393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808396">return</span>&nbsp;<span class="ident" id="3808403">z</span><br>
<span class="lineno"></span><span class="op" id="3808405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3808408">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3808477">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3808500">func</span>&nbsp;<span class="op" id="3808505">(</span><span class="ident" id="3808506">z</span>&nbsp;<span class="op" id="3808508">*</span><span class="ident" id="3808509">Zipf</span><span class="op" id="3808513">)</span>&nbsp;<span class="ident" id="3808515">Uint64</span><span class="op" id="3808521">(</span><span class="op" id="3808522">)</span>&nbsp;<span class="ident" id="3808524">uint64</span>&nbsp;<span class="op" id="3808531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808534">if</span>&nbsp;<span class="ident" id="3808537">z</span>&nbsp;<span class="op" id="3808539">==</span>&nbsp;<span class="ident" id="3808542">nil</span>&nbsp;<span class="op" id="3808546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3808550">panic</span><span class="op" id="3808555">(</span><span class="string" id="3808556">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3808572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808575">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808578">k</span>&nbsp;<span class="op" id="3808580">:=</span>&nbsp;<span class="num" id="3808583">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808589">for</span>&nbsp;<span class="op" id="3808593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808597">r</span>&nbsp;<span class="op" id="3808599">:=</span>&nbsp;<span class="ident" id="3808602">z</span><span class="op" id="3808603">.</span><span class="ident" id="3808604">r</span><span class="op" id="3808605">.</span><span class="ident" id="3808606">Float64</span><span class="op" id="3808613">(</span><span class="op" id="3808614">)</span>&nbsp;<span class="comment" id="3808616">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808632">ur</span>&nbsp;<span class="op" id="3808635">:=</span>&nbsp;<span class="ident" id="3808638">z</span><span class="op" id="3808639">.</span><span class="ident" id="3808640">hxm</span>&nbsp;<span class="op" id="3808644">+</span>&nbsp;<span class="ident" id="3808646">r</span><span class="op" id="3808647">*</span><span class="ident" id="3808648">z</span><span class="op" id="3808649">.</span><span class="ident" id="3808650">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808664">x</span>&nbsp;<span class="op" id="3808666">:=</span>&nbsp;<span class="ident" id="3808669">z</span><span class="op" id="3808670">.</span><span class="ident" id="3808671">hinv</span><span class="op" id="3808675">(</span><span class="ident" id="3808676">ur</span><span class="op" id="3808678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808682">k</span>&nbsp;<span class="op" id="3808684">=</span>&nbsp;<span class="ident" id="3808686">math</span><span class="op" id="3808690">.</span><span class="ident" id="3808691">Floor</span><span class="op" id="3808696">(</span><span class="ident" id="3808697">x</span>&nbsp;<span class="op" id="3808699">+</span>&nbsp;<span class="num" id="3808701">0.5</span><span class="op" id="3808704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808708">if</span>&nbsp;<span class="ident" id="3808711">k</span><span class="op" id="3808712">-</span><span class="ident" id="3808713">x</span>&nbsp;<span class="op" id="3808715">&lt;=</span>&nbsp;<span class="ident" id="3808718">z</span><span class="op" id="3808719">.</span><span class="ident" id="3808720">s</span>&nbsp;<span class="op" id="3808722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808727">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808735">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808739">if</span>&nbsp;<span class="ident" id="3808742">ur</span>&nbsp;<span class="op" id="3808745">&gt;=</span>&nbsp;<span class="ident" id="3808748">z</span><span class="op" id="3808749">.</span><span class="ident" id="3808750">h</span><span class="op" id="3808751">(</span><span class="ident" id="3808752">k</span><span class="op" id="3808753">+</span><span class="num" id="3808754">0.5</span><span class="op" id="3808757">)</span><span class="op" id="3808758">-</span><span class="ident" id="3808759">math</span><span class="op" id="3808763">.</span><span class="ident" id="3808764">Exp</span><span class="op" id="3808767">(</span><span class="op" id="3808768">-</span><span class="ident" id="3808769">math</span><span class="op" id="3808773">.</span><span class="ident" id="3808774">Log</span><span class="op" id="3808777">(</span><span class="ident" id="3808778">k</span><span class="op" id="3808779">+</span><span class="ident" id="3808780">z</span><span class="op" id="3808781">.</span><span class="ident" id="3808782">v</span><span class="op" id="3808783">)</span><span class="op" id="3808784">*</span><span class="ident" id="3808785">z</span><span class="op" id="3808786">.</span><span class="ident" id="3808787">q</span><span class="op" id="3808788">)</span>&nbsp;<span class="op" id="3808790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808795">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808809">return</span>&nbsp;<span class="ident" id="3808816">uint64</span><span class="op" id="3808822">(</span><span class="ident" id="3808823">k</span><span class="op" id="3808824">)</span><br>
<span class="lineno">75</span><span class="op" id="3808826">}</span>
</div>
</body>
</html>
