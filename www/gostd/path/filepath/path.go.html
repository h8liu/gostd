<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path/filepath</h2>
<ul>
<li><a href="/gostd/path/filepath/example_unix_test.go.html">example_unix_test.go</a></li>
<li><a href="/gostd/path/filepath/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/path/filepath/match.go.html">match.go</a></li>
<li><a href="/gostd/path/filepath/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/filepath/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/path/filepath/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/path/filepath/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/path/filepath/symlink.go.html">symlink.go</a></li>
<li><a href="/gostd/path/filepath/symlink_unix.go.html">symlink_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3335181">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3335236">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3335290">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3335341">//&nbsp;Package&nbsp;filepath&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;filename&nbsp;paths</span><br>
<span class="lineno"></span><span class="comment" id="3335421">//&nbsp;in&nbsp;a&nbsp;way&nbsp;compatible&nbsp;with&nbsp;the&nbsp;target&nbsp;operating&nbsp;system-defined&nbsp;file&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="3335497">package</span>&nbsp;<span class="ident" id="3335505">filepath</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3335515">import</span>&nbsp;<span class="op" id="3335522">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3335525">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3335535">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3335541">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3335549">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3335559">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3335562">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="3335612">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="3335670">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="3335736">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno">20</span><span class="keyword" id="3335793">type</span>&nbsp;<span class="ident" id="3335798">lazybuf</span>&nbsp;<span class="keyword" id="3335806">struct</span>&nbsp;<span class="op" id="3335813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3335816">path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3335827">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3335835">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3335846">[</span><span class="op" id="3335847">]</span><span class="builtintype" id="3335848">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3335854">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3335865">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3335870">volAndPath</span>&nbsp;<span class="builtintype" id="3335881">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3335889">volLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3335900">int</span><br>
<span class="lineno"></span><span class="op" id="3335904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3335907">func</span>&nbsp;<span class="op" id="3335912">(</span><span class="ident" id="3335913">b</span>&nbsp;<span class="op" id="3335915">*</span><span class="ident" id="3335916">lazybuf</span><span class="op" id="3335923">)</span>&nbsp;<span class="ident" id="3335925">index</span><span class="op" id="3335930">(</span><span class="ident" id="3335931">i</span>&nbsp;<span class="builtintype" id="3335933">int</span><span class="op" id="3335936">)</span>&nbsp;<span class="builtintype" id="3335938">byte</span>&nbsp;<span class="op" id="3335943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3335946">if</span>&nbsp;<span class="ident" id="3335949">b</span><span class="op" id="3335950">.</span><span class="ident" id="3335951">buf</span>&nbsp;<span class="op" id="3335955">!=</span>&nbsp;<span class="builtintype" id="3335958">nil</span>&nbsp;<span class="op" id="3335962">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3335966">return</span>&nbsp;<span class="ident" id="3335973">b</span><span class="op" id="3335974">.</span><span class="ident" id="3335975">buf</span><span class="op" id="3335978">[</span><span class="ident" id="3335979">i</span><span class="op" id="3335980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3335983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3335986">return</span>&nbsp;<span class="ident" id="3335993">b</span><span class="op" id="3335994">.</span><span class="ident" id="3335995">path</span><span class="op" id="3335999">[</span><span class="ident" id="3336000">i</span><span class="op" id="3336001">]</span><br>
<span class="lineno"></span><span class="op" id="3336003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="3336006">func</span>&nbsp;<span class="op" id="3336011">(</span><span class="ident" id="3336012">b</span>&nbsp;<span class="op" id="3336014">*</span><span class="ident" id="3336015">lazybuf</span><span class="op" id="3336022">)</span>&nbsp;<span class="builtinfunc" id="3336024">append</span><span class="op" id="3336030">(</span><span class="ident" id="3336031">c</span>&nbsp;<span class="builtintype" id="3336033">byte</span><span class="op" id="3336037">)</span>&nbsp;<span class="op" id="3336039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3336042">if</span>&nbsp;<span class="ident" id="3336045">b</span><span class="op" id="3336046">.</span><span class="ident" id="3336047">buf</span>&nbsp;<span class="op" id="3336051">==</span>&nbsp;<span class="builtintype" id="3336054">nil</span>&nbsp;<span class="op" id="3336058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3336062">if</span>&nbsp;<span class="ident" id="3336065">b</span><span class="op" id="3336066">.</span><span class="ident" id="3336067">w</span>&nbsp;<span class="op" id="3336069">&lt;</span>&nbsp;<span class="builtinfunc" id="3336071">len</span><span class="op" id="3336074">(</span><span class="ident" id="3336075">b</span><span class="op" id="3336076">.</span><span class="ident" id="3336077">path</span><span class="op" id="3336081">)</span>&nbsp;<span class="op" id="3336083">&amp;&amp;</span>&nbsp;<span class="ident" id="3336086">b</span><span class="op" id="3336087">.</span><span class="ident" id="3336088">path</span><span class="op" id="3336092">[</span><span class="ident" id="3336093">b</span><span class="op" id="3336094">.</span><span class="ident" id="3336095">w</span><span class="op" id="3336096">]</span>&nbsp;<span class="op" id="3336098">==</span>&nbsp;<span class="ident" id="3336101">c</span>&nbsp;<span class="op" id="3336103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3336108">b</span><span class="op" id="3336109">.</span><span class="ident" id="3336110">w</span><span class="op" id="3336111">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3336117">return</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3336126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3336130">b</span><span class="op" id="3336131">.</span><span class="ident" id="3336132">buf</span>&nbsp;<span class="op" id="3336136">=</span>&nbsp;<span class="builtinfunc" id="3336138">make</span><span class="op" id="3336142">(</span><span class="op" id="3336143">[</span><span class="op" id="3336144">]</span><span class="builtintype" id="3336145">byte</span><span class="op" id="3336149">,</span>&nbsp;<span class="builtinfunc" id="3336151">len</span><span class="op" id="3336154">(</span><span class="ident" id="3336155">b</span><span class="op" id="3336156">.</span><span class="ident" id="3336157">path</span><span class="op" id="3336161">)</span><span class="op" id="3336162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3336166">copy</span><span class="op" id="3336170">(</span><span class="ident" id="3336171">b</span><span class="op" id="3336172">.</span><span class="ident" id="3336173">buf</span><span class="op" id="3336176">,</span>&nbsp;<span class="ident" id="3336178">b</span><span class="op" id="3336179">.</span><span class="ident" id="3336180">path</span><span class="op" id="3336184">[</span><span class="op" id="3336185">:</span><span class="ident" id="3336186">b</span><span class="op" id="3336187">.</span><span class="ident" id="3336188">w</span><span class="op" id="3336189">]</span><span class="op" id="3336190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3336193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3336196">b</span><span class="op" id="3336197">.</span><span class="ident" id="3336198">buf</span><span class="op" id="3336201">[</span><span class="ident" id="3336202">b</span><span class="op" id="3336203">.</span><span class="ident" id="3336204">w</span><span class="op" id="3336205">]</span>&nbsp;<span class="op" id="3336207">=</span>&nbsp;<span class="ident" id="3336209">c</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3336212">b</span><span class="op" id="3336213">.</span><span class="ident" id="3336214">w</span><span class="op" id="3336215">++</span><br>
<span class="lineno"></span><span class="op" id="3336218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3336221">func</span>&nbsp;<span class="op" id="3336226">(</span><span class="ident" id="3336227">b</span>&nbsp;<span class="op" id="3336229">*</span><span class="ident" id="3336230">lazybuf</span><span class="op" id="3336237">)</span>&nbsp;<span class="builtintype" id="3336239">string</span><span class="op" id="3336245">(</span><span class="op" id="3336246">)</span>&nbsp;<span class="builtintype" id="3336248">string</span>&nbsp;<span class="op" id="3336255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3336258">if</span>&nbsp;<span class="ident" id="3336261">b</span><span class="op" id="3336262">.</span><span class="ident" id="3336263">buf</span>&nbsp;<span class="op" id="3336267">==</span>&nbsp;<span class="builtintype" id="3336270">nil</span>&nbsp;<span class="op" id="3336274">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3336278">return</span>&nbsp;<span class="ident" id="3336285">b</span><span class="op" id="3336286">.</span><span class="ident" id="3336287">volAndPath</span><span class="op" id="3336297">[</span><span class="op" id="3336298">:</span><span class="ident" id="3336299">b</span><span class="op" id="3336300">.</span><span class="ident" id="3336301">volLen</span><span class="op" id="3336307">+</span><span class="ident" id="3336308">b</span><span class="op" id="3336309">.</span><span class="ident" id="3336310">w</span><span class="op" id="3336311">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3336314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3336317">return</span>&nbsp;<span class="ident" id="3336324">b</span><span class="op" id="3336325">.</span><span class="ident" id="3336326">volAndPath</span><span class="op" id="3336336">[</span><span class="op" id="3336337">:</span><span class="ident" id="3336338">b</span><span class="op" id="3336339">.</span><span class="ident" id="3336340">volLen</span><span class="op" id="3336346">]</span>&nbsp;<span class="op" id="3336348">+</span>&nbsp;<span class="builtintype" id="3336350">string</span><span class="op" id="3336356">(</span><span class="ident" id="3336357">b</span><span class="op" id="3336358">.</span><span class="ident" id="3336359">buf</span><span class="op" id="3336362">[</span><span class="op" id="3336363">:</span><span class="ident" id="3336364">b</span><span class="op" id="3336365">.</span><span class="ident" id="3336366">w</span><span class="op" id="3336367">]</span><span class="op" id="3336368">)</span><br>
<span class="lineno"></span><span class="op" id="3336370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3336373">const</span>&nbsp;<span class="op" id="3336379">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3336382">Separator</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3336396">=</span>&nbsp;<span class="ident" id="3336398">os</span><span class="op" id="3336400">.</span><span class="ident" id="3336401">PathSeparator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3336416">ListSeparator</span>&nbsp;<span class="op" id="3336430">=</span>&nbsp;<span class="ident" id="3336432">os</span><span class="op" id="3336434">.</span><span class="ident" id="3336435">PathListSeparator</span><br>
<span class="lineno"></span><span class="op" id="3336453">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3336456">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3336515">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3336580">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="3336636">//</span><br>
<span class="lineno"></span><span class="comment" id="3336639">//&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Replace&nbsp;multiple&nbsp;Separator&nbsp;elements&nbsp;with&nbsp;a&nbsp;single&nbsp;one.</span><br>
<span class="lineno">65</span><span class="comment" id="3336700">//&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="3336766">//&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="3336837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3336891">//&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="3336945">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path,</span><br>
<span class="lineno">70</span><span class="comment" id="3337009">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assuming&nbsp;Separator&nbsp;is&nbsp;&#39;/&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="3337042">//</span><br>
<span class="lineno"></span><span class="comment" id="3337045">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;represents&nbsp;a&nbsp;root&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="3337122">//&nbsp;such&nbsp;as&nbsp;&#34;/&#34;&nbsp;on&nbsp;Unix&nbsp;or&nbsp;`C:\`&nbsp;on&nbsp;Windows.</span><br>
<span class="lineno"></span><span class="comment" id="3337166">//</span><br>
<span class="lineno">75</span><span class="comment" id="3337169">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="3337228">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3337255">//</span><br>
<span class="lineno"></span><span class="comment" id="3337258">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3337314">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno">80</span><span class="comment" id="3337342">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="3337394">func</span>&nbsp;<span class="ident" id="3337399">Clean</span><span class="op" id="3337404">(</span><span class="ident" id="3337405">path</span>&nbsp;<span class="builtintype" id="3337410">string</span><span class="op" id="3337416">)</span>&nbsp;<span class="builtintype" id="3337418">string</span>&nbsp;<span class="op" id="3337425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3337428">originalPath</span>&nbsp;<span class="op" id="3337441">:=</span>&nbsp;<span class="ident" id="3337444">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3337450">volLen</span>&nbsp;<span class="op" id="3337457">:=</span>&nbsp;<span class="ident" id="3337460">volumeNameLen</span><span class="op" id="3337473">(</span><span class="ident" id="3337474">path</span><span class="op" id="3337478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3337481">path</span>&nbsp;<span class="op" id="3337486">=</span>&nbsp;<span class="ident" id="3337488">path</span><span class="op" id="3337492">[</span><span class="ident" id="3337493">volLen</span><span class="op" id="3337499">:</span><span class="op" id="3337500">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3337503">if</span>&nbsp;<span class="ident" id="3337506">path</span>&nbsp;<span class="op" id="3337511">==</span>&nbsp;<span class="string" id="3337514">&#34;&#34;</span>&nbsp;<span class="op" id="3337517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3337521">if</span>&nbsp;<span class="ident" id="3337524">volLen</span>&nbsp;<span class="op" id="3337531">&gt;</span>&nbsp;<span class="num" id="3337533">1</span>&nbsp;<span class="op" id="3337535">&amp;&amp;</span>&nbsp;<span class="ident" id="3337538">originalPath</span><span class="op" id="3337550">[</span><span class="num" id="3337551">1</span><span class="op" id="3337552">]</span>&nbsp;<span class="op" id="3337554">!=</span>&nbsp;<span class="string" id="3337557">&#39;:&#39;</span>&nbsp;<span class="op" id="3337561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3337566">//&nbsp;should&nbsp;be&nbsp;UNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3337586">return</span>&nbsp;<span class="ident" id="3337593">FromSlash</span><span class="op" id="3337602">(</span><span class="ident" id="3337603">originalPath</span><span class="op" id="3337615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3337619">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3337623">return</span>&nbsp;<span class="ident" id="3337630">originalPath</span>&nbsp;<span class="op" id="3337643">+</span>&nbsp;<span class="string" id="3337645">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3337650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3337653">rooted</span>&nbsp;<span class="op" id="3337660">:=</span>&nbsp;<span class="ident" id="3337663">os</span><span class="op" id="3337665">.</span><span class="ident" id="3337666">IsPathSeparator</span><span class="op" id="3337681">(</span><span class="ident" id="3337682">path</span><span class="op" id="3337686">[</span><span class="num" id="3337687">0</span><span class="op" id="3337688">]</span><span class="op" id="3337689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3337693">//&nbsp;Invariants:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3337709">//&nbsp;&nbsp;&nbsp;&nbsp;reading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3337768">//&nbsp;&nbsp;&nbsp;&nbsp;writing&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3337822">//&nbsp;&nbsp;&nbsp;&nbsp;dotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3337884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3337949">n</span>&nbsp;<span class="op" id="3337951">:=</span>&nbsp;<span class="builtinfunc" id="3337954">len</span><span class="op" id="3337957">(</span><span class="ident" id="3337958">path</span><span class="op" id="3337962">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3337965">out</span>&nbsp;<span class="op" id="3337969">:=</span>&nbsp;<span class="ident" id="3337972">lazybuf</span><span class="op" id="3337979">{</span><span class="ident" id="3337980">path</span><span class="op" id="3337984">:</span>&nbsp;<span class="ident" id="3337986">path</span><span class="op" id="3337990">,</span>&nbsp;<span class="ident" id="3337992">volAndPath</span><span class="op" id="3338002">:</span>&nbsp;<span class="ident" id="3338004">originalPath</span><span class="op" id="3338016">,</span>&nbsp;<span class="ident" id="3338018">volLen</span><span class="op" id="3338024">:</span>&nbsp;<span class="ident" id="3338026">volLen</span><span class="op" id="3338032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338035">r</span><span class="op" id="3338036">,</span>&nbsp;<span class="ident" id="3338038">dotdot</span>&nbsp;<span class="op" id="3338045">:=</span>&nbsp;<span class="num" id="3338048">0</span><span class="op" id="3338049">,</span>&nbsp;<span class="num" id="3338051">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338054">if</span>&nbsp;<span class="ident" id="3338057">rooted</span>&nbsp;<span class="op" id="3338064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338068">out</span><span class="op" id="3338071">.</span><span class="builtinfunc" id="3338072">append</span><span class="op" id="3338078">(</span><span class="ident" id="3338079">Separator</span><span class="op" id="3338088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338092">r</span><span class="op" id="3338093">,</span>&nbsp;<span class="ident" id="3338095">dotdot</span>&nbsp;<span class="op" id="3338102">=</span>&nbsp;<span class="num" id="3338104">1</span><span class="op" id="3338105">,</span>&nbsp;<span class="num" id="3338107">1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3338110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338114">for</span>&nbsp;<span class="ident" id="3338118">r</span>&nbsp;<span class="op" id="3338120">&lt;</span>&nbsp;<span class="ident" id="3338122">n</span>&nbsp;<span class="op" id="3338124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338128">switch</span>&nbsp;<span class="op" id="3338135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338139">case</span>&nbsp;<span class="ident" id="3338144">os</span><span class="op" id="3338146">.</span><span class="ident" id="3338147">IsPathSeparator</span><span class="op" id="3338162">(</span><span class="ident" id="3338163">path</span><span class="op" id="3338167">[</span><span class="ident" id="3338168">r</span><span class="op" id="3338169">]</span><span class="op" id="3338170">)</span><span class="op" id="3338171">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338176">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338201">r</span><span class="op" id="3338202">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338207">case</span>&nbsp;<span class="ident" id="3338212">path</span><span class="op" id="3338216">[</span><span class="ident" id="3338217">r</span><span class="op" id="3338218">]</span>&nbsp;<span class="op" id="3338220">==</span>&nbsp;<span class="string" id="3338223">&#39;.&#39;</span>&nbsp;<span class="op" id="3338227">&amp;&amp;</span>&nbsp;<span class="op" id="3338230">(</span><span class="ident" id="3338231">r</span><span class="op" id="3338232">+</span><span class="num" id="3338233">1</span>&nbsp;<span class="op" id="3338235">==</span>&nbsp;<span class="ident" id="3338238">n</span>&nbsp;<span class="op" id="3338240">||</span>&nbsp;<span class="ident" id="3338243">os</span><span class="op" id="3338245">.</span><span class="ident" id="3338246">IsPathSeparator</span><span class="op" id="3338261">(</span><span class="ident" id="3338262">path</span><span class="op" id="3338266">[</span><span class="ident" id="3338267">r</span><span class="op" id="3338268">+</span><span class="num" id="3338269">1</span><span class="op" id="3338270">]</span><span class="op" id="3338271">)</span><span class="op" id="3338272">)</span><span class="op" id="3338273">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338278">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338294">r</span><span class="op" id="3338295">++</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338300">case</span>&nbsp;<span class="ident" id="3338305">path</span><span class="op" id="3338309">[</span><span class="ident" id="3338310">r</span><span class="op" id="3338311">]</span>&nbsp;<span class="op" id="3338313">==</span>&nbsp;<span class="string" id="3338316">&#39;.&#39;</span>&nbsp;<span class="op" id="3338320">&amp;&amp;</span>&nbsp;<span class="ident" id="3338323">path</span><span class="op" id="3338327">[</span><span class="ident" id="3338328">r</span><span class="op" id="3338329">+</span><span class="num" id="3338330">1</span><span class="op" id="3338331">]</span>&nbsp;<span class="op" id="3338333">==</span>&nbsp;<span class="string" id="3338336">&#39;.&#39;</span>&nbsp;<span class="op" id="3338340">&amp;&amp;</span>&nbsp;<span class="op" id="3338343">(</span><span class="ident" id="3338344">r</span><span class="op" id="3338345">+</span><span class="num" id="3338346">2</span>&nbsp;<span class="op" id="3338348">==</span>&nbsp;<span class="ident" id="3338351">n</span>&nbsp;<span class="op" id="3338353">||</span>&nbsp;<span class="ident" id="3338356">os</span><span class="op" id="3338358">.</span><span class="ident" id="3338359">IsPathSeparator</span><span class="op" id="3338374">(</span><span class="ident" id="3338375">path</span><span class="op" id="3338379">[</span><span class="ident" id="3338380">r</span><span class="op" id="3338381">+</span><span class="num" id="3338382">2</span><span class="op" id="3338383">]</span><span class="op" id="3338384">)</span><span class="op" id="3338385">)</span><span class="op" id="3338386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338391">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338434">r</span>&nbsp;<span class="op" id="3338436">+=</span>&nbsp;<span class="num" id="3338439">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338444">switch</span>&nbsp;<span class="op" id="3338451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338456">case</span>&nbsp;<span class="ident" id="3338461">out</span><span class="op" id="3338464">.</span><span class="ident" id="3338465">w</span>&nbsp;<span class="op" id="3338467">&gt;</span>&nbsp;<span class="ident" id="3338469">dotdot</span><span class="op" id="3338475">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338481">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338502">out</span><span class="op" id="3338505">.</span><span class="ident" id="3338506">w</span><span class="op" id="3338507">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338514">for</span>&nbsp;<span class="ident" id="3338518">out</span><span class="op" id="3338521">.</span><span class="ident" id="3338522">w</span>&nbsp;<span class="op" id="3338524">&gt;</span>&nbsp;<span class="ident" id="3338526">dotdot</span>&nbsp;<span class="op" id="3338533">&amp;&amp;</span>&nbsp;<span class="op" id="3338536">!</span><span class="ident" id="3338537">os</span><span class="op" id="3338539">.</span><span class="ident" id="3338540">IsPathSeparator</span><span class="op" id="3338555">(</span><span class="ident" id="3338556">out</span><span class="op" id="3338559">.</span><span class="ident" id="3338560">index</span><span class="op" id="3338565">(</span><span class="ident" id="3338566">out</span><span class="op" id="3338569">.</span><span class="ident" id="3338570">w</span><span class="op" id="3338571">)</span><span class="op" id="3338572">)</span>&nbsp;<span class="op" id="3338574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338581">out</span><span class="op" id="3338584">.</span><span class="ident" id="3338585">w</span><span class="op" id="3338586">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3338593">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338598">case</span>&nbsp;<span class="op" id="3338603">!</span><span class="ident" id="3338604">rooted</span><span class="op" id="3338610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338616">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338679">if</span>&nbsp;<span class="ident" id="3338682">out</span><span class="op" id="3338685">.</span><span class="ident" id="3338686">w</span>&nbsp;<span class="op" id="3338688">&gt;</span>&nbsp;<span class="num" id="3338690">0</span>&nbsp;<span class="op" id="3338692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338699">out</span><span class="op" id="3338702">.</span><span class="builtinfunc" id="3338703">append</span><span class="op" id="3338709">(</span><span class="ident" id="3338710">Separator</span><span class="op" id="3338719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3338725">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338731">out</span><span class="op" id="3338734">.</span><span class="builtinfunc" id="3338735">append</span><span class="op" id="3338741">(</span><span class="string" id="3338742">&#39;.&#39;</span><span class="op" id="3338745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338751">out</span><span class="op" id="3338754">.</span><span class="builtinfunc" id="3338755">append</span><span class="op" id="3338761">(</span><span class="string" id="3338762">&#39;.&#39;</span><span class="op" id="3338765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338771">dotdot</span>&nbsp;<span class="op" id="3338778">=</span>&nbsp;<span class="ident" id="3338780">out</span><span class="op" id="3338783">.</span><span class="ident" id="3338784">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3338789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338793">default</span><span class="op" id="3338800">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338805">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338830">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338856">if</span>&nbsp;<span class="ident" id="3338859">rooted</span>&nbsp;<span class="op" id="3338866">&amp;&amp;</span>&nbsp;<span class="ident" id="3338869">out</span><span class="op" id="3338872">.</span><span class="ident" id="3338873">w</span>&nbsp;<span class="op" id="3338875">!=</span>&nbsp;<span class="num" id="3338878">1</span>&nbsp;<span class="op" id="3338880">||</span>&nbsp;<span class="op" id="3338883">!</span><span class="ident" id="3338884">rooted</span>&nbsp;<span class="op" id="3338891">&amp;&amp;</span>&nbsp;<span class="ident" id="3338894">out</span><span class="op" id="3338897">.</span><span class="ident" id="3338898">w</span>&nbsp;<span class="op" id="3338900">!=</span>&nbsp;<span class="num" id="3338903">0</span>&nbsp;<span class="op" id="3338905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3338911">out</span><span class="op" id="3338914">.</span><span class="builtinfunc" id="3338915">append</span><span class="op" id="3338921">(</span><span class="ident" id="3338922">Separator</span><span class="op" id="3338931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3338936">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3338941">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3338960">for</span>&nbsp;<span class="op" id="3338964">;</span>&nbsp;<span class="ident" id="3338966">r</span>&nbsp;<span class="op" id="3338968">&lt;</span>&nbsp;<span class="ident" id="3338970">n</span>&nbsp;<span class="op" id="3338972">&amp;&amp;</span>&nbsp;<span class="op" id="3338975">!</span><span class="ident" id="3338976">os</span><span class="op" id="3338978">.</span><span class="ident" id="3338979">IsPathSeparator</span><span class="op" id="3338994">(</span><span class="ident" id="3338995">path</span><span class="op" id="3338999">[</span><span class="ident" id="3339000">r</span><span class="op" id="3339001">]</span><span class="op" id="3339002">)</span><span class="op" id="3339003">;</span>&nbsp;<span class="ident" id="3339005">r</span><span class="op" id="3339006">++</span>&nbsp;<span class="op" id="3339009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3339015">out</span><span class="op" id="3339018">.</span><span class="builtinfunc" id="3339019">append</span><span class="op" id="3339025">(</span><span class="ident" id="3339026">path</span><span class="op" id="3339030">[</span><span class="ident" id="3339031">r</span><span class="op" id="3339032">]</span><span class="op" id="3339033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3339038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3339042">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3339045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3339049">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339080">if</span>&nbsp;<span class="ident" id="3339083">out</span><span class="op" id="3339086">.</span><span class="ident" id="3339087">w</span>&nbsp;<span class="op" id="3339089">==</span>&nbsp;<span class="num" id="3339092">0</span>&nbsp;<span class="op" id="3339094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3339098">out</span><span class="op" id="3339101">.</span><span class="builtinfunc" id="3339102">append</span><span class="op" id="3339108">(</span><span class="string" id="3339109">&#39;.&#39;</span><span class="op" id="3339112">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3339115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339119">return</span>&nbsp;<span class="ident" id="3339126">FromSlash</span><span class="op" id="3339135">(</span><span class="ident" id="3339136">out</span><span class="op" id="3339139">.</span><span class="builtintype" id="3339140">string</span><span class="op" id="3339146">(</span><span class="op" id="3339147">)</span><span class="op" id="3339148">)</span><br>
<span class="lineno"></span><span class="op" id="3339150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3339153">//&nbsp;ToSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;separator&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3339221">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character.&nbsp;Multiple&nbsp;separators&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3339286">//&nbsp;replaced&nbsp;by&nbsp;multiple&nbsp;slashes.</span><br>
<span class="lineno"></span><span class="keyword" id="3339319">func</span>&nbsp;<span class="ident" id="3339324">ToSlash</span><span class="op" id="3339331">(</span><span class="ident" id="3339332">path</span>&nbsp;<span class="builtintype" id="3339337">string</span><span class="op" id="3339343">)</span>&nbsp;<span class="builtintype" id="3339345">string</span>&nbsp;<span class="op" id="3339352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339355">if</span>&nbsp;<span class="ident" id="3339358">Separator</span>&nbsp;<span class="op" id="3339368">==</span>&nbsp;<span class="string" id="3339371">&#39;/&#39;</span>&nbsp;<span class="op" id="3339375">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339379">return</span>&nbsp;<span class="ident" id="3339386">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3339392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339395">return</span>&nbsp;<span class="ident" id="3339402">strings</span><span class="op" id="3339409">.</span><span class="ident" id="3339410">Replace</span><span class="op" id="3339417">(</span><span class="ident" id="3339418">path</span><span class="op" id="3339422">,</span>&nbsp;<span class="builtintype" id="3339424">string</span><span class="op" id="3339430">(</span><span class="ident" id="3339431">Separator</span><span class="op" id="3339440">)</span><span class="op" id="3339441">,</span>&nbsp;<span class="string" id="3339443">&#34;/&#34;</span><span class="op" id="3339446">,</span>&nbsp;<span class="op" id="3339448">-</span><span class="num" id="3339449">1</span><span class="op" id="3339450">)</span><br>
<span class="lineno"></span><span class="op" id="3339452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3339455">//&nbsp;FromSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3339527">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;separator&nbsp;character.&nbsp;Multiple&nbsp;slashes&nbsp;are&nbsp;replaced</span><br>
<span class="lineno"></span><span class="comment" id="3339596">//&nbsp;by&nbsp;multiple&nbsp;separators.</span><br>
<span class="lineno"></span><span class="keyword" id="3339623">func</span>&nbsp;<span class="ident" id="3339628">FromSlash</span><span class="op" id="3339637">(</span><span class="ident" id="3339638">path</span>&nbsp;<span class="builtintype" id="3339643">string</span><span class="op" id="3339649">)</span>&nbsp;<span class="builtintype" id="3339651">string</span>&nbsp;<span class="op" id="3339658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339661">if</span>&nbsp;<span class="ident" id="3339664">Separator</span>&nbsp;<span class="op" id="3339674">==</span>&nbsp;<span class="string" id="3339677">&#39;/&#39;</span>&nbsp;<span class="op" id="3339681">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339685">return</span>&nbsp;<span class="ident" id="3339692">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3339698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3339701">return</span>&nbsp;<span class="ident" id="3339708">strings</span><span class="op" id="3339715">.</span><span class="ident" id="3339716">Replace</span><span class="op" id="3339723">(</span><span class="ident" id="3339724">path</span><span class="op" id="3339728">,</span>&nbsp;<span class="string" id="3339730">&#34;/&#34;</span><span class="op" id="3339733">,</span>&nbsp;<span class="builtintype" id="3339735">string</span><span class="op" id="3339741">(</span><span class="ident" id="3339742">Separator</span><span class="op" id="3339751">)</span><span class="op" id="3339752">,</span>&nbsp;<span class="op" id="3339754">-</span><span class="num" id="3339755">1</span><span class="op" id="3339756">)</span><br>
<span class="lineno"></span><span class="op" id="3339758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3339761">//&nbsp;SplitList&nbsp;splits&nbsp;a&nbsp;list&nbsp;of&nbsp;paths&nbsp;joined&nbsp;by&nbsp;the&nbsp;OS-specific&nbsp;ListSeparator,</span><br>
<span class="lineno"></span><span class="comment" id="3339838">//&nbsp;usually&nbsp;found&nbsp;in&nbsp;PATH&nbsp;or&nbsp;GOPATH&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><span class="comment" id="3339896">//&nbsp;Unlike&nbsp;strings.Split,&nbsp;SplitList&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;when&nbsp;passed&nbsp;an&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3339983">func</span>&nbsp;<span class="ident" id="3339988">SplitList</span><span class="op" id="3339997">(</span><span class="ident" id="3339998">path</span>&nbsp;<span class="builtintype" id="3340003">string</span><span class="op" id="3340009">)</span>&nbsp;<span class="op" id="3340011">[</span><span class="op" id="3340012">]</span><span class="builtintype" id="3340013">string</span>&nbsp;<span class="op" id="3340020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340023">return</span>&nbsp;<span class="ident" id="3340030">splitList</span><span class="op" id="3340039">(</span><span class="ident" id="3340040">path</span><span class="op" id="3340044">)</span><br>
<span class="lineno">180</span><span class="op" id="3340046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3340049">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;Separator,</span><br>
<span class="lineno"></span><span class="comment" id="3340113">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="3340172">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;Separator&nbsp;in&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir</span><br>
<span class="lineno">185</span><span class="comment" id="3340236">//&nbsp;and&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3340261">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="3340324">func</span>&nbsp;<span class="ident" id="3340329">Split</span><span class="op" id="3340334">(</span><span class="ident" id="3340335">path</span>&nbsp;<span class="builtintype" id="3340340">string</span><span class="op" id="3340346">)</span>&nbsp;<span class="op" id="3340348">(</span><span class="ident" id="3340349">dir</span><span class="op" id="3340352">,</span>&nbsp;<span class="ident" id="3340354">file</span>&nbsp;<span class="builtintype" id="3340359">string</span><span class="op" id="3340365">)</span>&nbsp;<span class="op" id="3340367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3340370">vol</span>&nbsp;<span class="op" id="3340374">:=</span>&nbsp;<span class="ident" id="3340377">VolumeName</span><span class="op" id="3340387">(</span><span class="ident" id="3340388">path</span><span class="op" id="3340392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3340395">i</span>&nbsp;<span class="op" id="3340397">:=</span>&nbsp;<span class="builtinfunc" id="3340400">len</span><span class="op" id="3340403">(</span><span class="ident" id="3340404">path</span><span class="op" id="3340408">)</span>&nbsp;<span class="op" id="3340410">-</span>&nbsp;<span class="num" id="3340412">1</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340415">for</span>&nbsp;<span class="ident" id="3340419">i</span>&nbsp;<span class="op" id="3340421">&gt;=</span>&nbsp;<span class="builtinfunc" id="3340424">len</span><span class="op" id="3340427">(</span><span class="ident" id="3340428">vol</span><span class="op" id="3340431">)</span>&nbsp;<span class="op" id="3340433">&amp;&amp;</span>&nbsp;<span class="op" id="3340436">!</span><span class="ident" id="3340437">os</span><span class="op" id="3340439">.</span><span class="ident" id="3340440">IsPathSeparator</span><span class="op" id="3340455">(</span><span class="ident" id="3340456">path</span><span class="op" id="3340460">[</span><span class="ident" id="3340461">i</span><span class="op" id="3340462">]</span><span class="op" id="3340463">)</span>&nbsp;<span class="op" id="3340465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3340469">i</span><span class="op" id="3340470">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3340474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340477">return</span>&nbsp;<span class="ident" id="3340484">path</span><span class="op" id="3340488">[</span><span class="op" id="3340489">:</span><span class="ident" id="3340490">i</span><span class="op" id="3340491">+</span><span class="num" id="3340492">1</span><span class="op" id="3340493">]</span><span class="op" id="3340494">,</span>&nbsp;<span class="ident" id="3340496">path</span><span class="op" id="3340500">[</span><span class="ident" id="3340501">i</span><span class="op" id="3340502">+</span><span class="num" id="3340503">1</span><span class="op" id="3340504">:</span><span class="op" id="3340505">]</span><br>
<span class="lineno"></span><span class="op" id="3340507">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="3340510">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding</span><br>
<span class="lineno"></span><span class="comment" id="3340579">//&nbsp;a&nbsp;Separator&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned,&nbsp;in&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="3340645">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="3340679">func</span>&nbsp;<span class="ident" id="3340684">Join</span><span class="op" id="3340688">(</span><span class="ident" id="3340689">elem</span>&nbsp;<span class="op" id="3340694">...</span><span class="builtintype" id="3340697">string</span><span class="op" id="3340703">)</span>&nbsp;<span class="builtintype" id="3340705">string</span>&nbsp;<span class="op" id="3340712">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340715">for</span>&nbsp;<span class="ident" id="3340719">i</span><span class="op" id="3340720">,</span>&nbsp;<span class="ident" id="3340722">e</span>&nbsp;<span class="op" id="3340724">:=</span>&nbsp;<span class="keyword" id="3340727">range</span>&nbsp;<span class="ident" id="3340733">elem</span>&nbsp;<span class="op" id="3340738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340742">if</span>&nbsp;<span class="ident" id="3340745">e</span>&nbsp;<span class="op" id="3340747">!=</span>&nbsp;<span class="string" id="3340750">&#34;&#34;</span>&nbsp;<span class="op" id="3340753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340758">return</span>&nbsp;<span class="ident" id="3340765">Clean</span><span class="op" id="3340770">(</span><span class="ident" id="3340771">strings</span><span class="op" id="3340778">.</span><span class="ident" id="3340779">Join</span><span class="op" id="3340783">(</span><span class="ident" id="3340784">elem</span><span class="op" id="3340788">[</span><span class="ident" id="3340789">i</span><span class="op" id="3340790">:</span><span class="op" id="3340791">]</span><span class="op" id="3340792">,</span>&nbsp;<span class="builtintype" id="3340794">string</span><span class="op" id="3340800">(</span><span class="ident" id="3340801">Separator</span><span class="op" id="3340810">)</span><span class="op" id="3340811">)</span><span class="op" id="3340812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3340816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3340819">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3340822">return</span>&nbsp;<span class="string" id="3340829">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3340832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3340835">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3340888">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno">210</span><span class="comment" id="3340946">//&nbsp;in&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;path;&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3341003">//&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3341014">func</span>&nbsp;<span class="ident" id="3341019">Ext</span><span class="op" id="3341022">(</span><span class="ident" id="3341023">path</span>&nbsp;<span class="builtintype" id="3341028">string</span><span class="op" id="3341034">)</span>&nbsp;<span class="builtintype" id="3341036">string</span>&nbsp;<span class="op" id="3341043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341046">for</span>&nbsp;<span class="ident" id="3341050">i</span>&nbsp;<span class="op" id="3341052">:=</span>&nbsp;<span class="builtinfunc" id="3341055">len</span><span class="op" id="3341058">(</span><span class="ident" id="3341059">path</span><span class="op" id="3341063">)</span>&nbsp;<span class="op" id="3341065">-</span>&nbsp;<span class="num" id="3341067">1</span><span class="op" id="3341068">;</span>&nbsp;<span class="ident" id="3341070">i</span>&nbsp;<span class="op" id="3341072">&gt;=</span>&nbsp;<span class="num" id="3341075">0</span>&nbsp;<span class="op" id="3341077">&amp;&amp;</span>&nbsp;<span class="op" id="3341080">!</span><span class="ident" id="3341081">os</span><span class="op" id="3341083">.</span><span class="ident" id="3341084">IsPathSeparator</span><span class="op" id="3341099">(</span><span class="ident" id="3341100">path</span><span class="op" id="3341104">[</span><span class="ident" id="3341105">i</span><span class="op" id="3341106">]</span><span class="op" id="3341107">)</span><span class="op" id="3341108">;</span>&nbsp;<span class="ident" id="3341110">i</span><span class="op" id="3341111">--</span>&nbsp;<span class="op" id="3341114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341118">if</span>&nbsp;<span class="ident" id="3341121">path</span><span class="op" id="3341125">[</span><span class="ident" id="3341126">i</span><span class="op" id="3341127">]</span>&nbsp;<span class="op" id="3341129">==</span>&nbsp;<span class="string" id="3341132">&#39;.&#39;</span>&nbsp;<span class="op" id="3341136">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341141">return</span>&nbsp;<span class="ident" id="3341148">path</span><span class="op" id="3341152">[</span><span class="ident" id="3341153">i</span><span class="op" id="3341154">:</span><span class="op" id="3341155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3341159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3341162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341165">return</span>&nbsp;<span class="string" id="3341172">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3341175">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="3341178">//&nbsp;EvalSymlinks&nbsp;returns&nbsp;the&nbsp;path&nbsp;name&nbsp;after&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;any&nbsp;symbolic</span><br>
<span class="lineno"></span><span class="comment" id="3341253">//&nbsp;links.</span><br>
<span class="lineno"></span><span class="comment" id="3341263">//&nbsp;If&nbsp;path&nbsp;is&nbsp;relative&nbsp;the&nbsp;result&nbsp;will&nbsp;be&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="3341340">//&nbsp;unless&nbsp;one&nbsp;of&nbsp;the&nbsp;components&nbsp;is&nbsp;an&nbsp;absolute&nbsp;symbolic&nbsp;link.</span><br>
<span class="lineno">225</span><span class="keyword" id="3341402">func</span>&nbsp;<span class="ident" id="3341407">EvalSymlinks</span><span class="op" id="3341419">(</span><span class="ident" id="3341420">path</span>&nbsp;<span class="builtintype" id="3341425">string</span><span class="op" id="3341431">)</span>&nbsp;<span class="op" id="3341433">(</span><span class="builtintype" id="3341434">string</span><span class="op" id="3341440">,</span>&nbsp;<span class="builtintype" id="3341442">error</span><span class="op" id="3341447">)</span>&nbsp;<span class="op" id="3341449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341452">return</span>&nbsp;<span class="ident" id="3341459">evalSymlinks</span><span class="op" id="3341471">(</span><span class="ident" id="3341472">path</span><span class="op" id="3341476">)</span><br>
<span class="lineno"></span><span class="op" id="3341478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3341481">//&nbsp;Abs&nbsp;returns&nbsp;an&nbsp;absolute&nbsp;representation&nbsp;of&nbsp;path.</span><br>
<span class="lineno">230</span><span class="comment" id="3341532">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;not&nbsp;absolute&nbsp;it&nbsp;will&nbsp;be&nbsp;joined&nbsp;with&nbsp;the&nbsp;current</span><br>
<span class="lineno"></span><span class="comment" id="3341598">//&nbsp;working&nbsp;directory&nbsp;to&nbsp;turn&nbsp;it&nbsp;into&nbsp;an&nbsp;absolute&nbsp;path.&nbsp;&nbsp;The&nbsp;absolute</span><br>
<span class="lineno"></span><span class="comment" id="3341667">//&nbsp;path&nbsp;name&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique.</span><br>
<span class="lineno"></span><span class="keyword" id="3341729">func</span>&nbsp;<span class="ident" id="3341734">Abs</span><span class="op" id="3341737">(</span><span class="ident" id="3341738">path</span>&nbsp;<span class="builtintype" id="3341743">string</span><span class="op" id="3341749">)</span>&nbsp;<span class="op" id="3341751">(</span><span class="builtintype" id="3341752">string</span><span class="op" id="3341758">,</span>&nbsp;<span class="builtintype" id="3341760">error</span><span class="op" id="3341765">)</span>&nbsp;<span class="op" id="3341767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341770">return</span>&nbsp;<span class="ident" id="3341777">abs</span><span class="op" id="3341780">(</span><span class="ident" id="3341781">path</span><span class="op" id="3341785">)</span><br>
<span class="lineno">235</span><span class="op" id="3341787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3341790">func</span>&nbsp;<span class="ident" id="3341795">unixAbs</span><span class="op" id="3341802">(</span><span class="ident" id="3341803">path</span>&nbsp;<span class="builtintype" id="3341808">string</span><span class="op" id="3341814">)</span>&nbsp;<span class="op" id="3341816">(</span><span class="builtintype" id="3341817">string</span><span class="op" id="3341823">,</span>&nbsp;<span class="builtintype" id="3341825">error</span><span class="op" id="3341830">)</span>&nbsp;<span class="op" id="3341832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341835">if</span>&nbsp;<span class="ident" id="3341838">IsAbs</span><span class="op" id="3341843">(</span><span class="ident" id="3341844">path</span><span class="op" id="3341848">)</span>&nbsp;<span class="op" id="3341850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341854">return</span>&nbsp;<span class="ident" id="3341861">Clean</span><span class="op" id="3341866">(</span><span class="ident" id="3341867">path</span><span class="op" id="3341871">)</span><span class="op" id="3341872">,</span>&nbsp;<span class="builtintype" id="3341874">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3341879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3341882">wd</span><span class="op" id="3341884">,</span>&nbsp;<span class="ident" id="3341886">err</span>&nbsp;<span class="op" id="3341890">:=</span>&nbsp;<span class="ident" id="3341893">os</span><span class="op" id="3341895">.</span><span class="ident" id="3341896">Getwd</span><span class="op" id="3341901">(</span><span class="op" id="3341902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341905">if</span>&nbsp;<span class="ident" id="3341908">err</span>&nbsp;<span class="op" id="3341912">!=</span>&nbsp;<span class="builtintype" id="3341915">nil</span>&nbsp;<span class="op" id="3341919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341923">return</span>&nbsp;<span class="string" id="3341930">&#34;&#34;</span><span class="op" id="3341932">,</span>&nbsp;<span class="ident" id="3341934">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3341939">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3341942">return</span>&nbsp;<span class="ident" id="3341949">Join</span><span class="op" id="3341953">(</span><span class="ident" id="3341954">wd</span><span class="op" id="3341956">,</span>&nbsp;<span class="ident" id="3341958">path</span><span class="op" id="3341962">)</span><span class="op" id="3341963">,</span>&nbsp;<span class="builtintype" id="3341965">nil</span><br>
<span class="lineno"></span><span class="op" id="3341969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3341972">//&nbsp;Rel&nbsp;returns&nbsp;a&nbsp;relative&nbsp;path&nbsp;that&nbsp;is&nbsp;lexically&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3342049">//&nbsp;joined&nbsp;to&nbsp;basepath&nbsp;with&nbsp;an&nbsp;intervening&nbsp;separator.&nbsp;That&nbsp;is,</span><br>
<span class="lineno">250</span><span class="comment" id="3342111">//&nbsp;Join(basepath,&nbsp;Rel(basepath,&nbsp;targpath))&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;itself.</span><br>
<span class="lineno"></span><span class="comment" id="3342188">//&nbsp;On&nbsp;success,&nbsp;the&nbsp;returned&nbsp;path&nbsp;will&nbsp;always&nbsp;be&nbsp;relative&nbsp;to&nbsp;basepath,</span><br>
<span class="lineno"></span><span class="comment" id="3342258">//&nbsp;even&nbsp;if&nbsp;basepath&nbsp;and&nbsp;targpath&nbsp;share&nbsp;no&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="3342310">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;targpath&nbsp;can&#39;t&nbsp;be&nbsp;made&nbsp;relative&nbsp;to&nbsp;basepath&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3342387">//&nbsp;knowing&nbsp;the&nbsp;current&nbsp;working&nbsp;directory&nbsp;would&nbsp;be&nbsp;necessary&nbsp;to&nbsp;compute&nbsp;it.</span><br>
<span class="lineno">255</span><span class="keyword" id="3342462">func</span>&nbsp;<span class="ident" id="3342467">Rel</span><span class="op" id="3342470">(</span><span class="ident" id="3342471">basepath</span><span class="op" id="3342479">,</span>&nbsp;<span class="ident" id="3342481">targpath</span>&nbsp;<span class="builtintype" id="3342490">string</span><span class="op" id="3342496">)</span>&nbsp;<span class="op" id="3342498">(</span><span class="builtintype" id="3342499">string</span><span class="op" id="3342505">,</span>&nbsp;<span class="builtintype" id="3342507">error</span><span class="op" id="3342512">)</span>&nbsp;<span class="op" id="3342514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342517">baseVol</span>&nbsp;<span class="op" id="3342525">:=</span>&nbsp;<span class="ident" id="3342528">VolumeName</span><span class="op" id="3342538">(</span><span class="ident" id="3342539">basepath</span><span class="op" id="3342547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342550">targVol</span>&nbsp;<span class="op" id="3342558">:=</span>&nbsp;<span class="ident" id="3342561">VolumeName</span><span class="op" id="3342571">(</span><span class="ident" id="3342572">targpath</span><span class="op" id="3342580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342583">base</span>&nbsp;<span class="op" id="3342588">:=</span>&nbsp;<span class="ident" id="3342591">Clean</span><span class="op" id="3342596">(</span><span class="ident" id="3342597">basepath</span><span class="op" id="3342605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342608">targ</span>&nbsp;<span class="op" id="3342613">:=</span>&nbsp;<span class="ident" id="3342616">Clean</span><span class="op" id="3342621">(</span><span class="ident" id="3342622">targpath</span><span class="op" id="3342630">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3342633">if</span>&nbsp;<span class="ident" id="3342636">targ</span>&nbsp;<span class="op" id="3342641">==</span>&nbsp;<span class="ident" id="3342644">base</span>&nbsp;<span class="op" id="3342649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3342653">return</span>&nbsp;<span class="string" id="3342660">&#34;.&#34;</span><span class="op" id="3342663">,</span>&nbsp;<span class="builtintype" id="3342665">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3342670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342673">base</span>&nbsp;<span class="op" id="3342678">=</span>&nbsp;<span class="ident" id="3342680">base</span><span class="op" id="3342684">[</span><span class="builtinfunc" id="3342685">len</span><span class="op" id="3342688">(</span><span class="ident" id="3342689">baseVol</span><span class="op" id="3342696">)</span><span class="op" id="3342697">:</span><span class="op" id="3342698">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342701">targ</span>&nbsp;<span class="op" id="3342706">=</span>&nbsp;<span class="ident" id="3342708">targ</span><span class="op" id="3342712">[</span><span class="builtinfunc" id="3342713">len</span><span class="op" id="3342716">(</span><span class="ident" id="3342717">targVol</span><span class="op" id="3342724">)</span><span class="op" id="3342725">:</span><span class="op" id="3342726">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3342729">if</span>&nbsp;<span class="ident" id="3342732">base</span>&nbsp;<span class="op" id="3342737">==</span>&nbsp;<span class="string" id="3342740">&#34;.&#34;</span>&nbsp;<span class="op" id="3342744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342748">base</span>&nbsp;<span class="op" id="3342753">=</span>&nbsp;<span class="string" id="3342755">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3342759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3342762">//&nbsp;Can&#39;t&nbsp;use&nbsp;IsAbs&nbsp;-&nbsp;`\a`&nbsp;and&nbsp;`a`&nbsp;are&nbsp;both&nbsp;relative&nbsp;in&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342827">baseSlashed</span>&nbsp;<span class="op" id="3342839">:=</span>&nbsp;<span class="builtinfunc" id="3342842">len</span><span class="op" id="3342845">(</span><span class="ident" id="3342846">base</span><span class="op" id="3342850">)</span>&nbsp;<span class="op" id="3342852">&gt;</span>&nbsp;<span class="num" id="3342854">0</span>&nbsp;<span class="op" id="3342856">&amp;&amp;</span>&nbsp;<span class="ident" id="3342859">base</span><span class="op" id="3342863">[</span><span class="num" id="3342864">0</span><span class="op" id="3342865">]</span>&nbsp;<span class="op" id="3342867">==</span>&nbsp;<span class="ident" id="3342870">Separator</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3342881">targSlashed</span>&nbsp;<span class="op" id="3342893">:=</span>&nbsp;<span class="builtinfunc" id="3342896">len</span><span class="op" id="3342899">(</span><span class="ident" id="3342900">targ</span><span class="op" id="3342904">)</span>&nbsp;<span class="op" id="3342906">&gt;</span>&nbsp;<span class="num" id="3342908">0</span>&nbsp;<span class="op" id="3342910">&amp;&amp;</span>&nbsp;<span class="ident" id="3342913">targ</span><span class="op" id="3342917">[</span><span class="num" id="3342918">0</span><span class="op" id="3342919">]</span>&nbsp;<span class="op" id="3342921">==</span>&nbsp;<span class="ident" id="3342924">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3342935">if</span>&nbsp;<span class="ident" id="3342938">baseSlashed</span>&nbsp;<span class="op" id="3342950">!=</span>&nbsp;<span class="ident" id="3342953">targSlashed</span>&nbsp;<span class="op" id="3342965">||</span>&nbsp;<span class="ident" id="3342968">baseVol</span>&nbsp;<span class="op" id="3342976">!=</span>&nbsp;<span class="ident" id="3342979">targVol</span>&nbsp;<span class="op" id="3342987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3342991">return</span>&nbsp;<span class="string" id="3342998">&#34;&#34;</span><span class="op" id="3343000">,</span>&nbsp;<span class="ident" id="3343002">errors</span><span class="op" id="3343008">.</span><span class="ident" id="3343009">New</span><span class="op" id="3343012">(</span><span class="string" id="3343013">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="3343032">+</span>&nbsp;<span class="ident" id="3343034">targ</span>&nbsp;<span class="op" id="3343039">+</span>&nbsp;<span class="string" id="3343041">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="3343057">+</span>&nbsp;<span class="ident" id="3343059">base</span><span class="op" id="3343063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3343069">//&nbsp;Position&nbsp;base[b0:bi]&nbsp;and&nbsp;targ[t0:ti]&nbsp;at&nbsp;the&nbsp;first&nbsp;differing&nbsp;elements.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343143">bl</span>&nbsp;<span class="op" id="3343146">:=</span>&nbsp;<span class="builtinfunc" id="3343149">len</span><span class="op" id="3343152">(</span><span class="ident" id="3343153">base</span><span class="op" id="3343157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343160">tl</span>&nbsp;<span class="op" id="3343163">:=</span>&nbsp;<span class="builtinfunc" id="3343166">len</span><span class="op" id="3343169">(</span><span class="ident" id="3343170">targ</span><span class="op" id="3343174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343177">var</span>&nbsp;<span class="ident" id="3343181">b0</span><span class="op" id="3343183">,</span>&nbsp;<span class="ident" id="3343185">bi</span><span class="op" id="3343187">,</span>&nbsp;<span class="ident" id="3343189">t0</span><span class="op" id="3343191">,</span>&nbsp;<span class="ident" id="3343193">ti</span>&nbsp;<span class="builtintype" id="3343196">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343201">for</span>&nbsp;<span class="op" id="3343205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343209">for</span>&nbsp;<span class="ident" id="3343213">bi</span>&nbsp;<span class="op" id="3343216">&lt;</span>&nbsp;<span class="ident" id="3343218">bl</span>&nbsp;<span class="op" id="3343221">&amp;&amp;</span>&nbsp;<span class="ident" id="3343224">base</span><span class="op" id="3343228">[</span><span class="ident" id="3343229">bi</span><span class="op" id="3343231">]</span>&nbsp;<span class="op" id="3343233">!=</span>&nbsp;<span class="ident" id="3343236">Separator</span>&nbsp;<span class="op" id="3343246">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343251">bi</span><span class="op" id="3343253">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343262">for</span>&nbsp;<span class="ident" id="3343266">ti</span>&nbsp;<span class="op" id="3343269">&lt;</span>&nbsp;<span class="ident" id="3343271">tl</span>&nbsp;<span class="op" id="3343274">&amp;&amp;</span>&nbsp;<span class="ident" id="3343277">targ</span><span class="op" id="3343281">[</span><span class="ident" id="3343282">ti</span><span class="op" id="3343284">]</span>&nbsp;<span class="op" id="3343286">!=</span>&nbsp;<span class="ident" id="3343289">Separator</span>&nbsp;<span class="op" id="3343299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343304">ti</span><span class="op" id="3343306">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343311">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343315">if</span>&nbsp;<span class="ident" id="3343318">targ</span><span class="op" id="3343322">[</span><span class="ident" id="3343323">t0</span><span class="op" id="3343325">:</span><span class="ident" id="3343326">ti</span><span class="op" id="3343328">]</span>&nbsp;<span class="op" id="3343330">!=</span>&nbsp;<span class="ident" id="3343333">base</span><span class="op" id="3343337">[</span><span class="ident" id="3343338">b0</span><span class="op" id="3343340">:</span><span class="ident" id="3343341">bi</span><span class="op" id="3343343">]</span>&nbsp;<span class="op" id="3343345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343350">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343362">if</span>&nbsp;<span class="ident" id="3343365">bi</span>&nbsp;<span class="op" id="3343368">&lt;</span>&nbsp;<span class="ident" id="3343370">bl</span>&nbsp;<span class="op" id="3343373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343378">bi</span><span class="op" id="3343380">++</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343389">if</span>&nbsp;<span class="ident" id="3343392">ti</span>&nbsp;<span class="op" id="3343395">&lt;</span>&nbsp;<span class="ident" id="3343397">tl</span>&nbsp;<span class="op" id="3343400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343405">ti</span><span class="op" id="3343407">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343416">b0</span>&nbsp;<span class="op" id="3343419">=</span>&nbsp;<span class="ident" id="3343421">bi</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343426">t0</span>&nbsp;<span class="op" id="3343429">=</span>&nbsp;<span class="ident" id="3343431">ti</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343438">if</span>&nbsp;<span class="ident" id="3343441">base</span><span class="op" id="3343445">[</span><span class="ident" id="3343446">b0</span><span class="op" id="3343448">:</span><span class="ident" id="3343449">bi</span><span class="op" id="3343451">]</span>&nbsp;<span class="op" id="3343453">==</span>&nbsp;<span class="string" id="3343456">&#34;..&#34;</span>&nbsp;<span class="op" id="3343461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343465">return</span>&nbsp;<span class="string" id="3343472">&#34;&#34;</span><span class="op" id="3343474">,</span>&nbsp;<span class="ident" id="3343476">errors</span><span class="op" id="3343482">.</span><span class="ident" id="3343483">New</span><span class="op" id="3343486">(</span><span class="string" id="3343487">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="3343506">+</span>&nbsp;<span class="ident" id="3343508">targ</span>&nbsp;<span class="op" id="3343513">+</span>&nbsp;<span class="string" id="3343515">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="3343531">+</span>&nbsp;<span class="ident" id="3343533">base</span><span class="op" id="3343537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343540">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343543">if</span>&nbsp;<span class="ident" id="3343546">b0</span>&nbsp;<span class="op" id="3343549">!=</span>&nbsp;<span class="ident" id="3343552">bl</span>&nbsp;<span class="op" id="3343555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3343559">//&nbsp;Base&nbsp;elements&nbsp;left.&nbsp;Must&nbsp;go&nbsp;up&nbsp;before&nbsp;going&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343614">seps</span>&nbsp;<span class="op" id="3343619">:=</span>&nbsp;<span class="ident" id="3343622">strings</span><span class="op" id="3343629">.</span><span class="ident" id="3343630">Count</span><span class="op" id="3343635">(</span><span class="ident" id="3343636">base</span><span class="op" id="3343640">[</span><span class="ident" id="3343641">b0</span><span class="op" id="3343643">:</span><span class="ident" id="3343644">bl</span><span class="op" id="3343646">]</span><span class="op" id="3343647">,</span>&nbsp;<span class="builtintype" id="3343649">string</span><span class="op" id="3343655">(</span><span class="ident" id="3343656">Separator</span><span class="op" id="3343665">)</span><span class="op" id="3343666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343670">size</span>&nbsp;<span class="op" id="3343675">:=</span>&nbsp;<span class="num" id="3343678">2</span>&nbsp;<span class="op" id="3343680">+</span>&nbsp;<span class="ident" id="3343682">seps</span><span class="op" id="3343686">*</span><span class="num" id="3343687">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343691">if</span>&nbsp;<span class="ident" id="3343694">tl</span>&nbsp;<span class="op" id="3343697">!=</span>&nbsp;<span class="ident" id="3343700">t0</span>&nbsp;<span class="op" id="3343703">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343708">size</span>&nbsp;<span class="op" id="3343713">+=</span>&nbsp;<span class="num" id="3343716">1</span>&nbsp;<span class="op" id="3343718">+</span>&nbsp;<span class="ident" id="3343720">tl</span>&nbsp;<span class="op" id="3343723">-</span>&nbsp;<span class="ident" id="3343725">t0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343734">buf</span>&nbsp;<span class="op" id="3343738">:=</span>&nbsp;<span class="builtinfunc" id="3343741">make</span><span class="op" id="3343745">(</span><span class="op" id="3343746">[</span><span class="op" id="3343747">]</span><span class="builtintype" id="3343748">byte</span><span class="op" id="3343752">,</span>&nbsp;<span class="ident" id="3343754">size</span><span class="op" id="3343758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343762">n</span>&nbsp;<span class="op" id="3343764">:=</span>&nbsp;<span class="builtinfunc" id="3343767">copy</span><span class="op" id="3343771">(</span><span class="ident" id="3343772">buf</span><span class="op" id="3343775">,</span>&nbsp;<span class="string" id="3343777">&#34;..&#34;</span><span class="op" id="3343781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343785">for</span>&nbsp;<span class="ident" id="3343789">i</span>&nbsp;<span class="op" id="3343791">:=</span>&nbsp;<span class="num" id="3343794">0</span><span class="op" id="3343795">;</span>&nbsp;<span class="ident" id="3343797">i</span>&nbsp;<span class="op" id="3343799">&lt;</span>&nbsp;<span class="ident" id="3343801">seps</span><span class="op" id="3343805">;</span>&nbsp;<span class="ident" id="3343807">i</span><span class="op" id="3343808">++</span>&nbsp;<span class="op" id="3343811">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343816">buf</span><span class="op" id="3343819">[</span><span class="ident" id="3343820">n</span><span class="op" id="3343821">]</span>&nbsp;<span class="op" id="3343823">=</span>&nbsp;<span class="ident" id="3343825">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3343838">copy</span><span class="op" id="3343842">(</span><span class="ident" id="3343843">buf</span><span class="op" id="3343846">[</span><span class="ident" id="3343847">n</span><span class="op" id="3343848">+</span><span class="num" id="3343849">1</span><span class="op" id="3343850">:</span><span class="op" id="3343851">]</span><span class="op" id="3343852">,</span>&nbsp;<span class="string" id="3343854">&#34;..&#34;</span><span class="op" id="3343858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343863">n</span>&nbsp;<span class="op" id="3343865">+=</span>&nbsp;<span class="num" id="3343868">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343876">if</span>&nbsp;<span class="ident" id="3343879">t0</span>&nbsp;<span class="op" id="3343882">!=</span>&nbsp;<span class="ident" id="3343885">tl</span>&nbsp;<span class="op" id="3343888">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3343893">buf</span><span class="op" id="3343896">[</span><span class="ident" id="3343897">n</span><span class="op" id="3343898">]</span>&nbsp;<span class="op" id="3343900">=</span>&nbsp;<span class="ident" id="3343902">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3343915">copy</span><span class="op" id="3343919">(</span><span class="ident" id="3343920">buf</span><span class="op" id="3343923">[</span><span class="ident" id="3343924">n</span><span class="op" id="3343925">+</span><span class="num" id="3343926">1</span><span class="op" id="3343927">:</span><span class="op" id="3343928">]</span><span class="op" id="3343929">,</span>&nbsp;<span class="ident" id="3343931">targ</span><span class="op" id="3343935">[</span><span class="ident" id="3343936">t0</span><span class="op" id="3343938">:</span><span class="op" id="3343939">]</span><span class="op" id="3343940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343948">return</span>&nbsp;<span class="builtintype" id="3343955">string</span><span class="op" id="3343961">(</span><span class="ident" id="3343962">buf</span><span class="op" id="3343965">)</span><span class="op" id="3343966">,</span>&nbsp;<span class="builtintype" id="3343968">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3343973">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3343976">return</span>&nbsp;<span class="ident" id="3343983">targ</span><span class="op" id="3343987">[</span><span class="ident" id="3343988">t0</span><span class="op" id="3343990">:</span><span class="op" id="3343991">]</span><span class="op" id="3343992">,</span>&nbsp;<span class="builtintype" id="3343994">nil</span><br>
<span class="lineno"></span><span class="op" id="3343998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3344001">//&nbsp;SkipDir&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;return&nbsp;value&nbsp;from&nbsp;WalkFuncs&nbsp;to&nbsp;indicate&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3344070">//&nbsp;the&nbsp;directory&nbsp;named&nbsp;in&nbsp;the&nbsp;call&nbsp;is&nbsp;to&nbsp;be&nbsp;skipped.&nbsp;It&nbsp;is&nbsp;not&nbsp;returned</span><br>
<span class="lineno">325</span><span class="comment" id="3344142">//&nbsp;as&nbsp;an&nbsp;error&nbsp;by&nbsp;any&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="3344174">var</span>&nbsp;<span class="ident" id="3344178">SkipDir</span>&nbsp;<span class="op" id="3344186">=</span>&nbsp;<span class="ident" id="3344188">errors</span><span class="op" id="3344194">.</span><span class="ident" id="3344195">New</span><span class="op" id="3344198">(</span><span class="string" id="3344199">&#34;skip&nbsp;this&nbsp;directory&#34;</span><span class="op" id="3344220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3344223">//&nbsp;WalkFunc&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;function&nbsp;called&nbsp;for&nbsp;each&nbsp;file&nbsp;or&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="3344297">//&nbsp;visited&nbsp;by&nbsp;Walk.&nbsp;The&nbsp;path&nbsp;argument&nbsp;contains&nbsp;the&nbsp;argument&nbsp;to&nbsp;Walk&nbsp;as&nbsp;a</span><br>
<span class="lineno">330</span><span class="comment" id="3344370">//&nbsp;prefix;&nbsp;that&nbsp;is,&nbsp;if&nbsp;Walk&nbsp;is&nbsp;called&nbsp;with&nbsp;&#34;dir&#34;,&nbsp;which&nbsp;is&nbsp;a&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="3344441">//&nbsp;containing&nbsp;the&nbsp;file&nbsp;&#34;a&#34;,&nbsp;the&nbsp;walk&nbsp;function&nbsp;will&nbsp;be&nbsp;called&nbsp;with&nbsp;argument</span><br>
<span class="lineno"></span><span class="comment" id="3344516">//&nbsp;&#34;dir/a&#34;.&nbsp;The&nbsp;info&nbsp;argument&nbsp;is&nbsp;the&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;named&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3344585">//</span><br>
<span class="lineno"></span><span class="comment" id="3344588">//&nbsp;If&nbsp;there&nbsp;was&nbsp;a&nbsp;problem&nbsp;walking&nbsp;to&nbsp;the&nbsp;file&nbsp;or&nbsp;directory&nbsp;named&nbsp;by&nbsp;path,&nbsp;the</span><br>
<span class="lineno">335</span><span class="comment" id="3344666">//&nbsp;incoming&nbsp;error&nbsp;will&nbsp;describe&nbsp;the&nbsp;problem&nbsp;and&nbsp;the&nbsp;function&nbsp;can&nbsp;decide&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="3344742">//&nbsp;to&nbsp;handle&nbsp;that&nbsp;error&nbsp;(and&nbsp;Walk&nbsp;will&nbsp;not&nbsp;descend&nbsp;into&nbsp;that&nbsp;directory).&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="3344818">//&nbsp;an&nbsp;error&nbsp;is&nbsp;returned,&nbsp;processing&nbsp;stops.&nbsp;The&nbsp;sole&nbsp;exception&nbsp;is&nbsp;that&nbsp;if&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3344896">//&nbsp;is&nbsp;a&nbsp;directory&nbsp;and&nbsp;the&nbsp;function&nbsp;returns&nbsp;the&nbsp;special&nbsp;value&nbsp;SkipDir,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3344970">//&nbsp;contents&nbsp;of&nbsp;the&nbsp;directory&nbsp;are&nbsp;skipped&nbsp;and&nbsp;processing&nbsp;continues&nbsp;as&nbsp;usual&nbsp;on</span><br>
<span class="lineno">340</span><span class="comment" id="3345048">//&nbsp;the&nbsp;next&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3345066">type</span>&nbsp;<span class="ident" id="3345071">WalkFunc</span>&nbsp;<span class="keyword" id="3345080">func</span><span class="op" id="3345084">(</span><span class="ident" id="3345085">path</span>&nbsp;<span class="builtintype" id="3345090">string</span><span class="op" id="3345096">,</span>&nbsp;<span class="ident" id="3345098">info</span>&nbsp;<span class="ident" id="3345103">os</span><span class="op" id="3345105">.</span><span class="ident" id="3345106">FileInfo</span><span class="op" id="3345114">,</span>&nbsp;<span class="ident" id="3345116">err</span>&nbsp;<span class="builtintype" id="3345120">error</span><span class="op" id="3345125">)</span>&nbsp;<span class="builtintype" id="3345127">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3345134">var</span>&nbsp;<span class="ident" id="3345138">lstat</span>&nbsp;<span class="op" id="3345144">=</span>&nbsp;<span class="ident" id="3345146">os</span><span class="op" id="3345148">.</span><span class="ident" id="3345149">Lstat</span>&nbsp;<span class="comment" id="3345155">//&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="3345171">//&nbsp;walk&nbsp;recursively&nbsp;descends&nbsp;path,&nbsp;calling&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="3345217">func</span>&nbsp;<span class="ident" id="3345222">walk</span><span class="op" id="3345226">(</span><span class="ident" id="3345227">path</span>&nbsp;<span class="builtintype" id="3345232">string</span><span class="op" id="3345238">,</span>&nbsp;<span class="ident" id="3345240">info</span>&nbsp;<span class="ident" id="3345245">os</span><span class="op" id="3345247">.</span><span class="ident" id="3345248">FileInfo</span><span class="op" id="3345256">,</span>&nbsp;<span class="ident" id="3345258">walkFn</span>&nbsp;<span class="ident" id="3345265">WalkFunc</span><span class="op" id="3345273">)</span>&nbsp;<span class="builtintype" id="3345275">error</span>&nbsp;<span class="op" id="3345281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3345284">err</span>&nbsp;<span class="op" id="3345288">:=</span>&nbsp;<span class="ident" id="3345291">walkFn</span><span class="op" id="3345297">(</span><span class="ident" id="3345298">path</span><span class="op" id="3345302">,</span>&nbsp;<span class="ident" id="3345304">info</span><span class="op" id="3345308">,</span>&nbsp;<span class="builtintype" id="3345310">nil</span><span class="op" id="3345313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345316">if</span>&nbsp;<span class="ident" id="3345319">err</span>&nbsp;<span class="op" id="3345323">!=</span>&nbsp;<span class="builtintype" id="3345326">nil</span>&nbsp;<span class="op" id="3345330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345334">if</span>&nbsp;<span class="ident" id="3345337">info</span><span class="op" id="3345341">.</span><span class="ident" id="3345342">IsDir</span><span class="op" id="3345347">(</span><span class="op" id="3345348">)</span>&nbsp;<span class="op" id="3345350">&amp;&amp;</span>&nbsp;<span class="ident" id="3345353">err</span>&nbsp;<span class="op" id="3345357">==</span>&nbsp;<span class="ident" id="3345360">SkipDir</span>&nbsp;<span class="op" id="3345368">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345373">return</span>&nbsp;<span class="builtintype" id="3345380">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345390">return</span>&nbsp;<span class="ident" id="3345397">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345406">if</span>&nbsp;<span class="op" id="3345409">!</span><span class="ident" id="3345410">info</span><span class="op" id="3345414">.</span><span class="ident" id="3345415">IsDir</span><span class="op" id="3345420">(</span><span class="op" id="3345421">)</span>&nbsp;<span class="op" id="3345423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345427">return</span>&nbsp;<span class="builtintype" id="3345434">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3345443">names</span><span class="op" id="3345448">,</span>&nbsp;<span class="ident" id="3345450">err</span>&nbsp;<span class="op" id="3345454">:=</span>&nbsp;<span class="ident" id="3345457">readDirNames</span><span class="op" id="3345469">(</span><span class="ident" id="3345470">path</span><span class="op" id="3345474">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345477">if</span>&nbsp;<span class="ident" id="3345480">err</span>&nbsp;<span class="op" id="3345484">!=</span>&nbsp;<span class="builtintype" id="3345487">nil</span>&nbsp;<span class="op" id="3345491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345495">return</span>&nbsp;<span class="ident" id="3345502">walkFn</span><span class="op" id="3345508">(</span><span class="ident" id="3345509">path</span><span class="op" id="3345513">,</span>&nbsp;<span class="ident" id="3345515">info</span><span class="op" id="3345519">,</span>&nbsp;<span class="ident" id="3345521">err</span><span class="op" id="3345524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345531">for</span>&nbsp;<span class="ident" id="3345535">_</span><span class="op" id="3345536">,</span>&nbsp;<span class="ident" id="3345538">name</span>&nbsp;<span class="op" id="3345543">:=</span>&nbsp;<span class="keyword" id="3345546">range</span>&nbsp;<span class="ident" id="3345552">names</span>&nbsp;<span class="op" id="3345558">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3345562">filename</span>&nbsp;<span class="op" id="3345571">:=</span>&nbsp;<span class="ident" id="3345574">Join</span><span class="op" id="3345578">(</span><span class="ident" id="3345579">path</span><span class="op" id="3345583">,</span>&nbsp;<span class="ident" id="3345585">name</span><span class="op" id="3345589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3345593">fileInfo</span><span class="op" id="3345601">,</span>&nbsp;<span class="ident" id="3345603">err</span>&nbsp;<span class="op" id="3345607">:=</span>&nbsp;<span class="ident" id="3345610">lstat</span><span class="op" id="3345615">(</span><span class="ident" id="3345616">filename</span><span class="op" id="3345624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345628">if</span>&nbsp;<span class="ident" id="3345631">err</span>&nbsp;<span class="op" id="3345635">!=</span>&nbsp;<span class="builtintype" id="3345638">nil</span>&nbsp;<span class="op" id="3345642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345647">if</span>&nbsp;<span class="ident" id="3345650">err</span>&nbsp;<span class="op" id="3345654">:=</span>&nbsp;<span class="ident" id="3345657">walkFn</span><span class="op" id="3345663">(</span><span class="ident" id="3345664">filename</span><span class="op" id="3345672">,</span>&nbsp;<span class="ident" id="3345674">fileInfo</span><span class="op" id="3345682">,</span>&nbsp;<span class="ident" id="3345684">err</span><span class="op" id="3345687">)</span><span class="op" id="3345688">;</span>&nbsp;<span class="ident" id="3345690">err</span>&nbsp;<span class="op" id="3345694">!=</span>&nbsp;<span class="builtintype" id="3345697">nil</span>&nbsp;<span class="op" id="3345701">&amp;&amp;</span>&nbsp;<span class="ident" id="3345704">err</span>&nbsp;<span class="op" id="3345708">!=</span>&nbsp;<span class="ident" id="3345711">SkipDir</span>&nbsp;<span class="op" id="3345719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345725">return</span>&nbsp;<span class="ident" id="3345732">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345743">}</span>&nbsp;<span class="keyword" id="3345745">else</span>&nbsp;<span class="op" id="3345750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3345755">err</span>&nbsp;<span class="op" id="3345759">=</span>&nbsp;<span class="ident" id="3345761">walk</span><span class="op" id="3345765">(</span><span class="ident" id="3345766">filename</span><span class="op" id="3345774">,</span>&nbsp;<span class="ident" id="3345776">fileInfo</span><span class="op" id="3345784">,</span>&nbsp;<span class="ident" id="3345786">walkFn</span><span class="op" id="3345792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345797">if</span>&nbsp;<span class="ident" id="3345800">err</span>&nbsp;<span class="op" id="3345804">!=</span>&nbsp;<span class="builtintype" id="3345807">nil</span>&nbsp;<span class="op" id="3345811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345817">if</span>&nbsp;<span class="op" id="3345820">!</span><span class="ident" id="3345821">fileInfo</span><span class="op" id="3345829">.</span><span class="ident" id="3345830">IsDir</span><span class="op" id="3345835">(</span><span class="op" id="3345836">)</span>&nbsp;<span class="op" id="3345838">||</span>&nbsp;<span class="ident" id="3345841">err</span>&nbsp;<span class="op" id="3345845">!=</span>&nbsp;<span class="ident" id="3345848">SkipDir</span>&nbsp;<span class="op" id="3345856">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345863">return</span>&nbsp;<span class="ident" id="3345870">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3345890">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3345893">return</span>&nbsp;<span class="builtintype" id="3345900">nil</span><br>
<span class="lineno"></span><span class="op" id="3345904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3345907">//&nbsp;Walk&nbsp;walks&nbsp;the&nbsp;file&nbsp;tree&nbsp;rooted&nbsp;at&nbsp;root,&nbsp;calling&nbsp;walkFn&nbsp;for&nbsp;each&nbsp;file&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3345983">//&nbsp;directory&nbsp;in&nbsp;the&nbsp;tree,&nbsp;including&nbsp;root.&nbsp;All&nbsp;errors&nbsp;that&nbsp;arise&nbsp;visiting&nbsp;files</span><br>
<span class="lineno">385</span><span class="comment" id="3346062">//&nbsp;and&nbsp;directories&nbsp;are&nbsp;filtered&nbsp;by&nbsp;walkFn.&nbsp;The&nbsp;files&nbsp;are&nbsp;walked&nbsp;in&nbsp;lexical</span><br>
<span class="lineno"></span><span class="comment" id="3346137">//&nbsp;order,&nbsp;which&nbsp;makes&nbsp;the&nbsp;output&nbsp;deterministic&nbsp;but&nbsp;means&nbsp;that&nbsp;for&nbsp;very</span><br>
<span class="lineno"></span><span class="comment" id="3346208">//&nbsp;large&nbsp;directories&nbsp;Walk&nbsp;can&nbsp;be&nbsp;inefficient.</span><br>
<span class="lineno"></span><span class="comment" id="3346254">//&nbsp;Walk&nbsp;does&nbsp;not&nbsp;follow&nbsp;symbolic&nbsp;links.</span><br>
<span class="lineno"></span><span class="keyword" id="3346294">func</span>&nbsp;<span class="ident" id="3346299">Walk</span><span class="op" id="3346303">(</span><span class="ident" id="3346304">root</span>&nbsp;<span class="builtintype" id="3346309">string</span><span class="op" id="3346315">,</span>&nbsp;<span class="ident" id="3346317">walkFn</span>&nbsp;<span class="ident" id="3346324">WalkFunc</span><span class="op" id="3346332">)</span>&nbsp;<span class="builtintype" id="3346334">error</span>&nbsp;<span class="op" id="3346340">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3346343">info</span><span class="op" id="3346347">,</span>&nbsp;<span class="ident" id="3346349">err</span>&nbsp;<span class="op" id="3346353">:=</span>&nbsp;<span class="ident" id="3346356">os</span><span class="op" id="3346358">.</span><span class="ident" id="3346359">Lstat</span><span class="op" id="3346364">(</span><span class="ident" id="3346365">root</span><span class="op" id="3346369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346372">if</span>&nbsp;<span class="ident" id="3346375">err</span>&nbsp;<span class="op" id="3346379">!=</span>&nbsp;<span class="builtintype" id="3346382">nil</span>&nbsp;<span class="op" id="3346386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346390">return</span>&nbsp;<span class="ident" id="3346397">walkFn</span><span class="op" id="3346403">(</span><span class="ident" id="3346404">root</span><span class="op" id="3346408">,</span>&nbsp;<span class="builtintype" id="3346410">nil</span><span class="op" id="3346413">,</span>&nbsp;<span class="ident" id="3346415">err</span><span class="op" id="3346418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3346421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346424">return</span>&nbsp;<span class="ident" id="3346431">walk</span><span class="op" id="3346435">(</span><span class="ident" id="3346436">root</span><span class="op" id="3346440">,</span>&nbsp;<span class="ident" id="3346442">info</span><span class="op" id="3346446">,</span>&nbsp;<span class="ident" id="3346448">walkFn</span><span class="op" id="3346454">)</span><br>
<span class="lineno">395</span><span class="op" id="3346456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3346459">//&nbsp;readDirNames&nbsp;reads&nbsp;the&nbsp;directory&nbsp;named&nbsp;by&nbsp;dirname&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3346524">//&nbsp;a&nbsp;sorted&nbsp;list&nbsp;of&nbsp;directory&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="3346563">func</span>&nbsp;<span class="ident" id="3346568">readDirNames</span><span class="op" id="3346580">(</span><span class="ident" id="3346581">dirname</span>&nbsp;<span class="builtintype" id="3346589">string</span><span class="op" id="3346595">)</span>&nbsp;<span class="op" id="3346597">(</span><span class="op" id="3346598">[</span><span class="op" id="3346599">]</span><span class="builtintype" id="3346600">string</span><span class="op" id="3346606">,</span>&nbsp;<span class="builtintype" id="3346608">error</span><span class="op" id="3346613">)</span>&nbsp;<span class="op" id="3346615">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3346618">f</span><span class="op" id="3346619">,</span>&nbsp;<span class="ident" id="3346621">err</span>&nbsp;<span class="op" id="3346625">:=</span>&nbsp;<span class="ident" id="3346628">os</span><span class="op" id="3346630">.</span><span class="ident" id="3346631">Open</span><span class="op" id="3346635">(</span><span class="ident" id="3346636">dirname</span><span class="op" id="3346643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346646">if</span>&nbsp;<span class="ident" id="3346649">err</span>&nbsp;<span class="op" id="3346653">!=</span>&nbsp;<span class="builtintype" id="3346656">nil</span>&nbsp;<span class="op" id="3346660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346664">return</span>&nbsp;<span class="builtintype" id="3346671">nil</span><span class="op" id="3346674">,</span>&nbsp;<span class="ident" id="3346676">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3346681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3346684">names</span><span class="op" id="3346689">,</span>&nbsp;<span class="ident" id="3346691">err</span>&nbsp;<span class="op" id="3346695">:=</span>&nbsp;<span class="ident" id="3346698">f</span><span class="op" id="3346699">.</span><span class="ident" id="3346700">Readdirnames</span><span class="op" id="3346712">(</span><span class="op" id="3346713">-</span><span class="num" id="3346714">1</span><span class="op" id="3346715">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3346718">f</span><span class="op" id="3346719">.</span><span class="ident" id="3346720">Close</span><span class="op" id="3346725">(</span><span class="op" id="3346726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346729">if</span>&nbsp;<span class="ident" id="3346732">err</span>&nbsp;<span class="op" id="3346736">!=</span>&nbsp;<span class="builtintype" id="3346739">nil</span>&nbsp;<span class="op" id="3346743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346747">return</span>&nbsp;<span class="builtintype" id="3346754">nil</span><span class="op" id="3346757">,</span>&nbsp;<span class="ident" id="3346759">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3346764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3346767">sort</span><span class="op" id="3346771">.</span><span class="ident" id="3346772">Strings</span><span class="op" id="3346779">(</span><span class="ident" id="3346780">names</span><span class="op" id="3346785">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3346788">return</span>&nbsp;<span class="ident" id="3346795">names</span><span class="op" id="3346800">,</span>&nbsp;<span class="builtintype" id="3346802">nil</span><br>
<span class="lineno"></span><span class="op" id="3346806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3346809">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3346851">//&nbsp;Trailing&nbsp;path&nbsp;separators&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno">415</span><span class="comment" id="3346927">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3346970">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Base&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="keyword" id="3347051">func</span>&nbsp;<span class="ident" id="3347056">Base</span><span class="op" id="3347060">(</span><span class="ident" id="3347061">path</span>&nbsp;<span class="builtintype" id="3347066">string</span><span class="op" id="3347072">)</span>&nbsp;<span class="builtintype" id="3347074">string</span>&nbsp;<span class="op" id="3347081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347084">if</span>&nbsp;<span class="ident" id="3347087">path</span>&nbsp;<span class="op" id="3347092">==</span>&nbsp;<span class="string" id="3347095">&#34;&#34;</span>&nbsp;<span class="op" id="3347098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347102">return</span>&nbsp;<span class="string" id="3347109">&#34;.&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3347114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3347117">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347145">for</span>&nbsp;<span class="builtinfunc" id="3347149">len</span><span class="op" id="3347152">(</span><span class="ident" id="3347153">path</span><span class="op" id="3347157">)</span>&nbsp;<span class="op" id="3347159">&gt;</span>&nbsp;<span class="num" id="3347161">0</span>&nbsp;<span class="op" id="3347163">&amp;&amp;</span>&nbsp;<span class="ident" id="3347166">os</span><span class="op" id="3347168">.</span><span class="ident" id="3347169">IsPathSeparator</span><span class="op" id="3347184">(</span><span class="ident" id="3347185">path</span><span class="op" id="3347189">[</span><span class="builtinfunc" id="3347190">len</span><span class="op" id="3347193">(</span><span class="ident" id="3347194">path</span><span class="op" id="3347198">)</span><span class="op" id="3347199">-</span><span class="num" id="3347200">1</span><span class="op" id="3347201">]</span><span class="op" id="3347202">)</span>&nbsp;<span class="op" id="3347204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347208">path</span>&nbsp;<span class="op" id="3347213">=</span>&nbsp;<span class="ident" id="3347215">path</span><span class="op" id="3347219">[</span><span class="num" id="3347220">0</span>&nbsp;<span class="op" id="3347222">:</span>&nbsp;<span class="builtinfunc" id="3347224">len</span><span class="op" id="3347227">(</span><span class="ident" id="3347228">path</span><span class="op" id="3347232">)</span><span class="op" id="3347233">-</span><span class="num" id="3347234">1</span><span class="op" id="3347235">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3347238">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3347241">//&nbsp;Throw&nbsp;away&nbsp;volume&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347268">path</span>&nbsp;<span class="op" id="3347273">=</span>&nbsp;<span class="ident" id="3347275">path</span><span class="op" id="3347279">[</span><span class="builtinfunc" id="3347280">len</span><span class="op" id="3347283">(</span><span class="ident" id="3347284">VolumeName</span><span class="op" id="3347294">(</span><span class="ident" id="3347295">path</span><span class="op" id="3347299">)</span><span class="op" id="3347300">)</span><span class="op" id="3347301">:</span><span class="op" id="3347302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3347305">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347331">i</span>&nbsp;<span class="op" id="3347333">:=</span>&nbsp;<span class="builtinfunc" id="3347336">len</span><span class="op" id="3347339">(</span><span class="ident" id="3347340">path</span><span class="op" id="3347344">)</span>&nbsp;<span class="op" id="3347346">-</span>&nbsp;<span class="num" id="3347348">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347351">for</span>&nbsp;<span class="ident" id="3347355">i</span>&nbsp;<span class="op" id="3347357">&gt;=</span>&nbsp;<span class="num" id="3347360">0</span>&nbsp;<span class="op" id="3347362">&amp;&amp;</span>&nbsp;<span class="op" id="3347365">!</span><span class="ident" id="3347366">os</span><span class="op" id="3347368">.</span><span class="ident" id="3347369">IsPathSeparator</span><span class="op" id="3347384">(</span><span class="ident" id="3347385">path</span><span class="op" id="3347389">[</span><span class="ident" id="3347390">i</span><span class="op" id="3347391">]</span><span class="op" id="3347392">)</span>&nbsp;<span class="op" id="3347394">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347398">i</span><span class="op" id="3347399">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3347403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347406">if</span>&nbsp;<span class="ident" id="3347409">i</span>&nbsp;<span class="op" id="3347411">&gt;=</span>&nbsp;<span class="num" id="3347414">0</span>&nbsp;<span class="op" id="3347416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347420">path</span>&nbsp;<span class="op" id="3347425">=</span>&nbsp;<span class="ident" id="3347427">path</span><span class="op" id="3347431">[</span><span class="ident" id="3347432">i</span><span class="op" id="3347433">+</span><span class="num" id="3347434">1</span><span class="op" id="3347435">:</span><span class="op" id="3347436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3347439">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3347442">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347481">if</span>&nbsp;<span class="ident" id="3347484">path</span>&nbsp;<span class="op" id="3347489">==</span>&nbsp;<span class="string" id="3347492">&#34;&#34;</span>&nbsp;<span class="op" id="3347495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347499">return</span>&nbsp;<span class="builtintype" id="3347506">string</span><span class="op" id="3347512">(</span><span class="ident" id="3347513">Separator</span><span class="op" id="3347522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3347525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347528">return</span>&nbsp;<span class="ident" id="3347535">path</span><br>
<span class="lineno">440</span><span class="op" id="3347540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3347543">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3347624">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3347694">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno">445</span><span class="comment" id="3347718">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3347760">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Dir&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="comment" id="3347840">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a&nbsp;separator&nbsp;unless&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="3347922">func</span>&nbsp;<span class="ident" id="3347927">Dir</span><span class="op" id="3347930">(</span><span class="ident" id="3347931">path</span>&nbsp;<span class="builtintype" id="3347936">string</span><span class="op" id="3347942">)</span>&nbsp;<span class="builtintype" id="3347944">string</span>&nbsp;<span class="op" id="3347951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347954">vol</span>&nbsp;<span class="op" id="3347958">:=</span>&nbsp;<span class="ident" id="3347961">VolumeName</span><span class="op" id="3347971">(</span><span class="ident" id="3347972">path</span><span class="op" id="3347976">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3347979">i</span>&nbsp;<span class="op" id="3347981">:=</span>&nbsp;<span class="builtinfunc" id="3347984">len</span><span class="op" id="3347987">(</span><span class="ident" id="3347988">path</span><span class="op" id="3347992">)</span>&nbsp;<span class="op" id="3347994">-</span>&nbsp;<span class="num" id="3347996">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3347999">for</span>&nbsp;<span class="ident" id="3348003">i</span>&nbsp;<span class="op" id="3348005">&gt;=</span>&nbsp;<span class="builtinfunc" id="3348008">len</span><span class="op" id="3348011">(</span><span class="ident" id="3348012">vol</span><span class="op" id="3348015">)</span>&nbsp;<span class="op" id="3348017">&amp;&amp;</span>&nbsp;<span class="op" id="3348020">!</span><span class="ident" id="3348021">os</span><span class="op" id="3348023">.</span><span class="ident" id="3348024">IsPathSeparator</span><span class="op" id="3348039">(</span><span class="ident" id="3348040">path</span><span class="op" id="3348044">[</span><span class="ident" id="3348045">i</span><span class="op" id="3348046">]</span><span class="op" id="3348047">)</span>&nbsp;<span class="op" id="3348049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3348053">i</span><span class="op" id="3348054">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3348058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3348061">dir</span>&nbsp;<span class="op" id="3348065">:=</span>&nbsp;<span class="ident" id="3348068">Clean</span><span class="op" id="3348073">(</span><span class="ident" id="3348074">path</span><span class="op" id="3348078">[</span><span class="builtinfunc" id="3348079">len</span><span class="op" id="3348082">(</span><span class="ident" id="3348083">vol</span><span class="op" id="3348086">)</span>&nbsp;<span class="op" id="3348088">:</span>&nbsp;<span class="ident" id="3348090">i</span><span class="op" id="3348091">+</span><span class="num" id="3348092">1</span><span class="op" id="3348093">]</span><span class="op" id="3348094">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3348097">return</span>&nbsp;<span class="ident" id="3348104">vol</span>&nbsp;<span class="op" id="3348108">+</span>&nbsp;<span class="ident" id="3348110">dir</span><br>
<span class="lineno"></span><span class="op" id="3348114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3348117">//&nbsp;VolumeName&nbsp;returns&nbsp;leading&nbsp;volume&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3348160">//&nbsp;Given&nbsp;&#34;C:\foo\bar&#34;&nbsp;it&nbsp;returns&nbsp;&#34;C:&#34;&nbsp;under&nbsp;windows.</span><br>
<span class="lineno">460</span><span class="comment" id="3348213">//&nbsp;Given&nbsp;&#34;\\host\share\foo&#34;&nbsp;it&nbsp;returns&nbsp;&#34;\\host\share&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3348268">//&nbsp;On&nbsp;other&nbsp;platforms&nbsp;it&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3348305">func</span>&nbsp;<span class="ident" id="3348310">VolumeName</span><span class="op" id="3348320">(</span><span class="ident" id="3348321">path</span>&nbsp;<span class="builtintype" id="3348326">string</span><span class="op" id="3348332">)</span>&nbsp;<span class="op" id="3348334">(</span><span class="ident" id="3348335">v</span>&nbsp;<span class="builtintype" id="3348337">string</span><span class="op" id="3348343">)</span>&nbsp;<span class="op" id="3348345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3348348">return</span>&nbsp;<span class="ident" id="3348355">path</span><span class="op" id="3348359">[</span><span class="op" id="3348360">:</span><span class="ident" id="3348361">volumeNameLen</span><span class="op" id="3348374">(</span><span class="ident" id="3348375">path</span><span class="op" id="3348379">)</span><span class="op" id="3348380">]</span><br>
<span class="lineno"></span><span class="op" id="3348382">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
