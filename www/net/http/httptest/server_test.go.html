<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6780011">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6780066">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6780120">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6780171">package</span>&nbsp;<span class="ident" id="6780179">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6780189">import</span>&nbsp;<span class="op" id="6780196">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6780199">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6780212">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6780224">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6780234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6780237">func</span>&nbsp;<span class="ident" id="6780242">TestServer</span><span class="op" id="6780252">(</span><span class="ident" id="6780253">t</span>&nbsp;<span class="op" id="6780255">*</span><span class="ident" id="6780256"><a href="/net/http/httptest/server_test.go.html#6780224">testing</a></span><span class="op" id="6780263">.</span><span class="ident" id="6780264">T</span><span class="op" id="6780265">)</span>&nbsp;<span class="op" id="6780267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780270">ts</span>&nbsp;<span class="op" id="6780273">:=</span>&nbsp;<span class="ident" id="6780276"><a href="/net/http/httptest/server.go.html#6300028">NewServer</a></span><span class="op" id="6780285">(</span><span class="ident" id="6780286"><a href="/net/http/httptest/server_test.go.html#6780212">http</a></span><span class="op" id="6780290">.</span><span class="ident" id="6780291">HandlerFunc</span><span class="op" id="6780302">(</span><span class="keyword" id="6780303">func</span><span class="op" id="6780307">(</span><span class="ident" id="6780308">w</span>&nbsp;<span class="ident" id="6780310"><a href="/net/http/httptest/server_test.go.html#6780212">http</a></span><span class="op" id="6780314">.</span><span class="ident" id="6780315">ResponseWriter</span><span class="op" id="6780329">,</span>&nbsp;<span class="ident" id="6780331">r</span>&nbsp;<span class="op" id="6780333">*</span><span class="ident" id="6780334"><a href="/net/http/httptest/server_test.go.html#6780212">http</a></span><span class="op" id="6780338">.</span><span class="ident" id="6780339">Request</span><span class="op" id="6780346">)</span>&nbsp;<span class="op" id="6780348">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780352"><a href="/net/http/httptest/server_test.go.html#6780308">w</a></span><span class="op" id="6780353">.</span><span class="ident" id="6780354">Write</span><span class="op" id="6780359">(</span><span class="op" id="6780360">[</span><span class="op" id="6780361">]</span><span class="builtintype" id="6780362">byte</span><span class="op" id="6780366">(</span><span class="string" id="6780367">&#34;hello&#34;</span><span class="op" id="6780374">)</span><span class="op" id="6780375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780378">}</span><span class="op" id="6780379">)</span><span class="op" id="6780380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780383">defer</span>&nbsp;<span class="ident" id="6780389"><a href="/net/http/httptest/server_test.go.html#6780270">ts</a></span><span class="op" id="6780391">.</span><span class="ident" id="6780392">Close</span><span class="op" id="6780397">(</span><span class="op" id="6780398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780401">res</span><span class="op" id="6780404">,</span>&nbsp;<span class="ident" id="6780406">err</span>&nbsp;<span class="op" id="6780410">:=</span>&nbsp;<span class="ident" id="6780413"><a href="/net/http/httptest/server_test.go.html#6780212">http</a></span><span class="op" id="6780417">.</span><span class="ident" id="6780418">Get</span><span class="op" id="6780421">(</span><span class="ident" id="6780422"><a href="/net/http/httptest/server_test.go.html#6780270">ts</a></span><span class="op" id="6780424">.</span><span class="ident" id="6780425">URL</span><span class="op" id="6780428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780431">if</span>&nbsp;<span class="ident" id="6780434"><a href="/net/http/httptest/server_test.go.html#6780406">err</a></span>&nbsp;<span class="op" id="6780438">!=</span>&nbsp;<span class="ident" id="6780441">nil</span>&nbsp;<span class="op" id="6780445">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780449"><a href="/net/http/httptest/server_test.go.html#6780253">t</a></span><span class="op" id="6780450">.</span><span class="ident" id="6780451">Fatal</span><span class="op" id="6780456">(</span><span class="ident" id="6780457"><a href="/net/http/httptest/server_test.go.html#6780406">err</a></span><span class="op" id="6780460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780466">got</span><span class="op" id="6780469">,</span>&nbsp;<span class="ident" id="6780471"><a href="/net/http/httptest/server_test.go.html#6780406">err</a></span>&nbsp;<span class="op" id="6780475">:=</span>&nbsp;<span class="ident" id="6780478"><a href="/net/http/httptest/server_test.go.html#6780199">ioutil</a></span><span class="op" id="6780484">.</span><span class="ident" id="6780485">ReadAll</span><span class="op" id="6780492">(</span><span class="ident" id="6780493"><a href="/net/http/httptest/server_test.go.html#6780401">res</a></span><span class="op" id="6780496">.</span><span class="ident" id="6780497">Body</span><span class="op" id="6780501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780504">if</span>&nbsp;<span class="ident" id="6780507"><a href="/net/http/httptest/server_test.go.html#6780406">err</a></span>&nbsp;<span class="op" id="6780511">!=</span>&nbsp;<span class="ident" id="6780514">nil</span>&nbsp;<span class="op" id="6780518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780522"><a href="/net/http/httptest/server_test.go.html#6780253">t</a></span><span class="op" id="6780523">.</span><span class="ident" id="6780524">Fatal</span><span class="op" id="6780529">(</span><span class="ident" id="6780530"><a href="/net/http/httptest/server_test.go.html#6780406">err</a></span><span class="op" id="6780533">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780539">if</span>&nbsp;<span class="builtintype" id="6780542">string</span><span class="op" id="6780548">(</span><span class="ident" id="6780549"><a href="/net/http/httptest/server_test.go.html#6780466">got</a></span><span class="op" id="6780552">)</span>&nbsp;<span class="op" id="6780554">!=</span>&nbsp;<span class="string" id="6780557">&#34;hello&#34;</span>&nbsp;<span class="op" id="6780565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780569"><a href="/net/http/httptest/server_test.go.html#6780253">t</a></span><span class="op" id="6780570">.</span><span class="ident" id="6780571">Errorf</span><span class="op" id="6780577">(</span><span class="string" id="6780578">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="6780598">,</span>&nbsp;<span class="builtintype" id="6780600">string</span><span class="op" id="6780606">(</span><span class="ident" id="6780607"><a href="/net/http/httptest/server_test.go.html#6780466">got</a></span><span class="op" id="6780610">)</span><span class="op" id="6780611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780614">}</span><br>
<span class="lineno"></span><span class="op" id="6780616">}</span>
</div>
</body>
</html>
