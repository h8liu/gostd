<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html" class="current">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6502114">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6502170">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6502224">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6502275">package</span>&nbsp;<span class="ident" id="6502283">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6502288">import</span>&nbsp;<span class="string" id="6502295">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6502305">const</span>&nbsp;<span class="op" id="6502311">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502314">icmpv4EchoRequest</span>&nbsp;<span class="op" id="6502332">=</span>&nbsp;<span class="num" id="6502334">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502337">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6502355">=</span>&nbsp;<span class="num" id="6502357">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502360">icmpv6EchoRequest</span>&nbsp;<span class="op" id="6502378">=</span>&nbsp;<span class="num" id="6502380">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502385">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6502403">=</span>&nbsp;<span class="num" id="6502405">129</span><br>
<span class="lineno"></span><span class="op" id="6502409">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6502412">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6502455">type</span>&nbsp;<span class="ident" id="6502460">icmpMessage</span>&nbsp;<span class="keyword" id="6502472">struct</span>&nbsp;<span class="op" id="6502479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502482">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6502491">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6502507">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502516">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6502525">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6502541">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502550">Checksum</span>&nbsp;<span class="builtintype" id="6502559">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6502575">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502588">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502597">icmpMessageBody</span>&nbsp;<span class="comment" id="6502613">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="6502621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6502624">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="6502676">type</span>&nbsp;<span class="ident" id="6502681">icmpMessageBody</span>&nbsp;<span class="keyword" id="6502697">interface</span>&nbsp;<span class="op" id="6502707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502710">Len</span><span class="op" id="6502713">(</span><span class="op" id="6502714">)</span>&nbsp;<span class="builtintype" id="6502716">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502721">Marshal</span><span class="op" id="6502728">(</span><span class="op" id="6502729">)</span>&nbsp;<span class="op" id="6502731">(</span><span class="op" id="6502732">[</span><span class="op" id="6502733">]</span><span class="builtintype" id="6502734">byte</span><span class="op" id="6502738">,</span>&nbsp;<span class="builtintype" id="6502740">error</span><span class="op" id="6502745">)</span><br>
<span class="lineno"></span><span class="op" id="6502747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6502750">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6502818">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="6502838">func</span>&nbsp;<span class="op" id="6502843">(</span><span class="ident" id="6502844">m</span>&nbsp;<span class="op" id="6502846">*</span><span class="ident" id="6502847">icmpMessage</span><span class="op" id="6502858">)</span>&nbsp;<span class="ident" id="6502860">Marshal</span><span class="op" id="6502867">(</span><span class="op" id="6502868">)</span>&nbsp;<span class="op" id="6502870">(</span><span class="op" id="6502871">[</span><span class="op" id="6502872">]</span><span class="builtintype" id="6502873">byte</span><span class="op" id="6502877">,</span>&nbsp;<span class="builtintype" id="6502879">error</span><span class="op" id="6502884">)</span>&nbsp;<span class="op" id="6502886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502889">b</span>&nbsp;<span class="op" id="6502891">:=</span>&nbsp;<span class="op" id="6502894">[</span><span class="op" id="6502895">]</span><span class="builtintype" id="6502896">byte</span><span class="op" id="6502900">{</span><span class="builtintype" id="6502901">byte</span><span class="op" id="6502905">(</span><span class="ident" id="6502906">m</span><span class="op" id="6502907">.</span><span class="ident" id="6502908">Type</span><span class="op" id="6502912">)</span><span class="op" id="6502913">,</span>&nbsp;<span class="builtintype" id="6502915">byte</span><span class="op" id="6502919">(</span><span class="ident" id="6502920">m</span><span class="op" id="6502921">.</span><span class="ident" id="6502922">Code</span><span class="op" id="6502926">)</span><span class="op" id="6502927">,</span>&nbsp;<span class="num" id="6502929">0</span><span class="op" id="6502930">,</span>&nbsp;<span class="num" id="6502932">0</span><span class="op" id="6502933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6502936">if</span>&nbsp;<span class="ident" id="6502939">m</span><span class="op" id="6502940">.</span><span class="ident" id="6502941">Body</span>&nbsp;<span class="op" id="6502946">!=</span>&nbsp;<span class="builtintype" id="6502949">nil</span>&nbsp;<span class="op" id="6502953">&amp;&amp;</span>&nbsp;<span class="ident" id="6502956">m</span><span class="op" id="6502957">.</span><span class="ident" id="6502958">Body</span><span class="op" id="6502962">.</span><span class="ident" id="6502963">Len</span><span class="op" id="6502966">(</span><span class="op" id="6502967">)</span>&nbsp;<span class="op" id="6502969">!=</span>&nbsp;<span class="num" id="6502972">0</span>&nbsp;<span class="op" id="6502974">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502978">mb</span><span class="op" id="6502980">,</span>&nbsp;<span class="ident" id="6502982">err</span>&nbsp;<span class="op" id="6502986">:=</span>&nbsp;<span class="ident" id="6502989">m</span><span class="op" id="6502990">.</span><span class="ident" id="6502991">Body</span><span class="op" id="6502995">.</span><span class="ident" id="6502996">Marshal</span><span class="op" id="6503003">(</span><span class="op" id="6503004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503008">if</span>&nbsp;<span class="ident" id="6503011">err</span>&nbsp;<span class="op" id="6503015">!=</span>&nbsp;<span class="builtintype" id="6503018">nil</span>&nbsp;<span class="op" id="6503022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503027">return</span>&nbsp;<span class="builtintype" id="6503034">nil</span><span class="op" id="6503037">,</span>&nbsp;<span class="ident" id="6503039">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503049">b</span>&nbsp;<span class="op" id="6503051">=</span>&nbsp;<span class="builtinfunc" id="6503053">append</span><span class="op" id="6503059">(</span><span class="ident" id="6503060">b</span><span class="op" id="6503061">,</span>&nbsp;<span class="ident" id="6503063">mb</span><span class="op" id="6503065">...</span><span class="op" id="6503068">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503074">switch</span>&nbsp;<span class="ident" id="6503081">m</span><span class="op" id="6503082">.</span><span class="ident" id="6503083">Type</span>&nbsp;<span class="op" id="6503088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503091">case</span>&nbsp;<span class="ident" id="6503096">icmpv6EchoRequest</span><span class="op" id="6503113">,</span>&nbsp;<span class="ident" id="6503115">icmpv6EchoReply</span><span class="op" id="6503130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503134">return</span>&nbsp;<span class="ident" id="6503141">b</span><span class="op" id="6503142">,</span>&nbsp;<span class="builtintype" id="6503144">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503149">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503152">csumcv</span>&nbsp;<span class="op" id="6503159">:=</span>&nbsp;<span class="builtinfunc" id="6503162">len</span><span class="op" id="6503165">(</span><span class="ident" id="6503166">b</span><span class="op" id="6503167">)</span>&nbsp;<span class="op" id="6503169">-</span>&nbsp;<span class="num" id="6503171">1</span>&nbsp;<span class="comment" id="6503173">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503195">s</span>&nbsp;<span class="op" id="6503197">:=</span>&nbsp;<span class="builtintype" id="6503200">uint32</span><span class="op" id="6503206">(</span><span class="num" id="6503207">0</span><span class="op" id="6503208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503211">for</span>&nbsp;<span class="ident" id="6503215">i</span>&nbsp;<span class="op" id="6503217">:=</span>&nbsp;<span class="num" id="6503220">0</span><span class="op" id="6503221">;</span>&nbsp;<span class="ident" id="6503223">i</span>&nbsp;<span class="op" id="6503225">&lt;</span>&nbsp;<span class="ident" id="6503227">csumcv</span><span class="op" id="6503233">;</span>&nbsp;<span class="ident" id="6503235">i</span>&nbsp;<span class="op" id="6503237">+=</span>&nbsp;<span class="num" id="6503240">2</span>&nbsp;<span class="op" id="6503242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503246">s</span>&nbsp;<span class="op" id="6503248">+=</span>&nbsp;<span class="builtintype" id="6503251">uint32</span><span class="op" id="6503257">(</span><span class="ident" id="6503258">b</span><span class="op" id="6503259">[</span><span class="ident" id="6503260">i</span><span class="op" id="6503261">+</span><span class="num" id="6503262">1</span><span class="op" id="6503263">]</span><span class="op" id="6503264">)</span><span class="op" id="6503265">&lt;&lt;</span><span class="num" id="6503267">8</span>&nbsp;<span class="op" id="6503269">|</span>&nbsp;<span class="builtintype" id="6503271">uint32</span><span class="op" id="6503277">(</span><span class="ident" id="6503278">b</span><span class="op" id="6503279">[</span><span class="ident" id="6503280">i</span><span class="op" id="6503281">]</span><span class="op" id="6503282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503285">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503288">if</span>&nbsp;<span class="ident" id="6503291">csumcv</span><span class="op" id="6503297">&amp;</span><span class="num" id="6503298">1</span>&nbsp;<span class="op" id="6503300">==</span>&nbsp;<span class="num" id="6503303">0</span>&nbsp;<span class="op" id="6503305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503309">s</span>&nbsp;<span class="op" id="6503311">+=</span>&nbsp;<span class="builtintype" id="6503314">uint32</span><span class="op" id="6503320">(</span><span class="ident" id="6503321">b</span><span class="op" id="6503322">[</span><span class="ident" id="6503323">csumcv</span><span class="op" id="6503329">]</span><span class="op" id="6503330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503336">s</span>&nbsp;<span class="op" id="6503338">=</span>&nbsp;<span class="ident" id="6503340">s</span><span class="op" id="6503341">&gt;&gt;</span><span class="num" id="6503343">16</span>&nbsp;<span class="op" id="6503346">+</span>&nbsp;<span class="ident" id="6503348">s</span><span class="op" id="6503349">&amp;</span><span class="num" id="6503350">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503358">s</span>&nbsp;<span class="op" id="6503360">=</span>&nbsp;<span class="ident" id="6503362">s</span>&nbsp;<span class="op" id="6503364">+</span>&nbsp;<span class="ident" id="6503366">s</span><span class="op" id="6503367">&gt;&gt;</span><span class="num" id="6503369">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6503373">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6503428">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503472">b</span><span class="op" id="6503473">[</span><span class="num" id="6503474">2</span><span class="op" id="6503475">]</span>&nbsp;<span class="op" id="6503477">^=</span>&nbsp;<span class="builtintype" id="6503480">byte</span><span class="op" id="6503484">(</span><span class="op" id="6503485">^</span><span class="ident" id="6503486">s</span><span class="op" id="6503487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503490">b</span><span class="op" id="6503491">[</span><span class="num" id="6503492">3</span><span class="op" id="6503493">]</span>&nbsp;<span class="op" id="6503495">^=</span>&nbsp;<span class="builtintype" id="6503498">byte</span><span class="op" id="6503502">(</span><span class="op" id="6503503">^</span><span class="ident" id="6503504">s</span>&nbsp;<span class="op" id="6503506">&gt;&gt;</span>&nbsp;<span class="num" id="6503509">8</span><span class="op" id="6503510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503513">return</span>&nbsp;<span class="ident" id="6503520">b</span><span class="op" id="6503521">,</span>&nbsp;<span class="builtintype" id="6503523">nil</span><br>
<span class="lineno">60</span><span class="op" id="6503527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6503530">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6503579">func</span>&nbsp;<span class="ident" id="6503584">parseICMPMessage</span><span class="op" id="6503600">(</span><span class="ident" id="6503601">b</span>&nbsp;<span class="op" id="6503603">[</span><span class="op" id="6503604">]</span><span class="builtintype" id="6503605">byte</span><span class="op" id="6503609">)</span>&nbsp;<span class="op" id="6503611">(</span><span class="op" id="6503612">*</span><span class="ident" id="6503613">icmpMessage</span><span class="op" id="6503624">,</span>&nbsp;<span class="builtintype" id="6503626">error</span><span class="op" id="6503631">)</span>&nbsp;<span class="op" id="6503633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503636">msglen</span>&nbsp;<span class="op" id="6503643">:=</span>&nbsp;<span class="builtinfunc" id="6503646">len</span><span class="op" id="6503649">(</span><span class="ident" id="6503650">b</span><span class="op" id="6503651">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503654">if</span>&nbsp;<span class="ident" id="6503657">msglen</span>&nbsp;<span class="op" id="6503664">&lt;</span>&nbsp;<span class="num" id="6503666">4</span>&nbsp;<span class="op" id="6503668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503672">return</span>&nbsp;<span class="builtintype" id="6503679">nil</span><span class="op" id="6503682">,</span>&nbsp;<span class="ident" id="6503684">errors</span><span class="op" id="6503690">.</span><span class="ident" id="6503691">New</span><span class="op" id="6503694">(</span><span class="string" id="6503695">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="6503714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503720">m</span>&nbsp;<span class="op" id="6503722">:=</span>&nbsp;<span class="op" id="6503725">&amp;</span><span class="ident" id="6503726">icmpMessage</span><span class="op" id="6503737">{</span><span class="ident" id="6503738">Type</span><span class="op" id="6503742">:</span>&nbsp;<span class="builtintype" id="6503744">int</span><span class="op" id="6503747">(</span><span class="ident" id="6503748">b</span><span class="op" id="6503749">[</span><span class="num" id="6503750">0</span><span class="op" id="6503751">]</span><span class="op" id="6503752">)</span><span class="op" id="6503753">,</span>&nbsp;<span class="ident" id="6503755">Code</span><span class="op" id="6503759">:</span>&nbsp;<span class="builtintype" id="6503761">int</span><span class="op" id="6503764">(</span><span class="ident" id="6503765">b</span><span class="op" id="6503766">[</span><span class="num" id="6503767">1</span><span class="op" id="6503768">]</span><span class="op" id="6503769">)</span><span class="op" id="6503770">,</span>&nbsp;<span class="ident" id="6503772">Checksum</span><span class="op" id="6503780">:</span>&nbsp;<span class="builtintype" id="6503782">int</span><span class="op" id="6503785">(</span><span class="ident" id="6503786">b</span><span class="op" id="6503787">[</span><span class="num" id="6503788">2</span><span class="op" id="6503789">]</span><span class="op" id="6503790">)</span><span class="op" id="6503791">&lt;&lt;</span><span class="num" id="6503793">8</span>&nbsp;<span class="op" id="6503795">|</span>&nbsp;<span class="builtintype" id="6503797">int</span><span class="op" id="6503800">(</span><span class="ident" id="6503801">b</span><span class="op" id="6503802">[</span><span class="num" id="6503803">3</span><span class="op" id="6503804">]</span><span class="op" id="6503805">)</span><span class="op" id="6503806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503809">if</span>&nbsp;<span class="ident" id="6503812">msglen</span>&nbsp;<span class="op" id="6503819">&gt;</span>&nbsp;<span class="num" id="6503821">4</span>&nbsp;<span class="op" id="6503823">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503827">var</span>&nbsp;<span class="ident" id="6503831">err</span>&nbsp;<span class="builtintype" id="6503835">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503843">switch</span>&nbsp;<span class="ident" id="6503850">m</span><span class="op" id="6503851">.</span><span class="ident" id="6503852">Type</span>&nbsp;<span class="op" id="6503857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503861">case</span>&nbsp;<span class="ident" id="6503866">icmpv4EchoRequest</span><span class="op" id="6503883">,</span>&nbsp;<span class="ident" id="6503885">icmpv4EchoReply</span><span class="op" id="6503900">,</span>&nbsp;<span class="ident" id="6503902">icmpv6EchoRequest</span><span class="op" id="6503919">,</span>&nbsp;<span class="ident" id="6503921">icmpv6EchoReply</span><span class="op" id="6503936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503941">m</span><span class="op" id="6503942">.</span><span class="ident" id="6503943">Body</span><span class="op" id="6503947">,</span>&nbsp;<span class="ident" id="6503949">err</span>&nbsp;<span class="op" id="6503953">=</span>&nbsp;<span class="ident" id="6503955">parseICMPEcho</span><span class="op" id="6503968">(</span><span class="ident" id="6503969">b</span><span class="op" id="6503970">[</span><span class="num" id="6503971">4</span><span class="op" id="6503972">:</span><span class="op" id="6503973">]</span><span class="op" id="6503974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503979">if</span>&nbsp;<span class="ident" id="6503982">err</span>&nbsp;<span class="op" id="6503986">!=</span>&nbsp;<span class="builtintype" id="6503989">nil</span>&nbsp;<span class="op" id="6503993">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503999">return</span>&nbsp;<span class="builtintype" id="6504006">nil</span><span class="op" id="6504009">,</span>&nbsp;<span class="ident" id="6504011">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504028">return</span>&nbsp;<span class="ident" id="6504035">m</span><span class="op" id="6504036">,</span>&nbsp;<span class="builtintype" id="6504038">nil</span><br>
<span class="lineno">80</span><span class="op" id="6504042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6504045">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6504113">type</span>&nbsp;<span class="ident" id="6504118">icmpEcho</span>&nbsp;<span class="keyword" id="6504127">struct</span>&nbsp;<span class="op" id="6504134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504137">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6504142">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6504149">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504164">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="6504169">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6504176">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504196">Data</span>&nbsp;<span class="op" id="6504201">[</span><span class="op" id="6504202">]</span><span class="builtintype" id="6504203">byte</span>&nbsp;<span class="comment" id="6504208">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="6504216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6504219">func</span>&nbsp;<span class="op" id="6504224">(</span><span class="ident" id="6504225">p</span>&nbsp;<span class="op" id="6504227">*</span><span class="ident" id="6504228">icmpEcho</span><span class="op" id="6504236">)</span>&nbsp;<span class="ident" id="6504238">Len</span><span class="op" id="6504241">(</span><span class="op" id="6504242">)</span>&nbsp;<span class="builtintype" id="6504244">int</span>&nbsp;<span class="op" id="6504248">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504251">if</span>&nbsp;<span class="ident" id="6504254">p</span>&nbsp;<span class="op" id="6504256">==</span>&nbsp;<span class="builtintype" id="6504259">nil</span>&nbsp;<span class="op" id="6504263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504267">return</span>&nbsp;<span class="num" id="6504274">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504280">return</span>&nbsp;<span class="num" id="6504287">4</span>&nbsp;<span class="op" id="6504289">+</span>&nbsp;<span class="builtinfunc" id="6504291">len</span><span class="op" id="6504294">(</span><span class="ident" id="6504295">p</span><span class="op" id="6504296">.</span><span class="ident" id="6504297">Data</span><span class="op" id="6504301">)</span><br>
<span class="lineno"></span><span class="op" id="6504303">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6504306">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6504374">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6504399">func</span>&nbsp;<span class="op" id="6504404">(</span><span class="ident" id="6504405">p</span>&nbsp;<span class="op" id="6504407">*</span><span class="ident" id="6504408">icmpEcho</span><span class="op" id="6504416">)</span>&nbsp;<span class="ident" id="6504418">Marshal</span><span class="op" id="6504425">(</span><span class="op" id="6504426">)</span>&nbsp;<span class="op" id="6504428">(</span><span class="op" id="6504429">[</span><span class="op" id="6504430">]</span><span class="builtintype" id="6504431">byte</span><span class="op" id="6504435">,</span>&nbsp;<span class="builtintype" id="6504437">error</span><span class="op" id="6504442">)</span>&nbsp;<span class="op" id="6504444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504447">b</span>&nbsp;<span class="op" id="6504449">:=</span>&nbsp;<span class="builtinfunc" id="6504452">make</span><span class="op" id="6504456">(</span><span class="op" id="6504457">[</span><span class="op" id="6504458">]</span><span class="builtintype" id="6504459">byte</span><span class="op" id="6504463">,</span>&nbsp;<span class="num" id="6504465">4</span><span class="op" id="6504466">+</span><span class="builtinfunc" id="6504467">len</span><span class="op" id="6504470">(</span><span class="ident" id="6504471">p</span><span class="op" id="6504472">.</span><span class="ident" id="6504473">Data</span><span class="op" id="6504477">)</span><span class="op" id="6504478">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504481">b</span><span class="op" id="6504482">[</span><span class="num" id="6504483">0</span><span class="op" id="6504484">]</span><span class="op" id="6504485">,</span>&nbsp;<span class="ident" id="6504487">b</span><span class="op" id="6504488">[</span><span class="num" id="6504489">1</span><span class="op" id="6504490">]</span>&nbsp;<span class="op" id="6504492">=</span>&nbsp;<span class="builtintype" id="6504494">byte</span><span class="op" id="6504498">(</span><span class="ident" id="6504499">p</span><span class="op" id="6504500">.</span><span class="ident" id="6504501">ID</span><span class="op" id="6504503">&gt;&gt;</span><span class="num" id="6504505">8</span><span class="op" id="6504506">)</span><span class="op" id="6504507">,</span>&nbsp;<span class="builtintype" id="6504509">byte</span><span class="op" id="6504513">(</span><span class="ident" id="6504514">p</span><span class="op" id="6504515">.</span><span class="ident" id="6504516">ID</span><span class="op" id="6504518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504521">b</span><span class="op" id="6504522">[</span><span class="num" id="6504523">2</span><span class="op" id="6504524">]</span><span class="op" id="6504525">,</span>&nbsp;<span class="ident" id="6504527">b</span><span class="op" id="6504528">[</span><span class="num" id="6504529">3</span><span class="op" id="6504530">]</span>&nbsp;<span class="op" id="6504532">=</span>&nbsp;<span class="builtintype" id="6504534">byte</span><span class="op" id="6504538">(</span><span class="ident" id="6504539">p</span><span class="op" id="6504540">.</span><span class="ident" id="6504541">Seq</span><span class="op" id="6504544">&gt;&gt;</span><span class="num" id="6504546">8</span><span class="op" id="6504547">)</span><span class="op" id="6504548">,</span>&nbsp;<span class="builtintype" id="6504550">byte</span><span class="op" id="6504554">(</span><span class="ident" id="6504555">p</span><span class="op" id="6504556">.</span><span class="ident" id="6504557">Seq</span><span class="op" id="6504560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6504563">copy</span><span class="op" id="6504567">(</span><span class="ident" id="6504568">b</span><span class="op" id="6504569">[</span><span class="num" id="6504570">4</span><span class="op" id="6504571">:</span><span class="op" id="6504572">]</span><span class="op" id="6504573">,</span>&nbsp;<span class="ident" id="6504575">p</span><span class="op" id="6504576">.</span><span class="ident" id="6504577">Data</span><span class="op" id="6504581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504584">return</span>&nbsp;<span class="ident" id="6504591">b</span><span class="op" id="6504592">,</span>&nbsp;<span class="builtintype" id="6504594">nil</span><br>
<span class="lineno"></span><span class="op" id="6504598">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6504601">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="6504668">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6504677">func</span>&nbsp;<span class="ident" id="6504682">parseICMPEcho</span><span class="op" id="6504695">(</span><span class="ident" id="6504696">b</span>&nbsp;<span class="op" id="6504698">[</span><span class="op" id="6504699">]</span><span class="builtintype" id="6504700">byte</span><span class="op" id="6504704">)</span>&nbsp;<span class="op" id="6504706">(</span><span class="op" id="6504707">*</span><span class="ident" id="6504708">icmpEcho</span><span class="op" id="6504716">,</span>&nbsp;<span class="builtintype" id="6504718">error</span><span class="op" id="6504723">)</span>&nbsp;<span class="op" id="6504725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504728">bodylen</span>&nbsp;<span class="op" id="6504736">:=</span>&nbsp;<span class="builtinfunc" id="6504739">len</span><span class="op" id="6504742">(</span><span class="ident" id="6504743">b</span><span class="op" id="6504744">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504747">p</span>&nbsp;<span class="op" id="6504749">:=</span>&nbsp;<span class="op" id="6504752">&amp;</span><span class="ident" id="6504753">icmpEcho</span><span class="op" id="6504761">{</span><span class="ident" id="6504762">ID</span><span class="op" id="6504764">:</span>&nbsp;<span class="builtintype" id="6504766">int</span><span class="op" id="6504769">(</span><span class="ident" id="6504770">b</span><span class="op" id="6504771">[</span><span class="num" id="6504772">0</span><span class="op" id="6504773">]</span><span class="op" id="6504774">)</span><span class="op" id="6504775">&lt;&lt;</span><span class="num" id="6504777">8</span>&nbsp;<span class="op" id="6504779">|</span>&nbsp;<span class="builtintype" id="6504781">int</span><span class="op" id="6504784">(</span><span class="ident" id="6504785">b</span><span class="op" id="6504786">[</span><span class="num" id="6504787">1</span><span class="op" id="6504788">]</span><span class="op" id="6504789">)</span><span class="op" id="6504790">,</span>&nbsp;<span class="ident" id="6504792">Seq</span><span class="op" id="6504795">:</span>&nbsp;<span class="builtintype" id="6504797">int</span><span class="op" id="6504800">(</span><span class="ident" id="6504801">b</span><span class="op" id="6504802">[</span><span class="num" id="6504803">2</span><span class="op" id="6504804">]</span><span class="op" id="6504805">)</span><span class="op" id="6504806">&lt;&lt;</span><span class="num" id="6504808">8</span>&nbsp;<span class="op" id="6504810">|</span>&nbsp;<span class="builtintype" id="6504812">int</span><span class="op" id="6504815">(</span><span class="ident" id="6504816">b</span><span class="op" id="6504817">[</span><span class="num" id="6504818">3</span><span class="op" id="6504819">]</span><span class="op" id="6504820">)</span><span class="op" id="6504821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504824">if</span>&nbsp;<span class="ident" id="6504827">bodylen</span>&nbsp;<span class="op" id="6504835">&gt;</span>&nbsp;<span class="num" id="6504837">4</span>&nbsp;<span class="op" id="6504839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6504843">p</span><span class="op" id="6504844">.</span><span class="ident" id="6504845">Data</span>&nbsp;<span class="op" id="6504850">=</span>&nbsp;<span class="builtinfunc" id="6504852">make</span><span class="op" id="6504856">(</span><span class="op" id="6504857">[</span><span class="op" id="6504858">]</span><span class="builtintype" id="6504859">byte</span><span class="op" id="6504863">,</span>&nbsp;<span class="ident" id="6504865">bodylen</span><span class="op" id="6504872">-</span><span class="num" id="6504873">4</span><span class="op" id="6504874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6504878">copy</span><span class="op" id="6504882">(</span><span class="ident" id="6504883">p</span><span class="op" id="6504884">.</span><span class="ident" id="6504885">Data</span><span class="op" id="6504889">,</span>&nbsp;<span class="ident" id="6504891">b</span><span class="op" id="6504892">[</span><span class="num" id="6504893">4</span><span class="op" id="6504894">:</span><span class="op" id="6504895">]</span><span class="op" id="6504896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6504899">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6504902">return</span>&nbsp;<span class="ident" id="6504909">p</span><span class="op" id="6504910">,</span>&nbsp;<span class="builtintype" id="6504912">nil</span><br>
<span class="lineno"></span><span class="op" id="6504916">}</span>
</div>
</body>
</html>
