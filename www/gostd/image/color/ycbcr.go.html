<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3760243">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3760298">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3760352">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3760403">package</span>&nbsp;<span class="ident" id="3760411">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3760418">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="3760475">func</span>&nbsp;<span class="ident" id="3760480">RGBToYCbCr</span><span class="op" id="3760490">(</span><span class="ident" id="3760491">r</span><span class="op" id="3760492">,</span>&nbsp;<span class="ident" id="3760494">g</span><span class="op" id="3760495">,</span>&nbsp;<span class="ident" id="3760497">b</span>&nbsp;<span class="builtintype" id="3760499">uint8</span><span class="op" id="3760504">)</span>&nbsp;<span class="op" id="3760506">(</span><span class="builtintype" id="3760507">uint8</span><span class="op" id="3760512">,</span>&nbsp;<span class="builtintype" id="3760514">uint8</span><span class="op" id="3760519">,</span>&nbsp;<span class="builtintype" id="3760521">uint8</span><span class="op" id="3760526">)</span>&nbsp;<span class="op" id="3760528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760531">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760564">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760605">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760652">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3760699">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760766">r1</span>&nbsp;<span class="op" id="3760769">:=</span>&nbsp;<span class="builtintype" id="3760772">int</span><span class="op" id="3760775">(</span><span class="ident" id="3760776">r</span><span class="op" id="3760777">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760780">g1</span>&nbsp;<span class="op" id="3760783">:=</span>&nbsp;<span class="builtintype" id="3760786">int</span><span class="op" id="3760789">(</span><span class="ident" id="3760790">g</span><span class="op" id="3760791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760794">b1</span>&nbsp;<span class="op" id="3760797">:=</span>&nbsp;<span class="builtintype" id="3760800">int</span><span class="op" id="3760803">(</span><span class="ident" id="3760804">b</span><span class="op" id="3760805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760808">yy</span>&nbsp;<span class="op" id="3760811">:=</span>&nbsp;<span class="op" id="3760814">(</span><span class="num" id="3760815">19595</span><span class="op" id="3760820">*</span><span class="ident" id="3760821">r1</span>&nbsp;<span class="op" id="3760824">+</span>&nbsp;<span class="num" id="3760826">38470</span><span class="op" id="3760831">*</span><span class="ident" id="3760832">g1</span>&nbsp;<span class="op" id="3760835">+</span>&nbsp;<span class="num" id="3760837">7471</span><span class="op" id="3760841">*</span><span class="ident" id="3760842">b1</span>&nbsp;<span class="op" id="3760845">+</span>&nbsp;<span class="num" id="3760847">1</span><span class="op" id="3760848">&lt;&lt;</span><span class="num" id="3760850">15</span><span class="op" id="3760852">)</span>&nbsp;<span class="op" id="3760854">&gt;&gt;</span>&nbsp;<span class="num" id="3760857">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760861">cb</span>&nbsp;<span class="op" id="3760864">:=</span>&nbsp;<span class="op" id="3760867">(</span><span class="op" id="3760868">-</span><span class="num" id="3760869">11056</span><span class="op" id="3760874">*</span><span class="ident" id="3760875">r1</span>&nbsp;<span class="op" id="3760878">-</span>&nbsp;<span class="num" id="3760880">21712</span><span class="op" id="3760885">*</span><span class="ident" id="3760886">g1</span>&nbsp;<span class="op" id="3760889">+</span>&nbsp;<span class="num" id="3760891">32768</span><span class="op" id="3760896">*</span><span class="ident" id="3760897">b1</span>&nbsp;<span class="op" id="3760900">+</span>&nbsp;<span class="num" id="3760902">257</span><span class="op" id="3760905">&lt;&lt;</span><span class="num" id="3760907">15</span><span class="op" id="3760909">)</span>&nbsp;<span class="op" id="3760911">&gt;&gt;</span>&nbsp;<span class="num" id="3760914">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760918">cr</span>&nbsp;<span class="op" id="3760921">:=</span>&nbsp;<span class="op" id="3760924">(</span><span class="num" id="3760925">32768</span><span class="op" id="3760930">*</span><span class="ident" id="3760931">r1</span>&nbsp;<span class="op" id="3760934">-</span>&nbsp;<span class="num" id="3760936">27440</span><span class="op" id="3760941">*</span><span class="ident" id="3760942">g1</span>&nbsp;<span class="op" id="3760945">-</span>&nbsp;<span class="num" id="3760947">5328</span><span class="op" id="3760951">*</span><span class="ident" id="3760952">b1</span>&nbsp;<span class="op" id="3760955">+</span>&nbsp;<span class="num" id="3760957">257</span><span class="op" id="3760960">&lt;&lt;</span><span class="num" id="3760962">15</span><span class="op" id="3760964">)</span>&nbsp;<span class="op" id="3760966">&gt;&gt;</span>&nbsp;<span class="num" id="3760969">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3760973">if</span>&nbsp;<span class="ident" id="3760976">yy</span>&nbsp;<span class="op" id="3760979">&lt;</span>&nbsp;<span class="num" id="3760981">0</span>&nbsp;<span class="op" id="3760983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3760987">yy</span>&nbsp;<span class="op" id="3760990">=</span>&nbsp;<span class="num" id="3760992">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3760995">}</span>&nbsp;<span class="keyword" id="3760997">else</span>&nbsp;<span class="keyword" id="3761002">if</span>&nbsp;<span class="ident" id="3761005">yy</span>&nbsp;<span class="op" id="3761008">&gt;</span>&nbsp;<span class="num" id="3761010">255</span>&nbsp;<span class="op" id="3761014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761018">yy</span>&nbsp;<span class="op" id="3761021">=</span>&nbsp;<span class="num" id="3761023">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761028">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761031">if</span>&nbsp;<span class="ident" id="3761034">cb</span>&nbsp;<span class="op" id="3761037">&lt;</span>&nbsp;<span class="num" id="3761039">0</span>&nbsp;<span class="op" id="3761041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761045">cb</span>&nbsp;<span class="op" id="3761048">=</span>&nbsp;<span class="num" id="3761050">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761053">}</span>&nbsp;<span class="keyword" id="3761055">else</span>&nbsp;<span class="keyword" id="3761060">if</span>&nbsp;<span class="ident" id="3761063">cb</span>&nbsp;<span class="op" id="3761066">&gt;</span>&nbsp;<span class="num" id="3761068">255</span>&nbsp;<span class="op" id="3761072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761076">cb</span>&nbsp;<span class="op" id="3761079">=</span>&nbsp;<span class="num" id="3761081">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761086">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761089">if</span>&nbsp;<span class="ident" id="3761092">cr</span>&nbsp;<span class="op" id="3761095">&lt;</span>&nbsp;<span class="num" id="3761097">0</span>&nbsp;<span class="op" id="3761099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761103">cr</span>&nbsp;<span class="op" id="3761106">=</span>&nbsp;<span class="num" id="3761108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761111">}</span>&nbsp;<span class="keyword" id="3761113">else</span>&nbsp;<span class="keyword" id="3761118">if</span>&nbsp;<span class="ident" id="3761121">cr</span>&nbsp;<span class="op" id="3761124">&gt;</span>&nbsp;<span class="num" id="3761126">255</span>&nbsp;<span class="op" id="3761130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761134">cr</span>&nbsp;<span class="op" id="3761137">=</span>&nbsp;<span class="num" id="3761139">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761144">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761147">return</span>&nbsp;<span class="builtintype" id="3761154">uint8</span><span class="op" id="3761159">(</span><span class="ident" id="3761160">yy</span><span class="op" id="3761162">)</span><span class="op" id="3761163">,</span>&nbsp;<span class="builtintype" id="3761165">uint8</span><span class="op" id="3761170">(</span><span class="ident" id="3761171">cb</span><span class="op" id="3761173">)</span><span class="op" id="3761174">,</span>&nbsp;<span class="builtintype" id="3761176">uint8</span><span class="op" id="3761181">(</span><span class="ident" id="3761182">cr</span><span class="op" id="3761184">)</span><br>
<span class="lineno"></span><span class="op" id="3761186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3761189">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="3761246">func</span>&nbsp;<span class="ident" id="3761251">YCbCrToRGB</span><span class="op" id="3761261">(</span><span class="ident" id="3761262">y</span><span class="op" id="3761263">,</span>&nbsp;<span class="ident" id="3761265">cb</span><span class="op" id="3761267">,</span>&nbsp;<span class="ident" id="3761269">cr</span>&nbsp;<span class="builtintype" id="3761272">uint8</span><span class="op" id="3761277">)</span>&nbsp;<span class="op" id="3761279">(</span><span class="builtintype" id="3761280">uint8</span><span class="op" id="3761285">,</span>&nbsp;<span class="builtintype" id="3761287">uint8</span><span class="op" id="3761292">,</span>&nbsp;<span class="builtintype" id="3761294">uint8</span><span class="op" id="3761299">)</span>&nbsp;<span class="op" id="3761301">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761304">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761337">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761367">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761416">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3761446">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761513">yy1</span>&nbsp;<span class="op" id="3761517">:=</span>&nbsp;<span class="builtintype" id="3761520">int</span><span class="op" id="3761523">(</span><span class="ident" id="3761524">y</span><span class="op" id="3761525">)</span><span class="op" id="3761526">&lt;&lt;</span><span class="num" id="3761528">16</span>&nbsp;<span class="op" id="3761531">+</span>&nbsp;<span class="num" id="3761533">1</span><span class="op" id="3761534">&lt;&lt;</span><span class="num" id="3761536">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761540">cb1</span>&nbsp;<span class="op" id="3761544">:=</span>&nbsp;<span class="builtintype" id="3761547">int</span><span class="op" id="3761550">(</span><span class="ident" id="3761551">cb</span><span class="op" id="3761553">)</span>&nbsp;<span class="op" id="3761555">-</span>&nbsp;<span class="num" id="3761557">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761562">cr1</span>&nbsp;<span class="op" id="3761566">:=</span>&nbsp;<span class="builtintype" id="3761569">int</span><span class="op" id="3761572">(</span><span class="ident" id="3761573">cr</span><span class="op" id="3761575">)</span>&nbsp;<span class="op" id="3761577">-</span>&nbsp;<span class="num" id="3761579">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761584">r</span>&nbsp;<span class="op" id="3761586">:=</span>&nbsp;<span class="op" id="3761589">(</span><span class="ident" id="3761590">yy1</span>&nbsp;<span class="op" id="3761594">+</span>&nbsp;<span class="num" id="3761596">91881</span><span class="op" id="3761601">*</span><span class="ident" id="3761602">cr1</span><span class="op" id="3761605">)</span>&nbsp;<span class="op" id="3761607">&gt;&gt;</span>&nbsp;<span class="num" id="3761610">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761614">g</span>&nbsp;<span class="op" id="3761616">:=</span>&nbsp;<span class="op" id="3761619">(</span><span class="ident" id="3761620">yy1</span>&nbsp;<span class="op" id="3761624">-</span>&nbsp;<span class="num" id="3761626">22554</span><span class="op" id="3761631">*</span><span class="ident" id="3761632">cb1</span>&nbsp;<span class="op" id="3761636">-</span>&nbsp;<span class="num" id="3761638">46802</span><span class="op" id="3761643">*</span><span class="ident" id="3761644">cr1</span><span class="op" id="3761647">)</span>&nbsp;<span class="op" id="3761649">&gt;&gt;</span>&nbsp;<span class="num" id="3761652">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761656">b</span>&nbsp;<span class="op" id="3761658">:=</span>&nbsp;<span class="op" id="3761661">(</span><span class="ident" id="3761662">yy1</span>&nbsp;<span class="op" id="3761666">+</span>&nbsp;<span class="num" id="3761668">116130</span><span class="op" id="3761674">*</span><span class="ident" id="3761675">cb1</span><span class="op" id="3761678">)</span>&nbsp;<span class="op" id="3761680">&gt;&gt;</span>&nbsp;<span class="num" id="3761683">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761687">if</span>&nbsp;<span class="ident" id="3761690">r</span>&nbsp;<span class="op" id="3761692">&lt;</span>&nbsp;<span class="num" id="3761694">0</span>&nbsp;<span class="op" id="3761696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761700">r</span>&nbsp;<span class="op" id="3761702">=</span>&nbsp;<span class="num" id="3761704">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761707">}</span>&nbsp;<span class="keyword" id="3761709">else</span>&nbsp;<span class="keyword" id="3761714">if</span>&nbsp;<span class="ident" id="3761717">r</span>&nbsp;<span class="op" id="3761719">&gt;</span>&nbsp;<span class="num" id="3761721">255</span>&nbsp;<span class="op" id="3761725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761729">r</span>&nbsp;<span class="op" id="3761731">=</span>&nbsp;<span class="num" id="3761733">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761741">if</span>&nbsp;<span class="ident" id="3761744">g</span>&nbsp;<span class="op" id="3761746">&lt;</span>&nbsp;<span class="num" id="3761748">0</span>&nbsp;<span class="op" id="3761750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761754">g</span>&nbsp;<span class="op" id="3761756">=</span>&nbsp;<span class="num" id="3761758">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761761">}</span>&nbsp;<span class="keyword" id="3761763">else</span>&nbsp;<span class="keyword" id="3761768">if</span>&nbsp;<span class="ident" id="3761771">g</span>&nbsp;<span class="op" id="3761773">&gt;</span>&nbsp;<span class="num" id="3761775">255</span>&nbsp;<span class="op" id="3761779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761783">g</span>&nbsp;<span class="op" id="3761785">=</span>&nbsp;<span class="num" id="3761787">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761795">if</span>&nbsp;<span class="ident" id="3761798">b</span>&nbsp;<span class="op" id="3761800">&lt;</span>&nbsp;<span class="num" id="3761802">0</span>&nbsp;<span class="op" id="3761804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761808">b</span>&nbsp;<span class="op" id="3761810">=</span>&nbsp;<span class="num" id="3761812">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761815">}</span>&nbsp;<span class="keyword" id="3761817">else</span>&nbsp;<span class="keyword" id="3761822">if</span>&nbsp;<span class="ident" id="3761825">b</span>&nbsp;<span class="op" id="3761827">&gt;</span>&nbsp;<span class="num" id="3761829">255</span>&nbsp;<span class="op" id="3761833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3761837">b</span>&nbsp;<span class="op" id="3761839">=</span>&nbsp;<span class="num" id="3761841">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3761846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3761849">return</span>&nbsp;<span class="builtintype" id="3761856">uint8</span><span class="op" id="3761861">(</span><span class="ident" id="3761862">r</span><span class="op" id="3761863">)</span><span class="op" id="3761864">,</span>&nbsp;<span class="builtintype" id="3761866">uint8</span><span class="op" id="3761871">(</span><span class="ident" id="3761872">g</span><span class="op" id="3761873">)</span><span class="op" id="3761874">,</span>&nbsp;<span class="builtintype" id="3761876">uint8</span><span class="op" id="3761881">(</span><span class="ident" id="3761882">b</span><span class="op" id="3761883">)</span><br>
<span class="lineno"></span><span class="op" id="3761885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3761888">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="3761967">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="3762006">//</span><br>
<span class="lineno"></span><span class="comment" id="3762009">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="3762083">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="3762158">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="3762236">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="3762289">//</span><br>
<span class="lineno"></span><span class="comment" id="3762292">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="3762371">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="3762446">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="3762518">type</span>&nbsp;<span class="ident" id="3762523">YCbCr</span>&nbsp;<span class="keyword" id="3762529">struct</span>&nbsp;<span class="op" id="3762536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762539">Y</span><span class="op" id="3762540">,</span>&nbsp;<span class="ident" id="3762542">Cb</span><span class="op" id="3762544">,</span>&nbsp;<span class="ident" id="3762546">Cr</span>&nbsp;<span class="builtintype" id="3762549">uint8</span><br>
<span class="lineno"></span><span class="op" id="3762555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3762558">func</span>&nbsp;<span class="op" id="3762563">(</span><span class="ident" id="3762564">c</span>&nbsp;<span class="ident" id="3762566">YCbCr</span><span class="op" id="3762571">)</span>&nbsp;<span class="ident" id="3762573">RGBA</span><span class="op" id="3762577">(</span><span class="op" id="3762578">)</span>&nbsp;<span class="op" id="3762580">(</span><span class="builtintype" id="3762581">uint32</span><span class="op" id="3762587">,</span>&nbsp;<span class="builtintype" id="3762589">uint32</span><span class="op" id="3762595">,</span>&nbsp;<span class="builtintype" id="3762597">uint32</span><span class="op" id="3762603">,</span>&nbsp;<span class="builtintype" id="3762605">uint32</span><span class="op" id="3762611">)</span>&nbsp;<span class="op" id="3762613">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762616">r</span><span class="op" id="3762617">,</span>&nbsp;<span class="ident" id="3762619">g</span><span class="op" id="3762620">,</span>&nbsp;<span class="ident" id="3762622">b</span>&nbsp;<span class="op" id="3762624">:=</span>&nbsp;<span class="ident" id="3762627">YCbCrToRGB</span><span class="op" id="3762637">(</span><span class="ident" id="3762638">c</span><span class="op" id="3762639">.</span><span class="ident" id="3762640">Y</span><span class="op" id="3762641">,</span>&nbsp;<span class="ident" id="3762643">c</span><span class="op" id="3762644">.</span><span class="ident" id="3762645">Cb</span><span class="op" id="3762647">,</span>&nbsp;<span class="ident" id="3762649">c</span><span class="op" id="3762650">.</span><span class="ident" id="3762651">Cr</span><span class="op" id="3762653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762656">return</span>&nbsp;<span class="builtintype" id="3762663">uint32</span><span class="op" id="3762669">(</span><span class="ident" id="3762670">r</span><span class="op" id="3762671">)</span>&nbsp;<span class="op" id="3762673">*</span>&nbsp;<span class="num" id="3762675">0x101</span><span class="op" id="3762680">,</span>&nbsp;<span class="builtintype" id="3762682">uint32</span><span class="op" id="3762688">(</span><span class="ident" id="3762689">g</span><span class="op" id="3762690">)</span>&nbsp;<span class="op" id="3762692">*</span>&nbsp;<span class="num" id="3762694">0x101</span><span class="op" id="3762699">,</span>&nbsp;<span class="builtintype" id="3762701">uint32</span><span class="op" id="3762707">(</span><span class="ident" id="3762708">b</span><span class="op" id="3762709">)</span>&nbsp;<span class="op" id="3762711">*</span>&nbsp;<span class="num" id="3762713">0x101</span><span class="op" id="3762718">,</span>&nbsp;<span class="num" id="3762720">0xffff</span><br>
<span class="lineno"></span><span class="op" id="3762727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762730">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="3762776">var</span>&nbsp;<span class="ident" id="3762780">YCbCrModel</span>&nbsp;<span class="ident" id="3762791">Model</span>&nbsp;<span class="op" id="3762797">=</span>&nbsp;<span class="ident" id="3762799">ModelFunc</span><span class="op" id="3762808">(</span><span class="ident" id="3762809">yCbCrModel</span><span class="op" id="3762819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3762822">func</span>&nbsp;<span class="ident" id="3762827">yCbCrModel</span><span class="op" id="3762837">(</span><span class="ident" id="3762838">c</span>&nbsp;<span class="ident" id="3762840">Color</span><span class="op" id="3762845">)</span>&nbsp;<span class="ident" id="3762847">Color</span>&nbsp;<span class="op" id="3762853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762856">if</span>&nbsp;<span class="ident" id="3762859">_</span><span class="op" id="3762860">,</span>&nbsp;<span class="ident" id="3762862">ok</span>&nbsp;<span class="op" id="3762865">:=</span>&nbsp;<span class="ident" id="3762868">c</span><span class="op" id="3762869">.</span><span class="op" id="3762870">(</span><span class="ident" id="3762871">YCbCr</span><span class="op" id="3762876">)</span><span class="op" id="3762877">;</span>&nbsp;<span class="ident" id="3762879">ok</span>&nbsp;<span class="op" id="3762882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762886">return</span>&nbsp;<span class="ident" id="3762893">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3762896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762899">r</span><span class="op" id="3762900">,</span>&nbsp;<span class="ident" id="3762902">g</span><span class="op" id="3762903">,</span>&nbsp;<span class="ident" id="3762905">b</span><span class="op" id="3762906">,</span>&nbsp;<span class="ident" id="3762908">_</span>&nbsp;<span class="op" id="3762910">:=</span>&nbsp;<span class="ident" id="3762913">c</span><span class="op" id="3762914">.</span><span class="ident" id="3762915">RGBA</span><span class="op" id="3762919">(</span><span class="op" id="3762920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3762923">y</span><span class="op" id="3762924">,</span>&nbsp;<span class="ident" id="3762926">u</span><span class="op" id="3762927">,</span>&nbsp;<span class="ident" id="3762929">v</span>&nbsp;<span class="op" id="3762931">:=</span>&nbsp;<span class="ident" id="3762934">RGBToYCbCr</span><span class="op" id="3762944">(</span><span class="builtintype" id="3762945">uint8</span><span class="op" id="3762950">(</span><span class="ident" id="3762951">r</span><span class="op" id="3762952">&gt;&gt;</span><span class="num" id="3762954">8</span><span class="op" id="3762955">)</span><span class="op" id="3762956">,</span>&nbsp;<span class="builtintype" id="3762958">uint8</span><span class="op" id="3762963">(</span><span class="ident" id="3762964">g</span><span class="op" id="3762965">&gt;&gt;</span><span class="num" id="3762967">8</span><span class="op" id="3762968">)</span><span class="op" id="3762969">,</span>&nbsp;<span class="builtintype" id="3762971">uint8</span><span class="op" id="3762976">(</span><span class="ident" id="3762977">b</span><span class="op" id="3762978">&gt;&gt;</span><span class="num" id="3762980">8</span><span class="op" id="3762981">)</span><span class="op" id="3762982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3762985">return</span>&nbsp;<span class="ident" id="3762992">YCbCr</span><span class="op" id="3762997">{</span><span class="ident" id="3762998">y</span><span class="op" id="3762999">,</span>&nbsp;<span class="ident" id="3763001">u</span><span class="op" id="3763002">,</span>&nbsp;<span class="ident" id="3763004">v</span><span class="op" id="3763005">}</span><br>
<span class="lineno"></span><span class="op" id="3763007">}</span>
</div>
</body>
</html>
