<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html" class="current">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6638318">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6638373">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6638427">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6638478">package</span>&nbsp;<span class="ident" id="6638486">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6638494">import</span>&nbsp;<span class="op" id="6638501">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638504">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638513">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638520">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638530">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638542">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638548">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638559">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6638569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6638572">var</span>&nbsp;<span class="ident" id="6638576">fset</span>&nbsp;<span class="op" id="6638581">=</span>&nbsp;<span class="ident" id="6638583">token</span><span class="op" id="6638588">.</span><span class="ident" id="6638589">NewFileSet</span><span class="op" id="6638599">(</span><span class="op" id="6638600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6638603">var</span>&nbsp;<span class="ident" id="6638607">validFiles</span>&nbsp;<span class="op" id="6638618">=</span>&nbsp;<span class="op" id="6638620">[</span><span class="op" id="6638621">]</span><span class="builtintype" id="6638622">string</span><span class="op" id="6638628">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638631">&#34;parser.go&#34;</span><span class="op" id="6638642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638645">&#34;parser_test.go&#34;</span><span class="op" id="6638661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638664">&#34;error_test.go&#34;</span><span class="op" id="6638679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6638682">&#34;short_test.go&#34;</span><span class="op" id="6638697">,</span><br>
<span class="lineno"></span><span class="op" id="6638699">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6638702">func</span>&nbsp;<span class="ident" id="6638707">TestParse</span><span class="op" id="6638716">(</span><span class="ident" id="6638717">t</span>&nbsp;<span class="op" id="6638719">*</span><span class="ident" id="6638720">testing</span><span class="op" id="6638727">.</span><span class="ident" id="6638728">T</span><span class="op" id="6638729">)</span>&nbsp;<span class="op" id="6638731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6638734">for</span>&nbsp;<span class="ident" id="6638738">_</span><span class="op" id="6638739">,</span>&nbsp;<span class="ident" id="6638741">filename</span>&nbsp;<span class="op" id="6638750">:=</span>&nbsp;<span class="keyword" id="6638753">range</span>&nbsp;<span class="ident" id="6638759">validFiles</span>&nbsp;<span class="op" id="6638770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6638774">_</span><span class="op" id="6638775">,</span>&nbsp;<span class="ident" id="6638777">err</span>&nbsp;<span class="op" id="6638781">:=</span>&nbsp;<span class="ident" id="6638784">ParseFile</span><span class="op" id="6638793">(</span><span class="ident" id="6638794">fset</span><span class="op" id="6638798">,</span>&nbsp;<span class="ident" id="6638800">filename</span><span class="op" id="6638808">,</span>&nbsp;<span class="builtintype" id="6638810">nil</span><span class="op" id="6638813">,</span>&nbsp;<span class="ident" id="6638815">DeclarationErrors</span><span class="op" id="6638832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6638836">if</span>&nbsp;<span class="ident" id="6638839">err</span>&nbsp;<span class="op" id="6638843">!=</span>&nbsp;<span class="builtintype" id="6638846">nil</span>&nbsp;<span class="op" id="6638850">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6638855">t</span><span class="op" id="6638856">.</span><span class="ident" id="6638857">Fatalf</span><span class="op" id="6638863">(</span><span class="string" id="6638864">&#34;ParseFile(%s):&nbsp;%v&#34;</span><span class="op" id="6638883">,</span>&nbsp;<span class="ident" id="6638885">filename</span><span class="op" id="6638893">,</span>&nbsp;<span class="ident" id="6638895">err</span><span class="op" id="6638898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6638902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6638905">}</span><br>
<span class="lineno"></span><span class="op" id="6638907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6638910">func</span>&nbsp;<span class="ident" id="6638915">nameFilter</span><span class="op" id="6638925">(</span><span class="ident" id="6638926">filename</span>&nbsp;<span class="builtintype" id="6638935">string</span><span class="op" id="6638941">)</span>&nbsp;<span class="builtintype" id="6638943">bool</span>&nbsp;<span class="op" id="6638948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6638951">switch</span>&nbsp;<span class="ident" id="6638958">filename</span>&nbsp;<span class="op" id="6638967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6638970">case</span>&nbsp;<span class="string" id="6638975">&#34;parser.go&#34;</span><span class="op" id="6638986">,</span>&nbsp;<span class="string" id="6638988">&#34;interface.go&#34;</span><span class="op" id="6639002">,</span>&nbsp;<span class="string" id="6639004">&#34;parser_test.go&#34;</span><span class="op" id="6639020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639024">return</span>&nbsp;<span class="builtintype" id="6639031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639037">case</span>&nbsp;<span class="string" id="6639042">&#34;parser.go.orig&#34;</span><span class="op" id="6639058">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639062">return</span>&nbsp;<span class="builtintype" id="6639069">true</span>&nbsp;<span class="comment" id="6639074">//&nbsp;permit&nbsp;but&nbsp;should&nbsp;be&nbsp;ignored&nbsp;by&nbsp;ParseDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639122">return</span>&nbsp;<span class="builtintype" id="6639129">false</span><br>
<span class="lineno"></span><span class="op" id="6639135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6639138">func</span>&nbsp;<span class="ident" id="6639143">dirFilter</span><span class="op" id="6639152">(</span><span class="ident" id="6639153">f</span>&nbsp;<span class="ident" id="6639155">os</span><span class="op" id="6639157">.</span><span class="ident" id="6639158">FileInfo</span><span class="op" id="6639166">)</span>&nbsp;<span class="builtintype" id="6639168">bool</span>&nbsp;<span class="op" id="6639173">{</span>&nbsp;<span class="keyword" id="6639175">return</span>&nbsp;<span class="ident" id="6639182">nameFilter</span><span class="op" id="6639192">(</span><span class="ident" id="6639193">f</span><span class="op" id="6639194">.</span><span class="ident" id="6639195">Name</span><span class="op" id="6639199">(</span><span class="op" id="6639200">)</span><span class="op" id="6639201">)</span>&nbsp;<span class="op" id="6639203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6639206">func</span>&nbsp;<span class="ident" id="6639211">TestParseDir</span><span class="op" id="6639223">(</span><span class="ident" id="6639224">t</span>&nbsp;<span class="op" id="6639226">*</span><span class="ident" id="6639227">testing</span><span class="op" id="6639234">.</span><span class="ident" id="6639235">T</span><span class="op" id="6639236">)</span>&nbsp;<span class="op" id="6639238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639241">path</span>&nbsp;<span class="op" id="6639246">:=</span>&nbsp;<span class="string" id="6639249">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639254">pkgs</span><span class="op" id="6639258">,</span>&nbsp;<span class="ident" id="6639260">err</span>&nbsp;<span class="op" id="6639264">:=</span>&nbsp;<span class="ident" id="6639267">ParseDir</span><span class="op" id="6639275">(</span><span class="ident" id="6639276">fset</span><span class="op" id="6639280">,</span>&nbsp;<span class="ident" id="6639282">path</span><span class="op" id="6639286">,</span>&nbsp;<span class="ident" id="6639288">dirFilter</span><span class="op" id="6639297">,</span>&nbsp;<span class="num" id="6639299">0</span><span class="op" id="6639300">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639303">if</span>&nbsp;<span class="ident" id="6639306">err</span>&nbsp;<span class="op" id="6639310">!=</span>&nbsp;<span class="builtintype" id="6639313">nil</span>&nbsp;<span class="op" id="6639317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639321">t</span><span class="op" id="6639322">.</span><span class="ident" id="6639323">Fatalf</span><span class="op" id="6639329">(</span><span class="string" id="6639330">&#34;ParseDir(%s):&nbsp;%v&#34;</span><span class="op" id="6639348">,</span>&nbsp;<span class="ident" id="6639350">path</span><span class="op" id="6639354">,</span>&nbsp;<span class="ident" id="6639356">err</span><span class="op" id="6639359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639365">if</span>&nbsp;<span class="ident" id="6639368">n</span>&nbsp;<span class="op" id="6639370">:=</span>&nbsp;<span class="builtinfunc" id="6639373">len</span><span class="op" id="6639376">(</span><span class="ident" id="6639377">pkgs</span><span class="op" id="6639381">)</span><span class="op" id="6639382">;</span>&nbsp;<span class="ident" id="6639384">n</span>&nbsp;<span class="op" id="6639386">!=</span>&nbsp;<span class="num" id="6639389">1</span>&nbsp;<span class="op" id="6639391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639395">t</span><span class="op" id="6639396">.</span><span class="ident" id="6639397">Errorf</span><span class="op" id="6639403">(</span><span class="string" id="6639404">&#34;got&nbsp;%d&nbsp;packages;&nbsp;want&nbsp;1&#34;</span><span class="op" id="6639429">,</span>&nbsp;<span class="ident" id="6639431">n</span><span class="op" id="6639432">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639438">pkg</span>&nbsp;<span class="op" id="6639442">:=</span>&nbsp;<span class="ident" id="6639445">pkgs</span><span class="op" id="6639449">[</span><span class="string" id="6639450">&#34;parser&#34;</span><span class="op" id="6639458">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639461">if</span>&nbsp;<span class="ident" id="6639464">pkg</span>&nbsp;<span class="op" id="6639468">==</span>&nbsp;<span class="builtintype" id="6639471">nil</span>&nbsp;<span class="op" id="6639475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639479">t</span><span class="op" id="6639480">.</span><span class="ident" id="6639481">Errorf</span><span class="op" id="6639487">(</span><span class="string" id="6639488">`package&nbsp;&#34;parser&#34;&nbsp;not&nbsp;found`</span><span class="op" id="6639516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639520">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639531">if</span>&nbsp;<span class="ident" id="6639534">n</span>&nbsp;<span class="op" id="6639536">:=</span>&nbsp;<span class="builtinfunc" id="6639539">len</span><span class="op" id="6639542">(</span><span class="ident" id="6639543">pkg</span><span class="op" id="6639546">.</span><span class="ident" id="6639547">Files</span><span class="op" id="6639552">)</span><span class="op" id="6639553">;</span>&nbsp;<span class="ident" id="6639555">n</span>&nbsp;<span class="op" id="6639557">!=</span>&nbsp;<span class="num" id="6639560">3</span>&nbsp;<span class="op" id="6639562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639566">t</span><span class="op" id="6639567">.</span><span class="ident" id="6639568">Errorf</span><span class="op" id="6639574">(</span><span class="string" id="6639575">&#34;got&nbsp;%d&nbsp;package&nbsp;files;&nbsp;want&nbsp;3&#34;</span><span class="op" id="6639605">,</span>&nbsp;<span class="ident" id="6639607">n</span><span class="op" id="6639608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639614">for</span>&nbsp;<span class="ident" id="6639618">filename</span>&nbsp;<span class="op" id="6639627">:=</span>&nbsp;<span class="keyword" id="6639630">range</span>&nbsp;<span class="ident" id="6639636">pkg</span><span class="op" id="6639639">.</span><span class="ident" id="6639640">Files</span>&nbsp;<span class="op" id="6639646">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639650">if</span>&nbsp;<span class="op" id="6639653">!</span><span class="ident" id="6639654">nameFilter</span><span class="op" id="6639664">(</span><span class="ident" id="6639665">filename</span><span class="op" id="6639673">)</span>&nbsp;<span class="op" id="6639675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639680">t</span><span class="op" id="6639681">.</span><span class="ident" id="6639682">Errorf</span><span class="op" id="6639688">(</span><span class="string" id="6639689">&#34;unexpected&nbsp;package&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="6639718">,</span>&nbsp;<span class="ident" id="6639720">filename</span><span class="op" id="6639728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639735">}</span><br>
<span class="lineno"></span><span class="op" id="6639737">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6639740">func</span>&nbsp;<span class="ident" id="6639745">TestParseExpr</span><span class="op" id="6639758">(</span><span class="ident" id="6639759">t</span>&nbsp;<span class="op" id="6639761">*</span><span class="ident" id="6639762">testing</span><span class="op" id="6639769">.</span><span class="ident" id="6639770">T</span><span class="op" id="6639771">)</span>&nbsp;<span class="op" id="6639773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6639776">//&nbsp;just&nbsp;kicking&nbsp;the&nbsp;tires:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6639804">//&nbsp;a&nbsp;valid&nbsp;arithmetic&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639838">src</span>&nbsp;<span class="op" id="6639842">:=</span>&nbsp;<span class="string" id="6639845">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639854">x</span><span class="op" id="6639855">,</span>&nbsp;<span class="ident" id="6639857">err</span>&nbsp;<span class="op" id="6639861">:=</span>&nbsp;<span class="ident" id="6639864">ParseExpr</span><span class="op" id="6639873">(</span><span class="ident" id="6639874">src</span><span class="op" id="6639877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639880">if</span>&nbsp;<span class="ident" id="6639883">err</span>&nbsp;<span class="op" id="6639887">!=</span>&nbsp;<span class="builtintype" id="6639890">nil</span>&nbsp;<span class="op" id="6639894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639898">t</span><span class="op" id="6639899">.</span><span class="ident" id="6639900">Errorf</span><span class="op" id="6639906">(</span><span class="string" id="6639907">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="6639926">,</span>&nbsp;<span class="ident" id="6639928">src</span><span class="op" id="6639931">,</span>&nbsp;<span class="ident" id="6639933">err</span><span class="op" id="6639936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6639942">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6639959">if</span>&nbsp;<span class="ident" id="6639962">_</span><span class="op" id="6639963">,</span>&nbsp;<span class="ident" id="6639965">ok</span>&nbsp;<span class="op" id="6639968">:=</span>&nbsp;<span class="ident" id="6639971">x</span><span class="op" id="6639972">.</span><span class="op" id="6639973">(</span><span class="op" id="6639974">*</span><span class="ident" id="6639975">ast</span><span class="op" id="6639978">.</span><span class="ident" id="6639979">BinaryExpr</span><span class="op" id="6639989">)</span><span class="op" id="6639990">;</span>&nbsp;<span class="op" id="6639992">!</span><span class="ident" id="6639993">ok</span>&nbsp;<span class="op" id="6639996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640000">t</span><span class="op" id="6640001">.</span><span class="ident" id="6640002">Errorf</span><span class="op" id="6640008">(</span><span class="string" id="6640009">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.BinaryExpr&#34;</span><span class="op" id="6640054">,</span>&nbsp;<span class="ident" id="6640056">src</span><span class="op" id="6640059">,</span>&nbsp;<span class="ident" id="6640061">x</span><span class="op" id="6640062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6640069">//&nbsp;a&nbsp;valid&nbsp;type&nbsp;expression</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640097">src</span>&nbsp;<span class="op" id="6640101">=</span>&nbsp;<span class="string" id="6640103">&#34;struct{x&nbsp;*int}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640121">x</span><span class="op" id="6640122">,</span>&nbsp;<span class="ident" id="6640124">err</span>&nbsp;<span class="op" id="6640128">=</span>&nbsp;<span class="ident" id="6640130">ParseExpr</span><span class="op" id="6640139">(</span><span class="ident" id="6640140">src</span><span class="op" id="6640143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640146">if</span>&nbsp;<span class="ident" id="6640149">err</span>&nbsp;<span class="op" id="6640153">!=</span>&nbsp;<span class="builtintype" id="6640156">nil</span>&nbsp;<span class="op" id="6640160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640164">t</span><span class="op" id="6640165">.</span><span class="ident" id="6640166">Errorf</span><span class="op" id="6640172">(</span><span class="string" id="6640173">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="6640192">,</span>&nbsp;<span class="ident" id="6640194">src</span><span class="op" id="6640197">,</span>&nbsp;<span class="ident" id="6640199">err</span><span class="op" id="6640202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640205">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6640208">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640225">if</span>&nbsp;<span class="ident" id="6640228">_</span><span class="op" id="6640229">,</span>&nbsp;<span class="ident" id="6640231">ok</span>&nbsp;<span class="op" id="6640234">:=</span>&nbsp;<span class="ident" id="6640237">x</span><span class="op" id="6640238">.</span><span class="op" id="6640239">(</span><span class="op" id="6640240">*</span><span class="ident" id="6640241">ast</span><span class="op" id="6640244">.</span><span class="ident" id="6640245">StructType</span><span class="op" id="6640255">)</span><span class="op" id="6640256">;</span>&nbsp;<span class="op" id="6640258">!</span><span class="ident" id="6640259">ok</span>&nbsp;<span class="op" id="6640262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640266">t</span><span class="op" id="6640267">.</span><span class="ident" id="6640268">Errorf</span><span class="op" id="6640274">(</span><span class="string" id="6640275">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.StructType&#34;</span><span class="op" id="6640320">,</span>&nbsp;<span class="ident" id="6640322">src</span><span class="op" id="6640325">,</span>&nbsp;<span class="ident" id="6640327">x</span><span class="op" id="6640328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6640335">//&nbsp;an&nbsp;invalid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640361">src</span>&nbsp;<span class="op" id="6640365">=</span>&nbsp;<span class="string" id="6640367">&#34;a&nbsp;+&nbsp;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640376">if</span>&nbsp;<span class="ident" id="6640379">_</span><span class="op" id="6640380">,</span>&nbsp;<span class="ident" id="6640382">err</span>&nbsp;<span class="op" id="6640386">:=</span>&nbsp;<span class="ident" id="6640389">ParseExpr</span><span class="op" id="6640398">(</span><span class="ident" id="6640399">src</span><span class="op" id="6640402">)</span><span class="op" id="6640403">;</span>&nbsp;<span class="ident" id="6640405">err</span>&nbsp;<span class="op" id="6640409">==</span>&nbsp;<span class="builtintype" id="6640412">nil</span>&nbsp;<span class="op" id="6640416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640420">t</span><span class="op" id="6640421">.</span><span class="ident" id="6640422">Errorf</span><span class="op" id="6640428">(</span><span class="string" id="6640429">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="6640458">,</span>&nbsp;<span class="ident" id="6640460">src</span><span class="op" id="6640463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640466">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6640470">//&nbsp;a&nbsp;valid&nbsp;expression&nbsp;followed&nbsp;by&nbsp;extra&nbsp;tokens&nbsp;is&nbsp;invalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640529">src</span>&nbsp;<span class="op" id="6640533">=</span>&nbsp;<span class="string" id="6640535">&#34;a[i]&nbsp;:=&nbsp;x&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640548">if</span>&nbsp;<span class="ident" id="6640551">_</span><span class="op" id="6640552">,</span>&nbsp;<span class="ident" id="6640554">err</span>&nbsp;<span class="op" id="6640558">:=</span>&nbsp;<span class="ident" id="6640561">ParseExpr</span><span class="op" id="6640570">(</span><span class="ident" id="6640571">src</span><span class="op" id="6640574">)</span><span class="op" id="6640575">;</span>&nbsp;<span class="ident" id="6640577">err</span>&nbsp;<span class="op" id="6640581">==</span>&nbsp;<span class="builtintype" id="6640584">nil</span>&nbsp;<span class="op" id="6640588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640592">t</span><span class="op" id="6640593">.</span><span class="ident" id="6640594">Errorf</span><span class="op" id="6640600">(</span><span class="string" id="6640601">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="6640630">,</span>&nbsp;<span class="ident" id="6640632">src</span><span class="op" id="6640635">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6640642">//&nbsp;a&nbsp;semicolon&nbsp;is&nbsp;not&nbsp;permitted&nbsp;unless&nbsp;automatically&nbsp;inserted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640705">src</span>&nbsp;<span class="op" id="6640709">=</span>&nbsp;<span class="string" id="6640711">&#34;a&nbsp;+&nbsp;b\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640722">if</span>&nbsp;<span class="ident" id="6640725">_</span><span class="op" id="6640726">,</span>&nbsp;<span class="ident" id="6640728">err</span>&nbsp;<span class="op" id="6640732">:=</span>&nbsp;<span class="ident" id="6640735">ParseExpr</span><span class="op" id="6640744">(</span><span class="ident" id="6640745">src</span><span class="op" id="6640748">)</span><span class="op" id="6640749">;</span>&nbsp;<span class="ident" id="6640751">err</span>&nbsp;<span class="op" id="6640755">!=</span>&nbsp;<span class="builtintype" id="6640758">nil</span>&nbsp;<span class="op" id="6640762">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640766">t</span><span class="op" id="6640767">.</span><span class="ident" id="6640768">Errorf</span><span class="op" id="6640774">(</span><span class="string" id="6640775">&#34;ParseExpr(%q):&nbsp;got&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6640804">,</span>&nbsp;<span class="ident" id="6640806">src</span><span class="op" id="6640809">,</span>&nbsp;<span class="ident" id="6640811">err</span><span class="op" id="6640814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640820">src</span>&nbsp;<span class="op" id="6640824">=</span>&nbsp;<span class="string" id="6640826">&#34;a&nbsp;+&nbsp;b;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640836">if</span>&nbsp;<span class="ident" id="6640839">_</span><span class="op" id="6640840">,</span>&nbsp;<span class="ident" id="6640842">err</span>&nbsp;<span class="op" id="6640846">:=</span>&nbsp;<span class="ident" id="6640849">ParseExpr</span><span class="op" id="6640858">(</span><span class="ident" id="6640859">src</span><span class="op" id="6640862">)</span><span class="op" id="6640863">;</span>&nbsp;<span class="ident" id="6640865">err</span>&nbsp;<span class="op" id="6640869">==</span>&nbsp;<span class="builtintype" id="6640872">nil</span>&nbsp;<span class="op" id="6640876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640880">t</span><span class="op" id="6640881">.</span><span class="ident" id="6640882">Errorf</span><span class="op" id="6640888">(</span><span class="string" id="6640889">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="6640918">,</span>&nbsp;<span class="ident" id="6640920">src</span><span class="op" id="6640923">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6640930">//&nbsp;various&nbsp;other&nbsp;stuff&nbsp;following&nbsp;a&nbsp;valid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6640983">const</span>&nbsp;<span class="ident" id="6640989">validExpr</span>&nbsp;<span class="op" id="6640999">=</span>&nbsp;<span class="string" id="6641001">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641010">const</span>&nbsp;<span class="ident" id="6641016">anything</span>&nbsp;<span class="op" id="6641025">=</span>&nbsp;<span class="string" id="6641027">&#34;dh3*#D)#_&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641040">for</span>&nbsp;<span class="ident" id="6641044">_</span><span class="op" id="6641045">,</span>&nbsp;<span class="ident" id="6641047">c</span>&nbsp;<span class="op" id="6641049">:=</span>&nbsp;<span class="keyword" id="6641052">range</span>&nbsp;<span class="string" id="6641058">&#34;!)]};,&#34;</span>&nbsp;<span class="op" id="6641067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641071">src</span>&nbsp;<span class="op" id="6641075">:=</span>&nbsp;<span class="ident" id="6641078">validExpr</span>&nbsp;<span class="op" id="6641088">+</span>&nbsp;<span class="builtintype" id="6641090">string</span><span class="op" id="6641096">(</span><span class="ident" id="6641097">c</span><span class="op" id="6641098">)</span>&nbsp;<span class="op" id="6641100">+</span>&nbsp;<span class="ident" id="6641102">anything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641113">if</span>&nbsp;<span class="ident" id="6641116">_</span><span class="op" id="6641117">,</span>&nbsp;<span class="ident" id="6641119">err</span>&nbsp;<span class="op" id="6641123">:=</span>&nbsp;<span class="ident" id="6641126">ParseExpr</span><span class="op" id="6641135">(</span><span class="ident" id="6641136">src</span><span class="op" id="6641139">)</span><span class="op" id="6641140">;</span>&nbsp;<span class="ident" id="6641142">err</span>&nbsp;<span class="op" id="6641146">==</span>&nbsp;<span class="builtintype" id="6641149">nil</span>&nbsp;<span class="op" id="6641153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641158">t</span><span class="op" id="6641159">.</span><span class="ident" id="6641160">Errorf</span><span class="op" id="6641166">(</span><span class="string" id="6641167">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="6641196">,</span>&nbsp;<span class="ident" id="6641198">src</span><span class="op" id="6641201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641205">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6641212">//&nbsp;ParseExpr&nbsp;must&nbsp;not&nbsp;crash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641241">for</span>&nbsp;<span class="ident" id="6641245">_</span><span class="op" id="6641246">,</span>&nbsp;<span class="ident" id="6641248">src</span>&nbsp;<span class="op" id="6641252">:=</span>&nbsp;<span class="keyword" id="6641255">range</span>&nbsp;<span class="ident" id="6641261">valids</span>&nbsp;<span class="op" id="6641268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641272">ParseExpr</span><span class="op" id="6641281">(</span><span class="ident" id="6641282">src</span><span class="op" id="6641285">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641288">}</span><br>
<span class="lineno"></span><span class="op" id="6641290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6641293">func</span>&nbsp;<span class="ident" id="6641298">TestColonEqualsScope</span><span class="op" id="6641318">(</span><span class="ident" id="6641319">t</span>&nbsp;<span class="op" id="6641321">*</span><span class="ident" id="6641322">testing</span><span class="op" id="6641329">.</span><span class="ident" id="6641330">T</span><span class="op" id="6641331">)</span>&nbsp;<span class="op" id="6641333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641336">f</span><span class="op" id="6641337">,</span>&nbsp;<span class="ident" id="6641339">err</span>&nbsp;<span class="op" id="6641343">:=</span>&nbsp;<span class="ident" id="6641346">ParseFile</span><span class="op" id="6641355">(</span><span class="ident" id="6641356">fset</span><span class="op" id="6641360">,</span>&nbsp;<span class="string" id="6641362">&#34;&#34;</span><span class="op" id="6641364">,</span>&nbsp;<span class="string" id="6641366">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;x,&nbsp;y,&nbsp;z&nbsp;:=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="6641410">,</span>&nbsp;<span class="num" id="6641412">0</span><span class="op" id="6641413">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641416">if</span>&nbsp;<span class="ident" id="6641419">err</span>&nbsp;<span class="op" id="6641423">!=</span>&nbsp;<span class="builtintype" id="6641426">nil</span>&nbsp;<span class="op" id="6641430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641434">t</span><span class="op" id="6641435">.</span><span class="ident" id="6641436">Fatal</span><span class="op" id="6641441">(</span><span class="ident" id="6641442">err</span><span class="op" id="6641445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6641452">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641503">as</span>&nbsp;<span class="op" id="6641506">:=</span>&nbsp;<span class="ident" id="6641509">f</span><span class="op" id="6641510">.</span><span class="ident" id="6641511">Decls</span><span class="op" id="6641516">[</span><span class="num" id="6641517">0</span><span class="op" id="6641518">]</span><span class="op" id="6641519">.</span><span class="op" id="6641520">(</span><span class="op" id="6641521">*</span><span class="ident" id="6641522">ast</span><span class="op" id="6641525">.</span><span class="ident" id="6641526">FuncDecl</span><span class="op" id="6641534">)</span><span class="op" id="6641535">.</span><span class="ident" id="6641536">Body</span><span class="op" id="6641540">.</span><span class="ident" id="6641541">List</span><span class="op" id="6641545">[</span><span class="num" id="6641546">0</span><span class="op" id="6641547">]</span><span class="op" id="6641548">.</span><span class="op" id="6641549">(</span><span class="op" id="6641550">*</span><span class="ident" id="6641551">ast</span><span class="op" id="6641554">.</span><span class="ident" id="6641555">AssignStmt</span><span class="op" id="6641565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641568">for</span>&nbsp;<span class="ident" id="6641572">_</span><span class="op" id="6641573">,</span>&nbsp;<span class="ident" id="6641575">v</span>&nbsp;<span class="op" id="6641577">:=</span>&nbsp;<span class="keyword" id="6641580">range</span>&nbsp;<span class="ident" id="6641586">as</span><span class="op" id="6641588">.</span><span class="ident" id="6641589">Rhs</span>&nbsp;<span class="op" id="6641593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641597">id</span>&nbsp;<span class="op" id="6641600">:=</span>&nbsp;<span class="ident" id="6641603">v</span><span class="op" id="6641604">.</span><span class="op" id="6641605">(</span><span class="op" id="6641606">*</span><span class="ident" id="6641607">ast</span><span class="op" id="6641610">.</span><span class="ident" id="6641611">Ident</span><span class="op" id="6641616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641620">if</span>&nbsp;<span class="ident" id="6641623">id</span><span class="op" id="6641625">.</span><span class="ident" id="6641626">Obj</span>&nbsp;<span class="op" id="6641630">!=</span>&nbsp;<span class="builtintype" id="6641633">nil</span>&nbsp;<span class="op" id="6641637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641642">t</span><span class="op" id="6641643">.</span><span class="ident" id="6641644">Errorf</span><span class="op" id="6641650">(</span><span class="string" id="6641651">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="6641679">,</span>&nbsp;<span class="ident" id="6641681">id</span><span class="op" id="6641683">.</span><span class="ident" id="6641684">Name</span><span class="op" id="6641688">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641698">for</span>&nbsp;<span class="ident" id="6641702">_</span><span class="op" id="6641703">,</span>&nbsp;<span class="ident" id="6641705">v</span>&nbsp;<span class="op" id="6641707">:=</span>&nbsp;<span class="keyword" id="6641710">range</span>&nbsp;<span class="ident" id="6641716">as</span><span class="op" id="6641718">.</span><span class="ident" id="6641719">Lhs</span>&nbsp;<span class="op" id="6641723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641727">id</span>&nbsp;<span class="op" id="6641730">:=</span>&nbsp;<span class="ident" id="6641733">v</span><span class="op" id="6641734">.</span><span class="op" id="6641735">(</span><span class="op" id="6641736">*</span><span class="ident" id="6641737">ast</span><span class="op" id="6641740">.</span><span class="ident" id="6641741">Ident</span><span class="op" id="6641746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641750">if</span>&nbsp;<span class="ident" id="6641753">id</span><span class="op" id="6641755">.</span><span class="ident" id="6641756">Obj</span>&nbsp;<span class="op" id="6641760">==</span>&nbsp;<span class="builtintype" id="6641763">nil</span>&nbsp;<span class="op" id="6641767">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641772">t</span><span class="op" id="6641773">.</span><span class="ident" id="6641774">Errorf</span><span class="op" id="6641780">(</span><span class="string" id="6641781">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="6641815">,</span>&nbsp;<span class="ident" id="6641817">id</span><span class="op" id="6641819">.</span><span class="ident" id="6641820">Name</span><span class="op" id="6641824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641831">}</span><br>
<span class="lineno"></span><span class="op" id="6641833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="6641836">func</span>&nbsp;<span class="ident" id="6641841">TestVarScope</span><span class="op" id="6641853">(</span><span class="ident" id="6641854">t</span>&nbsp;<span class="op" id="6641856">*</span><span class="ident" id="6641857">testing</span><span class="op" id="6641864">.</span><span class="ident" id="6641865">T</span><span class="op" id="6641866">)</span>&nbsp;<span class="op" id="6641868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641871">f</span><span class="op" id="6641872">,</span>&nbsp;<span class="ident" id="6641874">err</span>&nbsp;<span class="op" id="6641878">:=</span>&nbsp;<span class="ident" id="6641881">ParseFile</span><span class="op" id="6641890">(</span><span class="ident" id="6641891">fset</span><span class="op" id="6641895">,</span>&nbsp;<span class="string" id="6641897">&#34;&#34;</span><span class="op" id="6641899">,</span>&nbsp;<span class="string" id="6641901">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;var&nbsp;x,&nbsp;y,&nbsp;z&nbsp;=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="6641948">,</span>&nbsp;<span class="num" id="6641950">0</span><span class="op" id="6641951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6641954">if</span>&nbsp;<span class="ident" id="6641957">err</span>&nbsp;<span class="op" id="6641961">!=</span>&nbsp;<span class="builtintype" id="6641964">nil</span>&nbsp;<span class="op" id="6641968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6641972">t</span><span class="op" id="6641973">.</span><span class="ident" id="6641974">Fatal</span><span class="op" id="6641979">(</span><span class="ident" id="6641980">err</span><span class="op" id="6641983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6641986">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6641990">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642041">as</span>&nbsp;<span class="op" id="6642044">:=</span>&nbsp;<span class="ident" id="6642047">f</span><span class="op" id="6642048">.</span><span class="ident" id="6642049">Decls</span><span class="op" id="6642054">[</span><span class="num" id="6642055">0</span><span class="op" id="6642056">]</span><span class="op" id="6642057">.</span><span class="op" id="6642058">(</span><span class="op" id="6642059">*</span><span class="ident" id="6642060">ast</span><span class="op" id="6642063">.</span><span class="ident" id="6642064">FuncDecl</span><span class="op" id="6642072">)</span><span class="op" id="6642073">.</span><span class="ident" id="6642074">Body</span><span class="op" id="6642078">.</span><span class="ident" id="6642079">List</span><span class="op" id="6642083">[</span><span class="num" id="6642084">0</span><span class="op" id="6642085">]</span><span class="op" id="6642086">.</span><span class="op" id="6642087">(</span><span class="op" id="6642088">*</span><span class="ident" id="6642089">ast</span><span class="op" id="6642092">.</span><span class="ident" id="6642093">DeclStmt</span><span class="op" id="6642101">)</span><span class="op" id="6642102">.</span><span class="ident" id="6642103">Decl</span><span class="op" id="6642107">.</span><span class="op" id="6642108">(</span><span class="op" id="6642109">*</span><span class="ident" id="6642110">ast</span><span class="op" id="6642113">.</span><span class="ident" id="6642114">GenDecl</span><span class="op" id="6642121">)</span><span class="op" id="6642122">.</span><span class="ident" id="6642123">Specs</span><span class="op" id="6642128">[</span><span class="num" id="6642129">0</span><span class="op" id="6642130">]</span><span class="op" id="6642131">.</span><span class="op" id="6642132">(</span><span class="op" id="6642133">*</span><span class="ident" id="6642134">ast</span><span class="op" id="6642137">.</span><span class="ident" id="6642138">ValueSpec</span><span class="op" id="6642147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642150">for</span>&nbsp;<span class="ident" id="6642154">_</span><span class="op" id="6642155">,</span>&nbsp;<span class="ident" id="6642157">v</span>&nbsp;<span class="op" id="6642159">:=</span>&nbsp;<span class="keyword" id="6642162">range</span>&nbsp;<span class="ident" id="6642168">as</span><span class="op" id="6642170">.</span><span class="ident" id="6642171">Values</span>&nbsp;<span class="op" id="6642178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642182">id</span>&nbsp;<span class="op" id="6642185">:=</span>&nbsp;<span class="ident" id="6642188">v</span><span class="op" id="6642189">.</span><span class="op" id="6642190">(</span><span class="op" id="6642191">*</span><span class="ident" id="6642192">ast</span><span class="op" id="6642195">.</span><span class="ident" id="6642196">Ident</span><span class="op" id="6642201">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642205">if</span>&nbsp;<span class="ident" id="6642208">id</span><span class="op" id="6642210">.</span><span class="ident" id="6642211">Obj</span>&nbsp;<span class="op" id="6642215">!=</span>&nbsp;<span class="builtintype" id="6642218">nil</span>&nbsp;<span class="op" id="6642222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642227">t</span><span class="op" id="6642228">.</span><span class="ident" id="6642229">Errorf</span><span class="op" id="6642235">(</span><span class="string" id="6642236">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="6642264">,</span>&nbsp;<span class="ident" id="6642266">id</span><span class="op" id="6642268">.</span><span class="ident" id="6642269">Name</span><span class="op" id="6642273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642283">for</span>&nbsp;<span class="ident" id="6642287">_</span><span class="op" id="6642288">,</span>&nbsp;<span class="ident" id="6642290">id</span>&nbsp;<span class="op" id="6642293">:=</span>&nbsp;<span class="keyword" id="6642296">range</span>&nbsp;<span class="ident" id="6642302">as</span><span class="op" id="6642304">.</span><span class="ident" id="6642305">Names</span>&nbsp;<span class="op" id="6642311">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642315">if</span>&nbsp;<span class="ident" id="6642318">id</span><span class="op" id="6642320">.</span><span class="ident" id="6642321">Obj</span>&nbsp;<span class="op" id="6642325">==</span>&nbsp;<span class="builtintype" id="6642328">nil</span>&nbsp;<span class="op" id="6642332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642337">t</span><span class="op" id="6642338">.</span><span class="ident" id="6642339">Errorf</span><span class="op" id="6642345">(</span><span class="string" id="6642346">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="6642380">,</span>&nbsp;<span class="ident" id="6642382">id</span><span class="op" id="6642384">.</span><span class="ident" id="6642385">Name</span><span class="op" id="6642389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642396">}</span><br>
<span class="lineno"></span><span class="op" id="6642398">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="6642401">func</span>&nbsp;<span class="ident" id="6642406">TestObjects</span><span class="op" id="6642417">(</span><span class="ident" id="6642418">t</span>&nbsp;<span class="op" id="6642420">*</span><span class="ident" id="6642421">testing</span><span class="op" id="6642428">.</span><span class="ident" id="6642429">T</span><span class="op" id="6642430">)</span>&nbsp;<span class="op" id="6642432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642435">const</span>&nbsp;<span class="ident" id="6642441">src</span>&nbsp;<span class="op" id="6642445">=</span>&nbsp;<span class="string" id="6642447">`<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno"></span>import&nbsp;fmt&nbsp;&#34;fmt&#34;<br>
<span class="lineno">180</span>const&nbsp;pi&nbsp;=&nbsp;3.14<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct{}<br>
<span class="lineno"></span>var&nbsp;x&nbsp;int<br>
<span class="lineno"></span>func&nbsp;f()&nbsp;{&nbsp;L:&nbsp;}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642538">f</span><span class="op" id="6642539">,</span>&nbsp;<span class="ident" id="6642541">err</span>&nbsp;<span class="op" id="6642545">:=</span>&nbsp;<span class="ident" id="6642548">ParseFile</span><span class="op" id="6642557">(</span><span class="ident" id="6642558">fset</span><span class="op" id="6642562">,</span>&nbsp;<span class="string" id="6642564">&#34;&#34;</span><span class="op" id="6642566">,</span>&nbsp;<span class="ident" id="6642568">src</span><span class="op" id="6642571">,</span>&nbsp;<span class="num" id="6642573">0</span><span class="op" id="6642574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642577">if</span>&nbsp;<span class="ident" id="6642580">err</span>&nbsp;<span class="op" id="6642584">!=</span>&nbsp;<span class="builtintype" id="6642587">nil</span>&nbsp;<span class="op" id="6642591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642595">t</span><span class="op" id="6642596">.</span><span class="ident" id="6642597">Fatal</span><span class="op" id="6642602">(</span><span class="ident" id="6642603">err</span><span class="op" id="6642606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642609">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642613">objects</span>&nbsp;<span class="op" id="6642621">:=</span>&nbsp;<span class="keyword" id="6642624">map</span><span class="op" id="6642627">[</span><span class="builtintype" id="6642628">string</span><span class="op" id="6642634">]</span><span class="ident" id="6642635">ast</span><span class="op" id="6642638">.</span><span class="ident" id="6642639">ObjKind</span><span class="op" id="6642646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642650">&#34;p&#34;</span><span class="op" id="6642653">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6642657">ast</span><span class="op" id="6642660">.</span><span class="ident" id="6642661">Bad</span><span class="op" id="6642664">,</span>&nbsp;<span class="comment" id="6642666">//&nbsp;not&nbsp;in&nbsp;a&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642686">&#34;fmt&#34;</span><span class="op" id="6642691">:</span>&nbsp;<span class="ident" id="6642693">ast</span><span class="op" id="6642696">.</span><span class="ident" id="6642697">Bad</span><span class="op" id="6642700">,</span>&nbsp;<span class="comment" id="6642702">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642724">&#34;pi&#34;</span><span class="op" id="6642728">:</span>&nbsp;&nbsp;<span class="ident" id="6642731">ast</span><span class="op" id="6642734">.</span><span class="ident" id="6642735">Con</span><span class="op" id="6642738">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642742">&#34;T&#34;</span><span class="op" id="6642745">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6642749">ast</span><span class="op" id="6642752">.</span><span class="ident" id="6642753">Typ</span><span class="op" id="6642756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642760">&#34;x&#34;</span><span class="op" id="6642763">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6642767">ast</span><span class="op" id="6642770">.</span><span class="ident" id="6642771">Var</span><span class="op" id="6642774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642778">&#34;int&#34;</span><span class="op" id="6642783">:</span>&nbsp;<span class="ident" id="6642785">ast</span><span class="op" id="6642788">.</span><span class="ident" id="6642789">Bad</span><span class="op" id="6642792">,</span>&nbsp;<span class="comment" id="6642794">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642816">&#34;f&#34;</span><span class="op" id="6642819">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6642823">ast</span><span class="op" id="6642826">.</span><span class="ident" id="6642827">Fun</span><span class="op" id="6642830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6642834">&#34;L&#34;</span><span class="op" id="6642837">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6642841">ast</span><span class="op" id="6642844">.</span><span class="ident" id="6642845">Lbl</span><span class="op" id="6642848">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6642851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642855">ast</span><span class="op" id="6642858">.</span><span class="ident" id="6642859">Inspect</span><span class="op" id="6642866">(</span><span class="ident" id="6642867">f</span><span class="op" id="6642868">,</span>&nbsp;<span class="keyword" id="6642870">func</span><span class="op" id="6642874">(</span><span class="ident" id="6642875">n</span>&nbsp;<span class="ident" id="6642877">ast</span><span class="op" id="6642880">.</span><span class="ident" id="6642881">Node</span><span class="op" id="6642885">)</span>&nbsp;<span class="builtintype" id="6642887">bool</span>&nbsp;<span class="op" id="6642892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642896">if</span>&nbsp;<span class="ident" id="6642899">ident</span><span class="op" id="6642904">,</span>&nbsp;<span class="ident" id="6642906">ok</span>&nbsp;<span class="op" id="6642909">:=</span>&nbsp;<span class="ident" id="6642912">n</span><span class="op" id="6642913">.</span><span class="op" id="6642914">(</span><span class="op" id="6642915">*</span><span class="ident" id="6642916">ast</span><span class="op" id="6642919">.</span><span class="ident" id="6642920">Ident</span><span class="op" id="6642925">)</span><span class="op" id="6642926">;</span>&nbsp;<span class="ident" id="6642928">ok</span>&nbsp;<span class="op" id="6642931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6642936">obj</span>&nbsp;<span class="op" id="6642940">:=</span>&nbsp;<span class="ident" id="6642943">ident</span><span class="op" id="6642948">.</span><span class="ident" id="6642949">Obj</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642956">if</span>&nbsp;<span class="ident" id="6642959">obj</span>&nbsp;<span class="op" id="6642963">==</span>&nbsp;<span class="builtintype" id="6642966">nil</span>&nbsp;<span class="op" id="6642970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6642976">if</span>&nbsp;<span class="ident" id="6642979">objects</span><span class="op" id="6642986">[</span><span class="ident" id="6642987">ident</span><span class="op" id="6642992">.</span><span class="ident" id="6642993">Name</span><span class="op" id="6642997">]</span>&nbsp;<span class="op" id="6642999">!=</span>&nbsp;<span class="ident" id="6643002">ast</span><span class="op" id="6643005">.</span><span class="ident" id="6643006">Bad</span>&nbsp;<span class="op" id="6643010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643017">t</span><span class="op" id="6643018">.</span><span class="ident" id="6643019">Errorf</span><span class="op" id="6643025">(</span><span class="string" id="6643026">&#34;no&nbsp;object&nbsp;for&nbsp;%s&#34;</span><span class="op" id="6643044">,</span>&nbsp;<span class="ident" id="6643046">ident</span><span class="op" id="6643051">.</span><span class="ident" id="6643052">Name</span><span class="op" id="6643056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643068">return</span>&nbsp;<span class="builtintype" id="6643075">true</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643088">if</span>&nbsp;<span class="ident" id="6643091">obj</span><span class="op" id="6643094">.</span><span class="ident" id="6643095">Name</span>&nbsp;<span class="op" id="6643100">!=</span>&nbsp;<span class="ident" id="6643103">ident</span><span class="op" id="6643108">.</span><span class="ident" id="6643109">Name</span>&nbsp;<span class="op" id="6643114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643120">t</span><span class="op" id="6643121">.</span><span class="ident" id="6643122">Errorf</span><span class="op" id="6643128">(</span><span class="string" id="6643129">&#34;names&nbsp;don&#39;t&nbsp;match:&nbsp;obj.Name&nbsp;=&nbsp;%s,&nbsp;ident.Name&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6643180">,</span>&nbsp;<span class="ident" id="6643182">obj</span><span class="op" id="6643185">.</span><span class="ident" id="6643186">Name</span><span class="op" id="6643190">,</span>&nbsp;<span class="ident" id="6643192">ident</span><span class="op" id="6643197">.</span><span class="ident" id="6643198">Name</span><span class="op" id="6643202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643212">kind</span>&nbsp;<span class="op" id="6643217">:=</span>&nbsp;<span class="ident" id="6643220">objects</span><span class="op" id="6643227">[</span><span class="ident" id="6643228">ident</span><span class="op" id="6643233">.</span><span class="ident" id="6643234">Name</span><span class="op" id="6643238">]</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643243">if</span>&nbsp;<span class="ident" id="6643246">obj</span><span class="op" id="6643249">.</span><span class="ident" id="6643250">Kind</span>&nbsp;<span class="op" id="6643255">!=</span>&nbsp;<span class="ident" id="6643258">kind</span>&nbsp;<span class="op" id="6643263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643269">t</span><span class="op" id="6643270">.</span><span class="ident" id="6643271">Errorf</span><span class="op" id="6643277">(</span><span class="string" id="6643278">&#34;%s:&nbsp;obj.Kind&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6643306">,</span>&nbsp;<span class="ident" id="6643308">ident</span><span class="op" id="6643313">.</span><span class="ident" id="6643314">Name</span><span class="op" id="6643318">,</span>&nbsp;<span class="ident" id="6643320">obj</span><span class="op" id="6643323">.</span><span class="ident" id="6643324">Kind</span><span class="op" id="6643328">,</span>&nbsp;<span class="ident" id="6643330">kind</span><span class="op" id="6643334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643347">return</span>&nbsp;<span class="builtintype" id="6643354">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643360">}</span><span class="op" id="6643361">)</span><br>
<span class="lineno"></span><span class="op" id="6643363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6643366">func</span>&nbsp;<span class="ident" id="6643371">TestUnresolved</span><span class="op" id="6643385">(</span><span class="ident" id="6643386">t</span>&nbsp;<span class="op" id="6643388">*</span><span class="ident" id="6643389">testing</span><span class="op" id="6643396">.</span><span class="ident" id="6643397">T</span><span class="op" id="6643398">)</span>&nbsp;<span class="op" id="6643400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643403">f</span><span class="op" id="6643404">,</span>&nbsp;<span class="ident" id="6643406">err</span>&nbsp;<span class="op" id="6643410">:=</span>&nbsp;<span class="ident" id="6643413">ParseFile</span><span class="op" id="6643422">(</span><span class="ident" id="6643423">fset</span><span class="op" id="6643427">,</span>&nbsp;<span class="string" id="6643429">&#34;&#34;</span><span class="op" id="6643431">,</span>&nbsp;<span class="string" id="6643433">`<br>
<span class="lineno">225</span>package&nbsp;p<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1a(int)<br>
<span class="lineno"></span>func&nbsp;f2a(byte,&nbsp;int,&nbsp;float)<br>
<span class="lineno"></span>func&nbsp;f3a(a,&nbsp;b&nbsp;int,&nbsp;c&nbsp;float)<br>
<span class="lineno">230</span>func&nbsp;f4a(...complex)<br>
<span class="lineno"></span>func&nbsp;f5a(a&nbsp;s1a,&nbsp;b&nbsp;...complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1b(*int)<br>
<span class="lineno"></span>func&nbsp;f2b([]byte,&nbsp;(int),&nbsp;*float)<br>
<span class="lineno">235</span>func&nbsp;f3b(a,&nbsp;b&nbsp;*int,&nbsp;c&nbsp;[]float)<br>
<span class="lineno"></span>func&nbsp;f4b(...*complex)<br>
<span class="lineno"></span>func&nbsp;f5b(a&nbsp;s1a,&nbsp;b&nbsp;...[]complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1a&nbsp;struct&nbsp;{&nbsp;int&nbsp;}<br>
<span class="lineno">240</span>type&nbsp;s2a&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;s1a&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s3a&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;int;&nbsp;c&nbsp;float&nbsp;}<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1b&nbsp;struct&nbsp;{&nbsp;*int&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s2b&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;*float&nbsp;}<br>
<span class="lineno">245</span>type&nbsp;s3b&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;*s3b;&nbsp;c&nbsp;[]float&nbsp;}<br>
<span class="lineno"></span>`</span><span class="op" id="6643911">,</span>&nbsp;<span class="num" id="6643913">0</span><span class="op" id="6643914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6643917">if</span>&nbsp;<span class="ident" id="6643920">err</span>&nbsp;<span class="op" id="6643924">!=</span>&nbsp;<span class="builtintype" id="6643927">nil</span>&nbsp;<span class="op" id="6643931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643935">t</span><span class="op" id="6643936">.</span><span class="ident" id="6643937">Fatal</span><span class="op" id="6643942">(</span><span class="ident" id="6643943">err</span><span class="op" id="6643946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6643949">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6643953">want</span>&nbsp;<span class="op" id="6643958">:=</span>&nbsp;<span class="string" id="6643961">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="6643968">+</span>&nbsp;<span class="comment" id="6643970">//&nbsp;f1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6643979">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="6643997">+</span>&nbsp;<span class="comment" id="6643999">//&nbsp;f2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644008">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="6644021">+</span>&nbsp;<span class="comment" id="6644023">//&nbsp;f3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644032">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="6644043">+</span>&nbsp;<span class="comment" id="6644045">//&nbsp;f4a</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644054">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="6644065">+</span>&nbsp;<span class="comment" id="6644067">//&nbsp;f5a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644076">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644081">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="6644088">+</span>&nbsp;<span class="comment" id="6644090">//&nbsp;f1b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644099">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="6644117">+</span>&nbsp;<span class="comment" id="6644119">//&nbsp;f2b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644128">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="6644141">+</span>&nbsp;<span class="comment" id="6644143">//&nbsp;f3b</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644152">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="6644163">+</span>&nbsp;<span class="comment" id="6644165">//&nbsp;f4b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644174">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="6644185">+</span>&nbsp;<span class="comment" id="6644187">//&nbsp;f5b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644196">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644201">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="6644208">+</span>&nbsp;<span class="comment" id="6644210">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644219">&#34;byte&nbsp;int&nbsp;&#34;</span>&nbsp;<span class="op" id="6644231">+</span>&nbsp;<span class="comment" id="6644233">//&nbsp;s2a</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644242">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="6644255">+</span>&nbsp;<span class="comment" id="6644257">//&nbsp;s3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644266">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644271">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="6644278">+</span>&nbsp;<span class="comment" id="6644280">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644289">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="6644307">+</span>&nbsp;<span class="comment" id="6644309">//&nbsp;s2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644318">&#34;float&nbsp;&#34;</span>&nbsp;<span class="comment" id="6644327">//&nbsp;s3a</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644336">//&nbsp;collect&nbsp;unresolved&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644371">var</span>&nbsp;<span class="ident" id="6644375">buf</span>&nbsp;<span class="ident" id="6644379">bytes</span><span class="op" id="6644384">.</span><span class="ident" id="6644385">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644393">for</span>&nbsp;<span class="ident" id="6644397">_</span><span class="op" id="6644398">,</span>&nbsp;<span class="ident" id="6644400">u</span>&nbsp;<span class="op" id="6644402">:=</span>&nbsp;<span class="keyword" id="6644405">range</span>&nbsp;<span class="ident" id="6644411">f</span><span class="op" id="6644412">.</span><span class="ident" id="6644413">Unresolved</span>&nbsp;<span class="op" id="6644424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644428">buf</span><span class="op" id="6644431">.</span><span class="ident" id="6644432">WriteString</span><span class="op" id="6644443">(</span><span class="ident" id="6644444">u</span><span class="op" id="6644445">.</span><span class="ident" id="6644446">Name</span><span class="op" id="6644450">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644454">buf</span><span class="op" id="6644457">.</span><span class="ident" id="6644458">WriteByte</span><span class="op" id="6644467">(</span><span class="string" id="6644468">&#39;&nbsp;&#39;</span><span class="op" id="6644471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644477">got</span>&nbsp;<span class="op" id="6644481">:=</span>&nbsp;<span class="ident" id="6644484">buf</span><span class="op" id="6644487">.</span><span class="ident" id="6644488">String</span><span class="op" id="6644494">(</span><span class="op" id="6644495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6644499">if</span>&nbsp;<span class="ident" id="6644502">got</span>&nbsp;<span class="op" id="6644506">!=</span>&nbsp;<span class="ident" id="6644509">want</span>&nbsp;<span class="op" id="6644514">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6644518">t</span><span class="op" id="6644519">.</span><span class="ident" id="6644520">Errorf</span><span class="op" id="6644526">(</span><span class="string" id="6644527">&#34;\ngot:&nbsp;&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="6644549">,</span>&nbsp;<span class="ident" id="6644551">got</span><span class="op" id="6644554">,</span>&nbsp;<span class="ident" id="6644556">want</span><span class="op" id="6644560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6644563">}</span><br>
<span class="lineno"></span><span class="op" id="6644565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6644568">var</span>&nbsp;<span class="ident" id="6644572">imports</span>&nbsp;<span class="op" id="6644580">=</span>&nbsp;<span class="keyword" id="6644582">map</span><span class="op" id="6644585">[</span><span class="builtintype" id="6644586">string</span><span class="op" id="6644592">]</span><span class="builtintype" id="6644593">bool</span><span class="op" id="6644597">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644600">`&#34;a&#34;`</span><span class="op" id="6644605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644614">true</span><span class="op" id="6644618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644621">&#34;`a`&#34;</span><span class="op" id="6644626">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644635">true</span><span class="op" id="6644639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644642">`&#34;a/b&#34;`</span><span class="op" id="6644649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644656">true</span><span class="op" id="6644660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644663">`&#34;a.b&#34;`</span><span class="op" id="6644670">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644677">true</span><span class="op" id="6644681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644684">`&#34;m\x61th&#34;`</span><span class="op" id="6644695">:</span>&nbsp;&nbsp;<span class="builtintype" id="6644698">true</span><span class="op" id="6644702">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644705">`&#34;greek/αβ&#34;`</span><span class="op" id="6644719">:</span>&nbsp;<span class="builtintype" id="6644721">true</span><span class="op" id="6644725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644728">`&#34;&#34;`</span><span class="op" id="6644732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6644742">false</span><span class="op" id="6644747">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644751">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;pairs&nbsp;tests&nbsp;both&nbsp;``&nbsp;vs&nbsp;&#34;&#34;&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644803">//&nbsp;and&nbsp;also&nbsp;use&nbsp;of&nbsp;invalid&nbsp;characters&nbsp;spelled&nbsp;out&nbsp;as</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644857">//&nbsp;escape&nbsp;sequences&nbsp;and&nbsp;written&nbsp;directly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644900">//&nbsp;For&nbsp;example&nbsp;`&#34;\x00&#34;`&nbsp;tests&nbsp;import&nbsp;&#34;\x00&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6644945">//&nbsp;while&nbsp;&#34;`\x00`&#34;&nbsp;tests&nbsp;import&nbsp;`&lt;actual-NUL-byte&gt;`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6644998">`&#34;\x00&#34;`</span><span class="op" id="6645006">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645012">false</span><span class="op" id="6645017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645020">&#34;`\x00`&#34;</span><span class="op" id="6645028">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645034">false</span><span class="op" id="6645039">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645042">`&#34;\x7f&#34;`</span><span class="op" id="6645050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645056">false</span><span class="op" id="6645061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645064">&#34;`\x7f`&#34;</span><span class="op" id="6645072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645078">false</span><span class="op" id="6645083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645086">`&#34;a!&#34;`</span><span class="op" id="6645092">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645100">false</span><span class="op" id="6645105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645108">&#34;`a!`&#34;</span><span class="op" id="6645114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645122">false</span><span class="op" id="6645127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645130">`&#34;a&nbsp;b&#34;`</span><span class="op" id="6645137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645144">false</span><span class="op" id="6645149">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645152">&#34;`a&nbsp;b`&#34;</span><span class="op" id="6645159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645166">false</span><span class="op" id="6645171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645174">`&#34;a\\b&#34;`</span><span class="op" id="6645182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645188">false</span><span class="op" id="6645193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645196">&#34;`a\\b`&#34;</span><span class="op" id="6645204">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645210">false</span><span class="op" id="6645215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645218">&#34;\&#34;`a`\&#34;&#34;</span><span class="op" id="6645227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645232">false</span><span class="op" id="6645237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645240">&#34;`\&#34;a\&#34;`&#34;</span><span class="op" id="6645249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645254">false</span><span class="op" id="6645259">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645262">`&#34;\x80\x80&#34;`</span><span class="op" id="6645274">:</span>&nbsp;<span class="builtintype" id="6645276">false</span><span class="op" id="6645281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645284">&#34;`\x80\x80`&#34;</span><span class="op" id="6645296">:</span>&nbsp;<span class="builtintype" id="6645298">false</span><span class="op" id="6645303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645306">`&#34;\xFFFD&#34;`</span><span class="op" id="6645316">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645320">false</span><span class="op" id="6645325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6645328">&#34;`\xFFFD`&#34;</span><span class="op" id="6645338">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6645342">false</span><span class="op" id="6645347">,</span><br>
<span class="lineno"></span><span class="op" id="6645349">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="6645352">func</span>&nbsp;<span class="ident" id="6645357">TestImports</span><span class="op" id="6645368">(</span><span class="ident" id="6645369">t</span>&nbsp;<span class="op" id="6645371">*</span><span class="ident" id="6645372">testing</span><span class="op" id="6645379">.</span><span class="ident" id="6645380">T</span><span class="op" id="6645381">)</span>&nbsp;<span class="op" id="6645383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645386">for</span>&nbsp;<span class="ident" id="6645390">path</span><span class="op" id="6645394">,</span>&nbsp;<span class="ident" id="6645396">isValid</span>&nbsp;<span class="op" id="6645404">:=</span>&nbsp;<span class="keyword" id="6645407">range</span>&nbsp;<span class="ident" id="6645413">imports</span>&nbsp;<span class="op" id="6645421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645425">src</span>&nbsp;<span class="op" id="6645429">:=</span>&nbsp;<span class="ident" id="6645432">fmt</span><span class="op" id="6645435">.</span><span class="ident" id="6645436">Sprintf</span><span class="op" id="6645443">(</span><span class="string" id="6645444">&#34;package&nbsp;p;&nbsp;import&nbsp;%s&#34;</span><span class="op" id="6645466">,</span>&nbsp;<span class="ident" id="6645468">path</span><span class="op" id="6645472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645476">_</span><span class="op" id="6645477">,</span>&nbsp;<span class="ident" id="6645479">err</span>&nbsp;<span class="op" id="6645483">:=</span>&nbsp;<span class="ident" id="6645486">ParseFile</span><span class="op" id="6645495">(</span><span class="ident" id="6645496">fset</span><span class="op" id="6645500">,</span>&nbsp;<span class="string" id="6645502">&#34;&#34;</span><span class="op" id="6645504">,</span>&nbsp;<span class="ident" id="6645506">src</span><span class="op" id="6645509">,</span>&nbsp;<span class="num" id="6645511">0</span><span class="op" id="6645512">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645516">switch</span>&nbsp;<span class="op" id="6645523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645527">case</span>&nbsp;<span class="ident" id="6645532">err</span>&nbsp;<span class="op" id="6645536">!=</span>&nbsp;<span class="builtintype" id="6645539">nil</span>&nbsp;<span class="op" id="6645543">&amp;&amp;</span>&nbsp;<span class="ident" id="6645546">isValid</span><span class="op" id="6645553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645558">t</span><span class="op" id="6645559">.</span><span class="ident" id="6645560">Errorf</span><span class="op" id="6645566">(</span><span class="string" id="6645567">&#34;ParseFile(%s):&nbsp;got&nbsp;%v;&nbsp;expected&nbsp;no&nbsp;error&#34;</span><span class="op" id="6645609">,</span>&nbsp;<span class="ident" id="6645611">src</span><span class="op" id="6645614">,</span>&nbsp;<span class="ident" id="6645616">err</span><span class="op" id="6645619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6645623">case</span>&nbsp;<span class="ident" id="6645628">err</span>&nbsp;<span class="op" id="6645632">==</span>&nbsp;<span class="builtintype" id="6645635">nil</span>&nbsp;<span class="op" id="6645639">&amp;&amp;</span>&nbsp;<span class="op" id="6645642">!</span><span class="ident" id="6645643">isValid</span><span class="op" id="6645650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645655">t</span><span class="op" id="6645656">.</span><span class="ident" id="6645657">Errorf</span><span class="op" id="6645663">(</span><span class="string" id="6645664">&#34;ParseFile(%s):&nbsp;got&nbsp;no&nbsp;error;&nbsp;expected&nbsp;one&#34;</span><span class="op" id="6645707">,</span>&nbsp;<span class="ident" id="6645709">src</span><span class="op" id="6645712">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6645719">}</span><br>
<span class="lineno"></span><span class="op" id="6645721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6645724">func</span>&nbsp;<span class="ident" id="6645729">TestCommentGroups</span><span class="op" id="6645746">(</span><span class="ident" id="6645747">t</span>&nbsp;<span class="op" id="6645749">*</span><span class="ident" id="6645750">testing</span><span class="op" id="6645757">.</span><span class="ident" id="6645758">T</span><span class="op" id="6645759">)</span>&nbsp;<span class="op" id="6645761">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6645764">f</span><span class="op" id="6645765">,</span>&nbsp;<span class="ident" id="6645767">err</span>&nbsp;<span class="op" id="6645771">:=</span>&nbsp;<span class="ident" id="6645774">ParseFile</span><span class="op" id="6645783">(</span><span class="ident" id="6645784">fset</span><span class="op" id="6645788">,</span>&nbsp;<span class="string" id="6645790">&#34;&#34;</span><span class="op" id="6645792">,</span>&nbsp;<span class="string" id="6645794">`<br>
<span class="lineno"></span>package&nbsp;p&nbsp;/*&nbsp;1a&nbsp;*/&nbsp;/*&nbsp;1b&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;1c&nbsp;*/&nbsp;//&nbsp;1d<br>
<span class="lineno"></span>/*&nbsp;2a<br>
<span class="lineno"></span>*/<br>
<span class="lineno"></span>//&nbsp;2b<br>
<span class="lineno">335</span>const&nbsp;pi&nbsp;=&nbsp;3.1415<br>
<span class="lineno"></span>/*&nbsp;3a&nbsp;*/&nbsp;//&nbsp;3b<br>
<span class="lineno"></span>/*&nbsp;3c&nbsp;*/&nbsp;const&nbsp;e&nbsp;=&nbsp;2.7182<br>
<span class="lineno"></span><br>
<span class="lineno"></span>//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139<br>
<span class="lineno">340</span>func&nbsp;ExampleCount()&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(strings.Count(&#34;cheese&#34;,&nbsp;&#34;e&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(strings.Count(&#34;five&#34;,&nbsp;&#34;&#34;))&nbsp;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;3<br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;5<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><span class="op" id="6646106">,</span>&nbsp;<span class="ident" id="6646108">ParseComments</span><span class="op" id="6646121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646124">if</span>&nbsp;<span class="ident" id="6646127">err</span>&nbsp;<span class="op" id="6646131">!=</span>&nbsp;<span class="builtintype" id="6646134">nil</span>&nbsp;<span class="op" id="6646138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646142">t</span><span class="op" id="6646143">.</span><span class="ident" id="6646144">Fatal</span><span class="op" id="6646149">(</span><span class="ident" id="6646150">err</span><span class="op" id="6646153">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646159">expected</span>&nbsp;<span class="op" id="6646168">:=</span>&nbsp;<span class="op" id="6646171">[</span><span class="op" id="6646172">]</span><span class="op" id="6646173">[</span><span class="op" id="6646174">]</span><span class="builtintype" id="6646175">string</span><span class="op" id="6646181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646185">{</span><span class="string" id="6646186">&#34;/*&nbsp;1a&nbsp;*/&#34;</span><span class="op" id="6646196">,</span>&nbsp;<span class="string" id="6646198">&#34;/*&nbsp;1b&nbsp;*/&#34;</span><span class="op" id="6646208">,</span>&nbsp;<span class="string" id="6646210">&#34;/*&nbsp;1c&nbsp;*/&#34;</span><span class="op" id="6646220">,</span>&nbsp;<span class="string" id="6646222">&#34;//&nbsp;1d&#34;</span><span class="op" id="6646229">}</span><span class="op" id="6646230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646234">{</span><span class="string" id="6646235">&#34;/*&nbsp;2a\n*/&#34;</span><span class="op" id="6646246">,</span>&nbsp;<span class="string" id="6646248">&#34;//&nbsp;2b&#34;</span><span class="op" id="6646255">}</span><span class="op" id="6646256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646260">{</span><span class="string" id="6646261">&#34;/*&nbsp;3a&nbsp;*/&#34;</span><span class="op" id="6646271">,</span>&nbsp;<span class="string" id="6646273">&#34;//&nbsp;3b&#34;</span><span class="op" id="6646280">,</span>&nbsp;<span class="string" id="6646282">&#34;/*&nbsp;3c&nbsp;*/&#34;</span><span class="op" id="6646292">}</span><span class="op" id="6646293">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646297">{</span><span class="string" id="6646298">&#34;//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139&#34;</span><span class="op" id="6646326">}</span><span class="op" id="6646327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646331">{</span><span class="string" id="6646332">&#34;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune&#34;</span><span class="op" id="6646361">}</span><span class="op" id="6646362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646366">{</span><span class="string" id="6646367">&#34;//&nbsp;Output:&#34;</span><span class="op" id="6646379">,</span>&nbsp;<span class="string" id="6646381">&#34;//&nbsp;3&#34;</span><span class="op" id="6646387">,</span>&nbsp;<span class="string" id="6646389">&#34;//&nbsp;5&#34;</span><span class="op" id="6646395">}</span><span class="op" id="6646396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646402">if</span>&nbsp;<span class="builtinfunc" id="6646405">len</span><span class="op" id="6646408">(</span><span class="ident" id="6646409">f</span><span class="op" id="6646410">.</span><span class="ident" id="6646411">Comments</span><span class="op" id="6646419">)</span>&nbsp;<span class="op" id="6646421">!=</span>&nbsp;<span class="builtinfunc" id="6646424">len</span><span class="op" id="6646427">(</span><span class="ident" id="6646428">expected</span><span class="op" id="6646436">)</span>&nbsp;<span class="op" id="6646438">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646442">t</span><span class="op" id="6646443">.</span><span class="ident" id="6646444">Fatalf</span><span class="op" id="6646450">(</span><span class="string" id="6646451">&#34;got&nbsp;%d&nbsp;comment&nbsp;groups;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6646487">,</span>&nbsp;<span class="builtinfunc" id="6646489">len</span><span class="op" id="6646492">(</span><span class="ident" id="6646493">f</span><span class="op" id="6646494">.</span><span class="ident" id="6646495">Comments</span><span class="op" id="6646503">)</span><span class="op" id="6646504">,</span>&nbsp;<span class="builtinfunc" id="6646506">len</span><span class="op" id="6646509">(</span><span class="ident" id="6646510">expected</span><span class="op" id="6646518">)</span><span class="op" id="6646519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646525">for</span>&nbsp;<span class="ident" id="6646529">i</span><span class="op" id="6646530">,</span>&nbsp;<span class="ident" id="6646532">exp</span>&nbsp;<span class="op" id="6646536">:=</span>&nbsp;<span class="keyword" id="6646539">range</span>&nbsp;<span class="ident" id="6646545">expected</span>&nbsp;<span class="op" id="6646554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646558">got</span>&nbsp;<span class="op" id="6646562">:=</span>&nbsp;<span class="ident" id="6646565">f</span><span class="op" id="6646566">.</span><span class="ident" id="6646567">Comments</span><span class="op" id="6646575">[</span><span class="ident" id="6646576">i</span><span class="op" id="6646577">]</span><span class="op" id="6646578">.</span><span class="ident" id="6646579">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646586">if</span>&nbsp;<span class="builtinfunc" id="6646589">len</span><span class="op" id="6646592">(</span><span class="ident" id="6646593">got</span><span class="op" id="6646596">)</span>&nbsp;<span class="op" id="6646598">!=</span>&nbsp;<span class="builtinfunc" id="6646601">len</span><span class="op" id="6646604">(</span><span class="ident" id="6646605">exp</span><span class="op" id="6646608">)</span>&nbsp;<span class="op" id="6646610">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646615">t</span><span class="op" id="6646616">.</span><span class="ident" id="6646617">Errorf</span><span class="op" id="6646623">(</span><span class="string" id="6646624">&#34;got&nbsp;%d&nbsp;comments&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6646666">,</span>&nbsp;<span class="builtinfunc" id="6646668">len</span><span class="op" id="6646671">(</span><span class="ident" id="6646672">got</span><span class="op" id="6646675">)</span><span class="op" id="6646676">,</span>&nbsp;<span class="ident" id="6646678">i</span><span class="op" id="6646679">,</span>&nbsp;<span class="builtinfunc" id="6646681">len</span><span class="op" id="6646684">(</span><span class="ident" id="6646685">exp</span><span class="op" id="6646688">)</span><span class="op" id="6646689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646694">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646709">for</span>&nbsp;<span class="ident" id="6646713">j</span><span class="op" id="6646714">,</span>&nbsp;<span class="ident" id="6646716">exp</span>&nbsp;<span class="op" id="6646720">:=</span>&nbsp;<span class="keyword" id="6646723">range</span>&nbsp;<span class="ident" id="6646729">exp</span>&nbsp;<span class="op" id="6646733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646738">got</span>&nbsp;<span class="op" id="6646742">:=</span>&nbsp;<span class="ident" id="6646745">got</span><span class="op" id="6646748">[</span><span class="ident" id="6646749">j</span><span class="op" id="6646750">]</span><span class="op" id="6646751">.</span><span class="ident" id="6646752">Text</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646760">if</span>&nbsp;<span class="ident" id="6646763">got</span>&nbsp;<span class="op" id="6646767">!=</span>&nbsp;<span class="ident" id="6646770">exp</span>&nbsp;<span class="op" id="6646774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646780">t</span><span class="op" id="6646781">.</span><span class="ident" id="6646782">Errorf</span><span class="op" id="6646788">(</span><span class="string" id="6646789">&#34;got&nbsp;%q&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6646822">,</span>&nbsp;<span class="ident" id="6646824">got</span><span class="op" id="6646827">,</span>&nbsp;<span class="ident" id="6646829">i</span><span class="op" id="6646830">,</span>&nbsp;<span class="ident" id="6646832">exp</span><span class="op" id="6646835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6646847">}</span><br>
<span class="lineno">375</span><span class="op" id="6646849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6646852">func</span>&nbsp;<span class="ident" id="6646857">getField</span><span class="op" id="6646865">(</span><span class="ident" id="6646866">file</span>&nbsp;<span class="op" id="6646871">*</span><span class="ident" id="6646872">ast</span><span class="op" id="6646875">.</span><span class="ident" id="6646876">File</span><span class="op" id="6646880">,</span>&nbsp;<span class="ident" id="6646882">fieldname</span>&nbsp;<span class="builtintype" id="6646892">string</span><span class="op" id="6646898">)</span>&nbsp;<span class="op" id="6646900">*</span><span class="ident" id="6646901">ast</span><span class="op" id="6646904">.</span><span class="ident" id="6646905">Field</span>&nbsp;<span class="op" id="6646911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6646914">parts</span>&nbsp;<span class="op" id="6646920">:=</span>&nbsp;<span class="ident" id="6646923">strings</span><span class="op" id="6646930">.</span><span class="ident" id="6646931">Split</span><span class="op" id="6646936">(</span><span class="ident" id="6646937">fieldname</span><span class="op" id="6646946">,</span>&nbsp;<span class="string" id="6646948">&#34;.&#34;</span><span class="op" id="6646951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646954">for</span>&nbsp;<span class="ident" id="6646958">_</span><span class="op" id="6646959">,</span>&nbsp;<span class="ident" id="6646961">d</span>&nbsp;<span class="op" id="6646963">:=</span>&nbsp;<span class="keyword" id="6646966">range</span>&nbsp;<span class="ident" id="6646972">file</span><span class="op" id="6646976">.</span><span class="ident" id="6646977">Decls</span>&nbsp;<span class="op" id="6646983">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6646987">if</span>&nbsp;<span class="ident" id="6646990">d</span><span class="op" id="6646991">,</span>&nbsp;<span class="ident" id="6646993">ok</span>&nbsp;<span class="op" id="6646996">:=</span>&nbsp;<span class="ident" id="6646999">d</span><span class="op" id="6647000">.</span><span class="op" id="6647001">(</span><span class="op" id="6647002">*</span><span class="ident" id="6647003">ast</span><span class="op" id="6647006">.</span><span class="ident" id="6647007">GenDecl</span><span class="op" id="6647014">)</span><span class="op" id="6647015">;</span>&nbsp;<span class="ident" id="6647017">ok</span>&nbsp;<span class="op" id="6647020">&amp;&amp;</span>&nbsp;<span class="ident" id="6647023">d</span><span class="op" id="6647024">.</span><span class="ident" id="6647025">Tok</span>&nbsp;<span class="op" id="6647029">==</span>&nbsp;<span class="ident" id="6647032">token</span><span class="op" id="6647037">.</span><span class="ident" id="6647038">TYPE</span>&nbsp;<span class="op" id="6647043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647048">for</span>&nbsp;<span class="ident" id="6647052">_</span><span class="op" id="6647053">,</span>&nbsp;<span class="ident" id="6647055">s</span>&nbsp;<span class="op" id="6647057">:=</span>&nbsp;<span class="keyword" id="6647060">range</span>&nbsp;<span class="ident" id="6647066">d</span><span class="op" id="6647067">.</span><span class="ident" id="6647068">Specs</span>&nbsp;<span class="op" id="6647074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647080">if</span>&nbsp;<span class="ident" id="6647083">s</span><span class="op" id="6647084">,</span>&nbsp;<span class="ident" id="6647086">ok</span>&nbsp;<span class="op" id="6647089">:=</span>&nbsp;<span class="ident" id="6647092">s</span><span class="op" id="6647093">.</span><span class="op" id="6647094">(</span><span class="op" id="6647095">*</span><span class="ident" id="6647096">ast</span><span class="op" id="6647099">.</span><span class="ident" id="6647100">TypeSpec</span><span class="op" id="6647108">)</span><span class="op" id="6647109">;</span>&nbsp;<span class="ident" id="6647111">ok</span>&nbsp;<span class="op" id="6647114">&amp;&amp;</span>&nbsp;<span class="ident" id="6647117">s</span><span class="op" id="6647118">.</span><span class="ident" id="6647119">Name</span><span class="op" id="6647123">.</span><span class="ident" id="6647124">Name</span>&nbsp;<span class="op" id="6647129">==</span>&nbsp;<span class="ident" id="6647132">parts</span><span class="op" id="6647137">[</span><span class="num" id="6647138">0</span><span class="op" id="6647139">]</span>&nbsp;<span class="op" id="6647141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647148">if</span>&nbsp;<span class="ident" id="6647151">s</span><span class="op" id="6647152">,</span>&nbsp;<span class="ident" id="6647154">ok</span>&nbsp;<span class="op" id="6647157">:=</span>&nbsp;<span class="ident" id="6647160">s</span><span class="op" id="6647161">.</span><span class="ident" id="6647162">Type</span><span class="op" id="6647166">.</span><span class="op" id="6647167">(</span><span class="op" id="6647168">*</span><span class="ident" id="6647169">ast</span><span class="op" id="6647172">.</span><span class="ident" id="6647173">StructType</span><span class="op" id="6647183">)</span><span class="op" id="6647184">;</span>&nbsp;<span class="ident" id="6647186">ok</span>&nbsp;<span class="op" id="6647189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647197">for</span>&nbsp;<span class="ident" id="6647201">_</span><span class="op" id="6647202">,</span>&nbsp;<span class="ident" id="6647204">f</span>&nbsp;<span class="op" id="6647206">:=</span>&nbsp;<span class="keyword" id="6647209">range</span>&nbsp;<span class="ident" id="6647215">s</span><span class="op" id="6647216">.</span><span class="ident" id="6647217">Fields</span><span class="op" id="6647223">.</span><span class="ident" id="6647224">List</span>&nbsp;<span class="op" id="6647229">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647238">for</span>&nbsp;<span class="ident" id="6647242">_</span><span class="op" id="6647243">,</span>&nbsp;<span class="ident" id="6647245">name</span>&nbsp;<span class="op" id="6647250">:=</span>&nbsp;<span class="keyword" id="6647253">range</span>&nbsp;<span class="ident" id="6647259">f</span><span class="op" id="6647260">.</span><span class="ident" id="6647261">Names</span>&nbsp;<span class="op" id="6647267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647277">if</span>&nbsp;<span class="ident" id="6647280">name</span><span class="op" id="6647284">.</span><span class="ident" id="6647285">Name</span>&nbsp;<span class="op" id="6647290">==</span>&nbsp;<span class="ident" id="6647293">parts</span><span class="op" id="6647298">[</span><span class="num" id="6647299">1</span><span class="op" id="6647300">]</span>&nbsp;<span class="op" id="6647302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647313">return</span>&nbsp;<span class="ident" id="6647320">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647339">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647369">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647375">return</span>&nbsp;<span class="builtintype" id="6647382">nil</span><br>
<span class="lineno"></span><span class="op" id="6647386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6647389">//&nbsp;Don&#39;t&nbsp;use&nbsp;ast.CommentGroup.Text()&nbsp;-&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;exact&nbsp;comment&nbsp;text.</span><br>
<span class="lineno">400</span><span class="keyword" id="6647463">func</span>&nbsp;<span class="ident" id="6647468">commentText</span><span class="op" id="6647479">(</span><span class="ident" id="6647480">c</span>&nbsp;<span class="op" id="6647482">*</span><span class="ident" id="6647483">ast</span><span class="op" id="6647486">.</span><span class="ident" id="6647487">CommentGroup</span><span class="op" id="6647499">)</span>&nbsp;<span class="builtintype" id="6647501">string</span>&nbsp;<span class="op" id="6647508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647511">var</span>&nbsp;<span class="ident" id="6647515">buf</span>&nbsp;<span class="ident" id="6647519">bytes</span><span class="op" id="6647524">.</span><span class="ident" id="6647525">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647533">if</span>&nbsp;<span class="ident" id="6647536">c</span>&nbsp;<span class="op" id="6647538">!=</span>&nbsp;<span class="builtintype" id="6647541">nil</span>&nbsp;<span class="op" id="6647545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647549">for</span>&nbsp;<span class="ident" id="6647553">_</span><span class="op" id="6647554">,</span>&nbsp;<span class="ident" id="6647556">c</span>&nbsp;<span class="op" id="6647558">:=</span>&nbsp;<span class="keyword" id="6647561">range</span>&nbsp;<span class="ident" id="6647567">c</span><span class="op" id="6647568">.</span><span class="ident" id="6647569">List</span>&nbsp;<span class="op" id="6647574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647579">buf</span><span class="op" id="6647582">.</span><span class="ident" id="6647583">WriteString</span><span class="op" id="6647594">(</span><span class="ident" id="6647595">c</span><span class="op" id="6647596">.</span><span class="ident" id="6647597">Text</span><span class="op" id="6647601">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647611">return</span>&nbsp;<span class="ident" id="6647618">buf</span><span class="op" id="6647621">.</span><span class="ident" id="6647622">String</span><span class="op" id="6647628">(</span><span class="op" id="6647629">)</span><br>
<span class="lineno"></span><span class="op" id="6647631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="6647634">func</span>&nbsp;<span class="ident" id="6647639">checkFieldComments</span><span class="op" id="6647657">(</span><span class="ident" id="6647658">t</span>&nbsp;<span class="op" id="6647660">*</span><span class="ident" id="6647661">testing</span><span class="op" id="6647668">.</span><span class="ident" id="6647669">T</span><span class="op" id="6647670">,</span>&nbsp;<span class="ident" id="6647672">file</span>&nbsp;<span class="op" id="6647677">*</span><span class="ident" id="6647678">ast</span><span class="op" id="6647681">.</span><span class="ident" id="6647682">File</span><span class="op" id="6647686">,</span>&nbsp;<span class="ident" id="6647688">fieldname</span><span class="op" id="6647697">,</span>&nbsp;<span class="ident" id="6647699">lead</span><span class="op" id="6647703">,</span>&nbsp;<span class="ident" id="6647705">line</span>&nbsp;<span class="builtintype" id="6647710">string</span><span class="op" id="6647716">)</span>&nbsp;<span class="op" id="6647718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647721">f</span>&nbsp;<span class="op" id="6647723">:=</span>&nbsp;<span class="ident" id="6647726">getField</span><span class="op" id="6647734">(</span><span class="ident" id="6647735">file</span><span class="op" id="6647739">,</span>&nbsp;<span class="ident" id="6647741">fieldname</span><span class="op" id="6647750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647753">if</span>&nbsp;<span class="ident" id="6647756">f</span>&nbsp;<span class="op" id="6647758">==</span>&nbsp;<span class="builtintype" id="6647761">nil</span>&nbsp;<span class="op" id="6647765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647769">t</span><span class="op" id="6647770">.</span><span class="ident" id="6647771">Fatalf</span><span class="op" id="6647777">(</span><span class="string" id="6647778">&#34;field&nbsp;not&nbsp;found:&nbsp;%s&#34;</span><span class="op" id="6647799">,</span>&nbsp;<span class="ident" id="6647801">fieldname</span><span class="op" id="6647810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647813">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647816">if</span>&nbsp;<span class="ident" id="6647819">got</span>&nbsp;<span class="op" id="6647823">:=</span>&nbsp;<span class="ident" id="6647826">commentText</span><span class="op" id="6647837">(</span><span class="ident" id="6647838">f</span><span class="op" id="6647839">.</span><span class="ident" id="6647840">Doc</span><span class="op" id="6647843">)</span><span class="op" id="6647844">;</span>&nbsp;<span class="ident" id="6647846">got</span>&nbsp;<span class="op" id="6647850">!=</span>&nbsp;<span class="ident" id="6647853">lead</span>&nbsp;<span class="op" id="6647858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647862">t</span><span class="op" id="6647863">.</span><span class="ident" id="6647864">Errorf</span><span class="op" id="6647870">(</span><span class="string" id="6647871">&#34;got&nbsp;lead&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6647905">,</span>&nbsp;<span class="ident" id="6647907">got</span><span class="op" id="6647910">,</span>&nbsp;<span class="ident" id="6647912">lead</span><span class="op" id="6647916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6647919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6647922">if</span>&nbsp;<span class="ident" id="6647925">got</span>&nbsp;<span class="op" id="6647929">:=</span>&nbsp;<span class="ident" id="6647932">commentText</span><span class="op" id="6647943">(</span><span class="ident" id="6647944">f</span><span class="op" id="6647945">.</span><span class="ident" id="6647946">Comment</span><span class="op" id="6647953">)</span><span class="op" id="6647954">;</span>&nbsp;<span class="ident" id="6647956">got</span>&nbsp;<span class="op" id="6647960">!=</span>&nbsp;<span class="ident" id="6647963">line</span>&nbsp;<span class="op" id="6647968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6647972">t</span><span class="op" id="6647973">.</span><span class="ident" id="6647974">Errorf</span><span class="op" id="6647980">(</span><span class="string" id="6647981">&#34;got&nbsp;line&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6648015">,</span>&nbsp;<span class="ident" id="6648017">got</span><span class="op" id="6648020">,</span>&nbsp;<span class="ident" id="6648022">line</span><span class="op" id="6648026">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648029">}</span><br>
<span class="lineno"></span><span class="op" id="6648031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6648034">func</span>&nbsp;<span class="ident" id="6648039">TestLeadAndLineComments</span><span class="op" id="6648062">(</span><span class="ident" id="6648063">t</span>&nbsp;<span class="op" id="6648065">*</span><span class="ident" id="6648066">testing</span><span class="op" id="6648073">.</span><span class="ident" id="6648074">T</span><span class="op" id="6648075">)</span>&nbsp;<span class="op" id="6648077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648080">f</span><span class="op" id="6648081">,</span>&nbsp;<span class="ident" id="6648083">err</span>&nbsp;<span class="op" id="6648087">:=</span>&nbsp;<span class="ident" id="6648090">ParseFile</span><span class="op" id="6648099">(</span><span class="ident" id="6648100">fset</span><span class="op" id="6648104">,</span>&nbsp;<span class="string" id="6648106">&#34;&#34;</span><span class="op" id="6648108">,</span>&nbsp;<span class="string" id="6648110">`<br>
<span class="lineno">425</span>package&nbsp;p<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*/<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;F1&nbsp;int&nbsp;&nbsp;/*&nbsp;F1&nbsp;*/&nbsp;//&nbsp;line&nbsp;comment<br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;F2&nbsp;lead<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;F2&nbsp;int&nbsp;&nbsp;//&nbsp;F2&nbsp;line&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;f3&nbsp;lead&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;f3&nbsp;int&nbsp;&nbsp;//&nbsp;f3&nbsp;line&nbsp;comment<br>
<span class="lineno">435</span>}<br>
<span class="lineno"></span>`</span><span class="op" id="6648302">,</span>&nbsp;<span class="ident" id="6648304">ParseComments</span><span class="op" id="6648317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648320">if</span>&nbsp;<span class="ident" id="6648323">err</span>&nbsp;<span class="op" id="6648327">!=</span>&nbsp;<span class="builtintype" id="6648330">nil</span>&nbsp;<span class="op" id="6648334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648338">t</span><span class="op" id="6648339">.</span><span class="ident" id="6648340">Fatal</span><span class="op" id="6648345">(</span><span class="ident" id="6648346">err</span><span class="op" id="6648349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648352">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648355">checkFieldComments</span><span class="op" id="6648373">(</span><span class="ident" id="6648374">t</span><span class="op" id="6648375">,</span>&nbsp;<span class="ident" id="6648377">f</span><span class="op" id="6648378">,</span>&nbsp;<span class="string" id="6648380">&#34;T.F1&#34;</span><span class="op" id="6648386">,</span>&nbsp;<span class="string" id="6648388">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="6648413">,</span>&nbsp;<span class="string" id="6648415">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="6648440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648443">checkFieldComments</span><span class="op" id="6648461">(</span><span class="ident" id="6648462">t</span><span class="op" id="6648463">,</span>&nbsp;<span class="ident" id="6648465">f</span><span class="op" id="6648466">,</span>&nbsp;<span class="string" id="6648468">&#34;T.F2&#34;</span><span class="op" id="6648474">,</span>&nbsp;<span class="string" id="6648476">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="6648498">,</span>&nbsp;<span class="string" id="6648500">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="6648520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648523">checkFieldComments</span><span class="op" id="6648541">(</span><span class="ident" id="6648542">t</span><span class="op" id="6648543">,</span>&nbsp;<span class="ident" id="6648545">f</span><span class="op" id="6648546">,</span>&nbsp;<span class="string" id="6648548">&#34;T.f3&#34;</span><span class="op" id="6648554">,</span>&nbsp;<span class="string" id="6648556">&#34;//&nbsp;f3&nbsp;lead&nbsp;comment&#34;</span><span class="op" id="6648576">,</span>&nbsp;<span class="string" id="6648578">&#34;//&nbsp;f3&nbsp;line&nbsp;comment&#34;</span><span class="op" id="6648598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648601">ast</span><span class="op" id="6648604">.</span><span class="ident" id="6648605">FileExports</span><span class="op" id="6648616">(</span><span class="ident" id="6648617">f</span><span class="op" id="6648618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648621">checkFieldComments</span><span class="op" id="6648639">(</span><span class="ident" id="6648640">t</span><span class="op" id="6648641">,</span>&nbsp;<span class="ident" id="6648643">f</span><span class="op" id="6648644">,</span>&nbsp;<span class="string" id="6648646">&#34;T.F1&#34;</span><span class="op" id="6648652">,</span>&nbsp;<span class="string" id="6648654">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="6648679">,</span>&nbsp;<span class="string" id="6648681">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="6648706">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648709">checkFieldComments</span><span class="op" id="6648727">(</span><span class="ident" id="6648728">t</span><span class="op" id="6648729">,</span>&nbsp;<span class="ident" id="6648731">f</span><span class="op" id="6648732">,</span>&nbsp;<span class="string" id="6648734">&#34;T.F2&#34;</span><span class="op" id="6648740">,</span>&nbsp;<span class="string" id="6648742">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="6648764">,</span>&nbsp;<span class="string" id="6648766">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="6648786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6648789">if</span>&nbsp;<span class="ident" id="6648792">getField</span><span class="op" id="6648800">(</span><span class="ident" id="6648801">f</span><span class="op" id="6648802">,</span>&nbsp;<span class="string" id="6648804">&#34;T.f3&#34;</span><span class="op" id="6648810">)</span>&nbsp;<span class="op" id="6648812">!=</span>&nbsp;<span class="builtintype" id="6648815">nil</span>&nbsp;<span class="op" id="6648819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6648823">t</span><span class="op" id="6648824">.</span><span class="ident" id="6648825">Error</span><span class="op" id="6648830">(</span><span class="string" id="6648831">&#34;not&nbsp;expected&nbsp;to&nbsp;find&nbsp;T.f3&#34;</span><span class="op" id="6648858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6648861">}</span><br>
<span class="lineno"></span><span class="op" id="6648863">}</span>
</div>
</body>
</html>
