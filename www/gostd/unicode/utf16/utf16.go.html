<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5408868">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5408924">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5408978">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5409029">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="5409100">package</span>&nbsp;<span class="ident" id="5409108">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5409115">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5409178">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="5409233">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5409309">const</span>&nbsp;<span class="op" id="5409315">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5409318">replacementChar</span>&nbsp;<span class="op" id="5409334">=</span>&nbsp;<span class="string" id="5409336">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5409349">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5409383">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5409399">=</span>&nbsp;<span class="string" id="5409401">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="5409414">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="5409451">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5409454">const</span>&nbsp;<span class="op" id="5409460">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5409463">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5409517">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5409570">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5409615">surr1</span>&nbsp;<span class="op" id="5409621">=</span>&nbsp;<span class="num" id="5409623">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5409631">surr2</span>&nbsp;<span class="op" id="5409637">=</span>&nbsp;<span class="num" id="5409639">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5409647">surr3</span>&nbsp;<span class="op" id="5409653">=</span>&nbsp;<span class="num" id="5409655">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5409664">surrSelf</span>&nbsp;<span class="op" id="5409673">=</span>&nbsp;<span class="num" id="5409675">0x10000</span><br>
<span class="lineno"></span><span class="op" id="5409683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5409686">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="5409750">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="5409785">func</span>&nbsp;<span class="ident" id="5409790">IsSurrogate</span><span class="op" id="5409801">(</span><span class="ident" id="5409802">r</span>&nbsp;<span class="builtintype" id="5409804">rune</span><span class="op" id="5409808">)</span>&nbsp;<span class="builtintype" id="5409810">bool</span>&nbsp;<span class="op" id="5409815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5409818">return</span>&nbsp;<span class="ident" id="5409825">surr1</span>&nbsp;<span class="op" id="5409831">&lt;=</span>&nbsp;<span class="ident" id="5409834">r</span>&nbsp;<span class="op" id="5409836">&amp;&amp;</span>&nbsp;<span class="ident" id="5409839">r</span>&nbsp;<span class="op" id="5409841">&lt;</span>&nbsp;<span class="ident" id="5409843">surr3</span><br>
<span class="lineno"></span><span class="op" id="5409849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5409852">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="5409915">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="5409987">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="5410033">func</span>&nbsp;<span class="ident" id="5410038">DecodeRune</span><span class="op" id="5410048">(</span><span class="ident" id="5410049">r1</span><span class="op" id="5410051">,</span>&nbsp;<span class="ident" id="5410053">r2</span>&nbsp;<span class="builtintype" id="5410056">rune</span><span class="op" id="5410060">)</span>&nbsp;<span class="builtintype" id="5410062">rune</span>&nbsp;<span class="op" id="5410067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410070">if</span>&nbsp;<span class="ident" id="5410073">surr1</span>&nbsp;<span class="op" id="5410079">&lt;=</span>&nbsp;<span class="ident" id="5410082">r1</span>&nbsp;<span class="op" id="5410085">&amp;&amp;</span>&nbsp;<span class="ident" id="5410088">r1</span>&nbsp;<span class="op" id="5410091">&lt;</span>&nbsp;<span class="ident" id="5410093">surr2</span>&nbsp;<span class="op" id="5410099">&amp;&amp;</span>&nbsp;<span class="ident" id="5410102">surr2</span>&nbsp;<span class="op" id="5410108">&lt;=</span>&nbsp;<span class="ident" id="5410111">r2</span>&nbsp;<span class="op" id="5410114">&amp;&amp;</span>&nbsp;<span class="ident" id="5410117">r2</span>&nbsp;<span class="op" id="5410120">&lt;</span>&nbsp;<span class="ident" id="5410122">surr3</span>&nbsp;<span class="op" id="5410128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410132">return</span>&nbsp;<span class="op" id="5410139">(</span><span class="ident" id="5410140">r1</span><span class="op" id="5410142">-</span><span class="ident" id="5410143">surr1</span><span class="op" id="5410148">)</span><span class="op" id="5410149">&lt;&lt;</span><span class="num" id="5410151">10</span>&nbsp;<span class="op" id="5410154">|</span>&nbsp;<span class="op" id="5410156">(</span><span class="ident" id="5410157">r2</span>&nbsp;<span class="op" id="5410160">-</span>&nbsp;<span class="ident" id="5410162">surr2</span><span class="op" id="5410167">)</span>&nbsp;<span class="op" id="5410169">+</span>&nbsp;<span class="num" id="5410171">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5410180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410183">return</span>&nbsp;<span class="ident" id="5410190">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="5410206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5410209">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="5410284">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="5410360">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="5410398">func</span>&nbsp;<span class="ident" id="5410403">EncodeRune</span><span class="op" id="5410413">(</span><span class="ident" id="5410414">r</span>&nbsp;<span class="builtintype" id="5410416">rune</span><span class="op" id="5410420">)</span>&nbsp;<span class="op" id="5410422">(</span><span class="ident" id="5410423">r1</span><span class="op" id="5410425">,</span>&nbsp;<span class="ident" id="5410427">r2</span>&nbsp;<span class="builtintype" id="5410430">rune</span><span class="op" id="5410434">)</span>&nbsp;<span class="op" id="5410436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410439">if</span>&nbsp;<span class="ident" id="5410442">r</span>&nbsp;<span class="op" id="5410444">&lt;</span>&nbsp;<span class="ident" id="5410446">surrSelf</span>&nbsp;<span class="op" id="5410455">||</span>&nbsp;<span class="ident" id="5410458">r</span>&nbsp;<span class="op" id="5410460">&gt;</span>&nbsp;<span class="ident" id="5410462">maxRune</span>&nbsp;<span class="op" id="5410470">||</span>&nbsp;<span class="ident" id="5410473">IsSurrogate</span><span class="op" id="5410484">(</span><span class="ident" id="5410485">r</span><span class="op" id="5410486">)</span>&nbsp;<span class="op" id="5410488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410492">return</span>&nbsp;<span class="ident" id="5410499">replacementChar</span><span class="op" id="5410514">,</span>&nbsp;<span class="ident" id="5410516">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5410533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410536">r</span>&nbsp;<span class="op" id="5410538">-=</span>&nbsp;<span class="ident" id="5410541">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410551">return</span>&nbsp;<span class="ident" id="5410558">surr1</span>&nbsp;<span class="op" id="5410564">+</span>&nbsp;<span class="op" id="5410566">(</span><span class="ident" id="5410567">r</span><span class="op" id="5410568">&gt;&gt;</span><span class="num" id="5410570">10</span><span class="op" id="5410572">)</span><span class="op" id="5410573">&amp;</span><span class="num" id="5410574">0x3ff</span><span class="op" id="5410579">,</span>&nbsp;<span class="ident" id="5410581">surr2</span>&nbsp;<span class="op" id="5410587">+</span>&nbsp;<span class="ident" id="5410589">r</span><span class="op" id="5410590">&amp;</span><span class="num" id="5410591">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="5410597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="5410600">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5410676">func</span>&nbsp;<span class="ident" id="5410681">Encode</span><span class="op" id="5410687">(</span><span class="ident" id="5410688">s</span>&nbsp;<span class="op" id="5410690">[</span><span class="op" id="5410691">]</span><span class="builtintype" id="5410692">rune</span><span class="op" id="5410696">)</span>&nbsp;<span class="op" id="5410698">[</span><span class="op" id="5410699">]</span><span class="builtintype" id="5410700">uint16</span>&nbsp;<span class="op" id="5410707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410710">n</span>&nbsp;<span class="op" id="5410712">:=</span>&nbsp;<span class="builtinfunc" id="5410715">len</span><span class="op" id="5410718">(</span><span class="ident" id="5410719">s</span><span class="op" id="5410720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410723">for</span>&nbsp;<span class="ident" id="5410727">_</span><span class="op" id="5410728">,</span>&nbsp;<span class="ident" id="5410730">v</span>&nbsp;<span class="op" id="5410732">:=</span>&nbsp;<span class="keyword" id="5410735">range</span>&nbsp;<span class="ident" id="5410741">s</span>&nbsp;<span class="op" id="5410743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410747">if</span>&nbsp;<span class="ident" id="5410750">v</span>&nbsp;<span class="op" id="5410752">&gt;=</span>&nbsp;<span class="ident" id="5410755">surrSelf</span>&nbsp;<span class="op" id="5410764">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410769">n</span><span class="op" id="5410770">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5410775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5410778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410782">a</span>&nbsp;<span class="op" id="5410784">:=</span>&nbsp;<span class="builtinfunc" id="5410787">make</span><span class="op" id="5410791">(</span><span class="op" id="5410792">[</span><span class="op" id="5410793">]</span><span class="builtintype" id="5410794">uint16</span><span class="op" id="5410800">,</span>&nbsp;<span class="ident" id="5410802">n</span><span class="op" id="5410803">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410806">n</span>&nbsp;<span class="op" id="5410808">=</span>&nbsp;<span class="num" id="5410810">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410813">for</span>&nbsp;<span class="ident" id="5410817">_</span><span class="op" id="5410818">,</span>&nbsp;<span class="ident" id="5410820">v</span>&nbsp;<span class="op" id="5410822">:=</span>&nbsp;<span class="keyword" id="5410825">range</span>&nbsp;<span class="ident" id="5410831">s</span>&nbsp;<span class="op" id="5410833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410837">switch</span>&nbsp;<span class="op" id="5410844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410848">case</span>&nbsp;<span class="ident" id="5410853">v</span>&nbsp;<span class="op" id="5410855">&lt;</span>&nbsp;<span class="num" id="5410857">0</span><span class="op" id="5410858">,</span>&nbsp;<span class="ident" id="5410860">surr1</span>&nbsp;<span class="op" id="5410866">&lt;=</span>&nbsp;<span class="ident" id="5410869">v</span>&nbsp;<span class="op" id="5410871">&amp;&amp;</span>&nbsp;<span class="ident" id="5410874">v</span>&nbsp;<span class="op" id="5410876">&lt;</span>&nbsp;<span class="ident" id="5410878">surr3</span><span class="op" id="5410883">,</span>&nbsp;<span class="ident" id="5410885">v</span>&nbsp;<span class="op" id="5410887">&gt;</span>&nbsp;<span class="ident" id="5410889">maxRune</span><span class="op" id="5410896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410901">v</span>&nbsp;<span class="op" id="5410903">=</span>&nbsp;<span class="ident" id="5410905">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410924">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410938">case</span>&nbsp;<span class="ident" id="5410943">v</span>&nbsp;<span class="op" id="5410945">&lt;</span>&nbsp;<span class="ident" id="5410947">surrSelf</span><span class="op" id="5410955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410960">a</span><span class="op" id="5410961">[</span><span class="ident" id="5410962">n</span><span class="op" id="5410963">]</span>&nbsp;<span class="op" id="5410965">=</span>&nbsp;<span class="builtintype" id="5410967">uint16</span><span class="op" id="5410973">(</span><span class="ident" id="5410974">v</span><span class="op" id="5410975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410980">n</span><span class="op" id="5410981">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5410986">default</span><span class="op" id="5410993">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5410998">r1</span><span class="op" id="5411000">,</span>&nbsp;<span class="ident" id="5411002">r2</span>&nbsp;<span class="op" id="5411005">:=</span>&nbsp;<span class="ident" id="5411008">EncodeRune</span><span class="op" id="5411018">(</span><span class="ident" id="5411019">v</span><span class="op" id="5411020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411025">a</span><span class="op" id="5411026">[</span><span class="ident" id="5411027">n</span><span class="op" id="5411028">]</span>&nbsp;<span class="op" id="5411030">=</span>&nbsp;<span class="builtintype" id="5411032">uint16</span><span class="op" id="5411038">(</span><span class="ident" id="5411039">r1</span><span class="op" id="5411041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411046">a</span><span class="op" id="5411047">[</span><span class="ident" id="5411048">n</span><span class="op" id="5411049">+</span><span class="num" id="5411050">1</span><span class="op" id="5411051">]</span>&nbsp;<span class="op" id="5411053">=</span>&nbsp;<span class="builtintype" id="5411055">uint16</span><span class="op" id="5411061">(</span><span class="ident" id="5411062">r2</span><span class="op" id="5411064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411069">n</span>&nbsp;<span class="op" id="5411071">+=</span>&nbsp;<span class="num" id="5411074">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411078">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411084">return</span>&nbsp;<span class="ident" id="5411091">a</span><span class="op" id="5411092">[</span><span class="num" id="5411093">0</span><span class="op" id="5411094">:</span><span class="ident" id="5411095">n</span><span class="op" id="5411096">]</span><br>
<span class="lineno"></span><span class="op" id="5411098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5411101">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="5411163">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5411192">func</span>&nbsp;<span class="ident" id="5411197">Decode</span><span class="op" id="5411203">(</span><span class="ident" id="5411204">s</span>&nbsp;<span class="op" id="5411206">[</span><span class="op" id="5411207">]</span><span class="builtintype" id="5411208">uint16</span><span class="op" id="5411214">)</span>&nbsp;<span class="op" id="5411216">[</span><span class="op" id="5411217">]</span><span class="builtintype" id="5411218">rune</span>&nbsp;<span class="op" id="5411223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411226">a</span>&nbsp;<span class="op" id="5411228">:=</span>&nbsp;<span class="builtinfunc" id="5411231">make</span><span class="op" id="5411235">(</span><span class="op" id="5411236">[</span><span class="op" id="5411237">]</span><span class="builtintype" id="5411238">rune</span><span class="op" id="5411242">,</span>&nbsp;<span class="builtinfunc" id="5411244">len</span><span class="op" id="5411247">(</span><span class="ident" id="5411248">s</span><span class="op" id="5411249">)</span><span class="op" id="5411250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411253">n</span>&nbsp;<span class="op" id="5411255">:=</span>&nbsp;<span class="num" id="5411258">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411261">for</span>&nbsp;<span class="ident" id="5411265">i</span>&nbsp;<span class="op" id="5411267">:=</span>&nbsp;<span class="num" id="5411270">0</span><span class="op" id="5411271">;</span>&nbsp;<span class="ident" id="5411273">i</span>&nbsp;<span class="op" id="5411275">&lt;</span>&nbsp;<span class="builtinfunc" id="5411277">len</span><span class="op" id="5411280">(</span><span class="ident" id="5411281">s</span><span class="op" id="5411282">)</span><span class="op" id="5411283">;</span>&nbsp;<span class="ident" id="5411285">i</span><span class="op" id="5411286">++</span>&nbsp;<span class="op" id="5411289">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411293">switch</span>&nbsp;<span class="ident" id="5411300">r</span>&nbsp;<span class="op" id="5411302">:=</span>&nbsp;<span class="ident" id="5411305">s</span><span class="op" id="5411306">[</span><span class="ident" id="5411307">i</span><span class="op" id="5411308">]</span><span class="op" id="5411309">;</span>&nbsp;<span class="op" id="5411311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411315">case</span>&nbsp;<span class="ident" id="5411320">surr1</span>&nbsp;<span class="op" id="5411326">&lt;=</span>&nbsp;<span class="ident" id="5411329">r</span>&nbsp;<span class="op" id="5411331">&amp;&amp;</span>&nbsp;<span class="ident" id="5411334">r</span>&nbsp;<span class="op" id="5411336">&lt;</span>&nbsp;<span class="ident" id="5411338">surr2</span>&nbsp;<span class="op" id="5411344">&amp;&amp;</span>&nbsp;<span class="ident" id="5411347">i</span><span class="op" id="5411348">+</span><span class="num" id="5411349">1</span>&nbsp;<span class="op" id="5411351">&lt;</span>&nbsp;<span class="builtinfunc" id="5411353">len</span><span class="op" id="5411356">(</span><span class="ident" id="5411357">s</span><span class="op" id="5411358">)</span>&nbsp;<span class="op" id="5411360">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411366">surr2</span>&nbsp;<span class="op" id="5411372">&lt;=</span>&nbsp;<span class="ident" id="5411375">s</span><span class="op" id="5411376">[</span><span class="ident" id="5411377">i</span><span class="op" id="5411378">+</span><span class="num" id="5411379">1</span><span class="op" id="5411380">]</span>&nbsp;<span class="op" id="5411382">&amp;&amp;</span>&nbsp;<span class="ident" id="5411385">s</span><span class="op" id="5411386">[</span><span class="ident" id="5411387">i</span><span class="op" id="5411388">+</span><span class="num" id="5411389">1</span><span class="op" id="5411390">]</span>&nbsp;<span class="op" id="5411392">&lt;</span>&nbsp;<span class="ident" id="5411394">surr3</span><span class="op" id="5411399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411404">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411435">a</span><span class="op" id="5411436">[</span><span class="ident" id="5411437">n</span><span class="op" id="5411438">]</span>&nbsp;<span class="op" id="5411440">=</span>&nbsp;<span class="ident" id="5411442">DecodeRune</span><span class="op" id="5411452">(</span><span class="builtintype" id="5411453">rune</span><span class="op" id="5411457">(</span><span class="ident" id="5411458">r</span><span class="op" id="5411459">)</span><span class="op" id="5411460">,</span>&nbsp;<span class="builtintype" id="5411462">rune</span><span class="op" id="5411466">(</span><span class="ident" id="5411467">s</span><span class="op" id="5411468">[</span><span class="ident" id="5411469">i</span><span class="op" id="5411470">+</span><span class="num" id="5411471">1</span><span class="op" id="5411472">]</span><span class="op" id="5411473">)</span><span class="op" id="5411474">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411479">i</span><span class="op" id="5411480">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411486">n</span><span class="op" id="5411487">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411492">case</span>&nbsp;<span class="ident" id="5411497">surr1</span>&nbsp;<span class="op" id="5411503">&lt;=</span>&nbsp;<span class="ident" id="5411506">r</span>&nbsp;<span class="op" id="5411508">&amp;&amp;</span>&nbsp;<span class="ident" id="5411511">r</span>&nbsp;<span class="op" id="5411513">&lt;</span>&nbsp;<span class="ident" id="5411515">surr3</span><span class="op" id="5411520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411525">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411558">a</span><span class="op" id="5411559">[</span><span class="ident" id="5411560">n</span><span class="op" id="5411561">]</span>&nbsp;<span class="op" id="5411563">=</span>&nbsp;<span class="ident" id="5411565">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411584">n</span><span class="op" id="5411585">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411590">default</span><span class="op" id="5411597">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5411602">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411620">a</span><span class="op" id="5411621">[</span><span class="ident" id="5411622">n</span><span class="op" id="5411623">]</span>&nbsp;<span class="op" id="5411625">=</span>&nbsp;<span class="builtintype" id="5411627">rune</span><span class="op" id="5411631">(</span><span class="ident" id="5411632">r</span><span class="op" id="5411633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5411638">n</span><span class="op" id="5411639">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5411647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5411650">return</span>&nbsp;<span class="ident" id="5411657">a</span><span class="op" id="5411658">[</span><span class="num" id="5411659">0</span><span class="op" id="5411660">:</span><span class="ident" id="5411661">n</span><span class="op" id="5411662">]</span><br>
<span class="lineno"></span><span class="op" id="5411664">}</span>
</div>
</body>
</html>
