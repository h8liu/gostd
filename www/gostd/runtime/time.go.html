<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1926656">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1926711">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1926765">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1926816">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1926869">package</span>&nbsp;<span class="ident" id="1926877">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1926886">import</span>&nbsp;<span class="string" id="1926893">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1926903">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1926955">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1927021">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1927091">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1927163">type</span>&nbsp;<span class="ident" id="1927168">timer</span>&nbsp;<span class="keyword" id="1927174">struct</span>&nbsp;<span class="op" id="1927181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927184">i</span>&nbsp;<span class="builtintype" id="1927186">int</span>&nbsp;<span class="comment" id="1927190">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1927206">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1927281">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1927352">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927395">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1927402">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927409">period</span>&nbsp;<span class="ident" id="1927416">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927423">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1927430">func</span><span class="op" id="1927434">(</span><span class="keyword" id="1927435">interface</span><span class="op" id="1927444">{</span><span class="op" id="1927445">}</span><span class="op" id="1927446">,</span>&nbsp;<span class="builtintype" id="1927448">uintptr</span><span class="op" id="1927455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927458">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1927465">interface</span><span class="op" id="1927474">{</span><span class="op" id="1927475">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927478">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1927485">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1927493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1927496">var</span>&nbsp;<span class="ident" id="1927500">timers</span>&nbsp;<span class="keyword" id="1927507">struct</span>&nbsp;<span class="op" id="1927514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927517">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1927530">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927537">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1927550">*</span><span class="ident" id="1927551">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927554">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1927567">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927573">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1927586">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927592">rescheduling</span>&nbsp;<span class="builtintype" id="1927605">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927611">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1927624">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927630">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1927643">[</span><span class="op" id="1927644">]</span><span class="op" id="1927645">*</span><span class="ident" id="1927646">timer</span><br>
<span class="lineno"></span><span class="op" id="1927652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1927655">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1927714">var</span>&nbsp;<span class="ident" id="1927718">faketime</span>&nbsp;<span class="ident" id="1927727">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1927734">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1927756">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1927812">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1927853">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1927927">func</span>&nbsp;<span class="ident" id="1927932">timeSleep</span><span class="op" id="1927941">(</span><span class="ident" id="1927942">ns</span>&nbsp;<span class="ident" id="1927945">int64</span><span class="op" id="1927950">)</span>&nbsp;<span class="op" id="1927952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1927955">if</span>&nbsp;<span class="ident" id="1927958">ns</span>&nbsp;<span class="op" id="1927961">&lt;=</span>&nbsp;<span class="num" id="1927964">0</span>&nbsp;<span class="op" id="1927966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1927970">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1927978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927982">t</span>&nbsp;<span class="op" id="1927984">:=</span>&nbsp;<span class="builtinfunc" id="1927987">new</span><span class="op" id="1927990">(</span><span class="ident" id="1927991">timer</span><span class="op" id="1927996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1927999">t</span><span class="op" id="1928000">.</span><span class="ident" id="1928001">when</span>&nbsp;<span class="op" id="1928006">=</span>&nbsp;<span class="ident" id="1928008">nanotime</span><span class="op" id="1928016">(</span><span class="op" id="1928017">)</span>&nbsp;<span class="op" id="1928019">+</span>&nbsp;<span class="ident" id="1928021">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928025">t</span><span class="op" id="1928026">.</span><span class="ident" id="1928027">f</span>&nbsp;<span class="op" id="1928029">=</span>&nbsp;<span class="ident" id="1928031">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928047">t</span><span class="op" id="1928048">.</span><span class="ident" id="1928049">arg</span>&nbsp;<span class="op" id="1928053">=</span>&nbsp;<span class="ident" id="1928055">getg</span><span class="op" id="1928059">(</span><span class="op" id="1928060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928063">lock</span><span class="op" id="1928067">(</span><span class="op" id="1928068">&amp;</span><span class="ident" id="1928069">timers</span><span class="op" id="1928075">.</span><span class="ident" id="1928076">lock</span><span class="op" id="1928080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928083">addtimerLocked</span><span class="op" id="1928097">(</span><span class="ident" id="1928098">t</span><span class="op" id="1928099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928102">goparkunlock</span><span class="op" id="1928114">(</span><span class="op" id="1928115">&amp;</span><span class="ident" id="1928116">timers</span><span class="op" id="1928122">.</span><span class="ident" id="1928123">lock</span><span class="op" id="1928127">,</span>&nbsp;<span class="string" id="1928129">&#34;sleep&#34;</span><span class="op" id="1928136">)</span><br>
<span class="lineno"></span><span class="op" id="1928138">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1928141">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1928181">func</span>&nbsp;<span class="ident" id="1928186">startTimer</span><span class="op" id="1928196">(</span><span class="ident" id="1928197">t</span>&nbsp;<span class="op" id="1928199">*</span><span class="ident" id="1928200">timer</span><span class="op" id="1928205">)</span>&nbsp;<span class="op" id="1928207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1928210">if</span>&nbsp;<span class="ident" id="1928213">raceenabled</span>&nbsp;<span class="op" id="1928225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928229">racerelease</span><span class="op" id="1928240">(</span><span class="ident" id="1928241">unsafe</span><span class="op" id="1928247">.</span><span class="ident" id="1928248">Pointer</span><span class="op" id="1928255">(</span><span class="ident" id="1928256">t</span><span class="op" id="1928257">)</span><span class="op" id="1928258">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1928261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928264">addtimer</span><span class="op" id="1928272">(</span><span class="ident" id="1928273">t</span><span class="op" id="1928274">)</span><br>
<span class="lineno"></span><span class="op" id="1928276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1928279">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1928338">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1928405">func</span>&nbsp;<span class="ident" id="1928410">stopTimer</span><span class="op" id="1928419">(</span><span class="ident" id="1928420">t</span>&nbsp;<span class="op" id="1928422">*</span><span class="ident" id="1928423">timer</span><span class="op" id="1928428">)</span>&nbsp;<span class="builtintype" id="1928430">bool</span>&nbsp;<span class="op" id="1928435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1928438">return</span>&nbsp;<span class="ident" id="1928445">deltimer</span><span class="op" id="1928453">(</span><span class="ident" id="1928454">t</span><span class="op" id="1928455">)</span><br>
<span class="lineno"></span><span class="op" id="1928457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1928460">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1928476">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1928504">func</span>&nbsp;<span class="ident" id="1928509">goroutineReady</span><span class="op" id="1928523">(</span><span class="ident" id="1928524">arg</span>&nbsp;<span class="keyword" id="1928528">interface</span><span class="op" id="1928537">{</span><span class="op" id="1928538">}</span><span class="op" id="1928539">,</span>&nbsp;<span class="ident" id="1928541">seq</span>&nbsp;<span class="builtintype" id="1928545">uintptr</span><span class="op" id="1928552">)</span>&nbsp;<span class="op" id="1928554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928557">goready</span><span class="op" id="1928564">(</span><span class="ident" id="1928565">arg</span><span class="op" id="1928568">.</span><span class="op" id="1928569">(</span><span class="op" id="1928570">*</span><span class="ident" id="1928571">g</span><span class="op" id="1928572">)</span><span class="op" id="1928573">)</span><br>
<span class="lineno">80</span><span class="op" id="1928575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1928578">func</span>&nbsp;<span class="ident" id="1928583">addtimer</span><span class="op" id="1928591">(</span><span class="ident" id="1928592">t</span>&nbsp;<span class="op" id="1928594">*</span><span class="ident" id="1928595">timer</span><span class="op" id="1928600">)</span>&nbsp;<span class="op" id="1928602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928605">lock</span><span class="op" id="1928609">(</span><span class="op" id="1928610">&amp;</span><span class="ident" id="1928611">timers</span><span class="op" id="1928617">.</span><span class="ident" id="1928618">lock</span><span class="op" id="1928622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928625">addtimerLocked</span><span class="op" id="1928639">(</span><span class="ident" id="1928640">t</span><span class="op" id="1928641">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928644">unlock</span><span class="op" id="1928650">(</span><span class="op" id="1928651">&amp;</span><span class="ident" id="1928652">timers</span><span class="op" id="1928658">.</span><span class="ident" id="1928659">lock</span><span class="op" id="1928663">)</span><br>
<span class="lineno"></span><span class="op" id="1928665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1928668">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1928729">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1928784">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1928806">func</span>&nbsp;<span class="ident" id="1928811">addtimerLocked</span><span class="op" id="1928825">(</span><span class="ident" id="1928826">t</span>&nbsp;<span class="op" id="1928828">*</span><span class="ident" id="1928829">timer</span><span class="op" id="1928834">)</span>&nbsp;<span class="op" id="1928836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1928839">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1928906">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtimeÂ·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1928979">if</span>&nbsp;<span class="ident" id="1928982">t</span><span class="op" id="1928983">.</span><span class="ident" id="1928984">when</span>&nbsp;<span class="op" id="1928989">&lt;</span>&nbsp;<span class="num" id="1928991">0</span>&nbsp;<span class="op" id="1928993">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1928997">t</span><span class="op" id="1928998">.</span><span class="ident" id="1928999">when</span>&nbsp;<span class="op" id="1929004">=</span>&nbsp;<span class="num" id="1929006">1</span><span class="op" id="1929007">&lt;&lt;</span><span class="num" id="1929009">63</span>&nbsp;<span class="op" id="1929012">-</span>&nbsp;<span class="num" id="1929014">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929020">t</span><span class="op" id="1929021">.</span><span class="ident" id="1929022">i</span>&nbsp;<span class="op" id="1929024">=</span>&nbsp;<span class="builtinfunc" id="1929026">len</span><span class="op" id="1929029">(</span><span class="ident" id="1929030">timers</span><span class="op" id="1929036">.</span><span class="ident" id="1929037">t</span><span class="op" id="1929038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929041">timers</span><span class="op" id="1929047">.</span><span class="ident" id="1929048">t</span>&nbsp;<span class="op" id="1929050">=</span>&nbsp;<span class="builtinfunc" id="1929052">append</span><span class="op" id="1929058">(</span><span class="ident" id="1929059">timers</span><span class="op" id="1929065">.</span><span class="ident" id="1929066">t</span><span class="op" id="1929067">,</span>&nbsp;<span class="ident" id="1929069">t</span><span class="op" id="1929070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929073">siftupTimer</span><span class="op" id="1929084">(</span><span class="ident" id="1929085">t</span><span class="op" id="1929086">.</span><span class="ident" id="1929087">i</span><span class="op" id="1929088">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929091">if</span>&nbsp;<span class="ident" id="1929094">t</span><span class="op" id="1929095">.</span><span class="ident" id="1929096">i</span>&nbsp;<span class="op" id="1929098">==</span>&nbsp;<span class="num" id="1929101">0</span>&nbsp;<span class="op" id="1929103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929107">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929156">if</span>&nbsp;<span class="ident" id="1929159">timers</span><span class="op" id="1929165">.</span><span class="ident" id="1929166">sleeping</span>&nbsp;<span class="op" id="1929175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929180">timers</span><span class="op" id="1929186">.</span><span class="ident" id="1929187">sleeping</span>&nbsp;<span class="op" id="1929196">=</span>&nbsp;<span class="builtintype" id="1929198">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929207">notewakeup</span><span class="op" id="1929217">(</span><span class="op" id="1929218">&amp;</span><span class="ident" id="1929219">timers</span><span class="op" id="1929225">.</span><span class="ident" id="1929226">waitnote</span><span class="op" id="1929234">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929242">if</span>&nbsp;<span class="ident" id="1929245">timers</span><span class="op" id="1929251">.</span><span class="ident" id="1929252">rescheduling</span>&nbsp;<span class="op" id="1929265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929270">timers</span><span class="op" id="1929276">.</span><span class="ident" id="1929277">rescheduling</span>&nbsp;<span class="op" id="1929290">=</span>&nbsp;<span class="builtintype" id="1929292">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929301">goready</span><span class="op" id="1929308">(</span><span class="ident" id="1929309">timers</span><span class="op" id="1929315">.</span><span class="ident" id="1929316">gp</span><span class="op" id="1929318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929322">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929328">if</span>&nbsp;<span class="op" id="1929331">!</span><span class="ident" id="1929332">timers</span><span class="op" id="1929338">.</span><span class="ident" id="1929339">created</span>&nbsp;<span class="op" id="1929347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929351">timers</span><span class="op" id="1929357">.</span><span class="ident" id="1929358">created</span>&nbsp;<span class="op" id="1929366">=</span>&nbsp;<span class="builtintype" id="1929368">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929375">go</span>&nbsp;<span class="ident" id="1929378">timerproc</span><span class="op" id="1929387">(</span><span class="op" id="1929388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929391">}</span><br>
<span class="lineno">115</span><span class="op" id="1929393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1929396">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1929429">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1929504">func</span>&nbsp;<span class="ident" id="1929509">deltimer</span><span class="op" id="1929517">(</span><span class="ident" id="1929518">t</span>&nbsp;<span class="op" id="1929520">*</span><span class="ident" id="1929521">timer</span><span class="op" id="1929526">)</span>&nbsp;<span class="builtintype" id="1929528">bool</span>&nbsp;<span class="op" id="1929533">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929536">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929605">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929664">_</span>&nbsp;<span class="op" id="1929666">=</span>&nbsp;<span class="ident" id="1929668">t</span><span class="op" id="1929669">.</span><span class="ident" id="1929670">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929674">lock</span><span class="op" id="1929678">(</span><span class="op" id="1929679">&amp;</span><span class="ident" id="1929680">timers</span><span class="op" id="1929686">.</span><span class="ident" id="1929687">lock</span><span class="op" id="1929691">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929694">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929743">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929792">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929825">i</span>&nbsp;<span class="op" id="1929827">:=</span>&nbsp;<span class="ident" id="1929830">t</span><span class="op" id="1929831">.</span><span class="ident" id="1929832">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929835">last</span>&nbsp;<span class="op" id="1929840">:=</span>&nbsp;<span class="builtinfunc" id="1929843">len</span><span class="op" id="1929846">(</span><span class="ident" id="1929847">timers</span><span class="op" id="1929853">.</span><span class="ident" id="1929854">t</span><span class="op" id="1929855">)</span>&nbsp;<span class="op" id="1929857">-</span>&nbsp;<span class="num" id="1929859">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929862">if</span>&nbsp;<span class="ident" id="1929865">i</span>&nbsp;<span class="op" id="1929867">&lt;</span>&nbsp;<span class="num" id="1929869">0</span>&nbsp;<span class="op" id="1929871">||</span>&nbsp;<span class="ident" id="1929874">i</span>&nbsp;<span class="op" id="1929876">&gt;</span>&nbsp;<span class="ident" id="1929878">last</span>&nbsp;<span class="op" id="1929883">||</span>&nbsp;<span class="ident" id="1929886">timers</span><span class="op" id="1929892">.</span><span class="ident" id="1929893">t</span><span class="op" id="1929894">[</span><span class="ident" id="1929895">i</span><span class="op" id="1929896">]</span>&nbsp;<span class="op" id="1929898">!=</span>&nbsp;<span class="ident" id="1929901">t</span>&nbsp;<span class="op" id="1929903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929907">unlock</span><span class="op" id="1929913">(</span><span class="op" id="1929914">&amp;</span><span class="ident" id="1929915">timers</span><span class="op" id="1929921">.</span><span class="ident" id="1929922">lock</span><span class="op" id="1929926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929930">return</span>&nbsp;<span class="builtintype" id="1929937">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1929947">if</span>&nbsp;<span class="ident" id="1929950">i</span>&nbsp;<span class="op" id="1929952">!=</span>&nbsp;<span class="ident" id="1929955">last</span>&nbsp;<span class="op" id="1929960">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929964">timers</span><span class="op" id="1929970">.</span><span class="ident" id="1929971">t</span><span class="op" id="1929972">[</span><span class="ident" id="1929973">i</span><span class="op" id="1929974">]</span>&nbsp;<span class="op" id="1929976">=</span>&nbsp;<span class="ident" id="1929978">timers</span><span class="op" id="1929984">.</span><span class="ident" id="1929985">t</span><span class="op" id="1929986">[</span><span class="ident" id="1929987">last</span><span class="op" id="1929991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929995">timers</span><span class="op" id="1930001">.</span><span class="ident" id="1930002">t</span><span class="op" id="1930003">[</span><span class="ident" id="1930004">i</span><span class="op" id="1930005">]</span><span class="op" id="1930006">.</span><span class="ident" id="1930007">i</span>&nbsp;<span class="op" id="1930009">=</span>&nbsp;<span class="ident" id="1930011">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930017">timers</span><span class="op" id="1930023">.</span><span class="ident" id="1930024">t</span><span class="op" id="1930025">[</span><span class="ident" id="1930026">last</span><span class="op" id="1930030">]</span>&nbsp;<span class="op" id="1930032">=</span>&nbsp;<span class="ident" id="1930034">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930039">timers</span><span class="op" id="1930045">.</span><span class="ident" id="1930046">t</span>&nbsp;<span class="op" id="1930048">=</span>&nbsp;<span class="ident" id="1930050">timers</span><span class="op" id="1930056">.</span><span class="ident" id="1930057">t</span><span class="op" id="1930058">[</span><span class="op" id="1930059">:</span><span class="ident" id="1930060">last</span><span class="op" id="1930064">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930067">if</span>&nbsp;<span class="ident" id="1930070">i</span>&nbsp;<span class="op" id="1930072">!=</span>&nbsp;<span class="ident" id="1930075">last</span>&nbsp;<span class="op" id="1930080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930084">siftupTimer</span><span class="op" id="1930095">(</span><span class="ident" id="1930096">i</span><span class="op" id="1930097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930101">siftdownTimer</span><span class="op" id="1930114">(</span><span class="ident" id="1930115">i</span><span class="op" id="1930116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930122">unlock</span><span class="op" id="1930128">(</span><span class="op" id="1930129">&amp;</span><span class="ident" id="1930130">timers</span><span class="op" id="1930136">.</span><span class="ident" id="1930137">lock</span><span class="op" id="1930141">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930144">return</span>&nbsp;<span class="builtintype" id="1930151">true</span><br>
<span class="lineno"></span><span class="op" id="1930156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1930159">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1930201">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1930255">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1930332">func</span>&nbsp;<span class="ident" id="1930337">timerproc</span><span class="op" id="1930346">(</span><span class="op" id="1930347">)</span>&nbsp;<span class="op" id="1930349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930352">timers</span><span class="op" id="1930358">.</span><span class="ident" id="1930359">gp</span>&nbsp;<span class="op" id="1930362">=</span>&nbsp;<span class="ident" id="1930364">getg</span><span class="op" id="1930368">(</span><span class="op" id="1930369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930372">timers</span><span class="op" id="1930378">.</span><span class="ident" id="1930379">gp</span><span class="op" id="1930381">.</span><span class="ident" id="1930382">issystem</span>&nbsp;<span class="op" id="1930391">=</span>&nbsp;<span class="builtintype" id="1930393">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930399">for</span>&nbsp;<span class="op" id="1930403">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930407">lock</span><span class="op" id="1930411">(</span><span class="op" id="1930412">&amp;</span><span class="ident" id="1930413">timers</span><span class="op" id="1930419">.</span><span class="ident" id="1930420">lock</span><span class="op" id="1930424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930428">timers</span><span class="op" id="1930434">.</span><span class="ident" id="1930435">sleeping</span>&nbsp;<span class="op" id="1930444">=</span>&nbsp;<span class="builtintype" id="1930446">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930454">now</span>&nbsp;<span class="op" id="1930458">:=</span>&nbsp;<span class="ident" id="1930461">nanotime</span><span class="op" id="1930469">(</span><span class="op" id="1930470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930474">delta</span>&nbsp;<span class="op" id="1930480">:=</span>&nbsp;<span class="ident" id="1930483">int64</span><span class="op" id="1930488">(</span><span class="op" id="1930489">-</span><span class="num" id="1930490">1</span><span class="op" id="1930491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930495">for</span>&nbsp;<span class="op" id="1930499">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930504">if</span>&nbsp;<span class="builtinfunc" id="1930507">len</span><span class="op" id="1930510">(</span><span class="ident" id="1930511">timers</span><span class="op" id="1930517">.</span><span class="ident" id="1930518">t</span><span class="op" id="1930519">)</span>&nbsp;<span class="op" id="1930521">==</span>&nbsp;<span class="num" id="1930524">0</span>&nbsp;<span class="op" id="1930526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930532">delta</span>&nbsp;<span class="op" id="1930538">=</span>&nbsp;<span class="op" id="1930540">-</span><span class="num" id="1930541">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930547">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930561">t</span>&nbsp;<span class="op" id="1930563">:=</span>&nbsp;<span class="ident" id="1930566">timers</span><span class="op" id="1930572">.</span><span class="ident" id="1930573">t</span><span class="op" id="1930574">[</span><span class="num" id="1930575">0</span><span class="op" id="1930576">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930581">delta</span>&nbsp;<span class="op" id="1930587">=</span>&nbsp;<span class="ident" id="1930589">t</span><span class="op" id="1930590">.</span><span class="ident" id="1930591">when</span>&nbsp;<span class="op" id="1930596">-</span>&nbsp;<span class="ident" id="1930598">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930605">if</span>&nbsp;<span class="ident" id="1930608">delta</span>&nbsp;<span class="op" id="1930614">&gt;</span>&nbsp;<span class="num" id="1930616">0</span>&nbsp;<span class="op" id="1930618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930624">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930638">if</span>&nbsp;<span class="ident" id="1930641">t</span><span class="op" id="1930642">.</span><span class="ident" id="1930643">period</span>&nbsp;<span class="op" id="1930650">&gt;</span>&nbsp;<span class="num" id="1930652">0</span>&nbsp;<span class="op" id="1930654">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930660">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930710">t</span><span class="op" id="1930711">.</span><span class="ident" id="1930712">when</span>&nbsp;<span class="op" id="1930717">+=</span>&nbsp;<span class="ident" id="1930720">t</span><span class="op" id="1930721">.</span><span class="ident" id="1930722">period</span>&nbsp;<span class="op" id="1930729">*</span>&nbsp;<span class="op" id="1930731">(</span><span class="num" id="1930732">1</span>&nbsp;<span class="op" id="1930734">+</span>&nbsp;<span class="op" id="1930736">-</span><span class="ident" id="1930737">delta</span><span class="op" id="1930742">/</span><span class="ident" id="1930743">t</span><span class="op" id="1930744">.</span><span class="ident" id="1930745">period</span><span class="op" id="1930751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930757">siftdownTimer</span><span class="op" id="1930770">(</span><span class="num" id="1930771">0</span><span class="op" id="1930772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930777">}</span>&nbsp;<span class="keyword" id="1930779">else</span>&nbsp;<span class="op" id="1930784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930790">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930814">last</span>&nbsp;<span class="op" id="1930819">:=</span>&nbsp;<span class="builtinfunc" id="1930822">len</span><span class="op" id="1930825">(</span><span class="ident" id="1930826">timers</span><span class="op" id="1930832">.</span><span class="ident" id="1930833">t</span><span class="op" id="1930834">)</span>&nbsp;<span class="op" id="1930836">-</span>&nbsp;<span class="num" id="1930838">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930844">if</span>&nbsp;<span class="ident" id="1930847">last</span>&nbsp;<span class="op" id="1930852">&gt;</span>&nbsp;<span class="num" id="1930854">0</span>&nbsp;<span class="op" id="1930856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930863">timers</span><span class="op" id="1930869">.</span><span class="ident" id="1930870">t</span><span class="op" id="1930871">[</span><span class="num" id="1930872">0</span><span class="op" id="1930873">]</span>&nbsp;<span class="op" id="1930875">=</span>&nbsp;<span class="ident" id="1930877">timers</span><span class="op" id="1930883">.</span><span class="ident" id="1930884">t</span><span class="op" id="1930885">[</span><span class="ident" id="1930886">last</span><span class="op" id="1930890">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930897">timers</span><span class="op" id="1930903">.</span><span class="ident" id="1930904">t</span><span class="op" id="1930905">[</span><span class="num" id="1930906">0</span><span class="op" id="1930907">]</span><span class="op" id="1930908">.</span><span class="ident" id="1930909">i</span>&nbsp;<span class="op" id="1930911">=</span>&nbsp;<span class="num" id="1930913">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930919">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930925">timers</span><span class="op" id="1930931">.</span><span class="ident" id="1930932">t</span><span class="op" id="1930933">[</span><span class="ident" id="1930934">last</span><span class="op" id="1930938">]</span>&nbsp;<span class="op" id="1930940">=</span>&nbsp;<span class="ident" id="1930942">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930950">timers</span><span class="op" id="1930956">.</span><span class="ident" id="1930957">t</span>&nbsp;<span class="op" id="1930959">=</span>&nbsp;<span class="ident" id="1930961">timers</span><span class="op" id="1930967">.</span><span class="ident" id="1930968">t</span><span class="op" id="1930969">[</span><span class="op" id="1930970">:</span><span class="ident" id="1930971">last</span><span class="op" id="1930975">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930981">if</span>&nbsp;<span class="ident" id="1930984">last</span>&nbsp;<span class="op" id="1930989">&gt;</span>&nbsp;<span class="num" id="1930991">0</span>&nbsp;<span class="op" id="1930993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931000">siftdownTimer</span><span class="op" id="1931013">(</span><span class="num" id="1931014">0</span><span class="op" id="1931015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931021">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931027">t</span><span class="op" id="1931028">.</span><span class="ident" id="1931029">i</span>&nbsp;<span class="op" id="1931031">=</span>&nbsp;<span class="op" id="1931033">-</span><span class="num" id="1931034">1</span>&nbsp;<span class="comment" id="1931036">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931063">f</span>&nbsp;<span class="op" id="1931065">:=</span>&nbsp;<span class="ident" id="1931068">t</span><span class="op" id="1931069">.</span><span class="ident" id="1931070">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931075">arg</span>&nbsp;<span class="op" id="1931079">:=</span>&nbsp;<span class="ident" id="1931082">t</span><span class="op" id="1931083">.</span><span class="ident" id="1931084">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931091">seq</span>&nbsp;<span class="op" id="1931095">:=</span>&nbsp;<span class="ident" id="1931098">t</span><span class="op" id="1931099">.</span><span class="ident" id="1931100">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931107">unlock</span><span class="op" id="1931113">(</span><span class="op" id="1931114">&amp;</span><span class="ident" id="1931115">timers</span><span class="op" id="1931121">.</span><span class="ident" id="1931122">lock</span><span class="op" id="1931126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931131">if</span>&nbsp;<span class="ident" id="1931134">raceenabled</span>&nbsp;<span class="op" id="1931146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931152">raceacquire</span><span class="op" id="1931163">(</span><span class="ident" id="1931164">unsafe</span><span class="op" id="1931170">.</span><span class="ident" id="1931171">Pointer</span><span class="op" id="1931178">(</span><span class="ident" id="1931179">t</span><span class="op" id="1931180">)</span><span class="op" id="1931181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931191">f</span><span class="op" id="1931192">(</span><span class="ident" id="1931193">arg</span><span class="op" id="1931196">,</span>&nbsp;<span class="ident" id="1931198">seq</span><span class="op" id="1931201">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931206">lock</span><span class="op" id="1931210">(</span><span class="op" id="1931211">&amp;</span><span class="ident" id="1931212">timers</span><span class="op" id="1931218">.</span><span class="ident" id="1931219">lock</span><span class="op" id="1931223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931231">if</span>&nbsp;<span class="ident" id="1931234">delta</span>&nbsp;<span class="op" id="1931240">&lt;</span>&nbsp;<span class="num" id="1931242">0</span>&nbsp;<span class="op" id="1931244">||</span>&nbsp;<span class="ident" id="1931247">faketime</span>&nbsp;<span class="op" id="1931256">&gt;</span>&nbsp;<span class="num" id="1931258">0</span>&nbsp;<span class="op" id="1931260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931265">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931312">timers</span><span class="op" id="1931318">.</span><span class="ident" id="1931319">rescheduling</span>&nbsp;<span class="op" id="1931332">=</span>&nbsp;<span class="builtintype" id="1931334">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931342">goparkunlock</span><span class="op" id="1931354">(</span><span class="op" id="1931355">&amp;</span><span class="ident" id="1931356">timers</span><span class="op" id="1931362">.</span><span class="ident" id="1931363">lock</span><span class="op" id="1931367">,</span>&nbsp;<span class="string" id="1931369">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1931393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931398">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931413">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931465">timers</span><span class="op" id="1931471">.</span><span class="ident" id="1931472">sleeping</span>&nbsp;<span class="op" id="1931481">=</span>&nbsp;<span class="builtintype" id="1931483">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931490">noteclear</span><span class="op" id="1931499">(</span><span class="op" id="1931500">&amp;</span><span class="ident" id="1931501">timers</span><span class="op" id="1931507">.</span><span class="ident" id="1931508">waitnote</span><span class="op" id="1931516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931520">unlock</span><span class="op" id="1931526">(</span><span class="op" id="1931527">&amp;</span><span class="ident" id="1931528">timers</span><span class="op" id="1931534">.</span><span class="ident" id="1931535">lock</span><span class="op" id="1931539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931543">notetsleepg</span><span class="op" id="1931554">(</span><span class="op" id="1931555">&amp;</span><span class="ident" id="1931556">timers</span><span class="op" id="1931562">.</span><span class="ident" id="1931563">waitnote</span><span class="op" id="1931571">,</span>&nbsp;<span class="ident" id="1931573">delta</span><span class="op" id="1931578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931581">}</span><br>
<span class="lineno"></span><span class="op" id="1931583">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1931586">func</span>&nbsp;<span class="ident" id="1931591">timejump</span><span class="op" id="1931599">(</span><span class="op" id="1931600">)</span>&nbsp;<span class="op" id="1931602">*</span><span class="ident" id="1931603">g</span>&nbsp;<span class="op" id="1931605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931608">if</span>&nbsp;<span class="ident" id="1931611">faketime</span>&nbsp;<span class="op" id="1931620">==</span>&nbsp;<span class="num" id="1931623">0</span>&nbsp;<span class="op" id="1931625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931629">return</span>&nbsp;<span class="ident" id="1931636">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931641">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931645">lock</span><span class="op" id="1931649">(</span><span class="op" id="1931650">&amp;</span><span class="ident" id="1931651">timers</span><span class="op" id="1931657">.</span><span class="ident" id="1931658">lock</span><span class="op" id="1931662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931665">if</span>&nbsp;<span class="op" id="1931668">!</span><span class="ident" id="1931669">timers</span><span class="op" id="1931675">.</span><span class="ident" id="1931676">created</span>&nbsp;<span class="op" id="1931684">||</span>&nbsp;<span class="builtinfunc" id="1931687">len</span><span class="op" id="1931690">(</span><span class="ident" id="1931691">timers</span><span class="op" id="1931697">.</span><span class="ident" id="1931698">t</span><span class="op" id="1931699">)</span>&nbsp;<span class="op" id="1931701">==</span>&nbsp;<span class="num" id="1931704">0</span>&nbsp;<span class="op" id="1931706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931710">unlock</span><span class="op" id="1931716">(</span><span class="op" id="1931717">&amp;</span><span class="ident" id="1931718">timers</span><span class="op" id="1931724">.</span><span class="ident" id="1931725">lock</span><span class="op" id="1931729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931733">return</span>&nbsp;<span class="ident" id="1931740">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931749">var</span>&nbsp;<span class="ident" id="1931753">gp</span>&nbsp;<span class="op" id="1931756">*</span><span class="ident" id="1931757">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931760">if</span>&nbsp;<span class="ident" id="1931763">faketime</span>&nbsp;<span class="op" id="1931772">&lt;</span>&nbsp;<span class="ident" id="1931774">timers</span><span class="op" id="1931780">.</span><span class="ident" id="1931781">t</span><span class="op" id="1931782">[</span><span class="num" id="1931783">0</span><span class="op" id="1931784">]</span><span class="op" id="1931785">.</span><span class="ident" id="1931786">when</span>&nbsp;<span class="op" id="1931791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931795">faketime</span>&nbsp;<span class="op" id="1931804">=</span>&nbsp;<span class="ident" id="1931806">timers</span><span class="op" id="1931812">.</span><span class="ident" id="1931813">t</span><span class="op" id="1931814">[</span><span class="num" id="1931815">0</span><span class="op" id="1931816">]</span><span class="op" id="1931817">.</span><span class="ident" id="1931818">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931825">if</span>&nbsp;<span class="ident" id="1931828">timers</span><span class="op" id="1931834">.</span><span class="ident" id="1931835">rescheduling</span>&nbsp;<span class="op" id="1931848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931853">timers</span><span class="op" id="1931859">.</span><span class="ident" id="1931860">rescheduling</span>&nbsp;<span class="op" id="1931873">=</span>&nbsp;<span class="builtintype" id="1931875">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931884">gp</span>&nbsp;<span class="op" id="1931887">=</span>&nbsp;<span class="ident" id="1931889">timers</span><span class="op" id="1931895">.</span><span class="ident" id="1931896">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931904">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931907">unlock</span><span class="op" id="1931913">(</span><span class="op" id="1931914">&amp;</span><span class="ident" id="1931915">timers</span><span class="op" id="1931921">.</span><span class="ident" id="1931922">lock</span><span class="op" id="1931926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931929">return</span>&nbsp;<span class="ident" id="1931936">gp</span><br>
<span class="lineno"></span><span class="op" id="1931939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1931942">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1931975">func</span>&nbsp;<span class="ident" id="1931980">siftupTimer</span><span class="op" id="1931991">(</span><span class="ident" id="1931992">i</span>&nbsp;<span class="builtintype" id="1931994">int</span><span class="op" id="1931997">)</span>&nbsp;<span class="op" id="1931999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932002">t</span>&nbsp;<span class="op" id="1932004">:=</span>&nbsp;<span class="ident" id="1932007">timers</span><span class="op" id="1932013">.</span><span class="ident" id="1932014">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932017">when</span>&nbsp;<span class="op" id="1932022">:=</span>&nbsp;<span class="ident" id="1932025">t</span><span class="op" id="1932026">[</span><span class="ident" id="1932027">i</span><span class="op" id="1932028">]</span><span class="op" id="1932029">.</span><span class="ident" id="1932030">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932036">tmp</span>&nbsp;<span class="op" id="1932040">:=</span>&nbsp;<span class="ident" id="1932043">t</span><span class="op" id="1932044">[</span><span class="ident" id="1932045">i</span><span class="op" id="1932046">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932049">for</span>&nbsp;<span class="ident" id="1932053">i</span>&nbsp;<span class="op" id="1932055">&gt;</span>&nbsp;<span class="num" id="1932057">0</span>&nbsp;<span class="op" id="1932059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932063">p</span>&nbsp;<span class="op" id="1932065">:=</span>&nbsp;<span class="op" id="1932068">(</span><span class="ident" id="1932069">i</span>&nbsp;<span class="op" id="1932071">-</span>&nbsp;<span class="num" id="1932073">1</span><span class="op" id="1932074">)</span>&nbsp;<span class="op" id="1932076">/</span>&nbsp;<span class="num" id="1932078">4</span>&nbsp;<span class="comment" id="1932080">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932092">if</span>&nbsp;<span class="ident" id="1932095">when</span>&nbsp;<span class="op" id="1932100">&gt;=</span>&nbsp;<span class="ident" id="1932103">t</span><span class="op" id="1932104">[</span><span class="ident" id="1932105">p</span><span class="op" id="1932106">]</span><span class="op" id="1932107">.</span><span class="ident" id="1932108">when</span>&nbsp;<span class="op" id="1932113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932118">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932126">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932130">t</span><span class="op" id="1932131">[</span><span class="ident" id="1932132">i</span><span class="op" id="1932133">]</span>&nbsp;<span class="op" id="1932135">=</span>&nbsp;<span class="ident" id="1932137">t</span><span class="op" id="1932138">[</span><span class="ident" id="1932139">p</span><span class="op" id="1932140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932144">t</span><span class="op" id="1932145">[</span><span class="ident" id="1932146">i</span><span class="op" id="1932147">]</span><span class="op" id="1932148">.</span><span class="ident" id="1932149">i</span>&nbsp;<span class="op" id="1932151">=</span>&nbsp;<span class="ident" id="1932153">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932157">t</span><span class="op" id="1932158">[</span><span class="ident" id="1932159">p</span><span class="op" id="1932160">]</span>&nbsp;<span class="op" id="1932162">=</span>&nbsp;<span class="ident" id="1932164">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932170">t</span><span class="op" id="1932171">[</span><span class="ident" id="1932172">p</span><span class="op" id="1932173">]</span><span class="op" id="1932174">.</span><span class="ident" id="1932175">i</span>&nbsp;<span class="op" id="1932177">=</span>&nbsp;<span class="ident" id="1932179">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932183">i</span>&nbsp;<span class="op" id="1932185">=</span>&nbsp;<span class="ident" id="1932187">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932190">}</span><br>
<span class="lineno"></span><span class="op" id="1932192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1932195">func</span>&nbsp;<span class="ident" id="1932200">siftdownTimer</span><span class="op" id="1932213">(</span><span class="ident" id="1932214">i</span>&nbsp;<span class="builtintype" id="1932216">int</span><span class="op" id="1932219">)</span>&nbsp;<span class="op" id="1932221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932224">t</span>&nbsp;<span class="op" id="1932226">:=</span>&nbsp;<span class="ident" id="1932229">timers</span><span class="op" id="1932235">.</span><span class="ident" id="1932236">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932239">n</span>&nbsp;<span class="op" id="1932241">:=</span>&nbsp;<span class="builtinfunc" id="1932244">len</span><span class="op" id="1932247">(</span><span class="ident" id="1932248">t</span><span class="op" id="1932249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932252">when</span>&nbsp;<span class="op" id="1932257">:=</span>&nbsp;<span class="ident" id="1932260">t</span><span class="op" id="1932261">[</span><span class="ident" id="1932262">i</span><span class="op" id="1932263">]</span><span class="op" id="1932264">.</span><span class="ident" id="1932265">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932271">tmp</span>&nbsp;<span class="op" id="1932275">:=</span>&nbsp;<span class="ident" id="1932278">t</span><span class="op" id="1932279">[</span><span class="ident" id="1932280">i</span><span class="op" id="1932281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932284">for</span>&nbsp;<span class="op" id="1932288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932292">c</span>&nbsp;<span class="op" id="1932294">:=</span>&nbsp;<span class="ident" id="1932297">i</span><span class="op" id="1932298">*</span><span class="num" id="1932299">4</span>&nbsp;<span class="op" id="1932301">+</span>&nbsp;<span class="num" id="1932303">1</span>&nbsp;<span class="comment" id="1932305">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932321">c3</span>&nbsp;<span class="op" id="1932324">:=</span>&nbsp;<span class="ident" id="1932327">c</span>&nbsp;<span class="op" id="1932329">+</span>&nbsp;<span class="num" id="1932331">2</span>&nbsp;&nbsp;<span class="comment" id="1932334">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932349">if</span>&nbsp;<span class="ident" id="1932352">c</span>&nbsp;<span class="op" id="1932354">&gt;=</span>&nbsp;<span class="ident" id="1932357">n</span>&nbsp;<span class="op" id="1932359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932364">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932376">w</span>&nbsp;<span class="op" id="1932378">:=</span>&nbsp;<span class="ident" id="1932381">t</span><span class="op" id="1932382">[</span><span class="ident" id="1932383">c</span><span class="op" id="1932384">]</span><span class="op" id="1932385">.</span><span class="ident" id="1932386">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932393">if</span>&nbsp;<span class="ident" id="1932396">c</span><span class="op" id="1932397">+</span><span class="num" id="1932398">1</span>&nbsp;<span class="op" id="1932400">&lt;</span>&nbsp;<span class="ident" id="1932402">n</span>&nbsp;<span class="op" id="1932404">&amp;&amp;</span>&nbsp;<span class="ident" id="1932407">t</span><span class="op" id="1932408">[</span><span class="ident" id="1932409">c</span><span class="op" id="1932410">+</span><span class="num" id="1932411">1</span><span class="op" id="1932412">]</span><span class="op" id="1932413">.</span><span class="ident" id="1932414">when</span>&nbsp;<span class="op" id="1932419">&lt;</span>&nbsp;<span class="ident" id="1932421">w</span>&nbsp;<span class="op" id="1932423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932428">w</span>&nbsp;<span class="op" id="1932430">=</span>&nbsp;<span class="ident" id="1932432">t</span><span class="op" id="1932433">[</span><span class="ident" id="1932434">c</span><span class="op" id="1932435">+</span><span class="num" id="1932436">1</span><span class="op" id="1932437">]</span><span class="op" id="1932438">.</span><span class="ident" id="1932439">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932447">c</span><span class="op" id="1932448">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932457">if</span>&nbsp;<span class="ident" id="1932460">c3</span>&nbsp;<span class="op" id="1932463">&lt;</span>&nbsp;<span class="ident" id="1932465">n</span>&nbsp;<span class="op" id="1932467">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932472">w3</span>&nbsp;<span class="op" id="1932475">:=</span>&nbsp;<span class="ident" id="1932478">t</span><span class="op" id="1932479">[</span><span class="ident" id="1932480">c3</span><span class="op" id="1932482">]</span><span class="op" id="1932483">.</span><span class="ident" id="1932484">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932492">if</span>&nbsp;<span class="ident" id="1932495">c3</span><span class="op" id="1932497">+</span><span class="num" id="1932498">1</span>&nbsp;<span class="op" id="1932500">&lt;</span>&nbsp;<span class="ident" id="1932502">n</span>&nbsp;<span class="op" id="1932504">&amp;&amp;</span>&nbsp;<span class="ident" id="1932507">t</span><span class="op" id="1932508">[</span><span class="ident" id="1932509">c3</span><span class="op" id="1932511">+</span><span class="num" id="1932512">1</span><span class="op" id="1932513">]</span><span class="op" id="1932514">.</span><span class="ident" id="1932515">when</span>&nbsp;<span class="op" id="1932520">&lt;</span>&nbsp;<span class="ident" id="1932522">w3</span>&nbsp;<span class="op" id="1932525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932531">w3</span>&nbsp;<span class="op" id="1932534">=</span>&nbsp;<span class="ident" id="1932536">t</span><span class="op" id="1932537">[</span><span class="ident" id="1932538">c3</span><span class="op" id="1932540">+</span><span class="num" id="1932541">1</span><span class="op" id="1932542">]</span><span class="op" id="1932543">.</span><span class="ident" id="1932544">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932553">c3</span><span class="op" id="1932555">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932561">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932566">if</span>&nbsp;<span class="ident" id="1932569">w3</span>&nbsp;<span class="op" id="1932572">&lt;</span>&nbsp;<span class="ident" id="1932574">w</span>&nbsp;<span class="op" id="1932576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932582">w</span>&nbsp;<span class="op" id="1932584">=</span>&nbsp;<span class="ident" id="1932586">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932593">c</span>&nbsp;<span class="op" id="1932595">=</span>&nbsp;<span class="ident" id="1932597">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932607">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932611">if</span>&nbsp;<span class="ident" id="1932614">w</span>&nbsp;<span class="op" id="1932616">&gt;=</span>&nbsp;<span class="ident" id="1932619">when</span>&nbsp;<span class="op" id="1932624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932629">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932641">t</span><span class="op" id="1932642">[</span><span class="ident" id="1932643">i</span><span class="op" id="1932644">]</span>&nbsp;<span class="op" id="1932646">=</span>&nbsp;<span class="ident" id="1932648">t</span><span class="op" id="1932649">[</span><span class="ident" id="1932650">c</span><span class="op" id="1932651">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932655">t</span><span class="op" id="1932656">[</span><span class="ident" id="1932657">i</span><span class="op" id="1932658">]</span><span class="op" id="1932659">.</span><span class="ident" id="1932660">i</span>&nbsp;<span class="op" id="1932662">=</span>&nbsp;<span class="ident" id="1932664">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932668">t</span><span class="op" id="1932669">[</span><span class="ident" id="1932670">c</span><span class="op" id="1932671">]</span>&nbsp;<span class="op" id="1932673">=</span>&nbsp;<span class="ident" id="1932675">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932681">t</span><span class="op" id="1932682">[</span><span class="ident" id="1932683">c</span><span class="op" id="1932684">]</span><span class="op" id="1932685">.</span><span class="ident" id="1932686">i</span>&nbsp;<span class="op" id="1932688">=</span>&nbsp;<span class="ident" id="1932690">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932694">i</span>&nbsp;<span class="op" id="1932696">=</span>&nbsp;<span class="ident" id="1932698">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932701">}</span><br>
<span class="lineno"></span><span class="op" id="1932703">}</span>
</div>
</body>
</html>
