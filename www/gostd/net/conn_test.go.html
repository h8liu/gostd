<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7478598">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7478654">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7478708">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7478759">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="7478838">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7478847">package</span>&nbsp;<span class="ident" id="7478855">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7478860">import</span>&nbsp;<span class="op" id="7478867">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7478870">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7478876">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7478887">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7478898">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7478905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7478908">var</span>&nbsp;<span class="ident" id="7478912">connTests</span>&nbsp;<span class="op" id="7478922">=</span>&nbsp;<span class="op" id="7478924">[</span><span class="op" id="7478925">]</span><span class="keyword" id="7478926">struct</span>&nbsp;<span class="op" id="7478933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478936">net</span>&nbsp;&nbsp;<span class="builtintype" id="7478941">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478949">addr</span>&nbsp;<span class="builtintype" id="7478954">string</span><br>
<span class="lineno">20</span><span class="op" id="7478961">}</span><span class="op" id="7478962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478965">{</span><span class="string" id="7478966">&#34;tcp&#34;</span><span class="op" id="7478971">,</span>&nbsp;<span class="string" id="7478973">&#34;127.0.0.1:0&#34;</span><span class="op" id="7478986">}</span><span class="op" id="7478987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478990">{</span><span class="string" id="7478991">&#34;unix&#34;</span><span class="op" id="7478997">,</span>&nbsp;<span class="ident" id="7478999">testUnixAddr</span><span class="op" id="7479011">(</span><span class="op" id="7479012">)</span><span class="op" id="7479013">}</span><span class="op" id="7479014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479017">{</span><span class="string" id="7479018">&#34;unixpacket&#34;</span><span class="op" id="7479030">,</span>&nbsp;<span class="ident" id="7479032">testUnixAddr</span><span class="op" id="7479044">(</span><span class="op" id="7479045">)</span><span class="op" id="7479046">}</span><span class="op" id="7479047">,</span><br>
<span class="lineno"></span><span class="op" id="7479049">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="7479052">//&nbsp;someTimeout&nbsp;is&nbsp;used&nbsp;just&nbsp;to&nbsp;test&nbsp;that&nbsp;net.Conn&nbsp;implementations</span><br>
<span class="lineno"></span><span class="comment" id="7479118">//&nbsp;don&#39;t&nbsp;explode&nbsp;when&nbsp;their&nbsp;SetFooDeadline&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span><span class="comment" id="7479181">//&nbsp;It&nbsp;isn&#39;t&nbsp;actually&nbsp;used&nbsp;for&nbsp;testing&nbsp;timeouts.</span><br>
<span class="lineno"></span><span class="keyword" id="7479229">const</span>&nbsp;<span class="ident" id="7479235">someTimeout</span>&nbsp;<span class="op" id="7479247">=</span>&nbsp;<span class="num" id="7479249">10</span>&nbsp;<span class="op" id="7479252">*</span>&nbsp;<span class="ident" id="7479254">time</span><span class="op" id="7479258">.</span><span class="ident" id="7479259">Second</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7479267">func</span>&nbsp;<span class="ident" id="7479272">TestConnAndListener</span><span class="op" id="7479291">(</span><span class="ident" id="7479292">t</span>&nbsp;<span class="op" id="7479294">*</span><span class="ident" id="7479295">testing</span><span class="op" id="7479302">.</span><span class="ident" id="7479303">T</span><span class="op" id="7479304">)</span>&nbsp;<span class="op" id="7479306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479309">for</span>&nbsp;<span class="ident" id="7479313">_</span><span class="op" id="7479314">,</span>&nbsp;<span class="ident" id="7479316">tt</span>&nbsp;<span class="op" id="7479319">:=</span>&nbsp;<span class="keyword" id="7479322">range</span>&nbsp;<span class="ident" id="7479328">connTests</span>&nbsp;<span class="op" id="7479338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479342">switch</span>&nbsp;<span class="ident" id="7479349">tt</span><span class="op" id="7479351">.</span><span class="ident" id="7479352">net</span>&nbsp;<span class="op" id="7479356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479360">case</span>&nbsp;<span class="string" id="7479365">&#34;unix&#34;</span><span class="op" id="7479371">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479376">switch</span>&nbsp;<span class="ident" id="7479383">runtime</span><span class="op" id="7479390">.</span><span class="ident" id="7479391">GOOS</span>&nbsp;<span class="op" id="7479396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479401">case</span>&nbsp;<span class="string" id="7479406">&#34;nacl&#34;</span><span class="op" id="7479412">,</span>&nbsp;<span class="string" id="7479414">&#34;plan9&#34;</span><span class="op" id="7479421">,</span>&nbsp;<span class="string" id="7479423">&#34;windows&#34;</span><span class="op" id="7479432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479438">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479454">case</span>&nbsp;<span class="string" id="7479459">&#34;unixpacket&#34;</span><span class="op" id="7479471">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479476">switch</span>&nbsp;<span class="ident" id="7479483">runtime</span><span class="op" id="7479490">.</span><span class="ident" id="7479491">GOOS</span>&nbsp;<span class="op" id="7479496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479501">case</span>&nbsp;<span class="string" id="7479506">&#34;android&#34;</span><span class="op" id="7479515">,</span>&nbsp;<span class="string" id="7479517">&#34;darwin&#34;</span><span class="op" id="7479525">,</span>&nbsp;<span class="string" id="7479527">&#34;nacl&#34;</span><span class="op" id="7479533">,</span>&nbsp;<span class="string" id="7479535">&#34;openbsd&#34;</span><span class="op" id="7479544">,</span>&nbsp;<span class="string" id="7479546">&#34;plan9&#34;</span><span class="op" id="7479553">,</span>&nbsp;<span class="string" id="7479555">&#34;windows&#34;</span><span class="op" id="7479564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479570">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479582">case</span>&nbsp;<span class="string" id="7479587">&#34;freebsd&#34;</span><span class="op" id="7479596">:</span>&nbsp;<span class="comment" id="7479598">//&nbsp;FreeBSD&nbsp;8&nbsp;doesn&#39;t&nbsp;support&nbsp;unixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479642">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479663">ln</span><span class="op" id="7479665">,</span>&nbsp;<span class="ident" id="7479667">err</span>&nbsp;<span class="op" id="7479671">:=</span>&nbsp;<span class="ident" id="7479674">Listen</span><span class="op" id="7479680">(</span><span class="ident" id="7479681">tt</span><span class="op" id="7479683">.</span><span class="ident" id="7479684">net</span><span class="op" id="7479687">,</span>&nbsp;<span class="ident" id="7479689">tt</span><span class="op" id="7479691">.</span><span class="ident" id="7479692">addr</span><span class="op" id="7479696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479700">if</span>&nbsp;<span class="ident" id="7479703">err</span>&nbsp;<span class="op" id="7479707">!=</span>&nbsp;<span class="ident" id="7479710">nil</span>&nbsp;<span class="op" id="7479714">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479719">t</span><span class="op" id="7479720">.</span><span class="ident" id="7479721">Fatalf</span><span class="op" id="7479727">(</span><span class="string" id="7479728">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7479747">,</span>&nbsp;<span class="ident" id="7479749">err</span><span class="op" id="7479752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479760">defer</span>&nbsp;<span class="keyword" id="7479766">func</span><span class="op" id="7479770">(</span><span class="ident" id="7479771">ln</span>&nbsp;<span class="ident" id="7479774">Listener</span><span class="op" id="7479782">,</span>&nbsp;<span class="ident" id="7479784">net</span><span class="op" id="7479787">,</span>&nbsp;<span class="ident" id="7479789">addr</span>&nbsp;<span class="builtintype" id="7479794">string</span><span class="op" id="7479800">)</span>&nbsp;<span class="op" id="7479802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479807">ln</span><span class="op" id="7479809">.</span><span class="ident" id="7479810">Close</span><span class="op" id="7479815">(</span><span class="op" id="7479816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479821">switch</span>&nbsp;<span class="ident" id="7479828">net</span>&nbsp;<span class="op" id="7479832">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479837">case</span>&nbsp;<span class="string" id="7479842">&#34;unix&#34;</span><span class="op" id="7479848">,</span>&nbsp;<span class="string" id="7479850">&#34;unixpacket&#34;</span><span class="op" id="7479862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479868">os</span><span class="op" id="7479870">.</span><span class="ident" id="7479871">Remove</span><span class="op" id="7479877">(</span><span class="ident" id="7479878">addr</span><span class="op" id="7479882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479891">}</span><span class="op" id="7479892">(</span><span class="ident" id="7479893">ln</span><span class="op" id="7479895">,</span>&nbsp;<span class="ident" id="7479897">tt</span><span class="op" id="7479899">.</span><span class="ident" id="7479900">net</span><span class="op" id="7479903">,</span>&nbsp;<span class="ident" id="7479905">tt</span><span class="op" id="7479907">.</span><span class="ident" id="7479908">addr</span><span class="op" id="7479912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479916">if</span>&nbsp;<span class="ident" id="7479919">ln</span><span class="op" id="7479921">.</span><span class="ident" id="7479922">Addr</span><span class="op" id="7479926">(</span><span class="op" id="7479927">)</span><span class="op" id="7479928">.</span><span class="ident" id="7479929">Network</span><span class="op" id="7479936">(</span><span class="op" id="7479937">)</span>&nbsp;<span class="op" id="7479939">!=</span>&nbsp;<span class="ident" id="7479942">tt</span><span class="op" id="7479944">.</span><span class="ident" id="7479945">net</span>&nbsp;<span class="op" id="7479949">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479954">t</span><span class="op" id="7479955">.</span><span class="ident" id="7479956">Fatalf</span><span class="op" id="7479962">(</span><span class="string" id="7479963">&#34;got&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="7479984">,</span>&nbsp;<span class="ident" id="7479986">ln</span><span class="op" id="7479988">.</span><span class="ident" id="7479989">Addr</span><span class="op" id="7479993">(</span><span class="op" id="7479994">)</span><span class="op" id="7479995">.</span><span class="ident" id="7479996">Network</span><span class="op" id="7480003">(</span><span class="op" id="7480004">)</span><span class="op" id="7480005">,</span>&nbsp;<span class="ident" id="7480007">tt</span><span class="op" id="7480009">.</span><span class="ident" id="7480010">net</span><span class="op" id="7480013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480022">done</span>&nbsp;<span class="op" id="7480027">:=</span>&nbsp;<span class="builtinfunc" id="7480030">make</span><span class="op" id="7480034">(</span><span class="keyword" id="7480035">chan</span>&nbsp;<span class="builtintype" id="7480040">int</span><span class="op" id="7480043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480047">go</span>&nbsp;<span class="ident" id="7480050">transponder</span><span class="op" id="7480061">(</span><span class="ident" id="7480062">t</span><span class="op" id="7480063">,</span>&nbsp;<span class="ident" id="7480065">ln</span><span class="op" id="7480067">,</span>&nbsp;<span class="ident" id="7480069">done</span><span class="op" id="7480073">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480078">c</span><span class="op" id="7480079">,</span>&nbsp;<span class="ident" id="7480081">err</span>&nbsp;<span class="op" id="7480085">:=</span>&nbsp;<span class="ident" id="7480088">Dial</span><span class="op" id="7480092">(</span><span class="ident" id="7480093">tt</span><span class="op" id="7480095">.</span><span class="ident" id="7480096">net</span><span class="op" id="7480099">,</span>&nbsp;<span class="ident" id="7480101">ln</span><span class="op" id="7480103">.</span><span class="ident" id="7480104">Addr</span><span class="op" id="7480108">(</span><span class="op" id="7480109">)</span><span class="op" id="7480110">.</span><span class="ident" id="7480111">String</span><span class="op" id="7480117">(</span><span class="op" id="7480118">)</span><span class="op" id="7480119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480123">if</span>&nbsp;<span class="ident" id="7480126">err</span>&nbsp;<span class="op" id="7480130">!=</span>&nbsp;<span class="ident" id="7480133">nil</span>&nbsp;<span class="op" id="7480137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480142">t</span><span class="op" id="7480143">.</span><span class="ident" id="7480144">Fatalf</span><span class="op" id="7480150">(</span><span class="string" id="7480151">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7480168">,</span>&nbsp;<span class="ident" id="7480170">err</span><span class="op" id="7480173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480177">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480181">defer</span>&nbsp;<span class="ident" id="7480187">c</span><span class="op" id="7480188">.</span><span class="ident" id="7480189">Close</span><span class="op" id="7480194">(</span><span class="op" id="7480195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480199">if</span>&nbsp;<span class="ident" id="7480202">c</span><span class="op" id="7480203">.</span><span class="ident" id="7480204">LocalAddr</span><span class="op" id="7480213">(</span><span class="op" id="7480214">)</span><span class="op" id="7480215">.</span><span class="ident" id="7480216">Network</span><span class="op" id="7480223">(</span><span class="op" id="7480224">)</span>&nbsp;<span class="op" id="7480226">!=</span>&nbsp;<span class="ident" id="7480229">tt</span><span class="op" id="7480231">.</span><span class="ident" id="7480232">net</span>&nbsp;<span class="op" id="7480236">||</span>&nbsp;<span class="ident" id="7480239">c</span><span class="op" id="7480240">.</span><span class="ident" id="7480241">LocalAddr</span><span class="op" id="7480250">(</span><span class="op" id="7480251">)</span><span class="op" id="7480252">.</span><span class="ident" id="7480253">Network</span><span class="op" id="7480260">(</span><span class="op" id="7480261">)</span>&nbsp;<span class="op" id="7480263">!=</span>&nbsp;<span class="ident" id="7480266">tt</span><span class="op" id="7480268">.</span><span class="ident" id="7480269">net</span>&nbsp;<span class="op" id="7480273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480278">t</span><span class="op" id="7480279">.</span><span class="ident" id="7480280">Fatalf</span><span class="op" id="7480286">(</span><span class="string" id="7480287">&#34;got&nbsp;%v-&gt;%v;&nbsp;expected&nbsp;%v-&gt;%v&#34;</span><span class="op" id="7480316">,</span>&nbsp;<span class="ident" id="7480318">c</span><span class="op" id="7480319">.</span><span class="ident" id="7480320">LocalAddr</span><span class="op" id="7480329">(</span><span class="op" id="7480330">)</span><span class="op" id="7480331">.</span><span class="ident" id="7480332">Network</span><span class="op" id="7480339">(</span><span class="op" id="7480340">)</span><span class="op" id="7480341">,</span>&nbsp;<span class="ident" id="7480343">c</span><span class="op" id="7480344">.</span><span class="ident" id="7480345">RemoteAddr</span><span class="op" id="7480355">(</span><span class="op" id="7480356">)</span><span class="op" id="7480357">.</span><span class="ident" id="7480358">Network</span><span class="op" id="7480365">(</span><span class="op" id="7480366">)</span><span class="op" id="7480367">,</span>&nbsp;<span class="ident" id="7480369">tt</span><span class="op" id="7480371">.</span><span class="ident" id="7480372">net</span><span class="op" id="7480375">,</span>&nbsp;<span class="ident" id="7480377">tt</span><span class="op" id="7480379">.</span><span class="ident" id="7480380">net</span><span class="op" id="7480383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480391">c</span><span class="op" id="7480392">.</span><span class="ident" id="7480393">SetDeadline</span><span class="op" id="7480404">(</span><span class="ident" id="7480405">time</span><span class="op" id="7480409">.</span><span class="ident" id="7480410">Now</span><span class="op" id="7480413">(</span><span class="op" id="7480414">)</span><span class="op" id="7480415">.</span><span class="ident" id="7480416">Add</span><span class="op" id="7480419">(</span><span class="ident" id="7480420">someTimeout</span><span class="op" id="7480431">)</span><span class="op" id="7480432">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480436">c</span><span class="op" id="7480437">.</span><span class="ident" id="7480438">SetReadDeadline</span><span class="op" id="7480453">(</span><span class="ident" id="7480454">time</span><span class="op" id="7480458">.</span><span class="ident" id="7480459">Now</span><span class="op" id="7480462">(</span><span class="op" id="7480463">)</span><span class="op" id="7480464">.</span><span class="ident" id="7480465">Add</span><span class="op" id="7480468">(</span><span class="ident" id="7480469">someTimeout</span><span class="op" id="7480480">)</span><span class="op" id="7480481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480485">c</span><span class="op" id="7480486">.</span><span class="ident" id="7480487">SetWriteDeadline</span><span class="op" id="7480503">(</span><span class="ident" id="7480504">time</span><span class="op" id="7480508">.</span><span class="ident" id="7480509">Now</span><span class="op" id="7480512">(</span><span class="op" id="7480513">)</span><span class="op" id="7480514">.</span><span class="ident" id="7480515">Add</span><span class="op" id="7480518">(</span><span class="ident" id="7480519">someTimeout</span><span class="op" id="7480530">)</span><span class="op" id="7480531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480536">if</span>&nbsp;<span class="ident" id="7480539">_</span><span class="op" id="7480540">,</span>&nbsp;<span class="ident" id="7480542">err</span>&nbsp;<span class="op" id="7480546">:=</span>&nbsp;<span class="ident" id="7480549">c</span><span class="op" id="7480550">.</span><span class="ident" id="7480551">Write</span><span class="op" id="7480556">(</span><span class="op" id="7480557">[</span><span class="op" id="7480558">]</span><span class="builtintype" id="7480559">byte</span><span class="op" id="7480563">(</span><span class="string" id="7480564">&#34;CONN&nbsp;TEST&#34;</span><span class="op" id="7480575">)</span><span class="op" id="7480576">)</span><span class="op" id="7480577">;</span>&nbsp;<span class="ident" id="7480579">err</span>&nbsp;<span class="op" id="7480583">!=</span>&nbsp;<span class="ident" id="7480586">nil</span>&nbsp;<span class="op" id="7480590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480595">t</span><span class="op" id="7480596">.</span><span class="ident" id="7480597">Fatalf</span><span class="op" id="7480603">(</span><span class="string" id="7480604">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7480627">,</span>&nbsp;<span class="ident" id="7480629">err</span><span class="op" id="7480632">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480640">rb</span>&nbsp;<span class="op" id="7480643">:=</span>&nbsp;<span class="builtinfunc" id="7480646">make</span><span class="op" id="7480650">(</span><span class="op" id="7480651">[</span><span class="op" id="7480652">]</span><span class="builtintype" id="7480653">byte</span><span class="op" id="7480657">,</span>&nbsp;<span class="num" id="7480659">128</span><span class="op" id="7480662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480666">if</span>&nbsp;<span class="ident" id="7480669">_</span><span class="op" id="7480670">,</span>&nbsp;<span class="ident" id="7480672">err</span>&nbsp;<span class="op" id="7480676">:=</span>&nbsp;<span class="ident" id="7480679">c</span><span class="op" id="7480680">.</span><span class="ident" id="7480681">Read</span><span class="op" id="7480685">(</span><span class="ident" id="7480686">rb</span><span class="op" id="7480688">)</span><span class="op" id="7480689">;</span>&nbsp;<span class="ident" id="7480691">err</span>&nbsp;<span class="op" id="7480695">!=</span>&nbsp;<span class="ident" id="7480698">nil</span>&nbsp;<span class="op" id="7480702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480707">t</span><span class="op" id="7480708">.</span><span class="ident" id="7480709">Fatalf</span><span class="op" id="7480715">(</span><span class="string" id="7480716">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7480738">,</span>&nbsp;<span class="ident" id="7480740">err</span><span class="op" id="7480743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480747">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480752">&lt;-</span><span class="ident" id="7480754">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480760">}</span><br>
<span class="lineno"></span><span class="op" id="7480762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7480765">func</span>&nbsp;<span class="ident" id="7480770">transponder</span><span class="op" id="7480781">(</span><span class="ident" id="7480782">t</span>&nbsp;<span class="op" id="7480784">*</span><span class="ident" id="7480785">testing</span><span class="op" id="7480792">.</span><span class="ident" id="7480793">T</span><span class="op" id="7480794">,</span>&nbsp;<span class="ident" id="7480796">ln</span>&nbsp;<span class="ident" id="7480799">Listener</span><span class="op" id="7480807">,</span>&nbsp;<span class="ident" id="7480809">done</span>&nbsp;<span class="keyword" id="7480814">chan</span><span class="op" id="7480818">&lt;-</span>&nbsp;<span class="builtintype" id="7480821">int</span><span class="op" id="7480824">)</span>&nbsp;<span class="op" id="7480826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480829">defer</span>&nbsp;<span class="keyword" id="7480835">func</span><span class="op" id="7480839">(</span><span class="op" id="7480840">)</span>&nbsp;<span class="op" id="7480842">{</span>&nbsp;<span class="ident" id="7480844">done</span>&nbsp;<span class="op" id="7480849">&lt;-</span>&nbsp;<span class="num" id="7480852">1</span>&nbsp;<span class="op" id="7480854">}</span><span class="op" id="7480855">(</span><span class="op" id="7480856">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480860">switch</span>&nbsp;<span class="ident" id="7480867">ln</span>&nbsp;<span class="op" id="7480870">:=</span>&nbsp;<span class="ident" id="7480873">ln</span><span class="op" id="7480875">.</span><span class="op" id="7480876">(</span><span class="keyword" id="7480877">type</span><span class="op" id="7480881">)</span>&nbsp;<span class="op" id="7480883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480886">case</span>&nbsp;<span class="op" id="7480891">*</span><span class="ident" id="7480892">TCPListener</span><span class="op" id="7480903">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480907">ln</span><span class="op" id="7480909">.</span><span class="ident" id="7480910">SetDeadline</span><span class="op" id="7480921">(</span><span class="ident" id="7480922">time</span><span class="op" id="7480926">.</span><span class="ident" id="7480927">Now</span><span class="op" id="7480930">(</span><span class="op" id="7480931">)</span><span class="op" id="7480932">.</span><span class="ident" id="7480933">Add</span><span class="op" id="7480936">(</span><span class="ident" id="7480937">someTimeout</span><span class="op" id="7480948">)</span><span class="op" id="7480949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480952">case</span>&nbsp;<span class="op" id="7480957">*</span><span class="ident" id="7480958">UnixListener</span><span class="op" id="7480970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480974">ln</span><span class="op" id="7480976">.</span><span class="ident" id="7480977">SetDeadline</span><span class="op" id="7480988">(</span><span class="ident" id="7480989">time</span><span class="op" id="7480993">.</span><span class="ident" id="7480994">Now</span><span class="op" id="7480997">(</span><span class="op" id="7480998">)</span><span class="op" id="7480999">.</span><span class="ident" id="7481000">Add</span><span class="op" id="7481003">(</span><span class="ident" id="7481004">someTimeout</span><span class="op" id="7481015">)</span><span class="op" id="7481016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481022">c</span><span class="op" id="7481023">,</span>&nbsp;<span class="ident" id="7481025">err</span>&nbsp;<span class="op" id="7481029">:=</span>&nbsp;<span class="ident" id="7481032">ln</span><span class="op" id="7481034">.</span><span class="ident" id="7481035">Accept</span><span class="op" id="7481041">(</span><span class="op" id="7481042">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481045">if</span>&nbsp;<span class="ident" id="7481048">err</span>&nbsp;<span class="op" id="7481052">!=</span>&nbsp;<span class="ident" id="7481055">nil</span>&nbsp;<span class="op" id="7481059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481063">t</span><span class="op" id="7481064">.</span><span class="ident" id="7481065">Errorf</span><span class="op" id="7481071">(</span><span class="string" id="7481072">&#34;Listener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7481100">,</span>&nbsp;<span class="ident" id="7481102">err</span><span class="op" id="7481105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481109">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481120">defer</span>&nbsp;<span class="ident" id="7481126">c</span><span class="op" id="7481127">.</span><span class="ident" id="7481128">Close</span><span class="op" id="7481133">(</span><span class="op" id="7481134">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481137">network</span>&nbsp;<span class="op" id="7481145">:=</span>&nbsp;<span class="ident" id="7481148">ln</span><span class="op" id="7481150">.</span><span class="ident" id="7481151">Addr</span><span class="op" id="7481155">(</span><span class="op" id="7481156">)</span><span class="op" id="7481157">.</span><span class="ident" id="7481158">Network</span><span class="op" id="7481165">(</span><span class="op" id="7481166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481169">if</span>&nbsp;<span class="ident" id="7481172">c</span><span class="op" id="7481173">.</span><span class="ident" id="7481174">LocalAddr</span><span class="op" id="7481183">(</span><span class="op" id="7481184">)</span><span class="op" id="7481185">.</span><span class="ident" id="7481186">Network</span><span class="op" id="7481193">(</span><span class="op" id="7481194">)</span>&nbsp;<span class="op" id="7481196">!=</span>&nbsp;<span class="ident" id="7481199">network</span>&nbsp;<span class="op" id="7481207">||</span>&nbsp;<span class="ident" id="7481210">c</span><span class="op" id="7481211">.</span><span class="ident" id="7481212">LocalAddr</span><span class="op" id="7481221">(</span><span class="op" id="7481222">)</span><span class="op" id="7481223">.</span><span class="ident" id="7481224">Network</span><span class="op" id="7481231">(</span><span class="op" id="7481232">)</span>&nbsp;<span class="op" id="7481234">!=</span>&nbsp;<span class="ident" id="7481237">network</span>&nbsp;<span class="op" id="7481245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481249">t</span><span class="op" id="7481250">.</span><span class="ident" id="7481251">Errorf</span><span class="op" id="7481257">(</span><span class="string" id="7481258">&#34;got&nbsp;%v-&gt;%v;&nbsp;expected&nbsp;%v-&gt;%v&#34;</span><span class="op" id="7481287">,</span>&nbsp;<span class="ident" id="7481289">c</span><span class="op" id="7481290">.</span><span class="ident" id="7481291">LocalAddr</span><span class="op" id="7481300">(</span><span class="op" id="7481301">)</span><span class="op" id="7481302">.</span><span class="ident" id="7481303">Network</span><span class="op" id="7481310">(</span><span class="op" id="7481311">)</span><span class="op" id="7481312">,</span>&nbsp;<span class="ident" id="7481314">c</span><span class="op" id="7481315">.</span><span class="ident" id="7481316">RemoteAddr</span><span class="op" id="7481326">(</span><span class="op" id="7481327">)</span><span class="op" id="7481328">.</span><span class="ident" id="7481329">Network</span><span class="op" id="7481336">(</span><span class="op" id="7481337">)</span><span class="op" id="7481338">,</span>&nbsp;<span class="ident" id="7481340">network</span><span class="op" id="7481347">,</span>&nbsp;<span class="ident" id="7481349">network</span><span class="op" id="7481356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481368">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481371">c</span><span class="op" id="7481372">.</span><span class="ident" id="7481373">SetDeadline</span><span class="op" id="7481384">(</span><span class="ident" id="7481385">time</span><span class="op" id="7481389">.</span><span class="ident" id="7481390">Now</span><span class="op" id="7481393">(</span><span class="op" id="7481394">)</span><span class="op" id="7481395">.</span><span class="ident" id="7481396">Add</span><span class="op" id="7481399">(</span><span class="ident" id="7481400">someTimeout</span><span class="op" id="7481411">)</span><span class="op" id="7481412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481415">c</span><span class="op" id="7481416">.</span><span class="ident" id="7481417">SetReadDeadline</span><span class="op" id="7481432">(</span><span class="ident" id="7481433">time</span><span class="op" id="7481437">.</span><span class="ident" id="7481438">Now</span><span class="op" id="7481441">(</span><span class="op" id="7481442">)</span><span class="op" id="7481443">.</span><span class="ident" id="7481444">Add</span><span class="op" id="7481447">(</span><span class="ident" id="7481448">someTimeout</span><span class="op" id="7481459">)</span><span class="op" id="7481460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481463">c</span><span class="op" id="7481464">.</span><span class="ident" id="7481465">SetWriteDeadline</span><span class="op" id="7481481">(</span><span class="ident" id="7481482">time</span><span class="op" id="7481486">.</span><span class="ident" id="7481487">Now</span><span class="op" id="7481490">(</span><span class="op" id="7481491">)</span><span class="op" id="7481492">.</span><span class="ident" id="7481493">Add</span><span class="op" id="7481496">(</span><span class="ident" id="7481497">someTimeout</span><span class="op" id="7481508">)</span><span class="op" id="7481509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481513">b</span>&nbsp;<span class="op" id="7481515">:=</span>&nbsp;<span class="builtinfunc" id="7481518">make</span><span class="op" id="7481522">(</span><span class="op" id="7481523">[</span><span class="op" id="7481524">]</span><span class="builtintype" id="7481525">byte</span><span class="op" id="7481529">,</span>&nbsp;<span class="num" id="7481531">128</span><span class="op" id="7481534">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481537">n</span><span class="op" id="7481538">,</span>&nbsp;<span class="ident" id="7481540">err</span>&nbsp;<span class="op" id="7481544">:=</span>&nbsp;<span class="ident" id="7481547">c</span><span class="op" id="7481548">.</span><span class="ident" id="7481549">Read</span><span class="op" id="7481553">(</span><span class="ident" id="7481554">b</span><span class="op" id="7481555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481558">if</span>&nbsp;<span class="ident" id="7481561">err</span>&nbsp;<span class="op" id="7481565">!=</span>&nbsp;<span class="ident" id="7481568">nil</span>&nbsp;<span class="op" id="7481572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481576">t</span><span class="op" id="7481577">.</span><span class="ident" id="7481578">Errorf</span><span class="op" id="7481584">(</span><span class="string" id="7481585">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7481607">,</span>&nbsp;<span class="ident" id="7481609">err</span><span class="op" id="7481612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481616">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481624">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481627">if</span>&nbsp;<span class="ident" id="7481630">_</span><span class="op" id="7481631">,</span>&nbsp;<span class="ident" id="7481633">err</span>&nbsp;<span class="op" id="7481637">:=</span>&nbsp;<span class="ident" id="7481640">c</span><span class="op" id="7481641">.</span><span class="ident" id="7481642">Write</span><span class="op" id="7481647">(</span><span class="ident" id="7481648">b</span><span class="op" id="7481649">[</span><span class="op" id="7481650">:</span><span class="ident" id="7481651">n</span><span class="op" id="7481652">]</span><span class="op" id="7481653">)</span><span class="op" id="7481654">;</span>&nbsp;<span class="ident" id="7481656">err</span>&nbsp;<span class="op" id="7481660">!=</span>&nbsp;<span class="ident" id="7481663">nil</span>&nbsp;<span class="op" id="7481667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481671">t</span><span class="op" id="7481672">.</span><span class="ident" id="7481673">Errorf</span><span class="op" id="7481679">(</span><span class="string" id="7481680">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7481703">,</span>&nbsp;<span class="ident" id="7481705">err</span><span class="op" id="7481708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481712">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481720">}</span><br>
<span class="lineno"></span><span class="op" id="7481722">}</span>
</div>
</body>
</html>
