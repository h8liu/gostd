<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6112962">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6113018">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6113072">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6113123">//&nbsp;Package&nbsp;draw&nbsp;provides&nbsp;image&nbsp;composition&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="6113177">//</span><br>
<span class="lineno"></span><span class="comment" id="6113180">//&nbsp;See&nbsp;&#34;The&nbsp;Go&nbsp;image/draw&nbsp;package&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;this&nbsp;package:</span><br>
<span class="lineno"></span><span class="comment" id="6113252">//&nbsp;http://golang.org/doc/articles/image_draw.html</span><br>
<span class="lineno"></span><span class="keyword" id="6113302">package</span>&nbsp;<span class="ident" id="6113310">draw</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6113316">import</span>&nbsp;<span class="op" id="6113323">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6113326">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6113335">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="6113349">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6113352">//&nbsp;m&nbsp;is&nbsp;the&nbsp;maximum&nbsp;color&nbsp;value&nbsp;returned&nbsp;by&nbsp;image.Color.RGBA.</span><br>
<span class="lineno"></span><span class="keyword" id="6113414">const</span>&nbsp;<span class="ident" id="6113420">m</span>&nbsp;<span class="op" id="6113422">=</span>&nbsp;<span class="num" id="6113424">1</span><span class="op" id="6113425">&lt;&lt;</span><span class="num" id="6113427">16</span>&nbsp;<span class="op" id="6113430">-</span>&nbsp;<span class="num" id="6113432">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6113435">//&nbsp;Image&nbsp;is&nbsp;an&nbsp;image.Image&nbsp;with&nbsp;a&nbsp;Set&nbsp;method&nbsp;to&nbsp;change&nbsp;a&nbsp;single&nbsp;pixel.</span><br>
<span class="lineno">20</span><span class="keyword" id="6113506">type</span>&nbsp;<span class="ident" id="6113511">Image</span>&nbsp;<span class="keyword" id="6113517">interface</span>&nbsp;<span class="op" id="6113527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113530"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6113535">.</span><span class="ident" id="6113536">Image</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113543">Set</span><span class="op" id="6113546">(</span><span class="ident" id="6113547">x</span><span class="op" id="6113548">,</span>&nbsp;<span class="ident" id="6113550">y</span>&nbsp;<span class="builtintype" id="6113552">int</span><span class="op" id="6113555">,</span>&nbsp;<span class="ident" id="6113557">c</span>&nbsp;<span class="ident" id="6113559"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6113564">.</span><span class="ident" id="6113565">Color</span><span class="op" id="6113570">)</span><br>
<span class="lineno"></span><span class="op" id="6113572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6113575">//&nbsp;Quantizer&nbsp;produces&nbsp;a&nbsp;palette&nbsp;for&nbsp;an&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="6113621">type</span>&nbsp;<span class="ident" id="6113626">Quantizer</span>&nbsp;<span class="keyword" id="6113636">interface</span>&nbsp;<span class="op" id="6113646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113649">//&nbsp;Quantize&nbsp;appends&nbsp;up&nbsp;to&nbsp;cap(p)&nbsp;-&nbsp;len(p)&nbsp;colors&nbsp;to&nbsp;p&nbsp;and&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113720">//&nbsp;updated&nbsp;palette&nbsp;suitable&nbsp;for&nbsp;converting&nbsp;m&nbsp;to&nbsp;a&nbsp;paletted&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113787">Quantize</span><span class="op" id="6113795">(</span><span class="ident" id="6113796">p</span>&nbsp;<span class="ident" id="6113798"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6113803">.</span><span class="ident" id="6113804">Palette</span><span class="op" id="6113811">,</span>&nbsp;<span class="ident" id="6113813">m</span>&nbsp;<span class="ident" id="6113815"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6113820">.</span><span class="ident" id="6113821">Image</span><span class="op" id="6113826">)</span>&nbsp;<span class="ident" id="6113828"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6113833">.</span><span class="ident" id="6113834">Palette</span><br>
<span class="lineno">30</span><span class="op" id="6113842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6113845">//&nbsp;Op&nbsp;is&nbsp;a&nbsp;Porter-Duff&nbsp;compositing&nbsp;operator.</span><br>
<span class="lineno"></span><span class="keyword" id="6113890">type</span>&nbsp;<span class="ident" id="6113895">Op</span>&nbsp;<span class="builtintype" id="6113898">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6113903">const</span>&nbsp;<span class="op" id="6113909">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113912">//&nbsp;Over&nbsp;specifies&nbsp;``(src&nbsp;in&nbsp;mask)&nbsp;over&nbsp;dst&#39;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6113959">Over</span>&nbsp;<span class="ident" id="6113964"><a href="/image/draw/draw.go.html#6113895">Op</a></span>&nbsp;<span class="op" id="6113967">=</span>&nbsp;<span class="ident" id="6113969">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6113975">//&nbsp;Src&nbsp;specifies&nbsp;``src&nbsp;in&nbsp;mask&#39;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114010">Src</span><br>
<span class="lineno">40</span><span class="op" id="6114014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6114017">//&nbsp;Draw&nbsp;implements&nbsp;the&nbsp;Drawer&nbsp;interface&nbsp;by&nbsp;calling&nbsp;the&nbsp;Draw&nbsp;function&nbsp;with&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="6114096">//&nbsp;Op.</span><br>
<span class="lineno"></span><span class="keyword" id="6114103">func</span>&nbsp;<span class="op" id="6114108">(</span><span class="ident" id="6114109">op</span>&nbsp;<span class="ident" id="6114112"><a href="/image/draw/draw.go.html#6113895">Op</a></span><span class="op" id="6114114">)</span>&nbsp;<span class="ident" id="6114116">Draw</span><span class="op" id="6114120">(</span><span class="ident" id="6114121">dst</span>&nbsp;<span class="ident" id="6114125"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6114130">,</span>&nbsp;<span class="ident" id="6114132">r</span>&nbsp;<span class="ident" id="6114134"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114139">.</span><span class="ident" id="6114140">Rectangle</span><span class="op" id="6114149">,</span>&nbsp;<span class="ident" id="6114151">src</span>&nbsp;<span class="ident" id="6114155"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114160">.</span><span class="ident" id="6114161">Image</span><span class="op" id="6114166">,</span>&nbsp;<span class="ident" id="6114168">sp</span>&nbsp;<span class="ident" id="6114171"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114176">.</span><span class="ident" id="6114177">Point</span><span class="op" id="6114182">)</span>&nbsp;<span class="op" id="6114184">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114187"><a href="/image/draw/draw.go.html#6116076">DrawMask</a></span><span class="op" id="6114195">(</span><span class="ident" id="6114196"><a href="/image/draw/draw.go.html#6114121">dst</a></span><span class="op" id="6114199">,</span>&nbsp;<span class="ident" id="6114201"><a href="/image/draw/draw.go.html#6114132">r</a></span><span class="op" id="6114202">,</span>&nbsp;<span class="ident" id="6114204"><a href="/image/draw/draw.go.html#6114151">src</a></span><span class="op" id="6114207">,</span>&nbsp;<span class="ident" id="6114209"><a href="/image/draw/draw.go.html#6114168">sp</a></span><span class="op" id="6114211">,</span>&nbsp;<span class="ident" id="6114213">nil</span><span class="op" id="6114216">,</span>&nbsp;<span class="ident" id="6114218"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114223">.</span><span class="ident" id="6114224">Point</span><span class="op" id="6114229">{</span><span class="op" id="6114230">}</span><span class="op" id="6114231">,</span>&nbsp;<span class="ident" id="6114233"><a href="/image/draw/draw.go.html#6114109">op</a></span><span class="op" id="6114235">)</span><br>
<span class="lineno"></span><span class="op" id="6114237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6114240">//&nbsp;Drawer&nbsp;contains&nbsp;the&nbsp;Draw&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="6114276">type</span>&nbsp;<span class="ident" id="6114281">Drawer</span>&nbsp;<span class="keyword" id="6114288">interface</span>&nbsp;<span class="op" id="6114298">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6114301">//&nbsp;Draw&nbsp;aligns&nbsp;r.Min&nbsp;in&nbsp;dst&nbsp;with&nbsp;sp&nbsp;in&nbsp;src&nbsp;and&nbsp;then&nbsp;replaces&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6114367">//&nbsp;rectangle&nbsp;r&nbsp;in&nbsp;dst&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;drawing&nbsp;src&nbsp;on&nbsp;dst.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114429">Draw</span><span class="op" id="6114433">(</span><span class="ident" id="6114434">dst</span>&nbsp;<span class="ident" id="6114438"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6114443">,</span>&nbsp;<span class="ident" id="6114445">r</span>&nbsp;<span class="ident" id="6114447"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114452">.</span><span class="ident" id="6114453">Rectangle</span><span class="op" id="6114462">,</span>&nbsp;<span class="ident" id="6114464">src</span>&nbsp;<span class="ident" id="6114468"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114473">.</span><span class="ident" id="6114474">Image</span><span class="op" id="6114479">,</span>&nbsp;<span class="ident" id="6114481">sp</span>&nbsp;<span class="ident" id="6114484"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114489">.</span><span class="ident" id="6114490">Point</span><span class="op" id="6114495">)</span><br>
<span class="lineno"></span><span class="op" id="6114497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="6114500">//&nbsp;FloydSteinberg&nbsp;is&nbsp;a&nbsp;Drawer&nbsp;that&nbsp;is&nbsp;the&nbsp;Src&nbsp;Op&nbsp;with&nbsp;Floyd-Steinberg&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6114576">//&nbsp;diffusion.</span><br>
<span class="lineno"></span><span class="keyword" id="6114590">var</span>&nbsp;<span class="ident" id="6114594">FloydSteinberg</span>&nbsp;<span class="ident" id="6114609"><a href="/image/draw/draw.go.html#6114281">Drawer</a></span>&nbsp;<span class="op" id="6114616">=</span>&nbsp;<span class="ident" id="6114618"><a href="/image/draw/draw.go.html#6114641">floydSteinberg</a></span><span class="op" id="6114632">{</span><span class="op" id="6114633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6114636">type</span>&nbsp;<span class="ident" id="6114641">floydSteinberg</span>&nbsp;<span class="keyword" id="6114656">struct</span><span class="op" id="6114662">{</span><span class="op" id="6114663">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="6114666">func</span>&nbsp;<span class="op" id="6114671">(</span><span class="ident" id="6114672"><a href="/image/draw/draw.go.html#6114641">floydSteinberg</a></span><span class="op" id="6114686">)</span>&nbsp;<span class="ident" id="6114688">Draw</span><span class="op" id="6114692">(</span><span class="ident" id="6114693">dst</span>&nbsp;<span class="ident" id="6114697"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6114702">,</span>&nbsp;<span class="ident" id="6114704">r</span>&nbsp;<span class="ident" id="6114706"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114711">.</span><span class="ident" id="6114712">Rectangle</span><span class="op" id="6114721">,</span>&nbsp;<span class="ident" id="6114723">src</span>&nbsp;<span class="ident" id="6114727"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114732">.</span><span class="ident" id="6114733">Image</span><span class="op" id="6114738">,</span>&nbsp;<span class="ident" id="6114740">sp</span>&nbsp;<span class="ident" id="6114743"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6114748">.</span><span class="ident" id="6114749">Point</span><span class="op" id="6114754">)</span>&nbsp;<span class="op" id="6114756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114759"><a href="/image/draw/draw.go.html#6115058">clip</a></span><span class="op" id="6114763">(</span><span class="ident" id="6114764"><a href="/image/draw/draw.go.html#6114693">dst</a></span><span class="op" id="6114767">,</span>&nbsp;<span class="op" id="6114769">&amp;</span><span class="ident" id="6114770"><a href="/image/draw/draw.go.html#6114704">r</a></span><span class="op" id="6114771">,</span>&nbsp;<span class="ident" id="6114773"><a href="/image/draw/draw.go.html#6114723">src</a></span><span class="op" id="6114776">,</span>&nbsp;<span class="op" id="6114778">&amp;</span><span class="ident" id="6114779"><a href="/image/draw/draw.go.html#6114740">sp</a></span><span class="op" id="6114781">,</span>&nbsp;<span class="ident" id="6114783">nil</span><span class="op" id="6114786">,</span>&nbsp;<span class="ident" id="6114788">nil</span><span class="op" id="6114791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114794">if</span>&nbsp;<span class="ident" id="6114797"><a href="/image/draw/draw.go.html#6114704">r</a></span><span class="op" id="6114798">.</span><span class="ident" id="6114799">Empty</span><span class="op" id="6114804">(</span><span class="op" id="6114805">)</span>&nbsp;<span class="op" id="6114807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6114811">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6114819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6114822"><a href="/image/draw/draw.go.html#6129678">drawPaletted</a></span><span class="op" id="6114834">(</span><span class="ident" id="6114835"><a href="/image/draw/draw.go.html#6114693">dst</a></span><span class="op" id="6114838">,</span>&nbsp;<span class="ident" id="6114840"><a href="/image/draw/draw.go.html#6114704">r</a></span><span class="op" id="6114841">,</span>&nbsp;<span class="ident" id="6114843"><a href="/image/draw/draw.go.html#6114723">src</a></span><span class="op" id="6114846">,</span>&nbsp;<span class="ident" id="6114848"><a href="/image/draw/draw.go.html#6114740">sp</a></span><span class="op" id="6114850">,</span>&nbsp;<span class="ident" id="6114852">true</span><span class="op" id="6114856">)</span><br>
<span class="lineno"></span><span class="op" id="6114858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6114861">//&nbsp;clip&nbsp;clips&nbsp;r&nbsp;against&nbsp;each&nbsp;image&#39;s&nbsp;bounds&nbsp;(after&nbsp;translating&nbsp;into&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="6114933">//&nbsp;destination&nbsp;image&#39;s&nbsp;co-ordinate&nbsp;space)&nbsp;and&nbsp;shifts&nbsp;the&nbsp;points&nbsp;sp&nbsp;and&nbsp;mp&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6115010">//&nbsp;the&nbsp;same&nbsp;amount&nbsp;as&nbsp;the&nbsp;change&nbsp;in&nbsp;r.Min.</span><br>
<span class="lineno"></span><span class="keyword" id="6115053">func</span>&nbsp;<span class="ident" id="6115058">clip</span><span class="op" id="6115062">(</span><span class="ident" id="6115063">dst</span>&nbsp;<span class="ident" id="6115067"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6115072">,</span>&nbsp;<span class="ident" id="6115074">r</span>&nbsp;<span class="op" id="6115076">*</span><span class="ident" id="6115077"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115082">.</span><span class="ident" id="6115083">Rectangle</span><span class="op" id="6115092">,</span>&nbsp;<span class="ident" id="6115094">src</span>&nbsp;<span class="ident" id="6115098"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115103">.</span><span class="ident" id="6115104">Image</span><span class="op" id="6115109">,</span>&nbsp;<span class="ident" id="6115111">sp</span>&nbsp;<span class="op" id="6115114">*</span><span class="ident" id="6115115"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115120">.</span><span class="ident" id="6115121">Point</span><span class="op" id="6115126">,</span>&nbsp;<span class="ident" id="6115128">mask</span>&nbsp;<span class="ident" id="6115133"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115138">.</span><span class="ident" id="6115139">Image</span><span class="op" id="6115144">,</span>&nbsp;<span class="ident" id="6115146">mp</span>&nbsp;<span class="op" id="6115149">*</span><span class="ident" id="6115150"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115155">.</span><span class="ident" id="6115156">Point</span><span class="op" id="6115161">)</span>&nbsp;<span class="op" id="6115163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115166">orig</span>&nbsp;<span class="op" id="6115171">:=</span>&nbsp;<span class="ident" id="6115174"><a href="/image/draw/draw.go.html#6115074">r</a></span><span class="op" id="6115175">.</span><span class="ident" id="6115176">Min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115181">*</span><span class="ident" id="6115182"><a href="/image/draw/draw.go.html#6115074">r</a></span>&nbsp;<span class="op" id="6115184">=</span>&nbsp;<span class="ident" id="6115186"><a href="/image/draw/draw.go.html#6115074">r</a></span><span class="op" id="6115187">.</span><span class="ident" id="6115188">Intersect</span><span class="op" id="6115197">(</span><span class="ident" id="6115198"><a href="/image/draw/draw.go.html#6115063">dst</a></span><span class="op" id="6115201">.</span><span class="ident" id="6115202">Bounds</span><span class="op" id="6115208">(</span><span class="op" id="6115209">)</span><span class="op" id="6115210">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115213">*</span><span class="ident" id="6115214"><a href="/image/draw/draw.go.html#6115074">r</a></span>&nbsp;<span class="op" id="6115216">=</span>&nbsp;<span class="ident" id="6115218"><a href="/image/draw/draw.go.html#6115074">r</a></span><span class="op" id="6115219">.</span><span class="ident" id="6115220">Intersect</span><span class="op" id="6115229">(</span><span class="ident" id="6115230"><a href="/image/draw/draw.go.html#6115094">src</a></span><span class="op" id="6115233">.</span><span class="ident" id="6115234">Bounds</span><span class="op" id="6115240">(</span><span class="op" id="6115241">)</span><span class="op" id="6115242">.</span><span class="ident" id="6115243">Add</span><span class="op" id="6115246">(</span><span class="ident" id="6115247"><a href="/image/draw/draw.go.html#6115166">orig</a></span><span class="op" id="6115251">.</span><span class="ident" id="6115252">Sub</span><span class="op" id="6115255">(</span><span class="op" id="6115256">*</span><span class="ident" id="6115257"><a href="/image/draw/draw.go.html#6115111">sp</a></span><span class="op" id="6115259">)</span><span class="op" id="6115260">)</span><span class="op" id="6115261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115264">if</span>&nbsp;<span class="ident" id="6115267"><a href="/image/draw/draw.go.html#6115128">mask</a></span>&nbsp;<span class="op" id="6115272">!=</span>&nbsp;<span class="ident" id="6115275">nil</span>&nbsp;<span class="op" id="6115279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115283">*</span><span class="ident" id="6115284"><a href="/image/draw/draw.go.html#6115074">r</a></span>&nbsp;<span class="op" id="6115286">=</span>&nbsp;<span class="ident" id="6115288"><a href="/image/draw/draw.go.html#6115074">r</a></span><span class="op" id="6115289">.</span><span class="ident" id="6115290">Intersect</span><span class="op" id="6115299">(</span><span class="ident" id="6115300"><a href="/image/draw/draw.go.html#6115128">mask</a></span><span class="op" id="6115304">.</span><span class="ident" id="6115305">Bounds</span><span class="op" id="6115311">(</span><span class="op" id="6115312">)</span><span class="op" id="6115313">.</span><span class="ident" id="6115314">Add</span><span class="op" id="6115317">(</span><span class="ident" id="6115318"><a href="/image/draw/draw.go.html#6115166">orig</a></span><span class="op" id="6115322">.</span><span class="ident" id="6115323">Sub</span><span class="op" id="6115326">(</span><span class="op" id="6115327">*</span><span class="ident" id="6115328"><a href="/image/draw/draw.go.html#6115146">mp</a></span><span class="op" id="6115330">)</span><span class="op" id="6115331">)</span><span class="op" id="6115332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115338">dx</span>&nbsp;<span class="op" id="6115341">:=</span>&nbsp;<span class="ident" id="6115344"><a href="/image/draw/draw.go.html#6115074">r</a></span><span class="op" id="6115345">.</span><span class="ident" id="6115346">Min</span><span class="op" id="6115349">.</span><span class="ident" id="6115350">X</span>&nbsp;<span class="op" id="6115352">-</span>&nbsp;<span class="ident" id="6115354"><a href="/image/draw/draw.go.html#6115166">orig</a></span><span class="op" id="6115358">.</span><span class="ident" id="6115359">X</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115362">dy</span>&nbsp;<span class="op" id="6115365">:=</span>&nbsp;<span class="ident" id="6115368"><a href="/image/draw/draw.go.html#6115074">r</a></span><span class="op" id="6115369">.</span><span class="ident" id="6115370">Min</span><span class="op" id="6115373">.</span><span class="ident" id="6115374">Y</span>&nbsp;<span class="op" id="6115376">-</span>&nbsp;<span class="ident" id="6115378"><a href="/image/draw/draw.go.html#6115166">orig</a></span><span class="op" id="6115382">.</span><span class="ident" id="6115383">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115386">if</span>&nbsp;<span class="ident" id="6115389"><a href="/image/draw/draw.go.html#6115338">dx</a></span>&nbsp;<span class="op" id="6115392">==</span>&nbsp;<span class="num" id="6115395">0</span>&nbsp;<span class="op" id="6115397">&amp;&amp;</span>&nbsp;<span class="ident" id="6115400"><a href="/image/draw/draw.go.html#6115362">dy</a></span>&nbsp;<span class="op" id="6115403">==</span>&nbsp;<span class="num" id="6115406">0</span>&nbsp;<span class="op" id="6115408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115412">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115423">(</span><span class="op" id="6115424">*</span><span class="ident" id="6115425"><a href="/image/draw/draw.go.html#6115111">sp</a></span><span class="op" id="6115427">)</span><span class="op" id="6115428">.</span><span class="ident" id="6115429">X</span>&nbsp;<span class="op" id="6115431">+=</span>&nbsp;<span class="ident" id="6115434"><a href="/image/draw/draw.go.html#6115338">dx</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115438">(</span><span class="op" id="6115439">*</span><span class="ident" id="6115440"><a href="/image/draw/draw.go.html#6115111">sp</a></span><span class="op" id="6115442">)</span><span class="op" id="6115443">.</span><span class="ident" id="6115444">Y</span>&nbsp;<span class="op" id="6115446">+=</span>&nbsp;<span class="ident" id="6115449"><a href="/image/draw/draw.go.html#6115362">dy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115453">(</span><span class="op" id="6115454">*</span><span class="ident" id="6115455"><a href="/image/draw/draw.go.html#6115146">mp</a></span><span class="op" id="6115457">)</span><span class="op" id="6115458">.</span><span class="ident" id="6115459">X</span>&nbsp;<span class="op" id="6115461">+=</span>&nbsp;<span class="ident" id="6115464"><a href="/image/draw/draw.go.html#6115338">dx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115468">(</span><span class="op" id="6115469">*</span><span class="ident" id="6115470"><a href="/image/draw/draw.go.html#6115146">mp</a></span><span class="op" id="6115472">)</span><span class="op" id="6115473">.</span><span class="ident" id="6115474">Y</span>&nbsp;<span class="op" id="6115476">+=</span>&nbsp;<span class="ident" id="6115479"><a href="/image/draw/draw.go.html#6115362">dy</a></span><br>
<span class="lineno"></span><span class="op" id="6115482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6115485">func</span>&nbsp;<span class="ident" id="6115490">processBackward</span><span class="op" id="6115505">(</span><span class="ident" id="6115506">dst</span>&nbsp;<span class="ident" id="6115510"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6115515">,</span>&nbsp;<span class="ident" id="6115517">r</span>&nbsp;<span class="ident" id="6115519"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115524">.</span><span class="ident" id="6115525">Rectangle</span><span class="op" id="6115534">,</span>&nbsp;<span class="ident" id="6115536">src</span>&nbsp;<span class="ident" id="6115540"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115545">.</span><span class="ident" id="6115546">Image</span><span class="op" id="6115551">,</span>&nbsp;<span class="ident" id="6115553">sp</span>&nbsp;<span class="ident" id="6115556"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115561">.</span><span class="ident" id="6115562">Point</span><span class="op" id="6115567">)</span>&nbsp;<span class="builtintype" id="6115569">bool</span>&nbsp;<span class="op" id="6115574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6115577">return</span>&nbsp;<span class="ident" id="6115584"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115589">.</span><span class="ident" id="6115590">Image</span><span class="op" id="6115595">(</span><span class="ident" id="6115596"><a href="/image/draw/draw.go.html#6115506">dst</a></span><span class="op" id="6115599">)</span>&nbsp;<span class="op" id="6115601">==</span>&nbsp;<span class="ident" id="6115604"><a href="/image/draw/draw.go.html#6115536">src</a></span>&nbsp;<span class="op" id="6115608">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115613"><a href="/image/draw/draw.go.html#6115517">r</a></span><span class="op" id="6115614">.</span><span class="ident" id="6115615">Overlaps</span><span class="op" id="6115623">(</span><span class="ident" id="6115624"><a href="/image/draw/draw.go.html#6115517">r</a></span><span class="op" id="6115625">.</span><span class="ident" id="6115626">Add</span><span class="op" id="6115629">(</span><span class="ident" id="6115630"><a href="/image/draw/draw.go.html#6115553">sp</a></span><span class="op" id="6115632">.</span><span class="ident" id="6115633">Sub</span><span class="op" id="6115636">(</span><span class="ident" id="6115637"><a href="/image/draw/draw.go.html#6115517">r</a></span><span class="op" id="6115638">.</span><span class="ident" id="6115639">Min</span><span class="op" id="6115642">)</span><span class="op" id="6115643">)</span><span class="op" id="6115644">)</span>&nbsp;<span class="op" id="6115646">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6115651">(</span><span class="ident" id="6115652"><a href="/image/draw/draw.go.html#6115553">sp</a></span><span class="op" id="6115654">.</span><span class="ident" id="6115655">Y</span>&nbsp;<span class="op" id="6115657">&lt;</span>&nbsp;<span class="ident" id="6115659"><a href="/image/draw/draw.go.html#6115517">r</a></span><span class="op" id="6115660">.</span><span class="ident" id="6115661">Min</span><span class="op" id="6115664">.</span><span class="ident" id="6115665">Y</span>&nbsp;<span class="op" id="6115667">||</span>&nbsp;<span class="op" id="6115670">(</span><span class="ident" id="6115671"><a href="/image/draw/draw.go.html#6115553">sp</a></span><span class="op" id="6115673">.</span><span class="ident" id="6115674">Y</span>&nbsp;<span class="op" id="6115676">==</span>&nbsp;<span class="ident" id="6115679"><a href="/image/draw/draw.go.html#6115517">r</a></span><span class="op" id="6115680">.</span><span class="ident" id="6115681">Min</span><span class="op" id="6115684">.</span><span class="ident" id="6115685">Y</span>&nbsp;<span class="op" id="6115687">&amp;&amp;</span>&nbsp;<span class="ident" id="6115690"><a href="/image/draw/draw.go.html#6115553">sp</a></span><span class="op" id="6115692">.</span><span class="ident" id="6115693">X</span>&nbsp;<span class="op" id="6115695">&lt;</span>&nbsp;<span class="ident" id="6115697"><a href="/image/draw/draw.go.html#6115517">r</a></span><span class="op" id="6115698">.</span><span class="ident" id="6115699">Min</span><span class="op" id="6115702">.</span><span class="ident" id="6115703">X</span><span class="op" id="6115704">)</span><span class="op" id="6115705">)</span><br>
<span class="lineno"></span><span class="op" id="6115707">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6115710">//&nbsp;Draw&nbsp;calls&nbsp;DrawMask&nbsp;with&nbsp;a&nbsp;nil&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="6115750">func</span>&nbsp;<span class="ident" id="6115755">Draw</span><span class="op" id="6115759">(</span><span class="ident" id="6115760">dst</span>&nbsp;<span class="ident" id="6115764"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6115769">,</span>&nbsp;<span class="ident" id="6115771">r</span>&nbsp;<span class="ident" id="6115773"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115778">.</span><span class="ident" id="6115779">Rectangle</span><span class="op" id="6115788">,</span>&nbsp;<span class="ident" id="6115790">src</span>&nbsp;<span class="ident" id="6115794"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115799">.</span><span class="ident" id="6115800">Image</span><span class="op" id="6115805">,</span>&nbsp;<span class="ident" id="6115807">sp</span>&nbsp;<span class="ident" id="6115810"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115815">.</span><span class="ident" id="6115816">Point</span><span class="op" id="6115821">,</span>&nbsp;<span class="ident" id="6115823">op</span>&nbsp;<span class="ident" id="6115826"><a href="/image/draw/draw.go.html#6113895">Op</a></span><span class="op" id="6115828">)</span>&nbsp;<span class="op" id="6115830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6115833"><a href="/image/draw/draw.go.html#6116076">DrawMask</a></span><span class="op" id="6115841">(</span><span class="ident" id="6115842"><a href="/image/draw/draw.go.html#6115760">dst</a></span><span class="op" id="6115845">,</span>&nbsp;<span class="ident" id="6115847"><a href="/image/draw/draw.go.html#6115771">r</a></span><span class="op" id="6115848">,</span>&nbsp;<span class="ident" id="6115850"><a href="/image/draw/draw.go.html#6115790">src</a></span><span class="op" id="6115853">,</span>&nbsp;<span class="ident" id="6115855"><a href="/image/draw/draw.go.html#6115807">sp</a></span><span class="op" id="6115857">,</span>&nbsp;<span class="ident" id="6115859">nil</span><span class="op" id="6115862">,</span>&nbsp;<span class="ident" id="6115864"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6115869">.</span><span class="ident" id="6115870">Point</span><span class="op" id="6115875">{</span><span class="op" id="6115876">}</span><span class="op" id="6115877">,</span>&nbsp;<span class="ident" id="6115879"><a href="/image/draw/draw.go.html#6115823">op</a></span><span class="op" id="6115881">)</span><br>
<span class="lineno"></span><span class="op" id="6115883">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="6115886">//&nbsp;DrawMask&nbsp;aligns&nbsp;r.Min&nbsp;in&nbsp;dst&nbsp;with&nbsp;sp&nbsp;in&nbsp;src&nbsp;and&nbsp;mp&nbsp;in&nbsp;mask&nbsp;and&nbsp;then&nbsp;replaces&nbsp;the&nbsp;rectangle&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="6115982">//&nbsp;in&nbsp;dst&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;Porter-Duff&nbsp;composition.&nbsp;A&nbsp;nil&nbsp;mask&nbsp;is&nbsp;treated&nbsp;as&nbsp;opaque.</span><br>
<span class="lineno"></span><span class="keyword" id="6116071">func</span>&nbsp;<span class="ident" id="6116076">DrawMask</span><span class="op" id="6116084">(</span><span class="ident" id="6116085">dst</span>&nbsp;<span class="ident" id="6116089"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6116094">,</span>&nbsp;<span class="ident" id="6116096">r</span>&nbsp;<span class="ident" id="6116098"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116103">.</span><span class="ident" id="6116104">Rectangle</span><span class="op" id="6116113">,</span>&nbsp;<span class="ident" id="6116115">src</span>&nbsp;<span class="ident" id="6116119"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116124">.</span><span class="ident" id="6116125">Image</span><span class="op" id="6116130">,</span>&nbsp;<span class="ident" id="6116132">sp</span>&nbsp;<span class="ident" id="6116135"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116140">.</span><span class="ident" id="6116141">Point</span><span class="op" id="6116146">,</span>&nbsp;<span class="ident" id="6116148">mask</span>&nbsp;<span class="ident" id="6116153"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116158">.</span><span class="ident" id="6116159">Image</span><span class="op" id="6116164">,</span>&nbsp;<span class="ident" id="6116166">mp</span>&nbsp;<span class="ident" id="6116169"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116174">.</span><span class="ident" id="6116175">Point</span><span class="op" id="6116180">,</span>&nbsp;<span class="ident" id="6116182">op</span>&nbsp;<span class="ident" id="6116185"><a href="/image/draw/draw.go.html#6113895">Op</a></span><span class="op" id="6116187">)</span>&nbsp;<span class="op" id="6116189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116192"><a href="/image/draw/draw.go.html#6115058">clip</a></span><span class="op" id="6116196">(</span><span class="ident" id="6116197"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6116200">,</span>&nbsp;<span class="op" id="6116202">&amp;</span><span class="ident" id="6116203"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116204">,</span>&nbsp;<span class="ident" id="6116206"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6116209">,</span>&nbsp;<span class="op" id="6116211">&amp;</span><span class="ident" id="6116212"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6116214">,</span>&nbsp;<span class="ident" id="6116216"><a href="/image/draw/draw.go.html#6116148">mask</a></span><span class="op" id="6116220">,</span>&nbsp;<span class="op" id="6116222">&amp;</span><span class="ident" id="6116223"><a href="/image/draw/draw.go.html#6116166">mp</a></span><span class="op" id="6116225">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116228">if</span>&nbsp;<span class="ident" id="6116231"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116232">.</span><span class="ident" id="6116233">Empty</span><span class="op" id="6116238">(</span><span class="op" id="6116239">)</span>&nbsp;<span class="op" id="6116241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116245">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6116257">//&nbsp;Fast&nbsp;paths&nbsp;for&nbsp;special&nbsp;cases.&nbsp;If&nbsp;none&nbsp;of&nbsp;them&nbsp;apply,&nbsp;then&nbsp;we&nbsp;fall&nbsp;back&nbsp;to&nbsp;a&nbsp;general&nbsp;but&nbsp;slow&nbsp;implementation.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116370">switch</span>&nbsp;<span class="ident" id="6116377">dst0</span>&nbsp;<span class="op" id="6116382">:=</span>&nbsp;<span class="ident" id="6116385"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6116388">.</span><span class="op" id="6116389">(</span><span class="keyword" id="6116390">type</span><span class="op" id="6116394">)</span>&nbsp;<span class="op" id="6116396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116399">case</span>&nbsp;<span class="op" id="6116404">*</span><span class="ident" id="6116405"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116410">.</span><span class="ident" id="6116411">RGBA</span><span class="op" id="6116415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116419">if</span>&nbsp;<span class="ident" id="6116422"><a href="/image/draw/draw.go.html#6116182">op</a></span>&nbsp;<span class="op" id="6116425">==</span>&nbsp;<span class="ident" id="6116428"><a href="/image/draw/draw.go.html#6113959">Over</a></span>&nbsp;<span class="op" id="6116433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116438">if</span>&nbsp;<span class="ident" id="6116441"><a href="/image/draw/draw.go.html#6116148">mask</a></span>&nbsp;<span class="op" id="6116446">==</span>&nbsp;<span class="ident" id="6116449">nil</span>&nbsp;<span class="op" id="6116453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116459">switch</span>&nbsp;<span class="ident" id="6116466">src0</span>&nbsp;<span class="op" id="6116471">:=</span>&nbsp;<span class="ident" id="6116474"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6116477">.</span><span class="op" id="6116478">(</span><span class="keyword" id="6116479">type</span><span class="op" id="6116483">)</span>&nbsp;<span class="op" id="6116485">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116491">case</span>&nbsp;<span class="op" id="6116496">*</span><span class="ident" id="6116497"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116502">.</span><span class="ident" id="6116503">Uniform</span><span class="op" id="6116510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116517"><a href="/image/draw/draw.go.html#6118970">drawFillOver</a></span><span class="op" id="6116529">(</span><span class="ident" id="6116530"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6116534">,</span>&nbsp;<span class="ident" id="6116536"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116537">,</span>&nbsp;<span class="ident" id="6116539"><a href="/image/draw/draw.go.html#6116466">src0</a></span><span class="op" id="6116543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116550">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116561">case</span>&nbsp;<span class="op" id="6116566">*</span><span class="ident" id="6116567"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116572">.</span><span class="ident" id="6116573">RGBA</span><span class="op" id="6116577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116584"><a href="/image/draw/draw.go.html#6120384">drawCopyOver</a></span><span class="op" id="6116596">(</span><span class="ident" id="6116597"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6116601">,</span>&nbsp;<span class="ident" id="6116603"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116604">,</span>&nbsp;<span class="ident" id="6116606"><a href="/image/draw/draw.go.html#6116466">src0</a></span><span class="op" id="6116610">,</span>&nbsp;<span class="ident" id="6116612"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6116614">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116632">case</span>&nbsp;<span class="op" id="6116637">*</span><span class="ident" id="6116638"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116643">.</span><span class="ident" id="6116644">NRGBA</span><span class="op" id="6116649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116656"><a href="/image/draw/draw.go.html#6122555">drawNRGBAOver</a></span><span class="op" id="6116669">(</span><span class="ident" id="6116670"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6116674">,</span>&nbsp;<span class="ident" id="6116676"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116677">,</span>&nbsp;<span class="ident" id="6116679"><a href="/image/draw/draw.go.html#6116466">src0</a></span><span class="op" id="6116683">,</span>&nbsp;<span class="ident" id="6116685"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6116687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116705">case</span>&nbsp;<span class="op" id="6116710">*</span><span class="ident" id="6116711"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116716">.</span><span class="ident" id="6116717">YCbCr</span><span class="op" id="6116722">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116729">if</span>&nbsp;<span class="ident" id="6116732"><a href="/image/draw/draw.go.html#6124415">drawYCbCr</a></span><span class="op" id="6116741">(</span><span class="ident" id="6116742"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6116746">,</span>&nbsp;<span class="ident" id="6116748"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116749">,</span>&nbsp;<span class="ident" id="6116751"><a href="/image/draw/draw.go.html#6116466">src0</a></span><span class="op" id="6116755">,</span>&nbsp;<span class="ident" id="6116757"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6116759">)</span>&nbsp;<span class="op" id="6116761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116769">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116792">}</span>&nbsp;<span class="keyword" id="6116794">else</span>&nbsp;<span class="keyword" id="6116799">if</span>&nbsp;<span class="ident" id="6116802">mask0</span><span class="op" id="6116807">,</span>&nbsp;<span class="ident" id="6116809">ok</span>&nbsp;<span class="op" id="6116812">:=</span>&nbsp;<span class="ident" id="6116815"><a href="/image/draw/draw.go.html#6116148">mask</a></span><span class="op" id="6116819">.</span><span class="op" id="6116820">(</span><span class="op" id="6116821">*</span><span class="ident" id="6116822"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116827">.</span><span class="ident" id="6116828">Alpha</span><span class="op" id="6116833">)</span><span class="op" id="6116834">;</span>&nbsp;<span class="ident" id="6116836"><a href="/image/draw/draw.go.html#6116809">ok</a></span>&nbsp;<span class="op" id="6116839">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116845">switch</span>&nbsp;<span class="ident" id="6116852">src0</span>&nbsp;<span class="op" id="6116857">:=</span>&nbsp;<span class="ident" id="6116860"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6116863">.</span><span class="op" id="6116864">(</span><span class="keyword" id="6116865">type</span><span class="op" id="6116869">)</span>&nbsp;<span class="op" id="6116871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116877">case</span>&nbsp;<span class="op" id="6116882">*</span><span class="ident" id="6116883"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6116888">.</span><span class="ident" id="6116889">Uniform</span><span class="op" id="6116896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6116903"><a href="/image/draw/draw.go.html#6126814">drawGlyphOver</a></span><span class="op" id="6116916">(</span><span class="ident" id="6116917"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6116921">,</span>&nbsp;<span class="ident" id="6116923"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6116924">,</span>&nbsp;<span class="ident" id="6116926"><a href="/image/draw/draw.go.html#6116852">src0</a></span><span class="op" id="6116930">,</span>&nbsp;<span class="ident" id="6116932"><a href="/image/draw/draw.go.html#6116802">mask0</a></span><span class="op" id="6116937">,</span>&nbsp;<span class="ident" id="6116939"><a href="/image/draw/draw.go.html#6116166">mp</a></span><span class="op" id="6116941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116948">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116959">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6116968">}</span>&nbsp;<span class="keyword" id="6116970">else</span>&nbsp;<span class="op" id="6116975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6116980">if</span>&nbsp;<span class="ident" id="6116983"><a href="/image/draw/draw.go.html#6116148">mask</a></span>&nbsp;<span class="op" id="6116988">==</span>&nbsp;<span class="ident" id="6116991">nil</span>&nbsp;<span class="op" id="6116995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117001">switch</span>&nbsp;<span class="ident" id="6117008">src0</span>&nbsp;<span class="op" id="6117013">:=</span>&nbsp;<span class="ident" id="6117016"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6117019">.</span><span class="op" id="6117020">(</span><span class="keyword" id="6117021">type</span><span class="op" id="6117025">)</span>&nbsp;<span class="op" id="6117027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117033">case</span>&nbsp;<span class="op" id="6117038">*</span><span class="ident" id="6117039"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6117044">.</span><span class="ident" id="6117045">Uniform</span><span class="op" id="6117052">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117059"><a href="/image/draw/draw.go.html#6119633">drawFillSrc</a></span><span class="op" id="6117070">(</span><span class="ident" id="6117071"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6117075">,</span>&nbsp;<span class="ident" id="6117077"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117078">,</span>&nbsp;<span class="ident" id="6117080"><a href="/image/draw/draw.go.html#6117008">src0</a></span><span class="op" id="6117084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117091">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117102">case</span>&nbsp;<span class="op" id="6117107">*</span><span class="ident" id="6117108"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6117113">.</span><span class="ident" id="6117114">RGBA</span><span class="op" id="6117118">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117125"><a href="/image/draw/draw.go.html#6121766">drawCopySrc</a></span><span class="op" id="6117136">(</span><span class="ident" id="6117137"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6117141">,</span>&nbsp;<span class="ident" id="6117143"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117144">,</span>&nbsp;<span class="ident" id="6117146"><a href="/image/draw/draw.go.html#6117008">src0</a></span><span class="op" id="6117150">,</span>&nbsp;<span class="ident" id="6117152"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117161">return</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117172">case</span>&nbsp;<span class="op" id="6117177">*</span><span class="ident" id="6117178"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6117183">.</span><span class="ident" id="6117184">NRGBA</span><span class="op" id="6117189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117196"><a href="/image/draw/draw.go.html#6123605">drawNRGBASrc</a></span><span class="op" id="6117208">(</span><span class="ident" id="6117209"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6117213">,</span>&nbsp;<span class="ident" id="6117215"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117216">,</span>&nbsp;<span class="ident" id="6117218"><a href="/image/draw/draw.go.html#6117008">src0</a></span><span class="op" id="6117222">,</span>&nbsp;<span class="ident" id="6117224"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117233">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117244">case</span>&nbsp;<span class="op" id="6117249">*</span><span class="ident" id="6117250"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6117255">.</span><span class="ident" id="6117256">YCbCr</span><span class="op" id="6117261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117268">if</span>&nbsp;<span class="ident" id="6117271"><a href="/image/draw/draw.go.html#6124415">drawYCbCr</a></span><span class="op" id="6117280">(</span><span class="ident" id="6117281"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6117285">,</span>&nbsp;<span class="ident" id="6117287"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117288">,</span>&nbsp;<span class="ident" id="6117290"><a href="/image/draw/draw.go.html#6117008">src0</a></span><span class="op" id="6117294">,</span>&nbsp;<span class="ident" id="6117296"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117298">)</span>&nbsp;<span class="op" id="6117300">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117308">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117335">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117339"><a href="/image/draw/draw.go.html#6127731">drawRGBA</a></span><span class="op" id="6117347">(</span><span class="ident" id="6117348"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6117352">,</span>&nbsp;<span class="ident" id="6117354"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117355">,</span>&nbsp;<span class="ident" id="6117357"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6117360">,</span>&nbsp;<span class="ident" id="6117362"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117364">,</span>&nbsp;<span class="ident" id="6117366"><a href="/image/draw/draw.go.html#6116148">mask</a></span><span class="op" id="6117370">,</span>&nbsp;<span class="ident" id="6117372"><a href="/image/draw/draw.go.html#6116166">mp</a></span><span class="op" id="6117374">,</span>&nbsp;<span class="ident" id="6117376"><a href="/image/draw/draw.go.html#6116182">op</a></span><span class="op" id="6117378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117390">case</span>&nbsp;<span class="op" id="6117395">*</span><span class="ident" id="6117396"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6117401">.</span><span class="ident" id="6117402">Paletted</span><span class="op" id="6117410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117414">if</span>&nbsp;<span class="ident" id="6117417"><a href="/image/draw/draw.go.html#6116182">op</a></span>&nbsp;<span class="op" id="6117420">==</span>&nbsp;<span class="ident" id="6117423"><a href="/image/draw/draw.go.html#6114010">Src</a></span>&nbsp;<span class="op" id="6117427">&amp;&amp;</span>&nbsp;<span class="ident" id="6117430"><a href="/image/draw/draw.go.html#6116148">mask</a></span>&nbsp;<span class="op" id="6117435">==</span>&nbsp;<span class="ident" id="6117438">nil</span>&nbsp;<span class="op" id="6117442">&amp;&amp;</span>&nbsp;<span class="op" id="6117445">!</span><span class="ident" id="6117446"><a href="/image/draw/draw.go.html#6115490">processBackward</a></span><span class="op" id="6117461">(</span><span class="ident" id="6117462"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6117465">,</span>&nbsp;<span class="ident" id="6117467"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117468">,</span>&nbsp;<span class="ident" id="6117470"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6117473">,</span>&nbsp;<span class="ident" id="6117475"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117477">)</span>&nbsp;<span class="op" id="6117479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117484"><a href="/image/draw/draw.go.html#6129678">drawPaletted</a></span><span class="op" id="6117496">(</span><span class="ident" id="6117497"><a href="/image/draw/draw.go.html#6116377">dst0</a></span><span class="op" id="6117501">,</span>&nbsp;<span class="ident" id="6117503"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117504">,</span>&nbsp;<span class="ident" id="6117506"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6117509">,</span>&nbsp;<span class="ident" id="6117511"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117513">,</span>&nbsp;<span class="ident" id="6117515">false</span><span class="op" id="6117520">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117531">x0</span><span class="op" id="6117533">,</span>&nbsp;<span class="ident" id="6117535">x1</span><span class="op" id="6117537">,</span>&nbsp;<span class="ident" id="6117539">dx</span>&nbsp;<span class="op" id="6117542">:=</span>&nbsp;<span class="ident" id="6117545"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117546">.</span><span class="ident" id="6117547">Min</span><span class="op" id="6117550">.</span><span class="ident" id="6117551">X</span><span class="op" id="6117552">,</span>&nbsp;<span class="ident" id="6117554"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117555">.</span><span class="ident" id="6117556">Max</span><span class="op" id="6117559">.</span><span class="ident" id="6117560">X</span><span class="op" id="6117561">,</span>&nbsp;<span class="num" id="6117563">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117566">y0</span><span class="op" id="6117568">,</span>&nbsp;<span class="ident" id="6117570">y1</span><span class="op" id="6117572">,</span>&nbsp;<span class="ident" id="6117574">dy</span>&nbsp;<span class="op" id="6117577">:=</span>&nbsp;<span class="ident" id="6117580"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117581">.</span><span class="ident" id="6117582">Min</span><span class="op" id="6117585">.</span><span class="ident" id="6117586">Y</span><span class="op" id="6117587">,</span>&nbsp;<span class="ident" id="6117589"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117590">.</span><span class="ident" id="6117591">Max</span><span class="op" id="6117594">.</span><span class="ident" id="6117595">Y</span><span class="op" id="6117596">,</span>&nbsp;<span class="num" id="6117598">1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117601">if</span>&nbsp;<span class="ident" id="6117604"><a href="/image/draw/draw.go.html#6115490">processBackward</a></span><span class="op" id="6117619">(</span><span class="ident" id="6117620"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6117623">,</span>&nbsp;<span class="ident" id="6117625"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117626">,</span>&nbsp;<span class="ident" id="6117628"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6117631">,</span>&nbsp;<span class="ident" id="6117633"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117635">)</span>&nbsp;<span class="op" id="6117637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117641"><a href="/image/draw/draw.go.html#6117531">x0</a></span><span class="op" id="6117643">,</span>&nbsp;<span class="ident" id="6117645"><a href="/image/draw/draw.go.html#6117535">x1</a></span><span class="op" id="6117647">,</span>&nbsp;<span class="ident" id="6117649"><a href="/image/draw/draw.go.html#6117539">dx</a></span>&nbsp;<span class="op" id="6117652">=</span>&nbsp;<span class="ident" id="6117654"><a href="/image/draw/draw.go.html#6117535">x1</a></span><span class="op" id="6117656">-</span><span class="num" id="6117657">1</span><span class="op" id="6117658">,</span>&nbsp;<span class="ident" id="6117660"><a href="/image/draw/draw.go.html#6117531">x0</a></span><span class="op" id="6117662">-</span><span class="num" id="6117663">1</span><span class="op" id="6117664">,</span>&nbsp;<span class="op" id="6117666">-</span><span class="num" id="6117667">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117671"><a href="/image/draw/draw.go.html#6117566">y0</a></span><span class="op" id="6117673">,</span>&nbsp;<span class="ident" id="6117675"><a href="/image/draw/draw.go.html#6117570">y1</a></span><span class="op" id="6117677">,</span>&nbsp;<span class="ident" id="6117679"><a href="/image/draw/draw.go.html#6117574">dy</a></span>&nbsp;<span class="op" id="6117682">=</span>&nbsp;<span class="ident" id="6117684"><a href="/image/draw/draw.go.html#6117570">y1</a></span><span class="op" id="6117686">-</span><span class="num" id="6117687">1</span><span class="op" id="6117688">,</span>&nbsp;<span class="ident" id="6117690"><a href="/image/draw/draw.go.html#6117566">y0</a></span><span class="op" id="6117692">-</span><span class="num" id="6117693">1</span><span class="op" id="6117694">,</span>&nbsp;<span class="op" id="6117696">-</span><span class="num" id="6117697">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6117700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117704">var</span>&nbsp;<span class="ident" id="6117708">out</span>&nbsp;<span class="ident" id="6117712"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6117717">.</span><span class="ident" id="6117718">RGBA64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117726">sy</span>&nbsp;<span class="op" id="6117729">:=</span>&nbsp;<span class="ident" id="6117732"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117734">.</span><span class="ident" id="6117735">Y</span>&nbsp;<span class="op" id="6117737">+</span>&nbsp;<span class="ident" id="6117739"><a href="/image/draw/draw.go.html#6117566">y0</a></span>&nbsp;<span class="op" id="6117742">-</span>&nbsp;<span class="ident" id="6117744"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117745">.</span><span class="ident" id="6117746">Min</span><span class="op" id="6117749">.</span><span class="ident" id="6117750">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117753">my</span>&nbsp;<span class="op" id="6117756">:=</span>&nbsp;<span class="ident" id="6117759"><a href="/image/draw/draw.go.html#6116166">mp</a></span><span class="op" id="6117761">.</span><span class="ident" id="6117762">Y</span>&nbsp;<span class="op" id="6117764">+</span>&nbsp;<span class="ident" id="6117766"><a href="/image/draw/draw.go.html#6117566">y0</a></span>&nbsp;<span class="op" id="6117769">-</span>&nbsp;<span class="ident" id="6117771"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117772">.</span><span class="ident" id="6117773">Min</span><span class="op" id="6117776">.</span><span class="ident" id="6117777">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117780">for</span>&nbsp;<span class="ident" id="6117784">y</span>&nbsp;<span class="op" id="6117786">:=</span>&nbsp;<span class="ident" id="6117789"><a href="/image/draw/draw.go.html#6117566">y0</a></span><span class="op" id="6117791">;</span>&nbsp;<span class="ident" id="6117793"><a href="/image/draw/draw.go.html#6117784">y</a></span>&nbsp;<span class="op" id="6117795">!=</span>&nbsp;<span class="ident" id="6117798"><a href="/image/draw/draw.go.html#6117570">y1</a></span><span class="op" id="6117800">;</span>&nbsp;<span class="ident" id="6117802"><a href="/image/draw/draw.go.html#6117784">y</a></span><span class="op" id="6117803">,</span>&nbsp;<span class="ident" id="6117805"><a href="/image/draw/draw.go.html#6117726">sy</a></span><span class="op" id="6117807">,</span>&nbsp;<span class="ident" id="6117809"><a href="/image/draw/draw.go.html#6117753">my</a></span>&nbsp;<span class="op" id="6117812">=</span>&nbsp;<span class="ident" id="6117814"><a href="/image/draw/draw.go.html#6117784">y</a></span><span class="op" id="6117815">+</span><span class="ident" id="6117816"><a href="/image/draw/draw.go.html#6117574">dy</a></span><span class="op" id="6117818">,</span>&nbsp;<span class="ident" id="6117820"><a href="/image/draw/draw.go.html#6117726">sy</a></span><span class="op" id="6117822">+</span><span class="ident" id="6117823"><a href="/image/draw/draw.go.html#6117574">dy</a></span><span class="op" id="6117825">,</span>&nbsp;<span class="ident" id="6117827"><a href="/image/draw/draw.go.html#6117753">my</a></span><span class="op" id="6117829">+</span><span class="ident" id="6117830"><a href="/image/draw/draw.go.html#6117574">dy</a></span>&nbsp;<span class="op" id="6117833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117837">sx</span>&nbsp;<span class="op" id="6117840">:=</span>&nbsp;<span class="ident" id="6117843"><a href="/image/draw/draw.go.html#6116132">sp</a></span><span class="op" id="6117845">.</span><span class="ident" id="6117846">X</span>&nbsp;<span class="op" id="6117848">+</span>&nbsp;<span class="ident" id="6117850"><a href="/image/draw/draw.go.html#6117531">x0</a></span>&nbsp;<span class="op" id="6117853">-</span>&nbsp;<span class="ident" id="6117855"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117856">.</span><span class="ident" id="6117857">Min</span><span class="op" id="6117860">.</span><span class="ident" id="6117861">X</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117865">mx</span>&nbsp;<span class="op" id="6117868">:=</span>&nbsp;<span class="ident" id="6117871"><a href="/image/draw/draw.go.html#6116166">mp</a></span><span class="op" id="6117873">.</span><span class="ident" id="6117874">X</span>&nbsp;<span class="op" id="6117876">+</span>&nbsp;<span class="ident" id="6117878"><a href="/image/draw/draw.go.html#6117531">x0</a></span>&nbsp;<span class="op" id="6117881">-</span>&nbsp;<span class="ident" id="6117883"><a href="/image/draw/draw.go.html#6116096">r</a></span><span class="op" id="6117884">.</span><span class="ident" id="6117885">Min</span><span class="op" id="6117888">.</span><span class="ident" id="6117889">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117893">for</span>&nbsp;<span class="ident" id="6117897">x</span>&nbsp;<span class="op" id="6117899">:=</span>&nbsp;<span class="ident" id="6117902"><a href="/image/draw/draw.go.html#6117531">x0</a></span><span class="op" id="6117904">;</span>&nbsp;<span class="ident" id="6117906"><a href="/image/draw/draw.go.html#6117897">x</a></span>&nbsp;<span class="op" id="6117908">!=</span>&nbsp;<span class="ident" id="6117911"><a href="/image/draw/draw.go.html#6117535">x1</a></span><span class="op" id="6117913">;</span>&nbsp;<span class="ident" id="6117915"><a href="/image/draw/draw.go.html#6117897">x</a></span><span class="op" id="6117916">,</span>&nbsp;<span class="ident" id="6117918"><a href="/image/draw/draw.go.html#6117837">sx</a></span><span class="op" id="6117920">,</span>&nbsp;<span class="ident" id="6117922"><a href="/image/draw/draw.go.html#6117865">mx</a></span>&nbsp;<span class="op" id="6117925">=</span>&nbsp;<span class="ident" id="6117927"><a href="/image/draw/draw.go.html#6117897">x</a></span><span class="op" id="6117928">+</span><span class="ident" id="6117929"><a href="/image/draw/draw.go.html#6117539">dx</a></span><span class="op" id="6117931">,</span>&nbsp;<span class="ident" id="6117933"><a href="/image/draw/draw.go.html#6117837">sx</a></span><span class="op" id="6117935">+</span><span class="ident" id="6117936"><a href="/image/draw/draw.go.html#6117539">dx</a></span><span class="op" id="6117938">,</span>&nbsp;<span class="ident" id="6117940"><a href="/image/draw/draw.go.html#6117865">mx</a></span><span class="op" id="6117942">+</span><span class="ident" id="6117943"><a href="/image/draw/draw.go.html#6117539">dx</a></span>&nbsp;<span class="op" id="6117946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117951">ma</span>&nbsp;<span class="op" id="6117954">:=</span>&nbsp;<span class="builtintype" id="6117957">uint32</span><span class="op" id="6117963">(</span><span class="ident" id="6117964"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6117965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6117970">if</span>&nbsp;<span class="ident" id="6117973"><a href="/image/draw/draw.go.html#6116148">mask</a></span>&nbsp;<span class="op" id="6117978">!=</span>&nbsp;<span class="ident" id="6117981">nil</span>&nbsp;<span class="op" id="6117985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117991">_</span><span class="op" id="6117992">,</span>&nbsp;<span class="ident" id="6117994">_</span><span class="op" id="6117995">,</span>&nbsp;<span class="ident" id="6117997">_</span><span class="op" id="6117998">,</span>&nbsp;<span class="ident" id="6118000"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118003">=</span>&nbsp;<span class="ident" id="6118005"><a href="/image/draw/draw.go.html#6116148">mask</a></span><span class="op" id="6118009">.</span><span class="ident" id="6118010">At</span><span class="op" id="6118012">(</span><span class="ident" id="6118013"><a href="/image/draw/draw.go.html#6117865">mx</a></span><span class="op" id="6118015">,</span>&nbsp;<span class="ident" id="6118017"><a href="/image/draw/draw.go.html#6117753">my</a></span><span class="op" id="6118019">)</span><span class="op" id="6118020">.</span><span class="ident" id="6118021">RGBA</span><span class="op" id="6118025">(</span><span class="op" id="6118026">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118036">switch</span>&nbsp;<span class="op" id="6118043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118048">case</span>&nbsp;<span class="ident" id="6118053"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118056">==</span>&nbsp;<span class="num" id="6118059">0</span><span class="op" id="6118060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118066">if</span>&nbsp;<span class="ident" id="6118069"><a href="/image/draw/draw.go.html#6116182">op</a></span>&nbsp;<span class="op" id="6118072">==</span>&nbsp;<span class="ident" id="6118075"><a href="/image/draw/draw.go.html#6113959">Over</a></span>&nbsp;<span class="op" id="6118080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118087">//&nbsp;No-op.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118101">}</span>&nbsp;<span class="keyword" id="6118103">else</span>&nbsp;<span class="op" id="6118108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118115"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6118118">.</span><span class="ident" id="6118119">Set</span><span class="op" id="6118122">(</span><span class="ident" id="6118123"><a href="/image/draw/draw.go.html#6117897">x</a></span><span class="op" id="6118124">,</span>&nbsp;<span class="ident" id="6118126"><a href="/image/draw/draw.go.html#6117784">y</a></span><span class="op" id="6118127">,</span>&nbsp;<span class="ident" id="6118129"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6118134">.</span><span class="ident" id="6118135">Transparent</span><span class="op" id="6118146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118157">case</span>&nbsp;<span class="ident" id="6118162"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118165">==</span>&nbsp;<span class="ident" id="6118168"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6118170">&amp;&amp;</span>&nbsp;<span class="ident" id="6118173"><a href="/image/draw/draw.go.html#6116182">op</a></span>&nbsp;<span class="op" id="6118176">==</span>&nbsp;<span class="ident" id="6118179"><a href="/image/draw/draw.go.html#6114010">Src</a></span><span class="op" id="6118182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118188"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6118191">.</span><span class="ident" id="6118192">Set</span><span class="op" id="6118195">(</span><span class="ident" id="6118196"><a href="/image/draw/draw.go.html#6117897">x</a></span><span class="op" id="6118197">,</span>&nbsp;<span class="ident" id="6118199"><a href="/image/draw/draw.go.html#6117784">y</a></span><span class="op" id="6118200">,</span>&nbsp;<span class="ident" id="6118202"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6118205">.</span><span class="ident" id="6118206">At</span><span class="op" id="6118208">(</span><span class="ident" id="6118209"><a href="/image/draw/draw.go.html#6117837">sx</a></span><span class="op" id="6118211">,</span>&nbsp;<span class="ident" id="6118213"><a href="/image/draw/draw.go.html#6117726">sy</a></span><span class="op" id="6118215">)</span><span class="op" id="6118216">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118221">default</span><span class="op" id="6118228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118234">sr</span><span class="op" id="6118236">,</span>&nbsp;<span class="ident" id="6118238">sg</span><span class="op" id="6118240">,</span>&nbsp;<span class="ident" id="6118242">sb</span><span class="op" id="6118244">,</span>&nbsp;<span class="ident" id="6118246">sa</span>&nbsp;<span class="op" id="6118249">:=</span>&nbsp;<span class="ident" id="6118252"><a href="/image/draw/draw.go.html#6116115">src</a></span><span class="op" id="6118255">.</span><span class="ident" id="6118256">At</span><span class="op" id="6118258">(</span><span class="ident" id="6118259"><a href="/image/draw/draw.go.html#6117837">sx</a></span><span class="op" id="6118261">,</span>&nbsp;<span class="ident" id="6118263"><a href="/image/draw/draw.go.html#6117726">sy</a></span><span class="op" id="6118265">)</span><span class="op" id="6118266">.</span><span class="ident" id="6118267">RGBA</span><span class="op" id="6118271">(</span><span class="op" id="6118272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118278">if</span>&nbsp;<span class="ident" id="6118281"><a href="/image/draw/draw.go.html#6116182">op</a></span>&nbsp;<span class="op" id="6118284">==</span>&nbsp;<span class="ident" id="6118287"><a href="/image/draw/draw.go.html#6113959">Over</a></span>&nbsp;<span class="op" id="6118292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118299">dr</span><span class="op" id="6118301">,</span>&nbsp;<span class="ident" id="6118303">dg</span><span class="op" id="6118305">,</span>&nbsp;<span class="ident" id="6118307">db</span><span class="op" id="6118309">,</span>&nbsp;<span class="ident" id="6118311">da</span>&nbsp;<span class="op" id="6118314">:=</span>&nbsp;<span class="ident" id="6118317"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6118320">.</span><span class="ident" id="6118321">At</span><span class="op" id="6118323">(</span><span class="ident" id="6118324"><a href="/image/draw/draw.go.html#6117897">x</a></span><span class="op" id="6118325">,</span>&nbsp;<span class="ident" id="6118327"><a href="/image/draw/draw.go.html#6117784">y</a></span><span class="op" id="6118328">)</span><span class="op" id="6118329">.</span><span class="ident" id="6118330">RGBA</span><span class="op" id="6118334">(</span><span class="op" id="6118335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118342">a</span>&nbsp;<span class="op" id="6118344">:=</span>&nbsp;<span class="ident" id="6118347"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6118349">-</span>&nbsp;<span class="op" id="6118351">(</span><span class="ident" id="6118352"><a href="/image/draw/draw.go.html#6118246">sa</a></span>&nbsp;<span class="op" id="6118355">*</span>&nbsp;<span class="ident" id="6118357"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118360">/</span>&nbsp;<span class="ident" id="6118362"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118363">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118370"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118373">.</span><span class="ident" id="6118374">R</span>&nbsp;<span class="op" id="6118376">=</span>&nbsp;<span class="builtintype" id="6118378">uint16</span><span class="op" id="6118384">(</span><span class="op" id="6118385">(</span><span class="ident" id="6118386"><a href="/image/draw/draw.go.html#6118299">dr</a></span><span class="op" id="6118388">*</span><span class="ident" id="6118389"><a href="/image/draw/draw.go.html#6118342">a</a></span>&nbsp;<span class="op" id="6118391">+</span>&nbsp;<span class="ident" id="6118393"><a href="/image/draw/draw.go.html#6118234">sr</a></span><span class="op" id="6118395">*</span><span class="ident" id="6118396"><a href="/image/draw/draw.go.html#6117951">ma</a></span><span class="op" id="6118398">)</span>&nbsp;<span class="op" id="6118400">/</span>&nbsp;<span class="ident" id="6118402"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118410"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118413">.</span><span class="ident" id="6118414">G</span>&nbsp;<span class="op" id="6118416">=</span>&nbsp;<span class="builtintype" id="6118418">uint16</span><span class="op" id="6118424">(</span><span class="op" id="6118425">(</span><span class="ident" id="6118426"><a href="/image/draw/draw.go.html#6118303">dg</a></span><span class="op" id="6118428">*</span><span class="ident" id="6118429"><a href="/image/draw/draw.go.html#6118342">a</a></span>&nbsp;<span class="op" id="6118431">+</span>&nbsp;<span class="ident" id="6118433"><a href="/image/draw/draw.go.html#6118238">sg</a></span><span class="op" id="6118435">*</span><span class="ident" id="6118436"><a href="/image/draw/draw.go.html#6117951">ma</a></span><span class="op" id="6118438">)</span>&nbsp;<span class="op" id="6118440">/</span>&nbsp;<span class="ident" id="6118442"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118450"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118453">.</span><span class="ident" id="6118454">B</span>&nbsp;<span class="op" id="6118456">=</span>&nbsp;<span class="builtintype" id="6118458">uint16</span><span class="op" id="6118464">(</span><span class="op" id="6118465">(</span><span class="ident" id="6118466"><a href="/image/draw/draw.go.html#6118307">db</a></span><span class="op" id="6118468">*</span><span class="ident" id="6118469"><a href="/image/draw/draw.go.html#6118342">a</a></span>&nbsp;<span class="op" id="6118471">+</span>&nbsp;<span class="ident" id="6118473"><a href="/image/draw/draw.go.html#6118242">sb</a></span><span class="op" id="6118475">*</span><span class="ident" id="6118476"><a href="/image/draw/draw.go.html#6117951">ma</a></span><span class="op" id="6118478">)</span>&nbsp;<span class="op" id="6118480">/</span>&nbsp;<span class="ident" id="6118482"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118490"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118493">.</span><span class="ident" id="6118494">A</span>&nbsp;<span class="op" id="6118496">=</span>&nbsp;<span class="builtintype" id="6118498">uint16</span><span class="op" id="6118504">(</span><span class="op" id="6118505">(</span><span class="ident" id="6118506"><a href="/image/draw/draw.go.html#6118311">da</a></span><span class="op" id="6118508">*</span><span class="ident" id="6118509"><a href="/image/draw/draw.go.html#6118342">a</a></span>&nbsp;<span class="op" id="6118511">+</span>&nbsp;<span class="ident" id="6118513"><a href="/image/draw/draw.go.html#6118246">sa</a></span><span class="op" id="6118515">*</span><span class="ident" id="6118516"><a href="/image/draw/draw.go.html#6117951">ma</a></span><span class="op" id="6118518">)</span>&nbsp;<span class="op" id="6118520">/</span>&nbsp;<span class="ident" id="6118522"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118529">}</span>&nbsp;<span class="keyword" id="6118531">else</span>&nbsp;<span class="op" id="6118536">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118543"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118546">.</span><span class="ident" id="6118547">R</span>&nbsp;<span class="op" id="6118549">=</span>&nbsp;<span class="builtintype" id="6118551">uint16</span><span class="op" id="6118557">(</span><span class="ident" id="6118558"><a href="/image/draw/draw.go.html#6118234">sr</a></span>&nbsp;<span class="op" id="6118561">*</span>&nbsp;<span class="ident" id="6118563"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118566">/</span>&nbsp;<span class="ident" id="6118568"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118576"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118579">.</span><span class="ident" id="6118580">G</span>&nbsp;<span class="op" id="6118582">=</span>&nbsp;<span class="builtintype" id="6118584">uint16</span><span class="op" id="6118590">(</span><span class="ident" id="6118591"><a href="/image/draw/draw.go.html#6118238">sg</a></span>&nbsp;<span class="op" id="6118594">*</span>&nbsp;<span class="ident" id="6118596"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118599">/</span>&nbsp;<span class="ident" id="6118601"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118609"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118612">.</span><span class="ident" id="6118613">B</span>&nbsp;<span class="op" id="6118615">=</span>&nbsp;<span class="builtintype" id="6118617">uint16</span><span class="op" id="6118623">(</span><span class="ident" id="6118624"><a href="/image/draw/draw.go.html#6118242">sb</a></span>&nbsp;<span class="op" id="6118627">*</span>&nbsp;<span class="ident" id="6118629"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118632">/</span>&nbsp;<span class="ident" id="6118634"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118642"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118645">.</span><span class="ident" id="6118646">A</span>&nbsp;<span class="op" id="6118648">=</span>&nbsp;<span class="builtintype" id="6118650">uint16</span><span class="op" id="6118656">(</span><span class="ident" id="6118657"><a href="/image/draw/draw.go.html#6118246">sa</a></span>&nbsp;<span class="op" id="6118660">*</span>&nbsp;<span class="ident" id="6118662"><a href="/image/draw/draw.go.html#6117951">ma</a></span>&nbsp;<span class="op" id="6118665">/</span>&nbsp;<span class="ident" id="6118667"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6118668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118674">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118680">//&nbsp;The&nbsp;third&nbsp;argument&nbsp;is&nbsp;&amp;out&nbsp;instead&nbsp;of&nbsp;out&nbsp;(and&nbsp;out&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118741">//&nbsp;declared&nbsp;outside&nbsp;of&nbsp;the&nbsp;inner&nbsp;loop)&nbsp;to&nbsp;avoid&nbsp;the&nbsp;implicit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118806">//&nbsp;conversion&nbsp;to&nbsp;color.Color&nbsp;here&nbsp;allocating&nbsp;memory&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118869">//&nbsp;inner&nbsp;loop&nbsp;if&nbsp;sizeof(color.RGBA64)&nbsp;&gt;&nbsp;sizeof(uintptr).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118930"><a href="/image/draw/draw.go.html#6116085">dst</a></span><span class="op" id="6118933">.</span><span class="ident" id="6118934">Set</span><span class="op" id="6118937">(</span><span class="ident" id="6118938"><a href="/image/draw/draw.go.html#6117897">x</a></span><span class="op" id="6118939">,</span>&nbsp;<span class="ident" id="6118941"><a href="/image/draw/draw.go.html#6117784">y</a></span><span class="op" id="6118942">,</span>&nbsp;<span class="op" id="6118944">&amp;</span><span class="ident" id="6118945"><a href="/image/draw/draw.go.html#6117708">out</a></span><span class="op" id="6118948">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118960">}</span><br>
<span class="lineno"></span><span class="op" id="6118962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="6118965">func</span>&nbsp;<span class="ident" id="6118970">drawFillOver</span><span class="op" id="6118982">(</span><span class="ident" id="6118983">dst</span>&nbsp;<span class="op" id="6118987">*</span><span class="ident" id="6118988"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6118993">.</span><span class="ident" id="6118994">RGBA</span><span class="op" id="6118998">,</span>&nbsp;<span class="ident" id="6119000">r</span>&nbsp;<span class="ident" id="6119002"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6119007">.</span><span class="ident" id="6119008">Rectangle</span><span class="op" id="6119017">,</span>&nbsp;<span class="ident" id="6119019">src</span>&nbsp;<span class="op" id="6119023">*</span><span class="ident" id="6119024"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6119029">.</span><span class="ident" id="6119030">Uniform</span><span class="op" id="6119037">)</span>&nbsp;<span class="op" id="6119039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119042">sr</span><span class="op" id="6119044">,</span>&nbsp;<span class="ident" id="6119046">sg</span><span class="op" id="6119048">,</span>&nbsp;<span class="ident" id="6119050">sb</span><span class="op" id="6119052">,</span>&nbsp;<span class="ident" id="6119054">sa</span>&nbsp;<span class="op" id="6119057">:=</span>&nbsp;<span class="ident" id="6119060"><a href="/image/draw/draw.go.html#6119019">src</a></span><span class="op" id="6119063">.</span><span class="ident" id="6119064">RGBA</span><span class="op" id="6119068">(</span><span class="op" id="6119069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6119072">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119130">a</span>&nbsp;<span class="op" id="6119132">:=</span>&nbsp;<span class="op" id="6119135">(</span><span class="ident" id="6119136"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6119138">-</span>&nbsp;<span class="ident" id="6119140"><a href="/image/draw/draw.go.html#6119054">sa</a></span><span class="op" id="6119142">)</span>&nbsp;<span class="op" id="6119144">*</span>&nbsp;<span class="num" id="6119146">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119153">i0</span>&nbsp;<span class="op" id="6119156">:=</span>&nbsp;<span class="ident" id="6119159"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119162">.</span><span class="ident" id="6119163">PixOffset</span><span class="op" id="6119172">(</span><span class="ident" id="6119173"><a href="/image/draw/draw.go.html#6119000">r</a></span><span class="op" id="6119174">.</span><span class="ident" id="6119175">Min</span><span class="op" id="6119178">.</span><span class="ident" id="6119179">X</span><span class="op" id="6119180">,</span>&nbsp;<span class="ident" id="6119182"><a href="/image/draw/draw.go.html#6119000">r</a></span><span class="op" id="6119183">.</span><span class="ident" id="6119184">Min</span><span class="op" id="6119187">.</span><span class="ident" id="6119188">Y</span><span class="op" id="6119189">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119192">i1</span>&nbsp;<span class="op" id="6119195">:=</span>&nbsp;<span class="ident" id="6119198"><a href="/image/draw/draw.go.html#6119153">i0</a></span>&nbsp;<span class="op" id="6119201">+</span>&nbsp;<span class="ident" id="6119203"><a href="/image/draw/draw.go.html#6119000">r</a></span><span class="op" id="6119204">.</span><span class="ident" id="6119205">Dx</span><span class="op" id="6119207">(</span><span class="op" id="6119208">)</span><span class="op" id="6119209">*</span><span class="num" id="6119210">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119213">for</span>&nbsp;<span class="ident" id="6119217">y</span>&nbsp;<span class="op" id="6119219">:=</span>&nbsp;<span class="ident" id="6119222"><a href="/image/draw/draw.go.html#6119000">r</a></span><span class="op" id="6119223">.</span><span class="ident" id="6119224">Min</span><span class="op" id="6119227">.</span><span class="ident" id="6119228">Y</span><span class="op" id="6119229">;</span>&nbsp;<span class="ident" id="6119231"><a href="/image/draw/draw.go.html#6119217">y</a></span>&nbsp;<span class="op" id="6119233">!=</span>&nbsp;<span class="ident" id="6119236"><a href="/image/draw/draw.go.html#6119000">r</a></span><span class="op" id="6119237">.</span><span class="ident" id="6119238">Max</span><span class="op" id="6119241">.</span><span class="ident" id="6119242">Y</span><span class="op" id="6119243">;</span>&nbsp;<span class="ident" id="6119245"><a href="/image/draw/draw.go.html#6119217">y</a></span><span class="op" id="6119246">++</span>&nbsp;<span class="op" id="6119249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119253">for</span>&nbsp;<span class="ident" id="6119257">i</span>&nbsp;<span class="op" id="6119259">:=</span>&nbsp;<span class="ident" id="6119262"><a href="/image/draw/draw.go.html#6119153">i0</a></span><span class="op" id="6119264">;</span>&nbsp;<span class="ident" id="6119266"><a href="/image/draw/draw.go.html#6119257">i</a></span>&nbsp;<span class="op" id="6119268">&lt;</span>&nbsp;<span class="ident" id="6119270"><a href="/image/draw/draw.go.html#6119192">i1</a></span><span class="op" id="6119272">;</span>&nbsp;<span class="ident" id="6119274"><a href="/image/draw/draw.go.html#6119257">i</a></span>&nbsp;<span class="op" id="6119276">+=</span>&nbsp;<span class="num" id="6119279">4</span>&nbsp;<span class="op" id="6119281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119286">dr</span>&nbsp;<span class="op" id="6119289">:=</span>&nbsp;<span class="builtintype" id="6119292">uint32</span><span class="op" id="6119298">(</span><span class="ident" id="6119299"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119302">.</span><span class="ident" id="6119303">Pix</span><span class="op" id="6119306">[</span><span class="ident" id="6119307"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119308">+</span><span class="num" id="6119309">0</span><span class="op" id="6119310">]</span><span class="op" id="6119311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119316">dg</span>&nbsp;<span class="op" id="6119319">:=</span>&nbsp;<span class="builtintype" id="6119322">uint32</span><span class="op" id="6119328">(</span><span class="ident" id="6119329"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119332">.</span><span class="ident" id="6119333">Pix</span><span class="op" id="6119336">[</span><span class="ident" id="6119337"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119338">+</span><span class="num" id="6119339">1</span><span class="op" id="6119340">]</span><span class="op" id="6119341">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119346">db</span>&nbsp;<span class="op" id="6119349">:=</span>&nbsp;<span class="builtintype" id="6119352">uint32</span><span class="op" id="6119358">(</span><span class="ident" id="6119359"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119362">.</span><span class="ident" id="6119363">Pix</span><span class="op" id="6119366">[</span><span class="ident" id="6119367"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119368">+</span><span class="num" id="6119369">2</span><span class="op" id="6119370">]</span><span class="op" id="6119371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119376">da</span>&nbsp;<span class="op" id="6119379">:=</span>&nbsp;<span class="builtintype" id="6119382">uint32</span><span class="op" id="6119388">(</span><span class="ident" id="6119389"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119392">.</span><span class="ident" id="6119393">Pix</span><span class="op" id="6119396">[</span><span class="ident" id="6119397"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119398">+</span><span class="num" id="6119399">3</span><span class="op" id="6119400">]</span><span class="op" id="6119401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119407"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119410">.</span><span class="ident" id="6119411">Pix</span><span class="op" id="6119414">[</span><span class="ident" id="6119415"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119416">+</span><span class="num" id="6119417">0</span><span class="op" id="6119418">]</span>&nbsp;<span class="op" id="6119420">=</span>&nbsp;<span class="builtintype" id="6119422">uint8</span><span class="op" id="6119427">(</span><span class="op" id="6119428">(</span><span class="ident" id="6119429"><a href="/image/draw/draw.go.html#6119286">dr</a></span><span class="op" id="6119431">*</span><span class="ident" id="6119432"><a href="/image/draw/draw.go.html#6119130">a</a></span><span class="op" id="6119433">/</span><span class="ident" id="6119434"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6119436">+</span>&nbsp;<span class="ident" id="6119438"><a href="/image/draw/draw.go.html#6119042">sr</a></span><span class="op" id="6119440">)</span>&nbsp;<span class="op" id="6119442">&gt;&gt;</span>&nbsp;<span class="num" id="6119445">8</span><span class="op" id="6119446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119451"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119454">.</span><span class="ident" id="6119455">Pix</span><span class="op" id="6119458">[</span><span class="ident" id="6119459"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119460">+</span><span class="num" id="6119461">1</span><span class="op" id="6119462">]</span>&nbsp;<span class="op" id="6119464">=</span>&nbsp;<span class="builtintype" id="6119466">uint8</span><span class="op" id="6119471">(</span><span class="op" id="6119472">(</span><span class="ident" id="6119473"><a href="/image/draw/draw.go.html#6119316">dg</a></span><span class="op" id="6119475">*</span><span class="ident" id="6119476"><a href="/image/draw/draw.go.html#6119130">a</a></span><span class="op" id="6119477">/</span><span class="ident" id="6119478"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6119480">+</span>&nbsp;<span class="ident" id="6119482"><a href="/image/draw/draw.go.html#6119046">sg</a></span><span class="op" id="6119484">)</span>&nbsp;<span class="op" id="6119486">&gt;&gt;</span>&nbsp;<span class="num" id="6119489">8</span><span class="op" id="6119490">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119495"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119498">.</span><span class="ident" id="6119499">Pix</span><span class="op" id="6119502">[</span><span class="ident" id="6119503"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119504">+</span><span class="num" id="6119505">2</span><span class="op" id="6119506">]</span>&nbsp;<span class="op" id="6119508">=</span>&nbsp;<span class="builtintype" id="6119510">uint8</span><span class="op" id="6119515">(</span><span class="op" id="6119516">(</span><span class="ident" id="6119517"><a href="/image/draw/draw.go.html#6119346">db</a></span><span class="op" id="6119519">*</span><span class="ident" id="6119520"><a href="/image/draw/draw.go.html#6119130">a</a></span><span class="op" id="6119521">/</span><span class="ident" id="6119522"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6119524">+</span>&nbsp;<span class="ident" id="6119526"><a href="/image/draw/draw.go.html#6119050">sb</a></span><span class="op" id="6119528">)</span>&nbsp;<span class="op" id="6119530">&gt;&gt;</span>&nbsp;<span class="num" id="6119533">8</span><span class="op" id="6119534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119539"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119542">.</span><span class="ident" id="6119543">Pix</span><span class="op" id="6119546">[</span><span class="ident" id="6119547"><a href="/image/draw/draw.go.html#6119257">i</a></span><span class="op" id="6119548">+</span><span class="num" id="6119549">3</span><span class="op" id="6119550">]</span>&nbsp;<span class="op" id="6119552">=</span>&nbsp;<span class="builtintype" id="6119554">uint8</span><span class="op" id="6119559">(</span><span class="op" id="6119560">(</span><span class="ident" id="6119561"><a href="/image/draw/draw.go.html#6119376">da</a></span><span class="op" id="6119563">*</span><span class="ident" id="6119564"><a href="/image/draw/draw.go.html#6119130">a</a></span><span class="op" id="6119565">/</span><span class="ident" id="6119566"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6119568">+</span>&nbsp;<span class="ident" id="6119570"><a href="/image/draw/draw.go.html#6119054">sa</a></span><span class="op" id="6119572">)</span>&nbsp;<span class="op" id="6119574">&gt;&gt;</span>&nbsp;<span class="num" id="6119577">8</span><span class="op" id="6119578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119586"><a href="/image/draw/draw.go.html#6119153">i0</a></span>&nbsp;<span class="op" id="6119589">+=</span>&nbsp;<span class="ident" id="6119592"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119595">.</span><span class="ident" id="6119596">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119605"><a href="/image/draw/draw.go.html#6119192">i1</a></span>&nbsp;<span class="op" id="6119608">+=</span>&nbsp;<span class="ident" id="6119611"><a href="/image/draw/draw.go.html#6118983">dst</a></span><span class="op" id="6119614">.</span><span class="ident" id="6119615">Stride</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119623">}</span><br>
<span class="lineno"></span><span class="op" id="6119625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6119628">func</span>&nbsp;<span class="ident" id="6119633">drawFillSrc</span><span class="op" id="6119644">(</span><span class="ident" id="6119645">dst</span>&nbsp;<span class="op" id="6119649">*</span><span class="ident" id="6119650"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6119655">.</span><span class="ident" id="6119656">RGBA</span><span class="op" id="6119660">,</span>&nbsp;<span class="ident" id="6119662">r</span>&nbsp;<span class="ident" id="6119664"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6119669">.</span><span class="ident" id="6119670">Rectangle</span><span class="op" id="6119679">,</span>&nbsp;<span class="ident" id="6119681">src</span>&nbsp;<span class="op" id="6119685">*</span><span class="ident" id="6119686"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6119691">.</span><span class="ident" id="6119692">Uniform</span><span class="op" id="6119699">)</span>&nbsp;<span class="op" id="6119701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119704">sr</span><span class="op" id="6119706">,</span>&nbsp;<span class="ident" id="6119708">sg</span><span class="op" id="6119710">,</span>&nbsp;<span class="ident" id="6119712">sb</span><span class="op" id="6119714">,</span>&nbsp;<span class="ident" id="6119716">sa</span>&nbsp;<span class="op" id="6119719">:=</span>&nbsp;<span class="ident" id="6119722"><a href="/image/draw/draw.go.html#6119681">src</a></span><span class="op" id="6119725">.</span><span class="ident" id="6119726">RGBA</span><span class="op" id="6119730">(</span><span class="op" id="6119731">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6119734">//&nbsp;The&nbsp;built-in&nbsp;copy&nbsp;function&nbsp;is&nbsp;faster&nbsp;than&nbsp;a&nbsp;straightforward&nbsp;for&nbsp;loop&nbsp;to&nbsp;fill&nbsp;the&nbsp;destination&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6119836">//&nbsp;the&nbsp;color,&nbsp;but&nbsp;copy&nbsp;requires&nbsp;a&nbsp;slice&nbsp;source.&nbsp;We&nbsp;therefore&nbsp;use&nbsp;a&nbsp;for&nbsp;loop&nbsp;to&nbsp;fill&nbsp;the&nbsp;first&nbsp;row,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6119940">//&nbsp;then&nbsp;use&nbsp;the&nbsp;first&nbsp;row&nbsp;as&nbsp;the&nbsp;slice&nbsp;source&nbsp;for&nbsp;the&nbsp;remaining&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120011">i0</span>&nbsp;<span class="op" id="6120014">:=</span>&nbsp;<span class="ident" id="6120017"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120020">.</span><span class="ident" id="6120021">PixOffset</span><span class="op" id="6120030">(</span><span class="ident" id="6120031"><a href="/image/draw/draw.go.html#6119662">r</a></span><span class="op" id="6120032">.</span><span class="ident" id="6120033">Min</span><span class="op" id="6120036">.</span><span class="ident" id="6120037">X</span><span class="op" id="6120038">,</span>&nbsp;<span class="ident" id="6120040"><a href="/image/draw/draw.go.html#6119662">r</a></span><span class="op" id="6120041">.</span><span class="ident" id="6120042">Min</span><span class="op" id="6120045">.</span><span class="ident" id="6120046">Y</span><span class="op" id="6120047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120050">i1</span>&nbsp;<span class="op" id="6120053">:=</span>&nbsp;<span class="ident" id="6120056"><a href="/image/draw/draw.go.html#6120011">i0</a></span>&nbsp;<span class="op" id="6120059">+</span>&nbsp;<span class="ident" id="6120061"><a href="/image/draw/draw.go.html#6119662">r</a></span><span class="op" id="6120062">.</span><span class="ident" id="6120063">Dx</span><span class="op" id="6120065">(</span><span class="op" id="6120066">)</span><span class="op" id="6120067">*</span><span class="num" id="6120068">4</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120071">for</span>&nbsp;<span class="ident" id="6120075">i</span>&nbsp;<span class="op" id="6120077">:=</span>&nbsp;<span class="ident" id="6120080"><a href="/image/draw/draw.go.html#6120011">i0</a></span><span class="op" id="6120082">;</span>&nbsp;<span class="ident" id="6120084"><a href="/image/draw/draw.go.html#6120075">i</a></span>&nbsp;<span class="op" id="6120086">&lt;</span>&nbsp;<span class="ident" id="6120088"><a href="/image/draw/draw.go.html#6120050">i1</a></span><span class="op" id="6120090">;</span>&nbsp;<span class="ident" id="6120092"><a href="/image/draw/draw.go.html#6120075">i</a></span>&nbsp;<span class="op" id="6120094">+=</span>&nbsp;<span class="num" id="6120097">4</span>&nbsp;<span class="op" id="6120099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120103"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120106">.</span><span class="ident" id="6120107">Pix</span><span class="op" id="6120110">[</span><span class="ident" id="6120111"><a href="/image/draw/draw.go.html#6120075">i</a></span><span class="op" id="6120112">+</span><span class="num" id="6120113">0</span><span class="op" id="6120114">]</span>&nbsp;<span class="op" id="6120116">=</span>&nbsp;<span class="builtintype" id="6120118">uint8</span><span class="op" id="6120123">(</span><span class="ident" id="6120124"><a href="/image/draw/draw.go.html#6119704">sr</a></span>&nbsp;<span class="op" id="6120127">&gt;&gt;</span>&nbsp;<span class="num" id="6120130">8</span><span class="op" id="6120131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120135"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120138">.</span><span class="ident" id="6120139">Pix</span><span class="op" id="6120142">[</span><span class="ident" id="6120143"><a href="/image/draw/draw.go.html#6120075">i</a></span><span class="op" id="6120144">+</span><span class="num" id="6120145">1</span><span class="op" id="6120146">]</span>&nbsp;<span class="op" id="6120148">=</span>&nbsp;<span class="builtintype" id="6120150">uint8</span><span class="op" id="6120155">(</span><span class="ident" id="6120156"><a href="/image/draw/draw.go.html#6119708">sg</a></span>&nbsp;<span class="op" id="6120159">&gt;&gt;</span>&nbsp;<span class="num" id="6120162">8</span><span class="op" id="6120163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120167"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120170">.</span><span class="ident" id="6120171">Pix</span><span class="op" id="6120174">[</span><span class="ident" id="6120175"><a href="/image/draw/draw.go.html#6120075">i</a></span><span class="op" id="6120176">+</span><span class="num" id="6120177">2</span><span class="op" id="6120178">]</span>&nbsp;<span class="op" id="6120180">=</span>&nbsp;<span class="builtintype" id="6120182">uint8</span><span class="op" id="6120187">(</span><span class="ident" id="6120188"><a href="/image/draw/draw.go.html#6119712">sb</a></span>&nbsp;<span class="op" id="6120191">&gt;&gt;</span>&nbsp;<span class="num" id="6120194">8</span><span class="op" id="6120195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120199"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120202">.</span><span class="ident" id="6120203">Pix</span><span class="op" id="6120206">[</span><span class="ident" id="6120207"><a href="/image/draw/draw.go.html#6120075">i</a></span><span class="op" id="6120208">+</span><span class="num" id="6120209">3</span><span class="op" id="6120210">]</span>&nbsp;<span class="op" id="6120212">=</span>&nbsp;<span class="builtintype" id="6120214">uint8</span><span class="op" id="6120219">(</span><span class="ident" id="6120220"><a href="/image/draw/draw.go.html#6119716">sa</a></span>&nbsp;<span class="op" id="6120223">&gt;&gt;</span>&nbsp;<span class="num" id="6120226">8</span><span class="op" id="6120227">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120233">firstRow</span>&nbsp;<span class="op" id="6120242">:=</span>&nbsp;<span class="ident" id="6120245"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120248">.</span><span class="ident" id="6120249">Pix</span><span class="op" id="6120252">[</span><span class="ident" id="6120253"><a href="/image/draw/draw.go.html#6120011">i0</a></span><span class="op" id="6120255">:</span><span class="ident" id="6120256"><a href="/image/draw/draw.go.html#6120050">i1</a></span><span class="op" id="6120258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120261">for</span>&nbsp;<span class="ident" id="6120265">y</span>&nbsp;<span class="op" id="6120267">:=</span>&nbsp;<span class="ident" id="6120270"><a href="/image/draw/draw.go.html#6119662">r</a></span><span class="op" id="6120271">.</span><span class="ident" id="6120272">Min</span><span class="op" id="6120275">.</span><span class="ident" id="6120276">Y</span>&nbsp;<span class="op" id="6120278">+</span>&nbsp;<span class="num" id="6120280">1</span><span class="op" id="6120281">;</span>&nbsp;<span class="ident" id="6120283"><a href="/image/draw/draw.go.html#6120265">y</a></span>&nbsp;<span class="op" id="6120285">&lt;</span>&nbsp;<span class="ident" id="6120287"><a href="/image/draw/draw.go.html#6119662">r</a></span><span class="op" id="6120288">.</span><span class="ident" id="6120289">Max</span><span class="op" id="6120292">.</span><span class="ident" id="6120293">Y</span><span class="op" id="6120294">;</span>&nbsp;<span class="ident" id="6120296"><a href="/image/draw/draw.go.html#6120265">y</a></span><span class="op" id="6120297">++</span>&nbsp;<span class="op" id="6120300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120304"><a href="/image/draw/draw.go.html#6120011">i0</a></span>&nbsp;<span class="op" id="6120307">+=</span>&nbsp;<span class="ident" id="6120310"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120313">.</span><span class="ident" id="6120314">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120323"><a href="/image/draw/draw.go.html#6120050">i1</a></span>&nbsp;<span class="op" id="6120326">+=</span>&nbsp;<span class="ident" id="6120329"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120332">.</span><span class="ident" id="6120333">Stride</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6120342">copy</span><span class="op" id="6120346">(</span><span class="ident" id="6120347"><a href="/image/draw/draw.go.html#6119645">dst</a></span><span class="op" id="6120350">.</span><span class="ident" id="6120351">Pix</span><span class="op" id="6120354">[</span><span class="ident" id="6120355"><a href="/image/draw/draw.go.html#6120011">i0</a></span><span class="op" id="6120357">:</span><span class="ident" id="6120358"><a href="/image/draw/draw.go.html#6120050">i1</a></span><span class="op" id="6120360">]</span><span class="op" id="6120361">,</span>&nbsp;<span class="ident" id="6120363"><a href="/image/draw/draw.go.html#6120233">firstRow</a></span><span class="op" id="6120371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120374">}</span><br>
<span class="lineno"></span><span class="op" id="6120376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6120379">func</span>&nbsp;<span class="ident" id="6120384">drawCopyOver</span><span class="op" id="6120396">(</span><span class="ident" id="6120397">dst</span>&nbsp;<span class="op" id="6120401">*</span><span class="ident" id="6120402"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6120407">.</span><span class="ident" id="6120408">RGBA</span><span class="op" id="6120412">,</span>&nbsp;<span class="ident" id="6120414">r</span>&nbsp;<span class="ident" id="6120416"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6120421">.</span><span class="ident" id="6120422">Rectangle</span><span class="op" id="6120431">,</span>&nbsp;<span class="ident" id="6120433">src</span>&nbsp;<span class="op" id="6120437">*</span><span class="ident" id="6120438"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6120443">.</span><span class="ident" id="6120444">RGBA</span><span class="op" id="6120448">,</span>&nbsp;<span class="ident" id="6120450">sp</span>&nbsp;<span class="ident" id="6120453"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6120458">.</span><span class="ident" id="6120459">Point</span><span class="op" id="6120464">)</span>&nbsp;<span class="op" id="6120466">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120469">dx</span><span class="op" id="6120471">,</span>&nbsp;<span class="ident" id="6120473">dy</span>&nbsp;<span class="op" id="6120476">:=</span>&nbsp;<span class="ident" id="6120479"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120480">.</span><span class="ident" id="6120481">Dx</span><span class="op" id="6120483">(</span><span class="op" id="6120484">)</span><span class="op" id="6120485">,</span>&nbsp;<span class="ident" id="6120487"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120488">.</span><span class="ident" id="6120489">Dy</span><span class="op" id="6120491">(</span><span class="op" id="6120492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120495">d0</span>&nbsp;<span class="op" id="6120498">:=</span>&nbsp;<span class="ident" id="6120501"><a href="/image/draw/draw.go.html#6120397">dst</a></span><span class="op" id="6120504">.</span><span class="ident" id="6120505">PixOffset</span><span class="op" id="6120514">(</span><span class="ident" id="6120515"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120516">.</span><span class="ident" id="6120517">Min</span><span class="op" id="6120520">.</span><span class="ident" id="6120521">X</span><span class="op" id="6120522">,</span>&nbsp;<span class="ident" id="6120524"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120525">.</span><span class="ident" id="6120526">Min</span><span class="op" id="6120529">.</span><span class="ident" id="6120530">Y</span><span class="op" id="6120531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120534">s0</span>&nbsp;<span class="op" id="6120537">:=</span>&nbsp;<span class="ident" id="6120540"><a href="/image/draw/draw.go.html#6120433">src</a></span><span class="op" id="6120543">.</span><span class="ident" id="6120544">PixOffset</span><span class="op" id="6120553">(</span><span class="ident" id="6120554"><a href="/image/draw/draw.go.html#6120450">sp</a></span><span class="op" id="6120556">.</span><span class="ident" id="6120557">X</span><span class="op" id="6120558">,</span>&nbsp;<span class="ident" id="6120560"><a href="/image/draw/draw.go.html#6120450">sp</a></span><span class="op" id="6120562">.</span><span class="ident" id="6120563">Y</span><span class="op" id="6120564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120567">var</span>&nbsp;<span class="op" id="6120571">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120575">ddelta</span><span class="op" id="6120581">,</span>&nbsp;<span class="ident" id="6120583">sdelta</span>&nbsp;<span class="builtintype" id="6120590">int</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120596">i0</span><span class="op" id="6120598">,</span>&nbsp;<span class="ident" id="6120600">i1</span><span class="op" id="6120602">,</span>&nbsp;<span class="ident" id="6120604">idelta</span>&nbsp;<span class="builtintype" id="6120611">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120619">if</span>&nbsp;<span class="ident" id="6120622"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120623">.</span><span class="ident" id="6120624">Min</span><span class="op" id="6120627">.</span><span class="ident" id="6120628">Y</span>&nbsp;<span class="op" id="6120630">&lt;</span>&nbsp;<span class="ident" id="6120632"><a href="/image/draw/draw.go.html#6120450">sp</a></span><span class="op" id="6120634">.</span><span class="ident" id="6120635">Y</span>&nbsp;<span class="op" id="6120637">||</span>&nbsp;<span class="ident" id="6120640"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120641">.</span><span class="ident" id="6120642">Min</span><span class="op" id="6120645">.</span><span class="ident" id="6120646">Y</span>&nbsp;<span class="op" id="6120648">==</span>&nbsp;<span class="ident" id="6120651"><a href="/image/draw/draw.go.html#6120450">sp</a></span><span class="op" id="6120653">.</span><span class="ident" id="6120654">Y</span>&nbsp;<span class="op" id="6120656">&amp;&amp;</span>&nbsp;<span class="ident" id="6120659"><a href="/image/draw/draw.go.html#6120414">r</a></span><span class="op" id="6120660">.</span><span class="ident" id="6120661">Min</span><span class="op" id="6120664">.</span><span class="ident" id="6120665">X</span>&nbsp;<span class="op" id="6120667">&lt;=</span>&nbsp;<span class="ident" id="6120670"><a href="/image/draw/draw.go.html#6120450">sp</a></span><span class="op" id="6120672">.</span><span class="ident" id="6120673">X</span>&nbsp;<span class="op" id="6120675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120679"><a href="/image/draw/draw.go.html#6120575">ddelta</a></span>&nbsp;<span class="op" id="6120686">=</span>&nbsp;<span class="ident" id="6120688"><a href="/image/draw/draw.go.html#6120397">dst</a></span><span class="op" id="6120691">.</span><span class="ident" id="6120692">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120701"><a href="/image/draw/draw.go.html#6120583">sdelta</a></span>&nbsp;<span class="op" id="6120708">=</span>&nbsp;<span class="ident" id="6120710"><a href="/image/draw/draw.go.html#6120433">src</a></span><span class="op" id="6120713">.</span><span class="ident" id="6120714">Stride</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120723"><a href="/image/draw/draw.go.html#6120596">i0</a></span><span class="op" id="6120725">,</span>&nbsp;<span class="ident" id="6120727"><a href="/image/draw/draw.go.html#6120600">i1</a></span><span class="op" id="6120729">,</span>&nbsp;<span class="ident" id="6120731"><a href="/image/draw/draw.go.html#6120604">idelta</a></span>&nbsp;<span class="op" id="6120738">=</span>&nbsp;<span class="num" id="6120740">0</span><span class="op" id="6120741">,</span>&nbsp;<span class="ident" id="6120743"><a href="/image/draw/draw.go.html#6120469">dx</a></span><span class="op" id="6120745">*</span><span class="num" id="6120746">4</span><span class="op" id="6120747">,</span>&nbsp;<span class="op" id="6120749">+</span><span class="num" id="6120750">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120753">}</span>&nbsp;<span class="keyword" id="6120755">else</span>&nbsp;<span class="op" id="6120760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120764">//&nbsp;If&nbsp;the&nbsp;source&nbsp;start&nbsp;point&nbsp;is&nbsp;higher&nbsp;than&nbsp;the&nbsp;destination&nbsp;start&nbsp;point,&nbsp;or&nbsp;equal&nbsp;height&nbsp;but&nbsp;to&nbsp;the&nbsp;left,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120872">//&nbsp;then&nbsp;we&nbsp;compose&nbsp;the&nbsp;rows&nbsp;in&nbsp;right-to-left,&nbsp;bottom-up&nbsp;order&nbsp;instead&nbsp;of&nbsp;left-to-right,&nbsp;top-down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120972"><a href="/image/draw/draw.go.html#6120495">d0</a></span>&nbsp;<span class="op" id="6120975">+=</span>&nbsp;<span class="op" id="6120978">(</span><span class="ident" id="6120979"><a href="/image/draw/draw.go.html#6120473">dy</a></span>&nbsp;<span class="op" id="6120982">-</span>&nbsp;<span class="num" id="6120984">1</span><span class="op" id="6120985">)</span>&nbsp;<span class="op" id="6120987">*</span>&nbsp;<span class="ident" id="6120989"><a href="/image/draw/draw.go.html#6120397">dst</a></span><span class="op" id="6120992">.</span><span class="ident" id="6120993">Stride</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121002"><a href="/image/draw/draw.go.html#6120534">s0</a></span>&nbsp;<span class="op" id="6121005">+=</span>&nbsp;<span class="op" id="6121008">(</span><span class="ident" id="6121009"><a href="/image/draw/draw.go.html#6120473">dy</a></span>&nbsp;<span class="op" id="6121012">-</span>&nbsp;<span class="num" id="6121014">1</span><span class="op" id="6121015">)</span>&nbsp;<span class="op" id="6121017">*</span>&nbsp;<span class="ident" id="6121019"><a href="/image/draw/draw.go.html#6120433">src</a></span><span class="op" id="6121022">.</span><span class="ident" id="6121023">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121032"><a href="/image/draw/draw.go.html#6120575">ddelta</a></span>&nbsp;<span class="op" id="6121039">=</span>&nbsp;<span class="op" id="6121041">-</span><span class="ident" id="6121042"><a href="/image/draw/draw.go.html#6120397">dst</a></span><span class="op" id="6121045">.</span><span class="ident" id="6121046">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121055"><a href="/image/draw/draw.go.html#6120583">sdelta</a></span>&nbsp;<span class="op" id="6121062">=</span>&nbsp;<span class="op" id="6121064">-</span><span class="ident" id="6121065"><a href="/image/draw/draw.go.html#6120433">src</a></span><span class="op" id="6121068">.</span><span class="ident" id="6121069">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121078"><a href="/image/draw/draw.go.html#6120596">i0</a></span><span class="op" id="6121080">,</span>&nbsp;<span class="ident" id="6121082"><a href="/image/draw/draw.go.html#6120600">i1</a></span><span class="op" id="6121084">,</span>&nbsp;<span class="ident" id="6121086"><a href="/image/draw/draw.go.html#6120604">idelta</a></span>&nbsp;<span class="op" id="6121093">=</span>&nbsp;<span class="op" id="6121095">(</span><span class="ident" id="6121096"><a href="/image/draw/draw.go.html#6120469">dx</a></span><span class="op" id="6121098">-</span><span class="num" id="6121099">1</span><span class="op" id="6121100">)</span><span class="op" id="6121101">*</span><span class="num" id="6121102">4</span><span class="op" id="6121103">,</span>&nbsp;<span class="op" id="6121105">-</span><span class="num" id="6121106">4</span><span class="op" id="6121107">,</span>&nbsp;<span class="op" id="6121109">-</span><span class="num" id="6121110">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121113">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121116">for</span>&nbsp;<span class="op" id="6121120">;</span>&nbsp;<span class="ident" id="6121122"><a href="/image/draw/draw.go.html#6120473">dy</a></span>&nbsp;<span class="op" id="6121125">&gt;</span>&nbsp;<span class="num" id="6121127">0</span><span class="op" id="6121128">;</span>&nbsp;<span class="ident" id="6121130"><a href="/image/draw/draw.go.html#6120473">dy</a></span><span class="op" id="6121132">--</span>&nbsp;<span class="op" id="6121135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121139">dpix</span>&nbsp;<span class="op" id="6121144">:=</span>&nbsp;<span class="ident" id="6121147"><a href="/image/draw/draw.go.html#6120397">dst</a></span><span class="op" id="6121150">.</span><span class="ident" id="6121151">Pix</span><span class="op" id="6121154">[</span><span class="ident" id="6121155"><a href="/image/draw/draw.go.html#6120495">d0</a></span><span class="op" id="6121157">:</span><span class="op" id="6121158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121162">spix</span>&nbsp;<span class="op" id="6121167">:=</span>&nbsp;<span class="ident" id="6121170"><a href="/image/draw/draw.go.html#6120433">src</a></span><span class="op" id="6121173">.</span><span class="ident" id="6121174">Pix</span><span class="op" id="6121177">[</span><span class="ident" id="6121178"><a href="/image/draw/draw.go.html#6120534">s0</a></span><span class="op" id="6121180">:</span><span class="op" id="6121181">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121185">for</span>&nbsp;<span class="ident" id="6121189">i</span>&nbsp;<span class="op" id="6121191">:=</span>&nbsp;<span class="ident" id="6121194"><a href="/image/draw/draw.go.html#6120596">i0</a></span><span class="op" id="6121196">;</span>&nbsp;<span class="ident" id="6121198"><a href="/image/draw/draw.go.html#6121189">i</a></span>&nbsp;<span class="op" id="6121200">!=</span>&nbsp;<span class="ident" id="6121203"><a href="/image/draw/draw.go.html#6120600">i1</a></span><span class="op" id="6121205">;</span>&nbsp;<span class="ident" id="6121207"><a href="/image/draw/draw.go.html#6121189">i</a></span>&nbsp;<span class="op" id="6121209">+=</span>&nbsp;<span class="ident" id="6121212"><a href="/image/draw/draw.go.html#6120604">idelta</a></span>&nbsp;<span class="op" id="6121219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121224">sr</span>&nbsp;<span class="op" id="6121227">:=</span>&nbsp;<span class="builtintype" id="6121230">uint32</span><span class="op" id="6121236">(</span><span class="ident" id="6121237"><a href="/image/draw/draw.go.html#6121162">spix</a></span><span class="op" id="6121241">[</span><span class="ident" id="6121242"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121243">+</span><span class="num" id="6121244">0</span><span class="op" id="6121245">]</span><span class="op" id="6121246">)</span>&nbsp;<span class="op" id="6121248">*</span>&nbsp;<span class="num" id="6121250">0x101</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121259">sg</span>&nbsp;<span class="op" id="6121262">:=</span>&nbsp;<span class="builtintype" id="6121265">uint32</span><span class="op" id="6121271">(</span><span class="ident" id="6121272"><a href="/image/draw/draw.go.html#6121162">spix</a></span><span class="op" id="6121276">[</span><span class="ident" id="6121277"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121278">+</span><span class="num" id="6121279">1</span><span class="op" id="6121280">]</span><span class="op" id="6121281">)</span>&nbsp;<span class="op" id="6121283">*</span>&nbsp;<span class="num" id="6121285">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121294">sb</span>&nbsp;<span class="op" id="6121297">:=</span>&nbsp;<span class="builtintype" id="6121300">uint32</span><span class="op" id="6121306">(</span><span class="ident" id="6121307"><a href="/image/draw/draw.go.html#6121162">spix</a></span><span class="op" id="6121311">[</span><span class="ident" id="6121312"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121313">+</span><span class="num" id="6121314">2</span><span class="op" id="6121315">]</span><span class="op" id="6121316">)</span>&nbsp;<span class="op" id="6121318">*</span>&nbsp;<span class="num" id="6121320">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121329">sa</span>&nbsp;<span class="op" id="6121332">:=</span>&nbsp;<span class="builtintype" id="6121335">uint32</span><span class="op" id="6121341">(</span><span class="ident" id="6121342"><a href="/image/draw/draw.go.html#6121162">spix</a></span><span class="op" id="6121346">[</span><span class="ident" id="6121347"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121348">+</span><span class="num" id="6121349">3</span><span class="op" id="6121350">]</span><span class="op" id="6121351">)</span>&nbsp;<span class="op" id="6121353">*</span>&nbsp;<span class="num" id="6121355">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121365">dr</span>&nbsp;<span class="op" id="6121368">:=</span>&nbsp;<span class="builtintype" id="6121371">uint32</span><span class="op" id="6121377">(</span><span class="ident" id="6121378"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121382">[</span><span class="ident" id="6121383"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121384">+</span><span class="num" id="6121385">0</span><span class="op" id="6121386">]</span><span class="op" id="6121387">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121392">dg</span>&nbsp;<span class="op" id="6121395">:=</span>&nbsp;<span class="builtintype" id="6121398">uint32</span><span class="op" id="6121404">(</span><span class="ident" id="6121405"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121409">[</span><span class="ident" id="6121410"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121411">+</span><span class="num" id="6121412">1</span><span class="op" id="6121413">]</span><span class="op" id="6121414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121419">db</span>&nbsp;<span class="op" id="6121422">:=</span>&nbsp;<span class="builtintype" id="6121425">uint32</span><span class="op" id="6121431">(</span><span class="ident" id="6121432"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121436">[</span><span class="ident" id="6121437"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121438">+</span><span class="num" id="6121439">2</span><span class="op" id="6121440">]</span><span class="op" id="6121441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121446">da</span>&nbsp;<span class="op" id="6121449">:=</span>&nbsp;<span class="builtintype" id="6121452">uint32</span><span class="op" id="6121458">(</span><span class="ident" id="6121459"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121463">[</span><span class="ident" id="6121464"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121465">+</span><span class="num" id="6121466">3</span><span class="op" id="6121467">]</span><span class="op" id="6121468">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6121474">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121534">a</span>&nbsp;<span class="op" id="6121536">:=</span>&nbsp;<span class="op" id="6121539">(</span><span class="ident" id="6121540"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6121542">-</span>&nbsp;<span class="ident" id="6121544"><a href="/image/draw/draw.go.html#6121329">sa</a></span><span class="op" id="6121546">)</span>&nbsp;<span class="op" id="6121548">*</span>&nbsp;<span class="num" id="6121550">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121560"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121564">[</span><span class="ident" id="6121565"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121566">+</span><span class="num" id="6121567">0</span><span class="op" id="6121568">]</span>&nbsp;<span class="op" id="6121570">=</span>&nbsp;<span class="builtintype" id="6121572">uint8</span><span class="op" id="6121577">(</span><span class="op" id="6121578">(</span><span class="ident" id="6121579"><a href="/image/draw/draw.go.html#6121365">dr</a></span><span class="op" id="6121581">*</span><span class="ident" id="6121582"><a href="/image/draw/draw.go.html#6121534">a</a></span><span class="op" id="6121583">/</span><span class="ident" id="6121584"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6121586">+</span>&nbsp;<span class="ident" id="6121588"><a href="/image/draw/draw.go.html#6121224">sr</a></span><span class="op" id="6121590">)</span>&nbsp;<span class="op" id="6121592">&gt;&gt;</span>&nbsp;<span class="num" id="6121595">8</span><span class="op" id="6121596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121601"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121605">[</span><span class="ident" id="6121606"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121607">+</span><span class="num" id="6121608">1</span><span class="op" id="6121609">]</span>&nbsp;<span class="op" id="6121611">=</span>&nbsp;<span class="builtintype" id="6121613">uint8</span><span class="op" id="6121618">(</span><span class="op" id="6121619">(</span><span class="ident" id="6121620"><a href="/image/draw/draw.go.html#6121392">dg</a></span><span class="op" id="6121622">*</span><span class="ident" id="6121623"><a href="/image/draw/draw.go.html#6121534">a</a></span><span class="op" id="6121624">/</span><span class="ident" id="6121625"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6121627">+</span>&nbsp;<span class="ident" id="6121629"><a href="/image/draw/draw.go.html#6121259">sg</a></span><span class="op" id="6121631">)</span>&nbsp;<span class="op" id="6121633">&gt;&gt;</span>&nbsp;<span class="num" id="6121636">8</span><span class="op" id="6121637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121642"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121646">[</span><span class="ident" id="6121647"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121648">+</span><span class="num" id="6121649">2</span><span class="op" id="6121650">]</span>&nbsp;<span class="op" id="6121652">=</span>&nbsp;<span class="builtintype" id="6121654">uint8</span><span class="op" id="6121659">(</span><span class="op" id="6121660">(</span><span class="ident" id="6121661"><a href="/image/draw/draw.go.html#6121419">db</a></span><span class="op" id="6121663">*</span><span class="ident" id="6121664"><a href="/image/draw/draw.go.html#6121534">a</a></span><span class="op" id="6121665">/</span><span class="ident" id="6121666"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6121668">+</span>&nbsp;<span class="ident" id="6121670"><a href="/image/draw/draw.go.html#6121294">sb</a></span><span class="op" id="6121672">)</span>&nbsp;<span class="op" id="6121674">&gt;&gt;</span>&nbsp;<span class="num" id="6121677">8</span><span class="op" id="6121678">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121683"><a href="/image/draw/draw.go.html#6121139">dpix</a></span><span class="op" id="6121687">[</span><span class="ident" id="6121688"><a href="/image/draw/draw.go.html#6121189">i</a></span><span class="op" id="6121689">+</span><span class="num" id="6121690">3</span><span class="op" id="6121691">]</span>&nbsp;<span class="op" id="6121693">=</span>&nbsp;<span class="builtintype" id="6121695">uint8</span><span class="op" id="6121700">(</span><span class="op" id="6121701">(</span><span class="ident" id="6121702"><a href="/image/draw/draw.go.html#6121446">da</a></span><span class="op" id="6121704">*</span><span class="ident" id="6121705"><a href="/image/draw/draw.go.html#6121534">a</a></span><span class="op" id="6121706">/</span><span class="ident" id="6121707"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6121709">+</span>&nbsp;<span class="ident" id="6121711"><a href="/image/draw/draw.go.html#6121329">sa</a></span><span class="op" id="6121713">)</span>&nbsp;<span class="op" id="6121715">&gt;&gt;</span>&nbsp;<span class="num" id="6121718">8</span><span class="op" id="6121719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121727"><a href="/image/draw/draw.go.html#6120495">d0</a></span>&nbsp;<span class="op" id="6121730">+=</span>&nbsp;<span class="ident" id="6121733"><a href="/image/draw/draw.go.html#6120575">ddelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121742"><a href="/image/draw/draw.go.html#6120534">s0</a></span>&nbsp;<span class="op" id="6121745">+=</span>&nbsp;<span class="ident" id="6121748"><a href="/image/draw/draw.go.html#6120583">sdelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121756">}</span><br>
<span class="lineno">305</span><span class="op" id="6121758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6121761">func</span>&nbsp;<span class="ident" id="6121766">drawCopySrc</span><span class="op" id="6121777">(</span><span class="ident" id="6121778">dst</span>&nbsp;<span class="op" id="6121782">*</span><span class="ident" id="6121783"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6121788">.</span><span class="ident" id="6121789">RGBA</span><span class="op" id="6121793">,</span>&nbsp;<span class="ident" id="6121795">r</span>&nbsp;<span class="ident" id="6121797"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6121802">.</span><span class="ident" id="6121803">Rectangle</span><span class="op" id="6121812">,</span>&nbsp;<span class="ident" id="6121814">src</span>&nbsp;<span class="op" id="6121818">*</span><span class="ident" id="6121819"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6121824">.</span><span class="ident" id="6121825">RGBA</span><span class="op" id="6121829">,</span>&nbsp;<span class="ident" id="6121831">sp</span>&nbsp;<span class="ident" id="6121834"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6121839">.</span><span class="ident" id="6121840">Point</span><span class="op" id="6121845">)</span>&nbsp;<span class="op" id="6121847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121850">n</span><span class="op" id="6121851">,</span>&nbsp;<span class="ident" id="6121853">dy</span>&nbsp;<span class="op" id="6121856">:=</span>&nbsp;<span class="num" id="6121859">4</span><span class="op" id="6121860">*</span><span class="ident" id="6121861"><a href="/image/draw/draw.go.html#6121795">r</a></span><span class="op" id="6121862">.</span><span class="ident" id="6121863">Dx</span><span class="op" id="6121865">(</span><span class="op" id="6121866">)</span><span class="op" id="6121867">,</span>&nbsp;<span class="ident" id="6121869"><a href="/image/draw/draw.go.html#6121795">r</a></span><span class="op" id="6121870">.</span><span class="ident" id="6121871">Dy</span><span class="op" id="6121873">(</span><span class="op" id="6121874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121877">d0</span>&nbsp;<span class="op" id="6121880">:=</span>&nbsp;<span class="ident" id="6121883"><a href="/image/draw/draw.go.html#6121778">dst</a></span><span class="op" id="6121886">.</span><span class="ident" id="6121887">PixOffset</span><span class="op" id="6121896">(</span><span class="ident" id="6121897"><a href="/image/draw/draw.go.html#6121795">r</a></span><span class="op" id="6121898">.</span><span class="ident" id="6121899">Min</span><span class="op" id="6121902">.</span><span class="ident" id="6121903">X</span><span class="op" id="6121904">,</span>&nbsp;<span class="ident" id="6121906"><a href="/image/draw/draw.go.html#6121795">r</a></span><span class="op" id="6121907">.</span><span class="ident" id="6121908">Min</span><span class="op" id="6121911">.</span><span class="ident" id="6121912">Y</span><span class="op" id="6121913">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121916">s0</span>&nbsp;<span class="op" id="6121919">:=</span>&nbsp;<span class="ident" id="6121922"><a href="/image/draw/draw.go.html#6121814">src</a></span><span class="op" id="6121925">.</span><span class="ident" id="6121926">PixOffset</span><span class="op" id="6121935">(</span><span class="ident" id="6121936"><a href="/image/draw/draw.go.html#6121831">sp</a></span><span class="op" id="6121938">.</span><span class="ident" id="6121939">X</span><span class="op" id="6121940">,</span>&nbsp;<span class="ident" id="6121942"><a href="/image/draw/draw.go.html#6121831">sp</a></span><span class="op" id="6121944">.</span><span class="ident" id="6121945">Y</span><span class="op" id="6121946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121949">var</span>&nbsp;<span class="ident" id="6121953">ddelta</span><span class="op" id="6121959">,</span>&nbsp;<span class="ident" id="6121961">sdelta</span>&nbsp;<span class="builtintype" id="6121968">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121973">if</span>&nbsp;<span class="ident" id="6121976"><a href="/image/draw/draw.go.html#6121795">r</a></span><span class="op" id="6121977">.</span><span class="ident" id="6121978">Min</span><span class="op" id="6121981">.</span><span class="ident" id="6121982">Y</span>&nbsp;<span class="op" id="6121984">&lt;=</span>&nbsp;<span class="ident" id="6121987"><a href="/image/draw/draw.go.html#6121831">sp</a></span><span class="op" id="6121989">.</span><span class="ident" id="6121990">Y</span>&nbsp;<span class="op" id="6121992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121996"><a href="/image/draw/draw.go.html#6121953">ddelta</a></span>&nbsp;<span class="op" id="6122003">=</span>&nbsp;<span class="ident" id="6122005"><a href="/image/draw/draw.go.html#6121778">dst</a></span><span class="op" id="6122008">.</span><span class="ident" id="6122009">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122018"><a href="/image/draw/draw.go.html#6121961">sdelta</a></span>&nbsp;<span class="op" id="6122025">=</span>&nbsp;<span class="ident" id="6122027"><a href="/image/draw/draw.go.html#6121814">src</a></span><span class="op" id="6122030">.</span><span class="ident" id="6122031">Stride</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122039">}</span>&nbsp;<span class="keyword" id="6122041">else</span>&nbsp;<span class="op" id="6122046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122050">//&nbsp;If&nbsp;the&nbsp;source&nbsp;start&nbsp;point&nbsp;is&nbsp;higher&nbsp;than&nbsp;the&nbsp;destination&nbsp;start&nbsp;point,&nbsp;then&nbsp;we&nbsp;compose&nbsp;the&nbsp;rows</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122150">//&nbsp;in&nbsp;bottom-up&nbsp;order&nbsp;instead&nbsp;of&nbsp;top-down.&nbsp;Unlike&nbsp;the&nbsp;drawCopyOver&nbsp;function,&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122246">//&nbsp;check&nbsp;the&nbsp;x&nbsp;co-ordinates&nbsp;because&nbsp;the&nbsp;built-in&nbsp;copy&nbsp;function&nbsp;can&nbsp;handle&nbsp;overlapping&nbsp;slices.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122342"><a href="/image/draw/draw.go.html#6121877">d0</a></span>&nbsp;<span class="op" id="6122345">+=</span>&nbsp;<span class="op" id="6122348">(</span><span class="ident" id="6122349"><a href="/image/draw/draw.go.html#6121853">dy</a></span>&nbsp;<span class="op" id="6122352">-</span>&nbsp;<span class="num" id="6122354">1</span><span class="op" id="6122355">)</span>&nbsp;<span class="op" id="6122357">*</span>&nbsp;<span class="ident" id="6122359"><a href="/image/draw/draw.go.html#6121778">dst</a></span><span class="op" id="6122362">.</span><span class="ident" id="6122363">Stride</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122372"><a href="/image/draw/draw.go.html#6121916">s0</a></span>&nbsp;<span class="op" id="6122375">+=</span>&nbsp;<span class="op" id="6122378">(</span><span class="ident" id="6122379"><a href="/image/draw/draw.go.html#6121853">dy</a></span>&nbsp;<span class="op" id="6122382">-</span>&nbsp;<span class="num" id="6122384">1</span><span class="op" id="6122385">)</span>&nbsp;<span class="op" id="6122387">*</span>&nbsp;<span class="ident" id="6122389"><a href="/image/draw/draw.go.html#6121814">src</a></span><span class="op" id="6122392">.</span><span class="ident" id="6122393">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122402"><a href="/image/draw/draw.go.html#6121953">ddelta</a></span>&nbsp;<span class="op" id="6122409">=</span>&nbsp;<span class="op" id="6122411">-</span><span class="ident" id="6122412"><a href="/image/draw/draw.go.html#6121778">dst</a></span><span class="op" id="6122415">.</span><span class="ident" id="6122416">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122425"><a href="/image/draw/draw.go.html#6121961">sdelta</a></span>&nbsp;<span class="op" id="6122432">=</span>&nbsp;<span class="op" id="6122434">-</span><span class="ident" id="6122435"><a href="/image/draw/draw.go.html#6121814">src</a></span><span class="op" id="6122438">.</span><span class="ident" id="6122439">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122450">for</span>&nbsp;<span class="op" id="6122454">;</span>&nbsp;<span class="ident" id="6122456"><a href="/image/draw/draw.go.html#6121853">dy</a></span>&nbsp;<span class="op" id="6122459">&gt;</span>&nbsp;<span class="num" id="6122461">0</span><span class="op" id="6122462">;</span>&nbsp;<span class="ident" id="6122464"><a href="/image/draw/draw.go.html#6121853">dy</a></span><span class="op" id="6122466">--</span>&nbsp;<span class="op" id="6122469">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6122473">copy</span><span class="op" id="6122477">(</span><span class="ident" id="6122478"><a href="/image/draw/draw.go.html#6121778">dst</a></span><span class="op" id="6122481">.</span><span class="ident" id="6122482">Pix</span><span class="op" id="6122485">[</span><span class="ident" id="6122486"><a href="/image/draw/draw.go.html#6121877">d0</a></span><span class="op" id="6122488">:</span><span class="ident" id="6122489"><a href="/image/draw/draw.go.html#6121877">d0</a></span><span class="op" id="6122491">+</span><span class="ident" id="6122492"><a href="/image/draw/draw.go.html#6121850">n</a></span><span class="op" id="6122493">]</span><span class="op" id="6122494">,</span>&nbsp;<span class="ident" id="6122496"><a href="/image/draw/draw.go.html#6121814">src</a></span><span class="op" id="6122499">.</span><span class="ident" id="6122500">Pix</span><span class="op" id="6122503">[</span><span class="ident" id="6122504"><a href="/image/draw/draw.go.html#6121916">s0</a></span><span class="op" id="6122506">:</span><span class="ident" id="6122507"><a href="/image/draw/draw.go.html#6121916">s0</a></span><span class="op" id="6122509">+</span><span class="ident" id="6122510"><a href="/image/draw/draw.go.html#6121850">n</a></span><span class="op" id="6122511">]</span><span class="op" id="6122512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122516"><a href="/image/draw/draw.go.html#6121877">d0</a></span>&nbsp;<span class="op" id="6122519">+=</span>&nbsp;<span class="ident" id="6122522"><a href="/image/draw/draw.go.html#6121953">ddelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122531"><a href="/image/draw/draw.go.html#6121916">s0</a></span>&nbsp;<span class="op" id="6122534">+=</span>&nbsp;<span class="ident" id="6122537"><a href="/image/draw/draw.go.html#6121961">sdelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122545">}</span><br>
<span class="lineno"></span><span class="op" id="6122547">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="6122550">func</span>&nbsp;<span class="ident" id="6122555">drawNRGBAOver</span><span class="op" id="6122568">(</span><span class="ident" id="6122569">dst</span>&nbsp;<span class="op" id="6122573">*</span><span class="ident" id="6122574"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6122579">.</span><span class="ident" id="6122580">RGBA</span><span class="op" id="6122584">,</span>&nbsp;<span class="ident" id="6122586">r</span>&nbsp;<span class="ident" id="6122588"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6122593">.</span><span class="ident" id="6122594">Rectangle</span><span class="op" id="6122603">,</span>&nbsp;<span class="ident" id="6122605">src</span>&nbsp;<span class="op" id="6122609">*</span><span class="ident" id="6122610"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6122615">.</span><span class="ident" id="6122616">NRGBA</span><span class="op" id="6122621">,</span>&nbsp;<span class="ident" id="6122623">sp</span>&nbsp;<span class="ident" id="6122626"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6122631">.</span><span class="ident" id="6122632">Point</span><span class="op" id="6122637">)</span>&nbsp;<span class="op" id="6122639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122642">i0</span>&nbsp;<span class="op" id="6122645">:=</span>&nbsp;<span class="op" id="6122648">(</span><span class="ident" id="6122649"><a href="/image/draw/draw.go.html#6122586">r</a></span><span class="op" id="6122650">.</span><span class="ident" id="6122651">Min</span><span class="op" id="6122654">.</span><span class="ident" id="6122655">X</span>&nbsp;<span class="op" id="6122657">-</span>&nbsp;<span class="ident" id="6122659"><a href="/image/draw/draw.go.html#6122569">dst</a></span><span class="op" id="6122662">.</span><span class="ident" id="6122663">Rect</span><span class="op" id="6122667">.</span><span class="ident" id="6122668">Min</span><span class="op" id="6122671">.</span><span class="ident" id="6122672">X</span><span class="op" id="6122673">)</span>&nbsp;<span class="op" id="6122675">*</span>&nbsp;<span class="num" id="6122677">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122680">i1</span>&nbsp;<span class="op" id="6122683">:=</span>&nbsp;<span class="op" id="6122686">(</span><span class="ident" id="6122687"><a href="/image/draw/draw.go.html#6122586">r</a></span><span class="op" id="6122688">.</span><span class="ident" id="6122689">Max</span><span class="op" id="6122692">.</span><span class="ident" id="6122693">X</span>&nbsp;<span class="op" id="6122695">-</span>&nbsp;<span class="ident" id="6122697"><a href="/image/draw/draw.go.html#6122569">dst</a></span><span class="op" id="6122700">.</span><span class="ident" id="6122701">Rect</span><span class="op" id="6122705">.</span><span class="ident" id="6122706">Min</span><span class="op" id="6122709">.</span><span class="ident" id="6122710">X</span><span class="op" id="6122711">)</span>&nbsp;<span class="op" id="6122713">*</span>&nbsp;<span class="num" id="6122715">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122718">si0</span>&nbsp;<span class="op" id="6122722">:=</span>&nbsp;<span class="op" id="6122725">(</span><span class="ident" id="6122726"><a href="/image/draw/draw.go.html#6122623">sp</a></span><span class="op" id="6122728">.</span><span class="ident" id="6122729">X</span>&nbsp;<span class="op" id="6122731">-</span>&nbsp;<span class="ident" id="6122733"><a href="/image/draw/draw.go.html#6122605">src</a></span><span class="op" id="6122736">.</span><span class="ident" id="6122737">Rect</span><span class="op" id="6122741">.</span><span class="ident" id="6122742">Min</span><span class="op" id="6122745">.</span><span class="ident" id="6122746">X</span><span class="op" id="6122747">)</span>&nbsp;<span class="op" id="6122749">*</span>&nbsp;<span class="num" id="6122751">4</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122754">yMax</span>&nbsp;<span class="op" id="6122759">:=</span>&nbsp;<span class="ident" id="6122762"><a href="/image/draw/draw.go.html#6122586">r</a></span><span class="op" id="6122763">.</span><span class="ident" id="6122764">Max</span><span class="op" id="6122767">.</span><span class="ident" id="6122768">Y</span>&nbsp;<span class="op" id="6122770">-</span>&nbsp;<span class="ident" id="6122772"><a href="/image/draw/draw.go.html#6122569">dst</a></span><span class="op" id="6122775">.</span><span class="ident" id="6122776">Rect</span><span class="op" id="6122780">.</span><span class="ident" id="6122781">Min</span><span class="op" id="6122784">.</span><span class="ident" id="6122785">Y</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122789">y</span>&nbsp;<span class="op" id="6122791">:=</span>&nbsp;<span class="ident" id="6122794"><a href="/image/draw/draw.go.html#6122586">r</a></span><span class="op" id="6122795">.</span><span class="ident" id="6122796">Min</span><span class="op" id="6122799">.</span><span class="ident" id="6122800">Y</span>&nbsp;<span class="op" id="6122802">-</span>&nbsp;<span class="ident" id="6122804"><a href="/image/draw/draw.go.html#6122569">dst</a></span><span class="op" id="6122807">.</span><span class="ident" id="6122808">Rect</span><span class="op" id="6122812">.</span><span class="ident" id="6122813">Min</span><span class="op" id="6122816">.</span><span class="ident" id="6122817">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122820">sy</span>&nbsp;<span class="op" id="6122823">:=</span>&nbsp;<span class="ident" id="6122826"><a href="/image/draw/draw.go.html#6122623">sp</a></span><span class="op" id="6122828">.</span><span class="ident" id="6122829">Y</span>&nbsp;<span class="op" id="6122831">-</span>&nbsp;<span class="ident" id="6122833"><a href="/image/draw/draw.go.html#6122605">src</a></span><span class="op" id="6122836">.</span><span class="ident" id="6122837">Rect</span><span class="op" id="6122841">.</span><span class="ident" id="6122842">Min</span><span class="op" id="6122845">.</span><span class="ident" id="6122846">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122849">for</span>&nbsp;<span class="op" id="6122853">;</span>&nbsp;<span class="ident" id="6122855"><a href="/image/draw/draw.go.html#6122789">y</a></span>&nbsp;<span class="op" id="6122857">!=</span>&nbsp;<span class="ident" id="6122860"><a href="/image/draw/draw.go.html#6122754">yMax</a></span><span class="op" id="6122864">;</span>&nbsp;<span class="ident" id="6122866"><a href="/image/draw/draw.go.html#6122789">y</a></span><span class="op" id="6122867">,</span>&nbsp;<span class="ident" id="6122869"><a href="/image/draw/draw.go.html#6122820">sy</a></span>&nbsp;<span class="op" id="6122872">=</span>&nbsp;<span class="ident" id="6122874"><a href="/image/draw/draw.go.html#6122789">y</a></span><span class="op" id="6122875">+</span><span class="num" id="6122876">1</span><span class="op" id="6122877">,</span>&nbsp;<span class="ident" id="6122879"><a href="/image/draw/draw.go.html#6122820">sy</a></span><span class="op" id="6122881">+</span><span class="num" id="6122882">1</span>&nbsp;<span class="op" id="6122884">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122888">dpix</span>&nbsp;<span class="op" id="6122893">:=</span>&nbsp;<span class="ident" id="6122896"><a href="/image/draw/draw.go.html#6122569">dst</a></span><span class="op" id="6122899">.</span><span class="ident" id="6122900">Pix</span><span class="op" id="6122903">[</span><span class="ident" id="6122904"><a href="/image/draw/draw.go.html#6122789">y</a></span><span class="op" id="6122905">*</span><span class="ident" id="6122906"><a href="/image/draw/draw.go.html#6122569">dst</a></span><span class="op" id="6122909">.</span><span class="ident" id="6122910">Stride</span><span class="op" id="6122916">:</span><span class="op" id="6122917">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122921">spix</span>&nbsp;<span class="op" id="6122926">:=</span>&nbsp;<span class="ident" id="6122929"><a href="/image/draw/draw.go.html#6122605">src</a></span><span class="op" id="6122932">.</span><span class="ident" id="6122933">Pix</span><span class="op" id="6122936">[</span><span class="ident" id="6122937"><a href="/image/draw/draw.go.html#6122820">sy</a></span><span class="op" id="6122939">*</span><span class="ident" id="6122940"><a href="/image/draw/draw.go.html#6122605">src</a></span><span class="op" id="6122943">.</span><span class="ident" id="6122944">Stride</span><span class="op" id="6122950">:</span><span class="op" id="6122951">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122956">for</span>&nbsp;<span class="ident" id="6122960">i</span><span class="op" id="6122961">,</span>&nbsp;<span class="ident" id="6122963">si</span>&nbsp;<span class="op" id="6122966">:=</span>&nbsp;<span class="ident" id="6122969"><a href="/image/draw/draw.go.html#6122642">i0</a></span><span class="op" id="6122971">,</span>&nbsp;<span class="ident" id="6122973"><a href="/image/draw/draw.go.html#6122718">si0</a></span><span class="op" id="6122976">;</span>&nbsp;<span class="ident" id="6122978"><a href="/image/draw/draw.go.html#6122960">i</a></span>&nbsp;<span class="op" id="6122980">&lt;</span>&nbsp;<span class="ident" id="6122982"><a href="/image/draw/draw.go.html#6122680">i1</a></span><span class="op" id="6122984">;</span>&nbsp;<span class="ident" id="6122986"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6122987">,</span>&nbsp;<span class="ident" id="6122989"><a href="/image/draw/draw.go.html#6122963">si</a></span>&nbsp;<span class="op" id="6122992">=</span>&nbsp;<span class="ident" id="6122994"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6122995">+</span><span class="num" id="6122996">4</span><span class="op" id="6122997">,</span>&nbsp;<span class="ident" id="6122999"><a href="/image/draw/draw.go.html#6122963">si</a></span><span class="op" id="6123001">+</span><span class="num" id="6123002">4</span>&nbsp;<span class="op" id="6123004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6123009">//&nbsp;Convert&nbsp;from&nbsp;non-premultiplied&nbsp;color&nbsp;to&nbsp;pre-multiplied&nbsp;color.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123077">sa</span>&nbsp;<span class="op" id="6123080">:=</span>&nbsp;<span class="builtintype" id="6123083">uint32</span><span class="op" id="6123089">(</span><span class="ident" id="6123090"><a href="/image/draw/draw.go.html#6122921">spix</a></span><span class="op" id="6123094">[</span><span class="ident" id="6123095"><a href="/image/draw/draw.go.html#6122963">si</a></span><span class="op" id="6123097">+</span><span class="num" id="6123098">3</span><span class="op" id="6123099">]</span><span class="op" id="6123100">)</span>&nbsp;<span class="op" id="6123102">*</span>&nbsp;<span class="num" id="6123104">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123113">sr</span>&nbsp;<span class="op" id="6123116">:=</span>&nbsp;<span class="builtintype" id="6123119">uint32</span><span class="op" id="6123125">(</span><span class="ident" id="6123126"><a href="/image/draw/draw.go.html#6122921">spix</a></span><span class="op" id="6123130">[</span><span class="ident" id="6123131"><a href="/image/draw/draw.go.html#6122963">si</a></span><span class="op" id="6123133">+</span><span class="num" id="6123134">0</span><span class="op" id="6123135">]</span><span class="op" id="6123136">)</span>&nbsp;<span class="op" id="6123138">*</span>&nbsp;<span class="ident" id="6123140"><a href="/image/draw/draw.go.html#6123077">sa</a></span>&nbsp;<span class="op" id="6123143">/</span>&nbsp;<span class="num" id="6123145">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123153">sg</span>&nbsp;<span class="op" id="6123156">:=</span>&nbsp;<span class="builtintype" id="6123159">uint32</span><span class="op" id="6123165">(</span><span class="ident" id="6123166"><a href="/image/draw/draw.go.html#6122921">spix</a></span><span class="op" id="6123170">[</span><span class="ident" id="6123171"><a href="/image/draw/draw.go.html#6122963">si</a></span><span class="op" id="6123173">+</span><span class="num" id="6123174">1</span><span class="op" id="6123175">]</span><span class="op" id="6123176">)</span>&nbsp;<span class="op" id="6123178">*</span>&nbsp;<span class="ident" id="6123180"><a href="/image/draw/draw.go.html#6123077">sa</a></span>&nbsp;<span class="op" id="6123183">/</span>&nbsp;<span class="num" id="6123185">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123193">sb</span>&nbsp;<span class="op" id="6123196">:=</span>&nbsp;<span class="builtintype" id="6123199">uint32</span><span class="op" id="6123205">(</span><span class="ident" id="6123206"><a href="/image/draw/draw.go.html#6122921">spix</a></span><span class="op" id="6123210">[</span><span class="ident" id="6123211"><a href="/image/draw/draw.go.html#6122963">si</a></span><span class="op" id="6123213">+</span><span class="num" id="6123214">2</span><span class="op" id="6123215">]</span><span class="op" id="6123216">)</span>&nbsp;<span class="op" id="6123218">*</span>&nbsp;<span class="ident" id="6123220"><a href="/image/draw/draw.go.html#6123077">sa</a></span>&nbsp;<span class="op" id="6123223">/</span>&nbsp;<span class="num" id="6123225">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123234">dr</span>&nbsp;<span class="op" id="6123237">:=</span>&nbsp;<span class="builtintype" id="6123240">uint32</span><span class="op" id="6123246">(</span><span class="ident" id="6123247"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123251">[</span><span class="ident" id="6123252"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123253">+</span><span class="num" id="6123254">0</span><span class="op" id="6123255">]</span><span class="op" id="6123256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123261">dg</span>&nbsp;<span class="op" id="6123264">:=</span>&nbsp;<span class="builtintype" id="6123267">uint32</span><span class="op" id="6123273">(</span><span class="ident" id="6123274"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123278">[</span><span class="ident" id="6123279"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123280">+</span><span class="num" id="6123281">1</span><span class="op" id="6123282">]</span><span class="op" id="6123283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123288">db</span>&nbsp;<span class="op" id="6123291">:=</span>&nbsp;<span class="builtintype" id="6123294">uint32</span><span class="op" id="6123300">(</span><span class="ident" id="6123301"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123305">[</span><span class="ident" id="6123306"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123307">+</span><span class="num" id="6123308">2</span><span class="op" id="6123309">]</span><span class="op" id="6123310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123315">da</span>&nbsp;<span class="op" id="6123318">:=</span>&nbsp;<span class="builtintype" id="6123321">uint32</span><span class="op" id="6123327">(</span><span class="ident" id="6123328"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123332">[</span><span class="ident" id="6123333"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123334">+</span><span class="num" id="6123335">3</span><span class="op" id="6123336">]</span><span class="op" id="6123337">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6123343">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123403">a</span>&nbsp;<span class="op" id="6123405">:=</span>&nbsp;<span class="op" id="6123408">(</span><span class="ident" id="6123409"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6123411">-</span>&nbsp;<span class="ident" id="6123413"><a href="/image/draw/draw.go.html#6123077">sa</a></span><span class="op" id="6123415">)</span>&nbsp;<span class="op" id="6123417">*</span>&nbsp;<span class="num" id="6123419">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123429"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123433">[</span><span class="ident" id="6123434"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123435">+</span><span class="num" id="6123436">0</span><span class="op" id="6123437">]</span>&nbsp;<span class="op" id="6123439">=</span>&nbsp;<span class="builtintype" id="6123441">uint8</span><span class="op" id="6123446">(</span><span class="op" id="6123447">(</span><span class="ident" id="6123448"><a href="/image/draw/draw.go.html#6123234">dr</a></span><span class="op" id="6123450">*</span><span class="ident" id="6123451"><a href="/image/draw/draw.go.html#6123403">a</a></span><span class="op" id="6123452">/</span><span class="ident" id="6123453"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6123455">+</span>&nbsp;<span class="ident" id="6123457"><a href="/image/draw/draw.go.html#6123113">sr</a></span><span class="op" id="6123459">)</span>&nbsp;<span class="op" id="6123461">&gt;&gt;</span>&nbsp;<span class="num" id="6123464">8</span><span class="op" id="6123465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123470"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123474">[</span><span class="ident" id="6123475"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123476">+</span><span class="num" id="6123477">1</span><span class="op" id="6123478">]</span>&nbsp;<span class="op" id="6123480">=</span>&nbsp;<span class="builtintype" id="6123482">uint8</span><span class="op" id="6123487">(</span><span class="op" id="6123488">(</span><span class="ident" id="6123489"><a href="/image/draw/draw.go.html#6123261">dg</a></span><span class="op" id="6123491">*</span><span class="ident" id="6123492"><a href="/image/draw/draw.go.html#6123403">a</a></span><span class="op" id="6123493">/</span><span class="ident" id="6123494"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6123496">+</span>&nbsp;<span class="ident" id="6123498"><a href="/image/draw/draw.go.html#6123153">sg</a></span><span class="op" id="6123500">)</span>&nbsp;<span class="op" id="6123502">&gt;&gt;</span>&nbsp;<span class="num" id="6123505">8</span><span class="op" id="6123506">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123511"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123515">[</span><span class="ident" id="6123516"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123517">+</span><span class="num" id="6123518">2</span><span class="op" id="6123519">]</span>&nbsp;<span class="op" id="6123521">=</span>&nbsp;<span class="builtintype" id="6123523">uint8</span><span class="op" id="6123528">(</span><span class="op" id="6123529">(</span><span class="ident" id="6123530"><a href="/image/draw/draw.go.html#6123288">db</a></span><span class="op" id="6123532">*</span><span class="ident" id="6123533"><a href="/image/draw/draw.go.html#6123403">a</a></span><span class="op" id="6123534">/</span><span class="ident" id="6123535"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6123537">+</span>&nbsp;<span class="ident" id="6123539"><a href="/image/draw/draw.go.html#6123193">sb</a></span><span class="op" id="6123541">)</span>&nbsp;<span class="op" id="6123543">&gt;&gt;</span>&nbsp;<span class="num" id="6123546">8</span><span class="op" id="6123547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123552"><a href="/image/draw/draw.go.html#6122888">dpix</a></span><span class="op" id="6123556">[</span><span class="ident" id="6123557"><a href="/image/draw/draw.go.html#6122960">i</a></span><span class="op" id="6123558">+</span><span class="num" id="6123559">3</span><span class="op" id="6123560">]</span>&nbsp;<span class="op" id="6123562">=</span>&nbsp;<span class="builtintype" id="6123564">uint8</span><span class="op" id="6123569">(</span><span class="op" id="6123570">(</span><span class="ident" id="6123571"><a href="/image/draw/draw.go.html#6123315">da</a></span><span class="op" id="6123573">*</span><span class="ident" id="6123574"><a href="/image/draw/draw.go.html#6123403">a</a></span><span class="op" id="6123575">/</span><span class="ident" id="6123576"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6123578">+</span>&nbsp;<span class="ident" id="6123580"><a href="/image/draw/draw.go.html#6123077">sa</a></span><span class="op" id="6123582">)</span>&nbsp;<span class="op" id="6123584">&gt;&gt;</span>&nbsp;<span class="num" id="6123587">8</span><span class="op" id="6123588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123595">}</span><br>
<span class="lineno"></span><span class="op" id="6123597">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="6123600">func</span>&nbsp;<span class="ident" id="6123605">drawNRGBASrc</span><span class="op" id="6123617">(</span><span class="ident" id="6123618">dst</span>&nbsp;<span class="op" id="6123622">*</span><span class="ident" id="6123623"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6123628">.</span><span class="ident" id="6123629">RGBA</span><span class="op" id="6123633">,</span>&nbsp;<span class="ident" id="6123635">r</span>&nbsp;<span class="ident" id="6123637"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6123642">.</span><span class="ident" id="6123643">Rectangle</span><span class="op" id="6123652">,</span>&nbsp;<span class="ident" id="6123654">src</span>&nbsp;<span class="op" id="6123658">*</span><span class="ident" id="6123659"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6123664">.</span><span class="ident" id="6123665">NRGBA</span><span class="op" id="6123670">,</span>&nbsp;<span class="ident" id="6123672">sp</span>&nbsp;<span class="ident" id="6123675"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6123680">.</span><span class="ident" id="6123681">Point</span><span class="op" id="6123686">)</span>&nbsp;<span class="op" id="6123688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123691">i0</span>&nbsp;<span class="op" id="6123694">:=</span>&nbsp;<span class="op" id="6123697">(</span><span class="ident" id="6123698"><a href="/image/draw/draw.go.html#6123635">r</a></span><span class="op" id="6123699">.</span><span class="ident" id="6123700">Min</span><span class="op" id="6123703">.</span><span class="ident" id="6123704">X</span>&nbsp;<span class="op" id="6123706">-</span>&nbsp;<span class="ident" id="6123708"><a href="/image/draw/draw.go.html#6123618">dst</a></span><span class="op" id="6123711">.</span><span class="ident" id="6123712">Rect</span><span class="op" id="6123716">.</span><span class="ident" id="6123717">Min</span><span class="op" id="6123720">.</span><span class="ident" id="6123721">X</span><span class="op" id="6123722">)</span>&nbsp;<span class="op" id="6123724">*</span>&nbsp;<span class="num" id="6123726">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123729">i1</span>&nbsp;<span class="op" id="6123732">:=</span>&nbsp;<span class="op" id="6123735">(</span><span class="ident" id="6123736"><a href="/image/draw/draw.go.html#6123635">r</a></span><span class="op" id="6123737">.</span><span class="ident" id="6123738">Max</span><span class="op" id="6123741">.</span><span class="ident" id="6123742">X</span>&nbsp;<span class="op" id="6123744">-</span>&nbsp;<span class="ident" id="6123746"><a href="/image/draw/draw.go.html#6123618">dst</a></span><span class="op" id="6123749">.</span><span class="ident" id="6123750">Rect</span><span class="op" id="6123754">.</span><span class="ident" id="6123755">Min</span><span class="op" id="6123758">.</span><span class="ident" id="6123759">X</span><span class="op" id="6123760">)</span>&nbsp;<span class="op" id="6123762">*</span>&nbsp;<span class="num" id="6123764">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123767">si0</span>&nbsp;<span class="op" id="6123771">:=</span>&nbsp;<span class="op" id="6123774">(</span><span class="ident" id="6123775"><a href="/image/draw/draw.go.html#6123672">sp</a></span><span class="op" id="6123777">.</span><span class="ident" id="6123778">X</span>&nbsp;<span class="op" id="6123780">-</span>&nbsp;<span class="ident" id="6123782"><a href="/image/draw/draw.go.html#6123654">src</a></span><span class="op" id="6123785">.</span><span class="ident" id="6123786">Rect</span><span class="op" id="6123790">.</span><span class="ident" id="6123791">Min</span><span class="op" id="6123794">.</span><span class="ident" id="6123795">X</span><span class="op" id="6123796">)</span>&nbsp;<span class="op" id="6123798">*</span>&nbsp;<span class="num" id="6123800">4</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123803">yMax</span>&nbsp;<span class="op" id="6123808">:=</span>&nbsp;<span class="ident" id="6123811"><a href="/image/draw/draw.go.html#6123635">r</a></span><span class="op" id="6123812">.</span><span class="ident" id="6123813">Max</span><span class="op" id="6123816">.</span><span class="ident" id="6123817">Y</span>&nbsp;<span class="op" id="6123819">-</span>&nbsp;<span class="ident" id="6123821"><a href="/image/draw/draw.go.html#6123618">dst</a></span><span class="op" id="6123824">.</span><span class="ident" id="6123825">Rect</span><span class="op" id="6123829">.</span><span class="ident" id="6123830">Min</span><span class="op" id="6123833">.</span><span class="ident" id="6123834">Y</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123838">y</span>&nbsp;<span class="op" id="6123840">:=</span>&nbsp;<span class="ident" id="6123843"><a href="/image/draw/draw.go.html#6123635">r</a></span><span class="op" id="6123844">.</span><span class="ident" id="6123845">Min</span><span class="op" id="6123848">.</span><span class="ident" id="6123849">Y</span>&nbsp;<span class="op" id="6123851">-</span>&nbsp;<span class="ident" id="6123853"><a href="/image/draw/draw.go.html#6123618">dst</a></span><span class="op" id="6123856">.</span><span class="ident" id="6123857">Rect</span><span class="op" id="6123861">.</span><span class="ident" id="6123862">Min</span><span class="op" id="6123865">.</span><span class="ident" id="6123866">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123869">sy</span>&nbsp;<span class="op" id="6123872">:=</span>&nbsp;<span class="ident" id="6123875"><a href="/image/draw/draw.go.html#6123672">sp</a></span><span class="op" id="6123877">.</span><span class="ident" id="6123878">Y</span>&nbsp;<span class="op" id="6123880">-</span>&nbsp;<span class="ident" id="6123882"><a href="/image/draw/draw.go.html#6123654">src</a></span><span class="op" id="6123885">.</span><span class="ident" id="6123886">Rect</span><span class="op" id="6123890">.</span><span class="ident" id="6123891">Min</span><span class="op" id="6123894">.</span><span class="ident" id="6123895">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123898">for</span>&nbsp;<span class="op" id="6123902">;</span>&nbsp;<span class="ident" id="6123904"><a href="/image/draw/draw.go.html#6123838">y</a></span>&nbsp;<span class="op" id="6123906">!=</span>&nbsp;<span class="ident" id="6123909"><a href="/image/draw/draw.go.html#6123803">yMax</a></span><span class="op" id="6123913">;</span>&nbsp;<span class="ident" id="6123915"><a href="/image/draw/draw.go.html#6123838">y</a></span><span class="op" id="6123916">,</span>&nbsp;<span class="ident" id="6123918"><a href="/image/draw/draw.go.html#6123869">sy</a></span>&nbsp;<span class="op" id="6123921">=</span>&nbsp;<span class="ident" id="6123923"><a href="/image/draw/draw.go.html#6123838">y</a></span><span class="op" id="6123924">+</span><span class="num" id="6123925">1</span><span class="op" id="6123926">,</span>&nbsp;<span class="ident" id="6123928"><a href="/image/draw/draw.go.html#6123869">sy</a></span><span class="op" id="6123930">+</span><span class="num" id="6123931">1</span>&nbsp;<span class="op" id="6123933">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123937">dpix</span>&nbsp;<span class="op" id="6123942">:=</span>&nbsp;<span class="ident" id="6123945"><a href="/image/draw/draw.go.html#6123618">dst</a></span><span class="op" id="6123948">.</span><span class="ident" id="6123949">Pix</span><span class="op" id="6123952">[</span><span class="ident" id="6123953"><a href="/image/draw/draw.go.html#6123838">y</a></span><span class="op" id="6123954">*</span><span class="ident" id="6123955"><a href="/image/draw/draw.go.html#6123618">dst</a></span><span class="op" id="6123958">.</span><span class="ident" id="6123959">Stride</span><span class="op" id="6123965">:</span><span class="op" id="6123966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123970">spix</span>&nbsp;<span class="op" id="6123975">:=</span>&nbsp;<span class="ident" id="6123978"><a href="/image/draw/draw.go.html#6123654">src</a></span><span class="op" id="6123981">.</span><span class="ident" id="6123982">Pix</span><span class="op" id="6123985">[</span><span class="ident" id="6123986"><a href="/image/draw/draw.go.html#6123869">sy</a></span><span class="op" id="6123988">*</span><span class="ident" id="6123989"><a href="/image/draw/draw.go.html#6123654">src</a></span><span class="op" id="6123992">.</span><span class="ident" id="6123993">Stride</span><span class="op" id="6123999">:</span><span class="op" id="6124000">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124005">for</span>&nbsp;<span class="ident" id="6124009">i</span><span class="op" id="6124010">,</span>&nbsp;<span class="ident" id="6124012">si</span>&nbsp;<span class="op" id="6124015">:=</span>&nbsp;<span class="ident" id="6124018"><a href="/image/draw/draw.go.html#6123691">i0</a></span><span class="op" id="6124020">,</span>&nbsp;<span class="ident" id="6124022"><a href="/image/draw/draw.go.html#6123767">si0</a></span><span class="op" id="6124025">;</span>&nbsp;<span class="ident" id="6124027"><a href="/image/draw/draw.go.html#6124009">i</a></span>&nbsp;<span class="op" id="6124029">&lt;</span>&nbsp;<span class="ident" id="6124031"><a href="/image/draw/draw.go.html#6123729">i1</a></span><span class="op" id="6124033">;</span>&nbsp;<span class="ident" id="6124035"><a href="/image/draw/draw.go.html#6124009">i</a></span><span class="op" id="6124036">,</span>&nbsp;<span class="ident" id="6124038"><a href="/image/draw/draw.go.html#6124012">si</a></span>&nbsp;<span class="op" id="6124041">=</span>&nbsp;<span class="ident" id="6124043"><a href="/image/draw/draw.go.html#6124009">i</a></span><span class="op" id="6124044">+</span><span class="num" id="6124045">4</span><span class="op" id="6124046">,</span>&nbsp;<span class="ident" id="6124048"><a href="/image/draw/draw.go.html#6124012">si</a></span><span class="op" id="6124050">+</span><span class="num" id="6124051">4</span>&nbsp;<span class="op" id="6124053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124058">//&nbsp;Convert&nbsp;from&nbsp;non-premultiplied&nbsp;color&nbsp;to&nbsp;pre-multiplied&nbsp;color.</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124126">sa</span>&nbsp;<span class="op" id="6124129">:=</span>&nbsp;<span class="builtintype" id="6124132">uint32</span><span class="op" id="6124138">(</span><span class="ident" id="6124139"><a href="/image/draw/draw.go.html#6123970">spix</a></span><span class="op" id="6124143">[</span><span class="ident" id="6124144"><a href="/image/draw/draw.go.html#6124012">si</a></span><span class="op" id="6124146">+</span><span class="num" id="6124147">3</span><span class="op" id="6124148">]</span><span class="op" id="6124149">)</span>&nbsp;<span class="op" id="6124151">*</span>&nbsp;<span class="num" id="6124153">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124162">sr</span>&nbsp;<span class="op" id="6124165">:=</span>&nbsp;<span class="builtintype" id="6124168">uint32</span><span class="op" id="6124174">(</span><span class="ident" id="6124175"><a href="/image/draw/draw.go.html#6123970">spix</a></span><span class="op" id="6124179">[</span><span class="ident" id="6124180"><a href="/image/draw/draw.go.html#6124012">si</a></span><span class="op" id="6124182">+</span><span class="num" id="6124183">0</span><span class="op" id="6124184">]</span><span class="op" id="6124185">)</span>&nbsp;<span class="op" id="6124187">*</span>&nbsp;<span class="ident" id="6124189"><a href="/image/draw/draw.go.html#6124126">sa</a></span>&nbsp;<span class="op" id="6124192">/</span>&nbsp;<span class="num" id="6124194">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124202">sg</span>&nbsp;<span class="op" id="6124205">:=</span>&nbsp;<span class="builtintype" id="6124208">uint32</span><span class="op" id="6124214">(</span><span class="ident" id="6124215"><a href="/image/draw/draw.go.html#6123970">spix</a></span><span class="op" id="6124219">[</span><span class="ident" id="6124220"><a href="/image/draw/draw.go.html#6124012">si</a></span><span class="op" id="6124222">+</span><span class="num" id="6124223">1</span><span class="op" id="6124224">]</span><span class="op" id="6124225">)</span>&nbsp;<span class="op" id="6124227">*</span>&nbsp;<span class="ident" id="6124229"><a href="/image/draw/draw.go.html#6124126">sa</a></span>&nbsp;<span class="op" id="6124232">/</span>&nbsp;<span class="num" id="6124234">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124242">sb</span>&nbsp;<span class="op" id="6124245">:=</span>&nbsp;<span class="builtintype" id="6124248">uint32</span><span class="op" id="6124254">(</span><span class="ident" id="6124255"><a href="/image/draw/draw.go.html#6123970">spix</a></span><span class="op" id="6124259">[</span><span class="ident" id="6124260"><a href="/image/draw/draw.go.html#6124012">si</a></span><span class="op" id="6124262">+</span><span class="num" id="6124263">2</span><span class="op" id="6124264">]</span><span class="op" id="6124265">)</span>&nbsp;<span class="op" id="6124267">*</span>&nbsp;<span class="ident" id="6124269"><a href="/image/draw/draw.go.html#6124126">sa</a></span>&nbsp;<span class="op" id="6124272">/</span>&nbsp;<span class="num" id="6124274">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124283"><a href="/image/draw/draw.go.html#6123937">dpix</a></span><span class="op" id="6124287">[</span><span class="ident" id="6124288"><a href="/image/draw/draw.go.html#6124009">i</a></span><span class="op" id="6124289">+</span><span class="num" id="6124290">0</span><span class="op" id="6124291">]</span>&nbsp;<span class="op" id="6124293">=</span>&nbsp;<span class="builtintype" id="6124295">uint8</span><span class="op" id="6124300">(</span><span class="ident" id="6124301"><a href="/image/draw/draw.go.html#6124162">sr</a></span>&nbsp;<span class="op" id="6124304">&gt;&gt;</span>&nbsp;<span class="num" id="6124307">8</span><span class="op" id="6124308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124313"><a href="/image/draw/draw.go.html#6123937">dpix</a></span><span class="op" id="6124317">[</span><span class="ident" id="6124318"><a href="/image/draw/draw.go.html#6124009">i</a></span><span class="op" id="6124319">+</span><span class="num" id="6124320">1</span><span class="op" id="6124321">]</span>&nbsp;<span class="op" id="6124323">=</span>&nbsp;<span class="builtintype" id="6124325">uint8</span><span class="op" id="6124330">(</span><span class="ident" id="6124331"><a href="/image/draw/draw.go.html#6124202">sg</a></span>&nbsp;<span class="op" id="6124334">&gt;&gt;</span>&nbsp;<span class="num" id="6124337">8</span><span class="op" id="6124338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124343"><a href="/image/draw/draw.go.html#6123937">dpix</a></span><span class="op" id="6124347">[</span><span class="ident" id="6124348"><a href="/image/draw/draw.go.html#6124009">i</a></span><span class="op" id="6124349">+</span><span class="num" id="6124350">2</span><span class="op" id="6124351">]</span>&nbsp;<span class="op" id="6124353">=</span>&nbsp;<span class="builtintype" id="6124355">uint8</span><span class="op" id="6124360">(</span><span class="ident" id="6124361"><a href="/image/draw/draw.go.html#6124242">sb</a></span>&nbsp;<span class="op" id="6124364">&gt;&gt;</span>&nbsp;<span class="num" id="6124367">8</span><span class="op" id="6124368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124373"><a href="/image/draw/draw.go.html#6123937">dpix</a></span><span class="op" id="6124377">[</span><span class="ident" id="6124378"><a href="/image/draw/draw.go.html#6124009">i</a></span><span class="op" id="6124379">+</span><span class="num" id="6124380">3</span><span class="op" id="6124381">]</span>&nbsp;<span class="op" id="6124383">=</span>&nbsp;<span class="builtintype" id="6124385">uint8</span><span class="op" id="6124390">(</span><span class="ident" id="6124391"><a href="/image/draw/draw.go.html#6124126">sa</a></span>&nbsp;<span class="op" id="6124394">&gt;&gt;</span>&nbsp;<span class="num" id="6124397">8</span><span class="op" id="6124398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6124402">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6124405">}</span><br>
<span class="lineno"></span><span class="op" id="6124407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6124410">func</span>&nbsp;<span class="ident" id="6124415">drawYCbCr</span><span class="op" id="6124424">(</span><span class="ident" id="6124425">dst</span>&nbsp;<span class="op" id="6124429">*</span><span class="ident" id="6124430"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6124435">.</span><span class="ident" id="6124436">RGBA</span><span class="op" id="6124440">,</span>&nbsp;<span class="ident" id="6124442">r</span>&nbsp;<span class="ident" id="6124444"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6124449">.</span><span class="ident" id="6124450">Rectangle</span><span class="op" id="6124459">,</span>&nbsp;<span class="ident" id="6124461">src</span>&nbsp;<span class="op" id="6124465">*</span><span class="ident" id="6124466"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6124471">.</span><span class="ident" id="6124472">YCbCr</span><span class="op" id="6124477">,</span>&nbsp;<span class="ident" id="6124479">sp</span>&nbsp;<span class="ident" id="6124482"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6124487">.</span><span class="ident" id="6124488">Point</span><span class="op" id="6124493">)</span>&nbsp;<span class="op" id="6124495">(</span><span class="ident" id="6124496">ok</span>&nbsp;<span class="builtintype" id="6124499">bool</span><span class="op" id="6124503">)</span>&nbsp;<span class="op" id="6124505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124508">//&nbsp;An&nbsp;image.YCbCr&nbsp;is&nbsp;always&nbsp;fully&nbsp;opaque,&nbsp;and&nbsp;so&nbsp;if&nbsp;the&nbsp;mask&nbsp;is&nbsp;implicitly&nbsp;nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6124588">//&nbsp;(i.e.&nbsp;fully&nbsp;opaque)&nbsp;then&nbsp;the&nbsp;op&nbsp;is&nbsp;effectively&nbsp;always&nbsp;Src.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124651">x0</span>&nbsp;<span class="op" id="6124654">:=</span>&nbsp;<span class="op" id="6124657">(</span><span class="ident" id="6124658"><a href="/image/draw/draw.go.html#6124442">r</a></span><span class="op" id="6124659">.</span><span class="ident" id="6124660">Min</span><span class="op" id="6124663">.</span><span class="ident" id="6124664">X</span>&nbsp;<span class="op" id="6124666">-</span>&nbsp;<span class="ident" id="6124668"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6124671">.</span><span class="ident" id="6124672">Rect</span><span class="op" id="6124676">.</span><span class="ident" id="6124677">Min</span><span class="op" id="6124680">.</span><span class="ident" id="6124681">X</span><span class="op" id="6124682">)</span>&nbsp;<span class="op" id="6124684">*</span>&nbsp;<span class="num" id="6124686">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124689">x1</span>&nbsp;<span class="op" id="6124692">:=</span>&nbsp;<span class="op" id="6124695">(</span><span class="ident" id="6124696"><a href="/image/draw/draw.go.html#6124442">r</a></span><span class="op" id="6124697">.</span><span class="ident" id="6124698">Max</span><span class="op" id="6124701">.</span><span class="ident" id="6124702">X</span>&nbsp;<span class="op" id="6124704">-</span>&nbsp;<span class="ident" id="6124706"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6124709">.</span><span class="ident" id="6124710">Rect</span><span class="op" id="6124714">.</span><span class="ident" id="6124715">Min</span><span class="op" id="6124718">.</span><span class="ident" id="6124719">X</span><span class="op" id="6124720">)</span>&nbsp;<span class="op" id="6124722">*</span>&nbsp;<span class="num" id="6124724">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124727">y0</span>&nbsp;<span class="op" id="6124730">:=</span>&nbsp;<span class="ident" id="6124733"><a href="/image/draw/draw.go.html#6124442">r</a></span><span class="op" id="6124734">.</span><span class="ident" id="6124735">Min</span><span class="op" id="6124738">.</span><span class="ident" id="6124739">Y</span>&nbsp;<span class="op" id="6124741">-</span>&nbsp;<span class="ident" id="6124743"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6124746">.</span><span class="ident" id="6124747">Rect</span><span class="op" id="6124751">.</span><span class="ident" id="6124752">Min</span><span class="op" id="6124755">.</span><span class="ident" id="6124756">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124759">y1</span>&nbsp;<span class="op" id="6124762">:=</span>&nbsp;<span class="ident" id="6124765"><a href="/image/draw/draw.go.html#6124442">r</a></span><span class="op" id="6124766">.</span><span class="ident" id="6124767">Max</span><span class="op" id="6124770">.</span><span class="ident" id="6124771">Y</span>&nbsp;<span class="op" id="6124773">-</span>&nbsp;<span class="ident" id="6124775"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6124778">.</span><span class="ident" id="6124779">Rect</span><span class="op" id="6124783">.</span><span class="ident" id="6124784">Min</span><span class="op" id="6124787">.</span><span class="ident" id="6124788">Y</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124791">switch</span>&nbsp;<span class="ident" id="6124798"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6124801">.</span><span class="ident" id="6124802">SubsampleRatio</span>&nbsp;<span class="op" id="6124817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124820">case</span>&nbsp;<span class="ident" id="6124825"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6124830">.</span><span class="ident" id="6124831">YCbCrSubsampleRatio444</span><span class="op" id="6124853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6124857">for</span>&nbsp;<span class="ident" id="6124861">y</span><span class="op" id="6124862">,</span>&nbsp;<span class="ident" id="6124864">sy</span>&nbsp;<span class="op" id="6124867">:=</span>&nbsp;<span class="ident" id="6124870"><a href="/image/draw/draw.go.html#6124727">y0</a></span><span class="op" id="6124872">,</span>&nbsp;<span class="ident" id="6124874"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6124876">.</span><span class="ident" id="6124877">Y</span><span class="op" id="6124878">;</span>&nbsp;<span class="ident" id="6124880"><a href="/image/draw/draw.go.html#6124861">y</a></span>&nbsp;<span class="op" id="6124882">!=</span>&nbsp;<span class="ident" id="6124885"><a href="/image/draw/draw.go.html#6124759">y1</a></span><span class="op" id="6124887">;</span>&nbsp;<span class="ident" id="6124889"><a href="/image/draw/draw.go.html#6124861">y</a></span><span class="op" id="6124890">,</span>&nbsp;<span class="ident" id="6124892"><a href="/image/draw/draw.go.html#6124864">sy</a></span>&nbsp;<span class="op" id="6124895">=</span>&nbsp;<span class="ident" id="6124897"><a href="/image/draw/draw.go.html#6124861">y</a></span><span class="op" id="6124898">+</span><span class="num" id="6124899">1</span><span class="op" id="6124900">,</span>&nbsp;<span class="ident" id="6124902"><a href="/image/draw/draw.go.html#6124864">sy</a></span><span class="op" id="6124904">+</span><span class="num" id="6124905">1</span>&nbsp;<span class="op" id="6124907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124912">dpix</span>&nbsp;<span class="op" id="6124917">:=</span>&nbsp;<span class="ident" id="6124920"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6124923">.</span><span class="ident" id="6124924">Pix</span><span class="op" id="6124927">[</span><span class="ident" id="6124928"><a href="/image/draw/draw.go.html#6124861">y</a></span><span class="op" id="6124929">*</span><span class="ident" id="6124930"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6124933">.</span><span class="ident" id="6124934">Stride</span><span class="op" id="6124940">:</span><span class="op" id="6124941">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6124946">yi</span>&nbsp;<span class="op" id="6124949">:=</span>&nbsp;<span class="op" id="6124952">(</span><span class="ident" id="6124953"><a href="/image/draw/draw.go.html#6124864">sy</a></span><span class="op" id="6124955">-</span><span class="ident" id="6124956"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6124959">.</span><span class="ident" id="6124960">Rect</span><span class="op" id="6124964">.</span><span class="ident" id="6124965">Min</span><span class="op" id="6124968">.</span><span class="ident" id="6124969">Y</span><span class="op" id="6124970">)</span><span class="op" id="6124971">*</span><span class="ident" id="6124972"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6124975">.</span><span class="ident" id="6124976">YStride</span>&nbsp;<span class="op" id="6124984">+</span>&nbsp;<span class="op" id="6124986">(</span><span class="ident" id="6124987"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6124989">.</span><span class="ident" id="6124990">X</span>&nbsp;<span class="op" id="6124992">-</span>&nbsp;<span class="ident" id="6124994"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6124997">.</span><span class="ident" id="6124998">Rect</span><span class="op" id="6125002">.</span><span class="ident" id="6125003">Min</span><span class="op" id="6125006">.</span><span class="ident" id="6125007">X</span><span class="op" id="6125008">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125013">ci</span>&nbsp;<span class="op" id="6125016">:=</span>&nbsp;<span class="op" id="6125019">(</span><span class="ident" id="6125020"><a href="/image/draw/draw.go.html#6124864">sy</a></span><span class="op" id="6125022">-</span><span class="ident" id="6125023"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125026">.</span><span class="ident" id="6125027">Rect</span><span class="op" id="6125031">.</span><span class="ident" id="6125032">Min</span><span class="op" id="6125035">.</span><span class="ident" id="6125036">Y</span><span class="op" id="6125037">)</span><span class="op" id="6125038">*</span><span class="ident" id="6125039"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125042">.</span><span class="ident" id="6125043">CStride</span>&nbsp;<span class="op" id="6125051">+</span>&nbsp;<span class="op" id="6125053">(</span><span class="ident" id="6125054"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6125056">.</span><span class="ident" id="6125057">X</span>&nbsp;<span class="op" id="6125059">-</span>&nbsp;<span class="ident" id="6125061"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125064">.</span><span class="ident" id="6125065">Rect</span><span class="op" id="6125069">.</span><span class="ident" id="6125070">Min</span><span class="op" id="6125073">.</span><span class="ident" id="6125074">X</span><span class="op" id="6125075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6125080">for</span>&nbsp;<span class="ident" id="6125084">x</span>&nbsp;<span class="op" id="6125086">:=</span>&nbsp;<span class="ident" id="6125089"><a href="/image/draw/draw.go.html#6124651">x0</a></span><span class="op" id="6125091">;</span>&nbsp;<span class="ident" id="6125093"><a href="/image/draw/draw.go.html#6125084">x</a></span>&nbsp;<span class="op" id="6125095">!=</span>&nbsp;<span class="ident" id="6125098"><a href="/image/draw/draw.go.html#6124689">x1</a></span><span class="op" id="6125100">;</span>&nbsp;<span class="ident" id="6125102"><a href="/image/draw/draw.go.html#6125084">x</a></span><span class="op" id="6125103">,</span>&nbsp;<span class="ident" id="6125105"><a href="/image/draw/draw.go.html#6124946">yi</a></span><span class="op" id="6125107">,</span>&nbsp;<span class="ident" id="6125109"><a href="/image/draw/draw.go.html#6125013">ci</a></span>&nbsp;<span class="op" id="6125112">=</span>&nbsp;<span class="ident" id="6125114"><a href="/image/draw/draw.go.html#6125084">x</a></span><span class="op" id="6125115">+</span><span class="num" id="6125116">4</span><span class="op" id="6125117">,</span>&nbsp;<span class="ident" id="6125119"><a href="/image/draw/draw.go.html#6124946">yi</a></span><span class="op" id="6125121">+</span><span class="num" id="6125122">1</span><span class="op" id="6125123">,</span>&nbsp;<span class="ident" id="6125125"><a href="/image/draw/draw.go.html#6125013">ci</a></span><span class="op" id="6125127">+</span><span class="num" id="6125128">1</span>&nbsp;<span class="op" id="6125130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125136">rr</span><span class="op" id="6125138">,</span>&nbsp;<span class="ident" id="6125140">gg</span><span class="op" id="6125142">,</span>&nbsp;<span class="ident" id="6125144">bb</span>&nbsp;<span class="op" id="6125147">:=</span>&nbsp;<span class="ident" id="6125150"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6125155">.</span><span class="ident" id="6125156">YCbCrToRGB</span><span class="op" id="6125166">(</span><span class="ident" id="6125167"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125170">.</span><span class="ident" id="6125171">Y</span><span class="op" id="6125172">[</span><span class="ident" id="6125173"><a href="/image/draw/draw.go.html#6124946">yi</a></span><span class="op" id="6125175">]</span><span class="op" id="6125176">,</span>&nbsp;<span class="ident" id="6125178"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125181">.</span><span class="ident" id="6125182">Cb</span><span class="op" id="6125184">[</span><span class="ident" id="6125185"><a href="/image/draw/draw.go.html#6125013">ci</a></span><span class="op" id="6125187">]</span><span class="op" id="6125188">,</span>&nbsp;<span class="ident" id="6125190"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125193">.</span><span class="ident" id="6125194">Cr</span><span class="op" id="6125196">[</span><span class="ident" id="6125197"><a href="/image/draw/draw.go.html#6125013">ci</a></span><span class="op" id="6125199">]</span><span class="op" id="6125200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125206"><a href="/image/draw/draw.go.html#6124912">dpix</a></span><span class="op" id="6125210">[</span><span class="ident" id="6125211"><a href="/image/draw/draw.go.html#6125084">x</a></span><span class="op" id="6125212">+</span><span class="num" id="6125213">0</span><span class="op" id="6125214">]</span>&nbsp;<span class="op" id="6125216">=</span>&nbsp;<span class="ident" id="6125218"><a href="/image/draw/draw.go.html#6125136">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125225"><a href="/image/draw/draw.go.html#6124912">dpix</a></span><span class="op" id="6125229">[</span><span class="ident" id="6125230"><a href="/image/draw/draw.go.html#6125084">x</a></span><span class="op" id="6125231">+</span><span class="num" id="6125232">1</span><span class="op" id="6125233">]</span>&nbsp;<span class="op" id="6125235">=</span>&nbsp;<span class="ident" id="6125237"><a href="/image/draw/draw.go.html#6125140">gg</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125244"><a href="/image/draw/draw.go.html#6124912">dpix</a></span><span class="op" id="6125248">[</span><span class="ident" id="6125249"><a href="/image/draw/draw.go.html#6125084">x</a></span><span class="op" id="6125250">+</span><span class="num" id="6125251">2</span><span class="op" id="6125252">]</span>&nbsp;<span class="op" id="6125254">=</span>&nbsp;<span class="ident" id="6125256"><a href="/image/draw/draw.go.html#6125144">bb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125263"><a href="/image/draw/draw.go.html#6124912">dpix</a></span><span class="op" id="6125267">[</span><span class="ident" id="6125268"><a href="/image/draw/draw.go.html#6125084">x</a></span><span class="op" id="6125269">+</span><span class="num" id="6125270">3</span><span class="op" id="6125271">]</span>&nbsp;<span class="op" id="6125273">=</span>&nbsp;<span class="num" id="6125275">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6125282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6125286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6125289">case</span>&nbsp;<span class="ident" id="6125294"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6125299">.</span><span class="ident" id="6125300">YCbCrSubsampleRatio422</span><span class="op" id="6125322">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6125326">for</span>&nbsp;<span class="ident" id="6125330">y</span><span class="op" id="6125331">,</span>&nbsp;<span class="ident" id="6125333">sy</span>&nbsp;<span class="op" id="6125336">:=</span>&nbsp;<span class="ident" id="6125339"><a href="/image/draw/draw.go.html#6124727">y0</a></span><span class="op" id="6125341">,</span>&nbsp;<span class="ident" id="6125343"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6125345">.</span><span class="ident" id="6125346">Y</span><span class="op" id="6125347">;</span>&nbsp;<span class="ident" id="6125349"><a href="/image/draw/draw.go.html#6125330">y</a></span>&nbsp;<span class="op" id="6125351">!=</span>&nbsp;<span class="ident" id="6125354"><a href="/image/draw/draw.go.html#6124759">y1</a></span><span class="op" id="6125356">;</span>&nbsp;<span class="ident" id="6125358"><a href="/image/draw/draw.go.html#6125330">y</a></span><span class="op" id="6125359">,</span>&nbsp;<span class="ident" id="6125361"><a href="/image/draw/draw.go.html#6125333">sy</a></span>&nbsp;<span class="op" id="6125364">=</span>&nbsp;<span class="ident" id="6125366"><a href="/image/draw/draw.go.html#6125330">y</a></span><span class="op" id="6125367">+</span><span class="num" id="6125368">1</span><span class="op" id="6125369">,</span>&nbsp;<span class="ident" id="6125371"><a href="/image/draw/draw.go.html#6125333">sy</a></span><span class="op" id="6125373">+</span><span class="num" id="6125374">1</span>&nbsp;<span class="op" id="6125376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125381">dpix</span>&nbsp;<span class="op" id="6125386">:=</span>&nbsp;<span class="ident" id="6125389"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6125392">.</span><span class="ident" id="6125393">Pix</span><span class="op" id="6125396">[</span><span class="ident" id="6125397"><a href="/image/draw/draw.go.html#6125330">y</a></span><span class="op" id="6125398">*</span><span class="ident" id="6125399"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6125402">.</span><span class="ident" id="6125403">Stride</span><span class="op" id="6125409">:</span><span class="op" id="6125410">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125415">yi</span>&nbsp;<span class="op" id="6125418">:=</span>&nbsp;<span class="op" id="6125421">(</span><span class="ident" id="6125422"><a href="/image/draw/draw.go.html#6125333">sy</a></span><span class="op" id="6125424">-</span><span class="ident" id="6125425"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125428">.</span><span class="ident" id="6125429">Rect</span><span class="op" id="6125433">.</span><span class="ident" id="6125434">Min</span><span class="op" id="6125437">.</span><span class="ident" id="6125438">Y</span><span class="op" id="6125439">)</span><span class="op" id="6125440">*</span><span class="ident" id="6125441"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125444">.</span><span class="ident" id="6125445">YStride</span>&nbsp;<span class="op" id="6125453">+</span>&nbsp;<span class="op" id="6125455">(</span><span class="ident" id="6125456"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6125458">.</span><span class="ident" id="6125459">X</span>&nbsp;<span class="op" id="6125461">-</span>&nbsp;<span class="ident" id="6125463"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125466">.</span><span class="ident" id="6125467">Rect</span><span class="op" id="6125471">.</span><span class="ident" id="6125472">Min</span><span class="op" id="6125475">.</span><span class="ident" id="6125476">X</span><span class="op" id="6125477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125482">ciBase</span>&nbsp;<span class="op" id="6125489">:=</span>&nbsp;<span class="op" id="6125492">(</span><span class="ident" id="6125493"><a href="/image/draw/draw.go.html#6125333">sy</a></span><span class="op" id="6125495">-</span><span class="ident" id="6125496"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125499">.</span><span class="ident" id="6125500">Rect</span><span class="op" id="6125504">.</span><span class="ident" id="6125505">Min</span><span class="op" id="6125508">.</span><span class="ident" id="6125509">Y</span><span class="op" id="6125510">)</span><span class="op" id="6125511">*</span><span class="ident" id="6125512"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125515">.</span><span class="ident" id="6125516">CStride</span>&nbsp;<span class="op" id="6125524">-</span>&nbsp;<span class="ident" id="6125526"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125529">.</span><span class="ident" id="6125530">Rect</span><span class="op" id="6125534">.</span><span class="ident" id="6125535">Min</span><span class="op" id="6125538">.</span><span class="ident" id="6125539">X</span><span class="op" id="6125540">/</span><span class="num" id="6125541">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6125546">for</span>&nbsp;<span class="ident" id="6125550">x</span><span class="op" id="6125551">,</span>&nbsp;<span class="ident" id="6125553">sx</span>&nbsp;<span class="op" id="6125556">:=</span>&nbsp;<span class="ident" id="6125559"><a href="/image/draw/draw.go.html#6124651">x0</a></span><span class="op" id="6125561">,</span>&nbsp;<span class="ident" id="6125563"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6125565">.</span><span class="ident" id="6125566">X</span><span class="op" id="6125567">;</span>&nbsp;<span class="ident" id="6125569"><a href="/image/draw/draw.go.html#6125550">x</a></span>&nbsp;<span class="op" id="6125571">!=</span>&nbsp;<span class="ident" id="6125574"><a href="/image/draw/draw.go.html#6124689">x1</a></span><span class="op" id="6125576">;</span>&nbsp;<span class="ident" id="6125578"><a href="/image/draw/draw.go.html#6125550">x</a></span><span class="op" id="6125579">,</span>&nbsp;<span class="ident" id="6125581"><a href="/image/draw/draw.go.html#6125553">sx</a></span><span class="op" id="6125583">,</span>&nbsp;<span class="ident" id="6125585"><a href="/image/draw/draw.go.html#6125415">yi</a></span>&nbsp;<span class="op" id="6125588">=</span>&nbsp;<span class="ident" id="6125590"><a href="/image/draw/draw.go.html#6125550">x</a></span><span class="op" id="6125591">+</span><span class="num" id="6125592">4</span><span class="op" id="6125593">,</span>&nbsp;<span class="ident" id="6125595"><a href="/image/draw/draw.go.html#6125553">sx</a></span><span class="op" id="6125597">+</span><span class="num" id="6125598">1</span><span class="op" id="6125599">,</span>&nbsp;<span class="ident" id="6125601"><a href="/image/draw/draw.go.html#6125415">yi</a></span><span class="op" id="6125603">+</span><span class="num" id="6125604">1</span>&nbsp;<span class="op" id="6125606">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125612">ci</span>&nbsp;<span class="op" id="6125615">:=</span>&nbsp;<span class="ident" id="6125618"><a href="/image/draw/draw.go.html#6125482">ciBase</a></span>&nbsp;<span class="op" id="6125625">+</span>&nbsp;<span class="ident" id="6125627"><a href="/image/draw/draw.go.html#6125553">sx</a></span><span class="op" id="6125629">/</span><span class="num" id="6125630">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125636">rr</span><span class="op" id="6125638">,</span>&nbsp;<span class="ident" id="6125640">gg</span><span class="op" id="6125642">,</span>&nbsp;<span class="ident" id="6125644">bb</span>&nbsp;<span class="op" id="6125647">:=</span>&nbsp;<span class="ident" id="6125650"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6125655">.</span><span class="ident" id="6125656">YCbCrToRGB</span><span class="op" id="6125666">(</span><span class="ident" id="6125667"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125670">.</span><span class="ident" id="6125671">Y</span><span class="op" id="6125672">[</span><span class="ident" id="6125673"><a href="/image/draw/draw.go.html#6125415">yi</a></span><span class="op" id="6125675">]</span><span class="op" id="6125676">,</span>&nbsp;<span class="ident" id="6125678"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125681">.</span><span class="ident" id="6125682">Cb</span><span class="op" id="6125684">[</span><span class="ident" id="6125685"><a href="/image/draw/draw.go.html#6125612">ci</a></span><span class="op" id="6125687">]</span><span class="op" id="6125688">,</span>&nbsp;<span class="ident" id="6125690"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125693">.</span><span class="ident" id="6125694">Cr</span><span class="op" id="6125696">[</span><span class="ident" id="6125697"><a href="/image/draw/draw.go.html#6125612">ci</a></span><span class="op" id="6125699">]</span><span class="op" id="6125700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125706"><a href="/image/draw/draw.go.html#6125381">dpix</a></span><span class="op" id="6125710">[</span><span class="ident" id="6125711"><a href="/image/draw/draw.go.html#6125550">x</a></span><span class="op" id="6125712">+</span><span class="num" id="6125713">0</span><span class="op" id="6125714">]</span>&nbsp;<span class="op" id="6125716">=</span>&nbsp;<span class="ident" id="6125718"><a href="/image/draw/draw.go.html#6125636">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125725"><a href="/image/draw/draw.go.html#6125381">dpix</a></span><span class="op" id="6125729">[</span><span class="ident" id="6125730"><a href="/image/draw/draw.go.html#6125550">x</a></span><span class="op" id="6125731">+</span><span class="num" id="6125732">1</span><span class="op" id="6125733">]</span>&nbsp;<span class="op" id="6125735">=</span>&nbsp;<span class="ident" id="6125737"><a href="/image/draw/draw.go.html#6125640">gg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125744"><a href="/image/draw/draw.go.html#6125381">dpix</a></span><span class="op" id="6125748">[</span><span class="ident" id="6125749"><a href="/image/draw/draw.go.html#6125550">x</a></span><span class="op" id="6125750">+</span><span class="num" id="6125751">2</span><span class="op" id="6125752">]</span>&nbsp;<span class="op" id="6125754">=</span>&nbsp;<span class="ident" id="6125756"><a href="/image/draw/draw.go.html#6125644">bb</a></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125763"><a href="/image/draw/draw.go.html#6125381">dpix</a></span><span class="op" id="6125767">[</span><span class="ident" id="6125768"><a href="/image/draw/draw.go.html#6125550">x</a></span><span class="op" id="6125769">+</span><span class="num" id="6125770">3</span><span class="op" id="6125771">]</span>&nbsp;<span class="op" id="6125773">=</span>&nbsp;<span class="num" id="6125775">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6125782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6125786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6125789">case</span>&nbsp;<span class="ident" id="6125794"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6125799">.</span><span class="ident" id="6125800">YCbCrSubsampleRatio420</span><span class="op" id="6125822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6125826">for</span>&nbsp;<span class="ident" id="6125830">y</span><span class="op" id="6125831">,</span>&nbsp;<span class="ident" id="6125833">sy</span>&nbsp;<span class="op" id="6125836">:=</span>&nbsp;<span class="ident" id="6125839"><a href="/image/draw/draw.go.html#6124727">y0</a></span><span class="op" id="6125841">,</span>&nbsp;<span class="ident" id="6125843"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6125845">.</span><span class="ident" id="6125846">Y</span><span class="op" id="6125847">;</span>&nbsp;<span class="ident" id="6125849"><a href="/image/draw/draw.go.html#6125830">y</a></span>&nbsp;<span class="op" id="6125851">!=</span>&nbsp;<span class="ident" id="6125854"><a href="/image/draw/draw.go.html#6124759">y1</a></span><span class="op" id="6125856">;</span>&nbsp;<span class="ident" id="6125858"><a href="/image/draw/draw.go.html#6125830">y</a></span><span class="op" id="6125859">,</span>&nbsp;<span class="ident" id="6125861"><a href="/image/draw/draw.go.html#6125833">sy</a></span>&nbsp;<span class="op" id="6125864">=</span>&nbsp;<span class="ident" id="6125866"><a href="/image/draw/draw.go.html#6125830">y</a></span><span class="op" id="6125867">+</span><span class="num" id="6125868">1</span><span class="op" id="6125869">,</span>&nbsp;<span class="ident" id="6125871"><a href="/image/draw/draw.go.html#6125833">sy</a></span><span class="op" id="6125873">+</span><span class="num" id="6125874">1</span>&nbsp;<span class="op" id="6125876">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125881">dpix</span>&nbsp;<span class="op" id="6125886">:=</span>&nbsp;<span class="ident" id="6125889"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6125892">.</span><span class="ident" id="6125893">Pix</span><span class="op" id="6125896">[</span><span class="ident" id="6125897"><a href="/image/draw/draw.go.html#6125830">y</a></span><span class="op" id="6125898">*</span><span class="ident" id="6125899"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6125902">.</span><span class="ident" id="6125903">Stride</span><span class="op" id="6125909">:</span><span class="op" id="6125910">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125915">yi</span>&nbsp;<span class="op" id="6125918">:=</span>&nbsp;<span class="op" id="6125921">(</span><span class="ident" id="6125922"><a href="/image/draw/draw.go.html#6125833">sy</a></span><span class="op" id="6125924">-</span><span class="ident" id="6125925"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125928">.</span><span class="ident" id="6125929">Rect</span><span class="op" id="6125933">.</span><span class="ident" id="6125934">Min</span><span class="op" id="6125937">.</span><span class="ident" id="6125938">Y</span><span class="op" id="6125939">)</span><span class="op" id="6125940">*</span><span class="ident" id="6125941"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125944">.</span><span class="ident" id="6125945">YStride</span>&nbsp;<span class="op" id="6125953">+</span>&nbsp;<span class="op" id="6125955">(</span><span class="ident" id="6125956"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6125958">.</span><span class="ident" id="6125959">X</span>&nbsp;<span class="op" id="6125961">-</span>&nbsp;<span class="ident" id="6125963"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6125966">.</span><span class="ident" id="6125967">Rect</span><span class="op" id="6125971">.</span><span class="ident" id="6125972">Min</span><span class="op" id="6125975">.</span><span class="ident" id="6125976">X</span><span class="op" id="6125977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6125982">ciBase</span>&nbsp;<span class="op" id="6125989">:=</span>&nbsp;<span class="op" id="6125992">(</span><span class="ident" id="6125993"><a href="/image/draw/draw.go.html#6125833">sy</a></span><span class="op" id="6125995">/</span><span class="num" id="6125996">2</span><span class="op" id="6125997">-</span><span class="ident" id="6125998"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126001">.</span><span class="ident" id="6126002">Rect</span><span class="op" id="6126006">.</span><span class="ident" id="6126007">Min</span><span class="op" id="6126010">.</span><span class="ident" id="6126011">Y</span><span class="op" id="6126012">/</span><span class="num" id="6126013">2</span><span class="op" id="6126014">)</span><span class="op" id="6126015">*</span><span class="ident" id="6126016"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126019">.</span><span class="ident" id="6126020">CStride</span>&nbsp;<span class="op" id="6126028">-</span>&nbsp;<span class="ident" id="6126030"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126033">.</span><span class="ident" id="6126034">Rect</span><span class="op" id="6126038">.</span><span class="ident" id="6126039">Min</span><span class="op" id="6126042">.</span><span class="ident" id="6126043">X</span><span class="op" id="6126044">/</span><span class="num" id="6126045">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126050">for</span>&nbsp;<span class="ident" id="6126054">x</span><span class="op" id="6126055">,</span>&nbsp;<span class="ident" id="6126057">sx</span>&nbsp;<span class="op" id="6126060">:=</span>&nbsp;<span class="ident" id="6126063"><a href="/image/draw/draw.go.html#6124651">x0</a></span><span class="op" id="6126065">,</span>&nbsp;<span class="ident" id="6126067"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6126069">.</span><span class="ident" id="6126070">X</span><span class="op" id="6126071">;</span>&nbsp;<span class="ident" id="6126073"><a href="/image/draw/draw.go.html#6126054">x</a></span>&nbsp;<span class="op" id="6126075">!=</span>&nbsp;<span class="ident" id="6126078"><a href="/image/draw/draw.go.html#6124689">x1</a></span><span class="op" id="6126080">;</span>&nbsp;<span class="ident" id="6126082"><a href="/image/draw/draw.go.html#6126054">x</a></span><span class="op" id="6126083">,</span>&nbsp;<span class="ident" id="6126085"><a href="/image/draw/draw.go.html#6126057">sx</a></span><span class="op" id="6126087">,</span>&nbsp;<span class="ident" id="6126089"><a href="/image/draw/draw.go.html#6125915">yi</a></span>&nbsp;<span class="op" id="6126092">=</span>&nbsp;<span class="ident" id="6126094"><a href="/image/draw/draw.go.html#6126054">x</a></span><span class="op" id="6126095">+</span><span class="num" id="6126096">4</span><span class="op" id="6126097">,</span>&nbsp;<span class="ident" id="6126099"><a href="/image/draw/draw.go.html#6126057">sx</a></span><span class="op" id="6126101">+</span><span class="num" id="6126102">1</span><span class="op" id="6126103">,</span>&nbsp;<span class="ident" id="6126105"><a href="/image/draw/draw.go.html#6125915">yi</a></span><span class="op" id="6126107">+</span><span class="num" id="6126108">1</span>&nbsp;<span class="op" id="6126110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126116">ci</span>&nbsp;<span class="op" id="6126119">:=</span>&nbsp;<span class="ident" id="6126122"><a href="/image/draw/draw.go.html#6125982">ciBase</a></span>&nbsp;<span class="op" id="6126129">+</span>&nbsp;<span class="ident" id="6126131"><a href="/image/draw/draw.go.html#6126057">sx</a></span><span class="op" id="6126133">/</span><span class="num" id="6126134">2</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126140">rr</span><span class="op" id="6126142">,</span>&nbsp;<span class="ident" id="6126144">gg</span><span class="op" id="6126146">,</span>&nbsp;<span class="ident" id="6126148">bb</span>&nbsp;<span class="op" id="6126151">:=</span>&nbsp;<span class="ident" id="6126154"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6126159">.</span><span class="ident" id="6126160">YCbCrToRGB</span><span class="op" id="6126170">(</span><span class="ident" id="6126171"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126174">.</span><span class="ident" id="6126175">Y</span><span class="op" id="6126176">[</span><span class="ident" id="6126177"><a href="/image/draw/draw.go.html#6125915">yi</a></span><span class="op" id="6126179">]</span><span class="op" id="6126180">,</span>&nbsp;<span class="ident" id="6126182"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126185">.</span><span class="ident" id="6126186">Cb</span><span class="op" id="6126188">[</span><span class="ident" id="6126189"><a href="/image/draw/draw.go.html#6126116">ci</a></span><span class="op" id="6126191">]</span><span class="op" id="6126192">,</span>&nbsp;<span class="ident" id="6126194"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126197">.</span><span class="ident" id="6126198">Cr</span><span class="op" id="6126200">[</span><span class="ident" id="6126201"><a href="/image/draw/draw.go.html#6126116">ci</a></span><span class="op" id="6126203">]</span><span class="op" id="6126204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126210"><a href="/image/draw/draw.go.html#6125881">dpix</a></span><span class="op" id="6126214">[</span><span class="ident" id="6126215"><a href="/image/draw/draw.go.html#6126054">x</a></span><span class="op" id="6126216">+</span><span class="num" id="6126217">0</span><span class="op" id="6126218">]</span>&nbsp;<span class="op" id="6126220">=</span>&nbsp;<span class="ident" id="6126222"><a href="/image/draw/draw.go.html#6126140">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126229"><a href="/image/draw/draw.go.html#6125881">dpix</a></span><span class="op" id="6126233">[</span><span class="ident" id="6126234"><a href="/image/draw/draw.go.html#6126054">x</a></span><span class="op" id="6126235">+</span><span class="num" id="6126236">1</span><span class="op" id="6126237">]</span>&nbsp;<span class="op" id="6126239">=</span>&nbsp;<span class="ident" id="6126241"><a href="/image/draw/draw.go.html#6126144">gg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126248"><a href="/image/draw/draw.go.html#6125881">dpix</a></span><span class="op" id="6126252">[</span><span class="ident" id="6126253"><a href="/image/draw/draw.go.html#6126054">x</a></span><span class="op" id="6126254">+</span><span class="num" id="6126255">2</span><span class="op" id="6126256">]</span>&nbsp;<span class="op" id="6126258">=</span>&nbsp;<span class="ident" id="6126260"><a href="/image/draw/draw.go.html#6126148">bb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126267"><a href="/image/draw/draw.go.html#6125881">dpix</a></span><span class="op" id="6126271">[</span><span class="ident" id="6126272"><a href="/image/draw/draw.go.html#6126054">x</a></span><span class="op" id="6126273">+</span><span class="num" id="6126274">3</span><span class="op" id="6126275">]</span>&nbsp;<span class="op" id="6126277">=</span>&nbsp;<span class="num" id="6126279">255</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6126286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6126290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126293">case</span>&nbsp;<span class="ident" id="6126298"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6126303">.</span><span class="ident" id="6126304">YCbCrSubsampleRatio440</span><span class="op" id="6126326">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126330">for</span>&nbsp;<span class="ident" id="6126334">y</span><span class="op" id="6126335">,</span>&nbsp;<span class="ident" id="6126337">sy</span>&nbsp;<span class="op" id="6126340">:=</span>&nbsp;<span class="ident" id="6126343"><a href="/image/draw/draw.go.html#6124727">y0</a></span><span class="op" id="6126345">,</span>&nbsp;<span class="ident" id="6126347"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6126349">.</span><span class="ident" id="6126350">Y</span><span class="op" id="6126351">;</span>&nbsp;<span class="ident" id="6126353"><a href="/image/draw/draw.go.html#6126334">y</a></span>&nbsp;<span class="op" id="6126355">!=</span>&nbsp;<span class="ident" id="6126358"><a href="/image/draw/draw.go.html#6124759">y1</a></span><span class="op" id="6126360">;</span>&nbsp;<span class="ident" id="6126362"><a href="/image/draw/draw.go.html#6126334">y</a></span><span class="op" id="6126363">,</span>&nbsp;<span class="ident" id="6126365"><a href="/image/draw/draw.go.html#6126337">sy</a></span>&nbsp;<span class="op" id="6126368">=</span>&nbsp;<span class="ident" id="6126370"><a href="/image/draw/draw.go.html#6126334">y</a></span><span class="op" id="6126371">+</span><span class="num" id="6126372">1</span><span class="op" id="6126373">,</span>&nbsp;<span class="ident" id="6126375"><a href="/image/draw/draw.go.html#6126337">sy</a></span><span class="op" id="6126377">+</span><span class="num" id="6126378">1</span>&nbsp;<span class="op" id="6126380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126385">dpix</span>&nbsp;<span class="op" id="6126390">:=</span>&nbsp;<span class="ident" id="6126393"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6126396">.</span><span class="ident" id="6126397">Pix</span><span class="op" id="6126400">[</span><span class="ident" id="6126401"><a href="/image/draw/draw.go.html#6126334">y</a></span><span class="op" id="6126402">*</span><span class="ident" id="6126403"><a href="/image/draw/draw.go.html#6124425">dst</a></span><span class="op" id="6126406">.</span><span class="ident" id="6126407">Stride</span><span class="op" id="6126413">:</span><span class="op" id="6126414">]</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126419">yi</span>&nbsp;<span class="op" id="6126422">:=</span>&nbsp;<span class="op" id="6126425">(</span><span class="ident" id="6126426"><a href="/image/draw/draw.go.html#6126337">sy</a></span><span class="op" id="6126428">-</span><span class="ident" id="6126429"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126432">.</span><span class="ident" id="6126433">Rect</span><span class="op" id="6126437">.</span><span class="ident" id="6126438">Min</span><span class="op" id="6126441">.</span><span class="ident" id="6126442">Y</span><span class="op" id="6126443">)</span><span class="op" id="6126444">*</span><span class="ident" id="6126445"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126448">.</span><span class="ident" id="6126449">YStride</span>&nbsp;<span class="op" id="6126457">+</span>&nbsp;<span class="op" id="6126459">(</span><span class="ident" id="6126460"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6126462">.</span><span class="ident" id="6126463">X</span>&nbsp;<span class="op" id="6126465">-</span>&nbsp;<span class="ident" id="6126467"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126470">.</span><span class="ident" id="6126471">Rect</span><span class="op" id="6126475">.</span><span class="ident" id="6126476">Min</span><span class="op" id="6126479">.</span><span class="ident" id="6126480">X</span><span class="op" id="6126481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126486">ci</span>&nbsp;<span class="op" id="6126489">:=</span>&nbsp;<span class="op" id="6126492">(</span><span class="ident" id="6126493"><a href="/image/draw/draw.go.html#6126337">sy</a></span><span class="op" id="6126495">/</span><span class="num" id="6126496">2</span><span class="op" id="6126497">-</span><span class="ident" id="6126498"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126501">.</span><span class="ident" id="6126502">Rect</span><span class="op" id="6126506">.</span><span class="ident" id="6126507">Min</span><span class="op" id="6126510">.</span><span class="ident" id="6126511">Y</span><span class="op" id="6126512">/</span><span class="num" id="6126513">2</span><span class="op" id="6126514">)</span><span class="op" id="6126515">*</span><span class="ident" id="6126516"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126519">.</span><span class="ident" id="6126520">CStride</span>&nbsp;<span class="op" id="6126528">+</span>&nbsp;<span class="op" id="6126530">(</span><span class="ident" id="6126531"><a href="/image/draw/draw.go.html#6124479">sp</a></span><span class="op" id="6126533">.</span><span class="ident" id="6126534">X</span>&nbsp;<span class="op" id="6126536">-</span>&nbsp;<span class="ident" id="6126538"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126541">.</span><span class="ident" id="6126542">Rect</span><span class="op" id="6126546">.</span><span class="ident" id="6126547">Min</span><span class="op" id="6126550">.</span><span class="ident" id="6126551">X</span><span class="op" id="6126552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126557">for</span>&nbsp;<span class="ident" id="6126561">x</span>&nbsp;<span class="op" id="6126563">:=</span>&nbsp;<span class="ident" id="6126566"><a href="/image/draw/draw.go.html#6124651">x0</a></span><span class="op" id="6126568">;</span>&nbsp;<span class="ident" id="6126570"><a href="/image/draw/draw.go.html#6126561">x</a></span>&nbsp;<span class="op" id="6126572">!=</span>&nbsp;<span class="ident" id="6126575"><a href="/image/draw/draw.go.html#6124689">x1</a></span><span class="op" id="6126577">;</span>&nbsp;<span class="ident" id="6126579"><a href="/image/draw/draw.go.html#6126561">x</a></span><span class="op" id="6126580">,</span>&nbsp;<span class="ident" id="6126582"><a href="/image/draw/draw.go.html#6126419">yi</a></span><span class="op" id="6126584">,</span>&nbsp;<span class="ident" id="6126586"><a href="/image/draw/draw.go.html#6126486">ci</a></span>&nbsp;<span class="op" id="6126589">=</span>&nbsp;<span class="ident" id="6126591"><a href="/image/draw/draw.go.html#6126561">x</a></span><span class="op" id="6126592">+</span><span class="num" id="6126593">4</span><span class="op" id="6126594">,</span>&nbsp;<span class="ident" id="6126596"><a href="/image/draw/draw.go.html#6126419">yi</a></span><span class="op" id="6126598">+</span><span class="num" id="6126599">1</span><span class="op" id="6126600">,</span>&nbsp;<span class="ident" id="6126602"><a href="/image/draw/draw.go.html#6126486">ci</a></span><span class="op" id="6126604">+</span><span class="num" id="6126605">1</span>&nbsp;<span class="op" id="6126607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126613">rr</span><span class="op" id="6126615">,</span>&nbsp;<span class="ident" id="6126617">gg</span><span class="op" id="6126619">,</span>&nbsp;<span class="ident" id="6126621">bb</span>&nbsp;<span class="op" id="6126624">:=</span>&nbsp;<span class="ident" id="6126627"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6126632">.</span><span class="ident" id="6126633">YCbCrToRGB</span><span class="op" id="6126643">(</span><span class="ident" id="6126644"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126647">.</span><span class="ident" id="6126648">Y</span><span class="op" id="6126649">[</span><span class="ident" id="6126650"><a href="/image/draw/draw.go.html#6126419">yi</a></span><span class="op" id="6126652">]</span><span class="op" id="6126653">,</span>&nbsp;<span class="ident" id="6126655"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126658">.</span><span class="ident" id="6126659">Cb</span><span class="op" id="6126661">[</span><span class="ident" id="6126662"><a href="/image/draw/draw.go.html#6126486">ci</a></span><span class="op" id="6126664">]</span><span class="op" id="6126665">,</span>&nbsp;<span class="ident" id="6126667"><a href="/image/draw/draw.go.html#6124461">src</a></span><span class="op" id="6126670">.</span><span class="ident" id="6126671">Cr</span><span class="op" id="6126673">[</span><span class="ident" id="6126674"><a href="/image/draw/draw.go.html#6126486">ci</a></span><span class="op" id="6126676">]</span><span class="op" id="6126677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126683"><a href="/image/draw/draw.go.html#6126385">dpix</a></span><span class="op" id="6126687">[</span><span class="ident" id="6126688"><a href="/image/draw/draw.go.html#6126561">x</a></span><span class="op" id="6126689">+</span><span class="num" id="6126690">0</span><span class="op" id="6126691">]</span>&nbsp;<span class="op" id="6126693">=</span>&nbsp;<span class="ident" id="6126695"><a href="/image/draw/draw.go.html#6126613">rr</a></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126702"><a href="/image/draw/draw.go.html#6126385">dpix</a></span><span class="op" id="6126706">[</span><span class="ident" id="6126707"><a href="/image/draw/draw.go.html#6126561">x</a></span><span class="op" id="6126708">+</span><span class="num" id="6126709">1</span><span class="op" id="6126710">]</span>&nbsp;<span class="op" id="6126712">=</span>&nbsp;<span class="ident" id="6126714"><a href="/image/draw/draw.go.html#6126617">gg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126721"><a href="/image/draw/draw.go.html#6126385">dpix</a></span><span class="op" id="6126725">[</span><span class="ident" id="6126726"><a href="/image/draw/draw.go.html#6126561">x</a></span><span class="op" id="6126727">+</span><span class="num" id="6126728">2</span><span class="op" id="6126729">]</span>&nbsp;<span class="op" id="6126731">=</span>&nbsp;<span class="ident" id="6126733"><a href="/image/draw/draw.go.html#6126621">bb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126740"><a href="/image/draw/draw.go.html#6126385">dpix</a></span><span class="op" id="6126744">[</span><span class="ident" id="6126745"><a href="/image/draw/draw.go.html#6126561">x</a></span><span class="op" id="6126746">+</span><span class="num" id="6126747">3</span><span class="op" id="6126748">]</span>&nbsp;<span class="op" id="6126750">=</span>&nbsp;<span class="num" id="6126752">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6126759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6126763">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126766">default</span><span class="op" id="6126773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126777">return</span>&nbsp;<span class="ident" id="6126784">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6126791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6126794">return</span>&nbsp;<span class="ident" id="6126801">true</span><br>
<span class="lineno"></span><span class="op" id="6126806">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="6126809">func</span>&nbsp;<span class="ident" id="6126814">drawGlyphOver</span><span class="op" id="6126827">(</span><span class="ident" id="6126828">dst</span>&nbsp;<span class="op" id="6126832">*</span><span class="ident" id="6126833"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6126838">.</span><span class="ident" id="6126839">RGBA</span><span class="op" id="6126843">,</span>&nbsp;<span class="ident" id="6126845">r</span>&nbsp;<span class="ident" id="6126847"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6126852">.</span><span class="ident" id="6126853">Rectangle</span><span class="op" id="6126862">,</span>&nbsp;<span class="ident" id="6126864">src</span>&nbsp;<span class="op" id="6126868">*</span><span class="ident" id="6126869"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6126874">.</span><span class="ident" id="6126875">Uniform</span><span class="op" id="6126882">,</span>&nbsp;<span class="ident" id="6126884">mask</span>&nbsp;<span class="op" id="6126889">*</span><span class="ident" id="6126890"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6126895">.</span><span class="ident" id="6126896">Alpha</span><span class="op" id="6126901">,</span>&nbsp;<span class="ident" id="6126903">mp</span>&nbsp;<span class="ident" id="6126906"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6126911">.</span><span class="ident" id="6126912">Point</span><span class="op" id="6126917">)</span>&nbsp;<span class="op" id="6126919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126922">i0</span>&nbsp;<span class="op" id="6126925">:=</span>&nbsp;<span class="ident" id="6126928"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6126931">.</span><span class="ident" id="6126932">PixOffset</span><span class="op" id="6126941">(</span><span class="ident" id="6126942"><a href="/image/draw/draw.go.html#6126845">r</a></span><span class="op" id="6126943">.</span><span class="ident" id="6126944">Min</span><span class="op" id="6126947">.</span><span class="ident" id="6126948">X</span><span class="op" id="6126949">,</span>&nbsp;<span class="ident" id="6126951"><a href="/image/draw/draw.go.html#6126845">r</a></span><span class="op" id="6126952">.</span><span class="ident" id="6126953">Min</span><span class="op" id="6126956">.</span><span class="ident" id="6126957">Y</span><span class="op" id="6126958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126961">i1</span>&nbsp;<span class="op" id="6126964">:=</span>&nbsp;<span class="ident" id="6126967"><a href="/image/draw/draw.go.html#6126922">i0</a></span>&nbsp;<span class="op" id="6126970">+</span>&nbsp;<span class="ident" id="6126972"><a href="/image/draw/draw.go.html#6126845">r</a></span><span class="op" id="6126973">.</span><span class="ident" id="6126974">Dx</span><span class="op" id="6126976">(</span><span class="op" id="6126977">)</span><span class="op" id="6126978">*</span><span class="num" id="6126979">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6126982">mi0</span>&nbsp;<span class="op" id="6126986">:=</span>&nbsp;<span class="ident" id="6126989"><a href="/image/draw/draw.go.html#6126884">mask</a></span><span class="op" id="6126993">.</span><span class="ident" id="6126994">PixOffset</span><span class="op" id="6127003">(</span><span class="ident" id="6127004"><a href="/image/draw/draw.go.html#6126903">mp</a></span><span class="op" id="6127006">.</span><span class="ident" id="6127007">X</span><span class="op" id="6127008">,</span>&nbsp;<span class="ident" id="6127010"><a href="/image/draw/draw.go.html#6126903">mp</a></span><span class="op" id="6127012">.</span><span class="ident" id="6127013">Y</span><span class="op" id="6127014">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127017">sr</span><span class="op" id="6127019">,</span>&nbsp;<span class="ident" id="6127021">sg</span><span class="op" id="6127023">,</span>&nbsp;<span class="ident" id="6127025">sb</span><span class="op" id="6127027">,</span>&nbsp;<span class="ident" id="6127029">sa</span>&nbsp;<span class="op" id="6127032">:=</span>&nbsp;<span class="ident" id="6127035"><a href="/image/draw/draw.go.html#6126864">src</a></span><span class="op" id="6127038">.</span><span class="ident" id="6127039">RGBA</span><span class="op" id="6127043">(</span><span class="op" id="6127044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127047">for</span>&nbsp;<span class="ident" id="6127051">y</span><span class="op" id="6127052">,</span>&nbsp;<span class="ident" id="6127054">my</span>&nbsp;<span class="op" id="6127057">:=</span>&nbsp;<span class="ident" id="6127060"><a href="/image/draw/draw.go.html#6126845">r</a></span><span class="op" id="6127061">.</span><span class="ident" id="6127062">Min</span><span class="op" id="6127065">.</span><span class="ident" id="6127066">Y</span><span class="op" id="6127067">,</span>&nbsp;<span class="ident" id="6127069"><a href="/image/draw/draw.go.html#6126903">mp</a></span><span class="op" id="6127071">.</span><span class="ident" id="6127072">Y</span><span class="op" id="6127073">;</span>&nbsp;<span class="ident" id="6127075"><a href="/image/draw/draw.go.html#6127051">y</a></span>&nbsp;<span class="op" id="6127077">!=</span>&nbsp;<span class="ident" id="6127080"><a href="/image/draw/draw.go.html#6126845">r</a></span><span class="op" id="6127081">.</span><span class="ident" id="6127082">Max</span><span class="op" id="6127085">.</span><span class="ident" id="6127086">Y</span><span class="op" id="6127087">;</span>&nbsp;<span class="ident" id="6127089"><a href="/image/draw/draw.go.html#6127051">y</a></span><span class="op" id="6127090">,</span>&nbsp;<span class="ident" id="6127092"><a href="/image/draw/draw.go.html#6127054">my</a></span>&nbsp;<span class="op" id="6127095">=</span>&nbsp;<span class="ident" id="6127097"><a href="/image/draw/draw.go.html#6127051">y</a></span><span class="op" id="6127098">+</span><span class="num" id="6127099">1</span><span class="op" id="6127100">,</span>&nbsp;<span class="ident" id="6127102"><a href="/image/draw/draw.go.html#6127054">my</a></span><span class="op" id="6127104">+</span><span class="num" id="6127105">1</span>&nbsp;<span class="op" id="6127107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127111">for</span>&nbsp;<span class="ident" id="6127115">i</span><span class="op" id="6127116">,</span>&nbsp;<span class="ident" id="6127118">mi</span>&nbsp;<span class="op" id="6127121">:=</span>&nbsp;<span class="ident" id="6127124"><a href="/image/draw/draw.go.html#6126922">i0</a></span><span class="op" id="6127126">,</span>&nbsp;<span class="ident" id="6127128"><a href="/image/draw/draw.go.html#6126982">mi0</a></span><span class="op" id="6127131">;</span>&nbsp;<span class="ident" id="6127133"><a href="/image/draw/draw.go.html#6127115">i</a></span>&nbsp;<span class="op" id="6127135">&lt;</span>&nbsp;<span class="ident" id="6127137"><a href="/image/draw/draw.go.html#6126961">i1</a></span><span class="op" id="6127139">;</span>&nbsp;<span class="ident" id="6127141"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127142">,</span>&nbsp;<span class="ident" id="6127144"><a href="/image/draw/draw.go.html#6127118">mi</a></span>&nbsp;<span class="op" id="6127147">=</span>&nbsp;<span class="ident" id="6127149"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127150">+</span><span class="num" id="6127151">4</span><span class="op" id="6127152">,</span>&nbsp;<span class="ident" id="6127154"><a href="/image/draw/draw.go.html#6127118">mi</a></span><span class="op" id="6127156">+</span><span class="num" id="6127157">1</span>&nbsp;<span class="op" id="6127159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127164">ma</span>&nbsp;<span class="op" id="6127167">:=</span>&nbsp;<span class="builtintype" id="6127170">uint32</span><span class="op" id="6127176">(</span><span class="ident" id="6127177"><a href="/image/draw/draw.go.html#6126884">mask</a></span><span class="op" id="6127181">.</span><span class="ident" id="6127182">Pix</span><span class="op" id="6127185">[</span><span class="ident" id="6127186"><a href="/image/draw/draw.go.html#6127118">mi</a></span><span class="op" id="6127188">]</span><span class="op" id="6127189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127194">if</span>&nbsp;<span class="ident" id="6127197"><a href="/image/draw/draw.go.html#6127164">ma</a></span>&nbsp;<span class="op" id="6127200">==</span>&nbsp;<span class="num" id="6127203">0</span>&nbsp;<span class="op" id="6127205">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127211">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6127223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127228"><a href="/image/draw/draw.go.html#6127164">ma</a></span>&nbsp;<span class="op" id="6127231">|=</span>&nbsp;<span class="ident" id="6127234"><a href="/image/draw/draw.go.html#6127164">ma</a></span>&nbsp;<span class="op" id="6127237">&lt;&lt;</span>&nbsp;<span class="num" id="6127240">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127246">dr</span>&nbsp;<span class="op" id="6127249">:=</span>&nbsp;<span class="builtintype" id="6127252">uint32</span><span class="op" id="6127258">(</span><span class="ident" id="6127259"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127262">.</span><span class="ident" id="6127263">Pix</span><span class="op" id="6127266">[</span><span class="ident" id="6127267"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127268">+</span><span class="num" id="6127269">0</span><span class="op" id="6127270">]</span><span class="op" id="6127271">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127276">dg</span>&nbsp;<span class="op" id="6127279">:=</span>&nbsp;<span class="builtintype" id="6127282">uint32</span><span class="op" id="6127288">(</span><span class="ident" id="6127289"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127292">.</span><span class="ident" id="6127293">Pix</span><span class="op" id="6127296">[</span><span class="ident" id="6127297"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127298">+</span><span class="num" id="6127299">1</span><span class="op" id="6127300">]</span><span class="op" id="6127301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127306">db</span>&nbsp;<span class="op" id="6127309">:=</span>&nbsp;<span class="builtintype" id="6127312">uint32</span><span class="op" id="6127318">(</span><span class="ident" id="6127319"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127322">.</span><span class="ident" id="6127323">Pix</span><span class="op" id="6127326">[</span><span class="ident" id="6127327"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127328">+</span><span class="num" id="6127329">2</span><span class="op" id="6127330">]</span><span class="op" id="6127331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127336">da</span>&nbsp;<span class="op" id="6127339">:=</span>&nbsp;<span class="builtintype" id="6127342">uint32</span><span class="op" id="6127348">(</span><span class="ident" id="6127349"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127352">.</span><span class="ident" id="6127353">Pix</span><span class="op" id="6127356">[</span><span class="ident" id="6127357"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127358">+</span><span class="num" id="6127359">3</span><span class="op" id="6127360">]</span><span class="op" id="6127361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6127367">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127427">a</span>&nbsp;<span class="op" id="6127429">:=</span>&nbsp;<span class="op" id="6127432">(</span><span class="ident" id="6127433"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6127435">-</span>&nbsp;<span class="op" id="6127437">(</span><span class="ident" id="6127438"><a href="/image/draw/draw.go.html#6127029">sa</a></span>&nbsp;<span class="op" id="6127441">*</span>&nbsp;<span class="ident" id="6127443"><a href="/image/draw/draw.go.html#6127164">ma</a></span>&nbsp;<span class="op" id="6127446">/</span>&nbsp;<span class="ident" id="6127448"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6127449">)</span><span class="op" id="6127450">)</span>&nbsp;<span class="op" id="6127452">*</span>&nbsp;<span class="num" id="6127454">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127464"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127467">.</span><span class="ident" id="6127468">Pix</span><span class="op" id="6127471">[</span><span class="ident" id="6127472"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127473">+</span><span class="num" id="6127474">0</span><span class="op" id="6127475">]</span>&nbsp;<span class="op" id="6127477">=</span>&nbsp;<span class="builtintype" id="6127479">uint8</span><span class="op" id="6127484">(</span><span class="op" id="6127485">(</span><span class="ident" id="6127486"><a href="/image/draw/draw.go.html#6127246">dr</a></span><span class="op" id="6127488">*</span><span class="ident" id="6127489"><a href="/image/draw/draw.go.html#6127427">a</a></span>&nbsp;<span class="op" id="6127491">+</span>&nbsp;<span class="ident" id="6127493"><a href="/image/draw/draw.go.html#6127017">sr</a></span><span class="op" id="6127495">*</span><span class="ident" id="6127496"><a href="/image/draw/draw.go.html#6127164">ma</a></span><span class="op" id="6127498">)</span>&nbsp;<span class="op" id="6127500">/</span>&nbsp;<span class="ident" id="6127502"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6127504">&gt;&gt;</span>&nbsp;<span class="num" id="6127507">8</span><span class="op" id="6127508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127513"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127516">.</span><span class="ident" id="6127517">Pix</span><span class="op" id="6127520">[</span><span class="ident" id="6127521"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127522">+</span><span class="num" id="6127523">1</span><span class="op" id="6127524">]</span>&nbsp;<span class="op" id="6127526">=</span>&nbsp;<span class="builtintype" id="6127528">uint8</span><span class="op" id="6127533">(</span><span class="op" id="6127534">(</span><span class="ident" id="6127535"><a href="/image/draw/draw.go.html#6127276">dg</a></span><span class="op" id="6127537">*</span><span class="ident" id="6127538"><a href="/image/draw/draw.go.html#6127427">a</a></span>&nbsp;<span class="op" id="6127540">+</span>&nbsp;<span class="ident" id="6127542"><a href="/image/draw/draw.go.html#6127021">sg</a></span><span class="op" id="6127544">*</span><span class="ident" id="6127545"><a href="/image/draw/draw.go.html#6127164">ma</a></span><span class="op" id="6127547">)</span>&nbsp;<span class="op" id="6127549">/</span>&nbsp;<span class="ident" id="6127551"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6127553">&gt;&gt;</span>&nbsp;<span class="num" id="6127556">8</span><span class="op" id="6127557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127562"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127565">.</span><span class="ident" id="6127566">Pix</span><span class="op" id="6127569">[</span><span class="ident" id="6127570"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127571">+</span><span class="num" id="6127572">2</span><span class="op" id="6127573">]</span>&nbsp;<span class="op" id="6127575">=</span>&nbsp;<span class="builtintype" id="6127577">uint8</span><span class="op" id="6127582">(</span><span class="op" id="6127583">(</span><span class="ident" id="6127584"><a href="/image/draw/draw.go.html#6127306">db</a></span><span class="op" id="6127586">*</span><span class="ident" id="6127587"><a href="/image/draw/draw.go.html#6127427">a</a></span>&nbsp;<span class="op" id="6127589">+</span>&nbsp;<span class="ident" id="6127591"><a href="/image/draw/draw.go.html#6127025">sb</a></span><span class="op" id="6127593">*</span><span class="ident" id="6127594"><a href="/image/draw/draw.go.html#6127164">ma</a></span><span class="op" id="6127596">)</span>&nbsp;<span class="op" id="6127598">/</span>&nbsp;<span class="ident" id="6127600"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6127602">&gt;&gt;</span>&nbsp;<span class="num" id="6127605">8</span><span class="op" id="6127606">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127611"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127614">.</span><span class="ident" id="6127615">Pix</span><span class="op" id="6127618">[</span><span class="ident" id="6127619"><a href="/image/draw/draw.go.html#6127115">i</a></span><span class="op" id="6127620">+</span><span class="num" id="6127621">3</span><span class="op" id="6127622">]</span>&nbsp;<span class="op" id="6127624">=</span>&nbsp;<span class="builtintype" id="6127626">uint8</span><span class="op" id="6127631">(</span><span class="op" id="6127632">(</span><span class="ident" id="6127633"><a href="/image/draw/draw.go.html#6127336">da</a></span><span class="op" id="6127635">*</span><span class="ident" id="6127636"><a href="/image/draw/draw.go.html#6127427">a</a></span>&nbsp;<span class="op" id="6127638">+</span>&nbsp;<span class="ident" id="6127640"><a href="/image/draw/draw.go.html#6127029">sa</a></span><span class="op" id="6127642">*</span><span class="ident" id="6127643"><a href="/image/draw/draw.go.html#6127164">ma</a></span><span class="op" id="6127645">)</span>&nbsp;<span class="op" id="6127647">/</span>&nbsp;<span class="ident" id="6127649"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6127651">&gt;&gt;</span>&nbsp;<span class="num" id="6127654">8</span><span class="op" id="6127655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6127659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127663"><a href="/image/draw/draw.go.html#6126922">i0</a></span>&nbsp;<span class="op" id="6127666">+=</span>&nbsp;<span class="ident" id="6127669"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127672">.</span><span class="ident" id="6127673">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127682"><a href="/image/draw/draw.go.html#6126961">i1</a></span>&nbsp;<span class="op" id="6127685">+=</span>&nbsp;<span class="ident" id="6127688"><a href="/image/draw/draw.go.html#6126828">dst</a></span><span class="op" id="6127691">.</span><span class="ident" id="6127692">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127701"><a href="/image/draw/draw.go.html#6126982">mi0</a></span>&nbsp;<span class="op" id="6127705">+=</span>&nbsp;<span class="ident" id="6127708"><a href="/image/draw/draw.go.html#6126884">mask</a></span><span class="op" id="6127712">.</span><span class="ident" id="6127713">Stride</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6127721">}</span><br>
<span class="lineno"></span><span class="op" id="6127723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6127726">func</span>&nbsp;<span class="ident" id="6127731">drawRGBA</span><span class="op" id="6127739">(</span><span class="ident" id="6127740">dst</span>&nbsp;<span class="op" id="6127744">*</span><span class="ident" id="6127745"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127750">.</span><span class="ident" id="6127751">RGBA</span><span class="op" id="6127755">,</span>&nbsp;<span class="ident" id="6127757">r</span>&nbsp;<span class="ident" id="6127759"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127764">.</span><span class="ident" id="6127765">Rectangle</span><span class="op" id="6127774">,</span>&nbsp;<span class="ident" id="6127776">src</span>&nbsp;<span class="ident" id="6127780"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127785">.</span><span class="ident" id="6127786">Image</span><span class="op" id="6127791">,</span>&nbsp;<span class="ident" id="6127793">sp</span>&nbsp;<span class="ident" id="6127796"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127801">.</span><span class="ident" id="6127802">Point</span><span class="op" id="6127807">,</span>&nbsp;<span class="ident" id="6127809">mask</span>&nbsp;<span class="ident" id="6127814"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127819">.</span><span class="ident" id="6127820">Image</span><span class="op" id="6127825">,</span>&nbsp;<span class="ident" id="6127827">mp</span>&nbsp;<span class="ident" id="6127830"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127835">.</span><span class="ident" id="6127836">Point</span><span class="op" id="6127841">,</span>&nbsp;<span class="ident" id="6127843">op</span>&nbsp;<span class="ident" id="6127846"><a href="/image/draw/draw.go.html#6113895">Op</a></span><span class="op" id="6127848">)</span>&nbsp;<span class="op" id="6127850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127853">x0</span><span class="op" id="6127855">,</span>&nbsp;<span class="ident" id="6127857">x1</span><span class="op" id="6127859">,</span>&nbsp;<span class="ident" id="6127861">dx</span>&nbsp;<span class="op" id="6127864">:=</span>&nbsp;<span class="ident" id="6127867"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127868">.</span><span class="ident" id="6127869">Min</span><span class="op" id="6127872">.</span><span class="ident" id="6127873">X</span><span class="op" id="6127874">,</span>&nbsp;<span class="ident" id="6127876"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127877">.</span><span class="ident" id="6127878">Max</span><span class="op" id="6127881">.</span><span class="ident" id="6127882">X</span><span class="op" id="6127883">,</span>&nbsp;<span class="num" id="6127885">1</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6127888">y0</span><span class="op" id="6127890">,</span>&nbsp;<span class="ident" id="6127892">y1</span><span class="op" id="6127894">,</span>&nbsp;<span class="ident" id="6127896">dy</span>&nbsp;<span class="op" id="6127899">:=</span>&nbsp;<span class="ident" id="6127902"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127903">.</span><span class="ident" id="6127904">Min</span><span class="op" id="6127907">.</span><span class="ident" id="6127908">Y</span><span class="op" id="6127909">,</span>&nbsp;<span class="ident" id="6127911"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127912">.</span><span class="ident" id="6127913">Max</span><span class="op" id="6127916">.</span><span class="ident" id="6127917">Y</span><span class="op" id="6127918">,</span>&nbsp;<span class="num" id="6127920">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127923">if</span>&nbsp;<span class="ident" id="6127926"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6127931">.</span><span class="ident" id="6127932">Image</span><span class="op" id="6127937">(</span><span class="ident" id="6127938"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6127941">)</span>&nbsp;<span class="op" id="6127943">==</span>&nbsp;<span class="ident" id="6127946"><a href="/image/draw/draw.go.html#6127776">src</a></span>&nbsp;<span class="op" id="6127950">&amp;&amp;</span>&nbsp;<span class="ident" id="6127953"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127954">.</span><span class="ident" id="6127955">Overlaps</span><span class="op" id="6127963">(</span><span class="ident" id="6127964"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127965">.</span><span class="ident" id="6127966">Add</span><span class="op" id="6127969">(</span><span class="ident" id="6127970"><a href="/image/draw/draw.go.html#6127793">sp</a></span><span class="op" id="6127972">.</span><span class="ident" id="6127973">Sub</span><span class="op" id="6127976">(</span><span class="ident" id="6127977"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6127978">.</span><span class="ident" id="6127979">Min</span><span class="op" id="6127982">)</span><span class="op" id="6127983">)</span><span class="op" id="6127984">)</span>&nbsp;<span class="op" id="6127986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6127990">if</span>&nbsp;<span class="ident" id="6127993"><a href="/image/draw/draw.go.html#6127793">sp</a></span><span class="op" id="6127995">.</span><span class="ident" id="6127996">Y</span>&nbsp;<span class="op" id="6127998">&lt;</span>&nbsp;<span class="ident" id="6128000"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128001">.</span><span class="ident" id="6128002">Min</span><span class="op" id="6128005">.</span><span class="ident" id="6128006">Y</span>&nbsp;<span class="op" id="6128008">||</span>&nbsp;<span class="ident" id="6128011"><a href="/image/draw/draw.go.html#6127793">sp</a></span><span class="op" id="6128013">.</span><span class="ident" id="6128014">Y</span>&nbsp;<span class="op" id="6128016">==</span>&nbsp;<span class="ident" id="6128019"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128020">.</span><span class="ident" id="6128021">Min</span><span class="op" id="6128024">.</span><span class="ident" id="6128025">Y</span>&nbsp;<span class="op" id="6128027">&amp;&amp;</span>&nbsp;<span class="ident" id="6128030"><a href="/image/draw/draw.go.html#6127793">sp</a></span><span class="op" id="6128032">.</span><span class="ident" id="6128033">X</span>&nbsp;<span class="op" id="6128035">&lt;</span>&nbsp;<span class="ident" id="6128037"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128038">.</span><span class="ident" id="6128039">Min</span><span class="op" id="6128042">.</span><span class="ident" id="6128043">X</span>&nbsp;<span class="op" id="6128045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128050"><a href="/image/draw/draw.go.html#6127853">x0</a></span><span class="op" id="6128052">,</span>&nbsp;<span class="ident" id="6128054"><a href="/image/draw/draw.go.html#6127857">x1</a></span><span class="op" id="6128056">,</span>&nbsp;<span class="ident" id="6128058"><a href="/image/draw/draw.go.html#6127861">dx</a></span>&nbsp;<span class="op" id="6128061">=</span>&nbsp;<span class="ident" id="6128063"><a href="/image/draw/draw.go.html#6127857">x1</a></span><span class="op" id="6128065">-</span><span class="num" id="6128066">1</span><span class="op" id="6128067">,</span>&nbsp;<span class="ident" id="6128069"><a href="/image/draw/draw.go.html#6127853">x0</a></span><span class="op" id="6128071">-</span><span class="num" id="6128072">1</span><span class="op" id="6128073">,</span>&nbsp;<span class="op" id="6128075">-</span><span class="num" id="6128076">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128081"><a href="/image/draw/draw.go.html#6127888">y0</a></span><span class="op" id="6128083">,</span>&nbsp;<span class="ident" id="6128085"><a href="/image/draw/draw.go.html#6127892">y1</a></span><span class="op" id="6128087">,</span>&nbsp;<span class="ident" id="6128089"><a href="/image/draw/draw.go.html#6127896">dy</a></span>&nbsp;<span class="op" id="6128092">=</span>&nbsp;<span class="ident" id="6128094"><a href="/image/draw/draw.go.html#6127892">y1</a></span><span class="op" id="6128096">-</span><span class="num" id="6128097">1</span><span class="op" id="6128098">,</span>&nbsp;<span class="ident" id="6128100"><a href="/image/draw/draw.go.html#6127888">y0</a></span><span class="op" id="6128102">-</span><span class="num" id="6128103">1</span><span class="op" id="6128104">,</span>&nbsp;<span class="op" id="6128106">-</span><span class="num" id="6128107">1</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128118">sy</span>&nbsp;<span class="op" id="6128121">:=</span>&nbsp;<span class="ident" id="6128124"><a href="/image/draw/draw.go.html#6127793">sp</a></span><span class="op" id="6128126">.</span><span class="ident" id="6128127">Y</span>&nbsp;<span class="op" id="6128129">+</span>&nbsp;<span class="ident" id="6128131"><a href="/image/draw/draw.go.html#6127888">y0</a></span>&nbsp;<span class="op" id="6128134">-</span>&nbsp;<span class="ident" id="6128136"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128137">.</span><span class="ident" id="6128138">Min</span><span class="op" id="6128141">.</span><span class="ident" id="6128142">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128145">my</span>&nbsp;<span class="op" id="6128148">:=</span>&nbsp;<span class="ident" id="6128151"><a href="/image/draw/draw.go.html#6127827">mp</a></span><span class="op" id="6128153">.</span><span class="ident" id="6128154">Y</span>&nbsp;<span class="op" id="6128156">+</span>&nbsp;<span class="ident" id="6128158"><a href="/image/draw/draw.go.html#6127888">y0</a></span>&nbsp;<span class="op" id="6128161">-</span>&nbsp;<span class="ident" id="6128163"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128164">.</span><span class="ident" id="6128165">Min</span><span class="op" id="6128168">.</span><span class="ident" id="6128169">Y</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128172">sx0</span>&nbsp;<span class="op" id="6128176">:=</span>&nbsp;<span class="ident" id="6128179"><a href="/image/draw/draw.go.html#6127793">sp</a></span><span class="op" id="6128181">.</span><span class="ident" id="6128182">X</span>&nbsp;<span class="op" id="6128184">+</span>&nbsp;<span class="ident" id="6128186"><a href="/image/draw/draw.go.html#6127853">x0</a></span>&nbsp;<span class="op" id="6128189">-</span>&nbsp;<span class="ident" id="6128191"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128192">.</span><span class="ident" id="6128193">Min</span><span class="op" id="6128196">.</span><span class="ident" id="6128197">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128200">mx0</span>&nbsp;<span class="op" id="6128204">:=</span>&nbsp;<span class="ident" id="6128207"><a href="/image/draw/draw.go.html#6127827">mp</a></span><span class="op" id="6128209">.</span><span class="ident" id="6128210">X</span>&nbsp;<span class="op" id="6128212">+</span>&nbsp;<span class="ident" id="6128214"><a href="/image/draw/draw.go.html#6127853">x0</a></span>&nbsp;<span class="op" id="6128217">-</span>&nbsp;<span class="ident" id="6128219"><a href="/image/draw/draw.go.html#6127757">r</a></span><span class="op" id="6128220">.</span><span class="ident" id="6128221">Min</span><span class="op" id="6128224">.</span><span class="ident" id="6128225">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128228">sx1</span>&nbsp;<span class="op" id="6128232">:=</span>&nbsp;<span class="ident" id="6128235"><a href="/image/draw/draw.go.html#6128172">sx0</a></span>&nbsp;<span class="op" id="6128239">+</span>&nbsp;<span class="op" id="6128241">(</span><span class="ident" id="6128242"><a href="/image/draw/draw.go.html#6127857">x1</a></span>&nbsp;<span class="op" id="6128245">-</span>&nbsp;<span class="ident" id="6128247"><a href="/image/draw/draw.go.html#6127853">x0</a></span><span class="op" id="6128249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128252">i0</span>&nbsp;<span class="op" id="6128255">:=</span>&nbsp;<span class="ident" id="6128258"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6128261">.</span><span class="ident" id="6128262">PixOffset</span><span class="op" id="6128271">(</span><span class="ident" id="6128272"><a href="/image/draw/draw.go.html#6127853">x0</a></span><span class="op" id="6128274">,</span>&nbsp;<span class="ident" id="6128276"><a href="/image/draw/draw.go.html#6127888">y0</a></span><span class="op" id="6128278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128281">di</span>&nbsp;<span class="op" id="6128284">:=</span>&nbsp;<span class="ident" id="6128287"><a href="/image/draw/draw.go.html#6127861">dx</a></span>&nbsp;<span class="op" id="6128290">*</span>&nbsp;<span class="num" id="6128292">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128295">for</span>&nbsp;<span class="ident" id="6128299">y</span>&nbsp;<span class="op" id="6128301">:=</span>&nbsp;<span class="ident" id="6128304"><a href="/image/draw/draw.go.html#6127888">y0</a></span><span class="op" id="6128306">;</span>&nbsp;<span class="ident" id="6128308"><a href="/image/draw/draw.go.html#6128299">y</a></span>&nbsp;<span class="op" id="6128310">!=</span>&nbsp;<span class="ident" id="6128313"><a href="/image/draw/draw.go.html#6127892">y1</a></span><span class="op" id="6128315">;</span>&nbsp;<span class="ident" id="6128317"><a href="/image/draw/draw.go.html#6128299">y</a></span><span class="op" id="6128318">,</span>&nbsp;<span class="ident" id="6128320"><a href="/image/draw/draw.go.html#6128118">sy</a></span><span class="op" id="6128322">,</span>&nbsp;<span class="ident" id="6128324"><a href="/image/draw/draw.go.html#6128145">my</a></span>&nbsp;<span class="op" id="6128327">=</span>&nbsp;<span class="ident" id="6128329"><a href="/image/draw/draw.go.html#6128299">y</a></span><span class="op" id="6128330">+</span><span class="ident" id="6128331"><a href="/image/draw/draw.go.html#6127896">dy</a></span><span class="op" id="6128333">,</span>&nbsp;<span class="ident" id="6128335"><a href="/image/draw/draw.go.html#6128118">sy</a></span><span class="op" id="6128337">+</span><span class="ident" id="6128338"><a href="/image/draw/draw.go.html#6127896">dy</a></span><span class="op" id="6128340">,</span>&nbsp;<span class="ident" id="6128342"><a href="/image/draw/draw.go.html#6128145">my</a></span><span class="op" id="6128344">+</span><span class="ident" id="6128345"><a href="/image/draw/draw.go.html#6127896">dy</a></span>&nbsp;<span class="op" id="6128348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128352">for</span>&nbsp;<span class="ident" id="6128356">i</span><span class="op" id="6128357">,</span>&nbsp;<span class="ident" id="6128359">sx</span><span class="op" id="6128361">,</span>&nbsp;<span class="ident" id="6128363">mx</span>&nbsp;<span class="op" id="6128366">:=</span>&nbsp;<span class="ident" id="6128369"><a href="/image/draw/draw.go.html#6128252">i0</a></span><span class="op" id="6128371">,</span>&nbsp;<span class="ident" id="6128373"><a href="/image/draw/draw.go.html#6128172">sx0</a></span><span class="op" id="6128376">,</span>&nbsp;<span class="ident" id="6128378"><a href="/image/draw/draw.go.html#6128200">mx0</a></span><span class="op" id="6128381">;</span>&nbsp;<span class="ident" id="6128383"><a href="/image/draw/draw.go.html#6128359">sx</a></span>&nbsp;<span class="op" id="6128386">!=</span>&nbsp;<span class="ident" id="6128389"><a href="/image/draw/draw.go.html#6128228">sx1</a></span><span class="op" id="6128392">;</span>&nbsp;<span class="ident" id="6128394"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6128395">,</span>&nbsp;<span class="ident" id="6128397"><a href="/image/draw/draw.go.html#6128359">sx</a></span><span class="op" id="6128399">,</span>&nbsp;<span class="ident" id="6128401"><a href="/image/draw/draw.go.html#6128363">mx</a></span>&nbsp;<span class="op" id="6128404">=</span>&nbsp;<span class="ident" id="6128406"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6128407">+</span><span class="ident" id="6128408"><a href="/image/draw/draw.go.html#6128281">di</a></span><span class="op" id="6128410">,</span>&nbsp;<span class="ident" id="6128412"><a href="/image/draw/draw.go.html#6128359">sx</a></span><span class="op" id="6128414">+</span><span class="ident" id="6128415"><a href="/image/draw/draw.go.html#6127861">dx</a></span><span class="op" id="6128417">,</span>&nbsp;<span class="ident" id="6128419"><a href="/image/draw/draw.go.html#6128363">mx</a></span><span class="op" id="6128421">+</span><span class="ident" id="6128422"><a href="/image/draw/draw.go.html#6127861">dx</a></span>&nbsp;<span class="op" id="6128425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128430">ma</span>&nbsp;<span class="op" id="6128433">:=</span>&nbsp;<span class="builtintype" id="6128436">uint32</span><span class="op" id="6128442">(</span><span class="ident" id="6128443"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6128444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128449">if</span>&nbsp;<span class="ident" id="6128452"><a href="/image/draw/draw.go.html#6127809">mask</a></span>&nbsp;<span class="op" id="6128457">!=</span>&nbsp;<span class="ident" id="6128460">nil</span>&nbsp;<span class="op" id="6128464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128470">_</span><span class="op" id="6128471">,</span>&nbsp;<span class="ident" id="6128473">_</span><span class="op" id="6128474">,</span>&nbsp;<span class="ident" id="6128476">_</span><span class="op" id="6128477">,</span>&nbsp;<span class="ident" id="6128479"><a href="/image/draw/draw.go.html#6128430">ma</a></span>&nbsp;<span class="op" id="6128482">=</span>&nbsp;<span class="ident" id="6128484"><a href="/image/draw/draw.go.html#6127809">mask</a></span><span class="op" id="6128488">.</span><span class="ident" id="6128489">At</span><span class="op" id="6128491">(</span><span class="ident" id="6128492"><a href="/image/draw/draw.go.html#6128363">mx</a></span><span class="op" id="6128494">,</span>&nbsp;<span class="ident" id="6128496"><a href="/image/draw/draw.go.html#6128145">my</a></span><span class="op" id="6128498">)</span><span class="op" id="6128499">.</span><span class="ident" id="6128500">RGBA</span><span class="op" id="6128504">(</span><span class="op" id="6128505">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6128510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128515">sr</span><span class="op" id="6128517">,</span>&nbsp;<span class="ident" id="6128519">sg</span><span class="op" id="6128521">,</span>&nbsp;<span class="ident" id="6128523">sb</span><span class="op" id="6128525">,</span>&nbsp;<span class="ident" id="6128527">sa</span>&nbsp;<span class="op" id="6128530">:=</span>&nbsp;<span class="ident" id="6128533"><a href="/image/draw/draw.go.html#6127776">src</a></span><span class="op" id="6128536">.</span><span class="ident" id="6128537">At</span><span class="op" id="6128539">(</span><span class="ident" id="6128540"><a href="/image/draw/draw.go.html#6128359">sx</a></span><span class="op" id="6128542">,</span>&nbsp;<span class="ident" id="6128544"><a href="/image/draw/draw.go.html#6128118">sy</a></span><span class="op" id="6128546">)</span><span class="op" id="6128547">.</span><span class="ident" id="6128548">RGBA</span><span class="op" id="6128552">(</span><span class="op" id="6128553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6128558">if</span>&nbsp;<span class="ident" id="6128561"><a href="/image/draw/draw.go.html#6127843">op</a></span>&nbsp;<span class="op" id="6128564">==</span>&nbsp;<span class="ident" id="6128567"><a href="/image/draw/draw.go.html#6113959">Over</a></span>&nbsp;<span class="op" id="6128572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128578">dr</span>&nbsp;<span class="op" id="6128581">:=</span>&nbsp;<span class="builtintype" id="6128584">uint32</span><span class="op" id="6128590">(</span><span class="ident" id="6128591"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6128594">.</span><span class="ident" id="6128595">Pix</span><span class="op" id="6128598">[</span><span class="ident" id="6128599"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6128600">+</span><span class="num" id="6128601">0</span><span class="op" id="6128602">]</span><span class="op" id="6128603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128609">dg</span>&nbsp;<span class="op" id="6128612">:=</span>&nbsp;<span class="builtintype" id="6128615">uint32</span><span class="op" id="6128621">(</span><span class="ident" id="6128622"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6128625">.</span><span class="ident" id="6128626">Pix</span><span class="op" id="6128629">[</span><span class="ident" id="6128630"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6128631">+</span><span class="num" id="6128632">1</span><span class="op" id="6128633">]</span><span class="op" id="6128634">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128640">db</span>&nbsp;<span class="op" id="6128643">:=</span>&nbsp;<span class="builtintype" id="6128646">uint32</span><span class="op" id="6128652">(</span><span class="ident" id="6128653"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6128656">.</span><span class="ident" id="6128657">Pix</span><span class="op" id="6128660">[</span><span class="ident" id="6128661"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6128662">+</span><span class="num" id="6128663">2</span><span class="op" id="6128664">]</span><span class="op" id="6128665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6128671">da</span>&nbsp;<span class="op" id="6128674">:=</span>&nbsp;<span class="builtintype" id="6128677">uint32</span><span class="op" id="6128683">(</span><span class="ident" id="6128684"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6128687">.</span><span class="ident" id="6128688">Pix</span><span class="op" id="6128691">[</span><span class="ident" id="6128692"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6128693">+</span><span class="num" id="6128694">3</span><span class="op" id="6128695">]</span><span class="op" id="6128696">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128703">//&nbsp;dr,&nbsp;dg,&nbsp;db&nbsp;and&nbsp;da&nbsp;are&nbsp;all&nbsp;8-bit&nbsp;color&nbsp;at&nbsp;the&nbsp;moment,&nbsp;ranging&nbsp;in&nbsp;[0,255].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128783">//&nbsp;We&nbsp;work&nbsp;in&nbsp;16-bit&nbsp;color,&nbsp;and&nbsp;so&nbsp;would&nbsp;normally&nbsp;do:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128841">//&nbsp;dr&nbsp;|=&nbsp;dr&nbsp;&lt;&lt;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128862">//&nbsp;and&nbsp;similarly&nbsp;for&nbsp;dg,&nbsp;db&nbsp;and&nbsp;da,&nbsp;but&nbsp;instead&nbsp;we&nbsp;multiply&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128928">//&nbsp;(which&nbsp;is&nbsp;a&nbsp;16-bit&nbsp;color,&nbsp;ranging&nbsp;in&nbsp;[0,65535])&nbsp;by&nbsp;0x101.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6128993">//&nbsp;This&nbsp;yields&nbsp;the&nbsp;same&nbsp;result,&nbsp;but&nbsp;is&nbsp;fewer&nbsp;arithmetic&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129065">a</span>&nbsp;<span class="op" id="6129067">:=</span>&nbsp;<span class="op" id="6129070">(</span><span class="ident" id="6129071"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129073">-</span>&nbsp;<span class="op" id="6129075">(</span><span class="ident" id="6129076"><a href="/image/draw/draw.go.html#6128527">sa</a></span>&nbsp;<span class="op" id="6129079">*</span>&nbsp;<span class="ident" id="6129081"><a href="/image/draw/draw.go.html#6128430">ma</a></span>&nbsp;<span class="op" id="6129084">/</span>&nbsp;<span class="ident" id="6129086"><a href="/image/draw/draw.go.html#6113420">m</a></span><span class="op" id="6129087">)</span><span class="op" id="6129088">)</span>&nbsp;<span class="op" id="6129090">*</span>&nbsp;<span class="num" id="6129092">0x101</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129103"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129106">.</span><span class="ident" id="6129107">Pix</span><span class="op" id="6129110">[</span><span class="ident" id="6129111"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129112">+</span><span class="num" id="6129113">0</span><span class="op" id="6129114">]</span>&nbsp;<span class="op" id="6129116">=</span>&nbsp;<span class="builtintype" id="6129118">uint8</span><span class="op" id="6129123">(</span><span class="op" id="6129124">(</span><span class="ident" id="6129125"><a href="/image/draw/draw.go.html#6128578">dr</a></span><span class="op" id="6129127">*</span><span class="ident" id="6129128"><a href="/image/draw/draw.go.html#6129065">a</a></span>&nbsp;<span class="op" id="6129130">+</span>&nbsp;<span class="ident" id="6129132"><a href="/image/draw/draw.go.html#6128515">sr</a></span><span class="op" id="6129134">*</span><span class="ident" id="6129135"><a href="/image/draw/draw.go.html#6128430">ma</a></span><span class="op" id="6129137">)</span>&nbsp;<span class="op" id="6129139">/</span>&nbsp;<span class="ident" id="6129141"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129143">&gt;&gt;</span>&nbsp;<span class="num" id="6129146">8</span><span class="op" id="6129147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129153"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129156">.</span><span class="ident" id="6129157">Pix</span><span class="op" id="6129160">[</span><span class="ident" id="6129161"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129162">+</span><span class="num" id="6129163">1</span><span class="op" id="6129164">]</span>&nbsp;<span class="op" id="6129166">=</span>&nbsp;<span class="builtintype" id="6129168">uint8</span><span class="op" id="6129173">(</span><span class="op" id="6129174">(</span><span class="ident" id="6129175"><a href="/image/draw/draw.go.html#6128609">dg</a></span><span class="op" id="6129177">*</span><span class="ident" id="6129178"><a href="/image/draw/draw.go.html#6129065">a</a></span>&nbsp;<span class="op" id="6129180">+</span>&nbsp;<span class="ident" id="6129182"><a href="/image/draw/draw.go.html#6128519">sg</a></span><span class="op" id="6129184">*</span><span class="ident" id="6129185"><a href="/image/draw/draw.go.html#6128430">ma</a></span><span class="op" id="6129187">)</span>&nbsp;<span class="op" id="6129189">/</span>&nbsp;<span class="ident" id="6129191"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129193">&gt;&gt;</span>&nbsp;<span class="num" id="6129196">8</span><span class="op" id="6129197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129203"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129206">.</span><span class="ident" id="6129207">Pix</span><span class="op" id="6129210">[</span><span class="ident" id="6129211"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129212">+</span><span class="num" id="6129213">2</span><span class="op" id="6129214">]</span>&nbsp;<span class="op" id="6129216">=</span>&nbsp;<span class="builtintype" id="6129218">uint8</span><span class="op" id="6129223">(</span><span class="op" id="6129224">(</span><span class="ident" id="6129225"><a href="/image/draw/draw.go.html#6128640">db</a></span><span class="op" id="6129227">*</span><span class="ident" id="6129228"><a href="/image/draw/draw.go.html#6129065">a</a></span>&nbsp;<span class="op" id="6129230">+</span>&nbsp;<span class="ident" id="6129232"><a href="/image/draw/draw.go.html#6128523">sb</a></span><span class="op" id="6129234">*</span><span class="ident" id="6129235"><a href="/image/draw/draw.go.html#6128430">ma</a></span><span class="op" id="6129237">)</span>&nbsp;<span class="op" id="6129239">/</span>&nbsp;<span class="ident" id="6129241"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129243">&gt;&gt;</span>&nbsp;<span class="num" id="6129246">8</span><span class="op" id="6129247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129253"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129256">.</span><span class="ident" id="6129257">Pix</span><span class="op" id="6129260">[</span><span class="ident" id="6129261"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129262">+</span><span class="num" id="6129263">3</span><span class="op" id="6129264">]</span>&nbsp;<span class="op" id="6129266">=</span>&nbsp;<span class="builtintype" id="6129268">uint8</span><span class="op" id="6129273">(</span><span class="op" id="6129274">(</span><span class="ident" id="6129275"><a href="/image/draw/draw.go.html#6128671">da</a></span><span class="op" id="6129277">*</span><span class="ident" id="6129278"><a href="/image/draw/draw.go.html#6129065">a</a></span>&nbsp;<span class="op" id="6129280">+</span>&nbsp;<span class="ident" id="6129282"><a href="/image/draw/draw.go.html#6128527">sa</a></span><span class="op" id="6129284">*</span><span class="ident" id="6129285"><a href="/image/draw/draw.go.html#6128430">ma</a></span><span class="op" id="6129287">)</span>&nbsp;<span class="op" id="6129289">/</span>&nbsp;<span class="ident" id="6129291"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129293">&gt;&gt;</span>&nbsp;<span class="num" id="6129296">8</span><span class="op" id="6129297">)</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129303">}</span>&nbsp;<span class="keyword" id="6129305">else</span>&nbsp;<span class="op" id="6129310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129316"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129319">.</span><span class="ident" id="6129320">Pix</span><span class="op" id="6129323">[</span><span class="ident" id="6129324"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129325">+</span><span class="num" id="6129326">0</span><span class="op" id="6129327">]</span>&nbsp;<span class="op" id="6129329">=</span>&nbsp;<span class="builtintype" id="6129331">uint8</span><span class="op" id="6129336">(</span><span class="ident" id="6129337"><a href="/image/draw/draw.go.html#6128515">sr</a></span>&nbsp;<span class="op" id="6129340">*</span>&nbsp;<span class="ident" id="6129342"><a href="/image/draw/draw.go.html#6128430">ma</a></span>&nbsp;<span class="op" id="6129345">/</span>&nbsp;<span class="ident" id="6129347"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129349">&gt;&gt;</span>&nbsp;<span class="num" id="6129352">8</span><span class="op" id="6129353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129359"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129362">.</span><span class="ident" id="6129363">Pix</span><span class="op" id="6129366">[</span><span class="ident" id="6129367"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129368">+</span><span class="num" id="6129369">1</span><span class="op" id="6129370">]</span>&nbsp;<span class="op" id="6129372">=</span>&nbsp;<span class="builtintype" id="6129374">uint8</span><span class="op" id="6129379">(</span><span class="ident" id="6129380"><a href="/image/draw/draw.go.html#6128519">sg</a></span>&nbsp;<span class="op" id="6129383">*</span>&nbsp;<span class="ident" id="6129385"><a href="/image/draw/draw.go.html#6128430">ma</a></span>&nbsp;<span class="op" id="6129388">/</span>&nbsp;<span class="ident" id="6129390"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129392">&gt;&gt;</span>&nbsp;<span class="num" id="6129395">8</span><span class="op" id="6129396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129402"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129405">.</span><span class="ident" id="6129406">Pix</span><span class="op" id="6129409">[</span><span class="ident" id="6129410"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129411">+</span><span class="num" id="6129412">2</span><span class="op" id="6129413">]</span>&nbsp;<span class="op" id="6129415">=</span>&nbsp;<span class="builtintype" id="6129417">uint8</span><span class="op" id="6129422">(</span><span class="ident" id="6129423"><a href="/image/draw/draw.go.html#6128523">sb</a></span>&nbsp;<span class="op" id="6129426">*</span>&nbsp;<span class="ident" id="6129428"><a href="/image/draw/draw.go.html#6128430">ma</a></span>&nbsp;<span class="op" id="6129431">/</span>&nbsp;<span class="ident" id="6129433"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129435">&gt;&gt;</span>&nbsp;<span class="num" id="6129438">8</span><span class="op" id="6129439">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129445"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129448">.</span><span class="ident" id="6129449">Pix</span><span class="op" id="6129452">[</span><span class="ident" id="6129453"><a href="/image/draw/draw.go.html#6128356">i</a></span><span class="op" id="6129454">+</span><span class="num" id="6129455">3</span><span class="op" id="6129456">]</span>&nbsp;<span class="op" id="6129458">=</span>&nbsp;<span class="builtintype" id="6129460">uint8</span><span class="op" id="6129465">(</span><span class="ident" id="6129466"><a href="/image/draw/draw.go.html#6128527">sa</a></span>&nbsp;<span class="op" id="6129469">*</span>&nbsp;<span class="ident" id="6129471"><a href="/image/draw/draw.go.html#6128430">ma</a></span>&nbsp;<span class="op" id="6129474">/</span>&nbsp;<span class="ident" id="6129476"><a href="/image/draw/draw.go.html#6113420">m</a></span>&nbsp;<span class="op" id="6129478">&gt;&gt;</span>&nbsp;<span class="num" id="6129481">8</span><span class="op" id="6129482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6129495"><a href="/image/draw/draw.go.html#6128252">i0</a></span>&nbsp;<span class="op" id="6129498">+=</span>&nbsp;<span class="ident" id="6129501"><a href="/image/draw/draw.go.html#6127896">dy</a></span>&nbsp;<span class="op" id="6129504">*</span>&nbsp;<span class="ident" id="6129506"><a href="/image/draw/draw.go.html#6127740">dst</a></span><span class="op" id="6129509">.</span><span class="ident" id="6129510">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129518">}</span><br>
<span class="lineno">545</span><span class="op" id="6129520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6129523">//&nbsp;clamp&nbsp;clamps&nbsp;i&nbsp;to&nbsp;the&nbsp;interval&nbsp;[0,&nbsp;0xffff].</span><br>
<span class="lineno"></span><span class="keyword" id="6129570">func</span>&nbsp;<span class="ident" id="6129575">clamp</span><span class="op" id="6129580">(</span><span class="ident" id="6129581">i</span>&nbsp;<span class="builtintype" id="6129583">int32</span><span class="op" id="6129588">)</span>&nbsp;<span class="builtintype" id="6129590">int32</span>&nbsp;<span class="op" id="6129596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129599">if</span>&nbsp;<span class="ident" id="6129602"><a href="/image/draw/draw.go.html#6129581">i</a></span>&nbsp;<span class="op" id="6129604">&lt;</span>&nbsp;<span class="num" id="6129606">0</span>&nbsp;<span class="op" id="6129608">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129612">return</span>&nbsp;<span class="num" id="6129619">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129625">if</span>&nbsp;<span class="ident" id="6129628"><a href="/image/draw/draw.go.html#6129581">i</a></span>&nbsp;<span class="op" id="6129630">&gt;</span>&nbsp;<span class="num" id="6129632">0xffff</span>&nbsp;<span class="op" id="6129639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129643">return</span>&nbsp;<span class="num" id="6129650">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6129658">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6129661">return</span>&nbsp;<span class="ident" id="6129668"><a href="/image/draw/draw.go.html#6129581">i</a></span><br>
<span class="lineno"></span><span class="op" id="6129670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6129673">func</span>&nbsp;<span class="ident" id="6129678">drawPaletted</span><span class="op" id="6129690">(</span><span class="ident" id="6129691">dst</span>&nbsp;<span class="ident" id="6129695"><a href="/image/draw/draw.go.html#6113511">Image</a></span><span class="op" id="6129700">,</span>&nbsp;<span class="ident" id="6129702">r</span>&nbsp;<span class="ident" id="6129704"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6129709">.</span><span class="ident" id="6129710">Rectangle</span><span class="op" id="6129719">,</span>&nbsp;<span class="ident" id="6129721">src</span>&nbsp;<span class="ident" id="6129725"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6129730">.</span><span class="ident" id="6129731">Image</span><span class="op" id="6129736">,</span>&nbsp;<span class="ident" id="6129738">sp</span>&nbsp;<span class="ident" id="6129741"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6129746">.</span><span class="ident" id="6129747">Point</span><span class="op" id="6129752">,</span>&nbsp;<span class="ident" id="6129754">floydSteinberg</span>&nbsp;<span class="builtintype" id="6129769">bool</span><span class="op" id="6129773">)</span>&nbsp;<span class="op" id="6129775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6129778">//&nbsp;TODO(nigeltao):&nbsp;handle&nbsp;the&nbsp;case&nbsp;where&nbsp;the&nbsp;dst&nbsp;and&nbsp;src&nbsp;overlap.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6129845">//&nbsp;Does&nbsp;it&nbsp;even&nbsp;make&nbsp;sense&nbsp;to&nbsp;try&nbsp;and&nbsp;do&nbsp;Floyd-Steinberg&nbsp;whilst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6129910">//&nbsp;walking&nbsp;the&nbsp;image&nbsp;backward&nbsp;(right-to-left&nbsp;bottom-to-top)?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6129973">//&nbsp;If&nbsp;dst&nbsp;is&nbsp;an&nbsp;*image.Paletted,&nbsp;we&nbsp;have&nbsp;a&nbsp;fast&nbsp;path&nbsp;for&nbsp;dst.Set&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130043">//&nbsp;dst.At.&nbsp;The&nbsp;dst.Set&nbsp;equivalent&nbsp;is&nbsp;a&nbsp;batch&nbsp;version&nbsp;of&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130114">//&nbsp;used&nbsp;by&nbsp;color.Palette&#39;s&nbsp;Index&nbsp;method&nbsp;in&nbsp;image/color/color.go,&nbsp;plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130185">//&nbsp;optional&nbsp;Floyd-Steinberg&nbsp;error&nbsp;diffusion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130231">palette</span><span class="op" id="6130238">,</span>&nbsp;<span class="ident" id="6130240">pix</span><span class="op" id="6130243">,</span>&nbsp;<span class="ident" id="6130245">stride</span>&nbsp;<span class="op" id="6130252">:=</span>&nbsp;<span class="op" id="6130255">[</span><span class="op" id="6130256">]</span><span class="op" id="6130257">[</span><span class="num" id="6130258">3</span><span class="op" id="6130259">]</span><span class="builtintype" id="6130260">int32</span><span class="op" id="6130265">(</span><span class="ident" id="6130266">nil</span><span class="op" id="6130269">)</span><span class="op" id="6130270">,</span>&nbsp;<span class="op" id="6130272">[</span><span class="op" id="6130273">]</span><span class="builtintype" id="6130274">byte</span><span class="op" id="6130278">(</span><span class="ident" id="6130279">nil</span><span class="op" id="6130282">)</span><span class="op" id="6130283">,</span>&nbsp;<span class="num" id="6130285">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130288">if</span>&nbsp;<span class="ident" id="6130291">p</span><span class="op" id="6130292">,</span>&nbsp;<span class="ident" id="6130294">ok</span>&nbsp;<span class="op" id="6130297">:=</span>&nbsp;<span class="ident" id="6130300"><a href="/image/draw/draw.go.html#6129691">dst</a></span><span class="op" id="6130303">.</span><span class="op" id="6130304">(</span><span class="op" id="6130305">*</span><span class="ident" id="6130306"><a href="/image/draw/draw.go.html#6113326">image</a></span><span class="op" id="6130311">.</span><span class="ident" id="6130312">Paletted</span><span class="op" id="6130320">)</span><span class="op" id="6130321">;</span>&nbsp;<span class="ident" id="6130323"><a href="/image/draw/draw.go.html#6130294">ok</a></span>&nbsp;<span class="op" id="6130326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130330"><a href="/image/draw/draw.go.html#6130231">palette</a></span>&nbsp;<span class="op" id="6130338">=</span>&nbsp;<span class="builtinfunc" id="6130340">make</span><span class="op" id="6130344">(</span><span class="op" id="6130345">[</span><span class="op" id="6130346">]</span><span class="op" id="6130347">[</span><span class="num" id="6130348">3</span><span class="op" id="6130349">]</span><span class="builtintype" id="6130350">int32</span><span class="op" id="6130355">,</span>&nbsp;<span class="builtinfunc" id="6130357">len</span><span class="op" id="6130360">(</span><span class="ident" id="6130361"><a href="/image/draw/draw.go.html#6130291">p</a></span><span class="op" id="6130362">.</span><span class="ident" id="6130363">Palette</span><span class="op" id="6130370">)</span><span class="op" id="6130371">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130375">for</span>&nbsp;<span class="ident" id="6130379">i</span><span class="op" id="6130380">,</span>&nbsp;<span class="ident" id="6130382">col</span>&nbsp;<span class="op" id="6130386">:=</span>&nbsp;<span class="keyword" id="6130389">range</span>&nbsp;<span class="ident" id="6130395"><a href="/image/draw/draw.go.html#6130291">p</a></span><span class="op" id="6130396">.</span><span class="ident" id="6130397">Palette</span>&nbsp;<span class="op" id="6130405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130410">r</span><span class="op" id="6130411">,</span>&nbsp;<span class="ident" id="6130413">g</span><span class="op" id="6130414">,</span>&nbsp;<span class="ident" id="6130416">b</span><span class="op" id="6130417">,</span>&nbsp;<span class="ident" id="6130419">_</span>&nbsp;<span class="op" id="6130421">:=</span>&nbsp;<span class="ident" id="6130424"><a href="/image/draw/draw.go.html#6130382">col</a></span><span class="op" id="6130427">.</span><span class="ident" id="6130428">RGBA</span><span class="op" id="6130432">(</span><span class="op" id="6130433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130438"><a href="/image/draw/draw.go.html#6130231">palette</a></span><span class="op" id="6130445">[</span><span class="ident" id="6130446"><a href="/image/draw/draw.go.html#6130379">i</a></span><span class="op" id="6130447">]</span><span class="op" id="6130448">[</span><span class="num" id="6130449">0</span><span class="op" id="6130450">]</span>&nbsp;<span class="op" id="6130452">=</span>&nbsp;<span class="builtintype" id="6130454">int32</span><span class="op" id="6130459">(</span><span class="ident" id="6130460"><a href="/image/draw/draw.go.html#6130410">r</a></span><span class="op" id="6130461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130466"><a href="/image/draw/draw.go.html#6130231">palette</a></span><span class="op" id="6130473">[</span><span class="ident" id="6130474"><a href="/image/draw/draw.go.html#6130379">i</a></span><span class="op" id="6130475">]</span><span class="op" id="6130476">[</span><span class="num" id="6130477">1</span><span class="op" id="6130478">]</span>&nbsp;<span class="op" id="6130480">=</span>&nbsp;<span class="builtintype" id="6130482">int32</span><span class="op" id="6130487">(</span><span class="ident" id="6130488"><a href="/image/draw/draw.go.html#6130413">g</a></span><span class="op" id="6130489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130494"><a href="/image/draw/draw.go.html#6130231">palette</a></span><span class="op" id="6130501">[</span><span class="ident" id="6130502"><a href="/image/draw/draw.go.html#6130379">i</a></span><span class="op" id="6130503">]</span><span class="op" id="6130504">[</span><span class="num" id="6130505">2</span><span class="op" id="6130506">]</span>&nbsp;<span class="op" id="6130508">=</span>&nbsp;<span class="builtintype" id="6130510">int32</span><span class="op" id="6130515">(</span><span class="ident" id="6130516"><a href="/image/draw/draw.go.html#6130416">b</a></span><span class="op" id="6130517">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6130521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130525"><a href="/image/draw/draw.go.html#6130240">pix</a></span><span class="op" id="6130528">,</span>&nbsp;<span class="ident" id="6130530"><a href="/image/draw/draw.go.html#6130245">stride</a></span>&nbsp;<span class="op" id="6130537">=</span>&nbsp;<span class="ident" id="6130539"><a href="/image/draw/draw.go.html#6130291">p</a></span><span class="op" id="6130540">.</span><span class="ident" id="6130541">Pix</span><span class="op" id="6130544">[</span><span class="ident" id="6130545"><a href="/image/draw/draw.go.html#6130291">p</a></span><span class="op" id="6130546">.</span><span class="ident" id="6130547">PixOffset</span><span class="op" id="6130556">(</span><span class="ident" id="6130557"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6130558">.</span><span class="ident" id="6130559">Min</span><span class="op" id="6130562">.</span><span class="ident" id="6130563">X</span><span class="op" id="6130564">,</span>&nbsp;<span class="ident" id="6130566"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6130567">.</span><span class="ident" id="6130568">Min</span><span class="op" id="6130571">.</span><span class="ident" id="6130572">Y</span><span class="op" id="6130573">)</span><span class="op" id="6130574">:</span><span class="op" id="6130575">]</span><span class="op" id="6130576">,</span>&nbsp;<span class="ident" id="6130578"><a href="/image/draw/draw.go.html#6130291">p</a></span><span class="op" id="6130579">.</span><span class="ident" id="6130580">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6130588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130592">//&nbsp;quantErrorCurr&nbsp;and&nbsp;quantErrorNext&nbsp;are&nbsp;the&nbsp;Floyd-Steinberg&nbsp;quantization</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130667">//&nbsp;errors&nbsp;that&nbsp;have&nbsp;been&nbsp;propagated&nbsp;to&nbsp;the&nbsp;pixels&nbsp;in&nbsp;the&nbsp;current&nbsp;and&nbsp;next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130742">//&nbsp;rows.&nbsp;The&nbsp;+2&nbsp;simplifies&nbsp;calculation&nbsp;near&nbsp;the&nbsp;edges.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130798">var</span>&nbsp;<span class="ident" id="6130802">quantErrorCurr</span><span class="op" id="6130816">,</span>&nbsp;<span class="ident" id="6130818">quantErrorNext</span>&nbsp;<span class="op" id="6130833">[</span><span class="op" id="6130834">]</span><span class="op" id="6130835">[</span><span class="num" id="6130836">3</span><span class="op" id="6130837">]</span><span class="builtintype" id="6130838">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6130845">if</span>&nbsp;<span class="ident" id="6130848"><a href="/image/draw/draw.go.html#6129754">floydSteinberg</a></span>&nbsp;<span class="op" id="6130863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130867"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span>&nbsp;<span class="op" id="6130882">=</span>&nbsp;<span class="builtinfunc" id="6130884">make</span><span class="op" id="6130888">(</span><span class="op" id="6130889">[</span><span class="op" id="6130890">]</span><span class="op" id="6130891">[</span><span class="num" id="6130892">3</span><span class="op" id="6130893">]</span><span class="builtintype" id="6130894">int32</span><span class="op" id="6130899">,</span>&nbsp;<span class="ident" id="6130901"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6130902">.</span><span class="ident" id="6130903">Dx</span><span class="op" id="6130905">(</span><span class="op" id="6130906">)</span><span class="op" id="6130907">+</span><span class="num" id="6130908">2</span><span class="op" id="6130909">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130913"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span>&nbsp;<span class="op" id="6130928">=</span>&nbsp;<span class="builtinfunc" id="6130930">make</span><span class="op" id="6130934">(</span><span class="op" id="6130935">[</span><span class="op" id="6130936">]</span><span class="op" id="6130937">[</span><span class="num" id="6130938">3</span><span class="op" id="6130939">]</span><span class="builtintype" id="6130940">int32</span><span class="op" id="6130945">,</span>&nbsp;<span class="ident" id="6130947"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6130948">.</span><span class="ident" id="6130949">Dx</span><span class="op" id="6130951">(</span><span class="op" id="6130952">)</span><span class="op" id="6130953">+</span><span class="num" id="6130954">2</span><span class="op" id="6130955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6130958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6130962">//&nbsp;Loop&nbsp;over&nbsp;each&nbsp;source&nbsp;pixel.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6130995">out</span>&nbsp;<span class="op" id="6130999">:=</span>&nbsp;<span class="ident" id="6131002"><a href="/image/draw/draw.go.html#6113335">color</a></span><span class="op" id="6131007">.</span><span class="ident" id="6131008">RGBA64</span><span class="op" id="6131014">{</span><span class="ident" id="6131015">A</span><span class="op" id="6131016">:</span>&nbsp;<span class="num" id="6131018">0xffff</span><span class="op" id="6131024">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131027">for</span>&nbsp;<span class="ident" id="6131031">y</span>&nbsp;<span class="op" id="6131033">:=</span>&nbsp;<span class="num" id="6131036">0</span><span class="op" id="6131037">;</span>&nbsp;<span class="ident" id="6131039"><a href="/image/draw/draw.go.html#6131031">y</a></span>&nbsp;<span class="op" id="6131041">!=</span>&nbsp;<span class="ident" id="6131044"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6131045">.</span><span class="ident" id="6131046">Dy</span><span class="op" id="6131048">(</span><span class="op" id="6131049">)</span><span class="op" id="6131050">;</span>&nbsp;<span class="ident" id="6131052"><a href="/image/draw/draw.go.html#6131031">y</a></span><span class="op" id="6131053">++</span>&nbsp;<span class="op" id="6131056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131060">for</span>&nbsp;<span class="ident" id="6131064">x</span>&nbsp;<span class="op" id="6131066">:=</span>&nbsp;<span class="num" id="6131069">0</span><span class="op" id="6131070">;</span>&nbsp;<span class="ident" id="6131072"><a href="/image/draw/draw.go.html#6131064">x</a></span>&nbsp;<span class="op" id="6131074">!=</span>&nbsp;<span class="ident" id="6131077"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6131078">.</span><span class="ident" id="6131079">Dx</span><span class="op" id="6131081">(</span><span class="op" id="6131082">)</span><span class="op" id="6131083">;</span>&nbsp;<span class="ident" id="6131085"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6131086">++</span>&nbsp;<span class="op" id="6131089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131094">//&nbsp;er,&nbsp;eg&nbsp;and&nbsp;eb&nbsp;are&nbsp;the&nbsp;pixel&#39;s&nbsp;R,G,B&nbsp;values&nbsp;plus&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131152">//&nbsp;optional&nbsp;Floyd-Steinberg&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131190">sr</span><span class="op" id="6131192">,</span>&nbsp;<span class="ident" id="6131194">sg</span><span class="op" id="6131196">,</span>&nbsp;<span class="ident" id="6131198">sb</span><span class="op" id="6131200">,</span>&nbsp;<span class="ident" id="6131202">_</span>&nbsp;<span class="op" id="6131204">:=</span>&nbsp;<span class="ident" id="6131207"><a href="/image/draw/draw.go.html#6129721">src</a></span><span class="op" id="6131210">.</span><span class="ident" id="6131211">At</span><span class="op" id="6131213">(</span><span class="ident" id="6131214"><a href="/image/draw/draw.go.html#6129738">sp</a></span><span class="op" id="6131216">.</span><span class="ident" id="6131217">X</span><span class="op" id="6131218">+</span><span class="ident" id="6131219"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6131220">,</span>&nbsp;<span class="ident" id="6131222"><a href="/image/draw/draw.go.html#6129738">sp</a></span><span class="op" id="6131224">.</span><span class="ident" id="6131225">Y</span><span class="op" id="6131226">+</span><span class="ident" id="6131227"><a href="/image/draw/draw.go.html#6131031">y</a></span><span class="op" id="6131228">)</span><span class="op" id="6131229">.</span><span class="ident" id="6131230">RGBA</span><span class="op" id="6131234">(</span><span class="op" id="6131235">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131240">er</span><span class="op" id="6131242">,</span>&nbsp;<span class="ident" id="6131244">eg</span><span class="op" id="6131246">,</span>&nbsp;<span class="ident" id="6131248">eb</span>&nbsp;<span class="op" id="6131251">:=</span>&nbsp;<span class="builtintype" id="6131254">int32</span><span class="op" id="6131259">(</span><span class="ident" id="6131260"><a href="/image/draw/draw.go.html#6131190">sr</a></span><span class="op" id="6131262">)</span><span class="op" id="6131263">,</span>&nbsp;<span class="builtintype" id="6131265">int32</span><span class="op" id="6131270">(</span><span class="ident" id="6131271"><a href="/image/draw/draw.go.html#6131194">sg</a></span><span class="op" id="6131273">)</span><span class="op" id="6131274">,</span>&nbsp;<span class="builtintype" id="6131276">int32</span><span class="op" id="6131281">(</span><span class="ident" id="6131282"><a href="/image/draw/draw.go.html#6131198">sb</a></span><span class="op" id="6131284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131289">if</span>&nbsp;<span class="ident" id="6131292"><a href="/image/draw/draw.go.html#6129754">floydSteinberg</a></span>&nbsp;<span class="op" id="6131307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131313"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6131316">=</span>&nbsp;<span class="ident" id="6131318"><a href="/image/draw/draw.go.html#6129575">clamp</a></span><span class="op" id="6131323">(</span><span class="ident" id="6131324"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6131327">+</span>&nbsp;<span class="ident" id="6131329"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6131343">[</span><span class="ident" id="6131344"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6131345">+</span><span class="num" id="6131346">1</span><span class="op" id="6131347">]</span><span class="op" id="6131348">[</span><span class="num" id="6131349">0</span><span class="op" id="6131350">]</span><span class="op" id="6131351">/</span><span class="num" id="6131352">16</span><span class="op" id="6131354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131360"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6131363">=</span>&nbsp;<span class="ident" id="6131365"><a href="/image/draw/draw.go.html#6129575">clamp</a></span><span class="op" id="6131370">(</span><span class="ident" id="6131371"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6131374">+</span>&nbsp;<span class="ident" id="6131376"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6131390">[</span><span class="ident" id="6131391"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6131392">+</span><span class="num" id="6131393">1</span><span class="op" id="6131394">]</span><span class="op" id="6131395">[</span><span class="num" id="6131396">1</span><span class="op" id="6131397">]</span><span class="op" id="6131398">/</span><span class="num" id="6131399">16</span><span class="op" id="6131401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131407"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6131410">=</span>&nbsp;<span class="ident" id="6131412"><a href="/image/draw/draw.go.html#6129575">clamp</a></span><span class="op" id="6131417">(</span><span class="ident" id="6131418"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6131421">+</span>&nbsp;<span class="ident" id="6131423"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6131437">[</span><span class="ident" id="6131438"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6131439">+</span><span class="num" id="6131440">1</span><span class="op" id="6131441">]</span><span class="op" id="6131442">[</span><span class="num" id="6131443">2</span><span class="op" id="6131444">]</span><span class="op" id="6131445">/</span><span class="num" id="6131446">16</span><span class="op" id="6131448">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6131453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131459">if</span>&nbsp;<span class="ident" id="6131462"><a href="/image/draw/draw.go.html#6130231">palette</a></span>&nbsp;<span class="op" id="6131470">!=</span>&nbsp;<span class="ident" id="6131473">nil</span>&nbsp;<span class="op" id="6131477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131483">//&nbsp;Find&nbsp;the&nbsp;closest&nbsp;palette&nbsp;color&nbsp;in&nbsp;Euclidean&nbsp;R,G,B&nbsp;space:&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131551">//&nbsp;one&nbsp;that&nbsp;minimizes&nbsp;sum-squared-difference.&nbsp;We&nbsp;shift&nbsp;by&nbsp;1&nbsp;bit</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131619">//&nbsp;to&nbsp;avoid&nbsp;potential&nbsp;uint32&nbsp;overflow&nbsp;in&nbsp;sum-squared-difference.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6131688">//&nbsp;TODO(nigeltao):&nbsp;consider&nbsp;smarter&nbsp;algorithms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131740">bestIndex</span><span class="op" id="6131749">,</span>&nbsp;<span class="ident" id="6131751">bestSSD</span>&nbsp;<span class="op" id="6131759">:=</span>&nbsp;<span class="num" id="6131762">0</span><span class="op" id="6131763">,</span>&nbsp;<span class="builtintype" id="6131765">uint32</span><span class="op" id="6131771">(</span><span class="num" id="6131772">1</span><span class="op" id="6131773">&lt;&lt;</span><span class="num" id="6131775">32</span><span class="op" id="6131777">-</span><span class="num" id="6131778">1</span><span class="op" id="6131779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6131785">for</span>&nbsp;<span class="ident" id="6131789">index</span><span class="op" id="6131794">,</span>&nbsp;<span class="ident" id="6131796">p</span>&nbsp;<span class="op" id="6131798">:=</span>&nbsp;<span class="keyword" id="6131801">range</span>&nbsp;<span class="ident" id="6131807"><a href="/image/draw/draw.go.html#6130231">palette</a></span>&nbsp;<span class="op" id="6131815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131822">delta</span>&nbsp;<span class="op" id="6131828">:=</span>&nbsp;<span class="op" id="6131831">(</span><span class="ident" id="6131832"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6131835">-</span>&nbsp;<span class="ident" id="6131837"><a href="/image/draw/draw.go.html#6131796">p</a></span><span class="op" id="6131838">[</span><span class="num" id="6131839">0</span><span class="op" id="6131840">]</span><span class="op" id="6131841">)</span>&nbsp;<span class="op" id="6131843">&gt;&gt;</span>&nbsp;<span class="num" id="6131846">1</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131853">ssd</span>&nbsp;<span class="op" id="6131857">:=</span>&nbsp;<span class="builtintype" id="6131860">uint32</span><span class="op" id="6131866">(</span><span class="ident" id="6131867"><a href="/image/draw/draw.go.html#6131822">delta</a></span>&nbsp;<span class="op" id="6131873">*</span>&nbsp;<span class="ident" id="6131875"><a href="/image/draw/draw.go.html#6131822">delta</a></span><span class="op" id="6131880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131887"><a href="/image/draw/draw.go.html#6131822">delta</a></span>&nbsp;<span class="op" id="6131893">=</span>&nbsp;<span class="op" id="6131895">(</span><span class="ident" id="6131896"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6131899">-</span>&nbsp;<span class="ident" id="6131901"><a href="/image/draw/draw.go.html#6131796">p</a></span><span class="op" id="6131902">[</span><span class="num" id="6131903">1</span><span class="op" id="6131904">]</span><span class="op" id="6131905">)</span>&nbsp;<span class="op" id="6131907">&gt;&gt;</span>&nbsp;<span class="num" id="6131910">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131917"><a href="/image/draw/draw.go.html#6131853">ssd</a></span>&nbsp;<span class="op" id="6131921">+=</span>&nbsp;<span class="builtintype" id="6131924">uint32</span><span class="op" id="6131930">(</span><span class="ident" id="6131931"><a href="/image/draw/draw.go.html#6131822">delta</a></span>&nbsp;<span class="op" id="6131937">*</span>&nbsp;<span class="ident" id="6131939"><a href="/image/draw/draw.go.html#6131822">delta</a></span><span class="op" id="6131944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131951"><a href="/image/draw/draw.go.html#6131822">delta</a></span>&nbsp;<span class="op" id="6131957">=</span>&nbsp;<span class="op" id="6131959">(</span><span class="ident" id="6131960"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6131963">-</span>&nbsp;<span class="ident" id="6131965"><a href="/image/draw/draw.go.html#6131796">p</a></span><span class="op" id="6131966">[</span><span class="num" id="6131967">2</span><span class="op" id="6131968">]</span><span class="op" id="6131969">)</span>&nbsp;<span class="op" id="6131971">&gt;&gt;</span>&nbsp;<span class="num" id="6131974">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6131981"><a href="/image/draw/draw.go.html#6131853">ssd</a></span>&nbsp;<span class="op" id="6131985">+=</span>&nbsp;<span class="builtintype" id="6131988">uint32</span><span class="op" id="6131994">(</span><span class="ident" id="6131995"><a href="/image/draw/draw.go.html#6131822">delta</a></span>&nbsp;<span class="op" id="6132001">*</span>&nbsp;<span class="ident" id="6132003"><a href="/image/draw/draw.go.html#6131822">delta</a></span><span class="op" id="6132008">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132015">if</span>&nbsp;<span class="ident" id="6132018"><a href="/image/draw/draw.go.html#6131853">ssd</a></span>&nbsp;<span class="op" id="6132022">&lt;</span>&nbsp;<span class="ident" id="6132024"><a href="/image/draw/draw.go.html#6131751">bestSSD</a></span>&nbsp;<span class="op" id="6132032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132040"><a href="/image/draw/draw.go.html#6131740">bestIndex</a></span><span class="op" id="6132049">,</span>&nbsp;<span class="ident" id="6132051"><a href="/image/draw/draw.go.html#6131751">bestSSD</a></span>&nbsp;<span class="op" id="6132059">=</span>&nbsp;<span class="ident" id="6132061"><a href="/image/draw/draw.go.html#6131789">index</a></span><span class="op" id="6132066">,</span>&nbsp;<span class="ident" id="6132068"><a href="/image/draw/draw.go.html#6131853">ssd</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132078">if</span>&nbsp;<span class="ident" id="6132081"><a href="/image/draw/draw.go.html#6131853">ssd</a></span>&nbsp;<span class="op" id="6132085">==</span>&nbsp;<span class="num" id="6132088">0</span>&nbsp;<span class="op" id="6132090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132099">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132111">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132130"><a href="/image/draw/draw.go.html#6130240">pix</a></span><span class="op" id="6132133">[</span><span class="ident" id="6132134"><a href="/image/draw/draw.go.html#6131031">y</a></span><span class="op" id="6132135">*</span><span class="ident" id="6132136"><a href="/image/draw/draw.go.html#6130245">stride</a></span><span class="op" id="6132142">+</span><span class="ident" id="6132143"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6132144">]</span>&nbsp;<span class="op" id="6132146">=</span>&nbsp;<span class="builtintype" id="6132148">byte</span><span class="op" id="6132152">(</span><span class="ident" id="6132153"><a href="/image/draw/draw.go.html#6131740">bestIndex</a></span><span class="op" id="6132162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132169">if</span>&nbsp;<span class="op" id="6132172">!</span><span class="ident" id="6132173"><a href="/image/draw/draw.go.html#6129754">floydSteinberg</a></span>&nbsp;<span class="op" id="6132188">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132195">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132214"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6132217">-=</span>&nbsp;<span class="builtintype" id="6132220">int32</span><span class="op" id="6132225">(</span><span class="ident" id="6132226"><a href="/image/draw/draw.go.html#6130231">palette</a></span><span class="op" id="6132233">[</span><span class="ident" id="6132234"><a href="/image/draw/draw.go.html#6131740">bestIndex</a></span><span class="op" id="6132243">]</span><span class="op" id="6132244">[</span><span class="num" id="6132245">0</span><span class="op" id="6132246">]</span><span class="op" id="6132247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132253"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6132256">-=</span>&nbsp;<span class="builtintype" id="6132259">int32</span><span class="op" id="6132264">(</span><span class="ident" id="6132265"><a href="/image/draw/draw.go.html#6130231">palette</a></span><span class="op" id="6132272">[</span><span class="ident" id="6132273"><a href="/image/draw/draw.go.html#6131740">bestIndex</a></span><span class="op" id="6132282">]</span><span class="op" id="6132283">[</span><span class="num" id="6132284">1</span><span class="op" id="6132285">]</span><span class="op" id="6132286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132292"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6132295">-=</span>&nbsp;<span class="builtintype" id="6132298">int32</span><span class="op" id="6132303">(</span><span class="ident" id="6132304"><a href="/image/draw/draw.go.html#6130231">palette</a></span><span class="op" id="6132311">[</span><span class="ident" id="6132312"><a href="/image/draw/draw.go.html#6131740">bestIndex</a></span><span class="op" id="6132321">]</span><span class="op" id="6132322">[</span><span class="num" id="6132323">2</span><span class="op" id="6132324">]</span><span class="op" id="6132325">)</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132331">}</span>&nbsp;<span class="keyword" id="6132333">else</span>&nbsp;<span class="op" id="6132338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132344"><a href="/image/draw/draw.go.html#6130995">out</a></span><span class="op" id="6132347">.</span><span class="ident" id="6132348">R</span>&nbsp;<span class="op" id="6132350">=</span>&nbsp;<span class="builtintype" id="6132352">uint16</span><span class="op" id="6132358">(</span><span class="ident" id="6132359"><a href="/image/draw/draw.go.html#6131240">er</a></span><span class="op" id="6132361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132367"><a href="/image/draw/draw.go.html#6130995">out</a></span><span class="op" id="6132370">.</span><span class="ident" id="6132371">G</span>&nbsp;<span class="op" id="6132373">=</span>&nbsp;<span class="builtintype" id="6132375">uint16</span><span class="op" id="6132381">(</span><span class="ident" id="6132382"><a href="/image/draw/draw.go.html#6131244">eg</a></span><span class="op" id="6132384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132390"><a href="/image/draw/draw.go.html#6130995">out</a></span><span class="op" id="6132393">.</span><span class="ident" id="6132394">B</span>&nbsp;<span class="op" id="6132396">=</span>&nbsp;<span class="builtintype" id="6132398">uint16</span><span class="op" id="6132404">(</span><span class="ident" id="6132405"><a href="/image/draw/draw.go.html#6131248">eb</a></span><span class="op" id="6132407">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132413">//&nbsp;The&nbsp;third&nbsp;argument&nbsp;is&nbsp;&amp;out&nbsp;instead&nbsp;of&nbsp;out&nbsp;(and&nbsp;out&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132474">//&nbsp;declared&nbsp;outside&nbsp;of&nbsp;the&nbsp;inner&nbsp;loop)&nbsp;to&nbsp;avoid&nbsp;the&nbsp;implicit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132539">//&nbsp;conversion&nbsp;to&nbsp;color.Color&nbsp;here&nbsp;allocating&nbsp;memory&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132602">//&nbsp;inner&nbsp;loop&nbsp;if&nbsp;sizeof(color.RGBA64)&nbsp;&gt;&nbsp;sizeof(uintptr).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132663"><a href="/image/draw/draw.go.html#6129691">dst</a></span><span class="op" id="6132666">.</span><span class="ident" id="6132667">Set</span><span class="op" id="6132670">(</span><span class="ident" id="6132671"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6132672">.</span><span class="ident" id="6132673">Min</span><span class="op" id="6132676">.</span><span class="ident" id="6132677">X</span><span class="op" id="6132678">+</span><span class="ident" id="6132679"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6132680">,</span>&nbsp;<span class="ident" id="6132682"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6132683">.</span><span class="ident" id="6132684">Min</span><span class="op" id="6132687">.</span><span class="ident" id="6132688">Y</span><span class="op" id="6132689">+</span><span class="ident" id="6132690"><a href="/image/draw/draw.go.html#6131031">y</a></span><span class="op" id="6132691">,</span>&nbsp;<span class="op" id="6132693">&amp;</span><span class="ident" id="6132694"><a href="/image/draw/draw.go.html#6130995">out</a></span><span class="op" id="6132697">)</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132704">if</span>&nbsp;<span class="op" id="6132707">!</span><span class="ident" id="6132708"><a href="/image/draw/draw.go.html#6129754">floydSteinberg</a></span>&nbsp;<span class="op" id="6132723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6132730">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132749"><a href="/image/draw/draw.go.html#6131190">sr</a></span><span class="op" id="6132751">,</span>&nbsp;<span class="ident" id="6132753"><a href="/image/draw/draw.go.html#6131194">sg</a></span><span class="op" id="6132755">,</span>&nbsp;<span class="ident" id="6132757"><a href="/image/draw/draw.go.html#6131198">sb</a></span><span class="op" id="6132759">,</span>&nbsp;<span class="ident" id="6132761">_</span>&nbsp;<span class="op" id="6132763">=</span>&nbsp;<span class="ident" id="6132765"><a href="/image/draw/draw.go.html#6129691">dst</a></span><span class="op" id="6132768">.</span><span class="ident" id="6132769">At</span><span class="op" id="6132771">(</span><span class="ident" id="6132772"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6132773">.</span><span class="ident" id="6132774">Min</span><span class="op" id="6132777">.</span><span class="ident" id="6132778">X</span><span class="op" id="6132779">+</span><span class="ident" id="6132780"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6132781">,</span>&nbsp;<span class="ident" id="6132783"><a href="/image/draw/draw.go.html#6129702">r</a></span><span class="op" id="6132784">.</span><span class="ident" id="6132785">Min</span><span class="op" id="6132788">.</span><span class="ident" id="6132789">Y</span><span class="op" id="6132790">+</span><span class="ident" id="6132791"><a href="/image/draw/draw.go.html#6131031">y</a></span><span class="op" id="6132792">)</span><span class="op" id="6132793">.</span><span class="ident" id="6132794">RGBA</span><span class="op" id="6132798">(</span><span class="op" id="6132799">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132805"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6132808">-=</span>&nbsp;<span class="builtintype" id="6132811">int32</span><span class="op" id="6132816">(</span><span class="ident" id="6132817"><a href="/image/draw/draw.go.html#6131190">sr</a></span><span class="op" id="6132819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132825"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6132828">-=</span>&nbsp;<span class="builtintype" id="6132831">int32</span><span class="op" id="6132836">(</span><span class="ident" id="6132837"><a href="/image/draw/draw.go.html#6131194">sg</a></span><span class="op" id="6132839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132845"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6132848">-=</span>&nbsp;<span class="builtintype" id="6132851">int32</span><span class="op" id="6132856">(</span><span class="ident" id="6132857"><a href="/image/draw/draw.go.html#6131198">sb</a></span><span class="op" id="6132859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6132864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6132870">//&nbsp;Propagate&nbsp;the&nbsp;Floyd-Steinberg&nbsp;quantization&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132926"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6132940">[</span><span class="ident" id="6132941"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6132942">+</span><span class="num" id="6132943">0</span><span class="op" id="6132944">]</span><span class="op" id="6132945">[</span><span class="num" id="6132946">0</span><span class="op" id="6132947">]</span>&nbsp;<span class="op" id="6132949">+=</span>&nbsp;<span class="ident" id="6132952"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6132955">*</span>&nbsp;<span class="num" id="6132957">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132962"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6132976">[</span><span class="ident" id="6132977"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6132978">+</span><span class="num" id="6132979">0</span><span class="op" id="6132980">]</span><span class="op" id="6132981">[</span><span class="num" id="6132982">1</span><span class="op" id="6132983">]</span>&nbsp;<span class="op" id="6132985">+=</span>&nbsp;<span class="ident" id="6132988"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6132991">*</span>&nbsp;<span class="num" id="6132993">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132998"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133012">[</span><span class="ident" id="6133013"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133014">+</span><span class="num" id="6133015">0</span><span class="op" id="6133016">]</span><span class="op" id="6133017">[</span><span class="num" id="6133018">2</span><span class="op" id="6133019">]</span>&nbsp;<span class="op" id="6133021">+=</span>&nbsp;<span class="ident" id="6133024"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6133027">*</span>&nbsp;<span class="num" id="6133029">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133034"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133048">[</span><span class="ident" id="6133049"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133050">+</span><span class="num" id="6133051">1</span><span class="op" id="6133052">]</span><span class="op" id="6133053">[</span><span class="num" id="6133054">0</span><span class="op" id="6133055">]</span>&nbsp;<span class="op" id="6133057">+=</span>&nbsp;<span class="ident" id="6133060"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6133063">*</span>&nbsp;<span class="num" id="6133065">5</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133070"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133084">[</span><span class="ident" id="6133085"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133086">+</span><span class="num" id="6133087">1</span><span class="op" id="6133088">]</span><span class="op" id="6133089">[</span><span class="num" id="6133090">1</span><span class="op" id="6133091">]</span>&nbsp;<span class="op" id="6133093">+=</span>&nbsp;<span class="ident" id="6133096"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6133099">*</span>&nbsp;<span class="num" id="6133101">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133106"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133120">[</span><span class="ident" id="6133121"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133122">+</span><span class="num" id="6133123">1</span><span class="op" id="6133124">]</span><span class="op" id="6133125">[</span><span class="num" id="6133126">2</span><span class="op" id="6133127">]</span>&nbsp;<span class="op" id="6133129">+=</span>&nbsp;<span class="ident" id="6133132"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6133135">*</span>&nbsp;<span class="num" id="6133137">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133142"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133156">[</span><span class="ident" id="6133157"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133158">+</span><span class="num" id="6133159">2</span><span class="op" id="6133160">]</span><span class="op" id="6133161">[</span><span class="num" id="6133162">0</span><span class="op" id="6133163">]</span>&nbsp;<span class="op" id="6133165">+=</span>&nbsp;<span class="ident" id="6133168"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6133171">*</span>&nbsp;<span class="num" id="6133173">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133178"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133192">[</span><span class="ident" id="6133193"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133194">+</span><span class="num" id="6133195">2</span><span class="op" id="6133196">]</span><span class="op" id="6133197">[</span><span class="num" id="6133198">1</span><span class="op" id="6133199">]</span>&nbsp;<span class="op" id="6133201">+=</span>&nbsp;<span class="ident" id="6133204"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6133207">*</span>&nbsp;<span class="num" id="6133209">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133214"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133228">[</span><span class="ident" id="6133229"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133230">+</span><span class="num" id="6133231">2</span><span class="op" id="6133232">]</span><span class="op" id="6133233">[</span><span class="num" id="6133234">2</span><span class="op" id="6133235">]</span>&nbsp;<span class="op" id="6133237">+=</span>&nbsp;<span class="ident" id="6133240"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6133243">*</span>&nbsp;<span class="num" id="6133245">1</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133250"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6133264">[</span><span class="ident" id="6133265"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133266">+</span><span class="num" id="6133267">2</span><span class="op" id="6133268">]</span><span class="op" id="6133269">[</span><span class="num" id="6133270">0</span><span class="op" id="6133271">]</span>&nbsp;<span class="op" id="6133273">+=</span>&nbsp;<span class="ident" id="6133276"><a href="/image/draw/draw.go.html#6131240">er</a></span>&nbsp;<span class="op" id="6133279">*</span>&nbsp;<span class="num" id="6133281">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133286"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6133300">[</span><span class="ident" id="6133301"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133302">+</span><span class="num" id="6133303">2</span><span class="op" id="6133304">]</span><span class="op" id="6133305">[</span><span class="num" id="6133306">1</span><span class="op" id="6133307">]</span>&nbsp;<span class="op" id="6133309">+=</span>&nbsp;<span class="ident" id="6133312"><a href="/image/draw/draw.go.html#6131244">eg</a></span>&nbsp;<span class="op" id="6133315">*</span>&nbsp;<span class="num" id="6133317">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133322"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6133336">[</span><span class="ident" id="6133337"><a href="/image/draw/draw.go.html#6131064">x</a></span><span class="op" id="6133338">+</span><span class="num" id="6133339">2</span><span class="op" id="6133340">]</span><span class="op" id="6133341">[</span><span class="num" id="6133342">2</span><span class="op" id="6133343">]</span>&nbsp;<span class="op" id="6133345">+=</span>&nbsp;<span class="ident" id="6133348"><a href="/image/draw/draw.go.html#6131248">eb</a></span>&nbsp;<span class="op" id="6133351">*</span>&nbsp;<span class="num" id="6133353">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6133362">//&nbsp;Recycle&nbsp;the&nbsp;quantization&nbsp;error&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133407">if</span>&nbsp;<span class="ident" id="6133410"><a href="/image/draw/draw.go.html#6129754">floydSteinberg</a></span>&nbsp;<span class="op" id="6133425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133430"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><span class="op" id="6133444">,</span>&nbsp;<span class="ident" id="6133446"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span>&nbsp;<span class="op" id="6133461">=</span>&nbsp;<span class="ident" id="6133463"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133477">,</span>&nbsp;<span class="ident" id="6133479"><a href="/image/draw/draw.go.html#6130802">quantErrorCurr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133497">for</span>&nbsp;<span class="ident" id="6133501">i</span>&nbsp;<span class="op" id="6133503">:=</span>&nbsp;<span class="keyword" id="6133506">range</span>&nbsp;<span class="ident" id="6133512"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span>&nbsp;<span class="op" id="6133527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133533"><a href="/image/draw/draw.go.html#6130818">quantErrorNext</a></span><span class="op" id="6133547">[</span><span class="ident" id="6133548"><a href="/image/draw/draw.go.html#6133501">i</a></span><span class="op" id="6133549">]</span>&nbsp;<span class="op" id="6133551">=</span>&nbsp;<span class="op" id="6133553">[</span><span class="num" id="6133554">3</span><span class="op" id="6133555">]</span><span class="builtintype" id="6133556">int32</span><span class="op" id="6133561">{</span><span class="op" id="6133562">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133574">}</span><br>
<span class="lineno"></span><span class="op" id="6133576">}</span>
</div>
</body>
</html>
