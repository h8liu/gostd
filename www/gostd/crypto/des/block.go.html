<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4590908">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4590963">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4591017">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4591068">package</span>&nbsp;<span class="ident" id="4591076">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4591081">import</span>&nbsp;<span class="op" id="4591088">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4591091">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4591109">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4591112">func</span>&nbsp;<span class="ident" id="4591117">cryptBlock</span><span class="op" id="4591127">(</span><span class="ident" id="4591128">subkeys</span>&nbsp;<span class="op" id="4591136">[</span><span class="op" id="4591137">]</span><span class="builtintype" id="4591138">uint64</span><span class="op" id="4591144">,</span>&nbsp;<span class="ident" id="4591146">dst</span><span class="op" id="4591149">,</span>&nbsp;<span class="ident" id="4591151">src</span>&nbsp;<span class="op" id="4591155">[</span><span class="op" id="4591156">]</span><span class="builtintype" id="4591157">byte</span><span class="op" id="4591161">,</span>&nbsp;<span class="ident" id="4591163">decrypt</span>&nbsp;<span class="builtintype" id="4591171">bool</span><span class="op" id="4591175">)</span>&nbsp;<span class="op" id="4591177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591180">b</span>&nbsp;<span class="op" id="4591182">:=</span>&nbsp;<span class="ident" id="4591185"><a href="/gostd/crypto/des/block.go.html#4591091">binary</a></span><span class="op" id="4591191">.</span><span class="ident" id="4591192"><a href="/gostd/encoding/binary/binary.go.html#2987146">BigEndian</a></span><span class="op" id="4591201">.</span><span class="ident" id="4591202"><a href="/gostd/encoding/binary/binary.go.html#2988670">Uint64</a></span><span class="op" id="4591208">(</span><span class="ident" id="4591209"><a href="/gostd/crypto/des/block.go.html#4591151">src</a></span><span class="op" id="4591212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591215"><a href="/gostd/crypto/des/block.go.html#4591180">b</a></span>&nbsp;<span class="op" id="4591217">=</span>&nbsp;<span class="ident" id="4591219"><a href="/gostd/crypto/des/block.go.html#4593579">permuteInitialBlock</a></span><span class="op" id="4591238">(</span><span class="ident" id="4591239"><a href="/gostd/crypto/des/block.go.html#4591180">b</a></span><span class="op" id="4591240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591243">left</span><span class="op" id="4591247">,</span>&nbsp;<span class="ident" id="4591249">right</span>&nbsp;<span class="op" id="4591255">:=</span>&nbsp;<span class="builtintype" id="4591258">uint32</span><span class="op" id="4591264">(</span><span class="ident" id="4591265"><a href="/gostd/crypto/des/block.go.html#4591180">b</a></span><span class="op" id="4591266">&gt;&gt;</span><span class="num" id="4591268">32</span><span class="op" id="4591270">)</span><span class="op" id="4591271">,</span>&nbsp;<span class="builtintype" id="4591273">uint32</span><span class="op" id="4591279">(</span><span class="ident" id="4591280"><a href="/gostd/crypto/des/block.go.html#4591180">b</a></span><span class="op" id="4591281">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591285">var</span>&nbsp;<span class="ident" id="4591289">subkey</span>&nbsp;<span class="builtintype" id="4591296">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591304">for</span>&nbsp;<span class="ident" id="4591308">i</span>&nbsp;<span class="op" id="4591310">:=</span>&nbsp;<span class="num" id="4591313">0</span><span class="op" id="4591314">;</span>&nbsp;<span class="ident" id="4591316"><a href="/gostd/crypto/des/block.go.html#4591308">i</a></span>&nbsp;<span class="op" id="4591318">&lt;</span>&nbsp;<span class="num" id="4591320">16</span><span class="op" id="4591322">;</span>&nbsp;<span class="ident" id="4591324"><a href="/gostd/crypto/des/block.go.html#4591308">i</a></span><span class="op" id="4591325">++</span>&nbsp;<span class="op" id="4591328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4591332">if</span>&nbsp;<span class="ident" id="4591335"><a href="/gostd/crypto/des/block.go.html#4591163">decrypt</a></span>&nbsp;<span class="op" id="4591343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591348"><a href="/gostd/crypto/des/block.go.html#4591289">subkey</a></span>&nbsp;<span class="op" id="4591355">=</span>&nbsp;<span class="ident" id="4591357"><a href="/gostd/crypto/des/block.go.html#4591128">subkeys</a></span><span class="op" id="4591364">[</span><span class="num" id="4591365">15</span><span class="op" id="4591367">-</span><span class="ident" id="4591368"><a href="/gostd/crypto/des/block.go.html#4591308">i</a></span><span class="op" id="4591369">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591373">}</span>&nbsp;<span class="keyword" id="4591375">else</span>&nbsp;<span class="op" id="4591380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591385"><a href="/gostd/crypto/des/block.go.html#4591289">subkey</a></span>&nbsp;<span class="op" id="4591392">=</span>&nbsp;<span class="ident" id="4591394"><a href="/gostd/crypto/des/block.go.html#4591128">subkeys</a></span><span class="op" id="4591401">[</span><span class="ident" id="4591402"><a href="/gostd/crypto/des/block.go.html#4591308">i</a></span><span class="op" id="4591403">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591412"><a href="/gostd/crypto/des/block.go.html#4591243">left</a></span><span class="op" id="4591416">,</span>&nbsp;<span class="ident" id="4591418"><a href="/gostd/crypto/des/block.go.html#4591249">right</a></span>&nbsp;<span class="op" id="4591424">=</span>&nbsp;<span class="ident" id="4591426"><a href="/gostd/crypto/des/block.go.html#4591249">right</a></span><span class="op" id="4591431">,</span>&nbsp;<span class="ident" id="4591433"><a href="/gostd/crypto/des/block.go.html#4591243">left</a></span><span class="op" id="4591437">^</span><span class="ident" id="4591438"><a href="/gostd/crypto/des/block.go.html#4591973">feistel</a></span><span class="op" id="4591445">(</span><span class="ident" id="4591446"><a href="/gostd/crypto/des/block.go.html#4591249">right</a></span><span class="op" id="4591451">,</span>&nbsp;<span class="ident" id="4591453"><a href="/gostd/crypto/des/block.go.html#4591289">subkey</a></span><span class="op" id="4591459">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4591465">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591519">preOutput</span>&nbsp;<span class="op" id="4591529">:=</span>&nbsp;<span class="op" id="4591532">(</span><span class="builtintype" id="4591533">uint64</span><span class="op" id="4591539">(</span><span class="ident" id="4591540"><a href="/gostd/crypto/des/block.go.html#4591249">right</a></span><span class="op" id="4591545">)</span>&nbsp;<span class="op" id="4591547">&lt;&lt;</span>&nbsp;<span class="num" id="4591550">32</span><span class="op" id="4591552">)</span>&nbsp;<span class="op" id="4591554">|</span>&nbsp;<span class="builtintype" id="4591556">uint64</span><span class="op" id="4591562">(</span><span class="ident" id="4591563"><a href="/gostd/crypto/des/block.go.html#4591243">left</a></span><span class="op" id="4591567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591570"><a href="/gostd/crypto/des/block.go.html#4591091">binary</a></span><span class="op" id="4591576">.</span><span class="ident" id="4591577"><a href="/gostd/encoding/binary/binary.go.html#2987146">BigEndian</a></span><span class="op" id="4591586">.</span><span class="ident" id="4591587"><a href="/gostd/encoding/binary/binary.go.html#2988871">PutUint64</a></span><span class="op" id="4591596">(</span><span class="ident" id="4591597"><a href="/gostd/crypto/des/block.go.html#4591146">dst</a></span><span class="op" id="4591600">,</span>&nbsp;<span class="ident" id="4591602"><a href="/gostd/crypto/des/block.go.html#4595198">permuteFinalBlock</a></span><span class="op" id="4591619">(</span><span class="ident" id="4591620"><a href="/gostd/crypto/des/block.go.html#4591519">preOutput</a></span><span class="op" id="4591629">)</span><span class="op" id="4591630">)</span><br>
<span class="lineno"></span><span class="op" id="4591632">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4591635">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4591694">func</span>&nbsp;<span class="ident" id="4591699">encryptBlock</span><span class="op" id="4591711">(</span><span class="ident" id="4591712">subkeys</span>&nbsp;<span class="op" id="4591720">[</span><span class="op" id="4591721">]</span><span class="builtintype" id="4591722">uint64</span><span class="op" id="4591728">,</span>&nbsp;<span class="ident" id="4591730">dst</span><span class="op" id="4591733">,</span>&nbsp;<span class="ident" id="4591735">src</span>&nbsp;<span class="op" id="4591739">[</span><span class="op" id="4591740">]</span><span class="builtintype" id="4591741">byte</span><span class="op" id="4591745">)</span>&nbsp;<span class="op" id="4591747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591750"><a href="/gostd/crypto/des/block.go.html#4591117">cryptBlock</a></span><span class="op" id="4591760">(</span><span class="ident" id="4591761"><a href="/gostd/crypto/des/block.go.html#4591712">subkeys</a></span><span class="op" id="4591768">,</span>&nbsp;<span class="ident" id="4591770"><a href="/gostd/crypto/des/block.go.html#4591730">dst</a></span><span class="op" id="4591773">,</span>&nbsp;<span class="ident" id="4591775"><a href="/gostd/crypto/des/block.go.html#4591735">src</a></span><span class="op" id="4591778">,</span>&nbsp;<span class="builtintype" id="4591780">false</span><span class="op" id="4591785">)</span><br>
<span class="lineno"></span><span class="op" id="4591787">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4591790">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4591849">func</span>&nbsp;<span class="ident" id="4591854">decryptBlock</span><span class="op" id="4591866">(</span><span class="ident" id="4591867">subkeys</span>&nbsp;<span class="op" id="4591875">[</span><span class="op" id="4591876">]</span><span class="builtintype" id="4591877">uint64</span><span class="op" id="4591883">,</span>&nbsp;<span class="ident" id="4591885">dst</span><span class="op" id="4591888">,</span>&nbsp;<span class="ident" id="4591890">src</span>&nbsp;<span class="op" id="4591894">[</span><span class="op" id="4591895">]</span><span class="builtintype" id="4591896">byte</span><span class="op" id="4591900">)</span>&nbsp;<span class="op" id="4591902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4591905"><a href="/gostd/crypto/des/block.go.html#4591117">cryptBlock</a></span><span class="op" id="4591915">(</span><span class="ident" id="4591916"><a href="/gostd/crypto/des/block.go.html#4591867">subkeys</a></span><span class="op" id="4591923">,</span>&nbsp;<span class="ident" id="4591925"><a href="/gostd/crypto/des/block.go.html#4591885">dst</a></span><span class="op" id="4591928">,</span>&nbsp;<span class="ident" id="4591930"><a href="/gostd/crypto/des/block.go.html#4591890">src</a></span><span class="op" id="4591933">,</span>&nbsp;<span class="builtintype" id="4591935">true</span><span class="op" id="4591939">)</span><br>
<span class="lineno"></span><span class="op" id="4591941">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4591944">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4591968">func</span>&nbsp;<span class="ident" id="4591973">feistel</span><span class="op" id="4591980">(</span><span class="ident" id="4591981">right</span>&nbsp;<span class="builtintype" id="4591987">uint32</span><span class="op" id="4591993">,</span>&nbsp;<span class="ident" id="4591995">key</span>&nbsp;<span class="builtintype" id="4591999">uint64</span><span class="op" id="4592005">)</span>&nbsp;<span class="op" id="4592007">(</span><span class="ident" id="4592008">result</span>&nbsp;<span class="builtintype" id="4592015">uint32</span><span class="op" id="4592021">)</span>&nbsp;<span class="op" id="4592023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592026">sBoxLocations</span>&nbsp;<span class="op" id="4592040">:=</span>&nbsp;<span class="ident" id="4592043"><a href="/gostd/crypto/des/block.go.html#4591995">key</a></span>&nbsp;<span class="op" id="4592047">^</span>&nbsp;<span class="ident" id="4592049"><a href="/gostd/crypto/des/block.go.html#4593186">expandBlock</a></span><span class="op" id="4592060">(</span><span class="ident" id="4592061"><a href="/gostd/crypto/des/block.go.html#4591981">right</a></span><span class="op" id="4592066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592069">var</span>&nbsp;<span class="ident" id="4592073">sBoxResult</span>&nbsp;<span class="builtintype" id="4592084">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592092">for</span>&nbsp;<span class="ident" id="4592096">i</span>&nbsp;<span class="op" id="4592098">:=</span>&nbsp;<span class="builtintype" id="4592101">uint8</span><span class="op" id="4592106">(</span><span class="num" id="4592107">0</span><span class="op" id="4592108">)</span><span class="op" id="4592109">;</span>&nbsp;<span class="ident" id="4592111"><a href="/gostd/crypto/des/block.go.html#4592096">i</a></span>&nbsp;<span class="op" id="4592113">&lt;</span>&nbsp;<span class="num" id="4592115">8</span><span class="op" id="4592116">;</span>&nbsp;<span class="ident" id="4592118"><a href="/gostd/crypto/des/block.go.html#4592096">i</a></span><span class="op" id="4592119">++</span>&nbsp;<span class="op" id="4592122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592126">sBoxLocation</span>&nbsp;<span class="op" id="4592139">:=</span>&nbsp;<span class="builtintype" id="4592142">uint8</span><span class="op" id="4592147">(</span><span class="ident" id="4592148"><a href="/gostd/crypto/des/block.go.html#4592026">sBoxLocations</a></span><span class="op" id="4592161">&gt;&gt;</span><span class="num" id="4592163">42</span><span class="op" id="4592165">)</span>&nbsp;<span class="op" id="4592167">&amp;</span>&nbsp;<span class="num" id="4592169">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592176"><a href="/gostd/crypto/des/block.go.html#4592026">sBoxLocations</a></span>&nbsp;<span class="op" id="4592190">&lt;&lt;=</span>&nbsp;<span class="num" id="4592194">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4592198">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4592237">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592269">row</span>&nbsp;<span class="op" id="4592273">:=</span>&nbsp;<span class="op" id="4592276">(</span><span class="ident" id="4592277"><a href="/gostd/crypto/des/block.go.html#4592126">sBoxLocation</a></span>&nbsp;<span class="op" id="4592290">&amp;</span>&nbsp;<span class="num" id="4592292">0x1</span><span class="op" id="4592295">)</span>&nbsp;<span class="op" id="4592297">|</span>&nbsp;<span class="op" id="4592299">(</span><span class="op" id="4592300">(</span><span class="ident" id="4592301"><a href="/gostd/crypto/des/block.go.html#4592126">sBoxLocation</a></span>&nbsp;<span class="op" id="4592314">&amp;</span>&nbsp;<span class="num" id="4592316">0x20</span><span class="op" id="4592320">)</span>&nbsp;<span class="op" id="4592322">&gt;&gt;</span>&nbsp;<span class="num" id="4592325">4</span><span class="op" id="4592326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592330">column</span>&nbsp;<span class="op" id="4592337">:=</span>&nbsp;<span class="op" id="4592340">(</span><span class="ident" id="4592341"><a href="/gostd/crypto/des/block.go.html#4592126">sBoxLocation</a></span>&nbsp;<span class="op" id="4592354">&gt;&gt;</span>&nbsp;<span class="num" id="4592357">1</span><span class="op" id="4592358">)</span>&nbsp;<span class="op" id="4592360">&amp;</span>&nbsp;<span class="num" id="4592362">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592368"><a href="/gostd/crypto/des/block.go.html#4592073">sBoxResult</a></span>&nbsp;<span class="op" id="4592379">^=</span>&nbsp;<span class="ident" id="4592382"><a href="/gostd/crypto/des/block.go.html#4592542">feistelBox</a></span><span class="op" id="4592392">[</span><span class="ident" id="4592393"><a href="/gostd/crypto/des/block.go.html#4592096">i</a></span><span class="op" id="4592394">]</span><span class="op" id="4592395">[</span><span class="num" id="4592396">16</span><span class="op" id="4592398">*</span><span class="ident" id="4592399"><a href="/gostd/crypto/des/block.go.html#4592269">row</a></span><span class="op" id="4592402">+</span><span class="ident" id="4592403"><a href="/gostd/crypto/des/block.go.html#4592330">column</a></span><span class="op" id="4592409">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4592412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592415">return</span>&nbsp;<span class="ident" id="4592422"><a href="/gostd/crypto/des/block.go.html#4592073">sBoxResult</a></span><br>
<span class="lineno">55</span><span class="op" id="4592433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4592436">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4592504">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4592538">var</span>&nbsp;<span class="ident" id="4592542">feistelBox</span>&nbsp;<span class="op" id="4592553">[</span><span class="num" id="4592554">8</span><span class="op" id="4592555">]</span><span class="op" id="4592556">[</span><span class="num" id="4592557">64</span><span class="op" id="4592559">]</span><span class="builtintype" id="4592560">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4592568">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4592630">func</span>&nbsp;<span class="ident" id="4592635">permuteBlock</span><span class="op" id="4592647">(</span><span class="ident" id="4592648">src</span>&nbsp;<span class="builtintype" id="4592652">uint64</span><span class="op" id="4592658">,</span>&nbsp;<span class="ident" id="4592660">permutation</span>&nbsp;<span class="op" id="4592672">[</span><span class="op" id="4592673">]</span><span class="builtintype" id="4592674">uint8</span><span class="op" id="4592679">)</span>&nbsp;<span class="op" id="4592681">(</span><span class="ident" id="4592682">block</span>&nbsp;<span class="builtintype" id="4592688">uint64</span><span class="op" id="4592694">)</span>&nbsp;<span class="op" id="4592696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592699">for</span>&nbsp;<span class="ident" id="4592703">position</span><span class="op" id="4592711">,</span>&nbsp;<span class="ident" id="4592713">n</span>&nbsp;<span class="op" id="4592715">:=</span>&nbsp;<span class="keyword" id="4592718">range</span>&nbsp;<span class="ident" id="4592724"><a href="/gostd/crypto/des/block.go.html#4592660">permutation</a></span>&nbsp;<span class="op" id="4592736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592740">bit</span>&nbsp;<span class="op" id="4592744">:=</span>&nbsp;<span class="op" id="4592747">(</span><span class="ident" id="4592748"><a href="/gostd/crypto/des/block.go.html#4592648">src</a></span>&nbsp;<span class="op" id="4592752">&gt;&gt;</span>&nbsp;<span class="ident" id="4592755"><a href="/gostd/crypto/des/block.go.html#4592713">n</a></span><span class="op" id="4592756">)</span>&nbsp;<span class="op" id="4592758">&amp;</span>&nbsp;<span class="num" id="4592760">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592764"><a href="/gostd/crypto/des/block.go.html#4592682">block</a></span>&nbsp;<span class="op" id="4592770">|=</span>&nbsp;<span class="ident" id="4592773"><a href="/gostd/crypto/des/block.go.html#4592740">bit</a></span>&nbsp;<span class="op" id="4592777">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4592780">uint</span><span class="op" id="4592784">(</span><span class="op" id="4592785">(</span><span class="builtinfunc" id="4592786">len</span><span class="op" id="4592789">(</span><span class="ident" id="4592790"><a href="/gostd/crypto/des/block.go.html#4592660">permutation</a></span><span class="op" id="4592801">)</span><span class="op" id="4592802">-</span><span class="num" id="4592803">1</span><span class="op" id="4592804">)</span><span class="op" id="4592805">-</span><span class="ident" id="4592806"><a href="/gostd/crypto/des/block.go.html#4592703">position</a></span><span class="op" id="4592814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4592817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592820">return</span><br>
<span class="lineno"></span><span class="op" id="4592827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4592830">func</span>&nbsp;<span class="ident" id="4592835">init</span><span class="op" id="4592839">(</span><span class="op" id="4592840">)</span>&nbsp;<span class="op" id="4592842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592845">for</span>&nbsp;<span class="ident" id="4592849">s</span>&nbsp;<span class="op" id="4592851">:=</span>&nbsp;<span class="keyword" id="4592854">range</span>&nbsp;<span class="ident" id="4592860"><a href="/gostd/crypto/des/const.go.html#4600977">sBoxes</a></span>&nbsp;<span class="op" id="4592867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592871">for</span>&nbsp;<span class="ident" id="4592875">i</span>&nbsp;<span class="op" id="4592877">:=</span>&nbsp;<span class="num" id="4592880">0</span><span class="op" id="4592881">;</span>&nbsp;<span class="ident" id="4592883"><a href="/gostd/crypto/des/block.go.html#4592875">i</a></span>&nbsp;<span class="op" id="4592885">&lt;</span>&nbsp;<span class="num" id="4592887">4</span><span class="op" id="4592888">;</span>&nbsp;<span class="ident" id="4592890"><a href="/gostd/crypto/des/block.go.html#4592875">i</a></span><span class="op" id="4592891">++</span>&nbsp;<span class="op" id="4592894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4592899">for</span>&nbsp;<span class="ident" id="4592903">j</span>&nbsp;<span class="op" id="4592905">:=</span>&nbsp;<span class="num" id="4592908">0</span><span class="op" id="4592909">;</span>&nbsp;<span class="ident" id="4592911"><a href="/gostd/crypto/des/block.go.html#4592903">j</a></span>&nbsp;<span class="op" id="4592913">&lt;</span>&nbsp;<span class="num" id="4592915">16</span><span class="op" id="4592917">;</span>&nbsp;<span class="ident" id="4592919"><a href="/gostd/crypto/des/block.go.html#4592903">j</a></span><span class="op" id="4592920">++</span>&nbsp;<span class="op" id="4592923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592929">f</span>&nbsp;<span class="op" id="4592931">:=</span>&nbsp;<span class="builtintype" id="4592934">uint64</span><span class="op" id="4592940">(</span><span class="ident" id="4592941"><a href="/gostd/crypto/des/const.go.html#4600977">sBoxes</a></span><span class="op" id="4592947">[</span><span class="ident" id="4592948"><a href="/gostd/crypto/des/block.go.html#4592849">s</a></span><span class="op" id="4592949">]</span><span class="op" id="4592950">[</span><span class="ident" id="4592951"><a href="/gostd/crypto/des/block.go.html#4592875">i</a></span><span class="op" id="4592952">]</span><span class="op" id="4592953">[</span><span class="ident" id="4592954"><a href="/gostd/crypto/des/block.go.html#4592903">j</a></span><span class="op" id="4592955">]</span><span class="op" id="4592956">)</span>&nbsp;<span class="op" id="4592958">&lt;&lt;</span>&nbsp;<span class="op" id="4592961">(</span><span class="num" id="4592962">4</span>&nbsp;<span class="op" id="4592964">*</span>&nbsp;<span class="op" id="4592966">(</span><span class="num" id="4592967">7</span>&nbsp;<span class="op" id="4592969">-</span>&nbsp;<span class="builtintype" id="4592971">uint</span><span class="op" id="4592975">(</span><span class="ident" id="4592976"><a href="/gostd/crypto/des/block.go.html#4592849">s</a></span><span class="op" id="4592977">)</span><span class="op" id="4592978">)</span><span class="op" id="4592979">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4592985"><a href="/gostd/crypto/des/block.go.html#4592929">f</a></span>&nbsp;<span class="op" id="4592987">=</span>&nbsp;<span class="ident" id="4592989"><a href="/gostd/crypto/des/block.go.html#4592635">permuteBlock</a></span><span class="op" id="4593001">(</span><span class="builtintype" id="4593002">uint64</span><span class="op" id="4593008">(</span><span class="ident" id="4593009"><a href="/gostd/crypto/des/block.go.html#4592929">f</a></span><span class="op" id="4593010">)</span><span class="op" id="4593011">,</span>&nbsp;<span class="ident" id="4593013"><a href="/gostd/crypto/des/const.go.html#4600085">permutationFunction</a></span><span class="op" id="4593032">[</span><span class="op" id="4593033">:</span><span class="op" id="4593034">]</span><span class="op" id="4593035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593041"><a href="/gostd/crypto/des/block.go.html#4592542">feistelBox</a></span><span class="op" id="4593051">[</span><span class="ident" id="4593052"><a href="/gostd/crypto/des/block.go.html#4592849">s</a></span><span class="op" id="4593053">]</span><span class="op" id="4593054">[</span><span class="num" id="4593055">16</span><span class="op" id="4593057">*</span><span class="ident" id="4593058"><a href="/gostd/crypto/des/block.go.html#4592875">i</a></span><span class="op" id="4593059">+</span><span class="ident" id="4593060"><a href="/gostd/crypto/des/block.go.html#4592903">j</a></span><span class="op" id="4593061">]</span>&nbsp;<span class="op" id="4593063">=</span>&nbsp;<span class="builtintype" id="4593065">uint32</span><span class="op" id="4593071">(</span><span class="ident" id="4593072"><a href="/gostd/crypto/des/block.go.html#4592929">f</a></span><span class="op" id="4593073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593085">}</span><br>
<span class="lineno">80</span><span class="op" id="4593087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4593090">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4593140">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4593181">func</span>&nbsp;<span class="ident" id="4593186">expandBlock</span><span class="op" id="4593197">(</span><span class="ident" id="4593198">src</span>&nbsp;<span class="builtintype" id="4593202">uint32</span><span class="op" id="4593208">)</span>&nbsp;<span class="op" id="4593210">(</span><span class="ident" id="4593211">block</span>&nbsp;<span class="builtintype" id="4593217">uint64</span><span class="op" id="4593223">)</span>&nbsp;<span class="op" id="4593225">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593228">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593272"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span>&nbsp;<span class="op" id="4593276">=</span>&nbsp;<span class="op" id="4593278">(</span><span class="ident" id="4593279"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span>&nbsp;<span class="op" id="4593283">&lt;&lt;</span>&nbsp;<span class="num" id="4593286">5</span><span class="op" id="4593287">)</span>&nbsp;<span class="op" id="4593289">|</span>&nbsp;<span class="op" id="4593291">(</span><span class="ident" id="4593292"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span>&nbsp;<span class="op" id="4593296">&gt;&gt;</span>&nbsp;<span class="num" id="4593299">27</span><span class="op" id="4593301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593304">for</span>&nbsp;<span class="ident" id="4593308">i</span>&nbsp;<span class="op" id="4593310">:=</span>&nbsp;<span class="num" id="4593313">0</span><span class="op" id="4593314">;</span>&nbsp;<span class="ident" id="4593316"><a href="/gostd/crypto/des/block.go.html#4593308">i</a></span>&nbsp;<span class="op" id="4593318">&lt;</span>&nbsp;<span class="num" id="4593320">8</span><span class="op" id="4593321">;</span>&nbsp;<span class="ident" id="4593323"><a href="/gostd/crypto/des/block.go.html#4593308">i</a></span><span class="op" id="4593324">++</span>&nbsp;<span class="op" id="4593327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593331"><a href="/gostd/crypto/des/block.go.html#4593211">block</a></span>&nbsp;<span class="op" id="4593337">&lt;&lt;=</span>&nbsp;<span class="num" id="4593341">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593345">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593379"><a href="/gostd/crypto/des/block.go.html#4593211">block</a></span>&nbsp;<span class="op" id="4593385">|=</span>&nbsp;<span class="builtintype" id="4593388">uint64</span><span class="op" id="4593394">(</span><span class="ident" id="4593395"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span><span class="op" id="4593398">)</span>&nbsp;<span class="op" id="4593400">&amp;</span>&nbsp;<span class="op" id="4593402">(</span><span class="num" id="4593403">1</span><span class="op" id="4593404">&lt;&lt;</span><span class="num" id="4593406">6</span>&nbsp;<span class="op" id="4593408">-</span>&nbsp;<span class="num" id="4593410">1</span><span class="op" id="4593411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593415">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593439"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span>&nbsp;<span class="op" id="4593443">=</span>&nbsp;<span class="op" id="4593445">(</span><span class="ident" id="4593446"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span>&nbsp;<span class="op" id="4593450">&lt;&lt;</span>&nbsp;<span class="num" id="4593453">4</span><span class="op" id="4593454">)</span>&nbsp;<span class="op" id="4593456">|</span>&nbsp;<span class="op" id="4593458">(</span><span class="ident" id="4593459"><a href="/gostd/crypto/des/block.go.html#4593198">src</a></span>&nbsp;<span class="op" id="4593463">&gt;&gt;</span>&nbsp;<span class="num" id="4593466">28</span><span class="op" id="4593468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4593471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4593474">return</span><br>
<span class="lineno">95</span><span class="op" id="4593481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4593484">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4593548">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4593574">func</span>&nbsp;<span class="ident" id="4593579">permuteInitialBlock</span><span class="op" id="4593598">(</span><span class="ident" id="4593599">block</span>&nbsp;<span class="builtintype" id="4593605">uint64</span><span class="op" id="4593611">)</span>&nbsp;<span class="builtintype" id="4593613">uint64</span>&nbsp;<span class="op" id="4593620">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593623">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593669">b1</span>&nbsp;<span class="op" id="4593672">:=</span>&nbsp;<span class="ident" id="4593675"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4593681">&gt;&gt;</span>&nbsp;<span class="num" id="4593684">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593688">b2</span>&nbsp;<span class="op" id="4593691">:=</span>&nbsp;<span class="ident" id="4593694"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4593700">&lt;&lt;</span>&nbsp;<span class="num" id="4593703">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593707"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4593713">^=</span>&nbsp;<span class="ident" id="4593716"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4593719">^</span>&nbsp;<span class="ident" id="4593721"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4593724">^</span>&nbsp;<span class="ident" id="4593726"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4593728">&lt;&lt;</span><span class="num" id="4593730">48</span>&nbsp;<span class="op" id="4593733">^</span>&nbsp;<span class="ident" id="4593735"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span><span class="op" id="4593737">&gt;&gt;</span><span class="num" id="4593739">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593744">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593780"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4593783">=</span>&nbsp;<span class="ident" id="4593785"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4593791">&gt;&gt;</span>&nbsp;<span class="num" id="4593794">32</span>&nbsp;<span class="op" id="4593797">&amp;</span>&nbsp;<span class="num" id="4593799">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593809"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4593812">=</span>&nbsp;<span class="op" id="4593814">(</span><span class="ident" id="4593815"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4593821">&amp;</span>&nbsp;<span class="num" id="4593823">0xff00ff00</span><span class="op" id="4593833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4593836"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4593842">^=</span>&nbsp;<span class="ident" id="4593845"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4593847">&lt;&lt;</span><span class="num" id="4593849">32</span>&nbsp;<span class="op" id="4593852">^</span>&nbsp;<span class="ident" id="4593854"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4593857">^</span>&nbsp;<span class="ident" id="4593859"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4593861">&lt;&lt;</span><span class="num" id="4593863">8</span>&nbsp;<span class="op" id="4593865">^</span>&nbsp;<span class="ident" id="4593867"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span><span class="op" id="4593869">&lt;&lt;</span><span class="num" id="4593871">24</span>&nbsp;<span class="comment" id="4593874">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593905">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593964">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4593992">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594048">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594076">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594104">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594160">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594189">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594232"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4594235">=</span>&nbsp;<span class="ident" id="4594237"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594243">&amp;</span>&nbsp;<span class="num" id="4594245">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594265"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4594268">=</span>&nbsp;<span class="ident" id="4594270"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594276">&amp;</span>&nbsp;<span class="num" id="4594278">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594298"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594304">^=</span>&nbsp;<span class="ident" id="4594307"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4594310">^</span>&nbsp;<span class="ident" id="4594312"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4594315">^</span>&nbsp;<span class="ident" id="4594317"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4594319">&gt;&gt;</span><span class="num" id="4594321">12</span>&nbsp;<span class="op" id="4594324">^</span>&nbsp;<span class="ident" id="4594326"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span><span class="op" id="4594328">&lt;&lt;</span><span class="num" id="4594330">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594335">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594365">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594369">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594394">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594398">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594414">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594430">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594446">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594472">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594510"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4594513">=</span>&nbsp;<span class="ident" id="4594515"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594521">&amp;</span>&nbsp;<span class="num" id="4594523">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594543"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4594546">=</span>&nbsp;<span class="ident" id="4594548"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594554">&amp;</span>&nbsp;<span class="num" id="4594556">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594576"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594582">^=</span>&nbsp;<span class="ident" id="4594585"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4594588">^</span>&nbsp;<span class="ident" id="4594590"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span>&nbsp;<span class="op" id="4594593">^</span>&nbsp;<span class="ident" id="4594595"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4594597">&gt;&gt;</span><span class="num" id="4594599">6</span>&nbsp;<span class="op" id="4594601">^</span>&nbsp;<span class="ident" id="4594603"><a href="/gostd/crypto/des/block.go.html#4593688">b2</a></span><span class="op" id="4594605">&lt;&lt;</span><span class="num" id="4594607">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594611">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594641">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594651">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594661">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594671">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594681">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594691">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594701">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594711">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594740">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594778"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4594781">=</span>&nbsp;<span class="ident" id="4594783"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594789">&amp;</span>&nbsp;<span class="num" id="4594791">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594811"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span>&nbsp;<span class="op" id="4594817">^=</span>&nbsp;<span class="ident" id="4594820"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span>&nbsp;<span class="op" id="4594823">^</span>&nbsp;<span class="ident" id="4594825"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4594827">&gt;&gt;</span><span class="num" id="4594829">33</span>&nbsp;<span class="op" id="4594832">^</span>&nbsp;<span class="ident" id="4594834"><a href="/gostd/crypto/des/block.go.html#4593669">b1</a></span><span class="op" id="4594836">&lt;&lt;</span><span class="num" id="4594838">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594843">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594873">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594900">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594927">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594954">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4594981">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595008">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595035">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595062">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595089">return</span>&nbsp;<span class="ident" id="4595096"><a href="/gostd/crypto/des/block.go.html#4593599">block</a></span><br>
<span class="lineno"></span><span class="op" id="4595102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4595105">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4595169">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4595193">func</span>&nbsp;<span class="ident" id="4595198">permuteFinalBlock</span><span class="op" id="4595215">(</span><span class="ident" id="4595216">block</span>&nbsp;<span class="builtintype" id="4595222">uint64</span><span class="op" id="4595228">)</span>&nbsp;<span class="builtintype" id="4595230">uint64</span>&nbsp;<span class="op" id="4595237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595240">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595298">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595324">b1</span>&nbsp;<span class="op" id="4595327">:=</span>&nbsp;<span class="ident" id="4595330"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595336">&amp;</span>&nbsp;<span class="num" id="4595338">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595358"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595364">^=</span>&nbsp;<span class="ident" id="4595367"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595370">^</span>&nbsp;<span class="ident" id="4595372"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595374">&gt;&gt;</span><span class="num" id="4595376">33</span>&nbsp;<span class="op" id="4595379">^</span>&nbsp;<span class="ident" id="4595381"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595383">&lt;&lt;</span><span class="num" id="4595385">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595390"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595393">=</span>&nbsp;<span class="ident" id="4595395"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595401">&amp;</span>&nbsp;<span class="num" id="4595403">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595423">b2</span>&nbsp;<span class="op" id="4595426">:=</span>&nbsp;<span class="ident" id="4595429"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595435">&amp;</span>&nbsp;<span class="num" id="4595437">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595457"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595463">^=</span>&nbsp;<span class="ident" id="4595466"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595469">^</span>&nbsp;<span class="ident" id="4595471"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595474">^</span>&nbsp;<span class="ident" id="4595476"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595478">&gt;&gt;</span><span class="num" id="4595480">6</span>&nbsp;<span class="op" id="4595482">^</span>&nbsp;<span class="ident" id="4595484"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span><span class="op" id="4595486">&lt;&lt;</span><span class="num" id="4595488">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595492"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595495">=</span>&nbsp;<span class="ident" id="4595497"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595503">&amp;</span>&nbsp;<span class="num" id="4595505">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595525"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595528">=</span>&nbsp;<span class="ident" id="4595530"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595536">&amp;</span>&nbsp;<span class="num" id="4595538">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595558"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595564">^=</span>&nbsp;<span class="ident" id="4595567"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595570">^</span>&nbsp;<span class="ident" id="4595572"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595575">^</span>&nbsp;<span class="ident" id="4595577"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595579">&gt;&gt;</span><span class="num" id="4595581">12</span>&nbsp;<span class="op" id="4595584">^</span>&nbsp;<span class="ident" id="4595586"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span><span class="op" id="4595588">&lt;&lt;</span><span class="num" id="4595590">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595595"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595598">=</span>&nbsp;<span class="ident" id="4595600"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595606">&gt;&gt;</span>&nbsp;<span class="num" id="4595609">32</span>&nbsp;<span class="op" id="4595612">&amp;</span>&nbsp;<span class="num" id="4595614">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595624"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595627">=</span>&nbsp;<span class="op" id="4595629">(</span><span class="ident" id="4595630"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595636">&amp;</span>&nbsp;<span class="num" id="4595638">0xff00ff00</span><span class="op" id="4595648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595651"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595657">^=</span>&nbsp;<span class="ident" id="4595660"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595662">&lt;&lt;</span><span class="num" id="4595664">32</span>&nbsp;<span class="op" id="4595667">^</span>&nbsp;<span class="ident" id="4595669"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595672">^</span>&nbsp;<span class="ident" id="4595674"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595676">&lt;&lt;</span><span class="num" id="4595678">8</span>&nbsp;<span class="op" id="4595680">^</span>&nbsp;<span class="ident" id="4595682"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span><span class="op" id="4595684">&lt;&lt;</span><span class="num" id="4595686">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595691"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595694">=</span>&nbsp;<span class="ident" id="4595696"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595702">&gt;&gt;</span>&nbsp;<span class="num" id="4595705">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595709"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595712">=</span>&nbsp;<span class="ident" id="4595714"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595720">&lt;&lt;</span>&nbsp;<span class="num" id="4595723">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595727"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span>&nbsp;<span class="op" id="4595733">^=</span>&nbsp;<span class="ident" id="4595736"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span>&nbsp;<span class="op" id="4595739">^</span>&nbsp;<span class="ident" id="4595741"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span>&nbsp;<span class="op" id="4595744">^</span>&nbsp;<span class="ident" id="4595746"><a href="/gostd/crypto/des/block.go.html#4595324">b1</a></span><span class="op" id="4595748">&lt;&lt;</span><span class="num" id="4595750">48</span>&nbsp;<span class="op" id="4595753">^</span>&nbsp;<span class="ident" id="4595755"><a href="/gostd/crypto/des/block.go.html#4595423">b2</a></span><span class="op" id="4595757">&gt;&gt;</span><span class="num" id="4595759">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595763">return</span>&nbsp;<span class="ident" id="4595770"><a href="/gostd/crypto/des/block.go.html#4595216">block</a></span><br>
<span class="lineno"></span><span class="op" id="4595776">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4595779">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4595825">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4595853">func</span>&nbsp;<span class="ident" id="4595858">ksRotate</span><span class="op" id="4595866">(</span><span class="ident" id="4595867">in</span>&nbsp;<span class="builtintype" id="4595870">uint32</span><span class="op" id="4595876">)</span>&nbsp;<span class="op" id="4595878">(</span><span class="ident" id="4595879">out</span>&nbsp;<span class="op" id="4595883">[</span><span class="op" id="4595884">]</span><span class="builtintype" id="4595885">uint32</span><span class="op" id="4595891">)</span>&nbsp;<span class="op" id="4595893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595896"><a href="/gostd/crypto/des/block.go.html#4595879">out</a></span>&nbsp;<span class="op" id="4595900">=</span>&nbsp;<span class="builtinfunc" id="4595902">make</span><span class="op" id="4595906">(</span><span class="op" id="4595907">[</span><span class="op" id="4595908">]</span><span class="builtintype" id="4595909">uint32</span><span class="op" id="4595915">,</span>&nbsp;<span class="num" id="4595917">16</span><span class="op" id="4595919">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595922">last</span>&nbsp;<span class="op" id="4595927">:=</span>&nbsp;<span class="ident" id="4595930"><a href="/gostd/crypto/des/block.go.html#4595867">in</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4595934">for</span>&nbsp;<span class="ident" id="4595938">i</span>&nbsp;<span class="op" id="4595940">:=</span>&nbsp;<span class="num" id="4595943">0</span><span class="op" id="4595944">;</span>&nbsp;<span class="ident" id="4595946"><a href="/gostd/crypto/des/block.go.html#4595938">i</a></span>&nbsp;<span class="op" id="4595948">&lt;</span>&nbsp;<span class="num" id="4595950">16</span><span class="op" id="4595952">;</span>&nbsp;<span class="ident" id="4595954"><a href="/gostd/crypto/des/block.go.html#4595938">i</a></span><span class="op" id="4595955">++</span>&nbsp;<span class="op" id="4595958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4595962">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4595994">left</span>&nbsp;<span class="op" id="4595999">:=</span>&nbsp;<span class="op" id="4596002">(</span><span class="ident" id="4596003"><a href="/gostd/crypto/des/block.go.html#4595922">last</a></span>&nbsp;<span class="op" id="4596008">&lt;&lt;</span>&nbsp;<span class="op" id="4596011">(</span><span class="num" id="4596012">4</span>&nbsp;<span class="op" id="4596014">+</span>&nbsp;<span class="ident" id="4596016"><a href="/gostd/crypto/des/const.go.html#4603086">ksRotations</a></span><span class="op" id="4596027">[</span><span class="ident" id="4596028"><a href="/gostd/crypto/des/block.go.html#4595938">i</a></span><span class="op" id="4596029">]</span><span class="op" id="4596030">)</span><span class="op" id="4596031">)</span>&nbsp;<span class="op" id="4596033">&gt;&gt;</span>&nbsp;<span class="num" id="4596036">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596040">right</span>&nbsp;<span class="op" id="4596046">:=</span>&nbsp;<span class="op" id="4596049">(</span><span class="ident" id="4596050"><a href="/gostd/crypto/des/block.go.html#4595922">last</a></span>&nbsp;<span class="op" id="4596055">&lt;&lt;</span>&nbsp;<span class="num" id="4596058">4</span><span class="op" id="4596059">)</span>&nbsp;<span class="op" id="4596061">&gt;&gt;</span>&nbsp;<span class="op" id="4596064">(</span><span class="num" id="4596065">32</span>&nbsp;<span class="op" id="4596068">-</span>&nbsp;<span class="ident" id="4596070"><a href="/gostd/crypto/des/const.go.html#4603086">ksRotations</a></span><span class="op" id="4596081">[</span><span class="ident" id="4596082"><a href="/gostd/crypto/des/block.go.html#4595938">i</a></span><span class="op" id="4596083">]</span><span class="op" id="4596084">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596088"><a href="/gostd/crypto/des/block.go.html#4595879">out</a></span><span class="op" id="4596091">[</span><span class="ident" id="4596092"><a href="/gostd/crypto/des/block.go.html#4595938">i</a></span><span class="op" id="4596093">]</span>&nbsp;<span class="op" id="4596095">=</span>&nbsp;<span class="ident" id="4596097"><a href="/gostd/crypto/des/block.go.html#4595994">left</a></span>&nbsp;<span class="op" id="4596102">|</span>&nbsp;<span class="ident" id="4596104"><a href="/gostd/crypto/des/block.go.html#4596040">right</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596112"><a href="/gostd/crypto/des/block.go.html#4595922">last</a></span>&nbsp;<span class="op" id="4596117">=</span>&nbsp;<span class="ident" id="4596119"><a href="/gostd/crypto/des/block.go.html#4595879">out</a></span><span class="op" id="4596122">[</span><span class="ident" id="4596123"><a href="/gostd/crypto/des/block.go.html#4595938">i</a></span><span class="op" id="4596124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596130">return</span><br>
<span class="lineno"></span><span class="op" id="4596137">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4596140">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4596191">func</span>&nbsp;<span class="op" id="4596196">(</span><span class="ident" id="4596197">c</span>&nbsp;<span class="op" id="4596199">*</span><span class="ident" id="4596200"><a href="/gostd/crypto/des/cipher.go.html#4597279">desCipher</a></span><span class="op" id="4596209">)</span>&nbsp;<span class="ident" id="4596211">generateSubkeys</span><span class="op" id="4596226">(</span><span class="ident" id="4596227">keyBytes</span>&nbsp;<span class="op" id="4596236">[</span><span class="op" id="4596237">]</span><span class="builtintype" id="4596238">byte</span><span class="op" id="4596242">)</span>&nbsp;<span class="op" id="4596244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4596247">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596280">key</span>&nbsp;<span class="op" id="4596284">:=</span>&nbsp;<span class="ident" id="4596287"><a href="/gostd/crypto/des/block.go.html#4591091">binary</a></span><span class="op" id="4596293">.</span><span class="ident" id="4596294"><a href="/gostd/encoding/binary/binary.go.html#2987146">BigEndian</a></span><span class="op" id="4596303">.</span><span class="ident" id="4596304"><a href="/gostd/encoding/binary/binary.go.html#2988670">Uint64</a></span><span class="op" id="4596310">(</span><span class="ident" id="4596311"><a href="/gostd/crypto/des/block.go.html#4596227">keyBytes</a></span><span class="op" id="4596319">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596322">permutedKey</span>&nbsp;<span class="op" id="4596334">:=</span>&nbsp;<span class="ident" id="4596337"><a href="/gostd/crypto/des/block.go.html#4592635">permuteBlock</a></span><span class="op" id="4596349">(</span><span class="ident" id="4596350"><a href="/gostd/crypto/des/block.go.html#4596280">key</a></span><span class="op" id="4596353">,</span>&nbsp;<span class="ident" id="4596355"><a href="/gostd/crypto/des/const.go.html#4600316">permutedChoice1</a></span><span class="op" id="4596370">[</span><span class="op" id="4596371">:</span><span class="op" id="4596372">]</span><span class="op" id="4596373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4596377">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596446">leftRotations</span>&nbsp;<span class="op" id="4596460">:=</span>&nbsp;<span class="ident" id="4596463"><a href="/gostd/crypto/des/block.go.html#4595858">ksRotate</a></span><span class="op" id="4596471">(</span><span class="builtintype" id="4596472">uint32</span><span class="op" id="4596478">(</span><span class="ident" id="4596479"><a href="/gostd/crypto/des/block.go.html#4596322">permutedKey</a></span>&nbsp;<span class="op" id="4596491">&gt;&gt;</span>&nbsp;<span class="num" id="4596494">28</span><span class="op" id="4596496">)</span><span class="op" id="4596497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596500">rightRotations</span>&nbsp;<span class="op" id="4596515">:=</span>&nbsp;<span class="ident" id="4596518"><a href="/gostd/crypto/des/block.go.html#4595858">ksRotate</a></span><span class="op" id="4596526">(</span><span class="builtintype" id="4596527">uint32</span><span class="op" id="4596533">(</span><span class="ident" id="4596534"><a href="/gostd/crypto/des/block.go.html#4596322">permutedKey</a></span><span class="op" id="4596545">&lt;&lt;</span><span class="num" id="4596547">4</span><span class="op" id="4596548">)</span>&nbsp;<span class="op" id="4596550">&gt;&gt;</span>&nbsp;<span class="num" id="4596553">4</span><span class="op" id="4596554">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4596558">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4596579">for</span>&nbsp;<span class="ident" id="4596583">i</span>&nbsp;<span class="op" id="4596585">:=</span>&nbsp;<span class="num" id="4596588">0</span><span class="op" id="4596589">;</span>&nbsp;<span class="ident" id="4596591"><a href="/gostd/crypto/des/block.go.html#4596583">i</a></span>&nbsp;<span class="op" id="4596593">&lt;</span>&nbsp;<span class="num" id="4596595">16</span><span class="op" id="4596597">;</span>&nbsp;<span class="ident" id="4596599"><a href="/gostd/crypto/des/block.go.html#4596583">i</a></span><span class="op" id="4596600">++</span>&nbsp;<span class="op" id="4596603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4596607">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596655">pc2Input</span>&nbsp;<span class="op" id="4596664">:=</span>&nbsp;<span class="builtintype" id="4596667">uint64</span><span class="op" id="4596673">(</span><span class="ident" id="4596674"><a href="/gostd/crypto/des/block.go.html#4596446">leftRotations</a></span><span class="op" id="4596687">[</span><span class="ident" id="4596688"><a href="/gostd/crypto/des/block.go.html#4596583">i</a></span><span class="op" id="4596689">]</span><span class="op" id="4596690">)</span><span class="op" id="4596691">&lt;&lt;</span><span class="num" id="4596693">28</span>&nbsp;<span class="op" id="4596696">|</span>&nbsp;<span class="builtintype" id="4596698">uint64</span><span class="op" id="4596704">(</span><span class="ident" id="4596705"><a href="/gostd/crypto/des/block.go.html#4596500">rightRotations</a></span><span class="op" id="4596719">[</span><span class="ident" id="4596720"><a href="/gostd/crypto/des/block.go.html#4596583">i</a></span><span class="op" id="4596721">]</span><span class="op" id="4596722">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4596726">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4596769"><a href="/gostd/crypto/des/block.go.html#4596197">c</a></span><span class="op" id="4596770">.</span><span class="ident" id="4596771"><a href="/gostd/crypto/des/cipher.go.html#4597299">subkeys</a></span><span class="op" id="4596778">[</span><span class="ident" id="4596779"><a href="/gostd/crypto/des/block.go.html#4596583">i</a></span><span class="op" id="4596780">]</span>&nbsp;<span class="op" id="4596782">=</span>&nbsp;<span class="ident" id="4596784"><a href="/gostd/crypto/des/block.go.html#4592635">permuteBlock</a></span><span class="op" id="4596796">(</span><span class="ident" id="4596797"><a href="/gostd/crypto/des/block.go.html#4596655">pc2Input</a></span><span class="op" id="4596805">,</span>&nbsp;<span class="ident" id="4596807"><a href="/gostd/crypto/des/const.go.html#4600671">permutedChoice2</a></span><span class="op" id="4596822">[</span><span class="op" id="4596823">:</span><span class="op" id="4596824">]</span><span class="op" id="4596825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596828">}</span><br>
<span class="lineno"></span><span class="op" id="4596830">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
